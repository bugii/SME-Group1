commit 22ceab231cc6af7059e921bec2ff1570c1743ac2
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Nov 28 16:22:45 2019 -0800

    RATIS-729. Add an assertion in ClientProtoUtils#toRaftClientReplyProto.  Contributed by Hanisha Koneru

 .../java/org/apache/ratis/client/impl/ClientProtoUtils.java | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 3d26ae9ee6b02e2b3a64f1cff0b4b97763362919
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Wed Nov 27 15:23:44 2019 +0530

    RATIS-760. Add missing Grpc log append entries timeout metric. Contributed by Siddharth Wagle.

 .../ratis/grpc/metrics/GrpcServerMetrics.java      |  6 ++++
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  3 +-
 .../src/main/java/org/apache/ratis/grpc/server/tmp | 42 ++++++++++++++++++++++
 .../ratis/grpc/server/TestGrpcServerMetrics.java   |  2 ++
 4 files changed, 52 insertions(+), 1 deletion(-)

commit 47f2aeafd9672f2d1b43bc868daecd3eee07c1ab
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 26 10:25:50 2019 -0800

    RATIS-756. Fix identified names in ratis-common.  Contributed by Dinesh Chitlangia

 .../main/java/org/apache/ratis/conf/ConfUtils.java | 14 ++---
 .../java/org/apache/ratis/conf/RaftProperties.java | 60 +++++++++++-----------
 .../apache/ratis/protocol/RaftClientRequest.java   |  6 +--
 .../java/org/apache/ratis/protocol/RaftGroup.java  |  2 +-
 .../java/org/apache/ratis/protocol/RaftId.java     |  4 +-
 .../java/org/apache/ratis/protocol/RaftPeerId.java | 10 ++--
 .../org/apache/ratis/util/ReflectionUtils.java     | 11 ++--
 .../java/org/apache/ratis/util/SlidingWindow.java  |  4 +-
 8 files changed, 54 insertions(+), 57 deletions(-)

commit 260dbaad18267be3c5b32d297af1ccdb63dfd693
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 22 13:15:16 2019 -0800

    RATIS-730. Fix checkstyle violations in ratis-examples.  Contributed by Dinesh Chitlangia

 .../arithmetic/ArithmeticStateMachine.java         | 12 +++++-----
 .../ratis/examples/arithmetic/cli/Arithmetic.java  |  5 ++++-
 .../ratis/examples/arithmetic/cli/Assign.java      | 24 ++++++++++----------
 .../ratis/examples/arithmetic/cli/Client.java      |  4 ++--
 .../apache/ratis/examples/arithmetic/cli/Get.java  |  3 +--
 .../ratis/examples/arithmetic/cli/Server.java      | 18 ++-------------
 .../arithmetic/expression/BinaryExpression.java    | 26 +++++++++++++---------
 .../arithmetic/expression/DoubleValue.java         |  8 +++++--
 .../examples/arithmetic/expression/Expression.java |  4 ++++
 .../examples/arithmetic/expression/NullValue.java  |  2 +-
 .../arithmetic/expression/UnaryExpression.java     | 16 ++++++++-----
 .../org/apache/ratis/examples/common/Runner.java   |  6 ++++-
 .../ratis/examples/common/SubCommandBase.java      | 23 +++++++++++++++++--
 .../apache/ratis/examples/filestore/FileInfo.java  |  6 ++---
 .../ratis/examples/filestore/FileStoreClient.java  |  3 +--
 .../ratis/examples/filestore/FileStoreCommon.java  |  1 -
 .../ratis/examples/filestore/cli/Client.java       |  4 ++--
 .../ratis/examples/filestore/cli/FileStore.java    |  5 ++++-
 .../ratis/examples/filestore/cli/LoadGen.java      |  4 ++--
 .../ratis/examples/filestore/cli/Server.java       | 18 ++-------------
 20 files changed, 103 insertions(+), 89 deletions(-)

commit c0721c1fe6ba1dc19e8d8bb8bb3c13382c945704
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Nov 21 17:05:20 2019 -0800

    RATIS-758. Illegal state transition in LeaderElection: RUNNING to CLOSED.  Contributed by Attila Doroszlai

 .../apache/ratis/server/impl/LeaderElection.java   | 36 +++++++++++++++--
 .../ratis/server/impl/LeaderElectionTests.java     | 47 ++++++++++++++++++++++
 2 files changed, 79 insertions(+), 4 deletions(-)

commit ce699ba3f36b034ff283a21de2645f98bb92a876
Author: Lokesh Jain <ljain@apache.org>
Date:   Wed Nov 20 18:51:39 2019 +0530

    RATIS-736. Add a new RetryPolicy similar to MultipleLinearRandomRetry in HDFS. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/retry/MultipleLinearRandomRetry.java     | 188 +++++++++++++++++++++
 .../java/org/apache/ratis/retry/RetryPolicy.java   |   3 +
 .../java/org/apache/ratis/util/TimeDuration.java   |  95 ++++++++++-
 .../ratis/retry/TestMultipleLinearRandomRetry.java |  85 ++++++++++
 .../apache/ratis/{ => retry}/TestRetryPolicy.java  |  13 +-
 .../org/apache/ratis/util/TestTimeDuration.java    |  82 ++++++++-
 6 files changed, 449 insertions(+), 17 deletions(-)

commit c532f814bf5865621a180365e7e73a911b3fd609
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 19 10:04:12 2019 -0800

    RATIS-740. Fix checkstyle violations in ratis-common.  Contributed by Dinesh Chitlangia

 .../java/org/apache/ratis/conf/RaftProperties.java | 234 +++++----------------
 .../src/main/java/org/apache/ratis/io/MD5Hash.java |  26 ++-
 .../org/apache/ratis/protocol/GroupInfoReply.java  |   1 +
 .../ratis/protocol/GroupManagementRequest.java     |   4 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |   6 +-
 .../org/apache/ratis/rpc/SupportedRpcType.java     |   1 -
 .../apache/ratis/util/AtomicFileOutputStream.java  |   7 +-
 .../java/org/apache/ratis/util/AtomicUtils.java    |   7 +-
 .../org/apache/ratis/util/AutoCloseableLock.java   |   2 +-
 .../ratis/util/AutoCloseableReadWriteLock.java     |  10 +-
 .../apache/ratis/util/CodeInjectionForTesting.java |   6 +-
 .../org/apache/ratis/util/CollectionUtils.java     |   6 +-
 .../main/java/org/apache/ratis/util/IOUtils.java   |   2 +-
 .../java/org/apache/ratis/util/MD5FileUtil.java    |  14 +-
 .../org/apache/ratis/util/MemoizedSupplier.java    |   2 +-
 .../java/org/apache/ratis/util/NativeCrc32.java    |  16 +-
 .../apache/ratis/util/NativeLibraryChecker.java    |   5 +-
 .../main/java/org/apache/ratis/util/NetUtils.java  |   8 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |   4 +-
 .../java/org/apache/ratis/util/SizeInBytes.java    |   2 +-
 .../java/org/apache/ratis/util/StringUtils.java    |   5 +-
 .../apache/ratis/util/TraditionalBinaryPrefix.java |   8 +-
 22 files changed, 147 insertions(+), 229 deletions(-)

commit 425ed52f99efb976efd919aa72e9b171cab3869a
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 19 07:39:56 2019 -0800

    RATIS-748. Follower might not update its commit index.  Contributed by Lokesh Jain

 .../src/main/java/org/apache/ratis/server/raftlog/RaftLog.java | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit a421d1481170f41ddaf5bdd3b43ec545648ec868
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 19 10:00:31 2019 -0800

    Revert "ATIS-748" for fixing the commit log.
    
    This reverts commit 216806550f761b639abbb7f5ebe1988ce804a0f6.

 .../src/main/java/org/apache/ratis/server/raftlog/RaftLog.java | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit ee332dc37b941b634766fd7d4fb16a763965d498
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 19 09:29:12 2019 -0800

    RATIS-749. Create constant for set of not running states.  Contributed by Attila Doroszlai

 .../main/java/org/apache/ratis/util/LifeCycle.java | 44 ++++++++++++++--------
 .../java/org/apache/ratis/netty/NettyClient.java   |  3 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 16 ++++----
 4 files changed, 38 insertions(+), 27 deletions(-)

commit 216806550f761b639abbb7f5ebe1988ce804a0f6
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 19 07:39:56 2019 -0800

    ATIS-748. Follower might not update its commit index.  Contributed by Lokesh Jain

 .../src/main/java/org/apache/ratis/server/raftlog/RaftLog.java | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit 86afb3afbe10918505dc0e8c9f3d2ec0443ed9a1
Author: Tsz-Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Nov 18 13:35:02 2019 -0800

    Revert "RATIS-741. Create a Github PR template" (#47) due to missing Apache license header.

 .github/pull_request_template.md | 15 ---------------
 1 file changed, 15 deletions(-)

commit 5b4a6c4d58877d5eb5b1189f2c484622da9e0b38
Merge: 45e279f4 4b8b0379
Author: Tsz-Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Nov 18 12:30:04 2019 -0800

    Merge pull request #44 from dineshchitlangia/RATIS-741
    
    RATIS-741. Create a Github PR template.  Contributed by Dinesh Chitlangia

commit 45e279f438e81d6dbc92b55f8505b251cf7f52b4
Author: Lokesh Jain <ljain@apache.org>
Date:   Mon Nov 18 16:46:21 2019 +0530

    RATIS-652. Add metrics related to snapshot and log purge. Contributed by Aravindan Vijayan.

 .../ratis/grpc/metrics/GrpcServerMetrics.java      | 17 +++++++++-----
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  1 +
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 ++
 .../ratis/server/impl/RaftServerMetrics.java       |  5 ++++
 .../ratis/server/impl/StateMachineMetrics.java     | 10 ++++++++
 .../ratis/server/impl/StateMachineUpdater.java     |  4 ++++
 .../ratis/server/metrics/RaftLogMetrics.java       |  6 ++++-
 .../ratis/server/metrics/RatisMetricNames.java     | 27 ++++++++++++++--------
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |  4 +++-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   | 24 +++++++++++++++++++
 .../ratis/grpc/TestRaftSnapshotWithGrpc.java       | 21 +++++++++++++++++
 .../ratis/server/raftlog/TestRaftLogMetrics.java   |  2 +-
 .../raftlog/segmented/TestSegmentedRaftLog.java    | 17 +++++++++++---
 13 files changed, 118 insertions(+), 22 deletions(-)

commit adaf422abfa1340ca24a0bec53a2de87778ff9d5
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Nov 14 07:05:24 2019 -0800

    RATIS-753. Mark o.a.r.protocol.Message as @FunctionalInterface.  Contributed by Zili Chen

 ratis-common/src/main/java/org/apache/ratis/protocol/Message.java | 1 +
 1 file changed, 1 insertion(+)

commit 0ea2d2e6bf93a33027e20ef280a77e87dddb351e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 12 14:26:26 2019 -0800

    RATIS-751. TestStateMachineShutdownWithGrpc fails with AssertionError.  Contributed by Lokesh Jain

 .../java/org/apache/ratis/server/impl/StateMachineShutdownTests.java    | 2 ++
 1 file changed, 2 insertions(+)

commit a2ce5211003069548de749e5296210d2ccea2bf5
Author: Clay Baenziger <cwb@clayb.net>
Date:   Tue Nov 12 13:41:24 2019 +0100

    RATIS-750. NullPointerException at the ratis client while running Freon benchmark.

 ratis-examples/pom.xml | 5 +++++
 1 file changed, 5 insertions(+)

commit 2a247b154a3ab2976beb0c8b58dc8b957742d70f
Author: Mukul Kumar Singh <msingh@hortonworks.com>
Date:   Tue Nov 12 13:35:14 2019 +0100

    Update Ratis thirdparty to 0.3.0

 pom.xml | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 073137602c68559fc6395629c10298f5d055f068
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 8 13:49:47 2019 -0800

    RATIS-747. RaftServerMetrics.getRaftServerMetrics throws IllegalStateException.  Contributed by Aravindan Vijayan

 .../java/org/apache/ratis/server/impl/FollowerState.java     |  3 ---
 .../java/org/apache/ratis/server/impl/RaftServerMetrics.java | 12 ++++++------
 2 files changed, 6 insertions(+), 9 deletions(-)

commit 005aa6ab0f7a9051bb4c4a47660bca29ec70aa20
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Nov 6 09:47:26 2019 -0800

    RATIS-743. Remove log4j default test scope from dependencyManagement.  Contributed by Henrik Hegardt

 pom.xml | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit e2cbcc1b5538f50a2ec80facefe08f307fd05683
Author: Lokesh Jain <ljain@apache.org>
Date:   Wed Nov 6 15:11:21 2019 +0530

    RATIS-580. Refactor retryPolicy for RaftClient to customize wait time based on exception. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/client/ClientRetryEvent.java  |  56 ++++++++++
 .../org/apache/ratis/client/impl/OrderedAsync.java |  20 ++--
 .../apache/ratis/client/impl/RaftClientImpl.java   |  18 ++--
 .../apache/ratis/client/impl/UnorderedAsync.java   |  13 ++-
 .../retry/RequestTypeDependentRetryPolicy.java     |  87 ++++++++++++++++
 .../java/org/apache/ratis/retry/RetryPolicies.java | 113 ++++-----------------
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  48 ++++++---
 .../java/org/apache/ratis/util/TimeDuration.java   |   9 ++
 .../ratis/util/function/CheckedBiFunction.java     |  28 +++++
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  56 +++++-----
 .../java/org/apache/ratis/WatchRequestTests.java   |   9 +-
 .../java/org/apache/ratis/TestRetryPolicy.java     |  44 +++++---
 12 files changed, 328 insertions(+), 173 deletions(-)

commit 3f85a2abc3493b1f70e0841f8152001875b1f96a
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Nov 5 19:22:23 2019 +0530

    RATIS-682. Add follower metrics corresponding to LogAppender. Contributed by Siddharth Wagle.

 .../org/apache/ratis/server/impl/FollowerInfo.java |  3 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  7 +-
 .../ratis/server/metrics/LogAppenderMetrics.java   | 47 ++++++++++++
 .../ratis/server/metrics/RatisMetricNames.java     |  6 ++
 .../apache/ratis/server/metrics/RatisMetrics.java  |  7 ++
 .../ratis/server/impl/TestLogAppenderMetrics.java  | 86 ++++++++++++++++++++++
 6 files changed, 152 insertions(+), 4 deletions(-)

commit f40dad9b1504bff82a9f3559bb0f0ddf7205d6f0
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Nov 5 14:53:37 2019 +0530

    RATIS-614. Raft leader should use state machine's last applied index for LeaderNotReady exception. Contributed by Lokesh Jain.

 .../java/org/apache/ratis/server/impl/ServerState.java |  2 +-
 .../apache/ratis/server/impl/StateMachineUpdater.java  |  6 +++++-
 .../ratis/statemachine/impl/BaseStateMachine.java      | 18 +++++++++++-------
 .../src/test/java/org/apache/ratis/RaftBasicTests.java |  4 ----
 .../ratis/statemachine/SimpleStateMachine4Testing.java |  4 +++-
 5 files changed, 20 insertions(+), 14 deletions(-)

commit 4b8b03793aad36a45d6439ca5c6f22c81ee3b756
Author: Dinesh Chitlangia <dineshchitlangia@gmail.com>
Date:   Thu Oct 31 23:46:36 2019 -0400

    RATIS-741. Create a Github PR template

 .github/pull_request_template.md | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit 577dc9e57fa8da32af778c0c6dbc43c9be758543
Merge: bb569c23 343405df
Author: Tsz-Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 30 10:05:25 2019 -0700

    Merge pull request #41 from apache/dependabot/maven/com.puppycrawl.tools-checkstyle-8.18
    
    RATIS-738. Bump checkstyle from 8.16 to 8.18.  Contributed by Dependabot

commit 343405df39fb0664be189e0691c19b5f4af67750
Author: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Date:   Wed Oct 30 16:49:20 2019 +0000

    Bump checkstyle from 8.16 to 8.18
    
    Bumps [checkstyle](https://github.com/checkstyle/checkstyle) from 8.16 to 8.18.
    - [Release notes](https://github.com/checkstyle/checkstyle/releases)
    - [Commits](https://github.com/checkstyle/checkstyle/compare/checkstyle-8.16...checkstyle-8.18)
    
    Signed-off-by: dependabot[bot] <support@github.com>

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bb569c2397dac094a28c9f729c235c6334ec0ce9
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 30 09:47:17 2019 -0700

    RATIS-508. Switch from log4j to slf4j.  Contributed by Henrik Hegardt

 pom.xml                                            |  7 ++++
 .../main/java/org/apache/ratis/util/LogUtils.java  | 12 -------
 .../src/test/java/org/apache/ratis/BaseTest.java   |  6 ++--
 .../java/org/apache/ratis/util/Log4jUtils.java     | 37 ++++++++++++++++++++++
 ratis-examples/pom.xml                             | 10 ++++++
 .../org/apache/ratis/examples/common/Runner.java   | 17 +++-------
 ratis-examples/src/main/resources/log4j.properties |  2 ++
 .../java/org/apache/ratis/TestMultiRaftGroup.java  |  4 +--
 .../ratis/examples/arithmetic/TestArithmetic.java  |  4 +--
 ratis-grpc/pom.xml                                 |  4 +++
 ratis-hadoop/pom.xml                               |  4 +++
 .../hadooprpc/TestLeaderElectionWithHadoopRpc.java |  4 +--
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |  4 +--
 ratis-logservice/pom.xml                           |  4 +++
 ratis-metrics/pom.xml                              |  4 +++
 ratis-netty/pom.xml                                |  4 +++
 ratis-replicated-map/pom.xml                       |  4 +++
 ratis-server/pom.xml                               |  9 ++++++
 .../ratis/InstallSnapshotNotificationTests.java    |  4 +--
 .../java/org/apache/ratis/LogAppenderTests.java    |  4 +--
 .../org/apache/ratis/RaftAsyncExceptionTests.java  |  4 +--
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  6 ++--
 .../test/java/org/apache/ratis/RaftBasicTests.java |  6 ++--
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  8 ++---
 .../apache/ratis/RequestLimitAsyncBaseTest.java    |  6 ++--
 .../java/org/apache/ratis/RetryCacheTests.java     |  4 +--
 .../java/org/apache/ratis/WatchRequestTests.java   |  4 +--
 .../ratis/server/impl/GroupInfoBaseTest.java       |  6 ++--
 .../ratis/server/impl/GroupManagementBaseTest.java |  8 ++---
 .../ratis/server/impl/LeaderElectionTests.java     |  6 ++--
 .../server/impl/RaftReconfigurationBaseTest.java   |  4 +--
 .../ratis/server/impl/RaftServerTestUtil.java      |  6 ++--
 .../impl/RaftStateMachineExceptionTests.java       |  8 ++---
 .../segmented/SegmentedRaftLogTestUtils.java       |  4 +--
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  8 ++---
 ratis-test/pom.xml                                 |  9 ++++++
 .../ratis/TestRaftServerNoLeaderTimeout.java       |  6 ++--
 .../ratis/TestRaftServerSlownessDetection.java     |  4 +--
 .../apache/ratis/grpc/TestGrpcOutputStream.java    |  4 +--
 .../ratis/grpc/TestRaftOutputStreamWithGrpc.java   |  4 +--
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  6 ++--
 .../ratis/grpc/TestWatchRequestWithGrpc.java       | 10 +++---
 .../apache/ratis/server/ServerRestartTests.java    |  4 +--
 .../raftlog/segmented/TestSegmentedRaftLog.java    |  8 ++---
 .../ratis/statemachine/TestStateMachine.java       |  7 ++--
 .../apache/ratis/util/TestTimeoutScheduler.java    |  2 +-
 46 files changed, 188 insertions(+), 112 deletions(-)

commit f80757d3df3ce15022118095cd5f623b1c89d559
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 30 08:28:37 2019 -0700

    RATIS-457. gRPC timed out append entry reply should update follower match index.  Contributed by Lokesh Jain

 .../apache/ratis/grpc/server/GrpcLogAppender.java  | 32 +++++++---------------
 ratis-proto/src/main/proto/Raft.proto              |  1 +
 .../apache/ratis/server/impl/RaftServerImpl.java   | 10 +++++--
 .../apache/ratis/server/impl/ServerProtoUtils.java |  5 +++-
 4 files changed, 22 insertions(+), 26 deletions(-)

commit 368849c0e420db5684618385b14f5932892de40e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Oct 29 11:58:31 2019 -0700

    RATIS-307. Improve make_rc script with additional step of the release process.  Contributed by Marton Elek

 dev-support/make_rc.sh | 175 ++++++++++++++++++++++++++++++++++++-------------
 1 file changed, 131 insertions(+), 44 deletions(-)

commit fe030bd3e97ef98c1b034d01a0c875065b073169
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 28 15:21:55 2019 -0700

    RATIS-714. Limit the byte size used by the message in pending requests.

 .../java/org/apache/ratis/protocol/Message.java    |  11 +-
 .../org/apache/ratis/util/ResourceSemaphore.java   | 117 +++++++++++++++++++--
 .../apache/ratis/server/RaftServerConfigKeys.java  |  10 ++
 .../org/apache/ratis/server/impl/LeaderState.java  |   4 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  53 +++++++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |   2 +-
 .../ratis/server/impl/RaftServerMetrics.java       |   6 +-
 .../apache/ratis/util/TestResourceSemaphore.java   |  65 ++++++++++++
 8 files changed, 240 insertions(+), 28 deletions(-)

commit 3eba6c2ebc524a4bec05b5836ea49d8aa31a8e7c
Author: Arpit Agarwal <arp@apache.org>
Date:   Mon Oct 28 09:53:05 2019 -0700

    RATIS-680. Fix LICENSE file issues. Contributed by Arpit Agarwal.

 LICENSE | 126 ++++++++++++++++++++++++++++++++++++----------------------------
 1 file changed, 72 insertions(+), 54 deletions(-)

commit bc85807da993745d86d17ea463c6dce8fdb2e1e5
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 24 14:47:41 2019 -0700

    RATIS-708. Benchmark for toRaftClientRequestProto.

 .../main/java/org/apache/ratis/util/DataQueue.java |  2 +-
 .../java/org/apache/ratis/util/TimeDuration.java   | 10 ++-
 .../apache/ratis/client/TestClientProtoUtils.java  | 97 ++++++++++++++++++++++
 .../org/apache/ratis/util/TestTimeDuration.java    | 32 +++++--
 4 files changed, 133 insertions(+), 8 deletions(-)

commit d6d58d0f52b66c10c364ff1115fe252bd36acf62
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 24 10:54:36 2019 -0700

    RATIS-603. Add a method to StateMachine for printing StateMachineLogEntryProto.  Contributed by Mukul Kumar Singh

 .../apache/ratis/server/impl/ServerProtoUtils.java    | 19 ++++++++++++++++---
 .../java/org/apache/ratis/server/raftlog/RaftLog.java | 14 +++++++++-----
 .../server/raftlog/segmented/SegmentedRaftLog.java    |  5 +++++
 .../raftlog/segmented/SegmentedRaftLogWorker.java     |  4 ++--
 .../org/apache/ratis/statemachine/StateMachine.java   | 10 ++++++++++
 5 files changed, 42 insertions(+), 10 deletions(-)

commit debf50acc42d0d39b8d5e3396ec7eba2ebabf963
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 24 09:00:10 2019 -0700

    RATIS-694. Fix checkstyle violations in ratis-metrics.  Contributed by Dinesh Chitlangia

 .../main/java/org/apache/ratis/metrics/MetricRegistriesLoader.java  | 4 ++--
 .../src/main/java/org/apache/ratis/metrics/MetricRegistryInfo.java  | 6 +++---
 .../java/org/apache/ratis/metrics/impl/RatisMetricRegistryImpl.java | 2 +-
 .../src/main/java/org/apache/ratis/metrics/impl/RefCountingMap.java | 4 ++--
 4 files changed, 8 insertions(+), 8 deletions(-)

commit 2fd6c04dd12f4da9b23f4e4c5c0dd24134b42c17
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 24 08:53:03 2019 -0700

    RATIS-692. RaftStorageDirectory.tryLock throws a very deep IOException.

 .../src/main/java/org/apache/ratis/util/FileUtils.java    | 15 ++++++++++++++-
 .../src/main/java/org/apache/ratis/util/JavaUtils.java    | 10 +++++++++-
 .../src/main/java/org/apache/ratis/util/TimeDuration.java |  1 +
 ratis-common/src/test/java/org/apache/ratis/BaseTest.java |  2 +-
 .../apache/ratis/server/storage/RaftStorageDirectory.java |  6 +++---
 5 files changed, 28 insertions(+), 6 deletions(-)

commit ad6d7c3ea63e6b728ae5121582d02e2709311e91
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Thu Oct 24 15:40:50 2019 +0530

    RATIS-728. TimeoutScheduler for GrpcLogAppender holds on to the AppendEntryRequest till it times out even though request succeeds. Contributed by Tsz-wo Sze.

 .../grpc/client/GrpcClientProtocolClient.java      | 13 ++--
 .../apache/ratis/grpc/server/GrpcLogAppender.java  | 86 ++++++++++++++--------
 2 files changed, 61 insertions(+), 38 deletions(-)

commit 9c1638dbe6ef31246d780331b0cc8d27a8dc0c60
Author: Lokesh Jain <ljain@apache.org>
Date:   Thu Oct 24 12:48:08 2019 +0530

    RATIS-704. Invoke sendAsync as soon as OrderedAsync is created. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/RaftClientConfigKeys.java  | 15 ++++++++++++-
 .../org/apache/ratis/client/impl/OrderedAsync.java | 26 ++++++++++++++++------
 .../apache/ratis/client/impl/RaftClientImpl.java   |  2 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |  5 +++++
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  1 +
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  2 +-
 .../org/apache/ratis/RaftAsyncExceptionTests.java  | 20 ++++++++++-------
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 14 +++++++++---
 .../test/java/org/apache/ratis/RaftBasicTests.java |  5 +++--
 9 files changed, 67 insertions(+), 23 deletions(-)

commit 55cbfbbca68aca531bc261786a34499fce4de700
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Wed Oct 23 17:21:00 2019 +0530

    RATIS-726. TimeoutScheduler holds on to the raftClientRequest till it times out even though request succeeds. Contributed by Tsz-wo Sze.

 .../org/apache/ratis/client/impl/OrderedAsync.java | 49 ++++++++++++++--------
 1 file changed, 31 insertions(+), 18 deletions(-)

commit c76ab77da3c501cf51dd0c21d9b66ca484556ab4
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Oct 22 13:11:24 2019 +0530

    RATIS-718. TimeoutScheduler throws IllegalStateException. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  2 +-
 .../org/apache/ratis/util/TimeoutScheduler.java    | 89 ++++++++++++----------
 .../grpc/client/GrpcClientProtocolClient.java      |  2 +-
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  2 +-
 .../apache/ratis/server/impl/WatchRequests.java    |  2 +-
 .../apache/ratis/util/TestTimeoutScheduler.java    | 19 +++--
 6 files changed, 63 insertions(+), 53 deletions(-)

commit 510206dc54d334e5adf26c350a2dde27cbcda020
Author: cxorm <lianp964@gmail.com>
Date:   Wed Oct 16 16:38:58 2019 +0800

    RATIS-390. Fix package of LogServiceClient
    
    Closes #40
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../apache/ratis/logservice/{client => api}/LogServiceClient.java  | 7 +------
 .../src/main/java/org/apache/ratis/logservice/shell/Command.java   | 2 +-
 .../java/org/apache/ratis/logservice/shell/LogServiceShell.java    | 2 +-
 .../apache/ratis/logservice/shell/commands/ArchiveLogCommand.java  | 2 +-
 .../apache/ratis/logservice/shell/commands/CreateLogCommand.java   | 2 +-
 .../apache/ratis/logservice/shell/commands/DeleteLogCommand.java   | 2 +-
 .../org/apache/ratis/logservice/shell/commands/ExitCommand.java    | 2 +-
 .../apache/ratis/logservice/shell/commands/ExportLogCommand.java   | 2 +-
 .../org/apache/ratis/logservice/shell/commands/HelpCommand.java    | 2 +-
 .../apache/ratis/logservice/shell/commands/ListLogsCommand.java    | 2 +-
 .../apache/ratis/logservice/shell/commands/PutToLogCommand.java    | 2 +-
 .../org/apache/ratis/logservice/shell/commands/ReadLogCommand.java | 2 +-
 .../java/org/apache/ratis/logservice/tool/VerificationTool.java    | 2 +-
 .../java/org/apache/ratis/logservice/server/TestMetaServer.java    | 2 +-
 .../org/apache/ratis/logservice/tool/TestVerificationTool.java     | 2 +-
 .../java/org/apache/ratis/logservice/util/LogServiceCluster.java   | 2 +-
 16 files changed, 16 insertions(+), 21 deletions(-)

commit 99c33e0b1eabd15f44e08f5e1f42597f3ef4328c
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 21 10:18:27 2019 -0400

    RATIS-723. Fix pluggable metrics impl which cause test failures
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../src/main/java/org/apache/ratis/util/JmxRegister.java   |  4 ++--
 .../org/apache/ratis/examples/filestore/cli/Server.java    | 12 ++++--------
 ratis-logservice/pom.xml                                   |  5 +++++
 .../apache/ratis/logservice/LogServiceReadWriteBase.java   |  7 +++++++
 .../org/apache/ratis/logservice/server/TestMetaServer.java |  7 ++++++-
 .../src/main/java/org/apache/ratis/metrics/JVMMetrics.java | 14 +++++++++-----
 .../java/org/apache/ratis/metrics/MetricsReporting.java    |  7 ++++---
 ratis-test/pom.xml                                         |  6 ++++++
 .../apache/ratis/server/raftlog/TestRaftLogMetrics.java    |  8 +++++---
 9 files changed, 48 insertions(+), 22 deletions(-)

commit ced7dbfea404523ebc6b415d2e42979c2ac6b351
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Fri Oct 18 16:25:22 2019 +0530

    RATIS-649. Add metrics related to ClientRequests. Contributed by Aravindan Vijayan.

 .../apache/ratis/protocol/RaftClientRequest.java   |   2 +-
 .../apache/ratis/server/impl/FollowerState.java    |   2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   4 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  10 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 104 ++++++++++++---------
 .../ratis/server/impl/RaftServerMetrics.java       |  51 +++++++++-
 .../ratis/server/metrics/RatisMetricNames.java     |  15 +++
 .../apache/ratis/server/metrics/RatisMetrics.java  |   5 -
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  43 ++++++++-
 9 files changed, 174 insertions(+), 62 deletions(-)

commit ef12b1f2125bae534e07899395c8f14e94a648b5
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Fri Oct 18 15:58:02 2019 +0530

    RATIS-676. Add a metric in RaftServer to track the Log Commit Index. Contributed by Aravindan Vijayan.

 .../apache/ratis/server/impl/FollowerState.java    |  3 +++
 .../org/apache/ratis/server/impl/LeaderState.java  | 16 ++++-----------
 ...ftLeaderMetrics.java => RaftServerMetrics.java} | 24 +++++++++++-----------
 .../ratis/server/metrics/RatisMetricNames.java     |  4 ++--
 .../apache/ratis/server/metrics/RatisMetrics.java  | 14 ++++++-------
 .../java/org/apache/ratis/LogAppenderTests.java    |  4 ++--
 .../test/java/org/apache/ratis/RaftBasicTests.java | 13 ++++++------
 .../ratis/TestRaftServerSlownessDetection.java     |  2 +-
 8 files changed, 37 insertions(+), 43 deletions(-)

commit f36acabc58d6ed0146a9998150b5d7a038bdda7d
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Fri Oct 18 15:42:47 2019 +0530

    RATIS-717. NPE thrown on the follower while instantiating RaftLeaderMetrics. Contributed by Aravindan Vijayan.

 .../java/org/apache/ratis/server/impl/RaftLeaderMetrics.java  | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit d11320db65ce26b40994959c8a72c8f69556ad81
Author: Lokesh Jain <ljain@apache.org>
Date:   Thu Oct 17 23:56:07 2019 +0530

    RATIS-706. Dead lock in GrpcClientRpc. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/util/PeerProxyMap.java   | 47 ++++++++-----
 .../src/test/java/org/apache/ratis/BaseTest.java   | 16 ++++-
 .../org/apache/ratis/util/TestPeerProxyMap.java    | 80 ++++++++++++++++++++++
 3 files changed, 126 insertions(+), 17 deletions(-)

commit 9cbf1efaf0c58c4702caa724f2e602839386c607
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 17 19:31:38 2019 +0800

    RATIS-691. Fix checkstyle violations in ratis-logservice.  Contributed by Dinesh Chitlangia

 .../apache/ratis/logservice/api/LogMessage.java    |   2 +-
 .../org/apache/ratis/logservice/api/LogName.java   |   2 +-
 .../org/apache/ratis/logservice/api/LogStream.java |   2 +-
 .../ratis/logservice/client/LogServiceClient.java  |   8 +-
 .../apache/ratis/logservice/common/Constants.java  |   4 +-
 .../logservice/impl/ArchiveHdfsLogReader.java      |   3 -
 .../logservice/impl/ArchiveHdfsLogWriter.java      |   1 -
 .../logservice/impl/ArchivedLogStreamImpl.java     |  12 ++-
 .../logservice/impl/ExportedLogStreamImpl.java     |   2 +-
 .../ratis/logservice/impl/LogReaderImpl.java       |   4 +-
 .../ratis/logservice/impl/LogStreamImpl.java       |  16 ++--
 .../apache/ratis/logservice/server/LogServer.java  |   4 +-
 .../ratis/logservice/server/LogStateMachine.java   |  35 ++++---
 .../ratis/logservice/server/MetaStateMachine.java  |  68 ++++++--------
 .../ratis/logservice/server/MetadataServer.java    |   6 +-
 .../ratis/logservice/server/RaftLogReader.java     |  12 +--
 .../ratis/logservice/shell/CommandFactory.java     |   2 +-
 .../ratis/logservice/shell/LogServiceShell.java    |   4 +-
 .../logservice/shell/LogServiceShellOpts.java      |   6 +-
 .../ratis/logservice/tool/VerificationTool.java    | 104 ++++++++++++++-------
 .../ratis/logservice/util/LogServiceUtils.java     |   4 +-
 .../logservice/util/MetaServiceProtoUtil.java      |   7 +-
 .../ratis/logservice/server/TestMetaServer.java    |   4 +-
 23 files changed, 173 insertions(+), 139 deletions(-)

commit b9314825150cce323b092e31c90620dc757111e3
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 17 11:45:56 2019 +0800

    RATIS-702. Make metrics reporting implementation pluggable.  Contributed by Marton Elek

 pom.xml                                            |  7 --
 .../main/java/org/apache/ratis/util/FileUtils.java | 19 +++--
 .../ratis/examples/filestore/cli/Server.java       | 12 ++-
 .../ratis/grpc/metrics/GrpcServerMetrics.java      | 13 +--
 .../metrics/LogServiceMetricsRegistry.java         |  7 --
 ratis-metrics/pom.xml                              | 11 ++-
 .../java/org/apache/ratis/metrics/JVMMetrics.java  | 35 ++++----
 .../org/apache/ratis/metrics/MetricRegistries.java | 19 ++++-
 .../org/apache/ratis/metrics/MetricsReporting.java | 97 +++++-----------------
 .../ratis/metrics/impl/MetricRegistriesImpl.java   | 32 ++++++-
 .../metrics/impl/MetricRegistryFactoryImpl.java    |  5 +-
 .../metrics/impl/RatisMetricRegistryImpl.java      |  4 -
 .../ratis/metrics/TestHadoop2MetricsAdaptor.java   | 75 -----------------
 .../ratis/metrics/TestHadoop2MetricsSink.java      | 42 ----------
 .../ratis/server/impl/RaftLeaderMetrics.java       |  2 +-
 .../apache/ratis/server/metrics/RatisMetrics.java  | 20 +----
 .../ratis/statemachine/impl/BaseStateMachine.java  |  2 +-
 .../impl/SimpleStateMachineStorage.java            |  4 +-
 18 files changed, 120 insertions(+), 286 deletions(-)

commit 5bb587b2193848c45049bd6f7e836b699f42f81c
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 17 10:57:50 2019 +0800

    RATIS-716. RetryCache$CacheEntry$replyFuture holds onto RaftClientRequest until eviction.  Contributed by Lokesh Jain.

 .../java/org/apache/ratis/grpc/client/GrpcClientProtocolService.java   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 1053da1013638cee8b44d9ac6b0570c49cac50e7
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 16 06:54:05 2019 +0800

    RATIS-703. Intermittent ambiguous attempt(..) method in JavaUtils.  Contributed by Henrik Hegardt

 .../main/java/org/apache/ratis/util/JavaUtils.java | 28 +++++++---------------
 .../apache/ratis/server/impl/ServerImplUtils.java  |  2 +-
 .../ratis/InstallSnapshotNotificationTests.java    |  4 ++--
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  4 ++--
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  4 ++--
 .../java/org/apache/ratis/RetryCacheTests.java     |  2 +-
 .../ratis/server/impl/LeaderElectionTests.java     |  2 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |  6 ++---
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  4 ++--
 .../apache/ratis/server/ServerRestartTests.java    | 12 +++++-----
 10 files changed, 28 insertions(+), 40 deletions(-)

commit b49974df21a089dfd7b97db826fee409d384fcf3
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Oct 15 17:20:34 2019 +0800

    RATIS-707. Test failures caused by minTimeout set to zero.  Contributed by Siddharth Wagle

 .../main/java/org/apache/ratis/server/impl/RaftServerImpl.java | 10 +---------
 .../main/java/org/apache/ratis/server/impl/ServerState.java    |  1 -
 2 files changed, 1 insertion(+), 10 deletions(-)

commit 3f446aaf27704b0bf929bd39887637a6a71b4418
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Oct 11 16:35:38 2019 +0800

    RATIS-705. GrpcClientProtocolClient#close Interrupts itself.  Contributed by Lokesh Jain

 .../org/apache/ratis/util/TimeoutScheduler.java    |  9 +++--
 .../grpc/client/GrpcClientProtocolClient.java      |  2 +-
 .../org/apache/ratis/RaftAsyncExceptionTests.java  | 39 ++++++++++++++++++++++
 3 files changed, 47 insertions(+), 3 deletions(-)

commit 699792d56ca3828351b9e72cf983562eb8c11b21
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Thu Oct 10 14:55:11 2019 +0530

    RATIS-648. Add metrics related to GrpcLogAppendRequests. Contributed by Siddharth Wagle.

 ratis-grpc/pom.xml                                 |  13 ++-
 .../ratis/grpc/metrics/GrpcServerMetrics.java      |  92 ++++++++++++++++++
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  74 +++++++++++----
 .../ratis/grpc/server/TestGrpcServerMetrics.java   | 105 +++++++++++++++++++++
 .../apache/ratis/server/impl/RaftServerImpl.java   |   9 ++
 .../ratis/server/metrics/RatisMetricNames.java     |   1 +
 .../apache/ratis/server/metrics/RatisMetrics.java  |   6 ++
 .../server/metrics/TestLeaderElectionMetrics.java  |   2 -
 8 files changed, 279 insertions(+), 23 deletions(-)

commit 004ac670fea8cc6798b8c7d7631050382f8d0d76
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 9 17:07:58 2019 +0800

    RATIS-698. RaftServerImpl should not enforce minTimeout before first leaderElection cycle.

 .../java/org/apache/ratis/server/impl/RaftServerImpl.java     | 11 +++++++++--
 .../main/java/org/apache/ratis/server/impl/ServerState.java   |  1 +
 .../apache/ratis/statemachine/SimpleStateMachine4Testing.java |  5 +++--
 3 files changed, 13 insertions(+), 4 deletions(-)

commit 89abd1399a3413555f85cdda541587f824ac0200
Author: Josh Elser <elserj@apache.org>
Date:   Mon Oct 7 16:51:08 2019 -0400

    Revert "RATIS-672. Vagrant test's Maven 404's"
    
    This reverts commit 2d487ae51552ac7417c59882c9ed4011db03249a.

 dev-support/binary_locations.sh | 32 --------------------------------
 dev-support/ci/common.sh        |  2 --
 dev-support/docker/Dockerfile   | 28 +++++++---------------------
 dev-support/vagrant/Vagrantfile | 31 ++++++-------------------------
 start-build-env.sh              |  7 +------
 5 files changed, 14 insertions(+), 86 deletions(-)

commit 63cd2fb981933aba137ba39bfc07e389166f5863
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Fri Oct 4 23:28:15 2019 +0530

    RATIS-650. Add metrics to track commit index of each peer in a RaftGroup. Contributed by Supratim Deka.

 .../org/apache/ratis/server/impl/LeaderState.java  |  25 ++--
 .../org/apache/ratis/server/impl/LogAppender.java  |   2 +-
 .../ratis/server/impl/RaftLeaderMetrics.java       | 126 +++++++++++++++++++++
 .../apache/ratis/server/impl/RaftServerImpl.java   |   8 ++
 .../ratis/server/metrics/HeartbeatMetrics.java     |  63 -----------
 .../ratis/server/metrics/RatisMetricNames.java     |   6 +-
 .../apache/ratis/server/metrics/RatisMetrics.java  |  11 +-
 .../java/org/apache/ratis/LogAppenderTests.java    |  10 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java |  27 ++++-
 .../ratis/TestRaftServerSlownessDetection.java     |  10 +-
 10 files changed, 197 insertions(+), 91 deletions(-)

commit 2d487ae51552ac7417c59882c9ed4011db03249a
Author: Clay Baenziger <cwb@clayb.net>
Date:   Tue Oct 1 20:43:15 2019 -0700

    RATIS-672. Vagrant test's Maven 404's
    
    Trying to get Clay's patch working -- call out to binary_locations.sh
    before launching Yetus to build the docker image.
    
    Re-application after revert. Needed to make sure binary_locations.sh
    is invoked before building Docker so that PreCommit doesn't fail.
    
    Signed-off-by: Josh Elser <elserj@apache.org>
    Co-authored-by: Josh Elser <elserj@apache.org>

 dev-support/binary_locations.sh | 32 ++++++++++++++++++++++++++++++++
 dev-support/ci/common.sh        |  2 ++
 dev-support/docker/Dockerfile   | 28 +++++++++++++++++++++-------
 dev-support/vagrant/Vagrantfile | 31 +++++++++++++++++++++++++------
 start-build-env.sh              |  7 ++++++-
 5 files changed, 86 insertions(+), 14 deletions(-)

commit 5b6edb9adbdd2c62dad3a9992a5ac96dfe110d68
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 3 12:01:33 2019 +0800

    RATIS-693. Combine notifyLeader and notifyLeaderChanged calls on StateMachine.  Contributed by Siddharth Wagle

 .../main/java/org/apache/ratis/server/impl/LeaderState.java   |  1 -
 .../main/java/org/apache/ratis/server/impl/ServerState.java   |  2 +-
 .../main/java/org/apache/ratis/statemachine/StateMachine.java | 11 +++--------
 .../apache/ratis/statemachine/SimpleStateMachine4Testing.java | 10 +++++++---
 4 files changed, 11 insertions(+), 13 deletions(-)

commit ecef287d0e23650e91a024f777d253653c2ba630
Author: Josh Elser <elserj@apache.org>
Date:   Tue Oct 1 08:03:10 2019 -0700

    Revert "RATIS-672. Vagrant test's Maven 404's"
    
    Appears to have broken building the docker image under CI. Reverting to
    investigate.
    
    This reverts commit 5dd466a04595a7b8223a2c97f52193cec9c1b538.

 dev-support/binary_locations.sh | 32 --------------------------------
 dev-support/docker/Dockerfile   | 28 +++++++---------------------
 dev-support/vagrant/Vagrantfile | 31 ++++++-------------------------
 start-build-env.sh              |  7 +------
 4 files changed, 14 insertions(+), 84 deletions(-)

commit 5dd466a04595a7b8223a2c97f52193cec9c1b538
Author: Clay Baenziger <cwb@clayb.net>
Date:   Tue Sep 3 18:19:30 2019 -0400

    RATIS-672. Vagrant test's Maven 404's
    
    Fix-up for Docker and Vagrant to share dependencies and check checksums
    
    Closes #34
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 dev-support/binary_locations.sh | 32 ++++++++++++++++++++++++++++++++
 dev-support/docker/Dockerfile   | 28 +++++++++++++++++++++-------
 dev-support/vagrant/Vagrantfile | 31 +++++++++++++++++++++++++------
 start-build-env.sh              |  7 ++++++-
 4 files changed, 84 insertions(+), 14 deletions(-)

commit fb56bcbe7e058619458ad8bc7fc5cde3f3b8ffec
Author: Lokesh Jain <ljain@apache.org>
Date:   Mon Sep 30 16:39:17 2019 +0530

    RATIS-679. Add counters for append entries and number of times raft log is flushed.

 .../ratis/server/metrics/RaftLogMetrics.java       | 24 +++++++++-----------
 .../ratis/server/metrics/RatisMetricNames.java     |  6 +++++
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |  2 ++
 .../ratis/server/raftlog/TestRaftLogMetrics.java   | 26 ++++++++++++----------
 4 files changed, 32 insertions(+), 26 deletions(-)

commit 201fc850274896588e8da14fe0f939263bc80495
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Sep 30 08:38:25 2019 +0530

    RATIS-690. RaftClient should reconnect and change leader on TimeoutIOException, AlreadyClosedException. Contributed by Lokesh Jain.

 .../src/main/java/org/apache/ratis/client/impl/RaftClientImpl.java    | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit cff085c4ff7ad49dd65f8e77549494584b3ebc51
Author: Lokesh Jain <ljain@apache.org>
Date:   Fri Sep 27 21:05:01 2019 +0530

    RATIS-647. Create metrics associated with RaftLog for RaftServer. Contributed by Aravindan Vijayan.

 .../ratis/server/metrics/RaftLogMetrics.java       | 115 +++++++++++++++++++++
 .../ratis/server/metrics/RatisMetricNames.java     |  59 ++++++++++-
 .../apache/ratis/server/metrics/RatisMetrics.java  |  29 +++---
 .../ratis/server/raftlog/segmented/LogSegment.java |  42 +++++---
 .../server/raftlog/segmented/SegmentedRaftLog.java |  28 ++++-
 .../raftlog/segmented/SegmentedRaftLogCache.java   |  12 ++-
 .../segmented/SegmentedRaftLogInputStream.java     |  12 ++-
 .../raftlog/segmented/SegmentedRaftLogReader.java  |  15 ++-
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |  43 ++++----
 .../java/org/apache/ratis/LogAppenderTests.java    |   2 +-
 .../ratis/server/storage/RaftStorageTestUtils.java |   8 +-
 .../ratis/TestRaftServerSlownessDetection.java     |   2 +-
 .../ratis/server/raftlog/TestRaftLogMetrics.java   |  58 ++++++++++-
 .../raftlog/segmented/TestCacheEviction.java       |   2 +-
 .../server/raftlog/segmented/TestLogSegment.java   |  34 ++++--
 .../raftlog/segmented/TestSegmentedRaftLog.java    |  13 +++
 .../segmented/TestSegmentedRaftLogCache.java       |   2 +-
 17 files changed, 402 insertions(+), 74 deletions(-)

commit af8a5bcd3c58b3a263ec6cf836633f839905aa6d
Author: Lokesh Jain <ljain@apache.org>
Date:   Fri Sep 27 15:23:00 2019 +0530

    RATIS-678. Notify Leader does not provide raft group id. Contributed by Siddharth Wagle.

 .../src/main/java/org/apache/ratis/server/impl/LeaderState.java  | 2 +-
 .../src/main/java/org/apache/ratis/server/impl/ServerState.java  | 1 +
 .../main/java/org/apache/ratis/statemachine/StateMachine.java    | 9 ++++++++-
 .../apache/ratis/statemachine/SimpleStateMachine4Testing.java    | 2 +-
 4 files changed, 11 insertions(+), 3 deletions(-)

commit c564743fff6271b6d3a827997b72f3bb5be64b04
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Sep 23 13:57:40 2019 -0700

    RATIS-677. Log entry marked corrupt due to ChecksumException.

 .../apache/ratis/server/RaftServerConfigKeys.java  | 28 +++++++++
 .../org/apache/ratis/server/impl/ServerState.java  |  3 +-
 .../ratis/server/raftlog/segmented/LogSegment.java | 38 ++++++++----
 .../raftlog/segmented/SegmentedRaftLogReader.java  |  6 +-
 .../apache/ratis/server/storage/RaftStorage.java   | 14 ++++-
 .../apache/ratis/server/ServerRestartTests.java    | 70 ++++++++++++++++++++++
 .../raftlog/segmented/TestSegmentedRaftLog.java    |  4 ++
 .../ratis/server/storage/TestRaftStorage.java      |  7 +--
 8 files changed, 149 insertions(+), 21 deletions(-)

commit 1b2fcd9ce2447cffbe657ddf444dd943f9a085b8
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Sep 19 11:41:19 2019 -0700

    RATIS-681. Fix non-standard field names in config keys.

 .../main/java/org/apache/ratis/conf/ConfUtils.java | 50 ++++++++++++++------
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java | 26 +++++------
 .../apache/ratis/server/RaftServerConfigKeys.java  | 19 ++++----
 .../ratis/server/impl/StateMachineUpdater.java     |  2 +-
 .../java/org/apache/ratis/conf/TestConfUtils.java  | 53 ++++++++++++++++++++++
 5 files changed, 112 insertions(+), 38 deletions(-)

commit ac158584b7c094254d3276b0e130e7cb39a251b1
Merge: 0b70002b 950962dc
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Sep 19 10:15:39 2019 +0530

    Merge commit '950962dc917f5d7ba00ed0f5b73c86c566bf6972'

commit 950962dc917f5d7ba00ed0f5b73c86c566bf6972
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Sep 19 10:14:40 2019 +0530

    Switch to 0.5.0-SNAPSHOT after the 0.4.0 release

 pom.xml                       | 2 +-
 ratis-assembly/pom.xml        | 2 +-
 ratis-client/pom.xml          | 2 +-
 ratis-common/pom.xml          | 2 +-
 ratis-examples/pom.xml        | 2 +-
 ratis-grpc/pom.xml            | 2 +-
 ratis-hadoop/pom.xml          | 2 +-
 ratis-logservice/pom.xml      | 2 +-
 ratis-metrics/pom.xml         | 2 +-
 ratis-netty/pom.xml           | 2 +-
 ratis-proto/pom.xml           | 2 +-
 ratis-replicated-map/pom.xml  | 2 +-
 ratis-resource-bundle/pom.xml | 2 +-
 ratis-server/pom.xml          | 2 +-
 ratis-test/pom.xml            | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit 126db115902a1b4aeb7921ff1002045eedc7c4b7
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Sep 19 10:13:09 2019 +0530

    Change version for the version 0.4.0-rc4

 pom.xml                       | 2 +-
 ratis-assembly/pom.xml        | 2 +-
 ratis-client/pom.xml          | 2 +-
 ratis-common/pom.xml          | 2 +-
 ratis-examples/pom.xml        | 2 +-
 ratis-grpc/pom.xml            | 2 +-
 ratis-hadoop/pom.xml          | 2 +-
 ratis-logservice/pom.xml      | 2 +-
 ratis-metrics/pom.xml         | 2 +-
 ratis-netty/pom.xml           | 2 +-
 ratis-proto/pom.xml           | 2 +-
 ratis-replicated-map/pom.xml  | 2 +-
 ratis-resource-bundle/pom.xml | 2 +-
 ratis-server/pom.xml          | 2 +-
 ratis-test/pom.xml            | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit 0b70002bddae994f63f8d2a068b86474c361619e
Author: Lokesh Jain <ljain@apache.org>
Date:   Wed Sep 18 23:36:31 2019 +0530

    RATIS-684. Yetus build fails due to unreachable maven url. Contributed by Lokesh Jain.

 dev-support/docker/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c9308f64d14c49d4edd9eb116853de7c46794ed9
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Sep 17 12:43:13 2019 -0700

    RATIS-655. Change LeaderState and FollowerState and to use RaftGroupMemberId.

 .../apache/ratis/server/impl/FollowerState.java    | 22 ++++----
 .../apache/ratis/server/impl/LeaderElection.java   | 18 +++----
 .../org/apache/ratis/server/impl/LeaderState.java  | 61 ++++++++++++++--------
 .../apache/ratis/server/impl/PendingRequests.java  |  4 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 12 ++---
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  4 +-
 6 files changed, 68 insertions(+), 53 deletions(-)

commit c8f2c7a2f1c9de71b38d837d5b010793c53ce51b
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Mon Sep 16 15:31:30 2019 +0530

    RATIS-670. Add a metric to track StateMachine Log apply index. Contributed by Supratim Deka.

 .../ratis/server/impl/StateMachineMetrics.java     | 57 ++++++++++++++++++++++
 .../ratis/server/impl/StateMachineUpdater.java     | 11 +++++
 .../ratis/server/metrics/RatisMetricNames.java     |  4 ++
 .../apache/ratis/server/metrics/RatisMetrics.java  |  7 +++
 .../ratis/statemachine/impl/BaseStateMachine.java  |  9 ++++
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  6 +++
 .../test/java/org/apache/ratis/RaftBasicTests.java | 55 +++++++++++++++++++++
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  6 +++
 8 files changed, 155 insertions(+)

commit be9a98457c07bd729e5598aa61632f24a7372c54
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Sat Sep 14 10:20:30 2019 +0530

    RATIS-569. StatusRuntimeException because Ratis clients do not shutdown the observer cleanly. Contributed by Siddharth Wagle.

 .../apache/ratis/grpc/client/GrpcClientProtocolClient.java    |  8 +++++++-
 .../apache/ratis/grpc/server/GrpcServerProtocolClient.java    | 11 ++++++++++-
 2 files changed, 17 insertions(+), 2 deletions(-)

commit 67ba9cd875f72705d4177e72db7bc8df5539a91c
Author: Mukul Kumar Singh <mukul@cloudera.com>
Date:   Thu Sep 12 15:18:20 2019 +0530

    RATIS-668. Fix NOTICE file. Contributed by Arpit Agarwal.

 NOTICE                                   | 19 +++++++++++--------
 ratis-assembly/src/main/resources/NOTICE | 15 ---------------
 2 files changed, 11 insertions(+), 23 deletions(-)

commit 1ceeb2990a782c65bc920abe700740a7c95626f7
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Sep 10 14:34:49 2019 +0530

    RATIS-543. Ratis GRPC client produces excessive logging while writing data. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/grpc/client/GrpcClientProtocolClient.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 73f906ce93ed7e8e0ff4572ddd31abcaf35b3832
Merge: 741d8bd4 0f25304f
Author: Jitendra Nath Pandey <jitendra@hortonworks.com>
Date:   Sun Sep 8 20:53:39 2019 -0700

    Merge pull request #35 from joshelser/674-services
    
    RATIS-674 Correct the service loader entry for MetricRegistries

commit 0f25304fee7aed4d2841dff344bf8d3f5d5da48c
Author: Josh Elser <elserj@apache.org>
Date:   Fri Sep 6 17:47:00 2019 -0400

    RATIS-674. Correct the service loader entry for MetricRegistries

 ...metrics.MetricRegistries => org.apache.ratis.metrics.MetricRegistries} | 0
 1 file changed, 0 insertions(+), 0 deletions(-)

commit 741d8bd4fbb1c9642dd054e72cae0c7afb180170
Author: Rajeshbabu Chintaguntla <Rajeshbabu Chintaguntla>
Date:   Thu Sep 5 10:28:55 2019 +0530

    RATIS-556 Detect node failures and close the log to prevent additional writes(Rajeshbabu)

 .../apache/ratis/logservice/common/Constants.java  |   8 ++
 .../apache/ratis/logservice/server/LogServer.java  |  40 ++++++
 .../ratis/logservice/server/LogStateMachine.java   |  16 ++-
 .../ratis/logservice/server/MetaStateMachine.java  | 138 ++++++++++++++++++---
 .../ratis/logservice/server/MetadataServer.java    |  13 +-
 .../ratis/logservice/util/LogServiceProtoUtil.java |   2 +-
 .../logservice/util/MetaServiceProtoUtil.java      |  11 +-
 ratis-logservice/src/main/proto/LogService.proto   |   1 +
 ratis-logservice/src/main/proto/MetaService.proto  |   9 +-
 .../ratis/logservice/server/TestMetaServer.java    |  40 +++++-
 10 files changed, 244 insertions(+), 34 deletions(-)

commit 78e95b9b079e84908ca3f5506d71b2aefa227990
Author: Tsz-Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Aug 30 14:22:31 2019 -0700

    RATIS-485. TimeoutScheduler is leaked by gRPC client implementation.  Contributed by Tsz Wo Nicholas Sze and Josh Elser

 .../apache/ratis/client/RaftClientConfigKeys.java  | 10 ---
 .../apache/ratis/client/impl/RaftClientImpl.java   |  8 +--
 .../ratis/client/impl/RaftClientTestUtil.java      |  4 --
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  5 +-
 .../org/apache/ratis/util/TimeoutScheduler.java    | 80 ++++++++++++++++++----
 .../ratis/examples/filestore/cli/Client.java       |  1 -
 .../grpc/client/GrpcClientProtocolClient.java      |  3 +-
 .../apache/ratis/server/impl/WatchRequests.java    |  2 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  5 --
 .../apache/ratis/util/TestTimeoutScheduler.java    | 33 ++++++++-
 10 files changed, 104 insertions(+), 47 deletions(-)

commit 48239a7a2df06af3c3b4fb61932b83a8c205d7fd
Author: Tsz-Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Aug 30 14:04:29 2019 -0700

    RATIS-659. StateMachineUpdater#stopAndJoin might not take snapshot due to race condition.  Contributed by Lokesh Jain

 .../ratis/server/impl/StateMachineUpdater.java     | 26 +++++++++++++---------
 1 file changed, 16 insertions(+), 10 deletions(-)

commit 0793e9b513ff7393c197b1c13e15d22205495edd
Author: Tsz-Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Aug 30 12:58:06 2019 -0700

    RATIS-661. Add call in state machine to handle group removal.  Contributed by Lokesh Jain

 .../main/java/org/apache/ratis/server/impl/RaftServerProxy.java   | 1 +
 .../src/main/java/org/apache/ratis/statemachine/StateMachine.java | 8 ++++++++
 2 files changed, 9 insertions(+)

commit 2386b1abb7eaff0b8ac081e0ac70480d4e9d15bc
Author: Xiaoyu Yao <xyao@apache.org>
Date:   Wed Aug 28 19:38:58 2019 -0700

    RATIS-669. Allow Ratis gRPCTlsConfig to take Java Key/Cert Object in addition to File. Contributed by Xiaoyu Yao. (#33)

 .../java/org/apache/ratis/grpc/GrpcTlsConfig.java  | 52 ++++++++++++++++------
 .../grpc/client/GrpcClientProtocolClient.java      | 16 +++++--
 .../grpc/server/GrpcServerProtocolClient.java      | 13 ++++--
 .../org/apache/ratis/grpc/server/GrpcService.java  | 13 ++++--
 4 files changed, 71 insertions(+), 23 deletions(-)

commit 30bafb7a7fc91febfc3bf5b08a97f06d7f4ef810
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Wed Aug 28 10:30:30 2019 +0530

    RATIS-651. Add metrics related to leaderElection and HeartBeat. Contributed by  Aravindan Vijayan.

 .../apache/ratis/server/impl/FollowerState.java    |  1 +
 .../apache/ratis/server/impl/LeaderElection.java   |  3 +
 .../org/apache/ratis/server/impl/LeaderState.java  | 19 ++++-
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +
 .../apache/ratis/server/impl/RaftServerImpl.java   |  9 +++
 .../org/apache/ratis/server/impl/ServerState.java  |  2 +-
 .../ratis/server/metrics/HeartbeatMetrics.java     | 63 +++++++++++++++
 .../server/metrics/LeaderElectionMetrics.java      | 58 ++++++++++++++
 .../ratis/server/metrics/RatisMetricNames.java     | 33 ++++++++
 .../apache/ratis/server/metrics/RatisMetrics.java  | 15 ++++
 .../java/org/apache/ratis/LogAppenderTests.java    | 51 +++++++++++++
 .../ratis/server/impl/LeaderElectionTests.java     | 31 ++++++++
 .../server/metrics/TestLeaderElectionMetrics.java  | 89 ++++++++++++++++++++++
 .../ratis/TestRaftServerSlownessDetection.java     | 21 ++++-
 14 files changed, 393 insertions(+), 4 deletions(-)

commit 021165f2142bc1d1a0351b3cddf724272541d720
Author: Clay Baenziger <cwb@clayb.net>
Date:   Sun Jul 21 18:00:42 2019 -0400

    RATIS-629. Vagrant loadgen does not run
    
    Closes #29
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 dev-support/vagrant/bin/start_ratis_load_gen.sh | 4 ++--
 dev-support/vagrant/bin/start_ratis_server.sh   | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit f401c7a3d21ba2ce6fc735891ae9e22ea5628c8d
Author: Arpit Agarwal <arp@apache.org>
Date:   Fri Aug 16 10:59:02 2019 -0700

    RATIS-658. ratis-assembly does not include ratis-resource-bundle. Contributed by Mukul Kumar Singh.

 ratis-assembly/src/main/assembly/src.xml | 1 +
 1 file changed, 1 insertion(+)

commit 2739b4e42399b6a47f79c7b4bc7b23ca77702896
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Aug 12 13:42:50 2019 -0700

    RATIS-654. Fix generation LICENSE and NOTICE for third-party dependencies.  Contributed by Ankit Singhal

 pom.xml                                            |   69 +-
 ratis-assembly/pom.xml                             |   66 +-
 ratis-assembly/src/main/assembly/bin.xml           |   27 +-
 ratis-assembly/src/main/assembly/examples-bin.xml  |   86 +
 ratis-assembly/src/main/resources/NOTICE           |   24 +
 ratis-metrics/pom.xml                              |    6 +
 ratis-resource-bundle/pom.xml                      |   69 +
 .../src/main/resources/META-INF/LICENSE.vm         | 2608 +++++++++++++++++
 .../src/main/resources/META-INF/NOTICE.vm          |  372 +++
 .../src/main/resources/supplemental-models.xml     | 3095 ++++++++++++++++++++
 10 files changed, 6393 insertions(+), 29 deletions(-)

commit 4c11031456493bcc544a8157c7dc2616941245db
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Aug 7 10:59:11 2019 -0700

    RATIS-609. Change RaftLog to use RaftGroupMemberId.

 .../ratis/protocol/StateMachineException.java      |   5 -
 .../apache/ratis/server/impl/RaftServerImpl.java   |   8 +-
 .../org/apache/ratis/server/impl/ServerState.java  |  15 +--
 .../org/apache/ratis/server/raftlog/RaftLog.java   |  38 ++++----
 .../ratis/server/raftlog/memory/MemoryRaftLog.java |   8 +-
 .../server/raftlog/segmented/SegmentedRaftLog.java | 107 +++++++++++++++------
 .../raftlog/segmented/SegmentedRaftLogCache.java   |  10 +-
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |   9 +-
 .../apache/ratis/server/ServerRestartTests.java    |   2 +-
 .../raftlog/segmented/TestCacheEviction.java       |   9 +-
 .../raftlog/segmented/TestSegmentedRaftLog.java    |  50 +++++-----
 11 files changed, 149 insertions(+), 112 deletions(-)

commit 7ef5115318ba05a5263377a19edfd11c43f34316
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Sat Aug 3 19:18:07 2019 +0530

    RATIS-642. Bump the copyright year of the NOTICE.txt. Contributed by Mukul Kumar Singh.

 NOTICE                                   | 2 +-
 ratis-assembly/src/main/resources/NOTICE | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 499f1d83707a88482c9e1341dd841200cc7e7d88
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Aug 2 12:56:10 2019 -0700

    RATIS-578. Illegal State transition in LeaderElection.

 .../apache/ratis/server/impl/LeaderElection.java   | 10 ++--
 .../impl/RaftStateMachineExceptionTests.java       | 53 ++++++++++------------
 2 files changed, 27 insertions(+), 36 deletions(-)

commit 81644ccf3b29524a6139d47a6f0ae035c15efd9f
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Wed Jul 31 14:41:05 2019 +0530

    RATIS-643. Allow Ratis to take a configurable snapshot retention policy. Contributed by Aravindan Vijayan.

 .../apache/ratis/server/RaftServerConfigKeys.java  | 10 +++
 .../ratis/server/impl/StateMachineUpdater.java     | 10 +++
 .../ratis/statemachine/StateMachineStorage.java    |  2 +
 .../ratis/statemachine/impl/BaseStateMachine.java  |  4 ++
 .../impl/SimpleStateMachineStorage.java            | 49 +++++++++++++-
 .../statemachine/impl/SnapshotRetentionPolicy.java | 36 +++++++++++
 .../ratis/server/storage/TestRaftStorage.java      | 75 ++++++++++++++++++++++
 7 files changed, 185 insertions(+), 1 deletion(-)

commit 5dc4e717c8540b275cc2af33ab100c2a6ec21fc2
Author: Márton Elek <elek@apache.org>
Date:   Mon Jul 29 09:21:52 2019 +0200

    RATIS-642. Bump the copyright year of the NOTICE.txt. Contributed by Mukul Kumar Singh.

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 08aa862d00ad5dd9ecc5a39ee4899358b6f12a55
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Fri Jul 26 21:23:47 2019 +0530

    RATIS-606. GrpcService should use SO_REUSEADDR flag. Contributed by Mukul Kumar Singh.

 ratis-grpc/src/main/java/org/apache/ratis/grpc/server/GrpcService.java | 2 ++
 1 file changed, 2 insertions(+)

commit 96351eb9e32bb5bb25dac0446854e5f45a308f15
Author: Lokesh Jain <ljain@apache.org>
Date:   Fri Jul 26 17:54:20 2019 +0530

    RATIS-628. Simplify the code in LogSegment. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/server/raftlog/segmented/LogSegment.java | 114 ++++++---------------
 .../server/raftlog/segmented/SegmentedRaftLog.java |  17 ++-
 .../server/raftlog/segmented/TestLogSegment.java   |  30 ++----
 .../segmented/TestSegmentedRaftLogCache.java       |   7 +-
 4 files changed, 51 insertions(+), 117 deletions(-)

commit d0edef3b9eeed61ab8f1aea8ceb0aa01e258179a
Author: Elek, Márton <elek@users.noreply.github.com>
Date:   Fri Jul 26 03:49:46 2019 +0200

    RATIS-621. Metrics subproject is not included in the release tar. Contributed by Marton Elek. (#27)

 ratis-assembly/src/main/assembly/bin.xml | 1 +
 ratis-assembly/src/main/assembly/src.xml | 1 +
 2 files changed, 2 insertions(+)

commit 7c7cd28879291a53da955c2827bda5b0f93bb46f
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jul 22 13:59:46 2019 -0700

    RATIS-596. Rename raft.server.leader.election.timeout.

 .../apache/ratis/server/RaftServerConfigKeys.java  | 28 ++++++++++++----------
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../org/apache/ratis/server/impl/ServerState.java  | 14 ++++++-----
 ...out.java => TestRaftServerNoLeaderTimeout.java} | 22 ++++++++---------
 4 files changed, 35 insertions(+), 31 deletions(-)

commit d4f5c9ded9ea4dc1a8acbec9a5e24f5e2f3bc6b6
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jul 19 14:28:27 2019 -0700

    RATIS-626. Add missing license in TestArchiveHdfsLogReaderAndWriter.  Contributed by Ankit Singhal

 .../impl/TestArchiveHdfsLogReaderAndWriter.java         | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

commit 2f126074ce79af1b584931a934c4b266057eacc6
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Jul 18 14:09:38 2019 -0700

    RATIS-625. LogSegment#append leaks entryCache when the entries are loaded on a restart.  Contributed by Mukul Kumar Singh

 .../java/org/apache/ratis/server/raftlog/segmented/LogSegment.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 0ddf4ba5bf0ff8a0b0404e121f6fed6fe2dfc6ca
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Jul 18 10:58:49 2019 -0700

    RATIS-611. Add a test for InstallSnapshotNotification with follower restart.

 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  66 +++++----
 .../grpc/server/GrpcServerProtocolService.java     | 164 +++++++++++++++------
 .../org/apache/ratis/server/impl/FollowerInfo.java |   7 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  38 ++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |  10 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |   8 +-
 .../ratis/server/protocol/RaftServerProtocol.java  |   3 +-
 .../ratis/InstallSnapshotNotificationTests.java    | 130 ++++++++++------
 .../java/org/apache/ratis/MiniRaftCluster.java     |  12 +-
 .../impl/RaftStateMachineExceptionTests.java       |   2 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   2 +-
 .../TestInstallSnapshotNotificationWithGrpc.java   |  25 ++++
 .../grpc/TestRaftReconfigurationWithGrpc.java      |   8 +-
 13 files changed, 310 insertions(+), 165 deletions(-)

commit c2a6a24a9ff85cc24132f5d5db40391bd36fbe70
Author: Ankit Singhal <asinghal@cloudera.com>
Date:   Wed Jun 12 10:57:50 2019 -0700

    RATIS-588 LogStream StateMachine export
    
    Closes #25
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 ratis-logservice/pom.xml                           |  39 +++
 .../ratis/logservice/api/ArchiveLogReader.java     |  27 ++
 .../ratis/logservice/api/ArchiveLogWriter.java     |  45 +++
 .../org/apache/ratis/logservice/api/LogReader.java |   4 +-
 .../org/apache/ratis/logservice/api/LogStream.java |  24 +-
 .../ratis/logservice/client/LogServiceClient.java  | 120 ++++++-
 .../apache/ratis/logservice/common/Constants.java  |   1 +
 .../logservice/impl/ArchiveHdfsLogReader.java      | 215 ++++++++++++
 .../logservice/impl/ArchiveHdfsLogWriter.java      | 112 +++++++
 .../logservice/impl/ArchivedLogStreamImpl.java     | 138 ++++++++
 .../logservice/impl/ExportedLogStreamImpl.java     |  35 ++
 .../ratis/logservice/impl/LogStreamImpl.java       |  12 +-
 .../ratis/logservice/server/ArchivalInfo.java      |  95 ++++++
 .../apache/ratis/logservice/server/LogServer.java  |   6 +-
 .../logservice/server/LogServiceRaftLogReader.java |  14 +-
 .../ratis/logservice/server/LogStateMachine.java   | 369 +++++++++++++++++++--
 .../ratis/logservice/server/MetaStateMachine.java  |  16 +-
 .../ratis/logservice/server/RaftLogReader.java     |  51 +++
 .../ratis/logservice/shell/CommandFactory.java     |   4 +
 .../shell/commands/ArchiveLogCommand.java          |  47 +++
 .../shell/commands/ExportLogCommand.java           |  49 +++
 .../ratis/logservice/util/LogServiceProtoUtil.java |  61 +++-
 .../ratis/logservice/util/LogServiceUtils.java     |  20 ++
 .../logservice/util/MetaServiceProtoUtil.java      |   9 -
 ratis-logservice/src/main/proto/LogService.proto   |  44 ++-
 ratis-logservice/src/main/proto/MetaService.proto  |   8 -
 .../ratis/logservice/LogServiceReadWriteBase.java  |   7 +-
 .../impl/TestArchiveHdfsLogReaderAndWriter.java    | 153 +++++++++
 .../ratis/logservice/server/TestMetaServer.java    | 100 +++++-
 .../logservice/util/TestLogServiceProtoUtil.java   |   7 +-
 ratis-logservice/src/test/resources/logservice.xml |  28 ++
 .../ratis/statemachine/impl/BaseStateMachine.java  |   4 +-
 32 files changed, 1747 insertions(+), 117 deletions(-)

commit 74da30734d08b49946e84779b7485427a33620d7
Author: Rajeshbabu Chintaguntla <Rajeshbabu Chintaguntla>
Date:   Wed Jul 17 17:42:42 2019 +0530

    RATIS-541 Add option to verify correctness of batch and mix of batch and single updates data from LogService in VerficiationTool(Rajeshbabu)

 .../ratis/logservice/tool/VerificationTool.java    | 126 ++++++++++++++++++---
 1 file changed, 113 insertions(+), 13 deletions(-)

commit 0d11cd47e8b63108e2c3987c23407cd4d4e24da1
Author: Ankit Singhal <asinghal@cloudera.com>
Date:   Mon Jun 17 15:29:03 2019 -0700

    RATIS-594 RATIS-593 RATIS-551 Add HadoopMetrics2Adaptor for dropwizard metrics and Graphite container for log service
    
    Closes #26
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 LICENSE                                            |  23 +++++
 NOTICE                                             |  22 +++++
 pom.xml                                            |  26 ++++-
 ratis-logservice/docker-compose.yml                |  12 +++
 ratis-logservice/src/assembly/assembly.xml         |   1 +
 .../metrics/LogServiceMetricsRegistry.java         |  49 +++++----
 .../ratis/logservice/server/LogStateMachine.java   |   6 +-
 .../ratis/logservice/server/MetaStateMachine.java  |   6 +-
 .../ratis/logservice/LogServiceReadWriteBase.java  |   6 +-
 .../ratis/logservice/server/TestMetaServer.java    |  23 +++--
 .../src/test/resources/hadoop-metrics2.properties  |  56 +++++++++++
 ratis-metrics/pom.xml                              |  12 +++
 .../java/org/apache/ratis/metrics/JVMMetrics.java  |  46 +++++++++
 .../org/apache/ratis/metrics/MetricRegistries.java |   3 -
 .../ratis/metrics/MetricRegistryFactory.java       |   3 -
 .../apache/ratis/metrics/MetricRegistryInfo.java   |  45 ++++++---
 .../org/apache/ratis/metrics/MetricsReporting.java | 109 +++++++++++++++++++++
 .../apache/ratis/metrics/RatisMetricRegistry.java  |  61 ++++++++++++
 .../ratis/metrics/impl/MetricRegistriesImpl.java   |   2 +-
 .../metrics/impl/MetricRegistryFactoryImpl.java    |   4 +-
 ...cRegistry.java => RatisMetricRegistryImpl.java} |  48 ++++++---
 .../ratis/metrics/TestHadoop2MetricsAdaptor.java   |  75 ++++++++++++++
 .../ratis/metrics/TestHadoop2MetricsSink.java      |  42 ++++++++
 .../src/test/resources/hadoop-metrics2.properties  |  44 +++++++++
 .../apache/ratis/server/metrics/RatisMetrics.java  |  30 ++++--
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |   3 +-
 .../ratis/server/storage/RaftStorageTestUtils.java |   3 +-
 .../ratis/server/raftlog/TestRaftLogMetrics.java   |   2 +-
 28 files changed, 671 insertions(+), 91 deletions(-)

commit eb3feb5af57a13173be58b9ba18c382ce4a5da5b
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jul 5 15:47:15 2019 +0800

    RATIS-605. Change RaftServerImpl and proto to use RaftGroupMemberId.

 .../apache/ratis/client/impl/ClientProtoUtils.java |  29 ++---
 .../ratis/protocol/LeaderNotReadyException.java    |  14 +-
 .../apache/ratis/protocol/NotLeaderException.java  |   5 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |   7 +
 .../ratis/protocol/StateMachineException.java      |   7 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |  16 +++
 ratis-proto/src/main/proto/Raft.proto              |   7 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   6 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 144 ++++++++++-----------
 .../org/apache/ratis/server/impl/RoleInfo.java     |   2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  34 ++---
 .../org/apache/ratis/server/impl/ServerState.java  |  41 +++---
 .../ratis/server/impl/StateMachineUpdater.java     |   6 +-
 .../raftlog/segmented/TestSegmentedRaftLog.java    |   4 +
 14 files changed, 163 insertions(+), 159 deletions(-)

commit b5b0ff2d1eed13045c069239ceb5f676e21736e8
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Jul 3 13:11:13 2019 +0800

    RATIS-600. Better logging for installSnapshot.

 .../apache/ratis/protocol/RaftGroupMemberId.java   | 71 +++++++++++++++++
 .../apache/ratis/server/impl/RaftServerImpl.java   | 88 ++++++++++++----------
 .../apache/ratis/server/impl/ServerProtoUtils.java | 70 ++++++++++++++---
 3 files changed, 178 insertions(+), 51 deletions(-)

commit 87557f7496581524dae43ea6c6a062d479b387c4
Author: Márton Elek <elek@apache.org>
Date:   Sun Jun 30 06:01:16 2019 +0200

    RATIS-465. Add docker support for running filestore example. Contributed by Mukul Kumar Singh.

 ratis-examples/src/main/docker/Dockerfile          | 39 ++++++++++++++
 ratis-examples/src/main/docker/docker-compose.yaml | 63 ++++++++++++++++++++++
 2 files changed, 102 insertions(+)

commit 23373189a74d6fbe736490350dfc1cd489064b99
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jun 28 16:42:05 2019 +0800

    RATIS-604. OrderedRequestStreamObserver does not cleanup when responding error.  Contributed by Lokesh Jain

 .../apache/ratis/grpc/client/GrpcClientProtocolService.java    | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 5f778e206fcb31aa292393519e51139e59240c68
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jun 28 16:32:53 2019 +0800

    RATIS-592. One node ratis writes fail forever after first NotLeaderException or LeaderNotReadyException.  Contributed by Siddharth Wagle

 .../java/org/apache/ratis/client/impl/ClientProtoUtils.java | 12 ++++++++++++
 .../java/org/apache/ratis/client/impl/OrderedAsync.java     |  2 +-
 .../java/org/apache/ratis/client/impl/RaftClientImpl.java   | 13 +++++++------
 .../java/org/apache/ratis/client/impl/UnorderedAsync.java   |  2 +-
 .../org/apache/ratis/protocol/LeaderNotReadyException.java  |  9 ++++++---
 .../java/org/apache/ratis/protocol/RaftClientReply.java     |  7 ++++++-
 .../apache/ratis/grpc/client/GrpcClientProtocolClient.java  |  6 ++++++
 ratis-proto/src/main/proto/Raft.proto                       |  5 +++++
 .../java/org/apache/ratis/server/impl/RaftServerImpl.java   |  4 +++-
 .../ratis/server/impl/RaftReconfigurationBaseTest.java      |  9 ++++-----
 10 files changed, 51 insertions(+), 18 deletions(-)

commit 43ab53c3940b6ac745188f9c38d904635d37cb80
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Fri Jun 28 13:13:10 2019 +0530

    RATIS-575. TestWatchRequestWithGrpc#testWatchRequestTimeout fails with NotReplicatedException. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/WatchRequestTests.java   | 25 ++++++++++++++++------
 1 file changed, 18 insertions(+), 7 deletions(-)

commit 937f68d5a2e6fd21ba344ebab9259b6ffe9a292c
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Jun 27 21:24:51 2019 +0530

    RATIS-601. Fix NotLeaderException handling. Contributed by Mukul Kumar Singh.

 .../src/main/java/org/apache/ratis/client/RaftClientRpc.java       | 3 ++-
 .../src/main/java/org/apache/ratis/client/impl/OrderedAsync.java   | 7 ++++++-
 .../src/main/java/org/apache/ratis/client/impl/RaftClientImpl.java | 7 +++++--
 .../src/main/java/org/apache/ratis/grpc/client/GrpcClientRpc.java  | 2 +-
 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java | 5 ++---
 5 files changed, 16 insertions(+), 8 deletions(-)

commit 051fe4e657d542f88c0dabbbd5a90908295f8964
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Jun 26 16:35:00 2019 +0800

    RATIS-595. appendEntry future should be completed only after the entry is flushed.

 .../org/apache/ratis/server/impl/LeaderState.java  |  2 +-
 .../ratis/server/impl/RaftServerConstants.java     |  4 +-
 .../org/apache/ratis/server/raftlog/RaftLog.java   |  8 +--
 .../ratis/server/raftlog/memory/MemoryRaftLog.java |  2 +-
 .../server/raftlog/segmented/SegmentedRaftLog.java | 18 +++--
 .../raftlog/segmented/SegmentedRaftLogWorker.java  | 78 ++++++++++++++++++----
 .../server/impl/RaftReconfigurationBaseTest.java   |  2 +-
 .../ratis/server/storage/RaftStorageTestUtils.java |  2 +-
 .../raftlog/segmented/TestSegmentedRaftLog.java    | 36 +++++-----
 9 files changed, 105 insertions(+), 47 deletions(-)

commit e08f2d13e44befd136655f4936a01dca704dc3b1
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Jun 25 11:28:06 2019 +0800

    Revert "RATIS-601. Fix NotLeaderException handling.  Contributed by Mukul Kumar Singh"
    
    This reverts commit 6d7afecf4ec547815e283602f6ba2bac73b165cc.

 .../src/main/java/org/apache/ratis/client/impl/OrderedAsync.java   | 7 +------
 .../src/main/java/org/apache/ratis/client/impl/RaftClientImpl.java | 6 ++----
 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java | 5 +++--
 3 files changed, 6 insertions(+), 12 deletions(-)

commit 5dc6eeee0d4029facd5e7e09c2e51482fc4bfb46
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jun 24 14:26:01 2019 +0800

    RATIS-590. Deadlock in ratis client.  Contributed by Lokesh Jain

 .../org/apache/ratis/client/impl/OrderedAsync.java | 13 +++++-------
 .../apache/ratis/client/impl/RaftClientImpl.java   | 23 +++++-----------------
 2 files changed, 10 insertions(+), 26 deletions(-)

commit 9d7c7a38a97b4a93704259d4e837cf6fed74c856
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jun 24 13:19:25 2019 +0800

    RATIS-573. Handle Raft Log Append Failure.  Contributed by Supratim Deka

 .../server/raftlog/segmented/SegmentedRaftLog.java |  4 +++
 .../raftlog/segmented/SegmentedRaftLogWorker.java  | 33 ++++++++++++++++++++--
 .../apache/ratis/statemachine/StateMachine.java    | 10 +++++++
 .../raftlog/segmented/TestSegmentedRaftLog.java    | 19 +++++++++++--
 4 files changed, 60 insertions(+), 6 deletions(-)

commit 6d7afecf4ec547815e283602f6ba2bac73b165cc
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sun Jun 23 07:01:23 2019 +0800

    RATIS-601. Fix NotLeaderException handling.  Contributed by Mukul Kumar Singh

 .../src/main/java/org/apache/ratis/client/impl/OrderedAsync.java   | 7 ++++++-
 .../src/main/java/org/apache/ratis/client/impl/RaftClientImpl.java | 6 ++++--
 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java | 5 ++---
 3 files changed, 12 insertions(+), 6 deletions(-)

commit be68f8490cc063827c9f1a55d16caf269a44bbbc
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Jun 20 13:09:28 2019 -0700

    RATIS-597. Add notifyLeader API in state machine.  Contributed by Ankit Singhal

 .../java/org/apache/ratis/server/impl/LeaderState.java    |  2 +-
 .../java/org/apache/ratis/statemachine/StateMachine.java  |  7 +++++++
 .../apache/ratis/statemachine/RaftSnapshotBaseTest.java   |  4 +++-
 .../ratis/statemachine/SimpleStateMachine4Testing.java    | 15 +++++++++++++++
 4 files changed, 26 insertions(+), 2 deletions(-)

commit f7a394c9786e27b8aca9a9eedde967b8d4620643
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jun 17 11:21:45 2019 -0700

    RATIS-587. FinalizeLogSegment should flush the contents of log.

 .../raftlog/segmented/BufferedWriteChannel.java    | 78 +++++-----------------
 .../segmented/SegmentedRaftLogOutputStream.java    |  9 +--
 2 files changed, 20 insertions(+), 67 deletions(-)

commit 3c41936730062e27cbe5097f90b38a7ed01efad3
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jun 14 15:00:32 2019 -0700

    RATIS-579. ExitUtils.terminate results in JVM terminated for peers not part of the group.  Contributed by Siddharth Wagle

 .../main/java/org/apache/ratis/util/ExitUtils.java |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../ratis/server/impl/StateMachineUpdater.java     |  6 ++--
 .../server/raftlog/segmented/SegmentedRaftLog.java |  3 +-
 .../raftlog/segmented/SegmentedRaftLogWorker.java  | 21 ++++++++-----
 .../raftlog/segmented/TestSegmentedRaftLog.java    | 35 +++++++++++++---------
 6 files changed, 43 insertions(+), 26 deletions(-)

commit 008c0093fed0cfd7e53b7d455621e1ec794d6f38
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Jun 13 13:44:47 2019 -0700

    RATIS-577. NPE in LogAppender while creating a new request.

 .../apache/ratis/server/raftlog/segmented/SegmentedRaftLog.java    | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 300d9c53c4b77e16ddd5d68dcf6c792d52a94a02
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Wed Jun 5 12:57:16 2019 +0530

    RATIS-564. Add raft group Id to install snapshot notification. Contributed by Siddharth Wagle.

 .../main/java/org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../java/org/apache/ratis/server/impl/RaftServerImpl.java    |  4 ++--
 .../java/org/apache/ratis/statemachine/StateMachine.java     | 12 ++++++------
 .../ratis/statemachine/SimpleStateMachine4Testing.java       | 11 +++++++----
 .../org/apache/ratis/grpc/TestInstallSnapshotWithGrpc.java   |  6 +++++-
 5 files changed, 21 insertions(+), 14 deletions(-)

commit 971c970a036993f0dedc6721cf52b5f0ca4531e7
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Jun 5 11:30:16 2019 +0800

    RATIS-574. Client should not use configured sleep interval in RetryPolicy when it gets NotLeaderException.  Contributed by Siddharth Wagle

 .../org/apache/ratis/client/impl/OrderedAsync.java | 36 ++++++++++++++++------
 .../apache/ratis/client/impl/UnorderedAsync.java   |  5 ++-
 .../java/org/apache/ratis/retry/RetryPolicies.java |  2 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 30 ++++++++++++++++++
 4 files changed, 62 insertions(+), 11 deletions(-)

commit 8a7fac921405baf3bfff0fc4fe41aadec2c5abeb
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Jun 4 14:20:24 2019 +0530

    RATIS-571. Client may send first request in sliding window with firstFlag as false. Contributed by Lokesh Jain.

 .../org/apache/ratis/client/RaftClientRpc.java     | 11 +++++++-
 .../org/apache/ratis/client/impl/OrderedAsync.java | 29 +++++++++++++++++-----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 28 ++++++++++++++++-----
 .../java/org/apache/ratis/util/SlidingWindow.java  | 25 +++++++++++--------
 .../grpc/client/GrpcClientProtocolClient.java      | 13 +++-------
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 13 +++-------
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  1 +
 7 files changed, 79 insertions(+), 41 deletions(-)

commit be131d6b5a24bc87a709f4f93692d965a549c5cf
Author: Josh Elser <elserj@apache.org>
Date:   Tue Feb 5 14:50:56 2019 -0500

    RATIS-480. Update scripts to work in both dev checkouts and binary tarball
    
    Signed-off-by: Mukul Kumar Singh <msingh@apache.org>

 ratis-assembly/src/main/assembly/bin.xml | 23 ++++++++++++++---------
 ratis-examples/pom.xml                   |  8 --------
 ratis-examples/src/main/bin/client.sh    | 16 ++++++++++++++--
 ratis-examples/src/main/bin/common.sh    | 11 ++++++++++-
 ratis-examples/src/main/bin/server.sh    |  2 +-
 ratis-examples/src/main/bin/start-all.sh | 28 +++++++++++++++++++++++++---
 6 files changed, 64 insertions(+), 24 deletions(-)

commit 4ee34383eb81f565b6cf06072170f2c130c51e8e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jun 3 14:50:25 2019 +0800

    RATIS-167. Implement a high performance OutputStream using async API.

 .../apache/ratis/client/impl/RaftOutputStream.java | 136 +++++++++++++++++
 .../apache/ratis/grpc/client/GrpcOutputStream.java |   4 +-
 .../org/apache/ratis/OutputStreamBaseTest.java     | 166 +++++++++++----------
 .../apache/ratis/grpc/TestGrpcOutputStream.java    |  50 +++++++
 .../ratis/grpc/TestRaftOutputStreamWithGrpc.java   |  36 +++++
 5 files changed, 308 insertions(+), 84 deletions(-)

commit c31cf5c49292be9665c4959cf5db14b068521e02
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jun 3 14:44:02 2019 +0800

    RATIS-545. Leader Election timeout should consider JVM pause interval.  Contributed by Lokesh Jain

 .../src/main/java/org/apache/ratis/util/JavaUtils.java      | 13 +++++++++++++
 .../java/org/apache/ratis/server/RaftServerConfigKeys.java  | 11 ++++++++++-
 .../java/org/apache/ratis/server/impl/FollowerState.java    |  7 ++++++-
 .../java/org/apache/ratis/server/impl/RaftServerImpl.java   |  6 ++++++
 4 files changed, 35 insertions(+), 2 deletions(-)

commit ad6949f0e50ab00dcf8fbcc3e11331a114bc6826
Author: Vladimir Rodionov <vrodionov@apache.org>
Date:   Thu May 30 15:59:50 2019 -0700

    RATIS-520: LogService Configuration
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../java/org/apache/ratis/conf/RaftProperties.java |   5 +
 ratis-logservice/README.md                         |   5 +
 ratis-logservice/logservice-example.xml            |  88 ++++++++++
 .../logservice/api/LogServiceConfiguration.java    | 188 ++++++++++++++++-----
 .../ratis/logservice/client/LogServiceClient.java  |   2 +-
 .../apache/ratis/logservice/common/Constants.java  |  29 +++-
 .../ratis/logservice/impl/LogStreamImpl.java       |   2 +-
 .../ratis/logservice/impl/LogWriterImpl.java       |   6 +-
 .../apache/ratis/logservice/server/BaseServer.java |  31 +++-
 .../apache/ratis/logservice/server/LogServer.java  |  18 +-
 .../ratis/logservice/server/MetadataServer.java    |  14 +-
 .../apache/ratis/logservice/server/ServerOpts.java |  29 +++-
 12 files changed, 359 insertions(+), 58 deletions(-)

commit b98fac8804193408b316f8af5983feb557da0cba
Author: Ankit Singhal <ankit@apache.org>
Date:   Mon May 13 19:03:41 2019 -0700

    RATIS-549 RATIS-550 RATIS-552 RATIS-553 Metric Framework for Ratis
    
    Closes #19
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 pom.xml                                            |  15 ++-
 ratis-assembly/pom.xml                             |   4 +
 ratis-common/pom.xml                               |   5 -
 .../java/org/apache/ratis/util/AtomicUtils.java    |  60 +++++++++
 .../org/apache/ratis/util/CollectionUtils.java     |  21 +++
 .../main/java/org/apache/ratis/util/DataQueue.java |   7 +-
 .../ratis/logservice/client/LogServiceClient.java  |   2 +-
 .../metrics/LogServiceMetricsRegistry.java         |  69 ++++++++++
 .../ratis/logservice/server/LogStateMachine.java   |  88 +++++++++---
 .../ratis/logservice/server/MetaStateMachine.java  |  58 +++++---
 .../ratis/logservice/LogServiceReadWriteBase.java  |  68 +++++++++-
 .../ratis/logservice/server/TestMetaServer.java    |  62 +++++++--
 ratis-metrics/pom.xml                              |  60 +++++++++
 .../org/apache/ratis/metrics/MetricRegistries.java |  86 ++++++++++++
 .../ratis/metrics/MetricRegistriesLoader.java      |  95 +++++++++++++
 .../ratis/metrics/MetricRegistryFactory.java       |  36 +++++
 .../apache/ratis/metrics/MetricRegistryInfo.java   |  87 ++++++++++++
 .../ratis/metrics/impl/MetricRegistriesImpl.java   |  76 +++++++++++
 .../metrics/impl/MetricRegistryFactoryImpl.java    |  25 ++--
 .../ratis/metrics/impl/RatisMetricRegistry.java    | 103 +++++++++++++++
 .../apache/ratis/metrics/impl/RefCountingMap.java  |  86 ++++++++++++
 ...rg.apache.hadoop.hbase.metrics.MetricRegistries |  18 +++
 .../ratis/metrics/TestMetricRegistriesLoader.java  |  54 ++++++++
 .../ratis/metrics/impl/TestRefCountingMap.java     | 147 +++++++++++++++++++++
 ratis-server/pom.xml                               |  10 ++
 .../apache/ratis/server/metrics/RatisMetrics.java  |  51 +++++++
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |  30 +++--
 .../ratis/statemachine/impl/BaseStateMachine.java  |  16 +++
 .../ratis/server/storage/RaftStorageTestUtils.java |   7 +
 .../ratis/server/raftlog/TestRaftLogMetrics.java   |  35 ++---
 .../apache/ratis/util/TestDataBlockingQueue.java   |   3 +-
 31 files changed, 1380 insertions(+), 104 deletions(-)

commit 231b35c23d44a0afb889f0c6bb5ba9194b3cf398
Author: Lokesh Jain <ljain@apache.org>
Date:   Wed May 29 14:27:47 2019 +0530

    RATIS-565. Move the ordered async client code to a new class. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/client/impl/OrderedAsync.java | 216 +++++++++++++++++++++
 .../apache/ratis/client/impl/RaftClientImpl.java   | 204 ++++---------------
 .../ratis/client/impl/RaftClientTestUtil.java      |   5 +-
 .../apache/ratis/client/impl/UnorderedAsync.java   |  10 +-
 4 files changed, 259 insertions(+), 176 deletions(-)

commit ee1e3a5e06335721920743bd187c33628357a003
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Wed May 29 14:08:43 2019 +0530

    RATIS-566. OrderedStreamObservers#closeAllExisting should close the streams for a certain group id only. Contributed by Tsz Wo Nicholas Sze.

 .../grpc/client/GrpcClientProtocolService.java     | 37 ++++++++++++++++++----
 .../org/apache/ratis/grpc/server/GrpcService.java  |  5 +--
 .../org/apache/ratis/server/RaftServerRpc.java     |  3 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  2 +-
 4 files changed, 37 insertions(+), 10 deletions(-)

commit 4b613c1e2e91e91de7a84dc378a2e67da7fb092b
Author: Lokesh Jain <ljain@apache.org>
Date:   Wed May 29 10:17:54 2019 +0530

    RATIS-568. Server sliding window should fail out of order requests on close. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/RaftClientImpl.java   | 14 ++--
 .../apache/ratis/client/impl/UnorderedAsync.java   |  2 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |  6 ++
 .../java/org/apache/ratis/util/SlidingWindow.java  | 79 ++++++++++++++--------
 .../grpc/client/GrpcClientProtocolService.java     | 38 +++++++----
 5 files changed, 88 insertions(+), 51 deletions(-)

commit 346c024d1ce91b5c3b154f3bed58d8d1bfac6c64
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Tue May 28 23:50:11 2019 +0530

    RATIS-563. Purge logs in takeSnapshot only after all the nodes have caught up with the index. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/server/RaftServerConfigKeys.java  |  9 +++++
 .../org/apache/ratis/server/impl/ServerState.java  |  7 ++--
 .../ratis/server/impl/StateMachineUpdater.java     | 15 +++++++-
 .../org/apache/ratis/server/raftlog/RaftLog.java   | 42 +++++++++++++++++-----
 .../ratis/server/raftlog/memory/MemoryRaftLog.java |  5 +--
 .../server/raftlog/segmented/SegmentedRaftLog.java |  4 +--
 .../raftlog/segmented/SegmentedRaftLogCache.java   | 28 +++++++++++----
 .../raftlog/segmented/SegmentedRaftLogWorker.java  |  4 +--
 .../raftlog/segmented/TestSegmentedRaftLog.java    | 24 ++++++++++---
 9 files changed, 105 insertions(+), 33 deletions(-)

commit e493b60b795ce0ec41affbb5052d7c6a3255dfff
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri May 24 14:06:50 2019 +0800

    RATIS-559. LogAppender.getPrevious throws IllegalStateException.

 .../org/apache/ratis/server/impl/LogAppender.java  | 51 +++++++++++++++++-----
 .../ratis/server/impl/RaftServerConstants.java     |  6 ++-
 .../org/apache/ratis/server/raftlog/RaftLog.java   |  3 ++
 3 files changed, 48 insertions(+), 12 deletions(-)

commit de557a713d4834cc6343d474ac64e122d9c8267f
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu May 23 13:59:25 2019 +0800

    RATIS-558. GrpcLogAppender doesn't reset the log entries to follower on reply to inconsistent entries.

 .../java/org/apache/ratis/grpc/server/GrpcLogAppender.java  | 13 ++++---------
 .../src/test/java/org/apache/ratis/RaftAsyncTests.java      |  4 ++--
 2 files changed, 6 insertions(+), 11 deletions(-)

commit d5cd3f6c69082f42cb1a36d2c9a5a27f1d99a836
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu May 16 14:02:45 2019 -0700

    RATIS-542. When a server restarts, purge(-1) causes IllegalStateException.

 .../org/apache/ratis/server/impl/ServerState.java  |   1 -
 .../ratis/server/impl/StateMachineUpdater.java     | 191 ++++++++++++---------
 .../org/apache/ratis/server/raftlog/RaftLog.java   |   1 +
 .../apache/ratis/server/raftlog/RaftLogIndex.java  |   7 +
 .../ratis/server/raftlog/memory/MemoryRaftLog.java |   6 -
 .../apache/ratis/server/storage/RaftStorage.java   |  20 +--
 6 files changed, 117 insertions(+), 109 deletions(-)

commit 21c979895c8e9f12ba6b88717de5511e46eece2c
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu May 16 13:59:07 2019 -0700

    RATIS-534. Warn that the netty useCacheForAllThreads feature may cause JVM GC pauses.  Contributed by Lokesh Jain

 .../java/org/apache/ratis/grpc/GrpcFactory.java    | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit 5f59dea55fd6e3e85085781eeae4f793332d80de
Author: Josh Elser <elserj@apache.org>
Date:   Mon May 13 19:10:32 2019 -0400

    RATIS-546. Configurable value sizes on VerificationTool

 .../ratis/logservice/tool/VerificationTool.java    | 89 +++++++++++++++++++---
 .../logservice/tool/TestVerificationTool.java      | 59 ++++++++++++++
 2 files changed, 136 insertions(+), 12 deletions(-)

commit 34197939571287dd0b81896499b028b82a29b0fa
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed May 15 16:19:07 2019 -0700

    RATIS-555. Move RaftLog and the implementations to separated packages.

 .../main/java/org/apache/ratis/util/JavaUtils.java |  8 -----
 .../logservice/server/LogServiceRaftLogReader.java |  4 +--
 .../ratis/logservice/server/LogStateMachine.java   |  2 +-
 .../org/apache/ratis/server/impl/FollowerInfo.java |  2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  2 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  6 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../org/apache/ratis/server/impl/ServerState.java  |  5 ++-
 .../ratis/server/impl/StateMachineUpdater.java     |  2 +-
 .../ratis/server/{storage => raftlog}/RaftLog.java | 19 +++++-----
 .../{storage => raftlog}/RaftLogIOException.java   |  4 +--
 .../server/{storage => raftlog}/RaftLogIndex.java  |  2 +-
 .../{storage => raftlog}/RaftLogSequentialOps.java |  2 +-
 .../{storage => raftlog/memory}/MemoryRaftLog.java | 11 +++---
 .../segmented}/BufferedChannelBase.java            |  4 +--
 .../segmented}/BufferedWriteChannel.java           |  4 +--
 .../segmented}/CacheInvalidationPolicy.java        |  6 ++--
 .../{storage => raftlog/segmented}/LogSegment.java |  8 +++--
 .../segmented}/SegmentedRaftLog.java               | 42 ++++++++++------------
 .../segmented/SegmentedRaftLogCache.java}          | 13 +++----
 .../segmented}/SegmentedRaftLogFormat.java         |  2 +-
 .../segmented/SegmentedRaftLogInputStream.java}    | 23 ++++++------
 .../segmented/SegmentedRaftLogOutputStream.java}   |  8 ++---
 .../segmented/SegmentedRaftLogReader.java}         | 14 ++++----
 .../segmented/SegmentedRaftLogWorker.java}         | 27 +++++++-------
 .../org/apache/ratis/server/storage/MetaFile.java  |  8 ++---
 .../apache/ratis/server/storage/RaftStorage.java   |  4 +--
 .../ratis/server/storage/RaftStorageDirectory.java |  6 ++--
 .../java/org/apache/ratis/LogAppenderTests.java    |  2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 +--
 .../test/java/org/apache/ratis/RaftBasicTests.java |  2 +-
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  4 +--
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  2 +-
 .../java/org/apache/ratis/RetryCacheTests.java     |  4 +--
 .../apache/ratis/server/ServerRestartTests.java    |  6 ++--
 .../ratis/server/impl/LeaderElectionTests.java     |  6 ++--
 .../server/impl/RaftReconfigurationBaseTest.java   |  2 +-
 .../impl/RaftStateMachineExceptionTests.java       |  2 +-
 .../segmented/SegmentedRaftLogTestUtils.java       | 32 +++++++++++++++++
 .../ratis/server/storage/RaftStorageTestUtils.java | 16 ++-------
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  2 +-
 .../statemachine/SimpleStateMachine4Testing.java   |  8 ++---
 .../ratis/grpc/TestInstallSnapshotWithGrpc.java    |  2 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  2 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  2 +-
 .../{storage => raftlog}/TestRaftLogIndex.java     |  2 +-
 .../server/{ => raftlog}/TestRaftLogMetrics.java   | 11 +++---
 .../segmented}/TestCacheEviction.java              |  9 ++---
 .../segmented/TestLogSegment.java}                 | 28 +++++++--------
 .../segmented}/TestRaftLogReadWrite.java           | 38 +++++++++-----------
 .../segmented}/TestSegmentedRaftLog.java           | 18 +++++-----
 .../segmented/TestSegmentedRaftLogCache.java}      | 13 ++++---
 52 files changed, 234 insertions(+), 223 deletions(-)

commit 21d7526217795b6477e814365c216c9597c226ee
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue May 14 19:31:11 2019 +0530

    RATIS-515. IllegalStateException while updating matchIndex. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/grpc/server/GrpcLogAppender.java  | 103 ++++++++-------------
 .../org/apache/ratis/server/impl/FollowerInfo.java |   4 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  23 ++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |  99 +++++++-------------
 .../apache/ratis/server/impl/ServerProtoUtils.java |  18 ++--
 .../org/apache/ratis/server/impl/ServerState.java  |  41 ++++----
 .../org/apache/ratis/server/storage/RaftLog.java   |   8 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   3 +-
 .../ratis/grpc/TestInstallSnapshotWithGrpc.java    |   2 +-
 9 files changed, 128 insertions(+), 173 deletions(-)

commit c7b35c3f43fd52bf7669f19fc86c1b05b71bef0e
Author: Lokesh Jain <ljain@apache.org>
Date:   Fri May 10 00:54:22 2019 +0530

    RATIS-529. Leader should limit pending requests to avoid OOM. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  31 +++---
 .../ratis/protocol/RaftRetryFailureException.java  |   9 +-
 .../exceptions/ResourceUnavailableException.java   |  29 +++++
 .../org/apache/ratis/util/ResourceSemaphore.java   |  52 +++++++++
 .../java/org/apache/ratis/util/SlidingWindow.java  |   7 +-
 .../java/org/apache/ratis/util/TimeDuration.java   |  20 +++-
 .../src/test/java/org/apache/ratis/BaseTest.java   |  12 ++
 .../main/java/org/apache/ratis/grpc/GrpcUtil.java  |   7 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  67 +++++++----
 .../org/apache/ratis/server/impl/LeaderState.java  |  10 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  92 ++++++++++++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |  14 ++-
 .../apache/ratis/server/impl/WatchRequests.java    |  45 +++++---
 .../java/org/apache/ratis/MiniRaftCluster.java     |  27 ++---
 .../apache/ratis/RequestLimitAsyncBaseTest.java    | 124 +++++++++++++++++++++
 .../java/org/apache/ratis/WatchRequestTests.java   |  13 ++-
 .../ratis/server/impl/RaftServerTestUtil.java      |   3 +
 .../statemachine/SimpleStateMachine4Testing.java   |  42 ++++++-
 .../ratis/grpc/TestRequestLimitAsyncWithGrpc.java  |  25 +++++
 19 files changed, 526 insertions(+), 103 deletions(-)

commit e157ce542479011902410f6d76c71027123df5d3
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Apr 15 20:18:18 2019 +0800

    RATIS-518. Add request specific retry policy support.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  31 +++---
 .../apache/ratis/client/impl/UnorderedAsync.java   |  11 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |  12 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |   2 +-
 .../ratis/protocol/RaftRetryFailureException.java  |   7 +-
 .../java/org/apache/ratis/retry/RetryPolicies.java | 123 ++++++++++++++-------
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  16 +--
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   7 +-
 .../java/org/apache/ratis/TestRetryPolicy.java     |  80 ++++++++++++--
 9 files changed, 199 insertions(+), 90 deletions(-)

commit 2e7211f5c0c97c90744689d9f64e5ea81cfcdd93
Author: Lokesh Jain <ljain@apache.org>
Date:   Mon May 6 15:46:58 2019 +0530

    RATIS-497. IllegalStateException: ILLEGAL TRANSITION: In LogAppender(s4 -> s1), CLOSING -> RUNNING. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/ClientProtoUtils.java |  15 +--
 .../apache/ratis/client/impl/RaftClientImpl.java   |   5 +-
 .../apache/ratis/protocol/NotLeaderException.java  |  17 ++--
 .../ratis/protocol/SetConfigurationRequest.java    |  16 +--
 .../java/org/apache/ratis/util/Preconditions.java  |  17 ++++
 .../java/org/apache/ratis/util/ProtoUtils.java     |  10 +-
 .../ratis/grpc/client/GrpcClientStreamer.java      |   8 +-
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  42 ++++----
 .../org/apache/ratis/server/impl/FollowerInfo.java |  12 ++-
 .../org/apache/ratis/server/impl/LeaderState.java  |  65 +++++++-----
 .../org/apache/ratis/server/impl/LogAppender.java  | 113 +++++++++++++--------
 .../ratis/server/impl/RaftConfiguration.java       |  27 ++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |   7 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |   4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   3 +-
 .../org/apache/ratis/RaftExceptionBaseTest.java    |   4 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |   8 +-
 .../org/apache/ratis/util/TestPreconditions.java   |  53 ++++++++++
 18 files changed, 261 insertions(+), 165 deletions(-)

commit c01c5e9cce712fc5f6500bb5c27f80193eec7fbe
Author: Josh Elser <elserj@apache.org>
Date:   Tue Apr 23 16:23:40 2019 -0400

    RATIS-533. Set better default Raft properties from Ratis
    
    Include brief summary from the Jira issue as to what/why we
    changed, things we might want to tune in the future, and
    validate that config isn't set which would break the
    log service.
    
    Closes #18

 ratis-logservice/TUNING.md                         | 58 ++++++++++++++++++++++
 .../apache/ratis/logservice/server/BaseServer.java | 32 ++++++++++++
 .../apache/ratis/logservice/server/LogServer.java  | 35 +++++++++++--
 .../ratis/logservice/server/MetadataServer.java    | 12 +++--
 .../ratis/logservice/server/TestBaseServer.java    | 49 ++++++++++++++++++
 5 files changed, 177 insertions(+), 9 deletions(-)

commit f76d77938cf5069e55e96a48d571de29fd5d2805
Author: Josh Elser <elserj@apache.org>
Date:   Wed Apr 10 20:24:40 2019 -0400

    RATIS-527. Basic script wrappers around common logservice commands

 ratis-logservice/README.md                  | 10 +++++++++-
 ratis-logservice/src/assembly/assembly.xml  |  7 +++++++
 ratis-logservice/src/assembly/bin/load-test | 23 +++++++++++++++++++++++
 ratis-logservice/src/assembly/bin/shell     | 23 +++++++++++++++++++++++
 4 files changed, 62 insertions(+), 1 deletion(-)

commit 912365d94c212d5226390ed5a784ea4362646522
Author: Josh Elser <elserj@apache.org>
Date:   Wed Apr 10 19:29:00 2019 -0400

    RATIS-526. Push building the docker image and launching the client env into scripts

 ratis-logservice/README.md       |  5 +++--
 ratis-logservice/build-docker.sh | 31 +++++++++++++++++++++++++++++++
 ratis-logservice/client-env.sh   | 19 +++++++++++++++++++
 3 files changed, 53 insertions(+), 2 deletions(-)

commit cbdf7bda1ad749c846af8aba5afeac28efb96c65
Author: Josh Elser <elserj@apache.org>
Date:   Wed Apr 10 16:25:36 2019 -0400

    RATIS-525. Usability improvements to VerificationTool
    
    * Add lots of new options
    * Fix LOG/stdout use
    * Remove logs if they already exist before writing

 .../ratis/logservice/tool/VerificationTool.java    | 149 ++++++++++++++-------
 1 file changed, 100 insertions(+), 49 deletions(-)

commit 4a1697abe988e4a9d29e8f6c00c11f39e8a17e5e
Author: Josh Elser <elserj@apache.org>
Date:   Wed Apr 10 15:14:20 2019 -0400

    RATIS-524. Mark meta-quorum jcommander options as required

 .../java/org/apache/ratis/logservice/shell/LogServiceShellOpts.java     | 2 +-
 .../main/java/org/apache/ratis/logservice/tool/VerificationTool.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 1698e7345b3894f26d3758bffe496443006b356e
Author: Josh Elser <elserj@apache.org>
Date:   Wed Apr 10 15:13:19 2019 -0400

    RATIS-523. Switch chatty debug to trace logging

 .../ratis/logservice/server/LogServiceRaftLogReader.java     | 12 +++++++-----
 .../org/apache/ratis/logservice/server/LogStateMachine.java  | 11 ++++-------
 2 files changed, 11 insertions(+), 12 deletions(-)

commit fe2b15d2f1eb5dfb6a957414e8dc42e863027266
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Mon Apr 29 19:30:02 2019 +0530

    RATIS-532. UnorderedAsync requests should fail instead of retrying the request in case of GroupMismatchException. Contributed by Shashikant Banerjee.

 .../src/main/java/org/apache/ratis/client/impl/UnorderedAsync.java   | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit d7111524924623650a01e6bd1011eea79058b9eb
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Apr 23 18:16:32 2019 +0530

    RATIS-495. Leader Election thread might crash if two servers having the same id. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/util/ProtoUtils.java     |  4 ---
 .../apache/ratis/server/impl/LeaderElection.java   | 19 +++++++----
 .../ratis/server/impl/PeerConfiguration.java       | 17 +++++++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  4 +++
 .../ratis/server/impl/TestRaftConfiguration.java   | 39 ++++++++++++++++++++++
 6 files changed, 70 insertions(+), 15 deletions(-)

commit 9dcb75a94eacae49b4fed7f7105b97deee4aba51
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Apr 23 13:55:51 2019 +0800

    RATIS-243. Add log purge function after taking snapshot.

 .../ratis/server/impl/StateMachineUpdater.java     |  5 +--
 .../apache/ratis/server/storage/MemoryRaftLog.java | 16 ++++++++
 .../org/apache/ratis/server/storage/RaftLog.java   | 14 +++++++
 .../apache/ratis/server/storage/RaftLogCache.java  | 31 ++++++++++++++-
 .../apache/ratis/server/storage/RaftLogWorker.java | 30 +++++++++++++++
 .../ratis/server/storage/SegmentedRaftLog.java     | 14 +++++++
 .../ratis/server/storage/TestRaftLogCache.java     | 45 ++++++++++++++++++++++
 .../ratis/server/storage/TestSegmentedRaftLog.java | 32 +++++++++++++++
 8 files changed, 183 insertions(+), 4 deletions(-)

commit b51ec8850b8d340602e0a7f11bc73d1be5eef110
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Apr 16 13:04:48 2019 +0800

    RATIS-519. Improvements on README.md and ratis-examples/README.md.

 README.md                | 24 +++++++++++----
 ratis-examples/README.md | 79 ++++++++++++++++++++++++++++++++++--------------
 2 files changed, 75 insertions(+), 28 deletions(-)

commit 64f822f2da52a804cd9b7fecef992aa1b3f626ee
Author: Arpit Agarwal <arp@apache.org>
Date:   Mon Apr 15 14:16:05 2019 -0700

    Revert "RATIS-518. Add request specific retry policy support."
    
    This reverts commit 4c7028a64e2e5253cf678d5cb02c9dca15adbfeb.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  31 +++---
 .../apache/ratis/client/impl/UnorderedAsync.java   |  11 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |  12 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |   2 +-
 .../ratis/protocol/RaftRetryFailureException.java  |   7 +-
 .../java/org/apache/ratis/retry/RetryPolicies.java | 123 +++++++--------------
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  16 ++-
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   7 +-
 .../java/org/apache/ratis/TestRetryPolicy.java     |  80 ++------------
 9 files changed, 90 insertions(+), 199 deletions(-)

commit 4c7028a64e2e5253cf678d5cb02c9dca15adbfeb
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Apr 15 20:18:18 2019 +0800

    RATIS-518. Add request specific retry policy support.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  31 +++---
 .../apache/ratis/client/impl/UnorderedAsync.java   |  11 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |  12 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |   2 +-
 .../ratis/protocol/RaftRetryFailureException.java  |   7 +-
 .../java/org/apache/ratis/retry/RetryPolicies.java | 123 ++++++++++++++-------
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  16 +--
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   7 +-
 .../java/org/apache/ratis/TestRetryPolicy.java     |  80 ++++++++++++--
 9 files changed, 199 insertions(+), 90 deletions(-)

commit 8620e09b952b88a68a6912d26e53aa308a3c3b8c
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Apr 10 16:51:48 2019 +0800

    RATIS-514. Check if leader and follower have same configuration for installSnapshot.  Contributed by Hanisha Koneru

 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  6 +++-
 ratis-proto/src/main/proto/Raft.proto              | 41 +++++++++++++++-------
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 32 +++++++++++------
 .../apache/ratis/server/impl/ServerProtoUtils.java | 39 ++++++++++++++------
 .../org/apache/ratis/server/impl/ServerState.java  |  4 +--
 .../ratis/server/storage/SnapshotManager.java      |  8 +++--
 7 files changed, 91 insertions(+), 41 deletions(-)

commit 66d79c3af427b4bae58802c9d6e5761fc0f6fea2
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Apr 9 10:46:16 2019 +0800

    RATIS-517. Examples cannot be run after assembly.

 BUILDING.md                           |  4 +-
 README.md                             | 44 +-----------------
 pom.xml                               | 15 +++++-
 ratis-examples/README.md              | 87 +++++++++++++++++++++++++++++++++++
 ratis-examples/pom.xml                | 24 ++++++++--
 ratis-examples/src/main/bin/common.sh | 28 +++++++----
 6 files changed, 142 insertions(+), 60 deletions(-)

commit ea61c0d5d1a702d1fca6d642be2e2170735b9b85
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Apr 4 13:05:01 2019 +0800

    RATIS-513. Add missing modules to src and bin assembly xml.

 DISCLAIMER.txt => DISCLAIMER             |  0
 dev-support/make_rc.sh                   | 16 ++++-------
 pom.xml                                  | 24 ++++++++++++++--
 ratis-assembly/pom.xml                   | 49 ++++++++++++++++++++++++--------
 ratis-assembly/src/main/assembly/bin.xml | 16 +++++++++--
 ratis-assembly/src/main/assembly/src.xml | 38 +++++--------------------
 ratis-examples/pom.xml                   |  2 +-
 7 files changed, 86 insertions(+), 59 deletions(-)

commit 6bdfb587763d9e6faeeaf8918b8b6316c4cb7fe0
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Apr 3 21:15:48 2019 +0800

    RATIS-498. Notify Follower to Install Snapshot through state machine.  Contributed by Hanisha Koneru

 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java |  19 --
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  93 +++++++++-
 ratis-proto/src/main/proto/Raft.proto              |   7 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  10 ++
 .../org/apache/ratis/server/impl/FollowerInfo.java |   6 +-
 .../apache/ratis/server/impl/FollowerState.java    |   1 +
 .../org/apache/ratis/server/impl/LogAppender.java  |   7 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 192 +++++++++++++++++++--
 .../apache/ratis/server/impl/ServerProtoUtils.java |  24 +++
 .../org/apache/ratis/server/impl/ServerState.java  |  24 +++
 .../apache/ratis/statemachine/StateMachine.java    |  14 +-
 .../impl/SimpleStateMachineStorage.java            |   6 +
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   6 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +
 .../ratis/grpc/TestInstallSnapshotWithGrpc.java    | 188 ++++++++++++++++++++
 15 files changed, 550 insertions(+), 51 deletions(-)

commit 8fed3689c7b6b6d94fd1b808dd018855f2b21f1f
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Mon Apr 1 11:15:06 2019 +0530

    RATIS-512. testLeaderStepDown may fail with NullPointerException. Contributed by Tsz Wo Nicholas Sze.

 .../src/test/java/org/apache/ratis/MiniRaftCluster.java       | 11 +++++------
 .../src/test/java/org/apache/ratis/RaftExceptionBaseTest.java |  3 ++-
 .../apache/ratis/server/impl/RaftReconfigurationBaseTest.java |  3 ++-
 3 files changed, 9 insertions(+), 8 deletions(-)

commit 9984f3129834ed4daaca0274a96525bee5773440
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Mon Apr 1 11:06:26 2019 +0530

    RATIS-511. Fail the requests the sliding window when a raft client hits GroupMismatchException. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/RaftClientImpl.java   | 11 ++-
 .../java/org/apache/ratis/util/SlidingWindow.java  |  8 +--
 .../org/apache/ratis/RaftAsyncExceptionTests.java  | 79 ++++++++++++++++++++++
 .../ratis/grpc/TestRaftAsyncExceptionWithGrpc.java | 25 +++++++
 4 files changed, 116 insertions(+), 7 deletions(-)

commit d1bc34f14fa07bb5b260ed5d90050870e1777f81
Author: Rajeshbabu Chintaguntla <Rajeshbabu Chintaguntla>
Date:   Thu Mar 28 16:30:23 2019 +0530

    RATIS-510 VerificationTool does not have an Apache license header(Rajeshbabu)

 .../apache/ratis/logservice/tool/VerificationTool.java  | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

commit 66d082600d494feb6e9e0b521bba47e2d7c77961
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Mar 28 18:24:02 2019 +0800

    RATIS-503. RaftLog is accessed by LeaderElection after closed.

 .../main/java/org/apache/ratis/util/Daemon.java    |   9 +-
 .../main/java/org/apache/ratis/util/LifeCycle.java |  49 ++++--
 .../main/java/org/apache/ratis/util/LogUtils.java  |  12 ++
 .../java/org/apache/ratis/util/PeerProxyMap.java   |   2 +-
 .../java/org/apache/ratis/util/TimeDuration.java   |   5 +
 .../apache/ratis/server/impl/LeaderElection.java   | 173 +++++++++++++--------
 .../apache/ratis/server/impl/RaftServerImpl.java   |   4 +-
 .../org/apache/ratis/server/impl/RoleInfo.java     |   2 +-
 .../org/apache/ratis/server/impl/ServerState.java  |  33 ++--
 .../apache/ratis/server/protocol/TermIndex.java    |   7 +-
 .../server/simulation/SimulatedServerRpc.java      |  23 ++-
 11 files changed, 219 insertions(+), 100 deletions(-)

commit 97c152bb2fbabf462d32e6ebb05dfb30f4ed9a18
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Mar 28 14:10:08 2019 +0800

    RATIS-506. ServerRestartTests.testRestartCommitIndex may fail intermittently.

 .../main/java/org/apache/ratis/util/JavaUtils.java |  8 ---
 .../ratis/statemachine/impl/BaseStateMachine.java  |  2 +-
 .../apache/ratis/server/ServerRestartTests.java    | 36 ++++++----
 .../server/impl/RaftReconfigurationBaseTest.java   |  2 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  2 +-
 .../ratis/server/storage/TestRaftLogIndex.java     | 84 ++++++++++++++++++++++
 6 files changed, 109 insertions(+), 25 deletions(-)

commit b6cb1dd2f5732bd731fc0e671900086a5b4b6713
Author: Rajeshbabu Chintaguntla <rajeshbabu@apache.org>
Date:   Wed Mar 27 16:08:39 2019 -0400

    RATIS-475. Writing data from LogStream fails with IllegalStateException
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../apache/ratis/logservice/server/LogServer.java  |   6 +-
 .../ratis/logservice/tool/VerificationTool.java    | 142 +++++++++++++++++++++
 2 files changed, 144 insertions(+), 4 deletions(-)

commit 1240266c25ee2a9a3b23d08451a1194c900041df
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Wed Mar 27 21:18:58 2019 +0530

    RATIS-490. Logging Improvements with MultiRaft.  Contributed by Mukul Kumar Singh.

 .../org/apache/ratis/server/impl/FollowerState.java   |  4 ++--
 .../org/apache/ratis/server/impl/LogAppender.java     |  8 ++++----
 .../org/apache/ratis/server/impl/RaftServerImpl.java  |  6 +++---
 .../org/apache/ratis/server/impl/ServerState.java     | 19 +++++++++++--------
 .../apache/ratis/server/impl/StateMachineUpdater.java |  2 +-
 5 files changed, 21 insertions(+), 18 deletions(-)

commit 1fc5acedda4dbd7c62fe73c8656c792871f4661f
Author: Arpit Agarwal <arp@apache.org>
Date:   Thu Mar 21 09:46:19 2019 -0700

    RATIS-507. RaftServerProxy should not use common thread pool for creating raft server. Contributed by Mukul Kumar Singh.

 .../apache/ratis/server/impl/RaftServerProxy.java    | 20 ++++++++++++++------
 1 file changed, 14 insertions(+), 6 deletions(-)

commit c4330f2ef9f8b89e9819e364e41547bd8e230bf2
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Mar 20 15:33:25 2019 +0800

    RATIS-505. In gRPC, make Install Snapshot option configurable.  Contributed by Hanisha Koneru

 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java    | 19 +++++++++++++++++++
 .../org/apache/ratis/grpc/server/GrpcLogAppender.java | 17 +++++++++++++----
 2 files changed, 32 insertions(+), 4 deletions(-)

commit c779f7a585227f5d57e2d21e130627d540b91d69
Author: Arpit Agarwal <arp@apache.org>
Date:   Tue Mar 19 11:34:24 2019 -0700

    RATIS-502. Commit Index less than the snapshot's commit indexes need to be ignored on restart. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/server/storage/RaftLog.java   |  2 +-
 .../apache/ratis/server/storage/RaftLogIndex.java  |  6 ++-
 .../ratis/statemachine/impl/BaseStateMachine.java  |  2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 10 +++--
 .../apache/ratis/server/ServerRestartTests.java    | 47 +++++++++++++++++-----
 5 files changed, 50 insertions(+), 17 deletions(-)

commit 74b491cc76aa5e26029c3f6d77c1210809ecc110
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Mar 19 15:17:18 2019 +0800

    RATIS-499. Leader should close the sliding window if it steps down.

 .../ratis/client/impl/RaftClientTestUtil.java      |  11 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |   2 +-
 .../org/apache/ratis/util/CollectionUtils.java     |  41 ++++---
 .../grpc/client/GrpcClientProtocolClient.java      |  22 ++--
 .../ratis/grpc/client/GrpcClientProtocolProxy.java |   2 +-
 .../grpc/client/GrpcClientProtocolService.java     |  81 ++++++++++---
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  12 +-
 .../org/apache/ratis/grpc/server/GrpcService.java  |  23 ++--
 ratis-proto/src/main/proto/Grpc.proto              |   8 +-
 .../org/apache/ratis/server/RaftServerRpc.java     |   6 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   1 +
 .../org/apache/ratis/server/impl/RoleInfo.java     |   4 +
 .../ratis/server/impl/RaftServerTestUtil.java      |   7 +-
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  | 135 +++++++++++++++++++--
 14 files changed, 277 insertions(+), 78 deletions(-)

commit 29fe5017cb1a6c01fdf34f96829db04b86a2ef40
Author: Xiaoyu Yao <xyao@apache.org>
Date:   Sun Mar 17 23:49:45 2019 -0700

    RATIS-500. Remove GrpcClientProtocolClient request schedule debug log. Contributed by Xiaoyu Yao.
    
    This closes #16

 .../main/java/org/apache/ratis/grpc/client/GrpcClientProtocolClient.java | 1 -
 1 file changed, 1 deletion(-)

commit 03c5fd82044612d71c021c0c8a7a15999d28f170
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Mar 14 12:05:15 2019 -0700

    RATIS-459. Async requests may become out-of-order in some rare case.

 .../apache/ratis/client/impl/ClientProtoUtils.java | 26 +++++++------
 .../apache/ratis/client/impl/RaftClientImpl.java   | 45 ++++++++++++++--------
 .../apache/ratis/client/impl/UnorderedAsync.java   | 18 ++++++++-
 .../apache/ratis/protocol/GroupInfoRequest.java    |  7 ++--
 .../apache/ratis/protocol/GroupListRequest.java    |  7 ++--
 .../ratis/protocol/GroupManagementRequest.java     |  4 +-
 .../apache/ratis/protocol/RaftClientRequest.java   | 20 +++++-----
 .../ratis/protocol/SetConfigurationRequest.java    |  4 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |  9 +++++
 .../java/org/apache/ratis/util/SlidingWindow.java  | 20 +++++++---
 .../grpc/client/GrpcClientProtocolService.java     |  9 ++++-
 ratis-proto/src/main/proto/Raft.proto              |  7 +++-
 .../ratis/server/impl/RaftServerConstants.java     |  3 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  3 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  8 ++--
 .../java/org/apache/ratis/RetryCacheTests.java     |  8 ++--
 .../impl/RaftStateMachineExceptionTests.java       | 10 ++---
 17 files changed, 127 insertions(+), 81 deletions(-)

commit 5680cf5fbb03362c65f0514adf104a5e29ea9b57
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Mar 11 12:16:22 2019 -0700

    RATIS-345. Watch requests should bypass sliding window.

 dev-support/run-test-repeatedly.sh                 |   4 +-
 .../org/apache/ratis/client/RaftClientRpc.java     |   7 +
 .../apache/ratis/client/impl/RaftClientImpl.java   | 107 +++++++-----
 .../apache/ratis/client/impl/UnorderedAsync.java   | 104 ++++++++++++
 .../org/apache/ratis/protocol/RaftClientReply.java |   5 -
 .../apache/ratis/protocol/TimeoutIOException.java  |   4 +
 .../org/apache/ratis/util/CollectionUtils.java     |   4 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java |   9 +-
 .../java/org/apache/ratis/util/PeerProxyMap.java   |   8 +-
 .../main/java/org/apache/ratis/grpc/GrpcUtil.java  |  18 +-
 .../grpc/client/GrpcClientProtocolClient.java      | 122 ++++++++++----
 .../grpc/client/GrpcClientProtocolService.java     | 184 ++++++++++++++++-----
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  36 +++-
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |   8 +-
 ratis-proto/src/main/proto/Grpc.proto              |   4 +
 .../org/apache/ratis/server/impl/LeaderState.java  |   2 +
 .../apache/ratis/server/impl/ServerProtoUtils.java |  18 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   6 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |  12 ++
 .../java/org/apache/ratis/WatchRequestTests.java   |  60 +++----
 .../ratis/grpc/TestWatchRequestWithGrpc.java       |  14 +-
 21 files changed, 567 insertions(+), 169 deletions(-)

commit 35838f032a4096d78843130fa1435bcddf5ce961
Author: Clay Baenziger <cwb@clayb.net>
Date:   Wed Dec 5 02:50:27 2018 -0500

    RATIS-463. Basic Distributed Test Harness for Ratis
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 README.md                                          |   2 +
 dev-support/vagrant/.gitignore                     |   5 +
 dev-support/vagrant/README.md                      |  52 +++
 dev-support/vagrant/Vagrantfile                    | 197 ++++++++++
 dev-support/vagrant/bin/start_ratis_load_gen.sh    |  31 ++
 dev-support/vagrant/bin/start_ratis_server.sh      |  27 ++
 dev-support/vagrant/docs/vagrantfile.bpmn          | 420 +++++++++++++++++++++
 dev-support/vagrant/docs/vagrantfile_bpmn.svg      |  17 +
 dev-support/vagrant/namazu_configs/hdd_config.toml |  26 ++
 dev-support/vagrant/run_all_tests.sh               |  66 ++++
 dev-support/vagrant/screenrcs/namazu_hdd_screenrc  |  32 ++
 .../screenrcs/ratis_ratis-hdd-slowdown_screenrc    |  33 ++
 .../vagrant/screenrcs/ratis_ratis-server_screenrc  |  33 ++
 13 files changed, 941 insertions(+)

commit 04fd22f0ab357818853bbcfdf180f867dc1aa5c8
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Sat Mar 9 08:35:33 2019 +0530

    RATIS-496. notifyIndexUpdate should inform about the term as well. Contributed by Mukul Kumar Singh.

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java     | 2 +-
 .../src/main/java/org/apache/ratis/statemachine/StateMachine.java      | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

commit 55030b233bb0a98449141a3a731020960e4403e9
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Mar 7 14:28:48 2019 -0800

    RATIS-494. Throw AssumptionViolatedException if a test fails to change leader.

 pom.xml                                            |  2 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java | 11 +----------
 .../src/test/java/org/apache/ratis/BaseTest.java   |  2 +-
 .../java/org/apache/ratis/JUnitRunListener.java    | 22 ++++++++++++----------
 .../apache/ratis/server/impl/ServerImplUtils.java  |  7 +++++--
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 18 +++++++++++++-----
 .../apache/ratis/server/ServerRestartTests.java    |  2 +-
 .../ratis/server/impl/LeaderElectionTests.java     | 18 ++++++------------
 .../server/impl/RaftReconfigurationBaseTest.java   |  6 ++++--
 9 files changed, 44 insertions(+), 44 deletions(-)

commit 59aa6f3c82440d6b9af06690d6ddf2cb5922ea6e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Mar 5 14:05:02 2019 -0800

    RATIS-493. PeerProxyMap should throw AlreadyClosedException for CLOSING and CLOSED states.

 .../org/apache/ratis/client/RaftClientRpc.java     | 12 +++--
 .../ratis/client/impl/RaftClientRpcWithProxy.java  |  6 +--
 .../main/java/org/apache/ratis/util/IOUtils.java   | 58 +++++++++++++++-------
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  8 ++-
 .../java/org/apache/ratis/util/ProtoUtils.java     | 18 +------
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../server/simulation/SimulatedClientRpc.java      |  8 +--
 8 files changed, 62 insertions(+), 52 deletions(-)

commit a0f98c1eb8d1f755433a669c0ddbff0d9601b97c
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Feb 26 01:03:02 2019 +0530

    RATIS-489. Server RetryCache should not use size-based eviction. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/server/RaftServerConfigKeys.java   | 12 ------------
 .../java/org/apache/ratis/server/impl/RaftServerImpl.java    |  3 +--
 .../main/java/org/apache/ratis/server/impl/RetryCache.java   | 12 ++++--------
 .../org/apache/ratis/server/impl/RetryCacheTestUtil.java     |  4 ++--
 4 files changed, 7 insertions(+), 24 deletions(-)

commit 29921d2840aa887f55ae650c544147dd8f60fedd
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sun Feb 17 01:09:10 2019 +0800

    RATIS-411. Remove "public" from ServerProtoUtils.  Contributed by Ritesh

 .../main/java/org/apache/ratis/util/NetUtils.java  | 10 ++++-----
 .../apache/ratis/server/impl/ServerProtoUtils.java | 24 +++++++++++-----------
 2 files changed, 17 insertions(+), 17 deletions(-)

commit 386f70284277a87214115e31bc92752b443bd2e6
Author: Josh Elser <elserj@apache.org>
Date:   Fri Feb 8 19:40:28 2019 -0500

    RATIS-481. Encapsulate the RaftLog reading in its own class
    
    The LogStateMachine was getting really ugly with all of the code
    to seek and read the RaftLog, unwrapping the RaftLog index to the
    LogService index.
    
    This will help encapsulate the changes for RATIS-477
    
    Closes #12

 .../org/apache/ratis/logservice/api/LogReader.java |   4 +-
 .../org/apache/ratis/logservice/api/LogWriter.java |   4 +-
 .../ratis/logservice/impl/LogReaderImpl.java       |   8 +-
 .../ratis/logservice/impl/LogWriterImpl.java       |  10 +-
 .../logservice/server/LogServiceRaftLogReader.java | 160 +++++++++++++++++++++
 .../ratis/logservice/server/LogStateMachine.java   | 103 +++----------
 .../ratis/logservice/LogServiceReadWriteBase.java  | 103 ++++++++++++-
 .../src/test/resources/log4j.properties            |   1 +
 8 files changed, 290 insertions(+), 103 deletions(-)

commit b91700193cc9d153f300a81e1b15bb6e650dcf37
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Feb 11 14:36:00 2019 +0530

    RATIS-426. StateMachine should be notified about index updates when confentry/no op entries are processed. Contributed by Mukul Kumar Singh.

 .../java/org/apache/ratis/server/impl/RaftServerImpl.java     |  3 +++
 .../main/java/org/apache/ratis/statemachine/StateMachine.java | 11 +++++++++++
 2 files changed, 14 insertions(+)

commit dbe103eecc5cae0778917e29f77d543cf8888496
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Feb 2 14:42:17 2019 -0800

    RATIS-397. Remove the deprecated getMaxTimeout() method from MiniRaftCluster.  Contributed by Ritesh

 .../test/java/org/apache/ratis/grpc/MiniRaftClusterWithGrpc.java  | 2 +-
 .../org/apache/ratis/hadooprpc/MiniRaftClusterWithHadoopRpc.java  | 2 +-
 .../java/org/apache/ratis/netty/MiniRaftClusterWithNetty.java     | 2 +-
 ratis-server/src/test/java/org/apache/ratis/MiniRaftCluster.java  | 6 ------
 ratis-server/src/test/java/org/apache/ratis/RaftBasicTests.java   | 8 ++++----
 ratis-server/src/test/java/org/apache/ratis/RaftTestUtil.java     | 4 ++--
 .../ratis/server/simulation/MiniRaftClusterWithSimulatedRpc.java  | 3 ++-
 .../test/java/org/apache/ratis/statemachine/TestStateMachine.java | 3 ++-
 8 files changed, 13 insertions(+), 17 deletions(-)

commit 447ccfb1f152a605c10e06f940df17bc5de6ea37
Author: Josh Elser <elserj@apache.org>
Date:   Wed Jan 9 11:22:13 2019 -0500

    RATIS-470. De-couple the LogService "index" from the RaftLog "index"
    
    We've been using the Raft log index as the "record offset" that we expose
    to users via the LogService API. However, because one message that we push
    to the Raft log may contain many LogService records, this generates
    incorrect results.
    
    We have to "hide" the Raft log index, and identify just the LogService records
    so that we're exposing only their Log's information (e.g. none of the interal
    Raft quorum configuration entries).
    
    Closes #7

 .../org/apache/ratis/logservice/api/LogWriter.java |   7 +-
 .../ratis/logservice/impl/LogWriterImpl.java       |  38 ++++---
 .../ratis/logservice/server/LogStateMachine.java   | 114 ++++++++++++++++++---
 .../ratis/logservice/util/LogServiceProtoUtil.java |   7 +-
 .../ratis/logservice/LogServiceReadWriteBase.java  |  63 +++++++++++-
 .../ratis/logservice/server/TestMetaServer.java    |   5 +-
 6 files changed, 185 insertions(+), 49 deletions(-)

commit f283ffacb771130c70bdebb61d020fbc0c2aca46
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Wed Jan 30 14:18:39 2019 +0530

    RATIS-460. Once a snapshot is created an exception will be thrown when reply entries after restarting cluster. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/server/impl/ConfigurationManager.java   | 12 ++++--------
 .../org/apache/ratis/statemachine/RaftSnapshotBaseTest.java  | 12 ++++++++----
 2 files changed, 12 insertions(+), 12 deletions(-)

commit d0648a520a24ba2a9df6a6d7c3716cfdc3581b82
Author: Vlasimir Rodionov <vrodionov@HW14350.local>
Date:   Tue Jan 29 15:22:18 2019 -0800

    RATIS-425: LogReader readBulk should validate number of records

 .../org/apache/ratis/logservice/impl/LogReaderImpl.java    | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

commit aa6ed83a1940dec05f021c3340b316d3f7bce00a
Author: Josh Elser <elserj@apache.org>
Date:   Wed Jan 9 15:28:20 2019 -0500

    RATIS-473. Clarify size and length methods on LogStream
    
    getLength() was meant to be the number of records in a log
    but was implemented as the size in bytes of the records in
    the log. This commit adds a getSize() which takes the old
    implementation of getLength(), and then reimplements
    getLength() as the number of records in the log.
    
    Signed-off-by: Vladimir Rodionov <vrodionov@apache.org>
    Signed-off-by: Rajeshbabu Chintaguntla <rajeshbabu@apache.org>

 .../org/apache/ratis/logservice/api/LogStream.java |  6 ++++
 .../ratis/logservice/impl/LogStreamImpl.java       | 35 +++++++++++++++-------
 .../ratis/logservice/server/LogStateMachine.java   | 30 +++++++++++++------
 .../ratis/logservice/util/LogServiceProtoUtil.java | 18 +++++++++++
 ratis-logservice/src/main/proto/LogService.proto   | 12 ++++++++
 .../ratis/logservice/LogServiceReadWriteBase.java  | 10 +++----
 6 files changed, 87 insertions(+), 24 deletions(-)

commit d1ace258929b6771502c1f9f8a37903c63171b5c
Author: Josh Elser <elserj@apache.org>
Date:   Wed Jan 9 14:57:41 2019 -0500

    RATIS-472. Clean up output for `read` logservice shell command

 .../org/apache/ratis/logservice/shell/commands/ReadLogCommand.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit f614d713d9fcf1a906991faeb51c01ae445c4f90
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jan 25 14:38:03 2019 -0800

    RATIS-417. Fix checkstyle warnings in PureJavaCrc32C.  Contributed by Dinesh Chitlangia

 .../java/org/apache/ratis/util/PureJavaCrc32C.java | 1071 ++++++++++----------
 1 file changed, 535 insertions(+), 536 deletions(-)

commit e5692f3d7d59cdaed6ff4967c4595119996ea48c
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jan 25 14:32:40 2019 -0800

    RATIS-416. Fix checkstyle warnings in ClientImplUtils.  Contributed by Dinesh Chitlangia

 .../main/java/org/apache/ratis/client/impl/ClientImplUtils.java   | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 36fa43436906e818182935585d960cca2407e678
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jan 25 13:55:24 2019 -0800

    RATIS-414. Fix checkstyle warnings in RaftClient and RaftClientImpl.  Contributed by Dinesh Chitlangia

 .../src/main/java/org/apache/ratis/client/RaftClient.java     |  4 ++--
 .../java/org/apache/ratis/client/impl/RaftClientImpl.java     | 11 ++++++-----
 2 files changed, 8 insertions(+), 7 deletions(-)

commit 61bae7d81ee6439b891d852496004e8cd98ea981
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jan 25 12:12:52 2019 -0800

    RATIS-476. checkstyle SuppressionCommentFilter and SuppressWithNearbyCommentFilter are in wrong module.  Contributed by Dinesh Chitlangia

 dev-support/checkstyle.xml | 4 ++--
 pom.xml                    | 9 +++++++++
 2 files changed, 11 insertions(+), 2 deletions(-)

commit 32a04999d84935d02c9107263f00baee9f039245
Author: Josh Elser <elserj@apache.org>
Date:   Thu Jan 3 15:49:44 2019 -0500

    RATIS-469. Fix RAT failures from missing license headers
    
    Signed-off-by: Vladimir Rodionov <vrodionov@apache.org>

 ratis-logservice/Dockerfile                           | 16 ++++++++++++++++
 ratis-logservice/README.md                            | 16 ++++++++++++++++
 ratis-logservice/docker-compose.yml                   | 16 ++++++++++++++++
 ratis-logservice/src/assembly/assembly.xml            | 14 ++++++++++++++
 .../org/apache/ratis/logservice/shell/Command.java    | 19 ++++++++++++++++++-
 .../apache/ratis/logservice/shell/CommandFactory.java | 19 ++++++++++++++++++-
 .../ratis/logservice/shell/LogServiceShell.java       | 19 ++++++++++++++++++-
 .../ratis/logservice/shell/LogServiceShellOpts.java   | 19 ++++++++++++++++++-
 .../logservice/shell/commands/CreateLogCommand.java   | 19 ++++++++++++++++++-
 .../logservice/shell/commands/DeleteLogCommand.java   | 17 +++++++++++++++++
 .../ratis/logservice/shell/commands/ExitCommand.java  | 17 +++++++++++++++++
 .../ratis/logservice/shell/commands/HelpCommand.java  | 17 +++++++++++++++++
 .../logservice/shell/commands/ListLogsCommand.java    | 17 +++++++++++++++++
 .../logservice/shell/commands/PutToLogCommand.java    | 17 +++++++++++++++++
 .../logservice/shell/commands/ReadLogCommand.java     | 17 +++++++++++++++++
 15 files changed, 254 insertions(+), 5 deletions(-)

commit 29850741e635d31e49274dec610f106c001b11f0
Author: Josh Elser <elserj@apache.org>
Date:   Sun Dec 23 23:46:00 2018 -0500

    RATIS-372. Docker containers and docker-compose orchestration for the logservice
    
    Signed-off-by: Rajeshbabu Chintaguntla <rajeshbabu@apache.org>

 ratis-logservice/Dockerfile                | 19 ++++++++++
 ratis-logservice/README.md                 | 24 +++++++-----
 ratis-logservice/docker-compose.yml        | 59 ++++++++++++++++++++++++++++++
 ratis-logservice/src/assembly/assembly.xml | 16 ++++++++
 4 files changed, 108 insertions(+), 10 deletions(-)

commit 52c10915f752a09576707c274e0858f595f8e185
Author: Josh Elser <elserj@apache.org>
Date:   Sun Dec 23 23:16:42 2018 -0500

    RATIS-468. Create a tarball assembly for logservice
    
    Signed-off-by: Rajeshbabu Chintaguntla <rajeshbabu@apache.org>

 ratis-logservice/README.md                 | 16 +++++++++++++++-
 ratis-logservice/pom.xml                   |  7 +++++--
 ratis-logservice/src/assembly/assembly.xml | 16 ++++++++++++++++
 3 files changed, 36 insertions(+), 3 deletions(-)

commit 5ae2490deee1cb30347d2c2ec492010a4567a181
Author: Josh Elser <elserj@apache.org>
Date:   Tue Dec 4 22:32:20 2018 -0500

    RATIS-387. An interactive shell for the logservice
    
    Includes instructions on how to start a local quorum and connect the shell to it

 pom.xml                                            |   5 +
 ratis-logservice/README.md                         |  51 ++++++++
 ratis-logservice/pom.xml                           |  14 ++-
 .../apache/ratis/logservice/server/ServerOpts.java |   2 +-
 .../org/apache/ratis/logservice/shell/Command.java |  15 +++
 .../ratis/logservice/shell/CommandFactory.java     |  50 ++++++++
 .../ratis/logservice/shell/LogServiceShell.java    | 133 +++++++++++++++++++++
 .../logservice/shell/LogServiceShellOpts.java      |   8 ++
 .../shell/commands/CreateLogCommand.java           |  30 +++++
 .../shell/commands/DeleteLogCommand.java           |  32 +++++
 .../logservice/shell/commands/ExitCommand.java     |  20 ++++
 .../logservice/shell/commands/HelpCommand.java     |  23 ++++
 .../logservice/shell/commands/ListLogsCommand.java |  42 +++++++
 .../logservice/shell/commands/PutToLogCommand.java |  36 ++++++
 .../logservice/shell/commands/ReadLogCommand.java  |  53 ++++++++
 15 files changed, 508 insertions(+), 6 deletions(-)

commit b7b7e7e0e270531cbe916faed47e38b5e0b21dc3
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Fri Dec 28 10:56:16 2018 +0530

    RATIS-464. FileStore example readme is incorrect. Contributed by Mukul Kumar Singh.

 README.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a8c4ca056b3b3bfb0537da9da725198db5b818e1
Author: Xiaoyu Yao <xyao@apache.org>
Date:   Thu Dec 20 12:21:07 2018 -0800

    RATIS-454. Update to ratis-thirdparty 0.2.0. Contributed by Josh Elser.

 pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 5a8495eb287339a528b153396da6cd8c79c676b5
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Dec 20 22:00:38 2018 +0530

    RATIS-462. Add readStateMachineData api for FileStoreStateMachine. Contributed by Mukul Kumar Singh.

 .../ratis/examples/filestore/FileStoreClient.java  |  1 +
 .../examples/filestore/FileStoreStateMachine.java  | 23 ++++++++++++++++++++++
 ratis-proto/src/main/proto/Examples.proto          |  1 +
 3 files changed, 25 insertions(+)

commit 09cc126d7364fdfc23cac4d82af1fc84310c3884
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Dec 20 12:27:59 2018 +0530

    RATIS-456. Add a load generator for Filestore example. Contributed by Mukul Kumar Singh.

 README.md                                          | 40 +++++++++
 ratis-examples/pom.xml                             |  7 +-
 ratis-examples/src/main/bin/client.sh              |  2 +-
 ratis-examples/src/main/bin/server.sh              |  6 +-
 .../ratis/examples/arithmetic/cli/Arithmetic.java  | 37 +++++++++
 .../ratis/examples/arithmetic/cli/Client.java      |  1 +
 .../ratis/examples/arithmetic/cli/Server.java      |  1 +
 .../examples/{arithmetic => common}/Runner.java    | 38 +++++----
 .../{arithmetic/cli => common}/SubCommandBase.java |  2 +-
 .../ratis/examples/filestore/FileStoreClient.java  |  4 +
 .../ratis/examples/filestore/cli/Client.java       | 83 +++++++++++++++++++
 .../ratis/examples/filestore/cli/FileStore.java    | 36 ++++++++
 .../ratis/examples/filestore/cli/LoadGen.java      | 93 +++++++++++++++++++++
 .../ratis/examples/filestore/cli/Server.java       | 96 ++++++++++++++++++++++
 14 files changed, 423 insertions(+), 23 deletions(-)

commit c038d2e215620d312407e14843949f6873cd7b04
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Dec 15 15:11:29 2018 +0800

    RATIS-246. Support secure gRPC endpoint with mTLS in Ratis.  Contributed by Xiaoyu Yao

 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java | 50 ++++++++++++++++
 .../java/org/apache/ratis/grpc/GrpcFactory.java    | 23 +++++++-
 .../java/org/apache/ratis/grpc/GrpcTlsConfig.java  | 68 ++++++++++++++++++++++
 .../grpc/client/GrpcClientProtocolClient.java      | 32 ++++++++--
 .../ratis/grpc/client/GrpcClientProtocolProxy.java |  5 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 12 +++-
 .../ratis/grpc/client/GrpcClientStreamer.java      |  7 ++-
 .../apache/ratis/grpc/client/GrpcOutputStream.java |  5 +-
 .../grpc/server/GrpcServerProtocolClient.java      | 30 ++++++++--
 .../org/apache/ratis/grpc/server/GrpcService.java  | 55 ++++++++++++++---
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  8 +--
 11 files changed, 261 insertions(+), 34 deletions(-)

commit 76e89911ad8591cd16a460095cbb22a8a5625347
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Dec 14 10:14:14 2018 +0800

    RATIS-326. Introduce truncateStateMachineData API in StateMachine interface.  Contributed by Shashikant Banerjee

 .../apache/ratis/server/storage/RaftLogWorker.java    | 19 +++++++++++++++----
 .../apache/ratis/server/storage/SegmentedRaftLog.java |  2 +-
 .../org/apache/ratis/statemachine/StateMachine.java   | 12 ++++++++++++
 3 files changed, 28 insertions(+), 5 deletions(-)

commit cb68b56c2cb02ff3953b146d1029156941f33d3a
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Dec 14 09:56:27 2018 +0800

    RATIS-452. Fix bugs in RaftExceptionBaseTest and RaftReconfigurationBaseTest.

 .../main/java/org/apache/ratis/util/ExitUtils.java | 119 +++++++++----
 .../src/test/java/org/apache/ratis/BaseTest.java   |  10 ++
 .../hadooprpc/TestLeaderElectionWithHadoopRpc.java |   6 +-
 .../hadooprpc/TestRaftExceptionWithHadoopRpc.java  |   9 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   8 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  56 +++++-
 .../test/java/org/apache/ratis/RaftBasicTests.java |   4 +-
 .../org/apache/ratis/RaftExceptionBaseTest.java    | 190 +++++++++------------
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  30 ++--
 .../server/impl/RaftReconfigurationBaseTest.java   |  17 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  23 +--
 .../ratis/server/storage/TestSegmentedRaftLog.java |   1 +
 .../java/org/apache/ratis/util/TestExitUtils.java  |  59 +++++++
 13 files changed, 341 insertions(+), 191 deletions(-)

commit 00274fa39073e359433005c96097efaa24024702
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Dec 11 13:21:41 2018 -0800

    RATIS-453. When retry failed on an async call, it should fails all the following calls in the sliding window.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  62 ++++++------
 .../ratis/protocol/AlreadyClosedException.java     |   6 +-
 .../java/org/apache/ratis/retry/RetryPolicies.java |   4 +-
 .../java/org/apache/ratis/retry/RetryPolicy.java   |   5 +-
 .../java/org/apache/ratis/util/SlidingWindow.java  |  41 +++++++-
 .../util/function/CheckedFunctionWithTimeout.java  |   2 +-
 .../apache/ratis/util/function/FunctionUtils.java  |  34 +++++++
 .../src/test/java/org/apache/ratis/BaseTest.java   |  54 ++++++-----
 .../grpc/client/GrpcClientProtocolClient.java      |   3 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   9 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 106 ++++++++++++++++-----
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  12 +++
 12 files changed, 252 insertions(+), 86 deletions(-)

commit 3b0be0287f2c15de90552a6a83b58251a0eab8e8
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Dec 6 16:56:28 2018 -0800

    RATIS-402. Limit the data size in RaftLogWorker queue.

 .../org/apache/ratis/util/DataBlockingQueue.java   | 154 +++++++++++++++++++++
 .../main/java/org/apache/ratis/util/DataQueue.java |  12 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  23 ++-
 .../apache/ratis/server/storage/RaftLogWorker.java |  26 ++--
 .../ratis/server/storage/SegmentedRaftLog.java     |   4 +
 .../apache/ratis/util/TestDataBlockingQueue.java   | 117 ++++++++++++++++
 .../java/org/apache/ratis/util/TestDataQueue.java  |  48 ++++---
 7 files changed, 349 insertions(+), 35 deletions(-)

commit 74a3a7ce2db6b50bf8d1c6d57dee38a44461795f
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Dec 6 11:44:35 2018 -0800

    RATIS-450. Make Timestamp and TimeDuration value-based classes.

 .../java/org/apache/ratis/util/TimeDuration.java   | 55 +++++++++++++++++-----
 .../main/java/org/apache/ratis/util/Timestamp.java | 28 +++++++----
 .../org/apache/ratis/server/impl/FollowerInfo.java |  6 +--
 .../apache/ratis/server/impl/FollowerState.java    |  4 +-
 .../apache/ratis/server/impl/LeaderElection.java   |  4 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  8 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   |  6 +--
 .../org/apache/ratis/server/impl/RoleInfo.java     |  6 +--
 .../org/apache/ratis/server/impl/ServerState.java  |  8 ++--
 .../apache/ratis/server/impl/WatchRequests.java    |  2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java |  2 +-
 .../server/simulation/SimulatedRequestReply.java   | 15 +++---
 .../ratis/TestRaftServerLeaderElectionTimeout.java |  2 +-
 .../ratis/TestRaftServerSlownessDetection.java     |  2 +-
 .../org/apache/ratis/util/TestTimeDuration.java    | 18 +++----
 16 files changed, 107 insertions(+), 63 deletions(-)

commit 087652d47704dc8b9edf7d28f8e6268af1364b1b
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Dec 6 11:32:13 2018 -0800

    RATIS-449. Move the functional interfaces to a new package.

 .../main/java/org/apache/ratis/conf/ConfUtils.java |  4 +--
 .../main/java/org/apache/ratis/util/JavaUtils.java |  2 ++
 .../main/java/org/apache/ratis/util/LifeCycle.java |  9 +++---
 .../main/java/org/apache/ratis/util/LogUtils.java  | 34 ++++++++++------------
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  3 +-
 .../main/java/org/apache/ratis/util/TaskQueue.java |  3 +-
 .../org/apache/ratis/util/TimeoutScheduler.java    |  3 +-
 .../util/{ => function}/CheckedBiConsumer.java     | 10 +++----
 .../ratis/util/{ => function}/CheckedConsumer.java |  4 +--
 .../ratis/util/{ => function}/CheckedFunction.java |  8 ++---
 .../ratis/util/{ => function}/CheckedRunnable.java |  2 +-
 .../ratis/util/{ => function}/CheckedSupplier.java |  8 ++---
 .../src/test/java/org/apache/ratis/BaseTest.java   |  7 +++--
 .../apache/ratis/examples/filestore/FileInfo.java  | 11 +++++--
 .../apache/ratis/examples/filestore/FileStore.java | 17 ++++++++---
 .../ratis/examples/filestore/FileStoreClient.java  | 13 +++++++--
 .../java/org/apache/ratis/TestMultiRaftGroup.java  |  6 ++--
 .../examples/filestore/FileStoreBaseTest.java      | 17 ++++++++---
 .../main/java/org/apache/ratis/grpc/GrpcUtil.java  |  8 +++--
 .../grpc/client/GrpcClientProtocolClient.java      | 31 +++++++++++++-------
 ...mbinedClientProtocolClientSideTranslatorPB.java | 13 +++++++--
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 15 ++++++----
 .../apache/ratis/server/impl/RaftServerProxy.java  | 13 +++++++--
 .../ratis/server/storage/LogOutputStream.java      |  6 ++--
 .../ratis/server/storage/RaftLogSequentialOps.java |  4 +--
 .../server/storage/SegmentedRaftLogFormat.java     |  4 +--
 .../java/org/apache/ratis/MiniRaftCluster.java     | 32 ++++++++++++++++----
 .../java/org/apache/ratis/WatchRequestTests.java   |  5 +++-
 .../ratis/server/impl/GroupManagementBaseTest.java |  4 +--
 29 files changed, 194 insertions(+), 102 deletions(-)

commit bef9a72e32ee93adf3d532c2397e01e098afff59
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Dec 6 10:38:38 2018 -0800

    RATIS-447. LogAppender should times out if readStateMachineData takes a long time.

 .../org/apache/ratis/util/CollectionUtils.java     |   8 +
 .../main/java/org/apache/ratis/util/DataQueue.java | 142 +++++++++++++++++
 .../java/org/apache/ratis/util/TimeDuration.java   |  24 ++-
 .../main/java/org/apache/ratis/util/Timestamp.java |  19 ++-
 .../util/function/CheckedFunctionWithTimeout.java  |  32 ++++
 .../apache/ratis/util/function/TriConsumer.java    |  28 ++++
 .../org/apache/ratis/grpc/server/GrpcService.java  |   4 +-
 .../hadooprpc/TestLogAppenderWithHadoopRpc.java    |  25 +++
 .../apache/ratis/server/RaftServerConfigKeys.java  |  28 ++--
 .../org/apache/ratis/server/impl/LogAppender.java  |  98 ++++--------
 .../org/apache/ratis/server/impl/ServerState.java  |   2 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |  20 ++-
 .../ratis/server/storage/SegmentedRaftLog.java     |   2 +-
 .../java/org/apache/ratis/LogAppenderTests.java    | 134 +++++++---------
 .../test/java/org/apache/ratis/RaftBasicTests.java |   1 -
 .../org/apache/ratis/RaftExceptionBaseTest.java    |   2 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +-
 .../apache/ratis/grpc/TestLogAppenderWithGrpc.java |  25 +++
 .../ratis/netty/TestLogAppenderWithNetty.java      |  25 +++
 .../TestLogAppenderWithSimulatedRpc.java           |  25 +++
 .../java/org/apache/ratis/util/TestDataQueue.java  | 172 +++++++++++++++++++++
 .../org/apache/ratis/util/TestTimeDuration.java    |  65 +++++++-
 22 files changed, 707 insertions(+), 178 deletions(-)

commit 27a8cbb49db95327d1c70b8665944510083de3d4
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Dec 5 14:12:18 2018 -0800

    RATIS-448. IllegalStateException seen when log to be truncated does not exist.  Contributed by Lokesh Jain

 .../apache/ratis/server/storage/RaftLogWorker.java | 27 +++++++++++-----------
 1 file changed, 13 insertions(+), 14 deletions(-)

commit 046782430a9aee3094869ca2b63bcf0194c70e93
Author: Josh Elser <elserj@apache.org>
Date:   Wed Nov 28 12:59:14 2018 -0500

    RATIS-378. Consolidate common logic across logservice servers
    
    Signed-off-by: Rajeshbabu Chintaguntla <rajeshbabu@apache.org>

 .../ratis/logservice/client/LogServiceClient.java  |   2 +-
 .../apache/ratis/logservice/common/Constants.java  |   6 +-
 .../apache/ratis/logservice/server/BaseServer.java |  94 +++++++++++++++
 .../LogServer.java}                                | 131 +++++++++------------
 .../ratis/logservice/server/MetaStateMachine.java  |  21 ++--
 .../{MasterServer.java => MetadataServer.java}     | 124 ++++++++-----------
 .../apache/ratis/logservice/server/ServerOpts.java | 119 +++++++++++++++++++
 .../ratis/logservice/util/LogServiceUtils.java     |   1 -
 .../ratis/logservice/server/TestMetaServer.java    |  14 ++-
 .../ratis/logservice/util/LogServiceCluster.java   |  57 +++++----
 10 files changed, 374 insertions(+), 195 deletions(-)

commit d72d9c6eb8cb32fa4058b5ab5710e9cd45e2653d
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Dec 4 17:20:11 2018 -0800

    RATIS-359. Add timeout support for Watch requests.

 .../main/java/org/apache/ratis/conf/ConfUtils.java |   9 ++
 .../ratis/protocol/NotReplicatedException.java     |   6 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |   6 +
 .../java/org/apache/ratis/util/StringUtils.java    |  19 +++
 .../java/org/apache/ratis/util/TimeDuration.java   |  23 ++++
 .../main/java/org/apache/ratis/util/Timestamp.java |  12 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  25 +++-
 .../org/apache/ratis/server/impl/LeaderState.java  |  16 ++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   2 +-
 .../apache/ratis/server/impl/WatchRequests.java    | 113 ++++++++++++----
 .../java/org/apache/ratis/WatchRequestTests.java   | 150 +++++++++++++++++----
 .../org/apache/ratis/util/TestTimeDuration.java    |  18 ++-
 12 files changed, 338 insertions(+), 61 deletions(-)

commit a56bfcebd5bc44582a51fb0679a14fb5802f8702
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Dec 4 11:07:35 2018 -0800

    RATIS-444. Improve logging in RaftLogWorker.  Contributed by Lokesh Jain

 .../apache/ratis/server/storage/RaftLogWorker.java    | 19 +++++++++++++++----
 1 file changed, 15 insertions(+), 4 deletions(-)

commit 9296a3bc0b79cf73a6576e0b4c0b981d1ea3b221
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sun Dec 2 16:57:20 2018 -0800

    RATIS-443. FollowerState.inLogSync can be incorrectly cleared in appendEntriesAsync.

 ratis-proto/src/main/proto/Raft.proto              |   2 +-
 .../apache/ratis/server/impl/FollowerState.java    |  42 +++++--
 .../apache/ratis/server/impl/LeaderElection.java   |   2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 135 ++++++++++++---------
 5 files changed, 114 insertions(+), 69 deletions(-)

commit 609773e03c96f733829a93cc5bbcc3febd25408d
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Dec 1 12:50:04 2018 -0800

    RATIS-438. RaftBasicTests.testWithLoad may fail.

 .../main/java/org/apache/ratis/util/JavaUtils.java |  19 ++-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 186 ++++++++++-----------
 .../test/java/org/apache/ratis/RaftBasicTests.java |  92 +++++-----
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  10 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   6 +-
 .../apache/ratis/grpc/TestRaftAsyncWithGrpc.java   |   2 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  42 ++---
 7 files changed, 187 insertions(+), 170 deletions(-)

commit 959d493c0eacce6712bffe39924bd0440d11a6b0
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 30 14:17:45 2018 -0800

    RATIS-442. In RaftClient, remove ReplicationLevel parameter from send(..) and sendAsync(..) methods.

 .../java/org/apache/ratis/client/RaftClient.java   | 18 +---
 .../apache/ratis/client/impl/RaftClientImpl.java   | 10 +--
 .../apache/ratis/protocol/RaftClientRequest.java   | 17 ++--
 .../hadooprpc/TestRetryCacheWithHadoopRpc.java     | 29 +------
 ratis-proto/src/main/proto/Raft.proto              |  1 -
 .../org/apache/ratis/server/impl/LeaderState.java  | 12 +--
 .../apache/ratis/server/impl/PendingRequest.java   | 44 +---------
 .../apache/ratis/server/impl/PendingRequests.java  | 79 +----------------
 .../apache/ratis/server/impl/RaftServerImpl.java   |  9 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 13 +--
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 25 ++----
 .../test/java/org/apache/ratis/RaftBasicTests.java | 82 +++---------------
 .../java/org/apache/ratis/RetryCacheTests.java     | 51 +++++------
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  | 98 +---------------------
 .../ratis/netty/TestRetryCacheWithNettyRpc.java    | 28 +------
 .../simulation/TestRetryCacheWithSimulatedRpc.java | 28 +------
 16 files changed, 74 insertions(+), 470 deletions(-)

commit a1edeabea016ff7c55d4459fdb96c70a0ff132c7
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 30 14:02:44 2018 -0800

    RATIS-439. TestSegmentedRaftLog is failing.

 .../org/apache/ratis/util/AutoCloseableLock.java   | 20 +++++--
 .../ratis/util/AutoCloseableReadWriteLock.java     | 68 ++++++++++++++++++++++
 .../apache/ratis/server/storage/RaftLogCache.java  | 23 ++++++--
 .../ratis/server/storage/SegmentedRaftLog.java     | 29 ++++-----
 .../ratis/server/storage/TestCacheEviction.java    |  4 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java | 11 +++-
 6 files changed, 127 insertions(+), 28 deletions(-)

commit 6b63986de09d602dd8619f808496226ec1c5a3cd
Author: Josh Elser <elserj@apache.org>
Date:   Fri Nov 30 15:06:39 2018 -0500

    RATIS-446. Drop md5 and properly suffix sha512 file name
    
    Signed-off-by: Tsz Wo Nicholas Sze <szetszwo@apache.org>

 dev-support/make_rc.sh | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit d4ec63a0b93c5fd64d0c9b769e99f723d43e43b8
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Nov 26 16:33:31 2018 -0800

    RATIS-427. Better group info API in RaftClient.

 .../java/org/apache/ratis/client/RaftClient.java   |  6 +--
 .../apache/ratis/client/impl/ClientProtoUtils.java |  8 ++--
 .../apache/ratis/client/impl/RaftClientImpl.java   | 16 +++----
 .../org/apache/ratis/protocol/GroupListReply.java  | 10 ++--
 .../java/org/apache/ratis/protocol/RaftPeer.java   | 19 ++++++++
 .../java/org/apache/ratis/util/ProtoUtils.java     | 17 ++-----
 ...oopRpc.java => TestGroupInfoWithHadoopRpc.java} |  6 +--
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  2 +-
 ...rmationBaseTest.java => GroupInfoBaseTest.java} | 54 +++++++---------------
 ...ionWithGrpc.java => TestGroupInfoWithGrpc.java} |  6 +--
 ...nWithNetty.java => TestGroupInfoWithNetty.java} |  6 +--
 ...Rpc.java => TestGroupInfoWithSimulatedRpc.java} |  6 +--
 14 files changed, 76 insertions(+), 84 deletions(-)

commit 0b22e0935a95aea1eb70d38e713526d71d71df45
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Nov 22 11:41:35 2018 -0800

    RATIS-430. RaftLogCache#getCachedSegmentNum hits ConcurrentModificationException.

 .../server/storage/CacheInvalidationPolicy.java    |  15 +-
 .../apache/ratis/server/storage/RaftLogCache.java  | 301 +++++++++++++++------
 .../ratis/server/storage/RaftStorageDirectory.java |   4 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |  52 +---
 .../ratis/server/storage/TestCacheEviction.java    |  11 +-
 5 files changed, 246 insertions(+), 137 deletions(-)

commit b600fc21df1c3b72be1702e2bf57295cdcf55220
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sun Nov 18 19:25:27 2018 -0800

    RATIS-352. Persist commit index in Raft log.

 .../java/org/apache/ratis/TestBatchAppend.java     | 28 ++++---
 .../apache/ratis/netty/server/NettyRpcService.java |  9 ++-
 ratis-proto/src/main/proto/Raft.proto              |  5 ++
 .../org/apache/ratis/server/impl/LeaderState.java  | 16 +++-
 .../apache/ratis/server/impl/PendingRequests.java  | 18 +----
 .../apache/ratis/server/impl/RaftServerImpl.java   |  7 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  2 +-
 .../ratis/server/impl/RaftServerRpcWithProxy.java  |  2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java | 15 ++++
 .../org/apache/ratis/server/impl/ServerState.java  |  7 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |  5 +-
 .../org/apache/ratis/server/storage/RaftLog.java   | 87 ++++++++++++++++++----
 .../ratis/server/storage/RaftLogSequentialOps.java | 12 +++
 .../ratis/server/storage/SegmentedRaftLog.java     |  8 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 27 +++++++
 .../apache/ratis/server/ServerRestartTests.java    | 81 +++++++++++++++++---
 .../server/impl/RaftReconfigurationBaseTest.java   |  8 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  2 +
 .../ratis/netty/TestServerRestartWithNetty.java    |  4 +
 19 files changed, 268 insertions(+), 75 deletions(-)

commit 8136a972c178528d06f22a0dfdc6e42c3ce17c44
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Wed Nov 21 23:51:13 2018 +0530

    RATIS-410. Raft log entry with stateMachineData may cause OOM. Contributed by Shashikant Banerjee.

 .../main/java/org/apache/ratis/server/RaftServerConfigKeys.java  | 9 +++++++++
 .../java/org/apache/ratis/server/storage/SegmentedRaftLog.java   | 9 ++++++++-
 2 files changed, 17 insertions(+), 1 deletion(-)

commit 1dd3d0bffdddf571d5de3b38b6c998b7e26fe10a
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 20 13:40:40 2018 -0800

    trunk$mvn versions:set -DnewVersion=0.4.0-SNAPSHOT

 pom.xml                      | 2 +-
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-logservice/pom.xml     | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto/pom.xml          | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 ratis-test/pom.xml           | 2 +-
 13 files changed, 13 insertions(+), 13 deletions(-)

commit 51a306cb60f77036fc84ddfa42746d61d740c234
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 20 13:24:09 2018 -0800

    trunk$ mvn versions:set -DnewVersion=0.4.0

 pom.xml                      | 2 +-
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-logservice/pom.xml     | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto/pom.xml          | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 ratis-test/pom.xml           | 2 +-
 13 files changed, 13 insertions(+), 13 deletions(-)

commit 68bb4c9189659da48f2069f3f96754914bc20d30
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Nov 19 17:28:19 2018 -0800

    RATIS-429. RaftReconfigurationTest fails intermittently.

 .../TestRaftReconfigurationWithHadoopRpc.java      |   7 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |   4 +-
 .../server/impl/RaftReconfigurationBaseTest.java   | 189 +++++++++------------
 .../ratis/server/impl/RaftServerTestUtil.java      |   7 +-
 .../grpc/TestRaftReconfigurationWithGrpc.java      |  11 +-
 .../netty/TestRaftReconfigurationWithNetty.java    |  10 +-
 .../TestRaftReconfigurationWithSimulatedRpc.java   |  10 +-
 7 files changed, 96 insertions(+), 142 deletions(-)

commit 96a3b1bfeda319e8543da3dbcd2afadd5468a803
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Nov 17 15:52:52 2018 -0800

    RATIS-409. Watch requests may not work if there is a conf change.

 .../main/java/org/apache/ratis/util/JavaUtils.java |   5 +
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  18 ++-
 .../grpc/server/GrpcServerProtocolService.java     |   4 +
 .../org/apache/ratis/server/impl/FollowerInfo.java |  65 ++++++-----
 .../org/apache/ratis/server/impl/LeaderState.java  |  92 ++++++++++-----
 .../org/apache/ratis/server/impl/LogAppender.java  |   5 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   6 +-
 .../apache/ratis/server/storage/RaftLogIndex.java  |  76 ++++++++++++
 .../java/org/apache/ratis/MiniRaftCluster.java     |  15 +++
 .../java/org/apache/ratis/WatchRequestTests.java   | 130 +++++++--------------
 .../ratis/server/impl/RaftServerTestUtil.java      |   6 +
 11 files changed, 262 insertions(+), 160 deletions(-)

commit 2fb45da948230ca2bc194ed8e41440d1b7b0bcb8
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Nov 17 13:57:24 2018 -0800

    RATIS-421. Use thirdparty-0.1.0.

 pom.xml                      | 4 ++--
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto/pom.xml          | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 10 files changed, 11 insertions(+), 11 deletions(-)

commit df538e50531379488e768bc640721b00f4a43e6f
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Sat Nov 17 10:01:45 2018 +0530

    RATIS-365. Implement RaftServer.getGroupIds() using the key set of ImplMap. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/protocol/AdminAsynchronousProtocol.java  |  7 ++----
 .../java/org/apache/ratis/server/RaftServer.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  9 --------
 .../apache/ratis/server/impl/RaftServerProxy.java  | 25 +++++++++++-----------
 4 files changed, 15 insertions(+), 28 deletions(-)

commit 5b8bbee83ac5513e9d2f7de239875f33b33b7afd
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 16 13:38:31 2018 -0800

    RATIS-415. Disable checkstyle DesignForExtension rule.

 dev-support/checkstyle.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3fde3d2ac7c48c93d2dd1b18c560cee1d918046e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 16 13:11:18 2018 -0800

    RATIS-386. Raft Client Async API's should honor Retry Policy.  Contributed by Shashikant Banerjee

 .../apache/ratis/client/RaftClientConfigKeys.java  | 10 ----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 37 +++++++++---
 .../org/apache/ratis/protocol/RaftClientReply.java |  9 ++-
 .../ratis/protocol/RaftRetryFailureException.java  | 28 +++++++++
 .../java/org/apache/ratis/retry/RetryPolicies.java | 68 +++++++++++++++++-----
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  4 +-
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java |  4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 28 +++++++--
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 30 ++++++++++
 .../java/org/apache/ratis/WatchRequestTests.java   |  1 -
 .../java/org/apache/ratis/TestRetryPolicy.java     |  2 +-
 11 files changed, 176 insertions(+), 45 deletions(-)

commit a0f19ceb2a70644ce31ce6d92ef228bb10127b07
Author: Vladimir Rodionov <vrodionov@hortonworks.com>
Date:   Thu Nov 15 13:26:49 2018 -0800

    RATIS-422: LogStateMachine refactoring
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../org/apache/ratis/logservice/{api => server}/LogStateMachine.java    | 2 +-
 .../main/java/org/apache/ratis/logservice/worker/LogServiceWorker.java  | 2 +-
 .../test/java/org/apache/ratis/logservice/LogServiceReadWriteBase.java  | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 8fb860315fa8bc2150836ae98c0503fb28187873
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Thu Nov 15 10:31:03 2018 -0800

    RATIS-419. The Arithmetic example cannot be run by the scripts. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/examples/arithmetic/cli/Server.java  | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 1e8b234478c61db323c7149a8b14d8435be6cd82
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Nov 14 17:14:51 2018 -0800

    RATIS-406. In RaftServerImpl, the RaftLog.append(entries) call should not hold the RaftServerImpl lock.

 .../apache/ratis/server/impl/RaftServerImpl.java   |  10 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |  17 +--
 .../org/apache/ratis/server/storage/RaftLog.java   |  68 ++++++-----
 .../ratis/server/storage/RaftLogSequentialOps.java | 125 +++++++++++++++++++++
 .../ratis/server/storage/SegmentedRaftLog.java     |   9 +-
 5 files changed, 167 insertions(+), 62 deletions(-)

commit 16cadb68b8bd157e92662ab1ed427463a8e2ee91
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Nov 14 13:24:20 2018 -0800

    RATIS-131. Add checkstyle configuration.

 dev-support/checkstyle.xml | 206 +++++++++++++++++++++++++++++++++++++++++++++
 pom.xml                    |   7 +-
 2 files changed, 212 insertions(+), 1 deletion(-)

commit 5c37675fa38f54a7171b4581ba3148652f7f55c1
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 13 15:38:23 2018 -0800

    RATIS-399. Move all tests to a new module.

 pom.xml                                            |  2 +
 ratis-examples/pom.xml                             | 15 ++--
 ratis-grpc/pom.xml                                 | 11 ---
 ratis-netty/pom.xml                                | 11 ---
 ratis-netty/src/test/resources/log4j.properties    | 18 -----
 ratis-server/src/test/resources/log4j.properties   | 18 -----
 ratis-test/pom.xml                                 | 92 ++++++++++++++++++++++
 .../ratis/TestRaftServerLeaderElectionTimeout.java |  0
 .../ratis/TestRaftServerSlownessDetection.java     |  0
 .../java/org/apache/ratis/TestRetryPolicy.java     |  0
 .../ratis/grpc/TestGroupManagementWithGrpc.java    |  0
 .../ratis/grpc/TestLeaderElectionWithGrpc.java     |  0
 .../apache/ratis/grpc/TestRaftAsyncWithGrpc.java   |  0
 .../ratis/grpc/TestRaftExceptionWithGrpc.java      |  0
 .../grpc/TestRaftReconfigurationWithGrpc.java      |  0
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  0
 .../ratis/grpc/TestRaftSnapshotWithGrpc.java       |  0
 .../TestRaftStateMachineExceptionWithGrpc.java     |  0
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  0
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  0
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  |  0
 .../ratis/grpc/TestServerInformationWithGrpc.java  |  0
 .../ratis/grpc/TestServerRestartWithGrpc.java      |  0
 .../grpc/TestStateMachineShutdownWithGrpc.java     |  0
 .../ratis/grpc/TestWatchRequestWithGrpc.java       |  0
 .../ratis/netty/TestGroupManagementWithNetty.java  |  0
 .../ratis/netty/TestLeaderElectionWithNetty.java   |  0
 .../ratis/netty/TestRaftExceptionWithNetty.java    |  0
 .../netty/TestRaftReconfigurationWithNetty.java    |  0
 .../ratis/netty/TestRaftSnapshotWithNetty.java     |  0
 .../TestRaftStateMachineExceptionWithNetty.java    |  0
 .../org/apache/ratis/netty/TestRaftWithNetty.java  |  0
 .../ratis/netty/TestRetryCacheWithNettyRpc.java    |  0
 .../netty/TestServerInformationWithNetty.java      |  0
 .../ratis/netty/TestServerRestartWithNetty.java    |  0
 .../java/org/apache/ratis/protocol/TestRaftId.java |  0
 .../apache/ratis/server/TestRaftLogMetrics.java    |  0
 .../ratis/server/TestRaftServerConfigKeys.java     |  0
 .../ratis/server/impl/TestRaftServerJmx.java       |  0
 .../apache/ratis/server/impl/TestServerState.java  |  0
 .../TestGroupManagementWithSimulatedRpc.java       |  0
 .../TestLeaderElectionWithSimulatedRpc.java        |  0
 .../TestRaftExceptionWithSimulation.java           |  0
 .../TestRaftReconfigurationWithSimulatedRpc.java   |  0
 .../TestRaftSnapshotWithSimulatedRpc.java          |  0
 ...tRaftStateMachineExceptionWithSimulatedRpc.java |  0
 .../simulation/TestRaftWithSimulatedRpc.java       |  0
 .../simulation/TestRetryCacheWithSimulatedRpc.java |  0
 .../TestServerInformationWithSimulatedRpc.java     |  0
 .../TestServerRestartWithSimulatedRpc.java         |  0
 .../ratis/server/storage/TestCacheEviction.java    |  0
 .../ratis/server/storage/TestRaftLogCache.java     |  0
 .../ratis/server/storage/TestRaftLogReadWrite.java |  0
 .../ratis/server/storage/TestRaftLogSegment.java   |  0
 .../ratis/server/storage/TestRaftStorage.java      |  0
 .../ratis/server/storage/TestSegmentedRaftLog.java |  0
 .../ratis/statemachine/TestStateMachine.java       |  0
 .../java/org/apache/ratis/util/TestLifeCycle.java  |  0
 .../java/org/apache/ratis/util/TestMinMax.java     |  0
 .../org/apache/ratis/util/TestTimeDuration.java    |  0
 .../apache/ratis/util/TestTimeoutScheduler.java    |  0
 .../ratis/util/TestTraditionalBinaryPrefix.java    |  0
 .../src/test/resources/log4j.properties            |  0
 63 files changed, 99 insertions(+), 68 deletions(-)

commit d28b6493f89887c0b65c5a49a54c63ff2aa033cd
Author: Josh Elser <elserj@apache.org>
Date:   Fri Nov 2 16:15:45 2018 -0400

    RATIS-375 Re-enable LogStream state machine unit tests
    
    Had to fix the API calls after MetadataService introduction.
    
    Signed-off-by: Vladimir Rodionov <vrodionov@hortonworks.com>

 .../ratis/logservice/LogServiceBaseTest.java       | 92 ---------------------
 .../ratis/logservice/LogServiceReadWriteBase.java  | 94 +++++++++-------------
 .../ratis/logservice/TestLogServiceWithGrpc.java   |  4 +-
 .../ratis/logservice/TestLogServiceWithNetty.java  |  4 +-
 .../apache/ratis/logservice/util/TestUtils.java    | 20 ++++-
 5 files changed, 60 insertions(+), 154 deletions(-)

commit 6f3419ad8bc54b4732309f8981482b8726ec428d
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 9 13:13:32 2018 -0800

    RATIS-404. Deadlock in ratis between appendEntries and RaftLogWorker.  Contributed by Mukul Kumar Singh

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2c40f8a0d50b6dc9e083df01e9f78b5c1ff85921
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 9 13:13:03 2018 -0800

    Revert "RATIS-404. Deadlock in ratis between appendEntries and RaftLogWorker."
    
    This reverts commit 7255747a2b6b423a47ee82dd80728e52c7a05d6b.

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7255747a2b6b423a47ee82dd80728e52c7a05d6b
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 9 13:01:55 2018 -0800

    RATIS-404. Deadlock in ratis between appendEntries and RaftLogWorker.

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f9785690a0c8ee90582a8d91de562f19fc803d20
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Fri Nov 9 10:44:33 2018 -0800

    RATIS-405. Upgrade Maven Surefire plugin to 3.0.0-M1.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 079ad4876bd92e6acd43667c5ade610311a5e4c1
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Nov 8 16:59:40 2018 -0800

    RATIS-401. StateMachineDataPolicy.getFromFuture should throw an exception if all retries have failed.

 .../main/java/org/apache/ratis/util/JavaUtils.java |  2 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |  6 +++
 .../ratis/server/storage/TestSegmentedRaftLog.java | 52 +++++++++++++++++++---
 3 files changed, 52 insertions(+), 8 deletions(-)

commit cce89d0594c223c9fac80654f9bc9b35832197ab
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Nov 8 16:08:20 2018 -0800

    RATIS-398. Update Dockerfile.

 dev-support/docker/Dockerfile | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

commit 1d07b18eda61318c14661691051079f943a8ee29
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Nov 7 11:34:28 2018 -0800

    RATIS-396. Support retry if writeStateMachineData throws TimeoutIOException.

 .../main/java/org/apache/ratis/util/IOUtils.java   |  2 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 24 +++++++++++
 .../apache/ratis/server/storage/RaftLogWorker.java | 50 +++++++++++++++++-----
 3 files changed, 64 insertions(+), 12 deletions(-)

commit da8a0b494029ed4a94429eca126b11a780da34aa
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 6 16:05:31 2018 -0800

    RATIS-395. Upgrade Apache Yetus to 0.8.0.

 dev-support/ci/common.sh  | 3 ++-
 dev-support/yetus-wrapper | 5 +++--
 2 files changed, 5 insertions(+), 3 deletions(-)

commit 00fa4a276259b5fe91f3971db2fba606446727ed
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Nov 6 14:29:41 2018 -0800

    RATIS-394. Remove the assertion while setting the exception in TransactionContextImpl.  Contributed by Shashikant Banerjee

 .../java/org/apache/ratis/statemachine/impl/TransactionContextImpl.java  | 1 -
 1 file changed, 1 deletion(-)

commit 380baa9fd200af3fb09c038d21d8ab4c20fd4123
Author: Shashikant Banerjee <shashikant@apache.org>
Date:   Mon Nov 5 15:35:08 2018 +0530

    RATIS-362. Add a Builder for TransactionContext. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/util/Preconditions.java  | 11 +--
 .../examples/filestore/FileStoreStateMachine.java  | 14 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   |  7 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |  3 +-
 .../ratis/statemachine/TransactionContext.java     | 95 ++++++++++++++++++++--
 .../ratis/statemachine/impl/BaseStateMachine.java  |  8 +-
 .../statemachine/impl/TransactionContextImpl.java  | 28 +++----
 .../statemachine/SimpleStateMachine4Testing.java   | 10 ++-
 .../ratis/statemachine/TestStateMachine.java       |  9 +-
 9 files changed, 134 insertions(+), 51 deletions(-)

commit 8055e5d6e4b885b05aee302cd5f99fa1622e63c3
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Nov 3 20:29:36 2018 +0800

    RATIS-381. RaftTestUtil.waitForLeader should not return null.

 .../org/apache/ratis/util/CheckedRunnable.java     | 10 ++-
 .../org/apache/ratis/util/CheckedSupplier.java     | 10 +--
 .../main/java/org/apache/ratis/util/JavaUtils.java | 98 ++++++++++++----------
 .../java/org/apache/ratis/util/TimeDuration.java   | 20 ++++-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 75 ++++++++++++++---
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 82 +++++++++---------
 .../java/org/apache/ratis/RetryCacheTests.java     | 11 ++-
 .../apache/ratis/server/ServerRestartTests.java    |  6 ++
 .../ratis/server/impl/GroupManagementBaseTest.java |  9 +-
 .../ratis/server/impl/LeaderElectionTests.java     | 46 +++++++---
 .../server/impl/RaftReconfigurationBaseTest.java   |  2 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |  9 +-
 .../server/impl/ServerInformationBaseTest.java     |  4 +-
 14 files changed, 243 insertions(+), 141 deletions(-)

commit 27c2dfe6e30fb51f209e57ee9d40c14bb5c14f9a
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Nov 2 07:09:34 2018 +0800

    RATIS-262. Fix compilation warning and deprecated api usage.

 pom.xml                                                   |  1 -
 .../src/main/java/org/apache/ratis/util/JavaUtils.java    |  6 ++++++
 .../src/main/java/org/apache/ratis/util/LogUtils.java     |  3 ++-
 .../main/java/org/apache/ratis/util/TimeoutScheduler.java |  2 +-
 ratis-common/src/test/java/org/apache/ratis/BaseTest.java |  9 +++++++--
 ratis-examples/pom.xml                                    | 15 ---------------
 .../ratis/examples/arithmetic/ArithmeticStateMachine.java |  3 ++-
 .../ratis/grpc/server/GrpcServerProtocolClient.java       |  4 +++-
 .../org/apache/hadoop/ipc/ProtobufRpcEngineShaded.java    |  6 +++---
 .../src/test/java/org/apache/ratis/RaftBasicTests.java    |  2 +-
 .../org/apache/ratis/server/simulation/SimulatedRpc.java  |  4 ++--
 11 files changed, 27 insertions(+), 28 deletions(-)

commit 1d2ebee02d9e97763936ebd9b8b7cbfded514a1e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Oct 30 13:11:17 2018 +0800

    RATIS-379. Allow writing state machine data to be sync'ed with writing raft log.

 .../main/java/org/apache/ratis/conf/ConfUtils.java |  4 +-
 .../apache/ratis/protocol/TimeoutIOException.java  | 31 ++++++++
 .../main/java/org/apache/ratis/util/IOUtils.java   | 22 +++++-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 24 +++++++
 .../apache/ratis/server/impl/RaftServerProxy.java  |  4 +-
 .../apache/ratis/server/storage/RaftLogWorker.java | 46 +++++++-----
 .../ratis/server/storage/SegmentedRaftLog.java     | 11 ++-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 11 ++-
 .../ratis/server/storage/TestSegmentedRaftLog.java | 84 ++++++++++++++++++++--
 .../statemachine/SimpleStateMachine4Testing.java   |  2 +
 10 files changed, 205 insertions(+), 34 deletions(-)

commit 4d723a2c73b353f5228b067635383e03a697f563
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 29 13:46:31 2018 +0800

    RATIS-377. Tolerate partially written log header.

 .../apache/ratis/io/CorruptedFileException.java    | 27 +++++++
 .../org/apache/ratis/util/CheckedConsumer.java     | 37 ++++++++++
 .../java/org/apache/ratis/util/OpenCloseState.java | 38 ++++++++--
 .../java/org/apache/ratis/util/StringUtils.java    |  5 ++
 .../org/apache/ratis/server/impl/LogAppender.java  |  4 ++
 .../ratis/server/impl/RaftServerConstants.java     |  1 -
 .../ratis/server/storage/LogInputStream.java       | 55 +++++++--------
 .../ratis/server/storage/LogOutputStream.java      |  6 +-
 .../org/apache/ratis/server/storage/LogReader.java | 44 +++++++++---
 .../apache/ratis/server/storage/LogSegment.java    | 29 +++++---
 .../apache/ratis/server/storage/RaftLogCache.java  |  4 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |  3 -
 .../server/storage/SegmentedRaftLogFormat.java     | 82 ++++++++++++++++++++++
 .../apache/ratis/server/ServerRestartTests.java    | 54 +++++++++++++-
 .../apache/ratis/server/TestRaftLogMetrics.java    | 18 +++--
 .../ratis/server/storage/TestRaftLogReadWrite.java |  4 +-
 .../ratis/server/storage/TestRaftLogSegment.java   | 10 +--
 .../ratis/server/storage/TestSegmentedRaftLog.java | 13 ++++
 18 files changed, 354 insertions(+), 80 deletions(-)

commit b901b3a5a95a0128569d3a660fd0af24a7ee83e4
Author: Vladimir Rodionov <vrodionov@hortonworks.com>
Date:   Fri Oct 26 11:35:45 2018 -0700

    RATIS-369: LogService read/write path (Phase 2)
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../apache/ratis/logservice/LogServiceFactory.java |  48 -----
 .../apache/ratis/logservice/api/LogMessage.java    |  13 --
 .../apache/ratis/logservice/api/LogService.java    | 156 ---------------
 .../ratis/logservice/api/LogStateMachine.java      | 222 +++++++++------------
 .../org/apache/ratis/logservice/api/LogStream.java |  23 ++-
 .../ratis/logservice/client/LogServiceClient.java  |  57 +++++-
 .../ratis/logservice/dummy/DummyLogReader.java     |  76 -------
 .../ratis/logservice/dummy/DummyLogService.java    | 106 ----------
 .../ratis/logservice/dummy/DummyLogStream.java     | 108 ----------
 .../ratis/logservice/dummy/DummyLogWriter.java     |  51 -----
 .../ratis/logservice/impl/LogReaderImpl.java       | 139 +++++++------
 .../ratis/logservice/impl/LogServiceImpl.java      | 158 ---------------
 .../ratis/logservice/impl/LogStreamImpl.java       |  85 +++++---
 .../ratis/logservice/impl/LogWriterImpl.java       |  73 +++----
 .../ratis/logservice/server/MetaStateMachine.java  |  49 +++--
 .../ratis/logservice/util/LogServiceProtoUtil.java |  48 +++--
 ratis-logservice/src/main/proto/LogService.proto   |  14 +-
 .../ratis/logservice/LogServiceBaseTest.java       |  45 ++---
 .../ratis/logservice/LogServiceReadWriteBase.java  | 131 ++++++++++++
 .../ratis/logservice/TestLogServiceWithGrpc.java   |   4 +
 .../ratis/logservice/TestLogServiceWithNetty.java  |   2 +
 .../ratis/logservice/api/TestApiExample.java       |  67 -------
 .../ratis/logservice/server/TestMetaServer.java    |  29 ++-
 .../ratis/logservice/util/LogServiceCluster.java   |   6 +-
 .../logservice/util/TestLogServiceProtoUtil.java   |   2 +-
 25 files changed, 592 insertions(+), 1120 deletions(-)

commit e308cf599c3f08e12b4781288e9dc0b4eadb777d
Author: Sergey Soldatov <ssa@apache.org>
Date:   Thu Oct 25 23:25:52 2018 -0700

    RATIS-374 MetaServer UT fails.
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../ratis/logservice/server/MasterServer.java      |  1 +
 .../ratis/logservice/worker/LogServiceWorker.java  | 45 ++++++++++++++++++----
 .../ratis/logservice/server/TestMetaServer.java    |  5 ++-
 .../ratis/logservice/util/LogServiceCluster.java   | 12 ++++--
 4 files changed, 51 insertions(+), 12 deletions(-)

commit c59425465d531b57f17fdba35b1567076e4be306
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Oct 26 17:42:11 2018 +0800

    RATIS-373. Tolerate the last partially written log entry.

 .../main/java/org/apache/ratis/util/FileUtils.java |   3 +-
 .../main/java/org/apache/ratis/util/IOUtils.java   |   3 +-
 .../java/org/apache/ratis/util/OpenCloseState.java | 103 +++++++++++++++++++++
 .../ratis/server/storage/LogOutputStream.java      |  11 ++-
 .../org/apache/ratis/server/storage/LogReader.java |  19 +++-
 .../org/apache/ratis/server/storage/RaftLog.java   |  23 ++---
 .../apache/ratis/server/storage/RaftLogCache.java  |   6 +-
 .../ratis/server/storage/RaftStorageDirectory.java |  11 ++-
 .../ratis/server/storage/SegmentedRaftLog.java     |   4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  16 ++--
 .../ratis/TestRaftServerSlownessDetection.java     |   3 +
 .../apache/ratis/server/ServerRestartTests.java    |  95 +++++++++++++++----
 .../ratis/server/simulation/RequestHandler.java    |   5 +-
 .../ratis/server/storage/TestRaftLogSegment.java   |  61 +++++++++---
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   2 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +-
 16 files changed, 302 insertions(+), 67 deletions(-)

commit 85d8e025ffe332dc1329fbecd41d841fbc136db8
Author: Sergey Soldatov <ssa@apache.org>
Date:   Fri Oct 19 01:12:36 2018 -0700

    RATIS-334 Implement server membership for LogService Metadata Service
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 ratis-logservice/pom.xml                           | 134 ++++++++
 .../org/apache/ratis/logservice/api/LogInfo.java   |  49 +++
 .../org/apache/ratis/logservice/api/LogName.java   |   4 +-
 .../ratis/logservice/api/LogStateMachine.java      | 151 ++++-----
 .../ratis/logservice/client/LogServiceClient.java  | 146 ++++++++
 .../apache/ratis/logservice/common/Constants.java  |  31 ++
 .../common/LogAlreadyExistException.java           |  27 ++
 .../logservice/common/LogNotFoundException.java    |  28 ++
 .../common/NoEnoughWorkersException.java           |  32 ++
 .../ratis/logservice/impl/LogReaderImpl.java       |   3 +-
 .../ratis/logservice/impl/LogServiceImpl.java      |  76 ++---
 .../ratis/logservice/impl/LogStreamImpl.java       |   4 +-
 .../ratis/logservice/impl/LogWriterImpl.java       |  18 +-
 .../logservice/server/ManagementStateMachine.java  |  29 ++
 .../ratis/logservice/server/MasterServer.java      | 177 ++++++++++
 .../ratis/logservice/server/MetaStateMachine.java  | 371 +++++++++++++++++++++
 .../ratis/logservice/util/LogServiceProtoUtil.java | 160 ++-------
 .../ratis/logservice/util/LogServiceUtils.java     |  54 +++
 .../logservice/util/MetaServiceProtoUtil.java      | 209 ++++++++++++
 .../ratis/logservice/worker/LogServiceWorker.java  | 130 ++++++++
 .../src/main/proto/LogService.proto                | 121 +++----
 ratis-logservice/src/main/proto/MetaService.proto  | 143 ++++++++
 .../src/main/resources/log4j.properties            |  23 ++
 .../ratis/logservice/LogServiceBaseTest.java       |   9 +-
 .../ratis/logservice/server/TestMetaServer.java    | 200 +++++++++++
 .../ratis/logservice/util/LogServiceCluster.java   | 156 +++++++++
 .../logservice/util/TestLogServiceProtoUtil.java   | 109 +-----
 27 files changed, 2128 insertions(+), 466 deletions(-)

commit cce03d04bb7ff7670345bbd1e1574c0fdd0d6751
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 25 06:58:18 2018 +0800

    RATIS-371. Change tests so that they do not depend on consecutive log indices.

 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |   9 +-
 .../ratis/grpc/TestServerRestartWithGrpc.java      |  25 +++
 .../ratis/netty/TestServerRestartWithNetty.java    |  25 +++
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   6 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  18 +-
 .../java/org/apache/ratis/RetryCacheTests.java     |  19 ++-
 .../java/org/apache/ratis/WatchRequestTests.java   | 188 +++++++++++----------
 .../apache/ratis/server/ServerRestartTests.java    |  64 +++----
 .../apache/ratis/server/TestRaftLogMetrics.java    |  69 ++++----
 .../server/impl/RaftReconfigurationBaseTest.java   |  13 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |  11 +-
 .../impl/RaftStateMachineExceptionTests.java       |   9 +-
 .../server/impl/StateMachineShutdownTests.java     |   2 +-
 .../TestServerRestartWithSimulatedRpc.java         |  25 +++
 .../ratis/server/storage/RaftStorageTestUtils.java |   9 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  75 ++++----
 .../statemachine/SimpleStateMachine4Testing.java   |  78 +++++----
 17 files changed, 396 insertions(+), 249 deletions(-)

commit 0b7337083600f584624384c05bf5b6236e0f9dbe
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 25 06:56:16 2018 +0800

    Revert "r371"
    
    This reverts commit 4cb6b20237d7bf95a2c1acbaeec0ab58bc2a0074.

 .../java/org/apache/ratis/TestRestartRaftPeer.java |  64 ++++---
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |   9 +-
 .../ratis/grpc/TestServerRestartWithGrpc.java      |  25 ---
 .../ratis/netty/TestServerRestartWithNetty.java    |  25 ---
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   6 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  18 +-
 .../java/org/apache/ratis/RetryCacheTests.java     |  19 +--
 .../java/org/apache/ratis/WatchRequestTests.java   | 188 ++++++++++-----------
 .../apache/ratis/server/TestRaftLogMetrics.java    |  69 ++++----
 .../server/impl/RaftReconfigurationBaseTest.java   |  13 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |  11 +-
 .../impl/RaftStateMachineExceptionTests.java       |   9 +-
 .../server/impl/StateMachineShutdownTests.java     |   2 +-
 .../TestServerRestartWithSimulatedRpc.java         |  25 ---
 .../ratis/server/storage/RaftStorageTestUtils.java |   9 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  75 ++++----
 .../statemachine/SimpleStateMachine4Testing.java   |  78 ++++-----
 17 files changed, 249 insertions(+), 396 deletions(-)

commit ce5f48c41e4666f96dfd1444845f1f9a1e0cf0bc
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 24 23:58:46 2018 +0800

    r371

 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |   9 +-
 .../ratis/grpc/TestServerRestartWithGrpc.java      |  25 +++
 .../ratis/netty/TestServerRestartWithNetty.java    |  25 +++
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   6 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  18 +-
 .../java/org/apache/ratis/RetryCacheTests.java     |  19 ++-
 .../java/org/apache/ratis/WatchRequestTests.java   | 188 +++++++++++----------
 .../apache/ratis/server/ServerRestartTests.java    |  64 +++----
 .../apache/ratis/server/TestRaftLogMetrics.java    |  69 ++++----
 .../server/impl/RaftReconfigurationBaseTest.java   |  13 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |  11 +-
 .../impl/RaftStateMachineExceptionTests.java       |   9 +-
 .../server/impl/StateMachineShutdownTests.java     |   2 +-
 .../TestServerRestartWithSimulatedRpc.java         |  25 +++
 .../ratis/server/storage/RaftStorageTestUtils.java |   9 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  75 ++++----
 .../statemachine/SimpleStateMachine4Testing.java   |  78 +++++----
 17 files changed, 396 insertions(+), 249 deletions(-)

commit 2272086a5aebb65a7b0bfe1de59087641b96609f
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 24 12:10:47 2018 +0800

    RATIS-368. TestRaftSnapshotWithSimulatedRpc.testRestartPeer is failing.

 .../apache/ratis/server/impl/ConfigurationManager.java | 12 ++++++++++--
 .../apache/ratis/server/impl/PeerConfiguration.java    | 16 ++++++++++++++++
 .../apache/ratis/server/impl/RaftConfiguration.java    | 18 ++++++++++++++++++
 3 files changed, 44 insertions(+), 2 deletions(-)

commit aa38160890a0ffb7b8a3b0a7b709e12156c1a737
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Tue Oct 23 13:26:25 2018 +0530

    RATIS-364. Raft should persist configuration entries to meta file. Contributed by Mukul Kumar Singh.

 .../apache/ratis/server/impl/RaftServerImpl.java   |  4 ++--
 .../org/apache/ratis/server/impl/ServerState.java  |  8 +++++--
 .../apache/ratis/server/storage/RaftStorage.java   | 27 +++++++++++++++++++++-
 .../ratis/server/storage/RaftStorageDirectory.java |  5 ++++
 .../apache/ratis/statemachine/StateMachine.java    | 11 ---------
 .../ratis/statemachine/impl/BaseStateMachine.java  | 12 ----------
 6 files changed, 39 insertions(+), 28 deletions(-)

commit f7dea20f19a7432b32cedda0fa4b8e7bd648ee66
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Mon Oct 22 11:26:44 2018 -0700

    RATIS-366. In StateMachineUpdater, the stopIndex should use Long. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/server/impl/StateMachineUpdater.java | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 39916f231499351c35dce64a1b5434ade1a5cf5f
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 22 23:15:58 2018 +0800

    RATIS-338. ServerInformationReply should include multiple groups.  Contributed by Sergey Soldatov

 .../java/org/apache/ratis/client/RaftClient.java   |  7 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java | 77 +++++++++++++++++-----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 16 +++--
 .../ratis/protocol/AdminAsynchronousProtocol.java  |  7 +-
 .../org/apache/ratis/protocol/AdminProtocol.java   |  4 +-
 ...erInformationReply.java => GroupInfoReply.java} | 19 +++---
 ...formationRequest.java => GroupInfoRequest.java} |  4 +-
 .../org/apache/ratis/protocol/GroupListReply.java  | 43 ++++++++++++
 .../apache/ratis/protocol/GroupListRequest.java    | 29 ++++++++
 .../grpc/client/GrpcClientProtocolClient.java      | 11 +++-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 23 ++++---
 .../grpc/server/GrpcAdminProtocolService.java      | 23 ++++---
 ...mbinedClientProtocolClientSideTranslatorPB.java | 23 ++++---
 ...mbinedClientProtocolServerSideTranslatorPB.java | 32 ++++++---
 .../ratis/hadooprpc/client/HadoopClientRpc.java    |  6 +-
 .../apache/ratis/netty/client/NettyClientRpc.java  | 22 +++++--
 .../apache/ratis/netty/server/NettyRpcService.java | 22 +++++--
 ratis-proto/src/main/proto/Grpc.proto              |  7 +-
 ratis-proto/src/main/proto/Hadoop.proto            |  7 +-
 ratis-proto/src/main/proto/Netty.proto             |  8 ++-
 ratis-proto/src/main/proto/Raft.proto              | 16 ++++-
 .../java/org/apache/ratis/server/RaftServer.java   |  3 +
 .../apache/ratis/server/impl/RaftServerImpl.java   | 22 ++++---
 .../apache/ratis/server/impl/RaftServerProxy.java  | 27 ++++++--
 .../server/impl/ServerInformationBaseTest.java     | 53 +++++++++++----
 .../server/simulation/SimulatedServerRpc.java      |  7 +-
 26 files changed, 388 insertions(+), 130 deletions(-)

commit 8ef7b4852163456eb5db6c5bbb8440d9c3cb36b0
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 22 22:44:34 2018 +0800

    RATIS-361. Fix the NPE bug in MemoryRaftLog.

 .../apache/ratis/server/storage/MemoryRaftLog.java | 68 ++++++++++++++--------
 .../ratis/statemachine/TestStateMachine.java       | 14 +++--
 2 files changed, 53 insertions(+), 29 deletions(-)

commit ce783995f6612fa76f24a59c23e5964a4bf434a1
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 22 18:00:25 2018 +0800

    RATIS-363. StateMachineUpdater should wait for committed transactions to be applied before shutdown.  Contributed by Jitendra Nath Pandey

 .../grpc/TestStateMachineShutdownWithGrpc.java     |  26 +++++
 .../org/apache/ratis/server/impl/ServerState.java  |   7 +-
 .../ratis/server/impl/StateMachineUpdater.java     |  49 ++++++--
 .../server/impl/StateMachineShutdownTests.java     | 130 +++++++++++++++++++++
 4 files changed, 203 insertions(+), 9 deletions(-)

commit 60d0bc163182a52b5e0cb380d33e706a35e13d30
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sun Oct 21 15:32:01 2018 +0800

    RATIS-353. Refactor LogEntryProto.

 .../examples/filestore/FileStoreStateMachine.java  |   8 +-
 ratis-proto/src/main/proto/Raft.proto              |  29 +++--
 .../org/apache/ratis/server/impl/LeaderState.java  |   7 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  20 ++--
 .../apache/ratis/server/impl/ServerProtoUtils.java | 118 ++++++++++++---------
 .../org/apache/ratis/server/impl/ServerState.java  |   5 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |  11 +-
 .../statemachine/impl/TransactionContextImpl.java  |   2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  12 ++-
 .../ratis/server/impl/RetryCacheTestUtil.java      |  18 ++--
 .../ratis/server/storage/TestCacheEviction.java    |   6 +-
 .../ratis/server/storage/TestRaftLogCache.java     |  12 +--
 .../ratis/server/storage/TestRaftLogReadWrite.java |  19 +---
 .../ratis/server/storage/TestRaftLogSegment.java   |  26 ++---
 .../ratis/server/storage/TestSegmentedRaftLog.java |   9 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   2 +-
 17 files changed, 156 insertions(+), 150 deletions(-)

commit a82ced5ddb405fb5e12fb5c94c3d21aca65b9660
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Oct 20 10:32:00 2018 +0800

    RATIS-357. In ProtoUtils, remove isConfigurationLogEntry(..) and move out the LogEntryProto methods.

 .../java/org/apache/ratis/util/ProtoUtils.java     | 87 +++-------------------
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java | 76 ++++++++++++++++++-
 .../org/apache/ratis/server/impl/ServerState.java  | 20 ++---
 .../apache/ratis/server/storage/LogSegment.java    |  6 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |  3 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |  9 +--
 .../apache/ratis/server/storage/RaftLogWorker.java |  2 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |  3 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  5 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |  9 +--
 .../ratis/server/storage/TestCacheEviction.java    |  4 +-
 .../ratis/server/storage/TestRaftLogCache.java     |  8 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java | 12 +--
 .../ratis/server/storage/TestRaftLogSegment.java   | 20 ++---
 .../ratis/server/storage/TestSegmentedRaftLog.java |  6 +-
 16 files changed, 133 insertions(+), 139 deletions(-)

commit 4bd32cda3909dad92a618cbe7e194d62979978d5
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Oct 19 12:18:57 2018 +0800

    RATIS-356. Add replication level for transactions committed by majority in watch api.  Contributed by Jitendra Nath Pandey

 ratis-proto/src/main/proto/Raft.proto              | 10 ++-
 .../org/apache/ratis/server/impl/LeaderState.java  | 18 +++--
 .../java/org/apache/ratis/WatchRequestTests.java   | 76 +++++++++++++++++++---
 3 files changed, 86 insertions(+), 18 deletions(-)

commit ca0a1271d1ed73987c8910fc2cfacb1b1b18585e
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Oct 19 06:55:08 2018 +0800

    RATIS-355. TestBatchAppend and TestFileStore* are failing.

 .../main/java/org/apache/ratis/util/LifeCycle.java |  8 +++++++
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  9 +++----
 .../java/org/apache/ratis/MiniRaftCluster.java     | 28 ++++++++++++----------
 4 files changed, 29 insertions(+), 18 deletions(-)

commit 48d6a2a421a8b44f4080bad0ef4c004cbf7b456d
Author: Vladimir Rodionov <vrodionov@hortonworks.com>
Date:   Wed Oct 17 15:33:06 2018 -0700

    RATIS-274. Read/Write-path of log stream state machine
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../apache/ratis/logservice/LogServiceFactory.java |   8 +-
 .../apache/ratis/logservice/api/LogMessage.java    | 139 +---------
 .../apache/ratis/logservice/api/LogService.java    |  23 +-
 ...iguration.java => LogServiceConfiguration.java} |  38 ++-
 .../ratis/logservice/api/LogStateMachine.java      | 293 +++++++++++++++------
 .../org/apache/ratis/logservice/api/LogStream.java |  28 +-
 .../ratis/logservice/dummy/DummyLogService.java    |  24 +-
 .../ratis/logservice/dummy/DummyLogStream.java     |  29 +-
 .../ratis/logservice/impl/BaseLogStream.java       |  85 ------
 .../ratis/logservice/impl/LogReaderImpl.java       | 155 +++++++++++
 .../ratis/logservice/impl/LogServiceImpl.java      |  57 ++--
 .../ratis/logservice/impl/LogStreamImpl.java       | 159 +++++++++++
 .../ratis/logservice/impl/LogWriterImpl.java       |  97 +++++++
 .../ratis/logservice/util/LogServiceProtoUtil.java | 218 +++++++++++++--
 .../org/apache/ratis/logservice/util/Utils.java    |  48 ----
 .../ratis/logservice/LogServiceBaseTest.java       |   7 +-
 .../ratis/logservice/api/TestApiExample.java       |   4 +-
 .../ratis/logservice/api/TestLogMessage.java       |  55 ----
 .../logservice/util/TestLogServiceProtoUtil.java   | 290 ++++++++++++++++++++
 .../apache/ratis/logservice/util/TestUtils.java    |  84 +-----
 ratis-proto/src/main/proto/Logservice.proto        |  97 +++++--
 .../apache/ratis/server/impl/RaftServerProxy.java  |   2 +-
 22 files changed, 1381 insertions(+), 559 deletions(-)

commit 9774c5cb10dc14b280c8f5bafd852c0581ca0845
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Oct 18 09:25:43 2018 +0800

    RATIS-354. Remove LeaderNoOp and rename SMLogEntryProto.

 .../java/org/apache/ratis/util/ProtoUtils.java     | 27 +++++++-------
 .../arithmetic/ArithmeticStateMachine.java         | 19 ++++++----
 .../examples/filestore/FileStoreStateMachine.java  | 35 +++++++++---------
 .../ratis/examples/arithmetic/TestArithmetic.java  |  1 -
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  4 +--
 .../ratis/logservice/api/LogStateMachine.java      |  4 +--
 ratis-proto/src/main/proto/Raft.proto              | 13 +++----
 .../apache/ratis/server/impl/RaftServerImpl.java   | 35 ++++++++++++------
 .../apache/ratis/server/impl/ServerProtoUtils.java | 37 ++++++++++++-------
 .../org/apache/ratis/server/impl/ServerState.java  |  2 +-
 .../apache/ratis/server/storage/LogSegment.java    | 15 ++++----
 .../org/apache/ratis/server/storage/RaftLog.java   |  4 +--
 .../ratis/statemachine/TransactionContext.java     | 14 ++++----
 .../ratis/statemachine/impl/BaseStateMachine.java  |  8 ++---
 .../statemachine/impl/TransactionContextImpl.java  | 41 ++++++++++++----------
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 22 ++++++------
 .../ratis/server/impl/RetryCacheTestUtil.java      |  4 +--
 .../ratis/server/storage/TestRaftLogSegment.java   |  6 ++--
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  2 +-
 .../statemachine/SimpleStateMachine4Testing.java   | 11 +++---
 .../ratis/statemachine/TestStateMachine.java       |  7 ++--
 22 files changed, 170 insertions(+), 143 deletions(-)

commit 940a169bac12b10eb636d62029dddbc9fad420ff
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Oct 12 11:16:48 2018 +0800

    RATIS-347. Follow up works for RATIS-234.

 .../org/apache/ratis/protocol/RaftClientReply.java |   8 +-
 .../java/org/apache/ratis/util/LongMinMax.java     |  76 +++++++++
 .../java/org/apache/ratis/util/TestMinMax.java     |  57 +++++++
 .../org/apache/ratis/server/impl/LeaderState.java  |  28 ++--
 .../org/apache/ratis/server/impl/RoleInfo.java     |  14 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   9 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |   1 +
 .../java/org/apache/ratis/WatchRequestTests.java   | 178 +++++++++++++++++----
 8 files changed, 317 insertions(+), 54 deletions(-)

commit 9b2d7b65cf271e2b3b3616d427edf2688586a56c
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Thu Oct 11 12:14:43 2018 -0700

    RATIS-348. TimeoutScheduler and SlidingWindow should use daemon threads. Contributed by Tsz Wo Nicholas Sze.

 ratis-common/src/main/java/org/apache/ratis/util/JavaUtils.java        | 2 +-
 ratis-common/src/main/java/org/apache/ratis/util/SlidingWindow.java    | 3 ++-
 ratis-common/src/main/java/org/apache/ratis/util/TimeoutScheduler.java | 2 +-
 ratis-server/src/test/java/org/apache/ratis/MiniRaftCluster.java       | 2 +-
 ratis-server/src/test/java/org/apache/ratis/RaftAsyncTests.java        | 3 +--
 5 files changed, 6 insertions(+), 6 deletions(-)

commit a82cd7b126f432cb2851e61155042c9f9ecfdb79
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Oct 10 16:29:44 2018 +0800

    RATIS-234. Add an feature to watch if a request is replicated/committed to a particular ReplicationLevel.

 .../java/org/apache/ratis/client/RaftClient.java   |   6 +
 .../apache/ratis/client/RaftClientConfigKeys.java  |   3 +
 .../apache/ratis/client/impl/ClientProtoUtils.java |  17 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |  27 ++-
 .../org/apache/ratis/protocol/RaftClientReply.java |  16 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |  76 +++++---
 .../ratis/protocol/ServerInformationReply.java     |   2 +-
 .../java/org/apache/ratis/util/PeerProxyMap.java   |   4 +
 .../ratis/grpc/TestWatchRequestWithGrpc.java       |  25 +++
 ratis-proto/src/main/proto/Raft.proto              |  13 ++
 .../org/apache/ratis/server/impl/LeaderState.java  |  37 +++-
 .../org/apache/ratis/server/impl/LogAppender.java  |   6 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   6 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  34 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   |  25 ++-
 .../apache/ratis/server/impl/ServerProtoUtils.java |   2 +-
 .../apache/ratis/server/impl/WatchRequests.java    | 136 +++++++++++++++
 .../java/org/apache/ratis/WatchRequestTests.java   | 193 +++++++++++++++++++++
 .../statemachine/SimpleStateMachine4Testing.java   |  15 +-
 19 files changed, 571 insertions(+), 72 deletions(-)

commit 59de6bd6ba92fa24c7efdce0feffb814693c268e
Author: Rajeshbabu Chintaguntla <rajeshbabu@apache.org>
Date:   Tue Oct 9 23:51:12 2018 -0400

    RATIS-279 Create administrative API for LogService
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../apache/ratis/logservice/LogServiceFactory.java |   4 +-
 .../org/apache/ratis/logservice/api/LogName.java   |  12 +-
 .../apache/ratis/logservice/api/LogService.java    |  16 +-
 .../ratis/logservice/api/LogStateMachine.java      | 161 +++++++++++++++---
 .../ratis/logservice/impl/BaseLogStream.java       |  85 ++++++++++
 .../ratis/logservice/impl/LogServiceImpl.java      | 145 +++++++++++++++++
 .../ratis/logservice/util/LogServiceProtoUtil.java | 179 +++++++++++++++++++++
 .../ratis/logservice/LogServiceBaseTest.java       |  89 ++++++++++
 .../ratis/logservice/TestLogServiceWithGrpc.java   |  24 +++
 .../ratis/logservice/TestLogServiceWithNetty.java  |  25 +++
 ratis-proto/src/main/proto/Logservice.proto        |  80 +++++++++
 11 files changed, 787 insertions(+), 33 deletions(-)

commit 737db65432f41de9f0931781f462ac3e2ee5a763
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 8 21:35:02 2018 +0800

    RATIS-306. Support multiple storage directories.  Contributed by Nanda kumar

 .../main/java/org/apache/ratis/conf/ConfUtils.java |  15 +++
 .../java/org/apache/ratis/conf/RaftProperties.java |  27 +++++
 .../ratis/examples/arithmetic/cli/Server.java      |   3 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  12 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  43 ++++---
 .../org/apache/ratis/server/impl/ServerState.java  |  38 +++++-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   2 +-
 .../ratis/server/TestRaftServerConfigKeys.java     |  98 ++++++++++++++++
 .../apache/ratis/server/impl/TestServerState.java  | 127 +++++++++++++++++++++
 .../ratis/server/storage/TestCacheEviction.java    |   3 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java |   4 +-
 .../ratis/server/storage/TestRaftLogSegment.java   |   3 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   2 +-
 13 files changed, 343 insertions(+), 34 deletions(-)

commit 9b84d79cf9b305aff99b65c782ad340671a58c87
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Oct 8 14:48:30 2018 +0800

    RATIS-337. In RaftServerImpl, leaderState/heartbeatMonitor may be accessed without proper null check.

 .../apache/ratis/server/impl/RaftServerImpl.java   | 200 +++++++--------------
 .../org/apache/ratis/server/impl/RoleInfo.java     |  82 ++++++++-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  10 ++
 .../org/apache/ratis/server/impl/ServerState.java  |   9 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |   2 +-
 5 files changed, 162 insertions(+), 141 deletions(-)

commit c3845bc3f3044f513347d8fec220e4e289a0ea5b
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sun Oct 7 05:34:53 2018 +0800

    RATIS-341. Raft log index on the follower should be applied to state machine only after writing the log.  Contributed by Mukul Kumar Singh

 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  2 +-
 ratis-proto/src/main/proto/Raft.proto              |  1 +
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 48 ++++++++++------------
 .../apache/ratis/server/impl/ServerProtoUtils.java |  6 ++-
 .../org/apache/ratis/server/storage/RaftLog.java   |  5 ++-
 6 files changed, 32 insertions(+), 32 deletions(-)

commit b0dc99205ff6394f4f7698b443a5b2989947bcf5
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Sat Oct 6 08:25:41 2018 +0800

    RATIS-340. org.apache.hadoop.ipc.protobuf is shaded to org.apache.ratis.shaded.*.

 BUILDING.md                                                 | 13 ++++++++-----
 README.md                                                   |  6 ++++--
 .../java/org/apache/hadoop/ipc/ProtobufRpcEngineShaded.java |  6 +++---
 3 files changed, 15 insertions(+), 10 deletions(-)

commit bbfb8754d136a5404e8c2a813a7468d94165d80c
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Oct 5 14:31:53 2018 +0800

    RATIS-336. LeaderState.isBootStrappingPeer may have NPE.

 .../apache/ratis/server/impl/LeaderElection.java   |   2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  | 173 +++++++++++++--------
 .../org/apache/ratis/server/impl/LogAppender.java  |  15 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  27 ++--
 .../apache/ratis/server/storage/RaftLogWorker.java |  18 +--
 .../ratis/server/storage/SegmentedRaftLog.java     |   3 +-
 6 files changed, 131 insertions(+), 107 deletions(-)

commit f6814c6b46a54a787983a4245121ee35a9cad0b8
Author: Josh Elser <elserj@apache.org>
Date:   Wed Sep 26 22:33:51 2018 -0400

    RATIS-335 Use the new ratis-thirdparty-hadoop artifact

 pom.xml                     |  12 +--
 ratis-examples/pom.xml      |   2 +-
 ratis-hadoop-shaded/pom.xml | 182 --------------------------------------------
 ratis-hadoop/pom.xml        |   2 +-
 ratis-logservice/pom.xml    |   2 +-
 5 files changed, 9 insertions(+), 191 deletions(-)

commit e35d954e34adb4417dcc96c563df79b559768897
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Oct 2 15:58:05 2018 +0530

    RATIS-327. Fix bugs in SimpleStateMachine4Testing. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  26 ++---
 .../org/apache/ratis/server/impl/LeaderState.java  |   1 -
 .../apache/ratis/server/impl/PendingRequests.java  |   7 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   2 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  46 ++++-----
 .../ratis/TestRaftServerLeaderElectionTimeout.java |   2 +-
 .../ratis/TestRaftServerSlownessDetection.java     |   7 +-
 .../statemachine/SimpleStateMachine4Testing.java   | 108 ++++++++++-----------
 8 files changed, 90 insertions(+), 109 deletions(-)

commit a0843f4c2745ef0812107b48a52d2ca083a02eaa
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Sep 28 10:31:56 2018 -0700

    RATIS-294. Fix ratis-hadoop CVEs.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9d65b502c5b48c8fff8debe5d65cedd10740f973
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Sep 27 16:16:49 2018 -0700

    RATIS-304. StateMachine#readStateMachineData should return SMLogEntryProto.  Contributed by Lokesh Jain

 .../src/main/java/org/apache/ratis/util/ProtoUtils.java     | 13 +++++++++++++
 .../main/java/org/apache/ratis/server/storage/RaftLog.java  |  7 ++++---
 .../java/org/apache/ratis/statemachine/StateMachine.java    |  3 ++-
 .../ratis/statemachine/SimpleStateMachine4Testing.java      |  4 ++--
 4 files changed, 21 insertions(+), 6 deletions(-)

commit 021ee857f5b24d5d8a8ad40fe917803869b0bb75
Author: Lokesh Jain <ljain@apache.org>
Date:   Thu Sep 27 16:49:26 2018 +0530

    RATIS-332. Allow RaftServer.Builder to set StateMachine.Registry. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/grpc/MiniRaftClusterWithGrpc.java |  4 +-
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  4 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  4 +-
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  4 +-
 .../java/org/apache/ratis/server/RaftServer.java   | 11 ++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/ServerImplUtils.java  |  4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 30 +++++---
 .../MiniRaftClusterWithSimulatedRpc.java           |  5 +-
 .../ratis/statemachine/TestStateMachine.java       | 80 +++++++++++++++-------
 10 files changed, 95 insertions(+), 53 deletions(-)

commit d16c7dd2571fab11427c0b1ab7112363befe7f92
Author: Lokesh Jain <ljain@apache.org>
Date:   Mon Sep 24 11:54:33 2018 +0530

    RATIS-321. RaftLog should validate appendEntries. Contributed by Lokesh Jain.

 .../apache/ratis/server/storage/MemoryRaftLog.java |  1 +
 .../org/apache/ratis/server/storage/RaftLog.java   | 13 +++++++
 .../ratis/server/storage/SegmentedRaftLog.java     |  1 +
 .../ratis/server/storage/TestCacheEviction.java    |  4 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java | 43 +++++++++++++++++-----
 5 files changed, 51 insertions(+), 11 deletions(-)

commit 3b9d50deddcb2dc846b62ab63dd668f45c8b6536
Author: Josh Elser <elserj@apache.org>
Date:   Sat Sep 8 08:42:43 2018 -0700

    RATIS-316. Use ratis-thirdparty and reorganize generated code
    
    * Use ratis-thirdparty to build Ratis
    * Rename ratis-shaded-proto to ratis-proto
    * Undo skipShade because we don't have to shade anymore
    * Update BUILDING.md

 BUILDING.md                                        |  65 +--
 pom.xml                                            |  30 +-
 ratis-assembly/pom.xml                             |   6 +-
 ratis-client/pom.xml                               |   7 +-
 .../java/org/apache/ratis/client/RaftClient.java   |   2 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java |  10 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |   4 +-
 ratis-common/pom.xml                               |   7 +-
 .../main/java/org/apache/ratis/conf/ConfUtils.java |   2 +-
 .../java/org/apache/ratis/protocol/ClientId.java   |   2 +-
 .../java/org/apache/ratis/protocol/Message.java    |   2 +-
 .../ratis/protocol/NotReplicatedException.java     |   2 +-
 .../org/apache/ratis/protocol/RaftClientReply.java |   2 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |   4 +-
 .../org/apache/ratis/protocol/RaftGroupId.java     |   2 +-
 .../java/org/apache/ratis/protocol/RaftId.java     |   2 +-
 .../java/org/apache/ratis/protocol/RaftPeerId.java |   2 +-
 .../ratis/protocol/ServerInformationReply.java     |   4 +-
 .../java/org/apache/ratis/util/JmxRegister.java    |   2 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |   8 +-
 .../java/org/apache/ratis/util/StringUtils.java    |   6 +-
 ratis-examples/pom.xml                             |   6 +-
 .../arithmetic/ArithmeticStateMachine.java         |   4 +-
 .../examples/arithmetic/AssignmentMessage.java     |   2 +-
 .../ratis/examples/arithmetic/cli/Assign.java      |   4 +-
 .../ratis/examples/arithmetic/cli/Client.java      |   2 +-
 .../ratis/examples/arithmetic/cli/Server.java      |   2 +-
 .../apache/ratis/examples/filestore/FileInfo.java  |   2 +-
 .../apache/ratis/examples/filestore/FileStore.java |   4 +-
 .../ratis/examples/filestore/FileStoreClient.java  |   4 +-
 .../ratis/examples/filestore/FileStoreCommon.java  |   2 +-
 .../examples/filestore/FileStoreStateMachine.java  |  10 +-
 .../examples/filestore/FileStoreBaseTest.java      |   4 +-
 ratis-grpc/pom.xml                                 |   7 +-
 .../main/java/org/apache/ratis/grpc/GrpcUtil.java  |   8 +-
 .../grpc/client/GrpcClientProtocolClient.java      |  22 +-
 .../ratis/grpc/client/GrpcClientProtocolProxy.java |   6 +-
 .../grpc/client/GrpcClientProtocolService.java     |  12 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  12 +-
 .../ratis/grpc/client/GrpcClientStreamer.java      |   8 +-
 .../grpc/server/GrpcAdminProtocolService.java      |  12 +-
 .../apache/ratis/grpc/server/GrpcLogAppender.java  |  10 +-
 .../grpc/server/GrpcServerProtocolClient.java      |  14 +-
 .../grpc/server/GrpcServerProtocolService.java     |   6 +-
 .../org/apache/ratis/grpc/server/GrpcService.java  |   6 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |   2 +-
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  |   4 +-
 ratis-hadoop-shaded/pom.xml                        | 138 +++---
 ratis-hadoop/pom.xml                               |   4 +-
 .../apache/hadoop/ipc/ProtobufRpcEngineShaded.java |   4 +-
 ...mbinedClientProtocolClientSideTranslatorPB.java |   2 +-
 .../hadooprpc/client/CombinedClientProtocolPB.java |   2 +-
 ...mbinedClientProtocolServerSideTranslatorPB.java |  16 +-
 .../ratis/hadooprpc/server/HadoopRpcService.java   |  12 +-
 .../hadooprpc/server/RaftServerProtocolPB.java     |   2 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |  16 +-
 ratis-logservice/pom.xml                           |   2 +-
 .../apache/ratis/logservice/api/LogMessage.java    |   6 +-
 .../ratis/logservice/api/LogStateMachine.java      |   6 +-
 .../ratis/logservice/api/TestLogMessage.java       |   4 +-
 ratis-netty/pom.xml                                |   7 +-
 .../java/org/apache/ratis/netty/NettyClient.java   |  18 +-
 .../java/org/apache/ratis/netty/NettyRpcProxy.java |  22 +-
 .../apache/ratis/netty/client/NettyClientRpc.java  |  12 +-
 .../apache/ratis/netty/server/NettyRpcService.java |  30 +-
 ratis-proto-shaded/pom.xml                         | 482 ---------------------
 ...che.ratis.shaded.io.grpc.ManagedChannelProvider |  16 -
 ...pache.ratis.shaded.io.grpc.NameResolverProvider |  16 -
 .../org.apache.ratis.shaded.io.grpc.ServerProvider |  16 -
 ratis-proto/pom.xml                                | 191 ++++++++
 .../src/main/proto/Examples.proto                  |   2 +-
 .../src/main/proto/Grpc.proto                      |   2 +-
 .../src/main/proto/Hadoop.proto                    |   2 +-
 .../src/main/proto/Logservice.proto                |   4 +-
 .../src/main/proto/Netty.proto                     |   2 +-
 .../src/main/proto/RMap.proto                      |   4 +-
 .../src/main/proto/Raft.proto                      |   2 +-
 ratis-replicated-map/pom.xml                       |   6 +-
 ratis-server/pom.xml                               |   6 +-
 .../apache/ratis/server/impl/CommitInfoCache.java  |   2 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   4 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   6 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   4 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   2 +-
 .../apache/ratis/server/impl/PendingRequests.java  |   4 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  10 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |   2 +-
 .../org/apache/ratis/server/impl/RetryCache.java   |   6 +-
 .../org/apache/ratis/server/impl/RoleInfo.java     |   2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |   6 +-
 .../org/apache/ratis/server/impl/ServerState.java  |   8 +-
 .../ratis/server/impl/StateMachineUpdater.java     |   2 +-
 .../protocol/RaftServerAsynchronousProtocol.java   |   4 +-
 .../ratis/server/protocol/RaftServerProtocol.java  |  12 +-
 .../ratis/server/storage/LogInputStream.java       |   2 +-
 .../ratis/server/storage/LogOutputStream.java      |   4 +-
 .../org/apache/ratis/server/storage/LogReader.java |   6 +-
 .../apache/ratis/server/storage/LogSegment.java    |   8 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |   2 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   2 +-
 .../apache/ratis/server/storage/RaftLogCache.java  |   2 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |   2 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |   2 +-
 .../ratis/server/storage/SnapshotManager.java      |   4 +-
 .../apache/ratis/statemachine/StateMachine.java    |   4 +-
 .../ratis/statemachine/TransactionContext.java     |   8 +-
 .../ratis/statemachine/impl/BaseStateMachine.java  |   2 +-
 .../statemachine/impl/TransactionContextImpl.java  |   8 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   2 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  10 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java |   4 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |   6 +-
 .../ratis/TestRaftServerLeaderElectionTimeout.java |   2 +-
 .../ratis/TestRaftServerSlownessDetection.java     |   2 +-
 .../java/org/apache/ratis/protocol/TestRaftId.java |   2 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |   2 +-
 .../ratis/server/impl/RetryCacheTestUtil.java      |   2 +-
 .../server/impl/ServerInformationBaseTest.java     |   2 +-
 .../ratis/server/simulation/RaftServerReply.java   |   6 +-
 .../ratis/server/simulation/RaftServerRequest.java |   6 +-
 .../server/simulation/SimulatedServerRpc.java      |   2 +-
 .../ratis/server/storage/RaftStorageTestUtils.java |   2 +-
 .../ratis/server/storage/TestCacheEviction.java    |   2 +-
 .../ratis/server/storage/TestRaftLogCache.java     |   2 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java |   4 +-
 .../ratis/server/storage/TestRaftLogSegment.java   |   4 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   2 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   2 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   8 +-
 .../ratis/statemachine/TestStateMachine.java       |   2 +-
 130 files changed, 634 insertions(+), 972 deletions(-)

commit 523fb63832e574fac0a3b8cc65f548e91940dba5
Author: Vladimir Rodionov <vrodionov@hortonworks.com>
Date:   Wed Sep 19 12:45:01 2018 -0700

    RATIS-317. Log service state machine
    
    Signed-off-by: Josh Elser <elserj@apache.org>

 .../apache/ratis/logservice/api/LogMessage.java    | 175 ++++++++++++++++++
 .../org/apache/ratis/logservice/api/LogName.java   |   8 +
 .../ratis/logservice/api/LogStateMachine.java      | 197 +++++++++++++++++++++
 .../org/apache/ratis/logservice/util/Utils.java    |  48 +++++
 .../ratis/logservice/api/TestLogMessage.java       |  55 ++++++
 .../apache/ratis/logservice/util/TestUtils.java    |  95 ++++++++++
 ratis-proto-shaded/src/main/proto/Logservice.proto |  35 ++++
 7 files changed, 613 insertions(+)

commit ed8e60dad83ae733fe6c6c3752e82f1fee72c12e
Author: Lokesh Jain <ljain@apache.org>
Date:   Thu Sep 20 10:29:48 2018 +0530

    RATIS-324. Rename grpc classes. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/examples/ParameterizedBaseTest.java      |  6 ++--
 .../filestore/TestFileStoreAsyncWithGrpc.java      |  6 ++--
 .../examples/filestore/TestFileStoreWithGrpc.java  |  6 ++--
 .../java/org/apache/ratis/grpc/GrpcFactory.java    |  9 ++---
 .../grpc/{RaftGrpcUtil.java => GrpcUtil.java}      |  8 ++---
 ...olClient.java => GrpcClientProtocolClient.java} | 12 +++----
 ...ocolProxy.java => GrpcClientProtocolProxy.java} |  8 ++---
 ...Service.java => GrpcClientProtocolService.java} | 14 ++++----
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 14 ++++----
 ...AppendStreamer.java => GrpcClientStreamer.java} | 38 +++++++++++-----------
 ...RaftOutputStream.java => GrpcOutputStream.java} | 12 +++----
 ...lService.java => GrpcAdminProtocolService.java} | 10 +++---
 .../{GRpcLogAppender.java => GrpcLogAppender.java} | 27 ++++++++-------
 ...olClient.java => GrpcServerProtocolClient.java} |  4 +--
 ...Service.java => GrpcServerProtocolService.java} | 24 +++++++-------
 .../GrpcService.java}                              | 32 +++++++++---------
 ...rWithGRpc.java => MiniRaftClusterWithGrpc.java} | 20 ++++++------
 .../ratis/grpc/TestGroupManagementWithGrpc.java    |  2 +-
 .../ratis/grpc/TestLeaderElectionWithGrpc.java     |  6 ++--
 .../apache/ratis/grpc/TestRaftAsyncWithGrpc.java   |  4 +--
 .../ratis/grpc/TestRaftExceptionWithGrpc.java      |  4 +--
 ...c.java => TestRaftReconfigurationWithGrpc.java} | 10 +++---
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  4 +--
 .../ratis/grpc/TestRaftSnapshotWithGrpc.java       |  5 +--
 .../TestRaftStateMachineExceptionWithGrpc.java     |  4 +--
 .../java/org/apache/ratis/grpc/TestRaftStream.java | 24 +++++++-------
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  8 ++---
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  |  6 ++--
 .../ratis/grpc/TestServerInformationWithGrpc.java  |  4 +--
 .../src/main/proto/{GRpc.proto => Grpc.proto}      |  2 +-
 30 files changed, 163 insertions(+), 170 deletions(-)

commit 974919e5e099b80fd85a4ba1bb745db369519b75
Author: Lokesh Jain <ljain@apache.org>
Date:   Wed Sep 19 14:56:01 2018 +0530

    RATIS-325. RetryPolicies should not import com.google.common.annotations.VisibleForTesting. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/client/RaftClient.java   |  4 +-
 .../java/org/apache/ratis/retry/RetryPolicies.java | 85 +++++++++-------------
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  6 +-
 3 files changed, 42 insertions(+), 53 deletions(-)

commit 25d4a59151e6bdbd2cc90ee51e9c22c8bfed4b31
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Sep 18 20:51:33 2018 +0530

    RATIS-319. Increase TestRaftServerJmx's timeout. Contributed by Josh Elser.

 .../src/test/java/org/apache/ratis/server/impl/TestRaftServerJmx.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 357ba82937a757e70e32555423cc8b9edd69271b
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Sep 18 15:46:47 2018 +0530

    RATIS-323. Update grpc to not using the deprecated APIs. Contributed by Tsz Wo Nicholas Sze.

 .../main/java/org/apache/ratis/grpc/RaftGRpcService.java   |  5 ++---
 .../apache/ratis/grpc/client/RaftClientProtocolClient.java |  9 +++++----
 .../java/org/apache/ratis/grpc/server/GRpcLogAppender.java | 14 +++++++-------
 3 files changed, 14 insertions(+), 14 deletions(-)

commit b1c6d650394b1113192e4e757d8eca81606d2bab
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Sep 18 15:26:08 2018 +0530

    RATIS-322. Make RaftGroup a value base class. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/protocol/RaftGroup.java  | 54 ++++++++++++++++------
 .../org/apache/ratis/protocol/RaftGroupId.java     |  5 ++
 .../java/org/apache/ratis/protocol/RaftId.java     |  3 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |  3 +-
 .../ratis/examples/arithmetic/cli/Client.java      |  2 +-
 .../ratis/examples/arithmetic/cli/Server.java      |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  6 +--
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  2 +-
 .../ratis/server/impl/GroupManagementBaseTest.java |  8 ++--
 11 files changed, 61 insertions(+), 28 deletions(-)

commit eca35312cef825c209c14b3dff3bc2b94311ef14
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Sep 17 23:09:27 2018 +0530

    RATIS-315. Add an option to delete the group directory in groupRemove. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/client/RaftClient.java   |  2 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java |  9 ++-
 .../apache/ratis/client/impl/RaftClientImpl.java   |  4 +-
 .../ratis/protocol/GroupManagementRequest.java     | 15 +++--
 .../java/org/apache/ratis/util/StringUtils.java    | 13 +++++
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    | 30 ++++------
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     | 40 +++++++------
 .../apache/ratis/netty/server/NettyRpcService.java |  8 +--
 .../org/apache/ratis/netty/TestRaftWithNetty.java  | 17 +-----
 ratis-proto-shaded/src/main/proto/Raft.proto       |  1 +
 .../java/org/apache/ratis/server/RaftServer.java   |  2 +-
 .../ratis/server/impl/ConfigurationManager.java    |  9 ++-
 .../org/apache/ratis/server/impl/LeaderState.java  | 14 ++---
 .../ratis/server/impl/RaftConfiguration.java       |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 18 ++++--
 .../apache/ratis/server/impl/RaftServerProxy.java  | 49 +++++++++++-----
 .../apache/ratis/server/impl/ServerImplUtils.java  |  4 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  8 ++-
 .../org/apache/ratis/server/impl/ServerState.java  | 23 ++++----
 .../ratis/server/storage/RaftStorageDirectory.java |  5 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 39 ++++++++-----
 .../test/java/org/apache/ratis/RaftBasicTests.java | 66 ++++++++++------------
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  4 +-
 .../ratis/server/impl/GroupManagementBaseTest.java | 32 ++++++++---
 .../server/impl/RaftReconfigurationBaseTest.java   | 17 +++---
 .../simulation/TestRaftWithSimulatedRpc.java       | 27 +--------
 27 files changed, 254 insertions(+), 206 deletions(-)

commit 50588bde3e3d39757f1893c1451ba9a30d66459f
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Sep 11 14:00:10 2018 -0700

    RATIS-314. Use different loggers for different confs.

 .../java/org/apache/ratis/client/RaftClient.java   |  2 +-
 .../apache/ratis/client/RaftClientConfigKeys.java  | 17 ++++++--
 .../main/java/org/apache/ratis/RaftConfigKeys.java |  6 ++-
 .../main/java/org/apache/ratis/conf/ConfUtils.java | 39 +++++++++--------
 .../examples/filestore/FileStoreStateMachine.java  |  2 +-
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java | 34 ++++++++++-----
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  4 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   |  2 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  2 +-
 .../grpc/client/RaftClientProtocolClient.java      |  8 ++--
 .../apache/ratis/hadooprpc/HadoopConfigKeys.java   | 14 ++++--
 .../org/apache/ratis/netty/NettyConfigKeys.java    | 11 ++++-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 50 +++++++++++++---------
 .../apache/ratis/server/impl/RaftServerProxy.java  |  2 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |  2 +-
 15 files changed, 123 insertions(+), 72 deletions(-)

commit 6369d4e65eb3d733d101786b6c79ca600bdace77
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Sep 11 12:03:57 2018 -0700

    RATIS-253. Segmented Raft log rolls over segment frequently.  Contributed by Rajeshbabu Chintaguntla

 .../src/main/java/org/apache/ratis/server/storage/LogSegment.java    | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 2ce10dc1a88b7657c7d63e02774459afd8724c4d
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Sep 11 11:04:22 2018 -0700

    RATIS-310. Add support for Retry Policy in Ratis.  Contributed by Shashikant Banerjee

 .../java/org/apache/ratis/client/RaftClient.java   |  13 +-
 .../apache/ratis/client/impl/ClientImplUtils.java  |   8 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |  22 ++--
 .../java/org/apache/ratis/retry/RetryPolicies.java | 141 +++++++++++++++++++++
 .../java/org/apache/ratis/retry/RetryPolicy.java   |  40 ++++++
 .../java/org/apache/ratis/TestRetryPolicy.java     |  42 ++++++
 6 files changed, 254 insertions(+), 12 deletions(-)

commit 09b099c71d4f112e4c7802cab1b48f2b84e0620b
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Sep 10 16:15:53 2018 -0700

    RATIS-305. Replace the reinitialize() API with some group management APIs.

 .../java/org/apache/ratis/client/RaftClient.java   |  7 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java | 41 ++++++----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 15 +++-
 .../ratis/protocol/AdminAsynchronousProtocol.java  |  5 +-
 .../org/apache/ratis/protocol/AdminProtocol.java   |  4 +-
 .../ratis/protocol/GroupManagementRequest.java     | 92 ++++++++++++++++++++++
 .../apache/ratis/protocol/RaftClientMessage.java   |  4 +-
 .../apache/ratis/protocol/ReinitializeRequest.java | 37 ---------
 .../src/test/java/org/apache/ratis/BaseTest.java   |  6 +-
 .../java/org/apache/ratis/TestMultiRaftGroup.java  |  4 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 33 ++++----
 .../grpc/client/RaftClientProtocolClient.java      |  5 +-
 .../ratis/grpc/server/AdminProtocolService.java    | 11 ++-
 ...hGrpc.java => TestGroupManagementWithGrpc.java} |  4 +-
 ...mbinedClientProtocolClientSideTranslatorPB.java |  8 +-
 ...mbinedClientProtocolServerSideTranslatorPB.java | 11 ++-
 .../ratis/hadooprpc/client/HadoopClientRpc.java    |  4 +-
 ....java => TestGroupManagementWithHadoopRpc.java} |  4 +-
 .../apache/ratis/netty/client/NettyClientRpc.java  | 10 +--
 .../apache/ratis/netty/server/NettyRpcService.java |  8 +-
 ...etty.java => TestGroupManagementWithNetty.java} |  4 +-
 ratis-proto-shaded/src/main/proto/GRpc.proto       |  4 +-
 ratis-proto-shaded/src/main/proto/Hadoop.proto     |  2 +-
 ratis-proto-shaded/src/main/proto/Netty.proto      |  2 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       | 18 ++++-
 .../apache/ratis/server/impl/RaftServerProxy.java  | 65 ++++++++++-----
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  4 +-
 ...nBaseTest.java => GroupManagementBaseTest.java} | 46 +++++------
 .../server/simulation/SimulatedServerRpc.java      |  4 +-
 ...va => TestGroupManagementWithSimulatedRpc.java} |  4 +-
 30 files changed, 293 insertions(+), 173 deletions(-)

commit 89b1a1cd9b12623f031845881e3df069dcafe249
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Sep 10 13:08:28 2018 -0700

    RATIS-303. TestRaftStateMachineException is failing with NullPointerException.  Contributed by Shashikant Banerjee

 .../TestRaftStateMachineExceptionWithGrpc.java     | 26 +++++++
 ...TestRaftStateMachineExceptionWithHadoopRpc.java | 25 +++++++
 .../TestRaftStateMachineExceptionWithNetty.java    | 25 +++++++
 .../impl/RaftStateMachineExceptionTests.java       | 82 +++++++++++++---------
 ...tRaftStateMachineExceptionWithSimulatedRpc.java | 25 +++++++
 .../statemachine/SimpleStateMachine4Testing.java   |  2 +-
 6 files changed, 152 insertions(+), 33 deletions(-)

commit ef48512da368f7d52ffddd3a8f02890bbdff2b39
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Sep 7 13:19:20 2018 -0700

    RATIS-272. LogService: Design ideal API.  Contributed by Josh Elser

 pom.xml                                            |   7 ++
 ratis-logservice/pom.xml                           | 116 +++++++++++++++++
 .../apache/ratis/logservice/LogServiceFactory.java |  44 +++++++
 .../org/apache/ratis/logservice/api/LogName.java   |  71 +++++++++++
 .../org/apache/ratis/logservice/api/LogReader.java |  88 +++++++++++++
 .../apache/ratis/logservice/api/LogService.java    | 139 +++++++++++++++++++++
 .../org/apache/ratis/logservice/api/LogStream.java |  79 ++++++++++++
 .../logservice/api/LogStreamConfiguration.java     |  64 ++++++++++
 .../org/apache/ratis/logservice/api/LogWriter.java |  64 ++++++++++
 .../ratis/logservice/api/RecordListener.java       |  33 +++++
 .../ratis/logservice/dummy/DummyLogReader.java     |  76 +++++++++++
 .../ratis/logservice/dummy/DummyLogService.java    |  92 ++++++++++++++
 .../ratis/logservice/dummy/DummyLogStream.java     |  83 ++++++++++++
 .../ratis/logservice/dummy/DummyLogWriter.java     |  51 ++++++++
 .../ratis/logservice/api/TestApiExample.java       |  69 ++++++++++
 .../src/test/resources/log4j.properties            |  18 +++
 16 files changed, 1094 insertions(+)

commit acd507e6e2a5520682aa6ba37c5042a377f01cd0
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Sep 3 14:30:58 2018 +0530

    RATIS-300. Support multiple RaftServerImpl in RaftServerProxy. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/protocol/AlreadyClosedException.java     |  27 ++
 .../main/java/org/apache/ratis/util/IOUtils.java   |  18 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java |  17 +-
 .../main/java/org/apache/ratis/util/LifeCycle.java |   3 +-
 .../java/org/apache/ratis/util/Preconditions.java  |   8 +
 .../java/org/apache/ratis/TestRestartRaftPeer.java |   4 +-
 .../ratis/examples/ParameterizedBaseTest.java      |   2 +-
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  14 +-
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |   2 +-
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |   4 +-
 .../ratis/hadooprpc/server/HadoopRpcService.java   |   2 +-
 .../apache/ratis/netty/server/NettyRpcService.java |   2 +-
 .../java/org/apache/ratis/server/RaftServer.java   |   5 +-
 .../org/apache/ratis/server/RaftServerRpc.java     |   3 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  20 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  | 301 ++++++++++++++-------
 .../ratis/server/impl/RaftServerRpcWithProxy.java  |  11 +-
 .../org/apache/ratis/server/impl/RoleInfo.java     |   5 +
 .../apache/ratis/server/impl/ServerImplUtils.java  |  23 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  79 +++---
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  18 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java |   4 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  13 +-
 .../ratis/TestRaftServerLeaderElectionTimeout.java |   3 +-
 .../ratis/TestRaftServerSlownessDetection.java     |   2 +-
 .../ratis/server/impl/LeaderElectionTests.java     |   5 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |   3 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |  10 +
 .../server/impl/ReinitializationBaseTest.java      |  11 +-
 .../server/simulation/SimulatedServerRpc.java      |  10 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   3 +-
 .../ratis/statemachine/TestStateMachine.java       |  28 +-
 33 files changed, 426 insertions(+), 236 deletions(-)

commit c6c9ddf4d6f692d73b1693dc0746e21f70941876
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Aug 27 15:02:00 2018 +0530

    RATIS-264. Add setter method to set the capacity of retry cache. Contributed by Nanda Kumar.

 .../src/main/java/org/apache/ratis/server/RaftServerConfigKeys.java   | 4 ++++
 1 file changed, 4 insertions(+)

commit e6fd4949e0e3ae092acf28c988de2c570d639781
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Fri Aug 24 13:12:24 2018 +0530

    RATIS-302. Bump the version of grpc-java and netty. Contributed by Elek, Marton.

 ratis-proto-shaded/pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 9533febc04745bc259c3ad7abc1882cabf9f35b1
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Aug 23 15:41:48 2018 -0700

    RATIS-291.  Raft Server should fail themselves when a raft storage directory fails.  Contributed by Shashikant Banerjee

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java  | 6 ++++++
 1 file changed, 6 insertions(+)

commit 05812468f7c85b38ff7391e361c27a76929cf48a
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Aug 17 15:45:42 2018 -0700

    RATIS-295. RaftLogWorker#flushWrites should also flush state machine data.  Contributed by Shashikant Banerjee

 .../main/java/org/apache/ratis/server/storage/RaftLogWorker.java | 7 +++++++
 .../main/java/org/apache/ratis/statemachine/StateMachine.java    | 9 +++++++++
 2 files changed, 16 insertions(+)

commit 0b73e892afc99562ba15df0518303e918dce3c08
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Aug 14 10:37:45 2018 -0700

    RATIS-299. Error when running start-all.sh in ratis-examples.  Contributed by Jing Chen

 ratis-assembly/src/main/resources/NOTICE |  8 --------
 ratis-examples/pom.xml                   | 10 ++++++++++
 ratis-proto-shaded/pom.xml               |  5 -----
 3 files changed, 10 insertions(+), 13 deletions(-)

commit 67db67efd4a32b1ec3054571c0a8d885f4db882b
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Aug 13 15:08:04 2018 -0700

    RATIS-290. Raft server should notify the state machine if no leader is assigned for a long time.  Contributed by Mukul Kumar Singh

 ratis-proto-shaded/src/main/proto/Raft.proto       |  2 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 15 ++++
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 14 +++-
 .../org/apache/ratis/server/impl/ServerState.java  | 33 +++++++-
 .../apache/ratis/statemachine/StateMachine.java    | 16 +++-
 .../ratis/TestRaftServerLeaderElectionTimeout.java | 98 ++++++++++++++++++++++
 .../ratis/TestRaftServerSlownessDetection.java     |  2 +-
 .../statemachine/SimpleStateMachine4Testing.java   | 14 +++-
 9 files changed, 184 insertions(+), 12 deletions(-)

commit 86db875aa622fb5432c6048894eafc54c236a7c1
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Sat Aug 11 17:50:37 2018 +0530

    RATIS-270. Replication ALL requests should not be replied from retry cache if they are delayed. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  | 71 +++++++++++++++++++++-
 .../org/apache/ratis/server/impl/LeaderState.java  |  7 ++-
 .../apache/ratis/server/impl/PendingRequest.java   | 39 +++++++++---
 .../apache/ratis/server/impl/PendingRequests.java  | 11 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   | 11 +++-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 13 +++-
 .../java/org/apache/ratis/RetryCacheTests.java     | 38 ++++++------
 7 files changed, 149 insertions(+), 41 deletions(-)

commit e4a016fb039094a55ca802b6d9d26012d49099e7
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Sat Aug 11 07:59:16 2018 +0530

    RATIS-298. Update auto-common and log4j versions. Contributed by Mukul Kumar Singh.

 ratis-proto-shaded/pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6a2c3d58df27efaa10bc00c7c8a76730ef8bde64
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Tue Aug 7 14:37:05 2018 -0700

    RATIS-288. Pom cleanup/simplification.  Contributed by Josh Elser

 .gitignore                     |   2 -
 BUILDING.md                    |  42 ++--
 pom.xml                        |  30 ++-
 ratis-assembly/pom.xml         |   1 -
 ratis-client/pom.xml           |   1 -
 ratis-common/pom.xml           |   3 +-
 ratis-examples/pom.xml         |  38 +---
 ratis-hadoop-shaded/.gitignore |   2 -
 ratis-hadoop-shaded/pom.xml    | 307 ++++++--------------------
 ratis-proto-shaded/.gitignore  |   2 -
 ratis-proto-shaded/pom.xml     | 478 +++++++----------------------------------
 11 files changed, 203 insertions(+), 703 deletions(-)

commit 151c2aeed9fd9ebd7d86dc8ceacbd8580f4a9520
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Tue Aug 7 00:42:15 2018 +0530

    RATIS-293. Add an api for RaftServer to return its current GroupId. Contributed by Mukul Kumar Singh.

 ratis-server/src/main/java/org/apache/ratis/server/RaftServer.java   | 3 +++
 .../src/main/java/org/apache/ratis/server/impl/RaftServerProxy.java  | 5 +++++
 2 files changed, 8 insertions(+)

commit 1bc5d2a8276d849857f8bfcd84e39d33e1e75670
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Tue Aug 7 00:35:12 2018 +0530

    RATIS-292. Provide a UUID based constructor for RaftGroupID and ClientID. Contributed by Mukul Kumar Singh.

 ratis-common/src/main/java/org/apache/ratis/protocol/ClientId.java  | 6 +++++-
 .../src/main/java/org/apache/ratis/protocol/RaftGroupId.java        | 6 +++++-
 ratis-common/src/main/java/org/apache/ratis/protocol/RaftId.java    | 4 ++++
 3 files changed, 14 insertions(+), 2 deletions(-)

commit ce88606a1c94622255ccadb1fdd474e48793e712
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Tue Aug 7 00:11:38 2018 +0530

    RATIS-285. Ratis State Machine should have an api to inform about loss of a follower/slow follower. Contributed by Mukul Kumar Singh.

 .../apache/ratis/grpc/server/GRpcLogAppender.java  |   1 +
 ratis-proto-shaded/src/main/proto/Raft.proto       |   6 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  10 ++
 .../org/apache/ratis/server/impl/FollowerInfo.java |   8 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   7 ++
 .../apache/ratis/server/impl/RaftServerImpl.java   |  16 +--
 .../apache/ratis/statemachine/StateMachine.java    |  12 +++
 .../ratis/TestRaftServerSlownessDetection.java     | 107 +++++++++++++++++++++
 .../statemachine/SimpleStateMachine4Testing.java   |  12 +++
 9 files changed, 168 insertions(+), 11 deletions(-)

commit 0236eea307fef8f8829b19dfef8919fb665f42fc
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Aug 3 13:44:50 2018 -0700

    RATIS-289. Optimize readStateMachine by allowing to enqueue multiple read requests in parallel.  Contributed by Mukul Kumar Singh

 .../java/org/apache/ratis/util/ProtoUtils.java     | 15 ++++++-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  1 +
 .../org/apache/ratis/server/impl/LogAppender.java  | 14 +++++--
 .../apache/ratis/server/storage/MemoryRaftLog.java |  4 +-
 .../org/apache/ratis/server/storage/RaftLog.java   | 46 +++++++++++++++++++++-
 .../ratis/server/storage/SegmentedRaftLog.java     | 16 ++------
 6 files changed, 75 insertions(+), 21 deletions(-)

commit c2423179b8390a7ece679465e50b9abd47b4686d
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Wed Aug 1 07:37:54 2018 +0530

    RATIS-286. Add information about raft peers and rpc delay in ServerInformationReply. Contributed by Mukul Kumar Singh.

 .../apache/ratis/client/impl/ClientProtoUtils.java |  7 +--
 .../ratis/protocol/ServerInformationReply.java     | 24 ++++------
 ratis-proto-shaded/src/main/proto/Raft.proto       | 37 +++++++++++++--
 .../apache/ratis/server/impl/FollowerState.java    |  4 ++
 .../apache/ratis/server/impl/RaftServerImpl.java   | 53 ++++++++++++++++++++--
 5 files changed, 99 insertions(+), 26 deletions(-)

commit a4fd89473d1849ac2b81a0d1bd7f60537630621a
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Tue Jul 31 13:10:37 2018 +0530

    RATIS-284. FollowerInfo#toString should print the elapsed time from last rpc. Contributed by Mukul Kumar Singh.

 .../src/main/java/org/apache/ratis/server/impl/FollowerInfo.java      | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c213a19691d38f0f28e58d3138f7c6b33689d235
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Mon Jul 30 13:11:21 2018 -0700

    RATIS-281. Ratis should provide an api to readStateMachineData when the cached segment is not available.  Contributed by Mukul Kumar Singh

 .../java/org/apache/ratis/util/ProtoUtils.java     | 14 ++++++++++-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  1 +
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |  5 ++++
 .../org/apache/ratis/server/storage/RaftLog.java   |  9 +++++++
 .../ratis/server/storage/RaftLogIOException.java   |  4 +++
 .../ratis/server/storage/SegmentedRaftLog.java     | 29 ++++++++++++++++++++++
 .../apache/ratis/statemachine/StateMachine.java    | 10 ++++++++
 .../statemachine/SimpleStateMachine4Testing.java   | 18 +++++++++++++-
 9 files changed, 89 insertions(+), 3 deletions(-)

commit a3a833290b15d0f74a27c03bf87a14bb380fb260
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Jul 25 13:17:38 2018 -0700

    RATIS-269. Enhance server information reply to add raft node role, raft storage directory status information.  Contributed by Mukul Kumar Singh

 .../apache/ratis/client/impl/ClientProtoUtils.java |  5 +-
 .../ratis/protocol/ServerInformationReply.java     | 29 +++++++++-
 .../arithmetic/ArithmeticStateMachine.java         |  5 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       | 13 ++++-
 .../java/org/apache/ratis/server/RaftServer.java   |  4 --
 .../apache/ratis/server/impl/RaftServerImpl.java   | 40 +++++++-------
 .../org/apache/ratis/server/impl/RoleInfo.java     | 62 ++++++++++++++++++++++
 .../ratis/server/storage/RaftStorageDirectory.java |  2 +-
 .../ratis/statemachine/TransactionContext.java     |  4 +-
 .../statemachine/impl/TransactionContextImpl.java  | 12 ++---
 10 files changed, 138 insertions(+), 38 deletions(-)

commit 4d00b24ddf9be560679dbe2ec6d6e0a36f4adc13
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Fri Jul 20 13:42:21 2018 -0700

    RATIS-263. Deadlock in ratis because of leader election.  Contributed by Rajeshbabu Chintaguntla

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 67bb9fcd4495eb4fa79c128a0abda3578d9a2947
Merge: ac79be6b a620c5d7
Author: Márton Elek <elek@apache.org>
Date:   Sun Jul 15 08:50:48 2018 +0200

    Merge commit 'a620c5d'

commit a620c5d7a8e011e29259da6d54af59549d497edd
Author: Márton Elek <elek@apache.org>
Date:   Sun Jul 15 08:50:01 2018 +0200

    Switch to 0.3.0-SNAPSHOT after the 0.2.0 release

 pom.xml                      | 2 +-
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop-shaded/pom.xml  | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto-shaded/pom.xml   | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 12 files changed, 12 insertions(+), 12 deletions(-)

commit ac79be6b25f3f87810015a07badcf20683cd87da
Author: Lokesh Jain <ljain@apache.org>
Date:   Tue Jul 10 23:17:40 2018 +0530

    RATIS-252. Add an API for state machine to determining server role. Contributed by Tsz Wo Nicholas Sze.

 .../arithmetic/ArithmeticStateMachine.java         | 24 ++++++++-----
 .../examples/filestore/FileStoreStateMachine.java  |  7 ++--
 .../java/org/apache/ratis/server/RaftServer.java   |  5 +++
 .../apache/ratis/server/impl/RaftServerImpl.java   | 15 ++++-----
 .../org/apache/ratis/server/impl/ServerState.java  |  7 ++--
 .../ratis/server/impl/StateMachineUpdater.java     |  4 +--
 .../apache/ratis/statemachine/StateMachine.java    | 13 +++-----
 .../ratis/statemachine/TransactionContext.java     |  3 ++
 .../ratis/statemachine/impl/BaseStateMachine.java  | 33 +++++++++---------
 .../statemachine/impl/TransactionContextImpl.java  | 39 ++++++++--------------
 .../statemachine/SimpleStateMachine4Testing.java   | 16 ++++-----
 11 files changed, 82 insertions(+), 84 deletions(-)

commit ca1106caf8f48daffba2f2f2bac2409ab64cabff
Author: Lokesh Jain <ljain@hortonworks.com>
Date:   Mon Jul 9 14:44:19 2018 +0530

    RATIS-266. Log Exception thrown during applyTransaction & writeStateMachineData. Contributed by Mukul Kumar Singh.

 .../java/org/apache/ratis/server/impl/RaftServerImpl.java  | 14 ++++++++++----
 .../org/apache/ratis/server/storage/RaftLogWorker.java     | 11 +++++++++--
 2 files changed, 19 insertions(+), 6 deletions(-)

commit 4d14160995063ea9d126cc5c5ca823e0e3d956ae
Author: Márton Elek <elek@apache.org>
Date:   Thu Jun 28 07:51:55 2018 +0200

    Change version for the version 0.2.0 -rc2

 pom.xml                      | 2 +-
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop-shaded/pom.xml  | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto-shaded/pom.xml   | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 12 files changed, 12 insertions(+), 12 deletions(-)

commit ca1c7dfd13191f39a918e60ca3f85fdab52e72ff
Author: Anu Engineer <aengineer@apache.org>
Date:   Wed Jun 27 22:28:46 2018 -0700

    RATIS-258. Release artifacts should include 'incubating' instead of 'incubator'
    Contributed by Elek, Marton.

 ratis-assembly/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 137415c2d864f5243709f9d9b52dfdfb87978350
Author: Anu Engineer <aengineer@apache.org>
Date:   Wed Jun 27 18:07:16 2018 -0700

    RATIS-249. Create separated LICENSE AND NOTICE files for binary and source releases.
    Contributed by Elek, Marton.

 LICENSE                                   | 215 ++----------------
 NOTICE                                    | 290 ------------------------
 ratis-assembly/src/main/assembly/bin.xml  |   8 +
 ratis-assembly/src/main/resources/LICENSE | 353 ++++++++++++++++++++++++++++++
 ratis-assembly/src/main/resources/NOTICE  | 324 +++++++++++++++++++++++++++
 5 files changed, 708 insertions(+), 482 deletions(-)

commit ccc380119edb31631943b91b1f2f0fa70fc3bf86
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Jun 14 17:32:10 2018 +0800

    RATIS-233. Throw an exception for the delayed requests if the leader is stepping down.  Contributed by Kit Hui

 .../apache/ratis/client/impl/ClientProtoUtils.java | 17 +++++++-
 .../ratis/protocol/NotReplicatedException.java     | 46 +++++++++++++++++++++
 .../org/apache/ratis/protocol/RaftClientReply.java | 17 ++++++--
 .../apache/ratis/protocol/RaftClientRequest.java   |  3 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  9 ++++-
 .../apache/ratis/server/impl/PendingRequest.java   | 12 ++++--
 .../apache/ratis/server/impl/PendingRequests.java  | 10 +++++
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  8 ++++
 .../test/java/org/apache/ratis/RaftBasicTests.java | 47 ++++++++++++++++++++++
 9 files changed, 158 insertions(+), 11 deletions(-)

commit 1b753aebac1598dd4140229c0ce7db88d75fcdb2
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Wed Jun 13 17:48:13 2018 +0800

    RATIS-254. Add test command to BUILDING.md.  Contributed by Kit Hui

 BUILDING.md | 6 ++++++
 1 file changed, 6 insertions(+)

commit 0a68fc2ee8df8ed42dfc79baec55aca5c8829625
Author: Márton Elek <elek@apache.org>
Date:   Thu Jun 7 16:32:29 2018 +0200

    RATIS-250. Use the LICENSE and NOTICE files in the source tree without the extensions. Contributed by Sandeep Nemuri.

 LICENSE.txt => LICENSE                   | 0
 NOTICE.txt => NOTICE                     | 0
 ratis-assembly/src/main/assembly/bin.xml | 4 ++--
 ratis-assembly/src/main/assembly/src.xml | 4 ++--
 4 files changed, 4 insertions(+), 4 deletions(-)

commit c3407a2206e5f9acac20efbc6998ae19164df5ce
Author: Tsz Wo Nicholas Sze <szetszwo@apache.org>
Date:   Thu Jun 7 21:23:39 2018 +0800

    RATIS-240. Move stateMachine from RaftServerProxy to RaftServerImpl.

 .../java/org/apache/ratis/grpc/TestRaftServerWithGrpc.java | 12 ++++++------
 .../src/main/java/org/apache/ratis/server/RaftServer.java  |  6 ------
 .../java/org/apache/ratis/server/impl/RaftServerImpl.java  | 14 +++++++++-----
 .../java/org/apache/ratis/server/impl/RaftServerProxy.java | 13 ++++---------
 .../java/org/apache/ratis/server/impl/ServerImplUtils.java |  9 ++++++++-
 .../java/org/apache/ratis/statemachine/StateMachine.java   |  6 ++++++
 .../src/test/java/org/apache/ratis/RaftAsyncTests.java     |  4 ++--
 .../org/apache/ratis/server/impl/RaftServerTestUtil.java   | 11 -----------
 .../apache/ratis/statemachine/RaftSnapshotBaseTest.java    |  4 ++--
 .../ratis/statemachine/SimpleStateMachine4Testing.java     |  4 ++--
 .../org/apache/ratis/statemachine/TestStateMachine.java    |  7 +++----
 11 files changed, 42 insertions(+), 48 deletions(-)

commit 038ef310cab0043a630bcf00f490ec334e358b5e
Author: Márton Elek <elek@apache.org>
Date:   Thu Jun 7 00:09:33 2018 +0200

    RATIS-247. Add a JUnit RunListener to dump all threads when test timeout. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                                            | 33 ++------
 .../main/java/org/apache/ratis/util/JavaUtils.java |  9 +++
 .../java/org/apache/ratis/JUnitRunListener.java    | 89 ++++++++++++++++++++++
 .../apache/ratis/util/TestTimeoutScheduler.java    |  0
 ratis-hadoop-shaded/pom.xml                        | 12 +++
 ratis-proto-shaded/pom.xml                         | 12 +++
 .../ratis/server/impl/TestRaftServerJmx.java       |  4 +-
 7 files changed, 131 insertions(+), 28 deletions(-)

commit cf1e6a3c8732cbaaf2d5b55a95c88011147bb127
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu May 31 20:33:12 2018 +0530

    RATIS-239. LogAppender should reconnect for some IOException. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/client/RaftClientRpc.java     |  2 +-
 .../ratis/client/impl/RaftClientRpcWithProxy.java  | 13 +----
 .../main/java/org/apache/ratis/util/IOUtils.java   |  8 +++
 .../main/java/org/apache/ratis/util/LifeCycle.java |  1 -
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  6 +++
 .../apache/ratis/grpc/server/GRpcLogAppender.java  | 10 +---
 .../org/apache/ratis/server/RaftServerRpc.java     |  4 ++
 .../org/apache/ratis/server/impl/LeaderState.java  | 12 ++---
 .../org/apache/ratis/server/impl/LogAppender.java  | 58 ++++++++++++++++------
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  8 ++-
 .../ratis/server/impl/RaftServerRpcWithProxy.java  |  5 ++
 .../ratis/server/impl/StateMachineUpdater.java     |  4 --
 .../java/org/apache/ratis/MiniRaftCluster.java     | 27 +++++++---
 .../test/java/org/apache/ratis/RaftBasicTests.java |  3 +-
 .../java/org/apache/ratis/RetryCacheTests.java     |  4 +-
 .../server/impl/RaftReconfigurationBaseTest.java   | 17 ++++---
 .../server/simulation/SimulatedClientRpc.java      |  2 +-
 .../server/simulation/SimulatedServerRpc.java      |  5 ++
 19 files changed, 124 insertions(+), 67 deletions(-)

commit 5016d5d7af93936a1dc9065806dde423219a3345
Author: Márton Elek <elek@apache.org>
Date:   Mon May 14 22:47:04 2018 +0200

    RATIS-238. Bump the copyright year of the NOTICE.txt. Contributed by Elek, Marton.

 NOTICE.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d7d7061803b1bfa8890982153db82fcadde7e777
Author: Márton Elek <elek@apache.org>
Date:   Fri May 11 16:50:13 2018 +0200

    RATIS-237. Multiple definition of io.opencensus.trace.unsafe.ContextUtils is resolved as dependency causing runtime issue. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                    | 27 +++++++++++----------
 ratis-grpc/pom.xml         | 16 -------------
 ratis-netty/pom.xml        |  5 ----
 ratis-proto-shaded/pom.xml | 60 +++++++++++++++++++++++++++++++++++-----------
 4 files changed, 60 insertions(+), 48 deletions(-)

commit fef6574c2887d99d1f04618ade6dec1c67eeb6bd
Author: Tsz Sze <szetszwo@HW14119.local>
Date:   Fri May 4 10:55:45 2018 -0700

    RATIS-236. Use TimeoutScheduler in RaftClientImpl.

 .../apache/ratis/client/impl/RaftClientImpl.java   | 13 ++++----
 .../org/apache/ratis/util/TimeoutScheduler.java    | 38 ++++++++++++++--------
 .../grpc/client/RaftClientProtocolClient.java      |  6 ++--
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  5 +--
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 22 +++++++++----
 .../test/java/org/apache/ratis/RaftBasicTests.java | 20 +++++++++---
 .../apache/ratis/util/TestTimeoutScheduler.java    |  8 ++---
 7 files changed, 73 insertions(+), 39 deletions(-)

commit 09bb6cd1692b6506a3f9db805f911e277c627a80
Author: Tsz Sze <szetszwo@HW14119.local>
Date:   Wed May 2 11:25:55 2018 -0700

    RATIS-235. RaftTestUtil.assertLogEntries should check index for async tests.

 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  4 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  5 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 ++
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 69 ++++++++++------------
 .../test/java/org/apache/ratis/RaftBasicTests.java | 61 +++++++++++--------
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 37 +++++++++---
 .../ratis/server/impl/RaftServerTestUtil.java      |  4 ++
 7 files changed, 106 insertions(+), 78 deletions(-)

commit 451e8551b7f8aea23a969d6bccb8a56b5937c7f7
Author: Tsz Sze <szetszwo@HW14119.local>
Date:   Mon Apr 30 10:50:03 2018 -0700

    RATIS-231. Grpc server should reconnect if there is an exception.

 .../org/apache/ratis/protocol/RaftClientReply.java |   3 +-
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  88 +++-------
 .../apache/ratis/grpc/server/GRpcLogAppender.java  | 187 ++++++++++-----------
 .../grpc/server/RaftServerProtocolClient.java      |   7 +-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  11 --
 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  |  25 +--
 .../org/apache/ratis/server/impl/LogAppender.java  |  24 ++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   9 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |   9 +-
 .../org/apache/ratis/server/impl/ServerState.java  |  20 +--
 .../ratis/server/storage/RaftStorageDirectory.java |   2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  10 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |   8 +-
 13 files changed, 172 insertions(+), 231 deletions(-)

commit ba83ce132769591f302e5f780117cc03130b4870
Author: Tsz Sze <szetszwo@HW14119.local>
Date:   Thu Apr 26 12:14:00 2018 -0700

    RATIS-226. Skip the hadoop-rpc unit tests and TestRaftStream.  Contributed by Kit Hui

 .../org/apache/ratis/examples/ParameterizedBaseTest.java     |  2 +-
 .../src/test/java/org/apache/ratis/grpc/TestRaftStream.java  |  2 ++
 ratis-hadoop/pom.xml                                         | 12 ++++++++++++
 3 files changed, 15 insertions(+), 1 deletion(-)

commit 5e3269bb2c0d95b011097ad71124a2d2796739fc
Author: Tsz Sze <szetszwo@HW14119.local>
Date:   Wed Apr 25 10:47:02 2018 -0700

    RATIS-230. Improve gRPC log messages.

 .../main/java/org/apache/ratis/util/LogUtils.java    | 11 +++++++++++
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java     | 20 ++++++++++++++++++--
 .../ratis/grpc/client/RaftClientProtocolService.java |  6 ++++--
 .../apache/ratis/grpc/server/GRpcLogAppender.java    |  5 +----
 .../ratis/grpc/server/RaftServerProtocolService.java | 15 +++++----------
 5 files changed, 39 insertions(+), 18 deletions(-)

commit 55fffd96b8b1c31e1a4b9549b26657c881eea02e
Author: Tsz Sze <szetszwo@HW14119.local>
Date:   Tue Apr 24 11:09:06 2018 -0700

    RATIS-228. Handle zero size log_inprogress file.  Contributed by Kit Hui

 .../org/apache/ratis/server/storage/LogSegment.java |  5 ++++-
 .../ratis/server/storage/RaftStorageDirectory.java  | 10 +++++++---
 .../ratis/server/storage/TestRaftLogSegment.java    | 21 +++++++++++++++++++++
 3 files changed, 32 insertions(+), 4 deletions(-)

commit bbc79cf4621536d212ee1caffaabb54eba4263a6
Author: Márton Elek <elek@apache.org>
Date:   Sat Apr 21 22:02:14 2018 +0200

    RATIS-223. Bash script to stop Ratis started in Ratis-examples. Contributed by Vinay Banakar.

 ratis-examples/src/main/bin/stop-all.sh | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

commit 4309324418d90f8a86160456019f04e9e66bb2cb
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Apr 14 00:33:40 2018 +0800

    RATIS-225. Grpc LogAppender should update matchIndex on heartbeat reply.  Contribtued Lokesh Jain

 .../apache/ratis/grpc/server/GRpcLogAppender.java  | 15 +++--
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    | 68 ++++++++++++++++++++++
 .../org/apache/ratis/server/impl/FollowerInfo.java |  3 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  4 ++
 .../apache/ratis/server/impl/RaftServerImpl.java   |  4 ++
 .../test/java/org/apache/ratis/RaftAsyncTests.java |  1 -
 .../ratis/server/impl/RaftServerTestUtil.java      |  5 ++
 7 files changed, 93 insertions(+), 7 deletions(-)

commit 6c97d0603ae8c12776b87b419ac5e66adafcccc5
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Apr 13 09:45:14 2018 +0800

    RATIS-219. Add configuration for timeout duration.  Contributed by Lokesh Jain

 .../apache/ratis/client/RaftClientConfigKeys.java  | 23 +++++++++------
 .../apache/ratis/client/impl/RaftClientImpl.java   |  2 +-
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java |  2 +-
 .../org/apache/ratis/grpc/RaftGRpcService.java     | 10 +++++--
 .../apache/ratis/grpc/client/AppendStreamer.java   |  2 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  3 +-
 .../grpc/client/RaftClientProtocolClient.java      | 33 ++++++++++++++--------
 .../ratis/grpc/client/RaftClientProtocolProxy.java |  9 +++---
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  7 +++--
 .../grpc/server/RaftServerProtocolClient.java      | 17 +++++------
 .../apache/ratis/server/RaftServerConfigKeys.java  | 10 +++++++
 11 files changed, 73 insertions(+), 45 deletions(-)

commit e37ab2ee164fab84172513a72aa7175826b8dfd0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Apr 11 20:34:18 2018 +0800

    RATIS-224. In RpcTimeout, it should shut down the scheduler if there is no tasks.

 .../main/java/org/apache/ratis/rpc/RpcTimeout.java |  70 -------
 .../java/org/apache/ratis/util/TimeDuration.java   |   4 +
 .../org/apache/ratis/util/TimeoutScheduler.java    | 123 ++++++++++++
 .../grpc/client/RaftClientProtocolClient.java      |  13 +-
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  14 +-
 .../apache/ratis/util/TestTimeoutScheduler.java    | 210 +++++++++++++++++++++
 6 files changed, 344 insertions(+), 90 deletions(-)

commit c692bf201d01a67e2c85efcd625e0bf80c96758b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Apr 10 19:10:30 2018 +0800

    RATIS-208. Allow client to specify replication level in a request.  Contributed by Kit Hui

 .../java/org/apache/ratis/client/RaftClient.java   | 23 +++++++-
 .../apache/ratis/client/impl/RaftClientImpl.java   |  9 +--
 .../apache/ratis/protocol/RaftClientRequest.java   | 23 +++++---
 ratis-proto-shaded/src/main/proto/Raft.proto       |  6 ++
 .../org/apache/ratis/server/impl/LeaderState.java  | 49 ++++++++++------
 .../apache/ratis/server/impl/PendingRequest.java   | 18 +++++-
 .../apache/ratis/server/impl/PendingRequests.java  | 67 +++++++++++++++++++++-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  6 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 18 +++++-
 .../test/java/org/apache/ratis/RaftBasicTests.java | 39 +++++++++++--
 10 files changed, 214 insertions(+), 44 deletions(-)

commit 00f64b4c17dfa2f5bd57d25aec5c5eb24c1bb535
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Apr 7 21:51:02 2018 +0800

    RATIS-217. Support timeout for append entry requests(GrpcLogAppender).  Contributed by Lokesh Jain

 .../main/java/org/apache/ratis/rpc/RpcTimeout.java | 39 +++++++++++------
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   | 20 ++++++++-
 .../grpc/client/RaftClientProtocolClient.java      | 15 ++++---
 .../apache/ratis/grpc/server/GRpcLogAppender.java  | 50 ++++++++++++++++++----
 .../grpc/server/RaftServerProtocolService.java     |  2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  7 +--
 .../org/apache/ratis/server/impl/LogAppender.java  | 11 ++---
 .../apache/ratis/server/impl/RaftServerImpl.java   | 12 +++---
 .../apache/ratis/server/impl/ServerProtoUtils.java | 14 +++---
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 41 ++++++++++++++++++
 .../statemachine/SimpleStateMachine4Testing.java   | 30 ++++++++++++-
 11 files changed, 191 insertions(+), 50 deletions(-)

commit 05fb38bf1e169e30a59c511682159964b47ec8c6
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sun Apr 1 03:46:42 2018 +0800

    RATIS-168. Update Grpc and netty versions in Ratis.  Contributed by Mukul Kumar Singh

 pom.xml                     |   7 ++-
 ratis-grpc/pom.xml          |  11 ++++
 ratis-hadoop-shaded/pom.xml |  10 +---
 ratis-hadoop/pom.xml        |   8 ++-
 ratis-proto-shaded/pom.xml  | 120 +++++++++++++++++++++++++++++++++++---------
 5 files changed, 121 insertions(+), 35 deletions(-)

commit d87875e5c9288ea5ab6e5e864f9e4735605ca0f0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Mar 29 19:28:56 2018 +0800

    RATIS-211. Include copyright notices required by a binary release.  Contributed by Elek, Marton

 LICENSE.txt                                        |   2 +-
 NOTICE.txt                                         | 292 +++++++++++++++++++++
 ratis-examples/pom.xml                             |  10 +
 ratis-examples/src/main/resources/log4j.properties |  23 ++
 4 files changed, 326 insertions(+), 1 deletion(-)

commit f2fed3a4d88b353f22df9a4b88445842ca9a9577
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Mar 28 13:41:26 2018 +0800

    RATIS-176. Log Appender should throw an Exception in case append entry size exceeds the maxBufferSize configured.  Contributed by Shashikant Banerjee

 .../ratis/protocol/StateMachineException.java      |  5 ++++-
 .../org/apache/ratis/server/impl/ServerState.java  |  4 +++-
 .../apache/ratis/server/storage/MemoryRaftLog.java |  4 ++--
 .../org/apache/ratis/server/storage/RaftLog.java   | 10 ++++++++-
 .../ratis/server/storage/RaftLogIOException.java   |  4 ++++
 .../ratis/server/storage/SegmentedRaftLog.java     |  3 ++-
 .../org/apache/ratis/RaftExceptionBaseTest.java    | 25 +++++++++++++++++++++-
 7 files changed, 48 insertions(+), 7 deletions(-)

commit 9494b75c1ef285fb8a292118de97ccc37cc5b89c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Mar 27 15:36:16 2018 +0800

    RATIS-209. StateMachine updater may miss writeLog Request after a new Leader is chosen.  Contributed by Mukul Kumar Singh

 .../org/apache/ratis/server/storage/SegmentedRaftLog.java     | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit 288ea4f427f3670ebcbe8027587fbcf2a4d56986
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Mar 23 18:23:16 2018 +0800

    RATIS-215. Support timeout for async calls (Grpc).  Contributed by Lokesh Jain

 .../main/java/org/apache/ratis/rpc/RpcTimeout.java | 55 ++++++++++++++++++++++
 .../grpc/client/RaftClientProtocolClient.java      | 29 ++++++++----
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 13 +++++
 .../test/java/org/apache/ratis/RaftBasicTests.java |  2 +-
 4 files changed, 90 insertions(+), 9 deletions(-)

commit b47ba4266c1ecb308130530e4d34ad08e209924b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Mar 22 08:46:34 2018 +0800

    RATIS-213. Typo: ServerInformatonRequest. Contributed by Kit Hui.

 .../main/java/org/apache/ratis/client/impl/ClientProtoUtils.java    | 6 +++---
 .../src/main/java/org/apache/ratis/client/impl/RaftClientImpl.java  | 2 +-
 .../java/org/apache/ratis/protocol/AdminAsynchronousProtocol.java   | 2 +-
 .../src/main/java/org/apache/ratis/protocol/AdminProtocol.java      | 2 +-
 .../{ServerInformatonRequest.java => ServerInformationRequest.java} | 6 +++---
 .../src/main/java/org/apache/ratis/grpc/client/GrpcClientRpc.java   | 4 ++--
 .../java/org/apache/ratis/grpc/server/AdminProtocolService.java     | 4 ++--
 .../client/CombinedClientProtocolClientSideTranslatorPB.java        | 4 ++--
 .../client/CombinedClientProtocolServerSideTranslatorPB.java        | 2 +-
 .../java/org/apache/ratis/hadooprpc/client/HadoopClientRpc.java     | 4 ++--
 .../src/main/java/org/apache/ratis/netty/client/NettyClientRpc.java | 6 +++---
 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java  | 2 +-
 .../src/main/java/org/apache/ratis/server/impl/RaftServerProxy.java | 4 ++--
 .../java/org/apache/ratis/server/simulation/SimulatedServerRpc.java | 4 ++--
 14 files changed, 26 insertions(+), 26 deletions(-)

commit 1185121ab57cb64f14947510f7e7ebafe8c6ef54
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Mar 21 11:38:19 2018 +0800

    RATIS-214. Support timeout using withDeadlineAfter for the blockingStub(Grpc).  Contributed by Lokesh Jain

 .../apache/ratis/client/impl/RaftClientImpl.java   |  4 +++
 .../ratis/client/impl/RaftClientTestUtil.java      |  4 +++
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  2 +-
 .../grpc/client/RaftClientProtocolClient.java      | 18 ++++++++--
 .../grpc/server/RaftServerProtocolClient.java      | 11 ++++--
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  7 ++++
 .../test/java/org/apache/ratis/RaftBasicTests.java | 39 ++++++++++++++++++++++
 .../ratis/server/impl/RetryCacheTestUtil.java      |  4 +++
 8 files changed, 83 insertions(+), 6 deletions(-)

commit cbfa28a0232d969521f5d905d3d22c3b0a8ab402
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Fri Mar 16 21:42:07 2018 +0530

    RATIS-210. Refactor client request proto. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/ClientProtoUtils.java |  45 ++++++-
 .../apache/ratis/client/impl/RaftClientImpl.java   |  32 ++---
 .../apache/ratis/protocol/RaftClientRequest.java   | 144 ++++++++++++++++-----
 .../apache/ratis/protocol/ReinitializeRequest.java |   2 +-
 .../ratis/protocol/ServerInformatonRequest.java    |   2 +-
 .../ratis/protocol/SetConfigurationRequest.java    |   2 +-
 .../TestRaftStateMachineException.java             |   8 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  26 ++--
 .../apache/ratis/server/impl/PendingRequests.java  |   3 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   6 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  10 +-
 .../java/org/apache/ratis/RetryCacheTests.java     |  10 +-
 12 files changed, 206 insertions(+), 84 deletions(-)

commit 8fd74ede411196a2b762b6ed741eccb30248e81c
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Sun Feb 18 19:45:14 2018 +0530

    RATIS-207. Implement stale read. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/client/RaftClient.java   |  6 ++
 .../apache/ratis/client/impl/ClientProtoUtils.java |  9 ++-
 .../apache/ratis/client/impl/RaftClientImpl.java   | 70 ++++++++++++-----
 .../apache/ratis/protocol/RaftClientRequest.java   | 43 +++++++++--
 .../apache/ratis/protocol/StaleReadException.java  | 27 +++++++
 .../ratis/protocol/StateMachineException.java      |  4 +
 .../src/test/java/org/apache/ratis/BaseTest.java   | 55 ++++++++++---
 .../apache/ratis/grpc/client/AppendStreamer.java   |  2 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       | 11 ++-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 33 +++++++-
 .../apache/ratis/statemachine/StateMachine.java    | 13 ++++
 .../ratis/statemachine/impl/BaseStateMachine.java  | 25 +++++-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 89 +++++++++++++++++++++-
 .../org/apache/ratis/RaftExceptionBaseTest.java    | 13 +++-
 .../statemachine/SimpleStateMachine4Testing.java   |  6 +-
 15 files changed, 355 insertions(+), 51 deletions(-)

commit 4104860b9a1b79b997df4e39c3c70c7008422da4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Feb 15 14:49:00 2018 +0800

    RATIS-205. Return commit information to client.

 .../apache/ratis/client/impl/ClientProtoUtils.java | 10 ++-
 .../java/org/apache/ratis/protocol/Message.java    |  4 +
 .../org/apache/ratis/protocol/RaftClientReply.java | 46 ++++++++---
 .../java/org/apache/ratis/protocol/RaftGroup.java  | 31 +++++---
 .../ratis/protocol/ServerInformationReply.java     | 30 ++++----
 .../java/org/apache/ratis/util/ProtoUtils.java     | 23 ++++++
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  2 +
 ratis-proto-shaded/src/main/proto/Raft.proto       | 20 +++--
 .../apache/ratis/server/impl/CommitInfoCache.java  | 52 +++++++++++++
 .../org/apache/ratis/server/impl/FollowerInfo.java | 21 ++++-
 .../org/apache/ratis/server/impl/LeaderState.java  | 15 ++++
 .../org/apache/ratis/server/impl/LogAppender.java  | 20 +++--
 .../apache/ratis/server/impl/PendingRequest.java   |  6 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 90 +++++++++++++---------
 .../apache/ratis/server/impl/RaftServerProxy.java  | 26 ++-----
 .../apache/ratis/server/impl/ServerProtoUtils.java |  9 +--
 .../org/apache/ratis/server/impl/ServerState.java  | 37 ++++-----
 .../org/apache/ratis/server/storage/RaftLog.java   |  5 +-
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  2 +-
 .../server/impl/ServerInformationBaseTest.java     | 74 +++++++++++++++---
 21 files changed, 374 insertions(+), 151 deletions(-)

commit 3e69b13a2bfd55c56e0c5f2d310601dcfc46731e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Feb 12 10:07:03 2018 +0800

    RATIS-170. Add async support to the FileStore example.

 .../main/java/org/apache/ratis/util/JavaUtils.java |  11 ++
 .../main/java/org/apache/ratis/util/LogUtils.java  |   2 +-
 .../apache/ratis/examples/filestore/FileInfo.java  |  80 +++++++++----
 .../ratis/examples/filestore/FileStoreClient.java  |  80 ++++++++++---
 .../examples/filestore/FileStoreAsyncBaseTest.java | 110 ++++++++++++++++++
 .../examples/filestore/FileStoreBaseTest.java      | 126 +++++++++++++++++----
 .../filestore/TestFileStoreAsyncWithGrpc.java      |  25 ++++
 7 files changed, 379 insertions(+), 55 deletions(-)

commit bb5c258c308acb04bf0daf412f89a3da8400f694
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Feb 7 12:20:28 2018 -0800

    RATIS-197. In gRPC, reads are failing for size greater than 4MB.  Contributed by Mukul Kumar Singh

 .../main/java/org/apache/ratis/grpc/client/AppendStreamer.java | 10 +++++-----
 .../main/java/org/apache/ratis/grpc/client/GrpcClientRpc.java  |  6 +++---
 .../org/apache/ratis/grpc/client/RaftClientProtocolClient.java |  3 ++-
 .../org/apache/ratis/grpc/client/RaftClientProtocolProxy.java  |  4 ++--
 4 files changed, 12 insertions(+), 11 deletions(-)

commit 415bb3ed7fa7363e77ae4fd66195e5960a0cf479
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Feb 6 13:28:46 2018 -0800

    RATIS-201. RaftBasicTests.testWithLoad may fail due to IllegalStateException.  Contributed by Lokesh Jain

 .../src/test/java/org/apache/ratis/RaftBasicTests.java         | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 2ca8b934bf55c57f55108524189c6a7789cb35c3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Feb 5 16:41:58 2018 -0800

    Revert "RATIS-201. RaftBasicTests.testWithLoad should use RaftTestUtil.waitForLeader instead of cluster.getLeader().  Contributed by Lokesh Jain"
    
    This reverts commit cb7e6d42904ed91d960c8dd8c9e49d0f0461c228.

 ratis-server/src/test/java/org/apache/ratis/RaftBasicTests.java | 2 +-
 ratis-server/src/test/java/org/apache/ratis/RaftTestUtil.java   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 326acb087949498be31ce00e0c0bb0fecc32c1a7
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Feb 5 13:43:42 2018 -0800

    RATIS-203. RaftClient request may wait indefinitely for a reply.  Contributed by Lokesh Jain

 .../apache/ratis/server/impl/RaftServerImpl.java   | 14 ++++++-
 .../ratis/server/storage/SegmentedRaftLog.java     | 14 +++++++
 .../ratis/server/impl/RetryCacheTestUtil.java      | 48 ++++++++++++++++++++++
 .../ratis/server/storage/TestSegmentedRaftLog.java | 32 +++++++++++++--
 4 files changed, 103 insertions(+), 5 deletions(-)

commit cb7e6d42904ed91d960c8dd8c9e49d0f0461c228
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Feb 5 13:12:17 2018 -0800

    RATIS-201. RaftBasicTests.testWithLoad should use RaftTestUtil.waitForLeader instead of cluster.getLeader().  Contributed by Lokesh Jain

 ratis-server/src/test/java/org/apache/ratis/RaftBasicTests.java | 2 +-
 ratis-server/src/test/java/org/apache/ratis/RaftTestUtil.java   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 2d53656837d9d56792bc62a062dc1481aaab3024
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Feb 5 22:06:36 2018 +0530

    RATIS-206. Change StateMachine.query to pass and return Message. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/ClientProtoUtils.java | 16 +-----------
 .../java/org/apache/ratis/protocol/Message.java    | 26 +++++++++++++++++++
 .../java/org/apache/ratis/util/StringUtils.java    |  4 ++-
 .../arithmetic/ArithmeticStateMachine.java         | 15 +++--------
 .../examples/arithmetic/AssignmentMessage.java     |  4 +--
 .../examples/arithmetic/expression/Expression.java | 10 +++-----
 .../ratis/examples/filestore/FileStoreClient.java  |  2 +-
 .../examples/filestore/FileStoreStateMachine.java  | 16 ++++++------
 .../apache/ratis/server/impl/RaftServerImpl.java   |  3 ++-
 .../apache/ratis/statemachine/StateMachine.java    |  4 +--
 .../ratis/statemachine/impl/BaseStateMachine.java  |  8 +++---
 .../org/apache/ratis/RaftExceptionBaseTest.java    |  4 +--
 .../statemachine/SimpleStateMachine4Testing.java   | 30 +++++++++++++++-------
 13 files changed, 78 insertions(+), 64 deletions(-)

commit 1beef8741160aa471a3b5af4c677875296f0a0aa
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Feb 1 10:49:01 2018 +0530

    RATIS-204. Add getLastAppliedTermIndex to StateMachine. Contributed by Tsz Wo Nicholas Sze.

 .../main/java/org/apache/ratis/util/JavaUtils.java | 27 ++------
 .../org/apache/ratis/util/MemoizedSupplier.java    | 74 ++++++++++++++++++++++
 .../arithmetic/ArithmeticStateMachine.java         | 28 ++------
 .../examples/filestore/FileStoreStateMachine.java  | 29 +++------
 .../apache/ratis/server/impl/RaftServerImpl.java   | 14 ++--
 .../ratis/server/impl/StateMachineUpdater.java     | 19 ++++--
 .../apache/ratis/statemachine/StateMachine.java    |  8 ++-
 .../ratis/statemachine/TransactionContext.java     | 12 ++--
 .../ratis/statemachine/impl/BaseStateMachine.java  | 38 +++++++++--
 .../statemachine/SimpleStateMachine4Testing.java   | 21 ++----
 .../ratis/statemachine/TermIndexTracker.java       | 68 --------------------
 11 files changed, 167 insertions(+), 171 deletions(-)

commit dd15f2a29ba408f690821f97d4372b32d813346d
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Jan 29 18:53:27 2018 +0530

    RATIS-184. Document how to deploy the snapshot artifacts. Contributed by Tsz Wo Nicholas Sze.

 BUILDING.md | 32 -----------------------
 DEPLOY.md   | 84 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 84 insertions(+), 32 deletions(-)

commit 2d99e61728402ccf848f4c47a38ac15d6275344d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 26 17:20:59 2018 -0800

    RATIS-127. Move the state machine implementation to a new package.  Contributed by Jing Chen

 .../arithmetic/ArithmeticStateMachine.java         |   3 +
 .../examples/filestore/FileStoreStateMachine.java  |   7 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   3 +-
 .../ratis/statemachine/TransactionContext.java     | 183 ++++++-------------
 .../statemachine/{ => impl}/BaseStateMachine.java  |   8 +-
 .../{ => impl}/FileListSnapshotInfo.java           |   3 +-
 .../{ => impl}/SimpleStateMachineStorage.java      |   3 +-
 .../{ => impl}/SingleFileSnapshotInfo.java         |   2 +-
 .../statemachine/impl/TransactionContextImpl.java  | 200 +++++++++++++++++++++
 .../java/org/apache/ratis/MiniRaftCluster.java     |   2 +-
 .../ratis/server/storage/TestRaftStorage.java      |   2 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   6 +-
 .../ratis/statemachine/TestStateMachine.java       |   3 +-
 13 files changed, 279 insertions(+), 146 deletions(-)

commit c16cb1c6598855c47737dff46d4b07a580a37a32
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jan 24 13:58:47 2018 -0800

    RATIS-169. Add TestWithLoad for async api.  Contributed by Lokesh Jain

 .../test/java/org/apache/ratis/RaftAsyncTests.java | 11 +++++
 .../test/java/org/apache/ratis/RaftBasicTests.java | 54 ++++++++++++++++------
 2 files changed, 52 insertions(+), 13 deletions(-)

commit 0f7169db51ba15108c265b1e937e9daeaa085045
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Jan 22 12:59:31 2018 +0530

    RATIS-153. AsyncAppendEntries misses updating followerstate at end of logsync. Contributed by Mukul Kumar Singh.

 .../apache/ratis/server/impl/RaftServerImpl.java   | 22 +++++++++++++---------
 1 file changed, 13 insertions(+), 9 deletions(-)

commit 9f93037a965970d0de1db7920ac498901886c45e
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Mon Jan 22 10:48:52 2018 +0530

    RATIS-196. RaftServerProtocolService may continue to reply after it is closed. Contributed by Mukul Kumar Singh.

 .../apache/ratis/grpc/server/RaftServerProtocolService.java  | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

commit 7b3a9a6f5f8e8075727d84e3ddeae7b594eda89c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 19 18:20:56 2018 +0800

    RATIS-192. In gRPC, appendEntries replies were received out of order on the Leader.  Contributed by Mukul Kumar Singh

 .../ratis/grpc/server/RaftServerProtocolService.java      | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

commit 5b4bc0e7d12e1b2a465774c133e04150b91fcbd9
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jan 18 14:16:28 2018 -0800

    RATIS-160. Retry cache should handle leader change after log commit. Contributed by Lokesh Jain.

 .../src/main/java/org/apache/ratis/server/impl/RaftServerImpl.java  | 4 ++++
 .../src/main/java/org/apache/ratis/server/impl/RetryCache.java      | 6 +++++-
 2 files changed, 9 insertions(+), 1 deletion(-)

commit bc435ad49b4d81708b873005688f3dd65f3523a1
Author: Mukul Kumar Singh <msingh@apache.org>
Date:   Thu Jan 18 14:29:15 2018 +0530

    RATIS-193. RaftClientProtocolService can close a stream twice on error. Contributed by Mukul Kumar Singh.

 .../apache/ratis/grpc/client/RaftClientProtocolService.java    | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 8cac9d54f1e3e713afe41c170da59a41efd81334
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 12 09:16:54 2018 +0800

    RATIS-189. AppendRequestStreamObserver close can be called twice.  Contributed by Mukul Kumar Singh

 .../apache/ratis/grpc/client/RaftClientProtocolService.java   | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

commit 1f4b5727b5b536cd10a51f8378358386e2a798da
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jan 9 12:08:46 2018 +0800

    RATIS-158. mvn clean install on centos7 fails.  Contributed by Sandeep Nemuri

 ratis-proto-shaded/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit de25e8130176d8d347acc82ef9fc16881837f80c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jan 8 17:52:56 2018 +0800

    RATIS-183.  In gRPC, Follower should not wait for log sync to process next appendEntries.  Contributed by Mukul Kumar Singh

 .../grpc/server/RaftServerProtocolService.java     |  9 +++----
 .../java/org/apache/ratis/server/RaftServer.java   |  4 ++-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 30 ++++++++++++++-------
 .../apache/ratis/server/impl/RaftServerProxy.java  |  6 +++++
 .../protocol/RaftServerAsynchronousProtocol.java   | 31 ++++++++++++++++++++++
 5 files changed, 64 insertions(+), 16 deletions(-)

commit d022b687f2c0c4fd23a6383dd8f27cad10363273
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sun Jan 7 16:09:38 2018 +0800

    RATIS-185. Unable to assign more than one digit in the CLI of arithmetic example.  Contributed by Sandeep Nemuri

 .../main/java/org/apache/ratis/examples/arithmetic/cli/Assign.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 46084224605791a34632b03483c5abf656cf6c8f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sun Jan 7 16:06:08 2018 +0800

    RATIS-186. Add a Config option to specify the flow control window size in ratis-grpc.  Contributed by Mukul Kumar Singh

 .../src/main/java/org/apache/ratis/grpc/GrpcConfigKeys.java   | 11 +++++++++++
 .../src/main/java/org/apache/ratis/grpc/RaftGRpcService.java  | 11 ++++++++---
 .../java/org/apache/ratis/grpc/client/AppendStreamer.java     |  3 ++-
 .../main/java/org/apache/ratis/grpc/client/GrpcClientRpc.java |  3 ++-
 .../apache/ratis/grpc/client/RaftClientProtocolClient.java    | 11 +++++++----
 .../org/apache/ratis/grpc/client/RaftClientProtocolProxy.java |  6 ++++--
 .../apache/ratis/grpc/server/RaftServerProtocolClient.java    |  9 +++++----
 7 files changed, 39 insertions(+), 15 deletions(-)

commit 7a955ef438af44de89f031c49ec1bb763361d06a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 5 14:31:17 2018 +0800

    RATIS-177. Raft Leader should not return LeaderNotReady Exception for old completed requests.  Contributed by Lokesh Jain

 .../main/java/org/apache/ratis/server/impl/RaftServerImpl.java    | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 00f80b446faa61310f58d9986aa9bdcea56ac970
Author: Chen Liang <cliang@apache.org>
Date:   Wed Jan 3 13:23:09 2018 -0800

    RATIS-178. New servers may not be able to join an existing raft group. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   | 10 ++++--
 .../apache/ratis/grpc/server/GRpcLogAppender.java  | 25 +++++++-------
 .../grpc/server/RaftServerProtocolService.java     |  7 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   | 20 ++++++-----
 .../ratis/server/impl/LeaderElectionTests.java     | 40 ++++++++++++++++++++++
 5 files changed, 78 insertions(+), 24 deletions(-)

commit 7f57773b8ab62e11b6307cef2acf594b44b03e97
Author: Chen Liang <cliang@apache.org>
Date:   Tue Jan 2 11:06:24 2018 -0800

    RATIS-179. Improve the log message in leader election and refactor the tests. Tsz Wo Nicholas Sze.

 .../main/java/org/apache/ratis/util/JavaUtils.java |  8 +--
 .../ratis/grpc/TestLeaderElectionWithGrpc.java     | 36 ++++++++++
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    | 18 -----
 .../hadooprpc/TestLeaderElectionWithHadoopRpc.java | 56 +++++++++++++++
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     | 11 ---
 .../ratis/netty/TestLeaderElectionWithNetty.java   | 35 +++++++++
 .../org/apache/ratis/netty/TestRaftWithNetty.java  | 18 -----
 .../apache/ratis/server/impl/RaftServerImpl.java   | 20 +++---
 .../org/apache/ratis/server/impl/ServerState.java  | 13 ++--
 .../java/org/apache/ratis/MiniRaftCluster.java     |  7 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java | 50 ++-----------
 .../ratis/server/impl/LeaderElectionTests.java     | 84 ++++++++++++++++++++++
 .../TestLeaderElectionWithSimulatedRpc.java        | 25 +++++++
 13 files changed, 267 insertions(+), 114 deletions(-)

commit abc1538fb0ba6ae9d761ea7189d9ba9b723444d4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 28 19:04:22 2017 +0800

    Revert "RATIS-168. Update Grpc and netty versions in Ratis.  Contributed by Mukul Kumar Singh"
    
    This reverts commit fac475dbb2b70efbde9b0ec0be60231e2e17bfe6.

 BUILDING.md                |  8 ------
 pom.xml                    |  2 +-
 ratis-proto-shaded/pom.xml | 72 ++--------------------------------------------
 3 files changed, 4 insertions(+), 78 deletions(-)

commit fac475dbb2b70efbde9b0ec0be60231e2e17bfe6
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 28 15:19:32 2017 +0800

    RATIS-168. Update Grpc and netty versions in Ratis.  Contributed by Mukul Kumar Singh

 BUILDING.md                |  8 ++++++
 pom.xml                    |  2 +-
 ratis-proto-shaded/pom.xml | 72 ++++++++++++++++++++++++++++++++++++++++++++--
 3 files changed, 78 insertions(+), 4 deletions(-)

commit 7872f32962b5fdb5229be6bfc36eb73ec01ff79f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 28 14:44:04 2017 +0800

    RATIS-140. Raft client should reuse the gRPC stream for all async calls.

 .../apache/ratis/client/RaftClientConfigKeys.java  |   2 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java |   6 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |  96 +++--
 .../java/org/apache/ratis/util/SlidingWindow.java  | 403 +++++++++++++++++++++
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |   9 +-
 .../grpc/client/RaftClientProtocolClient.java      |  96 ++++-
 .../grpc/client/RaftClientProtocolService.java     | 137 ++++---
 .../test/java/org/apache/ratis/RaftAsyncTests.java |   3 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |   5 -
 9 files changed, 648 insertions(+), 109 deletions(-)

commit f7f97e0506447f5d9f6be100e91017871af9762b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Dec 23 01:01:38 2017 +0800

    RATIS-175. RaftServerProxy should close server rpc in case instance creation fails.  Contributed by Lokesh Jain

 .../apache/ratis/grpc/TestRaftServerWithGrpc.java  | 56 ++++++++++++++++++++++
 .../apache/ratis/server/impl/RaftServerProxy.java  | 12 ++++-
 .../ratis/server/impl/RaftServerTestUtil.java      | 12 ++++-
 3 files changed, 78 insertions(+), 2 deletions(-)

commit 83e5d99e509835318d7d794d5bab83e37670e088
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Dec 22 12:19:12 2017 +0800

    RATIS-174. Create binary package for the release.  Contributed by Elek, Marton

 ratis-assembly/pom.xml                      | 10 +++-
 ratis-assembly/src/main/assembly/bin.xml    | 79 +++++++++++++++++++++++++++++
 ratis-assembly/src/main/assembly/src.xml    |  3 +-
 ratis-assembly/src/main/resources/README.md | 30 +++++++++++
 ratis-examples/src/main/bin/client.sh       |  0
 ratis-examples/src/main/bin/common.sh       | 16 ++++--
 ratis-examples/src/main/bin/server.sh       |  0
 ratis-examples/src/main/bin/start-all.sh    |  0
 8 files changed, 131 insertions(+), 7 deletions(-)

commit ce3afb08fd3a5f00a46347ab4be3e7fc6958448f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Dec 18 18:58:20 2017 +0800

    RATIS-171. The FileStore tests fail with NullPointerException.  Contributed by Kit Hui

 .../src/main/java/org/apache/ratis/server/storage/RaftLogWorker.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 99e409b66bb28d1a93a1382014e70bd5e2d6af0e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Dec 18 10:08:56 2017 +0800

    RATIS-154. Add setter functions for Raft Config keys.  Contributed by Shashikant Banerjee

 .../main/java/org/apache/ratis/conf/ConfUtils.java |  7 ++++++
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java | 16 +++++++++++-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 29 +++++++++++++++++++---
 3 files changed, 47 insertions(+), 5 deletions(-)

commit c97136fc1d1e99150dcea240c6862d4c8796d17e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Dec 18 10:01:16 2017 +0800

    RATIS-173. Release build is failing because of javadoc warnings.  Contributed by Elek, Marton

 pom.xml | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit b9e9e18dd94a2c9b3d1308c553a3e3022b2d5fd1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Dec 18 09:57:10 2017 +0800

    RATIS-172. TestBatchAppend fails with timeout.  Contributed by Mukul Kumar Singh

 ratis-examples/src/test/java/org/apache/ratis/TestBatchAppend.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2b8467ea9e06a972be87b0da95768755c5864773
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Dec 12 18:31:48 2017 +0800

    RATIS-161. gRPC Log appender should check if the appended request size is less than max message size of the server.  Contributed by Mukul Kumar Singh

 .../org/apache/ratis/grpc/RaftGRpcService.java     | 17 ++++++++--
 .../org/apache/ratis/server/impl/LogAppender.java  | 37 +++++++++++++---------
 2 files changed, 36 insertions(+), 18 deletions(-)

commit c1b23fdb0bfe5d3e9937d60f0baa43772737f002
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Dec 12 18:07:25 2017 +0800

    RATIS-124. RaftLog should be sync'ed on all the entries appended but not the last entry. Contributed by Kit Hui

 .../apache/ratis/server/impl/RaftServerImpl.java   | 15 +++---
 .../apache/ratis/server/storage/MemoryRaftLog.java | 33 +++++++------
 .../org/apache/ratis/server/storage/RaftLog.java   | 17 +++----
 .../apache/ratis/server/storage/RaftLogWorker.java | 23 ++++-----
 .../ratis/server/storage/SegmentedRaftLog.java     | 55 +++++++++++-----------
 .../apache/ratis/statemachine/StateMachine.java    |  3 +-
 .../ratis/server/storage/TestCacheEviction.java    |  7 ++-
 .../ratis/server/storage/TestSegmentedRaftLog.java | 20 ++++----
 8 files changed, 81 insertions(+), 92 deletions(-)

commit 9a8daa1d5cdceb4e58d56dbca435e361c19dc107
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 6 11:01:49 2017 +0800

    RATIS-166. Remove the use of sun.misc.Unsafe. Contributed by Kit Hui

 .../org/apache/ratis/io/nativeio/NativeIO.java     | 50 +---------------------
 1 file changed, 2 insertions(+), 48 deletions(-)

commit c29ba46c85026003401ab9e02f44077acb21771a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 6 10:56:47 2017 +0800

    RATIS-165. Change ClientProtoUtils from "class" to "interface" and remove "public".  Contributed by Kit Hui

 .../apache/ratis/client/impl/ClientProtoUtils.java | 48 +++++++++++-----------
 1 file changed, 24 insertions(+), 24 deletions(-)

commit 1028c19e2c5a6ce8e6009a7e2b29bcb3db0e9c81
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Dec 5 15:18:07 2017 +0800

    RATIS-164. Remove public from ProtoUtils.  Contributed by Kit Hui

 .../java/org/apache/ratis/util/ProtoUtils.java     | 38 +++++++++++-----------
 1 file changed, 19 insertions(+), 19 deletions(-)

commit 8f0a3ed50aa7a347558551ab5ce3a8bc2e8e92a0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Dec 5 08:55:56 2017 +0800

    RATIS-162. Clean up reply exception handling code for RATIS-140.

 .../java/org/apache/ratis/client/RaftClient.java   |  8 +--
 .../org/apache/ratis/client/RaftClientRpc.java     |  2 +-
 .../apache/ratis/client/impl/ClientImplUtils.java  |  5 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java |  9 +--
 .../apache/ratis/client/impl/RaftClientImpl.java   | 79 +++++++++++++---------
 .../ratis/client/impl/RaftClientRpcWithProxy.java  |  4 +-
 .../ratis/protocol/LeaderNotReadyException.java    |  4 +-
 .../org/apache/ratis/protocol/RaftClientReply.java | 40 +++++------
 .../java/org/apache/ratis/protocol/RaftId.java     |  5 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java | 32 +++++++++
 .../main/java/org/apache/ratis/util/LogUtils.java  | 10 ++-
 .../apache/ratis/util/UncheckedAutoCloseable.java  | 27 ++++++++
 .../ratis/examples/filestore/FileStoreClient.java  |  6 +-
 .../TestRaftStateMachineException.java             |  5 +-
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   | 12 +---
 .../apache/ratis/grpc/client/AppendStreamer.java   |  7 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 45 ++++++------
 .../grpc/client/RaftClientProtocolClient.java      | 22 ++++--
 .../ratis/grpc/client/RaftClientProtocolProxy.java |  6 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  3 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  6 +-
 .../org/apache/ratis/server/impl/RetryCache.java   |  6 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  2 +-
 .../org/apache/ratis/server/impl/ServerState.java  | 21 +++---
 .../java/org/apache/ratis/MiniRaftCluster.java     |  9 +++
 .../org/apache/ratis/RaftExceptionBaseTest.java    | 13 ++--
 .../server/impl/RaftReconfigurationBaseTest.java   |  2 +-
 .../server/simulation/SimulatedClientRpc.java      |  2 +-
 28 files changed, 242 insertions(+), 150 deletions(-)

commit 1a74e13ea8eb614cdd62f3d87d4926717ca4be92
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Dec 4 06:25:18 2017 +0800

    RATIS-163. TestRaftWithHadoopRpc fails becuse hadoop rpc retry logic.  Contributed by Elek, Marton.

 .../ratis/hadooprpc/TestRaftExceptionWithHadoopRpc.java | 17 +++++++++++++++++
 .../apache/ratis/hadooprpc/TestRaftWithHadoopRpc.java   |  1 +
 2 files changed, 18 insertions(+)

commit 874e48b78f97533bc6898946dbb1aca10235abd9
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 29 12:11:58 2017 -0800

    RATIS-146. Maven install should install Proto files as well. Contributed by Mukul Kumar Singh

 ratis-proto-shaded/pom.xml | 7 -------
 1 file changed, 7 deletions(-)

commit 1f07109d71c683455af484e16d3966b18d415c45
Author: Chen Liang <cliang@apache.org>
Date:   Tue Nov 28 15:17:32 2017 -0800

    RATIS-141. In RaftClientProtocolService, the assumption of consecutive callId is invalid. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/ClientProtoUtils.java | 42 +++++++++++++++----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 10 ++++-
 .../apache/ratis/protocol/RaftClientRequest.java   | 18 +++++++--
 .../java/org/apache/ratis/util/StringUtils.java    | 16 ++++++++
 .../ratis/examples/ParameterizedBaseTest.java      |  8 +++-
 .../TestRaftStateMachineException.java             |  6 ++-
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   | 11 ++++-
 .../apache/ratis/grpc/client/AppendStreamer.java   | 29 +++++++------
 .../grpc/client/RaftClientProtocolService.java     | 47 ++++++++++++----------
 .../java/org/apache/ratis/grpc/TestRaftStream.java | 33 ++++++++-------
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  5 ---
 ratis-proto-shaded/src/main/proto/Raft.proto       | 13 +++---
 .../apache/ratis/server/impl/PendingRequests.java  |  2 +-
 .../ratis/server/impl/RaftServerConstants.java     |  1 +
 .../apache/ratis/server/impl/ServerProtoUtils.java |  3 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 32 +++++++++++----
 .../test/java/org/apache/ratis/RaftBasicTests.java | 13 +++---
 .../java/org/apache/ratis/RetryCacheTests.java     | 10 +++--
 19 files changed, 203 insertions(+), 100 deletions(-)

commit 5de0fa6473bc186926840154e7cf534b3f9839b1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Nov 25 20:37:11 2017 -0800

    RATIS-156. Implement configuration for client async requests.  Contributed by Lokesh Jain

 .../java/org/apache/ratis/client/RaftClient.java   |  2 +-
 .../apache/ratis/client/RaftClientConfigKeys.java  | 28 ++++++++++++
 .../org/apache/ratis/client/RaftClientRpc.java     | 12 +----
 .../apache/ratis/client/impl/ClientImplUtils.java  |  9 ++--
 .../apache/ratis/client/impl/RaftClientImpl.java   | 18 +++++---
 .../ratis/client/impl/RaftClientTestUtil.java      |  4 ++
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 52 +++++++++++++---------
 .../simulation/TestRaftAsyncWithSimulatedRpc.java  | 24 ----------
 .../simulation/TestRaftWithSimulatedRpc.java       |  5 ---
 9 files changed, 84 insertions(+), 70 deletions(-)

commit c804236529b889a85d8c0aed4f4358a1c46dbbfa
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 24 16:27:46 2017 -0800

    RATIS-145. (git)ignore dependency-reduced-pom.xml.  Contributed by Elek, Marton.

 .gitignore             |  1 +
 ratis-examples/pom.xml | 64 +++++++++++++++++++++++++++++++++++++++++++++++++-
 2 files changed, 64 insertions(+), 1 deletion(-)

commit f574e576c7098d563eea279596920178f7f5c288
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 24 16:24:41 2017 -0800

    RATIS-155. TestSegmentedRaftLog and TestCacheEviction may fail due to NullPointerException.  Contributed by Jitendra Nath Pandey

 .../main/java/org/apache/ratis/server/storage/RaftLogWorker.java    | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 79c880d9326850e970d6c07ccfd9f3128d17a7e2
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Fri Nov 24 10:53:21 2017 -0800

    RATIS-144. Build all the modules during the precommit yetus builds. Contributed by Marton Elek.

 dev-support/yetus-personality.sh | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit a7b29658ff7c656cb566680fa3c9cc10da5f1d0a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 23 17:07:28 2017 -0800

    RATIS-143. RaftClientImpl should have upper bound on async requests.  Contributed by Lokesh Jain

 .../apache/ratis/client/impl/RaftClientImpl.java   |  23 +++-
 .../ratis/client/impl/RaftClientTestUtil.java      |  28 +++++
 .../apache/ratis/grpc/TestRaftAsyncWithGrpc.java   |  24 +++++
 .../org/apache/ratis/server/impl/RetryCache.java   |   6 +-
 .../test/java/org/apache/ratis/RaftAsyncTests.java | 119 +++++++++++++++++++++
 .../simulation/TestRaftAsyncWithSimulatedRpc.java  |  24 +++++
 .../statemachine/SimpleStateMachine4Testing.java   |  22 ++++
 7 files changed, 240 insertions(+), 6 deletions(-)

commit 2fb731f916c9888b6d7dcc348eee05a5887a316e
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Tue Nov 21 17:18:56 2017 -0800

    RATIS-148. Add metric for log flush latency. Contributed by jitendra.

 ratis-common/pom.xml                               |   7 ++
 .../apache/ratis/metrics/RatisMetricsRegistry.java |  35 +++++++
 .../apache/ratis/server/storage/RaftLogWorker.java |  15 ++-
 .../apache/ratis/server/TestRaftLogMetrics.java    | 106 +++++++++++++++++++++
 4 files changed, 162 insertions(+), 1 deletion(-)

commit 77ffa18baba92bcea22e83533628fdf1020f68e1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Nov 20 17:20:14 2017 -0800

    RATIS-151. Refactor ratis-server tests to reduce the use DEFAULT_CALLID.

 .../src/test/java/org/apache/ratis/BaseTest.java   | 10 +++--
 .../ratis/examples/ParameterizedBaseTest.java      | 10 +++--
 .../ratis/examples/arithmetic/TestArithmetic.java  |  1 -
 .../examples/filestore/FileStoreBaseTest.java      |  2 +-
 .../TestRaftStateMachineException.java             | 48 +++++++---------------
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  |  4 +-
 .../hadooprpc/TestRetryCacheWithHadoopRpc.java     |  4 +-
 .../ratis/netty/TestRetryCacheWithNettyRpc.java    |  4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 44 ++++++++++++++++++--
 .../org/apache/ratis/RaftExceptionBaseTest.java    | 20 ++++-----
 ...ftRetryCacheTests.java => RetryCacheTests.java} | 25 +++++------
 .../server/impl/RaftReconfigurationBaseTest.java   | 32 +++++----------
 .../simulation/TestRetryCacheWithSimulatedRpc.java |  4 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  9 +---
 14 files changed, 107 insertions(+), 110 deletions(-)

commit 5d4bb423581bd6858411dd4037dcadee752155cc
Author: Márton Elek <elek@apache.org>
Date:   Tue Nov 21 23:46:38 2017 +0100

    RATIS-150. Fix hadoop tests in example. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                                            | 16 ++++++++-------
 ratis-examples/pom.xml                             |  4 ++++
 .../cli/{AssignTest.java => TestAssignCli.java}    | 23 ++++++++++++----------
 3 files changed, 26 insertions(+), 17 deletions(-)

commit 543ee0eb8db6eac663274be8d3c0a9dd054e65cf
Author: Chen Liang <cliang@apache.org>
Date:   Mon Nov 20 13:53:43 2017 -0800

    RATIS-147. Add a script to run a single test repeatedly. Contributed by Tsz Wo Nicholas Sze.

 dev-support/run-test-repeatedly.sh | 43 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)

commit dfeb671f04dc5fd091011476861c67cc8972d42d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 17 13:51:19 2017 -0800

    RATIS-95. Executable Jar for the ratis example.  Contributed by Elek, Marton

 pom.xml                                            |   6 ++
 ratis-examples/pom.xml                             |  42 ++++++---
 ratis-examples/src/main/bin/client.sh              |  23 +++++
 ratis-examples/src/main/bin/common.sh              |  23 +++++
 ratis-examples/src/main/bin/server.sh              |  24 +++++
 ratis-examples/src/main/bin/start-all.sh           |  23 +++++
 .../apache/ratis/examples/arithmetic/Runner.java   |  79 ++++++++++++++++
 .../ratis/examples/arithmetic/cli/Assign.java      | 104 +++++++++++++++++++++
 .../ratis/examples/arithmetic/cli/Client.java      |  56 +++++++++++
 .../apache/ratis/examples/arithmetic/cli/Get.java  |  49 ++++++++++
 .../ratis/examples/arithmetic/cli/Server.java      |  88 +++++++++++++++++
 .../examples/arithmetic/cli/SubCommandBase.java    |  53 +++++++++++
 .../arithmetic/expression/BinaryExpression.java    |  20 ++++
 .../arithmetic/expression/DoubleValue.java         |  14 +++
 .../arithmetic/expression/UnaryExpression.java     |  19 ++++
 .../ratis/examples/arithmetic/cli/AssignTest.java  |  53 +++++++++++
 16 files changed, 664 insertions(+), 12 deletions(-)

commit e914e7afac36a40663b58b6d33e77900e9d1ec1b
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Nov 17 12:19:10 2017 -0800

    RATIS-142. Test ArithmeticStateMachine with the Gauss–Legendre algorithm. Contributed by Tsz Wo Nicholas Sze.

 .../arithmetic/ArithmeticStateMachine.java         |   5 +-
 .../arithmetic/expression/BinaryExpression.java    |  20 ++-
 .../arithmetic/expression/DoubleValue.java         |   3 +-
 .../arithmetic/expression/UnaryExpression.java     |  33 ++++-
 .../examples/arithmetic/expression/Variable.java   |   8 ++
 .../java/org/apache/ratis/TestBatchAppend.java     |   4 +-
 .../java/org/apache/ratis/TestMultiRaftGroup.java  |   4 +-
 .../java/org/apache/ratis/TestRestartRaftPeer.java |   4 +-
 ...lesTestUtil.java => ParameterizedBaseTest.java} |  34 ++++-
 .../ratis/examples/arithmetic/TestArithmetic.java  | 144 ++++++++++++++-------
 .../TestRaftStateMachineException.java             |   4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   7 +-
 12 files changed, 209 insertions(+), 61 deletions(-)

commit 830569ed20e8d00dcaf2f857a2bda2c993cc5f44
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 15 13:28:36 2017 -0800

    RATIS-134. PeerProxyMap#addPeers should add peers only if it is not already present in the proxymap.  Contributed by Mukul Kumar Singh

 .../src/main/java/org/apache/ratis/util/PeerProxyMap.java         | 8 ++++----
 .../main/java/org/apache/ratis/grpc/client/AppendStreamer.java    | 2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 86e744c1f1d50a2b3530dfe568def4eb33aa6e05
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 14 13:28:21 2017 -0800

    RATIS-113. Add Async send interface to RaftClient. Contributed by Lokesh Jain

 .../java/org/apache/ratis/client/RaftClient.java   | 11 +++
 .../org/apache/ratis/client/RaftClientRpc.java     | 20 ++++-
 .../apache/ratis/client/impl/ClientImplUtils.java  |  3 -
 .../apache/ratis/client/impl/RaftClientImpl.java   | 65 +++++++++++++++-
 .../org/apache/ratis/protocol/RaftClientReply.java |  8 ++
 .../apache/ratis/grpc/client/GrpcClientRpc.java    | 91 ++++++++++++++--------
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  5 ++
 .../test/java/org/apache/ratis/RaftBasicTests.java | 32 +++++++-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 11 ++-
 .../simulation/TestRaftWithSimulatedRpc.java       |  6 ++
 10 files changed, 204 insertions(+), 48 deletions(-)

commit 564e89ee4285e5dc2c8b7fa48a66f63a692a4cce
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Nov 11 14:18:49 2017 -0800

    RATIS-133. Raft gRPC client should check proto size before sending a message.  Contributed by Mukul Kumar Singh

 .../main/java/org/apache/ratis/client/ClientFactory.java   |  3 ++-
 .../src/main/java/org/apache/ratis/client/RaftClient.java  |  2 +-
 .../main/java/org/apache/ratis/grpc/GrpcConfigKeys.java    | 14 +++++++-------
 .../src/main/java/org/apache/ratis/grpc/GrpcFactory.java   |  5 +++--
 .../main/java/org/apache/ratis/grpc/RaftGRpcService.java   |  2 +-
 .../java/org/apache/ratis/grpc/client/AppendStreamer.java  |  6 ++++++
 .../java/org/apache/ratis/grpc/client/GrpcClientRpc.java   | 10 +++++++++-
 .../java/org/apache/ratis/hadooprpc/HadoopFactory.java     |  3 ++-
 .../src/main/java/org/apache/ratis/netty/NettyFactory.java |  3 ++-
 .../org/apache/ratis/server/simulation/SimulatedRpc.java   |  3 ++-
 10 files changed, 35 insertions(+), 16 deletions(-)

commit 7f17943166b7c57ad0202aa796cf2a9271695a90
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Nov 11 14:17:37 2017 -0800

    RATIS-137. RaftBasicTests.testBasicAppendEntries may fail.  Contributed by Lokesh Jain

 .../test/java/org/apache/ratis/RaftBasicTests.java | 12 +++----
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 42 ++++++++++++++++------
 2 files changed, 35 insertions(+), 19 deletions(-)

commit 7919c20d63fb85d7e96184bd6eb1a0c9ff2dac2a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Nov 11 14:17:05 2017 -0800

    Revert "RATIS-137. RaftBasicTests.testBasicAppendEntries may fail."
    
    This reverts commit daee0b3615d4e583c3b0db4edfb00ebc8811b0ae.

 .../test/java/org/apache/ratis/RaftBasicTests.java | 12 ++++---
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 42 ++++++----------------
 2 files changed, 19 insertions(+), 35 deletions(-)

commit daee0b3615d4e583c3b0db4edfb00ebc8811b0ae
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Nov 11 13:46:34 2017 -0800

    RATIS-137. RaftBasicTests.testBasicAppendEntries may fail.

 .../test/java/org/apache/ratis/RaftBasicTests.java | 12 +++----
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 42 ++++++++++++++++------
 2 files changed, 35 insertions(+), 19 deletions(-)

commit 42273af454d368293e467518431c16f7c3c248aa
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Nov 9 13:15:26 2017 -0800

    RATIS-117. Add test for situation when old leader can/cannot commit log. Contributed by Yubo Xu.

 .../ratis/server/storage/LogOutputStream.java      | 25 ++++--
 .../test/java/org/apache/ratis/RaftBasicTests.java | 94 +++++++++++++++++++++-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 39 ++++++++-
 3 files changed, 147 insertions(+), 11 deletions(-)

commit b7d089a1ab279bcc5c8832131305134bbcb967d2
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 8 16:25:50 2017 -0800

    RATIS-135. Closed segments contribute to leaked memory as eviction policies are not honoured. Contributed by Mukul Kumar Singh

 .../src/main/java/org/apache/ratis/server/storage/SegmentedRaftLog.java  | 1 +
 1 file changed, 1 insertion(+)

commit 8a40ee4bccc23c37027829a9cc17838200650a0d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 8 10:44:52 2017 -0800

    RATIS-122. Add a FileStore example.

 .../apache/ratis/client/impl/ClientProtoUtils.java |   4 +-
 .../org/apache/ratis/util/CollectionUtils.java     |  13 +
 .../main/java/org/apache/ratis/util/FileUtils.java |   9 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java |   6 +
 .../main/java/org/apache/ratis/util/LogUtils.java  |  73 +++++-
 .../java/org/apache/ratis/util/ProtoUtils.java     |  30 ++-
 .../org/apache/ratis/util/ReflectionUtils.java     |   3 +-
 .../java/org/apache/ratis/util/StringUtils.java    |  23 +-
 .../main/java/org/apache/ratis/util/TaskQueue.java | 125 ++++++++++
 .../src/test/java/org/apache/ratis/BaseTest.java   |   2 +-
 .../apache/ratis/examples/filestore/FileInfo.java  | 266 +++++++++++++++++++++
 .../apache/ratis/examples/filestore/FileStore.java | 212 ++++++++++++++++
 .../ratis/examples/filestore/FileStoreClient.java  | 122 ++++++++++
 .../ratis/examples/filestore/FileStoreCommon.java  |  56 +++++
 .../examples/filestore/FileStoreStateMachine.java  | 186 ++++++++++++++
 .../examples/filestore/FileStoreBaseTest.java      | 201 ++++++++++++++++
 .../examples/filestore/TestFileStoreWithGrpc.java  |  25 ++
 .../examples/filestore/TestFileStoreWithNetty.java |  25 ++
 .../apache/ratis/netty/server/NettyRpcService.java |   6 +-
 ratis-proto-shaded/src/main/proto/Examples.proto   |  67 ++++++
 ratis-proto-shaded/src/main/proto/Raft.proto       |   2 +
 .../apache/ratis/server/impl/RaftServerImpl.java   |   2 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |  37 ++-
 .../ratis/statemachine/BaseStateMachine.java       |   6 +
 .../apache/ratis/statemachine/StateMachine.java    |  13 +
 .../ratis/statemachine/TransactionContext.java     |  11 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  27 ++-
 .../org/apache/ratis/RaftExceptionBaseTest.java    |   2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  15 +-
 .../server/impl/ServerInformationBaseTest.java     |   9 +-
 30 files changed, 1531 insertions(+), 47 deletions(-)

commit 830bd615dbcaa1db7c47b6f65bc68adbffc91289
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 8 14:32:07 2017 -0800

    Revert "RATIS-129. Compile protobuf and shade if the shaded source directory is missing."
    
    This reverts commit 6d0d114ff4a8709dd568b5227dbc6c78cbcd8d1f.

 BUILDING.md                 | 7 +++++--
 ratis-hadoop-shaded/pom.xml | 6 +++---
 ratis-proto-shaded/pom.xml  | 6 +++---
 3 files changed, 11 insertions(+), 8 deletions(-)

commit 22b70e9c4f7d1fc3895d38cde66c5e6fa1654d7e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 7 18:08:42 2017 -0800

    RATIS-136. Reduce log level for segment rollover.  Contributed by Mukul Kumar Singh

 .../apache/ratis/server/impl/FollowerState.java    |  5 ++--
 .../ratis/server/storage/LogOutputStream.java      |  8 +++---
 .../apache/ratis/server/storage/RaftLogWorker.java | 23 +++++++++++----
 .../ratis/server/storage/TestRaftLogReadWrite.java | 33 ++++++++++++++--------
 .../ratis/server/storage/TestRaftLogSegment.java   | 31 ++++++++++----------
 .../ratis/server/storage/TestSegmentedRaftLog.java | 12 +++++++-
 .../statemachine/SimpleStateMachine4Testing.java   | 10 ++++++-
 7 files changed, 82 insertions(+), 40 deletions(-)

commit 30cc776701561112d3761c4dcd143424897c4129
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 7 17:50:35 2017 -0800

    RATIS-132. Support simple 'mvn clean compile' command (move shading before the compile phase).  Contributed by Elek, Marton

 BUILDING.md                 | 14 +++++++-------
 ratis-hadoop-shaded/pom.xml |  9 ++++++---
 ratis-proto-shaded/pom.xml  | 40 +++++++++++++++++++++++++++++++++-------
 3 files changed, 46 insertions(+), 17 deletions(-)

commit 6d0d114ff4a8709dd568b5227dbc6c78cbcd8d1f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 3 16:54:28 2017 -0700

    RATIS-129. Compile protobuf and shade if the shaded source directory is missing.

 BUILDING.md                 | 7 ++-----
 ratis-hadoop-shaded/pom.xml | 6 +++---
 ratis-proto-shaded/pom.xml  | 6 +++---
 3 files changed, 8 insertions(+), 11 deletions(-)

commit 091d2fcb9db72f9f8531e2b2bc73927cd043c79f
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Nov 3 14:54:22 2017 -0700

    RATIS-128. Fix missing maven plugin version for protobuf and shade plugins. Contributed by Tsz Wo Nicholas Sze.

 pom.xml | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 9591cbca0bea7d42ddb54e493f3c3445788baa31
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 2 14:44:04 2017 -0700

    RATIS-102. Clean generated sources as part of the default clean lifecycle.  Contributed by Elek, Marton.

 BUILDING.md                 | 14 +++++------
 ratis-hadoop-shaded/pom.xml | 57 +++++++++++++++++++++++----------------------
 ratis-proto-shaded/pom.xml  | 57 +++++++++++++++++++++++----------------------
 3 files changed, 65 insertions(+), 63 deletions(-)

commit 630ad7f4d0ca83e729c33d4a4c8f4a3682280a9b
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Thu Nov 2 14:42:41 2017 -0700

    RATIS-4. Setup jenkins. Contributed by Marton Elek.

 .gitignore                        |   1 +
 dev-support/ci/README.md          |  40 +++++++++
 dev-support/ci/common.sh          |  37 ++++++++
 dev-support/ci/nightly-build.sh   |  47 ++++++++++
 dev-support/ci/precommit-build.sh |  49 +++++++++++
 dev-support/docker/Dockerfile     |  90 +++++++++++++++++++
 dev-support/test-patch            |  18 ++++
 dev-support/yetus-personality.sh  |  32 +++++++
 dev-support/yetus-wrapper         | 177 ++++++++++++++++++++++++++++++++++++++
 start-build-env.sh                |  55 ++++++++++++
 10 files changed, 546 insertions(+)

commit 7edcd52b0c90a2af9b9e25e84f71adf0d2c42506
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Oct 24 13:12:33 2017 -0700

    RATIS-121. In RaftServer.Builder, allow serverId and group to be initialized automatically.

 .../java/org/apache/ratis/protocol/RaftGroup.java  |  6 ++
 .../org/apache/ratis/protocol/RaftGroupId.java     |  5 ++
 .../src/test/java/org/apache/ratis/BaseTest.java   |  6 +-
 .../arithmetic/expression/TestExpression.java      |  4 +-
 .../org/apache/ratis/grpc/RaftGRpcService.java     | 17 +++--
 .../grpc/client/RaftClientProtocolService.java     | 15 +++--
 .../ratis/grpc/server/AdminProtocolService.java    |  7 +-
 .../grpc/server/RaftServerProtocolService.java     | 33 +++++-----
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 27 +++-----
 .../apache/ratis/netty/server/NettyRpcService.java | 45 +++++--------
 .../java/org/apache/ratis/server/RaftServer.java   |  6 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  | 19 +++---
 .../ratis/server/impl/RaftServerRpcWithProxy.java  | 76 ++++++++++++++++++++++
 .../apache/ratis/server/impl/ServerImplUtils.java  | 10 ++-
 .../java/org/apache/ratis/protocol/TestRaftId.java |  4 +-
 .../ratis/server/simulation/RequestHandler.java    | 17 +++--
 .../server/simulation/SimulatedServerRpc.java      | 10 +--
 17 files changed, 197 insertions(+), 110 deletions(-)

commit 2a781c220e0b9fe564cfa130b18fb952ece90a1e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Oct 19 16:03:35 2017 -0700

    RATIS-119. RaftServerImpl.registerMBean may throw MalformedObjectNameException.

 .../java/org/apache/ratis/util/JmxRegister.java    |  77 +++++++++++++++
 .../org/apache/ratis/server/RaftServerMXBean.java  |   2 -
 .../apache/ratis/server/impl/RaftServerImpl.java   |  37 +++----
 .../org/apache/ratis/server/TestRaftServerJmx.java |  92 -----------------
 .../ratis/server/impl/TestRaftServerJmx.java       | 109 +++++++++++++++++++++
 5 files changed, 205 insertions(+), 112 deletions(-)

commit 55764cc24c5dc5a35df29a8c23fcdf787c1bb8a3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Oct 13 15:38:12 2017 -0700

    RATIS-120. In RaftClient.Builder, allow clientRpc to be initialized automatically.

 .../main/java/org/apache/ratis/client/ClientFactory.java |  3 ++-
 .../main/java/org/apache/ratis/client/RaftClient.java    | 16 ++++++++++++++++
 .../main/java/org/apache/ratis/client/RaftClientRpc.java |  3 ---
 .../apache/ratis/client/impl/RaftClientRpcWithProxy.java |  5 -----
 .../main/java/org/apache/ratis/util/PeerProxyMap.java    | 12 +++++-------
 .../src/main/java/org/apache/ratis/grpc/GrpcFactory.java |  5 +++--
 .../org/apache/ratis/grpc/client/AppendStreamer.java     |  3 +--
 .../java/org/apache/ratis/grpc/client/GrpcClientRpc.java |  4 ++--
 .../java/org/apache/ratis/hadooprpc/HadoopFactory.java   |  5 +++--
 .../apache/ratis/hadooprpc/client/HadoopClientRpc.java   |  4 ++--
 .../apache/ratis/hadooprpc/server/HadoopRpcService.java  |  3 +--
 .../main/java/org/apache/ratis/netty/NettyFactory.java   |  5 +++--
 .../main/java/org/apache/ratis/netty/NettyRpcProxy.java  |  4 ++++
 .../org/apache/ratis/netty/client/NettyClientRpc.java    |  4 ++--
 .../org/apache/ratis/netty/server/NettyRpcService.java   |  4 ++--
 .../src/test/java/org/apache/ratis/MiniRaftCluster.java  | 15 ++-------------
 .../ratis/server/simulation/SimulatedClientRpc.java      |  5 -----
 .../org/apache/ratis/server/simulation/SimulatedRpc.java |  3 ++-
 18 files changed, 50 insertions(+), 53 deletions(-)

commit 96c470d884423f0997ac06073b53a541be856d11
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Oct 11 11:05:31 2017 +0800

    RATIS-116. In PendingRequests, the requests are never removed from the map.

 .../java/org/apache/ratis/client/RaftClient.java   |  2 +-
 .../apache/ratis/server/impl/PendingRequest.java   | 10 ++--
 .../apache/ratis/server/impl/PendingRequests.java  | 57 +++++++++++++++++-----
 3 files changed, 51 insertions(+), 18 deletions(-)

commit 7a5c3ea12a84a99bd78bd22e869e5b2a938693e7
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Sep 28 16:00:06 2017 +0800

    RATIS-118. Add missing license headers for the ServerInformation feature.

 .../apache/ratis/protocol/ServerInformationReply.java   | 17 +++++++++++++++++
 .../apache/ratis/protocol/ServerInformatonRequest.java  | 17 +++++++++++++++++
 ratis-hadoop-shaded/pom.xml                             | 17 +++++++++++++++++
 .../hadooprpc/TestServerInformationWithHadoopRpc.java   | 17 +++++++++++++++++
 .../ratis/netty/TestServerInformationWithNetty.java     | 17 +++++++++++++++++
 5 files changed, 85 insertions(+)

commit be4c414e05d39c34148782a8860df2695170dc19
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Sep 28 11:28:11 2017 +0800

    RATIS-115. RaftLogWorker still may throw IllegalStateException.

 .../main/java/org/apache/ratis/util/ExitUtils.java |  6 ++
 .../apache/ratis/server/impl/ServerProtoUtils.java |  5 +-
 .../apache/ratis/server/storage/LogSegment.java    | 21 ++++--
 .../apache/ratis/server/storage/RaftLogCache.java  | 81 +++++++++++++---------
 .../apache/ratis/server/storage/RaftLogWorker.java | 19 ++++-
 .../ratis/server/storage/SegmentedRaftLog.java     | 19 +++--
 .../java/org/apache/ratis/MiniRaftCluster.java     |  6 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java | 17 ++++-
 .../ratis/server/storage/RaftStorageTestUtils.java |  6 ++
 .../ratis/server/storage/TestRaftLogCache.java     |  2 +-
 10 files changed, 132 insertions(+), 50 deletions(-)

commit a783abd0d253d2082c5db6ed8ef485486ebb3c7a
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Sep 15 11:58:21 2017 -0700

    RATIS-114. TestRaftWithHadoopRpc.testWithLoad may timeout. Contributed by Tsz Wo Nicholas Sze.

 .../org/apache/ratis/client/RaftClientRpc.java     |   7 ++
 .../apache/ratis/client/impl/RaftClientImpl.java   |   6 +-
 .../ratis/client/impl/RaftClientRpcWithProxy.java  |  68 +++++++++++
 .../apache/ratis/protocol/RaftClientMessage.java   |   2 +-
 .../apache/ratis/protocol/RaftClientRequest.java   |   2 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java |   9 ++
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  13 ++-
 .../java/org/apache/ratis/TestMultiRaftGroup.java  |   2 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   |   1 +
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  22 +---
 .../apache/ratis/hadooprpc/HadoopConfigKeys.java   |   4 +
 .../ratis/hadooprpc/client/HadoopClientRpc.java    |  23 +---
 .../ratis/hadooprpc/server/HadoopRpcService.java   |   3 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |   5 +
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |  12 +-
 .../java/org/apache/ratis/netty/NettyFactory.java  |   1 -
 .../apache/ratis/netty/client/NettyClientRpc.java  |  20 +---
 .../apache/ratis/netty/server/NettyRpcService.java |   2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   1 +
 .../apache/ratis/server/impl/RaftServerImpl.java   |   4 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |   1 +
 .../java/org/apache/ratis/MiniRaftCluster.java     |  15 ++-
 .../test/java/org/apache/ratis/RaftBasicTests.java | 125 ++++++++++++++++-----
 .../test/java/org/apache/ratis/RaftTestUtil.java   |   8 --
 .../server/impl/BlockRequestHandlingInjection.java |  29 +++--
 .../server/impl/DelayLocalExecutionInjection.java  |   5 +
 .../server/simulation/SimulatedClientRpc.java      |  11 ++
 27 files changed, 286 insertions(+), 115 deletions(-)

commit 298c1a2de173c0e2284fc08ef2f953a5fee86e2d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Sep 12 12:29:39 2017 +0800

    RATIS-104. Add an RPC to get server information. Contributed by Chen Liang

 .../java/org/apache/ratis/client/RaftClient.java   |   3 +
 .../apache/ratis/client/impl/ClientProtoUtils.java |  45 +++++++++
 .../apache/ratis/client/impl/RaftClientImpl.java   |   9 ++
 .../ratis/protocol/AdminAsynchronousProtocol.java  |   3 +
 .../org/apache/ratis/protocol/AdminProtocol.java   |   2 +
 .../java/org/apache/ratis/protocol/RaftGroup.java  |   7 +-
 .../ratis/protocol/ServerInformationReply.java     |  33 +++++++
 .../ratis/protocol/ServerInformatonRequest.java    |  12 +++
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   |  10 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |   7 ++
 .../grpc/client/RaftClientProtocolClient.java      |   7 ++
 .../grpc/client/RaftClientProtocolService.java     |   3 +-
 .../ratis/grpc/server/AdminProtocolService.java    |  14 ++-
 .../ratis/grpc/TestServerInformationWithGrpc.java  |  25 +++++
 ...mbinedClientProtocolClientSideTranslatorPB.java |  40 +++++---
 ...mbinedClientProtocolServerSideTranslatorPB.java |  16 ++++
 .../ratis/hadooprpc/client/HadoopClientRpc.java    |   2 +
 .../TestServerInformationWithHadoopRpc.java        |   8 ++
 .../apache/ratis/netty/client/NettyClientRpc.java  |  15 ++-
 .../apache/ratis/netty/server/NettyRpcService.java |  10 ++
 .../netty/TestServerInformationWithNetty.java      |   8 ++
 ratis-proto-shaded/src/main/proto/GRpc.proto       |   3 +
 ratis-proto-shaded/src/main/proto/Hadoop.proto     |   3 +
 ratis-proto-shaded/src/main/proto/Netty.proto      |   4 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  10 ++
 .../apache/ratis/server/impl/RaftServerImpl.java   |  10 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  27 ++++++
 .../server/impl/ServerInformationBaseTest.java     | 103 +++++++++++++++++++++
 .../server/simulation/SimulatedServerRpc.java      |   3 +
 .../TestServerInformationWithSimulatedRpc.java     |  25 +++++
 30 files changed, 441 insertions(+), 26 deletions(-)

commit 86383d689389bb3ccc9336f97bac1b66caa3f867
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Sep 7 14:17:30 2017 +0800

    RATIS-111. RaftLogWorker may throw IllegalStateException.

 .../apache/ratis/util/AtomicFileOutputStream.java  |  10 +-
 .../main/java/org/apache/ratis/util/FileUtils.java | 184 ++++++++-------------
 .../main/java/org/apache/ratis/util/JavaUtils.java |   2 +-
 .../main/java/org/apache/ratis/util/LogUtils.java  |  19 +++
 .../src/test/java/org/apache/ratis/BaseTest.java   |   2 +
 .../ratis/examples/arithmetic/TestArithmetic.java  |   2 +-
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |   2 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |   2 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |  48 +++---
 .../apache/ratis/server/storage/RaftStorage.java   |   3 +-
 .../ratis/server/storage/RaftStorageDirectory.java |  21 +--
 .../ratis/server/storage/SegmentedRaftLog.java     |   3 +-
 .../ratis/server/storage/SnapshotManager.java      |   4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  15 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java |   6 +-
 .../org/apache/ratis/RaftExceptionBaseTest.java    |   2 -
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  16 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java |   2 +-
 .../ratis/server/storage/TestRaftLogSegment.java   |   2 +-
 .../ratis/server/storage/TestRaftStorage.java      |   9 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   2 +-
 21 files changed, 162 insertions(+), 194 deletions(-)

commit 9ce1783d30726b940193e1926659fefdbe2a2cdb
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Sep 4 14:54:42 2017 -0700

    RATIS-105. Server should check group id for client requests. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/ClientProtoUtils.java |  4 +--
 .../apache/ratis/client/impl/RaftClientImpl.java   | 18 +++++++----
 .../apache/ratis/protocol/NotLeaderException.java  |  2 +-
 .../java/org/apache/ratis/protocol/RaftPeer.java   |  7 +++-
 .../ratis/protocol/StateMachineException.java      |  2 +-
 .../src/test/java/org/apache/ratis/BaseTest.java   | 19 +++++++++++
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  7 ++++
 ...ithGrpc.java => TestRaftExceptionWithGrpc.java} | 14 +++-----
 .../ratis/hadooprpc/client/HadoopClientRpc.java    |  3 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  7 ++++
 ...pc.java => TestRaftExceptionWithHadoopRpc.java} | 14 +++-----
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  7 ++++
 ...hNetty.java => TestRaftExceptionWithNetty.java} | 14 +++-----
 .../apache/ratis/server/impl/RaftServerImpl.java   | 29 +++++++----------
 .../apache/ratis/server/impl/RaftServerProxy.java  |  2 ++
 .../org/apache/ratis/server/impl/RetryCache.java   | 25 ++++++++++++++-
 .../org/apache/ratis/server/storage/RaftLog.java   |  2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 +++
 ...ionBaseTest.java => RaftExceptionBaseTest.java} | 37 +++++++++++++++++++---
 .../server/impl/ReinitializationBaseTest.java      |  4 +--
 .../MiniRaftClusterWithSimulatedRpc.java           |  7 ++++
 ...n.java => TestRaftExceptionWithSimulation.java} | 11 +++----
 22 files changed, 165 insertions(+), 74 deletions(-)

commit 4ed8f72716a931835a28dbd62ec5898a97d99450
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Sep 4 14:54:15 2017 -0700

    RATIS-100. Fix bugs for running multiple raft groups with a state machine. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/protocol/GroupMismatchException.java     | 28 ++++++++
 .../java/org/apache/ratis/TestMultiRaftGroup.java  | 76 ++++++++++++++++++++++
 .../apache/ratis/server/impl/PendingRequests.java  |  7 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 12 ++++
 .../ratis/server/impl/StateMachineUpdater.java     |  4 ++
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 ++
 .../test/java/org/apache/ratis/RaftBasicTests.java |  4 +-
 .../server/impl/ReinitializationBaseTest.java      | 36 ++++++----
 .../ratis/statemachine/TestStateMachine.java       |  2 +-
 9 files changed, 157 insertions(+), 16 deletions(-)

commit c2032801a21bbe518989af7796c3ab0e408d7ef0
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Sep 4 14:52:37 2017 -0700

    Revert "Ratis-105. Server should check group id for client requests. Contributed by Tsz Wo Nicholas Sze."
    
    This reverts commit 4dbe99bbd1c5fc7e2d9a6eba4d6df5726b68a9c8.

 .../ratis/protocol/GroupMismatchException.java     | 28 --------
 .../java/org/apache/ratis/TestMultiRaftGroup.java  | 76 ----------------------
 .../apache/ratis/server/impl/PendingRequests.java  |  7 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 12 ----
 .../ratis/server/impl/StateMachineUpdater.java     |  4 --
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 --
 .../test/java/org/apache/ratis/RaftBasicTests.java |  4 +-
 .../server/impl/ReinitializationBaseTest.java      | 36 ++++------
 .../ratis/statemachine/TestStateMachine.java       |  2 +-
 9 files changed, 16 insertions(+), 157 deletions(-)

commit 4dbe99bbd1c5fc7e2d9a6eba4d6df5726b68a9c8
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Sep 4 14:16:22 2017 -0700

    Ratis-105. Server should check group id for client requests. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/protocol/GroupMismatchException.java     | 28 ++++++++
 .../java/org/apache/ratis/TestMultiRaftGroup.java  | 76 ++++++++++++++++++++++
 .../apache/ratis/server/impl/PendingRequests.java  |  7 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 12 ++++
 .../ratis/server/impl/StateMachineUpdater.java     |  4 ++
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 ++
 .../test/java/org/apache/ratis/RaftBasicTests.java |  4 +-
 .../server/impl/ReinitializationBaseTest.java      | 36 ++++++----
 .../ratis/statemachine/TestStateMachine.java       |  2 +-
 9 files changed, 157 insertions(+), 16 deletions(-)

commit fd230c448b88becb79a216cd0cc0571a3ab9b0c4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Sep 2 10:28:21 2017 +0800

    RATIS-110. Add a static valueOf method to ClientId and RaftGroupId.  Contributed by Chen Liang

 .../src/main/java/org/apache/ratis/client/RaftClient.java   |  2 +-
 .../java/org/apache/ratis/client/impl/ClientProtoUtils.java |  8 ++++----
 .../src/main/java/org/apache/ratis/protocol/ClientId.java   | 12 ++++++++----
 .../main/java/org/apache/ratis/protocol/RaftGroupId.java    | 13 ++++++++-----
 .../src/main/java/org/apache/ratis/util/ProtoUtils.java     |  2 +-
 .../src/test/java/org/apache/ratis/grpc/TestRaftStream.java | 10 ++++------
 .../java/org/apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../java/org/apache/ratis/server/impl/ServerProtoUtils.java |  2 +-
 .../src/test/java/org/apache/ratis/MiniRaftCluster.java     |  2 +-
 .../org/apache/ratis/RaftNotLeaderExceptionBaseTest.java    |  4 ++--
 .../src/test/java/org/apache/ratis/protocol/TestRaftId.java |  8 ++++----
 .../ratis/server/impl/RaftReconfigurationBaseTest.java      |  2 +-
 .../apache/ratis/server/impl/ReinitializationBaseTest.java  |  6 +++---
 .../org/apache/ratis/server/storage/TestCacheEviction.java  |  2 +-
 .../org/apache/ratis/server/storage/TestRaftLogCache.java   |  2 +-
 .../apache/ratis/server/storage/TestRaftLogReadWrite.java   |  2 +-
 .../org/apache/ratis/server/storage/TestRaftLogSegment.java |  2 +-
 .../apache/ratis/server/storage/TestSegmentedRaftLog.java   |  2 +-
 .../org/apache/ratis/statemachine/RaftSnapshotBaseTest.java |  2 +-
 19 files changed, 45 insertions(+), 40 deletions(-)

commit e46aee2c87e85fe7317f2e807cdf97da0be31ddc
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 28 14:03:24 2017 -0700

    RATIS-112. testRevertConfigurationChange may fail.

 .../org/apache/ratis/util/CheckedSupplier.java     |  8 +++
 .../main/java/org/apache/ratis/util/JavaUtils.java | 64 ++++++++++++++++++++++
 .../apache/ratis/server/impl/ServerImplUtils.java  | 14 ++++-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 23 --------
 .../server/impl/RaftReconfigurationBaseTest.java   | 51 +++++++++--------
 .../ratis/server/impl/RaftServerTestUtil.java      |  5 +-
 .../ratis/server/storage/RaftStorageTestUtils.java | 55 +++++++++++++++++++
 7 files changed, 172 insertions(+), 48 deletions(-)

commit ee262d7e3daefe323900146beb460b20b1a72869
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Aug 23 11:51:42 2017 -0700

    RATIS-109. Improve the log messages in RaftServerImpl and the related code.

 .../java/org/apache/ratis/protocol/RaftId.java     |   2 +-
 .../ratis/protocol/ServerNotReadyException.java    |  27 +++++
 .../arithmetic/ArithmeticStateMachine.java         |  14 ++-
 .../ratis/examples/RaftExamplesTestUtil.java       |   5 +-
 .../ratis/examples/arithmetic/TestArithmetic.java  |  29 ++++--
 .../TestRaftStateMachineException.java             |   2 +-
 .../apache/ratis/server/impl/FollowerState.java    |   3 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   8 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   2 +-
 .../ratis/server/impl/RaftConfiguration.java       |   6 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 110 +++++++++++----------
 .../apache/ratis/server/impl/ServerImplUtils.java  |   6 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  17 +++-
 .../org/apache/ratis/server/impl/ServerState.java  |  15 +--
 .../ratis/server/impl/StateMachineUpdater.java     |  11 ++-
 .../apache/ratis/server/protocol/TermIndex.java    |  10 ++
 .../apache/ratis/server/storage/RaftLogWorker.java |   2 +-
 .../statemachine/SimpleStateMachineStorage.java    |   1 +
 .../java/org/apache/ratis/MiniRaftCluster.java     |  11 ++-
 .../server/impl/RaftReconfigurationBaseTest.java   |   7 +-
 21 files changed, 185 insertions(+), 105 deletions(-)

commit 704072c5c4df67704ba0df38e965857672551fd7
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 21 14:52:30 2017 -0700

    RATIS-108. Add a timeout for all the tests.

 .../src/test/java/org/apache/ratis/BaseTest.java   | 72 ++++++++++++++++++++++
 .../java/org/apache/ratis/util/TestLifeCycle.java  |  3 +-
 .../org/apache/ratis/util/TestTimeDuration.java    |  2 +-
 .../ratis/util/TestTraditionalBinaryPrefix.java    |  2 +-
 .../java/org/apache/ratis/TestBatchAppend.java     | 10 +--
 .../java/org/apache/ratis/TestRestartRaftPeer.java | 10 +--
 .../ratis/examples/arithmetic/TestArithmetic.java  |  3 +-
 .../arithmetic/expression/TestExpression.java      | 15 ++---
 .../TestRaftStateMachineException.java             |  7 +--
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  4 +-
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |  1 -
 .../ratis/hadooprpc/server/HadoopRpcService.java   |  2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  2 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java | 10 +--
 .../ratis/RaftNotLeaderExceptionBaseTest.java      | 10 +--
 .../java/org/apache/ratis/RaftRetryCacheTests.java | 11 +---
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 54 ++++++----------
 .../java/org/apache/ratis/protocol/TestRaftId.java |  8 ++-
 .../org/apache/ratis/server/TestRaftServerJmx.java | 12 +---
 .../server/impl/RaftReconfigurationBaseTest.java   |  6 +-
 .../server/impl/ReinitializationBaseTest.java      |  8 +--
 .../ratis/server/storage/TestCacheEviction.java    |  6 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java | 12 ++--
 .../ratis/server/storage/TestRaftLogSegment.java   | 10 +--
 .../ratis/server/storage/TestRaftStorage.java      |  6 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java | 15 ++---
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  3 +-
 .../ratis/statemachine/TestStateMachine.java       |  8 +--
 28 files changed, 151 insertions(+), 161 deletions(-)

commit c0c3a3748c83517348c7d65016c8224029d30f90
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Aug 17 10:53:16 2017 -0700

    RATIS-106. Consistently use File for storageDir.

 .../main/java/org/apache/ratis/conf/ConfUtils.java | 23 ++++++++--
 .../java/org/apache/ratis/conf/RaftProperties.java | 15 +++++++
 .../main/java/org/apache/ratis/util/FileUtils.java | 49 ----------------------
 .../apache/ratis/server/RaftServerConfigKeys.java  | 11 ++---
 .../org/apache/ratis/server/impl/ServerState.java  |  6 ++-
 .../apache/ratis/server/storage/RaftStorage.java   | 16 +------
 .../java/org/apache/ratis/MiniRaftCluster.java     | 22 +++++-----
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  5 ++-
 .../ratis/server/storage/TestCacheEviction.java    |  4 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java | 13 +++---
 .../ratis/server/storage/TestRaftLogSegment.java   | 10 ++---
 .../ratis/server/storage/TestRaftStorage.java      | 27 +++++-------
 .../ratis/server/storage/TestSegmentedRaftLog.java |  4 +-
 13 files changed, 86 insertions(+), 119 deletions(-)

commit 3e0ad68a0897c622b00e85af0b7c06ed1a80fc12
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Aug 12 15:28:54 2017 -0700

    RATIS-103. LeaderState.updateSenders may throws UnsupportedOperationException.

 .../org/apache/ratis/server/impl/LeaderState.java  | 85 +++++++++++++---------
 .../org/apache/ratis/server/impl/LogAppender.java  |  3 +-
 2 files changed, 54 insertions(+), 34 deletions(-)

commit 0235de0ececb0c647858ede3228d25f4928df712
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Aug 10 22:42:43 2017 -0700

    RATIS-97. Pass RaftGroup to reinitialize. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/client/RaftClient.java   |  4 ++--
 .../apache/ratis/client/impl/ClientProtoUtils.java |  6 +++---
 .../apache/ratis/client/impl/RaftClientImpl.java   | 17 +++++++++------
 .../java/org/apache/ratis/protocol/RaftGroup.java  | 10 ++++++++-
 .../apache/ratis/protocol/ReinitializeRequest.java | 10 ++++-----
 .../main/java/org/apache/ratis/util/NetUtils.java  |  6 +++++-
 .../java/org/apache/ratis/util/ProtoUtils.java     | 15 +++++++++----
 ratis-proto-shaded/src/main/proto/Raft.proto       |  2 +-
 .../java/org/apache/ratis/server/RaftServer.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  |  4 ++--
 .../server/impl/ReinitializationBaseTest.java      | 25 +++++++++++-----------
 11 files changed, 61 insertions(+), 40 deletions(-)

commit 812d7dbeb5361911e269fa68995a2a7179cdf6be
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Aug 10 22:30:50 2017 -0700

    RATIS-94. Expose basic information over JMX. Contributed by Elek, Marton

 .../org/apache/ratis/server/RaftServerMXBean.java  |  60 +++++++++++++
 .../org/apache/ratis/server/impl/LeaderState.java  |  12 ++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  58 ++++++++++++
 .../org/apache/ratis/server/TestRaftServerJmx.java | 100 +++++++++++++++++++++
 4 files changed, 229 insertions(+), 1 deletion(-)

commit e2bdc2478f45832a12582a0f94f32735047f151c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 7 14:08:16 2017 -0700

    RATIS-101. Use ByteString instead of byte[] in RaftId, ClientId, RaftGroupId and RaftPeerId.

 .../apache/ratis/client/impl/ClientProtoUtils.java | 101 +++++++++++----------
 .../java/org/apache/ratis/protocol/ClientId.java   |   8 +-
 .../org/apache/ratis/protocol/RaftGroupId.java     |   8 +-
 .../java/org/apache/ratis/protocol/RaftId.java     |  43 +++++----
 .../java/org/apache/ratis/protocol/RaftPeerId.java |  23 ++---
 .../java/org/apache/ratis/util/ProtoUtils.java     |  35 +++----
 .../apache/ratis/grpc/client/AppendStreamer.java   |  17 ++--
 .../apache/ratis/server/impl/RaftServerImpl.java   |   2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java |  67 ++++++--------
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  18 ++--
 .../java/org/apache/ratis/protocol/TestRaftId.java |  48 ++++++++++
 .../ratis/server/simulation/RaftServerReply.java   |   7 +-
 .../ratis/server/simulation/RaftServerRequest.java |   7 +-
 13 files changed, 218 insertions(+), 166 deletions(-)

commit 1e7a06ef1877e062e749adbc298e5f7a2851c990
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Aug 2 15:11:31 2017 -0700

    RATIS-98. Cache RaftId byte[] and String.

 .../java/org/apache/ratis/protocol/ClientId.java   |  4 +-
 .../org/apache/ratis/protocol/RaftGroupId.java     |  4 +-
 .../java/org/apache/ratis/protocol/RaftId.java     | 49 ++++++++++++++++------
 .../java/org/apache/ratis/protocol/RaftPeer.java   |  3 +-
 ...mbinedClientProtocolClientSideTranslatorPB.java |  2 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  3 +-
 6 files changed, 45 insertions(+), 20 deletions(-)

commit fb702de7cbccbaf0a2aa9dd1badb04f74194d73b
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Jul 31 23:33:03 2017 -0700

    RATIS-96. LeaderState computeLastCommitted may throw ArrayIndexOutOfBoundsException. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/RaftClientImpl.java   |   4 +-
 .../java/org/apache/ratis/protocol/RaftGroup.java  |   2 +-
 .../org/apache/ratis/util/CollectionUtils.java     |   6 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java |  44 ++++++++
 .../main/java/org/apache/ratis/util/LifeCycle.java |  13 ++-
 .../apache/ratis/grpc/client/AppendStreamer.java   |   3 +
 .../org/apache/ratis/server/impl/LeaderState.java  |  23 +++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  25 +++--
 .../org/apache/ratis/server/impl/ServerState.java  |   8 +-
 .../apache/ratis/server/storage/RaftStorage.java   |  15 ++-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  53 ++++++---
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  14 ++-
 .../server/impl/ReinitializationBaseTest.java      | 125 ++++++++++++++++++++-
 13 files changed, 282 insertions(+), 53 deletions(-)

commit 89e64f2125eb2d1692b395df1f4ac6028d0ad266
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Jul 28 13:38:06 2017 -0700

    Ratis-99. Exclude shaded sources from the checkstyle check. Contributed by Elek, Marton.

 ratis-hadoop-shaded/pom.xml | 7 +++++++
 ratis-proto-shaded/pom.xml  | 7 +++++++
 2 files changed, 14 insertions(+)

commit 9ed2652d298f5b9f77f8d866bbc829f215418be9
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jul 11 13:59:19 2017 -0700

    Amend previous commit of RATIS-93: replace netty ThreadLocalRandom import with Java ThreadLocalRandom.

 ratis-common/src/main/java/org/apache/ratis/util/CollectionUtils.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit d45275123fd0bc9dd88a965067408882a21c5367
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jul 11 13:38:19 2017 -0700

    RATIS-93. Filter peers from the iteration before random selection.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  2 +-
 .../org/apache/ratis/util/CollectionUtils.java     | 28 ++++++++++++----------
 .../apache/ratis/grpc/client/AppendStreamer.java   |  3 +--
 .../apache/ratis/statemachine/StateMachine.java    |  3 +--
 4 files changed, 18 insertions(+), 18 deletions(-)

commit 237be5d10b389fd4f0b7829bb95e88ec94e8b72f
Author: Jing Zhao <jing9@apache.org>
Date:   Sat Jul 8 21:02:26 2017 -0700

    RATIS-8. Avoid using Optional for data fields in TransactionContext. Contributed by Hugo Louro.

 .../arithmetic/ArithmeticStateMachine.java         |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  5 +--
 .../org/apache/ratis/server/storage/RaftLog.java   |  2 +-
 .../ratis/statemachine/BaseStateMachine.java       |  2 +-
 .../ratis/statemachine/TransactionContext.java     | 52 +++++++++++-----------
 .../statemachine/SimpleStateMachine4Testing.java   |  2 +-
 .../ratis/statemachine/TestStateMachine.java       | 18 ++++----
 7 files changed, 41 insertions(+), 42 deletions(-)

commit a5b84af2de1e3311e96ebdf81f2a1155976cace4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jun 23 11:32:22 2017 +0800

    RATIS-92. Move the basic getClassByName methods from RaftProperties to ReflectionUtils.

 .../apache/ratis/client/impl/RaftClientImpl.java   |   3 +-
 .../main/java/org/apache/ratis/RaftConfigKeys.java |  11 +-
 .../java/org/apache/ratis/conf/RaftProperties.java | 117 +--------------
 .../main/java/org/apache/ratis/rpc/RpcType.java    |  34 ++++-
 .../org/apache/ratis/rpc/SupportedRpcType.java     |   4 +-
 .../org/apache/ratis/util/CollectionUtils.java     |  11 +-
 .../org/apache/ratis/util/ReflectionUtils.java     | 165 ++++++++++++++++-----
 .../apache/ratis/server/impl/RaftServerProxy.java  |   2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   2 +-
 .../ratis/server/simulation/SimulatedRpc.java      |   3 +-
 10 files changed, 178 insertions(+), 174 deletions(-)

commit 466fc2c3a8fc984b3f94e939045fc4d8a7b0ae0c
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Jun 13 19:42:53 2017 -0700

    RATIS-89. Add raft group and raft group ID. Contributed by Jing Zhao.

 .../java/org/apache/ratis/client/RaftClient.java   |  9 ++-
 .../apache/ratis/client/impl/ClientImplUtils.java  |  5 +-
 .../apache/ratis/client/impl/ClientProtoUtils.java | 37 +++++++-----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 13 +++--
 .../java/org/apache/ratis/protocol/ClientId.java   | 42 ++------------
 .../apache/ratis/protocol/RaftClientMessage.java   | 13 ++++-
 .../org/apache/ratis/protocol/RaftClientReply.java | 15 ++---
 .../apache/ratis/protocol/RaftClientRequest.java   |  8 +--
 .../java/org/apache/ratis/protocol/RaftGroup.java  | 55 ++++++++++++++++++
 .../org/apache/ratis/protocol/RaftGroupId.java     | 41 +++++++++++++
 .../java/org/apache/ratis/protocol/RaftId.java     | 67 ++++++++++++++++++++++
 .../java/org/apache/ratis/protocol/RaftPeerId.java |  3 +-
 .../org/apache/ratis/protocol/RaftRpcMessage.java  |  2 +
 .../apache/ratis/protocol/ReinitializeRequest.java | 14 ++---
 .../ratis/protocol/SetConfigurationRequest.java    |  4 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |  1 +
 .../TestRaftStateMachineException.java             |  4 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   | 14 +++--
 .../apache/ratis/grpc/client/RaftOutputStream.java |  5 +-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  7 ++-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  9 ++-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  8 +--
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  7 ++-
 ratis-proto-shaded/src/main/proto/Raft.proto       | 11 ++++
 .../java/org/apache/ratis/server/RaftServer.java   |  8 +--
 .../apache/ratis/server/impl/RaftServerImpl.java   | 40 +++++++------
 .../apache/ratis/server/impl/RaftServerProxy.java  | 22 ++++---
 .../apache/ratis/server/impl/ServerImplUtils.java  | 15 +----
 .../apache/ratis/server/impl/ServerProtoUtils.java | 29 +++++-----
 .../org/apache/ratis/server/impl/ServerState.java  |  7 ++-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 67 ++++++++++++----------
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  6 +-
 .../java/org/apache/ratis/RaftRetryCacheTests.java |  9 +--
 .../server/impl/RaftReconfigurationBaseTest.java   | 14 ++---
 .../server/impl/ReinitializationBaseTest.java      | 15 ++---
 .../MiniRaftClusterWithSimulatedRpc.java           |  7 +--
 .../ratis/server/simulation/RaftServerReply.java   | 12 ++++
 .../ratis/server/simulation/RaftServerRequest.java | 12 ++++
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  2 +-
 39 files changed, 433 insertions(+), 226 deletions(-)

commit ddb82cd190f91997d37b6937db1630a96737112c
Author: Jing Zhao <jing9@apache.org>
Date:   Mon May 29 10:18:57 2017 -0700

    RATIS-90. After hitting IOException, RaftClient should randomly pick a known server as leader. Contributed by Jing Zhao.

 .../apache/ratis/client/impl/RaftClientImpl.java   |  5 ++---
 .../org/apache/ratis/util/CollectionUtils.java     | 24 ++++++++++++++++++++++
 .../apache/ratis/grpc/client/AppendStreamer.java   |  3 ++-
 .../ratis/RaftNotLeaderExceptionBaseTest.java      | 20 +++++++++++++++++-
 4 files changed, 47 insertions(+), 5 deletions(-)

commit 06002e67a3476a491e4fc0f1638123f5957c452e
Author: Jing Zhao <jing9@apache.org>
Date:   Fri May 19 11:23:33 2017 -0700

    RATIS-86. Support raft server re-initialization. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/client/RaftClient.java   |  3 +
 .../apache/ratis/client/impl/ClientProtoUtils.java | 22 ++++++
 .../apache/ratis/client/impl/RaftClientImpl.java   | 22 +++++-
 .../ratis/protocol/AdminAsynchronousProtocol.java  | 27 +++++++
 .../org/apache/ratis/protocol/AdminProtocol.java   | 25 +++++++
 .../apache/ratis/protocol/ReinitializeRequest.java | 39 ++++++++++
 .../org/apache/ratis/util/CheckedSupplier.java     | 30 ++++++++
 .../main/java/org/apache/ratis/util/IOUtils.java   |  4 +-
 .../main/java/org/apache/ratis/util/JavaUtils.java | 63 ++++++++++++++++
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  2 +
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   | 32 ++++++--
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |  7 +-
 .../grpc/client/RaftClientProtocolClient.java      | 26 +++++--
 .../grpc/client/RaftClientProtocolService.java     | 27 ++-----
 .../ratis/grpc/server/AdminProtocolService.java    | 45 ++++++++++++
 .../ratis/grpc/TestReinitializationWithGrpc.java   | 28 +++++++
 .../apache/ratis/hadooprpc/HadoopConstants.java    |  4 +-
 .../hadooprpc/client/CombinedClientProtocol.java   | 25 +++++++
 ...binedClientProtocolClientSideTranslatorPB.java} | 53 +++++++++-----
 ...otocolPB.java => CombinedClientProtocolPB.java} |  8 +-
 ...binedClientProtocolServerSideTranslatorPB.java} | 29 ++++++--
 .../ratis/hadooprpc/client/HadoopClientRpc.java    | 10 ++-
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 18 ++---
 .../TestReinitializationWithHadoopRpc.java         | 28 +++++++
 .../apache/ratis/netty/client/NettyClientRpc.java  |  8 +-
 .../apache/ratis/netty/server/NettyRpcService.java |  9 +++
 .../ratis/netty/TestReinitializationWithNetty.java | 28 +++++++
 ratis-proto-shaded/src/main/proto/GRpc.proto       |  6 ++
 ratis-proto-shaded/src/main/proto/Hadoop.proto     |  6 +-
 ratis-proto-shaded/src/main/proto/Netty.proto      |  1 +
 ratis-proto-shaded/src/main/proto/Raft.proto       |  6 ++
 .../java/org/apache/ratis/server/RaftServer.java   |  8 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  3 +-
 .../ratis/server/impl/PeerConfiguration.java       |  1 -
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerProxy.java  | 85 +++++++++++++++++++---
 .../java/org/apache/ratis/MiniRaftCluster.java     | 24 +++---
 .../test/java/org/apache/ratis/RaftBasicTests.java |  2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 23 +++++-
 .../server/impl/RaftReconfigurationBaseTest.java   |  2 +-
 .../server/impl/ReinitializationBaseTest.java      | 84 +++++++++++++++++++++
 .../ratis/server/simulation/SimulatedRpc.java      |  1 -
 .../server/simulation/SimulatedServerRpc.java      | 27 +++----
 .../TestReinitializationWithSimulatedRpc.java      | 28 +++++++
 44 files changed, 794 insertions(+), 137 deletions(-)

commit 291f51b4282ff8d5d64f593614215e43b0f99b0e
Author: Jing Zhao <jing9@apache.org>
Date:   Mon May 15 11:24:28 2017 -0700

    RATIS-88. Add RaftPeerId.valueOf methods. Contributed by Tsz Wo Nicholas Sze.

 .../apache/ratis/client/impl/ClientProtoUtils.java |  9 +++--
 .../java/org/apache/ratis/protocol/RaftPeerId.java | 37 ++++++++++++-------
 .../java/org/apache/ratis/util/ProtoUtils.java     |  2 +-
 .../java/org/apache/ratis/TestBatchAppend.java     |  6 ++--
 .../java/org/apache/ratis/TestRestartRaftPeer.java |  6 ++--
 .../TestRaftStateMachineException.java             |  8 +----
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  2 +-
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 39 +++++++++-----------
 .../apache/ratis/netty/server/NettyRpcService.java |  2 +-
 .../apache/ratis/server/impl/LeaderElection.java   |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  8 ++---
 .../java/org/apache/ratis/MiniRaftCluster.java     |  4 +--
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  8 +----
 .../server/impl/RaftReconfigurationBaseTest.java   | 42 +++++++++-------------
 .../ratis/server/storage/TestCacheEviction.java    |  2 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |  2 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  2 --
 17 files changed, 79 insertions(+), 102 deletions(-)

commit e6419972c8c2119f7ce48ad80cd09918d51e5725
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri May 12 16:41:06 2017 -0700

    RATIS-85. TestNotLeaderExceptionWithHadoopRpc and TestRaftReconfigurationWithHadoopRpc fail intermittently.  Contributed by Jing Zhao

 .../main/java/org/apache/ratis/util/FileUtils.java |  1 +
 .../java/org/apache/ratis/util/ProtoUtils.java     |  4 +--
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  2 ++
 .../apache/ratis/server/impl/RaftServerImpl.java   |  6 ++--
 .../apache/ratis/server/impl/ServerProtoUtils.java |  2 +-
 .../org/apache/ratis/server/impl/ServerState.java  |  2 ++
 .../org/apache/ratis/server/storage/RaftLog.java   |  3 ++
 .../apache/ratis/server/storage/RaftLogCache.java  |  2 +-
 .../apache/ratis/server/storage/RaftLogWorker.java | 35 +++++++++++++++++-----
 .../ratis/server/storage/SegmentedRaftLog.java     |  6 ++--
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  7 ++---
 11 files changed, 50 insertions(+), 20 deletions(-)

commit 341456e04493fa014deac8cae803d78cb7f247a8
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed May 10 13:38:51 2017 -0700

    RATIS-87. Separate RaftServerImpl into proxy and impl.

 .../java/org/apache/ratis/TestRestartRaftPeer.java |   6 +-
 .../TestRaftStateMachineException.java             |   2 +-
 .../java/org/apache/ratis/grpc/GrpcFactory.java    |   3 +-
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |   3 +-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |   5 +-
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |   3 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |   4 +-
 .../java/org/apache/ratis/netty/NettyFactory.java  |   3 +-
 .../ratis/netty/MiniRaftClusterWithNetty.java      |   7 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   2 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   9 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 204 +++++++++------------
 .../apache/ratis/server/impl/RaftServerProxy.java  | 167 +++++++++++++++++
 .../apache/ratis/server/impl/ServerFactory.java    |   3 +-
 .../apache/ratis/server/impl/ServerImplUtils.java  |   4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 118 ++++++------
 .../test/java/org/apache/ratis/RaftBasicTests.java |   2 +-
 .../java/org/apache/ratis/RaftRetryCacheTests.java |   2 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  12 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |  10 +-
 .../ratis/server/impl/RaftServerTestUtil.java      |   7 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |   3 +-
 .../ratis/server/simulation/SimulatedRpc.java      |   3 +-
 .../server/simulation/SimulatedServerRpc.java      |   7 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   4 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +-
 .../ratis/statemachine/TestStateMachine.java       |   8 +-
 28 files changed, 375 insertions(+), 232 deletions(-)

commit 2fbbe0aa9df31e5e982b235071e0b438f0241453
Author: Jing Zhao <jing9@apache.org>
Date:   Wed May 10 10:57:20 2017 -0700

    RATIS-82. Add cache eviction policy. Contributed by Jing Zhao.

 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |   2 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  11 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |   4 +
 .../apache/ratis/server/impl/RaftServerImpl.java   |   8 +
 .../apache/ratis/server/impl/ServerProtoUtils.java |   4 +-
 .../server/storage/CacheInvalidationPolicy.java    | 112 ++++++++++++
 .../apache/ratis/server/storage/LogSegment.java    |  39 +++-
 .../apache/ratis/server/storage/RaftLogCache.java  |  50 ++++-
 .../ratis/server/storage/SegmentedRaftLog.java     |  34 +++-
 .../ratis/server/storage/TestCacheEviction.java    | 202 +++++++++++++++++++++
 .../ratis/server/storage/TestRaftLogCache.java     |   4 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   4 +-
 12 files changed, 450 insertions(+), 24 deletions(-)

commit 6eb4f8278048b518dfe261e9d4ae93b1db003aa1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue May 2 18:21:12 2017 -0700

    [maven-release-plugin] prepare for next development iteration

 pom.xml                      | 4 ++--
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop-shaded/pom.xml  | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto-shaded/pom.xml   | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 12 files changed, 13 insertions(+), 13 deletions(-)

commit 52c4b6412df7daba82445db289f7b41e2216b4a6
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue May 2 18:20:58 2017 -0700

    [maven-release-plugin] prepare release ratis-0.1.0-alpha

 pom.xml                      | 3 ++-
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop-shaded/pom.xml  | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto-shaded/pom.xml   | 2 +-
 ratis-replicated-map/pom.xml | 6 ++----
 ratis-server/pom.xml         | 2 +-
 12 files changed, 14 insertions(+), 15 deletions(-)

commit 642a22c166851dd81e6f96449239e88af72e64a0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon May 1 17:05:00 2017 -0700

    RATIS-84. A few improvements on the release script.

 dev-support/make_rc.sh                   | 41 +++++++++++++++++++-------------
 ratis-assembly/src/main/assembly/src.xml |  1 +
 2 files changed, 26 insertions(+), 16 deletions(-)

commit 88bb447352fb722a6a58116a79aa138a71c0e79a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Apr 28 18:06:04 2017 -0700

    RATIS-83. Add a DISCLAIMER file.

 DISCLAIMER.txt                           | 7 +++++++
 ratis-assembly/src/main/assembly/src.xml | 1 +
 2 files changed, 8 insertions(+)

commit af1c0d77acbc4463afdeff6a440350b124f38c0b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Apr 28 14:22:34 2017 -0700

    RATIS-65. Add a script to automate the release process.

 dev-support/make_rc.sh                   | 105 +++++++++++++++++++++++++++++
 pom.xml                                  |   2 +-
 ratis-assembly/pom.xml                   |   6 +-
 ratis-assembly/src/main/assembly/src.xml | 110 +++++++++++++++++++++++++++++++
 ratis-proto-shaded/pom.xml               |  17 +++++
 5 files changed, 236 insertions(+), 4 deletions(-)

commit 3bf0b50d9d0704fcb878f2764dbe301e0dc89df3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Apr 28 14:19:04 2017 -0700

    RATIS-63. Add NOTICE.txt.

 NOTICE.txt | 5 +++++
 1 file changed, 5 insertions(+)

commit d18785a3d9e4aa090293b0f7f9a05e3dc6e27e9e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Apr 27 15:59:38 2017 -0700

    RATIS-81. Add license header for ratis-replicated-map/README.md.

 ratis-replicated-map/README.md | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit ec615f3ac0d8d953adbabc6bc5e020fcf58a9f38
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Apr 27 12:47:42 2017 -0700

    RATIS-80. Add "Apache" to maven project.name.

 pom.xml                      | 2 +-
 ratis-assembly/pom.xml       | 2 +-
 ratis-client/pom.xml         | 2 +-
 ratis-common/pom.xml         | 2 +-
 ratis-examples/pom.xml       | 2 +-
 ratis-grpc/pom.xml           | 2 +-
 ratis-hadoop-shaded/pom.xml  | 2 +-
 ratis-hadoop/pom.xml         | 2 +-
 ratis-netty/pom.xml          | 2 +-
 ratis-proto-shaded/pom.xml   | 2 +-
 ratis-replicated-map/pom.xml | 2 +-
 ratis-server/pom.xml         | 2 +-
 12 files changed, 12 insertions(+), 12 deletions(-)

commit 13fdb9ee6cb89a2bfa3533ab7955b33951de491b
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Apr 26 10:55:00 2017 -0700

    RATIS-76. Add loading policy for RaftLogCache. Contributed by Jing Zhao.

 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  10 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |   2 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  16 +-
 .../apache/ratis/server/storage/LogSegment.java    | 168 ++++++++++++++++-----
 .../apache/ratis/server/storage/MemoryRaftLog.java |   1 -
 .../org/apache/ratis/server/storage/RaftLog.java   |   2 +-
 .../apache/ratis/server/storage/RaftLogCache.java  |  42 +++---
 .../ratis/server/storage/RaftLogIOException.java   |  29 ++++
 .../ratis/server/storage/SegmentedRaftLog.java     |  41 +++--
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  20 ++-
 .../ratis/server/storage/TestRaftLogCache.java     |  27 ++--
 .../ratis/server/storage/TestRaftLogSegment.java   |  39 +++--
 .../ratis/server/storage/TestSegmentedRaftLog.java |  21 ++-
 13 files changed, 300 insertions(+), 118 deletions(-)

commit b2c6913826a238b6f1f693c6cce648b5f5301155
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Apr 25 23:55:55 2017 +0800

    RATIS-74. Missing dependency for enforcer rule enforceBytecodeVersion.  Contributed by Karl Heinz Marbaise

 pom.xml | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 5ebe83e872b33c4a650e810f43f07fa93eee908d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Apr 25 23:43:10 2017 +0800

    RATIS-78. Ratis does not compile in Intellij. Contributed by Jing Zhao

 ratis-proto-shaded/pom.xml | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

commit 2373a4a08e5805af3291acae64c2efccd9f528d4
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Apr 17 10:43:29 2017 -0700

    RATIS-70. Separate term/index/offset and log entry content in LogSegment. Contributed by Jing Zhao

 .../java/org/apache/ratis/TestRestartRaftPeer.java |   2 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  14 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   5 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  12 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   3 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  30 ++++-
 .../org/apache/ratis/server/impl/ServerState.java  |  26 +++-
 .../ratis/server/impl/StateMachineUpdater.java     |  32 +----
 .../apache/ratis/server/protocol/TermIndex.java    |   2 +
 .../apache/ratis/server/storage/LogSegment.java    | 112 ++++++++++------
 .../apache/ratis/server/storage/MemoryRaftLog.java |  37 ++++--
 .../org/apache/ratis/server/storage/RaftLog.java   |  47 ++++---
 .../apache/ratis/server/storage/RaftLogCache.java  | 144 ++++++++++++---------
 .../apache/ratis/server/storage/RaftLogWorker.java |  10 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |  53 ++++----
 .../ratis/statemachine/BaseStateMachine.java       |   4 +-
 .../apache/ratis/statemachine/StateMachine.java    |   4 +-
 .../test/java/org/apache/ratis/RaftBasicTests.java |   5 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  21 +--
 .../server/impl/RaftReconfigurationBaseTest.java   |   7 +-
 .../ratis/server/storage/TestRaftLogCache.java     |   3 +-
 .../ratis/server/storage/TestRaftLogSegment.java   |  13 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |  62 +++++----
 23 files changed, 390 insertions(+), 258 deletions(-)

commit 06fd2e441bf72de3744f5409446079df009f1f6a
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Apr 13 11:20:27 2017 -0700

    RATIS-73. Update apache-rat-plugin to version 0.12. Contributed by Karl Heinz Marbaise.

 pom.xml | 16 ++++------------
 1 file changed, 4 insertions(+), 12 deletions(-)

commit 0af97352b05e5d8f163cb1c7ec9ba94c75971c6a
Author: Enis Soztutar <enis@apache.org>
Date:   Mon Apr 10 00:57:52 2017 -0700

    RATIS-58 Add rmap.proto

 ratis-proto-shaded/src/main/proto/RMap.proto | 189 +++++++++++++++++++++++++++
 1 file changed, 189 insertions(+)

commit ac55b5f186ffdec1dd97620eb06d9a939891ab1e
Author: Karl Heinz Marbaise <khmarbaise@apache.org>
Date:   Thu Apr 6 21:42:03 2017 +0200

    Removed usage of version properties usages for maven-plugins
    
    Signed-off-by: Enis Soztutar <enis@apache.org>

 ratis-assembly/pom.xml      | 2 --
 ratis-hadoop-shaded/pom.xml | 4 ----
 ratis-proto-shaded/pom.xml  | 5 -----
 3 files changed, 11 deletions(-)

commit 43bc6ebf4f415ecf23317ef4c38fa6c58afde29a
Author: Enis Soztutar <enis@apache.org>
Date:   Mon Apr 10 00:32:17 2017 -0700

    RATIS-52 Refactor RaftUtils into different classes

 .../apache/ratis/client/impl/ClientProtoUtils.java |   4 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |   7 +-
 .../main/java/org/apache/ratis/RaftConfigKeys.java |  12 +-
 .../org/apache/ratis/io/nativeio/NativeIO.java     |  19 +-
 .../ratis/io/nativeio/NativeIOException.java       |   4 +-
 .../java/org/apache/ratis/protocol/ClientId.java   |   4 +-
 .../java/org/apache/ratis/protocol/RaftPeerId.java |   4 +-
 .../org/apache/ratis/rpc/SupportedRpcType.java     |   6 +-
 .../apache/ratis/util/AtomicFileOutputStream.java  |   2 +-
 .../org/apache/ratis/util/CollectionUtils.java     |  63 ++++
 .../main/java/org/apache/ratis/util/FileUtils.java |   2 +-
 .../main/java/org/apache/ratis/util/IOUtils.java   | 144 ++++++++
 .../main/java/org/apache/ratis/util/LifeCycle.java |  14 +-
 .../main/java/org/apache/ratis/util/LogUtils.java  |  36 ++
 .../java/org/apache/ratis/util/MD5FileUtil.java    |   6 +-
 .../java/org/apache/ratis/util/PlatformUtils.java  |  74 ++++
 .../java/org/apache/ratis/util/Preconditions.java  |  75 ++++
 .../main/java/org/apache/ratis/util/RaftUtils.java | 386 ---------------------
 .../org/apache/ratis/util/ReflectionUtils.java     | 136 ++++++++
 .../arithmetic/ArithmeticStateMachine.java         |   4 +-
 .../arithmetic/expression/BinaryExpression.java    |   6 +-
 .../arithmetic/expression/DoubleValue.java         |   6 +-
 .../examples/arithmetic/expression/Expression.java |   8 +-
 .../examples/arithmetic/expression/NullValue.java  |   4 +-
 .../arithmetic/expression/UnaryExpression.java     |   6 +-
 .../examples/arithmetic/expression/Variable.java   |   6 +-
 .../java/org/apache/ratis/TestBatchAppend.java     |   8 +-
 .../java/org/apache/ratis/TestRestartRaftPeer.java |  10 +-
 .../ratis/examples/arithmetic/TestArithmetic.java  |   4 +-
 .../TestRaftStateMachineException.java             |  10 +-
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   |   9 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   |  11 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |   6 +-
 .../grpc/client/RaftClientProtocolService.java     |   8 +-
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  12 +-
 .../grpc/TestRaftReconfigurationWithGRpc.java      |   4 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |   4 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |   4 +-
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  |   8 +-
 .../TestRaftReconfigurationWithHadoopRpc.java      |   2 -
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |   8 +-
 .../hadooprpc/TestRetryCacheWithHadoopRpc.java     |   8 +-
 .../java/org/apache/ratis/netty/NettyRpcProxy.java |   8 +-
 .../org/apache/ratis/netty/TestRaftWithNetty.java  |   6 +-
 .../ratis/netty/TestRetryCacheWithNettyRpc.java    |  10 +-
 .../ratis/server/impl/ConfigurationManager.java    |   4 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   4 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  10 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   7 +-
 .../ratis/server/impl/PeerConfiguration.java       |   6 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   6 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  12 +-
 .../ratis/server/impl/RaftConfiguration.java       |  24 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  82 +++--
 .../org/apache/ratis/server/impl/RetryCache.java   |  14 +-
 .../org/apache/ratis/server/impl/ServerState.java  |   4 +-
 .../ratis/server/impl/StateMachineUpdater.java     |   8 +-
 .../ratis/server/storage/LogInputStream.java       |  19 +-
 .../ratis/server/storage/LogOutputStream.java      |   6 +-
 .../org/apache/ratis/server/storage/LogReader.java |  15 +-
 .../apache/ratis/server/storage/LogSegment.java    |  26 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |   4 +-
 .../org/apache/ratis/server/storage/MetaFile.java  |   4 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   4 +-
 .../apache/ratis/server/storage/RaftLogCache.java  |  14 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |  27 +-
 .../apache/ratis/server/storage/RaftStorage.java   |   4 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |   6 +-
 .../ratis/server/storage/SnapshotManager.java      |   7 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  41 ++-
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  10 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |  48 +--
 .../server/simulation/SimulatedRequestReply.java   |  17 +-
 .../simulation/TestRaftWithSimulatedRpc.java       |   8 +-
 .../simulation/TestRetryCacheWithSimulatedRpc.java |  10 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   4 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  10 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +-
 .../ratis/statemachine/TermIndexTracker.java       |   4 +-
 .../ratis/statemachine/TestStateMachine.java       |   6 +-
 80 files changed, 926 insertions(+), 731 deletions(-)

commit 9bd8cbd6b4d7a6746ee967697d20bcf62a1afaa1
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Apr 6 11:21:05 2017 -0700

    RATIS-68. Simplify parent entries in child pom. Contributed by Karl Heinz Marbaise.

 pom.xml                      | 3 +--
 ratis-assembly/pom.xml       | 2 --
 ratis-client/pom.xml         | 2 --
 ratis-common/pom.xml         | 2 --
 ratis-examples/pom.xml       | 2 --
 ratis-grpc/pom.xml           | 2 --
 ratis-hadoop-shaded/pom.xml  | 2 --
 ratis-hadoop/pom.xml         | 2 --
 ratis-netty/pom.xml          | 2 --
 ratis-proto-shaded/pom.xml   | 2 --
 ratis-replicated-map/pom.xml | 2 --
 ratis-server/pom.xml         | 2 --
 12 files changed, 1 insertion(+), 24 deletions(-)

commit 81cefd8e109bf6e35599fd349279b28a8483299b
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Apr 6 11:15:32 2017 -0700

    RATIS-66. Remove make-maven-plugin from pom.xml. Contributed by Karl Heinz Marbaise.

 pom.xml | 6 ------
 1 file changed, 6 deletions(-)

commit e913cf8c42ec202462f999e08835e884de79d148
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Apr 4 08:13:36 2017 +0200

    RATIS-54. Bump maven.min.version to 3.3.9.

 BUILDING.md |  6 ++++--
 pom.xml     | 14 ++++++++------
 2 files changed, 12 insertions(+), 8 deletions(-)

commit 24f5cc769f6db591d9baa105579ba41725943fe8
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Mar 31 15:16:54 2017 -0700

    RATIS-62. Return the Exception from StateMachine#preAppendTransaction to client as StateMachineException. Contributed by Jing Zhao.

 .../statemachine/TestRaftStateMachineException.java   | 19 ++++++-------------
 .../org/apache/ratis/server/impl/RaftServerImpl.java  | 17 ++++++++---------
 .../org/apache/ratis/server/impl/ServerState.java     |  3 ++-
 .../java/org/apache/ratis/server/storage/RaftLog.java |  9 +++++++--
 4 files changed, 23 insertions(+), 25 deletions(-)

commit 42fff2b266a7841e075cc2202fe4530a4c4cab61
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Mar 31 00:17:37 2017 -0700

    RATIS-17. Add basic retry cache implementation for Raft Server. Contributed by Jing Zhao.

 .../TestRaftStateMachineException.java             | 116 ++++++++++-
 .../apache/ratis/grpc/TestRetryCacheWithGrpc.java  |  46 +++++
 .../hadooprpc/TestRetryCacheWithHadoopRpc.java     |  46 +++++
 .../ratis/netty/TestRetryCacheWithNettyRpc.java    |  45 +++++
 .../apache/ratis/server/RaftServerConfigKeys.java  |  21 ++
 .../org/apache/ratis/server/impl/LeaderState.java  |   6 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   3 +
 .../apache/ratis/server/impl/PendingRequests.java  |  16 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 132 +++++++++---
 .../org/apache/ratis/server/impl/RetryCache.java   | 225 +++++++++++++++++++++
 .../ratis/server/impl/StateMachineUpdater.java     |   2 +-
 .../java/org/apache/ratis/RaftRetryCacheTests.java | 174 ++++++++++++++++
 .../ratis/server/impl/RaftServerTestUtil.java      |  14 ++
 .../simulation/TestRetryCacheWithSimulatedRpc.java |  45 +++++
 14 files changed, 842 insertions(+), 49 deletions(-)

commit 771e8adc40c36f310feac445beab1cff287dc69d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Mar 31 14:56:30 2017 +0800

    Revert "RATIS-52. Refactor RaftUtils into different classes.  Contributed by Enis Soztutar"
    
    This reverts commit 43ad0def61944b108bb4f2a474a60a4c566d9821.

 .../apache/ratis/client/impl/ClientProtoUtils.java |   4 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |   7 +-
 .../main/java/org/apache/ratis/RaftConfigKeys.java |  12 +-
 .../org/apache/ratis/io/nativeio/NativeIO.java     |  19 +-
 .../ratis/io/nativeio/NativeIOException.java       |   4 +-
 .../java/org/apache/ratis/protocol/ClientId.java   |   4 +-
 .../java/org/apache/ratis/protocol/RaftPeerId.java |   4 +-
 .../org/apache/ratis/rpc/SupportedRpcType.java     |   7 +-
 .../apache/ratis/util/AtomicFileOutputStream.java  |   2 +-
 .../org/apache/ratis/util/CollectionUtils.java     |  63 ----
 .../main/java/org/apache/ratis/util/FileUtils.java |   2 +-
 .../main/java/org/apache/ratis/util/IOUtils.java   | 144 --------
 .../main/java/org/apache/ratis/util/LifeCycle.java |  14 +-
 .../main/java/org/apache/ratis/util/LogUtils.java  |  36 --
 .../java/org/apache/ratis/util/MD5FileUtil.java    |   6 +-
 .../java/org/apache/ratis/util/PlatformUtils.java  |  74 ----
 .../java/org/apache/ratis/util/Preconditions.java  |  75 ----
 .../main/java/org/apache/ratis/util/RaftUtils.java | 386 +++++++++++++++++++++
 .../org/apache/ratis/util/ReflectionUtils.java     | 220 ------------
 .../arithmetic/ArithmeticStateMachine.java         |   4 +-
 .../arithmetic/expression/BinaryExpression.java    |   6 +-
 .../arithmetic/expression/DoubleValue.java         |   6 +-
 .../examples/arithmetic/expression/Expression.java |   8 +-
 .../examples/arithmetic/expression/NullValue.java  |   4 +-
 .../arithmetic/expression/UnaryExpression.java     |   6 +-
 .../examples/arithmetic/expression/Variable.java   |   6 +-
 .../java/org/apache/ratis/TestBatchAppend.java     |   8 +-
 .../java/org/apache/ratis/TestRestartRaftPeer.java |  10 +-
 .../ratis/examples/arithmetic/TestArithmetic.java  |   4 +-
 .../TestRaftStateMachineException.java             |  10 +-
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   |   9 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   |  11 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |   6 +-
 .../grpc/client/RaftClientProtocolService.java     |   8 +-
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  12 +-
 .../grpc/TestRaftReconfigurationWithGRpc.java      |   4 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |   4 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |   4 +-
 .../TestRaftReconfigurationWithHadoopRpc.java      |   2 +
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |   8 +-
 .../java/org/apache/ratis/netty/NettyRpcProxy.java |   8 +-
 .../org/apache/ratis/netty/TestRaftWithNetty.java  |   6 +-
 .../ratis/server/impl/ConfigurationManager.java    |   4 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   4 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  10 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   7 +-
 .../ratis/server/impl/PeerConfiguration.java       |   6 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   6 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  12 +-
 .../ratis/server/impl/RaftConfiguration.java       |  24 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  25 +-
 .../org/apache/ratis/server/impl/ServerState.java  |   4 +-
 .../ratis/server/impl/StateMachineUpdater.java     |   8 +-
 .../ratis/server/storage/LogInputStream.java       |  19 +-
 .../ratis/server/storage/LogOutputStream.java      |   6 +-
 .../org/apache/ratis/server/storage/LogReader.java |  15 +-
 .../apache/ratis/server/storage/LogSegment.java    |  26 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |   4 +-
 .../org/apache/ratis/server/storage/MetaFile.java  |   4 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   4 +-
 .../apache/ratis/server/storage/RaftLogCache.java  |  14 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |  27 +-
 .../apache/ratis/server/storage/RaftStorage.java   |   4 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |   6 +-
 .../ratis/server/storage/SnapshotManager.java      |   7 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  41 +--
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  10 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |   8 +-
 .../server/simulation/SimulatedRequestReply.java   |  17 +-
 .../simulation/TestRaftWithSimulatedRpc.java       |   8 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   4 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  10 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +-
 .../ratis/statemachine/TermIndexTracker.java       |   4 +-
 .../ratis/statemachine/TestStateMachine.java       |   6 +-
 75 files changed, 673 insertions(+), 922 deletions(-)

commit 43ad0def61944b108bb4f2a474a60a4c566d9821
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Mar 31 13:26:16 2017 +0800

    RATIS-52. Refactor RaftUtils into different classes.  Contributed by Enis Soztutar

 .../apache/ratis/client/impl/ClientProtoUtils.java |   4 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |   7 +-
 .../main/java/org/apache/ratis/RaftConfigKeys.java |  12 +-
 .../org/apache/ratis/io/nativeio/NativeIO.java     |  19 +-
 .../ratis/io/nativeio/NativeIOException.java       |   4 +-
 .../java/org/apache/ratis/protocol/ClientId.java   |   4 +-
 .../java/org/apache/ratis/protocol/RaftPeerId.java |   4 +-
 .../org/apache/ratis/rpc/SupportedRpcType.java     |   7 +-
 .../apache/ratis/util/AtomicFileOutputStream.java  |   2 +-
 .../org/apache/ratis/util/CollectionUtils.java     |  63 ++++
 .../main/java/org/apache/ratis/util/FileUtils.java |   2 +-
 .../main/java/org/apache/ratis/util/IOUtils.java   | 144 ++++++++
 .../main/java/org/apache/ratis/util/LifeCycle.java |  14 +-
 .../main/java/org/apache/ratis/util/LogUtils.java  |  36 ++
 .../java/org/apache/ratis/util/MD5FileUtil.java    |   6 +-
 .../java/org/apache/ratis/util/PlatformUtils.java  |  74 ++++
 .../java/org/apache/ratis/util/Preconditions.java  |  75 ++++
 .../main/java/org/apache/ratis/util/RaftUtils.java | 386 ---------------------
 .../org/apache/ratis/util/ReflectionUtils.java     | 220 ++++++++++++
 .../arithmetic/ArithmeticStateMachine.java         |   4 +-
 .../arithmetic/expression/BinaryExpression.java    |   6 +-
 .../arithmetic/expression/DoubleValue.java         |   6 +-
 .../examples/arithmetic/expression/Expression.java |   8 +-
 .../examples/arithmetic/expression/NullValue.java  |   4 +-
 .../arithmetic/expression/UnaryExpression.java     |   6 +-
 .../examples/arithmetic/expression/Variable.java   |   6 +-
 .../java/org/apache/ratis/TestBatchAppend.java     |   8 +-
 .../java/org/apache/ratis/TestRestartRaftPeer.java |  10 +-
 .../ratis/examples/arithmetic/TestArithmetic.java  |   4 +-
 .../TestRaftStateMachineException.java             |  10 +-
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   |   9 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   |  11 +-
 .../apache/ratis/grpc/client/GrpcClientRpc.java    |   6 +-
 .../grpc/client/RaftClientProtocolService.java     |   8 +-
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |  12 +-
 .../grpc/TestRaftReconfigurationWithGRpc.java      |   4 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |   4 +-
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |   4 +-
 .../TestRaftReconfigurationWithHadoopRpc.java      |   2 -
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |   8 +-
 .../java/org/apache/ratis/netty/NettyRpcProxy.java |   8 +-
 .../org/apache/ratis/netty/TestRaftWithNetty.java  |   6 +-
 .../ratis/server/impl/ConfigurationManager.java    |   4 +-
 .../apache/ratis/server/impl/LeaderElection.java   |   4 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  10 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   7 +-
 .../ratis/server/impl/PeerConfiguration.java       |   6 +-
 .../apache/ratis/server/impl/PendingRequest.java   |   6 +-
 .../apache/ratis/server/impl/PendingRequests.java  |  12 +-
 .../ratis/server/impl/RaftConfiguration.java       |  24 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  25 +-
 .../org/apache/ratis/server/impl/ServerState.java  |   4 +-
 .../ratis/server/impl/StateMachineUpdater.java     |   8 +-
 .../ratis/server/storage/LogInputStream.java       |  19 +-
 .../ratis/server/storage/LogOutputStream.java      |   6 +-
 .../org/apache/ratis/server/storage/LogReader.java |  15 +-
 .../apache/ratis/server/storage/LogSegment.java    |  26 +-
 .../apache/ratis/server/storage/MemoryRaftLog.java |   4 +-
 .../org/apache/ratis/server/storage/MetaFile.java  |   4 +-
 .../org/apache/ratis/server/storage/RaftLog.java   |   4 +-
 .../apache/ratis/server/storage/RaftLogCache.java  |  14 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |  27 +-
 .../apache/ratis/server/storage/RaftStorage.java   |   4 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |   6 +-
 .../ratis/server/storage/SnapshotManager.java      |   7 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  41 ++-
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  10 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |   8 +-
 .../server/simulation/SimulatedRequestReply.java   |  17 +-
 .../simulation/TestRaftWithSimulatedRpc.java       |   8 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |   4 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  10 +-
 .../statemachine/SimpleStateMachine4Testing.java   |   4 +-
 .../ratis/statemachine/TermIndexTracker.java       |   4 +-
 .../ratis/statemachine/TestStateMachine.java       |   6 +-
 75 files changed, 922 insertions(+), 673 deletions(-)

commit 67f25fec2d8b8a99132230c8c90a837b45acbac8
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 30 17:04:29 2017 -0700

    RATIS-57. Fix pom.xml for mvn release:prepare. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                     | 8 +++-----
 ratis-assembly/pom.xml      | 4 +---
 ratis-client/pom.xml        | 4 +---
 ratis-common/pom.xml        | 4 +---
 ratis-examples/pom.xml      | 4 +---
 ratis-grpc/pom.xml          | 4 +---
 ratis-hadoop-shaded/pom.xml | 4 +---
 ratis-hadoop/pom.xml        | 4 +---
 ratis-netty/pom.xml         | 4 +---
 ratis-proto-shaded/pom.xml  | 4 +---
 ratis-server/pom.xml        | 4 +---
 11 files changed, 13 insertions(+), 35 deletions(-)

commit 4010e7c47cc98bdbc95edd12c19bd34a3f877815
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 30 13:41:37 2017 -0700

    RATIS-51. Add ratis-replicated-map module. Contributed by Enis Soztutar.

 pom.xml                                            |  14 +++
 ratis-assembly/pom.xml                             |  10 ++
 ratis-replicated-map/README.md                     |  22 ++++
 ratis-replicated-map/pom.xml                       | 114 +++++++++++++++++++++
 .../src/test/resources/log4j.properties            |  18 ++++
 5 files changed, 178 insertions(+)

commit 48fbe431a8bcd8dc1b66706306b43767aa414218
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 30 13:37:22 2017 -0700

    RATIS-55. Add missing license headers. Contributed by Tsz Wo Nicholas Sze.

 BUILDING.md                 | 16 +++++++++++++++-
 README.md                   | 14 ++++++++++++++
 ratis-hadoop-shaded/pom.xml |  7 +++++++
 ratis-proto-shaded/pom.xml  |  7 +++++++
 4 files changed, 43 insertions(+), 1 deletion(-)

commit 930f4c019e3d8acc81376182c941ef887cc8a865
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Mar 28 19:40:01 2017 -0700

    RATIS-49. Add a clean profile to remove shaded source. Contributed by Tsz Wo Nicholas Sze.

 BUILDING.md                 | 55 ++++++++++++++++++++++++++++-----------------
 pom.xml                     |  2 +-
 ratis-hadoop-shaded/pom.xml | 42 ++++++++++++++++++++++++++--------
 ratis-proto-shaded/pom.xml  | 54 ++++++++++++++++++++++++--------------------
 4 files changed, 99 insertions(+), 54 deletions(-)

commit 768d7caa46f48a0851322f6f88cb599bdd5c7e52
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Mar 21 18:27:50 2017 -0700

    Revert "Update version to 0.11-SNAPSHOT."
    
    This reverts commit ebe62d25411ac62e74b49b14e4ad6535f29eb70b.

 pom.xml                     | 2 +-
 ratis-assembly/pom.xml      | 4 ++--
 ratis-client/pom.xml        | 4 ++--
 ratis-common/pom.xml        | 4 ++--
 ratis-examples/pom.xml      | 4 ++--
 ratis-grpc/pom.xml          | 4 ++--
 ratis-hadoop-shaded/pom.xml | 4 ++--
 ratis-hadoop/pom.xml        | 4 ++--
 ratis-netty/pom.xml         | 4 ++--
 ratis-proto-shaded/pom.xml  | 4 ++--
 ratis-server/pom.xml        | 4 ++--
 11 files changed, 21 insertions(+), 21 deletions(-)

commit ebe62d25411ac62e74b49b14e4ad6535f29eb70b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Mar 21 17:56:19 2017 -0700

    Update version to 0.11-SNAPSHOT.

 pom.xml                     | 2 +-
 ratis-assembly/pom.xml      | 4 ++--
 ratis-client/pom.xml        | 4 ++--
 ratis-common/pom.xml        | 4 ++--
 ratis-examples/pom.xml      | 4 ++--
 ratis-grpc/pom.xml          | 4 ++--
 ratis-hadoop-shaded/pom.xml | 4 ++--
 ratis-hadoop/pom.xml        | 4 ++--
 ratis-netty/pom.xml         | 4 ++--
 ratis-proto-shaded/pom.xml  | 4 ++--
 ratis-server/pom.xml        | 4 ++--
 11 files changed, 21 insertions(+), 21 deletions(-)

commit 183c64d51a788532b75335066c2558e68b2ee349
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Mar 20 15:43:15 2017 -0700

    RATIS-47. Shade google guava, and combine ratis-netty-shaded with ratis-proto-shaded. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                                            |  19 +-
 ratis-common/pom.xml                               |   5 -
 .../java/org/apache/ratis/util/StringUtils.java    |   4 +-
 ratis-examples/pom.xml                             |   5 -
 ratis-grpc/pom.xml                                 |   5 +
 ratis-hadoop-shaded/pom.xml                        |   2 +-
 ratis-netty-shaded/.gitignore                      |   2 -
 ratis-netty-shaded/pom.xml                         | 495 ---------------------
 ratis-netty/pom.xml                                |  10 +-
 ratis-proto-shaded/pom.xml                         | 342 +++++++++++++-
 10 files changed, 357 insertions(+), 532 deletions(-)

commit f970468b97582831c67036c0eb08e72c00bedf92
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Mar 20 14:46:25 2017 -0700

    RATIS-41. Avoid using google guava in common. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/conf/RaftProperties.java |  15 +-
 .../org/apache/ratis/io/nativeio/NativeIO.java     |   4 -
 .../java/org/apache/ratis/protocol/ClientId.java   |   9 +-
 .../java/org/apache/ratis/protocol/RaftPeer.java   |   6 +-
 .../java/org/apache/ratis/protocol/RaftPeerId.java |   7 +-
 .../main/java/org/apache/ratis/util/LifeCycle.java |   6 +-
 .../java/org/apache/ratis/util/MD5FileUtil.java    |   7 +-
 .../java/org/apache/ratis/util/NativeCrc32.java    |  33 --
 .../main/java/org/apache/ratis/util/NetUtils.java  |  77 +--
 .../java/org/apache/ratis/util/PeerProxyMap.java   |   8 +-
 .../java/org/apache/ratis/util/PureJavaCrc32.java  | 619 ---------------------
 .../main/java/org/apache/ratis/util/RaftUtils.java |  18 +-
 .../java/org/apache/ratis/util/StringUtils.java    |   4 +-
 .../native/src/org/apache/ratis/util/NativeCrc32.c |  12 -
 .../java/org/apache/ratis/hadooprpc/Proxy.java     |   2 +-
 .../java/org/apache/ratis/netty/NettyClient.java   |   4 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   4 +-
 17 files changed, 62 insertions(+), 773 deletions(-)

commit e84e7e4443d45be9a5340ba99a992b54dc917b02
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Mar 20 14:41:19 2017 -0700

    RATIS-46. Do not use commons-io and commons-lang. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                                               | 16 ----------------
 ratis-common/pom.xml                                  | 10 ----------
 .../org/apache/ratis/server/impl/LogAppender.java     |  3 +--
 .../org/apache/ratis/server/impl/ServerImplUtils.java |  3 +--
 .../org/apache/ratis/server/storage/LogReader.java    | 19 +++++--------------
 .../apache/ratis/server/storage/SegmentedRaftLog.java |  4 ++--
 .../src/test/java/org/apache/ratis/RaftTestUtil.java  |  4 ++--
 7 files changed, 11 insertions(+), 48 deletions(-)

commit 80b28c711a01693a239e1b6fe92f3f7c1d723324
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Mar 17 15:00:51 2017 -0700

    RATIS-44. Move hadoop out from ratis-proto-shaded. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                        |  26 ++--
 ratis-examples/pom.xml         |   5 +
 ratis-hadoop-shaded/.gitignore |   2 +
 ratis-hadoop-shaded/pom.xml    | 296 +++++++++++++++++++++++++++++++++++++++++
 ratis-hadoop/pom.xml           |   9 +-
 ratis-proto-shaded/pom.xml     | 101 --------------
 6 files changed, 318 insertions(+), 121 deletions(-)

commit 717e46d4974efd5e0581cb99903f48b52bc624cd
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Mar 17 14:58:01 2017 -0700

    RATIS-42. Shade netty in ratis. Contributed by Tsz Wo Nicholas Sze.

 pom.xml                                            |  23 +-
 ratis-examples/pom.xml                             |   5 +
 ratis-netty-shaded/.gitignore                      |   2 +
 ratis-netty-shaded/pom.xml                         | 495 +++++++++++++++++++++
 ratis-netty/pom.xml                                |  11 +-
 .../java/org/apache/ratis/netty/NettyClient.java   |  23 +-
 .../java/org/apache/ratis/netty/NettyRpcProxy.java |  29 +-
 .../apache/ratis/netty/server/NettyRpcService.java |  14 +-
 ratis-proto-shaded/pom.xml                         |  73 +--
 9 files changed, 576 insertions(+), 99 deletions(-)

commit dc182838bfabcb5839aee5e60a2851ffaf5fffaa
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Mar 17 11:08:16 2017 -0700

    RATIS-43. Rename RaftClientProtocolService 'client' field onto 'protocol'. Contributed by Hugo Louro.

 .../apache/ratis/grpc/client/RaftClientProtocolService.java    | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit a25143eedb84a3da5ffba5d475314eca41a7ae48
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 16 13:09:48 2017 -0700

    RATIS-38. RaftClient should not retry on StateMachineException.

 .../apache/ratis/client/impl/ClientProtoUtils.java | 69 ++++++++++++++++++----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 22 ++++---
 .../org/apache/ratis/protocol/RaftClientReply.java | 32 +++++++---
 .../ratis/protocol/StateMachineException.java      |  2 +-
 .../main/java/org/apache/ratis/util/RaftUtils.java | 11 ++++
 .../java/org/apache/ratis/util/StringUtils.java    | 10 ++++
 .../TestRaftStateMachineException.java             |  2 +-
 .../java/org/apache/ratis/grpc/RaftGrpcUtil.java   | 24 +-------
 .../TestRaftReconfigurationWithHadoopRpc.java      |  9 +++
 ratis-proto-shaded/src/main/proto/Raft.proto       | 20 +++++--
 .../org/apache/ratis/server/impl/LeaderState.java  |  5 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |  2 +-
 .../apache/ratis/server/impl/PendingRequests.java  | 11 +++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  9 +--
 .../ratis/server/impl/StateMachineUpdater.java     |  4 +-
 15 files changed, 164 insertions(+), 68 deletions(-)

commit f1716ac43e9dcb49ce3be8628cfb0e849bedc8ce
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Mar 14 12:24:13 2017 -0700

    RATIS-39 Avoid using google guava.

 ratis-client/pom.xml                               |  6 ---
 .../main/java/org/apache/ratis/util/RaftUtils.java | 50 ++++++++++++++++++++++
 ratis-examples/pom.xml                             |  5 ---
 .../arithmetic/ArithmeticStateMachine.java         |  5 +--
 .../arithmetic/expression/BinaryExpression.java    |  6 +--
 .../arithmetic/expression/DoubleValue.java         |  6 +--
 .../examples/arithmetic/expression/Expression.java |  9 ++--
 .../examples/arithmetic/expression/NullValue.java  |  4 +-
 .../arithmetic/expression/UnaryExpression.java     |  6 +--
 .../examples/arithmetic/expression/Variable.java   |  7 ++-
 ratis-grpc/pom.xml                                 |  5 ---
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  4 +-
 .../apache/ratis/grpc/client/AppendStreamer.java   | 11 +++--
 .../grpc/client/RaftClientProtocolService.java     |  9 ++--
 .../apache/ratis/grpc/server/GRpcLogAppender.java  | 20 ++++-----
 ratis-hadoop/pom.xml                               |  5 ---
 .../apache/hadoop/ipc/ProtobufRpcEngineShaded.java | 11 -----
 ratis-netty/pom.xml                                |  5 ---
 .../java/org/apache/ratis/netty/NettyClient.java   |  8 ++--
 .../apache/ratis/netty/server/NettyRpcService.java |  6 +--
 ratis-server/pom.xml                               |  5 ---
 .../ratis/server/impl/ConfigurationManager.java    |  6 +--
 .../apache/ratis/server/impl/LeaderElection.java   | 26 ++++-------
 .../org/apache/ratis/server/impl/LeaderState.java  | 11 +++--
 .../org/apache/ratis/server/impl/LogAppender.java  |  7 ++-
 .../ratis/server/impl/PeerConfiguration.java       |  9 ++--
 .../apache/ratis/server/impl/PendingRequest.java   |  7 ++-
 .../apache/ratis/server/impl/PendingRequests.java  | 13 +++---
 .../ratis/server/impl/RaftConfiguration.java       | 42 ++++++++----------
 .../apache/ratis/server/impl/RaftServerImpl.java   | 19 ++++----
 .../org/apache/ratis/server/impl/ServerState.java  |  8 +---
 .../ratis/server/impl/StateMachineUpdater.java     |  9 ++--
 .../ratis/server/storage/LogInputStream.java       | 17 +++-----
 .../org/apache/ratis/server/storage/LogReader.java |  4 +-
 .../apache/ratis/server/storage/LogSegment.java    | 39 ++++++++---------
 .../apache/ratis/server/storage/MemoryRaftLog.java |  5 +--
 .../org/apache/ratis/server/storage/MetaFile.java  |  7 ++-
 .../org/apache/ratis/server/storage/RaftLog.java   |  5 +--
 .../apache/ratis/server/storage/RaftLogCache.java  | 17 +++-----
 .../apache/ratis/server/storage/RaftLogWorker.java | 22 +++++-----
 .../apache/ratis/server/storage/RaftStorage.java   |  4 +-
 .../ratis/server/storage/RaftStorageDirectory.java | 13 ++----
 .../ratis/server/storage/SegmentedRaftLog.java     |  8 ++--
 .../ratis/server/storage/SnapshotManager.java      |  4 +-
 .../statemachine/SimpleStateMachineStorage.java    |  4 --
 .../java/org/apache/ratis/MiniRaftCluster.java     |  5 +--
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  5 +--
 .../ratis/server/simulation/RaftServerReply.java   |  8 ++--
 .../server/simulation/SimulatedRequestReply.java   | 11 ++---
 .../server/simulation/SimulatedServerRpc.java      |  7 +--
 .../ratis/server/storage/TestRaftLogSegment.java   | 12 +++---
 .../statemachine/SimpleStateMachine4Testing.java   | 19 +++-----
 .../ratis/statemachine/TermIndexTracker.java       | 11 ++---
 53 files changed, 257 insertions(+), 320 deletions(-)

commit 6a755e66f89a8e100403cb6af5eb08b9ead3c324
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 9 16:33:02 2017 -0800

    RATIS-37. Change RaftServerConfigKeys to use SizeInBytes and TimeDuration. Contributed by Tsz Wo Nicholas Sze.

 .../java/org/apache/ratis/util/TimeDuration.java   |   4 +
 .../java/org/apache/ratis/TestBatchAppend.java     |   9 +-
 .../java/org/apache/ratis/TestRestartRaftPeer.java |   5 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 155 ++++++++++-----------
 .../org/apache/ratis/server/impl/LeaderState.java  |  13 +-
 .../org/apache/ratis/server/impl/LogAppender.java  |   9 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |   5 +-
 .../org/apache/ratis/server/impl/ServerState.java  |   2 +-
 .../ratis/server/impl/StateMachineUpdater.java     |   4 +-
 .../ratis/server/storage/LogOutputStream.java      |   6 +-
 .../apache/ratis/server/storage/RaftLogWorker.java |   2 +-
 .../apache/ratis/server/storage/RaftStorage.java   |   2 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |   2 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |   8 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |  26 ++--
 .../server/impl/RaftReconfigurationBaseTest.java   |   2 +-
 .../server/simulation/SimulatedRequestReply.java   |   7 +-
 .../TestNotLeaderExceptionWithSimulation.java      |   3 -
 .../ratis/server/storage/TestRaftLogReadWrite.java |  12 +-
 .../ratis/server/storage/TestRaftLogSegment.java   |  39 +++---
 .../ratis/server/storage/TestRaftStorage.java      |   3 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |  10 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |   4 +-
 .../ratis/statemachine/TestStateMachine.java       |   2 +-
 24 files changed, 160 insertions(+), 174 deletions(-)

commit 615e767247063434c94baf3ab69cae937611ab75
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 9 16:06:41 2017 -0800

    RATIS-35. Add SafeVarargs annotation for ConfUtils methods. Contributed by Tsz Wo Nicholas Sze.

 .../main/java/org/apache/ratis/conf/ConfUtils.java    | 19 +++++++++++--------
 .../ratis/util/TestTraditionalBinaryPrefix.java       |  2 +-
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java    |  2 +-
 3 files changed, 13 insertions(+), 10 deletions(-)

commit 4e5d0d7952484b7ca880b7ce4b7e9f557ba08654
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Mar 8 15:18:11 2017 -0800

    RATIS-36. Use ConfUtils for other ConfigKeys. Contributed by Tsz Wo Nicholas Sze.

 ratis-client/pom.xml                               |   1 -
 .../java/org/apache/ratis/client/RaftClient.java   |   7 +-
 .../apache/ratis/client/RaftClientConfigKeys.java  |  26 +++-
 .../apache/ratis/client/impl/ClientImplUtils.java  |   3 +-
 .../apache/ratis/client/impl/RaftClientImpl.java   |   7 +-
 .../main/java/org/apache/ratis/RaftConfigKeys.java |  15 +-
 .../main/java/org/apache/ratis/conf/ConfUtils.java | 108 +++++++++++---
 .../java/org/apache/ratis/conf/RaftProperties.java |  99 +++----------
 .../org/apache/ratis/util/CheckedBiConsumer.java   |  30 ++++
 .../java/org/apache/ratis/util/SizeInBytes.java    |  82 +++++++++++
 .../java/org/apache/ratis/util/TimeDuration.java   | 141 ++++++++++++++++++
 .../apache/ratis/util/TraditionalBinaryPrefix.java | 162 +++++++++++++++++++++
 .../org/apache/ratis/util/TestTimeDuration.java    |  84 +++++++++++
 .../ratis/util/TestTraditionalBinaryPrefix.java    | 145 ++++++++++++++++++
 ratis-grpc/pom.xml                                 |   2 -
 .../java/org/apache/ratis/grpc/GrpcConfigKeys.java |  96 ++++++++++++
 .../org/apache/ratis/grpc/RaftGRpcService.java     |   8 +-
 .../org/apache/ratis/grpc/RaftGrpcConfigKeys.java  |  47 ------
 .../apache/ratis/grpc/client/AppendStreamer.java   |  34 ++---
 .../apache/ratis/grpc/client/RaftOutputStream.java |  17 +--
 .../apache/ratis/grpc/server/GRpcLogAppender.java  |   6 +-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |   4 +-
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  12 +-
 ratis-hadoop/pom.xml                               |   1 -
 .../apache/ratis/hadooprpc/HadoopConfigKeys.java   |  37 ++---
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |   2 +-
 .../ratis/hadooprpc/server/HadoopRpcService.java   |   4 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |   6 +-
 .../org/apache/ratis/netty/NettyConfigKeys.java    |  18 +--
 .../apache/ratis/netty/server/NettyRpcService.java |   2 +-
 .../ratis/netty/MiniRaftClusterWithNetty.java      |   4 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |   2 +-
 32 files changed, 958 insertions(+), 254 deletions(-)

commit b5a07be08446f6c7148329b6b44a69199d62a49f
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Mar 6 15:42:17 2017 -0800

    RATIS-34. Use ConfUtils to get and set RaftServerConfigKeys. Contributed by Tsz Wo Nicholas Sze.

 .../main/java/org/apache/ratis/conf/ConfUtils.java | 181 ++++++++++++++---
 .../java/org/apache/ratis/TestBatchAppend.java     |  11 +-
 .../java/org/apache/ratis/TestRestartRaftPeer.java |   4 +-
 .../apache/ratis/hadooprpc/HadoopConfigKeys.java   |   4 +-
 ratis-netty/pom.xml                                |   1 -
 .../org/apache/ratis/netty/NettyConfigKeys.java    |  14 +-
 .../apache/ratis/server/RaftServerConfigKeys.java  | 214 ++++++++++++++++-----
 .../org/apache/ratis/server/impl/LeaderState.java  |  60 ++----
 .../org/apache/ratis/server/impl/LogAppender.java  |  62 +++---
 .../apache/ratis/server/impl/RaftServerImpl.java   |   8 +-
 .../org/apache/ratis/server/impl/ServerState.java  |  22 +--
 .../ratis/server/impl/StateMachineUpdater.java     |  12 +-
 .../ratis/server/storage/LogOutputStream.java      |  34 ++--
 .../apache/ratis/server/storage/RaftLogWorker.java |   7 +-
 .../apache/ratis/server/storage/RaftStorage.java   |   8 +-
 .../ratis/server/storage/SegmentedRaftLog.java     |  20 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  10 +-
 .../test/java/org/apache/ratis/RaftTestUtil.java   |   2 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |   6 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |   4 +-
 .../server/simulation/SimulatedRequestReply.java   |   2 +-
 .../ratis/server/storage/TestRaftLogReadWrite.java |  32 ++-
 .../ratis/server/storage/TestRaftLogSegment.java   |  26 ++-
 .../ratis/server/storage/TestRaftStorage.java      |   2 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |  27 ++-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  19 +-
 .../ratis/statemachine/TestStateMachine.java       |  37 ++--
 27 files changed, 494 insertions(+), 335 deletions(-)

commit 6adf89d481cc424716b12aa120e89b2a0fe921fb
Author: Mingliang Liu <liuml07@apache.org>
Date:   Fri Mar 3 18:58:11 2017 -0800

    RATIS-15. Add call ID to identify a client request and its retry. Contributed by Jing Zhao

 .../java/org/apache/ratis/client/RaftClient.java   |  1 -
 .../apache/ratis/client/impl/ClientProtoUtils.java | 24 +++++++++++-----------
 .../apache/ratis/client/impl/RaftClientImpl.java   | 13 ++++++++++--
 .../org/apache/ratis/protocol/RaftClientReply.java | 16 +++++++--------
 .../apache/ratis/protocol/RaftClientRequest.java   | 16 +++++++--------
 .../ratis/protocol/SetConfigurationRequest.java    |  4 ++--
 .../java/org/apache/ratis/util/ProtoUtils.java     |  4 ++--
 .../apache/ratis/grpc/client/AppendStreamer.java   |  6 +++---
 .../grpc/client/RaftClientProtocolService.java     | 22 ++++++++++----------
 .../apache/ratis/grpc/client/RaftOutputStream.java |  6 ++++--
 .../java/org/apache/ratis/netty/NettyRpcProxy.java | 14 ++++++-------
 .../apache/ratis/netty/server/NettyRpcService.java |  2 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  4 ++--
 .../ratis/server/impl/RaftServerConstants.java     |  4 +---
 .../apache/ratis/server/impl/RaftServerImpl.java   |  2 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java | 15 +++++++-------
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  6 +++---
 .../server/impl/RaftReconfigurationBaseTest.java   | 14 ++++++-------
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  4 ++--
 19 files changed, 92 insertions(+), 85 deletions(-)

commit 46116d412add72d761ebd6a9325362dc19227459
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Mar 3 17:30:18 2017 -0800

    RATIS-30. Provide a way to pass parameters to rpc implementations.

 .../main/java/org/apache/ratis/RaftConfigKeys.java |   3 +-
 .../java/org/apache/ratis/conf/Parameters.java     |  66 ++++++++++
 .../main/java/org/apache/ratis/rpc/RpcType.java    |   5 +-
 .../org/apache/ratis/rpc/SupportedRpcType.java     |   9 +-
 .../main/java/org/apache/ratis/util/RaftUtils.java |  44 ++++---
 .../ratis/examples/RaftExamplesTestUtil.java       |   2 +-
 .../java/org/apache/ratis/grpc/GrpcFactory.java    |   3 +
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  51 +++-----
 ...ServerConfigKeys.java => HadoopConfigKeys.java} |  40 ++++---
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |  25 +++-
 .../ratis/hadooprpc/server/HadoopRpcService.java   |   5 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  47 ++++----
 .../java/org/apache/ratis/netty/NettyFactory.java  |   3 +
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  24 ++--
 .../java/org/apache/ratis/server/RaftServer.java   |  12 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  12 +-
 .../apache/ratis/server/impl/ServerImplUtils.java  |  13 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 133 ++++++++++-----------
 .../server/impl/RaftReconfigurationBaseTest.java   |   2 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |  95 ++++++---------
 .../server/simulation/SimulatedRequestReply.java   |  11 +-
 .../ratis/server/simulation/SimulatedRpc.java      |  32 +++--
 22 files changed, 370 insertions(+), 267 deletions(-)

commit 5a94eac05810309436e316616fc40181aa892ae8
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Mar 2 14:33:24 2017 -0800

    RATIS-33. Protobuf gets compiled only when both activation conditions are triggered.

 BUILDING.md                | 10 +++++++---
 ratis-proto-shaded/pom.xml | 24 +++++++++++++-----------
 2 files changed, 20 insertions(+), 14 deletions(-)

commit fdbbdf98c0d5db82ba6fc2e78893bfd006040abe
Author: Mingliang Liu <liuml07@apache.org>
Date:   Tue Feb 28 15:46:18 2017 -0800

    RATIS-32. Rename RaftClientRequestSender to RaftClientRpc. Contributed by Tsz Wo Nicholas Sze

 .../java/org/apache/ratis/client/ClientFactory.java  |  4 ++--
 .../java/org/apache/ratis/client/RaftClient.java     | 16 ++++++++--------
 ...ftClientRequestSender.java => RaftClientRpc.java} |  4 ++--
 .../apache/ratis/client/impl/ClientImplUtils.java    | 11 +++++------
 .../org/apache/ratis/client/impl/RaftClientImpl.java | 20 ++++++++++----------
 .../main/java/org/apache/ratis/grpc/GrpcFactory.java |  6 +++---
 ...tClientSenderWithGrpc.java => GrpcClientRpc.java} |  8 ++++----
 .../org/apache/ratis/hadooprpc/HadoopFactory.java    |  6 +++---
 ...ClientRequestSender.java => HadoopClientRpc.java} |  6 +++---
 .../java/org/apache/ratis/netty/NettyFactory.java    |  6 +++---
 ...yClientRequestSender.java => NettyClientRpc.java} |  4 ++--
 .../test/java/org/apache/ratis/MiniRaftCluster.java  |  2 +-
 .../apache/ratis/RaftNotLeaderExceptionBaseTest.java |  6 +++---
 .../server/impl/RaftReconfigurationBaseTest.java     | 10 +++++-----
 .../simulation/MiniRaftClusterWithSimulatedRpc.java  |  4 ++--
 ...ientRequestReply.java => SimulatedClientRpc.java} |  8 ++++----
 .../apache/ratis/server/simulation/SimulatedRpc.java |  6 +++---
 17 files changed, 63 insertions(+), 64 deletions(-)

commit 392fa51415047b6e265a73d4ef175f1a468535b7
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Feb 28 15:13:42 2017 -0800

    RATIS-19. Include clientId and callId in log entries.

 .../java/org/apache/ratis/util/ProtoUtils.java     |  5 ++++-
 ratis-proto-shaded/src/main/proto/Raft.proto       |  5 +++++
 .../apache/ratis/server/impl/RaftServerImpl.java   |  3 ++-
 .../org/apache/ratis/server/impl/ServerState.java  |  6 ++++--
 .../org/apache/ratis/server/storage/RaftLog.java   |  8 +++++---
 .../ratis/server/storage/TestRaftLogCache.java     | 10 +++++++---
 .../ratis/server/storage/TestRaftLogReadWrite.java | 20 ++++++++++++++------
 .../ratis/server/storage/TestRaftLogSegment.java   | 22 +++++++++++++---------
 .../ratis/server/storage/TestSegmentedRaftLog.java |  7 +++++--
 9 files changed, 59 insertions(+), 27 deletions(-)

commit 8ac50a721505076dc3a7f7dc5416ed27a3273e8a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Feb 28 14:39:22 2017 -0800

    RATIS-22. Use a factory method to create RaftClientRequestSender.

 .../org/apache/ratis/client/ClientFactory.java     | 35 ++++++++++++++++++++++
 .../java/org/apache/ratis/client/RaftClient.java   | 21 +++++--------
 .../apache/ratis/client/impl/RaftClientImpl.java   | 24 +++++++--------
 .../org/apache/ratis/rpc/SupportedRpcType.java     |  2 +-
 .../main/java/org/apache/ratis/util/RaftUtils.java | 17 +++++++++++
 .../GrpcServerFactory.java => GrpcFactory.java}    | 13 ++++++--
 .../grpc/client/RaftClientSenderWithGrpc.java      | 19 ++++--------
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  7 -----
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |  9 +++++-
 .../client/HadoopClientRequestSender.java          |  5 +---
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  8 +----
 .../java/org/apache/ratis/netty/NettyFactory.java  |  9 +++++-
 .../netty/client/NettyClientRequestSender.java     | 16 +++-------
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  7 -----
 .../java/org/apache/ratis/MiniRaftCluster.java     | 11 ++++---
 .../MiniRaftClusterWithSimulatedRpc.java           |  9 ++----
 .../ratis/server/simulation/SimulatedRpc.java      | 12 ++++++--
 17 files changed, 126 insertions(+), 98 deletions(-)

commit 718fa9ea3e1b1a3f4f88150b7433857fa1ed1f1e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Feb 27 17:40:42 2017 -0800

    RATIS-31. Support customized RPC types.

 .../main/java/org/apache/ratis/RaftConfigKeys.java | 23 +++++---
 .../main/java/org/apache/ratis/conf/ConfUtils.java | 17 ++++++
 .../main/java/org/apache/ratis/rpc/RpcFactory.java | 22 ++++++++
 .../java/org/apache/ratis/{ => rpc}/RpcType.java   | 17 +++---
 .../org/apache/ratis/rpc/SupportedRpcType.java     | 44 +++++++++++++++
 .../main/java/org/apache/ratis/util/RaftUtils.java | 16 ++++++
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  6 +--
 .../ratis/grpc/server/GrpcServerFactory.java       |  9 +++-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  4 +-
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |  9 +++-
 .../ratis/hadooprpc/server/HadoopRpcService.java   |  6 +--
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  4 +-
 .../java/org/apache/ratis/netty/NettyFactory.java  |  9 +++-
 .../apache/ratis/netty/server/NettyRpcService.java | 19 ++++---
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  4 +-
 .../java/org/apache/ratis/server/RaftServer.java   | 17 +++---
 .../apache/ratis/server/RaftServerConfigKeys.java  | 42 ---------------
 .../org/apache/ratis/server/RaftServerRpc.java     |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 10 ++--
 .../apache/ratis/server/impl/ServerFactory.java    | 36 ++++---------
 .../MiniRaftClusterWithSimulatedRpc.java           |  6 +--
 .../ratis/server/simulation/SimulatedRpc.java      | 62 ++++++++++++++++++++++
 .../server/simulation/SimulatedServerRpc.java      | 29 +++++-----
 .../ratis/server/simulation/SimulationFactory.java | 41 --------------
 24 files changed, 269 insertions(+), 185 deletions(-)

commit f04ac8590e8f5f9dcd479087282696b3e574c5ac
Author: Enis Soztutar <enis@apache.org>
Date:   Fri Feb 24 10:49:32 2017 -0800

    RATIS-26 Flatten maven layout and compile shaded atifacts by default

 BUILD.md                     |  11 -
 BUILDING.md                  |  66 +++++
 pom.xml                      | 597 +++++++++++++++++++++++++++++++++++++++++--
 ratis-assembly/pom.xml       | 239 +++++++++++++++++
 ratis-client/pom.xml         |   5 +-
 ratis-common/pom.xml         |  19 +-
 ratis-examples/pom.xml       |  11 +-
 ratis-grpc/pom.xml           |   5 +-
 ratis-hadoop/pom.xml         |   9 +-
 ratis-netty/pom.xml          |  11 +-
 ratis-project-dist/pom.xml   | 169 ------------
 ratis-project/pom.xml        | 409 -----------------------------
 ratis-proto-shaded/README.md |  23 --
 ratis-proto-shaded/pom.xml   |  77 +++---
 ratis-server/pom.xml         |  11 +-
 15 files changed, 952 insertions(+), 710 deletions(-)

commit e0a90d788b583cdf5658ee246f0b7b00eae957b7
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Feb 24 16:20:13 2017 -0800

    RATIS-28 addendum: previous commit missing the interface changes.

 .../src/main/java/org/apache/ratis/RaftConfigKeys.java       | 12 ++++++------
 .../main/java/org/apache/ratis/netty/NettyConfigKeys.java    | 12 ++++++------
 2 files changed, 12 insertions(+), 12 deletions(-)

commit d7fb566c4a0571b92354f9bfb57cdb0a3cd315e4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Feb 24 16:17:19 2017 -0800

    RATIS-28. Create RaftServerRpc using ServerFactory.

 .../main/java/org/apache/ratis/RaftConfigKeys.java |  42 +++++++++
 .../main/java/org/apache/ratis/conf/ConfUtils.java |  21 +++--
 .../main/java/org/apache/ratis/util/NetUtils.java  |  16 +++-
 .../ratis/examples/RaftExamplesTestUtil.java       |   1 -
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  33 ++-----
 .../ratis/grpc/server/GrpcServerFactory.java       |  15 ++-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  64 ++++---------
 .../org/apache/ratis/hadooprpc/HadoopFactory.java  |  40 ++++++++
 .../server/HadoopRpcServerConfigKeys.java          |   2 +-
 .../ratis/hadooprpc/server/HadoopRpcService.java   |   7 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  61 ++++---------
 .../org/apache/ratis/netty/NettyConfigKeys.java    |  42 +++++++++
 .../java/org/apache/ratis/netty/NettyFactory.java  |  30 ++++++
 .../apache/ratis/netty/server/NettyRpcService.java |  10 +-
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  57 ++----------
 .../java/org/apache/ratis/server/RaftServer.java   |  11 ++-
 .../apache/ratis/server/RaftServerConfigKeys.java  |  11 +--
 .../org/apache/ratis/server/RaftServerRpc.java     |  23 +----
 .../ratis/server/impl/ConfigurationManager.java    |  11 +--
 .../apache/ratis/server/impl/RaftServerImpl.java   |  97 +++++++++-----------
 .../apache/ratis/server/impl/ServerFactory.java    |   7 +-
 .../org/apache/ratis/server/impl/ServerState.java  |   8 --
 .../java/org/apache/ratis/MiniRaftCluster.java     | 101 +++++++++------------
 .../MiniRaftClusterWithSimulatedRpc.java           |  44 +++++----
 .../simulation/SimulatedClientRequestReply.java    |  10 +-
 .../server/simulation/SimulatedRequestReply.java   |  14 +--
 .../ratis/server/simulation/SimulationFactory.java |  41 +++++++++
 27 files changed, 424 insertions(+), 395 deletions(-)

commit c7c4d114007f755202c7d92629e42d870105ff69
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Feb 22 18:21:53 2017 -0800

    RATIS-27. Use factory methods to create MiniRaftCluster.

 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java | 13 +++-------
 .../ratis/grpc/TestNotLeaderExceptionWithGrpc.java |  6 ++---
 .../grpc/TestRaftReconfigurationWithGRpc.java      |  2 +-
 .../ratis/grpc/TestRaftSnapshotWithGrpc.java       |  5 ++--
 .../java/org/apache/ratis/grpc/TestRaftStream.java |  8 +++---
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    |  3 ++-
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 11 +++++---
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    | 29 ++++++++++++++--------
 .../TestNotLeaderExceptionWithHadoopRpc.java       |  5 ++--
 .../TestRaftReconfigurationWithHadoopRpc.java      |  4 +--
 .../hadooprpc/TestRaftSnapshotWithHadoopRpc.java   |  5 ++--
 .../ratis/hadooprpc/TestRaftWithHadoopRpc.java     |  2 +-
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  6 +----
 .../netty/TestNotLeaderExceptionWithNetty.java     |  6 ++---
 .../netty/TestRaftReconfigurationWithNetty.java    |  2 +-
 .../ratis/netty/TestRaftSnapshotWithNetty.java     |  5 ++--
 .../org/apache/ratis/netty/TestRaftWithNetty.java  |  3 ++-
 .../java/org/apache/ratis/MiniRaftCluster.java     |  9 +++----
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  5 ++--
 .../MiniRaftClusterWithSimulatedRpc.java           | 13 +++++-----
 .../TestNotLeaderExceptionWithSimulation.java      |  5 ++--
 .../TestRaftReconfigurationWithSimulatedRpc.java   |  2 +-
 .../TestRaftSnapshotWithSimulatedRpc.java          |  5 ++--
 .../simulation/TestRaftWithSimulatedRpc.java       |  8 ++----
 .../ratis/statemachine/RaftSnapshotBaseTest.java   |  8 +++---
 .../ratis/statemachine/TestStateMachine.java       |  3 ++-
 26 files changed, 78 insertions(+), 95 deletions(-)

commit e2276879983e5fcb6942452e4037abc57d95a6ab
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Feb 22 14:26:02 2017 -0800

    RATIS-7. Code cleanup for SimpleStateMachine4Testing. Contributed by Garvit Bansal

 .../apache/ratis/statemachine/SimpleStateMachine4Testing.java  | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 3dcda9c1c8409845f324416c1fac6d4628bdff40
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Feb 21 14:17:23 2017 -0800

    RATIS-25. Fix Hadoop Rpc test javac error. Contributed by Tsz Wo Nicholas Sze.

 .../ratis/hadooprpc/TestNotLeaderExceptionWithHadoopRpc.java  |  9 ++-------
 .../ratis/hadooprpc/TestRaftReconfigurationWithHadoopRpc.java |  4 ++--
 .../org/apache/ratis/hadooprpc/TestRaftWithHadoopRpc.java     | 11 ++++-------
 3 files changed, 8 insertions(+), 16 deletions(-)

commit bcb806d1c1ca30214eb16a324d822088aaf6be37
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Feb 18 15:28:30 2017 -0800

    RATIS-24 Move out the Hadoop RPC config keys from RaftServerConfigKeys.

 .../main/java/org/apache/ratis/conf/ConfUtils.java | 50 ++++++++++++++++++
 .../server/HadoopRpcServerConfigKeys.java          | 56 ++++++++++++++++++++
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 20 ++-----
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  8 +--
 .../apache/ratis/server/RaftServerConfigKeys.java  | 61 ----------------------
 5 files changed, 115 insertions(+), 80 deletions(-)

commit 5565425f0e4ebc450051340522702465b37d97c6
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Feb 17 18:16:38 2017 -0800

    RATIS-18. A new leader should start serving client requests only after it commits the first leader-placeholder entry. Contributed by Jing Zhao.

 .../ratis/protocol/LeaderNotReadyException.java    | 34 +++++++++++++
 .../client/HadoopClientRequestSender.java          |  7 ++-
 .../org/apache/ratis/server/impl/LeaderState.java  | 13 ++++-
 .../apache/ratis/server/impl/RaftServerImpl.java   |  7 +++
 .../java/org/apache/ratis/MiniRaftCluster.java     |  3 ++
 .../server/impl/DelayLocalExecutionInjection.java  |  6 ++-
 .../server/impl/RaftReconfigurationBaseTest.java   | 56 +++++++++++++++++++++-
 7 files changed, 119 insertions(+), 7 deletions(-)

commit e1620e804c5be0fa735065631d45f2f6d8db4502
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Feb 16 17:05:28 2017 -0800

    RATIS-21. Add RpcType and ServerFactory. Contributed by Tsz Wo Nicholas Sze.

 .../src/main/java/org/apache/ratis/RpcType.java    | 34 +++++++++++++
 .../java/org/apache/ratis/conf/RaftProperties.java |  7 ++-
 .../main/java/org/apache/ratis/util/RaftUtils.java | 52 +++++++++++++++-----
 .../org/apache/ratis/grpc/RaftGRpcService.java     |  6 +++
 ...AppenderFactory.java => GrpcServerFactory.java} |  6 +--
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java | 14 +-----
 .../ratis/grpc/TestNotLeaderExceptionWithGrpc.java |  6 ---
 .../grpc/TestRaftReconfigurationWithGRpc.java      | 11 -----
 .../java/org/apache/ratis/grpc/TestRaftStream.java | 37 +++++----------
 .../org/apache/ratis/grpc/TestRaftWithGrpc.java    | 11 -----
 .../ratis/hadooprpc/server/HadoopRpcService.java   |  6 +++
 .../apache/ratis/netty/server/NettyRpcService.java |  6 +++
 .../apache/ratis/server/RaftServerConfigKeys.java  | 46 ++++++++++++++++--
 .../org/apache/ratis/server/RaftServerRpc.java     |  3 +-
 .../org/apache/ratis/server/impl/LeaderState.java  |  6 +--
 .../ratis/server/impl/LogAppenderFactory.java      | 31 ------------
 .../apache/ratis/server/impl/RaftServerImpl.java   | 22 ++++-----
 .../apache/ratis/server/impl/ServerFactory.java    | 55 ++++++++++++++++++++++
 .../server/simulation/SimulatedServerRpc.java      |  6 +++
 19 files changed, 228 insertions(+), 137 deletions(-)

commit 16eb8cc6be5dfe06ab3cdd67250af16bd790f6ff
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Feb 16 15:21:06 2017 -0800

    RATIS-13. Add global unique ID for Raft Client. Contributed by Jing Zhao.

 .../java/org/apache/ratis/client/RaftClient.java   | 18 +++---
 .../apache/ratis/client/impl/ClientImplUtils.java  |  9 ++-
 .../apache/ratis/client/impl/ClientProtoUtils.java | 49 +++++++++-----
 .../apache/ratis/client/impl/RaftClientImpl.java   | 27 ++++----
 .../java/org/apache/ratis/protocol/ClientId.java   | 73 +++++++++++++++++++++
 .../apache/ratis/protocol/NotLeaderException.java  |  2 +-
 .../apache/ratis/protocol/RaftClientMessage.java   | 51 +++++++++++++++
 .../org/apache/ratis/protocol/RaftClientReply.java | 26 +++-----
 .../apache/ratis/protocol/RaftClientRequest.java   | 30 +++------
 .../java/org/apache/ratis/protocol/RaftPeer.java   | 10 +--
 .../java/org/apache/ratis/protocol/RaftPeerId.java | 74 ++++++++++++++++++++++
 .../org/apache/ratis/protocol/RaftRpcMessage.java  | 14 ++--
 .../ratis/protocol/SetConfigurationRequest.java    |  4 +-
 .../apache/ratis/util/CodeInjectionForTesting.java |  6 +-
 .../java/org/apache/ratis/util/PeerProxyMap.java   |  7 +-
 .../java/org/apache/ratis/util/ProtoUtils.java     |  5 +-
 .../main/java/org/apache/ratis/util/RaftUtils.java | 22 +++++++
 .../java/org/apache/ratis/util/StringUtils.java    | 22 -------
 .../arithmetic/ArithmeticStateMachine.java         |  9 +--
 .../java/org/apache/ratis/TestBatchAppend.java     | 11 ++--
 .../java/org/apache/ratis/TestRestartRaftPeer.java |  9 ++-
 .../ratis/examples/arithmetic/TestArithmetic.java  |  7 +-
 .../TestRaftStateMachineException.java             |  7 +-
 .../org/apache/ratis/grpc/RaftGRpcService.java     | 20 +++---
 .../apache/ratis/grpc/client/AppendStreamer.java   | 33 +++++-----
 .../grpc/client/RaftClientProtocolService.java     |  5 +-
 .../grpc/client/RaftClientSenderWithGrpc.java      |  3 +-
 .../apache/ratis/grpc/client/RaftOutputStream.java |  8 ++-
 .../grpc/server/RaftServerProtocolService.java     |  5 +-
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java |  9 ++-
 .../java/org/apache/ratis/grpc/TestRaftStream.java | 11 ++--
 .../client/HadoopClientRequestSender.java          |  2 +-
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 16 ++---
 .../netty/client/NettyClientRequestSender.java     |  3 +-
 .../apache/ratis/netty/server/NettyRpcService.java | 17 +++--
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  3 +-
 ratis-proto-shaded/src/main/proto/Raft.proto       | 10 +--
 .../java/org/apache/ratis/server/RaftServer.java   | 14 ++--
 .../apache/ratis/server/impl/LeaderElection.java   |  5 +-
 .../org/apache/ratis/server/impl/LeaderState.java  | 11 ++--
 .../ratis/server/impl/PeerConfiguration.java       | 17 ++---
 .../ratis/server/impl/RaftConfiguration.java       | 18 +++---
 .../apache/ratis/server/impl/RaftServerImpl.java   | 42 ++++++------
 .../apache/ratis/server/impl/ServerImplUtils.java  |  5 +-
 .../apache/ratis/server/impl/ServerProtoUtils.java | 38 ++++++-----
 .../org/apache/ratis/server/impl/ServerState.java  | 29 +++++----
 .../apache/ratis/server/storage/MemoryRaftLog.java |  5 +-
 .../org/apache/ratis/server/storage/RaftLog.java   | 15 +++--
 .../ratis/server/storage/SegmentedRaftLog.java     | 13 ++--
 .../ratis/server/storage/SnapshotManager.java      |  5 +-
 .../ratis/statemachine/BaseStateMachine.java       |  9 +--
 .../apache/ratis/statemachine/StateMachine.java    |  5 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 36 ++++++-----
 .../test/java/org/apache/ratis/RaftBasicTests.java | 13 ++--
 .../ratis/RaftNotLeaderExceptionBaseTest.java      | 20 +++---
 .../test/java/org/apache/ratis/RaftTestUtil.java   | 20 +++---
 .../server/impl/BlockRequestHandlingInjection.java |  9 +--
 .../server/impl/DelayLocalExecutionInjection.java  | 12 ++--
 .../server/impl/RaftReconfigurationBaseTest.java   | 58 +++++++++--------
 .../ratis/server/impl/RaftServerTestUtil.java      |  6 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |  7 +-
 .../ratis/server/simulation/RaftServerReply.java   | 14 ++--
 .../ratis/server/simulation/RaftServerRequest.java | 14 ++--
 .../server/simulation/SimulatedRequestReply.java   |  5 +-
 .../server/simulation/SimulatedServerRpc.java      |  4 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |  3 +-
 .../ratis/statemachine/RaftSnapshotBaseTest.java   | 18 +++---
 .../statemachine/SimpleStateMachine4Testing.java   |  6 +-
 .../ratis/statemachine/TestStateMachine.java       |  3 +-
 69 files changed, 676 insertions(+), 440 deletions(-)

commit 58ab69a808597e2971b5e1f261c7d3dc19097e7b
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Feb 1 14:49:29 2017 -0800

    RATIS-2. Change version to 0.1-SNAPSHOT. Contributed by Jing Zhao.

 pom.xml                    | 2 +-
 ratis-client/pom.xml       | 2 +-
 ratis-common/pom.xml       | 2 +-
 ratis-examples/pom.xml     | 2 +-
 ratis-grpc/pom.xml         | 2 +-
 ratis-hadoop/pom.xml       | 2 +-
 ratis-netty/pom.xml        | 2 +-
 ratis-project-dist/pom.xml | 4 ++--
 ratis-project/pom.xml      | 2 +-
 ratis-proto-shaded/pom.xml | 2 +-
 ratis-server/pom.xml       | 2 +-
 11 files changed, 12 insertions(+), 12 deletions(-)

commit 349f29ceefa452cb5212d2aae05e0290de3bbb88
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Thu Feb 9 12:53:14 2017 -0800

    Updated LICENSE.txt
    
    (cherry picked from commit 3d71132d7c18ff64077c277e15ffeef99cec6cb5)

 LICENSE.txt | 505 ------------------------------------------------------------
 1 file changed, 505 deletions(-)

commit 813db4b7847891bb76164fd663a732927d7d25a4
Merge: d960d1e7 d16c5c64
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Tue Jan 31 13:15:45 2017 -0800

    Initial code.

commit d960d1e7f467ee2a13b2c37be3a9f378ada6ae28
Author: Jitendra Pandey <jitendra@apache.org>
Date:   Tue Jan 31 11:09:52 2017 -0800

    License file added.

 LICENSE.txt | 909 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 909 insertions(+)

commit d16c5c649311c8af3340c3373593821ba67d467f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jan 31 23:54:26 2017 +0800

    Add builder classes for RaftServerRpc and its implementations.

 .../org/apache/ratis/grpc/RaftGRpcService.java     | 65 ++++++++++++++++------
 .../apache/ratis/grpc/MiniRaftClusterWithGRpc.java | 10 +++-
 .../ratis/hadooprpc/server/HadoopRpcService.java   | 47 ++++++++++++----
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    | 10 +++-
 .../apache/ratis/netty/server/NettyRpcService.java | 23 +++++++-
 .../ratis/netty/MiniRaftClusterWithNetty.java      |  2 +-
 .../org/apache/ratis/server/RaftServerRpc.java     | 35 ++++++++++++
 7 files changed, 159 insertions(+), 33 deletions(-)

commit 9c44237880ae2c772d58f036708b0bd3f6b013a8
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Jan 25 15:48:43 2017 -0800

    Update default raft log segment size.

 .../src/main/java/org/apache/ratis/server/RaftServerConfigKeys.java   | 4 ++--
 .../src/main/java/org/apache/ratis/server/storage/LogSegment.java     | 4 ++--
 .../src/main/java/org/apache/ratis/server/storage/RaftLogWorker.java  | 1 -
 3 files changed, 4 insertions(+), 5 deletions(-)

commit 0fed3078dd04c799067e856fb191fb0244a0f544
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 13 15:47:28 2017 +0800

    Add a Builder for RaftServer.

 .../apache/ratis/client/impl/ClientImplUtils.java  |  2 +-
 .../ratis/examples/RaftExamplesTestUtil.java       |  9 ++++
 .../java/org/apache/ratis/server/RaftServer.java   | 54 ++++++++++++++++++++++
 .../ratis/server/impl/ConfigurationManager.java    |  2 +-
 .../apache/ratis/server/impl/RaftServerImpl.java   | 10 ++--
 .../{ServerUtils.java => ServerImplUtils.java}     | 22 ++++++++-
 .../apache/ratis/server/protocol/TermIndex.java    |  4 +-
 .../java/org/apache/ratis/MiniRaftCluster.java     | 19 +++++---
 .../ratis/server/impl/RaftServerTestUtil.java      |  5 +-
 .../ratis/server/storage/TestSegmentedRaftLog.java |  5 +-
 .../statemachine/SimpleStateMachine4Testing.java   |  2 +-
 .../ratis/statemachine/TestStateMachine.java       |  2 +-
 12 files changed, 112 insertions(+), 24 deletions(-)

commit 336874fa36cd040df2d698bfc1030983ab3d0331
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 13 09:48:27 2017 +0800

    Add a Builder for RaftClient.

 .../java/org/apache/ratis/client/RaftClient.java   | 76 +++++++++++++++++++++-
 .../apache/ratis/client/impl/ClientImplUtils.java  | 33 ++++++++++
 .../apache/ratis/client/impl/RaftClientImpl.java   | 21 ++----
 .../java/org/apache/ratis/MiniRaftCluster.java     | 15 +++--
 .../ratis/RaftNotLeaderExceptionBaseTest.java      |  9 ++-
 .../server/impl/RaftReconfigurationBaseTest.java   | 41 +++++-------
 6 files changed, 145 insertions(+), 50 deletions(-)

commit 7e71a2e0e8ffb01a2168fabdf1d2f66f6ba7c4b9
Author: Enis Soztutar <enis@apache.org>
Date:   Fri Jan 6 15:36:48 2017 -0800

    Renamed the packages from raft to ratis in preperation for Apache Incubation
     - Moved all java packages from org.apache.raft to org.apache.ratis.
     - Moved native package to org_apache_ratis, and native lib to libratis.
     - Moved all modules raft-foo to ratis-foo.
     - Moved artifact classes from com.hortonworks.raft to org.apache.ratis.
     - Individual names for classes (RaftServer, etc) is kept as it is.
     - Usage of "raft" in referring to the protocol is kept as it is.
     - Changed references to previously used name Concur to Ratis.

 README.md                                          |   6 +-
 pom.xml                                            |  14 +--
 {raft-client => ratis-client}/pom.xml              |  18 ++--
 .../java/org/apache/ratis}/client/RaftClient.java  |   8 +-
 .../apache/ratis}/client/RaftClientConfigKeys.java |   2 +-
 .../ratis}/client/RaftClientRequestSender.java     |  10 +-
 .../ratis}/client/impl/ClientProtoUtils.java       |  10 +-
 .../apache/ratis}/client/impl/RaftClientImpl.java  |  17 +--
 .../RatisCommon.cmake                              |  36 +++----
 .../RaftJNI.cmake => ratis-common/RatisJNI.cmake   |   0
 {raft-common => ratis-common}/pom.xml              |  18 ++--
 {raft-common => ratis-common}/src/CMakeLists.txt   |  28 ++---
 {raft-common => ratis-common}/src/config.h.cmake   |   0
 .../src/main/conf/log4j.properties                 |  22 ++--
 .../org/apache/ratis}/conf/RaftProperties.java     |   5 +-
 .../main/java/org/apache/ratis}/io/MD5Hash.java    |   2 +-
 .../java/org/apache/ratis}/io/nativeio/Errno.java  |   2 +-
 .../org/apache/ratis}/io/nativeio/NativeIO.java    |   9 +-
 .../ratis}/io/nativeio/NativeIOException.java      |   6 +-
 .../ratis}/protocol/AlreadyExistsException.java    |   2 +-
 .../apache/ratis}/protocol/ChecksumException.java  |   2 +-
 .../java/org/apache/ratis}/protocol/Message.java   |   4 +-
 .../apache/ratis}/protocol/NotLeaderException.java |   2 +-
 .../protocol/RaftClientAsynchronousProtocol.java   |   2 +-
 .../apache/ratis}/protocol/RaftClientProtocol.java |   2 +-
 .../apache/ratis}/protocol/RaftClientReply.java    |   2 +-
 .../apache/ratis}/protocol/RaftClientRequest.java  |   2 +-
 .../org/apache/ratis}/protocol/RaftException.java  |   2 +-
 .../java/org/apache/ratis}/protocol/RaftPeer.java  |   2 +-
 .../org/apache/ratis}/protocol/RaftRpcMessage.java |   2 +-
 .../ReconfigurationInProgressException.java        |   2 +-
 .../protocol/ReconfigurationTimeoutException.java  |   2 +-
 .../ratis}/protocol/SetConfigurationRequest.java   |   2 +-
 .../ratis}/protocol/StateMachineException.java     |   2 +-
 .../apache/ratis}/util/AtomicFileOutputStream.java |   6 +-
 .../org/apache/ratis}/util/AutoCloseableLock.java  |   2 +-
 .../org/apache/ratis}/util/CheckedFunction.java    |   2 +-
 .../org/apache/ratis}/util/CheckedRunnable.java    |   2 +-
 .../ratis}/util/CodeInjectionForTesting.java       |   2 +-
 .../main/java/org/apache/ratis}/util/Daemon.java   |   2 +-
 .../java/org/apache/ratis}/util/ExitUtils.java     |   2 +-
 .../java/org/apache/ratis}/util/FileUtils.java     |   4 +-
 .../java/org/apache/ratis}/util/LifeCycle.java     |   2 +-
 .../java/org/apache/ratis}/util/MD5FileUtil.java   |   5 +-
 .../org/apache/ratis}/util/NativeCodeLoader.java   |  30 +++---
 .../java/org/apache/ratis}/util/NativeCrc32.java   |   5 +-
 .../apache/ratis}/util/NativeLibraryChecker.java   |  14 +--
 .../main/java/org/apache/ratis}/util/NetUtils.java |   2 +-
 .../java/org/apache/ratis}/util/PeerProxyMap.java  |   5 +-
 .../java/org/apache/ratis}/util/ProtoUtils.java    |  18 ++--
 .../java/org/apache/ratis}/util/PureJavaCrc32.java |   2 +-
 .../org/apache/ratis}/util/PureJavaCrc32C.java     |   2 +-
 .../java/org/apache/ratis}/util/RaftUtils.java     |   2 +-
 .../java/org/apache/ratis}/util/StringUtils.java   |   2 +-
 .../java/org/apache/ratis}/util/Timestamp.java     |   2 +-
 .../src/main/native/src/exception.c                |   0
 .../src/main/native/src/exception.h                |   6 +-
 .../src/org/apache/ratis}/io/nativeio/NativeIO.c   |  78 +++++++-------
 .../src/org/apache/ratis}/io/nativeio/errno_enum.c |   4 +-
 .../src/org/apache/ratis}/io/nativeio/errno_enum.h |   0
 .../apache/ratis}/io/nativeio/file_descriptor.c    |   2 +-
 .../apache/ratis}/io/nativeio/file_descriptor.h    |   2 +-
 .../src/org/apache/ratis}/util/NativeCodeLoader.c  |   8 +-
 .../src/org/apache/ratis}/util/NativeCrc32.c       |  18 ++--
 .../native/src/org/apache/ratis}/util/bulk_crc32.c |   2 +-
 .../native/src/org/apache/ratis}/util/bulk_crc32.h |   0
 .../org/apache/ratis}/util/bulk_crc32_aarch64.c    |   0
 .../src/org/apache/ratis}/util/bulk_crc32_x86.c    |   0
 .../ratis}/util/crc32_zlib_polynomial_tables.h     |   0
 .../src/org/apache/ratis}/util/crc32c_tables.h     |   0
 .../src/org/apache/ratis}/util/gcc_optimizations.h |   0
 .../src/main/native/src/org_apache_ratis.h         |   6 +-
 .../test/org/apache/ratis}/util/test_bulk_crc32.c  |   2 +-
 .../java/org/apache/ratis}/util/TestLifeCycle.java |   7 +-
 {raft-examples => ratis-examples}/pom.xml          |  62 +++++------
 .../arithmetic/ArithmeticStateMachine.java         |  25 ++---
 .../examples/arithmetic/AssignmentMessage.java     |  12 +--
 .../ratis}/examples/arithmetic/Evaluable.java      |   2 +-
 .../arithmetic/expression/BinaryExpression.java    |   2 +-
 .../arithmetic/expression/DoubleValue.java         |   2 +-
 .../examples/arithmetic/expression/Expression.java |   9 +-
 .../examples/arithmetic/expression/NullValue.java  |   2 +-
 .../arithmetic/expression/UnaryExpression.java     |   2 +-
 .../examples/arithmetic/expression/Variable.java   |   5 +-
 .../java/org/apache/ratis}/TestBatchAppend.java    |  26 ++---
 .../org/apache/ratis}/TestRestartRaftPeer.java     |  26 ++---
 .../ratis}/examples/RaftExamplesTestUtil.java      |  16 +--
 .../ratis}/examples/arithmetic/TestArithmetic.java |  18 ++--
 .../arithmetic/expression/TestExpression.java      |   7 +-
 .../TestRaftStateMachineException.java             |  24 +++--
 .../src/test/resources/log4j.properties            |   0
 {raft-grpc => ratis-grpc}/pom.xml                  |  38 +++----
 .../org/apache/ratis}/grpc/RaftGRpcService.java    |  33 +++---
 .../org/apache/ratis}/grpc/RaftGrpcConfigKeys.java |   4 +-
 .../java/org/apache/ratis}/grpc/RaftGrpcUtil.java  |  10 +-
 .../apache/ratis}/grpc/client/AppendStreamer.java  |  37 +++----
 .../grpc/client/RaftClientProtocolClient.java      |  26 ++---
 .../grpc/client/RaftClientProtocolProxy.java       |  10 +-
 .../grpc/client/RaftClientProtocolService.java     |  21 ++--
 .../grpc/client/RaftClientSenderWithGrpc.java      |  32 +++---
 .../ratis}/grpc/client/RaftOutputStream.java       |  12 +--
 .../apache/ratis}/grpc/server/GRpcLogAppender.java |  35 ++++---
 .../grpc/server/PipelinedLogAppenderFactory.java   |  12 +--
 .../grpc/server/RaftServerProtocolClient.java      |  18 ++--
 .../grpc/server/RaftServerProtocolService.java     |  17 +--
 .../ratis}/grpc/MiniRaftClusterWithGRpc.java       |  33 +++---
 .../grpc/TestNotLeaderExceptionWithGrpc.java       |  16 +--
 .../grpc/TestRaftReconfigurationWithGRpc.java      |  16 +--
 .../ratis}/grpc/TestRaftSnapshotWithGrpc.java      |   8 +-
 .../org/apache/ratis}/grpc/TestRaftStream.java     |  28 ++---
 .../org/apache/ratis}/grpc/TestRaftWithGrpc.java   |  18 ++--
 .../src/test/resources/log4j.properties            |   0
 {raft-hadoop => ratis-hadoop}/pom.xml              |  38 +++----
 .../apache/hadoop/ipc/ProtobufRpcEngineShaded.java | 114 ++++++++++-----------
 .../apache/ratis}/hadooprpc/HadoopConstants.java   |   2 +-
 .../java/org/apache/ratis}/hadooprpc/Proxy.java    |   4 +-
 .../client/HadoopClientRequestSender.java          |   8 +-
 .../RaftClientProtocolClientSideTranslatorPB.java  |  28 ++---
 .../hadooprpc/client/RaftClientProtocolPB.java     |   6 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |  26 ++---
 .../ratis}/hadooprpc/server/HadoopRpcService.java  |  48 +++++----
 .../hadooprpc/server/RaftServerProtocolPB.java     |   6 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |  19 ++--
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  22 ++--
 .../TestNotLeaderExceptionWithHadoopRpc.java       |  10 +-
 .../TestRaftReconfigurationWithHadoopRpc.java      |   8 +-
 .../hadooprpc/TestRaftSnapshotWithHadoopRpc.java   |   8 +-
 .../ratis}/hadooprpc/TestRaftWithHadoopRpc.java    |  18 ++--
 .../src/test/resources/log4j.properties            |   0
 {raft-netty => ratis-netty}/pom.xml                |  38 +++----
 .../java/org/apache/ratis}/netty/NettyClient.java  |   7 +-
 .../org/apache/ratis}/netty/NettyRpcProxy.java     |  40 +++++---
 .../netty/client/NettyClientRequestSender.java     |  24 ++---
 .../ratis}/netty/server/NettyRpcService.java       |  37 +++----
 .../ratis}/netty/MiniRaftClusterWithNetty.java     |  24 ++---
 .../netty/TestNotLeaderExceptionWithNetty.java     |   8 +-
 .../netty/TestRaftReconfigurationWithNetty.java    |   8 +-
 .../ratis}/netty/TestRaftSnapshotWithNetty.java    |   8 +-
 .../org/apache/ratis}/netty/TestRaftWithNetty.java |  12 +--
 .../src/test/resources/log4j.properties            |   0
 {raft-project-dist => ratis-project-dist}/pom.xml  |  16 +--
 {raft-project => ratis-project}/pom.xml            |  80 +++++++--------
 .../.gitignore                                     |   0
 .../README.md                                      |  14 +--
 {raft-proto-shaded => ratis-proto-shaded}/pom.xml  |  16 +--
 .../src/main/proto/GRpc.proto                      |  24 ++---
 .../src/main/proto/Hadoop.proto                    |  24 ++---
 .../src/main/proto/Netty.proto                     |  24 ++---
 .../src/main/proto/Raft.proto                      |   4 +-
 ...che.ratis.shaded.io.grpc.ManagedChannelProvider |   2 +-
 ...pache.ratis.shaded.io.grpc.NameResolverProvider |   2 +-
 .../org.apache.ratis.shaded.io.grpc.ServerProvider |   2 +-
 {raft-server => ratis-server}/pom.xml              |  30 +++---
 .../java/org/apache/ratis}/server/RaftServer.java  |  10 +-
 .../apache/ratis}/server/RaftServerConfigKeys.java |   6 +-
 .../org/apache/ratis}/server/RaftServerRpc.java    |   6 +-
 .../ratis}/server/impl/ConfigurationManager.java   |   2 +-
 .../apache/ratis}/server/impl/FollowerInfo.java    |   8 +-
 .../apache/ratis}/server/impl/FollowerState.java   |   6 +-
 .../apache/ratis}/server/impl/LeaderElection.java  |  36 ++++---
 .../org/apache/ratis}/server/impl/LeaderState.java |  51 ++++++---
 .../org/apache/ratis}/server/impl/LogAppender.java |  50 +++++----
 .../ratis}/server/impl/LogAppenderFactory.java     |   2 +-
 .../ratis}/server/impl/PeerConfiguration.java      |   5 +-
 .../apache/ratis}/server/impl/PendingRequest.java  |  13 +--
 .../apache/ratis}/server/impl/PendingRequests.java |   7 +-
 .../ratis}/server/impl/RaftConfiguration.java      |   5 +-
 .../ratis}/server/impl/RaftServerConstants.java    |   4 +-
 .../apache/ratis}/server/impl/RaftServerImpl.java  |  63 ++++++++----
 .../ratis}/server/impl/ServerProtoUtils.java       |  26 +++--
 .../org/apache/ratis}/server/impl/ServerState.java |  33 +++---
 .../org/apache/ratis}/server/impl/ServerUtils.java |   4 +-
 .../ratis}/server/impl/StateMachineUpdater.java    |  37 +++----
 .../ratis}/server/protocol/RaftServerProtocol.java |  11 +-
 .../apache/ratis}/server/protocol/TermIndex.java   |   4 +-
 .../ratis}/server/storage/BufferedChannelBase.java |   2 +-
 .../server/storage/BufferedWriteChannel.java       |   2 +-
 .../org/apache/ratis}/server/storage/FileInfo.java |   6 +-
 .../ratis}/server/storage/LogInputStream.java      |  17 +--
 .../ratis}/server/storage/LogOutputStream.java     |  27 +++--
 .../apache/ratis}/server/storage/LogReader.java    |  34 +++---
 .../apache/ratis}/server/storage/LogSegment.java   |  17 +--
 .../ratis}/server/storage/MemoryRaftLog.java       |  19 ++--
 .../org/apache/ratis}/server/storage/MetaFile.java |   7 +-
 .../org/apache/ratis}/server/storage/RaftLog.java  |  29 +++---
 .../apache/ratis}/server/storage/RaftLogCache.java |  23 +++--
 .../ratis}/server/storage/RaftLogWorker.java       |  35 ++++---
 .../apache/ratis}/server/storage/RaftStorage.java  |  21 ++--
 .../server/storage/RaftStorageDirectory.java       |   9 +-
 .../ratis}/server/storage/SegmentedRaftLog.java    |  29 +++---
 .../ratis}/server/storage/SnapshotManager.java     |  27 ++---
 .../ratis}/statemachine/BaseStateMachine.java      |  23 +++--
 .../ratis}/statemachine/FileListSnapshotInfo.java  |   8 +-
 .../statemachine/SimpleStateMachineStorage.java    |  15 +--
 .../statemachine/SingleFileSnapshotInfo.java       |   6 +-
 .../apache/ratis}/statemachine/SnapshotInfo.java   |   8 +-
 .../apache/ratis}/statemachine/StateMachine.java   |  20 ++--
 .../ratis}/statemachine/StateMachineStorage.java   |   5 +-
 .../ratis}/statemachine/TransactionContext.java    |  10 +-
 .../java/org/apache/ratis}/MiniRaftCluster.java    |  41 ++++----
 .../java/org/apache/ratis}/RaftBasicTests.java     |  16 +--
 .../ratis}/RaftNotLeaderExceptionBaseTest.java     |  28 ++---
 .../test/java/org/apache/ratis}/RaftTestUtil.java  |  33 +++---
 .../server/impl/BlockRequestHandlingInjection.java |   7 +-
 .../server/impl/DelayLocalExecutionInjection.java  |   6 +-
 .../server/impl/RaftReconfigurationBaseTest.java   |  56 +++++-----
 .../ratis}/server/impl/RaftServerTestUtil.java     |  14 +--
 .../MiniRaftClusterWithSimulatedRpc.java           |  12 +--
 .../ratis}/server/simulation/RaftServerReply.java  |  11 +-
 .../server/simulation/RaftServerRequest.java       |  10 +-
 .../ratis}/server/simulation/RequestHandler.java   |   8 +-
 .../simulation/SimulatedClientRequestReply.java    |  10 +-
 .../server/simulation/SimulatedRequestReply.java   |  15 +--
 .../server/simulation/SimulatedServerRpc.java      |  28 +++--
 .../TestNotLeaderExceptionWithSimulation.java      |   8 +-
 .../TestRaftReconfigurationWithSimulatedRpc.java   |   8 +-
 .../TestRaftSnapshotWithSimulatedRpc.java          |   8 +-
 .../simulation/TestRaftWithSimulatedRpc.java       |  12 +--
 .../ratis}/server/storage/TestRaftLogCache.java    |  14 +--
 .../server/storage/TestRaftLogReadWrite.java       |  39 +++----
 .../ratis}/server/storage/TestRaftLogSegment.java  |  38 +++----
 .../ratis}/server/storage/TestRaftStorage.java     |  25 +++--
 .../server/storage/TestSegmentedRaftLog.java       |  38 +++----
 .../ratis}/statemachine/RaftSnapshotBaseTest.java  |  53 +++++-----
 .../statemachine/SimpleStateMachine4Testing.java   |  49 ++++-----
 .../ratis}/statemachine/TermIndexTracker.java      |   9 +-
 .../ratis}/statemachine/TestStateMachine.java      |  40 +++++---
 .../src/test/resources/log4j.properties            |   0
 228 files changed, 1801 insertions(+), 1589 deletions(-)

commit bdd516434a39714632dc4e563ed055348ef84c4f
Author: Enis Soztutar <enis@apache.org>
Date:   Fri Jan 6 14:15:14 2017 -0800

    Small fixes to RaftServer and StateMachine related interfaces after recent refactorings

 raft-server/pom.xml                                                | 1 -
 raft-server/src/main/java/org/apache/raft/server/RaftServer.java   | 7 +++++++
 .../src/main/java/org/apache/raft/server/impl/RaftServerImpl.java  | 3 ++-
 .../src/main/java/org/apache/raft/statemachine/StateMachine.java   | 5 +++++
 .../main/java/org/apache/raft/statemachine/TransactionContext.java | 2 +-
 5 files changed, 15 insertions(+), 3 deletions(-)

commit f58b5ef8f8f96ad640ff1b6b2d707f21712ec87a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 6 16:03:30 2017 +0800

    Refactor SnapshotInfo and its implementations.

 .../arithmetic/ArithmeticStateMachine.java         |  1 -
 .../org/apache/raft/server/storage/FileInfo.java   | 11 +++++--
 ...shotInfoImpl.java => FileListSnapshotInfo.java} | 28 +++++++---------
 .../statemachine/SimpleStateMachineStorage.java    | 18 ++--------
 .../raft/statemachine/SingleFileSnapshotInfo.java  | 38 ++++++++++++++++++++++
 .../org/apache/raft/statemachine/SnapshotInfo.java |  7 ----
 .../statemachine/SimpleStateMachine4Testing.java   |  1 -
 7 files changed, 61 insertions(+), 43 deletions(-)

commit 594605829133f98d51b16d42fd0596fa26bde6d2
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jan 6 14:44:36 2017 +0800

    Convert TermIndex to an interface.

 .../arithmetic/ArithmeticStateMachine.java         |  2 +-
 .../apache/raft/server/impl/ServerProtoUtils.java  |  5 +-
 .../org/apache/raft/server/impl/ServerUtils.java   | 81 ++++++++++++++++++++++
 .../org/apache/raft/server/protocol/TermIndex.java | 58 +++-------------
 .../org/apache/raft/server/storage/RaftLog.java    |  3 +-
 .../statemachine/SimpleStateMachineStorage.java    |  2 +-
 .../apache/raft/statemachine/SnapshotInfoImpl.java |  2 +-
 .../statemachine/SimpleStateMachine4Testing.java   |  7 +-
 .../apache/raft/statemachine/TermIndexTracker.java |  2 +-
 9 files changed, 104 insertions(+), 58 deletions(-)

commit 8dbb64fbae8f85170b4e1494cc9b1d4fcd98b513
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Jan 5 20:38:48 2017 +0800

    Move TermIndexTracker to test.

 .../examples/arithmetic/ArithmeticStateMachine.java  | 20 +++++++++++++++-----
 .../statemachine/SimpleStateMachine4Testing.java     | 11 +++++------
 .../apache/raft/statemachine/TermIndexTracker.java   |  2 +-
 3 files changed, 21 insertions(+), 12 deletions(-)

commit eaadf8e66a98e2bc5e254af96a56f6d8f6d9800f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jan 3 19:42:48 2017 +0800

    Server code cleanup: remove rarely used methods and reduce method visibility.

 .../org/apache/raft/server/impl/FollowerState.java |  4 +-
 .../apache/raft/server/impl/LeaderElection.java    |  4 +-
 .../org/apache/raft/server/impl/LeaderState.java   |  7 +--
 .../apache/raft/server/impl/RaftConfiguration.java | 12 ++---
 .../apache/raft/server/impl/RaftServerImpl.java    | 17 ++++---
 .../java/org/apache/raft/server/impl/Role.java     | 25 ----------
 .../raft/server/impl/RaftServerTestUtil.java       |  6 +++
 .../raft/statemachine/RaftSnapshotBaseTest.java    | 57 ++++++++++------------
 .../statemachine/SimpleStateMachine4Testing.java   | 10 ++--
 .../apache/raft/statemachine/TestStateMachine.java | 11 +++--
 10 files changed, 71 insertions(+), 82 deletions(-)

commit a38e2f71ef0e84cb0af9a394544274e0dd56bcd9
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jan 3 02:05:43 2017 +0800

    Move RequestDispatcher code to RaftServerImpl.

 .../protocol/RaftClientAsynchronousProtocol.java   |  30 +++++
 .../java/org/apache/raft/grpc/RaftGRpcService.java |   6 +-
 .../grpc/client/RaftClientProtocolService.java     |  14 +--
 .../grpc/server/RaftServerProtocolService.java     |  15 ++-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  18 +--
 .../apache/raft/netty/server/NettyRpcService.java  |  15 ++-
 .../java/org/apache/raft/server/RaftServer.java    |   5 +-
 .../apache/raft/server/impl/RaftServerImpl.java    |  72 ++++++++++-
 .../apache/raft/server/impl/RequestDispatcher.java | 140 ---------------------
 .../raft/server/simulation/SimulatedServerRpc.java |  23 ++--
 10 files changed, 142 insertions(+), 196 deletions(-)

commit 673a28278346fb641f7c1e81c20bc37168be33f0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jan 2 23:59:14 2017 +0800

    Change RaftServerRpc to extend RaftServerProtocol and Closeable.

 .../java/org/apache/raft/grpc/RaftGRpcService.java | 10 +++++-----
 .../raft/hadooprpc/server/HadoopRpcService.java    |  8 ++++----
 .../apache/raft/netty/server/NettyRpcService.java  |  8 ++++----
 .../java/org/apache/raft/server/RaftServerRpc.java | 23 +++++++++-------------
 .../apache/raft/server/impl/LeaderElection.java    |  2 +-
 .../org/apache/raft/server/impl/LogAppender.java   |  4 ++--
 .../apache/raft/server/impl/RaftServerImpl.java    | 11 ++++-------
 .../org/apache/raft/server/impl/ServerState.java   |  2 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  8 ++++----
 9 files changed, 34 insertions(+), 42 deletions(-)

commit 56e9b719003e7d7024b05d9edec5a95937b3d3b3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jan 2 21:10:11 2017 +0800

    Add a new RaftServer interface.

 .../java/org/apache/raft/grpc/RaftGRpcService.java |  6 ++--
 .../raft/hadooprpc/server/HadoopRpcService.java    |  8 ++---
 .../apache/raft/netty/server/NettyRpcService.java  |  6 ++--
 .../java/org/apache/raft/server/RaftServer.java    | 34 ++++++++++++++++++++++
 .../raft/server/{impl => }/RaftServerRpc.java      |  2 +-
 .../apache/raft/server/impl/RaftServerImpl.java    |  7 +++--
 .../apache/raft/server/impl/RequestDispatcher.java |  9 ++++--
 .../test/java/org/apache/raft/MiniRaftCluster.java |  2 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  6 ++--
 9 files changed, 59 insertions(+), 21 deletions(-)

commit 22f3ee0b46a5485deafa84939eb5290938b5552b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jan 2 20:10:28 2017 +0800

    Rename RaftServer to RaftServerImpl (will add an interface.)

 .../test/java/org/apache/raft/TestBatchAppend.java |  4 +-
 .../java/org/apache/raft/TestRestartRaftPeer.java  |  4 +-
 .../TestRaftStateMachineException.java             |  4 +-
 .../java/org/apache/raft/grpc/RaftGRpcService.java |  4 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   |  6 +--
 .../grpc/server/PipelinedLogAppenderFactory.java   |  6 +--
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  | 14 ++---
 .../java/org/apache/raft/grpc/TestRaftStream.java  | 12 ++---
 .../org/apache/raft/grpc/TestRaftWithGrpc.java     |  4 +-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  4 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    | 12 ++---
 .../raft/hadooprpc/TestRaftWithHadoopRpc.java      |  4 +-
 .../apache/raft/netty/server/NettyRpcService.java  |  4 +-
 .../raft/netty/MiniRaftClusterWithNetty.java       | 14 ++---
 .../org/apache/raft/netty/TestRaftWithNetty.java   |  4 +-
 .../org/apache/raft/server/impl/FollowerState.java |  6 +--
 .../apache/raft/server/impl/LeaderElection.java    |  4 +-
 .../org/apache/raft/server/impl/LeaderState.java   |  6 +--
 .../org/apache/raft/server/impl/LogAppender.java   |  6 +--
 .../raft/server/impl/LogAppenderFactory.java       |  8 +--
 .../apache/raft/server/impl/PendingRequests.java   |  6 +--
 .../impl/{RaftServer.java => RaftServerImpl.java}  | 10 ++--
 .../apache/raft/server/impl/RequestDispatcher.java |  4 +-
 .../org/apache/raft/server/impl/ServerState.java   | 10 ++--
 .../raft/server/impl/StateMachineUpdater.java      |  4 +-
 .../apache/raft/server/storage/RaftLogWorker.java  |  8 +--
 .../raft/server/storage/SegmentedRaftLog.java      |  6 +--
 .../test/java/org/apache/raft/MiniRaftCluster.java | 60 +++++++++++-----------
 .../test/java/org/apache/raft/RaftBasicTests.java  |  8 +--
 .../raft/RaftNotLeaderExceptionBaseTest.java       |  4 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    | 22 ++++----
 .../server/impl/BlockRequestHandlingInjection.java |  6 +--
 .../server/impl/RaftReconfigurationBaseTest.java   |  4 +-
 .../raft/server/impl/RaftServerTestUtil.java       |  2 +-
 .../MiniRaftClusterWithSimulatedRpc.java           | 10 ++--
 .../raft/server/simulation/SimulatedServerRpc.java |  6 +--
 .../simulation/TestRaftWithSimulatedRpc.java       |  4 +-
 .../raft/statemachine/RaftSnapshotBaseTest.java    |  4 +-
 .../apache/raft/statemachine/TestStateMachine.java |  8 +--
 39 files changed, 158 insertions(+), 158 deletions(-)

commit c36810ed8dbd0e202f98ba57bd5730e7edff6863
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Dec 31 17:23:13 2016 +0800

    Move o.a.r.s.* to o.a.r.s.impl.

 .../examples/arithmetic/ArithmeticStateMachine.java     |  2 +-
 .../src/test/java/org/apache/raft/TestBatchAppend.java  |  2 +-
 .../test/java/org/apache/raft/TestRestartRaftPeer.java  |  2 +-
 .../statemachine/TestRaftStateMachineException.java     |  2 +-
 .../main/java/org/apache/raft/grpc/RaftGRpcService.java |  6 +++---
 .../raft/grpc/client/RaftClientProtocolService.java     |  2 +-
 .../org/apache/raft/grpc/server/GRpcLogAppender.java    |  8 ++++----
 .../raft/grpc/server/PipelinedLogAppenderFactory.java   | 10 +++++-----
 .../raft/grpc/server/RaftServerProtocolService.java     |  2 +-
 .../org/apache/raft/grpc/MiniRaftClusterWithGRpc.java   |  8 ++++----
 .../raft/grpc/TestNotLeaderExceptionWithGrpc.java       |  2 +-
 .../raft/grpc/TestRaftReconfigurationWithGRpc.java      |  4 ++--
 .../test/java/org/apache/raft/grpc/TestRaftStream.java  |  4 ++--
 .../java/org/apache/raft/grpc/TestRaftWithGrpc.java     |  6 +++---
 .../apache/raft/hadooprpc/server/HadoopRpcService.java  |  3 +++
 .../raft/hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  4 ++--
 .../hadooprpc/TestRaftReconfigurationWithHadoopRpc.java |  2 +-
 .../apache/raft/hadooprpc/TestRaftWithHadoopRpc.java    |  4 ++--
 .../org/apache/raft/netty/server/NettyRpcService.java   |  6 +++---
 .../org/apache/raft/netty/MiniRaftClusterWithNetty.java |  7 +++----
 .../raft/netty/TestRaftReconfigurationWithNetty.java    |  2 +-
 .../java/org/apache/raft/netty/TestRaftWithNetty.java   |  4 ++--
 .../org/apache/raft/server/RaftServerConfigKeys.java    |  1 +
 .../raft/server/{ => impl}/ConfigurationManager.java    |  2 +-
 .../org/apache/raft/server/{ => impl}/FollowerInfo.java |  2 +-
 .../apache/raft/server/{ => impl}/FollowerState.java    |  2 +-
 .../apache/raft/server/{ => impl}/LeaderElection.java   |  3 +--
 .../org/apache/raft/server/{ => impl}/LeaderState.java  |  4 ++--
 .../org/apache/raft/server/{ => impl}/LogAppender.java  |  7 +++----
 .../raft/server/{ => impl}/LogAppenderFactory.java      |  2 +-
 .../raft/server/{ => impl}/PeerConfiguration.java       |  2 +-
 .../apache/raft/server/{ => impl}/PendingRequest.java   |  2 +-
 .../apache/raft/server/{ => impl}/PendingRequests.java  | 17 ++++++-----------
 .../raft/server/{ => impl}/RaftConfiguration.java       |  2 +-
 .../org/apache/raft/server/{ => impl}/RaftServer.java   |  7 +++----
 .../raft/server/{ => impl}/RaftServerConstants.java     |  2 +-
 .../apache/raft/server/{ => impl}/RaftServerRpc.java    |  2 +-
 .../raft/server/{ => impl}/RequestDispatcher.java       |  2 +-
 .../java/org/apache/raft/server/{ => impl}/Role.java    |  2 +-
 .../org/apache/raft/server/impl/ServerProtoUtils.java   |  3 +--
 .../org/apache/raft/server/{ => impl}/ServerState.java  |  3 +--
 .../raft/server/{ => impl}/StateMachineUpdater.java     |  4 ++--
 .../org/apache/raft/server/storage/LogInputStream.java  |  2 +-
 .../org/apache/raft/server/storage/LogOutputStream.java |  2 +-
 .../java/org/apache/raft/server/storage/LogReader.java  |  2 +-
 .../java/org/apache/raft/server/storage/LogSegment.java |  2 +-
 .../org/apache/raft/server/storage/MemoryRaftLog.java   |  4 ++--
 .../java/org/apache/raft/server/storage/RaftLog.java    |  6 +++---
 .../org/apache/raft/server/storage/RaftLogCache.java    |  4 ++--
 .../org/apache/raft/server/storage/RaftLogWorker.java   |  4 ++--
 .../org/apache/raft/server/storage/RaftStorage.java     |  2 +-
 .../raft/server/storage/RaftStorageDirectory.java       |  2 +-
 .../apache/raft/server/storage/SegmentedRaftLog.java    |  6 +++---
 .../org/apache/raft/statemachine/BaseStateMachine.java  |  4 ++--
 .../raft/statemachine/SimpleStateMachineStorage.java    |  2 +-
 .../java/org/apache/raft/statemachine/SnapshotInfo.java |  2 +-
 .../org/apache/raft/statemachine/SnapshotInfoImpl.java  |  2 +-
 .../java/org/apache/raft/statemachine/StateMachine.java | 12 ++++++------
 .../org/apache/raft/statemachine/TermIndexTracker.java  |  2 +-
 .../src/test/java/org/apache/raft/MiniRaftCluster.java  |  8 ++++++--
 .../src/test/java/org/apache/raft/RaftBasicTests.java   |  8 ++------
 .../org/apache/raft/RaftNotLeaderExceptionBaseTest.java | 10 +++-------
 .../src/test/java/org/apache/raft/RaftTestUtil.java     |  6 +++---
 .../{ => impl}/BlockRequestHandlingInjection.java       |  2 +-
 .../server/{ => impl}/DelayLocalExecutionInjection.java |  2 +-
 .../server/{ => impl}/RaftReconfigurationBaseTest.java  |  7 ++++---
 .../raft/server/{ => impl}/RaftServerTestUtil.java      |  2 +-
 .../simulation/MiniRaftClusterWithSimulatedRpc.java     |  2 +-
 .../raft/server/simulation/SimulatedServerRpc.java      |  6 +++---
 .../TestRaftReconfigurationWithSimulatedRpc.java        |  2 +-
 .../server/simulation/TestRaftWithSimulatedRpc.java     |  2 +-
 .../raft/server/storage/TestRaftLogReadWrite.java       |  4 ++--
 .../apache/raft/server/storage/TestRaftLogSegment.java  |  8 +++-----
 .../org/apache/raft/server/storage/TestRaftStorage.java |  2 +-
 .../raft/server/storage/TestSegmentedRaftLog.java       |  4 ++--
 .../apache/raft/statemachine/RaftSnapshotBaseTest.java  |  6 +++---
 .../raft/statemachine/SimpleStateMachine4Testing.java   |  2 +-
 .../org/apache/raft/statemachine/TestStateMachine.java  |  2 +-
 78 files changed, 148 insertions(+), 160 deletions(-)

commit dd0b631a69927db0dfd7acd1a002380909203773
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Dec 31 16:50:47 2016 +0800

    Move ServerProtoUtils to o.a.r.s.impl.

 raft-server/src/main/java/org/apache/raft/server/LeaderElection.java   | 2 +-
 raft-server/src/main/java/org/apache/raft/server/LogAppender.java      | 2 +-
 raft-server/src/main/java/org/apache/raft/server/RaftServer.java       | 2 +-
 raft-server/src/main/java/org/apache/raft/server/ServerState.java      | 2 +-
 .../src/main/java/org/apache/raft/server/StateMachineUpdater.java      | 2 +-
 .../org/apache/raft/server/{protocol => impl}/ServerProtoUtils.java    | 3 ++-
 .../src/main/java/org/apache/raft/server/storage/LogSegment.java       | 2 +-
 .../src/main/java/org/apache/raft/server/storage/MemoryRaftLog.java    | 2 +-
 raft-server/src/main/java/org/apache/raft/server/storage/RaftLog.java  | 2 +-
 9 files changed, 10 insertions(+), 9 deletions(-)

commit 4bd72b11ba8eb57360e307db1d7838c729f67e40
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 29 20:51:10 2016 +0800

    Add a Builder class for RaftConfiguration.

 .../java/org/apache/raft/protocol/RaftPeer.java    |  17 ++-
 .../org/apache/raft/server/LeaderElection.java     |   2 +-
 .../java/org/apache/raft/server/LeaderState.java   |  11 +-
 .../org/apache/raft/server/PeerConfiguration.java  |   5 +
 .../org/apache/raft/server/RaftConfiguration.java  | 152 +++++++++++++++------
 .../java/org/apache/raft/server/RaftServer.java    |   2 +-
 .../raft/server/protocol/ServerProtoUtils.java     |  11 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |  12 +-
 .../org/apache/raft/server/RaftServerTestUtil.java |   3 +-
 9 files changed, 150 insertions(+), 65 deletions(-)

commit a2484fa081ffa5f3dedc3bb728ea8a5d3057c582
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 29 17:49:02 2016 +0800

    Clean up RaftConfiguration and add javadoc.

 .../java/org/apache/raft/server/LeaderState.java   | 10 ++--
 .../org/apache/raft/server/PeerConfiguration.java  |  2 +-
 .../org/apache/raft/server/RaftConfiguration.java  | 56 ++++++++----------
 .../java/org/apache/raft/server/RaftServer.java    |  4 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    | 40 ++-----------
 .../raft/server/RaftReconfigurationBaseTest.java   |  6 +-
 .../org/apache/raft/server/RaftServerTestUtil.java | 66 ++++++++++++++++++++++
 .../raft/statemachine/RaftSnapshotBaseTest.java    |  4 +-
 8 files changed, 106 insertions(+), 82 deletions(-)

commit 69c3155722eea4247993e8fd39a8cebce95c88e4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 29 16:21:13 2016 +0800

    Rename SimpleConfiguration to PeerConfiguration.

 .../main/java/org/apache/raft/server/LeaderState.java   |  6 +++---
 ...{SimpleConfiguration.java => PeerConfiguration.java} |  4 ++--
 .../java/org/apache/raft/server/RaftConfiguration.java  | 17 ++++++++---------
 3 files changed, 13 insertions(+), 14 deletions(-)

commit 0124abc01465ebf9a3966e19d766a70bfa81ee3d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 29 00:31:19 2016 +0800

    Rewrite the javadoc of TransactionContext.

 .../raft/statemachine/TransactionContext.java      | 128 ++++++++++-----------
 1 file changed, 60 insertions(+), 68 deletions(-)

commit 8bbb7fd68bd08ad400bef2717ddb0093ecd26b73
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 28 21:21:08 2016 +0800

    Rename SimpleStateMachine to SimpleStateMachine4Testing.

 raft-examples/src/test/java/org/apache/raft/TestBatchAppend.java    | 4 ++--
 .../src/test/java/org/apache/raft/TestRestartRaftPeer.java          | 4 ++--
 .../org/apache/raft/statemachine/TestRaftStateMachineException.java | 2 +-
 .../java/org/apache/raft/statemachine/RaftSnapshotBaseTest.java     | 6 +++---
 .../{SimpleStateMachine.java => SimpleStateMachine4Testing.java}    | 6 +++---
 .../test/java/org/apache/raft/statemachine/TestStateMachine.java    | 2 +-
 6 files changed, 12 insertions(+), 12 deletions(-)

commit 247ddf984b3e8789bc0c12a1c3fde5fb230aa352
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 28 21:19:02 2016 +0800

    Rename TrxContext to TransactionContext.

 .../arithmetic/ArithmeticStateMachine.java         |  2 +-
 .../TestRaftStateMachineException.java             |  2 +-
 .../java/org/apache/raft/server/LeaderState.java   |  6 ++--
 .../org/apache/raft/server/PendingRequest.java     |  8 ++---
 .../org/apache/raft/server/PendingRequests.java    | 10 +++---
 .../java/org/apache/raft/server/RaftServer.java    |  6 ++--
 .../org/apache/raft/server/RequestDispatcher.java  |  4 +--
 .../java/org/apache/raft/server/ServerState.java   |  4 +--
 .../apache/raft/server/StateMachineUpdater.java    |  6 ++--
 .../org/apache/raft/server/storage/RaftLog.java    |  6 ++--
 .../apache/raft/statemachine/BaseStateMachine.java | 14 ++++----
 .../org/apache/raft/statemachine/StateMachine.java | 12 +++----
 .../{TrxContext.java => TransactionContext.java}   | 40 +++++++++++-----------
 .../raft/statemachine/SimpleStateMachine.java      |  8 ++---
 .../apache/raft/statemachine/TestStateMachine.java |  6 ++--
 15 files changed, 67 insertions(+), 67 deletions(-)

commit 28a077932abd8862c8d605e77b014ed13d2ae229
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 28 00:11:36 2016 +0800

    Remove RaftServerRpcService..

 .../java/org/apache/raft/grpc/RaftGRpcService.java |  4 +-
 .../grpc/client/RaftClientProtocolService.java     | 11 +--
 .../grpc/server/RaftServerProtocolService.java     | 23 +++---
 .../raft/hadooprpc/server/HadoopRpcService.java    |  4 +-
 .../apache/raft/netty/server/NettyRpcService.java  |  5 +-
 .../apache/raft/server/RaftServerRpcService.java   | 95 ----------------------
 .../org/apache/raft/server/RequestDispatcher.java  | 69 ++++++++++++----
 .../raft/server/simulation/SimulatedServerRpc.java | 16 ++--
 8 files changed, 83 insertions(+), 144 deletions(-)

commit 401ae434d16d4edcb8ae4870c37e3bd7ee945ad7
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Dec 22 15:37:31 2016 -0800

    Remove hadoop-common dependency from raft-project/pom.xml

 raft-hadoop/pom.xml  | 6 ++++++
 raft-project/pom.xml | 6 ------
 2 files changed, 6 insertions(+), 6 deletions(-)

commit fc2a75ad14e1e2b3d9e201c1a148320bbf1e2288
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Dec 22 15:31:08 2016 -0800

    Remove Hadoop-Common dependency from raft-server.

 .../main/java/org/apache/raft/util/FileUtils.java  |  39 ++
 .../java/org/apache/raft/util/NativeCrc32.java     |   4 +-
 .../java/org/apache/raft/util/PureJavaCrc32.java   | 619 ++++++++++++++++++++
 .../java/org/apache/raft/util/PureJavaCrc32C.java  | 632 +++++++++++++++++++++
 .../java/org/apache/raft/grpc/TestRaftStream.java  |  35 +-
 raft-server/pom.xml                                |   6 -
 .../raft/server/storage/LogOutputStream.java       |   4 +-
 .../org/apache/raft/server/storage/LogReader.java  |   6 +-
 .../apache/raft/server/storage/RaftLogWorker.java  |   2 +-
 .../raft/server/storage/RaftStorageDirectory.java  |   9 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |   4 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  |   5 +-
 .../raft/server/storage/TestRaftLogSegment.java    |   4 +-
 .../raft/server/storage/TestRaftStorage.java       |  10 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  |   4 +-
 15 files changed, 1331 insertions(+), 52 deletions(-)

commit f5b238dd2e4f5cf1fd1e652f498b7516052a4854
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 22 16:08:04 2016 +0800

    Refactor util methods.

 .../main/java/org/apache/raft/util/ExitUtils.java  | 29 ++++---
 .../main/java/org/apache/raft/util/FileUtils.java  | 87 +++++++++++++++++++-
 .../main/java/org/apache/raft/util/LifeCycle.java  |  2 +-
 .../org/apache/raft/util/NativeLibraryChecker.java |  4 +-
 .../main/java/org/apache/raft/util/RaftUtils.java  | 94 +++-------------------
 .../apache/raft/server/StateMachineUpdater.java    | 14 ++--
 .../org/apache/raft/server/storage/LogSegment.java |  4 +-
 .../apache/raft/server/storage/RaftLogWorker.java  | 24 +++---
 .../apache/raft/server/storage/RaftStorage.java    |  9 ++-
 .../raft/server/storage/SnapshotManager.java       |  3 +-
 .../raft/server/simulation/RequestHandler.java     |  4 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  | 11 +--
 .../raft/statemachine/RaftSnapshotBaseTest.java    |  3 +-
 13 files changed, 154 insertions(+), 134 deletions(-)

commit 28c5aedfddfed15f4706bddfb65bae248efdf901
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Dec 21 14:49:11 2016 -0800

    Do not use org.apache.hadoop.fs.FileUtil in raft-common.

 .../main/java/org/apache/raft/util/FileUtils.java  | 83 ++++++++++++++++++++++
 .../main/java/org/apache/raft/util/RaftUtils.java  |  3 +-
 2 files changed, 84 insertions(+), 2 deletions(-)

commit 07846af57d491ac08eeaa10a539c39703ee29ec3
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Dec 21 14:40:53 2016 -0800

    Remove Hadoop dependency from raft-common.

 raft-common/pom.xml                                |  11 --
 .../src/main/java/org/apache/raft/io/MD5Hash.java  | 205 +++++++++++++++++++++
 .../apache/raft/util/AtomicFileOutputStream.java   |   4 +-
 .../java/org/apache/raft/util/MD5FileUtil.java     |   4 +-
 .../main/java/org/apache/raft/util/NetUtils.java   |   5 +-
 .../src/org/apache/raft/io/nativeio/errno_enum.c   |   2 +-
 .../org/apache/raft/server/storage/FileInfo.java   |   2 +-
 .../raft/server/storage/SnapshotManager.java       |   2 +-
 .../statemachine/SimpleStateMachineStorage.java    |   2 +-
 .../raft/statemachine/SimpleStateMachine.java      |   2 +-
 10 files changed, 215 insertions(+), 24 deletions(-)

commit 8ebc647883ce2c3e596a334e28ce3dd1fbbeaa79
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Dec 21 13:45:35 2016 -0800

    Do not use org.apache.hadoop.util.Shell

 .../java/org/apache/raft/io/nativeio/NativeIO.java | 15 ++++---
 .../apache/raft/io/nativeio/NativeIOException.java |  4 +-
 .../util/{test => }/CodeInjectionForTesting.java   |  2 +-
 .../org/apache/raft/util/{test => }/ExitUtils.java |  2 +-
 .../org/apache/raft/util/NativeLibraryChecker.java | 26 +-----------
 .../main/java/org/apache/raft/util/RaftUtils.java  | 46 +++++++++++++++++++++-
 .../java/org/apache/raft/util/StringUtils.java     | 15 +++++--
 .../java/org/apache/raft/grpc/RaftGRpcService.java |  2 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   |  2 +-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  2 +-
 .../apache/raft/netty/server/NettyRpcService.java  |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    |  2 +-
 .../apache/raft/server/storage/MemoryRaftLog.java  |  2 +-
 .../raft/server/storage/SegmentedRaftLog.java      |  2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |  2 +-
 .../raft/server/BlockRequestHandlingInjection.java |  2 +-
 .../raft/server/DelayLocalExecutionInjection.java  |  2 +-
 17 files changed, 78 insertions(+), 52 deletions(-)

commit 9095c18d459b6cf9594bff4e7e897d9db94371d2
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Dec 22 00:16:31 2016 +0800

    Do not use Hadoop IOUtils, DataChecksum and Configuration.

 .../java/org/apache/raft/conf/RaftProperties.java  |  1 -
 .../java/org/apache/raft/io/nativeio/NativeIO.java |  7 +-
 .../apache/raft/util/AtomicFileOutputStream.java   | 10 +--
 .../java/org/apache/raft/util/MD5FileUtil.java     | 13 ++-
 .../java/org/apache/raft/util/NativeCrc32.java     |  5 +-
 .../main/java/org/apache/raft/util/RaftUtils.java  | 99 +++++++++++++++++++++-
 .../raft/hadooprpc/server/HadoopRpcService.java    | 15 +++-
 .../apache/raft/server/RaftServerConfigKeys.java   | 14 ++-
 .../apache/raft/server/storage/LogInputStream.java |  4 +-
 .../raft/server/storage/LogOutputStream.java       | 18 ++--
 .../org/apache/raft/server/storage/LogReader.java  | 12 +--
 .../org/apache/raft/server/storage/MetaFile.java   |  4 +-
 .../apache/raft/server/storage/RaftLogWorker.java  |  5 +-
 .../raft/server/storage/SnapshotManager.java       |  3 +-
 14 files changed, 149 insertions(+), 61 deletions(-)

commit 31018be0bd56e149c946ee1c19b8a17dac6459a5
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 21 23:19:56 2016 +0800

    Do not use org.apache.hadoop.net.NetUtils.

 .../apache/raft/client/impl/RaftClientImpl.java    |   5 +-
 .../java/org/apache/raft/conf/RaftProperties.java  | 105 --------------
 .../main/java/org/apache/raft/util/NetUtils.java   | 154 +++++++++++++++++++++
 .../main/java/org/apache/raft/util/RaftUtils.java  |  36 -----
 .../java/org/apache/raft/util/StringUtils.java     |  22 +++
 .../apache/raft/grpc/client/AppendStreamer.java    |   3 +-
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |   4 +-
 .../main/java/org/apache/raft/hadooprpc/Proxy.java |   3 +-
 .../java/org/apache/raft/netty/NettyClient.java    |   4 +-
 .../raft/netty/MiniRaftClusterWithNetty.java       |   3 +-
 .../apache/raft/server/RaftServerConfigKeys.java   |   2 +-
 11 files changed, 189 insertions(+), 152 deletions(-)

commit 2383689f49d0321835462e4a5e9684f0cc3f0df2
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 21 17:26:54 2016 +0800

    Do not use org.apache.hadoop.util.ExitUtil.

 .../org/apache/raft/util/NativeLibraryChecker.java |  6 +-
 .../main/java/org/apache/raft/util/RaftUtils.java  |  4 +-
 .../main/java/org/apache/raft/util/Timestamp.java  |  4 +-
 .../util/{ => test}/CodeInjectionForTesting.java   |  3 +-
 .../java/org/apache/raft/util/test/ExitUtils.java  | 87 ++++++++++++++++++++++
 .../java/org/apache/raft/grpc/RaftGRpcService.java |  2 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   |  2 +-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  2 +-
 .../apache/raft/netty/server/NettyRpcService.java  |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    |  2 +-
 .../apache/raft/server/storage/MemoryRaftLog.java  |  2 +-
 .../raft/server/storage/SegmentedRaftLog.java      |  2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |  8 +-
 .../raft/server/BlockRequestHandlingInjection.java |  2 +-
 .../raft/server/DelayLocalExecutionInjection.java  |  2 +-
 15 files changed, 109 insertions(+), 21 deletions(-)

commit 9e58be717db680a8a31beee224f8aff9e2a32266
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 21 15:59:33 2016 +0800

    Do not use org.apache.hadoop.util.StringUtils/StringInterner.

 .../java/org/apache/raft/conf/RaftProperties.java  | 144 ++-------------------
 .../java/org/apache/raft/util/MD5FileUtil.java     |   3 +-
 .../main/java/org/apache/raft/util/RaftUtils.java  |   3 +-
 .../java/org/apache/raft/util/StringUtils.java     |  79 +++++++++++
 .../main/java/org/apache/raft/util/Timestamp.java  |  14 +-
 5 files changed, 101 insertions(+), 142 deletions(-)

commit ba9af18c9817f54ad9a59081dafeb033ee4f5483
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Dec 21 12:02:12 2016 +0800

    Do not use org.apache.hadoop.util.Daemon.

 .../src/main/java/org/apache/raft/util/Daemon.java | 35 ++++++++++++++++++++++
 .../main/java/org/apache/raft/util/Timestamp.java  |  2 +-
 .../apache/raft/grpc/client/AppendStreamer.java    |  2 +-
 .../java/org/apache/raft/server/FollowerState.java |  4 +--
 .../org/apache/raft/server/LeaderElection.java     |  2 +-
 .../java/org/apache/raft/server/LeaderState.java   |  2 +-
 .../java/org/apache/raft/server/LogAppender.java   |  2 +-
 .../apache/raft/server/StateMachineUpdater.java    |  2 +-
 .../raft/server/simulation/RequestHandler.java     |  2 +-
 .../raft/statemachine/SimpleStateMachine.java      |  2 +-
 10 files changed, 45 insertions(+), 10 deletions(-)

commit 60bfbc60ce982e60892e5b811c9d29298724d62b
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Dec 20 16:59:56 2016 -0800

    Add IO native code (borrowed from Hadoop).

 raft-common/RaftCommon.cmake                       |  208 ++++
 raft-common/RaftJNI.cmake                          |   97 ++
 raft-common/pom.xml                                |   92 ++
 raft-common/src/CMakeLists.txt                     |  108 ++
 raft-common/src/config.h.cmake                     |   24 +
 .../java/org/apache/raft/io/nativeio/Errno.java    |   64 ++
 .../java/org/apache/raft/io/nativeio/NativeIO.java |  808 +++++++++++++++
 .../apache/raft/io/nativeio/NativeIOException.java |   70 ++
 .../raft/protocol/AlreadyExistsException.java      |   36 +
 .../apache/raft/protocol/ChecksumException.java    |   35 +
 .../org/apache/raft/util/NativeCodeLoader.java     |   70 ++
 .../java/org/apache/raft/util/NativeCrc32.java     |  143 +++
 .../org/apache/raft/util/NativeLibraryChecker.java |   88 ++
 raft-common/src/main/native/src/exception.c        |  124 +++
 raft-common/src/main/native/src/exception.h        |  104 ++
 .../src/org/apache/raft/io/nativeio/NativeIO.c     | 1061 ++++++++++++++++++++
 .../src/org/apache/raft/io/nativeio/errno_enum.c   |  123 +++
 .../src/org/apache/raft/io/nativeio/errno_enum.h   |   27 +
 .../org/apache/raft/io/nativeio/file_descriptor.c  |  115 +++
 .../org/apache/raft/io/nativeio/file_descriptor.h  |   36 +
 .../src/org/apache/raft/util/NativeCodeLoader.c    |   56 ++
 .../native/src/org/apache/raft/util/NativeCrc32.c  |  276 +++++
 .../native/src/org/apache/raft/util/bulk_crc32.c   |  244 +++++
 .../native/src/org/apache/raft/util/bulk_crc32.h   |   73 ++
 .../src/org/apache/raft/util/bulk_crc32_aarch64.c  |  362 +++++++
 .../src/org/apache/raft/util/bulk_crc32_x86.c      |  345 +++++++
 .../raft/util/crc32_zlib_polynomial_tables.h       |  552 ++++++++++
 .../src/org/apache/raft/util/crc32c_tables.h       |  550 ++++++++++
 .../src/org/apache/raft/util/gcc_optimizations.h   |   30 +
 raft-common/src/main/native/src/org_apache_raft.h  |  189 ++++
 .../test/org/apache/raft/util/test_bulk_crc32.c    |  113 +++
 .../apache/hadoop/ipc/ProtobufRpcEngineShaded.java |   16 -
 raft-project/pom.xml                               |    2 +-
 raft-proto-shaded/pom.xml                          |   34 +-
 34 files changed, 6256 insertions(+), 19 deletions(-)

commit 5512d95849258233298a5c8edab3f568ce7dafd1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Dec 20 20:42:25 2016 +0800

    Rename min/maxTimeout in RaftServer and add getters.

 .../java/org/apache/raft/server/FollowerState.java |  6 ++----
 .../org/apache/raft/server/LeaderElection.java     |  4 +---
 .../java/org/apache/raft/server/LeaderState.java   | 12 +++++------
 .../java/org/apache/raft/server/LogAppender.java   |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    | 24 ++++++++++++++++------
 5 files changed, 28 insertions(+), 20 deletions(-)

commit 77233ec6a9dffba0e4a71012ab392e7f54877a69
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Dec 20 19:35:12 2016 +0800

    Do not use org.apache.hadoop.util.Time.

 .../main/java/org/apache/raft/util/Timestamp.java  | 76 ++++++++++++++++++++++
 .../apache/raft/grpc/server/GRpcLogAppender.java   |  9 ++-
 .../java/org/apache/raft/server/FollowerInfo.java  | 32 +++++----
 .../java/org/apache/raft/server/FollowerState.java | 24 ++++---
 .../org/apache/raft/server/LeaderElection.java     |  9 ++-
 .../java/org/apache/raft/server/LeaderState.java   | 14 ++--
 .../java/org/apache/raft/server/LogAppender.java   | 14 ++--
 .../java/org/apache/raft/server/RaftServer.java    | 18 +++--
 .../server/simulation/SimulatedRequestReply.java   |  6 +-
 9 files changed, 138 insertions(+), 64 deletions(-)

commit 993dd606045eb758e6db1b6ef14680fb49e0529f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Dec 10 21:45:04 2016 +0800

    Do not use hadoop GenericTestUtils.

 .../src/main/java/org/apache/raft/util/RaftUtils.java        |  6 ++++++
 raft-examples/pom.xml                                        |  7 -------
 .../src/test/java/org/apache/raft/TestBatchAppend.java       | 12 +++++-------
 .../src/test/java/org/apache/raft/TestRestartRaftPeer.java   | 10 +++++-----
 .../org/apache/raft/examples/arithmetic/TestArithmetic.java  |  4 ++--
 .../raft/statemachine/TestRaftStateMachineException.java     | 10 +++++-----
 raft-grpc/pom.xml                                            |  7 -------
 .../apache/raft/grpc/TestRaftReconfigurationWithGRpc.java    |  4 ++--
 .../src/test/java/org/apache/raft/grpc/TestRaftStream.java   |  4 ++--
 .../src/test/java/org/apache/raft/grpc/TestRaftWithGrpc.java |  4 ++--
 raft-hadoop/pom.xml                                          |  7 -------
 .../org/apache/raft/hadooprpc/TestRaftWithHadoopRpc.java     |  8 ++++----
 raft-netty/pom.xml                                           |  7 -------
 .../test/java/org/apache/raft/netty/TestRaftWithNetty.java   |  6 +++---
 raft-project/pom.xml                                         |  6 ------
 raft-server/pom.xml                                          |  6 ------
 .../java/org/apache/raft/RaftNotLeaderExceptionBaseTest.java | 10 +++++-----
 .../org/apache/raft/server/RaftReconfigurationBaseTest.java  |  8 ++++----
 .../raft/server/simulation/TestRaftWithSimulatedRpc.java     |  6 +++---
 .../org/apache/raft/server/storage/TestSegmentedRaftLog.java |  4 ++--
 .../org/apache/raft/statemachine/RaftSnapshotBaseTest.java   |  9 ++++-----
 .../java/org/apache/raft/statemachine/TestStateMachine.java  |  6 +++---
 22 files changed, 57 insertions(+), 94 deletions(-)

commit 98605d8f946cfa4b822e3ac46c69f748f0094c9e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Sat Dec 10 20:57:28 2016 +0800

    Do not use hadoop annotation in modules other than raft-hadoop.

 raft-client/pom.xml                                                  | 5 -----
 .../src/main/java/org/apache/raft/protocol/RaftClientProtocol.java   | 5 -----
 raft-server/src/main/java/org/apache/raft/server/RaftServer.java     | 4 ----
 .../java/org/apache/raft/server/protocol/RaftServerProtocol.java     | 4 ----
 4 files changed, 18 deletions(-)

commit 0c15145e9f115ab37bc4c0e1e58abdf7222f9a49
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Dec 9 17:55:35 2016 -0800

    Change log segment file preallocation strategy: preallcoate a couple of MB during the write when necessary.

 .../apache/raft/server/RaftServerConfigKeys.java   |  8 +-
 .../raft/server/storage/BufferedWriteChannel.java  |  2 +
 .../raft/server/storage/LogOutputStream.java       | 51 +++++++++---
 .../apache/raft/server/storage/RaftLogWorker.java  | 10 +--
 .../raft/server/storage/SegmentedRaftLog.java      |  4 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  | 32 ++++----
 .../raft/server/storage/TestRaftLogSegment.java    | 91 +++++++++++++++++-----
 .../raft/server/storage/TestSegmentedRaftLog.java  | 56 ++++++++++---
 .../raft/statemachine/SimpleStateMachine.java      |  6 +-
 9 files changed, 195 insertions(+), 65 deletions(-)

commit c250e628cc40d83f784eff89e52afcf31ebd2cbd
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Dec 9 14:35:15 2016 -0800

    Use buffered FileChannel for raft log writing.

 .../apache/raft/server/RaftServerConfigKeys.java   |   7 +-
 .../raft/server/storage/BufferedChannelBase.java   |  52 +++++++
 .../raft/server/storage/BufferedWriteChannel.java  | 157 +++++++++++++++++++++
 .../raft/server/storage/LogOutputStream.java       |   8 +-
 .../raft/server/RaftReconfigurationBaseTest.java   |   7 +
 .../raft/statemachine/RaftSnapshotBaseTest.java    |   7 +-
 6 files changed, 228 insertions(+), 10 deletions(-)

commit 8a784a682df5a2c11f5c804456437e876bffe3bf
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Dec 9 14:25:02 2016 +0800

    Separate RaftClient interface and implementation.

 .../java/org/apache/raft/client/RaftClient.java    | 172 ++-------------------
 .../apache/raft/client}/RaftClientConfigKeys.java  |   2 +-
 .../raft/client/{ => impl}/ClientProtoUtils.java   |   7 +-
 .../apache/raft/client/impl/RaftClientImpl.java    | 170 ++++++++++++++++++++
 .../main/java/org/apache/raft/util/RaftUtils.java  |  22 +++
 .../org/apache/raft/grpc/RaftGrpcConfigKeys.java   |   2 +-
 .../apache/raft/grpc/client/AppendStreamer.java    |  19 ++-
 .../grpc/client/RaftClientProtocolService.java     |   2 +-
 .../raft/grpc/client/RaftClientSenderWithGrpc.java |   5 +-
 .../RaftClientProtocolClientSideTranslatorPB.java  |   2 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |   2 +-
 .../netty/client/NettyClientRequestSender.java     |   2 +-
 .../apache/raft/netty/server/NettyRpcService.java  |   2 +-
 .../raft/server/protocol/ServerProtoUtils.java     |   2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |   3 +-
 .../raft/RaftNotLeaderExceptionBaseTest.java       |   5 +-
 .../raft/server/RaftReconfigurationBaseTest.java   |  15 +-
 17 files changed, 242 insertions(+), 192 deletions(-)

commit 37590605c5578da472bfd31a5241b0ec09f80075
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Dec 6 17:08:23 2016 -0800

    Add data size limitation to LogAppender sending buffer.

 .../test/java/org/apache/raft/TestBatchAppend.java | 172 +++++++++++++++++++++
 .../java/org/apache/raft/server/LogAppender.java   |  37 +++--
 .../apache/raft/server/RaftServerConfigKeys.java   |   2 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  |   3 +-
 4 files changed, 194 insertions(+), 20 deletions(-)

commit 6ba71ec0511bceb797d2aa37fdb370a2d4c66911
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Dec 2 13:23:44 2016 -0800

    Add BUILD.md to explain how to build the source code.

 BUILD.md | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit f4bb9252ddaa68a36df7e392605a84ae517d2df4
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Dec 1 15:23:33 2016 -0800

    mvn package does not generate test jars.

 raft-project-dist/pom.xml |  4 ++++
 raft-project/pom.xml      |  8 --------
 raft-proto-shaded/pom.xml | 27 ---------------------------
 3 files changed, 4 insertions(+), 35 deletions(-)

commit df4e2f71f98a36f3f347aa2499e86b40ddc95593
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Nov 21 17:06:15 2016 -0800

    "mvn package" does not generate test jar files.

 raft-project/pom.xml | 11 -----------
 1 file changed, 11 deletions(-)

commit a89d9726698c3498af9b60c36c7670e46bad8746
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Nov 21 14:14:01 2016 -0800

    Add LICENSE.txt and remove unused dependencies.

 LICENSE.txt          | 909 +++++++++++++++++++++++++++++++++++++++++++++++++++
 raft-project/pom.xml | 114 +------
 2 files changed, 911 insertions(+), 112 deletions(-)

commit df89f5b1daa38592092e64bcca7ae70f1c07cba2
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 18 16:56:54 2016 -0800

    Fix pom.xml files for "$mvn install".

 pom.xml                   | 23 -----------------------
 raft-examples/pom.xml     |  6 ------
 raft-project/pom.xml      | 39 +++++++++++++++++++--------------------
 raft-proto-shaded/pom.xml | 21 +++++++++++++++++++++
 4 files changed, 40 insertions(+), 49 deletions(-)

commit 2a20deb310eee42a01bd13bd3b9d2ee3830878f4
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 18 14:49:02 2016 -0800

    Shade protobuf and other libraries; see raft-proto-shaded/README.md

 pom.xml                                            |   1 +
 raft-client/pom.xml                                |   6 +
 .../org/apache/raft/client/ClientProtoUtils.java   |   2 +-
 raft-common/pom.xml                                |  33 +-
 .../java/org/apache/raft/protocol/Message.java     |   2 +-
 .../main/java/org/apache/raft/util/ProtoUtils.java |   4 +-
 raft-examples/pom.xml                              |  12 +-
 .../examples/arithmetic/AssignmentMessage.java     |   2 +-
 raft-grpc/pom.xml                                  |  65 +--
 .../java/org/apache/raft/grpc/RaftGRpcService.java |   8 +-
 .../java/org/apache/raft/grpc/RaftGrpcUtil.java    |   6 +-
 .../apache/raft/grpc/client/AppendStreamer.java    |   2 +-
 .../raft/grpc/client/RaftClientProtocolClient.java |   8 +-
 .../raft/grpc/client/RaftClientProtocolProxy.java  |   2 +-
 .../grpc/client/RaftClientProtocolService.java     |   2 +-
 .../raft/grpc/client/RaftClientSenderWithGrpc.java |   4 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   |   4 +-
 .../raft/grpc/server/RaftServerProtocolClient.java |   6 +-
 .../grpc/server/RaftServerProtocolService.java     |   2 +-
 raft-hadoop/pom.xml                                |  40 +-
 .../apache/hadoop/ipc/ProtobufRpcEngineShaded.java | 639 +++++++++++++++++++++
 .../main/java/org/apache/raft/hadooprpc/Proxy.java |   4 +-
 .../RaftClientProtocolClientSideTranslatorPB.java  |   2 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |   4 +-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  15 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |   4 +-
 raft-netty/pom.xml                                 |  35 +-
 .../java/org/apache/raft/netty/NettyRpcProxy.java  |   8 +-
 .../apache/raft/netty/server/NettyRpcService.java  |  14 +-
 raft-project/pom.xml                               |  14 +-
 raft-proto-shaded/.gitignore                       |   2 +
 raft-proto-shaded/README.md                        |  23 +
 raft-proto-shaded/pom.xml                          | 402 +++++++++++++
 .../src/main/proto/GRpc.proto                      |   0
 .../src/main/proto/Hadoop.proto                    |   0
 .../src/main/proto/Netty.proto                     |   0
 .../src/main/proto/Raft.proto                      |   0
 ...ache.raft.shaded.io.grpc.ManagedChannelProvider |  16 +
 ...apache.raft.shaded.io.grpc.NameResolverProvider |  16 +
 .../org.apache.raft.shaded.io.grpc.ServerProvider  |  16 +
 raft-server/pom.xml                                |   6 +
 .../java/org/apache/raft/server/LogAppender.java   |   2 +-
 .../raft/server/storage/LogOutputStream.java       |   2 +-
 .../org/apache/raft/server/storage/LogReader.java  |   4 +-
 .../org/apache/raft/server/storage/LogSegment.java |   2 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    |   2 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  |   2 +-
 47 files changed, 1224 insertions(+), 221 deletions(-)

commit fb2b8f38802e54779711cf1985c4ed0baefc7223
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 18 12:00:29 2016 -0800

    Change RaftTestUtil.waitAndCheckNewConf to try multiple attempts.

 .../org/apache/raft/server/LeaderElection.java     |  6 ++---
 .../apache/raft/server/storage/RaftLogWorker.java  |  3 ++-
 .../test/java/org/apache/raft/RaftTestUtil.java    | 28 +++++++++++++++++++++-
 .../raft/statemachine/RaftSnapshotBaseTest.java    |  2 --
 4 files changed, 32 insertions(+), 7 deletions(-)

commit 98e89d2ff147f5db69ae6c506da3bb5ede98e7a9
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 17 18:20:26 2016 -0800

    Shaded: move org.apache.raft.proto to org.apache.raft.shaded.proto.

 .../org/apache/raft/client/ClientProtoUtils.java   | 14 +----
 .../main/java/org/apache/raft/util/ProtoUtils.java |  2 +-
 raft-common/src/main/proto/Raft.proto              |  2 +-
 .../arithmetic/ArithmeticStateMachine.java         |  2 +-
 .../java/org/apache/raft/grpc/RaftGRpcService.java |  7 +--
 .../apache/raft/grpc/client/AppendStreamer.java    | 14 ++---
 .../raft/grpc/client/RaftClientProtocolClient.java | 12 ++--
 .../raft/grpc/client/RaftClientProtocolProxy.java  |  4 +-
 .../grpc/client/RaftClientProtocolService.java     | 14 ++---
 .../raft/grpc/client/RaftClientSenderWithGrpc.java | 10 ++-
 .../apache/raft/grpc/server/GRpcLogAppender.java   |  9 ++-
 .../raft/grpc/server/RaftServerProtocolClient.java | 13 ++--
 .../grpc/server/RaftServerProtocolService.java     |  9 +--
 .../proto/{RaftServerProtocol.proto => GRpc.proto} | 14 ++++-
 raft-grpc/src/main/proto/RaftClientProtocol.proto  | 34 -----------
 .../java/org/apache/raft/grpc/TestRaftStream.java  |  9 +--
 .../RaftClientProtocolClientSideTranslatorPB.java  |  4 +-
 .../hadooprpc/client/RaftClientProtocolPB.java     |  4 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |  4 +-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  5 +-
 .../hadooprpc/server/RaftServerProtocolPB.java     |  4 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |  4 +-
 .../{RaftServerProtocol.proto => Hadoop.proto}     | 12 +++-
 .../src/main/proto/RaftClientProtocol.proto        | 33 ----------
 .../java/org/apache/raft/netty/NettyRpcProxy.java  |  9 +--
 .../netty/client/NettyClientRequestSender.java     |  8 +--
 .../apache/raft/netty/server/NettyRpcService.java  |  8 +--
 raft-netty/src/main/proto/Netty.proto              |  2 +-
 .../org/apache/raft/server/LeaderElection.java     |  4 +-
 .../java/org/apache/raft/server/LeaderState.java   | 49 +++++----------
 .../java/org/apache/raft/server/LogAppender.java   | 22 ++-----
 .../java/org/apache/raft/server/RaftServer.java    | 71 ++++++++--------------
 .../java/org/apache/raft/server/RaftServerRpc.java |  7 +--
 .../apache/raft/server/RaftServerRpcService.java   | 13 +---
 .../org/apache/raft/server/RequestDispatcher.java  |  9 +--
 .../java/org/apache/raft/server/ServerState.java   | 25 +++-----
 .../apache/raft/server/StateMachineUpdater.java    | 17 +++---
 .../raft/server/protocol/RaftServerProtocol.java   |  7 +--
 .../raft/server/protocol/ServerProtoUtils.java     | 25 +++-----
 .../apache/raft/server/storage/LogInputStream.java |  2 +-
 .../raft/server/storage/LogOutputStream.java       |  2 +-
 .../org/apache/raft/server/storage/LogReader.java  |  2 +-
 .../org/apache/raft/server/storage/LogSegment.java |  7 ++-
 .../apache/raft/server/storage/MemoryRaftLog.java  |  2 +-
 .../org/apache/raft/server/storage/RaftLog.java    | 13 ++--
 .../apache/raft/server/storage/RaftLogCache.java   |  2 +-
 .../apache/raft/server/storage/RaftLogWorker.java  |  7 +--
 .../raft/server/storage/SegmentedRaftLog.java      |  2 +-
 .../raft/server/storage/SnapshotManager.java       |  8 +--
 .../apache/raft/statemachine/BaseStateMachine.java | 12 ++--
 .../org/apache/raft/statemachine/TrxContext.java   | 25 ++++----
 .../test/java/org/apache/raft/RaftTestUtil.java    | 14 ++---
 .../raft/server/RaftReconfigurationBaseTest.java   | 14 ++---
 .../raft/server/simulation/RaftServerReply.java    |  6 +-
 .../raft/server/simulation/RaftServerRequest.java  |  6 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  7 +--
 .../raft/server/storage/TestRaftLogCache.java      |  2 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  |  6 +-
 .../raft/server/storage/TestRaftLogSegment.java    | 12 ++--
 .../raft/server/storage/TestSegmentedRaftLog.java  |  6 +-
 .../raft/statemachine/RaftSnapshotBaseTest.java    |  2 +-
 .../raft/statemachine/SimpleStateMachine.java      | 29 +++++----
 .../apache/raft/statemachine/TestStateMachine.java |  4 +-
 63 files changed, 252 insertions(+), 455 deletions(-)

commit 6c763c834ac29970cf1e445ec7c64cdbe50fbaba
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 17 15:44:46 2016 -0800

    Allow transitions from STARTING and PAUSING to CLOSING in LifeCycle.

 .../main/java/org/apache/raft/util/LifeCycle.java  | 27 ++++++++++++++--------
 .../java/org/apache/raft/util/TestLifeCycle.java   |  7 +++---
 .../arithmetic/ArithmeticStateMachine.java         | 10 ++++----
 .../java/org/apache/raft/server/ServerState.java   |  2 +-
 .../apache/raft/server/StateMachineUpdater.java    |  2 +-
 .../apache/raft/statemachine/BaseStateMachine.java |  7 ++++--
 .../org/apache/raft/statemachine/StateMachine.java |  6 +++--
 .../raft/statemachine/SimpleStateMachine.java      | 12 +++++-----
 8 files changed, 45 insertions(+), 28 deletions(-)

commit 9933d90d69ee7fd6244794b7588109e1a6ea07ad
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 16 15:59:28 2016 -0800

    Refactor pom.xml files and update versions.

 pom.xml                   | 62 ++++++++++++++++++++++++---------
 raft-project-dist/pom.xml |  1 +
 raft-project/pom.xml      | 88 +++--------------------------------------------
 3 files changed, 50 insertions(+), 101 deletions(-)

commit 367d0c2d4096886d442510e852364f819d16a5bc
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Nov 14 14:11:23 2016 -0800

    Revert the accidental change to CheckedFunction.

 raft-common/src/main/java/org/apache/raft/util/CheckedFunction.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 844012cf74ea35e42b19b4dbe4567f16808d9bf9
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Nov 14 14:07:44 2016 -0800

    Clean up pom.xml files and add missing license headers.

 pom.xml                                            | 72 +++++++++++++++++++++-
 raft-client/pom.xml                                | 17 -----
 raft-common/pom.xml                                | 70 +--------------------
 .../java/org/apache/raft/util/CheckedFunction.java |  2 +-
 raft-examples/pom.xml                              | 59 ------------------
 .../examples/arithmetic/expression/Expression.java | 17 +++++
 raft-grpc/pom.xml                                  | 17 +----
 raft-hadoop/pom.xml                                | 40 +-----------
 raft-netty/pom.xml                                 | 37 -----------
 raft-project-dist/pom.xml                          | 13 ++++
 raft-project/pom.xml                               | 49 +++------------
 raft-server/pom.xml                                | 65 -------------------
 .../org/apache/raft/server/storage/MetaFile.java   | 17 +++++
 .../TestNotLeaderExceptionWithSimulation.java      | 17 +++++
 14 files changed, 147 insertions(+), 345 deletions(-)

commit 24eb2ba97dfcfae56ebd3a3b259d0732d75112fd
Author: jnp <jitendra@hortonworks.com>
Date:   Fri Nov 11 11:40:30 2016 -0800

    Updated README with link to the raft paper and a brief introduction.

 README.md | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

commit af892c263e2187778ace5d57e29e9c2358d161c8
Author: Enis Soztutar <enis@apache.org>
Date:   Wed Nov 9 17:15:58 2016 -0800

    Fixes to StateMachine API.
     - Added throwable declerations in the XXXtransaction() methods
     - Added setStateMachineContext() method to TrxContext so that SM can save state in followers
     - Added TrxContext setter methods
    
    RaftLog builds the LogEntry only after calling preAppendTransaction()

 .../java/org/apache/raft/server/LeaderState.java   | 49 ++++++++++++++++------
 .../org/apache/raft/server/PendingRequests.java    | 21 ++++++----
 .../java/org/apache/raft/server/RaftServer.java    |  7 +++-
 .../org/apache/raft/server/RequestDispatcher.java  |  9 ++--
 .../java/org/apache/raft/server/ServerState.java   | 17 ++++----
 .../org/apache/raft/server/storage/RaftLog.java    |  8 ++--
 .../apache/raft/statemachine/BaseStateMachine.java | 10 ++---
 .../org/apache/raft/statemachine/StateMachine.java | 13 +++---
 .../org/apache/raft/statemachine/TrxContext.java   | 43 +++++++++++++++----
 9 files changed, 120 insertions(+), 57 deletions(-)

commit 3e5dd889c9ca7c720ece79803aa5071bb20efda1
Author: Enis Soztutar <enis@apache.org>
Date:   Wed Nov 9 16:36:05 2016 -0800

    Fixed logging statement to log the server id

 .../java/org/apache/raft/server/RaftServer.java    | 51 ++++++++++++++--------
 .../apache/raft/server/StateMachineUpdater.java    |  2 +-
 2 files changed, 33 insertions(+), 20 deletions(-)

commit c94ef67096b84e3eb64c3cbe7d3bf9f07b7e617d
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Nov 10 18:20:03 2016 -0800

    Use PeerProxyMap and add retry max time limit in AppendStreamer.

 .../java/org/apache/raft/util/PeerProxyMap.java    |   4 +
 .../apache/raft/grpc/client/AppendStreamer.java    | 156 ++++++++-------------
 .../raft/grpc/client/RaftClientProtocolClient.java |   6 +
 .../raft/grpc/client/RaftClientProtocolProxy.java  | 104 ++++++++++++++
 .../java/org/apache/raft/grpc/TestRaftStream.java  |   1 -
 5 files changed, 169 insertions(+), 102 deletions(-)

commit d3a9c00b02f090f0c1c76a92a947253de520e11b
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Nov 9 16:38:45 2016 -0800

    Fix error/exception handling logic in AppendStreamer.

 .../org/apache/raft/client/ClientProtoUtils.java   |   5 +
 .../org/apache/raft/grpc/RaftGrpcConfigKeys.java   |   8 +
 .../java/org/apache/raft/grpc/RaftGrpcUtil.java    |  10 +
 .../apache/raft/grpc/client/AppendStreamer.java    | 337 ++++++++++++++++-----
 .../grpc/client/RaftClientProtocolService.java     |   3 +-
 .../raft/grpc/client/RaftClientSenderWithGrpc.java |   2 +-
 .../java/org/apache/raft/grpc/TestRaftStream.java  |  68 ++++-
 .../java/org/apache/raft/server/ServerState.java   |   2 +
 8 files changed, 352 insertions(+), 83 deletions(-)

commit 9db6775af061371b6711bdb841ddb9db2ce6c4ed
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 8 13:33:38 2016 -0800

    Move RaftServerConfigKeys.RAFT_SERVER_STATEMACHINE_CLASS_KEY to test and some code cleanup.

 .../main/java/org/apache/raft/util/LifeCycle.java  | 21 ++----
 .../arithmetic/ArithmeticStateMachine.java         | 78 ++++++----------------
 .../java/org/apache/raft/TestRestartRaftPeer.java  |  2 +-
 .../apache/raft/examples/RaftExamplesTestUtil.java |  3 +-
 .../apache/raft/server/RaftServerConfigKeys.java   |  3 -
 .../test/java/org/apache/raft/MiniRaftCluster.java | 14 ++--
 .../raft/statemachine/RaftSnapshotBaseTest.java    |  2 +-
 .../apache/raft/statemachine/TestStateMachine.java | 39 +++++------
 8 files changed, 55 insertions(+), 107 deletions(-)

commit e80f161ee77bc42ee9e5d7a338d4ac1916b86e60
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 4 18:08:28 2016 -0700

    Support multiple classes in LifeCycle.startAndTransition.

 raft-common/src/main/java/org/apache/raft/util/LifeCycle.java  |  5 +++--
 .../src/main/java/org/apache/raft/util/PeerProxyMap.java       |  4 ++--
 raft-common/src/main/java/org/apache/raft/util/RaftUtils.java  | 10 ++++++++++
 .../src/main/java/org/apache/raft/netty/NettyClient.java       |  5 +++--
 .../java/org/apache/raft/netty/server/NettyRpcService.java     |  3 +--
 .../java/org/apache/raft/statemachine/SimpleStateMachine.java  |  2 +-
 6 files changed, 20 insertions(+), 9 deletions(-)

commit 04992114b0209fefadfb4c6cc1d2b99d87a26fa8
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Nov 4 17:49:11 2016 -0700

    Netty: Add NotLeaderException, RaftReconfiguration and RestartRaftPeer tests.

 .../java/org/apache/raft/util/PeerProxyMap.java    |  37 +++---
 .../java/org/apache/raft/TestRestartRaftPeer.java  |  17 +--
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |  23 +---
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  23 +---
 .../java/org/apache/raft/netty/NettyRpcProxy.java  | 126 ++++++++++++---------
 .../apache/raft/netty/server/NettyRpcService.java  |  11 +-
 .../raft/netty/MiniRaftClusterWithNetty.java       |  31 ++---
 .../netty/TestNotLeaderExceptionWithNetty.java     |  33 ++++++
 .../netty/TestRaftReconfigurationWithNetty.java    |  31 +++++
 .../test/java/org/apache/raft/MiniRaftCluster.java |  26 +++++
 10 files changed, 219 insertions(+), 139 deletions(-)

commit f28498893513e3fb1fdb75a59551c1a13839c8f4
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Nov 4 17:07:57 2016 -0700

    Basic error handling in RaftOutputStream.

 .../java/org/apache/raft/client/RaftClient.java    |   6 +-
 .../apache/raft/grpc/client/AppendStreamer.java    | 173 +++++++++++++++++++--
 .../raft/grpc/client/RaftClientSenderWithGrpc.java |   2 +-
 .../apache/raft/grpc/client/RaftOutputStream.java  |  25 +--
 .../org/apache/raft/grpc/client/RaftWriter.java    |  37 -----
 .../java/org/apache/raft/grpc/TestRaftStream.java  |  18 +--
 6 files changed, 174 insertions(+), 87 deletions(-)

commit 8033ec423fa21d1804ff71bd9f26bba6b743c484
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Nov 4 11:29:38 2016 -0700

    Make sure internal error correctly handled/sent in raft server protocol (grpc).

 .../grpc/client/RaftClientProtocolService.java     |  6 ++++--
 .../apache/raft/grpc/server/GRpcLogAppender.java   | 18 ++++++++++--------
 .../grpc/server/RaftServerProtocolService.java     | 22 +++++++++++++---------
 3 files changed, 27 insertions(+), 19 deletions(-)

commit 520ddf6ef9fa80ded8524618ff64a3cf884ddcce
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Nov 3 19:26:58 2016 -0700

    Add log4j.properties to raft-grpc/netty/examples

 raft-examples/src/test/resources/log4j.properties | 18 ++++++++++++++++++
 raft-grpc/src/test/resources/log4j.properties     | 18 ++++++++++++++++++
 raft-netty/src/test/resources/log4j.properties    | 18 ++++++++++++++++++
 3 files changed, 54 insertions(+)

commit 4d41f3dcf3a676788d9ddf6aba950d0edeb15ba3
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Nov 3 19:18:35 2016 -0700

    Fix failed TestRestartRaftPeer.

 raft-common/src/main/java/org/apache/raft/util/LifeCycle.java       | 2 +-
 .../java/org/apache/raft/grpc/server/RaftServerProtocolService.java | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)

commit 1e1f2a32ac3a4d8189533f55051f84741eaed92b
Author: Enis Soztutar <enis@apache.org>
Date:   Thu Nov 3 19:04:57 2016 -0700

    Add missing dependency versions for maven enforcer plugin to work. Most of the dependency versions are coming from what Hadoop/HBase uses

 raft-project/pom.xml | 108 ++++++++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 107 insertions(+), 1 deletion(-)

commit 199c9d015a665f28a0bd496e4bd9dac57544d3c8
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 3 18:12:58 2016 -0700

    Support restart in MiniRaftClusterWithNetty.

 .../main/java/org/apache/raft/util/LifeCycle.java  |  1 +
 .../apache/raft/examples/RaftExamplesTestUtil.java | 22 +++++-------
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  | 26 ++++++++------
 .../apache/raft/grpc/TestRaftSnapshotWithGrpc.java | 32 +++++++++++++++++
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    | 29 +++++++++------
 .../hadooprpc/TestRaftSnapshotWithHadoopRpc.java   | 32 +++++++++++++++++
 .../java/org/apache/raft/netty/NettyClient.java    | 12 ++++---
 .../java/org/apache/raft/netty/NettyRpcProxy.java  |  2 +-
 .../apache/raft/netty/server/NettyRpcService.java  |  9 +++--
 .../raft/netty/MiniRaftClusterWithNetty.java       | 39 ++++++++++++++++----
 .../raft/netty/TestRaftSnapshotWithNetty.java      | 32 +++++++++++++++++
 .../test/java/org/apache/raft/MiniRaftCluster.java | 19 +++++++++-
 .../MiniRaftClusterWithSimulatedRpc.java           | 14 ++++++--
 .../TestRaftSnapshotWithSimulatedRpc.java          | 32 +++++++++++++++++
 .../raft/statemachine/RaftSnapshotBaseTest.java    | 42 +++++++++++-----------
 15 files changed, 269 insertions(+), 74 deletions(-)

commit 36eed7d875e3bb7ace8a4afea6fd12072d250162
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Nov 3 15:55:05 2016 -0700

    Minor code refactoring on GRpcLogAppender.

 .../org/apache/raft/grpc/server/GRpcLogAppender.java     | 16 +++++++---------
 .../main/java/org/apache/raft/server/LogAppender.java    |  1 -
 .../apache/raft/server/RaftReconfigurationBaseTest.java  |  1 -
 3 files changed, 7 insertions(+), 11 deletions(-)

commit 1a74a3f20730542101119d4e7ccfe055b2f98914
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 3 13:41:54 2016 -0700

    Refactor LifeCycle and fix some bugs.

 .../main/java/org/apache/raft/util/LifeCycle.java  | 79 +++++++++++++++-------
 .../java/org/apache/raft/util/PeerProxyMap.java    |  5 +-
 .../java/org/apache/raft/util/TestLifeCycle.java   |  2 +-
 .../java/org/apache/raft/netty/NettyClient.java    | 23 ++++---
 .../apache/raft/netty/server/NettyRpcService.java  |  9 +--
 .../java/org/apache/raft/server/RaftServer.java    |  2 +-
 .../raft/statemachine/SimpleStateMachine.java      | 23 ++++---
 7 files changed, 88 insertions(+), 55 deletions(-)

commit bdea1b077d453484127c87f9e944cfb5be778564
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Nov 3 11:13:35 2016 -0700

    Move the common close() logic to lifeCycle.checkStateAndClose(..).

 .../java/org/apache/raft/util/CheckedRunnable.java | 28 +++++++++++++++++
 .../main/java/org/apache/raft/util/LifeCycle.java  | 23 ++++++++++++++
 .../java/org/apache/raft/util/PeerProxyMap.java    |  8 ++---
 .../java/org/apache/raft/netty/NettyClient.java    | 18 +++--------
 .../apache/raft/netty/server/NettyRpcService.java  | 24 +++++----------
 .../org/apache/raft/server/LeaderElection.java     |  2 +-
 .../java/org/apache/raft/server/LeaderState.java   |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    | 35 +++++++++++-----------
 .../test/java/org/apache/raft/MiniRaftCluster.java |  6 ++--
 .../raft/statemachine/SimpleStateMachine.java      |  8 ++---
 10 files changed, 91 insertions(+), 63 deletions(-)

commit 66c3effd0b8967a3c37656f53fc7dea6d36b6cb0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 2 17:43:23 2016 -0700

    Use LifeCycle in RaftServer.

 .../main/java/org/apache/raft/util/LifeCycle.java  | 34 ++++++++--
 .../java/org/apache/raft/server/RaftServer.java    | 73 +++++++---------------
 .../test/java/org/apache/raft/MiniRaftCluster.java |  8 +--
 .../test/java/org/apache/raft/RaftBasicTests.java  |  2 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    |  4 +-
 .../raft/server/RaftReconfigurationBaseTest.java   |  2 +-
 .../raft/server/simulation/RequestHandler.java     |  6 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  8 +--
 8 files changed, 67 insertions(+), 70 deletions(-)

commit 317ba9d395c39295dda8b1c4bf243d8bcd1d5413
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 2 16:48:44 2016 -0700

    Use CheckedFunction instead of an abstract method in PeerProxyMap.

 .../java/org/apache/raft/util/CheckedFunction.java | 30 ++++++++++++++++++++++
 .../java/org/apache/raft/util/PeerProxyMap.java    | 18 ++++++++++---
 .../apache/raft/examples/RaftExamplesTestUtil.java | 28 ++++++++++++--------
 .../raft/grpc/client/RaftClientSenderWithGrpc.java |  8 +-----
 .../client/HadoopClientRequestSender.java          | 15 +++--------
 .../raft/hadooprpc/server/HadoopRpcService.java    | 15 +++--------
 .../java/org/apache/raft/netty/NettyRpcProxy.java  |  2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |  8 ------
 8 files changed, 71 insertions(+), 53 deletions(-)

commit b75cbb99bb5ffe8253f94a69e420e2bb6c9fdcc8
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Nov 2 14:58:49 2016 -0700

    Add basic error handling for GRpcLogAppender.

 .../java/org/apache/raft/TestRestartRaftPeer.java  |   9 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   | 135 ++++++++++++---------
 .../grpc/server/RaftServerProtocolService.java     |   7 +-
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |   8 +-
 .../java/org/apache/raft/server/LogAppender.java   |   1 +
 .../raft/server/RaftReconfigurationBaseTest.java   |   1 +
 6 files changed, 99 insertions(+), 62 deletions(-)

commit 8121f502a7b85bf96cbc681479bc195225a1346f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Nov 2 13:50:52 2016 -0700

    LifeCycle: add a transition from PAUSED to CLOSING, javadoc and a test.

 raft-common/pom.xml                                | 11 ++++
 .../main/java/org/apache/raft/util/LifeCycle.java  | 67 +++++++++++++++-------
 .../java/org/apache/raft/util/TestLifeCycle.java   | 52 +++++++++++++++++
 3 files changed, 109 insertions(+), 21 deletions(-)

commit 0017f4dba354f3cbc3b371be961a1c92b201506b
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Nov 1 18:13:31 2016 -0700

    Add pipeline support for InstallSnapshot (with GRpc). Fix TestRaftSnapshot for raft-grpc.

 .../java/org/apache/raft/conf/RaftProperties.java  |  31 ++++
 .../apache/raft/protocol/RaftClientRequest.java    |   2 +-
 raft-common/src/main/proto/Raft.proto              |   5 +-
 .../apache/raft/examples/RaftExamplesTestUtil.java |   7 -
 .../apache/raft/statemachine/TestRaftSnapshot.java |   5 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   | 145 ++++++++++++++++-
 .../raft/grpc/server/RaftServerProtocolClient.java |   7 +
 .../grpc/server/RaftServerProtocolService.java     |   2 -
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |  46 +++++-
 .../java/org/apache/raft/server/LeaderState.java   |   4 +-
 .../java/org/apache/raft/server/LogAppender.java   | 180 ++++++++++++++-------
 .../java/org/apache/raft/server/RaftServer.java    |   4 +-
 .../raft/server/protocol/ServerProtoUtils.java     |   5 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |   2 +-
 .../raft/statemachine/SimpleStateMachine.java      |   2 +-
 15 files changed, 358 insertions(+), 89 deletions(-)

commit 8405919fec2ad012666abeb2ce1c2bc77bdf5893
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 1 17:37:23 2016 -0700

    Support exception reply in raft-netty.

 .../main/java/org/apache/raft/util/ProtoUtils.java |  24 +++++
 .../main/java/org/apache/raft/util/RaftUtils.java  |  10 ++
 .../TestRaftStateMachineException.java             |  11 +-
 .../java/org/apache/raft/grpc/RaftGrpcUtil.java    |   7 +-
 .../raft/grpc/client/RaftClientSenderWithGrpc.java |  10 +-
 .../java/org/apache/raft/netty/NettyRpcProxy.java  |  17 ++-
 .../apache/raft/netty/server/NettyRpcService.java  | 119 ++++++++++++---------
 raft-netty/src/main/proto/Netty.proto              |   6 ++
 8 files changed, 132 insertions(+), 72 deletions(-)

commit 14fbfd3f53a179d89b7439b7f957bee7e585141c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 1 14:19:03 2016 -0700

    Share EventLoopGroup among netty proxies.

 .../java/org/apache/raft/util/PeerProxyMap.java    |  2 +-
 .../java/org/apache/raft/netty/NettyClient.java    | 13 ++------
 .../java/org/apache/raft/netty/NettyRpcProxy.java  | 37 ++++++++++++++++++----
 .../netty/client/NettyClientRequestSender.java     | 17 +---------
 .../apache/raft/netty/server/NettyRpcService.java  | 17 +---------
 .../org/apache/raft/netty/TestRaftWithNetty.java   |  3 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  | 17 ++++++----
 7 files changed, 49 insertions(+), 57 deletions(-)

commit 2d64633ebe2a26af6928ac71e394cbb37f88ad40
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Nov 1 13:47:31 2016 -0700

    Change Message#getContent return type to ByteString to avoid unnecessary copy.

 .../main/java/org/apache/raft/client/ClientProtoUtils.java |  6 ++----
 .../src/main/java/org/apache/raft/protocol/Message.java    |  4 +++-
 .../raft/examples/arithmetic/ArithmeticStateMachine.java   |  7 +++----
 .../apache/raft/examples/arithmetic/AssignmentMessage.java |  9 ++++++---
 .../raft/examples/arithmetic/expression/Expression.java    |  4 +++-
 .../apache/raft/examples/arithmetic/TestArithmetic.java    |  7 ++-----
 .../org/apache/raft/statemachine/TestRaftSnapshot.java     |  6 ++++--
 .../main/java/org/apache/raft/grpc/RaftGrpcConfigKeys.java |  2 +-
 .../java/org/apache/raft/server/RaftServerConfigKeys.java  |  2 +-
 .../org/apache/raft/statemachine/BaseStateMachine.java     |  5 ++---
 .../src/test/java/org/apache/raft/RaftTestUtil.java        | 14 ++++++++------
 .../org/apache/raft/statemachine/SimpleStateMachine.java   |  3 +--
 .../org/apache/raft/statemachine/TestStateMachine.java     |  3 +--
 13 files changed, 37 insertions(+), 35 deletions(-)

commit b91ef192f96150782e5c0af024202a568d91f9de
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Nov 1 13:10:10 2016 -0700

    RaftClient and PeerProxyMap should implement Closeable.

 .../java/org/apache/raft/client/RaftClient.java    |  8 +++-
 .../raft/client/RaftClientRequestSender.java       |  3 +-
 .../main/java/org/apache/raft/util/LifeCycle.java  |  9 +++--
 .../java/org/apache/raft/util/PeerProxyMap.java    | 39 ++++++++++++++++++--
 .../main/java/org/apache/raft/util/ProtoUtils.java |  5 +++
 .../java/org/apache/raft/TestRestartRaftPeer.java  |  1 +
 .../raft/examples/arithmetic/TestArithmetic.java   |  1 +
 .../apache/raft/statemachine/TestRaftSnapshot.java | 26 +++++++------
 .../TestRaftStateMachineException.java             |  3 +-
 .../raft/grpc/client/RaftClientProtocolClient.java |  6 ++-
 .../raft/grpc/client/RaftClientSenderWithGrpc.java | 10 +----
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |  5 ---
 .../hadooprpc/{HadoopUtils.java => Proxy.java}     | 26 +++++++++----
 .../client/HadoopClientRequestSender.java          | 10 +++--
 .../RaftClientProtocolClientSideTranslatorPB.java  | 26 ++++++-------
 .../raft/hadooprpc/server/HadoopRpcService.java    | 43 ++++++++++------------
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  5 ---
 .../netty/client/NettyClientRequestSender.java     | 11 +++++-
 .../apache/raft/netty/server/NettyRpcService.java  | 17 +++++++++
 .../raft/netty/MiniRaftClusterWithNetty.java       | 17 +++++----
 .../org/apache/raft/netty/TestRaftWithNetty.java   |  8 +++-
 .../java/org/apache/raft/server/LogAppender.java   |  9 +++--
 .../java/org/apache/raft/server/RaftServer.java    |  5 ++-
 .../test/java/org/apache/raft/MiniRaftCluster.java |  2 -
 .../test/java/org/apache/raft/RaftBasicTests.java  |  8 ++--
 .../raft/RaftNotLeaderExceptionBaseTest.java       | 11 ++++--
 .../raft/server/RaftReconfigurationBaseTest.java   | 14 ++++---
 .../MiniRaftClusterWithSimulatedRpc.java           |  5 ---
 .../simulation/SimulatedClientRequestReply.java    |  6 +++
 .../apache/raft/statemachine/TestStateMachine.java | 10 ++---
 30 files changed, 216 insertions(+), 133 deletions(-)

commit 1e5668cb0d9fed9311ab52cba2b4a17651942b2b
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Oct 31 15:50:53 2016 -0700

    Use oneof protobuf feature to save space for LogEntryProto.

 .../src/main/java/org/apache/raft/util/ProtoUtils.java |  4 ++--
 raft-common/src/main/proto/Raft.proto                  | 18 +++++++++---------
 .../java/org/apache/raft/grpc/RaftGrpcConfigKeys.java  |  2 +-
 .../main/java/org/apache/raft/server/LeaderState.java  |  3 ++-
 .../org/apache/raft/server/StateMachineUpdater.java    |  5 +++--
 .../apache/raft/server/protocol/ServerProtoUtils.java  |  1 -
 .../org/apache/raft/server/storage/LogSegment.java     |  5 +++--
 .../raft/server/RaftReconfigurationBaseTest.java       |  7 +++++--
 8 files changed, 25 insertions(+), 20 deletions(-)

commit 8d12cf75386a0c6a98fb35c8e99ca5188921b9cb
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Oct 31 15:37:57 2016 -0700

    Move TestRestartRaftPeer and TestRaftSnapshot to examples so that they can be run with all rpc implementations.

 .../java/org/apache/raft}/TestRestartRaftPeer.java | 21 +++++------
 .../apache/raft/examples/RaftExamplesTestUtil.java |  5 +++
 .../raft/statemachine}/TestRaftSnapshot.java       | 24 ++++++-------
 .../TestRaftStateMachineException.java             |  1 +
 .../raft/hadooprpc/RaftHadoopRpcTestUtil.java      | 42 ----------------------
 5 files changed, 29 insertions(+), 64 deletions(-)

commit b9c3c4584e96e201edc53ac19ca604598712d7eb
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Oct 31 15:08:45 2016 -0700

    Change RaftStateMachineExceptionBaseTest to @Parameterized instead of being abstract.

 .../apache/raft/examples/RaftExamplesTestUtil.java | 56 +++++++++++++++++-----
 .../raft/examples/arithmetic/TestArithmetic.java   | 19 +-------
 .../TestRaftStateMachineException.java             | 55 +++++++++------------
 .../grpc/TestStateMachineExceptionWithGrpc.java    | 37 --------------
 .../TestStateMachineExceptionWithHadoopRpc.java    | 36 --------------
 .../test/java/org/apache/raft/MiniRaftCluster.java |  1 +
 .../TestStateMachineExceptionWithSimulation.java   | 31 ------------
 7 files changed, 70 insertions(+), 165 deletions(-)

commit e3fea4057700798320ce8004ab1d968332dc5419
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Oct 31 14:30:14 2016 -0700

    Add the missing pom.xml file for the previous commit.

 raft-examples/pom.xml | 202 ++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 202 insertions(+)

commit 3b088f5d233c20fcb203fea432ce8e15934c728f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Oct 31 14:25:34 2016 -0700

    Move the examples package to a new module so that it can be run with all rpc implementations.

 .../arithmetic}/ArithmeticStateMachine.java        |  4 +-
 .../examples/arithmetic}/AssignmentMessage.java    |  6 +--
 .../raft/examples/arithmetic}/Evaluable.java       |  2 +-
 .../arithmetic}/expression/BinaryExpression.java   |  2 +-
 .../arithmetic}/expression/DoubleValue.java        |  2 +-
 .../arithmetic}/expression/Expression.java         |  4 +-
 .../examples/arithmetic}/expression/NullValue.java |  2 +-
 .../arithmetic}/expression/UnaryExpression.java    |  2 +-
 .../examples/arithmetic}/expression/Variable.java  |  4 +-
 .../apache/raft/examples/RaftExamplesTestUtil.java | 50 ++++++++++++++++++++++
 .../raft/examples/arithmetic}/TestArithmetic.java  |  8 ++--
 .../arithmetic}/expression/TestExpression.java     |  2 +-
 .../raft/hadooprpc/RaftHadoopRpcTestUtil.java      | 15 ++++---
 raft-project/pom.xml                               | 37 ++++++++++++++++
 .../test/java/org/apache/raft/MiniRaftCluster.java |  8 ++++
 15 files changed, 122 insertions(+), 26 deletions(-)

commit ed87fa5697c50535b5150680f02e1932200aa8fd
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Oct 28 17:13:12 2016 -0700

    Add raft netty client.

 .../org/apache/raft/client/ClientProtoUtils.java   |  5 --
 .../main/java/org/apache/raft/util/ProtoUtils.java |  5 ++
 raft-netty/pom.xml                                 |  7 ++
 ...ServerProtocolProxy.java => NettyRpcProxy.java} | 22 +++---
 .../netty/client/NettyClientRequestSender.java     | 79 ++++++++++++++++++++++
 .../apache/raft/netty/server/NettyRpcService.java  | 33 +++++++--
 raft-netty/src/main/proto/Netty.proto              |  3 +
 .../raft/netty/MiniRaftClusterWithNetty.java       |  3 +-
 .../org/apache/raft/netty/TestRaftWithNetty.java   | 13 ++--
 .../java/org/apache/raft/server/RaftServer.java    |  7 +-
 10 files changed, 150 insertions(+), 27 deletions(-)

commit 9cc94ae104bced8e5939de8709b49723c1fd8e02
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Oct 28 15:37:55 2016 -0700

    Avoid unnecessary copy in RaftOutputStream.

 .../main/java/org/apache/raft/client/ClientProtoUtils.java  | 11 +++++++++++
 .../src/main/java/org/apache/raft/util/ProtoUtils.java      |  7 ++++++-
 .../java/org/apache/raft/grpc/client/RaftOutputStream.java  | 13 +++++++------
 .../src/test/java/org/apache/raft/MiniRaftCluster.java      |  6 ++++--
 4 files changed, 28 insertions(+), 9 deletions(-)

commit d7be281f5be5c5feaf3fb3b0c16d835de1e44582
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Oct 28 14:51:31 2016 -0700

    Rename RaftServerRequest/ReplyProto to RaftNettyServerRequest/ReplyProto.

 .../main/java/org/apache/raft/util/ProtoUtils.java | 14 +++++--
 .../apache/raft/netty/server/NettyRpcService.java  | 46 +++++++++++-----------
 .../raft/netty/server/RaftServerProtocolProxy.java | 24 +++++------
 raft-netty/src/main/proto/Netty.proto              |  8 ++--
 .../org/apache/raft/server/LeaderElection.java     | 16 +++++---
 .../org/apache/raft/server/RaftConfiguration.java  |  3 +-
 .../java/org/apache/raft/server/ServerState.java   |  5 +--
 .../apache/raft/server/SimpleConfiguration.java    |  2 +-
 8 files changed, 63 insertions(+), 55 deletions(-)

commit 76bb3c8cfa9b1884d771e82c17997f899ecca55b
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Oct 28 14:45:50 2016 -0700

    Add more tests for RaftOutputStream. Fix bugs for RaftOutputStream#flush.

 .../apache/raft/grpc/client/RaftOutputStream.java  |  21 ++-
 .../java/org/apache/raft/grpc/TestRaftStream.java  | 201 ++++++++++++++++++---
 2 files changed, 187 insertions(+), 35 deletions(-)

commit 0cea77ace4360d570ec5d7c22fda7eb645143687
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Oct 27 16:38:14 2016 -0700

    Add basic Raft stream write tests.

 .../java/org/apache/raft/client/RaftClient.java    |   6 ++
 .../apache/raft/grpc/client/AppendStreamer.java    |   8 +-
 .../grpc/client/RaftClientProtocolService.java     |   2 +-
 ...WithGrpc.java => RaftClientSenderWithGrpc.java} |   6 +-
 .../apache/raft/grpc/client/RaftOutputStream.java  |  13 ++-
 .../org/apache/raft/grpc/client/RaftWriter.java    |  37 +++++++
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |   4 +-
 .../java/org/apache/raft/grpc/TestRaftStream.java  | 119 +++++++++++++++++++++
 8 files changed, 183 insertions(+), 12 deletions(-)

commit 0a4085423686212280ffc0c3ca0b96f3abeb39dc
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Oct 27 16:07:59 2016 -0700

    Add MiniRaftClusterWithNetty and testBasicLeaderElection is now passing with Netty.

 .../main/java/org/apache/raft/util/LifeCycle.java  |  3 +-
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  | 21 +----
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    | 35 ++------
 .../{NettyServer.java => NettyRpcService.java}     | 67 ++++++++-------
 .../raft/netty/MiniRaftClusterWithNetty.java       | 97 ++++++++++++++++++++++
 .../org/apache/raft/netty/TestRaftWithNetty.java   | 54 ++++++++++++
 .../java/org/apache/raft/server/LeaderState.java   | 28 ++-----
 .../org/apache/raft/server/RaftConfiguration.java  | 26 +++---
 .../apache/raft/server/SimpleConfiguration.java    |  4 +-
 .../raft/server/protocol/ServerProtoUtils.java     |  2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java | 53 +++++++-----
 .../test/java/org/apache/raft/RaftTestUtil.java    |  2 +-
 12 files changed, 257 insertions(+), 135 deletions(-)

commit 3ee16b42d4ceccbc5926465bb6d52eaccdf853b8
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Oct 27 14:49:17 2016 -0700

    Add more tests for Exception handling in raft-grpc.

 .../java/org/apache/raft/grpc/RaftGrpcUtil.java    | 16 ++++---
 .../raft/grpc/client/RaftClientProtocolClient.java |  4 +-
 .../raft/grpc/client/RaftClientWithGrpc.java       | 13 ++++--
 .../raft/grpc/TestNotLeaderExceptionWithGrpc.java  | 39 +++++++++++++++++
 .../grpc/TestStateMachineExceptionWithGrpc.java    | 37 ++++++++++++++++
 .../TestNotLeaderExceptionWithHadoopRpc.java       | 37 ++++++++++++++++
 .../TestStateMachineExceptionWithHadoopRpc.java    | 36 +++++++++++++++
 .../apache/raft/server/storage/RaftLogWorker.java  |  9 +++-
 .../test/java/org/apache/raft/RaftBasicTests.java  |  4 ++
 .../raft/RaftNotLeaderExceptionBaseTest.java       | 42 +++++++-----------
 .../raft/RaftStateMachineExceptionBaseTest.java    | 51 ++++++++++++----------
 .../raft/server/RaftReconfigurationBaseTest.java   |  1 -
 .../TestNotLeaderExceptionWithSimulation.java      | 15 +++++++
 .../TestStateMachineExceptionWithSimulation.java   | 31 +++++++++++++
 14 files changed, 272 insertions(+), 63 deletions(-)

commit 54292faa80e036fe172265378914b149cd4f023b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Oct 27 11:14:24 2016 -0700

    Remove unused code from raft-netty.

 .../org/apache/raft/netty/server/Dispatcher.java   | 34 ---------------
 .../org/apache/raft/netty/server/NettyServer.java  |  2 -
 .../raft/netty/server/NettyServerHandler.java      | 50 ----------------------
 .../netty/server/RaftServerProtocolHandler.java    | 37 ----------------
 4 files changed, 123 deletions(-)

commit 98c02594843d184535191bf8ae5900464983faf1
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Oct 27 00:16:43 2016 -0700

    Pass exceptions from server to client for GRPC. Add tests for Raft reconfiguration with GRPC.

 .../apache/raft/util/CodeInjectionForTesting.java  |  2 +-
 .../java/org/apache/raft/grpc/RaftGrpcUtil.java    | 74 ++++++++++++++++++++++
 .../raft/grpc/client/RaftClientProtocolClient.java | 15 ++++-
 .../grpc/client/RaftClientProtocolService.java     | 18 ++----
 .../apache/raft/grpc/server/GRpcLogAppender.java   | 29 ++++++---
 .../grpc/server/RaftServerProtocolService.java     | 11 +++-
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  | 15 ++++-
 .../raft/grpc/TestRaftReconfigurationWithGRpc.java | 47 ++++++++++++++
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  6 +-
 .../TestRaftReconfigurationWithHadoopRpc.java      |  5 ++
 .../java/org/apache/raft/server/FollowerInfo.java  | 24 +++++--
 .../java/org/apache/raft/server/LeaderState.java   | 10 +--
 .../java/org/apache/raft/server/LogAppender.java   |  9 ++-
 .../java/org/apache/raft/server/RaftServer.java    | 17 +++--
 .../test/java/org/apache/raft/MiniRaftCluster.java | 10 +--
 .../raft/server/DelayLocalExecutionInjection.java  |  2 +-
 .../raft/server/RaftReconfigurationBaseTest.java   | 10 +--
 .../MiniRaftClusterWithSimulatedRpc.java           |  5 +-
 18 files changed, 249 insertions(+), 60 deletions(-)

commit cfee4f77f705ea880c7d92938c446d39adde0ec6
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Oct 26 16:02:29 2016 -0700

    Initial checkin for raft-netty.

 .../org/apache/raft/client/ClientProtoUtils.java   |   5 +
 .../main/java/org/apache/raft/util/LifeCycle.java  |   9 +
 raft-netty/pom.xml                                 | 159 ++++++++++++++++
 .../java/org/apache/raft/netty/NettyClient.java    |  83 ++++++++
 .../org/apache/raft/netty/server/Dispatcher.java   |  34 ++++
 .../org/apache/raft/netty/server/NettyServer.java  | 208 +++++++++++++++++++++
 .../raft/netty/server/NettyServerHandler.java      |  50 +++++
 .../netty/server/RaftServerProtocolHandler.java    |  37 ++++
 .../raft/netty/server/RaftServerProtocolProxy.java | 117 ++++++++++++
 raft-netty/src/main/proto/Netty.proto              |  40 ++++
 raft-project/pom.xml                               |   7 +
 11 files changed, 749 insertions(+)

commit adb9be185e91a4e0868dcdbd17847d95b5230dbc
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Oct 26 13:16:54 2016 -0700

    Move RaftServerRpcService to common.

 .../main/java/org/apache/raft/hadooprpc/server/HadoopRpcService.java | 5 +----
 .../src/main/java/org/apache/raft}/server/RaftServerRpcService.java  | 3 +--
 2 files changed, 2 insertions(+), 6 deletions(-)

commit e934933008fbdaca8802a6a7bb7519f20b6d4589
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Oct 25 13:41:27 2016 -0700

    1. Add initial RaftOutputStream implementation for client to streaming data to Raft ring (without tests). 2. Add basic tests for Raft with GRPC (with unary Append RPC).

 .../org/apache/raft/client/ClientProtoUtils.java   | 132 ++++++++++++++
 .../java/org/apache/raft/client/RaftClient.java    |  11 +-
 .../java/org/apache/raft/util/PeerProxyMap.java    |  11 +-
 .../raft/grpc/{server => }/RaftGRpcService.java    |  20 ++-
 .../org/apache/raft/grpc/RaftGrpcConfigKeys.java   |  12 +-
 .../apache/raft/grpc/client/AppendStreamer.java    | 123 +++++++++++++
 .../raft/grpc/client/RaftClientProtocolClient.java |  56 ++++++
 .../grpc/client/RaftClientProtocolService.java     | 198 +++++++++++++++++++++
 .../raft/grpc/client/RaftClientWithGrpc.java       | 131 ++++++++++++++
 .../apache/raft/grpc/client/RaftOutputStream.java  | 110 ++++++++++++
 .../apache/raft/grpc/server/GRpcLogAppender.java   |  48 ++++-
 .../raft/grpc/server/RaftServerProtocolClient.java |   4 -
 .../grpc/server/RaftServerProtocolService.java     |   2 +-
 raft-grpc/src/main/proto/RaftClientProtocol.proto  |   4 -
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |  24 ++-
 .../org/apache/raft/grpc/TestRaftWithGrpc.java     |  45 +++--
 .../RaftClientProtocolClientSideTranslatorPB.java  |  10 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |  10 +-
 .../hadooprpc/MiniRaftClusterWithHadoopRpc.java    |  31 +---
 .../java/org/apache/raft/server/FollowerInfo.java  |   2 +-
 .../org/apache/raft/server/PendingRequests.java    |   2 +-
 .../apache/raft/server/RaftServerConstants.java    |   4 +-
 .../raft/server/protocol/ServerProtoUtils.java     | 118 +-----------
 .../test/java/org/apache/raft/RaftBasicTests.java  |   8 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    |  36 ++++
 25 files changed, 928 insertions(+), 224 deletions(-)

commit ca2db3c3538857a35ee366683f2d4412b0896286
Author: Enis Soztutar <enis@apache.org>
Date:   Fri Oct 21 18:51:31 2016 -0700

    Added steps for the Log -> SM interaction so that SM is called in log commit order for writes from the leader and applies for followers

 .../arithmatic/ArithmeticStateMachine.java         |  34 +++----
 .../hadooprpc/TestRaftStateMachineException.java   |  20 ++--
 .../apache/raft/server/StateMachineUpdater.java    |  18 ++--
 .../org/apache/raft/server/storage/RaftLog.java    |  17 ++--
 .../apache/raft/statemachine/BaseStateMachine.java |  27 ++++--
 .../org/apache/raft/statemachine/StateMachine.java |  56 ++++++++---
 .../org/apache/raft/statemachine/TrxContext.java   | 102 +++++++++++++++------
 .../raft/statemachine/SimpleStateMachine.java      |  27 +++---
 .../apache/raft/statemachine/TestStateMachine.java |  40 ++++----
 9 files changed, 228 insertions(+), 113 deletions(-)

commit faf9bc7c0ab273c181af79ffbb7b55d648d73f64
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Oct 20 12:37:46 2016 -0700

    Add sequence number field in client request/reply. Also fix a bug in new configuration replication: we should stop log appender for removed peers before appending new-conf log entry.

 .../java/org/apache/raft/client/RaftClient.java    | 17 ++++--
 .../org/apache/raft/protocol/RaftClientReply.java  | 49 ++++++++++++++---
 .../apache/raft/protocol/RaftClientRequest.java    | 38 +++++++++++---
 .../org/apache/raft/protocol/RaftRpcMessage.java   | 61 ----------------------
 .../raft/protocol/SetConfigurationRequest.java     |  4 +-
 raft-common/src/main/proto/Raft.proto              |  4 +-
 .../raft/hadooprpc/TestRaftNotLeaderException.java |  8 ++-
 .../apache/raft/hadooprpc/TestRaftSnapshot.java    |  3 +-
 .../java/org/apache/raft/server/LeaderState.java   |  6 +--
 .../java/org/apache/raft/server/LogAppender.java   |  4 ++
 .../apache/raft/server/RaftServerConstants.java    |  1 +
 .../raft/server/protocol/ServerProtoUtils.java     | 42 +++++++++------
 .../raft/server/RaftReconfigurationBaseTest.java   | 14 ++---
 13 files changed, 142 insertions(+), 109 deletions(-)

commit 4ca6912a8322c5b08cb435ef0b687f0d388f9687
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Oct 19 13:50:53 2016 -0700

    Add initial pipelined AppendEntries support in raft-grpc (Raft Server side only).

 raft-grpc/pom.xml                                  |   7 +
 .../org/apache/raft/grpc/RaftGrpcConfigKeys.java   |   3 +-
 .../apache/raft/grpc/server/GRpcLogAppender.java   | 218 +++++++++++++++++++++
 .../grpc/server/PipelinedLogAppenderFactory.java   |  32 +++
 .../apache/raft/grpc/server/RaftGRpcService.java   |  16 +-
 .../raft/grpc/server/RaftServerProtocolClient.java |  17 +-
 .../apache/raft/grpc/MiniRaftClusterWithGRpc.java  |  99 ++++++++++
 .../org/apache/raft/grpc/TestRaftWithGrpc.java     |  74 +++++++
 .../java/org/apache/raft/server/FollowerInfo.java  |  18 +-
 .../org/apache/raft/server/LeaderElection.java     |   2 +-
 .../java/org/apache/raft/server/LeaderState.java   |   4 +-
 .../java/org/apache/raft/server/LogAppender.java   |  53 ++---
 .../java/org/apache/raft/server/RaftServer.java    |   6 +-
 .../apache/raft/server/RaftServerConfigKeys.java   |   2 +-
 .../apache/raft/server/RaftServerConstants.java    |   2 -
 15 files changed, 504 insertions(+), 49 deletions(-)

commit 7ee1718699ea62dad7710fc0f8fe5deea3e1e1dd
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Oct 18 17:39:45 2016 -0700

    Move LifeCycle to commom.

 .../src/main/java/org/apache/raft/util}/LifeCycle.java                | 4 ++--
 .../src/test/java/org/apache/raft/hadooprpc/TestRaftSnapshot.java     | 2 +-
 .../src/main/java/org/apache/raft/server/StateMachineUpdater.java     | 2 +-
 .../src/main/java/org/apache/raft/statemachine/BaseStateMachine.java  | 1 +
 .../src/main/java/org/apache/raft/statemachine/StateMachine.java      | 1 +
 .../test/java/org/apache/raft/statemachine/SimpleStateMachine.java    | 1 +
 6 files changed, 7 insertions(+), 4 deletions(-)

commit 2d8e62c3274ad054a1c95dbf63226c92214bac1c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Oct 18 17:36:57 2016 -0700

    Move HadoopRpcBase to commom and rename it to PeerProxyMap.

 .../java/org/apache/raft/util/PeerProxyMap.java    | 24 ++++--------
 .../apache/raft/grpc/server/RaftGRpcService.java   |  2 +-
 .../client/HadoopClientRequestSender.java          | 44 ++++++++++------------
 .../raft/hadooprpc/server/HadoopRpcService.java    | 41 ++++++++++----------
 .../java/org/apache/raft/server/RaftServer.java    |  2 +-
 .../java/org/apache/raft/server/RaftServerRpc.java |  4 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  2 +-
 7 files changed, 52 insertions(+), 67 deletions(-)

commit f91ed282b6d9ef0c97409d33f39ae26e4c8b8509
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Oct 18 14:34:32 2016 -0700

    Add batch size control for log appender.

 .../java/org/apache/raft/server/LogAppender.java   | 221 +++++++++++++++------
 .../java/org/apache/raft/server/RaftServer.java    |  25 ++-
 .../apache/raft/server/RaftServerConfigKeys.java   |   6 +
 .../raft/server/protocol/ServerProtoUtils.java     |  19 +-
 .../org/apache/raft/server/storage/RaftLog.java    |   1 +
 .../raft/server/storage/SegmentedRaftLog.java      |   6 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  |   2 +-
 7 files changed, 205 insertions(+), 75 deletions(-)

commit 4d692043ceea82bbcb69a06dd84e14c033d66fa9
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Oct 17 14:34:12 2016 -0700

    Avoid translation between PB objects and plain java objects for RaftServerProtocol.

 .../org/apache/raft/protocol/RaftRpcMessage.java   |  46 ++--
 raft-common/src/main/proto/Raft.proto              |  47 ++--
 .../apache/raft/grpc/server/RaftGRpcService.java   |  32 ++-
 .../raft/grpc/server/RaftServerProtocolClient.java |  10 +-
 .../grpc/server/RaftServerProtocolService.java     |  35 +--
 .../RaftClientProtocolServerSideTranslatorPB.java  |   4 +-
 .../raft/hadooprpc/server/HadoopRpcService.java    |  77 ++++--
 .../RaftServerProtocolClientSideTranslatorPB.java  |  81 ------
 .../RaftServerProtocolServerSideTranslatorPB.java  |  13 +-
 .../hadooprpc/server/RaftServerRpcService.java     |  20 +-
 .../org/apache/raft/server/LeaderElection.java     |  28 ++-
 .../java/org/apache/raft/server/LogAppender.java   |  45 ++--
 .../java/org/apache/raft/server/RaftServer.java    | 116 +++++----
 .../java/org/apache/raft/server/RaftServerRpc.java |  17 +-
 .../org/apache/raft/server/RequestDispatcher.java  |  22 +-
 .../java/org/apache/raft/server/ServerState.java   |  12 +-
 .../raft/server/protocol/AppendEntriesReply.java   |  54 ----
 .../raft/server/protocol/AppendEntriesRequest.java |  77 ------
 .../raft/server/protocol/InstallSnapshotReply.java |  34 ---
 .../server/protocol/InstallSnapshotRequest.java    | 128 ----------
 .../raft/server/protocol/RaftServerProtocol.java   |  12 +-
 .../raft/server/protocol/RaftServerReply.java      |  39 ---
 .../raft/server/protocol/RaftServerRequest.java    |  26 --
 .../raft/server/protocol/RequestVoteReply.java     |  37 ---
 .../raft/server/protocol/RequestVoteRequest.java   |  49 ----
 .../raft/server/protocol/ServerProtoUtils.java     | 273 ++++++---------------
 .../raft/server/storage/SnapshotManager.java       |  11 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |   2 -
 .../raft/server/simulation/RaftServerReply.java    |  99 ++++++++
 .../raft/server/simulation/RaftServerRequest.java  |  98 ++++++++
 .../simulation/SimulatedClientRequestReply.java    |   1 -
 .../raft/server/simulation/SimulatedServerRpc.java |  48 +++-
 32 files changed, 618 insertions(+), 975 deletions(-)

commit 50f4e1ac4a32672ed0268507c206e8ff5657acb1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Oct 13 13:35:22 2016 -0700

    List and verify all possible life cycle state transitions.

 .../apache/raft/hadooprpc/TestRaftSnapshot.java    |  2 +
 .../apache/raft/server/StateMachineUpdater.java    |  3 +-
 .../apache/raft/statemachine/BaseStateMachine.java |  6 +-
 .../org/apache/raft/statemachine/LifeCycle.java    | 92 ++++++++++++++++++++++
 .../org/apache/raft/statemachine/StateMachine.java | 25 +-----
 .../raft/statemachine/SimpleStateMachine.java      | 16 ++--
 6 files changed, 106 insertions(+), 38 deletions(-)

commit 5fc0febe25e5c5e4215d38c0b3c553d5384b009e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Oct 12 14:40:11 2016 -0700

    Add license header.

 .../java/org/apache/raft/server/storage/FileInfo.java   | 17 +++++++++++++++++
 .../java/org/apache/raft/statemachine/SnapshotInfo.java | 17 +++++++++++++++++
 .../org/apache/raft/statemachine/SnapshotInfoImpl.java  | 17 +++++++++++++++++
 .../org/apache/raft/statemachine/TermIndexTracker.java  | 17 +++++++++++++++++
 .../java/org/apache/raft/statemachine/TrxContext.java   | 17 +++++++++++++++++
 5 files changed, 85 insertions(+)

commit a3c0a23f3538b6c9460e2e8f3afe79748de27ea7
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Oct 12 11:14:41 2016 -0700

    Initial simple implementation of RaftGRpcService. Also add LogAppenderFactory so that we can have an async LogAppender implementation in the future.

 .../org/apache/raft/grpc/RaftGrpcConfigKeys.java   |  30 +++++
 .../apache/raft/grpc/server/RaftGRpcService.java   | 120 ++++++++++++++++++++
 .../raft/grpc/server/RaftServerProtocolClient.java |  68 +++++++++++
 .../grpc/server/RaftServerProtocolService.java     | 125 +++++++++++++++++++++
 .../raft/hadooprpc/server/HadoopRpcService.java    |   5 -
 .../java/org/apache/raft/server/LeaderState.java   |  25 +++--
 .../server/{RpcSender.java => LogAppender.java}    |  11 +-
 .../org/apache/raft/server/LogAppenderFactory.java |  31 +++++
 .../java/org/apache/raft/server/RaftServer.java    |  18 ++-
 .../apache/raft/server/RaftServerConfigKeys.java   |   4 +
 .../java/org/apache/raft/server/RaftServerRpc.java |   2 -
 .../raft/server/simulation/SimulatedServerRpc.java |   4 +-
 12 files changed, 414 insertions(+), 29 deletions(-)

commit 68535e07ae186d437096646980fe13d9ae2e45ea
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Oct 11 15:49:59 2016 -0700

    Code refactoring: 1) move RpcSender and FollowerInfo out of LeaderState, 2) move RPC request/response protobuf definition and utility functions to raft-common/raft-server so that raft-grpc can reuse them.

 raft-common/src/main/proto/Raft.proto              |  83 +++++
 raft-grpc/pom.xml                                  |   1 +
 raft-grpc/src/main/proto/RaftClientProtocol.proto  |  38 +++
 raft-grpc/src/main/proto/RaftServerProtocol.proto  |  35 ++
 .../org/apache/raft/hadooprpc/HadoopUtils.java     | 329 -------------------
 .../RaftClientProtocolClientSideTranslatorPB.java  |  14 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |  14 +-
 .../RaftServerProtocolClientSideTranslatorPB.java  |  15 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |  15 +-
 .../hadooprpc/server/RaftServerRpcService.java     |  17 +
 .../src/main/proto/RaftClientProtocol.proto        |  34 +-
 .../src/main/proto/RaftServerProtocol.proto        |  70 +---
 .../java/org/apache/raft/server/FollowerInfo.java  |  79 +++++
 .../java/org/apache/raft/server/LeaderState.java   | 357 +++------------------
 .../java/org/apache/raft/server/RpcSender.java     | 306 ++++++++++++++++++
 .../raft/server/protocol/ServerProtoUtils.java     | 311 ++++++++++++++++++
 16 files changed, 950 insertions(+), 768 deletions(-)

commit 6cf4be6675e23ce93aaa3e9d1a72d29aa5bad9e6
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Oct 10 14:41:26 2016 -0700

    Fix NPE in PendingRequests#getTransactionContext: pendingRequest may be null if the peer just becomes the new leader and commits transactions received by the previous leader.

 .../src/main/java/org/apache/raft/server/PendingRequests.java        | 5 ++++-
 .../src/main/java/org/apache/raft/server/StateMachineUpdater.java    | 4 ++--
 .../src/main/java/org/apache/raft/server/storage/RaftLog.java        | 4 ++--
 3 files changed, 8 insertions(+), 5 deletions(-)

commit 1fe655b34bb8546db9901700fdca05832437c43f
Author: Enis Soztutar <enis@apache.org>
Date:   Thu Oct 6 18:20:18 2016 -0700

    Move StateMachine to the statemachine package and some method cleanup

 .../arithmatic/ArithmeticStateMachine.java         |   5 +-
 .../raft/examples/arithmatic/TestArithmetic.java   |   2 +-
 .../apache/raft/hadooprpc/TestRaftSnapshot.java    |   4 +-
 .../hadooprpc/TestRaftStateMachineException.java   |   4 +-
 .../apache/raft/hadooprpc/TestRestartRaftPeer.java |   4 +-
 .../org/apache/raft/server/BaseStateMachine.java   |  69 -----------
 .../java/org/apache/raft/server/RaftServer.java    |   1 +
 .../apache/raft/server/RaftServerConfigKeys.java   |   5 +-
 .../org/apache/raft/server/RequestDispatcher.java  |   3 +-
 .../java/org/apache/raft/server/ServerState.java   |   2 +-
 .../apache/raft/server/StateMachineUpdater.java    |   2 +-
 .../raft/server/storage/SnapshotManager.java       |   4 +-
 .../apache/raft/statemachine/BaseStateMachine.java | 132 +++++++++++++++++++++
 .../statemachine/SimpleStateMachineStorage.java    |   2 -
 .../{server => statemachine}/StateMachine.java     | 100 +---------------
 .../org/apache/raft/statemachine/TrxContext.java   |   6 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |   2 +-
 .../SimpleStateMachine.java                        |  17 ++-
 .../statemachine/TestStateMachine.java             |  11 +-
 19 files changed, 169 insertions(+), 206 deletions(-)

commit 2012d521e540da8b87c92025f081623b48ad13ff
Author: Enis Soztutar <enis@apache.org>
Date:   Thu Oct 6 17:33:29 2016 -0700

    Pass back the TrxState carried via PendingRequests back to the StateMachine.applyLogEntry() call.

 .../arithmatic/ArithmeticStateMachine.java         |   3 +-
 .../hadooprpc/TestRaftStateMachineException.java   |   4 +-
 .../java/org/apache/raft/server/LeaderState.java   |   8 +-
 .../org/apache/raft/server/PendingRequests.java    |  21 ++-
 .../java/org/apache/raft/server/RaftServer.java    |   8 +
 .../java/org/apache/raft/server/ServerState.java   |  11 +-
 .../java/org/apache/raft/server/StateMachine.java  |  12 +-
 .../apache/raft/server/StateMachineUpdater.java    |   9 +-
 .../org/apache/raft/server/storage/RaftLog.java    |   1 +
 .../org/apache/raft/statemachine/TrxContext.java   |  31 +++-
 .../org/apache/raft/server/SimpleStateMachine.java |   3 +-
 .../raft/server/statemachine/TestStateMachine.java | 186 +++++++++++++++++++++
 12 files changed, 269 insertions(+), 28 deletions(-)

commit 5b8a0d8fd89fbd540bf90cd518c2fd8e900f4926
Author: Enis Soztutar <enis@apache.org>
Date:   Mon Oct 3 17:26:09 2016 -0700

    Added TrxContext to carry the state between SM and RAFT Log / Server

 .../main/java/org/apache/raft/util/ProtoUtils.java |  6 +-
 raft-common/src/main/proto/Raft.proto              |  8 +-
 .../arithmatic/ArithmeticStateMachine.java         | 16 ++--
 .../apache/raft/hadooprpc/TestRaftSnapshot.java    |  4 +-
 .../org/apache/raft/server/BaseStateMachine.java   |  7 ++
 .../java/org/apache/raft/server/LeaderState.java   |  4 +-
 .../org/apache/raft/server/PendingRequest.java     |  8 +-
 .../org/apache/raft/server/PendingRequests.java    |  8 +-
 .../java/org/apache/raft/server/RaftServer.java    |  7 +-
 .../org/apache/raft/server/RequestDispatcher.java  | 15 ++--
 .../java/org/apache/raft/server/ServerState.java   |  3 +-
 .../java/org/apache/raft/server/StateMachine.java  | 26 +++---
 .../apache/raft/server/StateMachineUpdater.java    |  2 +-
 .../org/apache/raft/server/storage/RaftLog.java    |  8 +-
 .../org/apache/raft/statemachine/TrxContext.java   | 98 ++++++++++++++++++++++
 .../test/java/org/apache/raft/RaftTestUtil.java    | 14 ++--
 .../org/apache/raft/server/SimpleStateMachine.java | 11 +--
 .../raft/server/storage/TestRaftLogCache.java      |  7 +-
 .../raft/server/storage/TestRaftLogSegment.java    |  4 +-
 19 files changed, 178 insertions(+), 78 deletions(-)

commit 15884e8270cdcbe1d07f95f2accc27cbacf0cfd8
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Oct 3 13:35:38 2016 -0700

    Rename hadoopRpc package name to hadooprpc.

 .../apache/raft/{hadoopRpc => hadooprpc}/HadoopConstants.java  |  2 +-
 .../apache/raft/{hadoopRpc => hadooprpc}/HadoopRpcBase.java    |  2 +-
 .../org/apache/raft/{hadoopRpc => hadooprpc}/HadoopUtils.java  |  2 +-
 .../client/HadoopClientRequestSender.java                      |  6 +++---
 .../client/RaftClientProtocolClientSideTranslatorPB.java       |  4 ++--
 .../{hadoopRpc => hadooprpc}/client/RaftClientProtocolPB.java  |  4 ++--
 .../client/RaftClientProtocolServerSideTranslatorPB.java       |  4 ++--
 .../raft/{hadoopRpc => hadooprpc}/server/HadoopRpcService.java | 10 +++++-----
 .../server/RaftServerProtocolClientSideTranslatorPB.java       |  4 ++--
 .../{hadoopRpc => hadooprpc}/server/RaftServerProtocolPB.java  |  4 ++--
 .../server/RaftServerProtocolServerSideTranslatorPB.java       |  4 ++--
 .../{hadoopRpc => hadooprpc}/server/RaftServerRpcService.java  |  2 +-
 .../org/apache/raft/examples/arithmatic/TestArithmetic.java    |  2 +-
 .../{hadoopRpc => hadooprpc}/MiniRaftClusterWithHadoopRpc.java |  6 +++---
 .../raft/{hadoopRpc => hadooprpc}/RaftHadoopRpcTestUtil.java   |  2 +-
 .../{hadoopRpc => hadooprpc}/TestRaftNotLeaderException.java   |  2 +-
 .../TestRaftReconfigurationWithHadoopRpc.java                  |  2 +-
 .../apache/raft/{hadoopRpc => hadooprpc}/TestRaftSnapshot.java |  2 +-
 .../TestRaftStateMachineException.java                         |  2 +-
 .../raft/{hadoopRpc => hadooprpc}/TestRaftWithHadoopRpc.java   |  4 ++--
 .../raft/{hadoopRpc => hadooprpc}/TestRestartRaftPeer.java     |  2 +-
 21 files changed, 36 insertions(+), 36 deletions(-)

commit 7b8401bc82683fdb98eccd7af4fcc0bae0eac157
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Oct 3 11:48:38 2016 -0700

    Use protobuf-maven-plugin for protobuf compiling.

 raft-common/pom.xml                                |  36 +++--
 raft-grpc/pom.xml                                  | 158 +++++++++++++++++++++
 raft-hadoop/pom.xml                                |  29 ++--
 raft-project/pom.xml                               |  10 +-
 .../raft/server/RaftReconfigurationBaseTest.java   |   2 +-
 5 files changed, 190 insertions(+), 45 deletions(-)

commit 965667030e4ea60ae83c65168c9bc33e450e8525
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Sep 30 15:15:44 2016 -0700

    Use protobuf 3.0 for raft.

 raft-client/pom.xml                                |  6 --
 raft-common/pom.xml                                | 51 +++++++++--------
 .../main/java/org/apache/raft/util/ProtoUtils.java |  2 +-
 raft-common/src/main/proto/Raft.proto              | 58 +++++++++----------
 raft-hadoop/pom.xml                                | 52 +++++++++--------
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |  3 -
 .../src/main/proto/RaftClientProtocol.proto        | 25 +++++----
 .../src/main/proto/RaftServerProtocol.proto        | 65 +++++++++++-----------
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |  5 +-
 raft-project/pom.xml                               |  8 +--
 raft-server/pom.xml                                |  6 --
 .../raft/server/storage/LogOutputStream.java       |  4 +-
 .../org/apache/raft/server/storage/LogReader.java  |  2 +-
 .../org/apache/raft/server/storage/LogSegment.java |  2 +-
 .../raft/server/storage/SnapshotManager.java       | 11 ++--
 .../raft/server/storage/TestRaftLogReadWrite.java  |  2 +-
 16 files changed, 148 insertions(+), 154 deletions(-)

commit 58b06967cfc9e8b8ec66c05769dc40bc9309d890
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Sep 28 17:18:16 2016 -0700

    Add RequestDispatcher to redirect client requests to StateMachine first.

 .../java/org/apache/raft/protocol/Message.java     |  15 ---
 .../main/java/org/apache/raft/util/ProtoUtils.java |  16 +--
 raft-common/src/main/proto/Raft.proto              |   7 +-
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |  21 +++-
 .../raft/hadoopRpc/server/HadoopRpcService.java    |   5 +-
 .../hadoopRpc/server/RaftServerRpcService.java     |  22 ++--
 .../src/main/proto/RaftClientProtocol.proto        |   4 +
 .../arithmatic/ArithmeticStateMachine.java         |  70 ++++++++-----
 .../apache/raft/hadoopRpc/TestRaftSnapshot.java    |  35 +++----
 .../hadoopRpc/TestRaftStateMachineException.java   |   9 +-
 .../java/org/apache/raft/server/LeaderState.java   |  32 +++---
 .../org/apache/raft/server/PendingRequest.java     |  14 ++-
 .../org/apache/raft/server/PendingRequests.java    |  63 +++++-------
 .../java/org/apache/raft/server/RaftServer.java    |  53 +++++-----
 .../apache/raft/server/RaftServerConstants.java    |   2 +
 .../org/apache/raft/server/RequestDispatcher.java  |  98 ++++++++++++++++++
 .../java/org/apache/raft/server/ServerState.java   |  38 +++----
 .../java/org/apache/raft/server/StateMachine.java  |  77 ++++++++++----
 .../apache/raft/server/StateMachineUpdater.java    |  25 ++---
 .../org/apache/raft/server/protocol/TermIndex.java |   4 +
 .../org/apache/raft/server/storage/RaftLog.java    |   8 +-
 .../apache/raft/statemachine/TermIndexTracker.java |  34 +++---
 .../test/java/org/apache/raft/MiniRaftCluster.java |  13 ++-
 .../test/java/org/apache/raft/RaftTestUtil.java    |  45 +++++++-
 .../org/apache/raft/server/SimpleStateMachine.java | 114 +++++++++++----------
 .../raft/server/simulation/SimulatedServerRpc.java |  41 ++++----
 .../raft/server/storage/TestRaftLogCache.java      |  19 ++--
 .../raft/server/storage/TestRaftLogReadWrite.java  |  20 ++--
 .../raft/server/storage/TestRaftLogSegment.java    |  25 +++--
 .../raft/server/storage/TestSegmentedRaftLog.java  |  13 +--
 30 files changed, 566 insertions(+), 376 deletions(-)

commit fc898dfad460ad002a23d3a0b12722a3de219ef3
Author: Enis Soztutar <enis@apache.org>
Date:   Fri Sep 23 16:20:54 2016 -0700

    Refactor StateMachine snapshot handling and related interfaces
    
    Conflicts:
            raft-server/src/main/java/org/apache/raft/server/StateMachine.java
            raft-server/src/test/java/org/apache/raft/server/SimpleStateMachine.java

 .../java/org/apache/raft/util/MD5FileUtil.java     |   4 +
 .../main/java/org/apache/raft/util/ProtoUtils.java |   1 +
 .../main/java/org/apache/raft/util/RaftUtils.java  |   5 +
 raft-common/src/main/proto/Raft.proto              |  12 +-
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |  39 ++++--
 .../src/main/proto/RaftServerProtocol.proto        |  14 +-
 .../arithmatic/ArithmeticStateMachine.java         |  75 ++++++++---
 .../apache/raft/hadoopRpc/TestRaftSnapshot.java    |  13 +-
 .../org/apache/raft/server/BaseStateMachine.java   |  20 ++-
 .../org/apache/raft/server/LeaderElection.java     |   8 +-
 .../java/org/apache/raft/server/LeaderState.java   | 117 +++++++++-------
 .../java/org/apache/raft/server/RaftServer.java    |  33 +++--
 .../java/org/apache/raft/server/ServerState.java   |  50 ++++---
 .../java/org/apache/raft/server/StateMachine.java  | 117 ++++++++++++----
 .../apache/raft/server/StateMachineUpdater.java    |  38 +++---
 .../server/protocol/InstallSnapshotRequest.java    | 110 +++++++++------
 .../org/apache/raft/server/protocol/TermIndex.java |   2 +-
 .../org/apache/raft/server/storage/FileInfo.java   |  37 ++++++
 .../apache/raft/server/storage/RaftStorage.java    |  19 ++-
 .../raft/server/storage/RaftStorageDirectory.java  | 112 ++++------------
 .../raft/server/storage/SnapshotManager.java       | 134 ++++++++++---------
 .../statemachine/SimpleStateMachineStorage.java    | 148 +++++++++++++++++++++
 .../org/apache/raft/statemachine/SnapshotInfo.java |  48 +++++++
 .../apache/raft/statemachine/SnapshotInfoImpl.java |  51 +++++++
 .../raft/statemachine/StateMachineStorage.java     |  39 ++++++
 .../apache/raft/statemachine/TermIndexTracker.java |  55 ++++++++
 .../org/apache/raft/server/SimpleStateMachine.java | 105 +++++++++++----
 .../raft/server/storage/TestRaftStorage.java       |   7 +-
 28 files changed, 1010 insertions(+), 403 deletions(-)

commit 6281040d450b48209c9a08c82552e6253e43aca4
Author: Enis Soztutar <enis@apache.org>
Date:   Fri Sep 23 16:31:30 2016 -0700

    Add BaseStateMachine

 .../org/apache/raft/server/BaseStateMachine.java   | 44 ++++++++++++++++++++++
 .../java/org/apache/raft/server/StateMachine.java  |  2 +-
 .../apache/raft/server/storage/RaftStorage.java    |  4 +-
 .../raft/server/storage/RaftStorageDirectory.java  |  3 +-
 .../org/apache/raft/server/SimpleStateMachine.java | 16 +-------
 5 files changed, 51 insertions(+), 18 deletions(-)

commit 5cb9183863226596832a2f82c89fc7a3b9edba49
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Sep 21 10:05:26 2016 +0800

    Support readonly client requests.

 .../java/org/apache/raft/client/RaftClient.java    | 10 ++++-
 .../apache/raft/protocol/RaftClientRequest.java    | 14 +++++-
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |  3 +-
 .../src/main/proto/RaftClientProtocol.proto        |  1 +
 .../arithmatic/ArithmeticStateMachine.java         |  6 ++-
 .../raft/examples/arithmatic/TestArithmetic.java   |  8 +++-
 .../java/org/apache/raft/server/LeaderState.java   | 14 ++++++
 .../org/apache/raft/server/PendingRequests.java    | 51 +++++++++++++++++++---
 .../java/org/apache/raft/server/RaftServer.java    | 14 +++---
 .../java/org/apache/raft/server/ServerState.java   |  1 -
 .../java/org/apache/raft/server/StateMachine.java  |  7 +++
 .../org/apache/raft/server/SimpleStateMachine.java |  5 +++
 12 files changed, 114 insertions(+), 20 deletions(-)

commit 38bcf0e565c189eebace87ffecfb2264722ea6b0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Sep 19 20:50:27 2016 +0800

    Add AutoCloseableLock.

 .../org/apache/raft/util/AutoCloseableLock.java    | 57 ++++++++++++++++
 .../arithmatic/ArithmeticStateMachine.java         | 75 +++++++++++++++-------
 .../raft/examples/arithmatic/TestArithmetic.java   |  7 +-
 .../examples/arithmatic/expression/Expression.java | 14 ++++
 .../apache/raft/server/storage/MemoryRaftLog.java  | 36 +++--------
 .../org/apache/raft/server/storage/RaftLog.java    | 32 +++------
 .../raft/server/storage/SegmentedRaftLog.java      | 36 +++--------
 7 files changed, 154 insertions(+), 103 deletions(-)

commit 000211660c9762926b3244edd89c3b20c8828e2c
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Sep 15 15:01:38 2016 -0700

    Raft: fix a bug in RaftLogWorker to allow a raft follower to restart.

 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |   4 +-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  31 ++++--
 .../raft/hadoopRpc/TestRaftNotLeaderException.java |   5 +
 .../apache/raft/hadoopRpc/TestRestartRaftPeer.java | 114 +++++++++++++++++++++
 .../java/org/apache/raft/server/LeaderState.java   |   2 +-
 .../org/apache/raft/server/PendingRequests.java    |  16 ++-
 .../java/org/apache/raft/server/ServerState.java   |   3 +-
 .../org/apache/raft/server/storage/LogSegment.java |   9 +-
 .../apache/raft/server/storage/RaftLogWorker.java  |   6 +-
 .../raft/server/storage/SegmentedRaftLog.java      |  23 ++++-
 .../test/java/org/apache/raft/MiniRaftCluster.java |   9 ++
 .../test/java/org/apache/raft/RaftBasicTests.java  |   5 +
 .../MiniRaftClusterWithSimulatedRpc.java           |  20 +++-
 .../raft/server/storage/TestRaftLogSegment.java    |  49 +++++++--
 14 files changed, 257 insertions(+), 39 deletions(-)

commit b938243542c273ef683c9cf8c399b4a7cbd445ff
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Sep 13 23:14:17 2016 +0800

    Change StateMachine.applyLogEntry(..) to return a Message.

 .../org/apache/raft/protocol/RaftClientReply.java  | 19 +++++++++++---
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |  3 ++-
 .../raft/hadoopRpc/server/HadoopRpcService.java    |  8 +-----
 .../hadoopRpc/server/RaftServerRpcService.java     |  2 +-
 .../src/main/proto/RaftClientProtocol.proto        |  7 ++---
 .../arithmatic/ArithmeticStateMachine.java         | 13 +++++++---
 .../raft/examples/arithmatic/TestArithmetic.java   | 30 +++++++++++++++++-----
 .../arithmatic/expression/DoubleValue.java         |  3 +++
 .../hadoopRpc/TestRaftStateMachineException.java   |  3 ++-
 .../java/org/apache/raft/server/LeaderState.java   | 12 +++------
 .../org/apache/raft/server/PendingRequest.java     |  5 ++++
 .../org/apache/raft/server/PendingRequests.java    | 20 +++++----------
 .../java/org/apache/raft/server/RaftServer.java    |  6 ++---
 .../java/org/apache/raft/server/StateMachine.java  |  6 +++--
 .../apache/raft/server/StateMachineUpdater.java    |  6 +++--
 .../test/java/org/apache/raft/MiniRaftCluster.java |  1 +
 .../org/apache/raft/server/SimpleStateMachine.java |  4 ++-
 17 files changed, 93 insertions(+), 55 deletions(-)

commit f8954d50c32d52621324c88c299d2c9ed243dd56
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Sep 12 15:49:50 2016 -0700

    Raft: make variables in RaftServerConstants configurable.

 .../java/org/apache/raft/client/RaftClient.java    | 14 +++--
 ...aftConstants.java => RaftClientConfigKeys.java} |  5 +-
 .../main/java/org/apache/raft/util/RaftUtils.java  |  7 +++
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  2 +-
 .../java/org/apache/raft/server/FollowerState.java |  7 ++-
 .../org/apache/raft/server/LeaderElection.java     |  4 +-
 .../java/org/apache/raft/server/LeaderState.java   | 59 ++++++++++++++-------
 .../java/org/apache/raft/server/RaftServer.java    | 15 +++++-
 .../apache/raft/server/RaftServerConfigKeys.java   | 27 ++++++++++
 .../apache/raft/server/RaftServerConstants.java    | 30 -----------
 .../java/org/apache/raft/server/ServerState.java   |  2 +-
 .../raft/server/storage/LogOutputStream.java       | 26 +++++----
 .../org/apache/raft/server/storage/LogSegment.java |  5 --
 .../apache/raft/server/storage/RaftLogCache.java   |  2 +-
 .../apache/raft/server/storage/RaftLogWorker.java  | 19 +++++--
 .../raft/server/storage/SegmentedRaftLog.java      | 17 ++++--
 .../test/java/org/apache/raft/MiniRaftCluster.java | 12 ++++-
 .../test/java/org/apache/raft/RaftBasicTests.java  |  3 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    |  8 +--
 .../raft/server/RaftReconfigurationBaseTest.java   |  9 +++-
 .../org/apache/raft/server/SimpleStateMachine.java |  5 +-
 .../MiniRaftClusterWithSimulatedRpc.java           |  3 +-
 .../server/simulation/SimulatedRequestReply.java   |  4 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  | 61 +++++++++++++---------
 .../raft/server/storage/TestRaftLogSegment.java    | 11 ++--
 .../raft/server/storage/TestSegmentedRaftLog.java  | 30 +++++++----
 26 files changed, 251 insertions(+), 136 deletions(-)

commit 698857d6b5fb586fe32b86c41eed7b1753521492
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Sep 9 12:42:43 2016 +0800

    Add an example: arithmatic.

 .../arithmatic/ArithmeticStateMachine.java         | 119 ++++++++++++++++++++
 .../examples/arithmatic/AssignmentMessage.java     |  80 +++++++++++++
 .../apache/raft/examples/arithmatic/Evaluable.java |  24 ++++
 .../raft/examples/arithmatic/TestArithmetic.java   |  94 ++++++++++++++++
 .../arithmatic/expression/BinaryExpression.java    | 103 +++++++++++++++++
 .../arithmatic/expression/DoubleValue.java         |  58 ++++++++++
 .../examples/arithmatic/expression/Expression.java |  78 +++++++++++++
 .../examples/arithmatic/expression/NullValue.java  |  55 +++++++++
 .../arithmatic/expression/TestExpression.java      | 102 +++++++++++++++++
 .../arithmatic/expression/UnaryExpression.java     |  95 ++++++++++++++++
 .../examples/arithmatic/expression/Variable.java   | 125 +++++++++++++++++++++
 11 files changed, 933 insertions(+)

commit ad725b028561b741c15869ef1cec96afd0ca6dcf
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Aug 26 13:01:11 2016 -0700

    Raft: move RaftClientProtocol.proto and RaftServerProtocol.proto to raft-hadoop.

 .../main/java/org/apache/raft/util/ProtoUtils.java |  95 +------
 raft-common/src/main/proto/Raft.proto              |  12 +
 raft-hadoop/pom.xml                                |  23 ++
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     | 294 +++++++++++++++++++++
 .../RaftClientProtocolClientSideTranslatorPB.java  |   9 +-
 .../RaftClientProtocolServerSideTranslatorPB.java  |  10 +-
 .../RaftServerProtocolClientSideTranslatorPB.java  |  13 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |  13 +-
 .../src/main/proto/RaftClientProtocol.proto        |   0
 .../src/main/proto/RaftServerProtocol.proto        |  11 -
 raft-server/pom.xml                                |  22 --
 .../java/org/apache/raft/server/LeaderState.java   |   5 +-
 .../java/org/apache/raft/server/RaftServer.java    |   4 +-
 .../raft/server/protocol/InstallSnapshotReply.java |   2 +-
 .../server/protocol/InstallSnapshotRequest.java    |   2 +-
 .../raft/server/protocol/ServerProtoUtils.java     | 174 ------------
 .../raft/server/storage/SnapshotManager.java       |   4 +-
 17 files changed, 366 insertions(+), 327 deletions(-)

commit dc84cbb70f9e9c6af7d03369f855abcff47a239c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 26 10:40:39 2016 -0700

    Cleanup slightly StateMachine related code.

 .../apache/raft/server/RaftServerConfigKeys.java   |  2 +-
 .../apache/raft/server/StateMachineUpdater.java    | 11 +++++-----
 .../raft/server/storage/LogOutputStream.java       |  2 +-
 .../raft/server/storage/RaftStorageDirectory.java  | 23 +++++++++++++++++----
 .../org/apache/raft/server/SimpleStateMachine.java | 11 ++++------
 .../raft/server/storage/TestRaftStorage.java       | 24 ++++++++++++++++++++++
 6 files changed, 54 insertions(+), 19 deletions(-)

commit b4dc7b32764486fb58004f41756d7df6981db333
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Aug 25 15:49:12 2016 -0700

    Raft: refactor code injection and add unit test testRevertConfigurationChange.

 .../apache/raft/util/CodeInjectionForTesting.java  | 20 +++++--
 .../raft/hadoopRpc/server/HadoopRpcService.java    |  2 +-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    | 33 ++++++++---
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |  7 +--
 .../java/org/apache/raft/server/RaftServer.java    |  2 +-
 .../apache/raft/server/storage/MemoryRaftLog.java  |  2 +-
 .../apache/raft/server/storage/RaftLogWorker.java  |  2 +-
 .../raft/server/storage/SegmentedRaftLog.java      |  2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java | 13 ++++-
 ...ion.java => BlockRequestHandlingInjection.java} | 64 ++++++++++++++--------
 ...tion.java => DelayLocalExecutionInjection.java} | 25 +++++----
 .../raft/server/RaftReconfigurationBaseTest.java   | 16 +++---
 .../MiniRaftClusterWithSimulatedRpc.java           |  5 ++
 .../server/simulation/SimulatedRequestReply.java   |  3 +
 14 files changed, 129 insertions(+), 67 deletions(-)

commit 07dd83598fe09505ab1c67ff118bb90ec4f1669e
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Aug 25 11:16:03 2016 -0700

    Raft: add more unit tests for reconfiguration. Add code injection to delay logSync.

 .../java/org/apache/raft/client/RaftClient.java    |   8 +-
 .../protocol/ReconfigurationTimeoutException.java  |  24 +++
 .../apache/raft/util/CodeInjectionForTesting.java  |   5 +-
 .../client/HadoopClientRequestSender.java          |   5 +-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |   8 +-
 .../raft/hadoopRpc/TestRaftNotLeaderException.java |   7 +-
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |   6 +-
 .../java/org/apache/raft/server/LeaderState.java   |   5 +-
 .../apache/raft/server/storage/MemoryRaftLog.java  |   2 +
 .../org/apache/raft/server/storage/RaftLog.java    |   1 +
 .../raft/server/storage/SegmentedRaftLog.java      |   6 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |   7 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  |   4 +-
 .../org/apache/raft/server/DelayInjection.java     |  26 +--
 .../raft/server/RaftReconfigurationBaseTest.java   | 226 ++++++++++++++++++---
 .../raft/server/RaftServerCodeInjection.java       |   5 +-
 16 files changed, 277 insertions(+), 68 deletions(-)

commit 1c5ec24f67e0b8640dea419a5c4ef74788957e6a
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Aug 23 14:29:48 2016 -0700

    Raft: make sure the RaftClient can get StateMachineException.

 .../java/org/apache/raft/client/RaftClient.java    |  8 +-
 .../raft/protocol}/StateMachineException.java      | 12 +--
 .../client/HadoopClientRequestSender.java          | 19 +++--
 .../hadoopRpc/TestRaftStateMachineException.java   | 91 ++++++++++++++++++++++
 .../org/apache/raft/server/LeaderElection.java     |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    |  3 -
 .../apache/raft/server/StateMachineUpdater.java    |  3 +-
 7 files changed, 120 insertions(+), 18 deletions(-)

commit 0737c1ec155e69a918370a23e558c7a9b80e7779
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Aug 23 10:28:11 2016 -0700

    Check unexpected exit in MiniRaftCluster.

 .../test/java/org/apache/raft/MiniRaftCluster.java    | 19 +++++++++++--------
 .../apache/raft/server/simulation/RequestHandler.java |  6 ++----
 2 files changed, 13 insertions(+), 12 deletions(-)

commit d13ae2fc9285bdae55f91dc87e11fc65cab19599
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Aug 22 14:54:54 2016 -0700

    Raft: send reply to client only after the log has been applied to the state machine.

 .../java/org/apache/raft/protocol/RaftPeer.java    |   7 +-
 .../java/org/apache/raft/server/LeaderState.java   |  24 +--
 .../org/apache/raft/server/PendingRequests.java    | 107 +++++++++++++
 .../apache/raft/server/PendingRequestsHandler.java | 173 ---------------------
 .../java/org/apache/raft/server/RaftServer.java    |   9 +-
 .../java/org/apache/raft/server/ServerState.java   |  10 +-
 .../java/org/apache/raft/server/StateMachine.java  |  17 +-
 ...erException.java => StateMachineException.java} |  15 +-
 .../apache/raft/server/StateMachineUpdater.java    |  33 +++-
 .../org/apache/raft/server/SimpleStateMachine.java |  10 +-
 10 files changed, 194 insertions(+), 211 deletions(-)

commit a3116367c05272658084096a3ec88b62a5aee84c
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Aug 19 15:18:46 2016 -0700

    Raft: cleanup RaftServer and RaftServerRpc interaction.

 .../org/apache/raft/protocol/RaftException.java    |  4 +-
 .../raft/hadoopRpc/server/HadoopRpcService.java    | 27 ++-----
 .../hadoopRpc/server/RaftServerRpcService.java     | 86 ++++++++++++++++++++++
 .../java/org/apache/raft/server/LeaderState.java   |  5 +-
 .../org/apache/raft/server/PendingRequest.java     | 57 +++-----------
 .../apache/raft/server/PendingRequestsHandler.java | 31 +++-----
 .../java/org/apache/raft/server/RaftServer.java    | 48 ++++++------
 .../java/org/apache/raft/server/RaftServerRpc.java |  8 --
 .../apache/raft/server/StateMachineUpdater.java    |  3 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  |  4 +-
 .../raft/server/simulation/RequestHandler.java     | 14 ++--
 .../raft/server/simulation/RequestReply.java       | 31 --------
 .../server/simulation/SimulatedRequestReply.java   |  8 +-
 .../raft/server/simulation/SimulatedServerRpc.java | 64 ++++++++++------
 14 files changed, 197 insertions(+), 193 deletions(-)

commit db3cca9da4effa64f7d3b8dfbe71efbff2d1ce1b
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 19 13:16:04 2016 -0700

    Cleanup RaftClient and change testWithLoad to test mulitple clients.

 .../java/org/apache/raft/client/RaftClient.java    | 118 +++++++++++----------
 .../raft/hadoopRpc/TestRaftNotLeaderException.java |   4 +-
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |   5 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  |  77 ++++++++++----
 .../test/java/org/apache/raft/RaftTestUtil.java    |   6 +-
 5 files changed, 123 insertions(+), 87 deletions(-)

commit 3c934d8c2d78f8cece74739d9b60894806cabd8a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Aug 18 13:59:22 2016 -0700

    RaftClientRequestSender.addServerProxies(..) should not throw IOException.

 .../java/org/apache/raft/client/RaftClient.java    |  4 +--
 .../raft/client/RaftClientRequestSender.java       |  6 ++--
 .../apache/raft/protocol/RaftClientRequest.java    |  5 +++
 .../org/apache/raft/hadoopRpc/HadoopRpcBase.java   | 39 ++++++++++++++++++----
 .../client/HadoopClientRequestSender.java          |  4 +--
 .../raft/hadoopRpc/server/HadoopRpcService.java    |  9 ++---
 .../raft/hadoopRpc/DelaySendServerRequest.java     |  2 +-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  3 +-
 .../java/org/apache/raft/server/RaftServer.java    |  4 +--
 .../java/org/apache/raft/server/RaftServerRpc.java |  2 +-
 .../java/org/apache/raft/server/ServerState.java   |  2 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java |  6 ++--
 .../test/java/org/apache/raft/RaftTestUtil.java    | 20 ++++-------
 .../MiniRaftClusterWithSimulatedRpc.java           |  9 ++---
 .../simulation/SimulatedClientRequestReply.java    |  2 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  2 +-
 16 files changed, 66 insertions(+), 53 deletions(-)

commit 505b930daf5a82fe7eaa48007547a8e61714f234
Merge: efb9e639 fcf2e8a3
Author: Jing9 <zhaojing9@gmail.com>
Date:   Wed Aug 17 19:03:30 2016 -0700

    Raft: Replace log.dir with raft.log.dir property in raft-project-dist/pom.xml
    
    Replace log.dir with raft.log.dir property in raft-project-dist/pom.xml

commit efb9e639a7d0e96b62146549b2cd77e0ab7bd396
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Aug 17 18:56:48 2016 -0700

    Raft: add unit tests for NotLeaderException handling.

 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |   1 +
 .../raft/hadoopRpc/RaftHadoopRpcTestUtil.java      |  41 +++++
 .../raft/hadoopRpc/TestRaftNotLeaderException.java | 166 +++++++++++++++++++++
 .../apache/raft/hadoopRpc/TestRaftSnapshot.java    |  22 +--
 .../apache/raft/server/StateMachineUpdater.java    |   7 +-
 .../test/java/org/apache/raft/RaftBasicTests.java  |   8 +-
 .../test/java/org/apache/raft/RaftTestUtil.java    |  11 ++
 .../MiniRaftClusterWithSimulatedRpc.java           |   1 +
 8 files changed, 229 insertions(+), 28 deletions(-)

commit 6196ca4c0f80edd27777908a0ad33a76264450c7
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Aug 17 14:41:31 2016 -0700

    Raft: add NotLeaderException information (suggested leader and peers in current conf) into RaftClientReply.

 .../java/org/apache/raft/client/RaftClient.java    | 11 +++--
 .../apache/raft/protocol/NotLeaderException.java   |  4 +-
 .../apache/raft/protocol/RaftClientProtocol.java   |  4 +-
 .../org/apache/raft/protocol/RaftClientReply.java  | 23 ++++++++-
 .../java/org/apache/raft/protocol/RaftPeer.java    |  2 +
 .../main/java/org/apache/raft/util/ProtoUtils.java | 33 +++++++++----
 .../src/main/proto/RaftClientProtocol.proto        | 10 ++--
 .../client/HadoopClientRequestSender.java          |  5 +-
 .../RaftClientProtocolClientSideTranslatorPB.java  | 12 +++--
 .../RaftClientProtocolServerSideTranslatorPB.java  | 13 ++---
 .../java/org/apache/raft/server/LeaderState.java   |  7 ++-
 .../org/apache/raft/server/PendingRequest.java     | 18 ++++---
 .../apache/raft/server/PendingRequestsHandler.java | 27 +++++++----
 .../java/org/apache/raft/server/RaftServer.java    | 56 +++++++++++++++-------
 .../raft/server/simulation/SimulatedServerRpc.java |  8 ++--
 .../TestRaftReconfigurationWithSimulatedRpc.java   | 31 ++++++++++++
 16 files changed, 186 insertions(+), 78 deletions(-)

commit fcf2e8a38d43da16925bbf7c922bce52d6a9f26c
Author: Mingliang Liu <liuml07@apache.org>
Date:   Tue Aug 16 17:53:11 2016 -0700

    Replace log.dir with raft.log.dir property in raft-project-dist/pom.xml

 raft-project-dist/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6875471f8249febf4e3b6e82266248aa6f48319a
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Aug 16 21:44:36 2016 -0700

    Fix merge conflicts

 .gitignore |  17 ++++++
 pom.xml    | 180 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 197 insertions(+)

commit 4619aca4dc6d1c20a4f0bdde45f8ee012c72e0ce
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Aug 16 19:18:52 2016 -0700

    Raft: make setConfiguration work with Hadoop RPC.
    
    (cherry picked from commit 7b43f7326e407350056179f1e4d2a44ee2de1448)

 .../java/org/apache/raft/client/RaftClient.java    | 10 +++---
 .../raft/client/RaftClientRequestSender.java       |  4 +++
 .../java/org/apache/raft/protocol/RaftPeer.java    |  3 +-
 .../raft/protocol/SetConfigurationRequest.java     | 12 +++----
 .../main/java/org/apache/raft/util/ProtoUtils.java | 41 ++++++++--------------
 raft-common/src/main/proto/Raft.proto              | 22 +++++-------
 .../src/main/proto/RaftClientProtocol.proto        | 14 ++++----
 .../client/HadoopClientRequestSender.java          |  5 +++
 .../RaftClientProtocolServerSideTranslatorPB.java  |  2 +-
 .../raft/hadoopRpc/server/HadoopRpcService.java    |  5 +++
 .../TestRaftReconfigurationWithHadoopRpc.java      | 26 +++++++-------
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    |  4 +--
 .../java/org/apache/raft/server/RaftServerRpc.java |  2 +-
 .../src/main/proto/RaftServerProtocol.proto        | 28 +++++++--------
 .../test/java/org/apache/raft/MiniRaftCluster.java | 34 ++++++++++--------
 ...ation.java => RaftReconfigurationBaseTest.java} | 27 ++++++--------
 .../simulation/SimulatedClientRequestReply.java    |  6 ++++
 .../raft/server/simulation/SimulatedServerRpc.java |  2 +-
 19 files changed, 127 insertions(+), 122 deletions(-)

commit c3ab0d559b18cb064a89081d622471472133457e
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Aug 16 21:21:54 2016 -0700

    Merge Nicholas's maven change from master

 README.md                                          |   2 +
 raft-client/pom.xml                                |  76 +++
 .../java/org/apache/raft/client/RaftClient.java    |   2 +-
 .../raft/client/RaftClientRequestSender.java       |   0
 raft-common/pom.xml                                | 137 ++++++
 raft-common/src/main/conf/log4j.properties         |  74 +++
 .../main/java/org/apache/raft/RaftConstants.java   |   0
 .../java/org/apache/raft/conf/RaftProperties.java  |   0
 .../apache/raft/protocol/ConfigurationMessage.java |   0
 .../java/org/apache/raft/protocol/Message.java     |   0
 .../apache/raft/protocol/NotLeaderException.java   |   0
 .../apache/raft/protocol/RaftClientProtocol.java   |   0
 .../org/apache/raft/protocol/RaftClientReply.java  |   0
 .../apache/raft/protocol/RaftClientRequest.java    |   0
 .../org/apache/raft/protocol/RaftException.java    |   0
 .../java/org/apache/raft/protocol/RaftPeer.java    |   0
 .../org/apache/raft/protocol/RaftRpcMessage.java   |   0
 .../ReconfigurationInProgressException.java        |   0
 .../raft/protocol/SetConfigurationRequest.java     |   0
 .../apache/raft/util/AtomicFileOutputStream.java   |   0
 .../apache/raft/util/CodeInjectionForTesting.java  |   0
 .../java/org/apache/raft/util/MD5FileUtil.java     |   0
 .../main/java/org/apache/raft/util/ProtoUtils.java |   0
 .../main/java/org/apache/raft/util/RaftUtils.java  |   0
 .../src/main/proto/Raft.proto                      |   0
 .../src/main/proto/RaftClientProtocol.proto        |   0
 raft-hadoop/pom.xml                                | 146 ++++++
 .../org/apache/raft/hadoopRpc/HadoopConstants.java |   0
 .../org/apache/raft/hadoopRpc/HadoopRpcBase.java   |   0
 .../org/apache/raft/hadoopRpc/HadoopUtils.java     |   0
 .../client/HadoopClientRequestSender.java          |   0
 .../RaftClientProtocolClientSideTranslatorPB.java  |   0
 .../hadoopRpc/client/RaftClientProtocolPB.java     |   0
 .../RaftClientProtocolServerSideTranslatorPB.java  |   0
 .../raft/hadoopRpc/server/HadoopRpcService.java    |   0
 .../RaftServerProtocolClientSideTranslatorPB.java  |   0
 .../hadoopRpc/server/RaftServerProtocolPB.java     |   0
 .../RaftServerProtocolServerSideTranslatorPB.java  |   0
 .../raft/hadoopRpc/DelaySendServerRequest.java     |   0
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |   0
 .../apache/raft/hadoopRpc}/TestRaftSnapshot.java   |   7 +-
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |   0
 raft-hadoop/src/test/resources/log4j.properties    |  18 +
 raft-project-dist/pom.xml                          | 151 ++++++
 raft-project/pom.xml                               | 518 +++++++++++++++++++++
 raft-server/pom.xml                                | 180 +++++++
 .../apache/raft/server/ConfigurationManager.java   |   0
 .../java/org/apache/raft/server/FollowerState.java |   0
 .../org/apache/raft/server/LeaderElection.java     |   0
 .../java/org/apache/raft/server/LeaderState.java   |   0
 .../org/apache/raft/server/PendingRequest.java     |   0
 .../apache/raft/server/PendingRequestsHandler.java |   0
 .../org/apache/raft/server/RaftConfiguration.java  |   0
 .../java/org/apache/raft/server/RaftServer.java    |   0
 .../apache/raft/server/RaftServerConfigKeys.java   |   0
 .../apache/raft/server/RaftServerConstants.java    |   0
 .../apache/raft/server/RaftServerException.java    |   0
 .../java/org/apache/raft/server/RaftServerRpc.java |   0
 .../src/main/java/org/apache/raft/server/Role.java |   0
 .../java/org/apache/raft/server/ServerState.java   |   2 +-
 .../apache/raft/server/SimpleConfiguration.java    |   0
 .../java/org/apache/raft/server/StateMachine.java  |   0
 .../apache/raft/server/StateMachineUpdater.java    |   0
 .../raft/server/protocol/AppendEntriesReply.java   |   0
 .../raft/server/protocol/AppendEntriesRequest.java |   0
 .../raft/server/protocol/InstallSnapshotReply.java |   0
 .../server/protocol/InstallSnapshotRequest.java    |   0
 .../raft/server/protocol/RaftServerProtocol.java   |   0
 .../raft/server/protocol/RaftServerReply.java      |   0
 .../raft/server/protocol/RaftServerRequest.java    |   0
 .../raft/server/protocol/RequestVoteReply.java     |   0
 .../raft/server/protocol/RequestVoteRequest.java   |   0
 .../raft/server/protocol/ServerProtoUtils.java     |   0
 .../org/apache/raft/server/protocol/TermIndex.java |   0
 .../apache/raft/server/storage/LogInputStream.java |   0
 .../raft/server/storage/LogOutputStream.java       |   0
 .../org/apache/raft/server/storage/LogReader.java  |   0
 .../org/apache/raft/server/storage/LogSegment.java |   0
 .../apache/raft/server/storage/MemoryRaftLog.java  |   0
 .../org/apache/raft/server/storage/MetaFile.java   |   0
 .../org/apache/raft/server/storage/RaftLog.java    |   0
 .../apache/raft/server/storage/RaftLogCache.java   |   0
 .../apache/raft/server/storage/RaftLogWorker.java  |   0
 .../apache/raft/server/storage/RaftStorage.java    |   0
 .../raft/server/storage/RaftStorageDirectory.java  |   0
 .../raft/server/storage/SegmentedRaftLog.java      |   0
 .../raft/server/storage/SnapshotManager.java       |   0
 .../src/main/proto/RaftServerProtocol.proto        |   0
 .../test/java/org/apache/raft/MiniRaftCluster.java |   0
 .../test/java/org/apache/raft/RaftBasicTests.java  |   0
 .../test/java/org/apache/raft/RaftTestUtil.java    |   0
 .../raft/server/RaftServerCodeInjection.java       |   0
 .../org/apache/raft/server/SimpleStateMachine.java |   2 +-
 .../raft/server/TestRaftReconfiguration.java       |   0
 .../MiniRaftClusterWithSimulatedRpc.java           |   0
 .../raft/server/simulation/RequestHandler.java     |   0
 .../raft/server/simulation/RequestReply.java       |   0
 .../simulation/SimulatedClientRequestReply.java    |   0
 .../server/simulation/SimulatedRequestReply.java   |   0
 .../raft/server/simulation/SimulatedServerRpc.java |   0
 .../simulation/TestRaftWithSimulatedRpc.java       |   0
 .../raft/server/storage/TestRaftLogCache.java      |   0
 .../raft/server/storage/TestRaftLogReadWrite.java  |   0
 .../raft/server/storage/TestRaftLogSegment.java    |   0
 .../raft/server/storage/TestRaftStorage.java       |   0
 .../raft/server/storage/TestSegmentedRaftLog.java  |   0
 raft-server/src/test/resources/log4j.properties    |  18 +
 107 files changed, 1328 insertions(+), 5 deletions(-)

commit ad28c9ab5565b2268129dda69aa6319e3005cb65
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Aug 16 13:23:31 2016 -0700

    Raft: 1. allow RaftServer to add hadoop rpc proxy based on Raft configuration and configuration change. 2. Support restart in MiniRaftCluster.

 .../org/apache/raft/hadoopRpc/HadoopRpcBase.java   | 20 +++--
 .../client/HadoopClientRequestSender.java          |  9 +-
 .../raft/hadoopRpc/server/HadoopRpcService.java    | 13 ++-
 .../java/org/apache/raft/protocol/RaftPeer.java    |  3 +-
 .../apache/raft/server/ConfigurationManager.java   | 11 ++-
 .../org/apache/raft/server/RaftConfiguration.java  |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    | 38 +++++----
 .../java/org/apache/raft/server/RaftServerRpc.java |  4 +
 .../java/org/apache/raft/server/ServerState.java   | 35 ++++++--
 .../raft/server/protocol/ServerProtoUtils.java     |  1 +
 .../raft/server/storage/LogOutputStream.java       |  2 +-
 .../main/java/org/apache/raft/util/RaftUtils.java  |  4 +-
 .../test/java/org/apache/raft/MiniRaftCluster.java | 78 ++++++++++++-----
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    | 80 ++++++++++++------
 .../org/apache/raft/server/SimpleStateMachine.java |  5 +-
 .../raft/server/TestRaftReconfiguration.java       |  2 +-
 .../org/apache/raft/server/TestRaftSnapshot.java   | 97 ++++++++++++----------
 .../MiniRaftClusterWithSimulatedRpc.java           | 42 +++++++---
 .../raft/server/simulation/SimulatedServerRpc.java |  6 ++
 .../raft/server/storage/TestSegmentedRaftLog.java  |  4 +-
 20 files changed, 310 insertions(+), 146 deletions(-)

commit 2dc75ed86fd50c43bde9d28a18c77a6d52ca84d3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 15 15:24:23 2016 -0700

    Remove KerberosInfo from RaftServerProtocol.

 .../java/org/apache/raft/server/protocol/RaftServerProtocol.java     | 5 -----
 1 file changed, 5 deletions(-)

commit ffdaa41f127d58c8d493d7c36ff06802fcea0ba0
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 15 14:41:20 2016 -0700

    Raft: add changes in the last commit.

 .../main/java/org/apache/raft/RaftConstants.java   | 23 ++++++++++++++++++----
 .../java/org/apache/raft/client/RaftClient.java    |  6 +++---
 .../client/HadoopClientRequestSender.java          |  2 --
 .../hadoopRpc/client/RaftClientProtocolPB.java     |  1 -
 .../RaftServerProtocolClientSideTranslatorPB.java  |  3 +--
 .../RaftServerProtocolServerSideTranslatorPB.java  |  6 +-----
 .../java/org/apache/raft/server/FollowerState.java |  4 ++--
 .../org/apache/raft/server/LeaderElection.java     |  8 ++------
 .../java/org/apache/raft/server/LeaderState.java   | 15 +++++++-------
 .../org/apache/raft/server/PendingRequest.java     |  2 +-
 .../apache/raft/server/PendingRequestsHandler.java |  2 +-
 .../java/org/apache/raft/server/RaftServer.java    |  1 -
 .../apache/raft/server/RaftServerConstants.java    | 12 +++++------
 .../java/org/apache/raft/server/ServerState.java   |  8 ++++----
 .../java/org/apache/raft/server/StateMachine.java  |  6 +++---
 .../server/protocol/InstallSnapshotRequest.java    |  1 -
 .../raft/server/protocol/RaftServerProtocol.java   |  1 -
 .../raft/server/protocol/ServerProtoUtils.java     |  2 +-
 .../apache/raft/server/storage/LogInputStream.java |  5 ++---
 .../raft/server/storage/LogOutputStream.java       | 10 ++++------
 .../org/apache/raft/server/storage/LogReader.java  |  8 ++++----
 .../org/apache/raft/server/storage/LogSegment.java |  7 +++----
 .../apache/raft/server/storage/MemoryRaftLog.java  |  5 ++---
 .../org/apache/raft/server/storage/RaftLog.java    |  8 ++++----
 .../apache/raft/server/storage/RaftLogCache.java   |  6 +++---
 .../apache/raft/server/storage/RaftLogWorker.java  |  6 +++---
 .../apache/raft/server/storage/RaftStorage.java    |  6 +++---
 .../raft/server/storage/RaftStorageDirectory.java  |  2 +-
 .../raft/server/storage/SegmentedRaftLog.java      |  4 ++--
 .../test/java/org/apache/raft/MiniRaftCluster.java |  4 ++--
 .../test/java/org/apache/raft/RaftBasicTests.java  |  4 ++--
 .../test/java/org/apache/raft/RaftTestUtil.java    |  8 ++++----
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  4 ++--
 .../org/apache/raft/server/SimpleStateMachine.java | 14 ++++++-------
 .../raft/server/TestRaftReconfiguration.java       |  6 +++---
 .../MiniRaftClusterWithSimulatedRpc.java           |  4 ++--
 .../server/simulation/SimulatedRequestReply.java   |  4 ++--
 .../raft/server/storage/TestRaftLogReadWrite.java  | 20 +++++++++----------
 .../raft/server/storage/TestRaftLogSegment.java    |  8 ++++----
 .../raft/server/storage/TestRaftStorage.java       |  2 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  | 22 ++++++++++-----------
 41 files changed, 130 insertions(+), 140 deletions(-)

commit 77294b5a2b460d8432f3e280b1f0b27ac32782c5
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 15 14:38:58 2016 -0700

    Raft: split RaftConstants into server and client sides.

 .../hadoop-common/src/main/java/org/apache/raft/RaftConstants.java | 7 +++++++
 .../raft/server/{RaftConstants.java => RaftServerConstants.java}   | 0
 2 files changed, 7 insertions(+)

commit 2dfbd5eca52892fd246db09ad46bb1e1c1800783
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Aug 12 18:26:21 2016 -0700

    Raft: add basic InstallSnapshot test and fix bugs.

 .../raft/hadoopRpc/server/HadoopRpcService.java    |  1 +
 .../java/org/apache/raft/server/LeaderState.java   | 55 +++++++++----
 .../java/org/apache/raft/server/RaftServer.java    | 23 +++++-
 .../java/org/apache/raft/server/ServerState.java   | 13 ++-
 .../java/org/apache/raft/server/StateMachine.java  | 12 +++
 .../server/protocol/InstallSnapshotRequest.java    |  1 -
 .../apache/raft/server/storage/MemoryRaftLog.java  |  8 +-
 .../org/apache/raft/server/storage/RaftLog.java    | 25 +-----
 .../apache/raft/server/storage/RaftLogCache.java   |  5 ++
 .../apache/raft/server/storage/RaftLogWorker.java  | 48 ++++++++++-
 .../raft/server/storage/RaftStorageDirectory.java  |  8 +-
 .../raft/server/storage/SegmentedRaftLog.java      | 35 ++++++--
 .../raft/server/storage/SnapshotManager.java       | 11 +--
 .../test/java/org/apache/raft/RaftTestUtil.java    | 31 ++++++++
 .../org/apache/raft/server/SimpleStateMachine.java | 28 ++++++-
 .../raft/server/TestRaftReconfiguration.java       | 32 +-------
 .../org/apache/raft/server/TestRaftSnapshot.java   | 93 +++++++++++++++++++++-
 17 files changed, 334 insertions(+), 95 deletions(-)

commit 71be759679d997a78cfd6160b057a21e623c62a3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 12 15:57:09 2016 -0700

    Raft: do not use RaftConfiguration outside the server package.

 .../ReconfigurationInProgressException.java        | 14 +---------
 .../java/org/apache/raft/server/RaftServer.java    |  4 +--
 .../java/org/apache/raft/server/ServerState.java   |  2 +-
 .../raft/server/protocol/ServerProtoUtils.java     | 32 ++++++++++++++++++++++
 .../org/apache/raft/server/storage/LogSegment.java |  3 +-
 .../apache/raft/server/storage/MemoryRaftLog.java  |  2 +-
 .../org/apache/raft/server/storage/RaftLog.java    |  2 +-
 .../main/java/org/apache/raft/util/ProtoUtils.java | 30 --------------------
 8 files changed, 40 insertions(+), 49 deletions(-)

commit 8fa8d9580e24d329da42bf3e5879232791a5f45e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 12 15:24:47 2016 -0700

    Raft: remove the pb packages.

 .../hadoopRpc/client/RaftClientProtocolClientSideTranslatorPB.java   | 2 +-
 .../hadoopRpc/client/RaftClientProtocolServerSideTranslatorPB.java   | 2 +-
 .../hadoopRpc/server/RaftServerProtocolClientSideTranslatorPB.java   | 4 ++--
 .../hadoopRpc/server/RaftServerProtocolServerSideTranslatorPB.java   | 2 +-
 .../src/main/java/org/apache/raft/protocol/ConfigurationMessage.java | 2 +-
 .../src/main/java/org/apache/raft/server/LeaderElection.java         | 2 +-
 .../src/main/java/org/apache/raft/server/LeaderState.java            | 2 +-
 .../src/main/java/org/apache/raft/server/RaftServer.java             | 2 +-
 .../src/main/java/org/apache/raft/server/ServerState.java            | 4 ++--
 .../org/apache/raft/server/protocol/{pb => }/ServerProtoUtils.java   | 5 ++---
 .../src/main/java/org/apache/raft/server/storage/LogSegment.java     | 2 +-
 .../src/main/java/org/apache/raft/server/storage/MemoryRaftLog.java  | 4 ++--
 .../src/main/java/org/apache/raft/server/storage/RaftLog.java        | 4 ++--
 .../main/java/org/apache/raft/{protocol/pb => util}/ProtoUtils.java  | 2 +-
 .../src/test/java/org/apache/raft/server/TestRaftSnapshot.java       | 2 +-
 .../test/java/org/apache/raft/server/storage/TestRaftLogCache.java   | 2 +-
 .../java/org/apache/raft/server/storage/TestRaftLogReadWrite.java    | 2 +-
 .../test/java/org/apache/raft/server/storage/TestRaftLogSegment.java | 2 +-
 .../java/org/apache/raft/server/storage/TestSegmentedRaftLog.java    | 2 +-
 19 files changed, 24 insertions(+), 25 deletions(-)

commit 4f7908de899757c49fbe232ebeccfa53a2d4f466
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 12 15:19:53 2016 -0700

    Raft: move Hadoop server code to a separated package.

 .../hadoopRpc/{ => server}/HadoopRpcService.java   | 11 +++----
 .../RaftServerProtocolClientSideTranslatorPB.java  |  5 ++-
 .../server}/RaftServerProtocolPB.java              |  3 +-
 .../RaftServerProtocolServerSideTranslatorPB.java  |  3 +-
 .../raft/server/protocol/pb/ServerProtoUtils.java  | 36 +++++++++++-----------
 .../raft/hadoopRpc/DelaySendServerRequest.java     |  1 +
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  1 +
 7 files changed, 30 insertions(+), 30 deletions(-)

commit 6513b30a03f4618591d13bbd75da2e07620eb33e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 12 15:16:16 2016 -0700

    Raft: move Hadoop client code to a separated package.

 .../java/org/apache/raft/hadoopRpc/HadoopRpcBase.java  | 10 +++++-----
 .../org/apache/raft/hadoopRpc/HadoopRpcService.java    |  6 +++---
 .../{ => client}/HadoopClientRequestSender.java        | 10 ++++++----
 .../RaftClientProtocolClientSideTranslatorPB.java      |  5 ++---
 .../pb => hadoopRpc/client}/RaftClientProtocolPB.java  |  2 +-
 .../RaftClientProtocolServerSideTranslatorPB.java      |  3 ++-
 .../java/org/apache/raft/protocol/pb/ProtoUtils.java   | 18 +++++++++---------
 .../raft/hadoopRpc/MiniRaftClusterWithHadoopRpc.java   |  1 +
 8 files changed, 29 insertions(+), 26 deletions(-)

commit 7b2cb0c0ce0b6e7cb5918facba74a25831ff1916
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 12 15:06:18 2016 -0700

    Raft: clean up RaftConstants.

 .../raft/hadoopRpc/HadoopClientRequestSender.java  |  5 +-
 .../org/apache/raft/hadoopRpc/HadoopConstants.java | 59 +---------------------
 .../apache/raft/hadoopRpc/HadoopRpcService.java    |  4 +-
 .../RaftClientProtocolClientSideTranslatorPB.java  |  5 --
 .../raft/protocol/pb/RaftClientProtocolPB.java     |  7 +--
 .../org/apache/raft/server/RaftConfiguration.java  | 12 +++--
 .../java/org/apache/raft/server/RaftConstants.java | 16 ++----
 .../apache/raft/server/SimpleConfiguration.java    |  2 +-
 .../raft/server/protocol/RaftServerProtocol.java   |  5 +-
 .../RaftServerProtocolClientSideTranslatorPB.java  |  5 --
 .../server/protocol/pb/RaftServerProtocolPB.java   |  7 +--
 11 files changed, 31 insertions(+), 96 deletions(-)

commit 89b7ac834b7185f984476ffe4642c1c0ace0de03
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 12 15:04:27 2016 -0700

    Raft: clean up RaftConstants.

 .../org/apache/raft/hadoopRpc/HadoopConstants.java | 84 ++++++++++++++++++++++
 1 file changed, 84 insertions(+)

commit 5113566945ae57742e9b9a527a461b903e86b33c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Aug 11 16:14:58 2016 -0700

    Raft: move org.apache.hadoop.raft to org.apache.raft.

 .../{hadoop => }/raft/client/RaftClient.java       | 17 ++------
 .../raft/client/RaftClientRequestSender.java       |  6 +--
 .../{hadoop => }/raft/conf/RaftProperties.java     | 32 ++------------
 .../raft/hadoopRpc/HadoopClientRequestSender.java  | 14 +++---
 .../{hadoop => }/raft/hadoopRpc/HadoopRpcBase.java |  4 +-
 .../raft/hadoopRpc/HadoopRpcService.java           | 40 ++++++++---------
 .../{hadoop => }/raft/hadoopRpc/HadoopUtils.java   |  4 +-
 .../raft/protocol/ConfigurationMessage.java        |  8 +---
 .../apache/{hadoop => }/raft/protocol/Message.java |  2 +-
 .../raft/protocol/NotLeaderException.java          |  2 +-
 .../raft/protocol/RaftClientProtocol.java          |  2 +-
 .../raft/protocol/RaftClientReply.java             |  2 +-
 .../raft/protocol/RaftClientRequest.java           |  2 +-
 .../{hadoop => }/raft/protocol/RaftException.java  |  2 +-
 .../{hadoop => }/raft/protocol/RaftPeer.java       |  2 +-
 .../{hadoop => }/raft/protocol/RaftRpcMessage.java |  2 +-
 .../ReconfigurationInProgressException.java        |  4 +-
 .../raft/protocol/SetConfigurationRequest.java     |  2 +-
 .../{hadoop => }/raft/protocol/pb/ProtoUtils.java  | 16 +++----
 .../RaftClientProtocolClientSideTranslatorPB.java  | 15 +++----
 .../raft/protocol/pb/RaftClientProtocolPB.java     |  7 ++-
 .../RaftClientProtocolServerSideTranslatorPB.java  | 17 ++++----
 .../raft/server/ConfigurationManager.java          |  8 +---
 .../{hadoop => }/raft/server/FollowerState.java    |  2 +-
 .../{hadoop => }/raft/server/LeaderElection.java   | 19 ++++----
 .../{hadoop => }/raft/server/LeaderState.java      | 50 ++++++++--------------
 .../{hadoop => }/raft/server/PendingRequest.java   | 10 ++---
 .../raft/server/PendingRequestsHandler.java        |  6 +--
 .../raft/server/RaftConfiguration.java             |  4 +-
 .../{hadoop => }/raft/server/RaftConstants.java    |  2 +-
 .../{hadoop => }/raft/server/RaftServer.java       | 44 +++++++------------
 .../raft/server/RaftServerConfigKeys.java          |  5 +--
 .../raft/server/RaftServerException.java           |  4 +-
 .../{hadoop => }/raft/server/RaftServerRpc.java    | 15 +++----
 .../org/apache/{hadoop => }/raft/server/Role.java  |  2 +-
 .../{hadoop => }/raft/server/ServerState.java      | 28 ++++++------
 .../raft/server/SimpleConfiguration.java           | 11 ++---
 .../{hadoop => }/raft/server/StateMachine.java     |  8 ++--
 .../raft/server/StateMachineUpdater.java           | 14 +++---
 .../raft/server/protocol/AppendEntriesReply.java   |  2 +-
 .../raft/server/protocol/AppendEntriesRequest.java |  4 +-
 .../raft/server/protocol/InstallSnapshotReply.java |  4 +-
 .../server/protocol/InstallSnapshotRequest.java    |  4 +-
 .../raft/server/protocol/RaftServerProtocol.java   |  8 ++--
 .../raft/server/protocol/RaftServerReply.java      |  4 +-
 .../raft/server/protocol/RaftServerRequest.java    |  4 +-
 .../raft/server/protocol/RequestVoteReply.java     |  2 +-
 .../raft/server/protocol/RequestVoteRequest.java   |  2 +-
 .../raft/server/protocol/TermIndex.java            |  4 +-
 .../RaftServerProtocolClientSideTranslatorPB.java  | 15 +++----
 .../server/protocol/pb/RaftServerProtocolPB.java   |  6 +--
 .../RaftServerProtocolServerSideTranslatorPB.java  |  9 ++--
 .../raft/server/protocol/pb/ServerProtoUtils.java  | 15 ++++---
 .../raft/server/storage/LogInputStream.java        |  8 ++--
 .../raft/server/storage/LogOutputStream.java       | 14 +++---
 .../raft/server/storage/LogReader.java             | 17 ++------
 .../raft/server/storage/LogSegment.java            | 14 +++---
 .../raft/server/storage/MemoryRaftLog.java         | 12 +++---
 .../{hadoop => }/raft/server/storage/MetaFile.java | 12 ++----
 .../{hadoop => }/raft/server/storage/RaftLog.java  | 18 ++++----
 .../raft/server/storage/RaftLogCache.java          | 18 +++-----
 .../raft/server/storage/RaftLogWorker.java         | 18 ++++----
 .../raft/server/storage/RaftStorage.java           | 17 ++++----
 .../raft/server/storage/RaftStorageDirectory.java  |  6 +--
 .../raft/server/storage/SegmentedRaftLog.java      | 12 +++---
 .../raft/server/storage/SnapshotManager.java       | 12 +++---
 .../raft/util/AtomicFileOutputStream.java          |  8 +---
 .../raft/util/CodeInjectionForTesting.java         |  2 +-
 .../apache/{hadoop => }/raft/util/MD5FileUtil.java | 10 +----
 .../apache/{hadoop => }/raft/util/RaftUtils.java   |  2 +-
 .../hadoop-common/src/main/proto/Raft.proto        |  4 +-
 .../src/main/proto/RaftClientProtocol.proto        |  4 +-
 .../src/main/proto/RaftServerProtocol.proto        |  4 +-
 .../apache/{hadoop => }/raft/MiniRaftCluster.java  | 22 +++++-----
 .../apache/{hadoop => }/raft/RaftBasicTests.java   | 20 ++++-----
 .../org/apache/{hadoop => }/raft/RaftTestUtil.java | 10 ++---
 .../raft/hadoopRpc/DelaySendServerRequest.java     |  8 ++--
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    | 16 +++----
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      | 12 +++---
 .../raft/server/RaftServerCodeInjection.java       |  8 ++--
 .../raft/server/SimpleStateMachine.java            | 12 +++---
 .../raft/server/TestRaftReconfiguration.java       | 30 ++++++-------
 .../{hadoop => }/raft/server/TestRaftSnapshot.java | 24 +++++------
 .../MiniRaftClusterWithSimulatedRpc.java           | 20 ++++-----
 .../raft/server/simulation/RequestHandler.java     |  4 +-
 .../raft/server/simulation/RequestReply.java       |  2 +-
 .../simulation/SimulatedClientRequestReply.java    | 10 ++---
 .../server/simulation/SimulatedRequestReply.java   | 12 +++---
 .../raft/server/simulation/SimulatedServerRpc.java | 16 +++----
 .../simulation/TestRaftWithSimulatedRpc.java       | 10 ++---
 .../raft/server/storage/TestRaftLogCache.java      | 12 +++---
 .../raft/server/storage/TestRaftLogReadWrite.java  | 20 ++++-----
 .../raft/server/storage/TestRaftLogSegment.java    | 20 ++++-----
 .../raft/server/storage/TestRaftStorage.java       | 12 +++---
 .../raft/server/storage/TestSegmentedRaftLog.java  | 20 ++++-----
 95 files changed, 464 insertions(+), 585 deletions(-)

commit d9e70b26990c6b99d4565edf0d2ab3a9aba4e090
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Aug 10 17:31:00 2016 -0700

    Raft: support InstallSnapshot RPC (no tests yet)

 .../apache/hadoop/raft/server/FollowerState.java   |   6 +-
 .../apache/hadoop/raft/server/LeaderElection.java  |  11 +-
 .../org/apache/hadoop/raft/server/LeaderState.java | 122 ++++++++++++--
 .../apache/hadoop/raft/server/RaftConstants.java   |   1 +
 .../org/apache/hadoop/raft/server/RaftServer.java  |  93 ++++++++++-
 .../hadoop/raft/server/RaftServerConfigKeys.java   |   2 +-
 .../org/apache/hadoop/raft/server/ServerState.java |  50 ++++--
 .../apache/hadoop/raft/server/StateMachine.java    |  14 +-
 .../hadoop/raft/server/StateMachineUpdater.java    |  82 +++++++---
 .../raft/server/protocol/InstallSnapshotReply.java |  34 ++++
 .../server/protocol/InstallSnapshotRequest.java    | 106 ++++++++++++
 .../raft/server/protocol/RaftServerProtocol.java   |   2 +
 .../RaftServerProtocolClientSideTranslatorPB.java  |  16 ++
 .../RaftServerProtocolServerSideTranslatorPB.java  |  13 ++
 .../raft/server/protocol/pb/ServerProtoUtils.java  |  45 +++++-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |   7 +
 .../apache/hadoop/raft/server/storage/RaftLog.java |  22 ++-
 .../hadoop/raft/server/storage/RaftLogCache.java   |   5 +-
 .../hadoop/raft/server/storage/RaftLogWorker.java  |  12 +-
 .../hadoop/raft/server/storage/RaftStorage.java    |   5 +-
 .../raft/server/storage/RaftStorageDirectory.java  |  72 +++++++--
 .../raft/server/storage/SegmentedRaftLog.java      |  39 +++--
 .../raft/server/storage/SnapshotManager.java       | 134 +++++++++++++++
 .../org/apache/hadoop/raft/util/MD5FileUtil.java   | 180 +++++++++++++++++++++
 .../org/apache/hadoop/raft/util/RaftUtils.java     |  10 ++
 .../src/main/proto/RaftServerProtocol.proto        |  29 ++++
 .../org/apache/hadoop/raft/RaftBasicTests.java     |   2 -
 .../raft/server/RaftServerCodeInjection.java       |   1 +
 .../hadoop/raft/server/SimpleStateMachine.java     |  33 +++-
 .../hadoop/raft/server/TestRaftSnapshot.java       |   3 +-
 .../raft/server/simulation/SimulatedServerRpc.java |   4 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  |  18 +--
 32 files changed, 1056 insertions(+), 117 deletions(-)

commit dab7c4915da02cf5849aba6fe2c6561f050e5cfb
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Aug 9 16:02:08 2016 -0700

    Raft test: fix bugs in RaftBasicTests.testWithLoad.

 .../org/apache/hadoop/raft/RaftBasicTests.java     | 35 ++++++++++++++--------
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 35 +++++++++++-----------
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |  4 ++-
 .../raft/server/RaftServerCodeInjection.java       | 14 +++++++--
 .../MiniRaftClusterWithSimulatedRpc.java           |  8 +++--
 .../simulation/SimulatedClientRequestReply.java    |  5 ++--
 .../server/simulation/SimulatedRequestReply.java   | 26 ++++++++--------
 .../simulation/TestRaftWithSimulatedRpc.java       | 12 +++++---
 8 files changed, 85 insertions(+), 54 deletions(-)

commit 29a58781dc7338aea37ec5ee09541f8112d320c8
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Aug 5 15:45:22 2016 -0700

    Raft: allow turning off simulated latency.

 .../org/apache/hadoop/raft/server/LeaderState.java |  2 +-
 .../hadoop/raft/server/PendingRequestsHandler.java |  9 ++++---
 .../org/apache/hadoop/raft/RaftBasicTests.java     |  5 ++--
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |  2 ++
 .../server/simulation/SimulatedRequestReply.java   | 30 ++++++++++++++--------
 5 files changed, 30 insertions(+), 18 deletions(-)

commit 33154366ffa76260371e23a59d01e54fac3ba657
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Aug 5 13:31:27 2016 -0700

    Raft test: code clean up for BlockReceiveServerRequest.

 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 13 +++++++
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    | 10 ++---
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      | 11 +++++-
 .../RaftServerCodeInjection.java}                  | 45 +++++++++-------------
 4 files changed, 45 insertions(+), 34 deletions(-)

commit 027a35c3f3da8f4575009bb9d9ad36df7acda3ea
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Aug 4 11:00:26 2016 -0700

    Raft: run testWithLoad with TestRaftWithHadoopRpc.

 .../hadoop/raft/server/PendingRequestsHandler.java |  4 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  3 +
 .../org/apache/hadoop/raft/RaftBasicTests.java     | 53 +++++++++++++++-
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 29 +++++++++
 .../raft/hadoopRpc/DelaySendServerRequest.java     | 15 +++--
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  7 +-
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      |  3 +-
 .../MiniRaftClusterWithSimulatedRpc.java           | 14 ++--
 .../raft/server/simulation/RequestHandler.java     | 33 ++++++++--
 .../server/simulation/SimulatedRequestReply.java   | 74 ++++++++++------------
 .../raft/server/simulation/SimulatedServerRpc.java |  4 +-
 .../simulation/TestRaftWithSimulatedRpc.java       | 71 ---------------------
 .../apache/hadoop/raft/util/BlockForTesting.java   | 39 ------------
 .../raft/util/BlockReceiveServerRequest.java       | 47 +++++++-------
 .../apache/hadoop/raft/util/DelayForTesting.java   | 40 ------------
 .../org/apache/hadoop/raft/util/SrcDstPairs.java   | 51 ---------------
 16 files changed, 192 insertions(+), 295 deletions(-)

commit dd4bdf4ab53c63d977a9a35d0214520c18e02064
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Aug 3 18:03:27 2016 -0700

    Raft: fix bugs to support single node raft ring

 .../apache/hadoop/raft/protocol/pb/ProtoUtils.java |   2 +-
 .../apache/hadoop/raft/server/LeaderElection.java  |  20 ++-
 .../org/apache/hadoop/raft/server/LeaderState.java |   4 +-
 .../apache/hadoop/raft/server/PendingRequest.java  |   7 +-
 .../hadoop/raft/server/PendingRequestsHandler.java |   2 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  |  29 +++-
 .../org/apache/hadoop/raft/server/ServerState.java |  26 ++-
 .../hadoop/raft/server/StateMachineUpdater.java    |   9 +
 .../hadoop/raft/server/storage/MemoryRaftLog.java  | 149 +++++++++++------
 .../apache/hadoop/raft/server/storage/RaftLog.java | 105 +++++++++---
 .../hadoop/raft/server/storage/RaftLogWorker.java  |  19 ++-
 .../hadoop/raft/server/storage/RaftStorage.java    |   3 +-
 .../raft/server/storage/RaftStorageDirectory.java  |   4 +-
 .../raft/server/storage/SegmentedRaftLog.java      | 186 +++++++++++++--------
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |   5 +-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  10 +-
 .../hadoop/raft/server/SimpleStateMachine.java     |  15 +-
 .../hadoop/raft/server/TestRaftSnapshot.java       |  87 ++++++++--
 .../MiniRaftClusterWithSimulatedRpc.java           |  10 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  |  27 ++-
 20 files changed, 506 insertions(+), 213 deletions(-)

commit d4f047eeb6524b985313bbc0583e0e73b2db4812
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Aug 1 16:44:11 2016 -0700

    Raft: add testEnforceLeader to TestRaftWithHadoopRpc.

 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    |  8 +-
 .../RaftClientProtocolClientSideTranslatorPB.java  |  4 +-
 .../apache/hadoop/raft/server/LeaderElection.java  |  2 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 19 ++++-
 .../hadoop/raft/util/CodeInjectionForTesting.java  | 61 +++++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 31 +++++++-
 .../org/apache/hadoop/raft/RaftBasicTests.java     | 10 +++
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 17 ++--
 .../raft/hadoopRpc/DelaySendServerRequest.java     | 68 ++++++++++++++++
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    | 23 +++++-
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      | 16 +++-
 .../MiniRaftClusterWithSimulatedRpc.java           | 47 ++++-------
 .../server/simulation/SimulatedRequestReply.java   | 91 +++++-----------------
 .../simulation/TestRaftWithSimulatedRpc.java       | 17 ++--
 .../apache/hadoop/raft/util/BlockForTesting.java   | 39 ++++++++++
 .../raft/util/BlockReceiveServerRequest.java       | 66 ++++++++++++++++
 .../apache/hadoop/raft/util/DelayForTesting.java   | 40 ++++++++++
 .../org/apache/hadoop/raft/util/SrcDstPairs.java   | 51 ++++++++++++
 18 files changed, 469 insertions(+), 141 deletions(-)

commit 1eed4744c68860907db9ff3feab93a7ca825e1e9
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jul 28 14:28:06 2016 -0700

    Raft: initial implementation to support StateMachine and taking snapshots.

 .../org/apache/hadoop/raft/server/LeaderState.java |  21 ++--
 .../apache/hadoop/raft/server/RaftConstants.java   |  30 +++--
 .../org/apache/hadoop/raft/server/RaftServer.java  |  23 ++--
 .../hadoop/raft/server/RaftServerConfigKeys.java   |  13 ++
 .../org/apache/hadoop/raft/server/ServerState.java |  55 ++++++--
 .../apache/hadoop/raft/server/StateMachine.java    |  74 ++++++++++-
 .../hadoop/raft/server/StateMachineUpdater.java    | 138 +++++++++++++++++++++
 .../hadoop/raft/server/storage/LogInputStream.java |   6 +-
 .../raft/server/storage/LogOutputStream.java       |   4 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |   6 +-
 .../hadoop/raft/server/storage/RaftLogCache.java   |   4 +-
 .../hadoop/raft/server/storage/RaftStorage.java    |  12 +-
 .../raft/server/storage/RaftStorageDirectory.java  |  42 +++++--
 .../raft/server/storage/SegmentedRaftLog.java      |   8 +-
 .../org/apache/hadoop/raft/util/RaftUtils.java     |  34 ++++-
 .../hadoop/raft/server/SimpleStateMachine.java     | 135 ++++++++++++++++++++
 .../hadoop/raft/server/TestRaftSnapshot.java       |  72 +++++++++++
 .../simulation/TestRaftWithSimulatedRpc.java       |   4 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  |  24 ++--
 19 files changed, 618 insertions(+), 87 deletions(-)

commit f66720fb34d1cd7446b207a9124bca47900fe75c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 27 15:17:38 2016 -0700

    Raft: move testBasicAppendEntries to RaftBasicTests.

 .../raft/server/protocol/pb/ServerProtoUtils.java  |  4 ++-
 .../hadoop/raft/server/storage/RaftLogCache.java   |  2 +-
 .../org/apache/hadoop/raft/RaftBasicTests.java     | 33 +++++++++++++++++++++
 .../simulation/TestRaftWithSimulatedRpc.java       | 34 ++++------------------
 4 files changed, 43 insertions(+), 30 deletions(-)

commit 4ca25432be326b6e313c2898b2ba55d3adc69644
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 27 14:33:28 2016 -0700

    Raft: refactor TestRaft.

 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  6 +-
 .../org/apache/hadoop/raft/RaftBasicTests.java     | 68 ++++++++++++++++++++++
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  4 +-
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      | 40 +++----------
 .../simulation/TestRaftWithSimulatedRpc.java}      | 50 +++++-----------
 5 files changed, 94 insertions(+), 74 deletions(-)

commit fe8dddd2561f7fe18eeac03945ad860c65c71d02
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 27 12:09:26 2016 -0700

    Raft: add pb support for RaftClientProtocol.

 .../raft/hadoopRpc/HadoopClientRequestSender.java  | 57 ++++++++++++++++
 .../hadoop/raft/hadoopRpc/HadoopRpcBase.java       |  3 +-
 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    | 19 +++++-
 .../apache/hadoop/raft/hadoopRpc/HadoopUtils.java  | 44 +++++++++++++
 .../raft/protocol/SetConfigurationRequest.java     |  7 +-
 .../apache/hadoop/raft/protocol/pb/ProtoUtils.java | 77 +++++++++++++++++++---
 .../RaftClientProtocolClientSideTranslatorPB.java  | 76 +++++++++++++++++++++
 .../raft/protocol/pb/RaftClientProtocolPB.java     | 38 +++++++++++
 .../RaftClientProtocolServerSideTranslatorPB.java  | 70 ++++++++++++++++++++
 .../apache/hadoop/raft/server/RaftConstants.java   |  4 ++
 .../RaftServerProtocolClientSideTranslatorPB.java  | 18 +----
 .../src/main/proto/RaftClientProtocol.proto        | 50 ++++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  9 ++-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  9 +--
 14 files changed, 443 insertions(+), 38 deletions(-)

commit 9c59708578b89aa5998eaa7332b18e753f81c514
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jul 26 15:33:05 2016 -0700

    Raft: add address to RaftPeerProto and move pb related code from RaftUtils to ProtoUtils.

 .../hadoop/raft/protocol/ConfigurationMessage.java |   5 +-
 .../org/apache/hadoop/raft/protocol/RaftPeer.java  |  12 ++-
 .../apache/hadoop/raft/protocol/pb/ProtoUtils.java | 104 ++++++++++++++++++++-
 .../hadoop/raft/server/RaftConfiguration.java      |   3 +-
 .../org/apache/hadoop/raft/server/ServerState.java |   6 +-
 .../RaftServerProtocolClientSideTranslatorPB.java  |   6 +-
 .../hadoop/raft/server/storage/LogSegment.java     |   3 +-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |   4 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |   8 +-
 .../org/apache/hadoop/raft/util/RaftUtils.java     |  82 +---------------
 .../hadoop-common/src/main/proto/Raft.proto        |   4 +-
 .../raft/server/storage/TestRaftLogCache.java      |   8 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  |  13 +--
 .../raft/server/storage/TestRaftLogSegment.java    |  16 ++--
 .../raft/server/storage/TestSegmentedRaftLog.java  |   6 +-
 15 files changed, 155 insertions(+), 125 deletions(-)

commit 77940a04d429f64b3eba5c7d752fdd0d769d13c6
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jul 25 17:15:13 2016 -0700

    Raft: refactor Hadoop rpc server code.

 .../hadoop/raft/hadoopRpc/HadoopRpcBase.java       | 49 ++++++++++++++++++++++
 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    | 32 +++++++-------
 .../hadoop/raft/protocol/ConfigurationMessage.java |  2 +-
 .../org/apache/hadoop/raft/protocol/Message.java   | 14 +++----
 .../org/apache/hadoop/raft/server/RaftServer.java  |  2 +-
 .../apache/hadoop/raft/server/RaftServerRpc.java   |  3 ++
 .../raft/server/protocol/pb/ServerProtoUtils.java  |  7 +---
 .../org/apache/hadoop/raft/util/RaftUtils.java     |  7 ++--
 .../hadoop-common/src/main/proto/Raft.proto        | 17 ++------
 .../src/main/proto/RaftServerProtocol.proto        |  9 ++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  6 +++
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  6 +--
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    |  2 +-
 .../raft/server/simulation/SimulatedServerRpc.java |  6 +++
 14 files changed, 110 insertions(+), 52 deletions(-)

commit dc52ae96cf18f2a1891f5ff32008a90440c43a4e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jul 25 15:50:34 2016 -0700

    Raft: rename ProtoUtils to ServerProtoUtils.

 .../apache/hadoop/raft/protocol/pb/ProtoUtils.java | 59 ++++++++++++++++++++++
 .../apache/hadoop/raft/server/LeaderElection.java  |  5 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  5 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  |  6 +--
 .../org/apache/hadoop/raft/server/ServerState.java |  4 +-
 .../RaftServerProtocolClientSideTranslatorPB.java  |  9 ++--
 .../RaftServerProtocolServerSideTranslatorPB.java  |  8 +--
 .../pb/{ProtoUtils.java => ServerProtoUtils.java}  | 38 +++-----------
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |  6 +--
 .../apache/hadoop/raft/server/storage/RaftLog.java |  4 +-
 10 files changed, 87 insertions(+), 57 deletions(-)

commit dc52cfd384bfe72b68fe51aaa6039cc065d9cc2c
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jul 22 15:58:50 2016 -0700

    Raft: fix bugs in Hadoop rpc support and add TestRaftWithHadoopRpc.

 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    | 27 ++++----
 .../org/apache/hadoop/raft/protocol/RaftPeer.java  |  8 ++-
 .../apache/hadoop/raft/server/LeaderElection.java  |  3 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  3 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 14 ++--
 .../hadoop/raft/server/RaftServerConfigKeys.java   | 74 +++++++++++++++++++--
 .../org/apache/hadoop/raft/server/ServerState.java | 10 ++-
 .../raft/server/protocol/RaftServerProtocol.java   |  5 ++
 .../hadoop/raft/server/protocol/TermIndex.java     |  2 +
 .../hadoop/raft/server/protocol/pb/ProtoUtils.java | 41 +++++++++---
 .../server/protocol/pb/RaftServerProtocolPB.java   |  5 +-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |  4 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |  6 ++
 .../org/apache/hadoop/raft/util/RaftUtils.java     |  5 --
 .../src/main/proto/RaftServerProtocol.proto        |  4 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 27 ++++++--
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  9 ++-
 .../hadoopRpc/MiniRaftClusterWithHadoopRpc.java    | 75 ++++++++++++++++++++++
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      | 53 +++++++++++++++
 .../raft/server/TestRaftReconfiguration.java       |  7 +-
 20 files changed, 323 insertions(+), 59 deletions(-)

commit 65cc1f726f9f3935a065078b309a7b733a927720
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Jul 21 14:43:16 2016 -0700

    Raft: move MiniRaftClusterWithSimulatedRpc to the raft.server.simulation package.

 .../java/org/apache/hadoop/raft/MiniRaftCluster.java     | 12 +++++++-----
 .../src/test/java/org/apache/hadoop/raft/TestRaft.java   |  1 +
 .../hadoop/raft/server/TestRaftReconfiguration.java      |  2 +-
 .../simulation}/MiniRaftClusterWithSimulatedRpc.java     | 16 +++++++++++-----
 4 files changed, 20 insertions(+), 11 deletions(-)

commit 971eb83036dbe498a34fc180afb578b51d55197a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Jul 21 14:33:24 2016 -0700

    Raft: separate MiniRaftClusterWithSimulatedRpc from MiniRaftCluster.

 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  99 +++++++-------------
 .../raft/MiniRaftClusterWithSimulatedRpc.java      | 101 +++++++++++++++++++++
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  22 +++--
 .../raft/server/TestRaftReconfiguration.java       |  17 ++--
 4 files changed, 156 insertions(+), 83 deletions(-)

commit d7a21c346a9b7352999aa2f12ad8536f6d6e273f
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jul 21 14:00:58 2016 -0700

    Raft: remove unnecessary synchronization in RaftLog

 .../java/org/apache/hadoop/raft/server/LeaderElection.java   |  7 ++++---
 .../main/java/org/apache/hadoop/raft/server/LeaderState.java | 11 ++++++-----
 .../main/java/org/apache/hadoop/raft/server/RaftServer.java  | 12 ++++++++++++
 .../java/org/apache/hadoop/raft/server/StateMachine.java     |  8 ++++++--
 .../java/org/apache/hadoop/raft/server/storage/RaftLog.java  |  6 ++----
 5 files changed, 30 insertions(+), 14 deletions(-)

commit 0ff9f1fbde35d40c3087bcf8e34a56a0f12966ef
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 20 14:34:52 2016 -0700

    Raft: add saveCallInfo to RaftServerRpc.

 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    |  7 +++
 .../apache/hadoop/raft/server/PendingRequest.java  |  4 +-
 .../hadoop/raft/server/PendingRequestsHandler.java | 50 +++++++++++-----------
 .../org/apache/hadoop/raft/server/RaftServer.java  |  4 +-
 .../apache/hadoop/raft/server/RaftServerRpc.java   |  3 ++
 .../raft/hadoopRpc/TestRaftWithHadoopRpc.java      | 21 +++++++++
 .../raft/server/simulation/SimulatedServerRpc.java |  6 +++
 7 files changed, 66 insertions(+), 29 deletions(-)

commit 24f021188dbe464a2434902c75afa78f821d53ef
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 20 13:22:14 2016 -0700

    Raft: waitForReply in submitClientRequest and setConfiguration in RaftClientProtocol.

 .../org/apache/hadoop/raft/client/RaftClient.java  |   6 +-
 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    |   5 +-
 .../org/apache/hadoop/raft/protocol/RaftPeer.java  |   4 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  16 +--
 .../apache/hadoop/raft/server/PendingRequest.java  |  98 ++++++++++++++++++
 .../hadoop/raft/server/PendingRequestsHandler.java | 111 ++++++++-------------
 .../org/apache/hadoop/raft/server/RaftServer.java  |   9 +-
 .../org/apache/hadoop/raft/util/RaftUtils.java     |  10 ++
 .../raft/server/TestRaftReconfiguration.java       |  15 ++-
 9 files changed, 183 insertions(+), 91 deletions(-)

commit a2b2c892c1f8c67a0f6ceeba4381703ce3d96fbf
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Jul 19 15:14:06 2016 -0700

    Raft: enable SegmentedRaftLog in RaftServer and unit tests.

 .../org/apache/hadoop/raft/server/LeaderState.java |  4 +-
 .../hadoop/raft/server/PendingRequestsHandler.java | 20 ++++++--
 .../apache/hadoop/raft/server/RaftConfKeys.java    | 28 -----------
 .../org/apache/hadoop/raft/server/RaftServer.java  |  2 +-
 .../hadoop/raft/server/RaftServerConfigKeys.java   |  6 +++
 .../org/apache/hadoop/raft/server/ServerState.java |  4 +-
 .../hadoop/raft/server/storage/LogInputStream.java |  4 +-
 .../raft/server/storage/LogOutputStream.java       |  2 +-
 .../hadoop/raft/server/storage/LogReader.java      |  2 +-
 .../hadoop/raft/server/storage/LogSegment.java     |  2 +-
 .../hadoop/raft/server/storage/RaftLogWorker.java  |  8 +++-
 .../hadoop/raft/server/storage/RaftStorage.java    |  8 ++--
 .../raft/server/storage/SegmentedRaftLog.java      |  3 +-
 .../org/apache/hadoop/raft/util/RaftUtils.java     | 55 ++++++++++++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 44 ++++++++++++-----
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  4 +-
 .../raft/server/TestRaftReconfiguration.java       |  4 +-
 .../server/simulation/SimulatedRequestReply.java   |  8 ++--
 .../raft/server/storage/TestRaftLogReadWrite.java  | 50 ++++++++++++++++++--
 .../raft/server/storage/TestRaftLogSegment.java    | 10 ++--
 .../raft/server/storage/TestRaftStorage.java       |  4 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  |  4 +-
 22 files changed, 194 insertions(+), 82 deletions(-)

commit 59d956ed35dfe423b96c49157bf49a3fbe4f10be
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Jul 18 16:26:58 2016 -0700

    Raft: add RaftServerProtocol pb support.

 .../hadoop/raft/hadoopRpc/HadoopRpcService.java    | 129 ++++++++++++++
 .../org/apache/hadoop/raft/protocol/RaftPeer.java  |   9 +-
 .../apache/hadoop/raft/server/RaftConstants.java   |   8 +-
 .../hadoop/raft/server/RaftServerConfigKeys.java   |  29 ++++
 .../raft/server/protocol/RaftServerProtocol.java   |   2 -
 .../hadoop/raft/server/protocol/pb/ProtoUtils.java | 187 +++++++++++++++++++++
 .../RaftServerProtocolClientSideTranslatorPB.java  |  88 ++++++++++
 .../server/protocol/pb/RaftServerProtocolPB.java   |  36 ++++
 .../RaftServerProtocolServerSideTranslatorPB.java  |  62 +++++++
 .../hadoop-common/src/main/proto/Raft.proto        |  28 +++
 .../src/main/proto/RaftServerProtocol.proto        |  64 +++++++
 .../raft/server/simulation/RequestReply.java       |   2 +-
 12 files changed, 639 insertions(+), 5 deletions(-)

commit 18d3f645cd228c1132df48751d6550a2889dda8f
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Jul 18 15:32:13 2016 -0700

    Raft: add RaftProperties and allow using SegmentedRaftLog in RaftServer.

 .../apache/hadoop/raft/conf/RaftProperties.java    | 1882 ++++++++++++++++++++
 .../hadoop/raft/server/ConfigurationManager.java   |    7 +-
 .../apache/hadoop/raft/server/LeaderElection.java  |   21 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |   10 +-
 .../apache/hadoop/raft/server/RaftConfKeys.java    |   28 +
 .../org/apache/hadoop/raft/server/RaftServer.java  |   54 +-
 .../org/apache/hadoop/raft/server/ServerState.java |   52 +-
 .../hadoop/raft/server/storage/LogSegment.java     |   11 +-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |   15 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |   40 +-
 .../hadoop/raft/server/storage/RaftLogWorker.java  |    3 +-
 .../hadoop/raft/server/storage/RaftStorage.java    |   18 +-
 .../raft/server/storage/SegmentedRaftLog.java      |   33 +-
 .../org/apache/hadoop/raft/util/RaftUtils.java     |    7 +
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |   23 +-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |    6 +-
 .../raft/server/TestRaftReconfiguration.java       |   23 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  |   13 +-
 .../raft/server/storage/TestRaftLogSegment.java    |   11 +-
 .../raft/server/storage/TestRaftStorage.java       |   25 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  |   29 +-
 21 files changed, 2183 insertions(+), 128 deletions(-)

commit a749f1a2a1b73161b53ad1e04a871142f6aa6460
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Jul 15 14:40:55 2016 -0700

    Raft: move RequestReply to test and rename RaftCommunicationSystem to RaftServerRpc.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  5 ++--
 .../raft/client/RaftClientRequestSender.java       | 27 ++++++++++++++++++
 .../apache/hadoop/raft/server/LeaderElection.java  |  2 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  2 +-
 .../hadoop/raft/server/PendingRequestsHandler.java |  4 +--
 .../org/apache/hadoop/raft/server/RaftServer.java  | 18 ++++++------
 ...CommunicationSystem.java => RaftServerRpc.java} |  2 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 11 ++++----
 .../raft/server/simulation/RequestHandler.java     |  1 -
 .../raft/server/simulation}/RequestReply.java      |  2 +-
 .../simulation/SimulatedClientRequestReply.java    | 33 ++++++++++++++++++++++
 .../server/simulation/SimulatedRequestReply.java   |  1 -
 ...nicationSystem.java => SimulatedServerRpc.java} | 11 ++++----
 13 files changed, 87 insertions(+), 32 deletions(-)

commit f6a96a8b14ab95a6b03692abc6f97b629f7c6d04
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jul 14 15:45:26 2016 -0700

    Raft: add more tests for SegmentedRaftLog, fix bug of logSync.

 .../apache/hadoop/raft/server/LeaderElection.java  |   4 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |   2 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  |   4 +-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |   2 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |   5 +-
 .../hadoop/raft/server/storage/RaftLogCache.java   |   5 +
 .../hadoop/raft/server/storage/RaftLogWorker.java  |  64 ++++++-------
 .../raft/server/storage/SegmentedRaftLog.java      |  43 ++++++++-
 .../raft/server/storage/TestSegmentedRaftLog.java  | 102 ++++++++++++++++++++-
 9 files changed, 174 insertions(+), 57 deletions(-)

commit 21ef561b07e46d907cf26fd5b353b13ea73fdc5d
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Jul 13 18:19:35 2016 -0700

    Raft: support async logSync for SegmentedRaftLog

 .../apache/hadoop/raft/server/LeaderElection.java  |   4 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |   6 +-
 .../apache/hadoop/raft/server/RaftConstants.java   |   2 +
 .../org/apache/hadoop/raft/server/RaftServer.java  |  18 ++-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |   9 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |  11 +-
 .../hadoop/raft/server/storage/RaftLogWorker.java  |  97 ++++++++++++--
 .../raft/server/storage/SegmentedRaftLog.java      |  16 ++-
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |   1 -
 .../raft/server/storage/TestRaftLogReadWrite.java  |   2 +-
 .../raft/server/storage/TestRaftLogSegment.java    |   2 +-
 .../raft/server/storage/TestSegmentedRaftLog.java  | 148 +++++++++++++++++++++
 12 files changed, 287 insertions(+), 29 deletions(-)

commit 8311ffb7b12c03ea02edb81e64adb6911d7ce8fb
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 13 17:53:30 2016 -0700

    Raft: rename RaftRequestHandlers to SimulatedCommunicationSystem.

 .../test/java/org/apache/hadoop/raft/MiniRaftCluster.java    |  5 ++---
 ...equestHandlers.java => SimulatedCommunicationSystem.java} | 12 +++++-------
 2 files changed, 7 insertions(+), 10 deletions(-)

commit 74b9484dd0786d5a41ee6288f43fc031edd11250
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 13 17:41:45 2016 -0700

    Raft: move RaftRequestHandlers and RequestHandler to test.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  6 +--
 .../apache/hadoop/raft/server/LeaderElection.java  |  2 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  2 +-
 .../hadoop/raft/server/PendingRequestsHandler.java |  4 +-
 .../raft/server/RaftCommunicationSystem.java       | 41 +++++++++++++++
 .../org/apache/hadoop/raft/server/RaftServer.java  | 31 ++++++-----
 .../apache/hadoop/raft/server/RequestReply.java    |  9 ++--
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 61 +++++++++-------------
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  6 +--
 .../raft/server/TestRaftReconfiguration.java       |  1 +
 .../server/simulation}/RaftRequestHandlers.java    | 32 +++++++-----
 .../raft/server/simulation}/RequestHandler.java    | 11 ++--
 .../server/simulation/SimulatedRequestReply.java   | 14 ++---
 13 files changed, 131 insertions(+), 89 deletions(-)

commit db25532947f66868a89a648ea2d69ace78e64284
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 13 17:05:46 2016 -0700

    Raft: rename RaftRpc to RequestReply.

 .../org/apache/hadoop/raft/server/{RaftRpc.java => RequestReply.java} | 0
 .../simulation/{SimulatedRpc.java => SimulatedRequestReply.java}      | 4 ++--
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 7980f128694570709de82b8d106da078ff31c3cb
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Jul 13 16:49:04 2016 -0700

    Raft: Change RaftServerProtocol to use RequestVoteRequest and AppendEntriesRequest in the parameters.

 .../hadoop/raft/protocol/RaftClientProtocol.java   |  2 +-
 .../apache/hadoop/raft/server/LeaderElection.java  |  6 ++--
 .../org/apache/hadoop/raft/server/LeaderState.java |  8 +++--
 .../hadoop/raft/server/RaftRequestHandlers.java    | 19 ++++-------
 .../org/apache/hadoop/raft/server/RaftServer.java  | 39 ++++++++--------------
 .../raft/server/protocol/AppendEntriesRequest.java |  4 +++
 .../raft/server/protocol/RaftServerProtocol.java   |  7 ++--
 .../raft/server/protocol/RequestVoteRequest.java   |  4 +--
 8 files changed, 36 insertions(+), 53 deletions(-)

commit 1adde6ee88853e2b97b8a52bb5fce27ffa800470
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Jul 12 18:43:17 2016 -0700

    Raft: add tests for RaftLogCache and fix bugs

 .../hadoop/raft/server/storage/LogSegment.java     |  19 +-
 .../hadoop/raft/server/storage/RaftLogCache.java   |  67 ++++--
 .../hadoop/raft/server/storage/RaftLogWorker.java  |   6 +
 .../raft/server/storage/SegmentedRaftLog.java      |   4 +-
 .../raft/server/storage/TestRaftLogCache.java      | 253 +++++++++++++++++++++
 5 files changed, 318 insertions(+), 31 deletions(-)

commit 8c4b6090f3a72259daaa840fdd2ec713a2dc5e79
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue Jul 12 14:28:30 2016 -0700

    Raft: move request handler related code out from RaftServer.

 .../hadoop/raft/server/PendingRequestsHandler.java |   4 +-
 .../hadoop/raft/server/RaftRequestHandlers.java    | 114 +++++++++++++++++++++
 .../org/apache/hadoop/raft/server/RaftServer.java  |  84 +++------------
 .../apache/hadoop/raft/server/RequestHandler.java  |  25 ++---
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |   2 +-
 5 files changed, 139 insertions(+), 90 deletions(-)

commit 26d15107a46260a41822f1e13f3d573b3ba0834f
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Jul 12 14:25:31 2016 -0700

    Raft: add unit tests for LogSegment.

 .../hadoop/raft/server/storage/LogSegment.java     |  19 +-
 .../hadoop/raft/server/storage/RaftLogCache.java   |   2 +-
 .../raft/server/storage/TestRaftLogSegment.java    | 202 +++++++++++++++++++++
 .../raft/server/storage/TestSegmentedRaftLog.java  |  22 +++
 4 files changed, 238 insertions(+), 7 deletions(-)

commit d2726fe8bb99f9a46d93d2bdf13dfb2a24e1a570
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Jul 12 11:38:39 2016 -0700

    Raft: SegmentedRaftLog implementation (WIP).

 .../org/apache/hadoop/raft/server/LeaderState.java |   3 +-
 .../apache/hadoop/raft/server/RaftConstants.java   |   5 +-
 .../hadoop/raft/server/storage/FileLogManager.java | 215 --------------------
 .../hadoop/raft/server/storage/LogInputStream.java |  86 ++++----
 .../raft/server/storage/LogOutputStream.java       |  14 +-
 .../hadoop/raft/server/storage/LogReader.java      |  42 ++--
 .../hadoop/raft/server/storage/LogSegment.java     |  96 ++++++---
 .../hadoop/raft/server/storage/MemoryRaftLog.java  |  49 +++--
 .../hadoop/raft/server/storage/MetaFile.java       |   5 +-
 .../apache/hadoop/raft/server/storage/RaftLog.java |  46 +++--
 .../hadoop/raft/server/storage/RaftLogCache.java   | 219 ++++++++++++++++++++-
 .../hadoop/raft/server/storage/RaftLogWorker.java  | 160 ++++++++++-----
 .../hadoop/raft/server/storage/RaftStorage.java    |  45 +++--
 .../raft/server/storage/RaftStorageDirectory.java  |  24 ++-
 .../raft/server/storage/SegmentedRaftLog.java      |  83 ++++++--
 .../org/apache/hadoop/raft/util/RaftUtils.java     |   9 +
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  16 ++
 .../test/java/org/apache/hadoop/raft/TestRaft.java |   5 +-
 .../raft/server/TestRaftReconfiguration.java       |   5 +-
 .../raft/server/storage/TestRaftLogReadWrite.java  | 209 ++++++++++++++++++++
 .../raft/server/storage/TestRaftStorage.java       | 182 +++++++++++++++++
 21 files changed, 1094 insertions(+), 424 deletions(-)

commit bb671d1117d45b365606bcb85706d06c9057da4e
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Jul 6 10:50:32 2016 -0700

    Raft: use LogEntryProto to replace RaftLogEntry and ConfigurationEntry.

 .../apache/hadoop/raft/server/LeaderElection.java  |  4 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  8 ++-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 36 +++++++++++-
 .../org/apache/hadoop/raft/server/ServerState.java | 22 +++----
 .../apache/hadoop/raft/server/StateMachine.java    |  4 +-
 .../raft/server/protocol/AppendEntriesRequest.java |  8 ++-
 .../raft/server/protocol/ConfigurationEntry.java   | 44 --------------
 .../hadoop/raft/server/protocol/RaftLogEntry.java  | 68 ----------------------
 .../raft/server/protocol/RaftServerProtocol.java   |  4 +-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  | 25 ++++----
 .../apache/hadoop/raft/server/storage/RaftLog.java | 29 +++++----
 .../raft/server/storage/SegmentedRaftLog.java      | 12 ++--
 .../org/apache/hadoop/raft/util/RaftUtils.java     | 40 ++++++++-----
 .../hadoop-common/src/main/proto/Raft.proto        |  6 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 11 ++--
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 13 +++--
 16 files changed, 139 insertions(+), 195 deletions(-)

commit 178cd6fece4a5214112cfc8bcecba1fc23830b15
Author: Jing Zhao <jing9@apache.org>
Date:   Tue Jul 5 15:26:57 2016 -0700

    Raft: add ConfigurationManager to track Configuration changes. No longer record previous configuraiton in raft log entry.

 .../hadoop/raft/server/ConfigurationManager.java   | 85 +++++++++++++++++++++
 .../org/apache/hadoop/raft/server/LeaderState.java | 12 +--
 .../hadoop/raft/server/RaftConfiguration.java      | 15 +++-
 .../org/apache/hadoop/raft/server/RaftServer.java  |  7 +-
 .../org/apache/hadoop/raft/server/ServerState.java | 46 ++++++++----
 .../raft/server/protocol/ConfigurationEntry.java   | 26 ++-----
 .../hadoop/raft/server/protocol/RaftLogEntry.java  | 11 ++-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  | 34 +++------
 .../apache/hadoop/raft/server/storage/RaftLog.java | 18 ++---
 .../raft/server/storage/SegmentedRaftLog.java      |  9 +--
 .../org/apache/hadoop/raft/util/RaftUtils.java     | 39 ++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  6 +-
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  8 +-
 .../raft/server/TestRaftReconfiguration.java       | 86 ++++++++++++++++++++--
 14 files changed, 293 insertions(+), 109 deletions(-)

commit b8f29fad784e84b932fade540933dafaa1b8e587
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Jul 1 18:49:59 2016 -0700

    Raft: add initial Segmented Log implementation.

 .../hadoop/raft/protocol/ConfigurationMessage.java |   2 +-
 .../apache/hadoop/raft/server/RaftConstants.java   |  26 +-
 .../hadoop/raft/server/storage/FileLogManager.java | 215 ++++++++++++++
 .../hadoop/raft/server/storage/LogInputStream.java | 227 ++++++++++++++-
 .../raft/server/storage/LogOutputStream.java       |   6 +-
 .../hadoop/raft/server/storage/LogReader.java      |  54 +++-
 .../hadoop/raft/server/storage/LogSegment.java     |  69 ++++-
 .../hadoop/raft/server/storage/MetaFile.java       | 118 ++++++++
 .../hadoop/raft/server/storage/RaftLogCache.java   |  82 ++++++
 .../hadoop/raft/server/storage/RaftStorage.java    |  84 ++++++
 .../raft/server/storage/RaftStorageDirectory.java  | 317 +++++++++++++++++++++
 .../raft/server/storage/SegmentedRaftLog.java      | 118 ++++++++
 .../hadoop/raft/util/AtomicFileOutputStream.java   | 118 ++++++++
 .../apache/hadoop/raft/{ => util}/RaftUtils.java   |   2 +-
 .../raft/server/simulation/SimulatedRpc.java       |   2 +-
 15 files changed, 1406 insertions(+), 34 deletions(-)

commit 34cfd9829644f1ce32e64ea5d7442f75ce9625ef
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jun 23 14:33:32 2016 -0700

    Raft: add an abstract base class for RaftLog, rename the original implemetation to MemoryRaftLog.

 .../org/apache/hadoop/raft/server/LeaderState.java |   7 +-
 .../org/apache/hadoop/raft/server/RaftLog.java     | 178 ---------------------
 .../org/apache/hadoop/raft/server/RaftServer.java  |   2 +-
 .../org/apache/hadoop/raft/server/ServerState.java |  10 +-
 .../hadoop/raft/server/storage/MemoryRaftLog.java  | 123 ++++++++++++++
 .../apache/hadoop/raft/server/storage/RaftLog.java | 173 ++++++++++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  10 +-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |   4 +-
 .../raft/server/TestRaftReconfiguration.java       |   4 +-
 9 files changed, 320 insertions(+), 191 deletions(-)

commit df2e59dd0092a55a34cb0a0e1a3a7aaac063e566
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jun 23 13:29:55 2016 -0700

    Raft: add basic LogReader/LogOutputStream/LogWorker definition.

 .../java/org/apache/hadoop/raft/RaftUtils.java     |  30 +++
 .../hadoop/raft/protocol/ConfigurationMessage.java |  12 +-
 .../hadoop/raft/server/RaftConfiguration.java      |   8 +
 .../apache/hadoop/raft/server/RaftConstants.java   |  10 +
 .../org/apache/hadoop/raft/server/RaftLog.java     |   5 +-
 .../apache/hadoop/raft/server/StateMachine.java    |  26 ++
 .../hadoop/raft/server/storage/LogInputStream.java |  22 ++
 .../raft/server/storage/LogOutputStream.java       | 145 +++++++++++
 .../hadoop/raft/server/storage/LogReader.java      | 277 +++++++++++++++++++++
 .../hadoop/raft/server/storage/LogSegment.java     | 113 +++++++++
 .../hadoop/raft/server/storage/RaftLogWorker.java  | 177 +++++++++++++
 .../hadoop-common/src/main/proto/Raft.proto        |   3 +-
 12 files changed, 816 insertions(+), 12 deletions(-)

commit 8d9dc5d310479d0b471fa39e5458e58688d28ab2
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Jun 15 14:58:20 2016 -0700

    Raft: 1. rename Entry to RaftLogEntry. 2. Update Message interface. 3. Add protobuf definition for Raft log entry.

 .../hadoop/raft/protocol/ConfigurationMessage.java | 12 +++++
 .../org/apache/hadoop/raft/protocol/Message.java   | 10 +++-
 .../org/apache/hadoop/raft/server/LeaderState.java |  4 +-
 .../hadoop/raft/server/RaftConfiguration.java      |  1 -
 .../org/apache/hadoop/raft/server/RaftLog.java     | 24 ++++-----
 .../org/apache/hadoop/raft/server/RaftServer.java  |  6 +--
 .../org/apache/hadoop/raft/server/ServerState.java |  4 +-
 .../raft/server/protocol/AppendEntriesRequest.java |  6 +--
 .../raft/server/protocol/ConfigurationEntry.java   |  2 +-
 .../protocol/{Entry.java => RaftLogEntry.java}     |  8 +--
 .../raft/server/protocol/RaftServerProtocol.java   |  2 +-
 .../hadoop-common/src/main/proto/Raft.proto        | 59 ++++++++++++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  4 +-
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 20 ++++++--
 14 files changed, 126 insertions(+), 36 deletions(-)

commit e853abcd4fb42b4c3f221f098e1a1935dbbe60d4
Author: Jing Zhao <jing9@apache.org>
Date:   Wed Jun 15 13:08:55 2016 -0700

    Raft: 1. no longer add dummy entry at the head of the raft log. 2. Send explicit notification from LeaderState to PendingRquestsHandler for sending responses to client.

 .../org/apache/hadoop/raft/protocol/Message.java     |  2 ++
 .../org/apache/hadoop/raft/server/LeaderState.java   |  2 ++
 .../hadoop/raft/server/PendingRequestsHandler.java   | 10 ++++++++--
 .../java/org/apache/hadoop/raft/server/RaftLog.java  | 20 +++-----------------
 .../org/apache/hadoop/raft/server/RaftServer.java    |  7 ++++++-
 .../apache/hadoop/raft/server/protocol/Entry.java    | 14 +++++++++++++-
 .../test/java/org/apache/hadoop/raft/TestRaft.java   |  2 +-
 7 files changed, 35 insertions(+), 22 deletions(-)

commit 0b97937ef00269cf16f67152166c946c4ea89955
Author: Li Lu <llu@HW11074.local>
Date:   Tue Jun 14 14:43:29 2016 -0700

    Raft: test related changes.
    
    1. Add a test case to perform load test for raft cluster.
    
    2. Refactor SimulatedRPC to expose template methods for unit tests.

 .../org/apache/hadoop/raft/MiniRaftCluster.java    |   5 +-
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  19 ++++
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  62 +++++++++++-
 .../raft/server/simulation/SimulatedRpc.java       | 105 +++++++++++++--------
 4 files changed, 147 insertions(+), 44 deletions(-)

commit 0c1028cfdd27f04de76d3cbed455112beb259784
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Jun 13 15:34:23 2016 -0700

    Raft: fix a bug to make sure reponse is sent for setConfiguration request.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  7 ++++++
 .../org/apache/hadoop/raft/server/LeaderState.java |  1 +
 .../hadoop/raft/server/PendingRequestsHandler.java |  2 +-
 .../org/apache/hadoop/raft/server/RaftLog.java     |  2 +-
 .../raft/server/protocol/AppendEntriesReply.java   |  3 ++-
 .../raft/server/protocol/RaftServerReply.java      |  2 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  5 ++++-
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  3 ---
 .../raft/server/TestRaftReconfiguration.java       | 26 ++++++++++++++--------
 9 files changed, 34 insertions(+), 17 deletions(-)

commit b52a7788628de987242b636826bb114d2237e6ed
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Jun 13 12:10:01 2016 -0700

    Raft: 1. add progress check for setConfiguration. 2. Add 5.3 optimization for AppendEntries.

 .../org/apache/hadoop/raft/client/RaftClient.java  |   2 +
 .../hadoop/raft/protocol/RaftRpcMessage.java       |   5 +
 .../org/apache/hadoop/raft/server/LeaderState.java | 128 +++++++++++++--------
 .../apache/hadoop/raft/server/RaftConstants.java   |   3 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  |  18 ++-
 .../raft/server/protocol/AppendEntriesReply.java   |   4 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  24 ++--
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |   3 +
 .../raft/server/TestRaftReconfiguration.java       |  82 ++++++++++++-
 9 files changed, 197 insertions(+), 72 deletions(-)

commit 00c45d84cfaaf15fd358f47520f3815ea459a4da
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Jun 10 15:49:32 2016 -0700

    Raft: reenable TestRaftReconfiguration#testKillLeaderDuringReconf

 .../main/java/org/apache/hadoop/raft/server/LeaderState.java |  2 +-
 .../test/java/org/apache/hadoop/raft/MiniRaftCluster.java    |  3 ++-
 .../apache/hadoop/raft/server/TestRaftReconfiguration.java   | 12 ++++++------
 .../apache/hadoop/raft/server/simulation/SimulatedRpc.java   |  7 +++++--
 4 files changed, 14 insertions(+), 10 deletions(-)

commit 5fe896457837de78aa0adb1602b3c502939cc22c
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Jun 10 14:47:38 2016 -0700

    Raft: do not require running state check when killing a server.

 .../main/java/org/apache/hadoop/raft/server/RaftServer.java  |  6 +++++-
 .../test/java/org/apache/hadoop/raft/MiniRaftCluster.java    |  5 +++--
 .../apache/hadoop/raft/server/TestRaftReconfiguration.java   | 12 ++++++------
 3 files changed, 14 insertions(+), 9 deletions(-)

commit 6eae027551dba008803d227ca797459b2ad4a52f
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Jun 10 10:53:33 2016 -0700

    Raft: 1. Peers in INITIALIZING state should not call for vote. 2. Add explicit AppendResult for AppendEntriesReply. 3. Add support in RaftClient to update its server list based on NotLeaderException. 4. Remove corresponding event queue from SimulateRpc after killing a server.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  27 +++--
 .../hadoop/raft/protocol/NotLeaderException.java   |  14 ++-
 .../apache/hadoop/raft/server/LeaderElection.java  |   2 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |  21 ++--
 .../hadoop/raft/server/RaftConfiguration.java      |   4 +
 .../org/apache/hadoop/raft/server/RaftRpc.java     |   2 +
 .../org/apache/hadoop/raft/server/RaftServer.java  | 127 +++++++++++++++------
 .../apache/hadoop/raft/server/RequestHandler.java  |   4 +
 .../raft/server/protocol/AppendEntriesReply.java   |  53 +++++++++
 .../raft/server/protocol/AppendEntriesRequest.java |  18 ++-
 .../raft/server/protocol/RaftServerProtocol.java   |  10 +-
 .../raft/server/protocol/RaftServerReply.java      |   3 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  15 +--
 .../raft/server/TestRaftReconfiguration.java       |   2 +-
 .../raft/server/simulation/SimulatedRpc.java       |  25 +++-
 15 files changed, 253 insertions(+), 74 deletions(-)

commit 164182cd8be2edecc1732caf2c1d4dcc2f6b1af9
Author: Jing Zhao <jing9@apache.org>
Date:   Thu Jun 9 12:57:09 2016 -0700

    Raft: add suggested Leader in NotLeaderException.

 .../org/apache/hadoop/raft/client/RaftClient.java  | 27 ++++++++++++++++++----
 .../hadoop/raft/protocol/NotLeaderException.java   | 12 +++++-----
 .../org/apache/hadoop/raft/server/LeaderState.java | 18 +++++++++++----
 .../hadoop/raft/server/RaftConfiguration.java      |  9 ++++++++
 .../org/apache/hadoop/raft/server/RaftLog.java     |  1 -
 .../org/apache/hadoop/raft/server/RaftRpc.java     |  6 ++---
 .../org/apache/hadoop/raft/server/RaftServer.java  | 14 +++++++----
 .../raft/server/TestRaftReconfiguration.java       | 10 ++++----
 .../raft/server/simulation/SimulatedRpc.java       | 18 +++++++++++----
 9 files changed, 82 insertions(+), 33 deletions(-)

commit cb50fdeab414dd43c73bb17ed0d617d45f35b2ad
Author: Li Lu <llu@HW11074.local>
Date:   Thu Jun 9 21:34:38 2016 -0700

    Replace ServerState in RaftLog with selfId.

 .../main/java/org/apache/hadoop/raft/server/RaftLog.java  | 15 ++++++---------
 .../java/org/apache/hadoop/raft/server/ServerState.java   |  8 +++-----
 2 files changed, 9 insertions(+), 14 deletions(-)

commit 1c1ff9e53fec5fa8a48f642b2dd30fe9afde0e6c
Author: Li Lu <llu@HW11074.local>
Date:   Thu Jun 9 17:49:50 2016 -0700

    Test related updates:
    1. Add "blacklist" support for SimulatedRPC to selectively block RPCs between two servers.
    2. Add a test utility method to try enforcing the log data for Raft servers.
    
    More tests coming...

 .../org/apache/hadoop/raft/server/RaftLog.java     | 11 +++++-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 13 +++++++
 .../org/apache/hadoop/raft/server/ServerState.java | 25 ++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 20 ++++++++++
 .../raft/server/simulation/SimulatedRpc.java       | 44 ++++++++++++++++++++--
 5 files changed, 108 insertions(+), 5 deletions(-)

commit 702d30c1e869a0885606934d68c6fb0fa6cc0684
Author: Jing Zhao <jing9@apache.org>
Date:   Mon Jun 6 15:08:39 2016 -0700

    Raft: add new bootstrapping stage for reconfiguration.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  48 ++++-
 .../hadoop/raft/protocol/RaftClientReply.java      |   4 +-
 .../hadoop/raft/protocol/RaftRpcMessage.java       |   9 +-
 .../org/apache/hadoop/raft/server/LeaderState.java | 225 +++++++++++++++++----
 .../hadoop/raft/server/PendingRequestsHandler.java |  92 +++++++--
 .../hadoop/raft/server/RaftConfiguration.java      |  12 +-
 .../apache/hadoop/raft/server/RaftConstants.java   |   8 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  |  28 +--
 .../raft/server/protocol/RaftServerReply.java      |  10 +-
 .../raft/server/TestRaftReconfiguration.java       |  41 +++-
 10 files changed, 366 insertions(+), 111 deletions(-)

commit 5ff26d2d5abc62fb81696f522d3f4b8ecdb7ee5f
Author: Jing Zhao <jing9@apache.org>
Date:   Tue May 31 18:47:26 2016 -0700

    Raft: minor rename in RaftConfiguration.

 .../hadoop/raft/protocol/ConfigurationMessage.java | 10 +++----
 .../raft/protocol/SetConfigurationRequest.java     | 10 +++----
 .../hadoop/raft/server/RaftConfiguration.java      | 32 ++++++++--------------
 .../org/apache/hadoop/raft/server/RaftServer.java  |  8 +++---
 4 files changed, 26 insertions(+), 34 deletions(-)

commit f7eb39e0f7b01c7c73e1f6068ba53bb27fd0087d
Author: Li Lu <llu@HW11074.local>
Date:   Thu Jun 2 16:54:31 2016 -0700

    Added a utility method to MiniRaftCluster to enforce a server to be a leader, if possible.

 .../apache/hadoop/raft/server/RaftConstants.java   |  5 ++-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 51 ++++++++++++++++++++++
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 17 ++++++++
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  8 ++++
 .../raft/server/simulation/SimulatedRpc.java       | 39 +++++++++++++++++
 5 files changed, 119 insertions(+), 1 deletion(-)

commit 88012e03c1ffc90d8c71ea1942f186cfd1c42db3
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu May 26 13:31:39 2016 -0700

    Raft: Move SimulatedRpc to test.

 .../java/org/apache/hadoop/raft/server/simulation/SimulatedRpc.java   | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit d07cf12e89f0dfd9771fa0ac08215facf4dfd422
Author: Jing Zhao <jing9@apache.org>
Date:   Wed May 25 15:50:45 2016 -0700

    Raft: Move PendingRequestsHandler to LeaderState. Update term/leaderId/votedFor when changing to follower.

 .../apache/hadoop/raft/server/LeaderElection.java  |  66 ++++++---
 .../org/apache/hadoop/raft/server/LeaderState.java | 116 ++++++++++-----
 .../hadoop/raft/server/PendingRequestsHandler.java | 137 ++++++++++++++++++
 .../hadoop/raft/server/RaftConfiguration.java      |   5 +-
 .../org/apache/hadoop/raft/server/RaftLog.java     |  14 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 146 +++++--------------
 .../org/apache/hadoop/raft/server/ServerState.java |  29 +++-
 .../raft/server/protocol/RaftServerReply.java      |   2 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  34 ++---
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  10 +-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  33 +++--
 .../raft/server/TestRaftReconfiguration.java       | 161 ++++++++++++---------
 12 files changed, 463 insertions(+), 290 deletions(-)

commit e2990e4149c84ece28e1aa97747945b27c732288
Author: Jing Zhao <jing9@apache.org>
Date:   Tue May 17 15:30:31 2016 -0700

    Raft: let new leader replicate an empty entry with new term.

 .../org/apache/hadoop/raft/protocol/Message.java   |  9 +++
 .../org/apache/hadoop/raft/server/LeaderState.java | 26 +++++--
 .../org/apache/hadoop/raft/server/RaftLog.java     |  4 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 62 ++++++++++++----
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  | 11 +--
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  4 +-
 .../raft/{ => server}/TestRaftReconfiguration.java | 84 ++++++++++++++++------
 7 files changed, 149 insertions(+), 51 deletions(-)

commit e3c885618f8b703197e129f291444049f1f60121
Author: Jing Zhao <jing9@apache.org>
Date:   Fri May 13 16:58:47 2016 -0700

    Raft: add unit tests for raft reconfiguration.

 .../raft/protocol/SetConfigurationRequest.java     |   7 +
 .../apache/hadoop/raft/server/FollowerState.java   |  22 ++--
 .../apache/hadoop/raft/server/LeaderElection.java  |   6 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |   6 +
 .../hadoop/raft/server/RaftConfiguration.java      |   8 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  |   6 +-
 .../org/apache/hadoop/raft/server/ServerState.java |   4 +-
 .../hadoop/raft/server/SimpleConfiguration.java    |   6 +-
 .../apache/hadoop/raft/server/protocol/Entry.java  |   2 +-
 .../raft/server/simulation/SimulatedRpc.java       |  11 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  64 +++++++--
 .../java/org/apache/hadoop/raft/RaftTestUtil.java  |  82 ++++++++++++
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  63 +--------
 .../hadoop/raft/TestRaftReconfiguration.java       | 146 +++++++++++++++++++++
 14 files changed, 339 insertions(+), 94 deletions(-)

commit 9d8ffc74e707b3f65bf9a5c20523915e931054e1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu May 12 16:03:17 2016 -0700

    Raft: return client request after log is committed.

 .../java/org/apache/hadoop/raft/RaftUtils.java     |  29 +++++
 .../org/apache/hadoop/raft/client/RaftClient.java  |  25 +++-
 .../hadoop/raft/protocol/RaftClientReply.java      |   4 +-
 .../org/apache/hadoop/raft/server/RaftLog.java     |  22 +++-
 .../org/apache/hadoop/raft/server/RaftRpc.java     |   3 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 139 +++++++++++++++------
 .../apache/hadoop/raft/server/RequestHandler.java  | 107 ++++++++++------
 .../org/apache/hadoop/raft/server/ServerState.java |   8 +-
 .../raft/server/simulation/SimulatedRpc.java       |  56 +++++----
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  36 +++---
 10 files changed, 299 insertions(+), 130 deletions(-)

commit fb0a1affcf0eeb43a9f743443d0e5642b5131c95
Author: Jing Zhao <jing9@apache.org>
Date:   Wed May 11 18:40:55 2016 -0700

    Handle peers no longer belonging to the new configuration.

 .../apache/hadoop/raft/server/FollowerState.java   |  8 +++
 .../apache/hadoop/raft/server/LeaderElection.java  | 23 ++++++---
 .../org/apache/hadoop/raft/server/LeaderState.java |  2 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 59 +++++++++++++++-------
 .../raft/server/protocol/RequestVoteReply.java     | 37 ++++++++++++++
 5 files changed, 104 insertions(+), 25 deletions(-)

commit 5a8c22d6a4b11459ece805d4422b43d7712ea89d
Author: Jing Zhao <jing9@apache.org>
Date:   Wed May 11 14:45:36 2016 -0700

    Replicate the new configuration after (old-conf, new-conf) log entry gets committed.

 .../apache/hadoop/raft/server/FollowerState.java   | 80 ++++++++++++++++++
 .../apache/hadoop/raft/server/LeaderElection.java  | 40 ++++-----
 .../org/apache/hadoop/raft/server/LeaderState.java | 94 +++++++++++++++++++---
 .../hadoop/raft/server/RaftConfiguration.java      | 40 ++++++---
 .../org/apache/hadoop/raft/server/RaftLog.java     | 16 +++-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 82 ++++---------------
 .../org/apache/hadoop/raft/server/ServerState.java |  7 +-
 .../hadoop/raft/server/SimpleConfiguration.java    |  4 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  2 +-
 9 files changed, 252 insertions(+), 113 deletions(-)

commit 0c0bd1ed2641248aff484b84476a9bbfc269aeab
Author: Jing Zhao <jing9@apache.org>
Date:   Tue May 10 16:35:27 2016 -0700

    Add setConfiguration API and support the first stage of reconfiguration protocol: replicate (old, new) log entry.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  2 +-
 .../hadoop/raft/protocol/ConfigurationMessage.java | 30 ++++++++++++
 .../hadoop/raft/protocol/NotLeaderException.java   |  2 -
 .../hadoop/raft/protocol/RaftClientProtocol.java   |  2 +
 .../raft/{server => }/protocol/RaftPeer.java       |  2 +-
 .../ReconfigurationInProgressException.java        | 36 +++++++++++++++
 .../raft/protocol/SetConfigurationRequest.java     | 29 ++++++++++++
 .../apache/hadoop/raft/server/LeaderElection.java  |  2 +-
 .../org/apache/hadoop/raft/server/LeaderState.java | 51 +++++++++++++-------
 .../hadoop/raft/server/RaftConfiguration.java      | 30 +++++++++++-
 .../org/apache/hadoop/raft/server/RaftLog.java     |  9 ++++
 .../org/apache/hadoop/raft/server/RaftServer.java  | 54 ++++++++++++++++++++--
 .../org/apache/hadoop/raft/server/ServerState.java |  1 +
 .../hadoop/raft/server/SimpleConfiguration.java    |  2 +-
 .../raft/server/simulation/SimulatedRpc.java       |  2 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  2 +-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  3 --
 17 files changed, 226 insertions(+), 33 deletions(-)

commit 9708b403016070dcffadb88b385ec98df818dd1e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue May 10 16:00:14 2016 -0700

    Raft: finish testBasicAppendEntries.

 .../hadoop/raft/protocol/RaftClientReply.java      |  2 +-
 .../hadoop/raft/protocol/RaftClientRequest.java    |  2 +-
 .../hadoop/raft/protocol/RaftRpcMessage.java       | 28 +++++++++++-
 .../apache/hadoop/raft/server/LeaderElection.java  | 10 ++---
 .../org/apache/hadoop/raft/server/LeaderState.java |  9 ++--
 .../org/apache/hadoop/raft/server/RaftLog.java     | 28 +++++++-----
 .../org/apache/hadoop/raft/server/RaftServer.java  | 37 ++++++++--------
 .../org/apache/hadoop/raft/server/ServerState.java |  4 +-
 .../apache/hadoop/raft/server/protocol/Entry.java  |  4 ++
 .../raft/server/protocol/RaftServerReply.java      |  2 +-
 .../raft/server/protocol/RaftServerRequest.java    |  2 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 29 ++++++++++--
 .../test/java/org/apache/hadoop/raft/TestRaft.java | 51 +++++++++++++++++++---
 13 files changed, 153 insertions(+), 55 deletions(-)

commit 8234ceba5d78f48641a0467b7869c8d3cce16c54
Author: Jing Zhao <jing9@apache.org>
Date:   Tue May 10 13:48:19 2016 -0700

    Add a placeholder method for RaftLog#logSync and move RaftConfiguration change code into the RaftServer lock

 .../org/apache/hadoop/raft/server/RaftLog.java     | 12 ++++++++
 .../org/apache/hadoop/raft/server/RaftServer.java  | 33 +++++++---------------
 .../org/apache/hadoop/raft/server/ServerState.java | 25 ++++------------
 3 files changed, 27 insertions(+), 43 deletions(-)

commit 4ca75824192112bdd4d02ae4fc879c191f855804
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Tue May 10 13:27:04 2016 -0700

    Raft: add a DUMMY_ENTRY to RaftLog so that the index starts with 1.

 .../java/org/apache/hadoop/raft/client/RaftClient.java    |  1 +
 .../org/apache/hadoop/raft/server/LeaderElection.java     | 15 ++++++++-------
 .../java/org/apache/hadoop/raft/server/LeaderState.java   | 13 +++++++++++--
 .../main/java/org/apache/hadoop/raft/server/RaftLog.java  | 13 ++++++++++---
 .../java/org/apache/hadoop/raft/server/RaftServer.java    | 13 +++----------
 .../org/apache/hadoop/raft/server/RequestHandler.java     | 15 ++++++++++++++-
 .../java/org/apache/hadoop/raft/server/ServerState.java   |  5 ++---
 .../org/apache/hadoop/raft/server/protocol/Entry.java     |  4 ++--
 .../src/test/java/org/apache/hadoop/raft/TestRaft.java    |  9 ++++++---
 9 files changed, 57 insertions(+), 31 deletions(-)

commit 75d0699e242b9c0e6be695fa8a6cb6da62dafc42
Author: Jing Zhao <jing9@apache.org>
Date:   Mon May 9 18:23:56 2016 -0700

    Add support to change configuration when appending entries.

 .../org/apache/hadoop/raft/server/LeaderState.java | 11 ++--
 .../hadoop/raft/server/RaftConfiguration.java      | 67 ++++++++++------------
 .../org/apache/hadoop/raft/server/RaftLog.java     | 23 ++++++--
 .../org/apache/hadoop/raft/server/RaftServer.java  | 25 +++++++-
 .../apache/hadoop/raft/server/RequestHandler.java  | 11 ++--
 .../org/apache/hadoop/raft/server/ServerState.java | 31 ++++++++--
 .../raft/server/protocol/ConfigurationEntry.java   | 45 ++++++++-------
 7 files changed, 130 insertions(+), 83 deletions(-)

commit ff78a131aa676cfa32ffdb25e081cbcfef3fc11d
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon May 9 16:32:56 2016 -0700

    Raft: add more client rpc support.

 .../org/apache/hadoop/raft/client/RaftClient.java  |  35 +++++-
 .../hadoop/raft/protocol/NotLeaderException.java   |   2 +-
 .../hadoop/raft/protocol/RaftClientReply.java      |   2 +-
 .../hadoop/raft/protocol/RaftClientRequest.java    |   2 +-
 .../apache/hadoop/raft/server/LeaderElection.java  |  14 +--
 .../org/apache/hadoop/raft/server/LeaderState.java |   8 +-
 .../org/apache/hadoop/raft/server/RaftLog.java     |   5 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 132 ++++++++++++++-------
 .../apache/hadoop/raft/server/RequestHandler.java  |  12 +-
 .../raft/server/protocol/RaftServerProtocol.java   |  10 +-
 ...aftServerResponse.java => RaftServerReply.java} |   6 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  16 ++-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  31 ++++-
 13 files changed, 192 insertions(+), 83 deletions(-)

commit 29bdd1e6e31bf69eab39e880e7e1a5b4f1d25d85
Author: Jing Zhao <jing9@apache.org>
Date:   Mon May 9 15:35:34 2016 -0700

    Update LeaderState: Use a single thread (instead all the RpcSenders) to update the raft server state.

 .../org/apache/hadoop/raft/server/LeaderState.java | 154 +++++++++++++--------
 .../org/apache/hadoop/raft/server/RaftServer.java  |  17 ++-
 .../raft/server/simulation/SimulatedRpc.java       |   4 +-
 3 files changed, 110 insertions(+), 65 deletions(-)

commit 5c32b40a466db43cd51efeddc38315f603e9b340
Author: Jing Zhao <jing9@apache.org>
Date:   Mon May 9 10:57:04 2016 -0700

    Extend RaftConfiguration to support old/new configurations.

 .../hadoop/raft/protocol/NotLeaderException.java   |   4 +
 .../apache/hadoop/raft/server/LeaderElection.java  |  17 ++-
 .../org/apache/hadoop/raft/server/LeaderState.java |  92 ++++++++++++----
 .../hadoop/raft/server/RaftConfiguration.java      | 116 ++++++++++++++++++---
 .../org/apache/hadoop/raft/server/RaftServer.java  |  20 ++--
 .../org/apache/hadoop/raft/server/ServerState.java |  12 ++-
 .../hadoop/raft/server/SimpleConfiguration.java    |  88 ++++++++++++++++
 .../raft/server/protocol/ConfigurationEntry.java   |  55 ++++++++++
 .../apache/hadoop/raft/server/protocol/Entry.java  |   4 +
 .../hadoop/raft/server/protocol/RaftPeer.java      |   1 +
 .../raft/server/simulation/SimulatedRpc.java       |   6 +-
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |   2 +-
 12 files changed, 356 insertions(+), 61 deletions(-)

commit af2642ccb415e4b1d09239c3ada8426de72749a1
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri May 6 19:03:12 2016 -0700

    Raft: Change simulated rpc to support client requests.

 .../hadoop/raft/protocol/RaftClientProtocol.java   |   2 +-
 .../{Response.java => RaftClientReply.java}        |   5 +-
 .../hadoop/raft/protocol/RaftClientRequest.java    |  32 +++++
 .../hadoop/raft/protocol/RaftRpcMessage.java       |  42 +++++++
 .../org/apache/hadoop/raft/server/LeaderState.java |  10 +-
 .../org/apache/hadoop/raft/server/RaftRpc.java     |  31 +++++
 .../org/apache/hadoop/raft/server/RaftServer.java  | 129 +++++++--------------
 .../apache/hadoop/raft/server/RequestHandler.java  |  79 +++++++++++++
 .../raft/server/protocol/RaftServerRequest.java    |  24 +---
 .../raft/server/protocol/RaftServerResponse.java   |  17 ++-
 .../raft/server/protocol/RequestVoteRequest.java   |   6 +-
 .../hadoop/raft/server/simulation/EventQueue.java  |  58 ---------
 .../hadoop/raft/server/simulation/EventQueues.java |  56 ---------
 .../raft/server/simulation/SimulatedRpc.java       | 115 ++++++++++++++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |   4 +-
 15 files changed, 367 insertions(+), 243 deletions(-)

commit f4d9bec5b5d00fbcbcf9a2d28ecf211b378df11a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu May 5 15:34:06 2016 -0700

    Raft: check current before updating last commit index.

 .../org/apache/hadoop/raft/client/RaftClient.java  | 12 +++++++++++
 .../hadoop/raft/protocol/NotLeaderException.java   |  5 +++--
 .../org/apache/hadoop/raft/server/LeaderState.java |  8 +++----
 .../org/apache/hadoop/raft/server/RaftLog.java     |  9 +++++---
 .../org/apache/hadoop/raft/server/RaftServer.java  | 25 ++++++++++++++++------
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  9 +++++++-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |  9 ++++++++
 7 files changed, 61 insertions(+), 16 deletions(-)

commit 6bc297ec78295b5912385c340fa9bdb99567e748
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed May 4 11:40:24 2016 -0700

    Raft: rename ClientRaftProtocol and change RaftConfiguration.peers to a map.

 ...ntRaftProtocol.java => RaftClientProtocol.java} |  4 ++--
 .../org/apache/hadoop/raft/server/LeaderState.java |  2 ++
 .../hadoop/raft/server/RaftConfiguration.java      | 25 +++++++++++-----------
 .../org/apache/hadoop/raft/server/RaftServer.java  |  8 +++----
 .../org/apache/hadoop/raft/server/ServerState.java |  2 +-
 .../raft/server/protocol/RaftServerRequest.java    |  4 ++--
 .../hadoop/raft/server/simulation/EventQueue.java  |  1 -
 7 files changed, 23 insertions(+), 23 deletions(-)

commit 2b7c5c94754f8e80bb44fb2a8c1d0a9740d54310
Author: Jing Zhao <jing9@apache.org>
Date:   Tue May 3 15:09:12 2016 -0700

    Add RPC simulation and fix bugs.

 .../apache/hadoop/raft/server/LeaderElection.java  |   5 +-
 .../org/apache/hadoop/raft/server/LeaderState.java |   7 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 184 ++++++++++++++++-----
 .../org/apache/hadoop/raft/server/ServerState.java |   6 +-
 .../raft/server/protocol/AppendEntriesRequest.java |   7 +
 .../hadoop/raft/server/protocol/RaftPeer.java      |  10 ++
 .../raft/server/protocol/RaftServerRequest.java    |   6 +
 .../raft/server/protocol/RequestVoteRequest.java   |   7 +
 .../hadoop/raft/server/simulation/EventQueue.java  |  59 +++++++
 .../hadoop/raft/server/simulation/EventQueues.java |  56 +++++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  10 +-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |   3 +-
 12 files changed, 316 insertions(+), 44 deletions(-)

commit be6432ebf1fe40c5ae0b4778f587ba352e32e65e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon May 2 17:28:35 2016 -0700

    Raft: add isRunning to RaftServer and test killing leaders.

 .../apache/hadoop/raft/server/RaftConstants.java   |  2 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 32 +++++++++++++++++---
 .../org/apache/hadoop/raft/server/ServerState.java |  4 +--
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 34 +++++++++++++++++-----
 .../test/java/org/apache/hadoop/raft/TestRaft.java | 34 ++++++++++++++++++----
 5 files changed, 86 insertions(+), 20 deletions(-)

commit 574f3bdd14e71a1484eeb86b519ad9d2a74cde1f
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon May 2 17:00:39 2016 -0700

    Raft: update messages.

 .../apache/hadoop/raft/server/LeaderElection.java  | 42 +++++++++++-----------
 .../org/apache/hadoop/raft/server/LeaderState.java | 12 +++----
 .../org/apache/hadoop/raft/server/RaftServer.java  | 14 +++++---
 3 files changed, 37 insertions(+), 31 deletions(-)

commit 9bc37c8bf58e906b1145f34a83db1cf883bc1ba9
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Apr 29 17:34:02 2016 -0700

    Code cleanup for synchronization.

 .../apache/hadoop/raft/server/LeaderElection.java  | 68 ++++++++++++++--------
 .../org/apache/hadoop/raft/server/LeaderState.java |  6 +-
 .../org/apache/hadoop/raft/server/RaftLog.java     |  2 +-
 .../org/apache/hadoop/raft/server/RaftServer.java  | 44 +++++++++-----
 .../org/apache/hadoop/raft/server/ServerState.java | 19 +++---
 5 files changed, 87 insertions(+), 52 deletions(-)

commit fdf8224104342fb6d047b13f9ced200229d4705e
Author: Jing Zhao <jing9@apache.org>
Date:   Fri Apr 29 11:44:57 2016 -0700

    Some code refactoring. Also add some protocol definition.

 .../org/apache/hadoop/raft/LeaderElection.java     | 108 ------
 .../java/org/apache/hadoop/raft/RaftServer.java    | 407 ---------------------
 .../java/org/apache/hadoop/raft/ServerState.java   | 120 ------
 .../org/apache/hadoop/raft/client/RaftClient.java  |  28 ++
 .../hadoop/raft/protocol/ClientRaftProtocol.java   |  29 ++
 .../org/apache/hadoop/raft/protocol/Message.java   |  24 ++
 .../hadoop/raft/protocol/NotLeaderException.java   |  29 ++
 .../hadoop/raft/{ => protocol}/RaftException.java  |   8 +-
 .../org/apache/hadoop/raft/protocol/Response.java  |  21 ++
 .../apache/hadoop/raft/server/LeaderElection.java  | 163 +++++++++
 .../org/apache/hadoop/raft/server/LeaderState.java | 229 ++++++++++++
 .../hadoop/raft/server/RaftConfiguration.java      |  52 +++
 .../hadoop/raft/{ => server}/RaftConstants.java    |   4 +-
 .../apache/hadoop/raft/{ => server}/RaftLog.java   |  95 +----
 .../org/apache/hadoop/raft/server/RaftServer.java  | 280 ++++++++++++++
 .../raft/{ => server}/RaftServerException.java     |   4 +-
 .../java/org/apache/hadoop/raft/server/Role.java   |  25 ++
 .../org/apache/hadoop/raft/server/ServerState.java | 140 +++++++
 .../raft/server/protocol/AppendEntriesRequest.java |  50 +++
 .../apache/hadoop/raft/server/protocol/Entry.java  |  49 +++
 .../hadoop/raft/server/protocol/RaftPeer.java      |  35 ++
 .../protocol/RaftServerProtocol.java}              |  30 +-
 .../raft/server/protocol/RaftServerRequest.java    |  36 ++
 .../raft/server/protocol/RaftServerResponse.java   |  49 +++
 .../raft/server/protocol/RequestVoteRequest.java   |  44 +++
 .../hadoop/raft/server/protocol/TermIndex.java     |  68 ++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    |  22 +-
 .../test/java/org/apache/hadoop/raft/TestRaft.java |   4 +-
 28 files changed, 1399 insertions(+), 754 deletions(-)

commit c45272e1312150dc9753f76ae93c2dde2dac6d8e
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Thu Apr 28 15:27:21 2016 -0700

    Raft: add a basic raft test.

 .../org/apache/hadoop/raft/LeaderElection.java     |  4 +-
 .../main/java/org/apache/hadoop/raft/RaftLog.java  | 24 +++++++--
 .../java/org/apache/hadoop/raft/RaftProtocol.java  |  2 +-
 .../java/org/apache/hadoop/raft/RaftServer.java    | 62 ++++++++++++++++------
 .../java/org/apache/hadoop/raft/ServerState.java   |  9 ++++
 .../org/apache/hadoop/raft/MiniRaftCluster.java    | 51 ++++++++++++++++++
 .../test/java/org/apache/hadoop/raft/TestRaft.java | 39 ++++++++++++++
 7 files changed, 168 insertions(+), 23 deletions(-)

commit c299c624870e05f60a208880eb7e0369d17c4a91
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Apr 25 17:57:53 2016 -0700

    Address Jing's comments.

 .../main/java/org/apache/hadoop/raft/RaftProtocol.java    |  4 ++--
 .../src/main/java/org/apache/hadoop/raft/RaftServer.java  | 15 ++++++++++-----
 2 files changed, 12 insertions(+), 7 deletions(-)

commit 6f0b3db27fcef3e9d71754fbcf042fb94de95415
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Fri Apr 22 19:14:16 2016 -0700

    Raft: complete appendEntries (without tests)

 .../org/apache/hadoop/raft/LeaderElection.java     | 108 ++++++++
 .../main/java/org/apache/hadoop/raft/RaftLog.java  |  50 +++-
 .../java/org/apache/hadoop/raft/RaftProtocol.java  |   1 +
 .../java/org/apache/hadoop/raft/RaftServer.java    | 298 +++++++++++----------
 .../java/org/apache/hadoop/raft/ServerState.java   |  55 +++-
 5 files changed, 343 insertions(+), 169 deletions(-)

commit 3ae4fb01ca2dd157bc5370a32a43c1a389be1b52
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Wed Apr 20 14:13:23 2016 -0700

    Raft: support appendEntries (not yet done)

 .../main/java/org/apache/hadoop/raft/RaftLog.java  |  79 +++++++++-
 .../java/org/apache/hadoop/raft/RaftServer.java    | 162 +++++++++++++--------
 2 files changed, 174 insertions(+), 67 deletions(-)

commit d7d8369282bb2870b748ad1a89930cd63e79735a
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Apr 11 18:16:25 2016 +0800

    Raft: add heartbeat from leader to followers.

 .../java/org/apache/hadoop/raft/RaftConstants.java |   4 +
 .../java/org/apache/hadoop/raft/RaftProtocol.java  |   8 +-
 .../java/org/apache/hadoop/raft/RaftServer.java    | 178 +++++++++++++++++----
 .../apache/hadoop/raft/RaftServerException.java    |   6 +-
 .../java/org/apache/hadoop/raft/ServerState.java   |   8 +-
 5 files changed, 161 insertions(+), 43 deletions(-)

commit ae25f1c1fd9c09feb89beb1fb83a2821ca231e36
Author: Tsz-Wo Nicholas Sze <szetszwo@hortonworks.com>
Date:   Mon Apr 4 17:34:30 2016 +0800

    Raft: leader election (without tests)

 .../java/org/apache/hadoop/raft/RaftConstants.java |  35 ++++
 .../java/org/apache/hadoop/raft/RaftException.java |  36 ++++
 .../main/java/org/apache/hadoop/raft/RaftLog.java  |  51 +++++
 .../java/org/apache/hadoop/raft/RaftProtocol.java  |  50 +++++
 .../java/org/apache/hadoop/raft/RaftServer.java    | 214 +++++++++++++++++++++
 .../apache/hadoop/raft/RaftServerException.java    |  33 ++++
 .../java/org/apache/hadoop/raft/ServerState.java   |  82 ++++++++
 7 files changed, 501 insertions(+)

