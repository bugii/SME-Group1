commit ae50afac607d5301c4598e6d28ed9c376efd6911
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Oct 25 10:50:41 2019 +0200

    nimble/ll: Fix validation when enabling multiple advertising sets
    
    Checking for duplicate handles was bogus. This was affecting
    LL/DDI/ADV/BV-33-C qualification test case.

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7a8d3b8bce82b931e097266a4f75972a17436b89
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 5 14:32:32 2019 +0100

    nimble/ll: Fix resolving AdvA in auxilary packets in passive scan
    
    AdvA may be present either in ADV_EXT_IND or AUX_ADV_IND and we should
    not attempt to resolve adress if packet doesn't contain one.
    
    An example is non-connectable extended advertising with privacy enabled
    where ADV_EXT_IND has AdvA but no data, and AUX_ADV_IND has no AdvA but
    has advertising data. In this case we don't send HCI event until
    AUX_ADV_IND is received. In such case resolved RPA index from ADV_EXT_IND
    is kept in aux_data to be later used when AUX_ADV_IND is processed.
    
    Also, since LL task may not process packets before next PDU is scanned
    (especially on slow MCUs like M0) pass resolve list index along rxinfo
    and not by global scan SM variable.

 nimble/controller/include/controller/ble_ll_scan.h |  7 +-
 nimble/controller/src/ble_ll_conn.c                |  2 +-
 nimble/controller/src/ble_ll_scan.c                | 78 ++++++++++++++++------
 nimble/include/nimble/ble.h                        |  3 +
 4 files changed, 68 insertions(+), 22 deletions(-)

commit 1dffc22b1d6c4bc037b133783a6392c6afde510b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Oct 31 11:23:07 2019 +0100

    nimble/ll: Fix crash in periodic sync when connected
    
    Periodic sync and periodic advertising were using same scheduler
    type which was resulting in calling wrong function when sync was
    removed from scheduler.

 nimble/controller/include/controller/ble_ll_sched.h |  3 ++-
 nimble/controller/include/controller/ble_ll_sync.h  |  3 +++
 nimble/controller/src/ble_ll_adv.c                  |  4 ++--
 nimble/controller/src/ble_ll_sched.c                |  5 ++++-
 nimble/controller/src/ble_ll_sync.c                 | 10 ++++++++++
 5 files changed, 21 insertions(+), 4 deletions(-)

commit ea9f70c8bf1f61dd861d899e2e80d258923499b4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Nov 4 14:44:35 2019 +0100

    nimble/ll: Fix not storing remote features
    
    Only connection features were stored.

 nimble/controller/src/ble_ll_ctrl.c | 1 +
 1 file changed, 1 insertion(+)

commit ec2a158c6842b5f7cb6a3dfbb0cd443f9b241a50
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 30 11:06:57 2019 +0100

    nimble/ll: Don't send invalid offset in AuxPtr
    
    If offset value is too big and doesn't fit in 13bits we should set
    it to 0 to indicate that offset is not representable.

 nimble/controller/src/ble_ll_adv.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 91bdcb810286491e15629d386d15ae2621c66de8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 21 15:18:13 2019 +0200

    nimble/ll: Validate CTE argument when creating periodic sync
    
    If host requested CTE we should report error as it is not supported.

 nimble/controller/src/ble_ll_sync.c | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit 0b855330594bb3ca20d2fa941fd9f48098cee572
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Nov 4 14:46:59 2019 +0100

    nimble/btshell: Fix parsing of periodic sync lost event

 apps/btshell/src/main.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 514275163e112e033a14d6009de7c66a3bcd9c3d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 22 09:12:37 2019 +0200

    nimble/l2cap: Add missing conn find
    
    Since hs was unlock for some time, make sure we use valid conn

 nimble/host/src/ble_l2cap_sig.c | 2 ++
 1 file changed, 2 insertions(+)

commit da2db143de9272490e63a3c2e662f9691c0cbbdf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 18 15:46:21 2019 +0200

    nimble/l2cap: Add smarter CID assignment
    
    With this change, L2CAP CIDs are assigned per connection and CID ids
    will be reused when it is freed.
    
    Note that BLE_L2CAP_COC_MAX_NUM stays "global" and resources are
    available for all the connections.

 nimble/host/src/ble_hs_conn.c         |  2 +-
 nimble/host/src/ble_hs_conn_priv.h    | 12 ++++++
 nimble/host/src/ble_l2cap.c           |  4 +-
 nimble/host/src/ble_l2cap_coc.c       | 70 ++++++++++++++++++++++++++++-------
 nimble/host/src/ble_l2cap_coc_priv.h  |  8 ++--
 nimble/host/src/ble_l2cap_priv.h      |  2 +-
 nimble/host/src/ble_l2cap_sig.c       | 23 ++++++++----
 nimble/host/test/src/ble_l2cap_test.c |  9 +----
 8 files changed, 94 insertions(+), 36 deletions(-)

commit ba70dba7c88000c17b8224505d1b795b96d7fd67
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Nov 7 09:19:17 2019 +0100

    nimble/ll: Update scan backoff if halted while pending scan response
    
    Make sure we cleanup scan response pending state.

 nimble/controller/include/controller/ble_ll_scan.h |  4 ++--
 nimble/controller/src/ble_ll_scan.c                | 21 ++++++++++++++++-----
 nimble/controller/src/ble_ll_sched.c               |  4 ++--
 3 files changed, 20 insertions(+), 9 deletions(-)

commit 23f4655d8605a0b35775ac440be2c0837d23f3eb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 6 17:03:24 2019 +0100

    nimble/ll: Remove helper macros for AUX flags

 nimble/controller/include/controller/ble_ll_scan.h |  4 ----
 nimble/controller/src/ble_ll_scan.c                | 28 ++++++++++------------
 2 files changed, 12 insertions(+), 20 deletions(-)

commit fa409a6e6c2511345801345e35232e6c111645af
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 6 17:13:20 2019 +0100

    nimble/ll: Fix fragmented incoming data in scanner
    
    When scanning extended advertising events we keep current event state in
    'aux_data' which is shared between ISR and LL. It is possible that ISR
    handles auxiliary PDU at the same time when LL is still busy handling its
    "parent". This means that ISR can update 'aux_data->flags' causing LL to
    e.g. send advertising reports with invalid data.
    
    This patch refactors handling of flags in 'aux_data' to make it safe for
    concurrent access in ISR and LL.
    
    There are 2 copies of shared flags: 'flags_isr' updated by ISR and
    'flags_ll' used by LL. 'flags_ll' are updated to 'flags_isr' when LL
    starts processing auxiliary PDU so if another scan for given 'aux_data'
    is scheduled, it can update 'flags_isr' without affecting LL.
    
    Also new set of flags is introduced to better describe what they mean
    and also they shall be only set, never unset. This potentially allows
    to update `flags_isr` with `flags_ll` without introducing side-effects
    although this is tbd.

 nimble/controller/include/controller/ble_ll_scan.h |  33 ++-
 nimble/controller/src/ble_ll_scan.c                | 268 ++++++++++-----------
 2 files changed, 155 insertions(+), 146 deletions(-)

commit dccfae38eac704d13752e8563189673fd22fd057
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 6 11:42:15 2019 +0100

    nimble/ll: Do not scan AUX on PHY we do not support

 nimble/controller/src/ble_ll_scan.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit ebeb20122370aceca6443014e095305b16a92e9e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 6 17:03:42 2019 +0100

    nimble/ll: Remove redundant #ifdef

 nimble/controller/src/ble_ll_scan.c | 2 --
 1 file changed, 2 deletions(-)

commit a8739586d32b357c795d0da7b31dfbb1eb53d2d1
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Oct 25 13:23:53 2019 +0200

    nimble/ll: Fallback to default params when enabling scan
    
    This fix crash if host issues scan without prior setting scan params.
    As spec is not clear here, instead of rejecting such command, be nice
    to host and use defaults based on legacy scan params defaults.

 nimble/controller/src/ble_ll_scan.c | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit 290871f29ec7c85b0717d1f186f6b1f38e0c690e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Oct 17 10:31:55 2019 +0200

    nimble/ll: Fix Extended Advertising Set Parameters parsing
    
    Some parameters were not ignored correctly.

 nimble/controller/src/ble_ll_adv.c | 31 +++++++++++++++----------------
 1 file changed, 15 insertions(+), 16 deletions(-)

commit 9e4eaed19acfba4293ba8665794bcd685a7b0879
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 5 10:17:14 2019 +0100

    nimble/host: Fix setting big periodic advertising data

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit cbaa21160d884e1f701ed512b3d2eb4431c4c2fe
Merge: d2853c9a ec8ebe6f
Author: wes3 <wills@runtime.io>
Date:   Tue Nov 5 14:53:51 2019 -0800

    Merge pull request #630 from wes3/l2_rxcap_pack_chains
    
    nimble/host: Use os_mbuf_pack_chains

commit ec8ebe6fd29f1a31106c11117a23e79d4680772d
Author: Will San Filippo <william.sanfilippo@juul.com>
Date:   Tue Nov 5 11:03:40 2019 -0800

    porting/nimble: os_mbuf_pack_chains
    
    Adding the os_mbuf_pack_chains API from mynewt-core.

 porting/nimble/include/os/os_mbuf.h | 19 ++++++++
 porting/nimble/src/os_mbuf.c        | 86 +++++++++++++++++++++++++++++++++++++
 2 files changed, 105 insertions(+)

commit d2853c9a204ea76a51211f83026db7e6e56c3590
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Nov 4 21:47:24 2019 +0100

    nimble/ll: Fix setting sent_to_host flag
    
    There's no point in setting flag only to clear it in a moment - just
    make sure we don't set it when not needed.

 nimble/controller/src/ble_ll_scan.c | 13 +++----------
 1 file changed, 3 insertions(+), 10 deletions(-)

commit ffc76ac0e9244450c973fc57de984bdabae2b92e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Nov 4 21:47:14 2019 +0100

    nimble/ll: Add option to extend T_MAFS
    
    By default we try to schedule any AUX/SYNC/CHAIN within T_MAFS to make
    extended/periodic advertising events as short as possible. However, on
    slower MCUs like Cortex-M0 300us (T_MAFS) may be too short to schedule
    and start TX of subsequent PDU and we may drop some packets. This patch
    adds an option to extend these times in scheduler.
    
    Note that it is strongly recommended to keep these new settings at
    default values unless you know what you are doing!

 nimble/controller/src/ble_ll_adv.c |  6 +++---
 nimble/controller/syscfg.yml       | 14 ++++++++++++++
 2 files changed, 17 insertions(+), 3 deletions(-)

commit 5afa6ef8973221cda0574a57ffd4a322659790c6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 31 15:39:07 2019 +0100

    nimble/ll: Optimize extended header parsing for scanner
    
    ble_ll_scan_update_aux_data() will always store addresses in aux_data so
    there is no need to parse extended header each time we need to retrieve
    them - just assume whatever is stored in aux_data is valid.
    
    (the same should be done for ble_ll_init probably)

 nimble/controller/src/ble_ll_scan.c | 89 +++++++++++++++++++++++++++----------
 1 file changed, 66 insertions(+), 23 deletions(-)

commit 517ef3299d61d4e2e47124b8118cde594a8c6521
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 31 09:07:17 2019 +0100

    nimble/ll: Simplify aux_data updates
    
    This patch refactors ble_ll_scan_get_aux_data to avoid copying data
    from/to temporary aux_data and also fixes all comments which are
    confusing since they no longer describe actual behavior of function.

 nimble/controller/include/controller/ble_ll_scan.h |   2 +-
 nimble/controller/src/ble_ll_conn.c                |   2 +-
 nimble/controller/src/ble_ll_scan.c                | 200 ++++++++-------------
 3 files changed, 76 insertions(+), 128 deletions(-)

commit 1506488bc4415472c1ac3d2d02595126282d50eb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 31 09:17:09 2019 +0100

    nimble/ll: Cleaup symbols
    
    Not sure why valid phy mask is a variable, it can be simple #define.

 nimble/controller/src/ble_ll_scan.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

commit 33171fb59bad6f636f29e137917b0e0bcba66926
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 31 09:09:48 2019 +0100

    nimble/ll: Update RFU symbol
    
    This was added in Core 5.1.

 nimble/controller/include/controller/ble_ll.h | 2 +-
 nimble/controller/src/ble_ll_scan.c           | 6 +++---
 nimble/controller/src/ble_ll_sync.c           | 2 +-
 3 files changed, 5 insertions(+), 5 deletions(-)

commit 2c1d9772c926b4ebbe739416741f80dbd9058332
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 31 09:09:09 2019 +0100

    nimble/ll: Remove duplicated defines
    
    These are already defined in ble_ll.h.

 nimble/controller/src/ble_ll_scan.c | 15 ---------------
 1 file changed, 15 deletions(-)

commit 9c842836bab333d0e611b6ba144fce35335a6f6e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 30 12:15:29 2019 +0100

    nimble/hci: Fix incorrect debug asserts
    
    Without this assert was incorretly triggered on min and max values

 nimble/host/src/ble_hs_hci_evt.c | 24 ++++++++++++------------
 1 file changed, 12 insertions(+), 12 deletions(-)

commit cdbcfc4ce7afdde2916edd252a258163e7ce3bb6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 30 11:05:19 2019 +0100

    porting/endian: Add le24 and be24 helpers
    
    Sync with apache-mynewt-core
    
    Those are useful for some BLE and Mesh PDU handling (and probably more).
    Instead of user defining own function it should be beneficial to have
    common implementation.
    
    Not that this is useful only for flat buffers so only put and get
    helpers.

 porting/nimble/include/os/endian.h |  4 +++
 porting/nimble/src/endian.c        | 50 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 54 insertions(+)

commit 3ab8171defc151dc414da87390dc0d6ebf113149
Author: Will San Filippo <william.sanfilippo@juul.com>
Date:   Tue Oct 29 17:49:57 2019 -0700

    nimble/host: Use os_mbuf_pack_chains
    
    if BLE_L2CAP_JOIN_RX_FRAGS is set to 1, use the new API to pack
    mbuf chains instead of previous method. This new API will do more
    copying (possibly) but will better utilize memory in that it
    will use the entire data buffer of each mbuf in the chain.

 nimble/host/src/ble_l2cap.c | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

commit be964a4da9a3648666694f24e9230bfead83b03d
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Tue Sep 24 22:10:40 2019 +0530

    NimBLE/host: Fix multiple `discard const qualifier` warnings
    
    - Minor changes in `ble_gattc.c` to remove `discard const qualifier` warnings.

 nimble/host/src/ble_gattc.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 395daf3b75b3662dbf9c6bcd8286bebb3b42d04d
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Wed May 8 12:26:43 2019 +0530

    host/ble_hs_id: ble_hs_id_set_rnd should make sure all bits are neither one nor zero
    
    Useful for host only implementation.

 nimble/host/src/ble_hs_id.c                 | 15 ++++++++++++++-
 nimble/host/src/ble_hs_id_priv.h            |  1 +
 nimble/host/test/src/ble_hs_test_util.c     |  3 ++-
 nimble/host/test/src/ble_hs_test_util_hci.c |  6 ++++++
 nimble/host/test/src/ble_hs_test_util_hci.h |  1 +
 5 files changed, 24 insertions(+), 2 deletions(-)

commit 5ecff31e09b9c71b66196471ba713e4b1594ecae
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Thu Oct 24 12:11:44 2019 +0530

    nimble/host: Fix stopping `ble_hs_flow_timer` in `ble_hs_flow_startup`
    
    In `ble_hs_flow_startup`, stopping `ble_hs_flow_timer` before creating it
    results in accessing invalid/null `TimerHandle`

 nimble/host/src/ble_hs_flow.c | 3 +++
 1 file changed, 3 insertions(+)

commit 494a163582d28c40ea4946700ed951258b8e1a5b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 23 21:52:25 2019 +0200

    nimble/gap: Fix crash on create sync cancel
    
    Cancelling create sync result in sync created event being generated
    with error status (similar to LE Create Connection). Clearing
    pending GAP op was triggering assert in event handler.

 nimble/host/src/ble_gap.c | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit cd4d35bdb86032f8362cb2900b81a06084aacdff
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 24 12:03:04 2019 +0200

    nimble/ll: Fix scan disable with aux scan scheduled
    
    If aux scan is scheduled while disabling scan, we need to make sure ext
    adv event is properly finished so we can properly pass sanity check when
    removing last ref from aux data (ble_ll_scan.c:1232).

 nimble/controller/src/ble_ll_scan.c | 1 +
 1 file changed, 1 insertion(+)

commit 631a9f4035156a73c43bd48392df111586dec9ab
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 22 14:45:48 2019 +0200

    doc: Fix nordic target

 docs/mesh/sample.rst | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3d1a29fd3f711c8323937992af0d8e76ef40fcc0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 22 14:47:56 2019 +0200

    Fix path for blemesh app

 docs/mesh/sample.rst | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 31f7f82d55572b03ef5b07f28e62e2ebc53dd35c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 22 11:19:22 2019 +0200

    nimble/ll: Fix unaligned access in addr resolver
    
    ble_ll_resolv_rpa() casts IRK parameter to uint32_t* for faster access,
    but this parameter is a pointer to member of struct ble_ll_resolv_entry
    which is not word aligned thus it will hardfault on cm0.
    
    This patch forces proper aligmnent of IRKs.

 nimble/controller/include/controller/ble_ll_resolv.h | 1 +
 nimble/controller/src/ble_ll_resolv.c                | 1 +
 2 files changed, 2 insertions(+)

commit 766a41456a4f569decaa8c28105d323f9f909076
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 21 08:41:36 2019 +0200

    nimble/host: Fix controller to host flow control
    
    Thiscode was not updated to use packed structs.

 nimble/host/src/ble_hs_flow.c      | 43 +++++++++++++++++++++-----------------
 nimble/include/nimble/hci_common.h |  6 +++---
 2 files changed, 27 insertions(+), 22 deletions(-)

commit 4ceecdbed90998afba34e1661b6cb2427ab16be4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 21 14:18:07 2019 +0200

    nimble/phy: Make private functions static

 nimble/controller/include/controller/ble_phy.h | 1 -
 nimble/drivers/nrf51/src/ble_phy.c             | 4 ++--
 nimble/drivers/nrf52/src/ble_phy.c             | 6 +++---
 3 files changed, 5 insertions(+), 6 deletions(-)

commit f1808b9da7d5f88737e5823f907e6d50d2667a43
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 21 14:58:28 2019 +0200

    nimble/ll: Remove confusing symbol
    
    BLE_PHY_TRANSITION is already used for transitions between TX/RX so this
    name is confusing. And we actually do not need a special symbol here
    since we can just use 0 - PHYs are numbered starting from 1.

 nimble/controller/include/controller/ble_ll_conn.h | 2 --
 nimble/controller/src/ble_ll_conn.c                | 4 ++--
 nimble/controller/src/ble_ll_ctrl.c                | 2 +-
 3 files changed, 3 insertions(+), 5 deletions(-)

commit 60fc1cd2def03d6f4682b4908d6a6e2f551a1ee5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 21 14:45:55 2019 +0200

    nimble/ll: Fix PHY_UPDATE_IND handling
    
    phys fields are bitmasks, need to convert them.

 nimble/controller/src/ble_ll_ctrl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 638978ac8863e8102bb53e7232613834743bf3d8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 17 14:01:40 2019 +0200

    nimble/ll: Move PHY checks to drivers
    
    ble_phy.h should be hardware agnostic, let's move PHY checks to drivers
    instead.

 nimble/controller/include/controller/ble_phy.h | 8 --------
 nimble/drivers/nrf51/src/ble_phy.c             | 8 ++++++++
 nimble/drivers/nrf52/src/ble_phy.c             | 6 ++++++
 3 files changed, 14 insertions(+), 8 deletions(-)

commit 1adb35da4b65daf796e6ba363a57e68cdaa17a28
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Oct 18 10:38:49 2019 +0200

    nimble/host: Clarify ble_gap_disc duration parameters
    
    When zero is passed stack uses default values for duration.

 nimble/host/include/host/ble_gap.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit b83d270a89fcb51c092bd63d4dbbd59d632a5470
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 16 11:57:58 2019 +0200

    nimble/host: Fix scan duration on legacy API with ext adv enabled
    
    Make sure duration parameter is adjusted to legacy behaviour before
    passing it to ble_gap_ext_disc.

 nimble/host/src/ble_gap.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 71d85ca9fe98111d1782ab1bb0db2db08a5ff521
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 16 11:55:06 2019 +0200

    apps/btshell: Fix not reporting scan start error
    
    Extended parameter cannot be invalid as this is verified by parsing
    function so just print error in common exit path.

 apps/btshell/src/cmd.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 833547212bfed9e5246feeb7112f673d0d265cf1
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Oct 15 10:41:27 2019 +0200

    nimble/ll: Add support for disabling periodic advertising reports
    
    This is Core 5.1 feature and allows to pass LL/DDI/SCN-BV-38-C
    qualification test.

 nimble/controller/include/controller/ble_ll_hci.h  |  2 +-
 nimble/controller/include/controller/ble_ll_sync.h |  1 +
 nimble/controller/src/ble_ll_hci.c                 |  8 +++
 nimble/controller/src/ble_ll_supp_cmd.c            | 13 ++++
 nimble/controller/src/ble_ll_sync.c                | 75 +++++++++++++++++++++-
 nimble/include/nimble/hci_common.h                 |  7 ++
 6 files changed, 104 insertions(+), 2 deletions(-)

commit 49d394a2175d224998938c0265169f92b23f98af
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 16 15:06:06 2019 +0200

    nimble/phy: Fix ble_phy_restart_rx
    
    Stop usec timer when restarting RX. Otherwise calculations could be
    off resulting in not starting RX until next PHY disable.
    
    This fix active scan being suboptimal (especially for long scan
    intervals) and not receiving until next scan interval when WFR fired
    due to missed scan response.

 nimble/drivers/nrf51/src/ble_phy.c | 1 +
 nimble/drivers/nrf52/src/ble_phy.c | 1 +
 2 files changed, 2 insertions(+)

commit e61f4385f3f32a9e00022ae9ce97632edc8726fd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 16 12:24:39 2019 +0200

    nimble/ll: Fix receiving scan rsp with interleaved aux scan
    
    This changes meaning of scan_rsp_pending in scan sm which now is set
    only for duration of receiving scan response. When received packet
    is passed to LL task information about it being SCAN_RSP is passed
    in packet header flags. This allows for easy detection if scan
    response is ongoing and bail out with aux scan that would interfere
    with it.
    
    This improves active scan backoff handling when extended advertising
    is used.
    
    This was affecting LL/DDI/SCN/BV-24-C and LL/DDI/SCN/BV-64-C
    qualification test cases.

 nimble/controller/src/ble_ll_scan.c | 90 +++++++++++++++++++------------------
 nimble/include/nimble/ble.h         | 10 +++--
 2 files changed, 54 insertions(+), 46 deletions(-)

commit 87e963e7517839b27ba29f3a871175ce9cf51c26
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Oct 11 11:07:36 2019 +0200

    nimble/ll: Fix scanning on multiple PHYs
    
    On multiple PHYs scan initial scans are queued right after another.
    PHY is changed in scan event based on current scan window. If none
    of PHYs are currently inside scan window, next scan will use PHY
    which scan window starts sooner.
    
    ble_ll_scan_get_scan_win is now used for moving to next scan window
    on both current and next PHY thus next_event_start is no longer
    needed.

 nimble/controller/include/controller/ble_ll_scan.h |   1 -
 nimble/controller/src/ble_ll_scan.c                | 178 ++++++++++-----------
 2 files changed, 83 insertions(+), 96 deletions(-)

commit 2f966d2068e656450c7a0d31de9f31db5ab785c3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 9 11:17:43 2019 +0200

    nimble/ll: Obey PHYs scan window on continuous multi-phy scan

 nimble/controller/src/ble_ll_scan.c | 34 ++++++++++++++++++----------------
 1 file changed, 18 insertions(+), 16 deletions(-)

commit 8307ce6f2cf217de77c6fd34b1b1c082e02e91d6
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Oct 8 10:29:15 2019 +0200

    nimble/ll: Reset backoff only when sending scan request
    
    Don't decrement backoff if we failed to send scan request.

 nimble/controller/src/ble_ll_scan.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 5639168d95c828cfab8475decd87d92b578664de
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Oct 8 11:26:49 2019 +0200

    nimble/ll: Minor function name cleanup

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit bf4ef2c8626d22489731e388790c2893bf91be04
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Oct 1 12:39:04 2019 +0200

    nimble/ll: Don't pass all zero IRKs to HW resolv list
    
    Make sure we don't try to resolv RPAs for all zeros IRK as those should
    be reported to host as RPAs, not resolved types. This was affecting
    LL/DDI/SCN/BV-15-C qualification test.

 .../controller/include/controller/ble_ll_resolv.h  |  2 +-
 nimble/controller/src/ble_ll_resolv.c              | 43 +++++++++++++++-------
 2 files changed, 31 insertions(+), 14 deletions(-)

commit b0aef82b379c0ffdfbc55cbae8a0008de66026bd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 14 12:31:36 2019 +0200

    nimble: Add initial support for Core Spec 5.1
    
    This only adds required defines for new HCI commands and events.
    Option for selecting supported core version is also added.

 nimble/controller/src/ble_ll_ctrl.c      |  2 +-
 nimble/controller/src/ble_ll_hci.c       |  4 ++--
 nimble/include/nimble/hci_common.h       | 36 ++++++++++++++++++++++++++++++++
 nimble/syscfg.yml                        |  7 +++++++
 porting/npl/riot/include/syscfg/syscfg.h |  4 ++++
 5 files changed, 50 insertions(+), 3 deletions(-)

commit 9c6f8b1ac9208f98df485334e98e85ed0dcd00f1
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 2 10:10:59 2019 +0200

    nimble: Use packed structures for HCI commands and events
    
    This patch changes way HCI protocol is passed between host and
    controller. Rule of thumb is that structures defined as packed
    represent protocol order (LE) binary data, while normal structs
    hold host order decoded (unpacked) data.
    
    Packed structs are always used to parse or prepare HCI data. In
    general HCI data is parsed only where needed and pass 'as-is'
    up to stack as much as possible (this is to minimize need to copy
    data).
    
    Some additional changes and cleanups are also part of this commit
    (due to invasive nature of this commit) to avoid unnecessary rebases
    and conflicts:
     - constified pointers where needed (when passing packed data up)
     - updated HCI names as specified in Core 5.1
    
    This commit not only improves code readiblity (ie it is easy to
    check where data is used, as well as when it is expected to be
    in host or in protocol order) but also reduces code size. Some
    numbers for build with most features enabled (optimized build):
    nimble_controller.a     55602 -> 55246
    nimble_host.a           68001 -> 65285

 apps/btshell/src/main.c                            |    4 +-
 apps/bttester/src/gap.c                            |    6 +-
 nimble/controller/include/controller/ble_hw.h      |    4 +-
 nimble/controller/include/controller/ble_ll.h      |    6 +-
 nimble/controller/include/controller/ble_ll_adv.h  |   35 +-
 nimble/controller/include/controller/ble_ll_conn.h |   33 +
 nimble/controller/include/controller/ble_ll_ctrl.h |    2 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   13 +-
 .../controller/include/controller/ble_ll_resolv.h  |   20 +-
 nimble/controller/include/controller/ble_ll_scan.h |   18 +-
 nimble/controller/include/controller/ble_ll_sync.h |    8 +-
 .../include/controller/ble_ll_whitelist.h          |    4 +-
 nimble/controller/src/ble_ll.c                     |   18 +-
 nimble/controller/src/ble_ll_adv.c                 |  405 ++---
 nimble/controller/src/ble_ll_conn.c                |    2 +-
 nimble/controller/src/ble_ll_conn_hci.c            |  973 ++++++-----
 nimble/controller/src/ble_ll_conn_priv.h           |   74 +-
 nimble/controller/src/ble_ll_dtm.c                 |  178 +-
 nimble/controller/src/ble_ll_dtm_priv.h            |    8 +-
 nimble/controller/src/ble_ll_hci.c                 |  760 ++++-----
 nimble/controller/src/ble_ll_hci_ev.c              |  437 +++--
 nimble/controller/src/ble_ll_resolv.c              |  155 +-
 nimble/controller/src/ble_ll_scan.c                |  636 +++----
 nimble/controller/src/ble_ll_sync.c                |  264 ++-
 nimble/controller/src/ble_ll_whitelist.c           |   40 +-
 nimble/drivers/native/src/ble_hw.c                 |    4 +-
 nimble/drivers/nrf51/src/ble_hw.c                  |    4 +-
 nimble/drivers/nrf52/src/ble_hw.c                  |    4 +-
 nimble/host/include/host/ble_gap.h                 |    6 +-
 nimble/host/include/host/ble_hs_adv.h              |   28 +-
 nimble/host/src/ble_gap.c                          | 1417 ++++++++--------
 nimble/host/src/ble_gap_priv.h                     |   38 +-
 nimble/host/src/ble_hs.c                           |   10 +-
 nimble/host/src/ble_hs_adv.c                       |   19 +-
 nimble/host/src/ble_hs_hci.c                       |  134 +-
 nimble/host/src/ble_hs_hci_cmd.c                   | 1750 +-------------------
 nimble/host/src/ble_hs_hci_evt.c                   |  589 +++----
 nimble/host/src/ble_hs_hci_priv.h                  |  214 +--
 nimble/host/src/ble_hs_hci_util.c                  |  134 +-
 nimble/host/src/ble_hs_pvcy.c                      |  102 +-
 nimble/host/src/ble_hs_startup.c                   |  123 +-
 nimble/host/src/ble_sm.c                           |   98 +-
 nimble/host/src/ble_sm_priv.h                      |    6 +-
 nimble/host/test/src/ble_gap_test.c                |  119 +-
 nimble/host/test/src/ble_gatt_conn_test.c          |    7 +-
 nimble/host/test/src/ble_hs_adv_test.c             |    3 +
 nimble/host/test/src/ble_hs_conn_test.c            |   10 +-
 nimble/host/test/src/ble_hs_hci_test.c             |   10 +-
 nimble/host/test/src/ble_hs_test_util.c            |   17 +-
 nimble/host/test/src/ble_hs_test_util.h            |   20 +
 nimble/host/test/src/ble_hs_test_util_hci.c        |   23 +-
 nimble/host/test/src/ble_hs_test_util_hci.h        |    4 +-
 nimble/host/test/src/ble_l2cap_test.c              |    2 +
 nimble/host/test/src/ble_os_test.c                 |   18 +-
 nimble/host/test/src/ble_sm_test.c                 |    4 +-
 nimble/host/test/src/ble_sm_test_util.c            |   23 +-
 nimble/include/nimble/hci_common.h                 | 1579 ++++++++++--------
 nimble/transport/emspi/src/ble_hci_emspi.c         |    6 +-
 nimble/transport/socket/src/ble_hci_socket.c       |   12 +-
 nimble/transport/uart/src/ble_hci_uart.c           |   28 +-
 60 files changed, 4519 insertions(+), 6149 deletions(-)

commit 89e49d6baeb349ce2d64414c15fa5658a7e95bef
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 11 12:18:11 2019 +0200

    nimble/mesh: Fix provisioning rx_buf initialization
    
    This patch fixes regresion after
     5f56107d nimble/mesh: Sync provisioning code with Zephyr
    
    When PB GATT is not used then rx_buf would be not initialized

 nimble/host/mesh/src/prov.c | 3 +++
 1 file changed, 3 insertions(+)

commit 7624744d90c159b8c9ab0bf3d890b0c3a3c43928
Merge: 03110e9b 8cfabdcf
Author: Vipul Rahane <vipulrahane@apache.org>
Date:   Thu Oct 10 12:20:22 2019 -0700

    Merge pull request #577 from vrahane/mcumgr_changes
    
    apps: Make corresponding MCUmgr changes

commit 8cfabdcfde99f1b5e3e5bb57fe09f1ffb0545750
Author: Vipul Rahane <vrahane@gmail.com>
Date:   Thu Oct 10 12:13:28 2019 -0700

    CI: Clone mcumgr repo for CI tests

 .travis.yml | 1 +
 1 file changed, 1 insertion(+)

commit 03110e9b4378b3596bb6f624c14f3054409018ff
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 9 10:29:38 2019 +0200

    nimble/host: Fix using windows newlines in source code

 nimble/host/src/ble_hs_periodic_sync.c      | 308 ++++++++++++++--------------
 nimble/host/src/ble_hs_periodic_sync_priv.h | 110 +++++-----
 2 files changed, 209 insertions(+), 209 deletions(-)

commit 9f22d249e0c542e34ecc2bf1161904a2ee01e7f4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Oct 9 10:27:25 2019 +0200

    nimble/host: Build ble_hs_periodic_sync only when enabled
    
    When periodic advertising support is disabled this code is never used.

 nimble/host/src/ble_hs.c               | 2 ++
 nimble/host/src/ble_hs_periodic_sync.c | 2 ++
 2 files changed, 4 insertions(+)

commit b000924b5d42578c5287f01b5bb0a003ebe5d4f2
Author: Agata Ponitka <agata.ponitka@codecoup.pl>
Date:   Wed Oct 9 10:12:38 2019 +0200

    Upgrade test instructions
    
    Upgrade instructions and results test cases for L2CAP and SM.

 nimble/host/pts/pts-l2cap.txt | 186 +++++++++++++--------
 nimble/host/pts/pts-sm.txt    | 364 +++++++++++++++++++++++++++++-------------
 2 files changed, 373 insertions(+), 177 deletions(-)

commit 8402a9adc0bc3716ac0751daa18c93d8476e27d9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Oct 4 14:44:52 2019 +0200

    nimble/ll: Fix crash when scanning for AUX packets
    
    When dropping scan for AUX packet we need to make sure to send HCI
    report with data truncated flag set whe needed. Otherwise assert is
    triggered in ble_ll_scan_aux_data_unref (as this leaves host in
    undefined state).

 nimble/controller/include/controller/ble_ll.h      |  1 +
 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll.c                     |  1 +
 nimble/controller/src/ble_ll_scan.c                | 24 ++++++++++++++++++++--
 4 files changed, 25 insertions(+), 2 deletions(-)

commit 5d9caf8ba7375f89713c23074e48612532c7fd19
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 7 10:34:52 2019 +0200

    nimble/ll: Rename mempool used for AUX data in extended scan
    
    This is used for extended scanning only so name it appropriately.

 nimble/controller/src/ble_ll_scan.c | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 77ad24fd66bb1d22c560c0c568328646beb71add
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 7 09:52:59 2019 +0200

    nimble/ll: Remove unneeded null check
    
    scansm is always valid here.

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit decca8488cae863f2fc00ecf9988c0c397e072fd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 7 11:20:03 2019 +0200

    porting: Assert when setting data for queued event
    
    Setting data when event is already queued always indicates bug in code.

 porting/npl/mynewt/include/nimble/nimble_npl_os.h | 2 ++
 1 file changed, 2 insertions(+)

commit 275718acdc10f45811db4eb1a441f0c703c04ed9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 7 11:23:09 2019 +0200

    nimble/ll: Don't use bigger LL task stack when ext adv is enabled
    
    There is no need to use bigger task for extended advertising.
    Current usage:
     - 6 active adv instances (including 1680 chains): 56 words
     - ext scan with both PHYs enabled: 78 words

 nimble/controller/src/ble_ll.c | 5 -----
 1 file changed, 5 deletions(-)

commit fa916ce12fe17103078e80d0588e2c054a389e89
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 4 00:08:26 2019 +0200

    btshell: Remove tracking adv instances
    
    Nimbles does it for us, let's remove it from test app.

 apps/btshell/src/cmd.c | 36 ------------------------------------
 1 file changed, 36 deletions(-)

commit ee6bc63be81dd275dc39d3e164c5f89a247c0198
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Fri Oct 4 14:34:42 2019 +0530

    NimBLE/host: Fix return code in `ble_hs_tx_data`
    
    - Minor fix to return failed return code in `ble_hs_tx_data`.

 nimble/host/src/ble_hs.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 474e4722950a9955551f33fb69624aa3c5e604af
Author: Fabio Utzig <utzig@apache.org>
Date:   Sun Oct 6 08:57:31 2019 -0300

    Update the Mynewt slack join URL

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f7ade6abce5f4765a153a673ac906965f9656b46
Merge: 12597461 d6710d6a
Author: wes3 <wills@runtime.io>
Date:   Fri Oct 4 09:53:07 2019 -0700

    Merge pull request #597 from wes3/ll_conn_fix
    
    nimble/ll: Remove unnecessary code

commit d6710d6a03d87d6af0a9762f7a2cec808ece6390
Author: Will San Filippo <william.sanfilippo@juul.com>
Date:   Thu Oct 3 17:41:27 2019 -0700

    nimble/ll: Remove unnecessary code
    
    While reviewing code noticed that there was no need to check for
    not receiving a terminate indication as that case is already
    checked and could thus never be true. Removed the code that was
    not needed.

 nimble/controller/src/ble_ll_conn.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit 125974613b3a20963f24cb9b75b54190e36f610d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Sep 23 14:20:45 2019 +0200

    nimble/host: Remove protocols debug logging
    
    BLE_MONITOR provides better ways of debugging HCI and BLE protocols
    traffic than (incomplete) debug host logs. Instead of duplicating
    functionality just remove debug logs.

 nimble/host/src/ble_att_clt.c      |  65 ----
 nimble/host/src/ble_att_cmd.c      | 110 ------
 nimble/host/src/ble_att_cmd_priv.h |  20 --
 nimble/host/src/ble_att_priv.h     |   6 -
 nimble/host/src/ble_att_svr.c      |  54 ---
 nimble/host/src/ble_hs_dbg.c       | 695 -------------------------------------
 nimble/host/src/ble_hs_dbg_priv.h  |  34 --
 nimble/host/src/ble_hs_hci.c       |   4 -
 nimble/host/src/ble_hs_hci_cmd.c   |   8 -
 nimble/host/src/ble_hs_hci_evt.c   |   4 -
 nimble/host/src/ble_hs_priv.h      |  26 --
 nimble/host/src/ble_sm.c           |  16 -
 nimble/host/src/ble_sm_cmd.c       |  94 -----
 nimble/host/src/ble_sm_priv.h      |  17 -
 nimble/host/src/ble_sm_sc.c        |   2 -
 15 files changed, 1155 deletions(-)

commit cb5f1c661287f9433491eff9866430e7ebbe050e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Oct 2 11:13:04 2019 +0200

    nimble/ll: Rename sysfg for DTM extensions

 nimble/controller/src/ble_ll_dtm.c | 12 ++++++------
 nimble/controller/syscfg.yml       |  2 +-
 2 files changed, 7 insertions(+), 7 deletions(-)

commit e29d874d4befce5d430ff190fba05a96578654f8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Oct 2 10:38:35 2019 +0200

    nimble/ll: Fix old DTM syscfg deprecation

 nimble/controller/syscfg.yml | 1 +
 1 file changed, 1 insertion(+)

commit f6d05294af614637932c37af6cb56d19023ce06f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 2 10:15:19 2019 +0200

    nimble/l2cap: Fix extracting proc from the list
    
    When we were creating more than one channel at the time (we are doing it
    in the auto pts test enviroment), we will end up with removing from the
    list not that proc which we want as prev is always set to NULL wich
    means, we always remove HEAD of the list

 nimble/host/src/ble_l2cap_sig.c | 1 +
 1 file changed, 1 insertion(+)

commit 2307c1f5a58f00c724b9f999df81e83ad2b0b36a
Author: Agata Ponitka <agata.ponitka@codecoup.pl>
Date:   Wed Oct 2 08:45:16 2019 +0200

    host/pts: upgrade test instructions
    
    Upgrade instructions and results test cases in pts.

 nimble/host/pts/pts-gap.txt  | 689 ++++++++++++++++++---------------------
 nimble/host/pts/pts-gatt.txt | 756 +++++++++++++++++++++----------------------
 2 files changed, 681 insertions(+), 764 deletions(-)

commit fb7651b773734a075c47ff10210b92e6d55ef55b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 27 22:10:30 2019 +0200

    nimble/ll: Add support for custom DTM extensions
    
    This allows to enable custom extensions for DTM which currently allow to
    override interval between test packets and number of packets to be
    transmitted. See description of new syscfg setting for details.
    
    This is not enabled by default since it extends HCI command defined by
    Core specification so we need to be compliant by default. However even
    if extensions are enabled, NimBLE still accepts HCI command as defined
    in Core specification but also accepts extended one.

 nimble/controller/include/controller/ble_ll.h      |  2 +-
 .../controller/include/controller/ble_ll_sched.h   |  2 +-
 nimble/controller/include/controller/ble_phy.h     |  2 +-
 nimble/controller/src/ble_ll.c                     | 16 +++---
 nimble/controller/src/ble_ll_dtm.c                 | 62 ++++++++++++++++++++--
 nimble/controller/src/ble_ll_dtm_priv.h            |  2 +-
 nimble/controller/src/ble_ll_hci.c                 | 12 ++---
 nimble/controller/src/ble_ll_sched.c               |  2 +-
 nimble/controller/src/ble_ll_supp_cmd.c            |  6 +--
 nimble/controller/syscfg.yml                       | 18 +++++++
 nimble/drivers/nrf52/src/ble_phy.c                 |  2 +-
 porting/npl/riot/include/syscfg/syscfg.h           |  4 +-
 12 files changed, 98 insertions(+), 32 deletions(-)

commit 323aee97a2ad1f96e91ce1163ed72ad4bb8eb350
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 27 20:04:52 2019 +0200

    nimble/ll: Rename DTM syscfg

 nimble/controller/src/ble_ll_dtm.c | 2 +-
 nimble/controller/src/ble_ll_hci.c | 2 +-
 nimble/controller/syscfg.yml       | 9 +++++++--
 3 files changed, 9 insertions(+), 4 deletions(-)

commit 44712aa5af155fd57ae11e8c0411c65c60b67b03
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Sep 30 05:29:27 2019 -0500

    apps/bttester: Enable Friend feature
    
    Friend feature test cases in auto-pts require this option to be enabled.

 apps/bttester/src/mesh.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0ca4d11abca15fc810b8cead8f56c47cb0eff0ac
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Sep 25 16:26:38 2019 +0200

    nimble/host: Fix missing hs lock in ble_gap_unpair
    
    ble_hs_conn_find_by_addr needs to be called with hs_lock locked.

 nimble/host/src/ble_gap.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 4b42447f4bdc3bf819137aca4c80338e49a32851
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 26 15:44:06 2019 +0200

    nimble/ll: Fix RX timing on DTM
    
    There is no need to delay RX restart by scheduler delay since it's not
    called from scheduler - we can start asap.

 nimble/controller/src/ble_ll_dtm.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit c2b8a43c7d96d91372c83ed25f0ea9f995a05f6a
Author: Vipul Rahane <vrahane@gmail.com>
Date:   Thu Sep 26 13:11:03 2019 -0700

    apps: SMP should be MCUmgr since SMP in BLE means something else

 apps/blemesh/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7fa441c4773e3fa4d9a2ee948544ca710265cb99
Author: Vipul Rahane <vrahane@gmail.com>
Date:   Tue Sep 10 18:31:07 2019 -0700

    apps: Make corresponding MCUmgr changes

 apps/blemesh/syscfg.yml                  |  4 ++--
 apps/blemesh_light/syscfg.yml            |  4 ++--
 apps/blemesh_models_example_1/syscfg.yml |  4 ++--
 apps/blemesh_models_example_2/syscfg.yml |  4 ++--
 apps/blemesh_shell/syscfg.yml            |  4 ++--
 apps/bleprph/pkg.yml                     |  4 ++--
 apps/bleprph/syscfg.yml                  | 10 +++++-----
 apps/btshell/syscfg.yml                  |  4 ++--
 8 files changed, 19 insertions(+), 19 deletions(-)

commit 8f33b429d51a834ab21a3b1afc4a871bf80dea8d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 24 16:00:09 2019 +0200

    nimble/ll_scan: Set filter duplicate only when controller allowed
    
    If BLE_LL_NUM_SCAN_DUP_ADVS is 0 then never set filter duplicats in
    scansm as it does not makes sense.

 nimble/controller/src/ble_ll_scan.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 90168812576b99c9e4315690062bdf46548409a4
Author: Andrew Leech <andrew@alelec.net>
Date:   Mon Sep 23 13:48:01 2019 +1000

    Update sample application links
    
    Most of the samples apps have been moved from mynewt-core to mynewt-nimble project.
    test project no longer appears to exist.

 README.md | 11 ++++-------
 1 file changed, 4 insertions(+), 7 deletions(-)

commit 7340e6cfbeb123292717ba1dbec53e3283c0b013
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 4 10:27:52 2019 +0200

    apps/bttester: Fix mbuf handling in Mesh

 apps/bttester/src/mesh.c | 17 +++++++++--------
 1 file changed, 9 insertions(+), 8 deletions(-)

commit fc113f13d41fa051ca9003093df0721de3f25df0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Aug 30 15:47:17 2019 +0200

    apps/bttester: Add Include Service

 apps/bttester/src/gatt.c | 35 +++++++++++++++++++++++++++++++++++
 1 file changed, 35 insertions(+)

commit 90cd415b20fb90ecf68379ba4277afaadf920ddd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Aug 30 15:24:37 2019 +0200

    apps/bttester: Fix notification logic

 apps/bttester/src/gatt.c | 44 +++++++++++++++++++++++++-------------------
 1 file changed, 25 insertions(+), 19 deletions(-)

commit eacaa48177d9ba1ad84d9484c7d0452ef2f2e8a8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Aug 29 11:58:31 2019 +0200

    apps/bttester: Add Attribute Value Changed event

 apps/bttester/src/gatt.c | 47 ++++++++++++++++++++++++++++++++++++++---------
 1 file changed, 38 insertions(+), 9 deletions(-)

commit 2344704bed5b969f67679a7ca9ed43d7c812f810
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 26 16:52:59 2019 +0200

    apps/bttester: Fix change_database
    
    This method is used to issue service change notification and
    we don't need to actually change the database to end that.

 apps/bttester/src/gatt.c | 10 ----------
 1 file changed, 10 deletions(-)

commit fc6e29a2896191f8eccfa03d4be1d15c2af5fba1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Aug 23 15:46:19 2019 +0200

    apps/bttester: Fix gatt svr access callbacks

 apps/bttester/src/gatt.c | 114 ++++++++++++++++++-----------------------------
 1 file changed, 43 insertions(+), 71 deletions(-)

commit 095c98efb04773c4228e2fc5857425f5a3158318
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Aug 23 15:46:10 2019 +0200

    apps/bttester: Fix min key size

 apps/bttester/src/gatt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 29d3a155c3c5b12aff9ffbca49514a9dfcb61b46
Author: Szymon Czapracki <szymonczapracki@gmail.com>
Date:   Fri Aug 2 15:01:04 2019 +0200

    apps/bttester: Modify gatt database
    
    Slim down overall number of gatt services, characteristics etc.
    Make database static, remove functions for adding or deleting values.

 apps/bttester/src/bttester.c |    1 -
 apps/bttester/src/bttester.h |    9 +
 apps/bttester/src/gatt.c     | 2449 +++++++++++++++++++-----------------------
 3 files changed, 1115 insertions(+), 1344 deletions(-)

commit 0c91f0383d248bb0b8a65554f80504b3d7dd162a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Aug 28 11:21:59 2019 +0200

    apps/bttester: Fix GATT Attribute permission mapping
    
    BTP uses different values for permissions than Nimble so we have
    to convert host flags to BTP permissions.

 apps/bttester/src/gatt.c | 36 +++++++++++++++++++++++++++++++++++-
 1 file changed, 35 insertions(+), 1 deletion(-)

commit d13afd47cffb59a7843f364809f21891eec89857
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 26 16:54:32 2019 +0200

    apps/bttester: Fix Connection Parameter Update functionality
    
    1. Delete old implementations
    2. Call GAP param update api from callout to workaround
    an issue with PTS (GAP API waits for a response and PTS would not
    send a response until we press OK on a window).
    3. Keep sending Parameter update request after connection
    is established to workaround a missing WID in L2CAP/LE/CPU/BV-01-C.

 apps/bttester/src/gap.c | 116 +++++++++++++++++++-----------------------------
 1 file changed, 46 insertions(+), 70 deletions(-)

commit 1d9f377d95b8ca854105f4ab966aa75a1d10cc1b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu May 30 16:20:48 2019 +0200

    apps/bttester: Add encryption key size logging

 apps/bttester/src/gap.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e02b84115913f05835fe76d3c4cf11c71ad7b980
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu May 30 16:19:48 2019 +0200

    apps/bttester: Fix get_attributes infinite loop
    
    The entry variable was not updated in some cases.

 apps/bttester/src/gatt.c | 2 ++
 1 file changed, 2 insertions(+)

commit 7d7502598e220c19f551dcb6547e7556a60b0290
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Aug 1 15:46:54 2019 +0200

    apps/bttester: Fix setting adv parameters for directed advertising

 apps/bttester/src/gap.c | 3 +++
 1 file changed, 3 insertions(+)

commit 7baafa080fee60f349d2184aece8ed2b8eb05170
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 31 14:35:13 2019 +0200

    apps/bttester: Add support for Security Level Changed event

 apps/bttester/src/bttester.h |  7 +++++++
 apps/bttester/src/gap.c      | 33 ++++++++++++++++++++++++++++-----
 2 files changed, 35 insertions(+), 5 deletions(-)

commit 951abc9c3501d803e4266e6e7ce898e53e3bbfef
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 24 15:47:14 2019 +0200

    apps/bttester: Add missing return buf check

 apps/bttester/src/gatt.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 212a3e467ec78ad225862242880439f0c647c825
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 24 15:46:31 2019 +0200

    apps/bttester: Do not use atomics in gap.c
    
    This is so we can compile app without BLE_MESH.

 apps/bttester/src/gap.c | 34 ++++++++++++++++------------------
 1 file changed, 16 insertions(+), 18 deletions(-)

commit ea6ef736d2d9db9b391a4bd33bbd9aebcf6dbfed
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 18 14:02:03 2019 +0200

    apps/bttester: Change default syscfg values to fit on nRF52DK

 apps/bttester/syscfg.yml | 19 +++++++------------
 1 file changed, 7 insertions(+), 12 deletions(-)

commit 7ca817b2adc32570dbd8910464464dbd32353b99
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 12 15:39:24 2019 +0200

    apps/bttester: Add support for directed advertising

 apps/bttester/src/bttester.h |  7 +++++++
 apps/bttester/src/gap.c      | 32 ++++++++++++++++++++++++++++++++
 2 files changed, 39 insertions(+)

commit 409c5a30b3209eb9bf2bd84d3e712961c33d66cc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 9 16:26:31 2019 +0200

    apps/bttester: Add Connection Parameter Update implementation

 apps/bttester/src/bttester.h |  22 +++++++
 apps/bttester/src/gap.c      | 140 ++++++++++++++++++++++++++++++++++++++++++-
 2 files changed, 161 insertions(+), 1 deletion(-)

commit da51e2ef1464f75f3e2bf7624cbf3892d93af7d1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu May 16 01:08:09 2019 +0200

    apps/bttester: Change included service order

 apps/bttester/src/gatt.c | 65 ++++++++++++++++++++++++------------------------
 1 file changed, 32 insertions(+), 33 deletions(-)

commit 3fbe69ba7c22f1b6b12e2432bc5d360bec8e2bd3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon May 27 13:56:55 2019 +0200

    apps/bttester: Move descriptor definition for easier testing
    
    This is helpful for BTP Tester application.

 apps/bttester/src/gatt.c | 27 +++++++++++++++------------
 1 file changed, 15 insertions(+), 12 deletions(-)

commit 309b93e66b74f1fb64b01c2b57e00a809e4b813d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon May 27 13:54:56 2019 +0200

    apps/bttester: Add a dummy CCC descriptor definition
    
    This is used in add_descriptor method, when verifying that
    the descriptor that the Upper Tester wants to add is indeed present
    in the GATT database (since we are not able to add attributes dynamically).

 apps/bttester/src/gatt.c | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit c07adb5c5a478b3bc143f75aec0ccd2826d6ca43
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon May 27 13:53:52 2019 +0200

    apps/bttester: Fix find attribute by handle
    
    There was a typo that caused wrong interpretation of returned
    pointer to a structure with a descriptor definition.

 apps/bttester/src/gatt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d9f28dec9c497fa28b4a3378f606409bf206ee3c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Apr 25 16:24:02 2019 +0200

    apps/bttester: Remove write_long workaround
    
    This workaround should not be here. It should be
    on the AutoPTS side or this issue should be fixed in PTS.

 apps/bttester/src/gatt.c | 6 ------
 1 file changed, 6 deletions(-)

commit 472485aa1c956e675e95430bd98af2e770d16f8b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Apr 25 14:13:44 2019 +0200

    apps/bttester: Improve add attributes and set value
    
    With this patch the add_service, etc. returns a attribute handle
    in response, which can later be used to perform gatt reads/writes.
    Additionally you can use these handles in set_value and
    set_enc_key_size commands.

 apps/bttester/src/gatt.c | 284 ++++++++++++++++++++++++++++++-----------------
 1 file changed, 184 insertions(+), 100 deletions(-)

commit 5c68cca8d6660fe94d355b0bbe5fb4d49c6c2f9b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Apr 25 14:09:10 2019 +0200

    apps/bttester: Fix using mbufs
    
    This patch uses send_buf to make sure the whole chain gets
    sent, not just the first buffer.

 apps/bttester/src/gatt.c | 80 +++++++++++++++++++++++++-----------------------
 1 file changed, 41 insertions(+), 39 deletions(-)

commit 2ad14e7207bcd3241b59728e2d349f00111c4e14
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 19 16:52:39 2019 +0200

    apps/bttester: Delete code related to db offset calculation
    
    GATT Start Server params are deprecated.

 apps/bttester/src/gatt.c | 113 +----------------------------------------------
 1 file changed, 2 insertions(+), 111 deletions(-)

commit 0c8f1b6bd562fab23ed586aa4ecdfdb5f0d07c15
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 19 16:20:13 2019 +0200

    apps/bttester: Refactor Get Attrs and Get Attr Value
    
    Use internal ATT api to get attributes and their values.

 apps/bttester/src/gatt.c | 385 ++++++-----------------------------------------
 1 file changed, 46 insertions(+), 339 deletions(-)

commit 2321a8790ba54c45f488eae468302605f0bc6eb0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Apr 8 13:28:38 2019 +0200

    apps/bttester: Fix search attribute by handle

 apps/bttester/src/gatt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 814f73de88a1af54da74d245fc7eca575de24e42
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Apr 3 16:57:16 2019 +0200

    apps/bttester: Fix GATT Get attribute value

 apps/bttester/src/gatt.c | 61 ++++++++++++++++++++++++++++++++++--------------
 1 file changed, 43 insertions(+), 18 deletions(-)

commit fa013c8121a9b6e53a83fd42e0f7c76548b89a29
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Apr 3 16:07:53 2019 +0200

    apps/bttester: Add support for sending GATT includes

 apps/bttester/src/gatt.c | 25 ++++++++++++++++++-------
 1 file changed, 18 insertions(+), 7 deletions(-)

commit d9caef73fa1fc80aac7a3118330c0a01b3a8f936
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Apr 3 16:06:03 2019 +0200

    apps/bttester: Add support for sending segmented buffers
    
    Some messages are so long that mbuf chains have to be used to store them.
    This patch adds API to send mbufs. This api handles sending
    of all mbufs in a chain.

 apps/bttester/src/bttester.c      | 16 ++++++++++++++++
 apps/bttester/src/bttester.h      |  2 ++
 apps/bttester/src/bttester_pipe.h |  1 +
 apps/bttester/src/uart_pipe.c     | 25 +++++++++++++++++++++++++
 4 files changed, 44 insertions(+)

commit e6d9db0114a5c01b5c06e6ffce1aac635827c79b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Sep 10 21:29:35 2019 +0200

    porting: Add missing include in linux example
    
    main.c: In function ‘main’:
    main.c:65:33: warning: implicit declaration of function ‘atoi’ [-Wimplicit-function-declaration]
       65 |         ble_hci_sock_set_device(atoi(argv[1]));
          |                                 ^~~~

 porting/examples/linux/main.c | 1 +
 1 file changed, 1 insertion(+)

commit a069ebb3f3214e16c59cedc3fcbf61bbd0d49878
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Sep 10 21:26:25 2019 +0200

    porting: Remove BLE_NPL_WAIT_FOREVER from NPL API
    
    There is already BLE_NPL_TIME_FOREVER which should be used instead.
    Also due to int promotion using BLE_NPL_WAIT_FOREVER was causing
    subtle issues on 64bit asrchitectures when used.

 porting/examples/linux/main.c               | 4 ++--
 porting/examples/linux_blemesh/main.c       | 6 +++---
 porting/npl/linux/include/nimble/os_types.h | 2 --
 porting/npl/linux/src/os_mutex.c            | 2 +-
 porting/npl/linux/src/os_sem.c              | 2 +-
 porting/npl/linux/test/test_npl_eventq.c    | 2 +-
 porting/npl/linux/test/test_npl_sem.c       | 4 ++--
 7 files changed, 10 insertions(+), 12 deletions(-)

commit 03f4b3f903a3b47df43142900749e0192274adac
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Sep 10 12:18:59 2019 +0200

    porting: Improve linux sample
    
    Allow to specify HCI device at start.

 porting/examples/linux/main.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 92743bb80fdec355c18ae0e97354340bffaff676
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Sep 10 12:17:31 2019 +0200

    porting: Fix linux port example
    
    Linux port sample is using legacy advertising API which is disabled
    if Extended Advertising is enabled. For testing complete linux build we
    should have separate linux_dummy sample which doesn't call any APIs for
    simplicity.

 porting/examples/linux/include/syscfg/syscfg.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit db4d0fada0960ff8493200993a904f4395406960
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Mon Sep 9 12:33:53 2019 +0530

    Host: Remove unnecessary inclusion of headers in `prov.c` & `ble_sm_alg.c`

 nimble/host/mesh/src/prov.c  | 4 +---
 nimble/host/src/ble_sm_alg.c | 1 -
 2 files changed, 1 insertion(+), 4 deletions(-)

commit 80160ccdbe4886ab56babfd6b4c36249fd097299
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Sep 4 11:30:17 2019 +0200

    porting: Enable periodic advertising on linux port
    
    Make sure that linux port is build with all features enabled.

 porting/examples/linux/include/syscfg/syscfg.h | 14 +++++++++-----
 porting/npl/linux/src/os_eventq.cc             | 13 +++++++++++++
 porting/npl/linux/src/wqueue.h                 |  6 ++++++
 3 files changed, 28 insertions(+), 5 deletions(-)

commit 377842d8b430a20e3ae63f3443d56385564c2945
Author: Mohamed Essayed <mohamed.essayed@synopsys.com>
Date:   Thu Sep 5 20:24:09 2019 +0200

    nimble/gap: Solving bug in accessing ble_svc_gap_appearance

 nimble/host/services/gap/src/ble_svc_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 52e648989bf63631b5a0ea2e98f38e6307774def
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Aug 29 16:36:08 2019 +0200

    nimble/ll: Fix assert in ble_ll_adv_done
    
    This patch makes sure that periodic advertising uses its own scheduler
    type. It is needed to not confuse it with related extended advertising.
    
    Mentioned assert happend in the following scenario
    a) Nimble has configured and enabled connectable advertising
    b) Nimble has configured and enabled periodic advertising along with its
    extending advertising.
    c) Once Nimble connects and bonds with peer device, keys are storred
    and in that time GAP procedures are stopped i.e. advertising. In this
    moment periodic advertising and connection are ongoing.
    
    d) While advertising is OFF LL reschedules connection event. It might happen
    that periodic advertising is conflicting with this, and in this case
    connection has bigger prio. Scheduler wants to remove it but since
    periodic advertising uses BLE_LL_SCHED_TYPE_ADV, in fact it tries to
    stop already stopped advertising -> assert

 nimble/controller/include/controller/ble_ll_adv.h |  6 ++++++
 nimble/controller/src/ble_ll_adv.c                | 16 ++++++++++++++--
 nimble/controller/src/ble_ll_sched.c              |  5 +++++
 3 files changed, 25 insertions(+), 2 deletions(-)

commit c184d4482a3a36dd3678ee06afde89291ab1bbee
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Aug 27 15:12:37 2019 +0200

    nimble/ll: Refactor PHY transitions
    
    This changes semantics of ble_phy_mode_set(). Instead of only setting
    current phy_mode and TX-to-RX phy_mode, it will set an actual phy_modes
    used on every TX and RX during packet sequence. This allows ble_phy to
    configure RF properly for both transitions and also makes it resonsible
    for changing phy_mode on each transition - ble_ll shall now only call
    ble_phy_mode_set before 1st packet in an event, i.e. before calling
    ble_phy_tx/rx_set_start_time.

 nimble/controller/include/controller/ble_phy.h |  2 +-
 nimble/controller/src/ble_ll_conn.c            | 13 +++----
 nimble/drivers/nrf52/src/ble_phy.c             | 49 ++++++++++++++++----------
 3 files changed, 35 insertions(+), 29 deletions(-)

commit 5fb380d250b8636a6e289a36f6205ce39cc39f03
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Aug 14 15:41:42 2019 +0200

    nimble/porting: Add util.h
    
    This might be useful for portings.

 porting/nimble/include/os/util.h | 38 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 38 insertions(+)

commit fb5f503bd8b360ddecb91946822275868e261a7d
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Aug 28 16:02:28 2019 +0200

    controller: fix '-Wsometimes-uninitialized' issue
    
    In ble_ll_pdu_max_tx_octets_get(), LLVM complains about the
    possibility of the `octets` variable not being intialized. This is
    the case, if no assert() function is compiled in. This commit
    fixes this by initializing `octets` to a save value.

 nimble/controller/src/ble_ll.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3098b06d0dc2353a4e266f6780dd3edff1ad5bf4
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 31 16:20:16 2019 -0700

    Mynewt: Define logs in packages' syscfg files
    
    Defining logs in syscfg files provides a few benefits:
    
    1. Ability to set log level per module at build time.  Setting a global
    log level of 0 (`LOG_LEVEL=0`) might produce an image that is too big.
    Instead, we can enable debug logging only for the modules we are
    interested in.
    
    2. Easier to visualize system log configuration (see below).
    
    3. Log modules can be remapped at build time in case of conflicts.
    
    To see the system-wide log configuration, use either of these commands:
    
    ```
    newt target logcfg brief <target-name>
    newt target logcfg show <target-name>
    ```

 nimble/host/include/host/ble_hs_log.h | 27 ++++++++++++++++++++++-----
 nimble/host/syscfg.yml                | 14 ++++++++++++++
 2 files changed, 36 insertions(+), 5 deletions(-)

commit 2a675a243d61227cc658373575cb4339d2fb114d
Author: Hardik Senjaliya <hardik@proxy.com>
Date:   Mon Aug 19 12:45:31 2019 -0700

    nimble/mesh: using correct define name

 porting/examples/linux_blemesh/include/syscfg/syscfg.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit f140f1c993cd79ad0926facd20f25b9e26f11226
Author: Hardik Senjaliya <hardik@proxy.com>
Date:   Mon Aug 12 16:30:45 2019 -0700

    nimble/mesh: configurable segment retransmist attempts

 nimble/host/mesh/src/transport.c                       | 2 +-
 nimble/host/mesh/syscfg.yml                            | 6 ++++++
 porting/examples/linux_blemesh/include/syscfg/syscfg.h | 4 ++++
 3 files changed, 11 insertions(+), 1 deletion(-)

commit b24bb88bb50c3167e31dd84e23f1f9affa698218
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Aug 21 14:42:30 2019 +0200

    nimble/host: Cleanup address type conversion
    
    We should consistently store sec/cccds using public/random address types.
    To do this we introduce dedicated conversion functions for own and
    peer address types. Even though they use the same values it makes
    code easier to follow.

 nimble/host/src/ble_gatts.c             |  8 ++++++++
 nimble/host/src/ble_hs_conn.c           |  2 +-
 nimble/host/src/ble_hs_id.c             |  2 +-
 nimble/host/src/ble_hs_misc.c           | 20 +++++++++++++++++++-
 nimble/host/src/ble_hs_priv.h           |  3 ++-
 nimble/host/src/ble_sm.c                |  3 ++-
 nimble/host/test/src/ble_sm_test_util.c | 12 ++++++------
 7 files changed, 39 insertions(+), 11 deletions(-)

commit 8a505c8e76e7f04a6e1e3cc6ddf682e053c07161
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 21 14:53:35 2019 +0200

    nimble/ll: Fix removing IRK from resolv list
    
    We need to move proper number of bytes for complete resolv entry.

 nimble/controller/src/ble_ll_resolv.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit f283b9156efef22fca31108e185946a0fd617006
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 21 14:53:35 2019 +0200

    nimble/phy: Fix removing IRK from resolv list
    
    We need to move proper number of bytes for complete IRKs.

 nimble/drivers/nrf51/src/ble_hw.c | 2 +-
 nimble/drivers/nrf52/src/ble_hw.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit a42abba4f60dff37c77f5a5172ee9e1d7ec125d7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 19 11:38:47 2019 +0200

    nimble/mesh: Improve proxy handling when using BLE_EXT_ADV
    
    When using multiadvertising feature, mesh can more precisly say when
    remote connects to the proxy server.
    It is valuable when Node is using additional advertising instances for
    other purposes than mesh.

 nimble/host/mesh/include/mesh/glue.h | 14 ++++++++++++
 nimble/host/mesh/src/glue.c          | 14 ------------
 nimble/host/mesh/src/proxy.c         | 43 ++++++++++++++++++++++++++++++------
 3 files changed, 50 insertions(+), 21 deletions(-)

commit 70cfe8b7923720858dbf99f3b55252f812272a71
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 19 11:37:43 2019 +0200

    nimble/gap: Add missing listener callback call on Scan Request

 nimble/host/src/ble_gap.c | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

commit 2e28eefb543d24a3fbf4d6394024816f60bf1615
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 19 11:37:08 2019 +0200

    nimble/gap: Add missing listener callback call on adv finished

 nimble/host/src/ble_gap.c | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)

commit e52a1f56c1af02c778eda2261191a5ff52cb2fe3
Merge: 53dc68db 943983f5
Author: wes3 <wills@runtime.io>
Date:   Mon Aug 12 13:24:47 2019 -0700

    Merge pull request #553 from wes3/conn_pkt_cntr_fix
    
    nimble/controller: Packet counter size in connection incorrect.

commit 53dc68dba29741b9b685a5dcb5a1683aabc34fe2
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu May 16 11:48:56 2019 +0200

    mesh/adv: fix adv duration when using nimble controller
    
    The Nimble controller schedules advertising over scanning, so the
    scan window offset needed for the Zephyr controller leads to an
    increased number of advertisement packets sent when using the
    Nimble controller. The duration is now calculated only from the
    number of wanted transmissions and the advertising period + jitter.

 nimble/host/mesh/src/adv.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 943983f5e9c3bd03f70d78137d4b1976f9408eed
Author: Will San Filippo <william.sanfilippo@juul.com>
Date:   Tue Aug 6 14:47:47 2019 -0700

    nimble/controller: Packet counter size in connection incorrect.
    
    The transmit and receive packet counters were incorrectly sized at
    16 bits. The specification dictates 39 bits of packet counter. The
    fix makes them 32 bits as opposed to the full 39 as we do not think
    the chance of there being more than 2^32 packets during a connection
    likely and thus does not warrant the additioal RAM usage per
    connection (nor the slight addition to code space and speed).

 nimble/controller/include/controller/ble_ll_conn.h | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit 496f4583738fe68fa319be9bc5edadb9e01dc9a3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Aug 5 08:28:06 2019 +0200

    nimble/ll: Indicate proper transition from AUX_CONNECT_REQ
    
    nrf5x PHY works without this patch because it ignores this return value
    and configures transition speculatively on RX end, before processing
    received packet.
    
    With this fix such workaround is not necessary so we can fix nrf5x PHY.

 nimble/controller/src/ble_ll_adv.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 0ed1444639e72f03fc714e3e59cc787198f59b66
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Sun Aug 4 21:01:05 2019 +0200

    Apache NimBLE 1.2.0 release

 repository.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit aa87f447d0b766cad076b8a0dbb17f3f3d0fbd38
Author: Anton Maklakov <anton@espressif.com>
Date:   Wed Jul 31 11:27:14 2019 +0700

    fix -Wstrict-prototypes issues

 apps/blecsc/src/main.c                        |  2 +-
 apps/bttester/src/gatt.c                      |  2 +-
 apps/bttester/src/l2cap.c                     |  2 +-
 nimble/controller/include/controller/ble_ll.h |  2 +-
 nimble/host/test/src/ble_hs_conn_test.c       |  2 +-
 nimble/transport/uart/src/ble_hci_uart.c      |  2 +-
 porting/npl/linux/test/test_npl_callout.c     |  8 ++++----
 porting/npl/linux/test/test_npl_eventq.c      | 10 +++++-----
 porting/npl/linux/test/test_npl_mempool.c     |  6 +++---
 porting/npl/linux/test/test_npl_task.c        |  2 +-
 10 files changed, 19 insertions(+), 19 deletions(-)

commit b2289a008f71dbf6c4fbfd4f6644c695d32b2ad7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 22 20:58:46 2019 +0200

    apps/btshell: Fix full discovery
    
    During full discovery, if last service does not have any characteristic
    but its end handle is 65535 (which is allowed by Core spec), discovery
    will loop forever since it assumes service was discovered if either
    start handle == end handle or there are characteristics discovered.
    
    This patch fixes this by adding "discovered" property to service struct
    which is used to check if service was already discovered.

 apps/btshell/src/btshell.h |  2 ++
 apps/btshell/src/main.c    | 43 ++++++++++++++++++++++++++++++++++++++++---
 2 files changed, 42 insertions(+), 3 deletions(-)

commit 997dad8c9fc549e64b6c54eafcec109d92789418
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Fri Jul 5 12:05:22 2019 +0200

    npl/riot: disable LL privacy and encryption
    
    The RIOT port aims to provide a very slim default
    configuration with only some basic features enabled.
    The link layer privacy and encryption featues can be
    re-enabled through the RIOT build-system, this allows
    a simpler integration with low-resource platforms.

 porting/npl/riot/include/syscfg/syscfg.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit b1ec1d1f3f17d09eba1707e563b83a1910c4506f
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Fri Jul 5 11:42:12 2019 +0200

    npl/riot: disable LL data length ext per default

 porting/npl/riot/include/syscfg/syscfg.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a73dc45a686e571eedf159ed5150b05b5828980b
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Jun 12 15:43:01 2019 +0200

    npl/riot: reduce default msys bufsize to minimum

 porting/npl/riot/include/syscfg/syscfg.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 354d27da7625bccbabc14ce2f0079b4f6ed8712c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Aug 1 12:12:54 2019 +0200

    travis: Upgrade to go 1.12

 .travis.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0c0910b3983d29ddfbdb3b7d17f7714b7107b9f0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 19 15:09:11 2019 +0200

    apps/bleprph: Make device name configurable

 apps/bleprph/src/main.c | 4 ----
 apps/bleprph/syscfg.yml | 2 ++
 2 files changed, 2 insertions(+), 4 deletions(-)

commit 708d3b30ea290fb616d8901659542e272f6a01ab
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 26 10:47:42 2019 +0200

    nimble/ll: Fix restarting RX on wfr while scanning
    
    With this patch we move restarting RX on wfr while scanning to interrupt
    context instead of LL context.
    It is because we want to restart RX as fast as possible while scanning.
    Also previous ble_phy_restart_rx call in LL context during
    interrupts enabled was incorrect.

 nimble/controller/src/ble_ll_scan.c | 39 +++++++++++++++++++++++++++++++++++--
 1 file changed, 37 insertions(+), 2 deletions(-)

commit e0f88eb0fffe962d656175ea2fa070a4922d84ea
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jul 24 12:13:16 2019 +0200

    apps/blecent: Remove explicit dependency to controller
    
    blecent should work with any transport, it does not need explicit
    dependency to controller and RAM transport. nimble/transport meta
    package will select proper transport and add controller dependency
    automatically if needed.

 apps/blecent/pkg.yml    | 3 +--
 apps/blecent/src/main.c | 4 ----
 2 files changed, 1 insertion(+), 6 deletions(-)

commit 4cb0c0561c4529f50a2ffdd9ac9987fc5ec2a1fd
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jul 24 12:17:54 2019 +0200

    nimble/host: Fix initialization order
    
    Transport should be configured after default queue is set.
    
    Callbacks set by host handle data by putting them on queue and use
    event queue to notify host. If queue is not set (which can happen if
    transport sends data immediately after callbacks are registered),
    we'll have crash.

 nimble/host/src/ble_hs.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 70142326fdc4e84405cb9c0e0fc796ac4d340758
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jul 24 12:17:26 2019 +0200

    nimble/ll: Fix initialization order
    
    Transport should be configured before sending nop.
    
    Since transport is configured after os_task_init, it won't happen until
    ble_ll_task sleeps on eventq. This means LL will send nop without
    transport configured, which depending on transport may or may not work.
    
    os_task_init should be the last step of LL init and transport should be
    registered just before nop is sent.

 nimble/controller/src/ble_ll.c | 25 +++++++++++++------------
 1 file changed, 13 insertions(+), 12 deletions(-)

commit d9118c406eb4eecf63e9db1b4d01eb80778029c4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 23 03:43:57 2019 +0200

    nimble/phy: Fix memblock overwrite on PDU copy
    
    Optimized ble_phy_rxpdu_copy (f19002e9) can overwrite header of adjacent
    block at specific payload lengths.
    
    This happens if length of data that should be copied to last mbuf in
    chain is less than 4 bytes of data. In such case the last but one mbuf
    is already full when remaining data are appended to it beyond its data
    buffer effectively overwriting adjacent buffer.
    
    We should always check if there is enough space in current mbuf to copy
    data. If not, we just advance to next mbuf in chain. Even in such case
    there will be free mbuf to store remaining few bytes of data as this is
    guaranteed by ble_ll_rxpdu_alloc.

 nimble/drivers/nrf51/src/ble_phy.c | 13 ++++++++-----
 nimble/drivers/nrf52/src/ble_phy.c |  5 ++++-
 2 files changed, 12 insertions(+), 6 deletions(-)

commit cd1b98d63dfee5b47d26aa74a659f55de5ba4327
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jul 22 22:20:41 2019 +0200

    nimble/ll: Remove pointer to unreferenced aux_data
    
    When removing aux scheduler entry from the scheduler, make sure to remove
    the reference to the aux_data.

 nimble/controller/src/ble_ll_scan.c | 1 +
 1 file changed, 1 insertion(+)

commit 2a27eb23ca2860d0a9b462f6cadcca28001f17dc
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 4 21:05:07 2019 +0200

    nimble/ll: Enlarge critical section when stoping scanning

 nimble/controller/src/ble_ll_scan.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit 8b9cde1df640b64e1f4aa1d5d376b781c152f8ae
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 17 11:59:24 2019 +0200

    nimble/mesh: Fix null pointer access on prov_init
    
    During bt_mesh_prov_init() a bt_mesh_proxy_get_buf() function
    is called that returns a buffer that tries to initialize
    unallocated buffer. With this patch we just return NULL
    here, and then the buffer is allocated after Proxy is initialized.

 nimble/host/mesh/src/proxy.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit f3f06a8d6f9944fccfbad5b7c69ced2c53331738
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 31 14:18:00 2019 +0200

    nimble/ble_hs_stop: Change hs stop procedure
    
    This patch change a way of handling stop procedure. Before, host was
    disconnecting one by one all the active connections. This could result
    in long procedure time when some devices came out of range and host was
    waiting as long as supervision timout takes.
    
    Now, host is sending in the raw Disconnect Command to all the active
    connections and then start graceful disconnect timeout 2s.
    Host notifies that is stop when
    a) all the disconnection complete events arrived within 2s
    b) disconnect timeout fires

 nimble/host/src/ble_hs_stop.c                      | 100 ++++++++++++---------
 nimble/host/syscfg.yml                             |   6 ++
 porting/examples/linux/include/syscfg/syscfg.h     |   4 +
 .../examples/linux_blemesh/include/syscfg/syscfg.h |   4 +
 porting/nimble/include/syscfg/syscfg.h             |   4 +
 porting/npl/riot/include/syscfg/syscfg.h           |   3 +
 6 files changed, 81 insertions(+), 40 deletions(-)

commit 450b12ad2a8991bac7d87efd984a159ede13b85d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 31 14:11:15 2019 +0200

    nimble/ble_hs_conn: Add foreach helper function
    
    This is going to be used in following patch

 nimble/host/src/ble_hs_conn.c      | 14 ++++++++++++++
 nimble/host/src/ble_hs_conn_priv.h |  3 +++
 2 files changed, 17 insertions(+)

commit 605d2225de7729c3b7e98db3e52f992c8b155a9b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 31 14:10:13 2019 +0200

    nimble/gap: Add helper ble_gap_terminate_with_conn()
    
    This is going to be used in following patch

 nimble/host/src/ble_gap.c      | 45 ++++++++++++++++++++++++------------------
 nimble/host/src/ble_gap_priv.h |  1 +
 2 files changed, 27 insertions(+), 19 deletions(-)

commit ed3cf914872c26f065d6201f07acb189f3bdf6e8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 31 14:12:20 2019 +0200

    nimble/ble_hs_conn: Minor coding style fix

 nimble/host/src/ble_hs_conn_priv.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 9f62cf205e16cad9247e583e63d554e5ba8c3127
Author: JustineKH <justine@juul.com>
Date:   Wed Jul 17 16:04:08 2019 -0700

    nimble/ll: Fix dtm stop

 nimble/controller/src/ble_ll_dtm.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 63f2ced9e11f2f3f39ec17a6d06218761fa6c7ca
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 16 21:23:35 2019 +0200

    nimble/ll: Workaround and traces for the possible race scenario
    
    It looks like there is a race when closing connection with different
    paths. It can lead to situation that Nimble tries to close connsm which is
    already in IDLE, which leads to crash when removing connsm from
    g_ble_ll_conn_active_list which does not contain connsm.
    
    This patch adds workaround and plus assert and stats which should help
    to understand the root cause

 nimble/controller/src/ble_ll_conn.c | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)

commit 1e919fdca7c41a4ec75daa0a84220c5bf8ed4e8e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 16 18:26:57 2019 +0200

    Prepare for NimBLE 1.2 release

 repository.yml | 4 ++++
 1 file changed, 4 insertions(+)

commit c2053ffc231d7b9237fe987f96a222f764f4ca56
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 2 14:12:53 2019 +0200

    nimble/transport: Add option to use custom HCI transport
    
    Since it's recommended for apps to explicitly include only meta-package
    for HCI transport (so it can be easily changed in target for any BSP),
    we should also have an option to allow HCI transport other than one of
    those we have in tree. This is useful for development and 3rd party
    solutions which may have own HCI transport.

 nimble/transport/syscfg.yml | 1 +
 1 file changed, 1 insertion(+)

commit 11dcd95667b8ac91bf4d995afd7279fcdcc2c116
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 12 13:46:46 2019 +0200

    nimble/mesh: Increase transaction ID after sending unack message
    
    UNACK messages are not retransmitted so we should increase TID
    after sending each message.

 nimble/host/mesh/src/model_cli.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 181ed07b08838dc539ba6256c87bf8791e5f44ca
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 11 11:23:48 2019 +0200

    nimble/ll: Fix return value

 nimble/controller/src/ble_ll_sched.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 001516faa0c9588b138bd5d4e4e7ef2ceb51e03d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 16:36:35 2019 +0200

    nimble/ll: Minor comment fix

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7a9e3147aa4edf0231478539f0546d414735d4e5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 16:36:16 2019 +0200

    nimble/ll: Check if truncated on CRC error

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7858eb588507dbc53651170a9548926ec7ff53f8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 14:32:16 2019 +0200

    nimble/ll: Minor rename parameter for consistency

 nimble/controller/src/ble_ll_scan.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit cb1137d295780b525e6787237de73614ca2db9a8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 13:49:17 2019 +0200

    nimble/ll: Fix start time calculations

 nimble/controller/src/ble_ll_sched.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit d1bcaa11a860710def805b4f4bf1da17e3ae1e47
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 13:41:40 2019 +0200

    nimble/ll: Fix error handling when sending chained adv report
    
    In case there NimBLE has scheduled for next aux chain which is already
    fired, but there was an issue with previous report sending over the HCI,
    removing scheduled item from the scheduler will not succeed.
    
    This patch makes sure truncated event will be delivered to the
    host in such a case.

 nimble/controller/src/ble_ll_scan.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 03a628808378900e188d5aee06bf17af6eb175c5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 11 10:03:43 2019 +0200

    nimble/ll: Add missing aux_data check

 nimble/controller/src/ble_ll_scan.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 41a33b9a314a2de7d05e1793f091f1e86cc71f9e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 11 10:02:32 2019 +0200

    nimble/ll: Send truncated when error on parsing ext header

 nimble/controller/src/ble_ll_scan.c | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 7fb407e682855e29841fad232b46435699656eea
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 13:26:53 2019 +0200

    nimble/ll: Minor coding style issues

 nimble/controller/src/ble_ll_scan.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 0e9b96d21763c0d9e874a20f90815b19595e96c1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 13:23:35 2019 +0200

    nimble/ll: Add assert to detect not completed chained advertising report

 nimble/controller/src/ble_ll_scan.c | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit 5ccaec1a0be66b8d4047662bf5db0e4834d173dd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 10 12:17:24 2019 +0200

    nimble/ll: With new ref_cnt in truncated case aux_data->evt must be there

 nimble/controller/src/ble_ll_scan.c | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit caaceb1946286fc8f22bd90e75a05d264cea9837
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jun 20 00:10:21 2019 +0200

    nimble/ll: Add ble_ll_scan_interrupt function
    
    This is common fuction to be called whenever scanning has been
    interrupted. This function sends event to LL task.
    
    Also with this patch, scheduled AUX entry gets pointer to aux_data when
    it is scheduled and not when aux_data is created. This is because
    aux_data->ref_cnt is increased when scheduled.

 nimble/controller/include/controller/ble_ll_scan.h |  5 ++-
 nimble/controller/src/ble_ll_conn.c                |  5 +--
 nimble/controller/src/ble_ll_scan.c                | 45 +++++++++++++++-------
 nimble/controller/src/ble_ll_sched.c               |  1 +
 4 files changed, 39 insertions(+), 17 deletions(-)

commit 83dff410f233efe4e72de21f2c7329331f7b8a70
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 12 11:28:52 2019 +0200

    apps: Stop using ble_npl api
    
    This api should only be used between the OS and Nimble. Apps should
    use OS specific APIs.

 apps/blemesh_models_example_1/src/main.c           |  24 +-
 apps/blemesh_models_example_2/src/app_gpio.c       |   6 +-
 .../src/device_composition.c                       |  50 ++--
 apps/blemesh_models_example_2/src/main.c           |  14 +-
 .../src/no_transition_work_handler.c               |  48 ++--
 .../src/no_transition_work_handler.h               |   2 +-
 apps/blemesh_models_example_2/src/publisher.c      |   2 +-
 apps/blemesh_models_example_2/src/publisher.h      |   2 +-
 apps/blemesh_models_example_2/src/storage.c        |   9 +-
 apps/blemesh_models_example_2/src/storage.h        |   2 +-
 apps/blemesh_models_example_2/src/transition.c     | 288 ++++++++++-----------
 apps/blemesh_models_example_2/src/transition.h     |   6 +-
 12 files changed, 225 insertions(+), 228 deletions(-)

commit e138127e3f9855e518086be2e1628af09fd4d6af
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 11 14:43:01 2019 +0200

    nimble/ll: Use a different RPA when initiating Directed Connection
    
    Core Specification Vol 6, Part B, Section 6.4:
    "The Link Layer should not set the InitA field to the same
    value as the TargetA field in the received advertising PDU."

 nimble/controller/src/ble_ll_conn.c | 27 +++++++++++++++++++++++----
 1 file changed, 23 insertions(+), 4 deletions(-)

commit 091e766150c59aebe70530d6a45de4e9d0199290
Author: CharlesParent <cha.parent@gmail.com>
Date:   Thu Jul 11 10:48:07 2019 +0200

    Fix BLE_ADDR_IS_NRPA and BLE_ADDR_IS_STATIC define

 nimble/include/nimble/ble.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 86b28a32586957f994222acc9d676579b2083a7b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jun 17 15:22:35 2019 +0200

    nimble/ll: Improve getting advertiser address for ext adv packet
    
    With this change, when getting adva and inita from advertising
    extensions, NimBLE will first try to get it from the packet and if not
    succeed then it will look into related aux_data pointer.
    
    This is needed especially when waiting for AUX_CONNECT_RSP where RPA
    adva might be different from the one in advertising packets.

 nimble/controller/src/ble_ll_scan.c | 71 +++++++++++++++++++++++--------------
 1 file changed, 45 insertions(+), 26 deletions(-)

commit 137f2594de1e46e2db12056655b82a39083f9c53
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 8 22:36:33 2019 +0200

    nimble/ll: Do not drop event on failed PDU reschedule
    
    For unknown reason we drop advertising event when failed to reschedule
    advertising PDU. This does not affect legacy advertising too much since
    we'll just skip one or two channels, but in case of extended advertising
    it also removes AUX which means complete extended advertising event is
    lost.
    
    In addition, nRF51 is not fast enough to ensure all PDUs on primary
    channels can be scheduled before AUX so this effectively means extended
    advertising on nRF51 is unusable.
    
    With this fix we won't drop complete event if PDU reschedule fails, just
    move to next channel. It allows extended advertising to be usable on
    nRF51, but we should also allow to relax AUX scheduling constraints
    which will allow to schedule all primary PDUs properly - this will be
    addressed later.

 nimble/controller/src/ble_ll_adv.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 5f56107d61e7b8154342531b950f038bced9d486
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 1 12:56:37 2019 +0200

    nimble/mesh: Sync provisioning code with Zephyr
    
    This patch contains a few proposed patches from Mynewt that
    were backported to Zephyr and since there were other differences
    in this file I decided to sync it in one commit.
    
    In sync with this PR:
    https://github.com/zephyrproject-rtos/zephyr/pull/17117

 nimble/host/mesh/src/prov.c | 348 +++++++++++++++++++-------------------------
 1 file changed, 153 insertions(+), 195 deletions(-)

commit d512d353a021605b901740e3bd3281c547a9a9c2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Jul 7 11:40:10 2019 +0200

    nimble/ll: Add static checks for mbuf data alignment
    
    Since copying of received PDUs into mbufs assumes data in mbuf is word
    aligned, let's add static checks to make sure this is indeed true to
    avoid surprises in the future.

 nimble/controller/src/ble_ll.c | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 99df12df07e193964a980dc74c8c79b15f6f0a89
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Jul 6 12:31:04 2019 +0200

    nimble/phy/nrf51: Optimize PDU copy
    
    This replaces ble_phy_rxpdu_copy() with optimized code from nRF52.

 nimble/drivers/nrf51/src/ble_phy.c | 117 ++++++++++++++++++++-----------------
 1 file changed, 64 insertions(+), 53 deletions(-)

commit f19002e909b108585b2a1747e7cf45b81b1f85fe
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Jul 6 03:34:00 2019 +0200

    nimble/phy/nrf52: Optimize PDU copy
    
    This optimizes ble_phy_rxpdu_copy by (1) using uint32_t instead of
    uint16_t for calculations and (2) adding inline assembly to perform
    actual copying:
    
    (1) means there is no need to sign-extend values all the time,
    (2) means there are no e.g. redundant cmp instructions which GCC has
        tendency to use.
    
    Overall, optimized copying is over 2 times faster than old routine
    when copying long PDUs.

 nimble/drivers/nrf52/src/ble_phy.c | 117 ++++++++++++++++++++-----------------
 1 file changed, 64 insertions(+), 53 deletions(-)

commit 68527f9f239967b9e54b344d4d3fa7a48f7a4253
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Jul 6 00:26:08 2019 +0200

    nimble/ll: Cleanup ble_ll_rxpdu_alloc
    
    This just changes local variable names a bit and adds some comments to
    better explain how this function works.

 nimble/controller/include/controller/ble_ll.h | 12 ++--
 nimble/controller/src/ble_ll.c                | 89 +++++++++++++--------------
 2 files changed, 52 insertions(+), 49 deletions(-)

commit 5ed0130269bd5e5dba438e3f509527c90307057f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 5 22:59:27 2019 +0200

    nimble/ll: Rename CONNECT_REQ to CONNECT_IND
    
    CONNECT_IND is used instead of CONNECT_REQ starting with Core 5.0.

 nimble/controller/include/controller/ble_ll.h | 4 ++--
 nimble/controller/src/ble_ll.c                | 4 ++--
 nimble/controller/src/ble_ll_adv.c            | 6 +++---
 nimble/controller/src/ble_ll_conn.c           | 2 +-
 nimble/controller/src/ble_ll_scan.c           | 2 +-
 5 files changed, 9 insertions(+), 9 deletions(-)

commit 0da4decf660bd857dcea1d8cfd75a9a92dc2012b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 5 22:57:15 2019 +0200

    nimble/ll: Rename functions for consistency

 nimble/controller/src/ble_ll_conn.c | 15 ++++-----------
 1 file changed, 4 insertions(+), 11 deletions(-)

commit 72f6c4cc7df3671ff7ac29a6f41d164c1612b1db
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 5 22:50:01 2019 +0200

    nimble/ll: Do not use separate msys buffer for CONNECT_IND
    
    See previous commit.
    
    We only need InitA and AdvA to create CONNECT_IND on the fly, no need
    to have an extra always allocated mbuf. Storage for these data can be
    shared with scan state machine, the same as we shared mbuf.
    
    This allows to remove redundant mbuf allocation on startup and saves
    one block of msys pool.

 nimble/controller/include/controller/ble_ll_scan.h |  11 +-
 nimble/controller/src/ble_ll_conn.c                | 169 +++++++++------------
 2 files changed, 82 insertions(+), 98 deletions(-)

commit f8d5a73699da300748b6ffc6b74626e1df98d51b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 5 22:48:39 2019 +0200

    nimble/ll: Do not use separate msys block for SCAN_REQ
    
    LL allocates one mbuf on startup as a placeholder for SCAN_REQ. This
    consumes one block from msys and was necessary to make sure we have
    a buffer available instantly since SCAN_REQ is sent from interrupt
    context.
    
    Currently we can create PDUs on the fly during transmission so we only
    need ScanA and AdvA to be calculated before starting TX and they will
    be just copied directly to PDU while transmitting.
    
    We cannot yet remove this extra block from state machine since it is
    shared with CONNECT_IND, but we'll deal with this in next patch.

 nimble/controller/include/controller/ble_ll_scan.h |  7 ++
 nimble/controller/src/ble_ll_scan.c                | 83 +++++++++-------------
 2 files changed, 42 insertions(+), 48 deletions(-)

commit 34ee363fdeb9887eb38e96f89b1fde556ec0bc7e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 1 12:56:53 2019 +0200

    nimble/ll: Fix using ID address types when filtering duplicates
    
    The duplicate list should store only public/random address types
    and not public_id/random_id.
    
    Without this change there would be an assert in
    ble_ll_scan_dup_update_legacy when scanning resolved address.

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit d9992ac5a888fb4ba93feb4d9d51e988d3b31256
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 27 11:51:49 2019 +0200

    nimble/host: Simplify lookup for LE Meta event handler
    
    Unlike HCI events, we have handler for almost all LE Meta events so it
    is more efficient to have simple array of handlders indexed by subevent
    code instead of having to iterate it as a list.
    
    Also, since we do not need subevent code in dispatcher structure the new
    array is smaller.

 nimble/host/src/ble_hs_hci_evt.c | 73 ++++++++++++++--------------------------
 1 file changed, 26 insertions(+), 47 deletions(-)

commit 7069ca904251c65229409cc3f4a6df62896134a7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 27 11:29:36 2019 +0200

    nimble/host: Improve HCI events handlers lookup
    
    HCI event handler lookup is done by simply iterating over list so let's
    make sure that events that are most frequently used are at the beginning
    of the list.

 nimble/host/src/ble_hs_hci_evt.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 70d53304c072808c8b82ad89be4bf3a063748040
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 11 00:00:50 2019 +0200

    nimble/host: Add event for scan request notification
    
    We can enable scan request notifications for an advertising instance so
    would be good to have event that app can actually use.

 nimble/host/include/host/ble_gap.h | 16 ++++++++++++++++
 nimble/host/src/ble_gap.c          | 27 +++++++++++++++++++++++++++
 nimble/host/src/ble_gap_priv.h     |  1 +
 nimble/host/src/ble_hs_hci_evt.c   | 24 ++++++++++++++++++++++++
 nimble/include/nimble/hci_common.h |  9 +++++++++
 5 files changed, 77 insertions(+)

commit 3396ab78028b1c4437f13b0d11bcfbf9b8e28772
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 27 12:35:50 2019 +0200

    apps/blehci: Allow HCI transport to be configured
    
    Even though we always use blehci over UART, it may be useful to have
    transport configurable in case someone develops an USB transport or
    something else...

 apps/blehci/pkg.yml    | 7 +++++--
 apps/blehci/syscfg.yml | 2 ++
 2 files changed, 7 insertions(+), 2 deletions(-)

commit 7d4ce2c9ad7f26baec51a2547cfbe21b60cbe303
Author: Marko Kiiskila <marko@apache.org>
Date:   Tue Jun 25 16:58:54 2019 +0300

    nimble/controller/test; adjust priorities of tasks spawned for
    native MCU. None should conflict with each other.

 nimble/controller/test/syscfg.yml | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 71191a5c94f334feaf95d1311fb0c76e175a08b5
Author: Szymon Czapracki <szymonczapracki@gmail.com>
Date:   Mon Jun 17 15:17:07 2019 +0200

    nimble/mesh: Fix Public Key mismatch error handling
    
    Mismatch in Public Key type will cause device to send
    Invalid Format error, and treat any further PDU's as unexpected.
    
    This affects MESH/NODE/PROV/BI-03-C test case.

 nimble/host/mesh/src/prov.c | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit bc67ee39665807f1c26fff5358ce5f694626d4cb
Author: Szymon Czapracki <szymonczapracki@gmail.com>
Date:   Fri Jun 14 14:30:01 2019 +0200

    nimble/mesh: Fix provisioning errors handling
    
    Provisioning errors won't cause device to close link.
    Upon error, device will send Provisioning Failed PDU, and any further
    PDU's will be considered as unexpected. (Mesh Pofile section 5.4.4)
    
    Also a timer starts every time device sends a correct PDU.
    This affects MESH/NODE/PROV/BV-10-C test case.

 nimble/host/mesh/src/prov.c | 100 +++++++++++++++++++++++++++++++++-----------
 1 file changed, 75 insertions(+), 25 deletions(-)

commit 1dfda9db14ed72b9050ca607450d0c8fc9f927e0
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Jun 13 15:40:36 2019 +0200

    drivers/nrf52: do not set IRQ prio for RIOT
    
    RIOT does not allow for nested interrupts and initializes all IRQs
    to the same priority during system initialization. Assigning
    different priorities in the driver leads to system crashes.

 nimble/drivers/nrf52/src/ble_hw.c  | 2 ++
 nimble/drivers/nrf52/src/ble_phy.c | 2 ++
 2 files changed, 4 insertions(+)

commit fd4f3eb7c32c992af064c3c633c72f0e848f20e9
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Jun 13 15:38:31 2019 +0200

    drivers/nrf51: do not set IRQ prio for RIOT
    
    RIOT does not allow for nested interrupts and initializes all IRQs
    to the same priority during system initialization. Assigning
    different priorities in the driver leads to system crashes.

 nimble/drivers/nrf51/src/ble_hw.c  | 2 ++
 nimble/drivers/nrf51/src/ble_phy.c | 2 ++
 2 files changed, 4 insertions(+)

commit 68e295ab2ff4542b624ac83176f85c6b58096102
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 11 17:25:48 2019 +0200

    nimble/ll: Refactor duplicates filtering
    
    This patch refactors duplicates filtering to make it more robust by
    auto-expiring entries, removes limitation of 255 entries in cache and
    properly handles extended advertising reports for multiple sets and
    anonymous devices.
    
    Instead of a static array we use mempool of dup_entries which are linked
    to create a queue where most recently found device is placed on top.
    This allows to simply remove least recently found devices from queue
    when list capacity is reached and thus keep filtering new devices.
    
    Legacy advertising devices are simply matched by address thus each
    device has single entry in the queue.
    Extended advertising devices are matched by address and SID thus each
    device can have multiple entries in queue (for each SID).

 nimble/controller/src/ble_ll_scan.c | 469 ++++++++++++++++++++----------------
 1 file changed, 258 insertions(+), 211 deletions(-)

commit f6cd9bb414f2fb1170fe022e50762f94cb604265
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jun 19 11:39:56 2019 +0200

    nimble/ll: Fix regression in chained scan response
    
    Regression after
    7c17723d nimble/ll: Simplify aux_data ref counter usage
    
    Setting BLE_LL_AUX_INCOMPLETE_BIT has been incorrectly moved in mentioned
    patch.
    
    This fixes LL/DDI/SCN/BV-24-C

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit da6c12b33eab20209c8cf6d0d0e077b82a5e487d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jun 19 13:05:51 2019 +0200

    nimble/ll: Fix regression on connection to RPA
    
    Regression after
    e46fdc90 nimble/ll: Fix peer address check with privacy
    
    Regression prevented to connect to unknown device which uses RPA

 nimble/controller/src/ble_ll_conn.c | 26 +++++++++++++++-----------
 1 file changed, 15 insertions(+), 11 deletions(-)

commit f8a8da84ce4a057c75d37101d48d89634273055f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 18 11:54:20 2019 +0200

    nimble/gap: Fix for checking sc only mode
    
    When host is configure for SC only mode, make sure to reject pairing
    when remote wants Legacy pairing.
    
    This fixes GAP/SEC/SEM/BV-23-C and GAP/SEC/SEM/BV-24-C

 nimble/host/src/ble_sm.c | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

commit c04e4571503ee1b68a67c15f75eefe468cac7c32
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jun 18 11:47:14 2019 +0200

    apps/bttester: Change default RPA timeout
    
    With larger timeout the GAP/PRIV/CONN/BI-01-C testcase is more stable
    and passes 100% of the time.

 apps/bttester/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 39413cab73db0b0c88d91444eb455732dc1167e5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jun 18 11:44:52 2019 +0200

    apps/bttester: Handle peripheral privacy
    
    Bluetooth Core Spec v5.1 | Section 10.7.1
    `If a privacy-enabled Peripheral, that has a stored bond,
    receives a resolvable private address, the Host may resolve
    the resolvable private address [...]
    If the resolution is successful, the Host may accept the connection.
    If the resolution procedure fails, then the Host shall disconnect
    with the error code "Authentication failure" [...]`
    
    This allows passing GAP/PRIV/CONN/BI-01-C.

 apps/bttester/src/gap.c | 26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)

commit d447bbc4b44f9dabf3af3088f3f28cb1383812e5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 14 13:47:40 2019 +0200

    nimble/ll: Update DID when enabling or disabling periodic advertising
    
    The Advertising DID is not required to change when a SyncInfo field is
    added to or removed from an advertising set. However, if it does not
    change, then scanners may fail to synchronize to periodic advertising
    because entries in the Advertising DID cache (see Section 4.3.3) mean
    they ignore the advertisements containing the SyncInfo field. Therefore,
    advertisers should update the Advertising DID when a periodic advertising
    train is enabled. Alternatively, the Host should enable periodic
    advertising before enabling advertising.

 nimble/controller/src/ble_ll_adv.c | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)

commit e46fdc90e0b4183ee87d37e8746170f9b2a2b25b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 17 15:28:10 2019 +0200

    nimble/ll: Fix peer address check with privacy
    
    We should explicitly chceck if AdvA is identity instead of just
    comparing address types. Comparing address types can give incorrect
    result if peer identity address is static random since both static
    random and RPA are random addresses.

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f1e9720bc313fd2a3a3380dad9746abb338503ac
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 17 15:27:57 2019 +0200

    nimble/ll: Add helper to check if addr is identity

 nimble/controller/include/controller/ble_ll.h | 3 +++
 nimble/controller/src/ble_ll.c                | 6 ++++++
 2 files changed, 9 insertions(+)

commit 96337643ead558ec936c83905a728a9b125b3a10
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 11 01:34:38 2019 +0200

    apps/btshell: Provide consistent address input
    
    This patch changes handling of all addr-type arguments to be consistent
    by providing common parsing helper.
    
    Helper assumes there are always "addr" and "addr_type" parameters with
    optional provided prefix. First, it tries to parse full address from
    "addr" parameter. If address is found but no type was provided it will
    try to parse "addr_type" parameter. If address is found and type was
    provided it will check if there is no separate "addr_type" parameter and
    won't allow such case since it could be confusing.

 apps/btshell/src/cmd.c | 152 +++++++++++++++++++------------------------------
 1 file changed, 58 insertions(+), 94 deletions(-)

commit 2881fe789e8f36af38ee9defaad1146581e2f6ab
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 11 01:32:51 2019 +0200

    apps/btshell: Add parse_arg_addr to parse BLE address
    
    We already have parse_arg_mac which parses MAC address, but new API
    allows to include ":p" or ":r" ("-p"/"-r") at the end of address string
    which indicates address type. This can speed up typing commands since
    there is no need to enter long parameters with address type separately.

 apps/btshell/src/cmd.h   |  1 +
 apps/btshell/src/parse.c | 48 ++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 49 insertions(+)

commit 60b92eb0b25cc5b3ad70b4379f8558df6a35f569
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jun 13 16:52:23 2019 +0200

    porting: Fix some oddities in linux examples

 porting/examples/linux/main.c         | 10 +++-------
 porting/examples/linux_blemesh/ble.c  |  1 +
 porting/examples/linux_blemesh/main.c | 12 ++++--------
 3 files changed, 8 insertions(+), 15 deletions(-)

commit 7c17723dc9171fdf2dec316019b69b392a5d8a99
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jun 5 16:47:13 2019 +0200

    nimble/ll: Simplify aux_data ref counter usage
    
    This patch fixes aux_data reference counter, as previosly it was rather
    "usage counter", which was hard to follow. This patch should make it
    easier.

 nimble/controller/include/controller/ble_ll_scan.h |   8 +-
 nimble/controller/src/ble_ll_conn.c                |  51 ++---
 nimble/controller/src/ble_ll_scan.c                | 217 +++++++++------------
 nimble/controller/src/ble_ll_sched.c               |   6 +-
 4 files changed, 126 insertions(+), 156 deletions(-)

commit b6b6958d77f53310b0ad90cd16b13ddd76f37db2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jun 5 14:52:04 2019 +0200

    nimble/ll: Move wfr handling to LL context
    
    With this patch we move handling scan cleaning to LL context in case of
    wfr timeout. This is in order to avoid races on access to scansm data.

 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll_conn.c                | 12 +----
 nimble/controller/src/ble_ll_scan.c                | 58 ++++++++++++++--------
 3 files changed, 39 insertions(+), 32 deletions(-)

commit ae020dace03b33e2a1fab52481bd54d4abceeafb
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jun 13 15:30:05 2019 +0200

    Use common config option for periodic syncs count
    
    This avoids accidental inconsistency in combined build.

 apps/btshell/src/main.c                                | 10 +++++-----
 nimble/controller/syscfg.yml                           |  4 ++--
 nimble/host/src/ble_hs_periodic_sync.c                 |  4 ++--
 nimble/syscfg.yml                                      |  2 +-
 porting/examples/linux/include/syscfg/syscfg.h         |  4 ++--
 porting/examples/linux_blemesh/include/syscfg/syscfg.h |  4 ++--
 porting/nimble/include/syscfg/syscfg.h                 |  4 ++--
 porting/npl/riot/include/syscfg/syscfg.h               |  4 ++--
 8 files changed, 18 insertions(+), 18 deletions(-)

commit d6dfb6ceb0060534bda43bd2f56fc3eb06661323
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 10 23:59:34 2019 +0200

    nimble/ll: Add GPIOs for HCI debugging
    
    This adds two new settings which allows to use two GPIO pins to indicate
    when command is received or event sent by controller. This can be useful
    for debugging, e.g. to check synchronization between HCI and air
    activity.

 nimble/controller/src/ble_ll_hci.c       | 26 ++++++++++++++++++++++++++
 nimble/controller/syscfg.yml             | 13 +++++++++++++
 porting/npl/riot/include/syscfg/syscfg.h |  8 ++++++++
 3 files changed, 47 insertions(+)

commit d5ede9c75510d357c51652a3841855264b354fff
Author: Hrishikesh Dhayagude <hrishi@espressif.com>
Date:   Thu Jun 13 10:47:36 2019 +0530

    nimble/host: Fix compilation error when asserts are disabled
    
    /home/nimble/host/services/gap/src/ble_svc_gap.c:195:9:
    error: 'rc' may be used uninitialized in this function
    [-Werror=maybe-uninitialized]
         int rc;
             ^

 nimble/host/services/gap/src/ble_svc_gap.c | 2 ++
 1 file changed, 2 insertions(+)

commit b0e723fa37ea43534261c7dc6b696cb3a405f0e0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jun 13 07:10:14 2019 +0200

    nimble/sm: Fix rejecting stronger bond
    
    If there exists an authenticated bond and the slave sends
    a security request with No MITM we should not try to pair again
    as the stored bond is stronger than the requested one.

 nimble/host/src/ble_sm.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit ebe528c540f077b01239b2303ceaabf07b0c4f45
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 12 15:49:07 2019 +0200

    nimble/ll: Remove some no longer relevant TODOs from advertising code

 nimble/controller/src/ble_ll_adv.c | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)

commit 78cfce425899666396c546f40f186a9f55658d89
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 11 09:33:26 2019 +0200

    nimble/gap: Add missing doxygen documentation

 nimble/host/include/host/ble_gap.h | 529 ++++++++++++++++++++++++++++++++++++-
 1 file changed, 520 insertions(+), 9 deletions(-)

commit ff1b3f0d405692c7fc3737319b3bab0215c0f786
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jun 12 10:33:28 2019 +0200

    nimble/ll: Fix PHY transition on LL_PHY_UPDATE_IND
    
    s_to_m_phy field is a PHY bitmask, not a PHY number, so we need to
    decode it properly as otherwise during transition to LE Coded we'll fail
    to adjust TX payload length (1M and 2M work only because bitmask is the
    same as number).

 nimble/controller/src/ble_ll_conn.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit d3b7373a4ec7a4bbf6e1c5b5bf6d3d53a80e3112
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 11 11:38:41 2019 +0200

    apps/btshell: Use nice time conversions where possible

 apps/btshell/src/cmd.c | 122 +++++++++++++++++++++++++------------------------
 1 file changed, 62 insertions(+), 60 deletions(-)

commit 149af0a9c146c037fa05ccadaba5b1f18b424bb4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 11 11:31:03 2019 +0200

    apps/btshell: Add time parsing function
    
    New API allows to parse time strings which allow to specify values like
    intervals, periods, timeouts etc. in an easy way instead of using units
    which are always "I do not remember, need to check spec and calculate".
    
    Time string is converted to microseconds and returned value is divided
    by step value so it can be directly passed to various APIs.
    
    Accepted time string format is "XXX.YYYuuu" where:
    - XXX is integral part of value
    - YYY is fractional part of value
    - uuu is one of time units: "us", "ms" or "s"
    
    XXX and YYY (and also separating ".") can be skipped and will be thus
    set to 0.
    
    An error is returned if format is invalid (in particular, if uuu is not
    present) so this allows to fall back to standard integer conversion if
    necessary.

 apps/btshell/src/cmd.h   |  1 +
 apps/btshell/src/parse.c | 85 ++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 86 insertions(+)

commit 4fd4644f533808701abb58e24bff5b5b466b7ebb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jun 5 16:19:57 2019 +0200

    nimble/mesh: Reset the SAR timer also on SAR_CONT
    
    Usually this type of timer is used to detect inactivity,
    so receiving a SAR_CONT pdu counts as progress and should reset
    the timer.

 nimble/host/mesh/src/proxy.c | 1 +
 1 file changed, 1 insertion(+)

commit 58d8bf62e78187e6b3632cc2d9bc8dab79b9d6e0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jun 7 16:49:15 2019 +0200

    apps/btshell: Update conn-datalen params help to be more informative

 apps/btshell/src/cmd.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 8dec8a63d06b419ad5c988d832271cc77ff4125b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 11 15:01:50 2019 +0200

    btshell: Use stack default intervals for periodic advertising
    
    If user doesn't provide periodic advertising intervals use stack
    sane defaults instead of smallest allowed value.

 apps/btshell/src/cmd.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c5efe4612010152520ec8ebcb0cec82d271f7208
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 11 14:59:51 2019 +0200

    nimble/gap: Fix validation of periodic advertising parameters
    
    This allows to fallback to sane defaults if application doesn't
    provide any intervals.

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c4a1aaed44fe85e67bdd97a2b919a43558af559f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 10 12:15:12 2019 +0200

    btshell: Report error if failed to append extra data to adv data
    
    This was resulting is less data being appended to advertising data
    if msys pool was depleted without notifing user about error.

 apps/btshell/src/cmd.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit b6da0700d25a75124793d2ed9079610260befd51
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sat Jun 8 09:43:06 2019 +0200

    nimble/ll: Fix cancel connection creation
    
    This patch puts g_ble_ll_conn_create_sm into critical section.

 nimble/controller/src/ble_ll_conn.c     | 4 ++++
 nimble/controller/src/ble_ll_conn_hci.c | 3 +++
 2 files changed, 7 insertions(+)

commit f078a1ad9aa5e43ea2e74c20b788aea696eebb54
Author: Hrishikesh Dhayagude <hrishi@espressif.com>
Date:   Wed Jun 5 15:55:10 2019 +0530

    nimble/host: Fix compilation error
    
    error: format '%x' expects a matching 'unsigned int' argument [-Werror=format=]
             BLE_HS_LOG(DEBUG, "LE Advertising Set Terminated len=%u "

 nimble/host/src/ble_hs_dbg.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 8505762ac0bed2334bd0f08ed22b27b7f9b7b97f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 5 11:21:46 2019 +0200

    btshell: Add support for periodic advertising
    
    This alows to configure periodic advertising and synchronize with
    remote advertiser.

 apps/btshell/src/btshell.h |   4 +
 apps/btshell/src/cmd.c     | 380 ++++++++++++++++++++++++++++++++++++++++++++-
 apps/btshell/src/main.c    | 168 +++++++++++++++++++-
 3 files changed, 541 insertions(+), 11 deletions(-)

commit fafb11514f0e6192db05eecdfe81b3f900ba5a2e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 4 12:08:33 2019 +0200

    nimble/host: Refactor periodic sync support
    
    This includes:
     - use of ble_addr_t where possible
     - use of struct parameters in public API for future proof
     - use only MYNEWT_VAL(BLE_PERIODIC_ADV) - deps are handled by newt
     - simplify some naming conventions
     - allow per sync event handler
     - simplify syncs list handling
     - generation of sync lost event on sync terminate (to align behavior
       with connection API)
     - some file rename for consistency
     - bugfixes

 nimble/host/include/host/ble_gap.h                 |  78 ++---
 nimble/host/src/ble_gap.c                          | 350 ++++++++++++++-------
 nimble/host/src/ble_hs_hci_cmd.c                   |  12 +-
 nimble/host/src/ble_hs_hci_evt.c                   |  16 +-
 ...e_hs_periodic_disc.c => ble_hs_periodic_sync.c} | 114 +------
 ...dic_disc_priv.h => ble_hs_periodic_sync_priv.h} |  30 +-
 nimble/host/src/ble_hs_priv.h                      |   2 +-
 7 files changed, 320 insertions(+), 282 deletions(-)

commit a0dba5b585db455fd0e4f4820d28069f5e8bdd7b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jun 5 14:03:19 2019 +0200

    nimble/ll: Add missing return

 nimble/controller/src/ble_ll_conn.c | 1 +
 1 file changed, 1 insertion(+)

commit a4af93c1a11a6f2214507e43b21ecfdb24ab42f2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 5 15:28:34 2019 +0200

    btshell: Fix bogus error message on connect

 apps/btshell/src/cmd.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 7e497944bd6d64ef5885669ee63833be9dffd42c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jun 4 13:09:14 2019 +0200

    apps/bttester: Add option to use NRPA
    
    This is needed to pass TP/BROB/BCST/BV-04-C.

 apps/bttester/src/gap.c  | 8 ++++++--
 apps/bttester/syscfg.yml | 6 +++++-
 2 files changed, 11 insertions(+), 3 deletions(-)

commit 0abceecac44f75907f23c486dd27eb1f77871b58
Merge: ba531bca e09e7541
Author: Miguel Azevedo <miguellazev@gmail.com>
Date:   Tue Jun 4 16:53:00 2019 +0100

    Merge pull request #444 from mlaz/dis_sysid
    
    Adding System ID characteristic to DIS.

commit ba531bca06077f2fb5e0b874bb42fcd71ff726be
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jun 3 13:57:26 2019 +0200

    nimble/mesh: Fix missing SAR timeout in Proxy Server
    
    Mesh Profile 1.0 Section 6.6:
    "The timeout for the SAR transfer is 20 seconds. When the timeout expires,
    the Proxy Server shall disconnect."
    
    This allows passing MESH/SR/PROX/BV-05-C.

 nimble/host/mesh/src/proxy.c | 30 ++++++++++++++++++++++++++++++
 1 file changed, 30 insertions(+)

commit 4f189e077899b907a3c151fe729f46a53898b846
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jun 3 17:53:11 2019 +0200

    apps/bttester: Add support for reliable write

 apps/bttester/src/bttester.h | 10 ++++++++
 apps/bttester/src/gatt.c     | 60 ++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 70 insertions(+)

commit 54fc157c665cbe1a40311ca1602d09c324ada1c0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 16 13:59:35 2019 +0200

    nimble/ll: Add support for periodic sync
    
    This allows to synchronize with periodic advertiser with up to
    1650 bytes of chained data on all supported PHYs.
    
    Following qualification tests are passing:
    HCI/CCO/BV-16-C
    HCI/CCO/BV-17-C
    LL/DDI/SCN/BV-21-C
    LL/DDI/SCN/BV-25-C
    LL/DDI/SCN/BV-34-C
    LL/DDI/SCN/BV-37-C

 nimble/controller/include/controller/ble_ll.h      |   10 +
 nimble/controller/include/controller/ble_ll_hci.h  |    2 +
 .../controller/include/controller/ble_ll_sched.h   |    9 +
 nimble/controller/include/controller/ble_ll_sync.h |   58 +
 nimble/controller/src/ble_ll.c                     |   37 +
 nimble/controller/src/ble_ll_adv.c                 |    2 +-
 nimble/controller/src/ble_ll_conn_priv.h           |    4 +-
 nimble/controller/src/ble_ll_hci.c                 |   39 +
 nimble/controller/src/ble_ll_scan.c                |   74 +-
 nimble/controller/src/ble_ll_sched.c               |  228 ++-
 nimble/controller/src/ble_ll_supp_cmd.c            |   10 +
 nimble/controller/src/ble_ll_sync.c                | 1577 ++++++++++++++++++++
 nimble/controller/syscfg.yml                       |    7 +-
 nimble/include/nimble/ble.h                        |    3 +-
 nimble/include/nimble/hci_common.h                 |    6 +-
 15 files changed, 2057 insertions(+), 9 deletions(-)

commit 57d59b1fb86eed8a7844946e813ab826c4370b46
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 16 10:58:29 2019 +0200

    nimble/ll: Move window widening algorithm to utils
    
    This will also be used by periodic advertising scanner.

 .../controller/include/controller/ble_ll_utils.h   |  3 ++
 nimble/controller/src/ble_ll_conn.c                | 42 +++-------------------
 nimble/controller/src/ble_ll_utils.c               | 28 +++++++++++++++
 3 files changed, 35 insertions(+), 38 deletions(-)

commit cfcaa8a046b564193bb43099a06f71605dec7348
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu May 30 10:48:44 2019 +0200

    apps/bttester: Add support for Read by UUID
    
    This can be used to pass GAP/IDLE/NAMP/BV-01-C.

 apps/bttester/src/bttester.h | 10 +++++++++
 apps/bttester/src/gatt.c     | 50 ++++++++++++++++++++++++++++++++++++++++----
 2 files changed, 56 insertions(+), 4 deletions(-)

commit e09e75414ee7f387b5ffb3bfac3901fc95f2189a
Author: Miguel Azevedo <miguellazev@gmail.com>
Date:   Fri May 31 20:19:51 2019 +0100

    Added system id characteristic to DIS.

 .../dis/include/services/dis/ble_svc_dis.h         |   8 ++
 nimble/host/services/dis/src/ble_svc_dis.c         | 107 ++++++++++++++-------
 nimble/host/services/dis/syscfg.yml                |  45 +++++----
 3 files changed, 107 insertions(+), 53 deletions(-)

commit 9bc2304b703a467d43d367c05577b9f1c9835f47
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 16 11:47:59 2019 +0200

    apps/bttester: Fix l2cap set data to use updated API

 apps/bttester/src/l2cap.c | 39 +++++++++++++++++++++++++++++++--------
 1 file changed, 31 insertions(+), 8 deletions(-)

commit aceb9464f1f336e8b363fc4af682ece97fa84c38
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 31 10:46:19 2019 +0200

    apps/bttester: Add configurable Limited Advertising timeout
    
    This is required to pass some GAP/DISC/LIMM/BV-03-C and
    GAP/DISC/LIMM/BV-04-C testcases.

 apps/bttester/src/gap.c  | 7 ++++++-
 apps/bttester/syscfg.yml | 4 ++++
 2 files changed, 10 insertions(+), 1 deletion(-)

commit 099b1c42961b52035b2e51ec8232efa46959f009
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu May 30 16:18:41 2019 +0200

    nimble/sm: Fix storing encryption key size in legacy mode
    
    The key size was not properly persisted across connections
    when using legacy pairing mode.

 nimble/host/src/ble_sm.c | 2 ++
 1 file changed, 2 insertions(+)

commit bf5ed69eaeaf7be1b256564ea4316a8bf0845e14
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 29 15:26:09 2019 +0200

    nimble/ll: Fix settings offset units in SyncInfo
    
    If offset is >245700us units bit shall be set. Previously it was
    overwritten by offset regardless of value.

 nimble/controller/src/ble_ll_adv.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 42248ac45b63f2b0e961961ed83193cd0d120552
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 29 11:53:18 2019 +0200

    nimble/phy: Fix start time on late RX
    
    PHY start time was incorrectly set on late start because COUNTER
    register was used instead of proper cputime. This caused start time to
    be set to 24-bit value which became incorrect as soon as cputime value
    exceeded 0xffffff.

 nimble/drivers/nrf52/src/ble_phy.c | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

commit 9af7a226ba3be2e16c79f7c5c5c4afe433172f83
Author: SYNOPSYS\mohy <bassam.mohy@synopsys.com>
Date:   Tue May 14 14:01:11 2019 +0200

    nimble/hci : Fix for periodic advertising report
    
    Following line:
    
    memcpy(evt.data, &data[8], evt.data_length);
    
    was coping data to non allocated memory. This patch fixes it.

 nimble/host/src/ble_hs_hci_evt.c | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit 4e7e914da9d921c46c4fcd43bde9ca80e47d449b
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Apr 25 13:14:43 2019 +0200

    npl/riot: allow for timeout in ble_npl_eventq_get()

 porting/npl/riot/include/nimble/nimble_npl_os.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 16a3c5e5745971d903a0db3644a8d91c46bd4314
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Apr 25 10:55:48 2019 +0200

    npl/riot: add ble_npl_time_delay()

 porting/npl/riot/include/nimble/nimble_npl_os.h | 6 ++++++
 1 file changed, 6 insertions(+)

commit 4c3c91bbb3eccb19353fa437f7c4d72433ecbda2
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Apr 24 18:36:14 2019 +0200

    npl/riot: add missing callout functions

 porting/npl/riot/include/nimble/nimble_npl_os.h | 6 ++++++
 porting/npl/riot/src/npl_os_riot.c              | 8 ++++++++
 2 files changed, 14 insertions(+)

commit 32ccc39fe387f871cc6858741f18f03d36ca3a42
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Apr 24 14:33:36 2019 +0200

    npl/riot: added mesh config to syscfg.h

 porting/npl/riot/include/syscfg/syscfg.h | 234 +++++++++++++++++++++++++++++++
 1 file changed, 234 insertions(+)

commit 357db4d668b6cef3603c4b7d84a8e1d60af688ef
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 28 12:12:46 2019 +0200

    nimble/ll: Improve handling BLE_LL_EXT_ADV_AUX_PTR_CNT = 0
    
    This patch makes sure that when BLE_LL_EXT_ADV_AUX_PTR_CNT = 0
    then related membuf is NULL.

 nimble/controller/src/ble_ll_scan.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 5969da028fec45f8b94e9da18efa7faf1bf8d06c
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 13 11:30:52 2019 -0700

    Initialize shell_cmd objects using named members
    
    Some extra members are getting added to `struct shell_cmd` type in
    mynewt-core.  For this change to be backwards compatible, clients must
    initialize these objects using named members rather than positional
    values.

 apps/btshell/src/cmd.c       |   2 +-
 nimble/host/mesh/src/shell.c | 369 +++++++++++++++++++++++++++++++++++--------
 2 files changed, 304 insertions(+), 67 deletions(-)

commit d2675fe260e6b5c324f4f07c6a103b0f411add11
Author: Hrishikesh Dhayagude <hrishi@espressif.com>
Date:   Wed Apr 3 12:26:41 2019 +0530

    nimble/host: Replace chr_def_handle with chr_val_handle
    
    At some places for APIs ble_gatt_dsc_fn() and ble_gatts_chr_updated(), chr_val_handle was used and at other places
    chr_def_handle was used. Changed it uniformly with the right one to avoid confusion

 apps/blecent/src/peer.c                   | 2 +-
 apps/bttester/src/gatt.c                  | 2 +-
 nimble/host/include/host/ble_gatt.h       | 6 +++---
 nimble/host/test/src/ble_gatt_conn_test.c | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

commit e6ca0933acec4a998a7a7643bfa74d7a5c58043f
Author: Fabio Utzig <utzig@apache.org>
Date:   Mon May 20 13:50:20 2019 -0700

    Bump go requirement to 1.11
    
    The usage of RSA that allows for keys of any sizes requires go 1.11 to
    work.

 .travis.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a586a56b4923b057ccff3f2f3900a7828db57e16
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 17 22:18:08 2019 +0200

    nimble/ll: Fix scheduling aux ptr
    
    In case aux cannot be scheduled we might end up with not running
    scheduler. This patch fixes it.
    
    This patch also make sure RFCLK is restarted if scheduled element is the
    first on the list.

 nimble/controller/src/ble_ll_sched.c | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

commit 9d4bda2edcf0e7c2a03aa908321293a53361d258
Author: Ian Morris <ian.d.morris@outlook.com>
Date:   Wed May 1 11:29:03 2019 -0700

    ble_mesh_light/ws2812: Only compile if USE_NEOPIXEL is set.
    
    Without this builds for platforms other than NRFx fail even when
    USE_NEOPIXEL is set to 0 due to inclusion of NRFx header files.

 apps/blemesh_light/src/ws2812.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 35cfbbe74618d630745fa1e99a045d453061bc2c
Author: Mohamed Essayed <mohamed.essayed@synopsys.com>
Date:   Tue Apr 16 13:14:45 2019 +0200

    nimble/gap: Allow reconfiguring extended adv instance

 nimble/host/src/ble_gap.c | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit ce39050c6bd26fc58092645a9248857aed661faf
Author: Mohamed Essayed <mohamed.essayed@synopsys.com>
Date:   Thu May 2 14:46:06 2019 +0200

    nimble/gap: Adding LE Clear Advertising Sets Command

 nimble/host/include/host/ble_gap.h |  7 +++++++
 nimble/host/src/ble_gap.c          | 41 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 48 insertions(+)

commit 976bb8f84bf9547efdea444ae79a62d5a355a613
Author: Alexandre Abadie <alexandre.abadie@inria.fr>
Date:   Sat Apr 27 20:49:35 2019 +0200

    drivers/nrf51: generalize to other OSes than mynewt

 nimble/drivers/nrf51/src/ble_hw.c  | 10 ++++++++++
 nimble/drivers/nrf51/src/ble_phy.c |  8 +++++++-
 2 files changed, 17 insertions(+), 1 deletion(-)

commit 8b45120e1142b6e8e6be1db7fb963e58b9c15c46
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Nov 28 10:54:01 2018 +0100

    host/svc: add IPSS service for IPSP support

 .../ipss/include/services/ipss/ble_svc_ipss.h      | 38 ++++++++++++++++
 nimble/host/services/ipss/pkg.yml                  | 35 +++++++++++++++
 nimble/host/services/ipss/src/ble_svc_ipss.c       | 51 ++++++++++++++++++++++
 nimble/host/services/ipss/syscfg.yml               | 24 ++++++++++
 4 files changed, 148 insertions(+)

commit 2aae4aaeaee46853116fc7925ff5b959d1f4a91b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 19 16:21:01 2019 +0200

    nimble/host: Allow NULL in Find attribute by UUID
    
    Specifying UUID param as NULL will return any type of attribute.
    This can be useful to get a list of attributes in the database.
    For example it can be used in bttester application. It is an
    internal API, so generally it should not be used by an application
    but it is a testing application.

 nimble/host/src/ble_att_svr.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 5959a6b36e1e80961c93631c184cd2ee5d63ad65
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Thu Apr 25 14:02:02 2019 +0530

    ble_hs_adv: Fix small mistake in ble_hs_adv_parse_one_field
    
    Fix small mistake while parsing service uuid32 in `ble_hs_adv_parse_one_field`.

 nimble/host/src/ble_hs_adv.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 05b16589b68fce3d205a629d1976c74e66b89176
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 10 10:38:23 2019 +0200

    nimble/ll: Remove not needed TODO
    
    Since Advertising Extensions also use data channels we cannot disable
    encryption based on channel number.

 nimble/controller/src/ble_ll_adv.c | 1 -
 1 file changed, 1 deletion(-)

commit a369a5bcbd0d293657dd1fd38e808c50b9d4e2e5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 9 14:40:44 2019 +0200

    nimble: Use consistent schema for MYNEWT_VAL

 nimble/controller/include/controller/ble_ll.h      |  2 +-
 nimble/controller/include/controller/ble_ll_conn.h |  6 +--
 nimble/controller/include/controller/ble_ll_scan.h |  2 +-
 .../controller/include/controller/ble_ll_sched.h   |  2 +-
 nimble/controller/src/ble_ll.c                     | 34 ++++++++--------
 nimble/controller/src/ble_ll_adv.c                 | 47 +++++++++++-----------
 nimble/controller/src/ble_ll_conn.c                | 16 ++++----
 nimble/controller/src/ble_ll_conn_hci.c            |  8 ++--
 nimble/controller/src/ble_ll_conn_priv.h           |  2 +-
 nimble/controller/src/ble_ll_ctrl.c                | 22 +++++-----
 nimble/controller/src/ble_ll_dtm.c                 |  2 +-
 nimble/controller/src/ble_ll_hci.c                 | 30 +++++++-------
 nimble/controller/src/ble_ll_hci_ev.c              |  4 +-
 nimble/controller/src/ble_ll_resolv.c              |  4 +-
 nimble/controller/src/ble_ll_scan.c                | 16 ++++----
 nimble/controller/src/ble_ll_sched.c               |  2 +-
 nimble/controller/src/ble_ll_supp_cmd.c            | 43 ++++++++++----------
 nimble/controller/src/ble_ll_utils.c               |  2 +-
 nimble/drivers/native/src/ble_hw.c                 |  2 +-
 nimble/drivers/native/src/ble_phy.c                |  4 +-
 nimble/drivers/nrf51/src/ble_hw.c                  |  4 +-
 nimble/drivers/nrf51/src/ble_phy.c                 | 26 ++++++------
 nimble/drivers/nrf52/src/ble_hw.c                  |  4 +-
 nimble/drivers/nrf52/src/ble_phy.c                 | 28 ++++++-------
 nimble/host/mesh/src/friend.c                      |  4 +-
 nimble/host/mesh/src/lpn.c                         | 10 ++---
 nimble/host/mesh/src/prov.c                        |  4 +-
 nimble/host/mesh/src/proxy.c                       |  4 +-
 28 files changed, 168 insertions(+), 166 deletions(-)

commit bec06d9180bd2835e73c5c2fcf3f2ca763d93f69
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Feb 28 17:29:54 2019 +0100

    nimble/ll: Add support for Periodic Advertising
    
    This adds suppot for sending periodic advertising using AUX_SYN_IND
    PDUs. Includes support for multiple advertising sets, chaining up
    to 1650 bytes of data and all supported PHYs.
    
    Verified against following qualification tests:
    LL/DDI/ADV/BV-26-C
    LL/DDI/ADV/BV-33-C

 nimble/controller/include/controller/ble_ll.h      |   2 +
 nimble/controller/include/controller/ble_ll_adv.h  |   1 +
 .../controller/include/controller/ble_ll_sched.h   |   4 +
 nimble/controller/src/ble_ll.c                     |   2 +
 nimble/controller/src/ble_ll_adv.c                 | 621 ++++++++++++++++++++-
 nimble/controller/src/ble_ll_sched.c               |  75 +++
 6 files changed, 680 insertions(+), 25 deletions(-)

commit 86d3324e44d651a753f6300365b1bad21de00fa3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Feb 26 12:20:52 2019 +0100

    nimble/ll: Add initial support for periodic advertising
    
    This adds initial support for advertiser role. Currently only HCI
    commands and adding SyncInfo field is supported. No AUX_SYNC_IND PDUs
    are sent yet.

 nimble/controller/include/controller/ble_ll_adv.h |   4 +
 nimble/controller/src/ble_ll.c                    |   4 +
 nimble/controller/src/ble_ll_adv.c                | 382 +++++++++++++++++++++-
 nimble/controller/src/ble_ll_hci.c                |  16 +
 nimble/controller/src/ble_ll_supp_cmd.c           |   6 +
 nimble/controller/syscfg.yml                      |   6 +
 nimble/include/nimble/hci_common.h                |   3 +-
 7 files changed, 408 insertions(+), 13 deletions(-)

commit 0c6a74492467a290dd02dfebe6636cd506d09fda
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 9 11:36:51 2019 +0200

    nimble/host: Move hci_periodic_adv_params definition

 nimble/host/src/ble_hs_hci_priv.h  | 10 ++++++++++
 nimble/include/nimble/hci_common.h |  8 --------
 2 files changed, 10 insertions(+), 8 deletions(-)

commit c712e7d551dd55ca798db1de06dc42d30f392fb6
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 9 10:53:43 2019 +0200

    porting: Remove extra file from Makefile.defs
    
    By default all files are build and this list should be used only
    for exluding.

 porting/nimble/Makefile.defs | 1 -
 1 file changed, 1 deletion(-)

commit 1a1047fe113dcd661f6bcadba09d8317a860d9c0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 9 10:52:17 2019 +0200

    nimble/ll: Fix hci_le_subev_periodic_adv_rpt declaration
    
    Unused byte is part of spec and must have a placeholder.

 nimble/include/nimble/hci_common.h | 1 +
 1 file changed, 1 insertion(+)

commit 6104f25d27077afa3771598e48c378f66086ecbe
Merge: 7e5a7bbf b9c400d8
Author: wes3 <wills@runtime.io>
Date:   Mon Apr 22 10:34:51 2019 -0700

    Merge pull request #426 from JustineKH/fix/ble_ll_dtm_rx_start
    
    fix crash caused by OS_ENTER_CRITICAL, OS_EXIT_CRITICAL placement

commit b9c400d849db02b6f22df41c7a43deda1105a6b8
Author: JustineKH <justine@juul.com>
Date:   Fri Apr 19 17:25:24 2019 -0700

    fix crash caused by OS_ENTER_CRITICAL, OS_EXIT_CRITICAL placement

 nimble/controller/src/ble_ll_dtm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 7e5a7bbfe0c9945390317cdc1dcfe00cbf6063df
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Apr 18 13:31:28 2019 +0200

    nimble/host: Fix HCI fragmentation buffer size
    
    This patch fixes a regression introduced in:
    4a894678 nimble/hci: Modifying ACL Buf size based on BLE 5.1 Standard
    
    and is related to:
    2bd8de56 nimble/host: Register a 1-elem mbuf pool for ACL
    
    After adding a dedicated mbuf pool for HCI fragmentation
    and changing the ACL buffer size, the fragmentation data buffer
    size was too small to hold full ACL buffer including HCI header.

 nimble/host/src/ble_hs_hci.c | 1 +
 1 file changed, 1 insertion(+)

commit f2521657a2bac0d71d60a77eaaba352344941a71
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 17 10:50:13 2019 +0200

    nimble/ll: Make sure to ACK Terminate IND with empty packet

 nimble/controller/src/ble_ll_conn.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit 18afa6b76c12607b4cf45fa922c1c77c9163c8eb
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 16 22:35:32 2019 +0200

    apps: Fix bootutils dependencies
    
    Some applications were polling bootutils even if not using it.
    bleprph is using it for DIS information so depend on mcuboot instead
    and enable DIS by default.

 apps/blecsc/pkg.yml         | 1 -
 apps/blehr/pkg.yml          | 1 -
 apps/bleprph/pkg.yml        | 2 +-
 apps/bleprph/syscfg.yml     | 2 +-
 apps/ext_advertiser/pkg.yml | 1 -
 5 files changed, 2 insertions(+), 5 deletions(-)

commit 7be7fe716b4256fe16c65b01d35cb2c9140bb272
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 16 23:24:26 2019 +0200

    Add mcuboot to travis downloads
    
    Also clone only depth=1 since we don't need history.

 .travis.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 3dac1c574a103b9ef16007b4c73528a7345cef78
Author: mnasr93 <muhammadmostafa0@gmail.com>
Date:   Wed Apr 10 22:57:05 2019 +0200

    nimble/gap: Add listener call to notify_rx event

 nimble/host/src/ble_gap.c | 1 +
 1 file changed, 1 insertion(+)

commit 9f6cbefc59babc32db0cfd966029af1195e5b8d1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Apr 12 16:04:23 2019 +0200

    btshell: Add simple handler for new L2CAP CoC TX UNSTALLED event

 apps/btshell/src/main.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 4d70828f1815ca2f38bbcc1496c8bbf4978cf19d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Apr 12 14:08:40 2019 +0200

    nimble/l2cap: Add TX_UNSTALLED event to L2CAP CoC
    
    With this patch if L2CAP CoC has been stalled due to lack of credits
    BLE_HS_ESTALLED code will be returned.
    
    When NimBLE gets back credits and finish sending SDU,
    BLE_L2CAP_EVENT_COC_TX_UNSTALLED will be sent to the application as the
    indication that L2CAP CoC is unstalled and ready for sending new data.

 nimble/host/include/host/ble_hs.h     |  1 +
 nimble/host/include/host/ble_l2cap.h  | 23 +++++++++++++++++++++++
 nimble/host/src/ble_l2cap_coc.c       | 31 +++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap_coc_priv.h  |  5 ++++-
 nimble/host/test/src/ble_l2cap_test.c |  3 +++
 5 files changed, 62 insertions(+), 1 deletion(-)

commit afaca4f5c5a4b3de85fcf3c06e9ea7ec876dd751
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 12 11:53:00 2019 +0200

    apps/bttester: Remove ARRAY_SIZE macro
    
    It is already defined in Mynewt.

 apps/bttester/src/glue.h | 2 --
 1 file changed, 2 deletions(-)

commit 0e20e2c43a89a7f163ff833942bd19beaffc49bc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 12 16:19:11 2019 +0200

    apps/bttester: Fix another include path

 apps/bttester/src/gatt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 11eca31975483b52a74e754dfc44a6a25df83744
Author: Fabio Utzig <utzig@apache.org>
Date:   Fri Apr 12 09:59:26 2019 -0300

    Fix copying CI targets
    
    CI currently expects target tree inside targets directory and uses
    a hardcoded path. The targets directory might not exist on some of
    the repos tested, so create it first here. CI will be updated to use
    the repo slug to determine which repo's targets it should build.

 .travis.yml | 1 +
 1 file changed, 1 insertion(+)

commit d6d49bedf1fac0cb2631ea34dbc3f18346065b4f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 12 15:42:01 2019 +0200

    apps/bttester: Fix include path
    
    This path caused errors in CI.

 apps/bttester/src/gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c1c6a9c2e5b2a97465ac58c91cbe6974fba260a6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Apr 12 11:57:18 2019 +0200

    nimble/gap: Fix error code from periodic advertising
    
    If there is ongoing periodic sync let return EBUSY instead of EINVAL

 nimble/host/src/ble_gap.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 3c0424d860216a6382d585c63f360878bb3c3836
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Apr 12 11:55:58 2019 +0200

    nimble/gap: Fix periodic API to use ble_addr_t
    
    For the application NimBLE uses ble_addr_t instead of raw addr array and
    type.

 nimble/host/include/host/ble_gap.h | 14 ++++++--------
 nimble/host/src/ble_gap.c          | 17 ++++++++---------
 2 files changed, 14 insertions(+), 17 deletions(-)

commit 6f5a85f21617024fc705e488650ecfcf1c062ed4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Apr 11 15:04:52 2019 +0200

    btshell: Fix assert on host-enable after host-disable
    
    With this patch btshell reset gatt db on host-disable and init it back
    on host-enable
    
    Note that it does not have to be done inside the nimble because the idea
    behind host-disable is to gracefully disconnect all the connection on
    device reset.
    
    For btshell it make sense that application handles gatt db

 apps/btshell/src/cmd.c | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

commit 89ab0fb8f1a8e317ad3df7981bdf7607454e4611
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Apr 11 12:32:04 2019 +0200

    nimble/hs: Minor cleanup on how periodic sync is closed on hs_stop
    
    Sync periodic sync termination is blocking, lets do it before closing
    all the ACL connection

 nimble/host/src/ble_hs_periodic_disc.c |  8 +++++--
 nimble/host/src/ble_hs_stop.c          | 39 ++++++++++++++++++----------------
 2 files changed, 27 insertions(+), 20 deletions(-)

commit 3b73d9c5d87bc5380ba275d52ec421374d6e8b83
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Apr 11 12:30:17 2019 +0200

    nimble/gap: Fix error code on closing already closed periodic sync

 nimble/host/src/ble_gap.c | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

commit dad7749b61d3d98d32ab0a7d7f9bcb1d19a21936
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 10 14:05:10 2019 +0200

    apps: Remove bletest application
    
    This app was initially used for controller testing but it got rusty
    and no longer compiles and fixing it make no sense as it provides
    little value since we have better tools for controller testing now
    (blehci running with linux host or Harmony tester).

 apps/bletest/pkg.yml            |   38 --
 apps/bletest/src/bletest_hci.c  |  782 -----------------------
 apps/bletest/src/bletest_priv.h |   86 ---
 apps/bletest/src/main.c         | 1323 ---------------------------------------
 apps/bletest/syscfg.yml         |   33 -
 5 files changed, 2262 deletions(-)

commit 3b5236fcd18a9ab670bd99157aad81ae0d982a9e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 10 16:09:51 2019 +0200

    apps/bleprps: Add DIS to bleprph
    
    This can also include firmware (image) version.

 apps/bleprph/pkg.yml    |  1 +
 apps/bleprph/src/main.c | 16 ++++++++++++++++
 apps/bleprph/syscfg.yml |  3 +++
 3 files changed, 20 insertions(+)

commit 7e1b287664821b4467dbfea774c19aa8f0fb0563
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 9 22:08:55 2019 +0200

    Apache NimBLE 1.1.0 release

 repository.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 67844daa247b1f4a4b202f0a4e2aaea802186703
Author: Ahmed Shokry <ahmed.shokry@synopsys.com>
Date:   Wed Nov 28 14:37:55 2018 +0530

    nimble/host: Add initial periodic adverting host support
    
    This patch adds the implementation for periodic advertising
    nd discovery, which is available when BLE_PERIODIC_ADV is enabled

 nimble/controller/src/ble_ll_adv.c                 |  26 +-
 nimble/controller/src/ble_ll_hci.c                 |  24 +-
 nimble/host/include/host/ble_gap.h                 |  74 +++
 nimble/host/src/ble_gap.c                          | 687 ++++++++++++++++++++-
 nimble/host/src/ble_gap_priv.h                     |   5 +
 nimble/host/src/ble_hs.c                           |   3 +
 nimble/host/src/ble_hs_dbg.c                       |  15 +-
 nimble/host/src/ble_hs_hci_cmd.c                   | 158 +++++
 nimble/host/src/ble_hs_hci_evt.c                   |  87 ++-
 nimble/host/src/ble_hs_hci_priv.h                  |  42 ++
 nimble/host/src/ble_hs_periodic_disc.c             | 230 +++++++
 nimble/host/src/ble_hs_periodic_disc_priv.h        |  61 ++
 nimble/host/src/ble_hs_priv.h                      |   1 +
 nimble/host/src/ble_hs_startup.c                   |   5 +-
 nimble/host/src/ble_hs_stop.c                      |  48 +-
 nimble/include/nimble/hci_common.h                 |  86 ++-
 nimble/syscfg.yml                                  |   9 +
 porting/examples/linux/include/syscfg/syscfg.h     |   4 +
 .../examples/linux_blemesh/include/syscfg/syscfg.h |   4 +
 porting/nimble/Makefile.defs                       |   1 +
 porting/nimble/include/syscfg/syscfg.h             |   9 +
 porting/npl/riot/include/syscfg/syscfg.h           |   4 +
 22 files changed, 1486 insertions(+), 97 deletions(-)

commit 95bb7fe6465605ddefa6d3374a8e86e377817a07
Merge: 38e1c2e6 b9fabffd
Author: Martin Turon <mturon@google.com>
Date:   Fri Apr 5 09:34:37 2019 -0700

    Merge pull request #388 from turon/fix/188
    
    logging: Fix logging macro issue #188.

commit 38e1c2e61407a2688f680136e6a355a75296da60
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 26 09:44:43 2019 +0100

    nimble/transport: Add 'da1469x' to transport choices

 nimble/transport/pkg.yml    | 3 +++
 nimble/transport/syscfg.yml | 1 +
 2 files changed, 4 insertions(+)

commit 99ae4ed38efea4a16536b876777811e3a88fcd8c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 14 16:39:02 2019 +0100

    nimble/transport: Add transport for DA1469x CMAC
    
    This adds HCI transport for DA1469x CMAC loaded with original firmware.
    The firmware is loaded from libble_stack library which can be obtained
    from official DA1469x SDK.

 nimble/transport/da1469x/.gitignore            |   2 +
 nimble/transport/da1469x/README                |  10 +
 nimble/transport/da1469x/pkg.yml               |  44 +++
 nimble/transport/da1469x/src/da1469x_ble_hci.c | 368 +++++++++++++++++++++++++
 nimble/transport/da1469x/syscfg.yml            |  43 +++
 5 files changed, 467 insertions(+)

commit ecf9f25284b6a5ff13bb0867a1517493ca045b99
Author: mfarag13 <mohamed.essayed.farag@gmail.com>
Date:   Mon Apr 1 17:03:04 2019 +0200

    nimble/hci: Solving Array packing in ble_hs_test_util_hci_rx_num_completed_pkts_event.

 nimble/host/test/src/ble_hs_test_util_hci.c | 2 --
 1 file changed, 2 deletions(-)

commit 646cbdd0f85c11be52be6793829aaad5a24c3c57
Author: mfarag13 <mohamed.essayed.farag@gmail.com>
Date:   Mon Apr 1 16:38:59 2019 +0200

    himble/hci: Update ble_hs_hci_test to accommodate the new acl_buf_size.

 nimble/host/test/src/ble_hs_hci_test.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 4a8946786e24c593da117a458007f7a75269baef
Author: mfarag13 <mohamed.essayed.farag@gmail.com>
Date:   Mon Apr 1 12:59:00 2019 +0200

    nimble/hci: Modifying ACL Buf size based on BLE 5.1 Standard

 nimble/host/src/ble_hs_hci.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit fd27d2fdc5b2f211b1586b2653a81f02afa3e32a
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 1 11:31:56 2019 -0700

    host: Wake up stalled conns when a conn is dropped
    
    When a connection is dropped, it may free up some ACL packet capacity in
    the controller.  When this happens, we need to wake up all stalled
    connections.
    
    We want to wake up connections every time the ACL data buffer capcity
    increases (whenever `ble_hs_hci_add_avail_pkts()` is called).

 nimble/host/src/ble_hs_hci_evt.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 4a82ef412ec213b93917f29fad7af75844ff04c2
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 29 11:03:25 2019 -0700

    host: Always wake tx queues on rx of num-cmp-pkts
    
    Prior to commit: The code assumed that a transmission could stall for
    only one reason: the controller cannot accommodate any more ACL data
    packets.  When the host received a num-complered-packets event, it would
    only try to unstall each connection if all the controller's data buffers
    were previously used.
    
    It turns out there is a second way that a host connection can stall:
    mbuf exhaustion. If the host is unable to fragment an outgoing L2CAP
    packet into ACL data packets due to a lack of mbufs, the transmission
    stalls.
    
    This commit causes the host to wake up its connections every time it
    receives a num-completed-packets event. It does this even if the
    controller still had capacity for more ACL data packets. If a host
    connection is stalled due to mbuf exhaustion, the controller will only
    send the next num-completed-packets event after it has freed the mbuf
    from the designated ACL fragment pool (ble_hs_hci_frag_mbuf_pool). In
    other words, we are guaranteed to receive a num-completed-packets event
    whenever a transmission has stalled, regardless of the cause.

 nimble/host/src/ble_hs_hci_evt.c | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

commit 6595d33810f5e6d41ca508741123a5f85b661a95
Merge: f9151ab6 aa7bbd62
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 2 14:43:07 2019 +0200

    Merge pull request #406 from sjanc/nosec_fix
    
    nimble/host: Fix build with security disabled

commit aa7bbd6228e8b868e496ec4fa7c75775a5c55241
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 2 14:06:28 2019 +0200

    nimble/host: Fix build with security disabled

 nimble/host/src/ble_sm_priv.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f9151ab6b8eb205beae985640a59152e7061fdf0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Apr 1 16:51:58 2019 +0200

    nimble: Fix handling and storing encryption key size
    
    The key size was not properly persisted across connections.
    
    Fixes #403.

 apps/btshell/src/btshell.h         |  3 ++-
 apps/btshell/src/cmd.c             | 12 ++++++++++--
 apps/btshell/src/main.c            |  5 ++++-
 nimble/host/include/host/ble_gap.h |  6 ++++--
 nimble/host/src/ble_gap.c          |  9 ++++++---
 nimble/host/src/ble_sm.c           |  8 ++++++--
 nimble/host/src/ble_sm_priv.h      |  5 +++--
 nimble/host/src/ble_sm_sc.c        |  2 ++
 8 files changed, 37 insertions(+), 13 deletions(-)

commit a6c509b9acf90604365bdd33cb46055f54cd7787
Merge: 7be23d32 79927d16
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 2 09:31:03 2019 +0200

    Merge pull request #401 from sjanc/nrf52840_errata
    
    nimble/hw: Apply #102 #106 and #107 erratas also for nRF52840

commit 79927d161659eb71173f10ba84288a262cceb874
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 1 12:12:34 2019 +0200

    nimble/hw: Apply #102 #106 and #107 erratas also for nRF52840
    
    Although Nordic's infocenter claims this is fixed in final build of
    nRF52840, LL/ENC/MAS/BI-01-C was failing without enabling those.

 nimble/drivers/nrf52/src/ble_phy.c | 4 ----
 1 file changed, 4 deletions(-)

commit 7be23d325293345858d3123975f7193311a7ea04
Merge: bc65ae38 fcaafe79
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 29 16:30:24 2019 +0100

    Merge pull request #397 from sjanc/fix_nrf51
    
    nimble/hw: Fix compilation of nrf51 driver

commit fcaafe79ccaccace818c2161e8e453f1372e42ea
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 29 15:30:25 2019 +0100

    nimble/hw: Fix compilation of nrf51 driver
    
    Compiling repos/apache-mynewt-nimble/nimble/drivers/nrf51/src/ble_hw.c
    Error: repos/apache-mynewt-nimble/nimble/drivers/nrf51/src/ble_hw.c: In function 'ble_hw_get_public_addr':
    repos/apache-mynewt-nimble/nimble/drivers/nrf51/src/ble_hw.c:69:23: error: passing argument 2 of 'memcpy'
         discards 'volatile' qualifier from pointer target type [-Werror=discarded-qualifiers]
         memcpy(addr->val, &NRF_FICR->DEVICEADDR[0], 4);
                           ^
    In file included from repos/apache-mynewt-nimble/nimble/drivers/nrf51/src/ble_hw.c:22:0:
    repos/apache-mynewt-core/libc/baselibc/include/string.h:19:16: note: expected 'const void *' but argument is
         of type 'const volatile uint32_t * {aka const volatile long unsigned int *}'
     __extern void *memcpy(void *, const void *, size_t);
                    ^~~~~~
    repos/apache-mynewt-nimble/nimble/drivers/nrf51/src/ble_hw.c:70:27: error: passing argument 2 of 'memcpy'
         discards 'volatile' qualifier from pointer target type [-Werror=discarded-qualifiers]
         memcpy(&addr->val[4], &NRF_FICR->DEVICEADDR[1], 2);
                               ^
    In file included from repos/apache-mynewt-nimble/nimble/drivers/nrf51/src/ble_hw.c:22:0:
    repos/apache-mynewt-core/libc/baselibc/include/string.h:19:16: note: expected 'const void *' but argument is
         of type 'const volatile uint32_t * {aka const volatile long unsigned int *}'
     __extern void *memcpy(void *, const void *, size_t);
                    ^~~~~~

 nimble/drivers/nrf51/src/ble_hw.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit bc65ae383dc92a8fcae4f8a00e65949f988139cf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Mar 29 11:43:15 2019 +0100

    apps/btshell: Fix callback in gatt_svr
    
    Previous callback was reserved to security test characteristic.
    When called from a wrong characteristic it would result in an assert.

 apps/btshell/src/gatt_svr.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8d78bbfdf00820a9f27846eada1107f5a59f9789
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 28 23:11:24 2019 +0100

    nimble/ll: Remove DTM event from queue before erasing context
    
    If event is already queued, we should remove it from queue before
    erasing context as otherwise callback and link will be removed which
    leads to a crash when event is run,

 nimble/controller/src/ble_ll_dtm.c | 1 +
 1 file changed, 1 insertion(+)

commit 6f0f677811ce5046d63ed451cd3bb3f7fb8a2ec9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Mar 27 15:51:28 2019 +0100

    Prepare for Apache NimBLE 1.1.0 release

 repository.yml | 4 ++++
 1 file changed, 4 insertions(+)

commit c4a68865813241092e01e41794ed05fb076c8018
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 26 21:55:28 2019 -0700

    Fix leak check in host unit tests

 nimble/host/src/ble_hs_hci.c            | 18 ++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h       |  3 +++
 nimble/host/test/src/ble_hs_test_util.c | 16 ++++++++++++++--
 3 files changed, 35 insertions(+), 2 deletions(-)

commit 2bd8de56a136dbc81f8665f2be7ee01ee24d0cc1
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 26 13:00:56 2019 -0700

    nimble/host: Register a 1-elem mbuf pool for ACL
    
    Register a one-element mbuf pool dedicated to holding outgoing ACL data
    packets.  This dedicated pool prevents a deadlock caused by mbuf
    exhaustion.  Without this pool, all msys mbufs could be permanently
    allocated, preventing us from fragmenting outgoing packets and sending
    them (and ultimately freeing them).
    
    When the host fragments an outgoing data packet, it first tries to
    allocate the fragment using the new pool.  If this fails (because the
    single mbuf has already been sent to the controller), the host falls
    back to using msys.

 nimble/host/src/ble_hs_hci.c | 47 +++++++++++++++++++++++++++++++++++++++++++-
 nimble/include/nimble/ble.h  |  3 +++
 2 files changed, 49 insertions(+), 1 deletion(-)

commit c330035850409c509e24a88dcff04f686e02f367
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 26 09:40:30 2019 +0100

    nimble/transport: Make HCI transport select as a choice

 nimble/transport/pkg.yml    | 10 +++++-----
 nimble/transport/syscfg.yml | 47 ++++++++++++++++++++++++++++++++++++---------
 2 files changed, 43 insertions(+), 14 deletions(-)

commit 4deecf721c2613fe22bd8f099756903b0c212abd
Merge: 0d70bda4 b8c2f9ab
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Mar 27 09:58:47 2019 +0100

    Merge pull request #391 from sjanc/rat
    
    License headers cleanup

commit b8c2f9ab585b321411e99067fe5ad4511d0b270a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Mar 26 21:26:26 2019 +0100

    Fix license headers

 apps/blemesh_models_example_1/src/main.c              | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/app_gpio.c          | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/app_gpio.h          | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/ble_mesh.c          | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/ble_mesh.h          | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/common.h            | 19 +++++++++++++++++++
 .../blemesh_models_example_2/src/device_composition.c | 19 +++++++++++++++++++
 .../blemesh_models_example_2/src/device_composition.h | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/main.c              | 19 +++++++++++++++++++
 .../src/no_transition_work_handler.c                  | 19 +++++++++++++++++++
 .../src/no_transition_work_handler.h                  | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/publisher.c         | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/publisher.h         | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/state_binding.c     | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/state_binding.h     | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/storage.c           | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/storage.h           | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/transition.c        | 19 +++++++++++++++++++
 apps/blemesh_models_example_2/src/transition.h        | 19 +++++++++++++++++++
 apps/bttester/src/atomic.h                            | 19 +++++++++++++++++++
 apps/bttester/src/bttester.c                          | 19 +++++++++++++++++++
 apps/bttester/src/bttester.h                          | 19 +++++++++++++++++++
 apps/bttester/src/gap.c                               | 19 +++++++++++++++++++
 apps/bttester/src/gatt.c                              | 19 +++++++++++++++++++
 apps/bttester/src/l2cap.c                             | 19 +++++++++++++++++++
 apps/bttester/src/main.c                              | 19 +++++++++++++++++++
 apps/bttester/src/mesh.c                              | 19 +++++++++++++++++++
 porting/examples/linux/Makefile                       | 17 +++++++++++++++++
 porting/examples/linux_blemesh/Makefile               | 17 +++++++++++++++++
 porting/npl/linux/test/Makefile                       | 17 +++++++++++++++++
 30 files changed, 564 insertions(+)

commit 9a1b9d7faac58e949fb2afef43504597b5543b47
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Mar 26 21:26:01 2019 +0100

    apps/bttester: Remove btp spec file from tree
    
    This is maintained in auto-pts repo.

 apps/bttester/btp_spec.txt | 1640 --------------------------------------------
 1 file changed, 1640 deletions(-)

commit 0d70bda4d7bef4db100cbd6b96f9a4c2524fbc7a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 26 14:53:33 2019 +0100

    nimble/host: Fix handling no memory for sending ACL data fragmets
    
    When host has no memory for sending ACL fragment it should not free the
    mbuf but instead put packet in the queue.
    
    It is very important espacially in case when there were already some
    fragments sent and packet continuation is required

 nimble/host/src/ble_hs_hci.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit b9fabffd8530755ad91ad41169037df78bdcf072
Author: Martin Turon <mturon@google.com>
Date:   Mon Mar 11 15:16:21 2019 -0700

    logging: Fix logging macro issue #188.

 nimble/host/include/host/ble_hs_log.h | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit 370305a086b474e68346f246543a8ce760e6b336
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 26 00:45:27 2019 +0100

    Revert "nimble/l2cap: Fix possible memory leak"
    
    This reverts commit cf63688ebfd8173421d54cef8dacdb85a448676e.
    
    This is not needed as ble_l2cap_prepend_hdr() will free txom when
    returning NULL

 nimble/host/src/ble_l2cap.c | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit 286ae23d4ef95a2dded464f4e000a17a20848c27
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 22 14:41:55 2019 +0100

    nimble/l2cap: Rename MYNEWT_VAL flag for L2CAP MPS
    
    According to Bluetooth specification 5.0 Vol 3. Part A 4.23, in the
    context of CoC this value is used to configure MPS and not MTU.

 apps/bttester/syscfg.yml                               |  4 ++--
 nimble/host/src/ble_l2cap_coc.c                        |  2 +-
 nimble/host/syscfg.yml                                 |  7 +++----
 nimble/host/test/src/ble_l2cap_test.c                  | 12 ++++++------
 porting/examples/linux/include/syscfg/syscfg.h         |  4 ++--
 porting/examples/linux_blemesh/include/syscfg/syscfg.h |  4 ++--
 porting/npl/riot/include/syscfg/syscfg.h               |  4 ++--
 7 files changed, 18 insertions(+), 19 deletions(-)

commit c6ce9930c14adf9d633f7d1259849ba2842ef9a7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 22 14:28:18 2019 +0100

    nimble/l2cap: Minor printout fix

 nimble/host/src/ble_l2cap_coc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5d4faaaf45e20015313661f9fd71dc59da31576a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 22 14:24:27 2019 +0100

    nimble/l2cap: Fix handling receiving big l2cap coc mtu
    
    If L2CAP CoC MTU was bigger then available msys block, Nimble would fail
    here.
    
    Also this pullup is some leftover which is not needed as below code does
    not really use direct access to om_data besides checking SDU lenght
    which is 2 bytes long

 nimble/host/src/ble_l2cap_coc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e1b77b4ac170c0daa3af8148bc40edbca04fccb1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 22 15:06:50 2019 -0700

    host: Free txq on connection free, not atomic del
    
    This commit just moves a bit of code from one function to another.
    Previously, a connection's transmit queue was freed in
    `ble_hs_atomic_conn_delete()`.  This operation is more logically placed
    in the more "leaf" function `ble_hs_conn_free()`.

 nimble/host/src/ble_hs_atomic.c | 7 -------
 nimble/host/src/ble_hs_conn.c   | 6 ++++++
 2 files changed, 6 insertions(+), 7 deletions(-)

commit 20e65503e8c8d721d2a66e4685251ec2d25b650c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 13 16:35:02 2019 +0100

    apps/bttester: Find GATT DB attribute offset and count
    
    These values are then sent in response to GATT Start Servert command.

 apps/bttester/src/gatt.c | 138 +++++++++++++++++++++++++++++++++++++++++++----
 1 file changed, 127 insertions(+), 11 deletions(-)

commit eca963ac3303e1ffc1433c33657f9af224fab3ce
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 13 15:23:57 2019 +0100

    apps/bttester: Set BLE_MESH_RX_SDU_MAX to a value required by PTS

 apps/bttester/syscfg.yml | 1 +
 1 file changed, 1 insertion(+)

commit e3dd6a27e8c4e84e87756e11252f2a29c2a1a5bf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 13 14:57:49 2019 +0100

    apps/bttester: Fix subscribing for notifications/indications
    
    PTS expects Write with response.

 apps/bttester/src/gatt.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit 4d5e0c75b0526e82194514491f74821df85c6dd3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 13 13:52:59 2019 +0100

    apps/bttester: Use ID addr in connected event

 apps/bttester/src/gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0d51353f26b7e1953ce5b0dfb69f47f2220c8819
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Mar 7 10:53:13 2019 +0100

    apps/bttester: Fix gap pair implementation
    
    ble_gap_security_initiate handles these
    cases under the hood and more.

 apps/bttester/src/gap.c | 13 +++----------
 1 file changed, 3 insertions(+), 10 deletions(-)

commit a60458bede7c77ce705a62cb83abf2da1c15e585
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 6 17:11:11 2019 +0100

    apps/bttester: Enable debug logs and make RTT TERMINAL BUFFER larger
    
    Small buffer size caused some logs to be dropped

 apps/bttester/syscfg.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit bdf7499e2336856cb59925ee92336a99e05e7c75
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 6 15:51:07 2019 +0100

    apps/bttester: Fix sending conn param update after connection

 apps/bttester/src/gap.c | 43 ++++++++++++++++++++++++++++---------------
 1 file changed, 28 insertions(+), 15 deletions(-)

commit e7f96097e6b358affb0f075c30007f7c8b38028d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Mar 4 16:27:46 2019 +0100

    apps/bttester: Set additional GAP characteristics sycfg

 apps/bttester/syscfg.yml | 4 ++++
 1 file changed, 4 insertions(+)

commit a28bcbc719e2157235b0eae984643afdaac265a1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Mar 25 11:23:17 2019 +0100

    nimble/ll: Convert all advsm flags setters to use helpers

 nimble/controller/src/ble_ll_adv.c | 34 +++++++++++++++++-----------------
 1 file changed, 17 insertions(+), 17 deletions(-)

commit 6d9c12990f460008970a3a497536b96078d8d2dc
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Mar 25 01:23:17 2019 +0100

    nimble/ll: Protect advsm->flags
    
    Since it can be changed in interrupt and ll task context, move it to
    critical section.

 nimble/controller/src/ble_ll_adv.c | 47 ++++++++++++++++++++++++++++++++------
 1 file changed, 40 insertions(+), 7 deletions(-)

commit 736ed3bc8bb49722879b9857fb2ae5e490736953
Merge: ad2fe321 0a5d2ee5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Mar 25 11:39:25 2019 +0100

    Merge pull request #384 from sjanc/blecent_fix
    
    nimble/host: Fix build with peripheral disabled

commit 0a5d2ee5785d0127f1c656ee130d1b0b88db8539
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Mar 25 10:54:33 2019 +0100

    nimble/apps: Disable unneeded roles in blecent sample

 apps/blecent/syscfg.yml | 6 ++++++
 1 file changed, 6 insertions(+)

commit 612b293ea8fe71ee5cb5f68780d8420143975b95
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Mar 25 10:41:08 2019 +0100

    nimble/host: Fix build with peripheral disabled

 nimble/host/src/ble_gap.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit ad2fe321474ba770f9d4a1098696de763f66a8d7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 22 16:11:16 2019 +0100

    nimble/hs: Clear tx queue when connection is dropped
    
    This patch makes sure there is no outstanding packet in the host queue
    when connection is dropped

 nimble/host/src/ble_hs_atomic.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit fe48d4146884147363dbafec16db7d7484e16129
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Mar 18 15:57:36 2019 +0100

    mesh: Prohibit initializing advertising multiple times
    
    Calling os_task_init second time results in an asser.

 nimble/host/mesh/src/adv.c | 9 +++++++++
 1 file changed, 9 insertions(+)

commit 87f1d7c607a1bb58b145b2afb61c5438e3abb2e6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Mar 18 15:58:53 2019 +0100

    nimble/pts: Add missing instructions for some testcases

 nimble/host/pts/pts-gap.txt | 47 +++++++++++++++++++++++++++++++++++++++++++--
 1 file changed, 45 insertions(+), 2 deletions(-)

commit 2776b8f738629bf4ad25104e83225212b94bb1d9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 13 12:40:55 2019 +0100

    nimble/sm: Fix bonding when key distribution is one-sided
    
    When using Legacy pairing, Nimble is a slave/responder and
    the initiator set key distribution to 0 then our LTK would
    not be stored and it wouldn't be possible to restore encryption later.
    
    In legacy mode, bonding requires the exchange of keys at least
    from one side.  If no key exchange was specified, pretend bonding
    is not enabled.
    
    This fixes SM/SLA/KDU/BV-07-C.

 nimble/host/src/ble_sm.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit cf63688ebfd8173421d54cef8dacdb85a448676e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 21 11:52:26 2019 +0100

    nimble/l2cap: Fix possible memory leak

 nimble/host/src/ble_l2cap.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 3ea16d55530fa796e3a16f3b7efbba6d143254ef
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 21 11:49:20 2019 +0100

    nimble/hs: Fix data fragmentation
    
    This fix following issue when there is no memory in the
    os_msys_init_1_mempool:
    
    0  ble_hs_hci_acl_hdr_prepend (pb_flag=0 '\000', handle=<optimized out>, om=0x0)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_hs_hci.c:415
    1  ble_hs_hci_acl_tx_now (conn=conn@entry=0x2000ab14 <ble_hs_conn_elem_mem>,
        om=om@entry=0x20004e9c <os_main_stack+3756>)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_hs_hci.c:466
    2  0x00038f80 in ble_hs_hci_acl_tx (
        conn=conn@entry=0x2000ab14 <ble_hs_conn_elem_mem>,
        om=om@entry=0x20004e9c <os_main_stack+3756>)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_hs_hci.c:536
    3  0x0003a404 in ble_l2cap_tx (conn=0x2000ab14 <ble_hs_conn_elem_mem>,
        chan=<optimized out>, txom=<optimized out>,
        txom@entry=0x200058a8 <os_msys_init_1_data+2128>)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_l2cap.c:402
    4  0x0003445a in ble_att_tx (conn_handle=conn_handle@entry=1,
        txom=0x200058a8 <os_msys_init_1_data+2128>)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_att_cmd.c:76
    5  0x00034372 in ble_att_clt_tx_notify (conn_handle=conn_handle@entry=1,
        handle=handle@entry=14, txom=txom@entry=0x20005778 <os_msys_init_1_data+1824>)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_att_clt.c:962
    6  0x00037020 in ble_gattc_notify_custom (conn_handle=conn_handle@entry=1,
        chr_val_handle=chr_val_handle@entry=14,
        txom=txom@entry=0x20005778 <os_msys_init_1_data+1824>)
        at repos/apache-mynewt-nimble/nimble/host/src/ble_gattc.c:4178
    7  0x00032b5a in oc_send_buffer_gatt (m=0x20005778 <os_msys_init_1_data+1824>)
        at repos/apache-mynewt-core/net/oic/src/port/mynewt/ble_adaptor.c:529
    8  0x0003046c in oc_buffer_tx (ev=<optimized out>)
        at repos/apache-mynewt-core/net/oic/src/api/oc_buffer.c:100
    9  0x00022500 in main (argc=<optimized out>, argv=<optimized out>)
    (gdb) p os_msys_init_1_mbuf_pool
    $17 = {omp_databuf_len = 136, omp_pool = 0x20005d74 <os_msys_init_1_mempool>,
      omp_next = {stqe_next = 0x0}}
    (gdb) p os_msys_init_1_mempool
    $18 = {mp_block_size = 152, mp_num_blocks = 22, mp_num_free = 0, mp_min_free = 0,
      mp_flags = 0 '\000', mp_membuf_addr = 536891480, mp_list = {stqe_next = 0x0}, {
        slh_first = 0x0}, name = 0x4ea4d "msys_1"}
    Collapse

 nimble/host/src/ble_hs_hci.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 87a77fd26b4c9853535fc97cb26076045ec0af6c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 20 22:15:01 2019 -0700

    Add missing ble_driver dependency to ctlr tests

 nimble/controller/test/pkg.yml | 1 +
 1 file changed, 1 insertion(+)

commit 47395db16988f4d48cfd379e4ce955c9826d42bd
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 12 17:32:17 2019 -0700

    host tests: Don't use tu_suite_set_post_test_cb()
    
    This testutil function was deprecated by this PR:
    https://github.com/apache/mynewt-core/pull/1678
    
    Instead, each test case needs to manually verify that all mbufs have
    been freed.  This results in more code duplication, but automatically
    performing this verification was not right anyway.  We do not want to
    perform this step if a test case aborted early (failed
    TEST_ASSERT_FATAL()).

 nimble/host/test/src/ble_att_clt_test.c      |  30 ++++++-
 nimble/host/test/src/ble_att_svr_test.c      |  49 ++++++++--
 nimble/host/test/src/ble_gap_test.c          | 128 ++++++++++++++++++++++-----
 nimble/host/test/src/ble_gatt_conn_test.c    |   6 +-
 nimble/host/test/src/ble_gatt_disc_c_test.c  |  10 ++-
 nimble/host/test/src/ble_gatt_disc_d_test.c  |   6 +-
 nimble/host/test/src/ble_gatt_disc_s_test.c  |  12 ++-
 nimble/host/test/src/ble_gatt_find_s_test.c  |   6 +-
 nimble/host/test/src/ble_gatt_read_test.c    |  14 ++-
 nimble/host/test/src/ble_gatt_write_test.c   |  24 ++++-
 nimble/host/test/src/ble_gatts_notify_test.c |  14 ++-
 nimble/host/test/src/ble_gatts_read_test.c   |   5 +-
 nimble/host/test/src/ble_gatts_reg_test.c    |  14 ++-
 nimble/host/test/src/ble_hs_adv_test.c       |   8 +-
 nimble/host/test/src/ble_hs_conn_test.c      |   8 +-
 nimble/host/test/src/ble_hs_hci_test.c       |  10 ++-
 nimble/host/test/src/ble_hs_id_test.c        |  12 ++-
 nimble/host/test/src/ble_hs_pvcy_test.c      |  16 +++-
 nimble/host/test/src/ble_hs_stop_test.c      |   5 +-
 nimble/host/test/src/ble_hs_test.c           |   3 +
 nimble/host/test/src/ble_hs_test_util.c      |   6 --
 nimble/host/test/src/ble_l2cap_test.c        |  52 ++++++++++-
 nimble/host/test/src/ble_os_test.c           |   8 +-
 nimble/host/test/src/ble_sm_lgcy_test.c      |  14 ++-
 nimble/host/test/src/ble_sm_sc_test.c        |  30 ++++++-
 nimble/host/test/src/ble_sm_test.c           |  22 ++++-
 nimble/host/test/src/ble_store_test.c        |  12 ++-
 nimble/host/test/src/ble_uuid_test.c         |   4 +-
 28 files changed, 442 insertions(+), 86 deletions(-)

commit 7bfbc1d80b16a546843029c34f85b8493215b5c5
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 13 08:25:27 2019 -0700

    host: Update unit tests to use new testutil
    
    The testutil API chnaged with this PR:
    https://github.com/apache/mynewt-core/pull/1678
    
    This commit changes the host unit tests to use the updated testutil API.

 nimble/host/test/src/ble_att_clt_test.c      |  34 +++----
 nimble/host/test/src/ble_att_svr_test.c      |  38 +++----
 nimble/host/test/src/ble_gap_test.c          | 142 ++++++++++++---------------
 nimble/host/test/src/ble_gatt_conn_test.c    |  12 +--
 nimble/host/test/src/ble_gatt_disc_c_test.c  |  17 +---
 nimble/host/test/src/ble_gatt_disc_d_test.c  |  12 +--
 nimble/host/test/src/ble_gatt_disc_s_test.c  |  18 +---
 nimble/host/test/src/ble_gatt_find_s_test.c  |  12 +--
 nimble/host/test/src/ble_gatt_read_test.c    |  20 ++--
 nimble/host/test/src/ble_gatt_write_test.c   |  30 +++---
 nimble/host/test/src/ble_gatts_notify_test.c |  20 ++--
 nimble/host/test/src/ble_gatts_read_test.c   |   4 +-
 nimble/host/test/src/ble_gatts_reg_test.c    |  20 ++--
 nimble/host/test/src/ble_hs_adv_test.c       |  15 +--
 nimble/host/test/src/ble_hs_conn_test.c      |  16 +--
 nimble/host/test/src/ble_hs_hci_test.c       |  15 +--
 nimble/host/test/src/ble_hs_id_test.c        |  18 +---
 nimble/host/test/src/ble_hs_pvcy_test.c      |  22 ++---
 nimble/host/test/src/ble_hs_test.c           |  65 +++++++-----
 nimble/host/test/src/ble_hs_test_util.c      |   4 +-
 nimble/host/test/src/ble_l2cap_test.c        |  62 +++++-------
 nimble/host/test/src/ble_os_test.c           |  13 +--
 nimble/host/test/src/ble_sm_lgcy_test.c      |  12 +--
 nimble/host/test/src/ble_sm_sc_test.c        |  28 +++---
 nimble/host/test/src/ble_sm_test.c           |  34 ++-----
 nimble/host/test/src/ble_store_test.c        |  18 +---
 nimble/host/test/src/ble_uuid_test.c         |  10 +-
 27 files changed, 268 insertions(+), 443 deletions(-)

commit 3db75f82ed8ab77228aa43193669f8aeec163e95
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 13 08:25:22 2019 -0700

    controller: Update unit tests to use new testutil
    
    The testutil API chnaged with this PR:
    https://github.com/apache/mynewt-core/pull/1678
    
    This commit changes the controller unit tests to use the updated
    testutil API.

 nimble/controller/test/src/ble_ll_csa2_test.c | 14 +++-----------
 nimble/controller/test/src/ble_ll_csa2_test.h | 27 +++++++++++++++++++++++++++
 nimble/controller/test/src/ble_ll_test.c      |  6 ++----
 3 files changed, 32 insertions(+), 15 deletions(-)

commit 916c032258cca756ae56485f4c1f5f4e56918320
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 13 08:23:36 2019 -0700

    host: Move ble_hs_test.h to "test" package
    
    This header is only needed by unit tests, so it is better placed in the
    unit test package.

 nimble/host/include/host/ble_hs.h            |  1 -
 nimble/host/include/host/ble_hs_test.h       | 61 ---------------------------
 nimble/host/test/src/ble_att_clt_test.c      |  2 +-
 nimble/host/test/src/ble_att_svr_test.c      |  2 +-
 nimble/host/test/src/ble_gap_test.c          |  2 +-
 nimble/host/test/src/ble_gatt_conn_test.c    |  2 +-
 nimble/host/test/src/ble_gatt_disc_c_test.c  |  2 +-
 nimble/host/test/src/ble_gatt_disc_d_test.c  |  2 +-
 nimble/host/test/src/ble_gatt_disc_s_test.c  |  2 +-
 nimble/host/test/src/ble_gatt_find_s_test.c  |  2 +-
 nimble/host/test/src/ble_gatt_read_test.c    |  2 +-
 nimble/host/test/src/ble_gatt_write_test.c   |  2 +-
 nimble/host/test/src/ble_gatts_notify_test.c |  2 +-
 nimble/host/test/src/ble_gatts_read_test.c   |  2 +-
 nimble/host/test/src/ble_gatts_reg_test.c    |  2 +-
 nimble/host/test/src/ble_hs_adv_test.c       |  2 +-
 nimble/host/test/src/ble_hs_conn_test.c      |  2 +-
 nimble/host/test/src/ble_hs_hci_test.c       |  2 +-
 nimble/host/test/src/ble_hs_id_test.c        |  2 +-
 nimble/host/test/src/ble_hs_pvcy_test.c      |  2 +-
 nimble/host/test/src/ble_hs_stop_test.c      |  2 +-
 nimble/host/test/src/ble_hs_test.c           |  2 +-
 nimble/host/test/src/ble_hs_test.h           | 62 ++++++++++++++++++++++++++++
 nimble/host/test/src/ble_l2cap_test.c        |  2 +-
 nimble/host/test/src/ble_os_test.c           |  2 +-
 nimble/host/test/src/ble_sm_lgcy_test.c      |  2 +-
 nimble/host/test/src/ble_sm_sc_test.c        |  2 +-
 nimble/host/test/src/ble_sm_test.c           |  2 +-
 nimble/host/test/src/ble_sm_test_util.c      |  2 +-
 nimble/host/test/src/ble_store_test.c        |  2 +-
 nimble/host/test/src/ble_uuid_test.c         |  2 +-
 31 files changed, 90 insertions(+), 90 deletions(-)

commit 4e3032d6049ff940e980312650de8efed43323a6
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Mar 7 12:29:59 2019 +0100

    ll_dtm: add missing critical sections

 nimble/controller/src/ble_ll_dtm.c | 4 ++++
 1 file changed, 4 insertions(+)

commit a7b3c939146e735b59d55bff740c906bde6f86f9
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Mar 7 12:20:27 2019 +0100

    npl/riot: fix ble_npl_hw_is_in_critical()

 porting/npl/riot/include/nimble/nimble_npl_os.h | 14 ++++++++++++--
 porting/npl/riot/src/npl_os_riot.c              |  2 ++
 2 files changed, 14 insertions(+), 2 deletions(-)

commit afc27414132d3d9a90bc16d41f2ed6717f85ee71
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Tue Mar 12 12:00:06 2019 +0100

    porting/hal_timer: use OS_[ENTER/EXIT]_CRITICAL()

 porting/nimble/src/hal_timer.c | 49 ++++++++++++++++--------------------------
 1 file changed, 18 insertions(+), 31 deletions(-)

commit f8f02740acdf4d302d5c2f91ee2e34444d405671
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 12 13:13:12 2019 +0100

    nimble/host: Fix credits setting for L2CAP CoC
    
    With current implementation we could end up having credits 0 when
    requested L2CAP CoC MTU is much lower than MTU on L2CAP channel.
    
    This patch fixes it.

 nimble/host/src/ble_l2cap_coc.c       |  5 ++++-
 nimble/host/test/src/ble_l2cap_test.c | 22 ++++++++++++++++++----
 2 files changed, 22 insertions(+), 5 deletions(-)

commit e1d3968bf03ab504c6a5b8e2501df5b441fb51d7
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Mar 7 12:25:07 2019 +0100

    controller/ll: remove RIOT specific eventq init hack

 nimble/controller/src/ble_ll.c | 20 --------------------
 1 file changed, 20 deletions(-)

commit 28760d18dca33966faa1cac3ae307e3134744bf4
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Mar 7 12:24:12 2019 +0100

    npl/riot: init event queues detached and claim later

 porting/npl/riot/include/nimble/nimble_npl_os.h | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 5f691c966cbe97190f85fc991d94e85d8b13e773
Merge: ba7252bc 483b3b96
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 8 00:27:47 2019 +0100

    Merge pull request #368 from sjanc/fixes
    
    Couple fixes for LL

commit 483b3b96241a9445b1b3bdab3811531ec1dff774
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Mar 7 16:01:08 2019 +0100

    nimble/ll/dtm: Minor remainder calculation fix

 nimble/controller/src/ble_ll_adv.c | 1 -
 nimble/controller/src/ble_ll_dtm.c | 4 ++--
 2 files changed, 2 insertions(+), 3 deletions(-)

commit ba7252bc2f3293ba839cb041e8835f3046d0387e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 5 15:26:21 2019 +0100

    nimble/ll: Add pkg restriction for cputime frequency
    
    It has to be 32768, LL cannot work with other setting.

 nimble/controller/syscfg.yml | 3 +++
 1 file changed, 3 insertions(+)

commit 96d14d1d0a1c71f73ada595427ccad8569bb0239
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 5 15:17:58 2019 +0100

    nimble: Replace BLE_DEVICE usage with BLE_CONTROLLER

 apps/btshell/src/cmd.c                                 |  2 +-
 nimble/host/src/ble_hs_hci_cmd.c                       |  2 +-
 nimble/host/src/ble_hs_startup.c                       |  4 ++--
 nimble/host/util/src/addr.c                            |  4 ++--
 nimble/transport/socket/src/ble_hci_socket.c           |  2 +-
 nimble/transport/uart/src/ble_hci_uart.c               | 18 +++++++++---------
 porting/examples/linux/include/syscfg/syscfg.h         |  4 ++--
 porting/examples/linux_blemesh/include/syscfg/syscfg.h |  4 ++--
 porting/npl/riot/include/syscfg/syscfg.h               |  4 ++--
 9 files changed, 22 insertions(+), 22 deletions(-)

commit 45e8471252df99bd0dcdbb160431c485fcb68355
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 5 15:11:22 2019 +0100

    nimble/ll: Rename BLE_DEVICE to BLE_CONTROLLER
    
    BLE_CONTROLLER better describes the function of this syscfg setting and
    fits better with BLE_HOST.
    
    Also BLE_LP_CLOCK is redundant.

 nimble/controller/syscfg.yml | 21 +++++++++++++--------
 1 file changed, 13 insertions(+), 8 deletions(-)

commit cad1a2e4dc57720d924aafa171cf2e4acee6ef02
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Mar 7 15:57:58 2019 +0100

    nimble/ll: Fix PHY validation in LE Set Extended Advertising Parameters
    
    Valid PHYs depends pon supported PHYs. This fix assert when starting
    advertising configured for unsupported PHY.

 nimble/controller/src/ble_ll_adv.c | 37 ++++++++++++++++++++++++++++++++++---
 1 file changed, 34 insertions(+), 3 deletions(-)

commit e962353e31b2a66232a27e8b99070f6492dc2684
Merge: 70e1d20d 16131409
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Mar 7 16:24:14 2019 +0100

    Merge pull request #361 from ccollins476ad/clang
    
    clang: Fix "unused function" warnings

commit 16131409118bfed20914089524e68970abc3b598
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 4 15:14:45 2019 -0800

    clang: Fix "unused function" warnings
    
    Clang warns about some unused `static inline` functions.  Conditionally
    compile out these functions.

 nimble/controller/src/ble_ll_adv.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 70e1d20d214920623623f22180d4f9df19a22349
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 1 15:20:00 2019 -0800

    Remove implicit enum conversions for clang
    
    gcc allows implicit conversion between enum type (even when `-Wall` is
    specified).  clang does not allow such conversions with `-Wall`.  It
    reports warnings like this one:
    
        error: implicit conversion from enumeration type 'os_error_t' (aka 'enum os_error') to different enumeration type 'ble_npl_error_t' (aka 'enum ble_npl_error')
    
    This commit makes these conversions explicit via casts.  This allows the
    unit test code to be built with clang using Mynewt's default build
    flags.

 porting/npl/mynewt/include/nimble/nimble_npl_os.h | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 6a5f6a59ccfcbe1ee5b2d19a9fd53bae08128480
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 28 15:32:07 2019 +0100

    nimble/ll: Add some missing 'static's

 nimble/controller/src/ble_ll_sched.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit a39b15bf4bf51b6eedc6890b2e94ba39f2f447a2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 28 15:23:53 2019 +0100

    porting: Fix build error
    
    'OS_ASSERT_CRITICAL();' won't build if assert is defined as 'if () {}'.

 porting/nimble/include/os/os.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3ac89668f872957da5124799e6e22eec53a6087d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 28 15:22:59 2019 +0100

    porting: Add missing include
    
    We use assert in macro so good to have prototype included.

 porting/nimble/include/os/os.h | 2 ++
 1 file changed, 2 insertions(+)

commit cd055e96d94b48d182576d3bc6d69d3d9318c7af
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 28 13:51:00 2019 +0100

    nimble/ll: Fix indentation

 nimble/controller/src/ble_ll_sched.c | 23 ++++++++++-------------
 1 file changed, 10 insertions(+), 13 deletions(-)

commit 5d5275e06314e2443006f6d0061051be7afc5143
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 28 13:48:36 2019 +0100

    nimble/ll: Remove redundant variable
    
    We will always schedule 1st advertising event thus 'rc' is redundant
    (and it was only initialized to 0 so this could never return non-zero
    anyway).

 nimble/controller/src/ble_ll_sched.c | 10 ++--------
 1 file changed, 2 insertions(+), 8 deletions(-)

commit 3d7dbe6d7c98cd1cf14bac6bf9af99a57adb5d3b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 28 13:45:04 2019 +0100

    nimble/ll: Fix rescheduling ADV PDU
    
    It should be marked as enqueued if scheduled, otherwise we may not be
    able to remove scheduled item since ble_ll_sched_rmv_elem() check if
    element is marked as enqueued before even attempting to remove it.

 nimble/controller/src/ble_ll_sched.c | 1 +
 1 file changed, 1 insertion(+)

commit 275ffae3a97886b2d5ea2ba39556f8ec5b853aea
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 26 14:36:02 2019 +0100

    porting: Fix redundant conditions
    
    Both "blocks" and "block_size" are unsigned so they cannot be <0...

 porting/nimble/src/os_mempool.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b0cd89791786441766033dff42d7550315bcd70b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 26 14:28:50 2019 +0100

    porting: Add missing include

 porting/nimble/src/nimble_port.c | 1 +
 1 file changed, 1 insertion(+)

commit b8ae55fee40ee792ac6bacdff90ff142476d84f7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 26 14:25:48 2019 +0100

    nimble/host: Fix coding style
    
    Some of those variables are also redundant.

 nimble/host/src/ble_sm_sc.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 49e3d00afbf90582701ed9bc4df64bbc7edfcc7e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 25 10:36:36 2019 +0100

    nimble/transport: Fix function prototype
    
    ble_hci_trans_cfg_hs is used to configure callbacks for events, not
    commands.

 nimble/include/nimble/ble_hci_trans.h | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 3e426ad80480b55df048c2b9aa76ffb536a9533d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Feb 26 12:12:48 2019 +0100

    porting: Fix typos in controller makefile

 porting/nimble/Makefile.controller | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 282632ca0e9e8c0dc3ed4f32d387b8d056432fcf
Merge: 9d0d7e4d 93f90787
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Feb 26 12:08:28 2019 +0100

    Merge pull request #328 from sjanc/adv_csa
    
    Use CSA#2 for secodnary channels selection in extended advertising

commit 93f9078748be03c11eba3ebaefba90da2d21e9c8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Feb 1 11:57:31 2019 +0100

    nimble/ll: Don't use blacklisted channels for advertising without CSA2
    
    Remap randomized advertising secondary channels to avodi using
    channels marked as bad.
    
    Signed-off-by: Szymon Janc <szymon.janc@codecoup.pl>

 nimble/controller/src/ble_ll_adv.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 4e378fa40f42503e15f5fd27e5b9dff5e5de3bf2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jan 31 16:06:19 2019 +0100

    ninble/ll: Use CSA2 for secondary advertising channel selection
    
    When CSA2 support is enabled it is used for channel selection for
    auxilary advertising PDUs.

 nimble/controller/src/ble_ll_adv.c | 25 ++++++++++++++++++++++---
 1 file changed, 22 insertions(+), 3 deletions(-)

commit c31a54a792638e5d97e68585c8ccec5ae78edfee
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jan 31 14:26:44 2019 +0100

    nimble/ll: Move CSA2 and channel map functions to utils
    
    Those will be also used in periodic advertising.

 .../controller/include/controller/ble_ll_utils.h   |  26 ++
 nimble/controller/src/ble_ll_conn.c                | 263 +-------------------
 nimble/controller/src/ble_ll_conn_hci.c            |   3 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   1 -
 nimble/controller/src/ble_ll_utils.c               | 273 +++++++++++++++++++++
 5 files changed, 308 insertions(+), 258 deletions(-)

commit 9d0d7e4d23cf82b10dd7b19c49249e6a4578a892
Merge: 17779ae3 41919a82
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Feb 26 11:27:59 2019 +0100

    Merge pull request #350 from sjanc/ports_makefile
    
    Ports makefile improvements

commit 41919a821e5f94779e506baaf8258bd55f8bac26
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Feb 25 14:56:20 2019 +0100

    Remove exec permission from source files

 apps/blemesh_light/src/main.c     | 0
 apps/blemesh_light/src/ws2812.c   | 0
 apps/blemesh_light/src/ws2812.h   | 0
 porting/nimble/include/os/queue.h | 0
 4 files changed, 0 insertions(+), 0 deletions(-)

commit 9180b300351b2977da30ebf3bf79572198409fba
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Feb 25 14:27:40 2019 +0100

    gitignore: Add missing examples binaries

 .gitignore | 2 ++
 1 file changed, 2 insertions(+)

commit ecf352bca9e68d7e1094ae7bde70e5045dee463e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Feb 25 14:25:19 2019 +0100

    porting: Use wildcards in Makefiles
    
    This makes port build similar to when using newt tool which always
    builds all files in src/ folder.

 nimble/host/src/ble_eddystone.c                    |  1 +
 porting/examples/dummy/Makefile                    | 11 +++-
 porting/examples/linux/Makefile                    | 21 +++---
 porting/examples/linux_blemesh/Makefile            | 22 ++++---
 porting/nimble/Makefile.controller                 | 25 ++-----
 porting/nimble/Makefile.defs                       | 77 ++++------------------
 porting/nimble/Makefile.mesh                       | 22 +------
 porting/nimble/Makefile.tinycrypt                  |  7 +-
 .../npl/linux/{src => include/nimble}/os_types.h   |  0
 9 files changed, 51 insertions(+), 135 deletions(-)

commit 17779ae3d9e29a84f65ce7f94bec62529950217f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 19 11:44:27 2019 +0100

    apps/bttester: Fix enable subscription implementation

 apps/bttester/src/gatt.c | 13 +++++--------
 1 file changed, 5 insertions(+), 8 deletions(-)

commit 641193a52acf3405f767792f7d85ac8dfe2cc36a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 19 11:43:52 2019 +0100

    apps/bttester: Add notify/indicate flags to a read/write char

 apps/bttester/src/gatt.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit d91bde4bf4efe38a85a35e8c903fe2e9a3de3120
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 19 11:43:22 2019 +0100

    apps/bttester: Fix setting UART pipe size

 apps/bttester/src/uart_pipe.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c847a40159d46bcbc6725992bb7727b82022669f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 19 11:43:10 2019 +0100

    apps/bttester: Fix debug logging

 apps/bttester/src/bttester.c | 4 ++--
 apps/bttester/src/bttester.h | 2 +-
 apps/bttester/syscfg.yml     | 4 ++++
 3 files changed, 7 insertions(+), 3 deletions(-)

commit 058b5aa1ca267c30150bfcb8dbdd665fdf51cf2d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Feb 18 15:32:48 2019 +0100

    apps/bttester: Add support for discovering all primary services

 apps/bttester/src/bttester.h | 10 ++++++++++
 apps/bttester/src/gatt.c     | 44 ++++++++++++++++++++++++++++++++++++++++----
 2 files changed, 50 insertions(+), 4 deletions(-)

commit 4d522e3a8de5df3b2adea35a0a8de24ae8af3121
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Feb 18 15:32:11 2019 +0100

    apps/bttester: Fix find included services
    
    Previously the handles returned by the application were wrong.

 apps/bttester/src/gatt.c | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

commit e5d705210c80f495d76e1fddd67a04f6d81ec596
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Feb 15 12:07:38 2019 +0100

    apps/bttester: Add support for passkey confirm command

 apps/bttester/src/gap.c | 37 +++++++++++++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)

commit 1fa61a6257123c647ca334953288c2eb9e44d2ae
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Feb 15 12:07:20 2019 +0100

    apps/bttester: Fix passkey_entry handling

 apps/bttester/src/gap.c | 1 +
 1 file changed, 1 insertion(+)

commit cdb0398414f6649402d85ebf32442c7fd07d13ed
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 13 16:07:44 2019 +0100

    apps/bttester: Use UART pipe by default

 apps/bttester/src/uart_pipe.c | 4 ++--
 apps/bttester/syscfg.yml      | 6 +++---
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 81bc4d0e87e2fe40c3d4bca53d77266b66fcb14b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Feb 11 16:10:33 2019 +0100

    apps/bttester: Fix setting friend and gatt proxy options

 apps/bttester/src/mesh.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit f45de569caedb304868fdfd75dd039b64b724ee1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 13 15:36:30 2019 +0100

    apps/bttester: Fix handling own address
    
    Use public address if assigned, otherwise use static random address.
    Set correct flags when using random address.

 apps/bttester/src/gap.c  | 27 ++++++++++++++++++++++++---
 apps/bttester/src/mesh.c |  4 +++-
 apps/bttester/syscfg.yml |  1 -
 3 files changed, 27 insertions(+), 5 deletions(-)

commit ff5d9a6211f307b055fd018f705fcf08023fee86
Author: Simon Ratner <simon+github@probablyprime.net>
Date:   Sun Feb 24 23:16:49 2019 -0800

    nimble/host: Fix ble_sm_tx called without a lock

 nimble/host/src/ble_sm.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 92ab01ca9b771777f4249cfbac2aa8801fdcdf4e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 25 10:38:40 2019 +0100

    porting: Add NPL equivalent for OS_ASSERT_CRITICAL

 nimble/include/nimble/nimble_npl.h              | 2 ++
 porting/nimble/include/os/os.h                  | 1 +
 porting/npl/riot/include/nimble/nimble_npl_os.h | 6 ++++++
 3 files changed, 9 insertions(+)

commit 8ae6aff907f3f5b1fb0b365e3950ab559f82920e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Feb 25 10:54:55 2019 +0100

    porting/examples: Fix Makefiles

 porting/examples/linux/Makefile         | 2 +-
 porting/examples/linux_blemesh/Makefile | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit eb90977c272546ca22bd304bae77042524fb0b62
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Feb 22 16:08:11 2019 +0100

    porting/examples: Add missing syscfg.h

 .../examples/linux_blemesh/include/syscfg/syscfg.h | 1107 ++++++++++++++++++++
 1 file changed, 1107 insertions(+)

commit 137efe3bc2551734100c1ded1031b6cd3b0d18bf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Feb 22 13:52:43 2019 +0100

    nimble/ll: Improve scanner stop
    
    With this patch aux data cleaning and scheduler clean from aux_ptrs is
    done only when extended scanner was enabled.

 nimble/controller/src/ble_ll_scan.c | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

commit e7b0f4918727e0dd73c35e745bf3507acccb76eb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Feb 22 13:49:18 2019 +0100

    nimble/ll: Fix removing elements from the scheduler
    
    This patch makes sure to start scheduler timer only for valid entry.
    Also now function will return imidiatelly if scheduler list is empty.

 nimble/controller/src/ble_ll_sched.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 9a9bac14a395ff6fb418a579f085e9181088cd4a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Feb 19 08:29:33 2019 +0100

    nimble/ll: Fix race condition
    
    This patch fixes race condition when g_ble_ll_data.ll_rfclk_state
    is out of sync with nrf52_clock_hfxo_refcnt in nrf52_clock.c
    
    It could happen when HCI Reset has been done while scanning/advertising
    etc.
    
    This patch also adds OS_ASSERT_CRITICAL() in places where ll_rfclk_state
    is changed.

 nimble/controller/src/ble_ll.c      | 2 ++
 nimble/controller/src/ble_ll_xcvr.c | 3 +++
 2 files changed, 5 insertions(+)

commit e665d203e93002a48809996c519acdf1b633c8e8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Feb 1 15:41:12 2019 +0100

    apps/blemesh_models_example_2: Sync with Zephyr
    
    This patch combines all the changes made to this application in Zephyr.
    It features a lot of improvements and updates.
    
    With these changes some of the PTS Mesh Model testcases pass.

 apps/blemesh_models_example_2/README.md            |    4 +-
 apps/blemesh_models_example_2/pkg.yml              |    2 +
 apps/blemesh_models_example_2/src/app_gpio.c       |   76 +
 apps/blemesh_models_example_2/src/app_gpio.h       |   17 +
 apps/blemesh_models_example_2/src/ble_mesh.c       |    4 +
 apps/blemesh_models_example_2/src/ble_mesh.h       |   20 +
 apps/blemesh_models_example_2/src/common.h         |    4 +-
 .../src/device_composition.c                       | 1826 ++++++++++++++------
 .../src/device_composition.h                       |   82 +-
 apps/blemesh_models_example_2/src/main.c           |  231 +--
 .../src/no_transition_work_handler.c               |   70 +
 .../src/no_transition_work_handler.h               |   15 +
 apps/blemesh_models_example_2/src/publisher.c      |   18 +-
 apps/blemesh_models_example_2/src/state_binding.c  |  316 ++--
 apps/blemesh_models_example_2/src/state_binding.h  |   21 +
 apps/blemesh_models_example_2/src/storage.c        |  237 +++
 apps/blemesh_models_example_2/src/storage.h        |   28 +
 apps/blemesh_models_example_2/src/transition.c     |  741 ++++----
 apps/blemesh_models_example_2/src/transition.h     |   62 +-
 apps/blemesh_models_example_2/syscfg.yml           |   33 +-
 20 files changed, 2679 insertions(+), 1128 deletions(-)

commit 65869c55717b5c57fd4bee10b5b2233108c4883d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Feb 7 16:16:00 2019 +0100

    porting: Add blemesh example app for Linux

 porting/examples/linux_blemesh/Makefile |  88 +++++++
 porting/examples/linux_blemesh/ble.c    | 447 ++++++++++++++++++++++++++++++++
 porting/examples/linux_blemesh/main.c   |  98 +++++++
 3 files changed, 633 insertions(+)

commit 6f4181359266ec47587d86146eebd193684dd42d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 15 11:04:03 2019 +0100

    nimble/mesh: Do not redefine ARRAY_SIZE
    
    os/util.h has it now, but it may still be needed for ports.

 nimble/host/mesh/include/mesh/glue.h | 3 +++
 1 file changed, 3 insertions(+)

commit ca2d12baed03a62b5ce9083f4d3ce9c1734d0cc2
Author: Reham Tarek <rehamt@internal.synopsys.com>
Date:   Mon Feb 11 18:48:40 2019 +0200

    Additional Fix For Handling conn_handle=0
    
    A conn_handle of 0 should be handled as a valid connection handle while BLE_HS_CONN_HANDLE_NONE should be the proper assignment for the cases where the connection is no longer valid. This fix includes some spotted areas where a check for a valid connection handle is not properly handled.

 nimble/host/mesh/src/prov.c  | 4 ++--
 nimble/host/mesh/src/proxy.c | 5 +++--
 2 files changed, 5 insertions(+), 4 deletions(-)

commit bea94a0592b105eabecb2e15ed0bbc05f83daacf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Feb 11 15:21:07 2019 +0100

    nimble/mesh: Use ble_gap_event_listener instead of ble_gap_mesh_cb
    
    Use generic listener mechanism instead of dedicated Mesh callback.

 nimble/host/include/host/ble_gap.h |  4 ----
 nimble/host/mesh/src/mesh.c        |  4 +++-
 nimble/host/src/ble_gap.c          | 48 ++------------------------------------
 3 files changed, 5 insertions(+), 51 deletions(-)

commit 7ef718c120657021537d388945676e6c3527897d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Feb 8 16:15:40 2019 +0100

    apps/bttester: Update L2CAP COC MTU to be lower than application MTU
    
    Some testcases require MPS < MTU to test reassembly.

 apps/bttester/syscfg.yml | 2 ++
 1 file changed, 2 insertions(+)

commit 27c61ea33dc53e6b1b9f088e1a297de9ca075e84
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Feb 7 16:55:01 2019 +0100

    porting/linux: Fix semaphore and mutex pend implementations

 porting/npl/linux/src/os_mutex.c | 31 +++++++++++++++++++------------
 porting/npl/linux/src/os_sem.c   | 37 +++++++++++++++----------------------
 2 files changed, 34 insertions(+), 34 deletions(-)

commit 44569e1c72951a014a07ec7c088e85a8596e52f1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 7 00:55:48 2019 +0100

    nimble/ll: Fix handling RX data while encryption as a Slave
    
    Set enc_stat in the LL_ENC_REQ handler and not when sending LL_ENC_RSP.
    This is in order to make sure that next incoming PDU will be
    alread verified
    
    This fix small rate of failures of LL/SEC/SLA/BI-05

 nimble/controller/src/ble_ll_ctrl.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 664bf53ae1dc38c90aec9c99c9126b4de0f501e3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Feb 7 16:11:52 2019 +0100

    porting: Enable modlog printing when LOG_LEVEL set appropriately

 porting/nimble/include/modlog/modlog.h | 39 +++++++++++++++++++++++++++++-----
 1 file changed, 34 insertions(+), 5 deletions(-)

commit 17cbeab272feec6ac1d470eb3e07a0c962c0e1f5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Feb 7 15:41:31 2019 +0100

    porting/linux: Fix ble_npl_time_delay implementation
    
    Previous implementation was inaccurate due to use
    of sleep() function which uses seconds as a time parameter.

 porting/npl/linux/src/os_time.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit 680a32ce66839211138a2fa4b5e4773136ccfaea
Author: Martin Turon <mturon@google.com>
Date:   Mon Oct 29 14:55:43 2018 -0700

    [linux] Stability fixes to linux port: npl mutex, queues, and task.

 porting/npl/linux/src/os_mutex.c         | 17 +++++++----------
 porting/npl/linux/src/os_task.c          | 14 ++++++--------
 porting/npl/linux/src/os_types.h         |  4 ++++
 porting/npl/linux/src/wqueue.h           | 13 +++++++------
 porting/npl/linux/test/test_npl_eventq.c |  3 ++-
 5 files changed, 26 insertions(+), 25 deletions(-)

commit 07a14c38fb28ebc22468f95197f0ece11f996931
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Feb 6 16:16:28 2019 +0100

    nimble/ll: Fix time restrictions on PHY transition in Master role
    
    Fix according to Bluetooth 5.0 Vol. 6 Part B 5.1.10.1
    
    This fixes LL/CON/MAS/BV-50-C

 nimble/controller/src/ble_ll_ctrl.c | 17 +++++++++--------
 1 file changed, 9 insertions(+), 8 deletions(-)

commit de4a79f3452fb5ff09bdca698b2894b9a49e4663
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Feb 5 17:04:21 2019 +0100

    nimble/ll: Fix enh connection complete event as a master
    
    This patch fixes incorretly used identity address as a local rpa address
    in the LE Enhanced Connection Complete Evt

 nimble/controller/include/controller/ble_ll_conn.h | 3 +--
 nimble/controller/src/ble_ll_conn.c                | 2 ++
 nimble/controller/src/ble_ll_conn_hci.c            | 7 ++++---
 3 files changed, 7 insertions(+), 5 deletions(-)

commit 7cc706390e43a5d084b8cfe74fc4b5f216f8552f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 5 11:20:42 2019 +0100

    nimble/host: Fix missing newlines in some logs

 nimble/host/src/ble_hs.c     | 2 +-
 nimble/host/src/ble_hs_dbg.c | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 778d2cb9a0a4aaf6f8adc73e04045c3f8a056a86
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 31 12:56:52 2019 +0100

    nimble/host: Persist CCCD values that were set before bonding
    
    Before:
    
    1. Nimble is a peripheral
    2. A connection is established with a peer device
    3. Peer device subscribes for notifications/indications on a CCCD
    4. Bonding with a peer device
    5. Peer device disconnects and reconnects
    6. The indication setting is not restored
    
    After:
    
    1. Nimble is a peripheral
    2. A connection is established with a peer device
    3. Peer device subscribes for notifications/indications on a CCCD
    4. Bonding with a peer device
    5. CCCD values are persisted
    6. Peer device disconnects and reconnects
    7. The indication settings are restored
    
    Fixes issue #319

 nimble/host/src/ble_gap.c       |  8 ++++++--
 nimble/host/src/ble_gatt_priv.h |  1 +
 nimble/host/src/ble_gatts.c     | 35 +++++++++++++++++++++++++++++++++++
 3 files changed, 42 insertions(+), 2 deletions(-)

commit 2d3705b94f7b5d2493c71abb5ba4d33b3d763735
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 11 16:54:32 2019 +0100

    apps/bttester: Port app to Mynewt

 apps/bttester/README              |   53 +-
 apps/bttester/pkg.yml             |   42 +
 apps/bttester/src/atomic.h        |  386 +++++++
 apps/bttester/src/bttester.c      |  154 ++-
 apps/bttester/src/bttester.h      |   47 +-
 apps/bttester/src/bttester_pipe.h |   39 +
 apps/bttester/src/gap.c           |  885 +++++++++++----
 apps/bttester/src/gatt.c          | 2273 +++++++++++++++++++++----------------
 apps/bttester/src/glue.c          |  129 +++
 apps/bttester/src/glue.h          |   65 ++
 apps/bttester/src/l2cap.c         |  397 ++++---
 apps/bttester/src/main.c          |   43 +-
 apps/bttester/src/mesh.c          |  131 ++-
 apps/bttester/src/rtt_pipe.c      |  136 +++
 apps/bttester/src/uart_pipe.c     |  256 +++++
 apps/bttester/syscfg.yml          |  117 ++
 16 files changed, 3601 insertions(+), 1552 deletions(-)

commit 07df4bbae05e018f2c9dc850dc66c2efc0b8fb9b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 11 16:54:16 2019 +0100

    apps/bttester: Copy files from Zephyr

 apps/bttester/README         |   57 ++
 apps/bttester/btp_spec.txt   | 1640 +++++++++++++++++++++++++++++++++++
 apps/bttester/src/bttester.c |  300 +++++++
 apps/bttester/src/bttester.h |  846 ++++++++++++++++++
 apps/bttester/src/gap.c      |  748 ++++++++++++++++
 apps/bttester/src/gatt.c     | 1952 ++++++++++++++++++++++++++++++++++++++++++
 apps/bttester/src/l2cap.c    |  357 ++++++++
 apps/bttester/src/main.c     |   18 +
 apps/bttester/src/mesh.c     |  927 ++++++++++++++++++++
 9 files changed, 6845 insertions(+)

commit a14826c3c6f2a2f68473499c6ec12fd73ff0a356
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Feb 4 10:07:37 2019 +0100

    nimble/ll: Clear connsm->inita_identity_used when connsm is created

 nimble/controller/src/ble_ll_conn.c | 1 +
 1 file changed, 1 insertion(+)

commit 7b0995de9ba7d6e7c0ef48f4fe55a61bfe9c8c7a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 31 17:56:38 2019 +0100

    apps/btshell: Add an example of included services

 apps/btshell/src/gatt_svr.c | 38 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 38 insertions(+)

commit 067bebe4b5ff6817c1af83efd2510b66ab9c2d7b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 29 12:35:43 2019 +0100

    nimble/host: Fix printing included services
    
    Previously there was a bug when iterating over included services.
    Moreover the handles for included services were not assigned, which
    resulted in wrong handle for all attributes placed after the included
    services in the database. This patch fixes it and improves information
    displayed by this function.

 nimble/host/src/ble_gatts_lcl.c | 29 ++++++++++++++++++++---------
 1 file changed, 20 insertions(+), 9 deletions(-)

commit 58ed664b99810662a732395ce8ec5bb3ee4dd8c0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 16:22:53 2019 +0100

    mesh: Take advantage of net_buf_simple_pull_mem()
    
    Use net_buf_simple_pull_mem() instead of net_buf_simple_pull() where
    it makes sense.

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/beacon.c        |  3 +--
 nimble/host/mesh/src/cfg_srv.c       | 19 +++++++------------
 nimble/host/mesh/src/glue.c          |  9 +++++++++
 4 files changed, 18 insertions(+), 14 deletions(-)

commit 7cf84d52b92dbef43126f6dcfaef27f841b4620a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:52:39 2019 +0100

    mesh: Fix publish timer handling when sending fails
    
    Sending a model publication message could fail e.g. if there are no
    buffers available, however this doesn't mean that we should stop doing
    periodic publishing indefinitely. When an error occurs, make sure to
    call the publish_sent() function so that the periodic publishing timer
    gets resubmitted if necessary.

 nimble/host/mesh/src/access.c | 3 +++
 1 file changed, 3 insertions(+)

commit d42c018ffb9a6f2cb4b51e7429fe4450a1b1c8e8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:49:15 2019 +0100

    mesh: Fix publish timer handling when sending fails
    
    Sending a model publication message could fail e.g. if there are no
    buffers available, however this doesn't mean that we should stop doing
    periodic publishing indefinitely. When an error occurs, make sure to
    call the publish_sent() function so that the periodic publishing timer
    gets resubmitted if necessary.

 nimble/host/mesh/include/mesh/main.h | 21 ++++++++++
 nimble/host/mesh/src/adv.c           |  5 +++
 nimble/host/mesh/src/cfg_srv.c       |  7 ++++
 nimble/host/mesh/src/foundation.h    |  1 +
 nimble/host/mesh/src/mesh.c          | 79 ++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/net.h           |  1 +
 6 files changed, 114 insertions(+)

commit c2c5cd4e9f0bfc1a439543ca7975d30a25cb19ff
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:45:59 2019 +0100

    mesh: Clean up net validity & provisioning state handling
    
    Tracking of the BT_MESH_VALID flag and the PB-GATT state was rather
    fragile. Add proper error returns to the various GATT service enable &
    disable handlers, and toggle the BT_MESH_VALID flag in a single file
    (main.c). Use the newly added error returns to ensure that we don't
    re-enable PB-GATT if it wasn't already enabled from before.

 nimble/host/mesh/src/mesh.c  | 17 +++++++++++++++--
 nimble/host/mesh/src/net.c   |  9 ++-------
 nimble/host/mesh/src/proxy.c | 32 ++++++++++++++++++++++++++++++++
 3 files changed, 49 insertions(+), 9 deletions(-)

commit 54286e1a490bb8ad6b4a7980f44de2ab686d59e4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:37:11 2019 +0100

    mesh: Convert bit-fields into flags
    
    There's already a flags member in the bt_mesh context, so take
    advantage of that for any boolean members that have so far been
    bit-fields. This should produce more efficient code, also for the
    sequence number that's now its own u32_t.

 nimble/host/mesh/src/atomic.h    | 23 +++++++++++++++++++++++
 nimble/host/mesh/src/beacon.c    | 11 ++++++-----
 nimble/host/mesh/src/lpn.c       |  5 +++--
 nimble/host/mesh/src/mesh.c      | 15 ++++++---------
 nimble/host/mesh/src/net.c       | 36 ++++++++++++++++++++----------------
 nimble/host/mesh/src/net.h       | 22 +++++++++++++---------
 nimble/host/mesh/src/settings.c  | 21 ++++++++++-----------
 nimble/host/mesh/src/transport.c |  6 +++---
 8 files changed, 84 insertions(+), 55 deletions(-)

commit 7879438e9959a28422d734876194db753c3ee640
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:15:35 2019 +0100

    mesh: Remove redundant stack variable
    
    The msg->prev_addr is already stored in frnd->clear.frnd, so there's
    no need to have an extra stack variable for this (in the form of
    prev_addr).

 nimble/host/mesh/src/friend.c | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

commit a25ef6092c32d3c85aba2e395c5ad2bc6257b15c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:14:24 2019 +0100

    mesh: Fixes existing friend lookup in Friend Request handling
    
    Currently, when handling a Friend Request message with `prev_addr` set,
    we look up existing friend entry using `prev_addr` as the address.
    However, `prev_addr` is the address of the requesting node's previous
    friend, NOT the address of the requesting node itself. Therefore, we
    should always look up existing friend entry using `rx->ctx.addr` as the
    address.

 nimble/host/mesh/src/friend.c | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

commit 0b1884638727bc3248dd28348f4dc571551d75ae
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:11:39 2019 +0100

    mesh: Fix typo leading to incorrect settings storage
    
    This was intended to be an equality comparison and not an assignment.

 nimble/host/mesh/src/settings.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9b77b4cfcddc302612637bfc294ad5b9fe64e0b0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 15:04:11 2019 +0100

    mesh: Add header file support for C++
    
    Add preprocessor directive for C++ compatibility.

 nimble/host/mesh/include/mesh/access.h     | 8 ++++++++
 nimble/host/mesh/include/mesh/cfg_cli.h    | 7 +++++++
 nimble/host/mesh/include/mesh/cfg_srv.h    | 7 +++++++
 nimble/host/mesh/include/mesh/glue.h       | 8 ++++++++
 nimble/host/mesh/include/mesh/health_cli.h | 8 ++++++++
 nimble/host/mesh/include/mesh/health_srv.h | 8 ++++++++
 nimble/host/mesh/include/mesh/main.h       | 8 ++++++++
 nimble/host/mesh/include/mesh/model_cli.h  | 8 ++++++++
 nimble/host/mesh/include/mesh/model_srv.h  | 8 ++++++++
 nimble/host/mesh/include/mesh/porting.h    | 8 ++++++++
 nimble/host/mesh/include/mesh/proxy.h      | 8 ++++++++
 11 files changed, 86 insertions(+)

commit 1630de1a67d9f2c824f363016f31236a7e37fe3f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:55:31 2019 +0100

    mesh: Fix matching for all elements of an LPN
    
    When we're acting as a Friend for an LPN, we need to consider all
    elements of the LPN. The information of how many elements the LPN has
    is provided in the Friend Request message, however until now the code
    did not do anything with this information.
    
    Fix the issue by tracking the number of elements for each LPN and
    update the unicast address matching code to take this into account.

 nimble/host/mesh/src/friend.c | 23 +++++++++++++++++------
 nimble/host/mesh/src/net.h    |  1 +
 2 files changed, 18 insertions(+), 6 deletions(-)

commit 1fef5a8e5a628b581010c2366df523660d08f304
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:53:35 2019 +0100

    mesh: Increase scan window from 10ms to 30ms
    
    Experiments have shown that the probability of missing advertising
    packets is significantly lower with 30ms scan window compared to 10ms
    scan window. This is especially the case with advertisers using a 20ms
    advertising interval, which in turn is perhaps the most common one
    since it's the smallest allowed by the Bluetooth 5.0 specification.

 nimble/host/mesh/src/adv.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 4df2f15b06c350a40eb3b6acb520e4fab54a75ed
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:50:20 2019 +0100

    mesh: Enforce proper compilation.
    
    The current method relies heavily on the linker/compiler to
    do the correct operation. Which is to eliminate the code that will
    never get called. This posses a problem if the build even changes
    by a smallest fraction.
    The current patch will enforce proper inclusion of the code at the
    pre-processing stage. Thereby not relying on the compiler/linker to
    do the right thing.

 nimble/host/mesh/src/prov.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4a2884b018974494268db19f73770985d0f26245
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:48:11 2019 +0100

    mesh: Fix incorrect reference to BT_SETTINGS
    
    The test for IS_ENABLED(BT_SETTINGS) in mod_reset()
    should be IS_ENABLED(CONFIG_BT_SETTINGS).

 nimble/host/mesh/include/mesh/glue.h | 1 -
 nimble/host/mesh/src/cfg_srv.c       | 2 +-
 2 files changed, 1 insertion(+), 2 deletions(-)

commit 0e18a150372d900ce01a88ab2cb64991a968395e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:45:51 2019 +0100

    mesh: Fix missing semicolon
    
    Fix a missing semicolon at the end of a statement.

 nimble/host/mesh/src/health_srv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2bcb0ddbf4d52267dd1be42bc8824dc2604faf7c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:45:00 2019 +0100

    mesh: Fix checking for subnet when recovering App Key
    
    The ordering of items in flash is not guaranteed, so it's possible we
    get an App Key before the corresponding Net Key. Remove the check for
    a Net Key, since the storing code should never store an App Key if
    there is no corresponding Net Key.

 nimble/host/mesh/src/settings.c | 7 -------
 1 file changed, 7 deletions(-)

commit 4f1dbf88d8dd92b8be86c6eff0d4d361c315ba56
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:35:41 2019 +0100

    mesh: Remove commented out lines

 nimble/host/mesh/src/prov.c  | 2 --
 nimble/host/mesh/src/proxy.c | 1 -
 2 files changed, 3 deletions(-)

commit 07f712cd7db5acf053064d3da3f5507ffaec5506
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:34:48 2019 +0100

    mesh: Move Device UUID log to bt_mesh_prov_enable()
    
    In some cases the application might only initialize its UUID after
    calling bt_mesh_init(), e.g. in the case of deriving the UUID from the
    identity address. To avoid confusing logs, only print the UUID when
    actually enabling one of the provisioing bearers.

 nimble/host/mesh/src/mesh.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 8799108df8cc07d18cfd853941a64499e2be89cc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 30 14:15:04 2019 +0100

    mesh/transport: Reformat SeqAuth calculation fix

 nimble/host/mesh/src/transport.c | 20 +++++++++++---------
 1 file changed, 11 insertions(+), 9 deletions(-)

commit 3b3b92bfbda1fbd9f6b106c7bd02f2acc19603e3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Oct 29 14:50:55 2018 +0100

    mesh: Add macros to encoded model publication periods
    
    These macros are helpful for using the configuration client API with
    periodic model publication.

 nimble/host/mesh/include/mesh/cfg_cli.h | 42 +++++++++++++++++++++++++++++++++
 1 file changed, 42 insertions(+)

commit 4e307a49847b61b2e67b39d4b883a10e1636b59a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Nov 28 10:33:42 2018 +0100

    mesh: Fix unused variable error when PB_ADV and PB_GATT disabled

 nimble/host/mesh/src/prov.c | 2 ++
 1 file changed, 2 insertions(+)

commit aebc46f61f173d6e0cf9ed19f3b277cc259fb596
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 31 17:12:22 2019 +0100

    porting/linux: Fix missing MYNEWT_VAL define
    
    Fixes a regression introduced in Nimble PR #315.

 porting/examples/linux/include/syscfg/syscfg.h | 4 ++++
 1 file changed, 4 insertions(+)

commit febac4a0db375498f390ce4f2b8364f993e8fd4d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 31 16:31:29 2019 +0100

    nimble/ll: Fix PHY update on symmetric PHY from slave
    
    If slave requested symmetric PHY on PHY change we should either change
    both directions to the same PHY or leave both unchanged.
    
    This fixes LL/CON/MAS/BV-117C.

 nimble/controller/src/ble_ll_ctrl.c | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit 4cfe3260ba3c4fbfbea9d0ec61ff76a0edc75bf4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 31 12:47:06 2019 +0100

    btshell: Add information to ongoing test-tx and test-tx stop

 apps/btshell/src/btshell.h |  1 +
 apps/btshell/src/cmd.c     | 13 +++++++++++++
 apps/btshell/src/main.c    | 13 +++++++++++++
 3 files changed, 27 insertions(+)

commit 3d5971076e7096eee01790a240b0c99c50922704
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 31 12:53:19 2019 +0100

    nimble/ll: Fix updating advertiser RPA on AUX_CONNECT_RSP
    
    In adv_addr there is an address we shall use and not to try to decoded it
    from rxbuf.
    This patch fixes that.
    
    This fixes HCI/CM/BV-04-C

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f6c641bef5b8856462eb8df2b5fdc5260c0c452a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 31 15:42:24 2019 +0100

    nimble/ll: Fix randomizing channel on sec phy
    
    We always use the same channel on secondary phy for all auxes in chain.
    This is not stritcly incorrect, but we should better randomize channel
    for each aux in chain which is what this patch does.

 nimble/controller/src/ble_ll_adv.c | 29 +++++++++++++++++------------
 1 file changed, 17 insertions(+), 12 deletions(-)

commit fe01942e9eadd3ce9b034d5ef8f9dfd853b64298
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 30 11:08:57 2019 +0100

    nimble/ll: Fix handling directed advertising with privacy
    
    Fix incorrect address comparision. advsm->peer_addr is the address
    provided via HCI, in the advertising packets we use advsm->initiator_addr
    which is either advsm->peer_addr or RPA.
    
    Without this patch it is not possible to connect to Nimble when it
    is using RPA in the directed advertising

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 24ff866c9ef7f2382ae770b7a0c0ad781bcf8723
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Jan 30 11:26:45 2019 +0100

    porting/riot: add MYNEWT_VAL_BLE_L2CAP_COC_MTU

 porting/npl/riot/include/syscfg/syscfg.h | 4 ++++
 1 file changed, 4 insertions(+)

commit 6c2848fcc65a7db83efb8796585925b6a02f26ae
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Jan 30 11:26:00 2019 +0100

    host/tests/l2cap_coc: use MYNEWT_VAL_L2CAP_COC_MTU

 nimble/host/test/src/ble_l2cap_test.c | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 4f855d00cd620f153d308c6e8a1d9486ef3c7119
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Jan 30 11:25:17 2019 +0100

    host/l2cap_coc: use global _COC_MTU config val

 nimble/host/src/ble_l2cap_coc.c      | 2 +-
 nimble/host/src/ble_l2cap_coc_priv.h | 1 -
 2 files changed, 1 insertion(+), 2 deletions(-)

commit 5889dcba8d7e17cbf971d05d2cf34c7c1788045c
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Jan 30 11:24:34 2019 +0100

    host/syscfg: introduce L2CAP_COC_MTU config value

 nimble/host/syscfg.yml | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 430516d540d773389d46f50ee627924b8ebad7c6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 29 19:05:57 2019 +0100

    nimble/ll: Fix procedure collision as a slave
    
    This patch fixes following scenarion
    1. Nimble as a Slave starts LL procedure "A"
    2. Master starts encryption procedure
    
    In such a case, nimble overrided cur_ctrl_proc with BLE_LL_CTRL_PROC_ENCRYPT
    which leads to restart procedure "A" once encryption has been done.

 nimble/controller/src/ble_ll_ctrl.c | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

commit 164a7906e0d3921d5b1bfe7c6e79b2231dbf7720
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 29 17:39:39 2019 +0100

    nimble/ll: Fix setting pending_ctrl_procs

 nimble/controller/src/ble_ll_conn_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 882c99caf76c13066d7c22b84bf4d91f4ecb72df
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jan 28 18:27:22 2019 +0100

    nimble/ll: Create helper to handle LL_FEATURE_RSP
    
    This is in order to be consistent with other commands.

 nimble/controller/src/ble_ll_ctrl.c | 46 ++++++++++++++++++++++++-------------
 1 file changed, 30 insertions(+), 16 deletions(-)

commit 9aeb603358fa7ba87245f64c1b83158a652a6f85
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jan 28 18:27:09 2019 +0100

    nimble/ll: Improve DLE update start as a slave
    
    Nimble when beeing slave initiate DLE once it gets LL_FEATURE_REQ, but
    it send it before responding to it. This patch makes sure that Nimble
    first sends LL_FEATURE_RSP and then start DLE.

 nimble/controller/src/ble_ll_ctrl.c | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)

commit 7d300b674462d6baa3398538b67f9be91766e2cc
Merge: 99226e8e 4af27601
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 29 10:38:44 2019 +0100

    Merge pull request #304 from sjanc/did
    
    nimble/ll: Make sure that new DID is different than old one

commit 99226e8e15a2d7583b52f63869dab0e833eac789
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jan 28 11:22:55 2019 +0100

    apps/btshell: Improve test-tx command
    
    Change 'handle' parameter to 'conn' and set default
    values for some parameters.

 apps/btshell/src/btshell.h |  2 +-
 apps/btshell/src/cmd.c     | 24 ++++++++++++------------
 apps/btshell/src/main.c    | 11 ++++++-----
 3 files changed, 19 insertions(+), 18 deletions(-)

commit a95cfa6dfff485d1531531a34837dbac512c4bd7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 24 18:06:10 2019 +0100

    apps/btshell: Print key size with connection description

 apps/btshell/src/misc.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 929dff4471f99f0bea759e3fe21b53ba61d40f04
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 24 01:02:52 2019 +0100

    apps/btshell: Fix typo in parameter name for white-list command

 apps/btshell/src/cmd.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 997131ba972ea3aa32d2566f9b19bf755d661a03
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jan 21 17:47:56 2019 +0100

    host: Print CCCD in local database

 nimble/host/src/ble_gatts_lcl.c | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

commit 0f35e1b1a20e1d41cb8e79391d5af713fa51ed85
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 23 22:04:20 2019 +0100

    nimble/ll: Fix update advertising data while advertising
    
    With this patch we make sure that if advertising or scan data has been
    changed just after advertising event had been completed, new data will
    be used in next advertising event.
    
    Note: For this moment we will skip one advertising event in order to
    recalculate timings for aux packet, but this could be improved in the
    future.

 nimble/controller/src/ble_ll_adv.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 060239348358960027063b001751645dcfff5c12
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 25 00:39:41 2019 +0100

    btshell: Fix controller reset on test-tx command
    
    This patch fixes test-tx command which was ending with controller
    reset because data were send omiting bhc_outstanding_pkts needed for
    correct handling number of completed packets.

 apps/btshell/src/main.c | 44 +++++++++++++++++++++++---------------------
 1 file changed, 23 insertions(+), 21 deletions(-)

commit 05c45c1318cb74c3d690d238a42f7408aa80b51a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jan 14 23:48:48 2019 +0100

    nimble/hw: Remove reading public address fom UICR
    
    If public address was not present in FICR there was fallback to try to
    read this address from UICR. However, how address is stored in UICR is
    not standarized anywhere so it's just a vendor decision how and where
    to put it. In worst case this may read some other data from UICR and
    use them as public address in case vendor is not aware of this behavior.
    
    To avoid such problems, let's remove this fallback code. If needed,
    public address can now be read from virtually anywhere (also UICR) and
    set using new API: ble_ll_set_public_addr(). This should be done in
    e.g. BSP code and it's up to vendor.

 nimble/drivers/nrf51/src/ble_hw.c | 30 +++++++-----------------------
 nimble/drivers/nrf52/src/ble_hw.c | 29 +++++++++--------------------
 2 files changed, 16 insertions(+), 43 deletions(-)

commit 6ab40a1eb165d8d93201f75682d3700762abc5d5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jan 14 23:36:34 2019 +0100

    nimble/ll: Add API to set controller public address
    
    ble_ll_set_public_addr() can be used to set controller public address.
    This API can be called in e.g. hal_bsp_init() to set public address
    loaded from some vendor specific location. Address set in this way will
    take precedence over address configured in syscfg or stored in HW.
    
    NOTE: This is *NOT* intended to be used to modify public address on
    already running device. Using it for such purpose may yield unknown
    results.

 nimble/controller/include/controller/ble_ll.h |  9 ++++++++
 nimble/controller/src/ble_ll.c                | 33 +++++++++++++++++++--------
 2 files changed, 33 insertions(+), 9 deletions(-)

commit ab8bc74f92f71d79a3ae81687e0cbc37b681b567
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 22 12:41:29 2019 -0800

    nimble/ll: Fix access address computation
    
    Core 5.0, Vol 6, Part B, section 2.1.2:
        The Access Address shall be a 32-bit value. Each time it needs a
        new Access Address, the Link Layer shall generate a new random value
        that meets the following requirements:
          (...)
          * It shall have a minimum of two transitions in the most
            significant six bits.
    
    Current implementation of the above only checks if there are no
    transitions in 6 msb so it can create invalid access address.
    
    Transitions can be easily calculated using xor with the same value
    shifted - the result will have '1' at each position with transition so
    then it's just a matter of counting them.

 nimble/controller/src/ble_ll_conn.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit e3b9d73db0c9d2c8efd47d0d5eaea9c6673752e7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jan 23 17:58:13 2019 -0800

    nimble/host: Restore key size for LTK
    
    When LTK is restored successfully we also need to update key size for
    proc with proper value as otherwise we default to 0 which means that
    e.g. any characteristic which requires proper key size for read/write
    cannot be accessed.

 nimble/host/src/ble_sm.c | 1 +
 1 file changed, 1 insertion(+)

commit b97f1dc40d135b9f39ee855ff3e8166e58441d10
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 24 00:44:39 2019 +0100

    apps/btshell: Fix typos on l2cap_create_server

 apps/btshell/src/cmd_l2cap.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit e03c13e0e9267e5ccb8f6cb75cd130825dff0639
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 24 00:40:57 2019 +0100

    l2cap: Fix channel creation
    
    Previously the channel was added to the channels list after sending
    COC Accept event to the application. The application called
    ble_l2cap_coc_recv_ready which was trying to find channel on a list,
    but failed. With this patch the channel is added on a list before sending
    Accept event, and if the application returns an error, the channel is removed
    from the list. Moreover if we fail to send Connection Success, the application
    should now not receive a confirmation that we are connected.

 nimble/host/src/ble_l2cap_sig.c | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

commit 4af2760127694ef440d30e079abb5efc9723dd4c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 23 23:45:22 2019 +0100

    nimble/ll: Make sure that new DID is different than old one
    
    Whenever the Host provides new advertising data or scan response data
    for a given advertising set (whether it is the same as the previous
    data or not), the Advertising DID shall be updated. The new value shall
    be a randomly chosen value that is not the same as the previously used
    value.
    
    Signed-off-by: Szymon Janc <szymon.janc@codecoup.pl>

 nimble/controller/src/ble_ll_adv.c | 28 ++++++++++++++++++++++++----
 1 file changed, 24 insertions(+), 4 deletions(-)

commit 0f7ca647de8dc71ac1881aba4f2dbc66327e0e78
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 22 12:45:39 2019 -0800

    nimble/host: Fix field type for TX Power in HCI event struct
    
    TX Power is a signed value (same as RSSI).

 nimble/include/nimble/hci_common.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9efd0e90020e0f45e12c5e5603400f3772a7ca5c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 22 12:45:19 2019 -0800

    nimble/host: Fix field type for TX Power in GAP event struct
    
    TX Power is a signed value (same as RSSI).

 nimble/host/include/host/ble_gap.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6a93c415c2f58988d16fb08c35af471693add381
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 16 20:11:59 2019 +0100

    nimble/ll: Fix encryption pause
    
    Patch: 479eceb5 nimble/ll: Fix handling LL_PAUSE_ENC_REQ
    was incorrect because the intention was to handle LL_PAUSE_ENC_RSP as a
    slave there. This patch fixes this but if moves handling it into
    ble_ll_ctrl.c.
    
    This fix regression on LL/SEC/SLA/BV-02-C

 nimble/controller/src/ble_ll_conn.c | 6 ------
 nimble/controller/src/ble_ll_ctrl.c | 6 ++++++
 2 files changed, 6 insertions(+), 6 deletions(-)

commit ac5752cc192c10f7d18bf1ce1b72792c336e82bb
Merge: 1049b46f f769e422
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jan 17 18:38:44 2019 +0100

    Merge pull request #297 from sjanc/rxtx_comp
    
    support for RX/TX power RF path compensation

commit 1049b46f82aa894dedaf33900096c84b23eb46d7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 16 23:05:59 2019 +0100

    nimble/ll: Fix rescheduling connection
    
    Checking ble_ll_conn_is_lru() makes sense only for the
    BLE_LL_SCHED_TYPE_CONN entry

 nimble/controller/src/ble_ll_sched.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit 9c4b82c69b74e45a32ec0105c8463c8eecd1be4d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 16 22:07:15 2019 +0100

    nimble/l2cap: Minor typo fix

 nimble/host/src/ble_l2cap_coc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6dd6a5eaaf4c462bd809fd83562c3db9004e06ae
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 16 22:06:37 2019 +0100

    btshell: Check error code from ble_l2cap_recv_ready

 apps/btshell/src/main.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 76ce38e54d8e752821d78720dc87a4742b15a259
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 16 22:05:42 2019 +0100

    nimble/l2cap: Add error return to ble_l2cap_recv_ready

 nimble/host/include/host/ble_l2cap.h |  2 +-
 nimble/host/src/ble_l2cap.c          |  4 ++--
 nimble/host/src/ble_l2cap_coc.c      | 10 ++++++++--
 nimble/host/src/ble_l2cap_coc_priv.h |  6 +++---
 4 files changed, 14 insertions(+), 8 deletions(-)

commit f769e422e5af9c21c131d572485b675030473323
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 16 20:09:26 2019 +0100

    nimble/ll: Add support for RX/TX power with RF path compensation
    
    This allows host to compensate RX/TX power on RF path. This was
    affecting following qualification test cases:
    LL/DDI/ADV/BV-34-C
    HCI/CCO/BV-18-C
    HCI/CCO/BV-19-C
    HCI/CCO/BV-20-C

 nimble/controller/include/controller/ble_ll_hci.h |  3 +
 nimble/controller/include/controller/ble_phy.h    |  3 +
 nimble/controller/src/ble_ll_adv.c                |  4 +-
 nimble/controller/src/ble_ll_hci.c                | 74 +++++++++++++++++++++++
 nimble/controller/src/ble_ll_supp_cmd.c           |  6 +-
 nimble/drivers/native/src/ble_phy.c               | 12 +++-
 nimble/drivers/nrf51/src/ble_phy.c                | 12 +++-
 nimble/drivers/nrf52/src/ble_phy.c                | 12 +++-
 8 files changed, 118 insertions(+), 8 deletions(-)

commit 822e6b8db32a9897e160625c99f2af85f42975a2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 16 19:31:05 2019 +0100

    nimble/ll: Fix power value rounding for nRF52

 nimble/drivers/nrf52/src/ble_phy.c | 51 ++++++++++++++++++++++----------------
 1 file changed, 30 insertions(+), 21 deletions(-)

commit b823639c5faf51342387adf86fecbba6ed831124
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 16 19:24:44 2019 +0100

    nimble/ll: Remove leftover ble_phy_rssi_get declaration

 nimble/controller/include/controller/ble_phy.h | 3 ---
 1 file changed, 3 deletions(-)

commit 66850c85fa5d84216a36bbec7d4192250bd9a95c
Author: freddie <freddie.yang@139.com>
Date:   Sat Jan 12 12:00:03 2019 +0800

    mesh/proxy: Fix connection handle when disconnected

 nimble/host/mesh/src/proxy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0f3e7fa06fcbda468524db6f7142f5da29466a8b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 15 02:59:21 2019 +0100

    nimble/ll: Set BLE_LL_FEAT_DATA_LEN_EXT as initial feature
    
    We use it in case when Master does not initiate feature exchange.
    Note: When remote does not support it, then this bit will be cleared
    when handling LL_UNKNOWN_RSP.
    
    It fixes LL/CON/SLA/BV-79-C

 nimble/controller/include/controller/ble_ll.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 479eceb55d8be6d31c1a1a9a27d1511f0d6ab014
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 15 01:00:48 2019 +0100

    nimble/ll: Fix handling LL_PAUSE_ENC_REQ
    
    Nimble incorretly was trying to handle LL_PAUSE_ENC_RSP in a Slave role.
    This patch fixes it.
    
    This fixes LL/PAC/SLA/BI-01-C

 nimble/controller/src/ble_ll_conn.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 280f85d8635a69887ae1763fcde1a008248914f2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 15 00:38:24 2019 +0100

    nimble/ll: Set local RPA per peer device
    
    When remote connects to Nimble and uses RPA we should make sure to store
    this RPA in case HOST would like to read it.
    
    It fixes LL/CM/BV-02

 nimble/controller/include/controller/ble_ll_resolv.h |  1 +
 nimble/controller/src/ble_ll_conn.c                  |  8 +++++++-
 nimble/controller/src/ble_ll_resolv.c                | 12 ++++++++++++
 3 files changed, 20 insertions(+), 1 deletion(-)

commit d4f9bad8f1da62956d7679905bac54f69c2bb4ce
Merge: 44f1a188 b50139c4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 15 00:15:03 2019 +0100

    Merge pull request #292 from sjanc/blehci
    
    apps/blehci: Fix build

commit b50139c47cf2f62e6a1160b38b14460a56b0deee
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 15 00:04:50 2019 +0100

    apps/blehci: Fix build

 apps/blehci/pkg.yml | 1 +
 1 file changed, 1 insertion(+)

commit 44f1a188d98fbbd15ea2709dd287b1604ee7fca2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 9 16:40:12 2019 +0100

    host: Fix conn find by RPA address
    
    When argument address is RPA then compare with peer rpa address field.

 nimble/host/src/ble_hs_conn.c | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit bed211f69c383c01a38a505155f9bac4251fccc7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 9 16:54:39 2019 +0100

    host: Send Identity Resolved Event only when RPA was used

 nimble/host/src/ble_sm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit d442270f5e3e8e7b736215bef83740bb41173371
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 9 16:51:07 2019 +0100

    host: Fix setting conn's peer RPA address in SM
    
    Change introduced in previous commit already
    stores a peer RPA address in proper field inside
    connection structure, so we can update the condition to
    use peer_rpa_addr field to check if address was resolved.

 nimble/host/src/ble_sm.c | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

commit f0a74de7a9962a07758666800b8b16a3d7d101e5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 9 16:39:04 2019 +0100

    host: Fix setting peer RPA address on connection complete
    
    If peer RPA is not set in the event and peer address
    is RPA then store the peer RPA address so when the peer
    address is resolved, the RPA is not forgotten.

 nimble/host/src/ble_gap.c | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit c8a6bc66e017f5585f6ef4c718c945b6168d3f02
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 2 15:15:44 2019 +0100

    host: Make ble_gatts_clt_cfg_access non-static
    
    This is needed to read cccd value from bttester app.

 nimble/host/src/ble_gatt_priv.h | 3 +++
 nimble/host/src/ble_gatts.c     | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

commit 79d4d26b2e61abd7952af49d52327aadacf846da
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Dec 17 15:37:50 2018 +0100

    host/gatts: Show local included services

 nimble/host/src/ble_gatts_lcl.c | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit 38ac67f97aa164ec801336dfd9688f9a8fe9962d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 16 12:32:55 2018 +0100

    host/gatt: Add optional argument when iterating over local database

 nimble/host/include/host/ble_gatt.h | 3 ++-
 nimble/host/src/ble_gatt_priv.h     | 2 +-
 nimble/host/src/ble_gatts.c         | 4 ++--
 nimble/host/src/ble_gatts_lcl.c     | 5 +++--
 4 files changed, 8 insertions(+), 6 deletions(-)

commit 291d1b4b626a91828893e1b499085428966c5dc4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 11 13:26:59 2019 +0100

    nimble/ll: Fix address types in the advertising report
    
    This patch makes sure that corret address type is used in the
    advertising report when RPA addresses has been used over the air.
    
    This fixes LL/DDI/SCN/BV-33-C

 nimble/controller/src/ble_ll_scan.c | 41 ++++++++++++++++++++++++++++---------
 nimble/include/nimble/ble.h         |  4 ++++
 2 files changed, 35 insertions(+), 10 deletions(-)

commit 41362a4c717c0b00cca190b4545bbf8c5607022a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 11 11:26:05 2019 +0100

    nimble/ll: Cleaning patch in ext scanning
    
    This patch does not change any functionality, just make uses of macros
    to SET/CLEAR/CHECK flags in aux_data pointer

 nimble/controller/include/controller/ble_ll_scan.h |  6 +--
 nimble/controller/src/ble_ll_scan.c                | 52 +++++++++++-----------
 2 files changed, 29 insertions(+), 29 deletions(-)

commit 468bb994319efa1b9c6b66b65229b02344ab27f2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 11 11:08:48 2019 +0100

    nimble/ll: Minor coding style fix

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5ace22629d5ab0961019db4586f87b0ae2c3c3cd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 11 10:46:06 2019 +0100

    nimble/ll: Fix extended chaining scanning
    
    This patch fix scanning for the advertising events where
    last chain packet has extended header len 0

 nimble/controller/include/controller/ble_ll_scan.h |   1 +
 nimble/controller/src/ble_ll_scan.c                | 101 ++++++++++++---------
 2 files changed, 59 insertions(+), 43 deletions(-)

commit eb19fd1bc45062543a1114dc445b8440716fa661
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 10 13:15:01 2019 +0100

    nimble/ll: Minor fix
    
    Use current_aux instead of ble_hdr->rxinfo.user_data for better readability

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8469d0bf1e29ac0627f729a77cdb3b55da20c766
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 10 13:12:44 2019 +0100

    nimble/ll: Remove some trash comment

 nimble/controller/src/ble_ll_scan.c | 1 -
 1 file changed, 1 deletion(-)

commit f10b0487f9a8e7278dad7ab6e8fe897d0ace4270
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 10 12:25:19 2019 +0100

    nimble/ll: Improve extended scanner to report truncated report
    
    If Nimble was scheduled for aux packet but it received something else,
    make sure to send report with Truncated status.

 nimble/controller/src/ble_ll_scan.c | 26 ++++++++++++++++++++++----
 1 file changed, 22 insertions(+), 4 deletions(-)

commit 4e39d07b5456ed0663f7e61de4ffe34e872b82e1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Dec 17 16:27:45 2018 +0100

    mesh: Remove unused define

 nimble/host/mesh/include/mesh/glue.h | 1 -
 1 file changed, 1 deletion(-)

commit 5061deb4a55b1ac2f5939fe61f60d0629a42d1e1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 20 11:17:59 2018 +0100

    mesh: Cast 32bit values to ensure proper formatting

 nimble/host/mesh/src/access.c    | 13 +++++++------
 nimble/host/mesh/src/adv.c       |  2 +-
 nimble/host/mesh/src/beacon.c    |  6 +++---
 nimble/host/mesh/src/cfg_cli.c   |  2 +-
 nimble/host/mesh/src/cfg_srv.c   |  4 ++--
 nimble/host/mesh/src/crypto.c    | 16 +++++++++-------
 nimble/host/mesh/src/friend.c    | 19 +++++++++++--------
 nimble/host/mesh/src/lpn.c       |  6 +++---
 nimble/host/mesh/src/mesh.c      |  2 +-
 nimble/host/mesh/src/net.c       | 16 ++++++++++------
 nimble/host/mesh/src/prov.c      |  6 +++---
 nimble/host/mesh/src/proxy.c     |  5 +++--
 nimble/host/mesh/src/settings.c  | 14 ++++++++------
 nimble/host/mesh/src/transport.c | 19 ++++++++++++-------
 14 files changed, 74 insertions(+), 56 deletions(-)

commit 8632b079b69659e69b2f6afc0b8ebc8b96572de9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 20 11:16:19 2018 +0100

    mesh: Add lpn and rpl testing commands

 nimble/host/mesh/include/mesh/testing.h | 30 ++++++++++++++++++++++++++++++
 nimble/host/mesh/src/testing.c          | 23 +++++++++++++++++++++++
 2 files changed, 53 insertions(+)

commit 9e981f09912d073a1f19f5ca6b8ae1fe642d4928
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 10 14:20:50 2019 +0100

    mesh: Fix initializing connection handle for PB GATT
    
    Commit bf1ff83361edd5494637cac69b61a6bb228f9870 introduced a regression
    due to not initialized conn handle. Provisioning code would use
    GATT bearer even though there was no active connection.

 nimble/host/mesh/src/prov.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 4f368e644707ae9d90d546adf613cb2fe106d990
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Dec 21 11:42:55 2018 +0100

    nimble/host: Stop ble_hs_timer on startup only in unit tests
    
    ble_hs_start() tries to stop ble_hs_timer before init to make it work in
    unit tests which can call ble_hs_start() multiple times. Without this
    extra stop call, callouts list will be corrupted when init is called on
    a callout which is already queued.
    
    There's no easy way to fix unit tests since it's not quite possible to
    guarantee that each test case calls ble_hs_start() only once without
    refactoring some of them. To provide a quick fix for this, let's just
    call extra stop only for unit tests.
    
    This fixes issue with some NPL implementations which need to allocate
    some resources for callout on init and thus calling stop before init is
    not safe (like in Mynewt) and we do not really want to workaround this
    in NPL by adding checks everywhere.

 nimble/host/src/ble_hs.c | 2 ++
 1 file changed, 2 insertions(+)

commit 6b7fe252c94de084dbc05a77306dccd13b351dcb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Dec 11 21:59:58 2018 +0100

    nimble/ll: Add support to filter duplicates in ext advertising

 nimble/controller/src/ble_ll_scan.c | 90 +++++++++++++++++++++++++++----------
 1 file changed, 67 insertions(+), 23 deletions(-)

commit f6f2ce43d244aa86fa602c059f9c0c1e315c0720
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 4 17:08:39 2019 +0100

    nimble/ll: Fix InitA type when resolved

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 62621ab54ceef7f812434813c6004b07c8a5ac5d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 4 17:00:25 2019 +0100

    nimble/ll: Fix extended scan active for directed advertising
    
    In advertising extentions it is possible to have directed scannable
    advertising. This patch makes sure that Nimble sends AUX_SCAN_REQ only
    when directed advertising is for him.

 nimble/controller/src/ble_ll_scan.c | 55 ++++++++++++++++++++++++++++++-------
 1 file changed, 45 insertions(+), 10 deletions(-)

commit b25cbd4c2eaea611dba715122ed526b7f5238f16
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 3 12:14:03 2019 +0100

    nimble/ll: Improve data packing in extended advertising report
    
    Without this patch, even having buffer of 257 octets for the HCI event, Nimble was
    sending 253 octets of data plus 2 octets of header.
    This patch fixes it.

 nimble/controller/src/ble_ll_scan.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 8ec1aa01dfd47350f778c6041214b159210267c9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 3 12:10:45 2019 +0100

    nimble/ll: Fix legacy extended directed advertising event length
    
    Directed address is already within `struct ble_ll_ext_adv_report' so
    there is no need to increase `evt->event_len`

 nimble/controller/src/ble_ll_scan.c | 1 -
 1 file changed, 1 deletion(-)

commit 4213e93c0c4d76618fce344cc2d7ab85a2f09fa4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 3 12:00:33 2019 +0100

    nimble/ll: Fix extended advertising report event length
    
    `struct ble_ll_ext_adv_report` contains event meta code and event
    length (HCI event header) which shall not be calculated into event length.
    This patch fixes it.

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 0c37b30ac217ed41a657baf2e60b121197a5aae8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 3 11:55:53 2019 +0100

    nimble/ll: Remove reduntant comment
    
    This should go away already with following patch:
    
    commit 21f7dc82be5ff535708fcce70acd33ee6a5b2bed
    Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
    Date:   Tue Oct 9 13:36:21 2018 +0200
    
        nimble/ll: Fix InitA address type in the advertising report

 nimble/controller/src/ble_ll_scan.c | 1 -
 1 file changed, 1 deletion(-)

commit bf1ff83361edd5494637cac69b61a6bb228f9870
Author: Sagar Bijwe <sagar@espressif.com>
Date:   Wed Nov 28 14:37:55 2018 +0530

    mesh: Fix for handling conn_handle == 0
    
    As per Bluetooth specification, connection handle can have value in the
    range 0x000-0xEFF. So 0 can actually be a valid handle for a connection.
    This change fixes the mesh code to not consider 0 as invalid handle.

 nimble/host/mesh/src/prov.c  |  8 +++++---
 nimble/host/mesh/src/proxy.c | 14 ++++++++------
 2 files changed, 13 insertions(+), 9 deletions(-)

commit bd346f6da279594d7b94ffb144ebb0e8ea6dd3d0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Dec 20 11:47:14 2018 +0100

    nimble/unittest: Adjust unittest for handling conn update parameters
    
    Nimble changed the way of handling connection update parameter which
    requires adjusting of unit tests. The main change is that from now on Nimble
    will not timeout when it receive response on
    L2CAP Connection Parameter Update Request at it is considered as the end of the
    procedure from the Host point of view.

 nimble/host/test/src/ble_gap_test.c | 60 +++++++++++++++++++++----------------
 1 file changed, 34 insertions(+), 26 deletions(-)

commit 77a9782c25b90fafeff2c9b7c8bf597c8f742b64
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 14 18:46:53 2018 +0100

    nimble/gap: Remove gap update procedure entry on L2CAP response
    
    Whenever L2CAP connection parameter update response is received
    it is OK to remove procedure entry at all which also stops the timer for
    the procedure.
    
    In case parameters were not accepted by peer it is clear as Nimble
    just sends no success notification to the application and there is
    nothing to do.
    
    In case parameters has been accepted by peer, Nimble can remove procedure
    entry which stops the timer, because now it is controller job to notify
    host about updated parameters. Host cannot do nothing more about it.

 nimble/host/src/ble_gap.c | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

commit 7f3b525e175000309b621329c620267f239e7f48
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 14 18:45:23 2018 +0100

    nimble/gap: Reset GAP UPDATE timeout on fallback to L2CAP
    
    In case LL Update failed but took already some time, make sure we give
    more time for the connection update procedure over L2CAP

 nimble/host/src/ble_gap.c | 2 ++
 1 file changed, 2 insertions(+)

commit 9f5637e15c2eefa2450c9cfa1013d041fdad3923
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 14 18:38:28 2018 +0100

    nimble/gap: Increase GAP update timeout
    
    We want to make it longer just to make sure that peer device has time to
    reply (LL_RESPONSE_TIMEOUT is 40 sec)

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 86e128baeb39431e2e1dbd7d3b4d936a430caa52
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 21 14:42:32 2018 +0100

    nimble/ll: Add support to advertise anonymously

 nimble/controller/src/ble_ll_adv.c | 56 ++++++++++++++++++++++++--------------
 1 file changed, 36 insertions(+), 20 deletions(-)

commit 1a535e8a56b87cb20e9558e7aac9fd661bb0a722
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 21 14:14:19 2018 +0100

    nimble/ll: Fix directed extended advertising
    
    This patch makes sure TargetA is added only to scannable AUX_ADV_IND
    and not later to AUX_SCAN_RSP and chains.

 nimble/controller/src/ble_ll_adv.c | 28 ++++++++++++++++++++++++----
 1 file changed, 24 insertions(+), 4 deletions(-)

commit 146e1af0f7299ca07cdc548495125f82ce7cc8e0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Dec 20 14:10:31 2018 +0100

    nimble/gap: Minor error code fix and enhance the comment

 nimble/host/src/ble_gap.c | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

commit 821afe6d80b14796696f06ea543e5e85cbba1b64
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Dec 20 14:06:26 2018 +0100

    nimble/ll: Fix handling adv data and scan rsp data update while advertising
    
    If controller is busy with long data advertising, we will get issues
    when setting new data while controller is in the middle of advertising
    event.
    
    This patch fixes that. This shall also fixed LL/DDI/ADV/BV-27-C

 nimble/controller/src/ble_ll_adv.c | 106 ++++++++++++++++++++++++++++++++-----
 1 file changed, 92 insertions(+), 14 deletions(-)

commit 898f2779e666cd837acb82e1896b1bb81d9a338a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 21 10:09:47 2018 +0100

    btshell: Print CCCDs with keystore-show command

 apps/btshell/src/cmd.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 31b25f03830c1622b44215add99361afe2499fcf
Merge: 9f7dc47a 3bf79c68
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Dec 20 14:27:34 2018 +0100

    Merge pull request #274 from dhrishi/fix_typos
    
    nimble/doc: Fix minor typos

commit 9f7dc47a9748e78b89e755bb7581c3572d50890c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Dec 19 22:09:03 2018 +0100

    nimble/ll: Coding style fix

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 34bb0af41d3d234f43418eeda6b64cd480398a04
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Dec 19 15:34:38 2018 +0100

    nimble/ll: Fix handling TERMINATE_IND as a Master
    
    When slave sends TERMINATE_IND and MD flag is set to 0, Nimble needs to
    wait to next connection event to send Empty Packet to ACK this
    TERMINATE_IND.
    At the moment Nimble corretly checks MD flag but stop scheduling
    connection event which leads to un acked TERMINATE_IND.
    
    This patch fixes that.
    
    This shall fix LL/CON/INI/BV-06-C

 nimble/controller/include/controller/ble_ll_conn.h | 1 +
 nimble/controller/src/ble_ll_conn.c                | 6 +++++-
 2 files changed, 6 insertions(+), 1 deletion(-)

commit d5dbea9d5113d6fb18c455d90e7be1e434b39228
Author: Prasad Alatkar <prasad.alatkar@espressif.com>
Date:   Thu Nov 29 17:15:08 2018 +0530

       blehr: Fix state notifications
       Use conn_handle in ble_gattc_notify_custom() instead of incorrect notify_state

 apps/blehr/src/main.c | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit 3bf79c68dcf4d155f821a29bc46b60284aa90f28
Author: Hrishikesh Dhayagude <hrishi@espressif.com>
Date:   Tue Dec 18 22:08:02 2018 +0530

    nimble/doc: Fix minor typos

 README.md                              | 4 ++--
 RELEASE_NOTES.md                       | 2 +-
 nimble/host/include/host/ble_att.h     | 8 ++++----
 nimble/host/include/host/ble_gap.h     | 4 ++--
 nimble/host/include/host/ble_gatt.h    | 2 +-
 nimble/host/include/host/ble_hs_mbuf.h | 2 +-
 nimble/host/include/host/ble_store.h   | 4 ++--
 7 files changed, 13 insertions(+), 13 deletions(-)

commit a1bfe3a6ae4adabbac9c9da7de8c7966569ae6dd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Dec 12 16:51:36 2018 +0100

    apps/blemesh: Fix Vendor Model opcode
    
    Previously Vendor Model used Generic OnOff opcodes. According
    to the spec, vendor models should use 3-octet opcodes.
    
    Mesh Profile Specification, Section 2.3.3:
    "An opcode may be a single octet (for special messages that require maximum
    possible payload for parameters), 2 octets (for standard messages), or 3 octets
    (for vendor-specific messages)."
    
    This patch fixes that, by defining vendor specific opcode
    and adds a callback, that reads the received message
    and sends it back to the source.

 apps/blemesh/src/main.c | 32 ++++++++++++++++++++++++++++++--
 1 file changed, 30 insertions(+), 2 deletions(-)

commit c3d6fcbd8bb99bbdd9e11487acd8d76563da6b05
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Dec 11 14:30:23 2018 +0100

    nimble/host: Fix crash in ble_monitor when packets are not consumed
    
    Move ble_monitor_init() after the hs_evq is set. Otherwise callout within
    ble_monitor, which is used for droping packets mechanism is NULL.
    This of course leads to assert when callout fires.

 nimble/host/src/ble_hs.c | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

commit 05394fd148345d8a15f0798adba7431fc14c41ca
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Dec 5 11:04:18 2018 +0100

    nimble/ll: Do not send SCAN REQ to already scanned ext advertising

 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll_scan.c                | 80 ++++++++++++++++++++--
 2 files changed, 74 insertions(+), 7 deletions(-)

commit f0e85818f503f6fc680949721e35dc31b8ea0d4f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Dec 5 10:57:02 2018 +0100

    nimble/ll: Fix RPA address in the LE Enhanced Connection Complete
    
    It solves following issue:
    
    Scenario:
    1. Nimble has peer device in the resolving list.
    2. Peer device is in Device Privacy Mode
    3. Peer device is using its RPA and our identity address as InitA in
    directed advertising on which Nimble send Connect Ind with its identity address
    
    Issue:
    Nimble incorretly set Local RPA address in the LE Enhanced Connect Completed event.
    
    This should fix: LL/CON/INI/BV-10-C and LL/CON/INI/BV-21-C

 nimble/controller/include/controller/ble_ll_conn.h | 6 ++++++
 nimble/controller/src/ble_ll_conn.c                | 6 ++++++
 nimble/controller/src/ble_ll_conn_hci.c            | 8 +++++++-
 3 files changed, 19 insertions(+), 1 deletion(-)

commit ad9914ed4952ffa34f7bd681cf6176b4aec0d1f4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 30 16:06:38 2018 +0100

    nimble/ll: Fix Connect Ind send on directed advertising
    
    It solves following issue:
    
    Scenario:
    1. Nimble has peer device in the resolving list.
    2. Peer device is in Device Privacy Mode
    3. Peer device is using its RPA and our identity address as InitA in
    directed advertising
    
    Issue:
    Nimble send Connect Ind with its RPA instead of InitA
    
    This should fix: LL/CON/INI/BV-10-C and LL/CON/INI/BV-21-C

 nimble/controller/src/ble_ll_conn.c | 78 ++++++++++++++++++++++---------------
 1 file changed, 47 insertions(+), 31 deletions(-)

commit eb6cdbc35a41ab457be29d137594f910aa09ab61
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 30 15:26:30 2018 +0100

    nimble/ll: Fix handling LL_PHY_UPDATE_IND as a master
    
    We should response with LL_UNKNOWN_RSP
    
    This should fix LL/PAC/MAS/BV-01

 nimble/controller/src/ble_ll_ctrl.c | 108 +++++++++++++++++++-----------------
 1 file changed, 57 insertions(+), 51 deletions(-)

commit d4393d8e68fa3bd49b6cb5326ca91b462ca0933a
Author: Hrishikesh Dhayagude <hrishi@espressif.com>
Date:   Fri Nov 30 19:04:30 2018 +0530

    nimble/gatt: Fix the issue of removing multiple procs having same opcode
    
    If two or more requests with same opcode are sent
    (for e.g. Write and Enable/Disable notify), the requests go through and
    responses are received. Although, the responses for all the requests
    except for the first one are not sent above to the app (or upper
    layers)
    This is because, currently ble_gattc_extract_first_by_conn_op() extracts
    all the matching procs and then they are removed from the list. Ideally,
    it should extract the first matching proc (as its name suggests).
    
    This patch modifies ble_gattc_extract_by_conn_op() which is used from
    ble_gattc_extract_first_by_conn_op() to accept max_procs and extract the
    appropriate number of procs, as required.

 nimble/host/src/ble_gattc.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 0644723fa7195b0a40c254da9ee5295d45694c7d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Dec 6 08:13:13 2018 +0100

    nimble/ll: Fix regression on legacy connect
    
    Without this patch we will get assert on legacy connect

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 859cb352c6f26d4a9c558f2cf63e36864bd8838e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 9 10:26:39 2018 +0100

    nimble/ll: Improve handling truncated advertising events
    
    This patch make sure that each truncated advertising event is corretly
    sent to host

 nimble/controller/include/controller/ble_ll_scan.h |   2 +
 nimble/controller/src/ble_ll_scan.c                | 173 ++++++++++++++++-----
 nimble/controller/src/ble_ll_sched.c               |   5 +-
 3 files changed, 136 insertions(+), 44 deletions(-)

commit 2df0d01fe354ef289d4eb2857e8dbe6b5a1859f4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Nov 8 12:25:00 2018 +0100

    nimble/ll: Extended scanner - add ref count for aux data
    
    This patch improves scanner by adding ref counter for outstanding
    aux_data. With this we want to make sure aux_data is not freed e.g. when
    being handover to LL and in the same time processed in the interrupt in
    chaining scenario
    
    General idea is that 1 reference is kept as long as event is not
    completed (note: truncated is also completed) and other references are
    use when:
     - aux is scheduled
     - report is sending to the host
     - scan request has been sent
     - when packet is handover to LL

 nimble/controller/include/controller/ble_ll_scan.h |   5 +-
 .../controller/include/controller/ble_ll_trace.h   |   2 +
 nimble/controller/src/ble_ll_conn.c                |  56 +++++--
 nimble/controller/src/ble_ll_scan.c                | 179 ++++++++++++++++-----
 nimble/controller/src/ble_ll_sched.c               |   4 +-
 nimble/controller/src/ble_ll_trace.c               |   2 +
 6 files changed, 189 insertions(+), 59 deletions(-)

commit f709097a7854abce237b02cebfe46ef8850e871b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 16 15:16:42 2018 +0100

    nimble/ll: Add return value to ble_ll_sched_rmv_elem
    
    This will be used be next patches where LL need to know if given element
    has been removed or is already fired. Based on this reference counter of
    aux_data will be dropped or not.

 nimble/controller/include/controller/ble_ll_sched.h |  2 +-
 nimble/controller/src/ble_ll_sched.c                | 10 +++++++---
 2 files changed, 8 insertions(+), 4 deletions(-)

commit 3551e30949dcb598b7fbec69bce86d38fd9c8c5a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 16 16:15:00 2018 +0100

    nimble/ll: Some additional aux_data stats

 nimble/controller/include/controller/ble_ll.h | 3 +++
 nimble/controller/src/ble_ll.c                | 3 +++
 nimble/controller/src/ble_ll_scan.c           | 4 ++++
 3 files changed, 10 insertions(+)

commit c2a36ebebeb6bbf9e5cdfa3eb591fd292209377e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 16 15:05:22 2018 +0100

    nimble/ll: Keep connecting in case of error when decoding address

 nimble/controller/src/ble_ll_conn.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 83cc4e5b2f887ba60e4d199b14a16b8f12afe89b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Nov 13 09:17:15 2018 +0100

    nimble/ll: Fix handling HCI Le Set Advertising Data command
    
    When extended advertising mode is used, Controller shall send Command
    Status with Error Command Disallowed (0x0c) on HCI Le Set Advertising
    data command.
    
    It fixes HCI/GEV/BV-02-C

 nimble/controller/src/ble_ll_hci.c | 1 +
 1 file changed, 1 insertion(+)

commit 23f7091807e13cea344e485f82312cd9be8c76f6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 9 10:43:51 2018 +0100

    nimble/ll: Fix possible null pointer dereference
    
    In case of empty beacon (no AUX_ADV_IND), there will be no aux_data.
    
    This patch also:
    - removes reduntant else as need_event is already reset at
    the beggining of the loop
    
    - fixes incorrect return parameter which could be set to 1 for
    completed chained advertising event

 nimble/controller/src/ble_ll_scan.c | 22 ++++++++++++++--------
 1 file changed, 14 insertions(+), 8 deletions(-)

commit e6a63e3cefff3e3003ed549ba81240470aa154df
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 9 10:32:08 2018 +0100

    nimble/ll: Remove evt reference from aux_data
    
    Once aux_data->evt is taken, remove reference to it from aux_data as it
    is not needed.

 nimble/controller/src/ble_ll_scan.c | 1 +
 1 file changed, 1 insertion(+)

commit 549f8adc738e6d181c0aebf5d06cae03054268d7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Nov 8 16:29:06 2018 +0100

    nimble/ll: Make sure hci event size
    
    This patch make sure single HCI event is not bigger than 255

 nimble/controller/src/ble_ll_scan.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit e945b59b8457bcc44042ace8e2d3032415115a80
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Nov 4 01:06:37 2018 +0100

    nimble/ll: Improve getting aux data
    
    This patch simplify getting aux data so it is easier to follow the code.
    Also, in this patch aux_data is attached to ble_hdr of the received
    packet at the very beginning of isr_end and removed from global scan
    machine.

 nimble/controller/include/controller/ble_ll_scan.h |  4 +-
 nimble/controller/src/ble_ll_conn.c                | 11 +--
 nimble/controller/src/ble_ll_scan.c                | 87 ++++++++++------------
 3 files changed, 46 insertions(+), 56 deletions(-)

commit 665f0795d91d4b3db129d1773a5cd5fa0bd2d39b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 5 15:40:54 2018 +0100

    nimble/ll: Improve getting advertising and target address
    
    aux_data pointer contains valid advertiser and directed address from the
    very beggining if it is available. Later on when getting address let's
    make use of it and do not try to parse packet unless this is empty
    beacon

 nimble/controller/src/ble_ll_scan.c | 46 +++++++++++++++++--------------------
 1 file changed, 21 insertions(+), 25 deletions(-)

commit 21c809bc7407a80a7038c1c165c14e3f06cd4faf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 5 15:30:49 2018 +0100

    nimble/ll: Fix parsing aux_ptr
    
    With this patch we make sure that when parsing aux ptr we store
    advertiser and target address.

 nimble/controller/src/ble_ll_scan.c | 59 ++++++++++++++++++++++++-------------
 1 file changed, 39 insertions(+), 20 deletions(-)

commit 1ecfded31250c837936413915b52053258512a9c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 18 23:21:09 2018 +0200

    nimble/ll: Check privacy mode on Connect Ind receive
    
    This should fix: LL/SEC/ADV/BV-16-C

 nimble/controller/src/ble_ll_adv.c | 32 +++++++++++++++++++++++---------
 1 file changed, 23 insertions(+), 9 deletions(-)

commit 654b7d125cc4f25bca71f69160a7a3d1989b13af
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Dec 3 16:14:49 2018 -0800

    ble_ll_dtm.c: Add missing #include

 nimble/controller/src/ble_ll_dtm.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 79301b9b32b4f7b3051161b7aee616dd3c43a805
Author: Juan Carrano <j.carrano@fu-berlin.de>
Date:   Thu Nov 29 13:40:36 2018 +0100

    L2CAP sm: do not discard alignment information.
    
    ble_sm_gen_ediv and ble_sm_gen_master_id_rand took a simple pointer to
    integers, but were being called with pointers to members of a packed
    struct. This discarded the alignment information.
    
    Not only did it produce an error with clang's -Wno-address-of-packed-member,
    but it may also cause an error in a platform with alignment requirements.
    
    The solution was to modify both procedures to take a pointer to the whole
    structure instead of only the members.

 nimble/host/src/ble_sm.c | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit dc9726835151912a5d2eac998af19083b4c1582d
Merge: c2b2eebe 7467821a
Author: wes3 <wills@runtime.io>
Date:   Mon Dec 3 13:24:39 2018 -0800

    Merge pull request #257 from wes3/hfxo_settle_time_zero_fix
    
    net/nimble/drivers: Fix compile error if BLE_XTAL_SETTLE_TIME = 0

commit 7467821a2ead41345428a78c5316c5e224381f39
Author: William San Filippo <wills@runtime.io>
Date:   Mon Dec 3 13:16:58 2018 -0800

    net/nimble/drivers: Fix compile error if BLE_XTAL_SETTLE_TIME = 0
    
    The ble_phy_rfclk_enable function is called even when the settle
    time is set to 0 (to turn the HFXO on all the time). That function
    was getting compiled out (erroneously) when the settle time gets
    set to 0.

 nimble/drivers/nrf51/src/ble_phy.c | 2 --
 nimble/drivers/nrf52/src/ble_phy.c | 3 +--
 2 files changed, 1 insertion(+), 4 deletions(-)

commit c2b2eebea0662797c79f17278a4c269cc958e174
Merge: c9fa0444 111b86fa
Author: wes3 <wills@runtime.io>
Date:   Mon Dec 3 10:35:13 2018 -0800

    Merge pull request #255 from wes3/slave_conn_upd_fix
    
    net/nimble/controller: Slave connection update fix

commit 111b86fae097983332f406cbfdf7060856b0cbc2
Author: William San Filippo <wills@runtime.io>
Date:   Fri Nov 30 10:44:22 2018 -0800

    net/nimble/controller   Slave connection update fix
    
    The code was not correctly handling the case where a slave receives
    a connection update where the current connection event counter is
    equal to the instant in the connection update PDU. This is a valid
    case (as per spec errata). With this fix the controller should
    correctly handle this case.

 nimble/controller/src/ble_ll_ctrl.c | 23 +++++++++++++++++++----
 1 file changed, 19 insertions(+), 4 deletions(-)

commit c9fa0444cfde53e6939d1d2f6676a94e09695afe
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 19 10:26:20 2018 -0800

    BLE_MESH_SYSINIT_STAGE_2 --> BLE_MESH_SYSINIT_STAGE_SHELL

 nimble/host/mesh/pkg.yml    | 2 +-
 nimble/host/mesh/syscfg.yml | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 55c500325c3a35b7a7ed2aecd0731110b6e2376c
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Oct 25 13:21:09 2018 -0700

    Use syscfg settings for sysinit stage numbers
    
    This allows the app or target to rearrange package initialization order
    via syscfg overrides.
    
    Note: This requires an updated version of newt
    (https://github.com/apache/mynewt-newt/pull/230).  Older versions of
    newt fail to parse the updated `pkg.yml` files.

 nimble/controller/pkg.yml               |  2 +-
 nimble/controller/syscfg.yml            |  5 +++++
 nimble/host/mesh/pkg.yml                |  4 ++--
 nimble/host/mesh/syscfg.yml             | 10 ++++++++++
 nimble/host/pkg.yml                     |  2 +-
 nimble/host/services/ans/pkg.yml        |  2 +-
 nimble/host/services/ans/syscfg.yml     |  5 +++++
 nimble/host/services/bas/pkg.yml        |  2 +-
 nimble/host/services/bas/syscfg.yml     |  4 ++++
 nimble/host/services/bleuart/pkg.yml    |  2 +-
 nimble/host/services/bleuart/syscfg.yml |  4 ++++
 nimble/host/services/dis/pkg.yml        |  2 +-
 nimble/host/services/dis/syscfg.yml     |  4 ++++
 nimble/host/services/gap/pkg.yml        |  2 +-
 nimble/host/services/gap/syscfg.yml     |  5 +++++
 nimble/host/services/gatt/pkg.yml       |  2 +-
 nimble/host/services/gatt/syscfg.yml    | 24 ++++++++++++++++++++++++
 nimble/host/services/ias/pkg.yml        |  2 +-
 nimble/host/services/ias/syscfg.yml     | 23 +++++++++++++++++++++++
 nimble/host/services/lls/pkg.yml        |  2 +-
 nimble/host/services/lls/syscfg.yml     | 22 ++++++++++++++++++++++
 nimble/host/services/tps/pkg.yml        |  2 +-
 nimble/host/services/tps/syscfg.yml     | 23 +++++++++++++++++++++++
 nimble/host/store/config/pkg.yml        |  2 +-
 nimble/host/store/config/syscfg.yml     |  4 ++++
 nimble/host/store/ram/pkg.yml           |  2 +-
 nimble/host/store/ram/syscfg.yml        | 23 +++++++++++++++++++++++
 nimble/host/syscfg.yml                  |  4 ++++
 nimble/transport/emspi/pkg.yml          |  2 +-
 nimble/transport/emspi/syscfg.yml       |  5 +++++
 nimble/transport/ram/pkg.yml            |  2 +-
 nimble/transport/ram/syscfg.yml         |  5 +++++
 nimble/transport/socket/pkg.yml         |  2 +-
 nimble/transport/socket/syscfg.yml      |  5 +++++
 nimble/transport/uart/pkg.yml           |  2 +-
 nimble/transport/uart/syscfg.yml        |  4 ++++
 36 files changed, 198 insertions(+), 19 deletions(-)

commit 15b1e4345ce2f113122551c820d25bb1be14f29d
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 19 10:44:51 2018 -0800

    rename ble_hs_enabled --> ble_hs_is_enabled

 nimble/host/include/host/ble_hs.h | 2 +-
 nimble/host/src/ble_gap.c         | 8 ++++----
 nimble/host/src/ble_hs.c          | 4 ++--
 3 files changed, 7 insertions(+), 7 deletions(-)

commit 68a7f7815b11634ee2d3f6367a869ccb33f2d893
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 19 10:37:57 2018 -0800

    Combine ble_gap_preempt() and ble_gap_ensure_preempted()

 nimble/host/src/ble_gap.c      | 16 ++--------------
 nimble/host/src/ble_gap_priv.h |  1 -
 nimble/host/src/ble_hs_stop.c  |  2 +-
 3 files changed, 3 insertions(+), 16 deletions(-)

commit 766fea564c2e3ac1602705546bb1656b3e7e5c18
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Oct 4 12:28:20 2018 -0700

    apps/btshell: Allow enable / disable of host
    
    This commit adds two commands to btshell:
        * host-enable
        * host-disable

 apps/btshell/src/cmd.c  | 66 +++++++++++++++++++++++++++++++++++++++++++++++++
 apps/btshell/src/main.c |  7 ++++++
 2 files changed, 73 insertions(+)

commit 4eec25a1c2862e9b96a73c144824df86f4936c94
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 3 17:57:15 2018 -0700

    Mynewt: Stop the host on system shutdown
    
    This is Mynewt-only feature.  When the system is shutting down, the host
    stops.

 nimble/host/include/host/ble_hs.h | 11 +++++++
 nimble/host/pkg.yml               |  3 ++
 nimble/host/src/ble_hs_shutdown.c | 69 +++++++++++++++++++++++++++++++++++++++
 nimble/host/syscfg.yml            |  7 ++++
 4 files changed, 90 insertions(+)

commit 6709c868f22bb3f7349cfd60995c468c4607b313
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 3 17:57:02 2018 -0700

    Allow the host to be stopped and started again
    
    The application can stop the host by calling `ble_hs_stop()`.  Stopping
    the host has the following effects:
    * Abort all active GAP procedures with status BLE_HS_EPREEMPTED.
    * Disallow any subsequent GAP procedures until the host is started
      again.
    * Terminate all established connections.
    
    If multiple clients attempt to stop the host simultaneously, all of
    their provided callbacks are executed when the host stops.  The purpose
    of this behavior is to guarantee a consistent shutdown procedure.

 nimble/host/include/host/ble_hs.h       |  13 +-
 nimble/host/include/host/ble_hs_stop.h  |  70 ++++++++++
 nimble/host/include/host/ble_hs_test.h  |   1 +
 nimble/host/src/ble_gap.c               |  73 ++++++++---
 nimble/host/src/ble_gap_priv.h          |   1 +
 nimble/host/src/ble_hs.c                |  93 ++++++++++----
 nimble/host/src/ble_hs_priv.h           |   6 +
 nimble/host/src/ble_hs_stop.c           | 218 ++++++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_pvcy_test.c |   1 +
 nimble/host/test/src/ble_hs_stop_test.c | 200 +++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test.c      |   1 +
 nimble/host/test/src/ble_hs_test_util.c |  13 +-
 nimble/host/test/src/ble_hs_test_util.h |   1 +
 porting/nimble/Makefile.defs            |   1 +
 14 files changed, 649 insertions(+), 43 deletions(-)

commit 71f95c45b4d51dd954b40c684b6e1c914a497d96
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 3 17:34:56 2018 -0700

    host: Divide startup into two stages
    
    Prior to this commit: host startup was done in a single stage by an
    event on the default event queue.  This creates a problem if the
    application wishes to run the host in a different event queue (i.e., not
    the default task).  The typical init sequence looks like this:
    
    1. Sysinit (start event enqueued to default event queue).
    2. Application configures host, possible changing the host event queue.
    3. Host start event runs in the default task.
    
    The problem is that the start event in step three determines that the
    host task is the currently running task.  This is always the default
    task, which is incorrect if the user reconfigured the event queue.
    
    Now: host startup is divided into two stages.  The first stage simply
    enqueues a second event on the host event queue.  The startup sequence
    now looks like this:
    
    1. Sysinit (start event enqueued to default event queue).
    2. Application configures host, possible changing the host event queue.
    3. Stage 1 start event runs in the default task (stage 2 event enqueued
    to host task).
    4. Stage 2 start event runs in the host task.

 nimble/host/include/host/ble_hs.h |  8 ++++--
 nimble/host/src/ble_hs.c          | 55 ++++++++++++++++++++++++++++++++-------
 2 files changed, 51 insertions(+), 12 deletions(-)

commit 9f5a1d51221d59cd58cca8e5089b866ba336878b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 15 14:05:01 2018 +0100

    porting: Fix Makefile that lists non-existing file

 porting/nimble/Makefile.defs | 1 -
 1 file changed, 1 deletion(-)

commit 6fb0f8d3ea6f520b970c4cb504172a9e4508383a
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Nov 15 10:33:36 2018 +0100

    host/util: move function doc to header file

 nimble/host/util/include/host/util/util.h | 13 +++++++++++++
 nimble/host/util/src/addr.c               | 13 -------------
 2 files changed, 13 insertions(+), 13 deletions(-)

commit ab35afaae26d5fd4d668049e8751931adba8d3f5
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Nov 15 10:31:44 2018 +0100

    host/util/addr.c: fix typo in doc

 nimble/host/util/src/addr.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ba6ce7dfddd55da4b82e48de9b194357eb63f753
Author: Mehul Hirpara <mehul.hirpara@inedasystems.com>
Date:   Thu Nov 1 09:20:47 2018 +0530

    Fixed build error of Mesh stack for 64-bit machine

 nimble/host/mesh/src/testing.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4b5c5ef468ba0840ba22e3bc13e55c6e1736d0b1
Author: Mehul Hirpara <mehul.hirpara@inedasystems.com>
Date:   Wed Oct 24 17:56:11 2018 +0530

    [porting][linux] Added timeout support to Eventq Get API
    
    This change helps to get event from eventq with 0 timeout period.

 porting/npl/linux/src/os_eventq.cc |  7 +++++--
 porting/npl/linux/src/wqueue.h     | 18 +++++++++++++-----
 2 files changed, 18 insertions(+), 7 deletions(-)

commit e6fd6e948a4d49263d280127241680b636ed344a
Author: Mehul Hirpara <mehul.hirpara@inedasystems.com>
Date:   Wed Oct 24 17:48:07 2018 +0530

    Dynamically considering pointer size to support multiple platforms
    
    This change helps filling bt_mesh_adv buffer correctly while sending
    secure beacons (on Linux platform).

 nimble/host/mesh/src/adv.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 55e2c86357202927d48c5a3b7d437a462030b3cb
Author: Mehul Hirpara <mehul.hirpara@inedasystems.com>
Date:   Wed Oct 24 17:31:27 2018 +0530

    [porting][linux] Added required APIs to build glue.c for BLE Mesh app

 porting/npl/linux/src/os_callout.c | 27 +++++++++++++++++++++++++++
 porting/npl/linux/src/os_eventq.cc | 12 ++++++++++++
 porting/npl/linux/src/os_time.c    |  7 +++++++
 3 files changed, 46 insertions(+)

commit dfe8035947137e7e8993740e2001870b4196a523
Author: Mehul Hirpara <mehul.hirpara@inedasystems.com>
Date:   Wed Oct 24 16:48:30 2018 +0530

    [porting][linux] Fixed build errors when BLE Mesh Shell is disabled

 nimble/host/mesh/src/testing.c              |  4 ++++
 porting/npl/linux/include/console/console.h | 35 +++++++++++++++++++++++++++++
 2 files changed, 39 insertions(+)

commit dc9fb25e1f00acbbf58c06a3acfa764eec5b221f
Merge: 29ef0b0b 7ebe68fb
Author: wes3 <wills@runtime.io>
Date:   Tue Nov 13 16:10:55 2018 -0800

    Merge pull request #237 from wes3/nrf_hfxo_request
    
    nimble/ll: Request/release hfxo using mynewt API

commit 29ef0b0b99156140f45b623afd72fd3e927d3a02
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 2 12:44:22 2018 -0700

    nimble/host: Allow auto-start to be disabled
    
    Before commit: the host always starts during system initialization.
    
    After commit: a Mynewt syscfg setting (`BLE_HS_AUTO_START`) was added.
    When this setting is disabled, the host does not start automatically.
    Instead, the application starts the host using the new
    `ble_hs_sched_start()` function.
    
    `BLE_HS_AUTO_START` is enabled by default.

 nimble/host/include/host/ble_hs.h              | 12 ++++++++++++
 nimble/host/src/ble_hs.c                       | 16 +++++++++++++++-
 nimble/host/syscfg.yml                         |  6 ++++++
 porting/examples/linux/include/syscfg/syscfg.h |  4 ++++
 porting/nimble/include/syscfg/syscfg.h         |  4 ++++
 porting/npl/riot/include/syscfg/syscfg.h       |  4 ++++
 6 files changed, 45 insertions(+), 1 deletion(-)

commit 7ebe68fbc6f0fdacd9fde54e1f70cbbd687732c1
Author: William San Filippo <wills@runtime.io>
Date:   Mon Nov 12 16:02:18 2018 -0800

    nimble/ll: Add hfxo request/release API
    
    Per code review, the new nrfx API are now only used if MYNEWT
    is set to a non-zero value. For non-MYNEWT builds the nordic
    clock register is accessed directly.

 nimble/drivers/nrf51/src/ble_phy.c | 13 ++++++++++++-
 nimble/drivers/nrf52/src/ble_phy.c | 12 ++++++++++--
 2 files changed, 22 insertions(+), 3 deletions(-)

commit 3fc309ce5b280bee19da9e835cde29cf9064442a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 9 11:58:34 2018 +0100

    mesh: Minor fix trailing whitespaces

 nimble/host/mesh/src/prov.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 78da20d5d4193171a5bfd04a78a4f48019f07b5a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Nov 9 11:43:41 2018 +0100

    nimble/ll: Minor comment fix

 nimble/controller/src/ble_ll_sched.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ff7a82c065e57c905cd00c236eea915b30e1b928
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Nov 8 16:23:22 2018 +0100

    nimble/ll: Minor parameter name change
    
    Let be consistent and use aux_data everywhere

 nimble/controller/src/ble_ll_scan.c | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

commit ef58876024218e488dcbc15c8631db016241ab1f
Author: Martin Turon <mturon@google.com>
Date:   Mon Oct 29 14:55:43 2018 -0700

    [linux] resolve merge conflict.  Default to providing access to psm for l2cap coc connections.

 porting/examples/linux/include/syscfg/syscfg.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 22e1e79295e3c045e100e889738cbf7f3a8e17b6
Author: Martin Turon <mturon@nestlabs.com>
Date:   Thu Aug 23 18:39:33 2018 -0700

    [linux] Cleanup npl layer in linux port.

 porting/npl/linux/include/nimble/nimble_npl_os.h |  6 +----
 porting/npl/linux/src/npl_osal.h                 | 29 ------------------------
 porting/npl/linux/src/os_atomic.c                |  2 +-
 porting/npl/linux/src/os_callout.c               |  3 +--
 porting/npl/linux/src/os_eventq.cc               |  2 +-
 porting/npl/linux/src/os_mutex.c                 |  1 +
 porting/npl/linux/src/os_sem.c                   |  1 +
 porting/npl/linux/src/os_task.c                  |  6 +++++
 porting/npl/linux/src/os_time.c                  |  1 +
 porting/npl/linux/src/os_types.h                 |  4 ++--
 10 files changed, 15 insertions(+), 40 deletions(-)

commit d15edf1282a9b0046989d97c2d4f8f86a61fb1c5
Author: Martin Turon <mturon@nestlabs.com>
Date:   Thu Aug 23 18:39:33 2018 -0700

    [build] Adjust makefiles to support autotools integration.

 porting/nimble/Makefile.controller | 2 ++
 porting/nimble/Makefile.defs       | 5 +++++
 porting/nimble/Makefile.mesh       | 2 ++
 porting/nimble/Makefile.tinycrypt  | 2 ++
 4 files changed, 11 insertions(+)

commit 7e17a05d7c34e2bd391650e813ad4a394c2e9c56
Author: Chris Hemingway <chris.hemingway@gmail.com>
Date:   Sat Nov 3 12:07:53 2018 +0000

    Fix links in README.md

 README.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 44374ce86ca0063adb1691cb4e225c0fe7b010af
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 5 11:43:03 2018 +0100

    nimble/ll: Fix handling TERMINATE_IND
    
    When being master, we need to takie into acount MD flag when ACKing
    TERMINATE_IND packet. Spec does not says that ACK shall be in the same
    Connection Event
    
    This fixes: LL/CON/INI/BV-06 and LL/CON/INI/BV-07

 nimble/controller/src/ble_ll_conn.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit a96960c947177f0f542387025d5a63036920bc4b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 25 13:05:59 2018 +0200

    nimble/ll: Don't send scan request in passive scan
    
    This fix applies only for extended scanner.

 nimble/controller/src/ble_ll_scan.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 5638692fb63c4b135cd1b2a24ddb7dc93bc1647b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 19 00:35:54 2018 +0200

    nimble/ll: Fix handling LL_CTRL is not used for given role
    
    In such a case we should reply with LL_UNKNOWN_RSP

 nimble/controller/src/ble_ll_ctrl.c | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

commit 5ce4a27c81842b655a3a4c23b7c12efbf75f9876
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 19 00:09:17 2018 +0200

    nimble/ll: Add missing check for support BLE_LL_CTRL_PHY_UPD_IND
    
    This is needed for LL/PAC/SLA/BV-01

 nimble/controller/src/ble_ll_ctrl.c | 3 +++
 1 file changed, 3 insertions(+)

commit 3358930f36b525e384e836bba6e47f83ae1b48e0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Oct 29 11:43:06 2018 +0100

    porting: Fix Tinycrypt port build
    
    Tinycrypt requires -std=c99 flag to build.

 porting/examples/dummy/Makefile   | 8 +++++++-
 porting/examples/linux/Makefile   | 8 +++++++-
 porting/nimble/Makefile.tinycrypt | 6 ++++--
 3 files changed, 18 insertions(+), 4 deletions(-)

commit bb650cc692b4c62b21a77dde10e37a56e7fb0875
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 12 13:50:51 2018 +0200

    nimble/ll: Remove AUX from scheduler on scanner stop

 nimble/controller/src/ble_ll_scan.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit bbfe468774adeb8b702f7e878e8de6306a512ee2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 24 14:24:52 2018 +0200

    nimble/sched: Add way to remove given type of scheduled element

 .../controller/include/controller/ble_ll_sched.h   |  4 ++-
 nimble/controller/src/ble_ll_sched.c               | 31 ++++++++++++++++++++++
 2 files changed, 34 insertions(+), 1 deletion(-)

commit 4df479f2c8cb869edcf5b486f5c3f45652b89e50
Author: William San Filippo <wills@runtime.io>
Date:   Fri Nov 2 20:57:33 2018 -0700

    nimble/ll: Request/release hfxo using mynewt API
    
    This change is to use a new API committed to mynewt core that
    will request the hfxo to be turned on and release it when the
    hfxo is no longer desired. One reason to do this is that an
    application may desire the hfxo to be on and nimble would
    blindly turn it on/off when it wanted to. Note that the API
    requires that the request/release be paired; you cannot release
    without a request and if you request without a release the hfxo
    will be on continuously.
    
    A final note: the nimble link layer assumes that when it requests
    the hfxo it needs to settle. If the hfxo was already on the code
    would not need to wait for the settling time. The code has not
    been updated to handle that case. This is not going to cause
    any issues; it will operate as it did before. However, future
    improvements could be to check if the hfxo was already on and
    settled and thus not have to wait for the settling time.

 nimble/controller/src/ble_ll_xcvr.c | 12 ++++++++----
 nimble/drivers/nrf51/src/ble_phy.c  | 25 ++++++++++---------------
 nimble/drivers/nrf52/src/ble_phy.c  | 25 ++++++++++---------------
 3 files changed, 28 insertions(+), 34 deletions(-)

commit 525af73e7d6f9f65d8ce746fb6c1f6ce609967ae
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Wed Oct 24 15:30:05 2018 +0200

    porting: do not assing timer ISR prio using RIOT

 porting/nimble/src/hal_timer.c | 2 ++
 1 file changed, 2 insertions(+)

commit c3a2bd94db17f3bb1bff3b797dc4abc202edbd56
Author: Sam Anderson <internetofawesome@samsurl.com>
Date:   Wed Oct 31 03:22:18 2018 -0700

    nimble/host: Fix LE meta event length in debug code (#233)
    
    * fix length comparison bug
    
    * Revert "fix length comparison bug"
    
    This reverts commit 9911d7744d23efa9d4f94a8c141fb4cedfcefec6.
    
    * reflect length change as result of moving pointer forward

 nimble/host/src/ble_hs_dbg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7eafe8e0871171d4b55795f43d352dcaafd4fc2b
Merge: 0ab82f78 3faf58d7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 29 12:10:30 2018 +0100

    Merge pull request #234 from cedric84/patch-1
    
    BLE_L2CAP_EVENT_COC_DATA_RECEIVED and conn_handle

commit 3faf58d7d689099715d418fc87ded2e797a5a3f6
Author: cedric84 <44369985+cedric84@users.noreply.github.com>
Date:   Mon Oct 29 11:41:28 2018 +0100

    BLE_L2CAP_EVENT_COC_DATA_RECEIVED and conn_handle
    
    It seems that the "ble_l2cap_event_coc_received_data" function does not assign the "conn_handle" member of the "event" variable before calling the channel callback.
    I did not found any other function raising the "BLE_L2CAP_EVENT_COC_DATA_RECEIVED" event so I think this is the only place to make such a correction.

 nimble/host/src/ble_l2cap_coc.c | 1 +
 1 file changed, 1 insertion(+)

commit 0ab82f78671464c5ccf36e8d16b7332ba73b8e57
Merge: 97c67610 189e4d13
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Oct 24 09:45:25 2018 +0200

    Merge pull request #228 from cedric84/patch-1
    
    Connection request rx while already connected

commit 97c67610bd8eadaf6a84e15f7c489fa6c162ff63
Author: banzhuan <1298562349@qq.com>
Date:   Mon Oct 15 11:06:59 2018 +0800

    mesh: Fix memory leaks
    Function return without os_mbuf_free_chain(buf) after buf = NET_BUF_SIMPLE(n)
    will cause memory leaks

 nimble/host/mesh/src/cfg_srv.c   | 18 ++++++++++++------
 nimble/host/mesh/src/friend.c    |  8 ++++++--
 nimble/host/mesh/src/prov.c      |  2 ++
 nimble/host/mesh/src/transport.c |  3 ++-
 4 files changed, 22 insertions(+), 9 deletions(-)

commit cc6df7918fa14cc8efac2b644d47ba77ffaad769
Merge: d421cf8e 53817814
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 23 22:54:36 2018 +0200

    Merge pull request #218 from rymanluk/ll_part3
    
    nimble/ll: Certification fixes part3

commit 5381781448b504b187816ea6c0fe26f630476b1f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 18 00:35:58 2018 +0200

    nimble/ll: Minor fix for missing static

 nimble/controller/src/ble_ll_ctrl.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit e0810ed2a94315ad146e54644223754958fd10c1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 17 22:37:58 2018 +0200

    nimble/ll: Fix for sending unencrypted data on key refreshing
    
    After encryption is paused we should make sure to not send any packets
    from the queue before we encrypt again.
    
    This is a fix for LL/SEC/SLA/BV-03-C

 nimble/controller/include/controller/ble_ll_conn.h |  1 +
 nimble/controller/src/ble_ll_conn.c                | 13 +++++++++++--
 2 files changed, 12 insertions(+), 2 deletions(-)

commit 5ce3964c81798a71042b1f8cb89f8b5dfdab78c7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 16 09:16:49 2018 +0200

    nimble/ll: Fix data TX time when slave response on PHY update proc
    
    With this patch we make sure that slave does not send longer then it
    should after it response on on PHY_REQ and when it receives LL_PHY_UPDATE_IND
    
    This is according to Bluetooth specification 5.0 Vol.6 Part B, 5.1.10.1
    
    "If a slave responds to the PHY Update Procedure then, during the period
    starting when it sends the LL_PHY_RSP PDU and ending when it receives the
    LL_PHY_UPDATE_IND PDU in response, the slave's Link Layer shall not
    transmit a packet that would take longer than connEffectiveMaxTxTime
    microseconds to transmit on any PHY that appears in both the TX_PHYS field
    of its LL_PHY_RSP PDU and the RX_PHYS field of the master's
    LL_PHY_REQ PDU."
    
    This fixes LL/CON/SLA/BV-49-C

 nimble/controller/src/ble_ll_conn.c | 22 ++++++++++++++--------
 nimble/controller/src/ble_ll_ctrl.c |  8 ++++++++
 2 files changed, 22 insertions(+), 8 deletions(-)

commit 9824dac6b65e8af5564173e6647d96019ea32aa0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 16 09:16:09 2018 +0200

    nimble/ll: Fix data TX time when PHY update is started by slave
    
    This patch makes sure that Slave does not send longer then
    connEffectiveMaxTxTime after it init PHY update procedure:
    
    It is according to Bluetooth specification 5.0 Vol.6 Part B, 5.1.10.1
    
    "After a slave sends an LL_PHY_REQ PDU, and until it receives an
     LL_PHY_UPDATE_IND, LL_UNKNOWN_RSP, or LL_REJECT_EXT_IND
     PDU in response, its link layer shall not transmit a packet that would take
     longer than connEffectiveMaxTxTime microseconds to transmit on any PHY
     that appears in the TX_PHYS field of that LL_PHY_REQ PDU."
    
    This fixes LL/CON/SLA/BV-49-C

 nimble/controller/include/controller/ble_ll_conn.h |  3 +++
 nimble/controller/src/ble_ll_conn.c                | 13 ++++++++++++-
 nimble/controller/src/ble_ll_ctrl.c                | 15 +++++++++++++++
 3 files changed, 30 insertions(+), 1 deletion(-)

commit cba3f34ea1f0a42f3e3133702294492b4d1efd41
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 12 00:30:16 2018 +0200

    nimble/ll: Fix handling data pdu when starting encryption
    
    According to Bluetooth specification Vol 6, Part B, 5.1.3.1 and 5.1.3.2
    When master sends LL_ENC_REQ or LL_PAUSE_ENC_REQ, Slave can send all the
    data which has in the queues. Once Slave sends LL_ENC_RSP or
    LL_PAUSE_ENC_RSP, master should start to verify data pdu.
    
    This solves: LL/SEC/MAS/BV-04-C, LL/SEC/MAS/BV-05-C, LL/SEC/MAS/BV-12-C,
    LL/SEC/MAS/BV-13-C, LL/SEC/MAS/BI-08-C

 nimble/controller/include/controller/ble_ll_conn.h | 2 +-
 nimble/controller/src/ble_ll_conn.c                | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 21f7dc82be5ff535708fcce70acd33ee6a5b2bed
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 9 13:36:21 2018 +0200

    nimble/ll: Fix InitA address type in the advertising report

 nimble/controller/src/ble_ll_scan.c | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

commit 12ffd00caa928b8e0fe585383a3787ee1b9a933d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 9 10:41:56 2018 +0200

    nimble/ll: Improve handling disconnect when being Slave
    
    When slave latency is greater than 0 we might not catch ACK on Terminate
    Ind send by us being Slave.
    
    At the moment, when Terminate Ind is sent, we keep listening for the ACK
    however some devices waits with sending ACK for the next connection
    event which we miss due to slave latency.
    
    This patch fixes this.

 nimble/controller/src/ble_ll_conn.c | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 0ddabe5297057e624501d0b36ba965c0b6a71779
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 5 15:33:03 2018 +0200

    nimble/ll: Fix handling BLE_LL_CTRL_CONN_UPDATE_IND and BLE_LL_CTRL_CHANNEL_MAP_REQ
    
    When being master on the link, above LL commands are not used.
    We should response with ERROR UNKNOWN RSP as per Bluetooth 5
    specification:
    
    "If an LL Control PDU is received that is not used or not supported, the Link
    Layer shall respond with an LL_UNKNOWN_RSP PDU"
    
    This is fix for LL/PAC/MAS/BV-01-C

 nimble/controller/src/ble_ll_ctrl.c | 30 +++++++++++++++++-------------
 1 file changed, 17 insertions(+), 13 deletions(-)

commit 63255fa2935d759e2f031da30bf6035c15c08cea
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 5 10:13:42 2018 +0200

    nimble/ll: Store directed address in aux_ptr
    
    We need to store so we can use it for e.g
    directed scannable non-connectable advertising reports

 nimble/controller/include/controller/ble_ll_scan.h |  3 +++
 nimble/controller/src/ble_ll_scan.c                | 22 ++++++++++++++++++++++
 2 files changed, 25 insertions(+)

commit 11c678a5f9741a00e980e5c56084ddf65aac9638
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 4 14:57:26 2018 +0200

    nimble/ll: Improve sending extended advertising report
    
    Since adva and inita is already decoded and resolved if necessary,
    let's pass it to function which prepare ext advertising event and do not
    try to decode it one more time

 nimble/controller/include/controller/ble_ll_scan.h |  5 ++-
 nimble/controller/src/ble_ll_scan.c                | 38 ++++++++++++----------
 2 files changed, 25 insertions(+), 18 deletions(-)

commit 031ec3072b3db12d47b4bcd8ca1417cd8d5c73b5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 4 09:24:45 2018 +0200

    nimble/ll: Improve handling exchange features
    
    There are certification test cases (e.g LL/CON/SLA/BV-80-C)
    which expect us to send start LL procedure even features has not been
    exchanged yet. In the same time, if given procedure failed, controller
    shall remember it and do not start same procedure next time.
    
    Note: In our controller, due to IOP issues, features are not exchanged only
    when we are slave on the link.
    
    Anyway, with this patch, when connection is established we assume
    connection features matches our features. Any LL_UNKNOWN_RSP will clear
    features from the mask.
    
    Note: If feature exchange happen that this will be overwrite by actual
    features.

 nimble/controller/include/controller/ble_ll.h | 9 +++++++++
 nimble/controller/src/ble_ll_conn.c           | 2 +-
 nimble/controller/src/ble_ll_ctrl.c           | 4 ++++
 3 files changed, 14 insertions(+), 1 deletion(-)

commit 32b0d5765998638512872e725e82f02f5c547fd8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 3 15:19:18 2018 +0200

    nimble/ll: Improve connect on directed advertising
    
    This patch fixes certification issues: LL/CON/INI/BV-10-C, LL/CON/INI/BV-21-C
    
    When remote does directed advertising using identity address, initiator
    should make sure privacy mode and also check local IRK if it is non zero

 nimble/controller/src/ble_ll_conn.c | 22 +++++-----------------
 1 file changed, 5 insertions(+), 17 deletions(-)

commit 189e4d13ad846b106e2eb85be0b54d2b6722fe87
Author: cedric84 <44369985+cedric84@users.noreply.github.com>
Date:   Tue Oct 23 15:42:28 2018 +0200

    Update ble_ll_adv.c
    
    The "ble_ll_adv_already_connected" call is now performed only if the PDU is an initiating PDU (BLE_ADV_PDU_TYPE_CONNECT_REQ, BLE_ADV_PDU_TYPE_AUX_CONNECT_REQ) so the advertiser will not ignore any scan request from an already connected peer.

 nimble/controller/src/ble_ll_adv.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit d421cf8e0b37e36e2ba616310a055b3f5bd121d8
Merge: c7d7a4ca 0c4ee10b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 23 11:01:05 2018 +0200

    Merge pull request #198 from andrzej-kaczmarek/att-uuid-fix
    
    nimble/host: Fixes for UUID handling

commit 2be6b71413f66dc8fec013dad39e8c7e15176b78
Author: cedric84 <44369985+cedric84@users.noreply.github.com>
Date:   Tue Oct 23 09:35:15 2018 +0200

    Connection request rx while already connected
    
    Hi,
    In the situation I have to face, my slave allows several masters to create a connection with it.
    The slave uses extended advertising and sends it continuously until a connection request is received.
    A first connection is created and the slave transmits a new extended advertising. The master is reset (to simulate an issue) and restarts before the slave detects the disconnection. The master sends a new connection request as it receives the extended advertising and the slave stops the advertising state to enter the connection state. From the slave point of view, the connection already exists so the connection creation (done in the ble_ll_conn_slave_start function) fails but the advertising does not restart.
    The update I propose is to ignore the connection request if the connection is already created before trying to create the connection. This way, the advertising state continues as if the frame was reject by the white list.
    According to me, this update conforms with the Bluetooth Core Specification Version 5.0, Volume 6, Part B, Section 4.5, page 2637 "If an advertiser receives a connection request from an initiator it is already connected to, it shall ignore that request".
    What do you think ?
    
    Note : The code I insert in my "ble_ll_adv_already_connected" function is very similar from the one in the start of the "ble_ll_conn_slave_start" function, so it would perhaps be better to create this new function in the "ble_ll_conn.c" and to call it from the "ble_ll_conn_slave_start" and "ble_ll_adv_rx_req" functions.
    
    Best regards,
    Cedric

 nimble/controller/src/ble_ll_adv.c | 33 +++++++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)

commit c7d7a4ca42aa127b8cb20b241ee748b40aef0a04
Merge: 5bdae413 536be17b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 22 15:17:51 2018 +0200

    Merge pull request #227 from andrzej-kaczmarek/remove-yml-comments
    
    Remove misleading comments from .yml files

commit 0c4ee10be6e9b340becb9f6c317c34f897acb782
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 18 18:02:36 2018 +0200

    nimble/host: Return non-equal when comparing invalid UUIDs
    
    With all debug check disabled, we need to make sure that invalid UUIDs
    are not compared as equal.

 nimble/host/src/ble_uuid.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 20e971b55129c34ac298987217ab3a53a565ac60
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 27 10:11:39 2018 +0200

    nimble/host: Do not assert on 16-in-128-bit UUIDs
    
    It may happen that some evil peer sends 16-bit UUIDs as 128-bit ones
    over ATT - we will just accept them and use as regular 128-bit UUID.
    
    However, they will not pass sanity check thus we can have unexpected
    assertion which should not happen. Let's just check UUID type and
    ignore invalid contets which allows such requests to fail gracefully.
    
    Note that we may still want to have better sanity checks for UUIDs
    received from app which should not be able to pass 128-bit UUID instead
    of 16-bit one, but this can be addressed later.

 nimble/host/src/ble_uuid.c | 37 +++++++++++++++----------------------
 1 file changed, 15 insertions(+), 22 deletions(-)

commit d4871fe9a16e201890594cff0d6d3893c28423dc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 27 09:18:11 2018 +0200

    nimble/host: Cleanup handling UUIDs in ATT
    
    This patch adds private APIs to initialize UUIDs which should be used
    in ATT code - they guarantee that only 16-bit and 128-bit UUIDs are
    valid since public API function also allows 32-bit UUID which are not
    allowed in ATT.

 nimble/host/src/ble_att_clt.c           |  4 ++--
 nimble/host/src/ble_att_svr.c           |  7 +++----
 nimble/host/src/ble_gattc.c             | 24 ++++++++++++++----------
 nimble/host/src/ble_uuid.c              | 24 +++++++++++++++++++++---
 nimble/host/src/ble_uuid_priv.h         |  6 +++++-
 nimble/host/test/src/ble_hs_test_util.c |  8 ++++----
 6 files changed, 49 insertions(+), 24 deletions(-)

commit 5bdae413d47daa8535f4908c3f7e75e88db563fe
Merge: 50e5415f 26ca4b9c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Oct 19 13:09:07 2018 +0200

    Merge pull request #137 from aykevl/function-pointer-types
    
    porting: Use real function pointer types for ISR functions

commit 26ca4b9c60ea399c05ae2faa99601865b7037580
Author: Ayke van Laethem <aykevanlaethem@gmail.com>
Date:   Fri Oct 19 12:36:21 2018 +0200

    porting: Use correct type for ISR function pointers
    
    This fixes -Werror=strict-prototypes in RIOT.

 nimble/include/nimble/nimble_npl.h                  | 2 +-
 porting/npl/freertos/include/nimble/nimble_npl_os.h | 2 +-
 porting/npl/freertos/include/nimble/npl_freertos.h  | 2 +-
 porting/npl/riot/src/nrf5x_isr.c                    | 8 ++++----
 4 files changed, 7 insertions(+), 7 deletions(-)

commit 536be17b66ed54bf27b867733f8133807d26152e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Oct 19 11:19:49 2018 +0200

    Remove misleading comments from .yml files
    
    These comments were added by some old version of newt and are never
    updated after c&p so they are just misleading and unnecessary.

 apps/blecent/syscfg.yml                  | 2 --
 apps/blehci/syscfg.yml                   | 2 --
 apps/blemesh/syscfg.yml                  | 2 --
 apps/blemesh_light/syscfg.yml            | 2 --
 apps/blemesh_models_example_1/syscfg.yml | 2 --
 apps/blemesh_models_example_2/syscfg.yml | 2 --
 apps/blemesh_shell/syscfg.yml            | 2 --
 apps/bleprph/syscfg.yml                  | 2 --
 apps/bletest/syscfg.yml                  | 1 -
 apps/btshell/syscfg.yml                  | 2 --
 nimble/controller/syscfg.yml             | 2 --
 nimble/controller/test/syscfg.yml        | 2 --
 nimble/drivers/nrf52/syscfg.yml          | 2 --
 nimble/host/mesh/syscfg.yml              | 2 --
 nimble/host/services/bleuart/syscfg.yml  | 2 --
 nimble/host/services/dis/syscfg.yml      | 2 --
 nimble/host/services/gap/syscfg.yml      | 2 --
 nimble/host/store/config/syscfg.yml      | 2 --
 nimble/host/syscfg.yml                   | 2 --
 nimble/host/test/syscfg.yml              | 2 --
 nimble/host/util/syscfg.yml              | 2 --
 nimble/syscfg.yml                        | 2 --
 nimble/transport/emspi/syscfg.yml        | 2 --
 nimble/transport/ram/syscfg.yml          | 2 --
 nimble/transport/socket/syscfg.yml       | 2 --
 nimble/transport/syscfg.yml              | 2 --
 nimble/transport/uart/syscfg.yml         | 2 --
 27 files changed, 53 deletions(-)

commit 50e5415fbc7a2796f295e68a0f543c579f2e8989
Merge: de9bdeaf 6fd09c31
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Oct 18 22:21:26 2018 +0200

    Merge pull request #220 from michal-narajowski/btshell-adv-restart
    
    apps/btshell: Add option to restart advertising after disconnect

commit 6fd09c31ef934e386926cdd171f675efc4d44911
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Oct 11 23:30:34 2018 +0200

    apps/btshell: Add option to restart advertising after disconnect
    
    This patch takes into account both legacy and extended advertising. When using
    legacy advertising (BLE_EXT_ADV: 0) all advertising parameters are remembered
    to use when restarting. When using extended advertising the parameters
    per instance are remembered by the host. For ext adv the app remembers
    the handle of the connection that issued Advertising Complete Event.
    Later, at a Disconnect Event, the code checks if we should restart advertising
    for an instance related to that connection.

 apps/btshell/src/btshell.h |   6 ++-
 apps/btshell/src/cmd.c     |  22 ++++++--
 apps/btshell/src/main.c    | 122 ++++++++++++++++++++++++++++++++++++++++++++-
 3 files changed, 144 insertions(+), 6 deletions(-)

commit de9bdeafaea9bcf88ba50012d74975f877690425
Merge: 1a78a4e6 03cbf11a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 18 15:40:22 2018 +0200

    Merge pull request #225 from haukepetersen/fix_nplriot_develhelpissues
    
    npl/riot: fix issues if building without DEVELHELP

commit 03cbf11a4a787ca22586ead630412241c99810fd
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Thu Oct 18 14:40:38 2018 +0200

    npl/riot: fix issues if building without DEVELHELP

 porting/npl/riot/include/nimble/nimble_npl_os.h | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 1a78a4e6443874a94456166c46e9d60cadb44a42
Merge: cecad355 a59adce4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Oct 15 22:36:39 2018 +0200

    Merge pull request #222 from michal-narajowski/newt-compat
    
    Add latest version to newt compatibility list

commit a59adce4ec8fff0c098fe474493bc1c5339e33d3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Oct 15 21:47:01 2018 +0200

    Add latest version to newt compatibility list

 repository.yml | 2 ++
 1 file changed, 2 insertions(+)

commit cecad355adaec6660caa9a246fd54bd133cb0d85
Author: Fabio Utzig <utzig@apache.org>
Date:   Wed Oct 10 20:30:14 2018 -0700

    Allow parallel tests
    
    The build matrix was updated to support running tests on multiple machines.
    
    Other small changes to formatting and style where applied, plus clone git
    repos without history.

 .travis.yml | 98 +++++++++++++++++++++++++++++++++++++++++++++----------------
 1 file changed, 73 insertions(+), 25 deletions(-)

commit c694cd1f8f64d25214ac68aa197e92dd01dc706e
Merge: e729c534 df746706
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Oct 11 21:17:03 2018 +0200

    Merge pull request #215 from michal-narajowski/gap-find-by-addr
    
    host/gap: Add connection find by address API

commit df7467068d0429348ce97dbf6d0ac1ce4e32f435
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 9 15:02:47 2018 +0200

    host/gap: Add connection find by address API
    
    This may be useful in some cases.

 nimble/host/include/host/ble_gap.h | 16 ++++++++++++++++
 nimble/host/src/ble_gap.c          | 22 ++++++++++++++++++++++
 2 files changed, 38 insertions(+)

commit e729c5341a09a212c3ed72994059c3a8702829bc
Merge: 01e9c897 65d827c5
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Tue Oct 9 11:50:56 2018 -0700

    Merge pull request #214 from ccollins476ad/fix-hs-unit-tests
    
    Fix unit tests involving `ble_gap_preempt()`

commit 65d827c5938ccf644e9845bbd56063dc1a630142
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 8 17:12:18 2018 -0700

    Fix unit tests involving `ble_gap_preempt()`
    
    Now that `ble_gap_adv_stop()` always sends a
    `BLE_HCI_OCF_LE_SET_ADV_ENABLE` command (even if the host doesn't think
    it is currently advertising), unit tests need to simulate additional
    Command Complete events.  In particular, tests which call
    `ble_gap_preempt()` now need this additional ack.

 nimble/host/src/ble_gap.c                   |  20 +++--
 nimble/host/src/ble_hs.c                    |   5 ++
 nimble/host/test/src/ble_hs_pvcy_test.c     | 120 ++++++++++++++++++----------
 nimble/host/test/src/ble_hs_test_util.c     |  11 ++-
 nimble/host/test/src/ble_hs_test_util_hci.c |   5 ++
 nimble/host/test/src/ble_sm_test_util.c     |  10 ++-
 6 files changed, 118 insertions(+), 53 deletions(-)

commit 01e9c89787aa257c97bebdfa7fad59f2443d6c13
Merge: ad878b57 8b8aaa38
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Mon Oct 8 14:30:12 2018 -0700

    Merge pull request #211 from ccollins476ad/hs-ll-adv
    
    host: Unconditionally disable adv on controller

commit 8b8aaa38a794078445e03dae768a6f3db5f5eaba
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Oct 5 17:51:07 2018 -0700

    host: Unconditionally disable adv on controller
    
    This commit addresses a bug that has been observed occasionally.  The
    bug is: sometimes the controller thinks advertising is active while the
    host thinks it is not.  This bug causes all subsequent advertise
    attempts to fail.
    
    The root cause of this bug is: the host does not process all HCI events
    in the order they are received.  Specifically, "ack" events (Command
    Status and Command Complete) are processed right when the controller
    sends them, whereas other events get put on a queue and processed when
    the host parent task runs through its event queue.
    
    The reason for this discrepancy is that it allows the host to present a
    blocking HCI interface, even when the host and application run in the
    same task.  When the host sends an HCI command, it immediately pends on
    a semaphore.  When the controller acknowledges the command, it releases
    the semaphore, unlocking the host task.  If the controller sent other
    events to the host while it was blocked, they get processed *after* the
    ack, resulting in out of order event processing.
    
    The specific sequence which triggers the bug:
    
    1. Host advertises in connectable mode.
    
    2. Peer connects to the local device.  Controller enqueues the
    Connection Complete event on the host's HCI queue.  As a consequence of
    the new connection, the controller is no longer advertising.
    
    3. Before the host processes the event from step 2, it stops and starts
    advertising again (e.g., because it wants to advertise with different
    parameters).  The command to stop advertising has no effect on the
    controller since it is not advertising anyway.  The "start advertising"
    command does have an effect; the controller is now advertising.
    
    4. The host finally processes the Connection Complete event from step 2;
    it is now under the impression that controller is no longer advertising.
    
    After the above sequence, there is a mismatch among the host and
    controller state.  The host thinks advertising is not active, but the
    controller really is advertising.
    
    This commit implements a workaround for this situation.  Prior to this
    commit, the host would only honor a request to stop advertising if its
    state indicated that advertising is active.  If advertising were not
    active, `ble_gap_adv_stop()` would abort early with the
    `BLE_HS_EALREADY` error code.
    
    Now, the host always attempts to disable advertising when requested.  It
    does not inspect its own state at all.

 nimble/host/include/host/ble_gap.h | 12 ++++++++++++
 nimble/host/src/ble_gap.c          |  6 ------
 2 files changed, 12 insertions(+), 6 deletions(-)

commit ad878b572a7e797d5a62a61ac57a2478f73e109a
Merge: 554c7f65 d33cdbe5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Oct 8 18:14:56 2018 +0200

    Merge pull request #178 from michal-narajowski/ble-unpair
    
    host: Add API to unpair a peer device

commit 554c7f656b469af06450327ade9bba396a8ab161
Merge: c164b0a8 2403d8a2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 8 13:35:24 2018 +0200

    Merge pull request #197 from forgithub123/master
    
    mesh: Fix the wrong way to detect the trailing space

commit 2403d8a285ddb5883d044c720ee45c2e3a775cc2
Author: banzhuan <qinjingyu@tcl.com>
Date:   Sat Oct 6 11:24:18 2018 +0800

    mesh: Fix the wrong way to detect the trailing space.
    Assignment n bytes to link.rx.buf->om_len will lead to
    n bytes decrease of OS_MBUF_TRAILINGSPACE(link.rx.buf),
    so we should get the OS_MBUF_TRAILINGSPACE(link.rx.buf)
    before assignment net_buf_simple_pull_be16(buf) to
    link.rx.buf->om_len.

 nimble/host/mesh/src/prov.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit c164b0a87c90fbeeb5c522ac174dc4839212be83
Merge: bf2bdcc9 88a887c2
Author: Fabio Utzig <utzig@utzig.org>
Date:   Fri Oct 5 11:11:07 2018 -0300

    Merge pull request #210 from utzig/travis-cache-homebrew
    
    Cache homebrew packages

commit 88a887c24984d5abbee67a8532652f1201ee72e1
Author: Fabio Utzig <utzig@apache.org>
Date:   Fri Oct 5 09:27:41 2018 -0300

    Cache homebrew packages
    
    This applied two changes already merged on mynewt-core:
    
    * Enable caching of homebrew packages
    * Only print arm-none-eabi-gcc version on targets that install it

 .travis.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit bf2bdcc94965a1c42c3537d3021b3a9aa21611e7
Merge: 0af5b38f da0ddd99
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 5 13:35:35 2018 +0200

    Merge pull request #208 from rymanluk/ext_adv
    
    nimble/host: Allow to configure non-connectable scannable advertising

commit 0af5b38f4236dc6665bf629dbf118be848c333a8
Merge: 3d688066 22b0afc1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 5 13:35:21 2018 +0200

    Merge pull request #192 from rymanluk/gap_impr
    
    nimble/gap: When BLE_EXT_ADV is on use only EXT ADV HCI commands

commit 3d688066d0512d620c403f831bfed2673061d9b7
Merge: 6ea7ac3a 7917546e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Oct 5 09:57:02 2018 +0200

    Merge pull request #177 from michal-narajowski/l2cap-chan-params-getters
    
    nimble: Add API to query the L2CAP channel for details

commit 22b0afc1f2bab326fdd48f61c782dd5977c8376f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 20 16:03:55 2018 +0200

    nimble/gap: Add wrapper for ble_gap_disc when BLE_EXT_ADV is on
    
    When BLE_EXT_ADV is on, let us use only advertising extensions HCI
    commands.
    
    Nimble controller does not allow mix legacy and ext hci commands so let
    us make sure host has no chance to do it.

 nimble/host/src/ble_gap.c | 61 ++++++++++++++++++++---------------------------
 1 file changed, 26 insertions(+), 35 deletions(-)

commit ee81ef832d2f7dae59c10e8c06f8f20e39748522
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 16 11:23:15 2018 +0200

    nimble/gap: Add wrapper for ble_gap_connect when BLE_EXT_ADV is on
    
    When EXT Adv is build then let us use only advertising extensions HCI
    commands

 nimble/host/src/ble_gap.c | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

commit da0ddd99bf7e3efe9470cb24e5f681d6bb779652
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 4 16:13:09 2018 +0200

    nimble/host: Allow to configure non-connectable scannable advertising

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6ea7ac3adf6e26101b90b9d58b6d7aac1ada7603
Merge: 0fefae27 54ec8013
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Wed Oct 3 14:09:07 2018 -0700

    Merge pull request #205 from ccollins476ad/ble-hs-id-reset
    
    host: Clear addresses on reset

commit 54ec8013cd15bd514a87ebef51cc2e5b1b889cef
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 3 12:55:49 2018 -0700

    host: Clear addresses on reset
    
    A stack reset causes the controller to forget its random address.
    Therefore, the host must reconfigure the controller with a random
    address.
    
    Prior to this commit, the host did not clear its addresses on stack
    reset.  As a consequence, attempting to use a random address with
    `ble_hs_util_ensure_addr()` function following a reset would not work.
    The host would think that it had already configured the controller with
    a random address, so this function would be a no-op.

 nimble/host/src/ble_hs.c         |  3 +++
 nimble/host/src/ble_hs_id.c      | 11 +++++++++++
 nimble/host/src/ble_hs_id_priv.h |  1 +
 3 files changed, 15 insertions(+)

commit 0fefae27cb9e0dc17502413c4983781e23b03456
Author: Aditya Xavier <adityaxavier@gmail.com>
Date:   Wed Oct 3 15:17:24 2018 +0530

    Beacon's Measured Power as an argument (#202)
    
    * Beacon Measured Power as an argument
    
    Took Measured Power as an argument from the user instead of generating automatically. Also checked whether the value is as per BLE specifications.
    
    Modified btshell app to use the new argument while setting eddystone beacon.
    
    * Initialized measured power
    
    Warning, that measured power might not be initialized.
    
    * Modified as per suggestions
    
    1. Modified iBeacon accepted Measured Power range.
    2. Modified Measured Power variable in cmd.c for Eddystone use.
    3. Modified Comments in Eddystone to match Spec.

 apps/btshell/src/cmd.c                   | 13 ++++++++++++-
 nimble/host/include/host/ble_eddystone.h |  7 +++++--
 nimble/host/include/host/ble_ibeacon.h   |  3 ++-
 nimble/host/src/ble_eddystone.c          | 26 +++++++++++++-------------
 nimble/host/src/ble_ibeacon.c            | 15 +++++++--------
 5 files changed, 39 insertions(+), 25 deletions(-)

commit 3c84d3f4004ca4094187cf92a1088ca104868391
Merge: 34577f20 7139c9d2
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Tue Oct 2 13:44:42 2018 -0700

    Merge pull request #204 from ccollins476ad/typo
    
    Fix typo causing compile error

commit 7139c9d20644f6bb715f5e20304db5042a9d7af9
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Oct 2 13:21:35 2018 -0700

    Fix typo causing compile error

 nimble/transport/socket/src/ble_hci_socket.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9152940944b6b31a25650426db614d15c6d784d2
Author: banzhuan <qinjingyu@tcl.com>
Date:   Wed Sep 26 23:23:12 2018 +0800

    Fix the wrong way to detect the trailing space

 nimble/host/mesh/src/prov.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 34577f20224ec4ecd7015b6b18dbc795f4fbb40e
Merge: 0463000b cff2472f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 26 10:47:55 2018 +0200

    Merge pull request #196 from michal-narajowski/travis
    
    Update travis.yml to work with latest changes

commit cff2472fe9a1b05f9f477e7398bb576dcc694d31
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 25 13:43:19 2018 +0200

    Update travis.yml to work with latest changes

 .travis.yml | 5 -----
 1 file changed, 5 deletions(-)

commit 0463000b5d36665acdf4c8c75d0001a463dcdc66
Merge: 61a1d497 bbf67ae5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 25 09:29:20 2018 +0200

    Merge pull request #194 from jeremywood/ble_gap_max_update_entries_syscfg
    
    nimble/host: Convert BLE_GAP_MAX_UPDATE_ENTRIES from define to syscfg.

commit bbf67ae5947a4fb3af0e3804f7e0d556390dd17c
Author: Jeremy Wood <jeremy@proxy.co>
Date:   Mon Sep 24 22:57:49 2018 -0700

    nimble/host: Add MYNEWT_VAL_BLE_GAP_MAX_PENDING_CONN_PARAM_UPDATE to porting syscfg.h's.

 porting/examples/linux/include/syscfg/syscfg.h | 4 ++++
 porting/nimble/include/syscfg/syscfg.h         | 4 ++++
 porting/npl/riot/include/syscfg/syscfg.h       | 4 ++++
 3 files changed, 12 insertions(+)

commit 7252a28c9e606ef24047f893ac514a041bca3dbd
Author: Jeremy Wood <jeremy@proxy.co>
Date:   Mon Sep 24 09:53:56 2018 -0700

    nimble/host: Change BLE_GAP_MAX_UPDATE_ENTRIES to more descriptive BLE_GAP_MAX_PENDING_CONN_PARAM_UPDATE.

 nimble/host/src/ble_gap.c | 4 ++--
 nimble/host/syscfg.yml    | 6 ++++--
 2 files changed, 6 insertions(+), 4 deletions(-)

commit 61a1d497d6fffc8923009b84d799c32b2f1846da
Merge: 899af0a6 c36ae3c9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Sep 24 15:48:04 2018 +0200

    Merge pull request #195 from rymanluk/ll_fix_terminate
    
    nimble/ll: Fix checking len of TERMINATE_IND

commit c36ae3c98b4434744a36d71931fc8321ad4793f1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Sep 24 15:36:54 2018 +0200

    nimble/ll: Fix checking len of TERMINATE_IND
    
    BLE_LL_CTRL_TERMINATE_IND_LEN is 1 as it stands only for error code in
    the TERMINATE_IND opcode. 'rx_pyld_len' contains aslo opcode which is
    additional 1 octet.
    
    This patch fixes it.

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7917546ea80db7c770242b37b16df95b2e4778a5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Aug 30 16:31:39 2018 +0200

    nimble: Add API to query the L2CAP channel for details

 apps/btshell/src/main.c              |  9 ++++++--
 nimble/host/include/host/ble_l2cap.h |  4 ++++
 nimble/host/src/ble_l2cap_coc.c      | 40 ++++++++++++++++++++++++++++++++++++
 3 files changed, 51 insertions(+), 2 deletions(-)

commit d33cdbe5dc2ef7052658c48d68fce23e03458a9b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Sep 24 11:07:42 2018 +0200

    host: Add API to unpair a peer device
    
    This API allows to unpair a device with the specified address. The keys
    related to that peer device are removed from storage and peer address
    is removed from the resolve list from the controller. If a peer
    is connected, the connection is terminated.
    
    This function is used in policy for SM key overflow. Instead of just deleting
    the keys from storage, the host performs tasks described above to
    ensure correct behavior.

 apps/btshell/src/btshell.h         |  1 +
 apps/btshell/src/cmd.c             | 60 ++++++++++++++++++++++++++++++++++++++
 apps/btshell/src/main.c            | 13 +++++++++
 nimble/host/include/host/ble_gap.h | 28 ++++++++++++++++++
 nimble/host/src/ble_gap.c          | 52 +++++++++++++++++++++++++++++++++
 nimble/host/src/ble_store_util.c   |  2 +-
 6 files changed, 155 insertions(+), 1 deletion(-)

commit 899af0a6c2110b1437aa9556f56fef8b42585b63
Merge: 5b57923e f1624cf0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Sep 24 12:06:29 2018 +0200

    Merge pull request #187 from michal-narajowski/travis
    
    Add Travis CI integration

commit f1624cf0ae7a7c1bfae95ac6cbc59e8bc78607b9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 11 14:31:44 2018 +0200

    Add Travis CI integration

 .travis.yml | 87 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 87 insertions(+)

commit 32a1e15499e524e9b3c2cfc0ff40d777e6ff1ff7
Author: Jeremy Wood <jeremy@proxy.co>
Date:   Thu Sep 20 14:16:24 2018 -0700

    nimble/host: Convert BLE_GAP_MAX_UPDATE_ENTRIES from define to syscfg.
    
    Previously, BLE_GAP_MAX_UPDATE_ENTRIES was a define in ble_gap.c. Now it's a syscfg in nimble/host/syscfg.yml. There are cases where this value needs to be increased to support multiple simultaneous connections.

 nimble/host/src/ble_gap.c | 6 ++----
 nimble/host/syscfg.yml    | 6 ++++++
 2 files changed, 8 insertions(+), 4 deletions(-)

commit 5b57923e26f56ae8c9f1b1395b503da69f3f5dae
Merge: 2ca76f06 6a12e35c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 19 12:07:17 2018 +0200

    Merge pull request #181 from rymanluk/ll_fix
    
    nimble/ll: Certification fixes - part 2

commit 6a12e35cb6501dba20280e2edefd3c03a60925da
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 18 10:04:11 2018 +0200

    nimble/ll: Start LL response timer when sending start encrypt
    
    Make sure start that we receive start encrypt response withing 40 sec
    otherwise drop the link

 nimble/controller/src/ble_ll_ctrl.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 388bbfd645d46b1a6c25c7260506117ac9dedcb7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 16:03:18 2018 +0200

    nimble/ll: Remove reduntant parameter in -ble_ll_ctrl_start_enc_send

 nimble/controller/include/controller/ble_ll_ctrl.h | 2 +-
 nimble/controller/src/ble_ll_conn_hci.c            | 2 +-
 nimble/controller/src/ble_ll_ctrl.c                | 6 +++---
 3 files changed, 5 insertions(+), 5 deletions(-)

commit cade58be1abcbb5c6d1693af7a278b19b064acd2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 13:35:43 2018 +0200

    nimble/ll: Allow to set privacy mode when resolving is disabled
    
    Bluetooth specification does not require resolving to be enabled when
    setting privacy mode. Therefore let us remove this limitation.
    
    This fixes LL/SEC/ADV/BV-18

 nimble/controller/src/ble_ll_resolv.c | 4 ----
 1 file changed, 4 deletions(-)

commit 586bec1d6179e4ddf9e503a069a82ddcaa491135
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 12:22:09 2018 +0200

    nimble/ll: Minor coding style issue

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e978ffbe378a619d1802dac051c18ea7d8b39907
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 12:21:00 2018 +0200

    nimble/ll: Fix checking ADI in chains
    
    Scan response does not have ADI, therefore do not test it then

 nimble/controller/src/ble_ll_scan.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 865c9da8d9315a4290eefffad81bb06d598b0a0f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 12:18:25 2018 +0200

    nimble/ll: Fix event type in the advertising report containing scan rsp
    
    According to specification  Bluetooth 5, Vol 2, Part E, 7.7.65.13
    
    "When a scan response is received, bits 0-2 and 4 of the event type shall
    indicate the properties of the original advertising event"

 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll_scan.c                | 15 +++++++++++----
 2 files changed, 12 insertions(+), 4 deletions(-)

commit 7f7f46aa4a27e337a14ca0e6dd69d8144e45e7f9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 12:15:01 2018 +0200

    nimble/ll: Add correct sid into scan response advertising report

 nimble/controller/src/ble_ll_scan.c | 2 ++
 1 file changed, 2 insertions(+)

commit 2ca76f06a7c1cc99df22ec801acc0dad2600efc5
Merge: 8b5704ba fecbc729
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Sep 19 11:36:56 2018 +0200

    Merge pull request #170 from turon/pr/hci/set_device
    
    [linux] allow setting of hci device id for socket.

commit 2170c0f2e137d1a29422db2f1b8ef84bb8f9ee3a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 12:12:14 2018 +0200

    nimble/ll: Fix tracking adi in the chains
    
    Controller maintains auxdata for the whole advertising event. With this
    patch we make sure that ADI is not overwitten if chains does not have
    it e.g. in scan response

 nimble/controller/src/ble_ll_scan.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit ca5f3f4ef308b48ae778ee0670b52f582dae9b60
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 12:07:52 2018 +0200

    nimble/ll: Rename did to adi in aux data
    
    This value keeps AdvDataInfo (ADI) therefore fix the name

 nimble/controller/include/controller/ble_ll_scan.h | 2 +-
 nimble/controller/src/ble_ll_scan.c                | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit b847d4260848ffe35d38c616c53a4954fc0ed0f6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 14 11:48:08 2018 +0200

    nimble/ll: Fix getting aux_data
    
    Last chain element will not contain AuxPtr in the packet but we still
    have aux_data from previous chains.

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ae9da5d5d9f748ea62884b52cdfd2f36d7fc6ba5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 14 11:07:39 2018 +0200

    nimble/ll: Fix AuxPtr offset calculations
    
    Rounds which were cause by changing from usec->ticks->usec made AuxPtr
    incorrect.

 nimble/controller/src/ble_ll_adv.c | 13 ++++---------
 1 file changed, 4 insertions(+), 9 deletions(-)

commit bdc102d00643a5907ebb866e9eedf31873ef561d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 28 16:17:24 2018 +0200

    nimble/ll: Fix extended advertising reports handling
    
    We may run out of buffers for HCI advertising reports if scanning a lot
    of devices at the same time and/or host does not handle these events
    fast enough to return buffers to pool. This is handled properly if we
    need to fragment advertising data and fail to allocate buffer for 2nd
    or subsequent events (we'll mark data as trimmed in current event), but
    in case we cannot allocate buffer for 1st event it will just be dropped
    without marking data as trimmed. As a result, another PDU scanned from
    the same advertiser may be handled by host as continuation of previous
    data which results in corrupted reassembled data and there is no way
    for host to figure this out.
    
    This patch changes extended advertising reports handling to make sure
    data are always marked as trimmed when we run out of event buffers. We
    now always keep one pre-allocated event in aux_data so we can always
    send at least one event that will mark data as trimmed. If we cannot
    allocate 1st event for chain, it will be just dropped which is ok since
    host will not event know about this chain.

 nimble/controller/include/controller/ble_ll_scan.h |   2 +
 nimble/controller/src/ble_ll_scan.c                | 104 ++++++++++++++++-----
 2 files changed, 85 insertions(+), 21 deletions(-)

commit b77cefa259523b894d1db1b9edce2d3eeb1fcd5a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 28 15:01:40 2018 +0200

    nimble/ll: Rename ble_ll_ext_adv
    
    This is structure for ext adv report so rename it accordingly - current
    name is really confusing when reading code.

 nimble/controller/include/controller/ble_ll_scan.h |  4 ++--
 nimble/controller/src/ble_ll_scan.c                | 26 +++++++++++-----------
 2 files changed, 15 insertions(+), 15 deletions(-)

commit 0e51e19925b24d773013f3e634ad61bc2e4968aa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 11 14:19:29 2018 +0200

    nimble/ll: Allow to report ext advertising without aux data
    
    This should fix LL/DDI/SCN/BV-19

 nimble/controller/src/ble_ll_scan.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit caba91332214cf5dd994daa324949a3e0786c6ca
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 11 12:40:04 2018 +0200

    nimble/ll: Fix own_addr_type when scanning
    
    Make sure scansm->own_addr_type is set corretly when scanning is
    enabling
    
    This fixes LL/DDI/SCN/BV-16

 nimble/controller/src/ble_ll_scan.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 7b5fd321680b08315318deb1aab57fa24029c791
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 11 10:29:24 2018 +0200

    nimble/ll: Make sure there is no ADI field in AUX SCAN RSP
    
    This fixes LL/DDI/ADV/BV-25-C

 nimble/controller/src/ble_ll_adv.c | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit 7a94855661d9bbafb6e24c40983e5b7687f0b7c7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Sep 10 15:43:54 2018 +0200

    nimble/ll: Fix parameter check on HCI SET PHY command
    
    When tx_phys or rx_phys is not supported by controller, controller
    should respond with Unsupported Feature or Parameter Value (0x11)
    
    This patch fixes certification test LL/CON/SLA/BV-40

 nimble/controller/src/ble_ll_hci.c | 50 +++++++++++++++++++++++---------------
 1 file changed, 30 insertions(+), 20 deletions(-)

commit e713c3fb84d5cda5021961518ce3f15145d10d80
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Sep 10 13:58:55 2018 +0200

    nimble/ll: Start LL response timer on PHY REQ as a slave
    
    If master does not end PHY Update procedure, Slave is responsible to
    drop the link.
    
    It fixes test LL/CON/SLA/BV-51

 nimble/controller/src/ble_ll_ctrl.c | 60 +++++++++++++++++++++----------------
 1 file changed, 35 insertions(+), 25 deletions(-)

commit d332d31fdbbcba6892e47d907676d6b00eeb5a06
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 7 16:15:00 2018 +0200

    nimble/ll: Fix error code in read remote feature event
    
    If connection is dropped and read remote feature was in progress let us
    send this event before disconnection complete event and with actually
    error code and not the fixed one as it was so far.
    
    This should fixed certification test LL/CONN/MAS/BV-19

 nimble/controller/src/ble_ll_conn.c | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

commit 79001dd00a6dc1ba00bce509d7cd04edb7534675
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 14:35:34 2018 +0200

    nimble/ll: Verify length of Terminate Ind
    
    Make sure Terminate ind has correct len. Otherwise do not procced but
    reply with LL_UNKNOWN_RSP
    
    This should fix LL/PAC/SLA/BI-01 and LL/PAC/MAS/BI-01

 nimble/controller/src/ble_ll_conn.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit acde4fe8cf4d66cacb3cbd545f74c33b1fb55cfd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 13:46:42 2018 +0200

    nimble/ll: Fix missing directed flag

 nimble/controller/src/ble_ll_scan.c | 1 +
 1 file changed, 1 insertion(+)

commit f9564708182071ae5b9ba6ac46250b38497a6223
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 11:49:05 2018 +0200

    nimble/ll: Fix error code on connection update request
    
    If features has been exchanged and it is already known that peer does
    not support Connection Parameters Request procedure, controller shall
    return command status with code (0x1A) according to spec Bluetoot 5.0
    Vol 6, 5.1.7
    
    It fixes LL/CON/SLA/BV-86

 nimble/controller/src/ble_ll_conn_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f2ec62f81631c413c305e182927e88713ecf41c7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Aug 30 15:38:55 2018 +0200

    nimble/ll: Fix handling LL_UNKNOWN_RSP on LL_CONN_PARAM_REQ
    
    Make sure to send LL_CONN_UPDATE_IND if peer response with
    LL_UNKNOWN_RSP on LL_CONN_PARAM_REQ while being master on the link
    
    This fixes LL/CON/MAS/BV-81

 nimble/controller/src/ble_ll_ctrl.c | 186 +++++++++++++++++++-----------------
 1 file changed, 97 insertions(+), 89 deletions(-)

commit 396a4bf593b56dbfa8034872c6613b537b5d7614
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Aug 30 15:21:18 2018 +0200

    nimble/ll: Fix handling EXT_REJECT_IND on CONN_PARAM_REQ
    
    If peer sends back EXT_REJECT_IND on CONN_PARAM_REQ, Nimble
    controller should send LL_CONN_UPDATE_IND and stop the LL procedure
    
    This fixes LL/CON/MAS/BV-29

 nimble/controller/src/ble_ll_ctrl.c | 21 ++++++++++++++++-----
 1 file changed, 16 insertions(+), 5 deletions(-)

commit 36f344d0692f379f79837392ea9d7f17acc0fff6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Mar 12 14:09:15 2018 +0100

    nimble/ll: Don't stop CONN_PARAM_REQ procedure on collision
    
    This fixes following scenario for test case LL/CONN/MAS/BV-26
    * nimble is master on the link and started connection parameter procedure,
    * peer sends connection parameter request
    * nimble replies with ext reject err=lmp collision error
    
    After this nimble shall wait for response. This patch should fixed
    that

 nimble/controller/src/ble_ll_ctrl.c | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 8b5704bad35407277d13b6485bd723e55534b9cc
Merge: b2fb5cf7 cf791d4b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 18 14:35:26 2018 +0200

    Merge pull request #189 from andrzej-kaczmarek/nrf52-pipeline
    
    nimble/phy: nRF52 timing fixes

commit cf791d4b377bec9626a050e78bf74e2a013f44d9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 18 12:16:51 2018 +0200

    nimble/phy: Adjust wfr for timer resolution
    
    It's possible that we'll capture PDU start time at the end of timer
    cycle and since wfr expires at the beginning of calculated timer cycle
    it can be almost 1 usec too early. Let's compensate for this by
    waiting 1 usec more.

 nimble/drivers/nrf52/src/ble_phy.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit 99bacdb78e139698845adace87be37c7f4d66418
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 18 12:14:22 2018 +0200

    nimble/phy: Fix pipeline delays for nRF52
    
    Pipeline delays for nRF52832 and nRF52840 were measured from scratch
    and new values include extra delays caused by incoroprating erratas
    102/106/107 for nRF52832.

 nimble/drivers/nrf52/src/ble_phy.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit b2fb5cf7a72528f9c1010419d1e3a597bb581c44
Merge: 0a526ea0 b06f2fbc
Author: mkiiskila <marko@runtime.io>
Date:   Tue Sep 11 19:59:59 2018 +0300

    Merge pull request #186 from mkiiskila/ble_monitor_uart_crash
    
    ble_monitor; crashes if outputting uart receives any characters.

commit 0a526ea0212bc9443517aed34982b2412be0ce61
Merge: 04cd24da 76e83a49
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 11 12:30:02 2018 +0200

    Merge pull request #185 from andrzej-kaczmarek/gap-hooks
    
    nimble/host: Add listeners for GAP events

commit b06f2fbcc7f244892d6e6009839ec40650a37502
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Sep 11 13:16:45 2018 +0300

    ble_monitor; crashes if outputting uart receives any characters.
    Add a routine to discard the data instead.

 nimble/host/src/ble_monitor.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 76e83a498c4f8f39ff5e05579cf40df335bfd741
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 13 14:39:12 2018 +0200

    nimble/host: Add listeners for GAP events
    
    This allow any package to registere listener which will receive GAP
    events. The events applicable for listener are any "notifications",
    i.e. events which are informational only. This means that e.g. events
    like connection state changes are notified while pairing request is
    not.

 nimble/host/include/host/ble_gap.h | 39 +++++++++++++++++
 nimble/host/src/ble_gap.c          | 90 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 129 insertions(+)

commit 04cd24da0da844feec6235d06f456992f50c58a7
Merge: 6dc6249c 1634272c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 19:38:13 2018 +0200

    Merge pull request #184 from andrzej-kaczmarek/dtm-improv
    
    DTM: few improvements

commit 1634272c0312b15b9996da17be1ed01a3378d4e6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 16:45:23 2018 +0200

    nimble/ll/dtm: Start RX with interrupts disabled
    
    It can happen that if we are interrupted when setting things for RX,
    we will be stuck with radio unconfigured. For now let's just make sure
    this is done with interrupts disabled.
    
    It may be reasonable to handle this also somehow in PHY, but it needs
    more analysis and we don't want to break something. Also note that in
    other cases we set wfr so even if this happens, wfr will rescue us.

 nimble/controller/src/ble_ll_dtm.c | 3 +++
 1 file changed, 3 insertions(+)

commit dd403a661d226ddd7564daf033d04dc5225ac8b6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 16:45:17 2018 +0200

    nimble/ll/dtm: Add stat to count RX packets in real-time

 nimble/controller/src/ble_ll_dtm.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 71c9564458b745b69f70140e0911fa0670713c3d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 13:27:28 2018 +0200

    nimble/ll/dtm: Register stats properly

 nimble/controller/include/controller/ble_ll.h |  4 ++++
 nimble/controller/src/ble_ll.c                |  4 ++++
 nimble/controller/src/ble_ll_dtm.c            | 12 ++++++++++++
 3 files changed, 20 insertions(+)

commit 7c93cf86e9529b1614fac9dbf06b93a803ce6500
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 12:07:48 2018 +0200

    nimble/ll/dtm: Try to restart RX if failed due to radio error

 nimble/controller/src/ble_ll_dtm.c | 18 +++++++++++++++++-
 1 file changed, 17 insertions(+), 1 deletion(-)

commit f95b4b35fe1983622f7b946f70822207a3d19401
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 12:03:37 2018 +0200

    nimble/ll/dtm: Remove unnecessary assert
    
    HCI command will simply fail, no need to assert here.

 nimble/controller/src/ble_ll_dtm.c | 1 -
 1 file changed, 1 deletion(-)

commit 430ef71fc0e5669c7f30abc12d00b8ab2ec6f49a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 11:59:53 2018 +0200

    nimble/ll/dtm: Change event callback name
    
    We'll have more of them soon.

 nimble/controller/src/ble_ll_dtm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c5ab2b48f5019ea6756eaff6d26d92afa4e202ca
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 11:59:05 2018 +0200

    nimble/ll/dtm: Add stat for TX reschedule

 nimble/controller/src/ble_ll_dtm.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 7e040539d5ca75381114bdedc2c33f25cfbf3ea6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 6 11:28:28 2018 +0200

    nimble/ll/dtm: Remove scheduler first when stopping DTM
    
    It should be safer to begin stopping DTM by removing scheduler item so
    it does not fire while we are stopping things.

 nimble/controller/src/ble_ll_dtm.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 6dc6249cd74b3c3b8a5813a5dcbc09114d6b1edf
Merge: 7cbe9f14 fac10275
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 5 18:49:30 2018 +0200

    Merge pull request #183 from rymanluk/build_fixes
    
    nimble: Build error fixes after PR 164 and PR 182

commit fac10275023a569f62cc7a4c6512d205e4600bb5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 5 18:43:40 2018 +0200

    nimble/phy: Fix build error when only 1M is enabled
    
    This fixes following build error:
    [200~ble_phy.c:1831:5: error: implicit declaration of function
    'ble_phy_apply_errata_102_106_107'

 nimble/drivers/nrf52/src/ble_phy.c | 26 +++++++++++++-------------
 1 file changed, 13 insertions(+), 13 deletions(-)

commit d1efbb1b1e8055597519c361b99a7eb44d943987
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 5 18:39:34 2018 +0200

    nimble/ll: Fix build error when ADV EXT is disabled
    
    This fixes following build error:
    
    ble_ll_adv.c:2054: undefined reference to 'ble_ll_hci_adv_mode_ext'

 nimble/controller/src/ble_ll_hci.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 7cbe9f142e8069fea5ce2b93aace320bb72a57bb
Merge: 6148bf9b f8ed10bd
Author: mkiiskila <marko@runtime.io>
Date:   Wed Sep 5 16:48:25 2018 +0300

    Merge pull request #182 from mkiiskila/dtm_chained
    
    DTM; for TX create a chained list of mbufs.

commit f8ed10bd09e43244ec9dfedb315a2f59da32011f
Author: Marko Kiiskila <marko@runtime.io>
Date:   Wed Sep 5 16:21:38 2018 +0300

    DTM; for TX create a chained list of mbufs.

 nimble/controller/src/ble_ll_dtm.c | 25 ++++++++++++++++++++-----
 1 file changed, 20 insertions(+), 5 deletions(-)

commit 6148bf9b4fe5cf519fffd013b2f82fb3bc1202e5
Merge: 5762e5b4 c8c5cae5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 5 14:40:03 2018 +0200

    Merge pull request #180 from rymanluk/phy_fix
    
    nimble/nrf52_phy: Fix for incorrectly matching access address

commit c8c5cae5a0ef2d1cbb0e8024cd0f395660e7bcab
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 5 13:49:29 2018 +0200

    nimble/nrf52_phy: Fix for incorrectly matching access address
    
    Without this controller was accepting packets with different access address than
    configured.
    
    This fixes certification testse LL/ENC/ADV/BI-02 and LL/ENC/INI/BI-01

 nimble/drivers/nrf52/src/ble_phy.c | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

commit 5762e5b4e681830dec9733b874d41f2474c84c88
Merge: 974c8d73 155782c2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Sep 5 13:56:27 2018 +0200

    Merge pull request #179 from andrzej-kaczmarek/dtm-no-assert
    
    nimble/ll/dtm: Reschedule late TX PDU

commit 155782c2084f8439e2449a5179d7ae214a97ecc8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Sep 5 13:31:04 2018 +0200

    nimble/ll/dtm: Reschedule late TX PDU
    
    No need to assert, just set for reschedule and continue.

 nimble/controller/src/ble_ll_dtm.c | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

commit 974c8d73d1c54a66df5ef4b82aadf5ed308261e7
Merge: 5456156e c10b5926
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 5 13:46:57 2018 +0200

    Merge pull request #164 from rymanluk/ll_fix
    
    nimble/ll: Certification fixes - part 1

commit c10b5926c5a6c82969dae4f8c453fed4b316da7a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 09:52:50 2018 +0200

    nimble/ll: Fix setting RxAdd flag for RPA
    
    When ble_ll_resolv_gen_rpa() returns 1 then we know RPA is used.
    Before this patch it could happen that we set incorrect RxAdd in following scenario:
    1) peer's public address has RPA
    2) peer's IRK is 0

 nimble/controller/src/ble_ll_adv.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit aab97956a28a38a868acf4689d74a962d86506fb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 09:47:03 2018 +0200

    nimble/ll: Fix setting TxAdd flag in advertising instance
    
    This patch fixes following scenario:
    Advertising instance own address type is 0x02, IRK is 0 and public address has bits as RPA.
    In such a case TxAdd flag would be incorrectly set.

 nimble/controller/src/ble_ll_adv.c | 23 ++++++++++-------------
 1 file changed, 10 insertions(+), 13 deletions(-)

commit 96f7c1d700e24318ea1f5d7a385096d5a7dc0889
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 09:50:03 2018 +0200

    nimble/ll: Fix setting RxAdd flag in the advertising
    
    Make sure to use correct address type when setting RxAdd flag

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ed2e438c7092f90f38a9885787a7084295ddbe81
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 12:08:36 2018 +0200

    nimble/ll: Fix handling direct advertising when connecting
    
    With this patch we make sure that
    1) When InitA is RPA then it is resolved if possible and verified it is
    ours address. If Privacy feature is off such advertising is dropped
    2) When InitA is identity address then we make sure it is verified in
    terms of privacy mode (if device is on resolve list) and it match our
    address
    
    This fixes LL/SEC/ADV/BV-09, BV-11

 nimble/controller/src/ble_ll_conn.c | 74 +++++++++++++++++++++++++++----------
 1 file changed, 55 insertions(+), 19 deletions(-)

commit 20f4b22ea04ca4bb12a5e7316823c9e71f4ae036
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 10:48:49 2018 +0200

    nimble/ll: Fix scanning directed advertising.
    
    If remote sends directed advertising with identity AdvA and RPA InitA
    let us try to resolve it.

 nimble/controller/src/ble_ll_scan.c | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 63bdc921ea54502241e14fa94b88d165f343350c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 10:47:09 2018 +0200

    nimble/ll: Minor coding style fix

 nimble/controller/src/ble_ll_conn.c | 28 ++++++++++++++--------------
 1 file changed, 14 insertions(+), 14 deletions(-)

commit 916ea99aeed7c7ad4f6ecc49466915d256ef6d8f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 27 14:22:10 2018 +0200

    nimble/ll: Fix getting RPA from advertising instance
    
    Make sure adva is RPA before returing it as RPA
    This fixes LL/SEC/ADV/BV-06

 nimble/controller/src/ble_ll_adv.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit ee71c08ee6c164bd18f5314c9151d175d434f87b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 27 10:43:14 2018 +0200

    nimble/ll: Fix on choosing between direct/regular advertising report
    
    This patch fixes insufficient way of checking for RPA address.
    Also refactors code a bit so ble_ll_scan_send_adv_report() gets
    already decoded (and possibly resolved) InitA and AdvA along with
    address types.
    
    This fixes LL/DDI/SCN/BV-05

 nimble/controller/src/ble_ll_scan.c | 44 +++++++++++--------------------------
 1 file changed, 13 insertions(+), 31 deletions(-)

commit 71efe569356c932b7050ef81069279a2913d04a3
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 27 10:36:49 2018 +0200

    nimble/ll: Fix checking filter policy
    
    Make sure to check policy in case of directed advertising
    Also do filter policy check after controller tries to resolve InitA

 nimble/controller/src/ble_ll_scan.c | 22 +++++++++++-----------
 1 file changed, 11 insertions(+), 11 deletions(-)

commit 479457e4f950ea11adf6f7267f486e28a2bd0ea5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 27 10:51:18 2018 +0200

    nimble/ll: Try to resolve InitA
    
    Controller needs to do it in order to decided if Directed Advertising
    Report event shall be sent to the host or not.
    
    Also, filtering check should be done after controller tries to resolve
    InitA

 nimble/controller/include/controller/ble_ll.h |  3 +++
 nimble/controller/src/ble_ll.c                | 17 +++++++++++++++++
 nimble/controller/src/ble_ll_scan.c           |  8 ++++++++
 3 files changed, 28 insertions(+)

commit d134e8bfbb641d0d371bbb1d1496b229743ce521
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 27 09:55:05 2018 +0200

    nimble/ll: Fix len od directed advertsing report

 nimble/controller/src/ble_ll_scan.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit b1c9d8f392f696796fb3392f7248207be02a8caa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Aug 23 11:42:38 2018 +0200

    nimble/ll: Use the correct address type
    
    This patch fixes obious bug when AdvA address type is used instead of
    InitA address type.
    
    This fixes LL/CON/INI/BV-10

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 55b42563b0c57c09f3cc54427c39b92ddc2820ad
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 31 11:10:11 2018 +0200

    nimble/ll: Improve starting advertising for legacy pdu
    
    In case advertising extensions are used for legacy advertising PDU let's
    allow to start advertising even scan response data has not been set.
    We do it like this as for legacy advertising it would force to set scan
    response data as all connectable advertising is scannable then. We don't
    want to do it.

 nimble/controller/src/ble_ll_adv.c | 1 +
 1 file changed, 1 insertion(+)

commit b16d21e94140a64d608f723616672bf48e324e7f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 21 14:48:25 2018 +0200

    nimble/ll: Fix starting scannable advertising
    
    This patch makes sure that there are scan response data set when
    starting scannable advertising instance.
    
    This fixes HCI/GEV/BV-04

 nimble/controller/src/ble_ll_adv.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 5456156e33d4d6a997a2846ce707badf3625d51e
Merge: fdcd2b79 3fcf385a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Aug 30 15:15:58 2018 +0200

    Merge pull request #175 from andrzej-kaczmarek/rx-enc-start-fix
    
    nimble/ll: Disconnect on unexpected PDU when starting encryption

commit fdcd2b792e21933105a164fc079a570f82f132c3
Merge: c87f01e7 5c058dd1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Aug 30 15:04:13 2018 +0200

    Merge pull request #151 from michal-narajowski/app-blemesh-onoff-level-lighting-vnd
    
    apps/blemesh_onoff_level_lighting_vnd: Add app with various models

commit c87f01e7940a1784fe6214f6a637d4b08e1da060
Merge: 46e80d7f ad94303a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Aug 30 15:04:02 2018 +0200

    Merge pull request #148 from michal-narajowski/blemesh_onoff_app
    
    apps/blemesh_onoff: Add example app implementing onoff models

commit 2f9df753d75899ae6906225ae42a0eb068861119
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 21 14:36:03 2018 +0200

    nimble/ll: Fix disabling advertising
    
    According to spec Bluetooth 5 Vol 2, Part E chapter 7.8.56:
    "Note: disabling an advertising set that is already disabled has no
    effect."

 nimble/controller/src/ble_ll_adv.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit a0f4c0fa33b7c622b226ba4b6c3035665e1aafef
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 21 11:52:17 2018 +0200

    nimble/ll: Fix checking for valid adv mode
    
    Add missing OCF which are allowed only when advertising extensions are
    used by the host.
    
    This should fix HCI/GEV/BV-02

 nimble/controller/src/ble_ll_hci.c | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit 6efc27612bb215e3daaa36b3b80d74b7820ae279
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 21 09:35:01 2018 +0200

    nimble/ll: Return Commands Status on unknown hci command
    
    As per Bluetooth 5, Vol. 2, Part E, Chapter 4.4
    
    "If the command does not begin to execute (for example, if there was a
    parameter error or the command is currently not allowed), the Command
    Status event shall be returned with the appropriate error code in the Status
    parameter, and the event associated with the sent command shall not be
    returned."
    
    This fixes HCI/GEV/BV-01

 nimble/controller/src/ble_ll_hci.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 81d402551a2e5d59ae9f300cab7e230b93946082
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 20 15:59:20 2018 +0200

    nimble/ll: Fix legacy set adv data
    
    When host use legacy HCI comands, it is possible (specification does not
    forbid this) to set advertising data when directed advertiing is
    configured.
    This patch makes it possible as it fixes HCI/CM/BV-02 test when Tester
    uses HCI_LE_Set_Advertising_Data to clear advertising data after it was
    configured to directed advertising.

 nimble/controller/src/ble_ll_adv.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit a9af69292734e942166a63e77e6566098341f743
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Aug 20 15:12:47 2018 +0200

    nimble/ll: Update peer rpa when available
    
    We need to make sure peer RPA on resolving list is the one which was
    used by remote lately.
    This fixes HCI-CM-BV-01 which test if same peer RPA is sent over
    connection  complete event and as a response on hci read peer rpa
    command

 nimble/controller/include/controller/ble_ll_resolv.h |  2 ++
 nimble/controller/src/ble_ll_adv.c                   |  3 +++
 nimble/controller/src/ble_ll_conn.c                  |  5 +++++
 nimble/controller/src/ble_ll_resolv.c                | 12 ++++++++++++
 4 files changed, 22 insertions(+)

commit 46e80d7f4c693e680068bd7d6200c3feea786d27
Merge: b1fb8a09 9b2ffa53
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 23:53:14 2018 +0200

    Merge pull request #173 from rymanluk/btshell_impr
    
    btshell: Improvements in advertising shell command

commit 3fcf385a661a8580456c621b734aedd79455425b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Aug 28 16:25:59 2018 +0200

    nimble/ll: Disconnect on unpexected PDU when starting enc
    
    As per Core 5.0, Vol 6, Part B, 5.1.3.1 we should disconnect when
    receiving unexpected PDU during encryption start.

 nimble/controller/include/controller/ble_ll_ctrl.h |  1 +
 nimble/controller/src/ble_ll_conn.c                | 13 +++++++++++++
 nimble/controller/src/ble_ll_ctrl.c                | 18 ++++++++++++++++++
 3 files changed, 32 insertions(+)

commit e0d7f1946a802665f053636e836fb5c2308d29ed
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Aug 28 16:25:32 2018 +0200

    nimble/ll: Rename helper
    
    ...it will make next patch easier to read :)

 nimble/controller/include/controller/ble_ll_ctrl.h |  2 +-
 nimble/controller/src/ble_ll_conn.c                |  8 ++--
 nimble/controller/src/ble_ll_ctrl.c                | 54 ++++++++++++++++------
 3 files changed, 44 insertions(+), 20 deletions(-)

commit ba5b0f146242c4c9ff7014edf33f3d29a37d07f6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Aug 28 16:19:34 2018 +0200

    nimble/ll: Rename local variable for better readability

 nimble/controller/src/ble_ll_conn.c | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

commit b1fb8a098a555eac4dfa9c992ba9809fe8797808
Merge: ba49e62e 5fec973d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Aug 28 15:12:14 2018 +0200

    Merge pull request #172 from andrzej-kaczmarek/hci-handler-fix
    
    nimble/ll: Fix HCI Read Authenticated Payload Timeout handler

commit 9b2ffa532d21c7cee95130aae328b1077f309c71
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 14:33:31 2018 +0200

    btshell: Make sure to have scannable 0 when directed
    
    Since for legacy_pdu scannable is set autmatically, make sure it is off
    when directed advertising is choosen

 apps/btshell/src/cmd.c | 4 ++++
 1 file changed, 4 insertions(+)

commit eecc9aac5ed18235b9cf47d0dca155189ead1232
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 14:09:57 2018 +0200

    btshell: Add option for directed advertising in the shell
    
    Note when peer_addr is set then directed is marked to true however it
    can be overwriten by option "directed"

 apps/btshell/src/cmd.c | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 0d32142ed36171aa3fffad193972b624115fdf36
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 28 14:04:19 2018 +0200

    btshell: Set connectable/scannable to 1 when legacy is used
    
    For the case when legacy adv is used in most of cases connectable and
    scannable shall be set, therefore make it default.
    
    Those values can be overwritten

 apps/btshell/src/cmd.c | 23 ++++++++++++++---------
 1 file changed, 14 insertions(+), 9 deletions(-)

commit 5fec973dd6abf44962d8f4ff960363971157ffe7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Aug 28 11:18:39 2018 +0200

    nimble/ll: Fix HCI Read Authenticated Payload Timeout handler

 nimble/controller/src/ble_ll_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ba49e62e0f2d565a699385ca401f6cbbe4f13c37
Merge: af8b5332 2ca54a71
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 27 09:35:08 2018 +0200

    Merge pull request #171 from michal-narajowski/fix-porting-makefile
    
    porting: Delete non-existing file from Makefile.defs

commit 2ca54a719cfb0202c23cc7699f0bc78df485c7bf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 27 09:32:29 2018 +0200

    porting: Delete non-existing file from Makefile.defs
    
    This file was deleted in 2fdca20f885c4c8341497696f08fcc5f92edd9b8.

 porting/nimble/Makefile.defs | 1 -
 1 file changed, 1 deletion(-)

commit 5c058dd19e04754631ca02416ebef36e2b623f0d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 26 13:52:59 2018 +0200

    apps/blemesh_models_example_2: Add app with various models
    
    This is a application demonstrating a Bluetooth mesh node in
    which Root element has following models
    
    - Generic OnOff Server
    - Generic OnOff Client
    - Generic Level Server
    - Generic Level Client
    - Generic Power OnOff Server
    - Generic Power OnOff Setup Server
    - Generic Power OnOff Client
    - Light Lightness Server
    - Light Lightness Setup Server
    - Light Lightness Client
    - Light CTL Server
    - Light CTL Setup Server
    - Light CTL Client
    - Vendor Model
    
    And Secondary element has following models
    
    - Generic OnOff Server
    - Generic OnOff Client
    - Generic Level Server
    - Generic Level Client
    - Light CTL Temperature Server
    
    Prior to provisioning, an unprovisioned beacon is broadcast that contains
    a unique UUID. Each button controls the state of its
    corresponding LED and does not initiate any mesh activity

 apps/blemesh_models_example_2/README.md            |  101 +
 apps/blemesh_models_example_2/pkg.yml              |   38 +
 apps/blemesh_models_example_2/src/ble_mesh.c       |   93 +
 apps/blemesh_models_example_2/src/ble_mesh.h       |   34 +
 apps/blemesh_models_example_2/src/common.h         |   16 +
 .../src/device_composition.c                       | 1944 ++++++++++++++++++++
 .../src/device_composition.h                       |  182 ++
 apps/blemesh_models_example_2/src/main.c           |  198 ++
 apps/blemesh_models_example_2/src/publisher.c      |  241 +++
 apps/blemesh_models_example_2/src/publisher.h      |   27 +
 apps/blemesh_models_example_2/src/state_binding.c  |  183 ++
 apps/blemesh_models_example_2/src/state_binding.h  |   13 +
 apps/blemesh_models_example_2/src/transition.c     |  678 +++++++
 apps/blemesh_models_example_2/src/transition.h     |   58 +
 apps/blemesh_models_example_2/syscfg.yml           |   56 +
 15 files changed, 3862 insertions(+)

commit ad94303af598bdb05bb05d3024e51f166518d9eb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 25 15:18:24 2018 +0200

    apps/blemesh_models_example_1: Add app implementing onoff models
    
    This is a simple application demonstrating a Bluetooth mesh multi-element node.
    Each element has a mesh onoff client and server
    model which controls one of the 4 sets of buttons and LEDs .
    
    Prior to provisioning, an unprovisioned beacon is broadcast that contains
    a UUID. Each button controls the state of its
    corresponding LED and does not initiate any mesh activity.
    
    The models for button 1 and LED 1 are in the node's root element.
    The 3 remaining button/LED pairs are in elements 1 through 3.
    Assuming the provisioner assigns 0x100 to the root element,
    the secondary elements will appear at 0x101, 0x102 and 0x103.
    
    After provisioning, the button clients must
    be configured to publish and the LED servers to subscribe.
    
    If a LED server is provided with a publish address, it will
    also publish its status on an onoff state change.
    
    If a button is pressed only once within a 1 second interval, it sends an
    "on" message. If it is pressed more than once, it
    sends an "off" message. The buttons are quite noisy and are debounced in
    the button_pressed() interrupt handler. An interrupt within 250ms of the
    previous is discarded. This might seem a little clumsy, but the alternative of
    using one button for "on" and another for "off" would reduce the number
    of onoff clients from 4 to 2.

 apps/blemesh_models_example_1/README.md  |  79 ++++
 apps/blemesh_models_example_1/pkg.yml    |  34 ++
 apps/blemesh_models_example_1/src/main.c | 690 +++++++++++++++++++++++++++++++
 apps/blemesh_models_example_1/syscfg.yml |  53 +++
 4 files changed, 856 insertions(+)

commit af8b5332a5492c2d5f5feac5a4ed8c2d927ef790
Merge: 629dc2a6 babce918
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Aug 24 12:05:14 2018 +0200

    Merge pull request #165 from michal-narajowski/mesh-fixes-port
    
    Sync with Zephyr Mesh

commit fecbc729a834a9dccceabee0036cb9e842f0f32a
Author: Martin Turon <mturon@nestlabs.com>
Date:   Thu Aug 23 22:07:17 2018 -0700

    [linux] allow setting of hci device id for socket.

 nimble/transport/socket/src/ble_hci_socket.c | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

commit 629dc2a6aa3b7261afe8c1222d7345db939141be
Merge: 34e71375 cc31c7cc
Author: aditihilbert <aditi@runtime.io>
Date:   Thu Aug 23 18:17:39 2018 -0700

    Merge pull request #167 from aditihilbert/master
    
    Configured the doxygen comments to be pulled into docs for BLE

commit cc31c7ccd459ae94c92148a96ac1a8ed5ca5ba86
Author: Aditi Hilbert <aditi@runtime.io>
Date:   Thu Aug 23 18:10:42 2018 -0700

    Configured the doxygen comments to be pulled into docs for BLE

 docs/ble_hs/ble_att.rst   | 7 +++++--
 docs/ble_hs/ble_gap.rst   | 8 ++++----
 docs/ble_hs/ble_gattc.rst | 8 ++++----
 docs/ble_hs/ble_gatts.rst | 8 ++++----
 4 files changed, 17 insertions(+), 14 deletions(-)

commit 34e71375d680389fd0cdd8804518fa9b6b634696
Author: aditihilbert <aditi@runtime.io>
Date:   Thu Aug 23 17:18:27 2018 -0700

    Update ble_att.rst

 docs/ble_hs/ble_att.rst | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 619400749bb3062b87a520b8cfdea7c25967f1c2
Author: aditihilbert <aditi@runtime.io>
Date:   Thu Aug 23 16:53:19 2018 -0700

    Update ble_att.rst

 docs/ble_hs/ble_att.rst | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b08f99fc145968819d1a2a60eeb70d308bcfc488
Author: aditihilbert <aditi@runtime.io>
Date:   Thu Aug 23 16:04:08 2018 -0700

    Update ble_att.rst

 docs/ble_hs/ble_att.rst | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit babce918f6397ac88c2170545e485e90352d58c1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Aug 21 16:49:21 2018 +0200

    mesh: Fix heartbeat subscription state handling
    
    PTS version 7.3.0 incorporates some errata which change the expected
    behavior of the heartbeat subscription state. Update the code so that
    the following tests pass successfully:
    
    MESH/NODE/CFG/HBS/BV-01
    MESH/NODE/CFG/HBS/BV-02
    MESH/NODE/CFG/HBS/BV-03
    MESH/NODE/CFG/HBS/BV-04

 nimble/host/mesh/src/cfg_srv.c | 32 ++++++++++++++++++++------------
 1 file changed, 20 insertions(+), 12 deletions(-)

commit 4b9f59408629edc7d490789f4dc130091ac60076
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Aug 21 16:45:00 2018 +0200

    mesh: Initialize PB-GATT advertising data at the right time
    
    Some things, such as UUID, URI or even the local name may be different
    when bt_mesh_prov_enable() is called compared to when bt_mesh_init()
    was called. Create the advertising data on-demand each time when
    enabling PB-GATT.

 nimble/host/mesh/src/proxy.c | 92 ++++++++++++++++++++++++--------------------
 1 file changed, 50 insertions(+), 42 deletions(-)

commit 0fa9b57e100c91c07a11fdaaf579e64dff38d48d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 20 16:51:06 2018 +0200

    mesh: Clarify confusing log message
    
    Normally App Keys are identified using the AppKey Index value (a 12
    bit value in practice), whereas the stack-internal array index has
    very little relevance.

 nimble/host/mesh/src/transport.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e932b20ce3200303478560f6911c1cff61efeb95
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 20 16:49:38 2018 +0200

    mesh: Kconfig: Tweak RX SDU value
    
    Update the RX SDU Kconfig value to something that reflects better
    current use cases and doesn't waste memory needlessly. Also lower the
    minimum to two segments, since while many samples need three for their
    composition data (typically the biggest transferred payload), it's
    possible to have a very simple node whose composition fits in two
    segments.

 nimble/host/mesh/syscfg.yml | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

commit 677152bc7e4122a5671938088a571d5a9210c4c7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 20 16:48:33 2018 +0200

    mesh: Improve outgoing segment count configuration
    
    The Mesh specification doesn't support more than 32 transport layer
    segments, the way the number was so far derived from the advertising
    buffer count could result in a highre numbe than 32, thereby wasting
    memory. Make the number of supported segments build-time configurable
    through a new BT_MESH_TX_SEG_MAX configuration option.

 apps/blemesh/syscfg.yml              |  3 +++
 apps/blemesh_light/syscfg.yml        |  4 +++-
 apps/blemesh_shell/syscfg.yml        |  3 +++
 nimble/host/mesh/include/mesh/glue.h |  3 +++
 nimble/host/mesh/src/transport.c     |  9 ++++++++-
 nimble/host/mesh/src/transport.h     |  3 +--
 nimble/host/mesh/syscfg.yml          | 37 ++++++++++++++++++++++++++++--------
 7 files changed, 50 insertions(+), 12 deletions(-)

commit 3dd8190cb5a9aa019445d66a522fcc040bb1a9e8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Aug 20 16:05:28 2018 +0200

    mesh: Fix missing semicolon for debug log
    
    Without this it's not possible to build cfg_srv.c with debug logs
    enabled.

 nimble/host/mesh/src/cfg_srv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1f7227ed860c8783ec874effde4c0bd620977187
Merge: cce84d0a 20d45639
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Aug 16 13:44:34 2018 +0200

    Merge pull request #161 from rymanluk/mesh_fix
    
    mesh/transport: Fix calculating seqAuth

commit 20d45639a6be89e40f76641929016a0ef2667757
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 14 14:21:50 2018 +0200

    mesh/transport: Fix calculating seqAuth
    
    This patch fixes case where Mesh is receiving segmented data with
    SEQ and SeqZero as in logs below:
    
    bt_mesh_trans_recv: src 0x07FF dst 0x0001 seq 0x00031FFF friend_match 0
    bt_mesh_trans_recv: Payload dd7ffc016e5c7f861272e5f7577a6644
    trans_seg: ASZMIC 0 AKF 1 AID 0x1D
    trans_seg: SeqZero 0x1FFF SegO 0 SegN 1
    trans_seg: ######## seq_auth=204799
    
    bt_mesh_trans_recv: src 0x07FF dst 0x0001 seq 0x00032000 friend_match 0
    bt_mesh_trans_recv: Payload dd7ffc21abb5a7
    trans_seg: ASZMIC 0 AKF 1 AID 0x1D
    trans_seg: SeqZero 0x1FFF SegO 1 SegN 1
    trans_seg: ######## seq_auth=212991

 nimble/host/mesh/src/transport.c | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

commit cce84d0a880ccfbc0f108c1d4dcbefae0b391275
Merge: 4a7524de 774db595
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Tue Aug 14 16:36:35 2018 -0700

    Merge pull request #162 from ccollins476ad/spurious-update
    
    nimble/host: Remove spurious conn-update callback

commit 4a7524de4010f623cd362ac0bc7bb2c323db6f56
Merge: 44380767 22f19dc4
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Tue Aug 14 15:32:02 2018 -0700

    Merge pull request #156 from ccollins476ad/indicate-custom-comment
    
    nimble/host: Fix ble_gattc_indicate_custom comment

commit 4438076703bb9afde271b48f377a1f631ce44f92
Merge: 019c7cf0 7686e32d
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Tue Aug 14 15:31:47 2018 -0700

    Merge pull request #159 from ccollins476ad/fix-no-data-len-ext
    
    Fix build error when data length ext. disabled

commit 774db595f91bdc15a0f97bd2c28161440a261f1c
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 14 15:25:23 2018 -0700

    nimble/host: Remove spurious conn-update callback
    
    The GAP callback was incorrectly being called with an event type of
    BLE_GAP_EVENT_CONN_UPDATE each time a connection was terminated.  For
    example, a typical disconnect event might look like this in the log:
    
        023276 [ts=181843696us, mod=82 level=1] connection update; rc=531
        023277 [ts=181921816us, mod=82 level=1] disconnect; reason=531
    
    In most cases, only the second line should be present.  The "connection
    update" event should only be signaled on termination if an update
    procedure for the connection happened to be in progress at the time.
    In that case, the connection termination causes the update procedure to
    fail.

 nimble/host/src/ble_gap.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 7686e32dd0bea835bd4d40031e8c580e5ae9d073
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 9 20:53:35 2018 -0700

    Fix build error when data length ext. disabled

 nimble/controller/src/ble_ll_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 019c7cf0d9dbf7fa09fb84f69779c0b96cb5150e
Merge: 4359e732 f07c9662
Author: Sterling Hughes <sterlinghughes@users.noreply.github.com>
Date:   Tue Aug 7 12:40:41 2018 -0700

    Merge pull request #90 from turon/pr/npl-linux
    
    [linux] Add linux port of nimble using npl.

commit 22f19dc472992c6fc5847ed4c9ac40158b880ad0
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 1 15:42:38 2018 -0700

    nimble/host: Fix ble_gattc_indicate_custom comment

 nimble/host/include/host/ble_gatt.h | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 4359e7323d9b2de4ea04977633c541d6687b1dda
Merge: 44a06f5b 907cf3a0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 1 15:26:19 2018 +0200

    Merge pull request #155 from andrzej-kaczmarek/ll-build-fix
    
    nimble/ll: Fix build error with privacy disabled

commit 907cf3a0f9dad9d43e5c07b4945b5e163b8dfc01
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 1 15:24:36 2018 +0200

    nimble/ll: Fix build error with privacy disabled
    
    DLE command handler was not used in such case.

 nimble/controller/src/ble_ll_hci.c | 2 ++
 1 file changed, 2 insertions(+)

commit 44a06f5b2c4d64a6e51d8a55599c7d36abb00630
Merge: 8a204e01 c23aaad3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 1 14:41:07 2018 +0200

    Merge pull request #153 from andrzej-kaczmarek/ll-assert-syscfg
    
    nimble/ll: Make vnd event on assert configurable

commit 8a204e017ea32cc51ae64d548e1d56048aed6f72
Merge: cb7361cb b01e42bf
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 1 14:39:36 2018 +0200

    Merge pull request #135 from sjanc/hci
    
    Some HCI handling improvements

commit cb7361cb245b1748507d9ee981e7a073668fdd81
Merge: 99e42ca7 2ab834b9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 31 17:47:13 2018 +0200

    Merge pull request #154 from andrzej-kaczmarek/ll-dle-sugg-fix
    
    nimble/ll: Fix setting suggested length values

commit 2ab834b9e0b5d76cc767a6a7d4da6a965a0b66ae
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 31 15:46:56 2018 +0200

    nimble/ll: Fix setting suggested length values
    
    We can set each suggested value independently (or actually do whatever
    we want, but we want to follow host suggestion).

 nimble/controller/src/ble_ll_hci.c | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)

commit c23aaad31b8dc771020a85a6b6044cf02b05bef1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Jul 29 12:12:36 2018 +0200

    nimble/ll: Make vnd event on assert configurable
    
    This event is only useful when talking to external hosts, so no need to
    have it enabled in combined builds. Now it's configurable and disabled
    by default on all builds except for builds without NimBLE host.

 nimble/controller/include/controller/ble_ll.h |  2 +-
 nimble/controller/syscfg.yml                  | 12 ++++++++++++
 2 files changed, 13 insertions(+), 1 deletion(-)

commit 99e42ca7da0f1d916dabc14586d8d2eaf4da3634
Merge: b03c6062 f31f37df
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Jul 28 16:10:19 2018 +0200

    Merge pull request #152 from evansco/fix-ext-adv-set-tx-power
    
    nimble/controller: Fix setting of TX power in extended advertising

commit f31f37df20e534f6a71d2fc0d9448bef8900a357
Author: Evan Scott <evansco@umich.edu>
Date:   Fri Jul 27 22:32:15 2018 -0500

    Fix controller bug pulling TX power setting from wrong array during extended advertising configuration

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b01e42bfc94dafbd2a7d674bbe63508356041d0f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 20 15:36:02 2018 +0200

    nimble/ll: Improve LE Set Extended Scan Parameters command parsing
    
    This commands is variable length and should verify if all required
    bytes were provided by host.

 nimble/controller/include/controller/ble_ll_scan.h |  2 +-
 nimble/controller/src/ble_ll_hci.c                 |  5 ++---
 nimble/controller/src/ble_ll_scan.c                | 14 +++++++++++++-
 3 files changed, 16 insertions(+), 5 deletions(-)

commit a6ff03329a195d040393d1bed7309d2406654218
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 20 15:33:01 2018 +0200

    nimble/ll: Sort HCI commands handlers in increasing order
    
    This make is simpler to check which commands are supported.

 nimble/controller/src/ble_ll_hci.c | 130 +++++++++++++++++++------------------
 1 file changed, 67 insertions(+), 63 deletions(-)

commit 48e48f9f4b683ccdcbc3587f52227162d517605d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 20 15:08:12 2018 +0200

    nimble/ll: Validate HCI advertising data and scan response
    
    Mkae sure no invalid memory is read if malformatted HCI commands are
    received.

 nimble/controller/include/controller/ble_ll_adv.h |  7 ++++---
 nimble/controller/src/ble_ll_adv.c                | 20 ++++++++++++++++----
 nimble/controller/src/ble_ll_hci.c                |  4 ++--
 3 files changed, 22 insertions(+), 9 deletions(-)

commit 9103cae9605ee37911dc53b5cb900013944f1a47
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 20 12:24:20 2018 +0200

    nimble/ll: Validate LE Extended Create Connection Cmd buffer
    
    Make sure we don't access invalid memory when parsing command buffer.

 nimble/controller/src/ble_ll_conn_hci.c  | 22 +++++++++++++++++++++-
 nimble/controller/src/ble_ll_conn_priv.h |  2 +-
 nimble/controller/src/ble_ll_hci.c       |  2 +-
 3 files changed, 23 insertions(+), 3 deletions(-)

commit 8bc3872ca7531ad90e2091fb8b31fa696a346885
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 20 09:57:20 2018 +0200

    nimble/ll: Remove unused parameter from ble_ll_dtm_end_test
    
    cmdbuf is not used by this handler.

 nimble/controller/src/ble_ll_dtm.c      | 2 +-
 nimble/controller/src/ble_ll_dtm_priv.h | 2 +-
 nimble/controller/src/ble_ll_hci.c      | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 2fdca20f885c4c8341497696f08fcc5f92edd9b8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 20 09:55:03 2018 +0200

    nimble/ll: Fix handling of unknown commands
    
    For commands not supported by controller we should not validate length
    but just reply with Unknown HCI Command error.

 nimble/controller/src/ble_ll_hci.c | 253 +++++++++++++++++++++++++++----------
 nimble/host/src/ble_gap.c          |   2 +-
 nimble/host/src/ble_hs_hci_cmd.c   |   2 +-
 nimble/include/nimble/hci_common.h |   6 +-
 nimble/src/hci_common.c            | 109 ----------------
 5 files changed, 191 insertions(+), 181 deletions(-)

commit 5d847917556c6de8998e91132585b31847c3964a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 19 15:38:59 2018 +0200

    nimble/ll: Handle negative LTK key request reply separately
    
    This make separate handler for each command as well as filling
    reponse length from handler. Make it consistent with other code.

 nimble/controller/src/ble_ll_conn_hci.c  | 73 ++++++++++++++++++++++++++------
 nimble/controller/src/ble_ll_conn_priv.h |  5 ++-
 nimble/controller/src/ble_ll_hci.c       |  5 ++-
 3 files changed, 68 insertions(+), 15 deletions(-)

commit b03c606220083f03a6f4f9ad48d24a3556ac0d2e
Merge: ace178a2 880d5246
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 26 14:00:00 2018 +0200

    Merge pull request #150 from michal-narajowski/glue-net-buf-ports
    
    mesh: glue: Add utility net_buf functions for later use

commit ace178a2e3a6aa7bc4b60811564152a037168cb3
Merge: cb69596a c8909e00
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 26 13:58:48 2018 +0200

    Merge pull request #149 from michal-narajowski/memleak-fix
    
    mesh: Fix a possible memory leak

commit 880d52460ecbc7c20ff137419d6f6717a6d9c433
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 26 13:50:40 2018 +0200

    mesh: glue: Add utility net_buf functions for later use
    
    These functions will be used in an app that will be added in the future.

 nimble/host/mesh/include/mesh/glue.h |  2 ++
 nimble/host/mesh/src/glue.c          | 22 ++++++++++++++++++++++
 2 files changed, 24 insertions(+)

commit c8909e00183e6fa1969ecfc2ee1b8168288dea61
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 26 13:39:54 2018 +0200

    mesh: Fix a possible memory leak

 nimble/host/mesh/src/access.c | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

commit cb69596a6a84523c233be5237327657e69155dd4
Merge: 24c2b2cc 2f2250fc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 25 10:01:14 2018 +0200

    Merge pull request #146 from mehulhirpara/mybranch
    
    Added support to configure BLE Mesh device name

commit 24c2b2cc23a77d9dd695a44597c1e8480c80640f
Merge: 847a53b8 3dbc2dc8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 24 16:55:54 2018 +0200

    Merge pull request #147 from michal-narajowski/npl-updates
    
    nimble/porting: Add modlog dummy header to fix build issues

commit 3dbc2dc829daae37fc2da47e749d940984c50c32
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 18 11:00:23 2018 +0200

    nimble/porting: Add modlog dummy header to fix build issues
    
    Latest changes to logging library caused build failures for systems
    porting nimble.

 porting/nimble/include/modlog/modlog.h | 54 ++++++++++++++++++++++++++++++++++
 1 file changed, 54 insertions(+)

commit 847a53b85b85b08dfae79cb0b425e1e381a4a4a0
Merge: b95d8976 841b9cc8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 24 16:20:43 2018 +0200

    Merge pull request #145 from michal-narajowski/mesh-settings-fix
    
    mesh: Add option to not compile Mesh settings/storage

commit 2f2250fc88d326fcb4a265eba743a60f6208b8bb
Author: Mehul Hirpara <mehul.hirpara@inedasystems.com>
Date:   Thu Jul 19 10:32:12 2018 +0530

    Added support for configure device name

 nimble/host/mesh/include/mesh/glue.h | 2 +-
 nimble/host/mesh/syscfg.yml          | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 841b9cc8ba6b468d795358d39737a5869334907f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 18 11:49:36 2018 +0200

    mesh: Add option to not compile Mesh settings/storage

 nimble/host/mesh/include/mesh/glue.h | 21 ++++++++++++++-------
 nimble/host/mesh/pkg.yml             |  6 ++++--
 nimble/host/mesh/src/glue.c          |  9 ++++++++-
 nimble/host/mesh/src/mesh.c          |  6 +++---
 nimble/host/mesh/src/settings.c      |  6 ++++++
 5 files changed, 35 insertions(+), 13 deletions(-)

commit b95d897680819b0788b92636defaae5b5ebfaf6b
Merge: 88c3539f 54d77404
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jul 18 10:41:38 2018 +0200

    Merge pull request #143 from andrzej-kaczmarek/sm-debug-mode
    
    nimble/host: Add support for SM debug mode

commit 88c3539fb5c5e6bf557f3eb28236593ded9f9131
Merge: 8edad8a5 ada0e731
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 18 10:35:23 2018 +0200

    Merge pull request #142 from michal-narajowski/mesh-storage-port
    
    Mesh sync with Zephyr (persistent storage)

commit 8edad8a5a89fbe0d63c08653f4c51dd039df6a04
Merge: d5b913d8 e8efcf13
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Wed Jul 11 13:07:48 2018 -0700

    Merge pull request #140 from ccollins476ad/log-to-modlog
    
    Switch everything over to modlog

commit 54d774044f792dff61f1dfcee76caa6fa83b9b35
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 10 14:04:01 2018 +0200

    nimble/host: Add support for SM debug mode
    
    New syscfg option allows to enable SM debug mode which uses predefined
    DH key pair, as per core spec.

 nimble/host/src/ble_sm_alg.c | 19 +++++++++++++++++++
 nimble/host/syscfg.yml       |  7 +++++++
 2 files changed, 26 insertions(+)

commit ada0e731e6704afb9240ee2fad18770368553a6a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 9 10:39:19 2018 +0200

    apps/blemesh: Add option to enable Mesh persistent storage

 apps/blemesh/src/main.c | 10 +++++++++-
 apps/blemesh/syscfg.yml |  3 +++
 2 files changed, 12 insertions(+), 1 deletion(-)

commit e32e2c83de95b6b962025442d58554eb2838e321
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 6 15:55:33 2018 +0200

    apps/blemesh_light: Add option to enable Mesh persistent storage

 apps/blemesh_light/src/main.c | 8 ++++++++
 apps/blemesh_light/syscfg.yml | 3 +++
 2 files changed, 11 insertions(+)

commit eb86444d3c44cddd846475f457e46b7a2ab084ee
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 6 15:55:04 2018 +0200

    apps/blemesh_shell: Add option to enable Mesh persistent storage

 apps/blemesh_shell/syscfg.yml | 2 ++
 1 file changed, 2 insertions(+)

commit 7b965080939ac1b64d5f8363a1694a85244efd2d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 6 15:37:19 2018 +0200

    mesh: settings: Fix conf setting paths
    
    Mynewt doesn't support Setting modules. We need specify a name
    of configuration handler without '/'.

 nimble/host/mesh/src/settings.c | 49 ++++++++++++++++++++---------------------
 1 file changed, 24 insertions(+), 25 deletions(-)

commit 9cc8c3a4234a7ec4048a50e186f961991d580233
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 18:17:26 2018 +0200

    mesh: cfg_srv: Ignore Prohibited element addresses
    
    The Configuration Model specification states that all non-unicast
    addresses given as the address of an element are Prohibited. The
    correct action for Prohibited parameter values is to ignore the
    message. As of writing this patch the PTS does not enforce this, but
    it might in the future (as it does for many other Prohibited values).

 nimble/host/mesh/src/cfg_srv.c | 94 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 94 insertions(+)

commit 91acdc4a877f1c88f835320c02d5876cc50ae4ad
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 18:15:13 2018 +0200

    mesh: Fix checking for model subscription address
    
    Previously the code only checked if any of the models within an
    element had the destination address in their subscription list. After
    that check the specific model that the message was addressed to was
    not verified to have that address in it's subscription list. This
    patch fixes the problem.

 nimble/host/mesh/src/access.c | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit a216e3745ad672c8e0ae7118f6f554c959752c57
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 18:12:43 2018 +0200

    mesh: Fix cyclic rewriting to flash when restoring state
    
    When we're reading the initial state from flash, calling the various
    internal functions was leading to scheduling a rewrite to flash. Add
    an extra parameter to the appropriate functions so they know when
    they're called due to active configuration by a configuration client,
    and when they're called due to restoring the state from flash.
    
    This was not only wasting flash space, but also causing erroneous
    behavior with the FCB settings backend if there was an intermediate
    node reset operation stored, followed by a reprovisioning. The node
    reset entries would cause them to be re-appened after the second valid
    provisioning, leading to an incomplete node state.

 nimble/host/mesh/include/mesh/testing.h |  2 +-
 nimble/host/mesh/src/cfg_srv.c          | 57 ++++++++++++++++++++-------------
 nimble/host/mesh/src/foundation.h       |  4 +--
 nimble/host/mesh/src/settings.c         |  4 +--
 4 files changed, 39 insertions(+), 28 deletions(-)

commit 562e4503cccc75081b5973b0ee23557c5a6ca005
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 18:08:10 2018 +0200

    mesh: Fix redundant model publication clearing
    
    If the model publication is not enabled, we should return success,
    however no other steps need to be done. This also helps avoid writing
    redundant entries to flash when resetting a node that never had model
    publication enabled.

 nimble/host/mesh/src/cfg_srv.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 902a6c50213f0dce815f2a3924b40047a1497f18
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 18:07:42 2018 +0200

    mesh: Fix initialization order during node reset
    
    There were several things broken with the initialization order during
    node reset:
    
    - The model->flags should not be touched since the writing to
    persistent storage happends through delayed work, and the flags
    need to be kept until that.
    
    - The unprovision() function should only be called at the very end of
    the reset procedure, since it calls model-specific init functions
    which may clear things which the earlier reset routines depend on.

 nimble/host/mesh/src/access.c  | 1 -
 nimble/host/mesh/src/cfg_srv.c | 1 +
 nimble/host/mesh/src/mesh.c    | 4 ++--
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 6c9cd2bd6687dfb114bfe3b1b922722b023dd753
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 18:05:24 2018 +0200

    mesh: Fix (re)transmit interval handling
    
    The adv_send() function was incorrectly decoding the 5-bit value (it
    was using it directly as milliseconds), which effectively lead to the
    code always picking the controller's minimum supported interval.
    
    Fix this issue, but do it by simplifying the (re)transmission state
    tracking so that the state is always stored in the original "packed"
    8-bit value, where 5 bits are reserved for the interval, and 3 for the
    count.

 nimble/host/mesh/include/mesh/access.h |  4 ++--
 nimble/host/mesh/src/adv.c             | 29 ++++++++++++++++-------------
 nimble/host/mesh/src/adv.h             | 11 +++++------
 nimble/host/mesh/src/beacon.c          | 17 +++++++----------
 nimble/host/mesh/src/friend.c          |  6 ++----
 nimble/host/mesh/src/net.c             |  4 +---
 nimble/host/mesh/src/prov.c            |  6 ++----
 nimble/host/mesh/src/transport.c       | 12 +++---------
 8 files changed, 38 insertions(+), 51 deletions(-)

commit 9cca866da839e2b7b0209753f3ace665283c0bfe
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:58:07 2018 +0200

    mesh: Fix build error when LPN is not enabled
    
    Some versions of gcc do not seem to compile out the inaccessible code
    in this case and instead give the following error:
    
    subsys/bluetooth/host/mesh/transport.c:419: undefined reference to
    `bt_mesh_lpn_poll'
    
    This happens at least when building samples/bluetooth/mesh for
    native_posix on Fedora 28.

 nimble/host/mesh/src/transport.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit bca3eb33771d5aeeaf01260f5259936ea4840320
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:57:30 2018 +0200

    mesh: Fix reference to CONFIG_BT_MESH_FRIEND
    
    The Kconfig symbols use BT_* and not BLUETOOTH_*.

 nimble/host/mesh/include/mesh/glue.h | 1 -
 nimble/host/mesh/src/cfg_srv.c       | 2 +-
 2 files changed, 1 insertion(+), 2 deletions(-)

commit 15f4d06e10a1e492982e6e5c1811357ca578d2ac
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:51:58 2018 +0200

    mesh: Remove redundant ivu_unknown variable
    
    Instead of having an ivu_unknown variable to track when we can ignore
    the 96-hour minimum duration requirement, simply set the duration to
    the minimum (96 hours) in the places where ivu_unknown would have been
    1.

 nimble/host/mesh/src/net.c      | 17 ++++++++---------
 nimble/host/mesh/src/net.h      |  1 -
 nimble/host/mesh/src/settings.c |  1 -
 3 files changed, 8 insertions(+), 11 deletions(-)

commit f14a989197b8b6f369f0f6bb1a39201c9a8eed52
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:51:04 2018 +0200

    mesh: Fix IV Update duration tracking
    
    When the IV Update state enters Normal operation or IV Update in
    Progress, we need to keep track of how many hours has passed in the
    state, since the specification requires us to remain in the state at
    least for 96 hours (Update in Progress has an additional upper limit
    of 144 hours).
    
    In order to fulfil the above requirement, even if the node might be
    powered off once in a while, we need to store persistently how many
    hours the node has been in the state. This doesn't necessarily need to
    happen every hour (thanks to the flexible duration range). The exact
    cadence will depend a lot on the ways that the node will be used and
    what kind of power source it has.
    
    Since there is no single optimal answer, this patch adds a new
    configuration option, which allows specifying a divider, i.e. how many
    intervals the 96 hour minimum gets split into. After each interval the
    duration that the node has been in the current state gets stored to
    flash. E.g. the default value of 4 means that the state is saved every
    24 hours (96 / 4).

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/mesh.c          |  6 +--
 nimble/host/mesh/src/net.c           | 72 +++++++++++++++++-------------------
 nimble/host/mesh/src/net.h           | 27 ++++++--------
 nimble/host/mesh/src/settings.c      | 28 +++++++-------
 nimble/host/mesh/src/settings.h      |  2 +-
 nimble/host/mesh/syscfg.yml          | 24 ++++++++++++
 7 files changed, 89 insertions(+), 71 deletions(-)

commit a6c6434cf76f3392b4757100e7f35a8184d8bf6a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:42:26 2018 +0200

    mesh: shell: Add persistent storage support
    
    Add persistent storage support to the mesh shell module and app.

 nimble/host/mesh/include/mesh/glue.h |  5 ++++-
 nimble/host/mesh/src/shell.c         | 22 +++++++++++++++++-----
 2 files changed, 21 insertions(+), 6 deletions(-)

commit 66491f74d40e72784f216efc92a86e6c96e3bb9b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:26:36 2018 +0200

    mesh: Expose bt_mesh_is_provisioned() publicly
    
    After introducing persistent storage, it's useful for an app to check
    if the node has been provisioned or not.

 nimble/host/mesh/include/mesh/main.h | 11 +++++++++++
 nimble/host/mesh/src/mesh_priv.h     |  1 +
 2 files changed, 12 insertions(+)

commit 89a72ce3b26b04c6dddf966e705a37674af79a95
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:24:54 2018 +0200

    mesh: Remove sequence number from bt_mesh_provision()
    
    The sequence number was acting as a stop-gap for missing persistent
    storage. Now that we have the settings support in place it's no longer
    needed.

 nimble/host/mesh/include/mesh/main.h | 5 ++---
 nimble/host/mesh/src/mesh.c          | 6 +++---
 nimble/host/mesh/src/prov.c          | 2 +-
 nimble/host/mesh/src/shell.c         | 2 +-
 4 files changed, 7 insertions(+), 8 deletions(-)

commit 563413b959ed0b0e23822203ee158d6c6a26b834
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:23:35 2018 +0200

    mesh: Fix sequence number restoring
    
    The logic for restoring the sequence number was flawed in that it
    would not always cause an incremented sequence write upon the
    transmission of the first packet. The reason the code didn't work is
    that it assumed the stored value was a multiple of SEQ_STORE_RATE,
    however since the sequence number is stored in a deferred fashion
    that's not always true.

 nimble/host/mesh/src/settings.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 1a8f522094bb66fbaab656ebe500d71feffaee8f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:23:12 2018 +0200

    mesh: Fix updating RPL for locally originated messages
    
    We can implicitly trust locally originated messages, so there's no
    need to burden the RPL with them.

 nimble/host/mesh/src/transport.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 35909e8bf55d0f82152883fec5512fee60dc7393
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:22:48 2018 +0200

    mesh: Support for storing common configuration states
    
    Add support for storing the remaining configuration server model
    states (all of which are one byte values). The states are stored under
    a single settings key bt/mesh/Cfg.

 nimble/host/mesh/src/cfg_srv.c    |  34 ++++++++++-
 nimble/host/mesh/src/foundation.h |   1 +
 nimble/host/mesh/src/net.h        |   1 +
 nimble/host/mesh/src/settings.c   | 117 ++++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h   |   1 +
 5 files changed, 153 insertions(+), 1 deletion(-)

commit 04b6f733cf9706941e4fc6aab538c0a8820f86dc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:20:27 2018 +0200

    mesh: Support for storing heartbeat publication persistently
    
    Add support for storing the heartbeat publication persistently. The
    information is only stored as "publish indefinitely" or as "periodic
    publishing disabled" since we can't know for how long the node is
    powered off. The information is stored under the settings key
    bt/mesh/HBPub.

 nimble/host/mesh/include/mesh/cfg_srv.h |   4 +-
 nimble/host/mesh/src/cfg_srv.c          |  17 +++++
 nimble/host/mesh/src/foundation.h       |   2 +
 nimble/host/mesh/src/net.h              |   1 +
 nimble/host/mesh/src/settings.c         | 115 ++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h         |   1 +
 6 files changed, 138 insertions(+), 2 deletions(-)

commit 40f4d430dd931cb8674291d9baeaa9a8dfc21757
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:19:54 2018 +0200

    mesh: Support for storing model publication persistently
    
    Add support for storing the model publication information
    persistently. The addresses are stored under the settings key
    bt/mesh/s/<mod id>/pub for SIG models and bt/mesh/v/<mod id>/pub for
    vendor models.

 nimble/host/mesh/src/access.h   |   1 +
 nimble/host/mesh/src/cfg_srv.c  |   8 +++
 nimble/host/mesh/src/settings.c | 121 ++++++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h |   1 +
 4 files changed, 131 insertions(+)

commit 3d531ee81fa2d5b015a644ffe75f687b8e88f791
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:17:50 2018 +0200

    mesh: Support for storing model subscriptions persistently
    
    Add support for storing the subscribed group addresses for each model
    persistently. The addresses are stored under the settings key
    bt/mesh/s/<mod id>/sub for SIG models and bt/mesh/v/<mod id>/sub for
    vendor models.

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/access.h        |  1 +
 nimble/host/mesh/src/cfg_srv.c       | 53 +++++++++++++++++++++++++--
 nimble/host/mesh/src/settings.c      | 70 ++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h      |  1 +
 5 files changed, 123 insertions(+), 3 deletions(-)

commit 0d45795bed6a737d7100e6fc9ae776204e691014
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:15:45 2018 +0200

    mesh: Support for storing model bindings persistently
    
    Add support for storing the bound App Keys for each model
    persistently. The bindings are stored under the settings key
    bt/mesh/s/<mod id>/bind for SIG models and bt/mesh/v/<mod id>/bind for
    vendor models.

 nimble/host/mesh/src/access.h   |   5 ++
 nimble/host/mesh/src/cfg_srv.c  |   9 +++
 nimble/host/mesh/src/net.h      |   1 +
 nimble/host/mesh/src/settings.c | 137 ++++++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h |   1 +
 5 files changed, 153 insertions(+)

commit 4b699e58fdb81624b344e514e62e238e5e504775
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:13:15 2018 +0200

    mesh: Redesign element and storage info for models
    
    Keeping the model struct same sized, change the element pointer to two
    indexes, and add a flags member that will be used to track pending
    storage actions.

 nimble/host/mesh/include/mesh/access.h | 15 +++++++++--
 nimble/host/mesh/src/access.c          | 49 ++++++++++++++++++++++++++++++----
 nimble/host/mesh/src/access.h          |  2 ++
 nimble/host/mesh/src/cfg_srv.c         |  2 +-
 nimble/host/mesh/src/testing.c         |  2 +-
 5 files changed, 61 insertions(+), 9 deletions(-)

commit cafabb8d42bee427f1138ce170b7668bc8f93aba
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:02:33 2018 +0200

    mesh: Perform storage clearing also through delayed work
    
    In order not to have a Node Reset consume more stack than other
    operations, also perform the related storage writes through the same
    delayed work as all other storage updates.

 nimble/host/mesh/src/mesh.c      |  2 --
 nimble/host/mesh/src/settings.c  | 73 ++++++++++++++++++++++++++++------------
 nimble/host/mesh/src/transport.c |  2 ++
 3 files changed, 53 insertions(+), 24 deletions(-)

commit 5f6958626eabcef630d596460899df77debe3009
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 17:01:37 2018 +0200

    mesh: Introduce generic storage timer
    
    Instead of having an RPL-specific storage timer, introduce a generic
    one that'll eventually be used for all persistent storage.

 nimble/host/mesh/include/mesh/glue.h |   3 +
 nimble/host/mesh/src/mesh.c          |   2 +-
 nimble/host/mesh/src/net.h           |   8 +-
 nimble/host/mesh/src/settings.c      | 310 +++++++++++++++++++++++++++++++----
 nimble/host/mesh/src/settings.h      |   2 +-
 nimble/host/mesh/syscfg.yml          |   7 +
 6 files changed, 294 insertions(+), 38 deletions(-)

commit e121c1fdd6091b3966d01b319eb58d4c1004022c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:55:09 2018 +0200

    mesh: Convert RPL storage timer into a generic one
    
    To reduce stack consumption, and to avoid blocking the CPU during
    network activity, prepare for a generic timer that can be used for
    most (possibly all) mesh storage values.

 nimble/host/mesh/src/net.h      | 10 ++++++++++
 nimble/host/mesh/src/settings.c | 24 +++++++++++++++---------
 2 files changed, 25 insertions(+), 9 deletions(-)

commit d8b95996af42004372bac9dfaa2dcc83549280f2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:50:00 2018 +0200

    mesh: Expose destination address in bt_mesh_msg_ctx
    
    There are valid use cases where the model layer must know the true
    destination address. So far only the fact that it was one of the
    addresses that the model subscribes to (its element's unicast
    included) has been knowable.
    
    Solve the issue by moving the destination address from the internal
    net_rx context to the public bt_mesh_msg_ctx struct.

 nimble/host/mesh/include/mesh/access.h |  3 ++
 nimble/host/mesh/src/access.c          | 20 ++++++++-----
 nimble/host/mesh/src/friend.c          |  8 +++--
 nimble/host/mesh/src/net.c             | 21 ++++++-------
 nimble/host/mesh/src/net.h             |  1 -
 nimble/host/mesh/src/transport.c       | 55 ++++++++++++++++++----------------
 6 files changed, 61 insertions(+), 47 deletions(-)

commit 99ea5483b60629e425cca7815a9be113cd33c562
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:41:03 2018 +0200

    mesh: Add support for clearing persistent network storage
    
    Add support for clearing all data that's currently supported to be
    persistently stored.

 nimble/host/mesh/src/cfg_srv.c   |  8 +++++++
 nimble/host/mesh/src/mesh.c      |  4 ++++
 nimble/host/mesh/src/settings.c  | 47 ++++++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h  |  5 +++++
 nimble/host/mesh/src/transport.c |  4 ++++
 5 files changed, 68 insertions(+)

commit dd8f46eeacae6a0243fe8d2c954febfe31066ee8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:40:11 2018 +0200

    mesh: Fix resetting configuration model state
    
    Instead of manually iterating all app keys and net keys, use the
    bt_mesh_subnet_del() helper on all subnets. This will also clear any
    app keys, and ensures that persistent storage is cleared as well.

 nimble/host/mesh/src/cfg_srv.c | 19 ++++++-------------
 1 file changed, 6 insertions(+), 13 deletions(-)

commit ca94a2cef9cdf7b130e469ddc2e437851b24284f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:39:24 2018 +0200

    mesh: Introduce measures to avoid too frequent flash writes
    
    Both the local sequence number as well as the Replay Protection List
    (RPL) are states that may potentially change very often. In order not
    to wear out the flash with these updates it makes sense to try to
    avoid too frequent writes.
    
    For the local sequence number a simple solution is not to write the
    number on every increment. This patch introduces a new Kconfig option
    to define after how many increments the sequence number gets written.
    When the stack gets initialized it automatically adds the configured
    number to the last stored one, thereby guaranteeing that the node
    starts off with a number that's larger than the last used one.
    
    The RPL is more problematic, since in principle it needs to be updated
    every single time that we receive and process a message. Especially
    security sentitive nodes will want this stored immediately to flash.
    To give some use-case dependent flexibility, this patch introduces a
    new Kconfig option to specify a timeout after which the RPL gets
    written to flash.

 nimble/host/mesh/include/mesh/glue.h |  2 +
 nimble/host/mesh/pkg.yml             |  1 -
 nimble/host/mesh/src/mesh.c          |  4 ++
 nimble/host/mesh/src/net.h           |  3 ++
 nimble/host/mesh/src/settings.c      | 71 ++++++++++++++++++++++++++++++------
 nimble/host/mesh/src/settings.h      |  2 +
 nimble/host/mesh/syscfg.yml          | 27 ++++++++++++++
 7 files changed, 98 insertions(+), 12 deletions(-)

commit c92445aa5388a62326c0f12a78d91140117dccbd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:23:17 2018 +0200

    mesh: Move network startup operations to common function
    
    These are needed both for bt_mesh_provision() as well as persistent
    storage-based network creation.

 nimble/host/mesh/src/mesh.c     | 26 +-------------------------
 nimble/host/mesh/src/net.c      | 33 +++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/net.h      |  2 ++
 nimble/host/mesh/src/settings.c |  2 ++
 4 files changed, 38 insertions(+), 25 deletions(-)

commit c729272e85d8df479cc8eaf6b09ca0069e9b70c1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:15:12 2018 +0200

    mesh: Remove redundant 'provisioned' variable
    
    This variable is both redundant as well as problematic when it comes
    to adding persistent-storage-based provisioning information, which
    will not come through main.c or the bt_mesh_provision() API. Just
    remove it and use bt_mesh.valid which serves the same purpose in
    practice.

 nimble/host/mesh/src/mesh.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit f0e65c8eae77366d1b38eba271233fadb484dad3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 16:13:48 2018 +0200

    mesh: Add storage APIs for core network values
    
    Add APIs for storing core network values, such as Net and App Keys, IV
    Index, Sequence number, RPL, etc.

 nimble/host/mesh/include/mesh/glue.h |   5 ++
 nimble/host/mesh/src/cfg_srv.c       |  16 ++++
 nimble/host/mesh/src/glue.c          |  12 +++
 nimble/host/mesh/src/mesh.c          |   8 ++
 nimble/host/mesh/src/net.c           |  17 ++++-
 nimble/host/mesh/src/settings.c      | 137 +++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/settings.h      |  12 +++
 nimble/host/mesh/src/transport.c     |  11 +++
 8 files changed, 217 insertions(+), 1 deletion(-)

commit d4f0937316321857f2fe74345d5aa618a507c3b1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jul 5 14:59:57 2018 +0200

    mesh: Add skeleton for persistent storage
    
    Add initial skeleton for doing settings-based persistent storage for
    the mesh network state. This patch only includes restoring some core
    network state such as IV Index, Sequence number, Net Keys, App Keys
    and the Replay Protection list. The remaining state, and actually
    storing the state, is left for follow-up patches.

 nimble/host/mesh/include/mesh/glue.h |  11 +
 nimble/host/mesh/pkg.yml             |   3 +
 nimble/host/mesh/src/glue.c          |   7 +
 nimble/host/mesh/src/settings.c      | 501 +++++++++++++++++++++++++++++++++++
 nimble/host/mesh/syscfg.yml          |  10 +
 5 files changed, 532 insertions(+)

commit 89ea572c6cde28d938cb25bdc3d28228fc65a91c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 12:15:04 2018 +0200

    mesh: Create dedicated helper for incrementing seq
    
    The sequence number is incremented from several different places in
    the stack. The way it was done was potentially race condition prone,
    and was also problematic from the perspective of updating the
    sequence number in persistent storage. Create a dedicated helper for
    incrementing the sequence number (solves the race) which can in later
    patches be used to add the persistent storage support.

 nimble/host/mesh/src/friend.c | 16 ++++++++++------
 nimble/host/mesh/src/net.c    | 22 +++++++++++++++-------
 nimble/host/mesh/src/net.h    |  2 ++
 3 files changed, 27 insertions(+), 13 deletions(-)

commit 2d9b5bb328e1cdb1861c6a29f2b6ed517e553642
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:46:43 2018 +0200

    mesh: Remove redundant initialization
    
    This for loop runs inside an "if (!sub)" branch, so explicitly setting
    sub to NULL in the loop is redundant.

 nimble/host/mesh/src/cfg_srv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d8bcb00fd7885bd5b68fb63b1b0635393b726a79
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:46:15 2018 +0200

    mesh: Increase visibility of net & app key helpers
    
    These app key and net key (subnet) helpers will soon be needed to be
    called from the persistent storage code.

 nimble/host/mesh/src/adv.c        |  2 +-
 nimble/host/mesh/src/cfg_cli.c    |  1 +
 nimble/host/mesh/src/cfg_srv.c    | 59 +++++++++++++++++++++------------------
 nimble/host/mesh/src/foundation.h |  5 ++++
 nimble/host/mesh/src/health_cli.c |  1 -
 5 files changed, 39 insertions(+), 29 deletions(-)

commit 217ce418261650b1ed34e90f6e4bca9c05155a60
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:43:38 2018 +0200

    mesh: Move IV Update defines to net.h
    
    These will soon be needed from other places, e.g. the persistent
    storage support.

 nimble/host/mesh/src/net.c | 23 +++++------------------
 nimble/host/mesh/src/net.h | 13 +++++++++++++
 2 files changed, 18 insertions(+), 18 deletions(-)

commit a5758d90c34c087d654e60160f8a7d02409a9400
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:41:25 2018 +0200

    mesh: Fix sequence number in Friend queue
    
    The code was updating net_rx->seq to make sure sdu_recv() gets the
    right sequence number (seq_auth for segmented messages), however later
    net_rx->seq was also used for enqueuing to the Friend Queue, causing
    the queued messages to have the wrong value.
    
    To fix this, don't update net_rx->seq, rather pass an explicit
    sequence number value to sdu_recv(), which is just net_rx->seq for
    unsegmented messages, and seq_auth for segmented messages.

 nimble/host/mesh/src/transport.c | 16 +++++++---------
 1 file changed, 7 insertions(+), 9 deletions(-)

commit f5269cd5e5dd8ca3d715174b099eacc33b8dc26a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:34:53 2018 +0200

    mesh: Fix enabling Node Identity advertising
    
    The bt_mesh_provision() call results in the provisioning link state
    being cleared, so link.conn will become NULL. Add code to store the
    information of whether PB-GATT was used and use this information after
    the call instead of relying on link.conn anymore at this point.

 nimble/host/mesh/src/prov.c | 23 ++++++++++++++++++++---
 1 file changed, 20 insertions(+), 3 deletions(-)

commit ea414eb5561d5dd852db15b9ed49896c67ae5059
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:29:27 2018 +0200

    mesh: Remove unnecessary #ifdefs from header file
    
    The #ifdef protections are not needed, and in fact prevent helpers
    such as IS_ENABLED() from being used when calling APIs which are
    optional.

 nimble/host/mesh/include/mesh/mesh.h | 9 ---------
 1 file changed, 9 deletions(-)

commit e0caa1147223d2343c488b92475cb3814184967d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:26:50 2018 +0200

    mesh: Remove redundant branch for IV Update
    
    The condition 'iv_index != bt_mesh.iv_index + 1' is already caught by
    the earlier conditions in this branch.

 nimble/host/mesh/src/net.c | 6 ------
 1 file changed, 6 deletions(-)

commit 71580326856f4a59e0c44e8375380659ffc80658
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:26:09 2018 +0200

    mesh: Fix missing IVU normal mode timer when provisioning
    
    If the network is in IV Update In Progress state when we get
    provisioned we should set a timer so we eventually transition back to
    Normal mode (otherwise we may end up in IVU In Progress indefinitely).

 nimble/host/mesh/src/net.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 64e1c1782c5490d581c3a09e4d35fb2e43a6719e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 10:24:40 2018 +0200

    mesh: Fix IV Update tests when duration is unknown
    
    When we get provisioned we can't know how long the network has been in
    the current IV Update state. Introduce a special value for
    bt_mesh.last_update to indicate that we don't know the duration.

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/net.c           | 20 ++++++++++++++++++--
 2 files changed, 19 insertions(+), 2 deletions(-)

commit d5b913d8127beb692399e646cf27a9f43bce8dad
Merge: 0633d3e4 17686576
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 9 12:52:24 2018 +0200

    Merge pull request #139 from michal-narajowski/mesh-memleaks-fix
    
    mesh: Fix memory leaks when preparing messages

commit 0633d3e475a4357666d85c6c3bc0e3dc9d14e8ff
Merge: a1c5d4d2 5a7a6be3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 9 12:51:50 2018 +0200

    Merge pull request #141 from michal-narajowski/blemesh_light_fix_init
    
    apps/blemesh_light: Remove registering gatt services on init

commit 5a7a6be3e509339eecf7261aebf86344bcbcc639
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 6 15:54:21 2018 +0200

    apps/blemesh_light: Remove registering gatt services on init
    
    This is already done by sysinit when initializing mesh package.

 apps/blemesh_light/src/main.c | 2 --
 1 file changed, 2 deletions(-)

commit e8efcf13f03bd56f1777435e6dcd14c19cb86a19
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 5 11:54:59 2018 -0700

    Convert nimble apps from log to modlog
    
    Every sample nimble app used to register the `ble_hs_log` with the
    console handler.
    
    Now that the `ble_hs_log` doesn't exist, there is no need for apps to
    register it.
    
    Also, use the modlog package to write application log entries rather
    than the log API.

 apps/blecent/pkg.yml          |  1 +
 apps/blecent/src/blecent.h    | 11 +------
 apps/blecent/src/main.c       | 73 +++++++++++++++++++-----------------------
 apps/blecent/src/misc.c       | 74 +++++++++++++++++++++----------------------
 apps/blecsc/pkg.yml           |  1 +
 apps/blecsc/src/blecsc_sens.h | 11 +------
 apps/blecsc/src/gatt_svr.c    | 20 ++++++------
 apps/blecsc/src/main.c        | 37 ++++++++--------------
 apps/blehr/pkg.yml            |  1 +
 apps/blehr/src/blehr_sens.h   | 11 +------
 apps/blehr/src/gatt_svr.c     |  6 ++--
 apps/blehr/src/main.c         | 28 ++++++----------
 apps/blemesh/pkg.yml          |  1 +
 apps/blemesh/src/main.c       |  2 --
 apps/blemesh_light/pkg.yml    |  1 +
 apps/blemesh_light/src/main.c |  2 --
 apps/blemesh_shell/pkg.yml    |  1 +
 apps/blemesh_shell/src/main.c |  2 --
 apps/bleprph/pkg.yml          |  1 +
 apps/bleprph/src/bleprph.h    | 11 +------
 apps/bleprph/src/gatt_svr.c   |  6 ++--
 apps/bleprph/src/main.c       | 53 +++++++++++++------------------
 apps/bleprph/src/misc.c       |  4 +--
 apps/bletest/pkg.yml          |  1 +
 apps/bletest/src/main.c       |  3 --
 apps/btshell/pkg.yml          |  1 +
 apps/btshell/src/btshell.h    |  6 +---
 apps/btshell/src/gatt_svr.c   |  6 ++--
 apps/btshell/src/main.c       | 28 ++++++----------
 29 files changed, 159 insertions(+), 244 deletions(-)

commit 05a6b812a3d4211a871d885b3e60515b339661cc
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 26 12:04:12 2018 -0700

    Remove ble_hs_log; use modlog instead
    
    The host now uses the modlog package to write entries to the
    `LOG_MODULE_NIMBLE_HOST` module.  It no longer calls into the log API
    directly, so it doesn't need its own log anymore.

 nimble/host/include/host/ble_hs_log.h | 7 +++----
 nimble/host/pkg.yml                   | 2 +-
 2 files changed, 4 insertions(+), 5 deletions(-)

commit 1749c7e39093b2f5c65a93bcaeeb68f0c29388de
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 5 17:56:52 2018 -0700

    apps/bleprph: fix dependency paths
    
    Use `nimble/host` rather than `net/nimble/host`.

 apps/bleprph/pkg.yml | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

commit 17686576806119876ed691562852cd9d58f07f42
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jun 29 14:36:25 2018 +0200

    mesh: Fix memory leaks when preparing messages

 nimble/host/mesh/src/access.c | 14 ++++++++++----
 nimble/host/mesh/src/friend.c |  8 +++++++-
 nimble/host/mesh/src/shell.c  | 23 ++++++++++++++---------
 3 files changed, 31 insertions(+), 14 deletions(-)

commit a1c5d4d2c5e994143cadd108150c56f1a24595f1
Merge: ab1029a1 c8d3405f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 3 10:30:54 2018 +0200

    Merge pull request #138 from andrzej-kaczmarek/rtt-monitor-rename
    
    nimble/host: Change default RTT buffer name for BLE monitor

commit c8d3405fc6a7af4c288fbc869b8b15a0613c1b74
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 2 10:34:40 2018 +0200

    nimble/host: Change default RTT buffer name for BLE monitor
    
    Let's make it "btmonitor" so it clearly states its purpose.

 nimble/host/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ff78a6557773f8571427d64a3a4d5341068674c3
Author: Ayke van Laethem <aykevanlaethem@gmail.com>
Date:   Wed Jun 27 02:22:51 2018 +0200

    porting: Use real function pointer types for ISR functions
    
    It appears the only reason uint32_t was used, was because of the CMSIS
    NVIC_SetVector function which takes an address as an uint32_t. Clean
    this up for the porting layer.

 nimble/drivers/nrf52/src/ble_hw.c                   |  2 +-
 nimble/drivers/nrf52/src/ble_phy.c                  |  2 +-
 nimble/include/nimble/nimble_npl.h                  |  2 +-
 porting/nimble/src/hal_timer.c                      |  2 +-
 porting/npl/freertos/include/nimble/nimble_npl_os.h |  2 +-
 porting/npl/freertos/include/nimble/npl_freertos.h  |  2 +-
 porting/npl/riot/src/nrf5x_isr.c                    | 14 +++++++-------
 7 files changed, 13 insertions(+), 13 deletions(-)

commit ab1029a1c13d85b11f7555bb79aeb6f771c8db1e
Merge: 4904256d 7f020a61
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 26 09:58:33 2018 +0200

    Merge pull request #133 from sjanc/harmony
    
    nimble/ll: Return error for unconfigured advertising instances

commit 4904256d43c59075d2df1574961e495c937aad2b
Merge: 06752ba3 7a00dfea
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jun 22 09:59:02 2018 +0200

    Merge pull request #136 from michal-narajowski/mesh-fix-group-addr-recv
    
    mesh: Fix ignoring group and virtual addresses

commit 7a00dfea7ed3fa4bda6c9856dd558ea6cda7983d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jun 21 15:46:46 2018 +0200

    mesh: Fix ignoring group and virtual addresses
    
    Previous "fix" broke address processing by ignoring group and virtual addresses.
    This one ensures that we correctly handle these addresses and move on to finding
    model that subscribed to this type of address inside find_op() function.

 nimble/host/mesh/src/access.c | 3 +++
 1 file changed, 3 insertions(+)

commit 7f020a6124dd07e8bd92dd195497f0595bd81f36
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 18 14:25:33 2018 +0200

    nimble/ll: Return error for unconfigured advertising instances
    
    Trying to enable, remove, set advertising data or scan response to
    set that was previously not configured should result in "Unknown
    Advertising Identifier (0x42)" error.

 nimble/controller/include/controller/ble_ll_hci.h |  3 ++
 nimble/controller/src/ble_ll_adv.c                | 41 +++++++++++++++++++----
 nimble/controller/src/ble_ll_hci.c                |  5 +++
 3 files changed, 43 insertions(+), 6 deletions(-)

commit 06752ba3c7a64824dffb51feeb2e5c61f96933a8
Merge: 878f413f da25478c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jun 21 10:50:34 2018 +0200

    Merge pull request #134 from michal-narajowski/mesh-fix-group-addr-recv
    
    [RFC] mesh: Check if a model is subscribed to the destination address

commit da25478cde289d9a704ff0fc1493197bf0d48725
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jun 20 10:34:22 2018 +0200

    mesh: Check if a model is subscribed to the destination address
    
    Previously we only checked if any of the models within the element have
    the destination address in their subscription list. After that check the
    specific model that the message was addressed to was not verified to have that
    address in it's subscription list. This patch fixes this problem.

 nimble/host/mesh/src/access.c | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

commit 878f413f4b3b1d137f95083db1e83d82a2c744de
Merge: 0912fac7 84757a1f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 19 08:28:10 2018 +0200

    Merge pull request #131 from sjanc/update
    
    Update

commit 0912fac72f428a2f75084e525c87c0ff8d2b42d2
Merge: d19376c8 707be66a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 18 12:55:38 2018 +0200

    Merge pull request #132 from andrzej-kaczmarek/fix-socket-build
    
    nimble/transport: Fix socket transport build on native tgt

commit 707be66a21912925728e98d3ea598d5a6e6ac0db
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 18 10:51:08 2018 +0200

    nimble/transport: Fix socket transport build on native tgt

 nimble/transport/socket/src/ble_hci_socket.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 84757a1f3c942b0890fde85f43afab9f8e7384c5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 15 00:30:37 2018 +0200

    Update release notes with 1.0.0 release

 RELEASE_NOTES.md | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)

commit 4645d62f80adc03695574a52266f12eaa3ffeafb
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 15 00:29:53 2018 +0200

    Update repository with 0-latest matching 1.0.0 release

 repository.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d19376c8ccb3d1541a2a68ba416f6097b93e60d9
Merge: c92036a4 e62e5208
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jun 8 11:16:04 2018 +0200

    Merge pull request #128 from andrzej-kaczmarek/silly-nrf51-optimize
    
    Some optimizations

commit e62e52087625b0893bb210d4985424d3ccdaf3c4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 7 14:57:38 2018 +0200

    nimble/ll: Add helper to copy from "flat" mbuf
    
    This helper can be used when we know that payload is stored in single
    mbuf (not chained) and starts at offset 0. This silly optimization can
    save some CPU cycles which does make difference when trying to send
    CONNECT_REQ on nRF51.

 nimble/controller/include/controller/ble_ll.h |  1 +
 nimble/controller/src/ble_ll.c                | 17 +++++++++++++++++
 nimble/controller/src/ble_ll_conn.c           |  2 +-
 3 files changed, 19 insertions(+), 1 deletion(-)

commit 17297a3ffe2836f6faf50a116283efdeeee0cdd2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 7 14:56:15 2018 +0200

    nimble/ll: Move ble_ll_conn_req_pdu_make to proper file
    
    Not sure why this was in hci file, should be in ll.
    Also this makes possible for compiler to inline it.

 nimble/controller/src/ble_ll_conn.c      | 49 ++++++++++++++++++++++++++++++++
 nimble/controller/src/ble_ll_conn_hci.c  | 48 -------------------------------
 nimble/controller/src/ble_ll_conn_priv.h |  1 -
 3 files changed, 49 insertions(+), 49 deletions(-)

commit c92036a424d13039c603c2076fde4d2040bc3712
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 17:53:37 2018 +0200

    Update for 1.0.0 release

 repository.yml | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 2d7c900c5a3bfff52b4815186af9769da565a81c
Merge: 6691ddd7 5de98708
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 4 15:52:31 2018 +0200

    Merge pull request #126 from andrzej-kaczmarek/phy-late-wfr-fix
    
    nimble/phy: Fix late wfr setup

commit 6691ddd7d6fcfd18545a420b9f4632dd739e0669
Merge: 014c4c69 41d17229
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 14:23:16 2018 +0200

    Merge pull request #127 from sjanc/license
    
    License

commit 41d17229565ecb3bef066e5832ce5c1606955717
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 14:22:01 2018 +0200

    Update LICENSE file
    
    This was carrying too many external bundles that are not used in
    NimBLE repo.

 LICENSE | 244 ++--------------------------------------------------------------
 1 file changed, 6 insertions(+), 238 deletions(-)

commit 5de98708c1b5f76f3154dedb3825d3dc0bbe2269
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 4 13:58:51 2018 +0200

    nimble/phy: Fix late wfr setup
    
    wfr is set using CC[0] or CC[2] as reference, but since CPU may be
    halted for a brief moment between timer capture and wfr calculations it
    may happen that TIMER0 already counted past calculated value and compare
    will not occur as expected. This can leave radio stuck in RX state, e.g.
    in case we are advertising and waiting for scan/connect req after TX.
    
    To fix this we'll just check if wfr is set past current TIMER0 counter
    value and if so, we'll disable radio manually as if wfr fired.
    
    This is similar to 06cfc0b0 but happens for reverse transition.

 nimble/drivers/nrf52/src/ble_phy.c | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

commit fae57bf8dde5380d5ab577668651f3f3f06eb1e9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 14 13:19:28 2018 +0200

    apps: Add sample for extended advertising

 apps/ext_advertiser/pkg.yml        |  41 ++++
 apps/ext_advertiser/src/main.c     | 464 +++++++++++++++++++++++++++++++++++++
 apps/ext_advertiser/src/patterns.h | 186 +++++++++++++++
 apps/ext_advertiser/syscfg.yml     |  45 ++++
 4 files changed, 736 insertions(+)

commit 014c4c69cefdc95f2cc0afb8a29d859e260cac81
Merge: 70d464a2 87f3bde3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 13:30:56 2018 +0200

    Merge pull request #125 from sjanc/docs
    
    BLE host doxygen

commit 87f3bde3ee73331f2d72e3f84b2e05163e35ac1b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 12:11:28 2018 +0200

    nimble/host: Add doxygen for ble_hs_id.h

 nimble/host/include/host/ble_hs_id.h | 92 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_id.c          | 78 ------------------------------
 2 files changed, 92 insertions(+), 78 deletions(-)

commit 9259e078f77f14c2f24023cc9b479c02afd83152
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 12:09:29 2018 +0200

    nimble/host: Add doxygen for ble_hs_hci.h

 nimble/host/include/host/ble_hs_hci.h | 62 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_util.c     | 50 ----------------------------
 2 files changed, 62 insertions(+), 50 deletions(-)

commit 65bda05e9a5a817542048c76c194e42185769090
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 11:55:09 2018 +0200

    nimble/host: Add doxygen for ble_gatt.h

 nimble/host/include/host/ble_gatt.h | 453 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_gattc.c         | 299 +-----------------------
 nimble/host/src/ble_gatts.c         |  98 --------
 3 files changed, 454 insertions(+), 396 deletions(-)

commit 70d464a231f59e83e3df2479a66a531491f2ecf2
Merge: a17d808a f4f763d5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 11:21:47 2018 +0200

    Merge pull request #122 from sjanc/apps
    
    Add sample applications from mynewt-core repository

commit a17d808af8b67442e8da414f68427e62bccd116a
Merge: 87941b6a 2db88960
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 4 11:05:55 2018 +0200

    Merge pull request #120 from MariuszSkamra/h4_evt_prio
    
    transport: uart: Prioritize events

commit 87941b6a5f5ccc3807048767fd10e5c7061744bc
Merge: 050a7108 5f8c86c4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 4 10:27:09 2018 +0200

    Merge pull request #121 from sjanc/conn_pub_fix
    
    nimble/ll: Fix reconnection with peers using public address

commit f4f763d5dbe0919ce72d13fb8576282789b787a0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 30 15:40:44 2018 +0200

    Add sample applications from mynewt-core repository

 apps/blecent/pkg.yml                 |   36 +
 apps/blecent/src/blecent.h           |  120 ++
 apps/blecent/src/main.c              |  530 +++++
 apps/blecent/src/misc.c              |  209 ++
 apps/blecent/src/peer.c              |  807 ++++++++
 apps/blecent/syscfg.yml              |   26 +
 apps/blecsc/README.md                |    9 +
 apps/blecsc/pkg.yml                  |   40 +
 apps/blecsc/src/blecsc_sens.h        |  114 +
 apps/blecsc/src/gatt_svr.c           |  385 ++++
 apps/blecsc/src/main.c               |  319 +++
 apps/blecsc/syscfg.yml               |   38 +
 apps/blehci/pkg.yml                  |   30 +
 apps/blehci/src/main.c               |   33 +
 apps/blehci/syscfg.yml               |   23 +
 apps/blehr/README.md                 |    9 +
 apps/blehr/pkg.yml                   |   40 +
 apps/blehr/src/blehr_sens.h          |   55 +
 apps/blehr/src/gatt_svr.c            |  177 ++
 apps/blehr/src/main.c                |  262 +++
 apps/blehr/syscfg.yml                |   35 +
 apps/blemesh/pkg.yml                 |   36 +
 apps/blemesh/src/main.c              |  436 ++++
 apps/blemesh/syscfg.yml              |   48 +
 apps/blemesh_light/pkg.yml           |   36 +
 apps/blemesh_light/src/light_model.c |  242 +++
 apps/blemesh_light/src/light_model.h |   37 +
 apps/blemesh_light/src/main.c        |  124 ++
 apps/blemesh_light/src/ws2812.c      |  133 ++
 apps/blemesh_light/src/ws2812.h      |   42 +
 apps/blemesh_light/syscfg.yml        |   60 +
 apps/blemesh_shell/pkg.yml           |   36 +
 apps/blemesh_shell/src/main.c        |  114 +
 apps/blemesh_shell/syscfg.yml        |   65 +
 apps/bleprph/pkg.yml                 |   43 +
 apps/bleprph/src/bleprph.h           |   70 +
 apps/bleprph/src/gatt_svr.c          |  204 ++
 apps/bleprph/src/main.c              |  356 ++++
 apps/bleprph/src/misc.c              |   43 +
 apps/bleprph/src/phy.c               |  128 ++
 apps/bleprph/syscfg.yml              |   65 +
 apps/bletest/pkg.yml                 |   37 +
 apps/bletest/src/bletest_hci.c       |  782 +++++++
 apps/bletest/src/bletest_priv.h      |   86 +
 apps/bletest/src/main.c              | 1326 ++++++++++++
 apps/bletest/syscfg.yml              |   34 +
 apps/btshell/pkg.yml                 |   38 +
 apps/btshell/src/btshell.h           |  200 ++
 apps/btshell/src/cmd.c               | 3764 ++++++++++++++++++++++++++++++++++
 apps/btshell/src/cmd.h               |   64 +
 apps/btshell/src/cmd_gatt.c          |  587 ++++++
 apps/btshell/src/cmd_gatt.h          |   39 +
 apps/btshell/src/cmd_l2cap.c         |  261 +++
 apps/btshell/src/cmd_l2cap.h         |   32 +
 apps/btshell/src/gatt_svr.c          |  595 ++++++
 apps/btshell/src/main.c              | 2116 +++++++++++++++++++
 apps/btshell/src/misc.c              |  162 ++
 apps/btshell/src/parse.c             |  587 ++++++
 apps/btshell/syscfg.yml              |   44 +
 59 files changed, 16369 insertions(+)

commit 5f8c86c42d7b619cb6143999c75e5f05ba0cadcf
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 1 13:41:48 2018 +0200

    nimble/ll: Fix reconnection with peers using public address
    
    Instead of modyfing internal state and abusing use of legacy address
    type when using controller based privacy, now we just adjust address
    type in HCI event that needs this. This covers both cases where
    using host or controller based privacy. Fix not being able to
    reconnect to device using public address that previously distributed
    IRK key.

 nimble/controller/src/ble_ll_conn.c     | 26 --------------------------
 nimble/controller/src/ble_ll_conn_hci.c | 10 +++++++++-
 2 files changed, 9 insertions(+), 27 deletions(-)

commit dd19d11f891f1a65db9bf5d51e93e0c19b076c2b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 30 15:57:45 2018 +0200

    nimble/host: Add doxygen from ble_eddystone.h

 nimble/host/include/host/ble_eddystone.h | 50 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_eddystone.c          | 38 ------------------------
 2 files changed, 50 insertions(+), 38 deletions(-)

commit aa9ff1642f1effc610a6fb3073475a99d4666dd3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 30 15:54:02 2018 +0200

    nimble/host: Add doxygen for ble_att.h

 nimble/host/include/host/ble_att.h | 80 +++++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_att.c          | 32 ---------------
 nimble/host/src/ble_att_svr.c      | 31 ---------------
 3 files changed, 79 insertions(+), 64 deletions(-)

commit 2db88960e9f9e62cbf4229d38047a484c36b7da8
Author: Mariusz Skamra <mariusz.skamra@codecoup.pl>
Date:   Wed May 30 13:34:37 2018 +0200

    transport: uart: Prioritize events
    
    This adds prioritization of events received. This allows to allocate
    membuf for LE Advertising events from low prio mempool.
    This patch is needed for host to work in high poluted environment,
    where advertisements received may block the host from receiving
    other more important events from controller.

 nimble/transport/uart/src/ble_hci_uart.c | 99 +++++++++++++++++++++++++++-----
 1 file changed, 86 insertions(+), 13 deletions(-)

commit 050a7108cf56546554b4162f0600ab3b2d7e173f
Merge: 4cb32139 40aaaeb9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 28 13:51:07 2018 +0200

    Merge pull request #117 from haukepetersen/fix_misc_compile_warnings
    
    fix os/os_trace_api and RIOT related compile warnings

commit 40aaaeb9047378ad712e4fde07d6208f7a22e717
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Mon May 28 13:05:16 2018 +0200

    controller/ble_*_trace.h: include os_trace_api.h

 nimble/controller/include/controller/ble_ll_trace.h  | 2 ++
 nimble/controller/include/controller/ble_phy_trace.h | 2 ++
 2 files changed, 4 insertions(+)

commit 235c99db00019b81d56259322fbb1ba736c0a1dd
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Mon May 28 13:05:38 2018 +0200

    os/os_trace: remove os_trace_task_* defs

 porting/nimble/include/os/os_trace_api.h | 30 ------------------------------
 1 file changed, 30 deletions(-)

commit 4cb32139298ed9e959634ca9c64f99415fc4c9d4
Merge: 23093dbe 83001845
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 28 12:52:07 2018 +0200

    Merge pull request #112 from MariuszSkamra/porting_fixes
    
    porting: Fixes for compilation errors

commit 83001845e4b1cf7dd55ea0668bb00c46900f16f4
Author: Mariusz Skamra <mariusz.skamra@codecoup.pl>
Date:   Thu May 24 14:42:04 2018 +0200

    porting: Add missing npl_freertos_eventq_dflt_get
    
    This fixes compilation error on freertos due to misssing
    ble_npl_eventq_dflt_get function.

 nimble/host/mesh/src/glue.c | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit 23093dbe599d8816418f15442847e5ba23374e4f
Merge: e0266266 d73572eb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 28 12:02:42 2018 +0200

    Merge pull request #104 from andrzej-kaczmarek/systemview
    
    Add tracing via SystemView

commit e0266266d5cc9abe00b567a9f45b0dac40b8672a
Merge: 245ef69c 02f987d4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 28 11:38:49 2018 +0200

    Merge pull request #111 from andrzej-kaczmarek/npl-riot
    
    porting: Add NPL for RIOT

commit 02f987d44d427163ffd46ceaf288ae1ae48587e7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 15:31:31 2018 +0200

    porting: Add local syscfg for RIOT
    
    This is example configuration used by RIOT, mostly due to CI complaining
    about this file since it does not follow RIOT style at all (it is
    autogenerated by newt).
    
    Other applications built for RIOT can decide simply not to use this file
    and provide own instead.

 porting/npl/riot/include/syscfg/syscfg.h | 1057 ++++++++++++++++++++++++++++++
 1 file changed, 1057 insertions(+)

commit 4d9eee14e96d1c501a3f623a64f7ce2f70768f94
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 14:05:02 2018 +0200

    nimble/ll: Add workaround for initializing LL task on RIOT
    
    This is just a workaround, we need to find some more generic solution
    here.

 nimble/controller/src/ble_ll.c | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

commit 39c32e6be13bd981e9371640e9ce6a4d0ef5d608
Author: Hauke Petersen <hauke.petersen@fu-berlin.de>
Date:   Tue May 15 12:56:50 2018 +0200

    porting: Add NPL for RIOT
    
    This patch adds NPL for RIOT, see https://www.riot-os.org/.
    
    Example applications are included in RIOT sources and should be build
    from there. RIOT build system will automatically fetch NimBLE sources as
    a package.

 porting/npl/riot/include/nimble/nimble_npl_os.h | 261 ++++++++++++++++++++++++
 porting/npl/riot/src/npl_os_riot.c              |  66 ++++++
 porting/npl/riot/src/nrf5x_isr.c                |  58 ++++++
 3 files changed, 385 insertions(+)

commit 245ef69c65b7a74140efbc98a3867c0b361e2dc1
Merge: 3d4e20ca 95da64b7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 28 11:28:03 2018 +0200

    Merge pull request #115 from MariuszSkamra/hs_dbg_le_evt
    
    debug: Add missing debug logs for LE Meta Events

commit 95da64b7486afb6d847233c9ebaeb9f763f52ffc
Author: Mariusz Skamra <mariusz.skamra@codecoup.pl>
Date:   Fri May 25 10:48:43 2018 +0200

    debug: Add missing debug logs for LE Meta Events
    
    This adds debug logs for LE Meta Events.
    Those are not too heavy to limit the console output.

 nimble/host/src/ble_hs_dbg.c       | 182 +++++++++++++++++++++++++++++++++++++
 nimble/include/nimble/hci_common.h |  83 +++++++++++++++++
 2 files changed, 265 insertions(+)

commit f07c96621d148c51e3498d7c83f8bb0f7d5e859c
Author: Martin Turon <mturon@nestlabs.com>
Date:   Fri May 11 12:39:56 2018 -0700

    [linux] Linux port using NPL (Nimble Platform Layer).
    
    - Added linux implementations of npl abstractions:
      * callout, eventq, mutex, sem, time

 porting/examples/dummy/Makefile                  |   16 +-
 porting/examples/linux/Makefile                  |   81 ++
 porting/examples/linux/README.md                 |   73 ++
 porting/examples/linux/ble.c                     |  116 +++
 porting/examples/linux/include/syscfg/syscfg.h   | 1047 ++++++++++++++++++++++
 porting/examples/linux/main.c                    |   89 ++
 porting/npl/linux/include/nimble/nimble_npl_os.h |   54 ++
 porting/npl/linux/src/npl_osal.h                 |   29 +
 porting/npl/linux/src/os_atomic.c                |   36 +
 porting/npl/linux/src/os_callout.c               |  132 +++
 porting/npl/linux/src/os_eventq.cc               |  129 +++
 porting/npl/linux/src/os_mutex.c                 |   76 ++
 porting/npl/linux/src/os_sem.c                   |   99 ++
 porting/npl/linux/src/os_task.c                  |  110 +++
 porting/npl/linux/src/os_time.c                  |   64 ++
 porting/npl/linux/src/os_types.h                 |   85 ++
 porting/npl/linux/src/wqueue.h                   |   76 ++
 porting/npl/linux/test/Makefile                  |  103 +++
 porting/npl/linux/test/test_npl_callout.c        |  116 +++
 porting/npl/linux/test/test_npl_eventq.c         |  130 +++
 porting/npl/linux/test/test_npl_mempool.c        |  111 +++
 porting/npl/linux/test/test_npl_sem.c            |  155 ++++
 porting/npl/linux/test/test_npl_task.c           |   98 ++
 porting/npl/linux/test/test_util.h               |   56 ++
 24 files changed, 3079 insertions(+), 2 deletions(-)

commit 3d4e20ca3357ed4f13c9db8f5b18ccbf13229ab3
Merge: 86452a4d a48fee60
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 25 16:20:55 2018 +0200

    Merge pull request #116 from kolodgrz/ext_adv_fix_v1
    
    nimble/mesh: Don't send scannable adv events if non-connectable

commit a48fee607d6ec732399cd4bb27a420e02ae023d5
Author: Grzegorz Kolodziejczyk <grzegorz.kolodziejczyk@codecoup.pl>
Date:   Fri May 25 16:05:32 2018 +0200

    nimble/mesh: Don't send scannable adv events if non-connectable
    
    Extended advertising events should be send as non-scannable events.

 nimble/host/mesh/src/glue.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 86452a4d4fe7adfdf4bad69e2c53d33cbc123bd2
Merge: f6bd8dc1 6b5c2488
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 25 11:58:00 2018 +0200

    Merge pull request #114 from MariuszSkamra/hs_dbg
    
    debug: Improve logging of unknown LE Meta Event

commit f6bd8dc1f496557523697825f806d22bf73acb21
Merge: 4df446ff b1855ebb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 18:02:38 2018 +0200

    Merge pull request #113 from andrzej-kaczmarek/npl-dev
    
    porting: Fix multiple build errors on non-Mynewt builds

commit 4df446ff40d780a033b37bac0de72d598b0d0433
Merge: c155820c 05bd8129
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 24 16:32:43 2018 +0200

    Merge pull request #108 from rymanluk/ll_assert
    
    nimble/ll: Vendor error event on assert

commit 05bd8129a8a4f86c86197a3aa14be542bfd7c5dd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 28 13:16:11 2018 +0200

    nimble/ll: Vendor error event on assert
    
    With this patch controller will send Vendor Debug event
    on asserts.
    First octet of this event is Debug event type
    1) Debug event type (0x00 - assert information)
    2) Assert information (file and line)
    
    Example below shows my test asser in ble_ll_hci.c line 764
    
    > HCI Event: Vendor (0xff) plen 66
       00 72 65 70 6f 73 2f 61 70 61 63 68 65 2d 6d 79 .repos/apache-my
       6e 65 77 74 2d 6e 69 6d 62 6c 65 2f 6e 69 6d 62 newt-nimble/nimb
       6c 65 2f 63 6f 6e 74 72 6f 6c 6c 65 72 2f 73 72 le/controller/sr
       63 2f 62 6c 65 5f 6c 6c 5f 68 63 69 2e 63 fc 02 c/ble_ll_hci.c..
       00 00

 nimble/controller/include/controller/ble_ll.h      | 22 +++++++++++++
 nimble/controller/include/controller/ble_ll_ctrl.h |  1 +
 nimble/controller/src/ble_ll.c                     | 10 +++---
 nimble/controller/src/ble_ll_conn.c                | 20 ++++++------
 nimble/controller/src/ble_ll_conn_hci.c            |  6 ++--
 nimble/controller/src/ble_ll_ctrl.c                |  8 ++---
 nimble/controller/src/ble_ll_dtm.c                 | 18 +++++------
 nimble/controller/src/ble_ll_hci.c                 |  6 ++--
 nimble/controller/src/ble_ll_hci_ev.c              | 20 ++++++++++++
 nimble/controller/src/ble_ll_resolv.c              | 10 +++---
 nimble/controller/src/ble_ll_scan.c                | 36 +++++++++++-----------
 nimble/controller/src/ble_ll_sched.c               | 20 ++++++------
 nimble/controller/src/ble_ll_xcvr.c                |  2 +-
 nimble/include/nimble/hci_common.h                 |  1 +
 14 files changed, 112 insertions(+), 68 deletions(-)

commit 6b5c2488974953a2c6580f7e30a8d34c186f39a1
Author: Mariusz Skamra <mariusz.skamra@codecoup.pl>
Date:   Thu May 24 15:39:22 2018 +0200

    debug: Improve logging of unknown LE Meta Event
    
    This improves logging with SubEvent opcode to be printed out in
    ble_hs_dbg_le_event_disp.

 nimble/host/src/ble_hs_dbg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b1855ebb61b7936f6db95da47cc8ce12e30fe5a2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 16:04:30 2018 +0200

    porting: Fix unused parameter warning

 porting/nimble/include/log/log.h | 1 +
 1 file changed, 1 insertion(+)

commit 75a8801cd8ec3f804489c9fd515e33b875d0ee28
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 14:32:58 2018 +0200

    porting: Update os_mempool
    
    Perhaps we need to figure out better way to sync these files with core,
    but for now let's do this manually. Anyway, I do not expect this to
    happen very often.

 porting/nimble/include/os/os_mempool.h | 10 ++++++++
 porting/nimble/src/os_mempool.c        | 45 ++++++++++++++++++++++++++++++++--
 2 files changed, 53 insertions(+), 2 deletions(-)

commit 916cada7b43b0c729cf6d8d2282e4edae58cf2da
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 14:37:35 2018 +0200

    nimble/host: Fix build with host flow enabled
    
    Seems like something was broken when merging...

 nimble/host/src/ble_hs_flow.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 961fff56dbaec959c24451a9390b72686c1df592
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 14:29:48 2018 +0200

    nimble/host: Fix missing NPL usage
    
    Seems like we never tried to build ported NimBLE with some of features
    enabled thus there were still some OS calls left.

 nimble/host/src/ble_gap.c     |  4 ++--
 nimble/host/src/ble_hs.c      | 16 ++++++++++------
 nimble/host/src/ble_hs_flow.c | 26 +++++++++++++-------------
 3 files changed, 25 insertions(+), 21 deletions(-)

commit 421daeff07e677a3bfcdde1fb682feecd18a89c1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 14:28:29 2018 +0200

    nimble/ll: Fix build with ext adv enabled
    
    rand() needs stdlib.h
    
    This failed when building FreeRTOS port.

 nimble/controller/src/ble_ll_adv.c | 1 +
 1 file changed, 1 insertion(+)

commit 66eaa96c2fa7ca3ef7916c88eca8dad00044cf17
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 14:28:15 2018 +0200

    nimble/ll: Fix build with DTM enabled
    
     #include<> is used to search for system headers so it does not look in
    current directory.
    
    This failed when building FreeRTOS port, not sure why does not fail on
    Mynewt.

 nimble/controller/src/ble_ll.c     | 2 +-
 nimble/controller/src/ble_ll_hci.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit c155820ccdf1d1a383e1f5bad2178d22197a929f
Merge: f698731f 58c5ac85
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu May 24 15:13:42 2018 +0200

    Merge pull request #109 from sjanc/rat
    
    Add missing license headers and  RAT excludes

commit f698731f6bd4d1b11af565fe09ce3eefa6baac69
Merge: 3102727c daed64e7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 13:49:43 2018 +0200

    Merge pull request #110 from andrzej-kaczmarek/npl-dev
    
    porting: More NPL changes/fixes

commit daed64e78655c1c3d597bc1a2a9fa2d418ac775f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 12:00:53 2018 +0200

    porting: Fix FreeRTOS NPL
    
    Make ble_npl_eventq_remove properly handle calling from ISR.

 porting/npl/freertos/src/npl_os_freertos.c | 44 ++++++++++++++++++++++--------
 1 file changed, 33 insertions(+), 11 deletions(-)

commit 3c07cb1898fe6038ae76ea54c8c714a3f670ffc8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 11:07:28 2018 +0200

    porting: Add convenience init function in FreeRTOS NPL
    
    This adds convenience function for FreeRTOS NPL which initializes
    OS-specific things. Currently it creates tasks necessary to run ported
    NimBLE.

 .../freertos/include/nimble/nimble_port_freertos.h | 35 +++++++++++++++
 porting/npl/freertos/src/nimble_port_freertos.c    | 51 ++++++++++++++++++++++
 2 files changed, 86 insertions(+)

commit 86d4b254bebd04e1330b2e5fdc9e99f8e864017a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 11:06:31 2018 +0200

    porting: Use common FreeRTOS macros for entering/exiting critical sect

 porting/npl/freertos/include/nimble/nimble_npl_os.h | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 4c70f15a7489df665ef9da5af8bad673b778d214
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 11:04:09 2018 +0200

    porting: Add common function to run default event queue
    
    Now application can just call single function which will run default
    event queue instead of creating "standard" loop. Also on some OS it may
    be just possible to call some OS-specific API instead, so it's up to app
    what to do - this is just a convenience function.

 porting/nimble/include/nimble/nimble_port.h |  2 ++
 porting/nimble/src/nimble_port.c            | 11 +++++++++++
 2 files changed, 13 insertions(+)

commit 095288a5497829f22857e12e3442378419d153a2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 11:02:23 2018 +0200

    porting: Move default event queue management to common porting code
    
    OS specific code should not care about default event queue thus it will
    be created by nimble_port_init() function internally. We'll just add
    simple getter in case someone wants to use it.

 nimble/host/src/ble_hs.c                            | 16 +++++++++++++---
 nimble/include/nimble/nimble_npl.h                  |  2 --
 porting/nimble/include/nimble/nimble_port.h         |  4 ++++
 porting/nimble/src/nimble_port.c                    | 11 +++++++++++
 porting/npl/dummy/src/npl_os_dummy.c                |  6 ------
 porting/npl/freertos/include/nimble/nimble_npl_os.h |  8 --------
 porting/npl/freertos/src/npl_os_freertos.c          | 12 ------------
 7 files changed, 28 insertions(+), 31 deletions(-)

commit 7501d3816cbdc700bc4ebaeee29127b52318a333
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 10:58:52 2018 +0200

    porting: Add API to run an event instead of running an eventq
    
    This makes more sense since now we have API which can just fire callback
    associated with event. Running eventq is just getting an event from
    queue and then running it.

 nimble/controller/src/ble_ll.c                      | 6 +++++-
 nimble/include/nimble/nimble_npl.h                  | 4 ++--
 porting/npl/dummy/src/npl_os_dummy.c                | 2 +-
 porting/npl/freertos/include/nimble/nimble_npl_os.h | 7 +------
 porting/npl/mynewt/include/nimble/nimble_npl_os.h   | 4 ++--
 5 files changed, 11 insertions(+), 12 deletions(-)

commit 23d834ee035587fbe3be834d5b12325a6f549a0e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 12:00:23 2018 +0200

    porting: Add missing API to dummy NPL

 porting/npl/dummy/src/npl_os_dummy.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 3102727c8ce4806eccd5530d9935bc8d4c1637d9
Merge: 6e5ad2e1 cc9b523e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 24 10:54:49 2018 +0200

    Merge pull request #106 from rymanluk/mesh_ext_fix
    
    nimble/mesh: Couple of mesh fixes related to ext adv usage

commit 58c5ac8531aebafa249a68424f13b9c7b42b2268
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu May 24 10:51:21 2018 +0200

    Add missing license headers and  RAT excludes

 .rat-excludes                      | 28 ++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_flow.c      | 19 +++++++++++++++++++
 porting/examples/dummy/Makefile    | 19 +++++++++++++++++++
 porting/examples/dummy/main.c      | 19 +++++++++++++++++++
 porting/nimble/Makefile.controller | 17 +++++++++++++++++
 porting/nimble/Makefile.defs       | 17 +++++++++++++++++
 porting/nimble/Makefile.mesh       | 17 +++++++++++++++++
 porting/nimble/Makefile.tinycrypt  | 17 +++++++++++++++++
 version.yml                        | 19 +++++++++++++++++++
 9 files changed, 172 insertions(+)

commit 6e5ad2e158ff978431762e9616c0ed4d414a60de
Merge: ac07afbe 4ff46f5e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 24 00:29:58 2018 +0200

    Merge pull request #107 from andrzej-kaczmarek/npl-nrf5sdk-revert
    
    Revert "porting: Add FreeRTOS on nRF5 SDK porting example"

commit 4ff46f5e43d63c946c4b6aa4a3c73f5d18df77dd
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 23 18:21:11 2018 +0200

    Revert "porting: Add FreeRTOS on nRF5 SDK porting example"
    
    This reverts commit 27750e78f28c04d6d3d36af8cd616b47cab3c9b3.
    
    Demo was included in other PR by mistake, we should not merge it like
    this...

 .gitignore                                         |    5 -
 porting/examples/freertos_nrf5_sdk/ble.c           |  126 -
 .../freertos_nrf5_sdk/config/FreeRTOSConfig.h      |  207 --
 .../freertos_nrf5_sdk/include/syscfg/syscfg.h      | 1038 -------
 porting/examples/freertos_nrf5_sdk/main.c          |  128 -
 .../pca10040/blank/armgcc/Makefile                 |  187 --
 .../blank/armgcc/nimble_FreeRTOS_gcc_nrf52.ld      |   51 -
 .../pca10040/blank/config/sdk_config.h             | 2924 --------------------
 .../pca10056/blank/armgcc/Makefile                 |  184 --
 .../blank/armgcc/nimble_FreeRTOS_gcc_nrf52.ld      |   51 -
 .../pca10056/blank/config/sdk_config.h             | 2924 --------------------
 11 files changed, 7825 deletions(-)

commit ac07afbee25519f5bbb6b6f93e72c4af9303dea2
Merge: 084345c1 27750e78
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 23 18:18:29 2018 +0200

    Merge pull request #105 from andrzej-kaczmarek/npl-dev
    
    porting: Cleanup and fix NPL

commit 27750e78f28c04d6d3d36af8cd616b47cab3c9b3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:10:40 2018 +0200

    porting: Add FreeRTOS on nRF5 SDK porting example
    
    nRF5 SDK (v15) is required to run this demo app. By default, it is
    expected to be available at porting/examples/freertos_nrf5_sdk/nrf5_sdk
    but this location can be changed by SDK_ROOT variable.
    
    To build for nRF52832:
    > cd porting/examples/freertos_nrf5_sdk
    > make -C pca10040/blank/armgcc
    
    To build for nRF52840:
    > cd porting/examples/freertos_nrf5_sdk
    > make -C pca10056/blank/armgcc
    
    To build with nRF5 SDK placed in non-default location:
    > cd porting/examples/freertos_nrf5_sdk
    > make -C pca10040/blank/armgcc SDK_ROOT=/xxx/nRF5_SDK_15.0.0_a53641a
    
    Flashing is done as for other examples in nRF5 SDK:
    > make -C pca10040/blank/armgcc flash

 .gitignore                                         |    5 +
 porting/examples/freertos_nrf5_sdk/ble.c           |  126 +
 .../freertos_nrf5_sdk/config/FreeRTOSConfig.h      |  207 ++
 .../freertos_nrf5_sdk/include/syscfg/syscfg.h      | 1038 +++++++
 porting/examples/freertos_nrf5_sdk/main.c          |  128 +
 .../pca10040/blank/armgcc/Makefile                 |  187 ++
 .../blank/armgcc/nimble_FreeRTOS_gcc_nrf52.ld      |   51 +
 .../pca10040/blank/config/sdk_config.h             | 2924 ++++++++++++++++++++
 .../pca10056/blank/armgcc/Makefile                 |  184 ++
 .../blank/armgcc/nimble_FreeRTOS_gcc_nrf52.ld      |   51 +
 .../pca10056/blank/config/sdk_config.h             | 2924 ++++++++++++++++++++
 11 files changed, 7825 insertions(+)

commit 0217aa7b5a50ab5183219ee6ab440d010202551c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 12:41:58 2018 +0200

    porting: Remove services from NimBLE port initialization
    
    We should only initialize basic NimBLE packages in common init. Extra
    services should be better initialized by application since we do not
    know which ones it may want to include.

 porting/nimble/src/nimble_port.c | 14 --------------
 1 file changed, 14 deletions(-)

commit 02f148412cc90ed4458e21105e9aaeb8be80af74
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 11:41:41 2018 +0200

    porting: Fix FreeRTOS NPL
    
    This fixes few issues in FreeRTOS NPL related to API usage from ISR
    context.

 porting/npl/freertos/src/npl_os_freertos.c | 51 +++++++++++++++++-------------
 1 file changed, 29 insertions(+), 22 deletions(-)

commit 7ba4796846cf6942c8ed244dac223c66be03be55
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 11:15:52 2018 +0200

    porting: Fix ble_npl_eventq_is_empty return value

 nimble/include/nimble/nimble_npl.h                  | 2 +-
 porting/npl/freertos/include/nimble/nimble_npl_os.h | 2 +-
 porting/npl/mynewt/include/nimble/nimble_npl_os.h   | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit ecfd220fc90033a6526c7b5792cf24c50d9c5246
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 10:48:23 2018 +0200

    porting: Fix return values for time in NPL

 nimble/include/nimble/nimble_npl.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit c928a5050dfc8c2aeb72dfb03494925edf8eea99
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 12:16:19 2018 +0200

    porting: Change ble_npl_callout_reset return value
    
    All other APIs return ble_npl_error_t already.

 nimble/include/nimble/nimble_npl.h                  | 3 ++-
 porting/npl/dummy/src/npl_os_dummy.c                | 2 +-
 porting/npl/freertos/include/nimble/nimble_npl_os.h | 2 +-
 porting/npl/freertos/include/nimble/npl_freertos.h  | 4 ++--
 porting/npl/freertos/src/npl_os_freertos.c          | 2 +-
 porting/npl/mynewt/include/nimble/nimble_npl_os.h   | 2 +-
 6 files changed, 8 insertions(+), 7 deletions(-)

commit 7e958b77defa2b98b956895e74f01730f641220f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 12:14:36 2018 +0200

    porting: Rename ble_npl_callout_queued
    
    "is_active" is more consistent with other APIs naming like "is_empty" or
    "is_queued". Also "active" instead of "queued" makes more sense since
    this means callout is active and can fire on timeout. "queued" is just
    related to implementation on Mynewt where active callout is put on
    queue.
    
    Return value is also changes for consistency.

 nimble/controller/src/ble_ll_conn_hci.c             | 2 +-
 nimble/host/src/ble_hs.c                            | 2 +-
 nimble/include/nimble/nimble_npl.h                  | 2 +-
 porting/npl/dummy/src/npl_os_dummy.c                | 6 +++---
 porting/npl/freertos/include/nimble/nimble_npl_os.h | 4 ++--
 porting/npl/mynewt/include/nimble/nimble_npl_os.h   | 4 ++--
 6 files changed, 10 insertions(+), 10 deletions(-)

commit 4c215e3cbd84330b1431b530d2f253f9f622f438
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 22 10:45:16 2018 +0200

    porting: Remove redundant os_eventq_get_tmo API
    
    Let's just add timeout parameter to os_eventq_get instead and have
    single API to get event from queue. The handing of timeout can be
    optimied by compiler if static inline is used to implement this.

 nimble/host/mesh/src/adv.c                          |  6 +++---
 nimble/host/mesh/src/glue.c                         |  2 +-
 nimble/include/nimble/nimble_npl.h                  |  6 ++----
 porting/npl/freertos/include/nimble/nimble_npl_os.h | 12 +++---------
 porting/npl/freertos/include/nimble/npl_freertos.h  |  5 ++---
 porting/npl/freertos/src/npl_os_freertos.c          |  8 +-------
 porting/npl/mynewt/include/nimble/nimble_npl_os.h   | 16 +++++++++-------
 7 files changed, 21 insertions(+), 34 deletions(-)

commit 084345c18c1d1e4e4a767c041089466cfc07b83b
Merge: 111d91a4 392d6f29
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 23 10:06:41 2018 +0200

    Merge pull request #102 from sjanc/docs
    
    Documentation update

commit cc9b523e60538354a7461b39216b40d55d97ecfa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 22 23:33:39 2018 +0200

    nimble/mesh: Fix stop advertising for ADV and GATT bearer
    
    When using ext advetising, we need to make sure to stop correct
    instance.

 nimble/host/mesh/include/mesh/glue.h |  2 +-
 nimble/host/mesh/src/adv.c           |  2 +-
 nimble/host/mesh/src/glue.c          | 18 +++++++++++++++---
 nimble/host/mesh/src/proxy.c         |  2 +-
 4 files changed, 18 insertions(+), 6 deletions(-)

commit 12f3d059cd95551c9305e0772179dd2bf61a1f4d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 22 23:30:30 2018 +0200

    nimble/mesh: Minor fix name for mesh advertising instance and idx
    
    Make sure we use GATT and ADV bearer

 nimble/host/mesh/src/glue.c | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

commit 8aaf05cc9ffd9d225dfe61f5f77a42b51bbb0393
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 22 22:09:43 2018 +0200

    nimble/mesh: Fix set for address type

 nimble/host/mesh/src/glue.c | 1 +
 1 file changed, 1 insertion(+)

commit d73572eb4a61e4f821ed741be6036a9e2310aca3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 21 12:57:00 2018 +0200

    nimble/ll: Use logging via sysview
    
    This patch removes current logging from LL/PHY (which is temporary only
    anyway) and replaces it by sysview tracing. This allows to see traces
    together with ISRs and tasks activity.

 nimble/controller/include/controller/ble_ll.h      |  31 -------
 .../controller/include/controller/ble_ll_trace.h   |  92 +++++++++++++++++++
 .../controller/include/controller/ble_phy_trace.h  |  94 +++++++++++++++++++
 nimble/controller/src/ble_ll.c                     | 101 ++++-----------------
 nimble/controller/src/ble_ll_adv.c                 |  13 ++-
 nimble/controller/src/ble_ll_conn.c                |  38 +++-----
 nimble/controller/src/ble_ll_ctrl.c                |   3 +-
 nimble/controller/src/ble_ll_scan.c                |   1 -
 nimble/controller/src/ble_ll_sched.c               |   7 +-
 nimble/controller/src/ble_ll_trace.c               |  53 +++++++++++
 nimble/controller/src/ble_ll_xcvr.c                |   4 -
 nimble/controller/syscfg.yml                       |   5 +
 nimble/drivers/nrf51/src/ble_phy.c                 |  17 ++--
 nimble/drivers/nrf52/src/ble_phy.c                 |  18 ++--
 nimble/drivers/nrf52/src/ble_phy_trace.c           |  44 +++++++++
 nimble/drivers/nrf52/syscfg.yml                    |   5 +
 16 files changed, 355 insertions(+), 171 deletions(-)

commit ddfe8fe72507252ac3bbfaf8f238d0c88bb3ccaa
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 17 13:27:32 2018 +0200

    porting: Update NPL with latest tracing API

 porting/nimble/include/os/os_trace_api.h | 115 +++++++++++++++++++++++--------
 1 file changed, 87 insertions(+), 28 deletions(-)

commit 773bd4c7e804ba80fbacdc5576718553070de5b0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 17 13:26:06 2018 +0200

    nimble/phy: Update ISR tracing
    
    This updates ISR tracing to match mynewt-core.

 nimble/drivers/nrf51/src/ble_hw.c  | 5 +++++
 nimble/drivers/nrf51/src/ble_phy.c | 4 ++++
 nimble/drivers/nrf52/src/ble_hw.c  | 6 ++++--
 nimble/drivers/nrf52/src/ble_phy.c | 4 ++++
 4 files changed, 17 insertions(+), 2 deletions(-)

commit 392d6f29a407cfd68c327ec8316b986d97a40f24
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 18 14:37:51 2018 +0200

    nimble/host: Add doxygen for ble_gap.h

 nimble/host/include/host/ble_gap.h | 459 +++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_gap.c          | 278 ----------------------
 2 files changed, 440 insertions(+), 297 deletions(-)

commit 17166fefafb194dbf12a5fe8d3f4db4b75958f63
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 18 14:37:51 2018 +0200

    nimble/host: Add doxygen for ble_hs_mbuf.h

 nimble/host/include/host/ble_hs_mbuf.h | 43 ++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_mbuf.c          | 37 -----------------------------
 2 files changed, 43 insertions(+), 37 deletions(-)

commit 3285a68e045b9a01f36a6d7ad5d2317caff4a785
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 18 14:37:51 2018 +0200

    nimble/host: Add doxygen for ble_hs.h

 nimble/host/include/host/ble_hs.h | 211 +++++++++++++++++++++++++++++++++-----
 nimble/host/src/ble_hs.c          |  41 --------
 2 files changed, 188 insertions(+), 64 deletions(-)

commit 8ca2eb5fb2f8dfced4241a38bcb09eb8e173910f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 18 14:37:50 2018 +0200

    nimble/host: Add doxygen for ble_uuid.h

 nimble/host/include/host/ble_uuid.h | 75 ++++++++++++++++++++++++++++++++++---
 nimble/host/src/ble_uuid.c          | 42 ---------------------
 2 files changed, 70 insertions(+), 47 deletions(-)

commit 7a7b9dc704d78fd7950c80c6aac013880a917f1a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 18 14:37:50 2018 +0200

    docs: Fix sphinx build and cleanup for new repo

 docs/.gitignore                   |    1 -
 docs/README.rst                   |   14 +-
 docs/ble_hs/ble_hs.rst            |    2 +-
 docs/ble_setup/ble_addr.rst       |    6 +-
 docs/ble_setup/ble_sync_cb.rst    |    2 +-
 docs/conf.py                      |   12 +-
 docs/doxygen.xml                  | 2433 +++++++++++++++++++++++++++++++++++++
 docs/{ble_intro.rst => index.rst} |    2 +-
 8 files changed, 2451 insertions(+), 21 deletions(-)

commit bd65300bb7ce2d44dc7326399b9be65778be5376
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 18 14:37:50 2018 +0200

    docs: Move from mynewt-core

 docs/.gitignore                     |   6 +
 docs/Makefile                       |  25 ++
 docs/README.rst                     |  35 ++
 docs/ble_hs/ble_att.rst             |  22 ++
 docs/ble_hs/ble_gap.rst             |  14 +
 docs/ble_hs/ble_gattc.rst           |  15 +
 docs/ble_hs/ble_gatts.rst           |  15 +
 docs/ble_hs/ble_hs.rst              |  27 ++
 docs/ble_hs/ble_hs_id.rst           |  45 +++
 docs/ble_hs/ble_hs_return_codes.rst | 437 ++++++++++++++++++++++++
 docs/ble_intro.rst                  | 122 +++++++
 docs/ble_sec.rst                    |  76 +++++
 docs/ble_setup/ble_addr.rst         |  63 ++++
 docs/ble_setup/ble_lp_clock.rst     |  67 ++++
 docs/ble_setup/ble_setup_intro.rst  |  13 +
 docs/ble_setup/ble_sync_cb.rst      |  80 +++++
 docs/btshell/btshell_GAP.rst        | 660 ++++++++++++++++++++++++++++++++++++
 docs/btshell/btshell_GATT.rst       | 108 ++++++
 docs/btshell/btshell_advdata.rst    |  47 +++
 docs/btshell/btshell_api.rst        | 153 +++++++++
 docs/conf.py                        | 177 ++++++++++
 docs/mesh/index.rst                 |  95 ++++++
 docs/mesh/mesh_lightning_model.jpg  | Bin 0 -> 120157 bytes
 docs/mesh/mesh_topology.jpg         | Bin 0 -> 120443 bytes
 docs/mesh/sample.rst                |  30 ++
 25 files changed, 2332 insertions(+)

commit 111d91a40774753fb552fa56399a6f704cd4648d
Merge: d17120a2 84eed538
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 11:20:23 2018 +0200

    Merge pull request #101 from michal-narajowski/mesh-atomic-cleanup
    
    mesh: Move atomic.h to sources

commit 84eed538fdb7fd30de6a351ca9633b6655a64f86
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 18 11:14:55 2018 +0200

    mesh: Move atomic.h to sources
    
    This header is not a part of Mesh API.

 nimble/host/mesh/include/mesh/glue.h            | 1 -
 nimble/host/mesh/{include/mesh => src}/atomic.h | 0
 nimble/host/mesh/src/net.h                      | 1 +
 nimble/host/mesh/src/prov.c                     | 2 +-
 4 files changed, 2 insertions(+), 2 deletions(-)

commit d17120a2a1c335b41617c6acc2459370eedecf5e
Merge: 8a742233 c5a0c7a3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 18 10:20:57 2018 +0200

    Merge pull request #96 from turon/pr/64-bit
    
    porting: Add support for running on 64-bit architectures

commit 8a74223386ff8636710f9bbd7935b4e04da44c98
Merge: 1490ed4a 17cf119f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 18 10:10:55 2018 +0200

    Merge pull request #100 from andrzej-kaczmarek/unaligned-fix
    
    nimble/ll: Use simply memcpy for copying in resolv

commit 17cf119f05378bc002ab68dd356c34654dc315d3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 18 01:36:43 2018 +0200

    nimble/ll: Use simply memcpy for copying in resolv
    
    Copying data by words requires both src and dst to be word aligned, but
    fc4497b78 modified ble_ll_resolv_entry struct so neither rl_local_irk
    nor rl_peer_irk are aligned properly so copying does not work on nRF51
    (Cortex-M0).
    
    Let's use memcpy() here which is a bit slower, but since this code is
    not used very often it does not really matter.

 nimble/controller/src/ble_ll_resolv.c | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

commit c5a0c7a3ee1718f2c702317e7ec2f3890d5237a3
Author: Martin Turon <mturon@nestlabs.com>
Date:   Mon May 14 17:50:20 2018 -0700

    porting: Add support for running on 64-bit architectures

 porting/nimble/include/os/os_mempool.h |  2 +-
 porting/nimble/src/os_mempool.c        | 20 ++++++++++----------
 porting/nimble/src/os_msys_init.c      |  4 ++--
 3 files changed, 13 insertions(+), 13 deletions(-)

commit 1490ed4a114eef19bad71534cbe5e60934d00581
Merge: 9c3fe255 0d8dd2ea
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 16 14:04:40 2018 +0200

    Merge pull request #99 from sjanc/readme
    
    Add some initial documentation

commit 0d8dd2ea9605746020d6b6698418fe2ee60ad0d8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 16 11:50:09 2018 +0200

    Add some initial documentation
    
    This includes coding style, license and README.

 CODING_STANDARDS.md | 267 +++++++++++++++++++++++++++++++
 LICENSE             | 449 ++++++++++++++++++++++++++++++++++++++++++++++++++++
 NOTICE              |   8 +
 README.md           | 172 ++++++++++++++++++++
 RELEASE_NOTES.md    |   2 +
 5 files changed, 898 insertions(+)

commit 9c3fe25549f9d913a8bceb8638c57863ba08d7f8
Merge: d989c69c 0fd550bb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue May 15 16:14:03 2018 +0200

    Merge pull request #98 from michal-narajowski/mesh-npl
    
    Update Mesh to use NPL

commit d989c69cffa4b40a97ca687fffba7a00d250f17d
Merge: 3d11e019 7b6d509e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 15 16:13:50 2018 +0200

    Merge pull request #95 from turon/pr/hci_sock
    
    [hci_sock] Update hci socket transport to use NPL.

commit 0fd550bb6c72b45272449232002a1036449cdbcd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed May 9 14:17:33 2018 +0200

    mesh: Use Nimble Porting Layer

 nimble/host/mesh/include/mesh/glue.h | 31 ++++++++++-----------
 nimble/host/mesh/src/access.c        |  4 +--
 nimble/host/mesh/src/adv.c           | 28 +++++++++----------
 nimble/host/mesh/src/adv.h           |  2 +-
 nimble/host/mesh/src/beacon.c        |  2 +-
 nimble/host/mesh/src/cfg_srv.c       |  4 +--
 nimble/host/mesh/src/friend.c        |  8 +++---
 nimble/host/mesh/src/glue.c          | 54 ++++++++++++++++++------------------
 nimble/host/mesh/src/health_srv.c    |  4 +--
 nimble/host/mesh/src/lpn.c           |  2 +-
 nimble/host/mesh/src/net.c           |  4 +--
 nimble/host/mesh/src/net.h           |  2 +-
 nimble/host/mesh/src/prov.c          |  2 +-
 nimble/host/mesh/src/proxy.c         |  9 +++---
 nimble/host/mesh/src/transport.c     |  8 +++---
 15 files changed, 81 insertions(+), 83 deletions(-)

commit b029b909d4c330749f42745f946de17f984dfe72
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed May 2 15:56:13 2018 +0200

    mesh: Initialize mesh adv thread only if building with Mynewt

 nimble/host/mesh/include/mesh/porting.h | 19 +++++++++++++++++++
 nimble/host/mesh/src/adv.c              | 13 +++++++++----
 2 files changed, 28 insertions(+), 4 deletions(-)

commit a1005bd9c5b439bf96fec2461c5a0b08cbc4bfac
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed May 9 14:16:57 2018 +0200

    porting: Add missing API functions used by Mesh

 nimble/include/nimble/nimble_npl.h                 | 12 +++++++
 .../npl/freertos/include/nimble/nimble_npl_os.h    | 31 ++++++++++++++++++
 porting/npl/freertos/include/nimble/npl_freertos.h |  5 +++
 porting/npl/freertos/src/npl_os_freertos.c         | 38 +++++++++++++++++++---
 porting/npl/mynewt/include/nimble/nimble_npl_os.h  | 32 ++++++++++++++++++
 5 files changed, 113 insertions(+), 5 deletions(-)

commit c29971e38d91ade93cfeec71daa29b43a3cf0a7d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue May 8 16:17:35 2018 +0200

    porting: Add Mesh files to Makefile

 porting/nimble/Makefile.defs |  4 ++++
 porting/nimble/Makefile.mesh | 25 +++++++++++++++++++++++++
 2 files changed, 29 insertions(+)

commit b8a881690f2b49d7be1c6bb37f4039ed7248166b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri May 4 17:04:58 2018 +0200

    nimble/host: Fix HCI command processing when using host only

 nimble/host/src/ble_hs_hci_cmd.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 3d11e019c082c2b3d9d8d15ede59d7e3234dca54
Merge: c34f0805 bd8f4515
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 15 12:57:43 2018 +0200

    Merge pull request #8 from rymanluk/mesh_ext_adv
    
    nimble/mesh: Make use of advertising extensions

commit c34f080554bb612e7f458920b9faf295fdfad419
Merge: a4e8f42d c1a85a00
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 15 09:11:06 2018 +0200

    Merge pull request #93 from andrzej-kaczmarek/fix-auth-pyld-tmo-evt
    
    nimble/host: Enable auth payload tmo event only for >=4.1

commit a4e8f42daae86a8e9987c87e84fa9a0725e987da
Merge: 5beccb25 93514297
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 15 09:10:43 2018 +0200

    Merge pull request #94 from andrzej-kaczmarek/remove-npl-decl
    
    nimble/porting: Remove BLE_NPL_STORAGE_DECL

commit 5beccb250861e8d836a121f41fd323ab51d86565
Merge: 516595a8 5d20ab19
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue May 15 08:41:18 2018 +0200

    Merge pull request #92 from sjanc/ext_adv_opt
    
    nimble/gap: Optimise setting data with extended advertising

commit 7b6d509eea53015b21840423499c3c6f55c78430
Author: Martin Turon <mturon@nestlabs.com>
Date:   Mon May 14 17:44:04 2018 -0700

    [hci_sock] Update hci socket transport to use NPL.

 nimble/transport/socket/src/ble_hci_socket.c | 77 ++++++++++++++++++++--------
 1 file changed, 56 insertions(+), 21 deletions(-)

commit 935142971f6fb961a5b62191f747cc7da301412e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 14 22:08:34 2018 +0200

    nimble/porting: Remove BLE_NPL_STORAGE_DECL
    
    Currently nimble_npl_os.h is included before APIs are declared. This is
    to make sure all OS-specific types are defined early since they are
    needed for APIs declaration. This has a nice side effect since we can
    simply define some simple APIs as static inlines in nimble_npl_os.h and
    later declarations will simply inherit linkage of prior symbol, thus no
    error is emitted. As a result, we do not need BLE_NPL_STORAGE_DECL thus
    let's just remove it.

 nimble/include/nimble/nimble_npl.h | 36 ------------------------------------
 porting/examples/dummy/Makefile    |  2 +-
 2 files changed, 1 insertion(+), 37 deletions(-)

commit c1a85a007b1ee86857fdf49a64cc0598cc5b7cef
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 14 21:43:02 2018 +0200

    nimble/host: Enable auth payload tmo event only for >=4.1
    
    LE Ping was added in Core 4.1 thus Authenticated Payload Timeout Event
    shall be only enabled for controller supporting >=4.1.
    
    Note it would be also good to check for controller features to confirm,
    but we do not have this implemented yet.

 nimble/host/src/ble_hs_startup.c | 25 +++++++++++++++----------
 1 file changed, 15 insertions(+), 10 deletions(-)

commit bd8f451583a8d9b22d53c1c77887667847380d15
Author: Grzegorz Kolodziejczyk <grzegorz.kolodziejczyk@codecoup.pl>
Date:   Wed May 9 16:48:41 2018 +0200

    nimble/host: Start extended scan if possible
    
    While enabling scan for mesh, appropriate scan type should be use.

 nimble/host/mesh/src/adv.c | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit f98706cbc5e9dd962961e3173af72e22806a539c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Mar 19 14:16:39 2018 +0100

    nimble/mesh: Add possibility to use extended advertising
    
    With this patch Mesh can make use of multi instances which came with
    advertising extension. It creates one advertising instance for
    PB-ADV and one for PB-GATT and PROXY.
    
    That said, it is possible to create additional instances which are
    used for non mesh purpose. Note that this brings limitation on Mesh
    Friendship due to timings.
    
    To make use of it application needs to set BLE_EXT_ADV and
    BLE_MULTI_ADV_INSTANCES at least to 1. Mesh will use last available
    advertising instance for PB-ADV and second to last for PB-GATT and
    PROXY

 nimble/host/mesh/include/mesh/glue.h |   2 +-
 nimble/host/mesh/src/glue.c          | 186 ++++++++++++++++++++++++++++++++++-
 2 files changed, 184 insertions(+), 4 deletions(-)

commit 5d20ab19365b236c93733a46acc8a3ef61c2ce8a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 14 15:40:55 2018 +0200

    nimble/gap: Optimise setting data with extended advertising
    
    This makes GAP code to trim mbuf chain with adv data while consuming
    it but before sending HCI commands. Thanks to this is is possible
    to use MSYS pool from application for data which is later reused by
    controller resulting is smaller pool being needed.

 nimble/host/src/ble_gap.c | 33 ++++++++++++++++++++++-----------
 1 file changed, 22 insertions(+), 11 deletions(-)

commit 516595a8488aa2287c332f246f2fd57881724842
Merge: 21a15f71 c2719497
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 14 15:14:55 2018 +0200

    Merge pull request #87 from sjanc/adv_random_fix
    
    nimble/gap: Fix assert on slave connection with ext advertising

commit 21a15f71396dcbdedb05e94d5bddff3f964f0d09
Merge: 1c8306c5 bdae470a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 14 15:14:45 2018 +0200

    Merge pull request #91 from sjanc/adv_term
    
    nimble/ll: Fix advertising set termination

commit bdae470aa7cec5ed75aa09feecd2272ae4acd9bb
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 14 13:19:59 2018 +0200

    nimble/ll: Fix advertising set termination
    
    When using extended advertising PDUs it is possible that AUX_ADV_IND
    was dropped due to being scheduled too late. If that happen for
    last event (due to duration or max events count) set wouldn't be
    terminated.

 nimble/controller/src/ble_ll_adv.c | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)

commit 1c8306c5fb2fbebcabc589580adf12337499b6d5
Merge: fc9896d4 1607a069
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 14 13:46:48 2018 +0200

    Merge pull request #73 from sjanc/read_peer_rpa
    
    Refactor RPA handling in controller

commit c2719497299fd38c80bbf40ff4d015bc1775bc97
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu May 10 15:58:03 2018 +0200

    nimble/gap: Fix assert on slave connection with ext advertising
    
    When extended advertising is enabled and advertising instance is
    configured to own_address_type=random, it is using per instance
    random address and not global random address. We need to store
    address set in instance and pass it to connection object so that
    it can be returned as ID address.

 nimble/host/src/ble_gap.c          |  9 +++++++--
 nimble/host/src/ble_hs_conn.c      | 15 +++++++++++++++
 nimble/host/src/ble_hs_conn_priv.h |  3 +++
 3 files changed, 25 insertions(+), 2 deletions(-)

commit fc9896d42a14b818da343cbb14c568bdc86f677c
Merge: 5a75e9dd 398930b0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon May 14 10:38:57 2018 +0200

    Merge pull request #88 from rymanluk/port_fix
    
    nimble/phy: Fix setting correct GPIO PORT

commit 398930b071ca948fbd89d2a67e319b429ea482c5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 11 12:10:01 2018 +0200

    nimble/phy: Fix setting correct GPIO PORT
    
    Pin is already masked in this place, so pin > 31 will always result in
    0. Therefore check for already known port.

 nimble/drivers/nrf52/src/ble_phy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5a75e9dd96c46521c467e1905224fbcdbdcccae2
Merge: 5459d8e0 2ca097f0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 11 12:08:23 2018 +0200

    Merge pull request #86 from rymanluk/mesh_pkg
    
    nimble/mesh: Add bt_mesh_register_gatt to pkg init

commit 1607a069a77ea6cc35da5825d03431878b4479d4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 30 11:57:12 2018 +0200

    nimble/ll: Fix LE Remove Device From Resolving List Command
    
    This command was not able to remove last element on resolv list. Since
    g_ble_ll_resolv_data.rl_cnt is already used by ble_ll_is_on_resolv_list
    change range check to assert.
    
    Also, when a Controller cannot remove a device from the resolving list
    because it is not found, it shall return the error code Unknown
    Connection Identifier (0x02).

 nimble/controller/src/ble_ll_resolv.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit cb93173f60a6fffa724e49be2ca03b154ea33bb0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 30 09:15:33 2018 +0200

    nimble/ll: Use common RPA timer in advertising
    
    This reduces number of RPA generated and results in one (same as
    RPA returned via LE Read Peer Resolvable Address Command) RPA being
    used at time for each remote device.

 nimble/controller/include/controller/ble_ll_adv.h |  3 ++
 nimble/controller/src/ble_ll_adv.c                | 51 +++++++++++++----------
 nimble/controller/src/ble_ll_resolv.c             |  2 +
 3 files changed, 34 insertions(+), 22 deletions(-)

commit b2fc06543f1629938353d1a23b6ebdcbc515d75a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 27 14:31:13 2018 +0200

    nimble/ll: Implement LE Read Local/Peer RPA commands

 .../controller/include/controller/ble_ll_resolv.h  |  7 ++--
 nimble/controller/src/ble_ll_hci.c                 |  4 +-
 nimble/controller/src/ble_ll_resolv.c              | 46 +++++++++++++++++++---
 3 files changed, 47 insertions(+), 10 deletions(-)

commit fc4497b786d2debc6e95d6251ba93ec0802e8446
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 27 14:29:48 2018 +0200

    nimble/ll: Refactor RPA handling in resolving code
    
    - peer and local are always generated when peer is added to resolved list
    - users get current RPA when needed
    - RPAs are re-generated only from RPA timer

 .../controller/include/controller/ble_ll_resolv.h  |   4 +-
 nimble/controller/src/ble_ll_conn.c                |   2 +-
 nimble/controller/src/ble_ll_resolv.c              | 176 ++++++++++++---------
 nimble/controller/src/ble_ll_scan.c                |   2 +-
 4 files changed, 104 insertions(+), 80 deletions(-)

commit 2ca097f02d67c3e3670918caefa747b7d7bc464f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 10 10:38:39 2018 +0200

    nimble/mesh: Add bt_mesh_register_gatt to pkg init
    
    Whenever mesh is initialized we need to make sure gatt services are
    registered for GATT proxy

 nimble/host/mesh/pkg.yml | 1 +
 1 file changed, 1 insertion(+)

commit 5459d8e07440ccc108dfdd0f8aaf2296f684a59e
Merge: 805aa97a 4173207c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu May 10 10:27:00 2018 +0200

    Merge pull request #85 from sjanc/dtm_fix
    
    nimble/ll: Fix DTM build

commit 4173207cb89739e1ce3dec2d9c2dd1809ada3f99
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu May 10 10:05:38 2018 +0200

    nimble/ll: Fix DTM build

 nimble/controller/src/ble_ll_dtm.c | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)

commit 805aa97a1c11e0eb5b3f5f1c11a4dc3a32bb58b8
Merge: 14971d4a 4fa96ede
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Wed May 9 14:41:59 2018 -0700

    Merge pull request #84 from ccollins476ad/version.yml
    
    Add `version.yml` to master.

commit 4fa96eded2f5a7cd718ba48cd51ad1044da523a9
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 9 12:04:37 2018 -0700

    Add `version.yml` to master.
    
    Newt uses the `version.yml` file to determine the version of a checked
    out repo.  This should always be 0.0.0 in the master branch.
    
    Please see https://github.com/apache/mynewt-newt/pull/165 for more
    information about newt uses this file.

 version.yml | 3 +++
 1 file changed, 3 insertions(+)

commit 14971d4a9dfe375da80e1a1bd86fa8a0a10426ad
Merge: 4c4eb4d4 1f521a55
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 9 20:38:24 2018 +0200

    Merge pull request #83 from andrzej-kaczmarek/test-fix
    
    nimble: Fix tests build with NPL

commit 1f521a5575290f6eb9463615aeab3df6fed6ff4d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 9 20:15:25 2018 +0200

    nimble: Fix tests build with NPL
    
    This fixes following build errors in tests missed during NPL
    implementation:
    
    Compiling repos/apache-mynewt-nimble/nimble/host/src/ble_hs_hci_evt.c
    repos/apache-mynewt-nimble/nimble/host/src/ble_hs.c: In function ‘ble_hs_locked_by_cur_task’:
    repos/apache-mynewt-nimble/nimble/host/src/ble_hs.c:130:25: error: ‘struct ble_npl_mutex’ has no member named ‘mu_owner’
         owner = ble_hs_mutex.mu_owner;
                             ^
    
    Compiling repos/apache-mynewt-core/sys/log/full/src/log.c
    In file included from repos/apache-mynewt-nimble/nimble/controller/test/src/ble_ll_csa2_test.c:24:0:
    repos/apache-mynewt-nimble/nimble/controller/include/controller/ble_ll_conn.h:277:26: error: field ‘conn_ev_end’ has incomplete type
         struct ble_npl_event conn_ev_end;
                              ^~~~~~~~~~~
    repos/apache-mynewt-nimble/nimble/controller/include/controller/ble_ll_conn.h:290:28: error: field ‘ctrl_proc_rsp_timer’ has incomplete type
         struct ble_npl_callout ctrl_proc_rsp_timer;
                                ^~~~~~~~~~~~~~~~~~~
    repos/apache-mynewt-nimble/nimble/controller/include/controller/ble_ll_conn.h:296:28: error: field ‘auth_pyld_timer’ has incomplete type
         struct ble_npl_callout auth_pyld_timer;
                                ^~~~~~~~~~~~~~~

 nimble/controller/include/controller/ble_ll_conn.h | 1 +
 nimble/host/src/ble_hs.c                           | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

commit 4c4eb4d4ce6fd37992146ec00cdd41856e9c7235
Merge: a8cf73f0 b72a225f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed May 9 17:26:44 2018 +0200

    Merge pull request #82 from kolodgrz/mesh_shell_v1
    
    mesh: shell: Rename init function to avoid redefinition

commit b72a225f7eab561b5b42f79d857b1ba041ace09f
Author: Grzegorz Kolodziejczyk <grzegorz.kolodziejczyk@codecoup.pl>
Date:   Wed May 9 16:42:51 2018 +0200

    mesh: shell: Rename init function to avoid redefinition
    
    This patch makes mesh shell init function name unique, since btshell
    uses the same name function symbol.

 nimble/host/mesh/include/mesh/testing.h | 2 +-
 nimble/host/mesh/src/shell.c            | 4 ++--
 nimble/host/mesh/src/testing.c          | 2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)

commit a8cf73f02c0b5793d9d2ae0808523d871cc88603
Merge: 03d34948 be369983
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 9 10:07:04 2018 +0200

    Merge pull request #72 from andrzej-kaczmarek/porting-wip
    
    Porting NimBLE

commit be36998348998c371a5af67da37742cdc8c1cb92
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:10:10 2018 +0200

    Add .gitignore

 .gitignore | 3 +++
 1 file changed, 3 insertions(+)

commit bf9eb17cd99e0406ce8673ab681a8d229ef24b6c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:10:21 2018 +0200

    porting: Add NPL for FreeRTOS

 .../npl/freertos/include/nimble/nimble_npl_os.h    | 285 +++++++++++++++++++
 porting/npl/freertos/include/nimble/npl_freertos.h |  74 +++++
 porting/npl/freertos/src/npl_os_freertos.c         | 312 +++++++++++++++++++++
 3 files changed, 671 insertions(+)

commit d1536977af25f43bc6a0c474725a7e1e4dc1976a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:09:55 2018 +0200

    porting: Add dummy NPL

 porting/examples/dummy/Makefile                  |   35 +
 porting/examples/dummy/main.c                    |    8 +
 porting/nimble/Makefile.controller               |   30 +
 porting/nimble/Makefile.defs                     |   96 ++
 porting/nimble/Makefile.tinycrypt                |   10 +
 porting/nimble/include/hal/hal_timer.h           |  173 ++++
 porting/nimble/include/log/log.h                 |   45 +
 porting/nimble/include/mem/mem.h                 |   68 ++
 porting/nimble/include/nimble/nimble_port.h      |   37 +
 porting/nimble/include/os/endian.h               |  225 +++++
 porting/nimble/include/os/os.h                   |   60 ++
 porting/nimble/include/os/os_cputime.h           |  240 +++++
 porting/nimble/include/os/os_error.h             |   43 +
 porting/nimble/include/os/os_mbuf.h              |  627 +++++++++++++
 porting/nimble/include/os/os_mempool.h           |  255 ++++++
 porting/nimble/include/os/os_trace_api.h         |   54 ++
 porting/nimble/include/os/queue.h                |  522 +++++++++++
 porting/nimble/include/stats/stats.h             |   80 ++
 porting/nimble/include/syscfg/syscfg.h           |  886 ++++++++++++++++++
 porting/nimble/include/sysinit/sysinit.h         |   37 +
 porting/nimble/pkg.yml                           |   43 +
 porting/nimble/src/endian.c                      |  218 +++++
 porting/nimble/src/hal_timer.c                   |  840 +++++++++++++++++
 porting/nimble/src/mem.c                         |  302 +++++++
 porting/nimble/src/nimble_port.c                 |   74 ++
 porting/nimble/src/os_cputime.c                  |  126 +++
 porting/nimble/src/os_cputime_pwr2.c             |  109 +++
 porting/nimble/src/os_mbuf.c                     | 1039 ++++++++++++++++++++++
 porting/nimble/src/os_mempool.c                  |  303 +++++++
 porting/nimble/src/os_msys_init.c                |   84 ++
 porting/npl/dummy/include/nimble/nimble_npl_os.h |   60 ++
 porting/npl/dummy/src/hci_dummy.c                |  250 ++++++
 porting/npl/dummy/src/npl_os_dummy.c             |  201 +++++
 33 files changed, 7180 insertions(+)

commit 84a4c118ac3b91a2eda2da8119d4031b9480c3e4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:09:19 2018 +0200

    porting: Add Mynewt NPL

 nimble/pkg.yml                                    |   1 +
 porting/npl/mynewt/include/nimble/nimble_npl_os.h | 257 ++++++++++++++++++++++
 porting/npl/mynewt/pkg.yml                        |  27 +++
 3 files changed, 285 insertions(+)

commit 99016fea6a57ba86f692a50bfb906abd81556ba2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:08:54 2018 +0200

    nimble: Make NimBLE use NPL
    
    This replaces calls to Mynewt kernel APIs with corresponding calls to
    NPL APIs everywhere in Mynewt's code.

 nimble/controller/include/controller/ble_ll.h      |  17 ++--
 nimble/controller/include/controller/ble_ll_conn.h |   6 +-
 nimble/controller/include/controller/ble_ll_scan.h |   5 +-
 nimble/controller/src/ble_ll.c                     |  52 +++++-----
 nimble/controller/src/ble_ll_adv.c                 |  48 +++++----
 nimble/controller/src/ble_ll_conn.c                |  34 +++----
 nimble/controller/src/ble_ll_conn_hci.c            |   8 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   2 +-
 nimble/controller/src/ble_ll_ctrl.c                |  18 ++--
 nimble/controller/src/ble_ll_hci.c                 |  19 ++--
 nimble/controller/src/ble_ll_resolv.c              |  26 ++---
 nimble/controller/src/ble_ll_scan.c                |  15 ++-
 nimble/drivers/nrf52/src/ble_hw.c                  |   9 ++
 nimble/drivers/nrf52/src/ble_phy.c                 |  15 ++-
 nimble/host/include/host/ble_hs.h                  |   7 +-
 nimble/host/src/ble_att_priv.h                     |   8 +-
 nimble/host/src/ble_att_svr.c                      |   4 +-
 nimble/host/src/ble_gap.c                          |  45 ++++-----
 nimble/host/src/ble_gattc.c                        |  18 ++--
 nimble/host/src/ble_hs.c                           | 112 +++++++++------------
 nimble/host/src/ble_hs_conn.c                      |   4 +-
 nimble/host/src/ble_hs_conn_priv.h                 |   2 +-
 nimble/host/src/ble_hs_hci.c                       |  20 ++--
 nimble/host/src/ble_hs_priv.h                      |   2 +-
 nimble/host/src/ble_l2cap.c                        |   2 +-
 nimble/host/src/ble_l2cap_sig.c                    |  13 +--
 nimble/host/src/ble_monitor.c                      |  30 +++---
 nimble/host/src/ble_sm.c                           |  12 +--
 nimble/host/src/ble_sm_priv.h                      |   2 +-
 nimble/include/nimble/ble.h                        |   6 +-
 30 files changed, 279 insertions(+), 282 deletions(-)

commit c588ea8d61b5c09f0d68dfff35a4192a15813828
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 11:08:32 2018 +0200

    nimble: Add common NimBLE Porting Layer
    
    This adds declarations of NimBLE Porting Layer (NPL).
    NPL is a set of APIs for OS-specific operations (mutexes, queues etc.)
    which should be implemented for target OS when porting. This also
    includes Mynewt, since NimBLE will use NPL APIs everywhere instead of
    Mynewt's kernel APIs.

 nimble/include/nimble/nimble_npl.h | 199 +++++++++++++++++++++++++++++++++++++
 1 file changed, 199 insertions(+)

commit 0d889cf0379cdb6af2b45e7f4725c09f04ffb040
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 10:40:44 2018 +0200

    nimble/host: Add internal mqueue implementation
    
    This makes NimBLE use copy of os_mqueue instead of kernel/os
    implementation. This is to allow NimBLE use its own APIs for OS
    primitives (i.e. queues and events) which allows for easier porting to
    other OS.

 nimble/host/src/ble_hs.c        | 10 ++---
 nimble/host/src/ble_hs_mqueue.c | 82 +++++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_priv.h   |  9 +++++
 3 files changed, 96 insertions(+), 5 deletions(-)

commit 32d21b7484fdf586fd2db3fcf3d71a07727cdab1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 27 14:33:49 2018 +0200

    ext: Add local copy on TinyCrypt
    
    This will be required for standalone (libnimble) builds. Copy made from
    mynewt_1_3_0_tag (without pkg.yml).

 ext/tinycrypt/AUTHORS                              |  15 +
 ext/tinycrypt/LICENSE                              |  61 ++
 ext/tinycrypt/README                               |  71 ++
 ext/tinycrypt/VERSION                              |   1 +
 ext/tinycrypt/documentation/tinycrypt.rst          | 352 ++++++++
 ext/tinycrypt/include/tinycrypt/aes.h              | 130 +++
 ext/tinycrypt/include/tinycrypt/cbc_mode.h         | 151 ++++
 ext/tinycrypt/include/tinycrypt/ccm_mode.h         | 211 +++++
 ext/tinycrypt/include/tinycrypt/cmac_mode.h        | 194 +++++
 ext/tinycrypt/include/tinycrypt/constants.h        |  61 ++
 ext/tinycrypt/include/tinycrypt/ctr_mode.h         | 108 +++
 ext/tinycrypt/include/tinycrypt/ctr_prng.h         | 166 ++++
 ext/tinycrypt/include/tinycrypt/ecc.h              | 545 ++++++++++++
 ext/tinycrypt/include/tinycrypt/ecc_dh.h           | 131 +++
 ext/tinycrypt/include/tinycrypt/ecc_dsa.h          | 139 +++
 .../include/tinycrypt/ecc_platform_specific.h      |  81 ++
 ext/tinycrypt/include/tinycrypt/hmac.h             | 139 +++
 ext/tinycrypt/include/tinycrypt/hmac_prng.h        | 164 ++++
 ext/tinycrypt/include/tinycrypt/sha256.h           | 129 +++
 ext/tinycrypt/include/tinycrypt/utils.h            |  95 +++
 ext/tinycrypt/src/aes_decrypt.c                    | 164 ++++
 ext/tinycrypt/src/aes_encrypt.c                    | 191 +++++
 ext/tinycrypt/src/cbc_mode.c                       | 114 +++
 ext/tinycrypt/src/ccm_mode.c                       | 266 ++++++
 ext/tinycrypt/src/cmac_mode.c                      | 254 ++++++
 ext/tinycrypt/src/ctr_mode.c                       |  85 ++
 ext/tinycrypt/src/ctr_prng.c                       | 283 +++++++
 ext/tinycrypt/src/ecc.c                            | 942 +++++++++++++++++++++
 ext/tinycrypt/src/ecc_dh.c                         | 200 +++++
 ext/tinycrypt/src/ecc_dsa.c                        | 295 +++++++
 ext/tinycrypt/src/ecc_platform_specific.c          | 105 +++
 ext/tinycrypt/src/hmac.c                           | 148 ++++
 ext/tinycrypt/src/hmac_prng.c                      | 212 +++++
 ext/tinycrypt/src/sha256.c                         | 217 +++++
 ext/tinycrypt/src/utils.c                          |  74 ++
 35 files changed, 6494 insertions(+)

commit 03d349488407c389ad3348d0730d9a8b82a6ceb7
Merge: a22f6e8e e4065a03
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon May 7 09:08:21 2018 +0200

    Merge pull request #50 from samveen/small_fixes
    
    Strip trailing whitespace from all files

commit e4065a0345e8d937b38425857c1c01e4ea2404de
Author: Samveen <samveen@samveen.in>
Date:   Tue Apr 17 14:27:53 2018 +0700

    strip all trailing whitespace

 nimble/controller/pkg.yml                          |   2 +-
 nimble/controller/src/ble_ll_scan.c                |   4 +-
 nimble/drivers/native/pkg.yml                      |   2 +-
 nimble/drivers/nrf51/pkg.yml                       |   2 +-
 nimble/drivers/nrf52/pkg.yml                       |   2 +-
 nimble/host/include/host/ble_att.h                 |   2 +-
 nimble/host/include/host/ble_gatt.h                |   4 +-
 nimble/host/include/host/ble_hs_test.h             |   2 +-
 nimble/host/include/host/ble_monitor.h             |   2 +-
 nimble/host/include/host/ble_store.h               |   4 +-
 nimble/host/include/host/ble_uuid.h                |   2 +-
 nimble/host/mesh/pkg.yml                           |   4 +-
 nimble/host/mesh/syscfg.yml                        |  24 ++---
 nimble/host/pkg.yml                                |   2 +-
 nimble/host/pts/pts-gap.txt                        |   2 +-
 nimble/host/pts/pts-gatt.txt                       |  14 +--
 .../ans/include/services/ans/ble_svc_ans.h         |   8 +-
 nimble/host/services/ans/pkg.yml                   |   8 +-
 nimble/host/services/ans/src/ble_svc_ans.c         | 112 ++++++++++-----------
 nimble/host/services/bas/pkg.yml                   |   6 +-
 .../dis/include/services/dis/ble_svc_dis.h         |   4 +-
 nimble/host/services/dis/pkg.yml                   |   4 +-
 nimble/host/services/dis/src/ble_svc_dis.c         |  12 +--
 nimble/host/services/gap/pkg.yml                   |   4 +-
 nimble/host/services/gatt/pkg.yml                  |   2 +-
 .../ias/include/services/ias/ble_svc_ias.h         |   2 +-
 nimble/host/services/ias/pkg.yml                   |   6 +-
 nimble/host/services/ias/src/ble_svc_ias.c         |  20 ++--
 .../lls/include/services/lls/ble_svc_lls.h         |   4 +-
 nimble/host/services/lls/pkg.yml                   |   4 +-
 nimble/host/services/lls/src/ble_svc_lls.c         |  38 +++----
 nimble/host/services/tps/pkg.yml                   |   4 +-
 nimble/host/services/tps/src/ble_svc_tps.c         |   4 +-
 nimble/host/src/ble_att.c                          |   2 +-
 nimble/host/src/ble_att_clt.c                      |   4 +-
 nimble/host/src/ble_att_cmd.c                      |   2 +-
 nimble/host/src/ble_att_cmd_priv.h                 |   2 +-
 nimble/host/src/ble_att_svr.c                      |   6 +-
 nimble/host/src/ble_eddystone.c                    |   2 +-
 nimble/host/src/ble_gap.c                          |   2 +-
 nimble/host/src/ble_gatt_priv.h                    |   2 +-
 nimble/host/src/ble_gatts.c                        |   4 +-
 nimble/host/src/ble_hs_adv.c                       |   2 +-
 nimble/host/src/ble_hs_conn.c                      |   6 +-
 nimble/host/src/ble_hs_conn_priv.h                 |   2 +-
 nimble/host/src/ble_hs_dbg_priv.h                  |   2 +-
 nimble/host/src/ble_hs_flow.c                      |   6 +-
 nimble/host/src/ble_hs_flow_priv.h                 |   2 +-
 nimble/host/src/ble_hs_hci.c                       |   4 +-
 nimble/host/src/ble_hs_mbuf.c                      |   2 +-
 nimble/host/src/ble_hs_mbuf_priv.h                 |   2 +-
 nimble/host/src/ble_hs_misc.c                      |   2 +-
 nimble/host/src/ble_hs_startup_priv.h              |   2 +-
 nimble/host/src/ble_l2cap.c                        |   4 +-
 nimble/host/src/ble_l2cap_coc.c                    |   2 +-
 nimble/host/src/ble_l2cap_priv.h                   |   2 +-
 nimble/host/src/ble_l2cap_sig.c                    |   6 +-
 nimble/host/src/ble_l2cap_sig_cmd.c                |   2 +-
 nimble/host/src/ble_l2cap_sig_priv.h               |   2 +-
 nimble/host/src/ble_monitor_priv.h                 |   2 +-
 nimble/host/src/ble_sm_priv.h                      |   2 +-
 nimble/host/src/ble_store_util.c                   |   4 +-
 nimble/host/src/ble_uuid.c                         |   2 +-
 nimble/host/store/config/pkg.yml                   |   2 +-
 nimble/host/store/ram/pkg.yml                      |   2 +-
 nimble/host/test/pkg.yml                           |   2 +-
 nimble/host/test/src/ble_att_clt_test.c            |   2 +-
 nimble/host/test/src/ble_att_svr_test.c            |   2 +-
 nimble/host/test/src/ble_gap_test.c                |   2 +-
 nimble/host/test/src/ble_gatt_conn_test.c          |   2 +-
 nimble/host/test/src/ble_gatt_disc_c_test.c        |   2 +-
 nimble/host/test/src/ble_gatt_disc_d_test.c        |   2 +-
 nimble/host/test/src/ble_gatt_disc_s_test.c        |   2 +-
 nimble/host/test/src/ble_gatt_find_s_test.c        |   2 +-
 nimble/host/test/src/ble_gatt_read_test.c          |   4 +-
 nimble/host/test/src/ble_gatt_write_test.c         |   2 +-
 nimble/host/test/src/ble_gatts_notify_test.c       |   4 +-
 nimble/host/test/src/ble_gatts_reg_test.c          |   2 +-
 nimble/host/test/src/ble_hs_adv_test.c             |   2 +-
 nimble/host/test/src/ble_hs_conn_test.c            |   2 +-
 nimble/host/test/src/ble_hs_hci_test.c             |   2 +-
 nimble/host/test/src/ble_hs_id_test.c              |   2 +-
 nimble/host/test/src/ble_hs_pvcy_test.c            |   6 +-
 nimble/host/test/src/ble_hs_test.c                 |   2 +-
 nimble/host/test/src/ble_hs_test_util.c            |   2 +-
 nimble/host/test/src/ble_l2cap_test.c              |   2 +-
 nimble/host/test/src/ble_os_test.c                 |   2 +-
 nimble/host/test/src/ble_store_test.c              |   2 +-
 nimble/host/test/src/ble_uuid_test.c               |   2 +-
 nimble/host/tools/log2smtest.rb                    |   4 +-
 nimble/host/util/pkg.yml                           |   2 +-
 nimble/include/nimble/ble_hci_trans.h              |   2 +-
 nimble/include/nimble/nimble_opt_auto.h            |  10 +-
 nimble/pkg.yml                                     |   2 +-
 nimble/transport/emspi/pkg.yml                     |   2 +-
 nimble/transport/pkg.yml                           |   2 +-
 .../ram/include/transport/ram/ble_hci_ram.h        |   2 +-
 nimble/transport/ram/pkg.yml                       |   2 +-
 nimble/transport/socket/pkg.yml                    |   2 +-
 nimble/transport/uart/pkg.yml                      |   2 +-
 100 files changed, 247 insertions(+), 247 deletions(-)

commit a22f6e8e8bfaca35dd32ccb675db7c707c215908
Merge: 3f8b139b 0a9320d8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 20:50:07 2018 +0200

    Merge pull request #79 from andrzej-kaczmarek/ll-trng
    
    nimble: Use TRNG

commit 3f8b139b4c371658d11732799724c88431de4901
Merge: 9017366a 729d7238
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 4 14:42:39 2018 +0200

    Merge pull request #78 from sjanc/priv_build
    
    nimble/ll: Fix build with privacy disabled

commit 0a9320d84d86f4c8970895bb34ae7debf1acff7d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 13:55:44 2018 +0200

    nimble/host: Use TRNG driver if available
    
    If TRNG is enabled, let's use it directly instead of going through HCI.
    
    As a bonus, this way uECC can be used even before NimBLE is synced with
    controller.

 nimble/host/src/ble_sm_alg.c | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit 47a3ce26f2322e8ee601837b6c8b12eecddfe1e2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 4 13:22:24 2018 +0200

    nimble/ll: Use TRNG driver if available
    
    This patch enabled controller to use TRNG via driver, if enabled,
    instead of ble_hw interfaces. In case of nRF52 this is the same
    peripheral as used by ble_hw, but by accessing it via driver it can
    be shared with other RNG users.

 nimble/controller/src/ble_ll_rand.c | 26 +++++++++++++++++++++++++-
 1 file changed, 25 insertions(+), 1 deletion(-)

commit 729d723861c08f87a3acefa9c9903354e171d904
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 4 13:21:02 2018 +0200

    nimble/ll: Fix build with privacy disabled

 nimble/controller/src/ble_ll_conn.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 9017366a46250555b62b4930744a6b1e1f97ccc9
Merge: 7316d873 abe1881a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 4 11:58:56 2018 +0200

    Merge pull request #77 from sjanc/enh_conn_complete
    
    nimble/ll: Fix peer address in LE Enhanced Connection Complete Event

commit 7316d8738a88ac6fa8334df6bc8e50ce3147f28c
Merge: b1736192 35e7a16c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri May 4 11:57:39 2018 +0200

    Merge pull request #75 from sjanc/zero_irk
    
    nimble/ll: Fix creating connections with all-zero IRK

commit abe1881ad859ae18d29499c01dde5aabadcd10ce
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed May 2 15:00:25 2018 +0200

    nimble/ll: Fix peer address in LE Enhanced Connection Complete Event
    
    If device is already on resolve list address type in LE (Extended)
    Connection Command need to be adjusted. Otherwise peer RPA won't be
    added to LE Enhanced Connection Complete Event. This has fatal results
    as eg. SMP is using OTA address for crypto calculations.

 nimble/controller/src/ble_ll_conn.c | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit b1736192751f422c37f94a1bcb25786adc62491f
Merge: 675dab96 1b5a8ca8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed May 2 12:05:25 2018 +0200

    Merge pull request #76 from michal-narajowski/ias-cb-fix
    
    nimble/host: Add check before calling a IAS event callback

commit 1b5a8ca8df2730d361850b0256a27eaf99fc5f31
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed May 2 11:39:01 2018 +0200

    nimble/host: Add check before calling a IAS event callback

 nimble/host/services/ias/src/ble_svc_ias.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 35e7a16c8c5697385bd86ef18d131c226e5ffa32
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 30 15:18:23 2018 +0200

    nimble/ll: Fix creating connections with all-zero IRK
    
    If peer was added using LE Add Device To Resolving List Command and
    provided peer IRK is all zeros we should stil accept connection with
    it's public (or static random) random even if in network privacy mode.
    
    This was affecting TP/CON/INI/BV-08-C qualification test case.

 nimble/controller/src/ble_ll_conn.c | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 675dab960fcd437d7093ebe91828e86fe7a6eaca
Merge: c3be6181 0e2ca39d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 30 15:26:24 2018 +0200

    Merge pull request #74 from andrzej-kaczmarek/phy-dbg-fix
    
    nimble/phy: Build fixes

commit 0e2ca39d2e38b2e2a4d784fdf4a6522a37e4ff1c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 30 13:23:54 2018 +0200

    nimble/phy: Fix debug pins build on nRF52832
    
    Need to adjust code for nRF52832 which does not have GPIO ports and
    NRF_RADIO->EVENT_RXREADY event.
    
    Also setup GPIO via registers to strip dependency from hal_gpio (for
    porting).

 nimble/drivers/nrf52/src/ble_phy.c | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)

commit e93f80529772f93476a3cb5f9533b0c9ccd06a86
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 30 13:19:39 2018 +0200

    nimble/phy: Use NRF52840_XXAA macro instead of syscfg
    
    We'll use NRF52840_XXAA macro (defined by nrfx) instead of BSP_NRF52840
    syscfg value for conditional compilation of nRF52840 code. This is to
    make porting a bit easier since NRF52840_XXAA symbol is always defined
    on nrfx builds which BSP_NRF52840 is Mynewt-specific.

 nimble/drivers/nrf52/src/ble_phy.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c3be6181c5dea9136d8007f377eebfbde86ce2fb
Merge: 706fd6d0 336dd31a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Apr 30 11:27:39 2018 +0200

    Merge pull request #17 from michal-narajowski/mesh-models
    
    Mesh models fixes

commit 336dd31ae679a05a3d432d2f252cb104ee271d0c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Apr 30 11:15:58 2018 +0200

    mesh: shell: Expose Input and Output OOB actions as MYNEWT_VALs

 nimble/host/mesh/src/shell.c |  8 ++++----
 nimble/host/mesh/syscfg.yml  | 32 ++++++++++++++++++++++++++++++++
 2 files changed, 36 insertions(+), 4 deletions(-)

commit 966e21bac02b2b10a0b446ce72eb0250179c4c60
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 28 11:18:58 2018 +0200

    mesh: Expose APIs used in a demo app

 nimble/host/mesh/include/mesh/cfg_srv.h |  1 +
 nimble/host/mesh/include/mesh/testing.h |  7 +++++++
 nimble/host/mesh/src/cfg_srv.c          |  4 ++--
 nimble/host/mesh/src/shell.c            |  2 +-
 nimble/host/mesh/src/testing.c          | 19 +++++++++++++++++++
 5 files changed, 30 insertions(+), 3 deletions(-)

commit f202ec8a07caae9630d428d3aaa4470ce5456c6e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Mar 23 17:11:42 2018 +0100

    mesh: Add Light Lightness model; remove dependency on PWMs
    
    This patch removes dependency on PWMs by exposing a simple
    API to replace default Server model callbacks with custom
    ones.
    
    Adding Light Lightness model allows us to control the LEDs from
    Silicon Labs' Mesh Android app. Unfortunately there is a bug
    in this app, because it binds AppKey to Generic Level Server
    and then uses Light Lightness messages to control the lightness,
    so we need to manually bind AppKey to Light Lightness Server
    to be able to process these messages. To do this type:
    `mod-app-bind <element-addr> <appkey-index> <model-id>`
    so in this case:
    `mod-app-bind 0x0001 0x0000 0x1300`
    
    After this step you should be able to control LED brightness from
    mobile app.
    
    Also when using Generic Level Set to change LED brightness you should now
    use 16-bit hex value, e.g.:
    `gen-level-set 0xffff` - 100% brightness
    `gen-level-set 0x0000` -   0% brightness

 nimble/host/mesh/{src => include/mesh}/model_cli.h |   0
 nimble/host/mesh/{src => include/mesh}/model_srv.h |  16 ++-
 nimble/host/mesh/src/access.c                      |   2 +-
 nimble/host/mesh/src/light_model.c                 | 132 ++-------------------
 nimble/host/mesh/src/light_model.h                 |  11 +-
 nimble/host/mesh/src/mesh_priv.h                   |   5 +-
 nimble/host/mesh/src/model_cli.c                   |   2 +-
 nimble/host/mesh/src/model_srv.c                   |  62 +++++++++-
 nimble/host/mesh/src/shell.c                       |  31 +++--
 nimble/host/mesh/syscfg.yml                        |   1 -
 10 files changed, 116 insertions(+), 146 deletions(-)

commit 30e7f467cac8931f6432feb9aeec4126b71f62dd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Mar 23 16:48:13 2018 +0100

    mesh: models: Fix printing status

 nimble/host/mesh/src/model_srv.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 5128be2393a7b913dcacc3eb20d2cb183b7b6f82
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Mar 23 16:47:56 2018 +0100

    mesh: shell: Conditionally compile cfg cli and health cli commands
    
    Allow to exclude Configuration Client and Health Client commands
    to reduce code size.

 nimble/host/mesh/src/shell.c | 260 +++++++++++++++++++++++--------------------
 1 file changed, 142 insertions(+), 118 deletions(-)

commit 42a0dfd398e9ae21e2e2c0d7dd30763f8b6cefda
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Mar 23 16:16:50 2018 +0100

    mesh: shell: Disable input actions and disable output string action
    
    Disable for convenience when using Mesh Android app.

 nimble/host/mesh/src/shell.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 706fd6d011054f173cc64531e2eb55c7b4fe2a96
Merge: 002365d5 852a09dc
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 30 08:18:34 2018 +0200

    Merge pull request #70 from sjanc/hd_adv_conn
    
    nimble/ll: Fix HCI events for high duty directed advertising

commit 002365d5bb6010612a6619ae7f51902d56d03179
Merge: 8913533a 446648aa
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 27 20:31:13 2018 +0200

    Merge pull request #71 from andrzej-kaczmarek/porting-prepare
    
    More fixes for non-Mynewt builds

commit 446648aa49f1a9f3cd19e654a4519db8fd36a878
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 27 18:17:34 2018 +0200

    nimble/host: Fix may be uninitialize warning
    
    Seems like spurious error, but according to GCC "duration_ticks" may be
    uninitialized if os_time_ms_to_ticks() is static inline...

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 740fe294857e341e33b9cf41c600911f97f4a444
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 27 17:00:19 2018 +0200

    nimble/ll: Create LL task only for Mynewt build
    
    NimBLE ported for other OS will require app to create task for LL
    manually. This is to avoid adding porting layer for task creation only
    to create single task.

 nimble/controller/src/ble_ll.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 5abc60660c9666802790de154e78ef4936f6168d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 27 13:46:26 2018 +0200

    nimble/ll: Remove explicit usage of OS_TICKS_PER_SEC
    
    Use os_time APIs instead to make porting easier.

 nimble/controller/include/controller/ble_ll_ctrl.h | 2 +-
 nimble/controller/src/ble_ll.c                     | 2 +-
 nimble/controller/src/ble_ll_conn_priv.h           | 3 +--
 nimble/controller/src/ble_ll_ctrl.c                | 2 +-
 nimble/controller/src/ble_ll_resolv.c              | 4 ++--
 5 files changed, 6 insertions(+), 7 deletions(-)

commit 51b4b7319931967cc746ff0becf84c6bca4035e8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 27 13:45:46 2018 +0200

    nimble/ll: Cleanup includes

 nimble/controller/include/controller/ble_ll.h      | 2 --
 nimble/controller/include/controller/ble_ll_conn.h | 1 -
 nimble/controller/src/ble_ll.c                     | 2 +-
 nimble/controller/src/ble_ll_adv.c                 | 1 -
 nimble/controller/src/ble_ll_conn.c                | 2 +-
 nimble/controller/src/ble_ll_conn_hci.c            | 1 -
 nimble/controller/src/ble_ll_scan.c                | 2 +-
 nimble/controller/src/ble_ll_sched.c               | 2 +-
 nimble/host/util/src/addr.c                        | 1 -
 9 files changed, 4 insertions(+), 10 deletions(-)

commit 8913533ab9b2c3358955f9c671304bdc9d2a8147
Merge: 3f0ea7c3 355b6f52
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 26 13:23:43 2018 +0200

    Merge pull request #69 from sjanc/test_build_fix
    
    nimble/host: Fix tests build

commit 852a09dc71cecd5be6e767a1d2ec753f5f1e52d3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 26 10:47:24 2018 +0200

    nimble/ll: Fix HCI events for high duty directed advertising
    
    When doing high duty directed advertising we should always send
    LE Connection Complete event if advertising was terminated due to
    timeout (either duration or events count). Additionaly if advertising
    was started with extended advertising HCI command we should send
    LE Advertising Set Terminated Event when it is terminated.

 nimble/controller/src/ble_ll_adv.c | 58 +++++++++++++++++++++++++-------------
 1 file changed, 38 insertions(+), 20 deletions(-)

commit 355b6f52b3eae229c2e7b79b912533276262e546
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 26 11:17:27 2018 +0200

    nimble/host: Fix tests build

 nimble/host/src/ble_hs_hci.c                |  5 ++---
 nimble/host/test/src/ble_gatt_disc_c_test.c |  8 ++++----
 nimble/host/test/src/ble_gatt_disc_d_test.c |  4 ++--
 nimble/host/test/src/ble_gatt_disc_s_test.c | 10 +++++-----
 nimble/host/test/src/ble_gatt_find_s_test.c |  2 +-
 nimble/host/test/src/ble_gatt_read_test.c   |  4 ++--
 nimble/host/test/src/ble_gatt_write_test.c  |  8 ++++----
 7 files changed, 20 insertions(+), 21 deletions(-)

commit 3f0ea7c3a510d7b1370e08a60eef96ab63737f70
Merge: bbcb9bfe a710df8e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 26 10:39:03 2018 +0200

    Merge pull request #68 from andrzej-kaczmarek/tiny-fix
    
    nimble/host: Remove log_init call

commit bbcb9bfe21badcc9b9d4487f4a9ace1399e048d5
Merge: 42d2266a 41e06a27
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 26 10:37:23 2018 +0200

    Merge pull request #61 from andrzej-kaczmarek/os-ticks-remove
    
    nimble/host: Change timeouts defs to ms instead of ticks

commit 42d2266ab953331be94324e5271915ce83fc1a0a
Merge: 713fc9fc 4f094510
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 26 09:21:17 2018 +0200

    Merge pull request #65 from sjanc/scan
    
    some minor scan cleanups

commit 713fc9fc5760ee2bb0c32918e74a7a93e9eb9c6d
Merge: f0ac6c0a 079155ce
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 26 09:20:21 2018 +0200

    Merge pull request #64 from sjanc/ext_adv
    
    nimble/ll: Fix not reporting Extended Advertising in LE features

commit f0ac6c0ae8097ec554bb458c4f57da1aff9f083b
Merge: 3b1eb3be a7587563
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 26 09:20:02 2018 +0200

    Merge pull request #60 from sjanc/ext_scan
    
    Fix data_status in BLE_GAP_EVENT_EXT_DISC

commit 3b1eb3be80b1875785a37b0a4f9692d776b7fb01
Merge: 2a614e49 94a12ba3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 25 23:34:33 2018 +0200

    Merge pull request #58 from davidzuhn/fix/bas-notify-correctly
    
    call ble_gatts_chr_updated() on battery level change

commit a710df8ed239fd619bbd3b603dcc7b86b76ee5d0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 25 16:25:45 2018 +0200

    nimble/host: Remove log_init call
    
    log_init() is already called by sysinit with prio 100, so before
    ble_hs_init() is called so this does not seem to be necessary here.

 nimble/host/src/ble_hs.c | 2 --
 1 file changed, 2 deletions(-)

commit 2a614e4907ca87c512c913c7c7df6372bf374fc6
Merge: 1f1657df 5baab6fa
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 25 16:14:49 2018 +0200

    Merge pull request #62 from andrzej-kaczmarek/includes-fix
    
    nimble/host: Some fixes for #includes

commit 1f1657df019bdf9b4a3fd5d3278a07b63eee5740
Merge: fb36cf4f 842b13eb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 25 15:49:55 2018 +0200

    Merge pull request #67 from rymanluk/fix_ext_scan
    
    nimble/ll: Fix for scanning ext advertising.

commit 842b13ebcb1384084b228a65a83ca5f27e58cf51
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 25 14:10:37 2018 +0200

    nimble/ll: Make sure aux_data is valid when sending ext adv report
    
    In ble_ll_hci_send_ext_adv_report() we have to have valid aux_data.
    Assert if it is not a case.

 nimble/controller/src/ble_ll_scan.c | 5 +++++
 1 file changed, 5 insertions(+)

commit e35d299b0ad30b0faf86fd4ba9c283e9f48b5e0d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 25 14:04:46 2018 +0200

    nimble/ll: Fix return from ble_ll_scan_start
    
    This patch makes sure that ble_ll_scan_start return 0 (OK) if scanning
    has been started or is ongoing.
    
    It solves problem with incorrect free on scansm->cur_aux data when
    ble_ll_scan_start return BLE_PHY_ERR_RX_LATE. In such a case radio was
    scanning on secondary channel but scan state machine was not prepared
    for it.

 nimble/controller/src/ble_ll_scan.c | 5 +++++
 1 file changed, 5 insertions(+)

commit fb36cf4f7df1af12b6f8f366e95d2fdd74099b2d
Merge: 1de96cd3 1f04c363
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 25 14:00:12 2018 +0200

    Merge pull request #66 from sjanc/adv_reset_fix
    
    nimble/ll: Fix mbuf leak in advertising on HCI Reset

commit 1f04c363cc0b767c3cd3b42db5e4f4afc780438c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 25 13:20:48 2018 +0200

    nimble/ll: Fix mbuf leak in advertising on HCI Reset
    
    If advertising data or scan response is set for advertising instance it
    must be free before re-initializing advertising state machine.

 nimble/controller/src/ble_ll_adv.c | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

commit 4f094510765c5e842518c64dc317613cf7604ad5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 19 16:00:06 2018 +0200

    nimble/ll: Validate reserved PHYs bits in ext scan parameters

 nimble/controller/src/ble_ll_scan.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit b1ccb62ff5af090537c5f9acd981fc8af4d22368
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 19 15:31:07 2018 +0200

    nimble/ll: Make scan state machine static
    
    Those are not used outside of ble_ll_scan.c file.

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit e70e791d97423c5e5ff3d48ed16584590178fe2f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 19 15:28:59 2018 +0200

    nimble/ll: Don't use global g_ble_ll_scan_sm if not needed
    
    We already have local pointer for this so use this for consistency.

 nimble/controller/src/ble_ll_scan.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 1de96cd3576e3abaa5a737bce25e71d51cfa2c8d
Merge: 4c5498fd 3b7f1650
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 25 08:54:10 2018 +0200

    Merge pull request #63 from sjanc/hci_evt_size
    
    nimble/transport: Adjust BLE_HCI_EVT_BUF_SIZE default for ext scan

commit 94a12ba316da35f56d7fe43fe1a9fd1ce9a289e9
Author: david zuhn <zoo@blueknobby.com>
Date:   Mon Apr 23 19:01:08 2018 -0500

    call ble_gatts_chr_updated() on battery level change
    
    This call doesn't require the connection handle, and thus doesn't
    need an additional setup call to pass in that value.  Remove the
    code that was intended to be called from on_connect.

 .../bas/include/services/bas/ble_svc_bas.h         |  5 ----
 nimble/host/services/bas/src/ble_svc_bas.c         | 29 +++-------------------
 2 files changed, 3 insertions(+), 31 deletions(-)

commit 079155ce3761281797b92f5c10611495e3f2bb74
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 24 16:42:18 2018 +0200

    nimble/ll: Fix not reporting Extended Advertising in LE features
    
    If Extended Advertising is enabled proper bit needs to be set in
    support features.
    
    < HCI Command: LE Read Local Supported Features (0x08|0x0003) plen 0
    > HCI Event: Command Complete (0x0e) plen 12
          LE Read Local Supported Features (0x08|0x0003) ncmd 1
            Status: Success (0x00)
            Features: 0xff 0x59 0x00 0x00 0x00 0x00 0x00 0x00
              LE Encryption
              Connection Parameter Request Procedure
              Extended Reject Indication
              Slave-initiated Features Exchange
              LE Ping
              LE Data Packet Length Extension
              LL Privacy
              Extended Scanner Filter Policies
              LE 2M PHY
              LE Coded PHY
              LE Extended Advertising
              Channel Selection Algorithm #2

 nimble/controller/src/ble_ll.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 3b7f16509e98690cd8469035390d91b5da857ab6
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 23 13:14:38 2018 +0200

    nimble/transport: Adjust BLE_HCI_EVT_BUF_SIZE default for ext scan
    
    When Extended Advertising is enabled use 257 bytes for
    BLE_HCI_EVT_BUF_SIZE to minimize HCI traffic when scanning. This also
    fix invalid value in emspi transport that was exceeding maximum HCI
     event value defined by spec.

 nimble/transport/emspi/syscfg.yml  | 2 +-
 nimble/transport/ram/syscfg.yml    | 3 +++
 nimble/transport/socket/syscfg.yml | 4 +++-
 nimble/transport/uart/syscfg.yml   | 4 +++-
 4 files changed, 10 insertions(+), 3 deletions(-)

commit 5baab6fa8f67345044d8e32702ceda47c868e002
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 24 14:09:03 2018 +0200

    nimble/host: Use bssnz_t only for Mynewt build

 nimble/host/src/ble_gap.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 449b8c3ece043e1ec39eea9c6f67d7a271866843
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 24 14:07:06 2018 +0200

    nimble/host: Add some missing includes
    
    Some of missing includes were implicitly added via other files and cause
    problems when porting on different platforms.

 nimble/host/services/bleuart/src/bleuart.c | 1 +
 nimble/host/src/ble_att_priv.h             | 1 +
 nimble/host/src/ble_att_svr.c              | 1 +
 nimble/host/src/ble_gatts.c                | 1 +
 4 files changed, 4 insertions(+)

commit 1b65445c854813c297e20e9052b226fd13ff2c5f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 27 15:34:53 2018 +0200

    nimble/host: Remove unused includes

 nimble/host/src/ble_gatts.c      | 1 -
 nimble/host/src/ble_hs.c         | 1 -
 nimble/host/src/ble_hs_dbg.c     | 1 -
 nimble/host/src/ble_hs_hci_cmd.c | 1 -
 nimble/host/src/ble_hs_hci_evt.c | 1 -
 nimble/host/src/ble_hs_misc.c    | 1 -
 nimble/host/src/ble_hs_priv.h    | 1 -
 nimble/host/src/ble_l2cap_coc.c  | 1 -
 nimble/host/src/ble_l2cap_sig.c  | 1 -
 nimble/host/src/ble_sm.c         | 1 -
 nimble/host/src/ble_sm_cmd.c     | 1 -
 nimble/host/src/ble_sm_lgcy.c    | 1 -
 12 files changed, 12 deletions(-)

commit 41e06a279a8b74d348546fead661d7dfbbfc76ab
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 24 12:03:03 2018 +0200

    nimble/host: Change timeouts defs to ms instead of ticks
    
    This is to make porting easier as we do not rely on OS_TICKS_PER_SEC.

 nimble/host/mesh/src/adv.c      |  2 +-
 nimble/host/mesh/src/glue.c     |  9 ++++++---
 nimble/host/src/ble_gap.c       | 12 +++++++-----
 nimble/host/src/ble_gatt_priv.h |  4 ----
 nimble/host/src/ble_gattc.c     |  8 +++++---
 nimble/host/src/ble_hs.c        |  6 ++++--
 nimble/host/src/ble_hs_hci.c    |  6 ++++--
 nimble/host/src/ble_sm.c        |  6 +++---
 8 files changed, 30 insertions(+), 23 deletions(-)

commit a7587563d8a1bac8e3404b7296217f1057bef84f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 24 10:58:51 2018 +0200

    nimble/host: Fix data_status in BLE_GAP_EVENT_EXT_DISC
    
    Since we decode this from HCI props host needs to have dedicated
    defines as those no longer match HCI properties mask.

 nimble/host/include/host/ble_gap.h |  5 +++++
 nimble/host/src/ble_hs_hci_evt.c   | 19 +++++++++++++++++--
 2 files changed, 22 insertions(+), 2 deletions(-)

commit 4c5498fda3a83cc70afcf1fc5f7cb3293c4405c1
Merge: 29e5dad7 060be7fb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 24 10:18:34 2018 +0200

    Merge pull request #57 from andrzej-kaczmarek/ext-scan-fix
    
    nimble/phy: Fix starting late RX

commit 29e5dad7942f5fbb72acdd279e1a589b1ff4f3b5
Merge: 637883a5 9ea4f8ab
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 24 10:00:34 2018 +0200

    Merge pull request #59 from andrzej-kaczmarek/ext-adv-evt-type-fix
    
    nimble/host: Fix parsing event type for ext adv reports

commit 9ea4f8ab68da44d6a9d92b99cbec9f4c26c01159
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 24 09:57:35 2018 +0200

    nimble/host: Fix parsing event type for ext adv reports

 nimble/host/src/ble_hs_hci_evt.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 060be7fb6d85cd3a3e444e456e21e8a589b5d65c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 20 14:10:45 2018 +0200

    nimble/phy: Fix PDU start time calculation
    
    Not sure why compiler did not catch uninitialized 'ticks' here, but we
    should adjust value read from 'phy_start_cputime' instead.

 nimble/drivers/nrf52/src/ble_phy.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 30459b28fae5ce2747a6a7af58edb6c9cd700cf2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 20 13:14:57 2018 +0200

    nimble/phy: Fix starting late RX
    
    Since c33701ae we can properly receive packets event if scanning was
    started on late RX. However, the problem is that radio is started
    manually there so phy_start_cputime is not correctly and, what's even
    worse, TIMER0 is not running thus we cannot properly calculate RX start
    time when PDU is received.
    
    This does not cause any major problem with legacy adveritising (we may
    just miss sending CONNECT_REQ or SCAN_REQ once) but if we schedule scan
    for AUX in extended advertising, the result of invalid calculations is
    stored in scheduler item. In particular, due to TIMER0 being stopped,
    our usecs reference time for EVENT_ADDRESS is 0 and calculation of an
    actual PDU start time wraps it around so the scan is scheduled far far
    in the future, which in turn quickly leads to exhaustion of mempool for
    auxscan items and we basically stop extended scanning (until any of
    incorrectly scheduled items executes).
    
    To fix this, on late RX we just setup RTC0 and TIMER0 to start as soon
    as possible taking limitations of both timer into account (see comments
    in code).

 nimble/drivers/nrf52/src/ble_phy.c | 68 +++++++++++++++++++++++++++++++-------
 1 file changed, 56 insertions(+), 12 deletions(-)

commit 637883a5121dd9df8fc6f6e53a78de8698e0a83f
Merge: 6c1e6906 77833c6c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 20 11:46:39 2018 +0200

    Merge pull request #54 from sjanc/adv_params
    
    nimble/ll: Fix advertising interval validation

commit 6c1e69067c1854a1c96a9df10dfc0cdb4dd0e4fb
Merge: b270fb6d 80201c8c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 19 16:12:46 2018 +0200

    Merge pull request #56 from andrzej-kaczmarek/ll-adv-rxadd-fix
    
    nimble/ll: Fix RxAdd in AUX_CONNECT_RSP

commit 80201c8c2008f41413b62d0ddbeb90957f375ec6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 19 15:41:46 2018 +0200

    nimble/ll: Fix RxAdd in AUX_CONNECT_RSP
    
    We put TxAdd bit instead of RxAdd bit so connections failed in case we
    used public address and remote used random address.

 nimble/controller/src/ble_ll_adv.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 77833c6ca929789055f717e9d4b4e5c120f52540
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 18 15:22:58 2018 +0200

    nimble/ll: Fix advertising interval validation
    
    For legacy advertising any interval between 0x0020 and 0x4000 is valid
    as long as min interval is not greater than max interval.
    
    For extended advertising any interval between 0x000020 and 0xffffff
    is valid as long as min interval is not greater than max interval.
    
    If intervals provided are outside of value allowed by specificication
    then Invalid Parmeters error is returned.
    
    If the advertising interval range provided by the Host is valid but
    outside the advertising interval range supported by the Controller,
    then the Controller shall return the Unsupported Feature or Parameter
    Value (0x11) error code. Since for now we support only intervals
    in legacy range we use this code in that case.
    
    This was affecting TP/DDI/BI-02-C qualification test case.

 nimble/controller/src/ble_ll_adv.c | 58 ++++++++++++++++++++------------------
 1 file changed, 31 insertions(+), 27 deletions(-)

commit b270fb6d35141826cfc87993fbf45c25f63658f2
Merge: 97813155 4120b113
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 19 01:00:28 2018 +0200

    Merge pull request #55 from andrzej-kaczmarek/build-fix
    
    nimble/host: Fix build with ext adv disabled

commit 4120b11310e5e8355098ce6be8df06958491d1a6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 19 00:58:58 2018 +0200

    nimble/host: Fix build with ext adv disabled

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 9781315518d83a2807563498137562647b2554bf
Merge: ccc9b80d a28837c4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 18 23:38:42 2018 +0200

    Merge pull request #51 from andrzej-kaczmarek/ext-adv-fix
    
    Multiple fixes to extended advertising

commit ccc9b80d8531f0b7536ddd301583f1bfbea44ab6
Merge: b043da7b 5e81bbf2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 18 13:31:59 2018 +0200

    Merge pull request #53 from rymanluk/fix_sched
    
    nimble/ll: Fix check for scheduled item.

commit 5e81bbf23b88808f5768cd2bfeb14ecb37530777
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 18 11:19:31 2018 +0200

    nimble/ll: Fix check for scheduled item.
    
    This patch makes sure check is correct when cputime just wrapped
    around.

 nimble/controller/src/ble_ll_sched.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b043da7b998d2102ce2a5c780f25a1a6cc9e7772
Merge: d378f3d0 d9f706a9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 18 13:27:27 2018 +0200

    Merge pull request #48 from sjanc/scan_tmo
    
    Support for duration and period in extended scan

commit d378f3d04f74051461ba8c334640ba239f79b18c
Merge: 49b0dd67 1a7e3d12
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 18 13:27:18 2018 +0200

    Merge pull request #52 from sjanc/scan_fix
    
    nimble/ll: Fix dereferencing NULL pointer in ble_ll_scan_rx_isr_end

commit 1a7e3d1204668b998e2224854db15e8cd2cd17dc
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 18 10:48:01 2018 +0200

    nimble/ll: Fix dereferencing NULL pointer in ble_ll_scan_rx_isr_end
    
    If we are out of buffers NULL rxpdu can be passed to this function.
    Dereference it only after checking if it is not NULL.

 nimble/controller/src/ble_ll_scan.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit a28837c45b68062e7f1d0618b3d07426bac8c282
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 16 10:30:43 2018 +0200

    nimble: Fix syscfg description
    
    We do support full extended advertising data range.

 nimble/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ccc94fc6b129ac8f4b078c472c5f94c020240d19
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Apr 15 22:04:34 2018 +0200

    nimble/host: Pass num completed ext adv events to app

 nimble/host/include/host/ble_gap.h | 8 ++++++++
 nimble/host/src/ble_gap.c          | 7 +++++--
 2 files changed, 13 insertions(+), 2 deletions(-)

commit a95fb1d558ba0c7fc50391f4cb7d8911506bb348
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 16 17:56:51 2018 +0200

    nimble/ll: Refactor advertising duration handling
    
    The advertising duration was not handled properly in some cases when
    extended advertising was used which resulted in very weird behaviour
    over the air (like bursts of events which did not follow interval) or
    simply exceeding requested duration.
    
    This fixes all known problems by ensuring that:
    - if 1st aux scheduled in chain does not fit within duration, we stop
      advertising immediately
    - if subsequent aux scheduled in chain does not fit within duration,
      we remove it from scheduler (data will be trimmed)
    - after aux chain is done, we check if next advertising fits within
      duration before scheduling (prior to this we checked if current
      aux did fit which does not make any sense)
    
    This means that we should be now compliant with requirement stated in
    Core 5.0, Vol 2, Part E, section 7.8.56:
        "The Controller should not start an extended advertising event
         that it cannot complete within the duration."
    
    However, there's one tricky part here: we do not know whether full
    extended advertising event can be sent within duration (i.e. with all
    host data) as chain is scheduled on-the-fly using available air time.
    For this reason we will just trim data if needed to complete extended
    advertising event in time, as described earlier.

 nimble/controller/src/ble_ll_adv.c | 97 +++++++++++++++++++++-----------------
 1 file changed, 55 insertions(+), 42 deletions(-)

commit b05ea72b7ad21cb5d63866234ff0fc3b73b758be
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 17 15:59:41 2018 +0200

    nimble/ll: Stop advertising properly after limit occured
    
    We should do full SM stop after duration of max events limit occured to
    make sure there is nothing left in scheduler or queues.

 nimble/controller/src/ble_ll_adv.c | 33 +++++++++++++++------------------
 1 file changed, 15 insertions(+), 18 deletions(-)

commit fdeea2ec889e794d6a336cb21bd7e59aeb1f6900
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 16 17:18:03 2018 +0200

    nimble/ll: Minor code cleanup

 nimble/controller/src/ble_ll_adv.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 4959a7d6b27ea1db750f0e1798f191cc0533f38e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 16 10:30:28 2018 +0200

    nimble/ll: Fix dropping ext advertising events
    
    When dropping an extended advertising event, we need to make sure that
    no event for secondary channels is in queue and mark aux as inactive.
    This was done event will properly reschedule next event from scratch
    and we won't have any loose events to handle.

 nimble/controller/src/ble_ll_adv.c | 3 +++
 1 file changed, 3 insertions(+)

commit 214df3e7ea30e046657611714e0fb7555c79e51b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Apr 15 22:30:45 2018 +0200

    nimble/ll: Fix scheduling for aux packets
    
    We already adjust start_time to include scheduler delay and there is no
    need to include it in end_time. Just make sure that we round ticks up
    when converting from usecs and we'll have enough time for txing aux.

 nimble/controller/src/ble_ll_adv.c | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit 11acb65828ab8676253a89a0c367c1c03aa4e954
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Apr 15 17:35:47 2018 +0200

    nimble/ll: Handle missing aux gracefully
    
    Since auxes are scheduled from LL task context it may happen sometimes
    that we won't have aux scheduled when trying to make ADV_EXT_IND PDU.
    In such case just set AuxPtr to 0 as this means data are truncated.

 nimble/controller/src/ble_ll_adv.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 1d7ce9dc149c586d206b3aca766f03ddf47ee62d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Apr 15 17:34:07 2018 +0200

    nimble/ll: Send number of events in case of advertising timeout
    
    We shall send number of advertising events in case max number of events
    was specified and timeout due to duration was reached. Since events
    counter is only increased if max number of events was specified, we do
    not need extra checks here.

 nimble/controller/src/ble_ll_adv.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 1ffdb89b049c8da5a5b448a65084edad6b152454
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Apr 15 17:28:57 2018 +0200

    nimble/ll: Remove redundant check
    
    There is no need to check for BLE_LL_ADV_SM_FLAG_ADV_TERMINATE_EVT in
    ble_ll_adv_sec_done() since this flag is always set for extended
    advertising and secondary channels are only active in case of extended
    advertising.

 nimble/controller/src/ble_ll_adv.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit d9f706a93a9c42b2dbf5d9aca9438354da05fa20
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 16 12:14:45 2018 +0200

    nimble/host: Add support for ext scan duration
    
    If only duration is set for extended scan host will be notified when
    scan is finished and GAP procedure should be terminated at this event.

 nimble/host/src/ble_gap.c        |  8 ++++++++
 nimble/host/src/ble_gap_priv.h   |  4 ++++
 nimble/host/src/ble_hs_hci_evt.c | 12 ++++++++++++
 3 files changed, 24 insertions(+)

commit d8c3ba85ad1e5b637ffe9ef1b924447d54b25b50
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 13 16:54:44 2018 +0200

    nimble/ll: Add support for duration and period in extended scan
    
    Handling of duration and period parameter in LE Set Extended Scan
    Enable Command was missing.
    
    This was affecting TP/DDI/SCN/BV-19-C qualification test case.

 nimble/controller/include/controller/ble_ll_ctrl.h |   1 +
 nimble/controller/include/controller/ble_ll_scan.h |   6 +-
 nimble/controller/src/ble_ll_hci_ev.c              |  22 ++++
 nimble/controller/src/ble_ll_scan.c                | 129 +++++++++++++++++++--
 nimble/include/nimble/hci_common.h                 |   3 +
 5 files changed, 151 insertions(+), 10 deletions(-)

commit 9ba3f72be3a7dd24d0df86567252b8e3de16ae0f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 13 14:37:24 2018 +0200

    nimble/ll: Don't build ext scan code if disabled
    
    Some pieces of extended scanner code were not under proper #ifdefs.

 nimble/controller/include/controller/ble_ll_scan.h |  4 +++-
 nimble/controller/src/ble_ll_conn.c                |  7 ++++---
 nimble/controller/src/ble_ll_scan.c                | 10 +++++++++-
 3 files changed, 16 insertions(+), 5 deletions(-)

commit ae78a91c64a9627a5bc55501032119c9b16c7306
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 17 10:47:26 2018 +0200

    nimble/ll: Fix LE Set Scan Enable settings when enabled
    
    If scanning is already enabled when enabling we just to update filter
    policy.

 nimble/controller/src/ble_ll_scan.c | 3 +++
 1 file changed, 3 insertions(+)

commit 9a790bc985427b32e03f67ae9c62b010a6974fd1
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 13 13:50:38 2018 +0200

    nimble/ll: Refactor ble_ll_scan_set_enable
    
    This is in preparation for adding duration/period support.
    Makes disable and already enabled a special case with early exit.

 nimble/controller/src/ble_ll_scan.c | 84 ++++++++++++++++++-------------------
 1 file changed, 42 insertions(+), 42 deletions(-)

commit 0d619e64376c300cb75feb078e9c1c4597736cd7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 13 11:47:17 2018 +0200

    nimble/ll: Remove leftover TODO comment

 nimble/controller/src/ble_ll_scan.c | 4 ----
 1 file changed, 4 deletions(-)

commit 49b0dd67d6d6282860011d0f4929b4fbd0b9853a
Merge: 021773f0 280b8dc3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 17 11:40:53 2018 +0200

    Merge pull request #49 from sjanc/scan_init
    
    nimble/ll: Fix scanner init on HCI Reset

commit 021773f070c74bbb152e2fdfc329b96bcbda8b69
Merge: 35bd3de5 0967e8a5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 16 22:44:52 2018 +0200

    Merge pull request #45 from rymanluk/fix_dir_addr_type
    
    nimble/ll: Fix for setting address type for directed advertising

commit 280b8dc3029e08a39ed435f39759ee5a0d4a00e4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 16 15:55:49 2018 +0200

    nimble/ll: Fix scanner init on HCI Reset
    
    mempool shouldn't be initialized on HCI Reset as it may affect other
    pools. Instead initialize it only on init and cleanup on HCI Reset.

 nimble/controller/src/ble_ll_scan.c | 94 ++++++++++++++++++++-----------------
 1 file changed, 52 insertions(+), 42 deletions(-)

commit 0967e8a5b1910fa7386dc5675f5a1bd67b160027
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 16 10:44:22 2018 +0200

    nimble/ll: Fix for setting address type for directed advertising

 nimble/controller/src/ble_ll_adv.c | 17 +++++++++++++----
 1 file changed, 13 insertions(+), 4 deletions(-)

commit 35bd3de5959ebe4af205ea793c88ece037458485
Merge: 42826d51 7276c35b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Apr 15 13:28:12 2018 +0200

    Merge pull request #43 from andrzej-kaczmarek/aux-assert-fix
    
    nimble/ll: Fix assertion when scheduling aux

commit 42826d51309db2aaa1fe6f50000ca19d6ab9cd12
Merge: d4fbd693 4f39f1b6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Apr 13 12:04:09 2018 +0200

    Merge pull request #40 from michal-narajowski/transport-static-alloc
    
    nimble/transport: Use static allocation for mempools

commit 7276c35bba2983c7a8046938cec58aef1cadeaad
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 12 22:12:12 2018 +0200

    nimble/ll: Fix misleading comment
    
    ...some leftovers from development phase

 nimble/controller/src/ble_ll_adv.c | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

commit 6bf447b129e0c3897ad661cd9c2b654d6b6a6205
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 12 22:04:30 2018 +0200

    nimble/ll: Fix assertion when scheduling aux
    
    Advertising events are scheduled from LL task and we always try to
    schedule two auxes one after another (for chaining). However, since this
    does not happen in critical section it can happen that we're interrupted
    after scheduling 1st aux, so when we try to schedule 2nd one there is no
    aux scheduled anymore which causes an assert.
    
    It it safe to just skip the scheduling in this case and thus handle this
    gracefully. The only drawback is that we possibly truncate aux chain,
    but this is harmless.

 nimble/controller/src/ble_ll_adv.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit d4fbd6938a4b33705e4bc1118acac2f8b8fa97a5
Merge: 22c5d3d4 c6fe6d8c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 12 16:07:12 2018 +0200

    Merge pull request #42 from sjanc/le_ping
    
    nimble/ll: Fix LE Ping with devices that don't support it

commit 22c5d3d4903b49bc48d1525196382a3ffcfd117e
Merge: 93817c9c 545acd72
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 12 16:06:36 2018 +0200

    Merge pull request #41 from sjanc/conn_complete_fix
    
    Connection complete fix

commit 545acd7273b5e3151d794f014455fbabedf1ad78
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 12 11:52:15 2018 +0200

    nimble/test: Fix LE Connection Complete tests
    
    In case of error status code all fields of that event are invalid and
    should be ignored by host.
    
    Also update connection failure unit test to simulate valid behaviour:
    LE Connection Complete event doesn't indicate connection failure but
    only attempt to create connection. Failure is reported afterwards
    with Disconnected Event with proper reson code.

 nimble/host/test/src/ble_gap_test.c         | 41 +++++++++++++++++++++++++----
 nimble/host/test/src/ble_hs_test_util_hci.c |  3 ++-
 2 files changed, 38 insertions(+), 6 deletions(-)

commit d2e781b0e083ef391dbb652f7472c97a0f3c0b99
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 12 11:48:55 2018 +0200

    nimble/gap: Fix accessing invalid field in LE Connection Complete event
    
    If status is error all other fields are invalid and connection role
    should be determined based on error code. This also adds sanity
    check if BLE_HS_DEBUG is enabled to verify if upper layers are
    correctly ignoring handle value in case of error.

 nimble/host/src/ble_hs_hci_evt.c | 54 +++++++++++++++++++++-------------------
 1 file changed, 28 insertions(+), 26 deletions(-)

commit d3f5e37174ce05e54bf6a8b08a84d20fe90043a9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 12 11:47:11 2018 +0200

    nimble/gap: Fix assert checking valid connection handle
    
    Valid connection handle value is 0x000-0x0eff.

 nimble/host/src/ble_gap.c          | 2 +-
 nimble/include/nimble/hci_common.h | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)

commit c6fe6d8c3795d546e15c21cf2dea886630202ec9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 12 15:45:00 2018 +0200

    nimble/ll: Fix LE Ping with devices that don't support it
    
    Core Specification 5.0 Vol. 6 Part D. 6.13 "LE PING":
    "Either Link Layer can authenticate the remote device using the LE Ping
    Procedure even if the remote device does not support the LE Ping
    feature."
    
    Both LE_PING_RSP and LL_UNKNOWN_RSP are valid reasponses for LE Ping
    procedure.
    
    This was affecting TP/SEC/MAS/BV-10-C qualification test case.

 nimble/controller/src/ble_ll_ctrl.c | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit 4f39f1b60d7c1f613ebe45b466ee716290f1f832
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Apr 11 16:34:35 2018 +0200

    nimble/transport: Use static allocation for mempools
    
    The size of buffers is known at compile time and failing
    to malloc buffer results in assert anyway, so we should use
    static buffers. This has the advantage of linker warning if
    RAM is exceeded.

 nimble/transport/emspi/src/ble_hci_emspi.c         | 132 +++++++++++--------
 .../ram/include/transport/ram/ble_hci_ram.h        |   2 +-
 nimble/transport/ram/pkg.yml                       |   2 +-
 nimble/transport/ram/src/ble_hci_ram.c             | 139 +++++++++------------
 nimble/transport/socket/src/ble_hci_socket.c       |  89 +++++++------
 nimble/transport/uart/src/ble_hci_uart.c           | 130 ++++++++++---------
 6 files changed, 257 insertions(+), 237 deletions(-)

commit 93817c9cbcd6059ea8b1938b9a58e4c038354c5d
Merge: 4d906549 cedc0363
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 11 14:27:27 2018 +0200

    Merge pull request #39 from sjanc/fixes
    
    Fixes for connection creation events handling

commit cedc03631f6ad4f473c8ad8e5cce2b9a40e7a4b8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 11 11:35:57 2018 +0200

    nimble/host: Fix LE Connection Complete Event handling
    
    If status is non-zero all other fields of event are invalid and should
    not be referenced by host. Also specification defines only two valid
    error codes: BLE_ERR_DIR_ADV_TMO (high-duty directed advertising
    terminated due to timeout) or BLE_ERR_UNK_CONN_ID (outgoing connection
    creation was cancelled by host). Based on those host can determine
    which ongoing procedure is affected based solely on error code.

 nimble/host/src/ble_gap.c | 72 ++++++++++++++++++++---------------------------
 1 file changed, 31 insertions(+), 41 deletions(-)

commit 11e7d0c46b596298eeee1bdb8e464b89e7fc9024
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 10 14:13:10 2018 +0200

    nimble/ll: Fix LE Connection Complete Event when canceling
    
    This commit fix two issue related to LE Connection Complete Event
    when canceling ongoing connection creation with LE Create Connection
    Cancel Command:
     - LE Connection Complete Event should be sent after Command Complete
       for LE Create Connection Cancel
     - On failure, only Status parameter is valid for LE Connection
       Complete Event (Vol 2 Part E section 4.5) so zero remaining parameters
    
    Same applies to LE Enhanced Connection Complete event.

 nimble/controller/src/ble_ll_conn.c      | 24 +++++++++---------------
 nimble/controller/src/ble_ll_conn_hci.c  | 24 ++++++++++++++++++++++--
 nimble/controller/src/ble_ll_conn_priv.h |  5 ++++-
 nimble/controller/src/ble_ll_hci.c       | 13 ++++++++++---
 4 files changed, 45 insertions(+), 21 deletions(-)

commit 7d753fc0fa776f8eb3ea34448c2b6dac9a40b4d7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 10 10:45:12 2018 +0200

    nimble/ll: Fix HCI events order on slave connection
    
    If a connection is created and the Controller supports the LE Channel
    Selection Algorithm #2 feature, this event shall be immediately
    followed by an LE Channel Selection Algorithm Event.

 nimble/controller/src/ble_ll_adv.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 4d906549da2a3183f9ffd134a40e1338cd7df454
Merge: 8992eaab a0180206
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 10 13:35:06 2018 +0200

    Merge pull request #28 from michal-narajowski/mesh_cli
    
    mesh: Fix possible race condition and other issues

commit a0180206dfb4353652e022520a9fe764a3049a4b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 3 13:42:54 2018 +0200

    mesh: testing: Fix check if subnet is allocated

 nimble/host/mesh/src/testing.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 31663a042acd02e8d0ec93f01702e9feada9b22c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 10 12:22:38 2018 +0200

    mesh: Fix Node Identity advertising with PB-ADV
    
    The Node Identity advertising should only be automatically enabled
    when provisioning happened over PB-GATT, but not when it happened over
    PB-ADV. Move the enabling of Node Identity to the provisioning code,
    where we know the bearer that was used (this information does not get
    passed to the bt_mesh_provision function).

 nimble/host/mesh/src/net.c  | 3 +--
 nimble/host/mesh/src/prov.c | 7 +++++++
 2 files changed, 8 insertions(+), 2 deletions(-)

commit 33142fe7f699caa54ab79c0eb8d3399f2b506c94
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 10 12:17:31 2018 +0200

    mesh: Fix possible NULL dereferences in client models
    
    There's a small but real chance of a race-condition when sending
    messages to the local node (through the local network interface) that
    expected parameters will be NULL in the message handles. Add
    appropriate NULL checks for them.

 nimble/host/mesh/src/cfg_cli.c    | 12 +++++++++---
 nimble/host/mesh/src/health_cli.c |  4 +++-
 2 files changed, 12 insertions(+), 4 deletions(-)

commit 0f7a7ccffce97eac0a5ea857f06983caee5cc542
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 10 12:10:09 2018 +0200

    mesh: cfg_cli: Fix possible race condition
    
    If the thread that sends the configuration messages has low priority
    and is sending to the local node (a common use case currently) it's
    possible that the response arrives before the cli->op_* state
    variables are set, resulting in the message never getting properly
    processed and the client API call timing out.
    
    Split the initialization into a separete cli_prepare() call and add a
    cli_reset() to clean up the variables in case of premature completion
    of the client operation (e.g. due to message sending failure).

 nimble/host/mesh/src/cfg_cli.c    | 110 ++++++++++++++++++++++++--------------
 nimble/host/mesh/src/health_cli.c |  58 ++++++++++++--------
 2 files changed, 108 insertions(+), 60 deletions(-)

commit f9e291cc87aa7a84bbc01d5f2e9ecad703e79977
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 10 11:51:48 2018 +0200

    mesh: cfg_cli: Fix trying to write a NULL pointer
    
    It's not always guaranteed that param->status will be non-NULL,
    especially not after a subsequent patch to fix a race condition with
    the response waiting.

 nimble/host/mesh/src/cfg_cli.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 8992eaabc335cf1de991804dddb77681bc4f41ba
Merge: 7bbfe228 e387c7d8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 10 11:56:26 2018 +0200

    Merge pull request #35 from davidzuhn/cleanup/normalize-permissions
    
    remove execute permissions

commit 7bbfe228acd05324d41c19ecc4bb627889e0e96b
Merge: af34d359 0288d084
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 10 11:55:57 2018 +0200

    Merge pull request #36 from samveen/small_fixes
    
    Remove misleading comments

commit af34d359608f1959e8b32ef5c854b9c9073ae36e
Merge: 6870ae3f 81d8b88c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 10 10:39:09 2018 +0200

    Merge pull request #20 from andrzej-kaczmarek/mesh-fix
    
    nimble/mesh: Fix BLE_MESH_PB_GATT syscfg description

commit 0288d084cf0646c3983dc39f8ebafcd4a41a8e50
Author: Samveen <samveen@samveen.in>
Date:   Tue Apr 10 11:57:12 2018 +0700

    Remove misleading comments

 nimble/host/services/ans/src/ble_svc_ans.c | 2 --
 nimble/host/services/bas/src/ble_svc_bas.c | 2 --
 2 files changed, 4 deletions(-)

commit e387c7d8cecd843f6111bc585f36eb8dee84b99f
Author: david zuhn <zoo@blueknobby.com>
Date:   Mon Apr 9 20:21:06 2018 -0500

    remove execute permissions

 nimble/transport/socket/src/ble_hci_socket.c | 0
 nimble/transport/uart/src/ble_hci_uart.c     | 0
 2 files changed, 0 insertions(+), 0 deletions(-)

commit 6870ae3fe59b22e20edc9cb951899d66f115a417
Merge: d389ee32 6e4dc472
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Mon Apr 9 16:52:32 2018 -0700

    Merge pull request #34 from samveen/small_fix
    
    Correct spelling in comment

commit d389ee32da15885834d41fb5d2b44c35de62315b
Merge: 47b9b52e 683aba42
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Mon Apr 9 16:52:19 2018 -0700

    Merge pull request #29 from davidzuhn/bugfix/typo-correction
    
    fix spelling errors

commit 683aba429f19f19048e6db44770f320259848539
Author: david zuhn <zoo@blueknobby.com>
Date:   Mon Apr 9 17:16:08 2018 -0500

    fix spelling error

 nimble/host/services/ias/pkg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6e4dc472b69d4fc82e5d1bfac05b1e06cfd457cd
Author: Samveen <samveen@samveen.in>
Date:   Mon Apr 9 22:25:31 2018 +0700

    correct spelling in comment

 nimble/host/services/ans/include/services/ans/ble_svc_ans.h | 4 ++--
 nimble/host/services/bas/include/services/bas/ble_svc_bas.h | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 47b9b52e623f34effc0c2c443870c66e81d22e4b
Merge: 4deb018a 23c50c05
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 9 14:10:29 2018 +0200

    Merge pull request #33 from andrzej-kaczmarek/nimble-phy-errata
    
    nimble/phy: Allow to selectively enable workaround for nRF52840

commit 23c50c0506d48d1e443a7211a7b8010f7e61ddae
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 9 13:51:57 2018 +0200

    nimble/phy: Allow to selectively enable workaround for nRF52840
    
    There are known anomalies in nRF52840 engineering and final revisions
    which, according to Nordic DevZone, should be only applied to chip
    version affected. For this reason We need to allow workarounds for #164
    and #191 to be enabled selectively.
    
    Default configuration applies to nRF52840 Rev 1 (final silicon) and
    Engineering B and C.
    
    When building for nRF52840 Engineering A (found on early versions on
    nRF52840 PDK) configuration should be changed.

 nimble/drivers/nrf52/src/ble_phy.c |  8 ++++++++
 nimble/drivers/nrf52/syscfg.yml    | 18 ++++++++++++++++++
 2 files changed, 26 insertions(+)

commit 4deb018a6a12bde01514c0da2938558031cdf8e2
Merge: ecfa4334 6743c473
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 12:11:32 2018 +0200

    Merge pull request #32 from sjanc/ctrl_fix
    
    nimble/ll: Fix typo

commit 6743c4734a743b735844929ef14bee7f4b9dafee
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 12:10:20 2018 +0200

    nimble/ll: Fix typo

 nimble/controller/src/ble_ll.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ecfa43345ca3077f3868bd17e87827fa476967a4
Merge: 30782c4e 6db10199
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 12:09:32 2018 +0200

    Merge pull request #31 from sjanc/ctrl_fix
    
    nimble/ll: Fix build without extended advertising

commit 6db101991f5e9f0350a958050b8bdc82ba776d48
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 12:07:24 2018 +0200

    nimble/ll: Fix build without extended advertising

 nimble/controller/src/ble_ll.c | 2 ++
 1 file changed, 2 insertions(+)

commit 30782c4edc0891f332e70d8443468f49afd1202d
Merge: 14a9f9f6 0814d7ce
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 12:02:46 2018 +0200

    Merge pull request #30 from sjanc/ctrl_fix
    
    nimble/ll: Fix build with disabled extended advertising

commit 0814d7cec2e9f9dc7ff6d3060189fabbeeac9398
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 11:58:45 2018 +0200

    nimble/ll: Fix build with disabled extended advertising

 nimble/controller/src/ble_ll_hci.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 14a9f9f6b128c8f0eeece74f824554720067facc
Merge: 639f6d1e 7e857433
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 9 10:03:32 2018 +0200

    Merge pull request #21 from rymanluk/ll_scan_fix
    
    nimble/ll: Fix scanning handle for directed advertising

commit 639f6d1eff9d7a400dedfa134128441ef21a4c15
Merge: ee55b4d5 703f545b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 10:02:03 2018 +0200

    Merge pull request #22 from andrzej-kaczmarek/nrf52-phy-fixes
    
    nimble/phy: Updates to nRF52 PHY (including errata #191)

commit ee55b4d5cde484ee8cc2f49ce993ff4207d6b489
Merge: 0d4712e6 57f71145
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 10:00:47 2018 +0200

    Merge pull request #19 from andrzej-kaczmarek/nrf52-rx-rampup-fix
    
    nimble/phy: Allow idle state when starting RX

commit 0d4712e6f2abbd75b11abefce38cb59d0101d606
Merge: 7e9ccfea fa0c8c05
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 9 09:52:26 2018 +0200

    Merge pull request #26 from sjanc/hci_q
    
    nimble/ll: HCI fixes

commit 3e64fbdd02c8fda89db0bc14b4d5bb9e3ef87d0f
Author: david zuhn <zoo@blueknobby.com>
Date:   Sun Apr 8 18:02:49 2018 -0500

    fix spelling errors

 nimble/host/services/ans/src/ble_svc_ans.c | 2 +-
 nimble/host/services/bas/src/ble_svc_bas.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit fa0c8c057737610d12e74b50f9d1b6f803ea9657
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 6 15:35:41 2018 +0200

    nimble/ll: Fix check if advertising is enabled
    
    Check all advertising instances when determining if advertising is
    enabled.

 nimble/controller/src/ble_ll_adv.c | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

commit f6609e09d9e9402006fb7c5075d0367dd714bdb9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 3 14:59:52 2018 +0200

    nimble/ll: Fix setting random address when forbidden
    
    From Core Specification 5.0 Vol2 Part E 7.8.4:
    
    "If the Host issues this command (LE Set Random Address Command )when
    scanning or legacy advertising is enabled, the Controller shall return
    the error code Command Disallowed (0x0C)."
    
    "If Extended Advertising is in use, this command only affects the
    address used for scanning and initiating. The addresses used for
    advertising are set by the LE_Set_Advertising_Set_Random_Address
    command."
    
    Test Specification (LL/CON/INI/BV-01-C) also extendeds above check
    with initiating state.

 nimble/controller/include/controller/ble_ll.h |  2 +-
 nimble/controller/src/ble_ll.c                | 30 ++++++++++++++++++++-------
 nimble/controller/src/ble_ll_hci.c            |  9 +-------
 3 files changed, 25 insertions(+), 16 deletions(-)

commit 87cc155372345fc8e2fb70ca4ba30465c34e5573
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 16 16:04:58 2018 +0100

    nimble/ll: Fix for not mixing Legacy and Extended Advertising HCI commands
    
    As per Core Specification 5.0 Vol.2 Part E 3.1.1 "Legacy and Extended
    Advertising":
    
    If, since the last power-on or reset, the Host has ever issued a legacy
    advertising command and then issues an extended advertising command, or
    has ever issued an extended advertising command and then issues a legacy
    advertising command, the Controller shall return the error code Command
    Disallowed (0x0C).

 nimble/controller/src/ble_ll_hci.c | 63 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 63 insertions(+)

commit 7e9ccfeafd791ff3c6c94003e2477d01d0cf880c
Merge: eb3ccb39 6adc6d61
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 4 09:42:42 2018 +0200

    Merge pull request #12 from sdalu/dis
    
    ble service: Device Information Service

commit eb3ccb39b668433279cc5e55f2e9cd22f543927f
Merge: b8dd9f77 b6a8fffa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 3 15:57:14 2018 +0200

    Merge pull request #23 from rymanluk/ll_set_resolv_fix
    
    nimble/ll: Fix HCI Set Resolving Timeout

commit b6a8fffa4bfed08bc3a5e288ce81f72d3d52e436
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 29 15:32:07 2018 +0200

    nimble/ll: Fix HCI Set Resolving Timeout
    
    With this patch, controller will accept resolving timeout even resolving
    is not yet enabled.
    
    Need it for LL testing

 nimble/controller/src/ble_ll_resolv.c | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)

commit 6adc6d61723f011e86be7339595acc02457078c8
Author: Stephane D'Alu <sdalu@sdalu.com>
Date:   Wed Mar 21 17:40:15 2018 +0100

    implementation of the Device Information Service

 .../dis/include/services/dis/ble_svc_dis.h         | 105 ++++++++
 nimble/host/services/dis/pkg.yml                   |  34 +++
 nimble/host/services/dis/src/ble_svc_dis.c         | 296 +++++++++++++++++++++
 nimble/host/services/dis/syscfg.yml                |  96 +++++++
 4 files changed, 531 insertions(+)

commit 703f545bde90c0866ae433aa08023cb1ff0d54c7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 14:41:00 2018 +0200

    nimble/phy: Do not configure radio if not needed
    
    We do not need to configure radio if not changing phy_mode.

 nimble/drivers/nrf52/src/ble_phy.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 168365fc863a768eab516550c0b97cf1d609704b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 14:03:56 2018 +0200

    nimble/phy: Add errata #191 for nRF52840
    
    This applies to engineering revisions B and C and revision 1.

 nimble/drivers/nrf52/src/ble_phy.c | 18 +++++++++++++++---
 1 file changed, 15 insertions(+), 3 deletions(-)

commit 3f77f38934e268c6288af59316ac8c780b2b0268
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 13:59:58 2018 +0200

    nimble/phy: Optimize applying nRF52840 workaround
    
    Workaround for nRF52840 only applies to LE Coded PHY and does not need
    to be applied on every mode change - only if we are switching between
    Coded and non-Coded PHY.

 nimble/drivers/nrf52/src/ble_phy.c | 38 +++++++++++++++++++++++++++++++-------
 1 file changed, 31 insertions(+), 7 deletions(-)

commit 856e196ac0216539e74d65b2f1e77506836c7188
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 13:57:36 2018 +0200

    nimble/phy: Fix parameters for ble_phy_mode_set
    
    'new_phy_mode' makes more sense than 'cur_phy_mode'.
    Also use proper types for parameters and remove redundant cast.

 nimble/controller/include/controller/ble_phy.h |  2 +-
 nimble/drivers/nrf52/src/ble_phy.c             | 12 ++++++------
 2 files changed, 7 insertions(+), 7 deletions(-)

commit dc058e870b5039a368a1f5e844b6f715abc3bf5b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 13:56:19 2018 +0200

    nimble/phy: Optimize phy configuration
    
    Use switch instead of series of if-else - we'll just have simple jump
    instead or multiple branches.

 nimble/drivers/nrf52/src/ble_phy.c | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit 7e857433be8198f904ca9cc3e5ba73f30c70a3e7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 29 13:31:27 2018 +0200

    nimble/ll: Fix scanning handle for directed advertising
    
    So far Nimble did not sent advertising reports to host for directed
    advertising events if RPA was not used. This is fixed with this patch.
    If RPA is used in advertising report then LE Directed Advertising Report
    Event  is sent to the host, otherwise LE Advertising Report Event.

 nimble/controller/src/ble_ll_scan.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit b8dd9f778ad4c9742bcf2607833f68a71af0306c
Merge: cfca89ae 886f4aac
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 29 13:52:55 2018 +0200

    Merge pull request #18 from rymanluk/ll_fixes
    
    nimble/ll: Portion of fixes for the nimble controller.

commit 81d8b88ce9f4796d8a64a61e6d7af9664dbb8406
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 13:10:57 2018 +0200

    nimble/mesh: Fix BLE_MESH_PB_GATT syscfg description

 nimble/host/mesh/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 886f4aacfc34dbc5580cc589ef0f4ee31a545e03
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 28 15:16:40 2018 +0200

    nimble/ll: Fix command complete on HCI set extended adv parameters
    
    Make sure command complete has selected TX power in it.

 nimble/controller/src/ble_ll_adv.c | 62 ++++++++++++++++++++++++++------------
 1 file changed, 42 insertions(+), 20 deletions(-)

commit bcb3c899aa39b83ceaf990ce26f2e43eab47d7dd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 28 10:50:25 2018 +0200

    nimble/ll: Fix command complete for connection parameter request reply
    
    Make sure connection handle is in the command complete event

 nimble/controller/src/ble_ll_conn_hci.c  | 17 +++++++++++------
 nimble/controller/src/ble_ll_conn_priv.h |  3 ++-
 nimble/controller/src/ble_ll_hci.c       |  4 ++--
 3 files changed, 15 insertions(+), 9 deletions(-)

commit 134f6f48da2ea07995e8acb76c28a4e987b51f4d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Mar 19 14:46:18 2018 +0100

    nimble/ll: Remove reduntant #define

 nimble/controller/include/controller/ble_ll_conn.h | 1 -
 1 file changed, 1 deletion(-)

commit 7a5293beecfe10f2c6d8a917b1d0559bfdaa2389
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Mar 19 10:44:38 2018 +0100

    nimble/ll: Fix for sending HCI Advertising Terminate event
    
    With this patch Controller will send HCI Advertising Terminate event
    only when BT5.0 commands has been used to start advertising

 nimble/controller/src/ble_ll_adv.c | 20 ++++++++++++++------
 1 file changed, 14 insertions(+), 6 deletions(-)

commit 7595ba8551c9291a57b8d65cf80b1f3d913cac63
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 14 15:50:24 2018 +0100

    nimble/ll: Fix start point for supervision timeout
    
    We should count supervision timeout from the end of last reveived packet
    and not the beginning.

 nimble/controller/src/ble_ll_conn.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 2cccbba7a9e563e0089777c31887286841516734
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 14 09:23:51 2018 +0100

    nimble/ll: Fix for LE connection parameter request
    
    If host mask out HCI Remote Connection Parameters Request event, LL
    shall reject LL Connection Parameter request

 nimble/controller/src/ble_ll_ctrl.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 397a78335c759a8ecc9efdbfa655514b8b692ae7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 13 11:25:05 2018 +0100

    nimble/ll: Fix for HCI Set Data Length
    
    With this patch LL will start Data Length Procedure on HCI Set Data
    Length command

 nimble/controller/include/controller/ble_ll_ctrl.h |  1 +
 nimble/controller/src/ble_ll_conn_hci.c            | 35 ++++++++++++----------
 nimble/controller/src/ble_ll_ctrl.c                |  2 +-
 3 files changed, 21 insertions(+), 17 deletions(-)

commit 57f71145490d36e72ff1550d687b1cc438752719
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 29 10:19:28 2018 +0200

    nimble/phy: Allow idle state when starting RX
    
    nRF52 radio can ramp-up from idle state so it can be either disabled or
    idle (for whatever reason - it happens sometimes) when starting RX.
    Similar problem was already fixed on nRF51 by forcing radio disable
    since that radio can ramp-up only from disabled state.

 nimble/drivers/nrf52/src/ble_phy.c | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit cfca89ae7d627112eab50eb941a56707589884e4
Merge: a5b70535 3cffcd1b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Mar 28 13:43:44 2018 +0200

    Merge pull request #16 from sjanc/init
    
    Detect controller version on init

commit a5b7053591ac8d55df8e29297f6305936e9e6cc3
Merge: b3d689be 726384ea
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Mar 28 11:19:51 2018 +0200

    Merge pull request #9 from andrzej-kaczmarek/adv-halt-fix
    
    nimble/ll: Do not use sec_txdone for legacy adv

commit 3cffcd1b63d05482b851305ab469c6e400cfc09b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Mar 26 12:45:50 2018 +0200

    nimble/host: Check if controller supports LE on init
    
    NimBLE requires LE support in controller. This allows for early
    error in case one tries to run NimBLE host with BR/EDR only controller
    eg on Linux.

 nimble/host/src/ble_hs_hci_priv.h           |   3 +-
 nimble/host/src/ble_hs_hci_util.c           |   6 --
 nimble/host/src/ble_hs_startup.c            |  41 +++++++-
 nimble/host/test/src/ble_hs_pvcy_test.c     |   2 +-
 nimble/host/test/src/ble_hs_test_util_hci.c | 149 +++++++++++++++-------------
 nimble/host/test/src/ble_hs_test_util_hci.h |   7 +-
 6 files changed, 129 insertions(+), 79 deletions(-)

commit c488b9d63553c0290994be390b964efbec619894
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Mar 26 12:44:47 2018 +0200

    nimble/host: Check controller version on init
    
    This allows to run NimBLE host with non-NimBLE controllers.

 nimble/host/src/ble_hs_startup.c | 59 ++++++++++++++++++++++++++++++++--------
 1 file changed, 47 insertions(+), 12 deletions(-)

commit dc497d8a00f25309196c2c92bd95ceb2d9cecd4a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Mar 26 12:40:17 2018 +0200

    nimble/host: Cleanup defines names for HCI commands

 nimble/host/src/ble_hs_startup.c   |  8 ++++----
 nimble/include/nimble/hci_common.h | 12 ++++++++----
 2 files changed, 12 insertions(+), 8 deletions(-)

commit b3d689beb2d091f3d380c83ce8f2ebe8e20fe48b
Merge: e0c0c9c5 3c890e8e
Author: Sterling Hughes <sterlinghughes@users.noreply.github.com>
Date:   Fri Mar 23 08:53:59 2018 -0700

    Merge pull request #13 from sdalu/bas
    
    ble service: Battery Service

commit e0c0c9c590ce3fb7b9a3c83054ca519aef1a034c
Merge: 758de7ab 735f4d1c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 23 14:00:24 2018 +0100

    Merge pull request #7 from rymanluk/mesh_sim_fix
    
    nimble/mesh: Fix segmentation fault when running on simulator

commit 3c890e8ef819724c6c459aa4aadb2328c1d872ed
Author: Stephane D'Alu <sdalu@sdalu.com>
Date:   Wed Mar 21 17:44:57 2018 +0100

    implementation of the Battery Service

 .../bas/include/services/bas/ble_svc_bas.h         |  36 +++++
 nimble/host/services/bas/pkg.yml                   |  34 +++++
 nimble/host/services/bas/src/ble_svc_bas.c         | 152 +++++++++++++++++++++
 nimble/host/services/bas/syscfg.yml                |  30 ++++
 4 files changed, 252 insertions(+)

commit 758de7ab8c25567da078e60adc0f7ab315ab05bf
Merge: 223b0d47 60d1cd70
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 21 15:01:30 2018 +0100

    Merge pull request #11 from michal-narajowski/mesh-onoff-level-models
    
    mesh: Add example implementation of generic onoff and level models

commit 60d1cd702ec094cc654b63eab58821421cc75a77
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:19:29 2018 +0100

    mesh: Add example implementation of generic onoff and level models
    
    This patch adds simple implementation of these two models
    with support for both client and server. There is also an example
    light model that simulates a light bulb and controls 4 LEDs through
    4 PWMs.
    
    To use these features set BLE_MESH_SHELL_MODELS: 1 and you should
    enable pwm0, pwm1, pwm2 and pwm3 devices. On nrf52840 you should
    specify PWM_0: 1, PWM_1: 1, PWM_2: 1, PWM_3: 1, to achieve this.
    
    Here are the commands used to control the server from client (mesh-shell
    will communicate through local interface by default):
    
    `init` - to initialize mesh
    `provision 0 0x0001` - provision mesh with fixed keys, 0x0001 is a unicast address
    of a node
    `app-key-add 0 0 0` - add app key with netkey_idx=0 appkey_idx=0 and value=0
    `mod-app-bind 0x0001 0x0000 0x1000` - bind appkey with generic onoff server model
    `mod-app-bind 0x0001 0x0000 0x1001` - bind appkey with generic onoff client model
    `mod-app-bind 0x0001 0x0000 0x1002` - bind appkey with generic level server model
    `mod-app-bind 0x0001 0x0000 0x1003` - bind appkey with generic level client
    model
    `gen-level-set 50` - set diode lightness to 50%
    `gen-level-get` - get state of level model
    `gen-onoff-set 0` - set state of onoff model to off
    `gen-onoff-get` - get state of onoff model

 nimble/host/mesh/include/mesh/glue.h |   1 +
 nimble/host/mesh/src/access.c        |   7 +
 nimble/host/mesh/src/light_model.c   | 174 ++++++++++++++++++++++
 nimble/host/mesh/src/light_model.h   |  26 ++++
 nimble/host/mesh/src/mesh_priv.h     |  13 ++
 nimble/host/mesh/src/model_cli.c     | 274 +++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/model_cli.h     |  43 ++++++
 nimble/host/mesh/src/model_srv.c     | 136 +++++++++++++++++
 nimble/host/mesh/src/model_srv.h     |  34 +++++
 nimble/host/mesh/src/shell.c         | 186 +++++++++++++++++++++++-
 nimble/host/mesh/syscfg.yml          |   6 +
 11 files changed, 895 insertions(+), 5 deletions(-)

commit 735f4d1c6d6a8ffab0dbb4cde2b3ed9f577ebe9c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 15 15:23:05 2018 +0100

    nimble/mesh: Fix native build
    
    This patch adds code needed to run Mesh app on simulator.

 nimble/host/mesh/src/shell.c | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

commit 19d11510e4cbdd5c55d55c984b516559c9072475
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 15 13:16:03 2018 +0100

    nimble/mesh: Fix simulator segmentation fault on mesh init
    
    When MESH_PB_GATT is enabled, link.rx_buf is taken from proxy module.
    This patch makes sure rx_buf is used when proxy module is initialized.

 nimble/host/mesh/src/mesh.c | 13 ++++++++-----
 nimble/host/mesh/src/prov.c |  5 +----
 2 files changed, 9 insertions(+), 9 deletions(-)

commit 223b0d471fc6bd9a6916179f3d9dc3243345f89a
Merge: ba00bae6 2e3897f8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 21 10:19:56 2018 +0100

    Merge pull request #10 from michal-narajowski/mesh-mbuf-leak-fix
    
    mesh: Fix os_mbuf leak in cfg client and health client

commit 2e3897f8019fdcbd00832d7670ed4545a4fe7937
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 20 16:22:24 2018 +0100

    mesh: Fix os_mbuf leak in cfg client and health client

 nimble/host/mesh/src/cfg_cli.c    | 188 ++++++++++++++++++++++++--------------
 nimble/host/mesh/src/health_cli.c |  71 +++++++++-----
 2 files changed, 164 insertions(+), 95 deletions(-)

commit 726384ea97a49ddb1c67e8856206c3eb7540d219
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Mar 19 11:46:00 2018 +0100

    nimble/ll: Do not use sec_txdone for legacy adv

 nimble/controller/src/ble_ll_adv.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit ba00bae647107ca601afb4e478ed64b4c59c9746
Merge: 4d7dc813 21ab9b40
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Mar 16 10:34:14 2018 +0100

    Merge pull request #6 from michal-narajowski/mesh-dep-fix
    
    mesh: Fix dependency after nimble migration

commit 21ab9b40537673ab7835bc620ac31a0a35b96a11
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Mar 16 10:26:09 2018 +0100

    mesh: Fix dependency after nimble migration

 nimble/host/mesh/pkg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4d7dc8132a5d61a4870b5f003e8a24ed5c295e19
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Dec 20 14:33:54 2017 +0100

    nimble: Make this proper external repository

 nimble/controller/pkg.yml            |  6 +++---
 nimble/controller/test/pkg.yml       | 14 +++++++-------
 nimble/drivers/native/pkg.yml        |  4 ++--
 nimble/drivers/nrf51/pkg.yml         |  6 +++---
 nimble/drivers/nrf52/pkg.yml         |  6 +++---
 nimble/host/mesh/pkg.yml             | 12 ++++++------
 nimble/host/pkg.yml                  | 16 ++++++++--------
 nimble/host/services/ans/pkg.yml     |  4 ++--
 nimble/host/services/bleuart/pkg.yml |  6 +++---
 nimble/host/services/gap/pkg.yml     |  4 ++--
 nimble/host/services/gatt/pkg.yml    |  4 ++--
 nimble/host/services/ias/pkg.yml     |  4 ++--
 nimble/host/services/lls/pkg.yml     |  4 ++--
 nimble/host/services/tps/pkg.yml     |  4 ++--
 nimble/host/store/config/pkg.yml     |  8 ++++----
 nimble/host/store/ram/pkg.yml        |  4 ++--
 nimble/host/test/pkg.yml             | 16 ++++++++--------
 nimble/host/util/pkg.yml             |  4 ++--
 nimble/pkg.yml                       |  4 ++--
 nimble/transport/emspi/pkg.yml       |  6 +++---
 nimble/transport/pkg.yml             | 14 +++++++-------
 nimble/transport/ram/pkg.yml         |  6 +++---
 nimble/transport/socket/pkg.yml      | 10 +++++-----
 nimble/transport/uart/pkg.yml        | 10 +++++-----
 repository.yml                       | 30 ++++++++++++++++++++++++++++++
 25 files changed, 118 insertions(+), 88 deletions(-)

commit f34aebd54d365f991ec6d0e2394c744d8415ea5c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Mar 15 22:47:59 2018 +0100

    nimble/phy: Fix includes
    
    Few leftovers after transition to nrfx.
    
    X-Original-Commit: a016470258f38e38ae6e8912d15d043caf0f7d4a

 nimble/drivers/nrf51/src/ble_hw.c  | 2 +-
 nimble/drivers/nrf51/src/ble_phy.c | 2 +-
 nimble/drivers/nrf52/src/ble_hw.c  | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 2f803e02e82188d851e1dde444f34ba6dc62aadf
Author: Fabio Utzig <utzig@apache.org>
Date:   Fri Mar 9 09:22:01 2018 -0300

    Move cmsis_nvic.h files frm BSP to MCU
    
    This moves cmsis_nvic.h from BSPs to MCUs. Where customizations where
    necessary, new syscfg options were added to the MCU to be overridden by
    the BSP, eg, number of peripheral interrupts.
    
    X-Original-Commit: a926c9c1025087967f113235c4fe7cd5ee6a8dc2

 nimble/drivers/nrf51/src/ble_hw.c  | 2 +-
 nimble/drivers/nrf51/src/ble_phy.c | 2 +-
 nimble/drivers/nrf52/src/ble_hw.c  | 2 +-
 nimble/drivers/nrf52/src/ble_phy.c | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit ae8ce47c5d703b39b534bdeddc90becee80af42f
Merge: cff6b84d feb792c6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 13 13:21:09 2018 +0100

    Merge pull request #911 from michal-narajowski/mesh-fixes
    
    Mesh fixes
    
    X-Original-Commit: 00eb38b4c4d14b88da05ff0e82b2f8ebf728942c

commit cff6b84dfe5b29a1d6817f5a9a8d34bcf32658be
Merge: 10cc2118 5eebc3b1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 13 13:18:51 2018 +0100

    Merge pull request #883 from rymanluk/scan_ext_impr
    
    nimble/ll: Improve extended scan/connect when host request both PHYs to be used
    
    X-Original-Commit: f816a547943a826e058f7f17e0c892b6e1fbc493

commit feb792c6e08aada3de0a3690391a8c24c28e7953
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 6 16:07:30 2018 +0100

    mesh: Fix available LPN groups count
    
    X-Original-Commit: 22228bdc87d78141849ac0715c39ef50c32436fb

 nimble/host/mesh/include/mesh/glue.h | 2 +-
 nimble/host/mesh/src/lpn.c           | 2 +-
 nimble/host/mesh/src/net.h           | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 880daad2a2a6e82fd94ab0719ca162173309761c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 6 12:17:25 2018 +0100

    mesh: shell: Fix supported output actions
    
    Add more supported output actions to be able to provision with
    the Bluetooth Mesh app from Silicon Labs. It contains a bug
    which causes it to select wrong (not supported) action.
    
    X-Original-Commit: 9f6b121764c0707a93ace91dbd11923c6dba1b71

 nimble/host/mesh/src/shell.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 3c0e120bd07d465df34591a392436cd4c98ad14b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 6 12:02:42 2018 +0100

    mesh: Fix setting advertising scan response data
    
    Previously the scan response data was ignored.
    Also the discoverable mode of advertising should be set
    to ensure that the advertising is scannable and that the controller
    can send scan response data.
    
    X-Original-Commit: 8dbd765334d696baeb2c7a20e5ea812a727180c1

 nimble/host/mesh/src/glue.c  | 16 ++++++++++++++++
 nimble/host/mesh/src/proxy.c |  4 +++-
 2 files changed, 19 insertions(+), 1 deletion(-)

commit e2ce808c94b6f53257cdd4a2ba7d3a3f616e1705
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 6 11:31:45 2018 +0100

    mesh: shell: Enable beacon by default
    
    X-Original-Commit: 9d180d3b5e440c1942fbfcacb6b811d17d1bad55

 nimble/host/mesh/src/shell.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 10cc2118264db6864eaba872bfccecd421e755fc
Author: Stéphane D'Alu <sdalu@sdalu.com>
Date:   Mon Mar 12 22:58:31 2018 +0100

    service/ans: don't depent on libm for creating bitmask (#903)
    
    X-Original-Commit: 0fc4943638290b121b92bc87266860802ee91258

 nimble/host/services/ans/src/ble_svc_ans.c | 9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

commit 448954c40b0d57eed247adeceac968ac75c88385
Merge: 07a5d696 b35de4c8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Mar 12 08:49:22 2018 +0100

    Merge pull request #866 from rymanluk/dtm_impr
    
    nimble/dtm: Allow RX being late
    
    X-Original-Commit: 3d41bd30587911376a748fdd5cd12260edb95fc6

commit 07a5d6965ffe20d7ac0490a9b94be674eab11e64
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 8 14:54:31 2018 +0100

    nimble/mesh: Use OS_TASK_STACK_DEFINE for stacks in mesh
    
    X-Original-Commit: 5a97968cdfa5914ad14318051dcb7d6fbef928ea

 nimble/host/mesh/src/adv.c   | 9 +++------
 nimble/host/mesh/src/shell.c | 7 +++----
 2 files changed, 6 insertions(+), 10 deletions(-)

commit 7925ccfb83cd15e0bbb9455e8558884ac01103bf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Mar 8 14:50:24 2018 +0100

    nimble/ll: Use OS_TASK_STACK_DEFINE to init ble_ll stack
    
    This will assure correct aligment
    
    X-Original-Commit: f217015c76f8e2e26a68cc0126f8f9994c96d10f

 nimble/controller/src/ble_ll.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 5eebc3b15e2d750c41550753572b82b37cd9a894
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 7 11:44:28 2018 +0100

    nimble/ll: Fix extended connect when using both PHYs for scanning
    
    When host is using extended connect, scan parameters is a recomendation
    for the controller. Nimble usually follow it but in case host requests
    both CODED and UNCODED PHY for primary scan PHY and choose parameters
    which saying "continous scan" on both PHYs, controller will split time
    between both PHYs.
    
    X-Original-Commit: fc457f1c0791bbc1493a01b9170b5d04d69e354a

 nimble/controller/src/ble_ll_scan.c | 35 ++++++++++++++++++++++++-----------
 1 file changed, 24 insertions(+), 11 deletions(-)

commit 6054b773942b603d309b32d89b9b6dab6e2309d9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 6 14:45:41 2018 +0100

    nimble/ll: Support scan on two PHYs when continous scanning requested
    
    X-Original-Commit: 6258e862c56f2b99ef1682f1fc6c200ce36986ab

 nimble/controller/src/ble_ll_scan.c | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

commit ef48541d0988956d8746a7c6f510a1ef2b53b989
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 6 14:43:14 2018 +0100

    nimble/ll: Improve extended scanner for both PHYs
    
    This patch simplify a bit scanner core and make sure to reuse all
    available bandwith when scanning for two PHYs is requested
    
    X-Original-Commit: 1efe9e5a084373104eda914caba8252b054ddb27

 nimble/controller/src/ble_ll_scan.c | 109 ++++++++++++++++++------------------
 1 file changed, 56 insertions(+), 53 deletions(-)

commit 176b8d8dce2ac5404a0349fd430765d2eae94b29
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 7 11:35:34 2018 +0100

    nimble/ll: Minor coding style fix
    
    X-Original-Commit: 09c3e68af9f41cb6aa5274c254648b721b6c7140

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f9250ff60de7aa3efed6cf1fe9c60ac534e66e67
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 6 14:41:56 2018 +0100

    nimble/ll: Allow to be late on RX when scanning
    
    X-Original-Commit: 178ff7a986ca139b1d776bad8050526f4dfaf18d

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b35de4c81e3044b440758e94efc205ec3a712a27
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 2 11:48:58 2018 +0100

    nimble/dtm: Allow for being late on RX start timer
    
    So far we assert when being late or starting RX timer. Now we allow to
    be late as it is not important for dtm code. RX is still on after it.
    
    X-Original-Commit: dc600a051f11e3c9f31e93fdd45e63c659c3c8c4

 nimble/controller/src/ble_ll_dtm.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 1ca40fe58004f0c58d80067a0ca0644bf8dcc3cd
Merge: 6014f938 1e7940c8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Mar 7 11:10:26 2018 +0100

    Merge pull request #837 from andrzej-kaczmarek/nimble-numpktcmp-fix
    
    nimble/ll: Fix sending HCI Number of Completed Packets event
    
    X-Original-Commit: 356528ca3c7307d38ceb6b44ab452e9c6d74f2a9

commit 6014f938cdeb008f4454b1b4bbe2df7855a2b46d
Merge: c33701ae 8acb7a83
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Mar 7 11:10:06 2018 +0100

    Merge pull request #871 from michal-narajowski/ll-legacy-adv-fix
    
    nimble/ll: Allow setting scan rsp data before configuring advertising
    
    X-Original-Commit: 8f0a8d53bd57cc17644758dc31f0d0439327f752

commit 8acb7a83eff5dc0722c1aef7624444d9b0c57551
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Mar 6 15:35:46 2018 +0100

    nimble/ll: Allow setting scan rsp data before configuring advertising
    
    When using legacy advertising commands
    
    X-Original-Commit: 7c9ebd15755af50377418f4fb7b19fd9f22fcfc8

 nimble/controller/src/ble_ll_adv.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit c33701ae80cfe3d23ba7ae02d6328fec2b4ec209
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Mar 6 10:20:04 2018 +0100

    nimble/phy: Fix receiver configuration on late RX
    
    If we are late when scheduling RX, receiver is enabled anyway since we
    may just want to scan for "anything". However, current code only enables
    receiver but does not configure it so the results seem unpredictable.
    
    This patch fixes this by ensuring that radio is properly configured for
    RX in both cases.
    
    X-Original-Commit: 068c09a8da97bc62eddd5084fa1e40f910abf7e8

 nimble/drivers/nrf52/src/ble_phy.c | 22 ++++++++++++++++++----
 1 file changed, 18 insertions(+), 4 deletions(-)

commit 8feb3cade1217a0c5a1043716086919121a2e653
Merge: aaf569e8 e99920f5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 27 12:06:19 2018 +0100

    Merge pull request #841 from michal-narajowski/mesh-zephyr-ports
    
    Mesh zephyr ports
    
    X-Original-Commit: 6192e73f2685d55fa950013e2040621a5d619f77

commit e99920f59e5836ab75cd95fa8f71e938ebcfc368
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 21 12:56:20 2018 +0100

    mesh: Use a single transmission from Friend to LPN
    
    As per TSE 10009 the TS will enforce that a Friend ever only uses a
    single transmission when sending packets to an LPN. Make sure that our
    implementation follows this.
    
    https://www.bluetooth.org/tse/errata_view.cfm?errata_id=10009
    
    X-Original-Commit: 564a956d1a3b291234dc1351f422830b781689f1

 nimble/host/mesh/src/friend.c | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit 7ed968551eab2f54dfb5ca0d995e2679ed1a9fb3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 14:25:30 2018 +0100

    mesh: Ignore segments of cancelled message
    
    This fixes the issue when after incomplete timer expiration
    host sent ACK.
    The host failed in two cases:
    1. Sending ACK right after the incomplete timer expiration;
    2. Sending ACK from new RX context. Now, seq_auth of cancelled
    message is not cleaned on RX reset, so segments of cancelled message
    will be discarded when resend.
    
    According to the Mesh Profile v1.0
    "When the incomplete timer expires, the lower transport layer
    shall consider that the message being received has failed and
    cancel the acknowledgment timer. Any segment of a canceled
    message shall be ignored."
    
    X-Original-Commit: 50e7d632932c4188849aee89e0d23e2207352601

 nimble/host/mesh/src/transport.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit d7fc4a5a1157006921aa1ffd61482cfdcb939728
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 14:24:57 2018 +0100

    mesh: Fix sending Provisioning Failed for PB-GATT
    
    In the case of an unexpected PDU we need to send the right response.
    This was already taken care of for PB-ADV, but not for PB-GATT.
    
    X-Original-Commit: 65b2467d6192e9bd943a3f898132775984d6b871

 nimble/host/mesh/src/prov.c | 1 +
 1 file changed, 1 insertion(+)

commit 63b487ad59a15d268dc2a51d493ad0d2582dd49a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 14:24:33 2018 +0100

    mesh: Resend Link Acknowledgment when necessary
    
    The Provisioner might have missed our earlier Link Acknowledgement, so
    if we receive another one with matching Link ID and link.expect state,
    simply send another acknowledgement.
    
    X-Original-Commit: b6d823cb5131e8750d7ec1152b4d48ea60ac85c3

 nimble/host/mesh/src/prov.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 35bcfc25b76b6be19093a5e85b94485e9160104c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 14:23:49 2018 +0100

    mesh: Fix handling of failed transmissions
    
    When sending a segmented message, the state could get stuck if the
    advertising bearer fails in transmitting and we don't detect that it
    happened. Add a send_start callback for all packets so we can always
    know if sending fails.
    
    X-Original-Commit: c2f6fa5baf8eab609a705347e1c1b881e48bd710

 nimble/host/mesh/src/transport.c | 34 ++++++++++++++++++++++++----------
 1 file changed, 24 insertions(+), 10 deletions(-)

commit 6e2c7d19022c4d9e956a309b55e326f130a455d7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 14:12:47 2018 +0100

    mesh: Account for scan window delaying adv events
    
    New advertising started while scanning is already enabled
    would delay the first advertisement event until the end of
    the current overlapping scan window in the Zephyr native BLE
    controller implementation. Hence, consider this scan window
    duration when calculating the advertising stop.
    
    X-Original-Commit: 9b8e353c059d260134310e0255bce8b40b00d394

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/adv.c           | 27 +++++++++++++++------------
 nimble/host/mesh/src/glue.c          |  5 +++++
 3 files changed, 21 insertions(+), 12 deletions(-)

commit 703c021133e3e7e158d79c736333fa53c57f1628
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 12:31:32 2018 +0100

    mesh: Fix coverity warning with unchecked error return
    
    This fixes Zephyr's Coverity CID 182769.
    
    X-Original-Commit: 584c807f5e25a9c325d90ad6643628198785128d

 nimble/host/mesh/src/beacon.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 417418eaac3bee5a9237fa4db2219d66819ebeb4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 12:30:15 2018 +0100

    mesh: Add support for OOB info and URI in provisioning data
    
    Until now the OOB info and URI fields in unprovisioned beacons were
    generally ignored by the implementation. Add fields for these to
    bt_mesh_prov and make sure to take them into account when encoding
    advertising data, both for PB-ADV and PB-GATT. For PB-ADV the URI goes
    out in a separate beacon, whereas for PB-GATT it is placed in the scan
    response data.
    
    X-Original-Commit: e6b7f42e2688c2d4102dea83bf962d2fbc74ac5e

 nimble/host/mesh/include/mesh/glue.h |  2 ++
 nimble/host/mesh/include/mesh/main.h | 26 +++++++++++++++++++++
 nimble/host/mesh/src/adv.c           |  5 ++--
 nimble/host/mesh/src/adv.h           |  1 +
 nimble/host/mesh/src/beacon.c        | 39 ++++++++++++++++++++++++++++---
 nimble/host/mesh/src/prov.c          |  4 ++--
 nimble/host/mesh/src/prov.h          |  2 +-
 nimble/host/mesh/src/proxy.c         | 45 +++++++++++++++++++++++++++++++-----
 8 files changed, 110 insertions(+), 14 deletions(-)

commit aaf569e8bc5894d755daa257eca9849caef153e5
Author: Vipul Rahane <vipulrahane@apache.org>
Date:   Mon Feb 26 15:27:23 2018 -0800

    nimble: Adding missing inttypes.h include
    
    - This was causing a build failure
    
    X-Original-Commit: 13566431878bc3e4ac84cd0e9a36eb1d2cd5c870

 nimble/host/services/gap/include/services/gap/ble_svc_gap.h | 2 ++
 1 file changed, 2 insertions(+)

commit 1e7940c858d83d5566e10873c0c600502657f072
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Feb 21 13:54:57 2018 +0100

    nimble/ll: Update handling of HCI Number of Completed Packets event
    
    The calculations for sending this HCI event periodically are a bit
    mysterious at first glance - let's make them more obvious.
    
    X-Original-Commit: 29d5d03fc888c414fb21ac22d6df4b970847f92f

 nimble/controller/src/ble_ll_conn_hci.c | 7 +++----
 nimble/controller/syscfg.yml            | 2 +-
 2 files changed, 4 insertions(+), 5 deletions(-)

commit 78617e16445892abbce5716932a67cb84d31e427
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 23:07:06 2018 +0100

    nimble/gap: Make max device length configurable
    
    X-Original-Commit: a1122f0c7a942baf6e0c963fcae9b8df9484a27b

 nimble/host/services/gap/src/ble_svc_gap.c | 4 ++--
 nimble/host/services/gap/syscfg.yml        | 3 +++
 2 files changed, 5 insertions(+), 2 deletions(-)

commit 48ec4798d53723bbd2455470e9c40e331adb4f8d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 22:50:54 2018 +0100

    nimble/gap: Make appearance optionally writable
    
    As it turns out, spec allows appearance characteristic to be writable
    so let us allow configure it this way. Also we need API to set this
    from app so it can read new appearance value, store it and then restore
    after reboot.
    
    X-Original-Commit: b1b1c785b6f7968588aec68cad897711539552d5

 .../gap/include/services/gap/ble_svc_gap.h         |  1 +
 nimble/host/services/gap/src/ble_svc_gap.c         | 71 +++++++++++++++++++---
 nimble/host/services/gap/syscfg.yml                |  9 +++
 3 files changed, 74 insertions(+), 7 deletions(-)

commit 5f5b248e34116179e879f6bf5d47cc7854194329
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 22:26:00 2018 +0100

    nimble/gap: Make device name optionally writable
    
    GAP service takes care of updating characteristic value. Application
    can register callback to be notified of value change and can then read
    this value and store somewhere (and restore on next boot).
    
    X-Original-Commit: 46e768f451bc4c7a0222348fee384b4d1c87aff1

 .../gap/include/services/gap/ble_svc_gap.h         |  4 ++
 nimble/host/services/gap/src/ble_svc_gap.c         | 67 ++++++++++++++++++++--
 nimble/host/services/gap/syscfg.yml                |  9 +++
 3 files changed, 75 insertions(+), 5 deletions(-)

commit 0fa1d0e1a81856d23c339ec37e65e90bf694c808
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 21:40:44 2018 +0100

    nimble/gap: Make PPCP configurable
    
    Allow to configure value of "Peripherap Preferred Connection Parameters"
    characteristic. Since this characteristic is optional and right now we
    do not set any meaningful value there, we simply disable it by default.
    
    X-Original-Commit: ce7276d7ea9e46e2912980d010b98ef5beadc6ee

 nimble/host/services/gap/src/ble_svc_gap.c | 23 ++++++++++++++++++-----
 nimble/host/services/gap/syscfg.yml        | 24 ++++++++++++++++++++++++
 2 files changed, 42 insertions(+), 5 deletions(-)

commit ac3727c406ef5f8932257937fd83ec96251c60aa
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 21:25:39 2018 +0100

    nimble/gap: Fix characteristics in non-peripheral role
    
    "Peripheral Preferred Connection Parameters" is only optional in
    peripheral role and excluded otherwise - so make it register only
    if we're configured for peripheral role.
    
    X-Original-Commit: 3b1e9855a8dcf0450a21f1bc18102601701d3f60

 nimble/host/services/gap/src/ble_svc_gap.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 095bbc8f8889f73770a52115b9191e8e236456ca
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 21:19:06 2018 +0100

    nimble/gap: Store appearance as simple uint16
    
    X-Original-Commit: a57cfcafecae8b880acb6a3214708f945d9e98b8

 nimble/host/services/gap/src/ble_svc_gap.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

commit 0256df284f7ae9cee12a63023a42d1dcc048fdb1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 21:16:29 2018 +0100

    nimble/gap: Make device name configurable via syscfg
    
    This can still be overriden by app, as previously - it's just not
    hardcoded.
    
    X-Original-Commit: d8101a357beb0b541597f46e5f049af799063aff

 nimble/host/services/gap/src/ble_svc_gap.c | 3 ++-
 nimble/host/services/gap/syscfg.yml        | 5 +++++
 2 files changed, 7 insertions(+), 1 deletion(-)

commit e77d5460c6a9cd320b07a5cb3b74a817da68863d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 21:11:20 2018 +0100

    nimble/gap: Add "Central Address Resolution" characteristic
    
    This characteristics is mandatory for LE Central role if LL Privacy is
    supported.
    
    We could be smarter in registering it by checking controller features,
    but this is quite complex to implement due to the way everything is set
    up so let's leave proper configuration for user :)
    
    X-Original-Commit: 4934ddf4afc889c0aaa932734d5bf361eb4dc042

 .../services/gap/include/services/gap/ble_svc_gap.h     |  1 +
 nimble/host/services/gap/src/ble_svc_gap.c              | 17 +++++++++++++++++
 nimble/host/services/gap/syscfg.yml                     |  6 ++++++
 3 files changed, 24 insertions(+)

commit 724dea122cadaa87c0d4345ff859d8026b9187e7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 20:23:04 2018 +0100

    nimble/gap: Remove deprecated characteristics
    
    "Peripheal Privacy Flag" and "Reconnection Address" are not included in
    GAP spec since 4.1, so let's remove them. And they were not properly
    configured anyway...
    
    X-Original-Commit: 3e2a7295ab2a6be2e46319677ba0d19f4d36224b

 .../gap/include/services/gap/ble_svc_gap.h         |  2 --
 nimble/host/services/gap/src/ble_svc_gap.c         | 27 ----------------------
 2 files changed, 29 deletions(-)

commit 49c1941f89c5762c2c75e9c86c662150a1bfa957
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 23:01:27 2018 +0100

    nimble/gap: Remove redundant formward declaration
    
    X-Original-Commit: b83cc69fbbb59e1bb2c80914d2a9b31698f13b76

 nimble/host/services/gap/include/services/gap/ble_svc_gap.h | 2 --
 1 file changed, 2 deletions(-)

commit da72102f4421e64666d2ead77e50e051fed035cc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 23 23:01:05 2018 +0100

    nimble/gap: Fix whitespaces
    
    X-Original-Commit: 7e4dae9ad578d711c4cba0243b1edbfcb0262be6

 nimble/host/services/gap/include/services/gap/ble_svc_gap.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ad3ff34e98c285c0a063fc91fea58a34ebe04804
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 11:50:51 2018 +0100

    mesh: Fix passing CID to model publication messages
    
    The vendor variants of the model publication client messages were not
    passing onward the CID, rather passing CID_NVAL which is clearly not
    right.
    
    X-Original-Commit: 398fd57f82a407a343ff04e445aed6de9e990e8e

 nimble/host/mesh/src/cfg_cli.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit c1272bd6dd5b0e7386a33209d9fd322fa0abf619
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 20 22:32:43 2018 +0100

    nimble/ll: Fix BLE_LL_CONN_INIT_MIN_WIN_OFFSET
    
    The code which calculates earliest connection event start does not take
    BLE_LL_CONN_INIT_MIN_WIN_OFFSET into account, but we still update tx
    windows offset in state machine with its value. As a result when this
    setting is set to non-zero value we schedule first connection event
    earlier than what slave calculates from CONNECT_IND PDU so connection
    cannot be established.
    
    X-Original-Commit: cf8ca1b0a6fab4e5d1c579fe37ee2adc4e3a1e07

 nimble/controller/src/ble_ll_sched.c | 4 ++++
 1 file changed, 4 insertions(+)

commit ea51f6d4218482474d58a30ea3c8b39a7dc69539
Merge: ab815f79 347d3f13
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Tue Feb 20 14:40:53 2018 -0800

    Merge pull request #792 from ccollins476ad/task-prio
    
     Use `task_priority` type for task priority syscfg.
    
    X-Original-Commit: e17911e30947a29488b6ddfa7f469567971f5f01

commit ab815f79aa98f0895cb94404a2def34ead3070df
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 15:08:07 2018 +0100

    mesh: shell: Fix build when shell is disabled
    
    X-Original-Commit: 5ed429bff2e761adb6d330610ef6e1a6c468872a

 nimble/host/mesh/src/shell.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit cb1760eb7427b64324e04a2ac7b7dbb6275b5bb2
Merge: b0e6640b 554fd646
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 20 10:21:24 2018 +0100

    Merge pull request #815 from michal-narajowski/mesh-blemesh-shell
    
    New mesh app with shell support for testing
    
    X-Original-Commit: 2cf52d5bf0b83bf200d2ff5124270aa387ffcdb1

commit b0e6640b4de67c926eac524f5d7f8be1325c9fb3
Author: Maciej Jurczak <mjurczak@gmail.com>
Date:   Mon Feb 19 23:18:24 2018 +0100

    Changes after PR review.
    CSC profile specific ATT error added.
    Custom endianness handling functions replaced with system functions.
    Device appearance moved to syscfg.
    
    X-Original-Commit: 6cb978b99b2014a9589b1d59ea40e17a9e531dfd

 .../gap/include/services/gap/ble_svc_gap.h         |  7 ++++---
 nimble/host/services/gap/src/ble_svc_gap.c         | 18 +++++++---------
 nimble/host/services/gap/syscfg.yml                | 24 ++++++++++++++++++++++
 3 files changed, 35 insertions(+), 14 deletions(-)

commit ceab2b460985b43e003b6bbe3d4e5a3eceef5704
Author: Maciej Jurczak <mjurczak@gmail.com>
Date:   Sun Feb 18 14:20:49 2018 +0100

    Reverted accidentaly removed function prototype.
    
    X-Original-Commit: a7d82f957630171bf48972cd2b3915ccd37b434c

 nimble/host/services/gap/include/services/gap/ble_svc_gap.h | 2 ++
 1 file changed, 2 insertions(+)

commit 150cbde507a5b72393467aaff7d465a03d17e7ed
Author: Maciej Jurczak <mjurczak@gmail.com>
Date:   Sun Feb 18 13:11:31 2018 +0100

    Added device appearance setter and getter to GAP service.
    
    X-Original-Commit: e4221d89612eda349dad1e6ba7a8e9390d841dc9

 .../host/services/gap/include/services/gap/ble_svc_gap.h   |  4 ++--
 nimble/host/services/gap/src/ble_svc_gap.c                 | 14 ++++++++++++++
 2 files changed, 16 insertions(+), 2 deletions(-)

commit 554fd646452757ac0497feb3ecc02ab0d8493070
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Feb 15 16:47:33 2018 +0100

    mesh: shell: Use random addr when public is unassigned
    
    X-Original-Commit: 8d0155cfbc024386a09106cba8f584a0a897144f

 nimble/host/mesh/src/shell.c | 24 ++++++++++++++++++------
 1 file changed, 18 insertions(+), 6 deletions(-)

commit 1b202fa925f2fcc94adb4ccaa97ba7fc6db52fff
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 14 13:11:26 2018 +0100

    mesh: glue: Add sanity check in k_delayed_work_submit
    
    X-Original-Commit: a14eec88975af4679cd523a5aced6a5510dcfceb

 nimble/host/mesh/src/glue.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 3dc586db1303eb823f340e256e194792b8fcbc43
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 14 12:07:37 2018 +0100

    mesh: glue: Fix calculating remaining time of delayed work
    
    os_cputime_get32() returns value from totally different range, than
    os_time_get() and os_callout_reset() uses os_time_get(), so it should be
    also used here. os_cputime_ticks_to_usecs() doesn't work well with
    os_time_get(), so OS_TICKS_PER_SEC macro is used.
    
    X-Original-Commit: 1eb0d588b403935a8451ff8d87a9b5c993282e3c

 nimble/host/mesh/src/glue.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 9b080e36578f42d93d72a062f61b94cf5c3cc9e4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 13 12:17:34 2018 +0100

    mesh: cfg_cli: Set default message timeout to 5 seconds
    
    To be able to process long messages like composition data get.
    
    X-Original-Commit: cb2a7cb98ac55ece8d007dab1f70b7bf4bc2bc50

 nimble/host/mesh/src/cfg_cli.c    | 2 +-
 nimble/host/mesh/src/health_cli.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 5d427da0df3a7fee6721d05611e88a6d8f0af62f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 14 13:45:15 2018 +0100

    mesh: shell: Use Runtime's company ID
    
    X-Original-Commit: 44d9a1ed1767c936068875c70d2ba994515e39da

 nimble/host/mesh/src/shell.c | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

commit a17113e8d05f333567b8b5b2b2f35dd262604e00
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Feb 13 11:36:56 2018 +0100

    mesh: shell: Use separate task to avoid deadlocks
    
    This is added to avoid deadlocks when node is used as Configuration Client.
    
    X-Original-Commit: c147a42a7d6554c3cd9313effbe6e39924a0e1ea

 nimble/host/mesh/src/shell.c | 30 ++++++++++++++++++++++++++++++
 1 file changed, 30 insertions(+)

commit eccf2e838acef3a7cddac2ae1553b3612e25ac30
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Feb 12 16:54:24 2018 +0100

    mesh: Fix Friend os_mempool_size calculation
    
    X-Original-Commit: a0b45a5f3d7d81641cca8fc6f4461296199a4db0

 nimble/host/mesh/src/friend.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 65cdb84628492659ebc841c3b3617ef2d18286f7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Feb 1 02:52:53 2018 +0100

    mesh: glue: Fix k_sem_take() semaphore port
    
    os_sem_pend expects time in ticks and timeout is in ms.
    
    X-Original-Commit: 7999ae27b8269561b22711a580001f6210b63485

 nimble/host/mesh/include/mesh/glue.h | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 6bc91e9e8265f65d9bd0c95ddf7bbd9b13b4862e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 19 15:22:27 2018 +0100

    mesh: shell: Add command for printing mesh composition data
    
    For testing purposes.
    
    X-Original-Commit: bc8f9b16f1c9141c7466bb7a55b2a863622db203

 nimble/host/mesh/src/shell.c | 46 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 46 insertions(+)

commit 31d1880960fc0770daefdf401776c149364e2e72
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 12 10:10:30 2018 +0100

    mesh: shell: Add command for printing mesh credentials
    
    For testing purposes.
    
    X-Original-Commit: 77b78775f138c5aaffa9d8c8e0c17fb7e9604820

 nimble/host/mesh/src/shell.c   |  9 ++++++
 nimble/host/mesh/src/testing.c | 68 ++++++++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/testing.h |  1 +
 3 files changed, 78 insertions(+)

commit bc4923805fbb5ee63ea3dc3d6afd056eb39ea161
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 19 11:38:48 2018 +0100

    mesh: shell: Add LPN subscription commands to mesh shell
    
    X-Original-Commit: 1409b61d162858308030c2f9c3dbd18fd0d89b73

 nimble/host/mesh/src/shell.c | 49 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 49 insertions(+)

commit a6f461b7bb9830ceddb9e5274444b3787375c0be
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 18 17:11:30 2018 +0100

    mesh: shell: Add dummy vendor model for PTS testing
    
    This is required to pass MESH/NODE/CFG/MAKL/BI-04-C.
    
    X-Original-Commit: bf1c017e025600531588af02f3e374f3cc551f8f

 nimble/host/mesh/src/shell.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit 287101bdaf6e48d5874a277571839a24ffd8deaa
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 9 12:40:28 2018 +0100

    mesh: Initialize shell on sysinit
    
    This is needed, because mesh-shell has commands to initialize mesh,
    so the shell should not be initialized during mesh init.
    
    X-Original-Commit: dc3dc40af95ca271ba9aa51f1c4416d5cebe775a

 nimble/host/mesh/pkg.yml     |  3 +++
 nimble/host/mesh/src/mesh.c  |  4 ----
 nimble/host/mesh/src/shell.c | 13 +++++++++----
 nimble/host/mesh/src/shell.h |  2 +-
 4 files changed, 13 insertions(+), 9 deletions(-)

commit ab275d89356cd53b7cdae92bd5ab164ddb620cbb
Merge: da3bdcee 074d32d4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Feb 16 14:05:54 2018 +0100

    Merge pull request #748 from michal-narajowski/mesh-zephyr-ports
    
    Some mesh fixes from Zephyr
    
    X-Original-Commit: a45035b6de7ba35df30eba59b8aabe342f3c4f2c

commit 074d32d4b52e38363c0df924387a76dcc0fc64e3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:45:54 2018 +0100

    mesh: Remove redundant AD parsing check
    
    A few lines earlier the code bails out in case len is 0. Checking for
    buf->len < 1 is the same as checking for buf->len == 0. Since len is
    guaranteed to be > 0 here the check len > buf->len implicitly checks
    for buf->len == 0, i.e. the second test can be removed.
    
    X-Original-Commit: 7334e9616f742303cf848cd30ccb321758735320

 nimble/host/mesh/src/adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ca7e104c14b4d163c13fd396f30a71948e9465bb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:44:33 2018 +0100

    mesh: Fix segment transmission timeout
    
    The timeout was hard-coded to 400ms, but the spec actually states:
    
    "This timer shall be set to a minimum of 200 + 50 * TTL milliseconds."
    
    X-Original-Commit: 085af3822411686a45460f8ec6ee104acb37e735

 nimble/host/mesh/src/transport.c | 20 ++++++++++++++++----
 1 file changed, 16 insertions(+), 4 deletions(-)

commit 58041b9cc5120511732fc0dcc19c28b025e9cd87
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:43:53 2018 +0100

    mesh: Fix ack timeout calculation
    
    The caculation was wrong since the value may be BT_MESH_TTL_DEFAULT,
    i.e. 0xff, leading to much too large values.
    
    X-Original-Commit: aaa9094ad2c1bfe8f3eb483631240a6a9b3bfc0c

 nimble/host/mesh/src/transport.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 5618c9ffa56f9eb54ecce55ab00a2de3cfa694dc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:43:10 2018 +0100

    mesh: Clear segment rx context when incomplete timer expires
    
    https://www.bluetooth.org/errata/errata_view.cfm?errata_id=10321
    
    X-Original-Commit: 7ae45e93c7fa2fbf5a5f7c5ce76d783de80b5aa2

 nimble/host/mesh/src/transport.c | 30 +++++++++++++++++-------------
 1 file changed, 17 insertions(+), 13 deletions(-)

commit 56fdb2d620704ee2a8097a68f88a0c1db245ada6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:42:31 2018 +0100

    mesh: Take advantage of K_SECONDS macro
    
    This makes the code slightly more readable.
    
    X-Original-Commit: e7c0eeb1e909c17794af5c2d59efcd729385dd7b

 nimble/host/mesh/src/transport.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f25e49f7709dc548d040a1f9cebf596698bdb269
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jan 31 20:41:54 2018 +0100

    mesh: Fix ignoring old SeqAuth values
    
    Replay protection is not enforced at the Lower Transport Layer, so it
    is possible to get an old replayed segment here. In such a case
    cleanly discard it instead of causing a valid existing transaction
    from being discarded.
    
    X-Original-Commit: 084acfd33a1b880d43db9e07be04f617d1ac5d3d

 nimble/host/mesh/src/transport.c | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit 7ebc2b5239e3c865632c7e8ae0a1405e02848000
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 11 15:27:04 2018 +0100

    mesh: Add event indicating expiration of incomp timer
    
    This event indicates that segmented message incomplete timer
    expired.
    
    X-Original-Commit: 5d885150d35a201526a98b9f4aaa33c7f898fb0e

 nimble/host/mesh/include/mesh/testing.h |  1 +
 nimble/host/mesh/src/testing.c          | 11 +++++++++++
 nimble/host/mesh/src/testing.h          |  1 +
 nimble/host/mesh/src/transport.c        |  5 +++++
 4 files changed, 18 insertions(+)

commit 95d32ec2f7954aa5dc83cded79ae7bc9324bfdc8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 11 14:57:31 2018 +0100

    mesh: Move bt_test_mesh_net_recv to internal API
    
    This function is called only within mesh stack.
    
    X-Original-Commit: 7693827a83d378f707db1e621e2c6983f118a5e0

 nimble/host/mesh/include/mesh/testing.h | 14 --------------
 nimble/host/mesh/src/testing.h          |  2 ++
 nimble/host/mesh/src/transport.c        |  2 +-
 3 files changed, 3 insertions(+), 15 deletions(-)

commit ef2bbf176460ec884faa6cca868aa8f22579cebf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 11 12:44:59 2018 +0100

    mesh: Add Provisioning Invalid Bearer callback to Testing API
    
    X-Original-Commit: 936ba0b6a849cbe378aafcc10cb78898a78a8215

 nimble/host/mesh/include/mesh/testing.h |  1 +
 nimble/host/mesh/src/prov.c             |  6 ++++++
 nimble/host/mesh/src/testing.c          | 11 +++++++++++
 nimble/host/mesh/src/testing.h          |  4 ++++
 4 files changed, 22 insertions(+)

commit 0ef3b757ab42c7993f8d3a14311fbe88cb9870a5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 11 12:39:36 2018 +0100

    mesh: Add model bound callbacks to Testing API
    
    X-Original-Commit: 391dc99a32cb3caec131670d4b72af16ccc64b8f

 nimble/host/mesh/include/mesh/testing.h |  5 +++++
 nimble/host/mesh/src/cfg_srv.c          |  9 +++++++++
 nimble/host/mesh/src/testing.c          | 28 ++++++++++++++++++++++++++++
 nimble/host/mesh/src/testing.h          | 15 +++++++++++++++
 4 files changed, 57 insertions(+)

commit 3d4109d5235bb7feed40d3e1c7797907569b4031
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 14 15:10:00 2018 +0100

    mesh: Introduce Bluetooth Testing API
    
    X-Original-Commit: a05bd3f7b803483f553f74fc8defddf34f843739

 nimble/host/mesh/include/mesh/glue.h    |  1 +
 nimble/host/mesh/include/mesh/testing.h | 75 +++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/testing.c          | 36 ++++++++++++++++
 nimble/host/mesh/src/transport.c        |  6 +++
 nimble/host/mesh/syscfg.yml             |  5 +++
 5 files changed, 123 insertions(+)

commit f3158bcfaf2b9fab5966f1164a648ab900d9d93e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 11 15:14:45 2018 +0100

    mesh: Fix model subscription groups cleanup
    
    Virtual address labels array entries were not updated on va deletion,
    so that STATUS_INSUFF_RESOURCES error was returned after few
    subsequent Config Model Subscription Virtual Address Add, Delete,
    Overwrite commands, even if there shall be free space available.
    
    X-Original-Commit: 0e44b7e1880565019d7aa498d22ea509dfc7bb11

 nimble/host/mesh/src/cfg_srv.c | 95 +++++++++++++++++++++++++++++-------------
 1 file changed, 65 insertions(+), 30 deletions(-)

commit 3873f0950351d1bfbcae7aba33a0ba5aa5aebae2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 11 15:13:00 2018 +0100

    mesh: Fix LPN subsciption groups update on VA deletion
    
    This fixes missing bt_mesh_lpn_group_del call in mod_sub_va_del.
    If Config Model Subscription Virtual Address Delete was received
    and successfully proceeded, subscription address shall be also
    deleted from LPN Subscribe Groups.
    
    X-Original-Commit: 01729bc18b497b59ee22ee517598e00e4bdd3b4d

 nimble/host/mesh/src/cfg_srv.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 11dd5352838557ef8278ae2b7cfef8ccf6c54698
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 5 16:06:37 2018 +0100

    Revert "mesh: Fix ignoring invalid Transport OpCode as LPN"
    
    MESH/NODE/FRND/LPN/BI-02-C in Mesh Test Specification 1.0.1
    has been fixed according to TSE #9774.
    
    IUT shall ignore the message with an RFU Transport Control Opcode
    but another Friend Poll message shall be sent with an alternating
    FSN value.
    
    X-Original-Commit: 0b1a0d4e0615c1f0b54e0ccc0947af41e0c65d17

 nimble/host/mesh/src/transport.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

commit cc7e83072820ac04627f25d20a427a1ace21f725
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 5 16:00:28 2018 +0100

    mesh: Do not set RFU bits in Heartbeat Publication Features
    
    Features received in Config Heartbeat Publication Set message can have
    Feature bits set to RFU values.
    This patch fixes setting this RFU bits in Heartbeat Publication
    Features, so that those are not indicated in Config Heartbeat
    Publication Status message.
    
    X-Original-Commit: e2b3c2c5be7ee60725a46b362a913fec78b0d333

 nimble/host/mesh/include/mesh/main.h | 4 ++++
 nimble/host/mesh/src/cfg_srv.c       | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)

commit c1b501a676e7617da3d59aa94394e74bef60d846
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 4 11:27:17 2018 +0100

    mesh: Fix status returned from mod_unbind
    
    According to Mesh Specification v1.0 4.3.2.48 Config Model App Status:
    "The Status Code shall be Success if the received request was redundant
    (bind request of existing binding, or unbind of a non-existing binding),
    with no further action taken."
    
    X-Original-Commit: e2b222d13183fc576ab763657a330a12dde6f19f

 nimble/host/mesh/src/cfg_srv.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 03b449ae870f945ea0ab78c24e39a273afacdae0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 4 11:25:53 2018 +0100

    mesh: shell: Fix IVIndex parsing
    
    Fix the parsing of IVIndex value from shell command line for
    cmd_provision
    
    X-Original-Commit: a77bd09113ff59cb429bf68e8a1e165621635cdd

 nimble/host/mesh/src/shell.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2174622ded0b8ed420a90ff7ac0e497d0e7d1d50
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Feb 14 15:06:58 2018 +0100

    mesh: Fix sys_slist_t port and add net_buf_slist_t port
    
    This patch fixes sys_slist_t port from Zephyr porting it verbatim.
    It will be used in following patches. It also defines a port
    of sys_slist_t for os_mbufs called net_buf_slist_t and uses it
    to fix issues with previous port. This port is needed, because Zephyr's
    sys_slist_t is not compatible with Mynewt's os_mbufs.
    
    We should not use os_mbuf_pkthdr chains to represent a list of
    packets, this is a hack. For now this is not an issue, because mesh
    does not use os_mbuf chains. We should change this in the future.
    
    X-Original-Commit: 8ac960305f2b4789b6a2b7b94492476800130372

 nimble/host/mesh/include/mesh/glue.h  |  19 ++
 nimble/host/mesh/include/mesh/slist.h | 290 ++++++++++++++++++++++++++----
 nimble/host/mesh/src/friend.c         |  32 ++--
 nimble/host/mesh/src/glue.c           |  89 ++++++++++
 nimble/host/mesh/src/net.c            |   3 +-
 nimble/host/mesh/src/net.h            |   8 +-
 nimble/host/mesh/src/slist.c          | 323 ----------------------------------
 7 files changed, 389 insertions(+), 375 deletions(-)

commit da3bdceec35900405145ed682575c78123441d0b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Feb 14 17:27:28 2018 +0100

    nimble/phy: Cleanup code for checking PDUSTAT->CISTAT
    
    X-Original-Commit: dff83e3e502178b847a829d3f6d4dade53556233

 nimble/drivers/nrf52/src/ble_phy.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit 7bdacd35185fe399a4d2d80795014505a26cce67
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Feb 14 17:29:03 2018 +0100

    nimble/phy: Allow 2M PHY on nRF52
    
    With nrfx we now have proper symbols defined for nRF52.
    
    X-Original-Commit: 93d97dabe051472358c81e94fdfc9979a078c066

 nimble/controller/include/controller/ble_phy.h | 4 ++--
 nimble/drivers/nrf52/src/ble_phy.c             | 4 ++++
 2 files changed, 6 insertions(+), 2 deletions(-)

commit d62d1c24b51fbbd1e946e7936f04822091d509b8
Merge: 06cfc0b0 1ce5000d
Author: Miguel Azevedo <miguellazev@gmail.com>
Date:   Wed Feb 14 13:48:11 2018 -0200

    Merge pull request #763 from mlaz/integrate_nrfx
    
    Integrate nrfx along with all drivers from mynewt_nordic.
    
    X-Original-Commit: d870b9d608109b6b8b0a7d320f42520b828a5a72

commit 1ce5000d4eede94ef87872d7b9bc8d392201eddf
Author: Miguel Azevedo <miguellazev@gmail.com>
Date:   Tue Feb 13 17:58:39 2018 -0200

    Fixing NRF_RADIO CI field on ble_phy.
    
    X-Original-Commit: 3c2c8defa455137a45f397513ca54ed7be8e68f7

 nimble/drivers/nrf52/src/ble_phy.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 06cfc0b08f852bafecba6697c962dc54c1fc5358
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 13 14:51:42 2018 +0100

    nimble/phy: Fix for late RX-TX transition on nRF52
    
    RX-TX transition on nRF52 is done by triggering TXEN using TIMER0 as we
    do T_IFS in software. However, it may happen that timer set for TIMER0
    is behind current TIMER0 counter and thus we will not start TX and thus
    effectively block phy.
    
    For now we will use a little hack: just indicate that we were late on
    setting transition timer and this will make ble_phy_tx() fail so we can
    recover easily. This seems much cleaner than hacking extra handling in
    many other functions, so let's use such workaround for now.
    
    X-Original-Commit: dd132d43d5facb8e538e1e2277f9a47bba4bdd40

 nimble/drivers/nrf52/src/ble_phy.c | 27 +++++++++++++++++++++++++++
 1 file changed, 27 insertions(+)

commit 350eded2876039e449a8bda390d03ebaa57789a4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 13 09:23:57 2018 +0100

    nimble/host: Remove redundant memset
    
    X-Original-Commit: b9eab544483b5be21c2b47b3fef427afe002c3a5

 nimble/host/src/ble_hs_pvcy.c | 2 --
 1 file changed, 2 deletions(-)

commit 08991756f6040aebd44792e8c932329b9067b57f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 13 09:13:29 2018 +0100

    nimble/host: Do not set peer IRK for all-zero address
    
    Also fix comment to be more precise.
    
    X-Original-Commit: 471f63d3b4d372c6ae4a5acc51e9c5e67ab3aa1f

 nimble/host/src/ble_hs_pvcy.c | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit 0548f849a87309da67d628ce8b0f847ea8e6edd8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 12 20:51:59 2018 +0100

    nimble/ll: Add note about InitA when initiating connection with privacy
    
    Even with privacy enabled we have to use our identity address as InitA
    when peer is not on our resolving list. Since this is a bit counter-
    intuitive, let's add a note with spec reference so we do not need to
    waste time in future figuring out why it is implemented like this.
    
    X-Original-Commit: 19cf6a3f92b9111f05fcd2f05cfa21bb62991cb9

 nimble/controller/src/ble_ll_conn.c | 5 +++++
 1 file changed, 5 insertions(+)

commit dbdea0fb33c03969334a2d5f6b81bbe2ede330e2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 12 20:46:47 2018 +0100

    nimble/ll: Use NRPA for scan requests to unknown devices
    
    With privacy enabled, we'll use NRPA instead of identity address to
    send scan requests to devices which are not on our resolving list.
    This is to prevent us from being tracked when doing active scanning.
    
    X-Original-Commit: 0cde652d1eef0b7f7ef202e7418284e675687cfa

 nimble/controller/include/controller/ble_ll_scan.h |  4 +++
 nimble/controller/src/ble_ll_scan.c                | 36 +++++++++++++++++++++-
 2 files changed, 39 insertions(+), 1 deletion(-)

commit 68740d6427e5f942d03b11ea50eb6e32054280ad
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 12 18:02:18 2018 +0100

    nimble/ll: Fix generating RPA when advertising
    
    When starting SM, we always overwrite AdvA and InitA to "identity"
    values and then we should overwrite them again with RPAs, if necessary.
    However, since we call function which rotates RPA for advertising SM it
    will not update addresses if called before rotate timeout fired.
    
    This means that 1st time we start SM addresses are set properly, but
    then we may use identity addresses instead of RPAs if SM is restarted.
    
    This patch fixes this by ensuring proper RPAs are always configured in
    SM.
    
    X-Original-Commit: 84483464e35a4646be430519bac7f948d5f3202a

 nimble/controller/src/ble_ll_adv.c | 76 +++++++++++++++++++++-----------------
 1 file changed, 43 insertions(+), 33 deletions(-)

commit fadb671268c32a188779b52d40a6d593e42e3c28
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Feb 12 15:17:44 2018 +0100

    nimble: Fix for failing unit tests
    
    X-Original-Commit: 06696776610c38575d52d47e712f238f2c62638f

 nimble/host/test/src/ble_hs_pvcy_test.c     | 2 +-
 nimble/host/test/src/ble_hs_test_util_hci.c | 6 ++++++
 2 files changed, 7 insertions(+), 1 deletion(-)

commit fb69e531ed420157d7c6e1bc5df5293171b1843f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Feb 12 13:23:45 2018 +0100

    nimble/mesh: Use fast advertising interval for BT5 controllers
    
    X-Original-Commit: 277a1488f90ad191f370a65a14863b09bc5b5b3a

 nimble/host/mesh/src/adv.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 298481dd7c0d4741ee53b03a984ee1ca50d35eda
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Feb 12 13:20:17 2018 +0100

    nimble/startup: Read local HCI version on startup
    
    X-Original-Commit: 3dd9d11c8ab9638503ede80cdd08ed4296d91e46

 nimble/host/src/ble_hs_hci.c      | 13 +++++++++++++
 nimble/host/src/ble_hs_hci_priv.h |  2 ++
 nimble/host/src/ble_hs_startup.c  | 32 ++++++++++++++++++++++++++++++++
 3 files changed, 47 insertions(+)

commit 4dd9196d1f815a36d81f1f5c5532d67cf5c1e747
Merge: 96b40c29 5e82e31b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 12 09:54:12 2018 +0100

    Merge pull request #770 from andrzej-kaczmarek/adv-chain
    
    nimble/ll: Add support for advertising and scan response data fragmentation
    
    X-Original-Commit: 1f0049a351154c937472395d15b5cfbe27c9d64b

commit 96b40c297e572247b82b10862d24d8789f1dcd8b
Merge: fe24be8c 91ca91d9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Feb 7 05:29:55 2018 -0800

    Merge pull request #786 from rymanluk/nimble_ll_fixes
    
    nimble/ll: Fix for disconnection with LL response timeout with one vendor
    
    X-Original-Commit: 67bd13021aad899976c854a738beeedb2e64ea1f

commit fe24be8c1f7ba89bb978adf52b9744ccd8d3d4dc
Merge: 319fd8ef cb06a145
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Feb 7 14:18:56 2018 +0100

    Merge pull request #789 from andrzej-kaczmarek/nimble-standby-fix
    
    nimble: Fix for invalid handling of missed connection event
    
    X-Original-Commit: ba8e923ffb4052ba4b2e833e094fbd4f2a80d21e

commit 91ca91d9b6e1b831cb04223f551909a1d626debf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 31 18:52:15 2018 +0100

    nimble/ll: Fix for disconnection with LL response timeout
    
    It could happen that remote peer (master) sends LL_REJECT_IND
    on LL_LENGTH_REQ in case of collision. In this case nimble shall stop
    procedure.
    
    X-Original-Commit: 6d7f0e6a304ffb4537ba56aec7cf148bded03f38

 nimble/controller/src/ble_ll_ctrl.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit 319fd8efb884b1ef434e5b0e2e93f58f307f4533
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 6 19:28:16 2018 +0100

    nimble/transport: Remove HCI event buffer size override for extadv
    
    We can now fragment scanned advertising PDUs into smaller reports to
    fit in configured event size - no need to override this for ext adv
    anymore.
    
    X-Original-Commit: 13bc5613ed89a19da7f020005ff6df26f1d7b7f4

 nimble/transport/ram/syscfg.yml    | 3 ---
 nimble/transport/socket/syscfg.yml | 3 ---
 nimble/transport/uart/syscfg.yml   | 3 ---
 3 files changed, 9 deletions(-)

commit 28235070472f9099475a0955a077cc4ae6b56f73
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 6 19:54:00 2018 +0100

    nimble/ll: Fix extended advertising reports HCI  events
    
    Since single extended advertising PDU can fit more data than single HCI
    event, it is possible that received data do not fit into single event
    and we dropped entire PDU in this case.
    
    To handle this properly we need to fragment received data into multiple
    HCI events. New code will fragment data automatically depending on max
    event size configured and adjust data status flags accordingly.
    
    Also, data status flag was set incorrectly and this is also fixed now.
    
    X-Original-Commit: a1000b8d60912e89d186719904b85e9e49585407

 nimble/controller/include/controller/ble_ll_scan.h |   2 +-
 nimble/controller/src/ble_ll_scan.c                | 126 ++++++++++++---------
 nimble/include/nimble/hci_common.h                 |   7 +-
 3 files changed, 80 insertions(+), 55 deletions(-)

commit 5810f86a1a9916d90d2f33f0e423a29b99cbf488
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Feb 6 19:26:33 2018 +0100

    nimble/ll: Fix parsing length in advertising PDU
    
    In Bluetooth 5.0 length field is 8 bits so we should not use mask
    anymore as it may lead to data truncation/corruption. RFU bits shall be
    set to 0 by older devices to this should be safe (in earlier versions
    length field was 6 bits and 2 msb were RFU).
    
    X-Original-Commit: 7c0ceed998a82d7271b2ddfa4f1bf7b9783835d7

 nimble/controller/include/controller/ble_ll.h | 1 -
 nimble/controller/src/ble_ll.c                | 2 +-
 nimble/controller/src/ble_ll_conn.c           | 2 +-
 nimble/controller/src/ble_ll_scan.c           | 2 +-
 4 files changed, 3 insertions(+), 4 deletions(-)

commit 5e82e31b7435a4ce09c4d0503a91b2de5ef68a98
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 18 17:11:45 2018 +0100

    nimble/ll: Add support for adv/scanrsp data fragmentation
    
    This patch adds support for fragmentation of advertising and scan
    response data on secondary advertising channels.
    
    The controller can support up to 1650 bytes of data (spec limit).
    
    The scheduling code for secondary channels is refactored to be more
    generic and allow to easily schedule chains of aux packets for both
    advertising and scan response data. We now have two scheduler instances
    for auxiliary packets so we can have two consecutive packets scheduled.
    This way AuxPtr can be calculated immediately, without need to schedule
    new auxiliary packet in interrupt context. Subsequent auxiliary packets
    are automatically scheduled as long as there are some data left unsent.
    
    X-Original-Commit: 8eaa177d1a55e0dda724cda8b5bda03ec0f3c8ce

 nimble/controller/include/controller/ble_ll.h      |   3 +-
 .../controller/include/controller/ble_ll_sched.h   |   6 +-
 nimble/controller/src/ble_ll_adv.c                 | 775 +++++++++++++--------
 nimble/controller/src/ble_ll_sched.c               |   5 +-
 4 files changed, 502 insertions(+), 287 deletions(-)

commit 54b5f31cb0950a4b8b9059370f0e27b678a626fe
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 1 14:35:49 2018 +0100

    nimble/ll: Store scan response data in mbuf
    
    We can support long scan response data (for extended advertising)
    without need to lots of RAM. Ths is basically the same as b405472 but
    for scan response data.
    
    X-Original-Commit: 2a882a83782555f5e11b9eedabfc88f3a65cb919

 nimble/controller/src/ble_ll_adv.c | 118 ++++++++++++++++++++++---------------
 1 file changed, 71 insertions(+), 47 deletions(-)

commit 347d3f13ae1124a6e5f424074107097f3f093936
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 5 11:33:51 2018 -0800

    BLE LL - Fix prio conflict with UART in unit tests
    
    X-Original-Commit: e01480a0cee16dc41a30c4687d9e258ec6ad3742

 nimble/controller/test/syscfg.yml | 3 +++
 1 file changed, 3 insertions(+)

commit 34c36c1d50f7173d3ed2f11e7e1764980a1616d2
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 5 11:25:58 2018 -0800

    Use `task_priority` type for task priority syscfg.
    
    This allows newt to report priority conflicts at build time.
    
    X-Original-Commit: 1672c2983e0ce7eac6704397d489021a10b318df

 nimble/host/mesh/syscfg.yml        | 1 +
 nimble/transport/emspi/syscfg.yml  | 1 +
 nimble/transport/socket/syscfg.yml | 1 +
 3 files changed, 3 insertions(+)

commit 2f3c674d017d482e07d4a9ddeb5223999528fc12
Merge: 355ceaa4 80b66782
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 5 15:54:43 2018 +0100

    Merge pull request #614 from andrzej-kaczmarek/nimble-ll-dle-fix
    
    nimble/ll: Fixes for Data Length Extension
    
    X-Original-Commit: d2cd24136113b0583958536e85921b4a4b97302f

commit 355ceaa490e076428d2265b53b8c46c671f0ec50
Merge: 6f786f68 4919f524
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Feb 5 06:50:39 2018 -0800

    Merge pull request #767 from rymanluk/dtm_fix
    
    nimble/ll_dtm: Couple of fixes for DTM code
    
    X-Original-Commit: 1d8a02189a051524eea9122f20e7ec697fb9a662

commit 6f786f68795c2bef8312c029971e98e0c0497ddc
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 1 20:34:49 2018 +0100

    nimble/dtm: Disable whitening for testing
    
    X-Original-Commit: 1aaf512484cd6986700a35b55783a7fef7a0c976

 nimble/controller/src/ble_ll_dtm.c | 5 +++++
 nimble/drivers/nrf52/src/ble_phy.c | 4 +++-
 2 files changed, 8 insertions(+), 1 deletion(-)

commit 80b667822cf0d1118e90800cc691fff5362915c7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 13:36:18 2018 +0100

    nimble: Fix HCI LE Set Data Length parameters range
    
    In Core specification 5.0 upper limit for TxTime is 17040 (0x4290).
    
    X-Original-Commit: 61df8cfc85ae6cf062fc3d44999daec4869eb0c8

 nimble/include/nimble/hci_common.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 99e04f775a22910a1c9099d61bfb09b6b469a2cf
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Feb 5 15:27:15 2018 +0100

    nimble/ll: Fix data fragmentation with maxTxTime<maxTxOctets
    
    We did not properly adjust payload length for 2nd and subsequent packet
    fragments so in case effectiveMaxTxTime is less than time required to
    send payload of effectiveMaxTxOctets, we send too many data in all
    packets except 1st one.
    
    X-Original-Commit: 28a6757071fef72b2b6171fdf2c2fede48d524df

 nimble/controller/src/ble_ll_conn.c | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit 869b5a89c349ea60ab7cfc9efb562fa13c3d8ca9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 25 13:56:29 2018 +0100

    nimble/ll: Cleanup a bit conn initialization
    
    X-Original-Commit: 464b066fd76b2d50acd32e0bc66afa99441b3a0a

 nimble/controller/src/ble_ll_conn.c | 33 +++++++++++++++------------------
 1 file changed, 15 insertions(+), 18 deletions(-)

commit 32ba8b3eab3e1cd7a6423191da0b6d080395c4c0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Oct 11 16:50:24 2017 +0200

    nimble/ll: Fix LL_LENGTH_REQ/RSP handling
    
    We should reply LL_UNKNOWN_RSP if CtrlData received from peer are
    invalid [1]. This means, we only have to check if TX/RX values for time
    and octets are not less than 328 and 27 respectively [2]. Any other
    value received shall be accepted - we will calculate effective values
    for both octets and time to be within limits anyway.
    
    In addidion, even if LL_LENGTH_RSP does not have valid data we should
    end procedure since there is no exception for this in spec [3]. We do
    not apply invalid parameters, but also won't hit procedure timeout.
    
    Core specification v5.0, Vol 6, Part B
    [1] section 2.4.2
    [2] section 2.4.2.21
    [3] section 5.1.10
    
    X-Original-Commit: faf673657f07b4215befe2a11ed1546a27ce4d96

 nimble/controller/src/ble_ll_ctrl.c | 44 ++++++++-----------------------------
 1 file changed, 9 insertions(+), 35 deletions(-)

commit 573a7643704cde7c5416c8dc215b7e7802f30c98
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Oct 11 16:48:23 2017 +0200

    nimble/ll: Fix max supported TX time
    
    Max TX time (regardless of PHY) is 17040us since this is maximum value
    allowed by HCI commands and we should accept it. This does not mean we
    will use whatever hosts requests since these are just suggestions and
    we calculate actual supported and effective TX time taking into account
    connection settings and other limitations from spec.
    
    X-Original-Commit: 46f451be162f21a8b3218f5b1b6f6869fdf97501

 nimble/controller/src/ble_ll_conn_priv.h | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)

commit cb06a1452a8db528b5d4968eae024403c8bba882
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 2 17:07:57 2018 +0100

    nimble/phy: Make sure PHY is properly disabled before TX/RX
    
    LL should disable PHY when going to standby state, but if it does not
    do this for whatever reason let's make sure radio is properly disabled
    before reconfiguring it for TX/RX. Leaving radio in idle state means
    any short combination to start it won't work so it may be stuck until
    something else disables PHY.
    
    On nRF52 this is not necessary since it is possible to ramp-up radio
    also from idle state.
    
    X-Original-Commit: d5a9b26f39c5e1f5c1720953b4423de5fefa4021

 nimble/drivers/nrf51/src/ble_phy.c | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

commit f0cd5d093fe103508e6ff19ee3c075e710675d43
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 2 16:59:22 2018 +0100

    nimble/ll: Disable PHY if failed to handle connection event
    
    When failed to handle connection event, we go back to standby state but
    we also need to disable PHY so subsequent scheuler event can start from
    "clean" state.
    
    X-Original-Commit: e1f52630b2570b10e73d0561fbe9dee4dc553794

 nimble/controller/src/ble_ll_conn.c | 1 +
 1 file changed, 1 insertion(+)

commit afbaf4b961567f926072b294f53d0826db9d501f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 1 13:45:10 2018 +0100

    nimble/gap: Allow adv data for connectable ext adv
    
    This is allowed by spec, only legacy directed advertising cannot have
    adv data included.
    
    X-Original-Commit: d40b1364ea1e75bdea6b061f0b00c69cade704d4

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 4661e7bbda6551f0b1a67231e4682bf467407041
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Feb 1 13:44:18 2018 +0100

    nimble/ll: Remove duplicated symbols
    
    X-Original-Commit: e4f449c7c909be561ad1343912a86af491a81b25

 nimble/controller/include/controller/ble_ll.h | 9 ---------
 1 file changed, 9 deletions(-)

commit 4ae8d333b82b7b2558f1c717168131c5ad1bafb7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 31 12:13:50 2018 +0100

    nimble: Enable missing Encryption Key Refresh Complete Event
    
    Host didn't enabled that event in controller but is expecting this
    when re-encrypting connection with new LTK.
    
    This was affecting TP/SEC/AUT/BV-13-C qualification test.
    
    X-Original-Commit: a97c970598bb71e88f4f9e2bc1776a7217c2ed0d

 nimble/host/src/ble_hs_startup.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 3f81ffaa12c271e689ae00adc223cc603f3f724e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jan 29 18:40:16 2018 +0100

    nimble/ll: Improve handling of incomplete adv data
    
    As per Core specification [1], if advertising data is not complete in
    advertising set we should return Command Disallowed error when trying to
    enable set.
    
    [1] 5.0, Vol 2, Part E, section 7.8.56
    
    X-Original-Commit: 12b3708e927833535d121553ccb23064dbadb919

 nimble/controller/src/ble_ll_adv.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 96498364adc37886f336944969225767ebd8b7f9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jan 29 18:28:43 2018 +0100

    nimble/ll: Remove unnecessary assert
    
    It is ok to have adv_data NULL here since it may not be set for legacy
    or directed advertising and in this case it is assumed to have zero
    bytes length so won't be used.
    
    X-Original-Commit: 69285b3fd695189551c5125f1d49444947779fee

 nimble/controller/src/ble_ll_adv.c | 2 --
 1 file changed, 2 deletions(-)

commit 122ac01cd44615a3276b776c3bf2db4fe71d2373
Merge: 43ff6624 86ee60e2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 29 11:40:19 2018 +0100

    Merge pull request #768 from sjanc/dtm
    
    nimble/controller: Fix DTM test commands channel settings
    
    X-Original-Commit: 5ff6418c0c1c65da9398df2188df866a8ecd6795

commit 4919f5247a8ad0b4514a6d70e6da6677921973d8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 25 23:07:23 2018 +0100

    nimble/ll_sched: Minor coding style fix
    
    X-Original-Commit: 16c0054671f652c9eb543e3619c5bbf29103f697

 nimble/controller/src/ble_ll_sched.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e047d306136a9b1007f589d8dcef8e3c542880ae
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 25 23:06:34 2018 +0100

    nimble/ll_dtm: Fix for enabling clock on RX
    
    X-Original-Commit: 75863a690278e8b64f4a947dc0daf0f192ebc838

 nimble/controller/src/ble_ll_dtm.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 43ff662477d31bf244fbb41d5683ab6e159142c9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 22:53:37 2018 +0100

    nimble/phy: Fix build
    
    Broken by 7935e536 and ae064f0c2...
    
    X-Original-Commit: 99b9c123ae636328de8c96ef3625a35d4f49c879

 nimble/drivers/nrf51/src/ble_phy.c | 1 -
 nimble/drivers/nrf52/src/ble_phy.c | 2 ++
 2 files changed, 2 insertions(+), 1 deletion(-)

commit fd8a7e7bb477a8290d3af1afde54e8bccbad6da0
Merge: a00cdb97 5dc668f9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 22:26:29 2018 +0100

    Merge pull request #771 from andrzej-kaczmarek/nimble-phy-dev
    
    nimble: Various small PHY improvements
    
    X-Original-Commit: 79d1bee77f20c0a0a8a02e938a333c445140f876

commit 5dc668f92ccfda3c33cfea815b03abc0e0ad8e6e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 17:56:49 2018 +0100

    nimble/phy: Fix PCNF0 configuration
    
    We do not need to keep PCNF0 "base" value in RAM - it is predefined for
    each PHY.
    
    X-Original-Commit: 39e75ecbbac72c688848e3a9f9cbbab256c26a34

 nimble/drivers/nrf52/src/ble_phy.c | 37 +++++++++++++++++++------------------
 1 file changed, 19 insertions(+), 18 deletions(-)

commit f9c097815c0450b36bd59d9c6211294c8a8f27e0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 11:53:03 2018 +0100

    nimble/phy: Fix magic number
    
    X-Original-Commit: da66f82ee8b3c22422601122fde52ab2852e9964

 nimble/drivers/nrf52/src/ble_phy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7b4d320a4735fb8c1cdd2969ffdf1f323f717570
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 11:52:27 2018 +0100

    nimble/phy: Remove redundant code
    
    Packet pointer was probably increment to have payload word-aligned, but
    this does not seem to have any effect here as we do not have optimized
    memcpy for such case. Also, since there is no explicit call to memcpy
    GCC will also not be able to emit built-in optimized memcpy here (e.g.
    when doing os_membuf_copydata).
    
    X-Original-Commit: 282789d30457eb2500f0dfb1311a222274969fd1

 nimble/drivers/nrf52/src/ble_phy.c | 3 ---
 1 file changed, 3 deletions(-)

commit 08d43f0e18abe807bec2679b82b7e09e05bea36c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 16:52:11 2018 +0100

    nimble/phy: Use static mapping for channel index to RF freq
    
    X-Original-Commit: 7935e536065050e0bc21e3519ff1fe9b55832d8e

 nimble/drivers/nrf51/src/ble_phy.c | 30 +++++++----------------
 nimble/drivers/nrf52/src/ble_phy.c | 49 ++++++++++----------------------------
 2 files changed, 22 insertions(+), 57 deletions(-)

commit ad398d239ba3c8a32b59ebc6418b14e858adbf62
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 16:38:14 2018 +0100

    nimble/phy: Make some constant data an actual static const
    
    There's no need to keep packet offsets in RAM - these are constant.
    
    X-Original-Commit: ae064f0c2acc540457e91cfbe7a97da20a67443a

 nimble/drivers/nrf52/src/ble_phy.c | 12 ++++--------
 1 file changed, 4 insertions(+), 8 deletions(-)

commit a00cdb97ff3e5e52c63764be6229a8960ee3ed2b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 10:40:26 2018 +0100

    nimble/phy: Fix encryption on nRF52
    
    When txing an encrypted packed, encryption is started before PDU header
    is put in encryption buffer thus header in TX buffer is invalid and
    breaks connection.
    
    This regression was introduced in 333a4e9 which changed order of buffer
    operations.
    
    This patch fixes the problem by starting key-stream generation after
    PDU header is put in encryption buffer to make sure everything is in
    place when encryption starts. There is still enough time for encryption
    to be started before radio starts txing.
    
    X-Original-Commit: b4149c6f3bb5701956a2ac5e7860b0c72314afdb

 nimble/drivers/nrf52/src/ble_phy.c | 24 +++++++++++++++---------
 1 file changed, 15 insertions(+), 9 deletions(-)

commit f3db4a1195ba255945be0009fff03269b8ec8caa
Merge: 41dbe1dd 3455df84
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 26 11:41:50 2018 +0100

    Merge pull request #766 from andrzej-kaczmarek/nimle-ll-remfeat-fix
    
    nimble/ll: Fix HCI LE Read Remote Features command
    
    X-Original-Commit: 35d40c64c5c3275d8c4b52da73c9968e292c7dd9

commit 86ee60e22fcf170b6503e200c1b10f3abfcbb321
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jan 26 09:57:04 2018 +0100

    nimble/controller: Fix DTM test commands channel settings
    
    DTM HCI commands operate on RF channels instead of channel indexes.
    
    X-Original-Commit: 7e35c65cc4e937a62d8612d42916f40bd14bf179

 nimble/controller/src/ble_ll_dtm.c | 27 +++++++++++++++++----------
 1 file changed, 17 insertions(+), 10 deletions(-)

commit 3455df84a38ce5c842a870c4343cdebfd4e51fa7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 25 15:54:35 2018 +0100

    nimble/ll: Fix HCI LE Read Remote Features command
    
    Commit 04bf9592 removed automatic feature exchange procedure after
    connection when in slave role. This breaks HCI LE Read Remote Features
    command since it expected that this procedure is always started so it
    did not even try to start it, just sets bit in state machine that reply
    is pending.
    
    This patch fixes this regression by starting features exchange procedure
    if not already done.
    
    X-Original-Commit: 275df75126033341c2ab4d0385965397af62e171

 nimble/controller/src/ble_ll_conn_hci.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit 41dbe1dd65641513c661a3ec8210f35c469b22fe
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jan 25 15:40:55 2018 +0100

    nimble/controller: Fix DTM build
    
    X-Original-Commit: ab1bac7760f0c1f5f95c3c1e4f672153c37c69ee

 nimble/controller/src/ble_ll_dtm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit baff9ab513e7e68a8d49cf4ac2b8b5635f598e1b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jan 25 15:19:02 2018 +0100

    nimble/controller: Fix LE Test End Command return value
    
    From Core Specification:
    "This command is used to stop any test which is in progress. The
    Number_Of_Packets for a transmitter test shall be reported as 0x0000.
    The Number_Of_Packets is an unsigned number and contains the number of
    received packets."
    
    X-Original-Commit: 96127812aa2db70e9790519a28efdad4dc145deb

 nimble/controller/src/ble_ll_dtm.c | 1 -
 1 file changed, 1 deletion(-)

commit 21e6f10409f469aca18c274c12e0e3eaca2cd576
Merge: 1d0b0a94 3fc48eeb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 25 10:39:17 2018 +0100

    Merge pull request #755 from andrzej-kaczmarek/nimble-ll-mbuf
    
    nimble: mbuf optimization in controller
    
    X-Original-Commit: 997f9874d76429cb643cb3c471f68cd18457a815

commit 1d0b0a94a885e7d149cd0e4519b4f14abbaf065b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jan 24 17:35:38 2018 +0100

    nimble/gap: Fix setting long advertising data
    
    When fragmenting long advertising data, offset was advanced properly
    but ignored so we always set data from the beginning of mbuf in each
    fragment.
    
    Now we'll just consume data from mbuf and offset is no longer needed.
    mbuf is consumed anyway be callers.
    
    X-Original-Commit: 7c13301876584c377e17963e35e017f3bc3060ca

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit f9de28934fc04008876ad5c9364cd46102414321
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jan 24 16:45:33 2018 +0100

    nimble/gap: Change ext adv data API to consume mbufs
    
    Setting ext adv data will now consume mbuf regardless of result which
    is similar to many other APIs in Mynewt.
    
    X-Original-Commit: 17658312d24d7978b63be4dcb6c5f9a8c9596140

 nimble/host/src/ble_gap.c | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

commit 3fc48eeba0da9ecf3ea13fda83a54fd7edff3cc2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jan 22 15:02:08 2018 +0100

    nimble/phy: Allow ble_phy_tx without mbuf
    
    ble_phy_tx accepts PDU payload as mbuf which means that in some cases
    (e.g. when txing advertising packet) we need to allocate temporary mbuf
    for PDU payload which is instantly copied again to txbuf.
    
    This patch changes ble_phy_tx API to accept callback function instead
    of mbuf. This callback is called when payload should be copied to txbuf
    so we can copy data form wherever required or create them on-the-fly
    which can make whole process faster and save mbuf.
    
    Since there are still few places where an actual mbuf is txed, there is
    helper callback defined which preserves mbuf copy logic from previous
    ble_phy_tx implementation.
    
    Since new API is not backwards compatible this patch also changes code
    in adv/conn/scan state machines to benefit from new one-copy-less API.
    
    X-Original-Commit: 333a4e924552a033365c207ea7c2e159847e7ba4

 nimble/controller/include/controller/ble_ll.h  |   3 +
 nimble/controller/include/controller/ble_phy.h |   5 +-
 nimble/controller/src/ble_ll.c                 |  18 +++
 nimble/controller/src/ble_ll_adv.c             | 192 ++++++++++---------------
 nimble/controller/src/ble_ll_conn.c            |   4 +-
 nimble/controller/src/ble_ll_scan.c            |   3 +-
 nimble/drivers/native/src/ble_phy.c            |  12 +-
 nimble/drivers/nrf51/src/ble_phy.c             |  40 +++---
 nimble/drivers/nrf52/src/ble_phy.c             |  30 ++--
 9 files changed, 143 insertions(+), 164 deletions(-)

commit f5490b90d1f3f504446985282ae79e332ab235b2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jan 22 14:31:19 2018 +0100

    nimble/ll: Keep instance adv data in mbufs
    
    This patch removes static buffer for advdata in advertising SM and uses
    mbuf instead. This can save a lot of memory if we support multiple adv
    instances as we only allocate roughly (depends on pools configuration)
    the amount of memory needed for each instance separately.
    
    Previously each instance allocated the same amount of memory no matter
    if it was used or not.
    
    Similar change can be done for scanrsp later.
    
    X-Original-Commit: b40547230c0df9bd8d1c15aae0d50b1085009453

 nimble/controller/src/ble_ll_adv.c | 68 +++++++++++++++++++++++++++-----------
 1 file changed, 48 insertions(+), 20 deletions(-)

commit 5a2dd66484f5de7bd9c4e3f07069c41abf7467b3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jan 24 09:53:21 2018 +0100

    nimble/ll: Fix DTM build without 2M/Coded PHY enabled
    
    Error: repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_dtm.c:
    In function 'ble_ll_dtm_tx_sched_cb':
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_dtm.c:187:5:
    error: implicit declaration of function 'ble_phy_mode_set'; did you mean
    'ble_phy_reset'? [-Werror=implicit-function-declaration]
         ble_phy_mode_set(ctx->phy_mode, ctx->phy_mode);
         ^~~~~~~~~~~~~~~~
         ble_phy_reset
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_dtm.c: In
    function 'ble_ll_dtm_ctx_free':
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_dtm.c:346:5:
    error: implicit declaration of function 'ble_ll_xcvr_rfclk_stop'; did
    you mean 'ble_ll_sched_stop'? [-Werror=implicit-function-declaration]
         ble_ll_xcvr_rfclk_stop();
         ^~~~~~~~~~~~~~~~~~~~~~
         ble_ll_sched_stop
    cc1: all warnings being treated as errors
    
    X-Original-Commit: 12cb434b59e8991b7d5ed2652b347fb83be1e2b8

 nimble/controller/src/ble_ll_dtm.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 1895cf5c1be68e7afedbc71c8ccaa4a2efd4b7b1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jan 19 12:15:57 2018 +0100

    mesh: Check Heartbeat Pub count prior scheduling delayed work
    
    This check is needed to not schedule the delayed work if current
    message to be sent is the last heartbeat message.
    
    X-Original-Commit: 038539819e166b891355277c15e563dce2df959c

 nimble/host/mesh/src/cfg_srv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit dbda065e7fef26fb8f33a7f2f899716b8ffacb09
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jan 18 16:02:26 2018 +0100

    mesh: Reset Heartbeat Publication timer before sending message
    
    The timer should be reset before sending to ensure correct publication period.
    
    This patch allows to pass MESH/NODE/CFG/HBP/BV-02-C.
    
    X-Original-Commit: d4b84638df47e7ea21629e6919f547f5dcd47285

 nimble/host/mesh/src/cfg_srv.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit e91109e79f691b428b5a1f15b9dc826ac0f2fd9c
Merge: 3b6296dd 99bd6ea6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 18 14:01:10 2018 +0100

    Merge pull request #742 from rymanluk/hci_test_cmd
    
    nimble/ble_ll: Add support for HCI Test commands
    
    X-Original-Commit: 1ce6bb0cb4605716f05ef87bbaf99f65315092be

commit 3b6296ddcd3f7d1476bb60c71210048dc4269412
Merge: 11169103 e837fa77
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jan 18 10:38:18 2018 +0100

    Merge pull request #741 from sjanc/non-conn-adv
    
    nimble/host: Allow low interval on non-connectable advertising
    
    X-Original-Commit: afa26647cc6fa11afca999711e506d0ca4ea3fb8

commit 99bd6ea62834c42cb4cce34b638695b5f4279c2e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Dec 22 14:21:01 2017 +0100

    nimble/ble_ll: Add support for HCI Test commands
    
    With this patch, by setting BLE_LL_DIRECT_TEST_MODE flag it is possible
    to use HCI transiver and receiver comands as specified in Bluetooth 5
    specification.
    
    X-Original-Commit: 0899dc0d36c4db20a63bd657cd9066dfec327e3e

 nimble/controller/include/controller/ble_ll.h      |   1 +
 .../controller/include/controller/ble_ll_sched.h   |   5 +
 nimble/controller/include/controller/ble_phy.h     |   5 +
 nimble/controller/src/ble_ll.c                     |  36 ++
 nimble/controller/src/ble_ll_dtm.c                 | 494 +++++++++++++++++++++
 nimble/controller/src/ble_ll_dtm_priv.h            |  36 ++
 nimble/controller/src/ble_ll_hci.c                 |  21 +
 nimble/controller/src/ble_ll_sched.c               |  60 +++
 nimble/controller/src/ble_ll_supp_cmd.c            |  17 +
 nimble/controller/syscfg.yml                       |   5 +
 nimble/drivers/nrf52/src/ble_phy.c                 |  13 +
 nimble/host/src/ble_hs_hci_cmd.c                   |   4 +-
 nimble/include/nimble/hci_common.h                 |   8 +-
 nimble/src/hci_common.c                            |   4 +-
 14 files changed, 701 insertions(+), 8 deletions(-)

commit 111691034d92c80b34b2aa89374682b24ab16e8f
Merge: b7dca4f7 17a663eb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 17 18:07:53 2018 +0100

    Merge pull request #736 from rymanluk/att_fix
    
    nimble/att: Fix for PTS issue reported in MYNEWT-886
    
    X-Original-Commit: 6e3e2c79f989f5a348d9d53e125aec5e5105095b

commit e837fa770445dbf68ebeb3b135d5b357afd59d28
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 17 15:05:08 2018 +0100

    nimble/host: Allow low interval on non-connectable advertising
    
    This limiation was removed in BT5 spec so there is no need to keep this
    when build with nimBLE controller. Since nimBLE host doesn't verify
    controller version for now we allow this on combined build only.
    
    X-Original-Commit: 914b2e1e3b5e80ca764e18ff3637a2d0b345367d

 nimble/host/src/ble_hs_hci_cmd.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit 17a663eb0dfc203e4497f05cf0aa0bdc7fdffab5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 16 19:46:34 2018 +0100

    nimble/att: Fix response for unknown opcode
    
    Fixes MYNEWT-886
    
    With this patch if unknown ATT request come to ATT channel, Nimble
    replies with ATT Error Response with error code Request Not Supported.
    
    That should fix GATT/SR/UNS/BI-01-C
    
    X-Original-Commit: 768633db326ebb8596181cb563028bca2f38d2ef

 nimble/host/src/ble_att.c               | 22 +++++++++++++++++++++-
 nimble/host/src/ble_att_priv.h          |  3 +++
 nimble/host/src/ble_att_svr.c           |  2 +-
 nimble/host/test/src/ble_att_svr_test.c | 27 +++++++++++++++++++++++++++
 4 files changed, 52 insertions(+), 2 deletions(-)

commit 714d4d2a25efa0e56b87bbc3a84ff78de5fb300e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 16 19:43:30 2018 +0100

    nimble/att: Fix error code when accessing characteristics
    
    With this patch BLE_HS_ENOSUP is used only when given ATT operations is
    not supported. Otherwise it is BLE_HS_EREJECT.
    It affects only test code.
    
    X-Original-Commit: b854f39fbe03fe1ec16b6c7c2403890f17e678d4

 nimble/host/src/ble_att_svr.c           | 6 +++---
 nimble/host/test/src/ble_att_svr_test.c | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit b7dca4f760cca093b7e365a520dc9d071963a291
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 16 12:35:24 2018 +0100

    nimble/ll: Fix calculation of adv pdu length
    
    This makes use of symbols to make calculations clear.
    
    X-Original-Commit: 6fc22367e19e4c1ae12958e54cafd0b78372f707

 nimble/controller/src/ble_ll_adv.c | 8 ++------
 1 file changed, 2 insertions(+), 6 deletions(-)

commit 75cbd2ba54c2620152b22c933c00b88e7cb74489
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 16 12:35:24 2018 +0100

    nimble/ll: Fix calculation of scan rsp length
    
    This makes use of symbols to make calculations clear.
    
    X-Original-Commit: a5f69610529dad2dd5827301edfe433597cf2eb8

 nimble/controller/src/ble_ll_adv.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit 716f629da816b0592c10866701c717fc3ea1cc9b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 16 12:38:45 2018 +0100

    nimble/ll: Fix calculation of connect rsp length
    
    This makes use of symbols to make calculations clear.
    
    X-Original-Commit: fccddb22920e01c26079863e4a776148a3105733

 nimble/controller/src/ble_ll_adv.c | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit 0b0fa392fa7e9226ff6eef7e0c2ab6cbd5e11bd5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 16 11:35:48 2018 +0100

    nimble/ll: Fix helpers to calculate aux adv and scan rsp length
    
    Helper functions to calculate length of aux packets return PDU length
    instead of payload length. This makes TX time calculation incorrect and
    can also overflow return value since PDU length is up to 257 bytes
    (outside uint8_t range),
    
    X-Original-Commit: 2a98773ed5c0cef9df77b7029807c7f232c1bb43

 nimble/controller/include/controller/ble_ll.h |  4 ++++
 nimble/controller/src/ble_ll_adv.c            | 32 ++++++++++++++-------------
 2 files changed, 21 insertions(+), 15 deletions(-)

commit d69e961dfa1553c3dc4753574b28f5d2e35efe26
Merge: 5a9801bd 88d3b3c7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 16 10:44:10 2018 +0100

    Merge pull request #719 from andrzej-kaczmarek/nimble-hci-trans
    
     nimble: Add meta-package for HCI transports
    
    X-Original-Commit: afdff9be35f3227274bb25fbf903541e656a5776

commit 5a9801bdf8877320e709438cf3370af3710194bd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 15 17:32:53 2018 +0100

    nimble/transport: Fix typo in UART transport
    
    X-Original-Commit: 29c5182089491d76a4ab373e2e800e8ed0f71056

 nimble/transport/uart/src/ble_hci_uart.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit efaad20099c9f52a02143db1d08298a900a68dae
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 29 19:40:57 2017 -0800

    BLE Host - flow control.
    
    X-Original-Commit: 1fb89fd97abe73c06e7e360d838e2b2c4f01d0cb

 nimble/host/src/ble_gap.c                  |   1 +
 nimble/host/src/ble_hs.c                   |  52 ++++++-
 nimble/host/src/ble_hs_conn_priv.h         |   8 +
 nimble/host/src/ble_hs_flow.c              | 240 +++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_flow_priv.h         |  36 +++++
 nimble/host/src/ble_hs_hci_cmd.c           |  47 +++++-
 nimble/host/src/ble_hs_hci_priv.h          |   7 +-
 nimble/host/src/ble_hs_priv.h              |   3 +
 nimble/host/src/ble_hs_startup.c           |   3 +
 nimble/host/syscfg.yml                     |  29 ++++
 nimble/include/nimble/ble.h                |   3 +
 nimble/include/nimble/ble_hci_trans.h      |  15 ++
 nimble/include/nimble/hci_common.h         |  35 +++++
 nimble/transport/emspi/src/ble_hci_emspi.c |  47 ++++--
 nimble/transport/ram/src/ble_hci_ram.c     |  10 ++
 nimble/transport/uart/src/ble_hci_uart.c   |  50 ++++--
 16 files changed, 547 insertions(+), 39 deletions(-)

commit 2f3362372ef05f13753e9ce193bc996b6d5a63a0
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 29 19:36:35 2017 -0800

    emspi transport - clarify that it is host-only.
    
    X-Original-Commit: 7dc5d328677931d106fb958120ed333361e97130

 nimble/transport/emspi/src/ble_hci_emspi.c | 17 +++--------------
 nimble/transport/emspi/syscfg.yml          |  5 ++++-
 2 files changed, 7 insertions(+), 15 deletions(-)

commit 88d3b3c7c13834541ea4ae22085ad2b8d5f47d2c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 9 12:15:33 2018 +0100

    nimble: Add meta-package for HCI transports
    
    This patch makes net/nimble/transport a separate meta-package to allow
    select HCI transport via syscfg instead of explicitly adding dependency
    to particular transport package.
    
    The advantage of this approach is that the same application can be used
    on multiple targets, regardless of controller being used on target BSP.
    It is also fully backwards compatible since it is still possible to do
    it "the old way", i.e. add explicit dependency to particular transport
    package instead of meta-package.
    
    By default, combination of RAM transport and NimBLE controller is used
    which is default configuration for most existing apps.
    
    Each availble transport package has its own syscfg value:
    - BLE_HCI_TRANSPORT_EMSPI for net/nimble/transport/emspi
    - BLE_HCI_TRANSPORT_RAM for net/nimble/transport/ram
    - BLE_HCI_TRANSPORT_SOCKET for net/nimble/transport/socket
    - BLE_HCI_TRANSPORT_UART for net/nimble/transport/uart
    
    In addition there's dedicated value to use built-in NimBLE controller,
    which is most common usage and thus default setting:
    - BLE_HCI_TRANSPORT_NIMBLE_BUILTIN
    
    This is virtually the same as enabling RAM transport and adding package
    with NimBLE controller ( net/nimble/controller) manually, but since
    package is pulled by syscfg value it can be easily overriden in target
    settings.
    
    X-Original-Commit: e1f2888ab3d999a8a908bc1b5b843c17e13ea9ad

 nimble/transport/pkg.yml    | 42 ++++++++++++++++++++++++++++++++++++++++++
 nimble/transport/syscfg.yml | 39 +++++++++++++++++++++++++++++++++++++++
 2 files changed, 81 insertions(+)

commit 36779533ba4026dab97a71fc301a3712b648da3b
Merge: 655e15f0 22de9c0b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jan 11 09:34:28 2018 +0100

    Merge pull request #722 from rymanluk/some_mesh_fixes
    
    nimble/mesh: Minor mesh fixes
    
    X-Original-Commit: 0082f9dc1d60a54186d04104b5d67c4919357663

commit 655e15f0823aebb3b8e87ff8d9581bfb8308f2c0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jan 10 10:58:43 2018 +0100

    nimble/controller: Make sure random address is set corretly
    
    When host sets random address when advertising extensions are enabled,
    we need to make sure that same address is used for instance 0 which is
    legacy advertising instance
    
    X-Original-Commit: 3cd61b399e0d5dc8ce556b9f8aa23e62b641456a

 nimble/controller/src/ble_ll_hci.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit 22de9c0bbfb31ca70d982043da926d51f573e4f4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 2 14:10:07 2018 +0100

    blemesh: Fix compiler error when building without PB_ADV
    
    Error: repos/apache-mynewt-core/net/nimble/host/mesh/src/prov.c: In
    function 'bt_mesh_prov_reset_link':
    repos/apache-mynewt-core/net/nimble/host/mesh/src/prov.c:1590:9:
    error:
        'struct prov_link' has no member named 'rx'
             link.rx.buf = bt_mesh_proxy_get_buf();
    
    X-Original-Commit: 1fe74b20f54f7e0ab9e6f62e05234cd5a1dc4c22

 nimble/host/mesh/src/prov.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 51104af13cacde99f5c7db53cdfa54869a2552fd
Merge: 93d58b04 3829cc35
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Dec 22 10:32:39 2017 +0100

    Merge pull request #710 from andrzej-kaczmarek/nimble-iphone-fix
    
    nimble/ll: Do not initiate features xchg as a slave
    
    X-Original-Commit: 4df0a173a97d2556a7f5f8997822e5f69a126e19

commit 3829cc357019a254095de79f37d3ab710e95bbbe
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Dec 20 13:42:05 2017 +0100

    nimble/ll: Do not initiate features xchg as a slave
    
    This patch removes initial feature xchg from controller when connected
    as a slave due to observed problems with recent iPhones (8 and X).
    
    X-Original-Commit: 04bf95924537757ff8516a275297ea6f2a6d4393

 nimble/controller/src/ble_ll_conn.c | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

commit 93d58b045a12e27b5de8ab2a0d36e4aa503469fd
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Dec 18 14:13:07 2017 -0800

    BLE Host - Don't crash if no store package.
    
    Prior to this change: the host asserted that IRK restoration succeeds at
    sync time.  A common reason for failure was the lack of any host store
    package in the build.
    
    After change: If IRK restoration at startup fails for any reason, a
    message is logged and the app continues running.
    
    X-Original-Commit: 3e6ff4de76f6cc486ad7c7a545c3f8b4aac01e82

 nimble/host/src/ble_hs.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 5dc94ac602a8569ff979d0e7acb805699a01c3fc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Dec 15 11:33:55 2017 +0100

    nimble/ll: Remove unused includes
    
    X-Original-Commit: ca72204bbd80b02df31fb72561ccd9a22f19e414

 nimble/controller/src/ble_ll_adv.c  | 1 -
 nimble/controller/src/ble_ll_conn.c | 1 -
 nimble/controller/src/ble_ll_scan.c | 1 -
 3 files changed, 3 deletions(-)

commit b0b7787da2ff81a0439fa3f31674c782daec6ead
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Dec 5 14:48:32 2017 +0100

    nimble/host: Increase HCI command timeout
    
    1 sec is not enough sometimes, let's make it 2 secs - the same value is
    used in e.g. Linux Kernel.
    
    X-Original-Commit: 185e2961e7271227d4b35db3b4e427edd2d6cd66

 nimble/host/src/ble_hs_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6de52d252a9a463cdeb74a63aeff703f4c75d074
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Dec 5 10:20:27 2017 +0100

    nimble/host: Fix invalid connection handle usage
    
    '0' is a valid connection handle, we need to return proper symbol if
    there is no connection found.
    
    X-Original-Commit: e5a7f8ac1b9b13018c01d2f69b08d20bc6f33aa9

 nimble/host/src/ble_att.c   | 2 +-
 nimble/host/src/ble_l2cap.c | 2 +-
 nimble/host/src/ble_sm.c    | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit f91703f6db4b7c35cc84132ed99ee01347199413
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Dec 12 15:56:22 2017 +0100

    mesh: Fix build issue
    
    repos/apache-mynewt-core/net/nimble/host/mesh/src/health_cli.c:49:16:
    error: dereferencing pointer to incomplete type 'struct
    bt_mesh_health_cli'
      if (health_cli->op_pending != OP_HEALTH_FAULT_STATUS) {
    
    X-Original-Commit: 7af931a2bafab87db4cf3ce3ce96907c3cd914ef

 nimble/host/mesh/src/health_cli.c | 1 +
 1 file changed, 1 insertion(+)

commit bf590d764dfcc22cf37af4da48bafca8652969cf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 8 12:12:19 2017 +0100

    mesh: Fix using Friend and LPN configs
    
    X-Original-Commit: 77e3ef2c42bb1f051bcede31676f7b99825091db

 nimble/host/mesh/src/lpn.c | 2 +-
 nimble/host/mesh/src/net.c | 8 ++++----
 2 files changed, 5 insertions(+), 5 deletions(-)

commit eeafd12dbdffae503e04a068c26f88f5aab2900f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 8 10:55:45 2017 +0100

    mesh: Fix typo in Kconfig help message
    
    300 * 100 ms = 30000 ms = 30 s
    
    X-Original-Commit: 9ec7280b99117b5b245193f703c5403e853c01cf

 nimble/host/mesh/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 19c9525fc4e7c1a081f6067122d79a339abc5c4a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 12:16:18 2017 +0100

    mesh: Add debug check that os_mbuf is not chained
    
    Mesh is designed to not use mbuf chains. This patch adds a debug check
    to ensure that we don't create a chain at some point when defining
    a mesh message.
    
    X-Original-Commit: 99b016c86b426bf07ccb75e2dcd2eb4ce10ba3ab

 nimble/host/mesh/include/mesh/glue.h |  8 +++++++-
 nimble/host/mesh/src/glue.c          | 16 +++++++++++++++-
 2 files changed, 22 insertions(+), 2 deletions(-)

commit 91fd57f8aed33836311b022dc31e1960c1a15972
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 12:15:48 2017 +0100

    mesh: Reformat defines to improve readability
    
    X-Original-Commit: dffecb53f631e99412af0ac0f0f05f1408be8471

 nimble/host/mesh/include/mesh/glue.h | 41 ++++++++++++++++++------------------
 1 file changed, 21 insertions(+), 20 deletions(-)

commit d8fc5cbb27b62b15d373654ae865211a6c12e20d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 12:01:33 2017 +0100

    mesh: Fix friend mempool initialization
    
    X-Original-Commit: d73bcf3ef57ff0bdd38b42d5c1ef8e085f95fc94

 nimble/host/mesh/src/friend.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit f8c351d04b2a50b2db3b2059ae1fc5985d998281
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:28:17 2017 +0100

    mesh: Proxy: Don't try to advertise when it's not possible
    
    If we have the maximum number of supported connections, then it
    doesn't make sense to try to do connectable advertising.
    
    X-Original-Commit: b7f36951452624b5f5fa18f176f32925e07ccd3f

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/proxy.c         | 17 ++++++++++++++---
 2 files changed, 15 insertions(+), 3 deletions(-)

commit 06f4b2578a272a2c7f4d1968b0cc9bd89196f8c5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:23:14 2017 +0100

    mesh: Proxy: Fine-tune subnet advertising rotation
    
    Create a slightly smarter algorithm for choosing how long to advertise
    each subnet. This is particularly important for the mesh_shell app,
    since it uses a 10 second NODE_ID_TIMEOUT, meaning starting Node ID
    advertising through user interaction would only succeed in advertising
    one subnet (due to this being configured to 10 seconds).
    
    X-Original-Commit: ae81ee5336cd087597cbfbd9f22659cf27d86195

 nimble/host/mesh/src/proxy.c | 19 +++++++++++++++++--
 1 file changed, 17 insertions(+), 2 deletions(-)

commit 9c8a364d52ab3d1685dc80a0b3df48820ddc32f7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:22:49 2017 +0100

    mesh: Suppport multiple subnets for app-triggered Node ID
    
    Mesh Profile Specification 1.0 section 7.2.2.2.3:
    
    "When the server starts advertising as a result of user interaction,
    the server shall interleave the advertising of each subnet it is a
    member of"
    
    X-Original-Commit: bb447130d25d3b1e0aa8e603e544ce8debc2d376

 nimble/host/mesh/src/proxy.c | 27 +++++++++++++++------------
 1 file changed, 15 insertions(+), 12 deletions(-)

commit a2c22a93087424bf781a40c4e899f28a27ea8f96
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:22:15 2017 +0100

    mesh: Prioritize subnets with Node ID
    
    Node ID advertising is short lived, so it's important to make sure
    that subnets that get it enabled are first in queue to start
    advertising.
    
    X-Original-Commit: 5d437928727ee9fec39062b6e720055106152f50

 nimble/host/mesh/src/proxy.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 2110b8cc3b9c3d3f4b62c2e1cfb57a292385d776
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:19:15 2017 +0100

    mesh: Add helpers for starting/stopping Node ID
    
    We'll soon extend the start functionality with a bit more stuff
    (prioritizing the started subnet), so in order to avoid excessive code
    duplication, create helpers for these actions.
    
    X-Original-Commit: 1a35181b41d64a00bf3d5d50516a410f7c66cb78

 nimble/host/mesh/src/cfg_srv.c | 10 ++++++----
 nimble/host/mesh/src/proxy.c   | 18 ++++++++++++++----
 nimble/host/mesh/src/proxy.h   |  3 +++
 3 files changed, 23 insertions(+), 8 deletions(-)

commit 013911aa2438d5b0d10249c461b93dc53d118936
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:18:21 2017 +0100

    mesh: Add Proxy advertising support for multiple subnets
    
    Until now the proxy server code would only advertise with the first
    subnet. Introduce tracking of what the last advertised subnet was, and
    give each subnet 10 seconds of advertising at a time.
    
    X-Original-Commit: c85f4ef1b2240c57df86bf138c2bf3454f7d108b

 nimble/host/mesh/src/proxy.c | 68 ++++++++++++++++++++++++++++++++++++++------
 1 file changed, 59 insertions(+), 9 deletions(-)

commit 046fb1c50ca08a0b1c62a75cfccb424af9046c60
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:17:32 2017 +0100

    mesh: Add support for sending NetKey Add message
    
    Add configuration client model support for NetKey Add message, as well
    as a mesh shell command for calling the new API.
    
    X-Original-Commit: ece31d29648b971c3253a0153f94e075786ff450

 nimble/host/mesh/include/mesh/cfg_cli.h |  3 ++
 nimble/host/mesh/src/cfg_cli.c          | 75 +++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c            | 43 +++++++++++++++++++
 3 files changed, 121 insertions(+)

commit ef6213121f0fcadc82a45635086e47f71e692162
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Dec 7 10:05:25 2017 +0100

    mesh: Fix relaying from GATT to Advertising
    
    The logic for choosing to relay from the GATT bearer to the
    advertising bearer was still buggy. This patch refactors the logic to
    a separate helper function to make it clearer.
    
    X-Original-Commit: 45d0c31d25701fccb40c7a8a8c47399613deab3f

 nimble/host/mesh/src/net.c | 26 ++++++++++++++++++++------
 1 file changed, 20 insertions(+), 6 deletions(-)

commit 7c1d6b24b5302d225341e77a299564d5d8aad729
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 11:35:07 2017 +0100

    mesh: Fix creating advertising packets from pool
    
    The user data is a pointer (4 bytes) to struct bt_mesh_adv
    
    X-Original-Commit: 44d1f776fc1ba3b5668ac5b2792dcdb6b4a9d00b

 nimble/host/mesh/src/adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 084d592e3441d2678acacc69e0fe0779a75e6920
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 09:51:51 2017 +0100

    mesh: Fix copy-paste mistake in log message
    
    X-Original-Commit: c7267416eb0afd9b197d1967c021c34071eb565d

 nimble/host/mesh/src/cfg_cli.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 24ffc14e222acf0a14f83b88c160dbbb0ef86a6a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 09:51:26 2017 +0100

    mesh: shell: Fix AppKey Add command handler
    
    The command handler already has support for decoding from hex, however
    it was not using the decoded value when calling the client API.
    
    X-Original-Commit: 1fa3239e79d261943e7bd783b5e0437f1f7dc072

 nimble/host/mesh/src/shell.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 25111a3a3f314fd5f2ed493a0dbd793681a76989
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 09:51:02 2017 +0100

    mesh: Fix format specifier for s32_t
    
    X-Original-Commit: e4af4232e9f9677904ad694a75ba9f777ba267c1

 nimble/host/mesh/src/proxy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 82e1225959b61e04e6daf6e8bf3a8d3563039b7c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 09:50:26 2017 +0100

    mesh: Fix using the correct transmit state
    
    If relaying is not supported, or disabled, the Relay Transmit state
    will normally be 0, which is not what we want to use when proxying out
    packets from GATT clients. The bt_mesh_net_relay() function is also
    used for sending out locally originated packets, in which case the
    Relay Retransmit state is also the wrong one to use (the Network
    Transmit state should be used instead).
    
    This patch makes sure we only use the Relay Retransmit state for
    packets originating from the advertising bearer, and for all other
    packets use the Network Transmit state.
    
    X-Original-Commit: 12faffe6e790f74ac11f9ffd6e8ff171abc7d138

 nimble/host/mesh/src/net.c | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit 712cc4ccaf246a32ee03867531d8a21f774c0e24
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 09:49:52 2017 +0100

    mesh: Fix relaying conditions for Adv & GATT bearers
    
    The bt_mesh_net_relay() function was missing several important checks
    for whether a PDU should be relayed or not. In particular, it would
    relay a packet from adv to adv even if the Relay state was set to
    disabled, as long as GATT Proxy was set to enabled. The code would
    also relay packets to the GATT Proxy bearer if the Relay state was set
    to enabled but GATT Proxy was set to disabled. This patch addresses
    both of these issues.
    
    X-Original-Commit: ab8e838e758669db03f34e7fac0dbae421ce9971

 nimble/host/mesh/src/net.c | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

commit 2a2d61d6cda37ca6a9b5a5290f6020af02fa5ff4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 5 09:47:19 2017 +0100

    mesh: Fix changing Relay state from Not Supported (0x02)
    
    If the Relay state is set to Not Supported (0x02) the Config Relay Set
    message should not change the state, rather just return its current
    value.
    
    X-Original-Commit: b0bd10f423eb3d447165fc54c7ea394bf3ac9377

 nimble/host/mesh/src/cfg_srv.c | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

commit fb2cfe47fe88ed7eac77d8a806e6c86668e97eae
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 14:37:22 2017 +0100

    mesh: Fix beacon cache handling
    
    The beacon cache handling was severely broken in the way that the
    cache_add() function was incorrectly mapping net_idx to array index,
    which could have lead to array overflows.
    
    To fix this, while also cleaning things up, move the cache to the
    actual bt_mesh_subnet struct. This e.g. lets us avoid having to track
    the net_idx twice.
    
    X-Original-Commit: 46ba2634302b74087b6e6744b99ec86ad73abf75

 nimble/host/mesh/src/beacon.c | 22 ++++++++--------------
 nimble/host/mesh/src/net.h    |  2 ++
 2 files changed, 10 insertions(+), 14 deletions(-)

commit af3e945953e2aebcce68c5e4e9fd06471f0f3bc2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 14:36:39 2017 +0100

    mesh: Fix setting an upper limit on beacon interval
    
    https://www.bluetooth.org/errata/errata_view.cfm?errata_id=9807
    
    "If the computed Beacon Interval is less than 10 seconds, it should be
    set to 10 seconds. If the computed Beacon Interval is greater than 600
    seconds, it should be set to 600 seconds."
    
    The lower limit is already covered by how frequently the delayed work
    callback gets called, so we just need enforce the 600 second maximum.
    
    X-Original-Commit: 6ecbdd620359e69c6026a618b791a6b81437b7b9

 nimble/host/mesh/src/beacon.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 362858b3a9c1c13c239e44d492080854ea136ab7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 14:35:19 2017 +0100

    mesh: Fix Proxy compilation
    
    X-Original-Commit: da5fdc3609faa0398f65bfcff745ad9e3cf85474

 nimble/host/mesh/src/prov.c  |  2 +-
 nimble/host/mesh/src/proxy.c | 10 ++++++----
 2 files changed, 7 insertions(+), 5 deletions(-)

commit 03c37faf4769d7f71a2b28d46dbaea98976fd5c2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:50:32 2017 +0100

    mesh: Fix sending beacons to Friend Queue & GATT clients
    
    Whenever there's a security change (Key Refresh or IV Update) we
    should immediately send beacons to any Friend Queues or connected GATT
    clients. Introduce a helper function to do this, and make sure it's
    called from all places that change the Key Refresh or IV Update
    states.
    
    This fixes test case MESH/SR/PROX/PB-12-C.
    
    X-Original-Commit: 9560c36b11aeb16db0592a7b49a80d21a8bbaa1d

 nimble/host/mesh/include/mesh/glue.h | 22 +++++++++++++---------
 nimble/host/mesh/src/beacon.c        | 15 ++++++---------
 nimble/host/mesh/src/net.c           | 20 ++++++++++++++++----
 nimble/host/mesh/src/net.h           |  2 ++
 nimble/host/mesh/src/proxy.c         | 11 +++++++++++
 nimble/host/mesh/src/transport.c     |  4 +++-
 6 files changed, 51 insertions(+), 23 deletions(-)

commit 61397f8159cb9c594b28cce8ab6fc0c4787c4542
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:47:42 2017 +0100

    mesh: Fix logging mesh addresses
    
    Addresses are 16-bit and not 8-bit.
    
    X-Original-Commit: 4158bee21e7f18117b7675ea31b4492452d0d07d

 nimble/host/mesh/src/proxy.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit ebf291a98e4300b092c995f66662d940cbae473c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:47:16 2017 +0100

    mesh: Clearly document the magic 18 byte minimum length
    
    This makes it clear why 18 is a valid minimum network PDU length to
    enforce. This is particularly important since as of writing this patch
    there's at least one PTS test case which sends too small PDUs, which
    could potentially lead to people thinking the implementation is at
    fault (it's not).
    
    X-Original-Commit: 91b8e2948d8bbe6e3eeabebfc3e91db40e2f371b

 nimble/host/mesh/src/net.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit a0db70a2f725515a1aaed5452e6422258354f36b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:46:13 2017 +0100

    mesh: Introduce API for clearing the RPL
    
    Some Transport Layer tests (MESH/NODE/TNPT/BV-13-C in particular)
    require manual clearing of the RPL. Introduce an API for it as well as
    a command to the mesh shell to call the API.
    
    X-Original-Commit: ef2f132eaae0494da39e4a68bc27c9abc95cfea5

 nimble/host/mesh/src/shell.c     | 7 +++++++
 nimble/host/mesh/src/transport.c | 6 ++++++
 nimble/host/mesh/src/transport.h | 2 ++
 3 files changed, 15 insertions(+)

commit ed40ac1c633d7cdbc3c65d7e77e5df1ea224334d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:43:41 2017 +0100

    mesh: Fix Replay Protection List checking
    
    If we the stored RPL entry was for an old IV Index, and the received
    PDU is for a new IV Index we should not be comparing the sequence
    number (as it's by definition always greater than the old one).
    
    X-Original-Commit: a8ccaf398dffe142fd3e82ae11a4dc0382df366e

 nimble/host/mesh/src/transport.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 8595ceb59cc9e892ebf27e5a81dcede87cb0ce25
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:43:09 2017 +0100

    mesh: Fix disconnecting clients when disabling GATT Proxy
    
    Section 4.2.11 of the Mesh Profile Specification 1.0 states:
    
    "Upon transition from GATT Proxy state 0x01 to GATT Proxy state 0x00
    the GATT Bearer Server shall disconnect all GATT Bearer Clients."
    
    This also makes test case MESH/SR/MPXS/BV-08-C pass.
    
    X-Original-Commit: 8dc82953fc72c7d491a565c9a9cc27df74e1d869

 nimble/host/mesh/src/cfg_srv.c |  6 ++++++
 nimble/host/mesh/src/proxy.c   | 30 ++++++++++++++++++++----------
 nimble/host/mesh/src/proxy.h   |  1 +
 3 files changed, 27 insertions(+), 10 deletions(-)

commit 228e89a662ef0302c2ac7c7686df6cbee6d82bd1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:40:27 2017 +0100

    mesh: Fix initializing Node ID start time
    
    The bt_mesh_proxy_identity_enable() function was missing a line to
    properly initialize the start time for Node Identity advertising.
    Without it this public function wouldn't work as intended.
    
    X-Original-Commit: 4e27fb728e30720b5ac912f5b0ca9b8c1564238d

 nimble/host/mesh/src/proxy.c | 1 +
 1 file changed, 1 insertion(+)

commit c58b75d26537c728d9a9b43cc65a70e4b9bcc2ad
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:38:46 2017 +0100

    mesh: Fix GATT Proxy & Node Identity state binding
    
    Section 4.2.11.1 of the Mesh Profile specification 1.0 states:
    
    "When the GATT Proxy state is set to 0x00, the Node Identity state for
    all subnets shall be set to 0x00 and shall not be changed."
    
    When the proxy state has been changed we also need to wake up the
    advertising module to make sure we do the right kind of advertising.
    
    X-Original-Commit: 5a16f06275cc95d430dc5bb23a2262a758a14678

 nimble/host/mesh/src/cfg_srv.c | 25 ++++++++++++++++++++++++-
 1 file changed, 24 insertions(+), 1 deletion(-)

commit 6f7b712192e789054b833a6a5da3c4324e222777
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:37:27 2017 +0100

    mesh: Deliver TTL=1 PDUs only to the local net interface
    
    Section 3.4.5.2 in the Mesh Profile Specification (1.0) states:
    
    "The output filter of the interface connected to advertising or GATT
    bearers shall drop all messages with TTL value set to 1."
    
    Also: https://www.bluetooth.org/errata/errata_view.cfm?errata_id=9811
    
    Note that this is specifically 1 and not 0, since e.g. Friend PDUs
    always go out with TTL 0.
    
    Another noteworthy thing is that the way this has to be implemented is
    slightly contrary to how it's presented in the specification (both in
    the text as well as the Message processing flow diagram in section
    3.11. If this was implemented following the spec to its word, then any
    PDU received over GATT or Advertising with TTL 2 would never be
    relayed (since the TTL would be 1 when the PDU gets rerouted back to
    the bearer). This would be both counterintuitive to the intended
    purpose of the TTL, and would also be contrary to the test
    specification (see Test Procedure step 1 in MESH/NODE/RLY/BV-01-C).
    
    X-Original-Commit: cde7c1e6f6264e486a80851a5ef0f7189de55ecb

 nimble/host/mesh/src/net.c | 31 ++++++++++++++++++++++++++-----
 1 file changed, 26 insertions(+), 5 deletions(-)

commit a6f469f39d23d81a6cf7863f30e8a77e669513b1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:34:28 2017 +0100

    mesh: Remove unnecessary variable
    
    Most places in bt_mesh_friend_req() used rx->sub (which is already
    quite short in itself), so just remove the only remaining user and the
    helper variable itself.
    
    X-Original-Commit: 763f526f0ce520fe420035d525055bff5dd7b6fe

 nimble/host/mesh/src/friend.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 24b948b931e6c8ee1f7bcba683cd859c43c62b8c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:33:30 2017 +0100

    mesh: Fix Friend messaging state tracking
    
    There were several issues with the code:
    
      - queue_size wasn't properly kept up to date, leading to erroneous
        buffer discarding logic.
    
      - Poll timeout when there were buffers in the Friend Queue didn't
        work because we didn't track if there'd been a preceding request
        for messages or not (hence the added pending_req variable).
    
      - We would overwrite the recv_delay timer if there was another
        request while the previous one was still sending (a likely scenario
        if we send out multiple advertising events per packet).
    
      - We weren't canceling the sending of a buffer if the Friendship was
        suddenly cleared.
    
    X-Original-Commit: 7a81acafddc78b44e9751d4c2ba678d9bff13a66

 nimble/host/mesh/src/friend.c | 82 ++++++++++++++++++++++++++++---------------
 nimble/host/mesh/src/net.h    |  1 +
 2 files changed, 54 insertions(+), 29 deletions(-)

commit 5481f79d7682293fa8b6154c3c87637342ad7002
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:32:07 2017 +0100

    mesh: Log information about the on-behalf-of flag
    
    X-Original-Commit: 12f86834edd55118bf2bee86bcfe3e5c0cc9873f

 nimble/host/mesh/src/transport.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit beb85cb4691cb78abcc1fded881bec3e732bb0c9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:31:42 2017 +0100

    mesh: Reduce logging clutter for LPN lookups
    
    The logs for looking up LPNs were spamming the console a bit too much.
    
    X-Original-Commit: 16ce99a33298de7dda44ae8260386a8243a9de98

 nimble/host/mesh/src/friend.c | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit f1307f675911bdd7f09875240177dacb4218b830
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:31:01 2017 +0100

    mesh: Fix looking up existing friendship contexts
    
    When receiving Friend Offers we should also consider unestablished
    contexts, and simply start from the beginning if that happens.
    
    X-Original-Commit: 06bfd7830da3e4faed81becf7002dfb24df60a66

 nimble/host/mesh/src/friend.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 560a722a676455a7273059c074e1856ce5eda624
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:30:33 2017 +0100

    mesh: Fix clearing Friend state upon reset
    
    Not clearing the Friend state could risk invalid timers staying
    active, etc.
    
    X-Original-Commit: a059544dd867b3bf25467080d885216ca95932db

 nimble/host/mesh/src/mesh.c | 4 ++++
 1 file changed, 4 insertions(+)

commit f465087e5a859dd4a6646156d36e279cf9ca8ff1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:29:06 2017 +0100

    mesh: Fix & clean up Friendship Credential handling
    
    Pass the subnet to some friend_cred_* APIs since it contains all
    necessary information for choosing the right keys to generate them
    from. Also shorten the API names to avoid awkward line splitting -
    these are internal APIs so it's an acceptable compromise. One bug that
    this fixes as part of the cleanup is using the right NetKey Index when
    clearing Friendship: previously the code was always using the index of
    the first subnet, regardless of which subnet the Friendship was based
    on.
    
    X-Original-Commit: 0b97dbce3154fce5896a807e14fca643b8bb4a43

 nimble/host/mesh/src/cfg_srv.c |  4 +--
 nimble/host/mesh/src/friend.c  | 10 +++---
 nimble/host/mesh/src/lpn.c     | 18 +++--------
 nimble/host/mesh/src/net.c     | 72 ++++++++++++++++++++++--------------------
 nimble/host/mesh/src/net.h     | 55 +++++++++++++++-----------------
 5 files changed, 73 insertions(+), 86 deletions(-)

commit 42af22ae96c90cd99a90d36f0cb7a10bd6e04224
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:23:16 2017 +0100

    mesh: Remove unnecessary logic for key selection
    
    Key Refresh Phase 2 is analogous to the Key Refresh flag being set.
    This means that the flag can directly be used as the index to the
    new/old key two-element array.
    
    X-Original-Commit: 76854748146bf06fa7796d6386ba2ebb4b82e105

 nimble/host/mesh/src/friend.c | 14 ++++++-------
 nimble/host/mesh/src/net.c    | 49 +++++++++++++++++++------------------------
 nimble/host/mesh/src/net.h    |  4 ++--
 3 files changed, 29 insertions(+), 38 deletions(-)

commit 8f2bf3bd501b100d830018713fe7a7ea5b1294e6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:21:44 2017 +0100

    mesh: Fix clearing network message cache
    
    Since the stack supports runtime reset and reprovisioning, we need to
    clear the network message cache whenever creating a new mesh network.
    
    X-Original-Commit: 63b5b8df7fae5d666d9dad3b6342a8f10c0d72c6

 nimble/host/mesh/src/net.c | 3 +++
 1 file changed, 3 insertions(+)

commit b4a423fb12f93faea4f1d5005d2d93f21f339eef
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:21:19 2017 +0100

    mesh: Fix proxy advertising handling
    
    Remove inconsistent and sometimes unreliable tracking of what
    advertising parameters should be used and when the Node Identity
    advertising started. The main change that facilitates this is to have
    the Node ID start timestamp as part of the mesh subnet context.
    
    X-Original-Commit: a7162101c6146969f72a6750794bccdb6834f14c

 nimble/host/mesh/src/cfg_srv.c |  1 +
 nimble/host/mesh/src/net.c     |  1 +
 nimble/host/mesh/src/net.h     |  1 +
 nimble/host/mesh/src/proxy.c   | 49 +++++++++++++++++++++++-------------------
 4 files changed, 30 insertions(+), 22 deletions(-)

commit 0524c3b627cd88f17685b96bc3cf29b42356dcf4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:14:57 2017 +0100

    mesh: Use 32-bit math for Node ID duration
    
    The Node Identity duration is at most 60 seconds, so it's safe to use
    32-bit timestamps.
    
    X-Original-Commit: 1baca59413b8b494f4f5b2c767ca5d6afc764158

 nimble/host/mesh/src/proxy.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 36409380e6a78612dcb414c1add5f1b5eac6576b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 11:14:08 2017 +0100

    mesh: Introduce option for Node ID timeout
    
    Some PTS test cases only work when we're advertising using Network
    Identity. Using the default timeout of 60 seconds for Node Identity
    will cause this test cases to fail (i.e. the PTS gives up before
    Zephyr transitions to advertising from Node Identity to Network
    Identity).
    
    X-Original-Commit: f47f3a7b7950ccb92c225a0150d475347dd948d9

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/proxy.c         | 13 ++++++++-----
 nimble/host/mesh/syscfg.yml          | 13 +++++++++++--
 3 files changed, 20 insertions(+), 7 deletions(-)

commit 82af3dce1b9cd634cdfadc66f952b7224b96384e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:40:48 2017 +0100

    mesh: shell: Fix parsing "boolean" parameters
    
    The shell was being inconsistent in its parsing of boolean parameters.
    Some commands were documented as accepting "on" but were actually
    parsing the parameter with strtoul() which would result in 0.
    Introduce a new helper to convert a string to a u8_t which still
    accepts "on" or "enable". This gives us full flexibility of having a
    simple interface to the user, but still allowing non-boolean values to
    be tested (since on-air the value is a full octet).
    
    X-Original-Commit: abf84adcbea7216137a850542a4573356328b45d

 nimble/host/mesh/src/shell.c | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

commit fe78081f18c84c95b4907e8681dd74ddff4d27fd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:39:34 2017 +0100

    mesh: shell: Add command for setting the UUID
    
    Instead of having a hard-coded UUID, introduce a command to change it.
    This is particularly useful if there are many unprovisioned nodes
    around.
    
    X-Original-Commit: 864c29bfcccd775249236130afb113044bcaf129

 nimble/host/mesh/src/shell.c | 29 ++++++++++++++++++++++++++++-
 1 file changed, 28 insertions(+), 1 deletion(-)

commit d40248f3df7ebb96c945b692cd2eb4943352c28c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:37:16 2017 +0100

    mesh: shell: Make Static OOB optional
    
    Having the Static OOB value set up-front can be confusing to the user
    since they will not know what the value is. Start off by having it
    unset, but introduce a new command using which the user can either set
    or clear it.
    
    X-Original-Commit: 7f440b9891eec185dcefaf3940841758ec90118d

 nimble/host/mesh/src/shell.c | 101 +++++++++++++++++++++++++++----------------
 1 file changed, 64 insertions(+), 37 deletions(-)

commit 52ff4e8934dddfb0f2be730bbb9e79836cf73ddd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:34:31 2017 +0100

    mesh: Restrict scope of variables in health_get_registered()
    
    Don't declare the variables in a wider scope than what they're needed
    for.
    
    X-Original-Commit: d6d110fb22980f0b64329e0d7af30edf48bff203

 nimble/host/mesh/src/health_srv.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 658468fd5de26ce3edfc8c67d0961fdad6ed720c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:34:04 2017 +0100

    mesh: shell: Fix sending health publication
    
    We need to send out a Health Fault Current Status (the Health Model's
    publication message) when all faults are cleared. The logic for
    calculating number of faults was also wrong after the updated model
    publication API.
    
    X-Original-Commit: b928253846aec7a28394090c6c7b2afefd8a3837

 nimble/host/mesh/src/health_srv.c | 6 ++----
 nimble/host/mesh/src/shell.c      | 1 +
 2 files changed, 3 insertions(+), 4 deletions(-)

commit f10777c71e6899aa87249b1a7388b41507131b0f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:33:34 2017 +0100

    mesh: Improve documentation for model publication
    
    Make it clear that the model publication msg member must not be a
    stack variable.
    
    X-Original-Commit: 1181d567e649708dc9d4afb671d021c3e2a3e917

 nimble/host/mesh/include/mesh/access.h | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit c6e1fd06d68adbf2fe5908acd45a339474e2c179
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:33:03 2017 +0100

    mesh: shell: Fix health publication message size
    
    The Health Current Fault message size was being set too small to fit
    any faults. Use a macro to make sure the size gets applied in both
    places where appropriate.
    
    X-Original-Commit: 45a585586ce397337bae28f485f31f1e15b6b298

 nimble/host/mesh/src/shell.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit a8d2f330914e2083928f61d79a0192204ff3df5b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:30:56 2017 +0100

    mesh: Fix NetKey Update behavior in Phase 1
    
    If we get a different key value in Phase 1 we should return the same
    "Cannot Update" error as in phases 2 and 3. This fixes test case
    MESH/NODE/KR/BI-02-C.
    
    X-Original-Commit: be2733a39bbbc8487e776b9076de833c953c0cca

 nimble/host/mesh/src/cfg_srv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c38a6b91f81e8d529216419d170fd6ae7fc926f5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:30:33 2017 +0100

    mesh: Add IV Update test mode API
    
    This makes it possible to pass all IV Update tests without having to
    build a custom configuration for some of the tests. We also disable
    the feature in all sample configurations, but leave it on in the
    tests.
    
    X-Original-Commit: 7c4342de236623fb3be6148281a60f4cb741c7d4

 nimble/host/mesh/include/mesh/main.h | 20 +++++++++++++++++++
 nimble/host/mesh/src/beacon.c        |  2 +-
 nimble/host/mesh/src/lpn.c           |  2 +-
 nimble/host/mesh/src/net.c           | 31 +++++++++++++++++++++++++----
 nimble/host/mesh/src/net.h           |  3 ++-
 nimble/host/mesh/src/shell.c         | 38 +++++++++++++++++++++++++++---------
 nimble/host/mesh/src/transport.c     |  4 ++--
 nimble/host/mesh/syscfg.yml          |  1 +
 8 files changed, 83 insertions(+), 18 deletions(-)

commit 5718d0729d3cd1ebe616e858c7f23a9c4a177fcf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:18:21 2017 +0100

    mesh: shell: Add iv-update command
    
    This command is needed to pass some IV Update-related PTS tests.
    
    X-Original-Commit: 2fcb7459facc2bb386eb511cec5d456ffb58bd91

 nimble/host/mesh/src/shell.c | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit 04e4f0037e56dbe2724b2969fecb727a82865532
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 1 10:12:07 2017 +0100

    mesh: Fix creating initial beacon data
    
    There was a chance that initial beacons for subnets would be sent with
    uninitialized data. Make sure we initialize the beacon data each time
    when we create a new subnet.
    
    X-Original-Commit: 9ed0ee6501ca596418b6f6390b83d4d382d5b49f

 nimble/host/mesh/src/cfg_srv.c | 3 +++
 nimble/host/mesh/src/net.c     | 3 +++
 2 files changed, 6 insertions(+)

commit f04de5eef042d1652a7ef59d0f55654cc7f679a4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 17:02:53 2017 +0100

    mesh: shell: Fix & clean up command help
    
    Use NULL instead of "", fix typos, and indicate app-key-add last
    parameter as optional (to match the command implementation).
    
    X-Original-Commit: c51cad138f1a7663e5fab3d644736fffff0941b3

 nimble/host/mesh/src/shell.c | 14 +++-----------
 1 file changed, 3 insertions(+), 11 deletions(-)

commit 3d186cd77258da80f59a1321f35e8b310c81ec89
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 17:01:24 2017 +0100

    mesh: Add support for manipulating Label UUIDs
    
    Add support for sending messages that add, delete or overwrite Label
    UUIDs, and add commands for these to the shell. With the help of these
    commands it's possible to pass Transport Layer PTS tests (in
    particular TNPT/BV-05-C) by manually adding a Label UUID through
    module subscription, since the test case itself does not do this.
    
    X-Original-Commit: 934d202b26d7013f9669610566496207f6ff0071

 nimble/host/mesh/include/mesh/cfg_cli.h |  26 +++++++
 nimble/host/mesh/src/cfg_cli.c          | 127 +++++++++++++++++++++++++++++++-
 nimble/host/mesh/src/shell.c            | 103 ++++++++++++++++++++++++++
 3 files changed, 252 insertions(+), 4 deletions(-)

commit 4634129ac609859039df490acd4f495e45c671c9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 16:58:10 2017 +0100

    mesh: Improve logging related to Label UUID lookups
    
    X-Original-Commit: 95a5d6d155249265d4da0fb02c07625ae3056ce6

 nimble/host/mesh/src/cfg_srv.c | 9 +++++++++
 1 file changed, 9 insertions(+)

commit f44497d6f81acc0c1e49b1fc923bfd89b88f4a0c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 16:57:36 2017 +0100

    mesh: shell: Add raw network PDU sending support
    
    X-Original-Commit: 28cd62128747c7ac596ad146492172ddca5c7f50

 nimble/host/mesh/src/shell.c | 52 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 52 insertions(+)

commit ce7db4806eae22273de23ac4759e1b34e849cdbb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 16:55:01 2017 +0100

    mesh: shell: Add support for decoding hex strings
    
    Add helper to decode arbitrary-length hex strings. The first user is
    the AppKeyAdd handler.
    
    X-Original-Commit: 2950084e1d0e8d99b6a6e608ca58603aedbdede8

 nimble/host/mesh/src/shell.c | 41 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 41 insertions(+)

commit 952ebc3cf699f8acc2c87316fde34177cbf5cd39
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 16:53:53 2017 +0100

    mesh: shell: Fix decoding vendor model IDs
    
    The code was accessing the wrong parameter.
    
    X-Original-Commit: 25f8bfa5584d5e77dd077fa46a508f49bf39b35d

 nimble/host/mesh/src/shell.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 2102e4b6ed46ab44c7d98fa31acb5ab5fad069bd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 11:45:02 2017 +0100

    mesh: LPN: Fix clearing group status
    
    When the Friendship is lost the group status tracking needs to be
    cleared.
    
    X-Original-Commit: 31d198b2d95af5c71305a802ebeb3326b95d6775

 nimble/host/mesh/src/lpn.c | 82 ++++++++++++++++++++++++----------------------
 1 file changed, 43 insertions(+), 39 deletions(-)

commit 5681e6454a20ad4ed2c3abbe66dfa645771b3247
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 11:43:38 2017 +0100

    mesh: LPN: Fix clearing pending request
    
    The code would unconditionally clear sent_req in update_timeout(),
    which would e.g. cause us to switch to Friend Polls if the Friend
    didn't respond to a Subscription List Add/Remove on the first attempt.
    
    X-Original-Commit: f43213e6be3ee6aec6ffcf35dcc247412173e189

 nimble/host/mesh/src/lpn.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 069ca7f3d307d03cefdbb0125aeca393f19290c3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 11:42:51 2017 +0100

    mesh: Increase initial poll timeout
    
    The purpose of using something less than the configured poll timeout
    was to cover the case where the LPN establishes Friendship before the
    provisioner has completely configured it. However, there's the "more
    data" flag in the initial Friend Response, and we now also have a
    public API to request for more messages. Both of these features
    diminish the value of having a reduced initial timeout. Also, some LPN
    test cases do not expect us to send frequent polls initially, causing
    failures with the PTS.
    
    Therefore, introduce a Kconfig option to set the initial timeout, and
    make it default to the actual poll timeout.
    
    X-Original-Commit: 35499d711911beeec97c6ff572741ec64a0816c3

 nimble/host/mesh/src/lpn.c  |  4 +++-
 nimble/host/mesh/syscfg.yml | 14 ++++++++++++--
 2 files changed, 15 insertions(+), 3 deletions(-)

commit d4e71d4ef4bce89d0a1b80b2b1b7d9daccc33561
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 24 11:37:00 2017 +0100

    mesh: Introduce public LPN APIs for better control
    
    Many apps, the mesh shell included (due to PTS test requirements)
    benefit from exposing LPN state and polling outside of the stack.
    Introduce new APIs for these, and add code to the mesh shell module to
    take advantage of them.
    
    X-Original-Commit: 1512f82bd242708f1f6be0e430512b499ef1856c

 nimble/host/mesh/include/mesh/main.h | 18 +++++++++
 nimble/host/mesh/src/lpn.c           | 27 +++++++++++++-
 nimble/host/mesh/src/lpn.h           |  2 -
 nimble/host/mesh/src/shell.c         | 72 ++++++++++++++++++++++++++----------
 nimble/host/mesh/src/transport.c     |  2 +-
 5 files changed, 96 insertions(+), 25 deletions(-)

commit 08a38272fd15bd2e5bad89d4675a3b1a6c8774fd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 16:20:42 2017 +0100

    mesh: Reformat code to better match Zephyr's
    
    X-Original-Commit: 4539dda435011e1fdfcae57adc970ac99eca8010

 nimble/host/mesh/src/adv.c   | 278 ++++++++++++++++++++--------------------
 nimble/host/mesh/src/mesh.c  | 204 ++++++++++++++---------------
 nimble/host/mesh/src/net.c   |   1 -
 nimble/host/mesh/src/prov.c  |  24 ++--
 nimble/host/mesh/src/proxy.c | 296 +++++++++++++++++++++----------------------
 nimble/host/mesh/src/shell.c |  14 +-
 6 files changed, 404 insertions(+), 413 deletions(-)

commit add21e03858cd8b50f56f16e5d4299e30b2fc754
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 16:18:32 2017 +0100

    mesh: Fix typos in IV Index update procedure
    
    X-Original-Commit: 2b2818a2a6e1af2c644bae98dd0d00cb1d310ee9

 nimble/host/mesh/src/net.c | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)

commit 22d38d1c61abf299ed8837a42c241df2f137f560
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:40:33 2017 +0100

    mesh: Health: Fix requiring specific Company ID
    
    The Health Fault Test & Test Unacknowledged messages are supposed to
    be sent for more than the Node Composition Data Company ID. It's true
    that some PTS tests require the message to be ignored for
    non-composition data ID, however that's something that should be
    covered by the application that's used for testing, and not the
    generic Health Server Code.
    
    X-Original-Commit: b4952a83b7f0a75f983a9b4d3dc8e1bbb3980abc

 nimble/host/mesh/src/health_srv.c | 8 --------
 1 file changed, 8 deletions(-)

commit 432b1eacfdb2480b198ab39075768909e1236945
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:40:02 2017 +0100

    mesh: Add support for Health Attention messages
    
    Add support for sending Health Attention messages, as well as commands
    to use these new APIs from the shell.
    
    X-Original-Commit: 7c5e3443ac9717f50fc767a025b651c0b9d356f7

 nimble/host/mesh/include/mesh/health_cli.h |  6 ++
 nimble/host/mesh/src/health_cli.c          | 99 ++++++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c               | 73 ++++++++++++++++++++++
 3 files changed, 178 insertions(+)

commit 90d2aace9d0ec07718d6ea896933f69493a27897
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:37:08 2017 +0100

    mesh: Introduce helpers to wait for a status message
    
    There was a lot of code duplicated in the Foundation Client Models for
    waiting on a specific status message. Refactor this into helper
    functions (one per client model).
    
    X-Original-Commit: 593ada291eead8ae1b354cea093fd6e57b03260e

 nimble/host/mesh/src/cfg_cli.c    | 155 +++++++-------------------------------
 nimble/host/mesh/src/health_cli.c |  65 +++++-----------
 2 files changed, 49 insertions(+), 171 deletions(-)

commit 3e2bd5a4bf45f7848e26d84a4803a69ab54edd27
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:36:34 2017 +0100

    mesh: Add support for Health Period messages
    
    Add support for sending Health Period messages, as well as commands to
    use these new APIs from the shell.
    
    X-Original-Commit: dc75f9aaf2c3b1770ce596d81811f5b439ccaec8

 nimble/host/mesh/include/mesh/health_cli.h |   6 ++
 nimble/host/mesh/src/health_cli.c          | 115 +++++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c               |  73 ++++++++++++++++++
 3 files changed, 194 insertions(+)

commit 614b5a2b5f2fbc2dc403156c3d0c5de6bb391bf3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:33:52 2017 +0100

    mesh: Add support for Health Fault Test messages
    
    Add support for sending Test and Test Unacknowledged messages.
    
    X-Original-Commit: cdbf80cb0b3bda0b7be89168ef61ac9cb7a28e9a

 nimble/host/mesh/include/mesh/health_cli.h |  4 ++
 nimble/host/mesh/src/health_cli.c          | 65 +++++++++++++++++++++++++++++-
 nimble/host/mesh/src/shell.c               | 60 +++++++++++++++++++++++++++
 3 files changed, 127 insertions(+), 2 deletions(-)

commit b21b48e3f74bf205d42146db915ce99455277f91
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:31:38 2017 +0100

    mesh: Add support for Health Fault Clear messages
    
    Add support for sending Clear and Clear Unacknowledged messages.
    
    X-Original-Commit: 1fce24179b4a4fdfcccdb7829995de4deb876294

 nimble/host/mesh/include/mesh/health_cli.h |  4 +++
 nimble/host/mesh/src/health_cli.c          | 53 +++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c               | 57 ++++++++++++++++++++++++++++++
 3 files changed, 114 insertions(+)

commit 1524fad12ffe9b76602f3161a6415c381f2653a5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:22:37 2017 +0100

    mesh: shell: Add Health Fault support to the server
    
    Add commands and callbacks to manage the Registered Fault state.
    
    X-Original-Commit: cfea732c2f6a181c1e70afff9b12a169ceeff115

 nimble/host/mesh/src/shell.c | 162 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 162 insertions(+)

commit 832474b46288688cfa799d7307c0cb2f1d6f2978
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:20:22 2017 +0100

    mesh: shell: Use a valid Company ID
    
    The Company ID 0xffff is treated as invalid in some contexts, so use a
    valid one. Also, the Health tests require the Health Fault Company ID
    to match that found in the Composition Data.
    
    X-Original-Commit: f6f71ef9c5782bfe43f30a63f427744a75eb0acf

 nimble/host/mesh/src/shell.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 7a59db366ef94856d3cc8017dcedc7f45c445a9f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:19:50 2017 +0100

    mesh: Add support for receiving Health Current Status
    
    Add a callback to the Health Client Model context, so that the
    application is able to receive Health Current Status messages that
    some Health Server Model publishes.
    
    X-Original-Commit: 602a384ed4819a344a01d1340db8da9af96f4729

 nimble/host/mesh/include/mesh/health_cli.h |  4 ++++
 nimble/host/mesh/src/health_cli.c          | 27 +++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c               |  9 +++++++++
 3 files changed, 40 insertions(+)

commit 5163145ca173c769478e83bf8fe10c6e60a84a8e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:18:31 2017 +0100

    mesh: Add support for sending Health Fault Get message
    
    Add the needed Health Client API for sending Health Fault Get, and add
    a command to the shell to utilize it.
    
    X-Original-Commit: a9ebf675c337216e0a5720412f99366f0bc0431a

 nimble/host/mesh/include/mesh/health_cli.h |   4 ++
 nimble/host/mesh/src/health_cli.c          | 107 +++++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c               |  54 +++++++++++++++
 3 files changed, 165 insertions(+)

commit 5eae9c26e6183744021151681ba80d72ffef3f36
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 15:13:15 2017 +0100

    mesh: Add skeleton for Health Client model
    
    Add a skeleton for the Health Client model.
    
    X-Original-Commit: d10d69894f538d0584a86209d77613bdf57dad1f

 nimble/host/mesh/include/mesh/health_cli.h | 44 +++++++++++++++++
 nimble/host/mesh/include/mesh/mesh.h       |  4 ++
 nimble/host/mesh/src/access.c              |  3 ++
 nimble/host/mesh/src/foundation.h          |  1 +
 nimble/host/mesh/src/health_cli.c          | 77 ++++++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.c               |  4 ++
 nimble/host/mesh/syscfg.yml                |  6 +++
 7 files changed, 139 insertions(+)

commit a9a4bc3964b34a3fa1db2346176f3e9cfa2d1ffa
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 14:48:35 2017 +0100

    mesh: shell: Add appidx command for setting the AppIndex
    
    X-Original-Commit: d324bcfb04c8ddd4f679de4de02506f0c018bb46

 nimble/host/mesh/src/shell.c | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

commit 59776747ea7ddbc6e0b2a91593c81a4e3f63b9a4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:09:16 2017 +0100

    mesh: Friend: Fix poll timeout type
    
    The Poll Timeout needs to be at least 24 bits, so u16_t doesn't
    suffice and will potentially result in truncation. Use u32_t, thereby
    also fixing a coverity warning.
    
    X-Original-Commit: 665613babb20b6699d702bdf5bfefee1eb887f5a

 nimble/host/mesh/src/friend.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 834802dbb28e0f541b4f102a28cb55102fc62b2b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:08:46 2017 +0100

    mesh: Fix coverity warning of unchecked return
    
    Most places check the return value of bt_mesh_model_send(), so check
    for it in all places.
    
    X-Original-Commit: b40052734d616b05201cca6a7ad58d9176ebcaaa

 nimble/host/mesh/src/cfg_srv.c    | 40 ++++++++++++++++++++++++++++-----------
 nimble/host/mesh/src/health_srv.c | 10 ++++++++--
 2 files changed, 37 insertions(+), 13 deletions(-)

commit 4b942a95da8e38f8f890318ac62ebf87731d8e71
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:06:01 2017 +0100

    mesh: Fix dereferencing mod->pub too early
    
    The bt_mesh_model_publish() is supposed to return a "not supported"
    error if the publish context doesn't exist. Fixing the premature
    dereferencing also fixes coverity warnings.
    
    X-Original-Commit: 5c766168d16c53bd28b9b33003ce04d99066516d

 nimble/host/mesh/src/access.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 0adfb5cdb95e3de71c7de2918060973158f035c3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:05:39 2017 +0100

    mesh: Improve model publication documentation
    
    Make it clear which members of bt_mesh_model_pub the documentation is
    referencing.
    
    X-Original-Commit: f468845332d7c475d326b6b62fbb718ee08b869c

 nimble/host/mesh/include/mesh/access.h | 22 ++++++++++++----------
 1 file changed, 12 insertions(+), 10 deletions(-)

commit 407243a5a16494cd78e08a4661ef314b1f6759a5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:04:57 2017 +0100

    mesh: remove redundant 32-bit wrap-around code
    
    The separate checking for "now < reftime" is unnecessary, since the
    integer over/under-flow for unsigned 32-bit values resulting from
    subtraction will give the right delta even if 'now' is less than the
    reference.
    
    X-Original-Commit: b8aae893268fdc4f419c58e5a5b8666f6fa7fdbb

 nimble/host/mesh/src/access.c |  8 ++------
 nimble/host/mesh/src/beacon.c |  8 +-------
 nimble/host/mesh/src/friend.c | 11 ++---------
 3 files changed, 5 insertions(+), 22 deletions(-)

commit a3a3511079ec1c60906df9b97ce3ac2418b7ac6e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:04:03 2017 +0100

    mesh: Fix accuracy of Publish Period
    
    After the Publish Retransmit state was introduced the Publish Period
    measurement would begin once the previous Publish message has finished
    transmitting. This will however cause inaccurate periods, which is
    particularly an issue with the PTS that expects accuracy of less than
    0.5 seconds (apparently).
    
    Since the publication timer is also used for the retransmissions we
    can't simultaneously use if for the period as well. Therefore, we
    introduce a new variable called period_start which makes a note of
    when the period was supposed to start, and then once all
    retransmissoins are done initializes the timer with the send duration
    taken into account.
    
    X-Original-Commit: f9dc98b1d04266b267d1efb5e13f3b2a3737622c

 nimble/host/mesh/include/mesh/access.h |  2 ++
 nimble/host/mesh/src/access.c          | 34 ++++++++++++++++++++++++++++++----
 2 files changed, 32 insertions(+), 4 deletions(-)

commit 68e3b8cbe86b6ffb9a9119848fdd11fb304c59be
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:03:28 2017 +0100

    mesh: Provide documentation for the publication API
    
    Document all members of the bt_mesh_model_pub struct.
    
    X-Original-Commit: daa71e85231427544b0be74a62ee682b0f4e92b2

 nimble/host/mesh/include/mesh/access.h | 47 ++++++++++++++++++++++++----------
 1 file changed, 33 insertions(+), 14 deletions(-)

commit e5e0634344b3e3b6d5e3165eea94727a2f63a94b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 10:00:23 2017 +0100

    mesh: Fix non-periodic Model Publication
    
    The only generally available model supporting publication that's
    convenient to be used for testing is the Health Server Model.
    Unfortunately since this model supports period publication, the
    non-periodic side got less attention and had some bugs.
    
    The first thing that needs to be done is to verify that the period
    returned by bt_mesh_model_pub_period_get() is positive. If it's zero
    then no periodic publication should take place.
    
    Another thing that this patch cleans up is the naming of the callback
    used for periodic publishing. There's no need do require the callback
    to call bt_mesh_model_publish() since this must happen no matter what,
    so instead rename the callback from 'func' to 'update' and have the
    access layer call bt_mesh_model_publish() if the callback was
    successful.
    
    X-Original-Commit: c900560f3daa6574d2a7821b6be898f40c77716a

 nimble/host/mesh/include/mesh/access.h |  9 +++++---
 nimble/host/mesh/src/access.c          | 38 ++++++++++++++++++++++------------
 nimble/host/mesh/src/cfg_srv.c         |  6 +++---
 nimble/host/mesh/src/health_srv.c      | 10 +++------
 4 files changed, 37 insertions(+), 26 deletions(-)

commit b1fde6bb0a4f32229911fab2520096800c5b014c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:59:21 2017 +0100

    mesh: Proxy: Downgrade advertising errors to warnings
    
    When a small amount of supported connections is configured (especially
    the default number of 1), connectable advertising may fail. This is
    perfectly fine since as soon as a disconnection event happens the
    advertising will be successfully restarted. To avoid causing
    unnecessary user worries, downgrade the resulting errors to warnings.
    
    X-Original-Commit: 910dd589930aad9978a1e458d32e3be6c4fa9a9e

 nimble/host/mesh/src/proxy.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit aceab9e9de59f5eda44f38c46cef9fba78bcc114
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:58:50 2017 +0100

    mesh: Fix node reset
    
    There were some things that were working only when receiving a Node
    Reset message from someone else, but not when the app called
    bt_mesh_reset() directly. There was also some state cleanup missing
    for the transport layer. This patch addresses all of these issues.
    
    X-Original-Commit: 2acd3aa7153269c9d452d06b1ea76976d80bcc98

 nimble/host/mesh/src/cfg_srv.c    | 60 +++++++++++++++++++++++----------------
 nimble/host/mesh/src/foundation.h |  2 ++
 nimble/host/mesh/src/mesh.c       | 10 +++++--
 nimble/host/mesh/src/transport.c  | 15 +++++++++-
 nimble/host/mesh/src/transport.h  |  1 +
 5 files changed, 60 insertions(+), 28 deletions(-)

commit 6989900c23a68f5a599ddd70a6ca7a7aee4b8a2b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:55:01 2017 +0100

    mesh: shell: Declare mandatory dependency on BLE_MESH_CFG_CLI
    
    The Configuration Client is such a generally useful feature for the
    shell that it makes sense to have it as a mandatory dependency (the
    shell wasn't anyway compiling at the moment without it).
    
    X-Original-Commit: 2fc5da39c321bdedd27b4855abb7f4bc98e0298c

 nimble/host/mesh/src/cfg_cli.c | 11 +++++++----
 nimble/host/mesh/src/shell.c   |  6 ++++++
 nimble/host/mesh/syscfg.yml    |  4 +++-
 3 files changed, 16 insertions(+), 5 deletions(-)

commit 5b44a0acb5b08bf2939012540cee48b5d271b1d7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:45:04 2017 +0100

    mesh: shell: Add mod-sub-del command
    
    Add command to delete model subscriptions.
    
    X-Original-Commit: 7034ac14660b636a7064fb5bb79adc7678002179

 nimble/host/mesh/src/shell.c | 45 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 45 insertions(+)

commit b3f18ecc050e81a769bed6a0e87d10eddffa8a3b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:41:09 2017 +0100

    mesh: Add Model Subscription Del & Overwrite support
    
    The Del and Overwrite operations have the exact same parameters and
    expected status response as the Add operation, so we can reuse most of
    the code.
    
    X-Original-Commit: 4aa6a17539d7b6ed8c53aa82e83e375c6907016f

 nimble/host/mesh/include/mesh/cfg_cli.h | 14 +++++++++
 nimble/host/mesh/src/cfg_cli.c          | 52 ++++++++++++++++++++++++++++-----
 2 files changed, 59 insertions(+), 7 deletions(-)

commit 4c36faed9a6e75777256469503f65b16fbbed1a2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:38:45 2017 +0100

    mesh: Fix ignoring all messages in LPN mode
    
    Even though we have LPN enabled, we might still receive messages
    through other network interfaces than the advertising one (e.g. the
    local network interface).
    
    X-Original-Commit: 577bbc6984c7d58bf6972b84cd40cae316f36a40

 nimble/host/mesh/src/transport.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1f5f3cd5fae41ffabd93e04ee6ec46baaeef9c53
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 23 09:37:49 2017 +0100

    mesh: Fix calling send start for multi-segmented messages
    
    Using the start callback, especially with multi-segment messages, may
    not be super useful for applications, but we should support if if they
    do provide it. One application could e.g. be to calculate the duration
    it takes for a multi-segment message to be completely received by the
    remote end.
    
    X-Original-Commit: a9ca63e01851a044714ee51107791dc3d79bb791

 nimble/host/mesh/src/transport.c | 18 +++++++++++++++++-
 1 file changed, 17 insertions(+), 1 deletion(-)

commit c1b48a14b744aee9f10dc22271e763c9aced0f4c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 14:46:28 2017 +0100

    mesh: Fix model publication
    
    Model publication was broken in a couple of ways:
    
      - The Publish Retransmit State was not taken into account at all
      - Health Server used a single publish state for all elements
    
    To implement Publish Retransmit properly, one has to use a callback to
    track when the message has been sent. The problem with the transport
    layer sending APIs was that giving a callback would cause the
    transport layer to assume that segmentation (with acks) is desired,
    which is not the case for Model Publication (unless the message itself
    is too large, of course). Because of this, the message sending context
    receives a new send_rel ("Send Reliable") boolean member that an app
    can use to force reliable sending.
    
    Another challenge with the Publish Retransmit state is that a buffer
    is needed for storing the AppKey-encrypted SDU once it has been sent
    out for the first time.To solve this, a new new net_buf_simple member
    is added to the model publication context. The separate 'msg' input
    parameter of the bt_mesh_model_publish() API is removed, since the
    application is now expected to pre-fill pub->msg instead.
    
    To help with the publishing API change, the Health Server model gets a
    new helper macro for initializing the publishing context with a
    right-sized publishing message.
    
    The API for creating Health Server instances is also redesigned since
    it was so far using a single model publishing state, which would
    result in erratic behavior in case of multiple elements with the
    Health Server Model. Now, the application needs to provide a unique
    publishing context for each Health Server instance.
    
    The changes are heavily intertwined, so it's not easily possible to
    split them into multiple patches, hence the large(ish) patch.
    
    X-Original-Commit: 9479e06d6e21307b2e0facf960d3bb9b10b4e487

 nimble/host/mesh/include/mesh/access.h     |  19 +++-
 nimble/host/mesh/include/mesh/health_srv.h |  54 ++++++---
 nimble/host/mesh/src/access.c              | 175 ++++++++++++++++++++++-------
 nimble/host/mesh/src/cfg_srv.c             |   3 +-
 nimble/host/mesh/src/crypto.c              |  18 ++-
 nimble/host/mesh/src/crypto.h              |  10 +-
 nimble/host/mesh/src/health_srv.c          | 115 +++++++++----------
 nimble/host/mesh/src/net.c                 |   4 +-
 nimble/host/mesh/src/net.h                 |   4 +-
 nimble/host/mesh/src/shell.c               |  12 +-
 nimble/host/mesh/src/transport.c           | 113 +++++++++++--------
 11 files changed, 342 insertions(+), 185 deletions(-)

commit 424111be85dffc658c5f781e5ccaa2f76806ae0d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 13:54:40 2017 +0100

    mesh: Fix encoding/decoding Publish Retransmit value
    
    The Model Publish Retransmit Interval is in units of 50ms and not 10ms
    like the other transmit/retransmit states. Create dedicated macros for
    the Publish Retransmit State and use them where appropriate.
    
    X-Original-Commit: e063ad8ac28b1a2e2fee9f7a5b4d15c905d7d8f2

 nimble/host/mesh/include/mesh/access.h | 34 ++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/cfg_srv.c         |  8 ++++----
 nimble/host/mesh/src/shell.c           | 15 ++++++++-------
 3 files changed, 46 insertions(+), 11 deletions(-)

commit 66ca13a41873af12bb0a5e499408e2d1a3c59f65
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 13:53:57 2017 +0100

    mesh: Use a unified send callback also for public API
    
    There's no need for callback exposed in the public API to be something
    different than what's used internally. In fact this would just
    complicate things. This patch exposes the internal callback under a
    bt_mesh_adv_cb name and uses it throughout the mesh stack.
    
    X-Original-Commit: f1f3ccc07973827a518bbb42aa8ecbc8aa385ec8

 nimble/host/mesh/include/mesh/access.h |  8 ++++++--
 nimble/host/mesh/src/access.c          |  6 +++---
 nimble/host/mesh/src/adv.c             | 16 ++++++++--------
 nimble/host/mesh/src/adv.h             |  9 ++-------
 nimble/host/mesh/src/beacon.c          |  4 ++--
 nimble/host/mesh/src/friend.c          | 10 +++++-----
 nimble/host/mesh/src/lpn.c             | 12 ++++++------
 nimble/host/mesh/src/net.c             | 20 ++++++++++----------
 nimble/host/mesh/src/net.h             |  4 ++--
 nimble/host/mesh/src/prov.c            | 10 +++++-----
 nimble/host/mesh/src/transport.c       | 23 ++++++++++++-----------
 nimble/host/mesh/src/transport.h       |  4 ++--
 12 files changed, 63 insertions(+), 63 deletions(-)

commit ad8f75b5101dddfde6dc2ba7f370e457f28d8d39
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 13:47:01 2017 +0100

    mesh: Fix notifying message send completion for GATT proxy
    
    In case an outgoing message gets only delivered to the proxy interface
    we should not forget to notify the send callbacks of this.
    
    X-Original-Commit: 060a04dba5fa9df575fa89b03424679a2c950fda

 nimble/host/mesh/src/net.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 1040b8f88b4e73bc543247faebe777fc2c964e43
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 13:46:13 2017 +0100

    mesh: Introduce a second advertising callback
    
    Some places of the code are interested in when the first advertising
    event goes out. Others, on the other hand, are interested when the
    last advertising event goes out. Some are even interested in both of
    these. Instead of providing a single callback, provide a struct with
    two possible callbacks for sending advertising PDUs.
    
    X-Original-Commit: d5caf54fbde8018659c4620c8cbba704201fd04a

 nimble/host/mesh/src/adv.c       | 50 ++++++++++++++++++++++------------------
 nimble/host/mesh/src/adv.h       | 16 ++++++++-----
 nimble/host/mesh/src/beacon.c    | 10 ++++----
 nimble/host/mesh/src/friend.c    | 33 ++++++++++++++++++--------
 nimble/host/mesh/src/lpn.c       | 34 +++++++++++++++++----------
 nimble/host/mesh/src/net.c       | 16 ++++++++-----
 nimble/host/mesh/src/net.h       |  5 ++--
 nimble/host/mesh/src/prov.c      | 24 +++++++++++--------
 nimble/host/mesh/src/transport.c | 22 ++++++++++--------
 nimble/host/mesh/src/transport.h |  4 ++--
 10 files changed, 130 insertions(+), 84 deletions(-)

commit f7a2b5880a9aa5740a6bdb727d68bf60ab95c5f5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 13:22:29 2017 +0100

    mesh: Introduce user data for the advertising callback
    
    This simplifies the callback implementations since they no-longer need
    to do their own look-ups of the needed context.
    
    X-Original-Commit: 6725034fdf756487c07d92cf6c80115f1e09e5f6

 nimble/host/mesh/src/adv.c       |  7 +++++--
 nimble/host/mesh/src/adv.h       | 23 ++++++++++-------------
 nimble/host/mesh/src/beacon.c    | 12 +++++-------
 nimble/host/mesh/src/cfg_srv.c   |  2 +-
 nimble/host/mesh/src/friend.c    | 37 +++++++++----------------------------
 nimble/host/mesh/src/lpn.c       | 18 +++++++++++-------
 nimble/host/mesh/src/net.c       | 12 ++++++------
 nimble/host/mesh/src/net.h       |  4 ++--
 nimble/host/mesh/src/prov.c      | 16 +++++++++-------
 nimble/host/mesh/src/transport.c | 22 +++++++++++-----------
 nimble/host/mesh/src/transport.h |  3 ++-
 11 files changed, 71 insertions(+), 85 deletions(-)

commit afec8f2be06e516bf3115dd0ffd0f80254d501de
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 21 12:13:31 2017 +0100

    Mesh: Move per-buffer mesh meta-data to external struct
    
    We've so far been trying to keep the per-buffer mesh meta-data to
    a maximum of 8 bytes in anticipation of upcoming net_buf refactoring
    that'll have all net_bufs in the system with the same sized user data.
    
    It's however slowly becoming unfeasible to do this - e.g. simply
    adding user data to the sending callback would already fill up the
    full 8 bytes.
    
    To solve this issue, treat the net_buf user data as just a pointer to
    the actual user data, and keep the actual user data in a separate
    array. We still keep taking advantage of net_buf_id() however, so
    buffers can cheaply be mapped to their meta-data.
    
    X-Original-Commit: 6bd12c1d3150569fd63255f273aa21d82a487518

 nimble/host/mesh/include/mesh/glue.h | 20 ++++++++++++++++
 nimble/host/mesh/src/adv.c           | 33 +++++++++++++++++----------
 nimble/host/mesh/src/adv.h           | 15 ++++++++----
 nimble/host/mesh/src/friend.c        | 44 ++++++++++++++++--------------------
 4 files changed, 72 insertions(+), 40 deletions(-)

commit 10318883de1bc5642ab6e92b275eb3d922e0c777
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:25:02 2017 +0100

    mesh: Fix clearing incomplete Friendship upon reset
    
    When resetting there is no point trying to start clearing the
    Friendship since there will not be any security material left to send
    out PDUs.
    
    X-Original-Commit: 008a14e31f3f4685bc67afddde2240e76958912b

 nimble/host/mesh/src/lpn.c  | 22 +++++++++++-----------
 nimble/host/mesh/src/lpn.h  |  2 +-
 nimble/host/mesh/src/mesh.c |  2 +-
 3 files changed, 13 insertions(+), 13 deletions(-)

commit 4c08f28316b3f156061a5fee4f0c03e54203422a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:23:46 2017 +0100

    mesh: Fix compiler warning for access.c
    
    This fixes a warning for duplicate const declaration specifier.
    
    X-Original-Commit: 1e3c51db7a2a8da641990e009cd00a7268030c3f

 nimble/host/mesh/src/access.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit df4d2ddbb820fe65d5e76c013dee42ead016c82b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:22:52 2017 +0100

    mesh: Make AppKey binding implicit for Model Publication
    
    The common interpretation (among other implementations) seems to be
    that Model Publication for a given AppKey Index implies a binding for
    that AppKey. This isn't currently explicitly stated in the spec, but
    in order to improve interoperability go with this interpretation as
    well.
    
    X-Original-Commit: edf7faf099a9eb253d17cb55c4c7ca474479342d

 nimble/host/mesh/src/access.c | 25 ++++++++++++++++++++-----
 1 file changed, 20 insertions(+), 5 deletions(-)

commit 7defc295e9ebc0124eaa823627d2a04031e7d178
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:21:53 2017 +0100

    mesh: Friend: Fix setting pending_buf variable
    
    The variable for tracking that a buffer from the Friend Queue hasn't
    been sent yet was not being properly set.
    
    X-Original-Commit: 1cd292cc70da9088d7f9e978b24731fd1f6bfce5

 nimble/host/mesh/src/friend.c | 1 +
 1 file changed, 1 insertion(+)

commit c8c6b532d48d17c39275e65867ad8f0d406d4492
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:21:29 2017 +0100

    mesh: Use u8_t instead of bitfields for 8-bit wide values
    
    It's cleaner to use single u8_t variables for values which require
    exactly 8 bits.
    
    X-Original-Commit: 7d857e99eb46708663dcb346c343638114de46c7

 nimble/host/mesh/include/mesh/access.h | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 643e54f99bb35898ff6eb8c85a8a09158e0d8468
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:20:51 2017 +0100

    mesh: Use dedicated struct for heartbeat subscription
    
    This simplifies the API since there is no-longer a need to pass a huge
    number of function arguments around.
    
    X-Original-Commit: 16f3dcabbfe83ed72774c3bb19d11fa5caf5cc59

 nimble/host/mesh/include/mesh/cfg_cli.h | 18 ++++++++++----
 nimble/host/mesh/src/cfg_cli.c          | 44 ++++++++++++---------------------
 nimble/host/mesh/src/shell.c            | 42 ++++++++++++++++++-------------
 3 files changed, 54 insertions(+), 50 deletions(-)

commit b5de1d7112b73cfa01a368f058d0f074aab1888b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:20:12 2017 +0100

    mesh: Use dedicated struct for heartbeat publication
    
    This simplifies the API since there is no-longer a need to pass a huge
    number of function arguments around.
    
    X-Original-Commit: 8b65e8f9ff5929de37f56bf5381a966b7c15a71a

 nimble/host/mesh/include/mesh/cfg_cli.h | 19 +++++++----
 nimble/host/mesh/src/cfg_cli.c          | 59 ++++++++++++---------------------
 nimble/host/mesh/src/shell.c            | 31 ++++++++---------
 3 files changed, 49 insertions(+), 60 deletions(-)

commit 9af3617ae07932d166ed1885b07db17aa8e19f7e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:19:23 2017 +0100

    mesh: shell: Add mod-pub command
    
    Add a command for getting and setting the model publication. We also
    have to adjust the app's configuration, since both the Model
    Publication Set and Status messages are segmented messages, meaning we
    need two TX and RX segment contexts.
    
    X-Original-Commit: 89a37308e0f410d1c0cb2376fb422734b1d42f63

 nimble/host/mesh/src/shell.c | 130 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 130 insertions(+)

commit 7812c197bd2d42417bb236202278158a0fa4ced4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:15:48 2017 +0100

    mesh: Add support for sending Model Publication messages
    
    Add support for Model Publication Set/Get and their vendor model
    variants.
    
    X-Original-Commit: 5a6a9b1690c5b57bba3c361545784b160ade50a8

 nimble/host/mesh/include/mesh/cfg_cli.h |  25 ++++
 nimble/host/mesh/src/cfg_cli.c          | 231 ++++++++++++++++++++++++++++++++
 2 files changed, 256 insertions(+)

commit b17a74375fcf00b0a1053f9eed30233a712905c0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:14:32 2017 +0100

    mesh: Use invalid CID instead of bool for non-vendor models
    
    The value 0xffff is reserved, so we can use that to indicate whether
    there's a vendor model in question or not. Simplifies things over the
    previously used separate boolean value.
    
    X-Original-Commit: 0f50d92f6aabab3dad17be6715b4d146b6361a45

 nimble/host/mesh/src/cfg_cli.c | 57 +++++++++++++++++++++---------------------
 1 file changed, 29 insertions(+), 28 deletions(-)

commit 6eb4d817a5c1bf4082517558699fe452246ba253
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:12:49 2017 +0100

    mesh: Fix enabling scanning after provisioning
    
    There were some needed changes missing after the update to have manual
    control of PB-ADV & PB-GATT provisioning bearers. E.g. the test for
    CONFIG_BT_MESH_LOW_POWER in net.c was no-longer indicative of scanning
    being on or not.
    
    Do the scan enabling selection within the LPN module if LPN is
    supported, or otherwise enable scanning unconditionally in
    bt_mesh_provision().
    
    X-Original-Commit: 19752388f4202620652d615b153b334d48dcce3b

 nimble/host/mesh/src/lpn.c  | 14 ++++++++++----
 nimble/host/mesh/src/mesh.c |  7 ++-----
 2 files changed, 12 insertions(+), 9 deletions(-)

commit 304c737b798c0c7658ae70cbeb9000fa749dbbdf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:09:09 2017 +0100

    mesh: Fix documentation of bt_mesh_input_string()
    
    X-Original-Commit: ce083422272e420b0e2950ee558f7bda5ad7ef41

 nimble/host/mesh/include/mesh/main.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d50a44366668d56a7fadf8b25cdb5fca50cfcedc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:08:41 2017 +0100

    mesh: shell: Fix newline in incorrect place
    
    X-Original-Commit: 385fec42ff06c3a7a5104ca7c7f4e3d6d6f234ae

 nimble/host/mesh/src/shell.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2f9d84245f9df20dfd2959807a311e3747d6eb7a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:07:52 2017 +0100

    mesh: Allow changing cfg client message timeout
    
    10 seconds is quite long for configuration messages, and way too much
    currently since we only talk through the local networking interface.
    Set the default timeout to 2 seconds, and provide APIs through which
    the timeout may be changed at run-time (mainly useful for the shell).
    
    Note: The timeout_set() API is normally assumed to be called just once
    for an application, based on the expected size of the network (hops &
    latency). Trying to change it e.g. in a multi-threaded environment for
    every message may not yield the expected results.
    
    X-Original-Commit: 660ecf7659c2141d4b74e1521b1a473e69592031

 nimble/host/mesh/include/mesh/cfg_cli.h |  3 +++
 nimble/host/mesh/src/cfg_cli.c          | 38 ++++++++++++++++++++------------
 nimble/host/mesh/src/shell.c            | 39 +++++++++++++++++++++++++++++++++
 3 files changed, 66 insertions(+), 14 deletions(-)

commit d6b342123597e8d689c7bfb84731863819f7396c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:05:30 2017 +0100

    mesh: shell: Convert hb-sub-set command to hb-sub
    
    Convert the hb-ub-set command to a more generic hb-sub that can be
    used both for getting and setting the Heartrate Subscription State.
    
    X-Original-Commit: 46eaa01c1ff466f914c3c06456c35202a382b469

 nimble/host/mesh/src/shell.c | 49 +++++++++++++++++++++++++++++++++++++-------
 1 file changed, 42 insertions(+), 7 deletions(-)

commit b91d881171c59f50e432b5556f6753fd9284aa15
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:02:07 2017 +0100

    mesh: Add support for sending Heartbeat Subscription Get
    
    Add support for sending the Heartrate Subscription Get message.
    
    X-Original-Commit: fdc543757b86e67b4e276c2add714070d718c682

 nimble/host/mesh/include/mesh/cfg_cli.h |  4 ++
 nimble/host/mesh/src/cfg_cli.c          | 89 +++++++++++++++++++++------------
 2 files changed, 60 insertions(+), 33 deletions(-)

commit e24b6cc7bb2379e38eaaace8b1d5c6685d2ce5ff
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 16:00:51 2017 +0100

    mesh: shell: Convert hb-pub-set command to hb-pub
    
    Convert the hb-pub-set command to a more generic hb-pub that can be
    used both for getting and setting the Heartrate Publication State.
    
    X-Original-Commit: 0ad543c7485de6e296c2b28059f898fd66b53a71

 nimble/host/mesh/src/shell.c | 48 +++++++++++++++++++++++++++++++++++++++-----
 1 file changed, 43 insertions(+), 5 deletions(-)

commit da412928beaaaed20fadfa7ede39ddd7ba006269
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 15:53:46 2017 +0100

    mesh: Add support for sending Heartbeat Publication Get
    
    Add support for sending the Heartrate Publication Get message.
    
    X-Original-Commit: 5df84b2bb037f47088b3c6b838c78fb0b0394cee

 nimble/host/mesh/include/mesh/cfg_cli.h |  4 +++
 nimble/host/mesh/src/cfg_cli.c          | 50 +++++++++++++++++++++++++++++++++
 2 files changed, 54 insertions(+)

commit 40447d741f83bc482d98221561540e1e5f03f76b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 15:47:15 2017 +0100

    mesh: shell: Add provision command for self-provisioning
    
    This is for testing purposes, in case an external provisioner is not
    available or not wanted.
    
    X-Original-Commit: 0b1cc5370b13aa08f751031872c375cbc887f2b5

 nimble/host/mesh/src/shell.c | 42 ++++++++++++++++++++++++++++++++++++++++--
 1 file changed, 40 insertions(+), 2 deletions(-)

commit 6427ffd3a95dee134b42b9c0ffb58c647ed8569d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 15:44:57 2017 +0100

    mesh: shell: Add hb-pub-set command
    
    X-Original-Commit: eb5946839c119679a6a7d06244ccde151eb451c4

 nimble/host/mesh/src/shell.c | 39 +++++++++++++++++++++++++++++++++++++++
 1 file changed, 39 insertions(+)

commit 51c9330cde1d173db42f35c7f6e5b5d998405614
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 15:42:13 2017 +0100

    mesh: Add support for sending Heartbeat Publication Set
    
    X-Original-Commit: bc534f73934df83f8a7c5b014474cb0518afb21f

 nimble/host/mesh/include/mesh/cfg_cli.h |  4 ++
 nimble/host/mesh/src/cfg_cli.c          | 95 +++++++++++++++++++++++++++++++++
 2 files changed, 99 insertions(+)

commit 6ef16e8bc16b6153c0c0c2dd16caa7f906838b61
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 14:12:42 2017 +0100

    mesh: Add documentation for public provisioning APIs
    
    Add proper documentation for public provisioning APIs.
    
    X-Original-Commit: 407e91e9a44cd46b03b4339e2be6a57b64f309da

 nimble/host/mesh/include/mesh/main.h | 89 +++++++++++++++++++++++++++++++++++-
 1 file changed, 87 insertions(+), 2 deletions(-)

commit 83c75d185ee1f2964d32cfe732a525e972a89995
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 14:09:51 2017 +0100

    mesh: Fix calling complete callback for bt_mesh_provision()
    
    If the app does direct provisioning, it may still want to do common
    handling through its provisioning complete callback (if it has one
    registered). This also means that we always require a non-NULL
    provisioning context provided to bt_enable(), and that it needs to
    fail if NULL was given.
    
    X-Original-Commit: 89f8f47ad0f8608b291f1f3553d6ef11b4141b82

 nimble/host/mesh/src/mesh.c |  4 ++++
 nimble/host/mesh/src/prov.c | 21 +++++++++++++++------
 nimble/host/mesh/src/prov.h |  1 +
 3 files changed, 20 insertions(+), 6 deletions(-)

commit 4758977da4cc81980b9b408ab56eb63e6d772759
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 14:06:30 2017 +0100

    mesh: Provisioning: Add NetKeyIndex to complete callback
    
    It may be useful for the app to know what the initial NetKeyIndex that
    it was given during provisioning is.
    
    X-Original-Commit: 0aa31ba653c308143fe6eec5532a318681b8edd3

 nimble/host/mesh/include/mesh/main.h | 2 +-
 nimble/host/mesh/src/prov.c          | 2 +-
 nimble/host/mesh/src/shell.c         | 6 ++++--
 3 files changed, 6 insertions(+), 4 deletions(-)

commit a1b668ed54de92a757391fd677643e4a532ef68f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 14:02:37 2017 +0100

    mesh: shell: Group global variables in a dedicated struct
    
    This avoids conflicts with function-local variables being called the
    same way.
    
    X-Original-Commit: f6b6de50133b4fc4a1bcaa732ccf922947de0a67

 nimble/host/mesh/src/shell.c | 89 ++++++++++++++++++++++++--------------------
 1 file changed, 49 insertions(+), 40 deletions(-)

commit 57b7ad3d58885554c14817ca082eddf83eed7acb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 14:01:47 2017 +0100

    mesh: Provide documentation for provisioning APIs
    
    X-Original-Commit: 2c200b48ce3ad680cc21200829641ada9a67a552

 nimble/host/mesh/include/mesh/main.h | 36 ++++++++++++++++++++++++++++++++++++
 1 file changed, 36 insertions(+)

commit e0c5ff40526acc6e9893d60e98f47e01b8e7c1a4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 14:01:10 2017 +0100

    mesh: Rename health server code from health to health_srv
    
    This is in anticipation of soon adding health client support, which
    could then cause confusion due to the ambiguous API names.
    
    X-Original-Commit: 5e53a0a2f64dc337f682a7c46a8f1f552d6ae978

 nimble/host/mesh/include/mesh/health_srv.h      |  6 +++---
 nimble/host/mesh/src/access.c                   |  2 +-
 nimble/host/mesh/src/foundation.h               |  2 +-
 nimble/host/mesh/src/{health.c => health_srv.c} | 26 ++++++++++++-------------
 nimble/host/mesh/src/shell.c                    |  2 +-
 5 files changed, 19 insertions(+), 19 deletions(-)

commit abf2733a0a1d841577d01b3ddb8d1df7ed980944
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:56:30 2017 +0100

    mesh: Rename configuration server code from cfg to cfg_srv
    
    Now that there's support for configuration client as well, rename cfg
    to cfg_srv to avoid any confusion.
    
    X-Original-Commit: e9ef27976c5549e63a0952227cd1261d76018baa

 nimble/host/mesh/include/mesh/cfg_srv.h   |  6 ++---
 nimble/host/mesh/src/access.c             |  6 ++---
 nimble/host/mesh/src/{cfg.c => cfg_srv.c} | 44 +++++++++++++++----------------
 nimble/host/mesh/src/foundation.h         |  2 +-
 nimble/host/mesh/src/shell.c              |  2 +-
 5 files changed, 30 insertions(+), 30 deletions(-)

commit 6d2f91e52bfd13a91bb6211f3f90e4cba75aa313
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:45:11 2017 +0100

    mesh: Add more flexible APIs for provisioning bearers
    
    Add the ability to track the provisioning bearer through an extra
    parameter to link_open/close. Also introduce new public functions to
    enable/disable specific provisioning bearers. This also means that one
    now needs to explicitly enable provisioning bearers after calling
    bt_mesh_init().
    
    X-Original-Commit: 6508743e65d150fbbef91fbbcc9ba3561e491767

 nimble/host/mesh/include/mesh/glue.h |  4 ++
 nimble/host/mesh/include/mesh/main.h | 13 +++++-
 nimble/host/mesh/src/beacon.c        |  3 --
 nimble/host/mesh/src/mesh.c          | 68 +++++++++++++++++++++-------
 nimble/host/mesh/src/prov.c          | 16 +++++--
 nimble/host/mesh/src/prov.h          |  2 +
 nimble/host/mesh/src/proxy.c         |  4 ++
 nimble/host/mesh/src/shell.c         | 87 +++++++++++++++++++++++++++++++++---
 8 files changed, 167 insertions(+), 30 deletions(-)

commit 1732e186ffbf3d24006a3d31ea9d3acdf6f92653
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:27:34 2017 +0100

    mesh: Use proper _t suffix for typedefs
    
    To be consistent with the coding style, use a _t suffix for typedefs.
    
    X-Original-Commit: c421d9906a6e7ca3f713c3396e1f6943cd7d8429

 nimble/host/mesh/include/mesh/main.h | 8 ++++----
 nimble/host/mesh/src/prov.c          | 8 ++++----
 nimble/host/mesh/src/shell.c         | 6 +++---
 3 files changed, 11 insertions(+), 11 deletions(-)

commit 6a6dfa537aa618f61d8baf573c9127350cbabdcd
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:21:32 2017 +0100

    mesh: shell: Add hb-sub-set command
    
    X-Original-Commit: b1d7e68f311b7cf6fb49655c7d62c4fe3f13ab42

 nimble/host/mesh/src/shell.c | 36 ++++++++++++++++++++++++++++++++++++
 1 file changed, 36 insertions(+)

commit 025fd1d82ea34cf4e4ad995414cbd3c1e64282d7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:19:59 2017 +0100

    mesh: shell: Add mod-sub-add command
    
    X-Original-Commit: b6adef7f4f63f17cb4e2a921a880033dd2588a46

 nimble/host/mesh/src/shell.c | 44 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)

commit b0cea7da5a26972328e983777f6ebaa0938c7310
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:18:16 2017 +0100

    mesh: shell: Add app-key-bind command
    
    X-Original-Commit: 2a9b29e986b2530c29170761a6736957f5687735

 nimble/host/mesh/src/shell.c | 43 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)

commit 81373a98fc40b79d21471b28f60f08a94a13b7fb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:16:46 2017 +0100

    mesh: shell: Add app-key-add command
    
    X-Original-Commit: 411fd62e81de3a0930998e6dd20ac0f46b8e842a

 nimble/host/mesh/src/shell.c | 38 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 38 insertions(+)

commit c7eaae845af35abf161a4c93d497ed6470c40aa8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:14:47 2017 +0100

    mesh: shell: Add for relay and 1-byte state commands
    
    Add commands for 1-byte states such as Default TTL, Friend and GATT
    Proxy, as well as the 2-byte Relay state.
    
    X-Original-Commit: a06aaf54b780cc5a997cd55a1fb3f942a1cd66ed

 nimble/host/mesh/src/shell.c | 134 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 134 insertions(+)

commit fbf79b2b1635b43e5564aef97d14169968029716
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:10:41 2017 +0100

    mesh: shell: Add support for Beacon Get/Set
    
    X-Original-Commit: a17ac8377097442e0b61251a1b368708d5de0841

 nimble/host/mesh/src/shell.c | 30 +++++++++++++++++++++++++++++-
 1 file changed, 29 insertions(+), 1 deletion(-)

commit 016e8d335ae9ee46f85b16077f1025fb2da8b401
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:08:32 2017 +0100

    mesh: shell: Add "dst" & "netidx" commands
    
    Add commands to modify the used destination address and NetIdx.
    
    X-Original-Commit: 8949ddad753dbca18085c0e4321cc032c7737c77

 nimble/host/mesh/src/shell.c | 43 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)

commit 2194229e084e54269932781cae70675b24c67547
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:06:08 2017 +0100

    mesh: shell: Add support for getting composition data
    
    X-Original-Commit: c3196e43b764d8b856866fec5b99a3588fa3cf04

 nimble/host/mesh/src/shell.c | 87 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 87 insertions(+)

commit 4712e4e7113670949e431a06bc810d13f51b4acc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:04:06 2017 +0100

    mesh: Add support for sending Heartbeat Subscription Set
    
    X-Original-Commit: f6285d2e28953c9d1c98979435a74bf67aba75b6

 nimble/host/mesh/include/mesh/cfg_cli.h |   3 +
 nimble/host/mesh/src/cfg_cli.c          | 115 ++++++++++++++++++++++++++++++++
 2 files changed, 118 insertions(+)

commit 360c0f2ce3e87184f098eef71122763ce7bc4c67
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:03:29 2017 +0100

    mesh: Add support for sending Model Subscription Add
    
    X-Original-Commit: f5f1b7d77fec5793e5f82dacb2e1fab4db42c001

 nimble/host/mesh/include/mesh/cfg_cli.h |   7 ++
 nimble/host/mesh/src/cfg_cli.c          | 126 ++++++++++++++++++++++++++++++++
 2 files changed, 133 insertions(+)

commit a8340ee0bb974bced02d0ee16113d0e2f546b98e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:02:40 2017 +0100

    mesh: Add support for sending Model App Bind message
    
    X-Original-Commit: c5d0c57f8bac2b6332fadc7c382be4d64bb915cb

 nimble/host/mesh/include/mesh/cfg_cli.h |   7 ++
 nimble/host/mesh/src/cfg_cli.c          | 130 ++++++++++++++++++++++++++++++++
 2 files changed, 137 insertions(+)

commit 4ff4684c6d85277d772cfb0ac53c8b075f30296f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:01:45 2017 +0100

    mesh: Add support for sending AppKeyAdd message
    
    X-Original-Commit: 3f13cfcbf449f642947119224b97e63f3b4fd3ec

 nimble/host/mesh/include/mesh/cfg_cli.h |  4 ++
 nimble/host/mesh/src/cfg_cli.c          | 82 +++++++++++++++++++++++++++++++++
 2 files changed, 86 insertions(+)

commit 670a4b82ff3328c9e57335ab665efa46a07c846b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 13:00:56 2017 +0100

    mesh: Add support for Relay and 1-byte state Get/Set
    
    Add support to the Configuration Client Model for getting and setting
    1-byte states (which can be nicely generalized in code) as well as the
    2-byte Relay state.
    
    X-Original-Commit: 6bb823b4b5f3db7627cff47acc731c914ff8a463

 nimble/host/mesh/include/mesh/cfg_cli.h |  19 +++
 nimble/host/mesh/src/cfg_cli.c          | 219 ++++++++++++++++++++++++++++++--
 2 files changed, 225 insertions(+), 13 deletions(-)

commit e2a9ef5cdb5e38cf519baa4fe07f598d710fa57a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 12:59:04 2017 +0100

    mesh: Add support for sending Beacon Get & Set
    
    X-Original-Commit: f69d6de6efb8eedd54cb5f11f364536e2c59a3bc

 nimble/host/mesh/include/mesh/cfg_cli.h |   4 ++
 nimble/host/mesh/src/cfg_cli.c          | 120 +++++++++++++++++++++++++++++---
 2 files changed, 116 insertions(+), 8 deletions(-)

commit 842f23533104ce18c82125a749f6abf1fd9adcf6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 12:21:10 2017 +0100

    mesh: Add support for sending Get Composition Data
    
    Add Get Composition Data support to the Configuration Client Model.
    
    X-Original-Commit: 08e5d0ceabe496345adfc25e809d7cf8685e3ecb

 nimble/host/mesh/include/mesh/cfg_cli.h |  10 ++-
 nimble/host/mesh/include/mesh/glue.h    |  18 ++++++
 nimble/host/mesh/src/access.c           |   3 +
 nimble/host/mesh/src/cfg_cli.c          | 108 ++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/foundation.h       |   2 +
 5 files changed, 140 insertions(+), 1 deletion(-)

commit 0046a7d4757462172b561f024bebaca6b1268a0d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 11:54:02 2017 +0100

    mesh: Add primary address to provisioning complete callback
    
    It may be useful for the app to know that the local node's primary
    address is.
    
    X-Original-Commit: 8ab991863e58c060f2ec5d72acc6d76bc94041e7

 nimble/host/mesh/include/mesh/main.h | 2 +-
 nimble/host/mesh/src/prov.c          | 2 +-
 nimble/host/mesh/src/shell.c         | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)

commit 95b0a27c3a9752f1a9bdd658acec681f39527a52
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 11:51:50 2017 +0100

    mesh: shell: Add command for Node Identity
    
    X-Original-Commit: 8a145a868902691beac042720bdc4ac0d1333a58

 nimble/host/mesh/src/shell.c | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

commit 0c96fcc54c6008b871f3c4566d383aecf858a2a3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 11:49:50 2017 +0100

    mesh: shell: Take advantage of link open/close callbacks
    
    X-Original-Commit: 8be83d4bfb228f7e78208cc8b44217ff0c1a29a8

 nimble/host/mesh/src/shell.c | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 33757058d3179b1d3738e8b92aa991d0c0e6f218
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 11:49:16 2017 +0100

    mesh: shell: Add LPN toggling command
    
    X-Original-Commit: 481530c31e76cd5ddbee1836049626a498e8ea02

 nimble/host/mesh/src/shell.c | 53 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 53 insertions(+)

commit 0854a8cc6fa6e7569219cdaaa85d1ea8308fdaba
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 17 11:40:24 2017 +0100

    mesh: shell: Add basic skeleton
    
    Add a basic shell skeleton for Mesh, containing basic command for
    initialization, provisioning and reset.
    
    X-Original-Commit: 23cb76a4fad19a4c4a152b9f90d16814341f525f

 nimble/host/mesh/include/mesh/glue.h |   1 +
 nimble/host/mesh/pkg.yml             |   3 +
 nimble/host/mesh/src/mesh.c          |   5 +
 nimble/host/mesh/src/shell.c         | 223 +++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/shell.h         |   6 +
 nimble/host/mesh/syscfg.yml          |   6 +
 6 files changed, 244 insertions(+)

commit 11e2d4843d13419b35ddd4ec7cc0db63e5499036
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 17:08:24 2017 +0100

    mesh: Add skeleton for Configuration Client Model
    
    X-Original-Commit: 66818102b09f8d330f93d303ccb7607d7c3311de

 nimble/host/mesh/include/mesh/cfg_cli.h | 34 +++++++++++++++++++++++++++++++++
 nimble/host/mesh/include/mesh/mesh.h    |  4 ++++
 nimble/host/mesh/src/cfg_cli.c          | 20 +++++++++++++++++++
 nimble/host/mesh/syscfg.yml             |  5 +++++
 4 files changed, 63 insertions(+)

commit f7e8c81b67d5c031f21fa530dae0870240038f1c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 16:52:34 2017 +0100

    mesh: Make TRANSMIT_COUNT & TRANSMIT_INT macros public
    
    These are useful for apps who want to implement/use the Configuration
    Client Model.
    
    X-Original-Commit: 3d7ac73dd3bec03ff099ce544fdc95119b6f04bf

 nimble/host/mesh/include/mesh/access.h | 20 ++++++++++++++++++++
 nimble/host/mesh/src/cfg.c             | 13 ++++++++-----
 nimble/host/mesh/src/foundation.h      |  5 -----
 nimble/host/mesh/src/friend.c          |  5 ++++-
 nimble/host/mesh/src/net.c             |  5 +++--
 nimble/host/mesh/src/transport.c       | 14 ++++++++------
 6 files changed, 43 insertions(+), 19 deletions(-)

commit 9590a0dbd18176e17cce6c1c1ac78bd0878c2fe1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 16:25:48 2017 +0100

    mesh: Reformat headers to match Zephyr's coding style
    
    X-Original-Commit: 36cac25e288b6fe935ac7654d35a1662fc80fa45

 nimble/host/mesh/src/access.h     |  55 +++----
 nimble/host/mesh/src/adv.h        |  46 +++---
 nimble/host/mesh/src/beacon.h     |  19 +--
 nimble/host/mesh/src/crypto.h     |   4 +-
 nimble/host/mesh/src/foundation.h |  50 +++---
 nimble/host/mesh/src/friend.h     |   4 +-
 nimble/host/mesh/src/lpn.h        |  40 +++--
 nimble/host/mesh/src/mesh_priv.h  |   3 +-
 nimble/host/mesh/src/net.h        | 311 ++++++++++++++++++--------------------
 nimble/host/mesh/src/prov.h       |  24 +--
 nimble/host/mesh/src/proxy.h      |   2 +-
 nimble/host/mesh/src/transport.h  |  90 +++++------
 12 files changed, 286 insertions(+), 362 deletions(-)

commit 7311bd1bd938111c698214ab60741b2c4133775c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 16:01:45 2017 +0100

    mesh: Refactor public headers
    
    As the number of mesh APIs grows it becomes a bit cumbersome to have
    everything in a single header file. Split the mesh.h header file into
    multiple files, and include the new headers from the old one to retain
    backwards compatibility and simplicity for apps.
    
    X-Original-Commit: 6e72e7661643250d5c59a548ac43326aeb29b008

 nimble/host/mesh/include/mesh/access.h     | 301 ++++++++++++++
 nimble/host/mesh/include/mesh/cfg_srv.h    |  69 ++++
 nimble/host/mesh/include/mesh/glue.h       |   9 +
 nimble/host/mesh/include/mesh/health_srv.h |  63 +++
 nimble/host/mesh/include/mesh/main.h       | 157 ++++++++
 nimble/host/mesh/include/mesh/mesh.h       | 622 +----------------------------
 nimble/host/mesh/include/mesh/proxy.h      |  35 ++
 7 files changed, 646 insertions(+), 610 deletions(-)

commit 6e53b1c2cd8546350ae84f03c192747e2c3c2fbc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 15:19:36 2017 +0100

    mesh: Fix relaying packets
    
    The restoring of the buffer parsing state was only correct for the
    friend queue (which needs the app-layer data). Relaying on the other
    hand requires the network layer data, i.e. it needs a different state
    to be restored.
    
    X-Original-Commit: 515b2216d60c55a7e4509c44c6e92753ae5dd3f7

 nimble/host/mesh/src/net.c       | 5 +++++
 nimble/host/mesh/src/transport.c | 4 ++--
 2 files changed, 7 insertions(+), 2 deletions(-)

commit 669dcf72c0b171a9aabb4f14187e6f50e0ec8feb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 15:17:58 2017 +0100

    mesh: Fix missing tracking of segment callback
    
    X-Original-Commit: e2f66131b425ce37bb2592a90b84cd48372d867f

 nimble/host/mesh/src/transport.c | 2 ++
 1 file changed, 2 insertions(+)

commit 178b2a051fd8ee55f51620e4a93efb356ed5fabf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 15:17:25 2017 +0100

    mesh: Take advantage of BT_MESH_TTL_MAX macro
    
    X-Original-Commit: 06610675177dc84bb2364b2323cc89111ec77a4f

 nimble/host/mesh/src/cfg.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit ed72ea79544966aba733e9eee89170ba7177f64a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 15:12:46 2017 +0100

    mesh: Export key packing helpers internally
    
    X-Original-Commit: 9c34d2902e265c9d61ed2cc77eaefb57b03448be

 nimble/host/mesh/src/cfg.c        | 15 ---------------
 nimble/host/mesh/src/foundation.h | 15 +++++++++++++++
 2 files changed, 15 insertions(+), 15 deletions(-)

commit 5084e4b2cc964aa2601998a0faf27722ff5e9cf4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 15:09:42 2017 +0100

    mesh: Fix sending messages when not provisioned
    
    The message sending APIs should fail cleanly if we are not yet
    provisioned.
    
    X-Original-Commit: eb04eb5f4f22e67a746415cc973cad80cb6d8bc3

 nimble/host/mesh/src/access.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 942363391235c36f783da48f48bde42abbf1cac9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 15:07:31 2017 +0100

    mesh: Change local_queue from k_fifo to sys_slist_t
    
    We never access the local network interface queue in a blocking
    fashing, so it's unnecessary to have all the infrastructure that
    k_fifo provides. Use the simpler sys_slist_t instead.
    
    X-Original-Commit: 4b9a0f0be09945ce0ed077941c7d9f881d7430a9

 nimble/host/mesh/src/net.c | 6 +++---
 nimble/host/mesh/src/net.h | 9 ++++-----
 2 files changed, 7 insertions(+), 8 deletions(-)

commit 2c7183b828c0876996f70dda60b822e49bb17e3a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:58:53 2017 +0100

    mesh: Clarify API for empty model arrays
    
    Avoid applications defining empty model arrays by themselves by
    documenting the BT_MESH_MODEL_NONE helper macro (renamed to be more
    intuitive).
    
    X-Original-Commit: 828eb55f39ca661165c58a736a649ca275616e0d

 nimble/host/mesh/include/mesh/mesh.h | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit ca35f5103e7ebf49ee9b45070989198413e90bb5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:52:17 2017 +0100

    mesh: Provisioning: Introduce link open/close callbacks
    
    It may be useful for the app to know when the provisioning link is
    active and when it has been closed. This can be used e.g. to signal
    the user the state of the device. Some PTS tests also require
    verifying the link state.
    
    X-Original-Commit: 11f8d4c9b0156675f49d558e12b6c7b86ccec88a

 nimble/host/mesh/include/mesh/mesh.h |  5 +++--
 nimble/host/mesh/src/prov.c          | 18 ++++++++++++++++++
 2 files changed, 21 insertions(+), 2 deletions(-)

commit 95ca1b9099ea1578403f626ac3ec504ee33e508c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:49:20 2017 +0100

    mesh: Provisioning: Make static OOB value const
    
    This makes it possible for the actual value to reside in ROM.
    
    X-Original-Commit: 70a4b92d1ba10b5ef955609f4a7c4bb61858e29d

 nimble/host/mesh/include/mesh/mesh.h | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit 845374464727552dd717042c7f3fbc66fc4dc78c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:47:59 2017 +0100

    mesh: Provisioning: Fix encoding of OOB values into link.auth
    
    X-Original-Commit: 506a58ea5df517b4c98aee97b0e0e9357ae6b3a7

 nimble/host/mesh/src/prov.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit f57490e8389175a7a1e1a943de2ca8ab4757b8f4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:47:28 2017 +0100

    mesh: Provisioning: Fix input OOB support
    
    The code was missing the sending of the Input Complete PDU, and was
    also setting the link.auth value too late.
    
    X-Original-Commit: 41acb4cff915d87015827bf1efb2c6190cf0ade1

 nimble/host/mesh/src/prov.c | 24 ++++++++++++++++++++----
 1 file changed, 20 insertions(+), 4 deletions(-)

commit 8145996ce4cca29ef0f367a04ee375f8685b2d99
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:45:29 2017 +0100

    mesh: Provisioning: Fix coding style (too long line)
    
    X-Original-Commit: e833827d6f85ef1f7a9fc4127b4553d05ccc3e4d

 nimble/host/mesh/src/prov.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit c049eca189961912ede687438d1e651f11cd55f2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:44:55 2017 +0100

    mesh: Provisioning: Fix OOB string output
    
    The OOB string was being generated in an incorrect way, resulting
    essentially in garbage.
    
    X-Original-Commit: b57b0174293be45ddb03691fdd9307041181d88d

 nimble/host/mesh/src/prov.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6758b99e4b047dac0b7023f5a90e840018b0127d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:43:28 2017 +0100

    mesh: Use a saner default ReceiveDelay in syscfg.yml
    
    A value of 20ms means it's possible the LPN will end up doing
    simultaneous advertising & scanning, which increases the risk of lost
    packets. Use a default of 100ms to keep these separate.
    
    X-Original-Commit: 896af563610927ecc0178401466d045074f58b47

 nimble/host/mesh/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9a47b14522c3fb0ccad3d594bc20a5aa4492b711
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:42:33 2017 +0100

    mesh: Implement handling of Friend Clear messages
    
    Handling Friend Clear messages and sending the Friend Clear
    Confirmation responses wasn't so far properly implemented. One of the
    requirements is to keep sending the reponses even though we no-longer
    have a friendship. This means that we need to keep the net_idx, frnd
    and lpn_counter values valid, which in turn requires the introduction
    of a separate "valid" boolean value.
    
    X-Original-Commit: 5ab81ec533372bf420584ac7513adf66bb83fd81

 nimble/host/mesh/src/cfg.c    |  2 +-
 nimble/host/mesh/src/friend.c | 51 +++++++++++++++++++++++++++++++++----------
 nimble/host/mesh/src/friend.h |  4 ++--
 nimble/host/mesh/src/net.h    |  1 +
 4 files changed, 43 insertions(+), 15 deletions(-)

commit 80e6ef18659a026d310e5f8e27e6d024168ae0bf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:41:33 2017 +0100

    mesh: Set PTS-friendly Friendship values in syscfg.yml
    
    The PTS tests for the Friend node expect a minimum of 16 queued
    messages and the ability to have two LPNs. Set these as defaults.
    
    X-Original-Commit: 96cc5ca7c771be14d053571f9c60cc1fc04047ed

 nimble/host/mesh/syscfg.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 3bef53b997d1521bc66254f3e1ac7fd244442302
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:40:24 2017 +0100

    mesh: Implement the Friend Clear procedure
    
    When a Friend Node receives a Friend Request with a unicast
    PreviousAddress that's not an element on the Friend Node, it needs to
    start the Friend Clear procedure. This procedure involves sending
    periodic Friend Clear messages to the old Friend of the LPN.
    
    X-Original-Commit: be4d4056cb52044dd8a1c705438cec736d05236a

 nimble/host/mesh/src/friend.c    | 142 +++++++++++++++++++++++++++++++++++++--
 nimble/host/mesh/src/friend.h    |   2 +
 nimble/host/mesh/src/net.h       |   8 +++
 nimble/host/mesh/src/transport.c |   6 +-
 4 files changed, 152 insertions(+), 6 deletions(-)

commit 1b59005759a819b9825729d2d3d74aed960ec07c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:35:18 2017 +0100

    mesh: Fix network credential selection
    
    The only messages that should be encrypted using the friendship
    credentials are those coming through the Friend Queue on the Friend
    node, most request-response pairs between LPN & Friend (exceptions are
    Friend Request - Friend Offer, and Friend Clear - Friend Clear
    Confirm), as well as Model Publication messages when the Friendship
    Credentials Flag has been enabled in the model publication.
    
    X-Original-Commit: 1df4f7f0c12e68df08c5b611af755e49123daae4

 nimble/host/mesh/include/mesh/mesh.h |  5 +----
 nimble/host/mesh/src/access.c        | 27 ++++++++++++++++-----------
 nimble/host/mesh/src/lpn.c           |  6 +++---
 nimble/host/mesh/src/net.c           | 29 ++++++++++-------------------
 nimble/host/mesh/src/net.h           | 13 ++++++-------
 nimble/host/mesh/src/transport.c     | 30 +++---------------------------
 6 files changed, 39 insertions(+), 71 deletions(-)

commit b3e33d8b714194f4a9db32811b084b076cdf8a8d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:28:26 2017 +0100

    mesh: Introduce LPN-specific adv transmit properties
    
    When the node is in LPN node, the LPN-Friend messages has its own
    retries, so doing this on the advertising level (i.e. following the
    network transmit state) is sub-optimal.
    
    X-Original-Commit: 69ff4e282c308b6d182a4b67dee5ef97db27672d

 nimble/host/mesh/src/lpn.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 2705e7dd4cabd31a982f25899bbf4c59a62f5e34
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:25:59 2017 +0100

    mesh: Allow passing adv transmit info in net_tx
    
    This makes it possible (in a subsequent patch) to fine-tune some
    special cases, like the LPN poll messages.
    
    X-Original-Commit: c6db53084ec78eb9d76c8ef5f194081abf6c7c00

 nimble/host/mesh/src/access.c    |  1 +
 nimble/host/mesh/src/cfg.c       |  1 +
 nimble/host/mesh/src/lpn.c       |  5 +++++
 nimble/host/mesh/src/net.h       |  1 +
 nimble/host/mesh/src/transport.c | 21 +++++++++------------
 5 files changed, 17 insertions(+), 12 deletions(-)

commit 448c48c7d478d3ba9b18b30c031524b708c11d43
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:23:47 2017 +0100

    mesh: Use more accurate timing for LPN functions
    
    Update the advertising callback to include the exact duration that we
    will be sending out the packet. This is useful since sometimes we want
    to use the end point of the advertising as the reference time to count
    when some other action should take place.
    
    X-Original-Commit: fc732dce6c1b92173d363099a34d10802bd8bd59

 nimble/host/mesh/src/adv.c       |  6 +++---
 nimble/host/mesh/src/adv.h       |  4 ++--
 nimble/host/mesh/src/beacon.c    |  4 ++--
 nimble/host/mesh/src/friend.c    |  6 +++---
 nimble/host/mesh/src/lpn.c       | 39 +++++++++++++++++++++------------------
 nimble/host/mesh/src/net.c       |  2 +-
 nimble/host/mesh/src/net.h       |  3 +++
 nimble/host/mesh/src/prov.c      |  9 +++++----
 nimble/host/mesh/src/transport.c |  5 +++--
 9 files changed, 43 insertions(+), 35 deletions(-)

commit aa99d7818c5b5cb5ee8c524567856e7dd1387369
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 14:13:00 2017 +0100

    mesh: Fix clearing friendship
    
    Lower the attempts and make sure we track the old Friend address for
    subsequent Friend Requests, in case we never receive a Clear
    Confirmation.
    
    X-Original-Commit: 451e0da02391d51b7ca92ad79806da3bce8213c7

 nimble/host/mesh/src/lpn.c | 33 ++++++++++++++++++++++++---------
 nimble/host/mesh/src/net.h |  6 +++++-
 2 files changed, 29 insertions(+), 10 deletions(-)

commit b9efac443e86f1f9dc5a61e0cff450cf74a15665
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 13:55:12 2017 +0100

    mesh: Fix sending Friend Clear messages indefinitely
    
    We should give up after a small number of attempts.
    
    X-Original-Commit: 8a10ddf463013b4df70c4f8d957ec253f7b3faa1

 nimble/host/mesh/include/mesh/glue.h | 1 +
 nimble/host/mesh/src/lpn.c           | 8 ++++++--
 2 files changed, 7 insertions(+), 2 deletions(-)

commit 732dd1006bb57923d22800001dbbee1f8ba975e6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 13:26:50 2017 +0100

    mesh: Improve Low Power establishment procedure
    
    Add some automated policies for starting LPN establishment and make it
    possible to perform the establishment in a "low power" way, i.e.
    switching to low duty-cycle already when starting to send Friend
    Requests.
    
    X-Original-Commit: 51cf9136535b2698301efeeecc8f5106b0aa7c79

 nimble/host/mesh/include/mesh/glue.h |   2 +
 nimble/host/mesh/src/lpn.c           | 139 +++++++++++++++++++++++++++--------
 nimble/host/mesh/src/lpn.h           |  14 +++-
 nimble/host/mesh/src/net.h           |  12 +--
 nimble/host/mesh/src/transport.c     |   7 +-
 nimble/host/mesh/syscfg.yml          |  29 ++++++++
 6 files changed, 163 insertions(+), 40 deletions(-)

commit fad6a71a8d95be0ad51ad0dac1d20b0a7d4dfe68
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 12:21:19 2017 +0100

    mesh: Fix ignoring prohibited ReceiveWindow value
    
    According to the Mesh Spec value 0x00 of ReceiveWindow parameter is
    prohibited. This is needed to pass MESH/NODE/FRND/LPN/BI-03-C.
    
    X-Original-Commit: ff7f43e8103550cfa041d2af1762fdef002d9ad2

 nimble/host/mesh/src/lpn.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 0a14e1e0d04a6274c2bcf5b7898bffbe8ca55342
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 12:20:25 2017 +0100

    mesh: Fix typo when iterating GATT clients
    
    The intention of the code was to access client->conn and not
    clients->conn (which would always access the first client struct).
    
    X-Original-Commit: 8d0ee67dffc93c02f053af8824022ebd2d6629e2

 nimble/host/mesh/src/proxy.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c4af06b388b64a93f6acbb521be2870a4c0d3d3d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 12:03:51 2017 +0100

    nimble/host: Fix Mesh feature description in syscfg.yml
    
    Reformulate the description text for BLE_MESH.
    
    X-Original-Commit: 3fd472573892227fffad4def27517bc545d3a444

 nimble/host/syscfg.yml | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 50a4227a1542299b4d950cd57d3522fecce370f4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 12:01:27 2017 +0100

    mesh: Fix net_find_and_decrypt() function
    
    The function return type was declared incorrectly. Also, the magic
    checking for i after exiting the loop could cause some false positive
    compiler warnings. Instead, return directly from the loop (with the
    downside of duplicating a few lines of code).
    
    X-Original-Commit: 32a3236468ebf200436121308c5d9d5c4e07dbb6

 nimble/host/mesh/src/net.c | 24 ++++++++++++------------
 1 file changed, 12 insertions(+), 12 deletions(-)

commit aad4fe0c43ec1ce5ba5fd1a2e42b1b65ba224d26
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:59:55 2017 +0100

    mesh: Avoid using 64-bit storage & math for beacons
    
    It's in practice impossible for the time between two beacons to be
    more than 50 hours (the approximate wrap-around time for a 32-bit
    millisecond timer), so we can use a 32-bit timestamp instead of a
    64-bit one for the beacon tracking.
    
    X-Original-Commit: 921902085eb1b7bf99a2c082da0524dd0fc40efe

 nimble/host/mesh/src/beacon.c | 25 +++++++++++++++----------
 nimble/host/mesh/src/net.h    |  5 ++---
 2 files changed, 17 insertions(+), 13 deletions(-)

commit 98582e688287ff4c8d8596602aeb4a52085e7593
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:56:08 2017 +0100

    mesh: Fix network decryption in case of multiple LPNs
    
    If we are a Friend node with multiple LPNs, we need to iterate through
    all available Friendship credentials to find the right keys.
    
    X-Original-Commit: b49cf7b6644c37fcfeb5878dc983704d1ec4239f

 nimble/host/mesh/src/net.c | 107 ++++++++++++++++++++++++++++-----------------
 1 file changed, 67 insertions(+), 40 deletions(-)

commit 2855e1fc9c2a677d4f98addd90d7645bb7087427
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:52:45 2017 +0100

    mesh: Simplify & fix net credentials selection
    
    The Mesh spec expects us to fall back to master credentials if
    friendship ones are not available. Also remove an unnecessary branch
    with the help of a new 'idx' variable.
    
    X-Original-Commit: 09c1d9dda9791ef24e90e10469e817f6ca17d88b

 nimble/host/mesh/src/net.c       | 41 ++++++++++++++++------------------------
 nimble/host/mesh/src/transport.c |  5 +++++
 2 files changed, 21 insertions(+), 25 deletions(-)

commit 9a3814501eb69d408ae30acddedd30705410e474
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:51:15 2017 +0100

    mesh: Remove unnecessary per-buffer segment context
    
    The friend_cred and new_key information is common for all segments of
    a segmented transaction, so it makes sense to store them as part of
    struct seg_tx instead of each buffer's user data.
    
    X-Original-Commit: bd4fecfb37d6b5af375874eefe71a659a987e0d2

 nimble/host/mesh/src/adv.h       |  2 +-
 nimble/host/mesh/src/transport.c | 16 ++++++++--------
 2 files changed, 9 insertions(+), 9 deletions(-)

commit 92cc1d3327bd69a78738c3f18f951c53e274e732
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:49:40 2017 +0100

    mesh: Fix friendship credential usage for segmented messages
    
    The friend_cred hint needs to be set already at the point of
    segmenting, i.e. doing it in bt_mesh_net_send() is too late. Move the
    setting to bt_mesh_trans_send() and bt_mesh_ctl_send().
    
    X-Original-Commit: 399ab47a166236843e3a36c38e300c09c72037d5

 nimble/host/mesh/src/lpn.h       | 13 +++++++++++--
 nimble/host/mesh/src/net.c       | 13 ++-----------
 nimble/host/mesh/src/transport.c | 16 ++++++++++++++++
 3 files changed, 29 insertions(+), 13 deletions(-)

commit 25401270567c95b027e6df22d1152f3aef42c9af
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:45:54 2017 +0100

    mesh: Fix ignoring invalid Transport OpCode as LPN
    
    MESH/NODE/FRND/LPN/BI-02-C requires us to ignore unknown Transport
    OpCodes instead of treating them as valid responses to a Friend Poll.
    
    X-Original-Commit: 5a75116cbdb9fde6e7710b258ddae63c77a9a374

 nimble/host/mesh/include/mesh/glue.h | 1 +
 nimble/host/mesh/src/transport.c     | 6 +++++-
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 70be508e2acce2d99ab53e5a1f75f078d911df95
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:44:03 2017 +0100

    mesh: Fix retries when establishing Friendship as LPN
    
    The Mesh Specification recommends retrying up to 6 times the Friend
    Poll when establishing Friendship as LPN.
    
    X-Original-Commit: 819d2dd9f5c6b96987dad3fde61764760b4bed82

 nimble/host/mesh/src/lpn.c | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit 698ef996e1436085c164a85e9b7993a3fe506ea7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:43:31 2017 +0100

    mesh: Improve debug logs for provisioning
    
    X-Original-Commit: 6f3929f7952e9a05781e2526bebb9d571243cab9

 nimble/host/mesh/src/mesh.c | 4 +++-
 nimble/host/mesh/src/net.c  | 4 +++-
 2 files changed, 6 insertions(+), 2 deletions(-)

commit d794e55416670635f1a2cfbb1f4998e19b74c5d3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:42:22 2017 +0100

    mesh: Fix provisioning with Key Refresh flag set
    
    We should not have any valid key material in key slot 0 if the KR flag
    is set, since then the new key/old key information will be incorrect
    when network PDUs get decrypted.
    
    X-Original-Commit: be8250d36a5401c4bf6e9ce6340285deccb5628c

 nimble/host/mesh/src/net.c | 22 +++++++++++++---------
 1 file changed, 13 insertions(+), 9 deletions(-)

commit 911cac6aff172574a29981d30da5d1776955dcc0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:41:46 2017 +0100

    mesh: Improve acknowledgement timer calculation
    
    According to the Mesh Profile Specification: "The acknowledgment timer
    shall be set to a minimum of 150 + 50 * TTL milliseconds".
    
    X-Original-Commit: 658e542d2ceeaae3ba1e64f5dc59d429cb3430b6

 nimble/host/mesh/src/transport.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit a3d8bb8636fd198107e15252eaf80fe2337dccbc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:40:47 2017 +0100

    mesh: Fix message replay protection
    
    The Mesh Profile Specification states that replay protection must be
    done for all control and access messages. Furthermore, the replay
    protection list must be updated with the sequence from the last
    segment of a segmented message (the code was only updating based on
    SeqZero).
    
    X-Original-Commit: fe6073cd2534f1e7d4120cf8119d16a8b4e4eb12

 nimble/host/mesh/src/transport.c | 21 ++++++++++++++-------
 1 file changed, 14 insertions(+), 7 deletions(-)

commit 55de0023a2ebc698e540e69b36132a64003b88cb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:39:15 2017 +0100

    mesh: Fix transport layer heartbeat subscription matching
    
    X-Original-Commit: 1f645b367078554e5c3f05a2a37b06af78e86639

 nimble/host/mesh/src/cfg.c       |  3 ++
 nimble/host/mesh/src/mesh.c      |  2 ++
 nimble/host/mesh/src/transport.c | 75 ++++++++++++++++++++++++----------------
 nimble/host/mesh/src/transport.h |  4 +++
 4 files changed, 54 insertions(+), 30 deletions(-)

commit f7b8478a362cc375d4407a333e075e1d301123cf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 11:22:08 2017 +0100

    mesh: Cfg: Implement Low Power Node PollTimeout Get fully
    
    Now that Friend support is complete we can create a full
    implementation of the LPN PollTimeout Get message.
    
    X-Original-Commit: 782bdd7f703690b53166f6adec5aac73c8977c03

 nimble/host/mesh/include/mesh/glue.h |  1 +
 nimble/host/mesh/src/cfg.c           | 21 ++++++++++++++++++++-
 nimble/host/mesh/src/friend.c        | 23 ++++++++++++-----------
 nimble/host/mesh/src/friend.h        |  3 +++
 4 files changed, 36 insertions(+), 12 deletions(-)

commit b1475d0655e558fb403a6bfd73316b497ef58070
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 10 15:38:31 2017 +0100

    mesh: Fix not including RSSI into network RX context
    
    The RSSI was supposed to be stored in the net_rx struct.
    
    X-Original-Commit: 9bc6d5a37f0c51fe8fcb658408c8fed6e8eb9fe6

 nimble/host/mesh/src/net.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c39ada8cdb1ae9f4b04a2eca496f81063cbd80b3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 10:57:33 2017 +0100

    mesh: Add complete Friend support
    
    X-Original-Commit: 1520f33e22d21d97f6c0d52302d1b039758552d3

 nimble/host/mesh/include/mesh/glue.h  |    7 +
 nimble/host/mesh/include/mesh/slist.h |  240 +++++++
 nimble/host/mesh/src/beacon.c         |   18 +-
 nimble/host/mesh/src/cfg.c            |   12 +-
 nimble/host/mesh/src/friend.c         | 1143 ++++++++++++++++++++++++++++++---
 nimble/host/mesh/src/friend.h         |   45 +-
 nimble/host/mesh/src/lpn.c            |    8 +-
 nimble/host/mesh/src/net.c            |   95 ++-
 nimble/host/mesh/src/net.h            |   72 ++-
 nimble/host/mesh/src/slist.c          |  323 ++++++++++
 nimble/host/mesh/src/transport.c      |  208 ++++--
 nimble/host/mesh/src/transport.h      |    8 +-
 nimble/host/mesh/syscfg.yml           |   17 +-
 13 files changed, 1942 insertions(+), 254 deletions(-)

commit 88e86cfaa7c90633c177676f9fe54f0dd5c272b8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 09:52:09 2017 +0100

    mesh: Disable Low Power node by default
    
    X-Original-Commit: 8b4235e8c1a9b10b8e97472179f82fb80019a9bf

 nimble/host/mesh/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f77a8e6d2a8f786ded0598f433539f3f2b397050
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Nov 28 16:44:58 2017 -0800

    net/nimble/host unittest; change null initialization to memset.
    
    X-Original-Commit: 753df77b026b836115d909ef246cc2288edcbbe3

 nimble/host/test/src/ble_hs_hci_test.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 90c74110f90baa0c326e4fb7cdbcba9af4ec379e
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 27 10:32:40 2017 -0800

    BLE Host - use instance 0 when ext. adv. disabled.
    
    X-Original-Commit: bbe6795f04fc114ad9a01612fce0eef08e2905e1

 nimble/host/src/ble_hs_hci_evt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3f1c40564e351e4e9b8e5404e487148dfaff61ce
Merge: d13bd3d9 be1ab394
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Nov 23 10:30:18 2017 +0100

    Merge pull request #671 from sjanc/ext_adv_host
    
    Extended Advertising API
    
    X-Original-Commit: 50a0295e04f7e9a88ad4e5f5f4ae6c1e3d73dfbb

commit d13bd3d927343f94bf2ea22c2b028627201ebfeb
Merge: 5d96e4be 5b78aee2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Nov 23 09:17:03 2017 +0100

    Merge pull request #673 from andrzej-kaczmarek/nimble-fixing
    
    nimble: Various fixes
    
    X-Original-Commit: 8d65a27b9e147100b6bb35747de456640b130570

commit 5d96e4be85f88f97766f18d32beb808426fbc681
Author: Fabio Utzig <utzig@apache.org>
Date:   Wed Nov 22 16:30:55 2017 -0200

    Add missing license headers
    
    X-Original-Commit: 7b39833187fd37612d954d728536515344e16aca

 nimble/host/test/src/ble_hs_test_util_hci.c | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit be1ab394ac5ab1cec5a2a0e83ce57f0e089191a0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:12 2017 +0100

    nimble/host: Add support for setting extended adv_data and scan_rsp
    
    Data from application can come fragmented but host make sure all is
    sent using minimal number of HCI commands.
    
    X-Original-Commit: 6e7c6cc3892d1414531fe6e2712496086dc34b89

 nimble/host/include/host/ble_hs_adv.h |   3 +
 nimble/host/src/ble_gap.c             | 193 +++++++++++++++++++++++++++-
 nimble/host/src/ble_hs_adv.c          | 232 +++++++++++++++++++++++-----------
 nimble/host/src/ble_hs_hci_cmd.c      |  23 +---
 nimble/host/src/ble_hs_hci_priv.h     |  12 +-
 nimble/include/nimble/hci_common.h    |   6 +
 6 files changed, 366 insertions(+), 103 deletions(-)

commit 33e2118d18d51402410461b9cead610902ad1fe5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/gap: Remove old experimental API for setting advertising PHY
    
    This API was only intermedient until proper API supporting multiple
    instances is introduced.
    
    X-Original-Commit: b332901726a72da2b5fb997c4486b9715bee0273

 nimble/host/include/host/ble_gap.h |  5 -----
 nimble/host/src/ble_gap.c          | 12 ------------
 2 files changed, 17 deletions(-)

commit 42f70328d4e72ad39f6b4e89bb83f2da664e1cf7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Don't use slave timer with extended advertising
    
    This timer is needed for legacy advertising only. Extended advertising
    allows to handle this in controller.
    
    X-Original-Commit: 05899acb7634e3b3ada57f7a8df3273699954b55

 nimble/host/src/ble_gap.c | 35 +++++++++++++++++++++++++++--------
 1 file changed, 27 insertions(+), 8 deletions(-)

commit b3e770fbb63c93d9bbebbf91dd15b8683f6e171b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Make preempt code multi advertising aware
    
    X-Original-Commit: ccf66e5fa3aacdce749b6cfdf23930c1b4e5fd0f

 nimble/host/src/ble_gap.c | 106 ++++++++++++++++++++++++++++++++--------------
 1 file changed, 74 insertions(+), 32 deletions(-)

commit 7af3f3eb21d8f1d0a1104651918b78d3c938d8bf
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Extend advertising stop event with instance
    
    This allows to identify which advertising instance was terminated
    and assosiate it with connection.
    
    X-Original-Commit: cbca170aba0deaff94b499ccd6b6ac37fe4bba70

 nimble/host/include/host/ble_gap.h | 10 +++++++++-
 nimble/host/src/ble_gap.c          | 32 ++++++++++++++++++++++++++------
 2 files changed, 35 insertions(+), 7 deletions(-)

commit 8434d82787d4cdf2eceb6ac3bf34ed4849d77a76
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Add support for setting advertising instance address
    
    Each avdertising instance can use different random address.
    
    X-Original-Commit: 10e98165f0dcb8dc177768b8e75c31343e73583c

 nimble/host/src/ble_gap.c | 83 ++++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 82 insertions(+), 1 deletion(-)

commit b721eaa7668328b4e787e97198e4d14f142f01b2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Pass advertising instance to connection complete
    
    This is a preparation for proper connection handling when multiple
    advetising instances are active.
    
    X-Original-Commit: c2bf5cbf2b8ddaa9d3fc1950529295488331187d

 nimble/host/src/ble_gap.c                   | 26 ++++++++++++----
 nimble/host/src/ble_gap_priv.h              |  3 +-
 nimble/host/src/ble_hs_hci_evt.c            | 46 +++++++++++++++++++++++++----
 nimble/host/test/src/ble_gap_test.c         | 12 ++++----
 nimble/host/test/src/ble_hs_conn_test.c     |  6 ++--
 nimble/host/test/src/ble_hs_test_util.c     |  2 +-
 nimble/host/test/src/ble_hs_test_util_hci.c |  2 +-
 nimble/host/test/src/ble_os_test.c          |  6 ++--
 nimble/include/nimble/hci_common.h          | 10 +++++++
 9 files changed, 86 insertions(+), 27 deletions(-)

commit 4b6ce13567f324569087f602515f7a3d49f9e57e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Remove ext adv path from legacy API
    
    If needed those will be implemented as wrappers around ext adv API.
    
    X-Original-Commit: 7aa1b0d674efe548d8542fa80fd8028e6e36e508

 nimble/host/src/ble_gap.c         | 268 ++++----------------------------------
 nimble/host/src/ble_hs_hci_util.c |  24 ----
 2 files changed, 25 insertions(+), 267 deletions(-)

commit 31211ee1adda8d9945f3e5cfa7f5f974655c3876
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Add support for configuring advertising instances
    
    This allows to configure new advertising instance.
    
    X-Original-Commit: 0be457eba7a369b281c91a743e7fffd3dc7af9e2

 nimble/host/src/ble_gap.c | 177 +++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 176 insertions(+), 1 deletion(-)

commit 303d9388b0b9cec553d474b60777747b6f07a26f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Add support for removing advertising instance
    
    This allows to remove configured advertising instance.
    
    X-Original-Commit: 2d1b66b277341bd10a302d87183e8c34af22d210

 nimble/host/src/ble_gap.c         | 38 +++++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_hs_hci_cmd.c  | 10 ++++++++++
 nimble/host/src/ble_hs_hci_priv.h |  4 ++++
 3 files changed, 51 insertions(+), 1 deletion(-)

commit ec760615c6f1bf29a09c94d9e99f7dc133a28def
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Add support for stopping advertising instance
    
    This allows to stop enabled advertising instance.
    
    X-Original-Commit: 51a3c6785e5ad9c3a32565c160093f67cfa10456

 nimble/host/src/ble_gap.c | 43 ++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 42 insertions(+), 1 deletion(-)

commit feb373c9d1025646b63bd57dbaee6879e37dfcdd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:11 2017 +0100

    nimble/host: Add support for starting advertising instance
    
    This allows to start configured advertising instance.
    
    X-Original-Commit: 78209bbe0097ec5abe92edb9fa1016532f9cc602

 nimble/host/src/ble_gap.c | 52 ++++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 51 insertions(+), 1 deletion(-)

commit 5b78aee2b54b2822dea5b678931c337c5eb8a787
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 22 14:04:25 2017 +0100

    nimble/mesh: Remove invalid typedef
    
    We should not redefine size_t.
    
    X-Original-Commit: f959b1cb2673fcc580caf211eb88f2fbe6b72c36

 nimble/host/mesh/include/mesh/glue.h | 1 -
 1 file changed, 1 deletion(-)

commit 73bdd65c6a2a3ab581e6b2f7ab5e7d47b309e99e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 21 14:39:36 2017 +0100

    nimble/mesh: Fix #include
    
    X-Original-Commit: 2885fec6cdb974c0b65ce0cba26560edce44f11f

 nimble/host/mesh/src/beacon.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ff3cecf30c42e44e3c9cddca891a5ebff72c4839
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 22 13:51:26 2017 +0100

    nimble/host: Change services pkg init priorities
    
    Let's define following init priorities for service packages:
    - 301 for GAP
    - 302 for GATT
    - 303 for other services
    
    This will make services register in this order to upon discovery we'll
    always have GAP first, then GATT and other services. Note that this
    particular order is not required by is probably used by virtually any
    device as it makes sense to have mandatory services first.
    
    X-Original-Commit: a0c805462cc54167a339a9d62a265dbc7cb8dcf0

 nimble/host/services/ans/pkg.yml  | 2 +-
 nimble/host/services/gap/pkg.yml  | 2 +-
 nimble/host/services/gatt/pkg.yml | 2 +-
 nimble/host/services/ias/pkg.yml  | 2 +-
 nimble/host/services/lls/pkg.yml  | 2 +-
 nimble/host/services/tps/pkg.yml  | 2 +-
 6 files changed, 6 insertions(+), 6 deletions(-)

commit 63345c6327fe013702f64f31ca28045959613b22
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Nov 21 15:36:10 2017 +0100

    nimble/host: Add API for extended advertising
    
    This API allows to make full usage of Bluetooth 5 extended advertising
    features: PHY selection and multiple advertising instances.
    
    X-Original-Commit: 7b692c9bc87bae5e23cc43e4fa48675184a7cd5b

 nimble/host/include/host/ble_gap.h | 35 +++++++++++++++++++++++++++++
 nimble/host/src/ble_gap.c          | 46 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 81 insertions(+)

commit 8624e41c3232a7f35f58bb213cee679ce159fcb0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Nov 20 14:11:08 2017 +0100

    nimble/host: Use static buffer for GAP mempool
    
    It is only allocated on startup and host initialization will fail in
    case it cannot be allocated, so let's just make it static.
    
    X-Original-Commit: 881eae1633d347a9a30019e90ffe17585f467abf

 nimble/host/src/ble_gap.c | 20 ++++++++------------
 1 file changed, 8 insertions(+), 12 deletions(-)

commit 565e379968c711c66df03dd9d959a27eb9339470
Merge: bcf3324b 32e6cfc7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 21 14:36:00 2017 +0100

    Merge pull request #668 from andrzej-kaczmarek/nimble-build-fix
    
    nimble: Fix LLS and TPS
    
    X-Original-Commit: 2b837d43ca50f5557f0ae4499a84ca3ccd1068c8

commit bcf3324bc82faf2be22f8428dfe78a2f7b5a19f0
Merge: 25359e09 2a8393a4
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Mon Nov 20 15:41:15 2017 -0800

    Merge pull request #667 from ccollins476ad/apollo2-timers
    
    Apollo2 - Tickless idle and HAL timer implementation
    
    X-Original-Commit: 240db83bf1f9106e667b102f818f00cc8e24d261

commit 2a8393a425f564bad1f710a910ef5e7b30d6ee30
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Nov 19 11:00:13 2017 -0800

    emspi transport - Fix compiler warning.
    
    X-Original-Commit: d1e7244839a911e18502ec5b755938dc56bf60fb

 nimble/transport/emspi/src/ble_hci_emspi.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 32e6cfc75c32cba0169e24a0f2c74464a2b0adca
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Nov 20 17:49:19 2017 +0100

    nimble/lls: Make LLS usable
    
    LLS code was not updated for long long time - now it should work again.
    
    X-Original-Commit: 2bd30d99179003eca286758f694d1798afa45677

 .../lls/include/services/lls/ble_svc_lls.h         |  5 +--
 nimble/host/services/lls/pkg.yml                   |  5 ++-
 nimble/host/services/lls/src/ble_svc_lls.c         | 49 +++++++++-------------
 3 files changed, 26 insertions(+), 33 deletions(-)

commit 2509e8d3d915b5ce0c669838cf394534b0df184c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Nov 20 17:47:43 2017 +0100

    nimble/tps: Fix compilation error
    
    X-Original-Commit: 7c50000d6efc7ae404a3361a40c51f5d52e88177

 nimble/host/services/tps/src/ble_svc_tps.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 25359e090b5720f887665dca18c2e24033bf5f5f
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 17 11:32:55 2017 -0800

    MYNEWT-869 BLE Host - Fix CoC double free
    
    On an attempt to transmit a packet that is too large over a
    connection-oriented channel, the channel would retain the invalid packet
    but return a failure code.
    
    This was causing problems in a particular unit test, because the unit
    test would free the mbuf when `ble_l2cap_coc_send()` returned a non-zero
    error code.  The mbuf would later get freed a second time when the
    channel was disconnected.
    
    From the btshell and bletiny code, it seems the intent was for the
    caller to free the mbuf only when `ble_l2cap_coc_send()` reported the
    `BLE_HS_BUSY` error.  I have changed `ble_l2cap_coc_send()` such that
    the channel only retains the mbuf on success, so the caller must free
    the mbuf on any non-zero error code.  I think this is an improvement for
    the following reasons:
    
    1. Simpler API.  Free the mbuf on any failure is simpler than having to
    free only on certain error conditions.
    
    2. I believe this change makes the code more correct.  It doesn't seem
    correct for the channel to retain an mbuf that it cannot send, and I
    don't believe the channel's outgoing MTU is expected to change during
    the lifetime of the channel.
    
    X-Original-Commit: aa4e67fd8d4c00a7e30307d753d347fd44bf2c9b

 nimble/host/src/ble_l2cap.c     | 4 ++++
 nimble/host/src/ble_l2cap_coc.c | 8 ++++++--
 2 files changed, 10 insertions(+), 2 deletions(-)

commit 496cc9a42d9e51702cf4f8c1ee4153095cf95ea4
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 17 11:32:03 2017 -0800

    MYNEWT-869 BLE Host - Fix GATT svr unit test.
    
    `ble_gatts_start()` was getting called twice.  The first call occurs
    inside `ble_hs_test_util_reg_svcs()`.
    
    X-Original-Commit: d42597a81feac9a4668da0f33d5b73371196680f

 nimble/host/test/src/ble_gatts_read_test.c | 2 --
 1 file changed, 2 deletions(-)

commit 6cb386c0de352afcad9284f9b903683f32c19a14
Merge: a305a99f 47f06104
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Nov 16 14:03:08 2017 +0100

    Merge pull request #662 from sjanc/ext_adv_cleanups
    
    Some GAP code cleanups
    
    X-Original-Commit: 49314cae4dcd481bedd8a9a9cabc2aef50fb66a6

commit 47f06104f9c21a63ed4f136cb116f05f44807e5b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:23 2017 +0100

    nimble/host: Make function touching ble_gap_slave use instance
    
    This is a preparation for multi instance support.
    
    X-Original-Commit: c0af15a08cd69e7c873f7cabf598daf478896f84

 nimble/host/src/ble_gap.c | 49 +++++++++++++++++++++++++++--------------------
 1 file changed, 28 insertions(+), 21 deletions(-)

commit 11a5c443cc4217aa079781bca3d4ceb774f4d60e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:23 2017 +0100

    nimble/host: Simplify connection accept functions
    
    Remove unused parameters and outdated comments.
    
    X-Original-Commit: 41f463d5065d3af663f51b87f6a3ac2843abf76c

 nimble/host/src/ble_gap.c | 40 ++++------------------------------------
 1 file changed, 4 insertions(+), 36 deletions(-)

commit c8a9d75a7127584d948d197ee4e1da7b19d03195
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:22 2017 +0100

    nimble/host: Use flag for tracking advertising type
    
    X-Original-Commit: 66325151317d5afef4ee4f5d1ce6e37f3b0d4485

 nimble/host/src/ble_gap.c | 35 +++++++++++++----------------------
 1 file changed, 13 insertions(+), 22 deletions(-)

commit da5e4af3f2136ec3fa95ed3d908d276aea35eddd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:22 2017 +0100

    nimble: Fix tx power type in hci_ext_adv_params
    
    This is signed value.
    
    X-Original-Commit: 26a6d3b521c3c21ef8ed31f6e426233ce0b9bdce

 nimble/include/nimble/hci_common.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 28dfa64bf240f305e7220c5242574d9de6fb2b2b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:22 2017 +0100

    nimble/gap: Make ble_gap_slave table
    
    This is in preparation for multiple advertising instance support.
    
    X-Original-Commit: 6af7f52a8b1707d157469d013bb0d91cabdf3eae

 nimble/host/src/ble_gap.c | 54 +++++++++++++++++++++++------------------------
 1 file changed, 27 insertions(+), 27 deletions(-)

commit 8e46e2fc89600529e5515827b8773029ba5c30e9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:22 2017 +0100

    nimble/host: Unanonimize ble_gap_slave
    
    X-Original-Commit: 5e075f9b562f4c7956cc1efb4e3136aafa6e9ed7

 nimble/host/src/ble_gap.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit d7e70b57ff5cdd0483562e7e25e929810fe3c276
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:22 2017 +0100

    nimble: Move adv instances count definition to common header
    
    This will be used by both controller and host now.
    
    X-Original-Commit: 5a4b7ca494a5e7ed0e8d8022fd623a4ff06809e8

 nimble/controller/include/controller/ble_ll_adv.h |  3 ---
 nimble/controller/src/ble_ll_adv.c                | 28 +++++++++++------------
 nimble/controller/src/ble_ll_hci.c                |  2 +-
 nimble/include/nimble/ble.h                       |  3 +++
 4 files changed, 18 insertions(+), 18 deletions(-)

commit 288348ecabf608804b2e76933ebf63f568511d27
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Nov 15 14:54:22 2017 +0100

    nimble/host: Remove unused members from ble_gap_slave
    
    X-Original-Commit: e47b2d17a1c7d6ac08bf2f8e0513a7dca9c581cb

 nimble/host/src/ble_gap.c | 2 --
 1 file changed, 2 deletions(-)

commit a305a99f5f772224b19c53442e6263e39077048e
Merge: 774606a0 84a2ec9a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 10:22:17 2017 +0100

    Merge pull request #651 from michal-narajowski/friend_preparation
    
    mesh: Preparation for Friend support
    
    X-Original-Commit: 92956057369204bd50d7f5f64c73076fbbf4588d

commit 774606a079033e6e343260b4bb77edf5638dc254
Merge: 3a53ee1b 0f244be7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 16 10:21:52 2017 +0100

    Merge pull request #652 from michal-narajowski/mesh-msg-cache
    
    mesh: Improve Network Message Cache behavior
    
    X-Original-Commit: 20ce091b916ba47cb261e55f8d182b7d4a399f58

commit 3a53ee1b3f90f1ede9da92cbf833264876fe291b
Merge: eb72b402 3e5ad678
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 14 09:57:54 2017 +0100

    Merge pull request #653 from andrzej-kaczmarek/various-fixes
    
    Add new semaphore API + some nimble/os fixes
    
    X-Original-Commit: 3a0857ecc2fe3d12ad7e5eb48596e1b3e61cd083

commit eb72b4023ee13e6af670192208bf9ecab5814f42
Merge: 91056552 e00887d6
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Nov 10 12:24:33 2017 -0800

    Merge pull request #655 from ccollins476ad/apollo2
    
    Support for APOLLO 2 and emspi HCI transport
    
    X-Original-Commit: c33b6c3b0d2e9899308ca51b098e5a67365dc044

commit 910565521d1c0b58e6c48da91082f0b614da8f28
Merge: 9726391c 04445018
Author: wes3 <wills@runtime.io>
Date:   Fri Nov 10 12:08:47 2017 -0800

    Merge pull request #647 from wes3/hfxo_fix
    
    net/nimble: MYNEWT-862 HFXO not always turning off
    
    X-Original-Commit: feede0363245604a781cda1d8b3f9f23b98bdb94

commit e00887d6625801263e3561c8233d83ff3072d325
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 9 19:58:50 2017 -0800

    ANS service: Add a hacky #undef to fix ambiq blds.
    
    Some ambiq SDK headers use `OVERFLOW` as an identifier.  This is a macro
    that is leaked by some versions of math.h.  This commit `#undef`s
    OVERFLOW to prevent the header from breaking.
    
    X-Original-Commit: bc80c7ce5f7010dc5bbeee2ae97b6acef982e7a4

 nimble/host/services/ans/src/ble_svc_ans.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit bfffc40b323ac593f9d38002072fe0f9369d2a35
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 9 19:15:24 2017 -0800

    BLE HCI transport - emspi
    
    This is an HCI transport that works over SPI.  It uses EM's SPI
    protocol, as described in the EM9304 data sheet:
    http://www.emmicroelectronic.com/sites/default/files/public/products/datasheets/9304-ds.pdf
    
    Currently only the host side is supported.
    
    In addition, this package only builds when the MCU is an APOLLO 2.  This
    is due to a dependency on the ambiq SDK.
    
    X-Original-Commit: e2889f9acf4f4faf7816e1906842f9a31035f8bf

 .../emspi/include/transport/emspi/ble_hci_emspi.h  |  33 +
 nimble/transport/emspi/pkg.yml                     |  36 +
 nimble/transport/emspi/src/ble_hci_emspi.c         | 935 +++++++++++++++++++++
 nimble/transport/emspi/syscfg.yml                  |  92 ++
 4 files changed, 1096 insertions(+)

commit 3e5ad6785a0c2337eb7854ab9b4be10aab2b530c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Nov 9 16:43:46 2017 +0100

    nimble/ias: Fix service definition
    
    It did not compile...
    
    X-Original-Commit: 5f0df1c450541e8b45964f99f019113960471160

 nimble/host/services/ias/src/ble_svc_ias.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 51ecfda51453887c3b247131c9d5ba86c42e3519
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Nov 9 15:12:19 2017 +0100

    nimble/host: Enable ble_hs_locked_by_cur_task for debug only
    
    It's used only for debugging anyway.
    
    X-Original-Commit: 20d7536988e4f5a210ead7601085470669e959de

 nimble/host/src/ble_hs.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6c73620fb00c2000b7161f471dbc4970bcf2149d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Nov 9 14:01:35 2017 +0100

    nimble/host: Fix semaphore usage
    
    We should not access semaphore internals. Instead, use dedicated API.
    
    X-Original-Commit: b226920419ca7a84f24ac56f76ca5f52e79a584a

 nimble/host/src/ble_hs_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2a4409d65d4395dac4fac289adecc2c0d8b5af73
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Nov 9 12:17:59 2017 +0100

    nimble/host: Add missing include
    
    X-Original-Commit: 94e635f5ea7e4640a22b6ddc56c2a4373f32b885

 nimble/host/src/ble_monitor.c | 1 +
 1 file changed, 1 insertion(+)

commit dd2e426f6786cdc03f059e484ce53e62d8d31f8f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Nov 8 16:24:50 2017 +0100

    nimble/host: Remove unused bsp includes
    
    X-Original-Commit: fae57b293371389d569f61900268d37e7f7b2196

 nimble/host/src/ble_att.c     | 1 -
 nimble/host/src/ble_att_svr.c | 1 -
 nimble/host/src/ble_hs.c      | 1 -
 3 files changed, 3 deletions(-)

commit 0f244be7f1ae5046be6ad09d23edc906365e9127
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 9 11:58:33 2017 +0100

    mesh: Improve Network Message Cache behavior
    
    The implementation of the Network Message Cache has so far been
    suboptimal, since it has treated the same packet with different TTL
    values as different packets. Since one of the purposes of this cache
    is to prevent unnecessary relaying, it's important that we don't let
    the TTL value influence the "hash" that's used for matching messages.
    
    This patch changes the hash to consist of most of the IV Index (three
    least significant bytes of it), the sequence number and the source
    address, which should give fairly optimal matching behavior.
    
    X-Original-Commit: 311263736dbe417f254413ab63dcd3f99aca32a8

 nimble/host/mesh/src/net.c | 46 ++++++++++++++++------------------------------
 nimble/host/mesh/src/net.h |  1 -
 2 files changed, 16 insertions(+), 31 deletions(-)

commit 84a2ec9a4352c252e28788db4bd3b666efefedd2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:56:51 2017 +0100

    mesh: Extend advertising API with helpers for Friend support
    
    These extensions prepare the way of implementing full Friend support.
    
    X-Original-Commit: a811e5d30d1322e32c6387de31991ed363c2f4d2

 nimble/host/mesh/src/adv.c | 16 +++++++++++++---
 nimble/host/mesh/src/adv.h |  8 ++++++++
 2 files changed, 21 insertions(+), 3 deletions(-)

commit f424f153b611982350244bed36c384948ba815d3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:44:15 2017 +0100

    mesh: Return change information from bt_mesh_iv_update()
    
    This will soon be useful to the callers of bt_mesh_iv_update(), in
    particular Friend support.
    
    X-Original-Commit: 9b4b858eec665aa008c9836106130c21e3800c5a

 nimble/host/mesh/src/net.c | 20 +++++++++++---------
 nimble/host/mesh/src/net.h |  2 +-
 2 files changed, 12 insertions(+), 10 deletions(-)

commit 61c9ab640df13408e09096167b0662f1695e8891
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:40:47 2017 +0100

    mesh: Export bt_mesh_friend_cred_get() for Friend usage
    
    This function will soon be needed by the Friend support.
    
    X-Original-Commit: 6e55febfbbef2edf3071d4a3b54145038699eeed

 nimble/host/mesh/src/net.c | 43 ++++++++++++++++++++++---------------------
 nimble/host/mesh/src/net.h |  2 ++
 2 files changed, 24 insertions(+), 21 deletions(-)

commit 2cddc441717b7cb28a28617a31dee9560a209ac9
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:31:05 2017 +0100

    mesh: Remove redundant assignment
    
    This value is assigned again a few lines later.
    
    X-Original-Commit: af4c1855fcdb605632b7f5fe8459e859a30c49a5

 nimble/host/mesh/src/net.c | 1 -
 1 file changed, 1 deletion(-)

commit 61e1c2730aca375a31183d751d5a8169e7ef6e05
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:29:48 2017 +0100

    mesh: Cfg: Only update friend state if supported
    
    If Friend support is not available we should not modify the value of
    cfg->frnd.
    
    X-Original-Commit: b9d9547531ecd9e29e46aea4c58b69bbf2ca846d

 nimble/host/mesh/src/cfg.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit a3553a315d4f6ad2fb70aee8e8f655c58a366d11
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:27:39 2017 +0100

    mesh: Export some transport layer helpers
    
    These will soon be needed by the Friend code to compose messages.
    
    X-Original-Commit: 31abe05ee8eb4b52b33583937e2eba7f0644f390

 nimble/host/mesh/src/transport.c | 8 ++------
 nimble/host/mesh/src/transport.h | 4 ++++
 2 files changed, 6 insertions(+), 6 deletions(-)

commit facbfaadae43d2ddba72fcad65b9afadce01a682
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:24:50 2017 +0100

    mesh: Add bt_mesh_net_flags() helper function
    
    This reduces code in various places needed to construct a flags value
    for a given subnet.
    
    X-Original-Commit: 41a9a30437ec43738e7a9466ba01e00c3d286405

 nimble/host/mesh/src/beacon.c |  8 +-------
 nimble/host/mesh/src/net.c    | 23 ++++++++++++++++-------
 nimble/host/mesh/src/net.h    |  3 +++
 3 files changed, 20 insertions(+), 14 deletions(-)

commit 83d58a2fe3a62dca8df7bfa97bb8060313488850
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:21:35 2017 +0100

    mesh: Fix TX segment context lookups
    
    X-Original-Commit: 26b9179ff31c6e9bb06c64f2797f5d0e2dabd172

 nimble/host/mesh/src/transport.c | 44 ++++++++++++++++++++++++++++++++--------
 1 file changed, 35 insertions(+), 9 deletions(-)

commit 5cf82a66cd7499600e2f8662ec5bba89f9d55745
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:15:51 2017 +0100

    mesh: Take advantage of BT_MESH_NET_HDR_LEN define
    
    Avoid using hard-coded magic numbers.
    
    X-Original-Commit: 6b68fdfc0fbd1808a12eef00a49b4952325a82e7

 nimble/host/mesh/src/transport.c | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit 17eacb6dbca82e05aeaa5d73fc36af9eb9ccbfe8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 11:03:57 2017 +0100

    mesh: Keep received buffer intact until transport layer
    
    The lower transport layer is responsible e.g. for the Friend Queue, so
    we need to have the buffer in its original parsing state there.
    
    X-Original-Commit: 52d26b432adb7331c8536695782ce8ed39bfcea7

 nimble/host/mesh/src/net.c       | 33 +++++++++++++--------------------
 nimble/host/mesh/src/net.h       |  5 +++--
 nimble/host/mesh/src/proxy.c     |  5 ++++-
 nimble/host/mesh/src/transport.c |  4 ++++
 4 files changed, 24 insertions(+), 23 deletions(-)

commit 9726391cde213be4d213041123f31ad3f9380758
Merge: c55b6c2e 2a5dbc7e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 9 09:27:02 2017 +0100

    Merge pull request #649 from michal-narajowski/mesh_pts_fixes
    
    mesh: Various fixes found during PTS testing
    
    X-Original-Commit: 33a0e264cc32182df865f41dddd32c3983d5f17f

commit c55b6c2e5fd44b6a5d742ec7407e6df6e7d4d537
Merge: a7037da4 44d5c462
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 9 09:26:46 2017 +0100

    Merge pull request #646 from michal-narajowski/mesh-init-fix
    
    mesh: Fail init on keys generation error
    
    X-Original-Commit: e600ad00cb19307eca7bd9e1788bba35a7f9432a

commit 2a5dbc7e57ed360656cf32d7e0f00fb4aaea354f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 7 09:55:45 2017 +0100

    mesh: Fix HB Sub Status when disabling subscription
    
    MESH/NODE/CFG/HBS/BV-02-C expects it to be possible to do a Set with
    the existing src & dst addresses but with a zero period in order to
    "cancel" the current subscription. In such a case the addresses should
    remain set but the period be set to zero, similar to what would happen
    if the period would expire.
    
    X-Original-Commit: e6f54bebbdaf6dcdebe863500ae20eb3b43d9d3a

 nimble/host/mesh/src/cfg.c | 26 +++++++++++++++++++-------
 1 file changed, 19 insertions(+), 7 deletions(-)

commit aa8aea35634b47208d595323419beaeb5bbda02d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Nov 7 09:53:07 2017 +0100

    mesh: Fix clearing HB state when disabling HB sub
    
    The heartbeat subscription Count, MinHops & MaxHops should only be
    reset when enabling heartbeat subscription. Any other actions should
    keep it unchanged.
    
    X-Original-Commit: 1f27b1a255930692a859d5417b62d224d24d0485

 nimble/host/mesh/src/cfg.c | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

commit 514a5d1c914cd46229eb92e3669cf560ea29a559
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Nov 2 15:35:48 2017 +0100

    mesh: Fix sending heartbeat only when relay state changes
    
    The heartbeat should only be sent in case the relay state actually
    changes. This fixes MESH/NODE/CFG/HBP/BV-03-C.
    
    X-Original-Commit: ed80ed41fbca1ed04c1e6813c6deb244b40ba76c

 nimble/host/mesh/src/cfg.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit b56692263c9b6cec382f4923070fb4b466f123ce
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Oct 13 08:55:05 2017 +0200

    mesh: Fix HB Pub Count Log calculation routine
    
    "4.1.2 Log field transformation
    
    In order to compress two-octet values into one-octet fields,
    the following logarithmic transformation is used: any two-octet
    value is mapped onto a one-octet field value representing
    the largest integer n, where 2^(n-1) is less than or equal
    to the two-octet value."
    
    Log field transformation table:
    
    Log Field Value         2-octet Value
    0x01                    0x0001
    0x02                    0x0002 through 0x0003
    0x03                    0x0004 through 0x0007
    0x04                    0x0008 through 0x000F
    0x05                    0x0010 through 0x001F
    0x06                    0x0020 through 0x003F
    0x07                    0x0040 through 0x007F
    0x08                    0x0080 through 0x00FF
    0x09                    0x0100 through 0x01FF
    0x0A                    0x0200 through 0x03FF
    0x0B                    0x0400 through 0x07FF
    0x0C                    0x0800 through 0x0FFF
    0x0D                    0x1000 through 0x1FFF
    0x0E                    0x2000 through 0x3FFF
    0x0F                    0x4000 through 0x7FFF
    0x10                    0x8000 through 0xFFFF
    
    "4.2.17.2 Heartbeat Publication Count Log
    
    The Heartbeat Publication Count Log value between 0x01 and 0x11
    shall represent that smallest integer n where 2^(n-1) is greater
    than or equal to the Heartbeat Publication Count value. For example,
    if the Heartbeat Publication Count value is 0x0579, then the Heartbeat
    Publication Count Log value would be 0x0C."
    
    According to this definition 2^(n-1) is an upper bound for n log value.
    
    Proposed Publication Count Log transformation table:
    
    Pub Count Log Value     2-octet Value
    0x01                    0x0001
    0x02                    0x0002
    0x03                    0x0003 through 0x0004
    0x04                    0x0005 through 0x0008
    0x05                    0x0009 through 0x0010
    0x06                    0x0011 through 0x0020
    0x07                    0x0021 through 0x0040
    0x08                    0x0041 through 0x0080
    0x09                    0x0081 through 0x0100
    0x0A                    0x0101 through 0x0200
    0x0B                    0x0201 through 0x0400
    0x0C                    0x0401 through 0x0800
    0x0D                    0x0801 through 0x1000
    0x0E                    0x1001 through 0x2000
    0x0F                    0x2001 through 0x4000
    0x10                    0x4001 through 0x8000
    0x11                    0x8001 through 0x10000
    
    According to Log field transformation table 0x0579 would be transformed
    to 0x0B and should be to transformed to 0x0C.
    
    This is required to pass MESH/NODE/CFG/HBP/BV-01-C.
    
    X-Original-Commit: c1d8367d5ed88fa85adc99c0983762cacec005ea

 nimble/host/mesh/src/cfg.c | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

commit 848d20ebe992d039187ddfdf01c9fbe547acc2c7
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Oct 13 16:57:09 2017 +0200

    mesh: Fix ignoring all prohibited sub_dst in HB Sub Set
    
    Section 4.2.18.2 in the Mesh Profile Specification states:
    
    "The Heartbeat Subscription Destination shall be the unassigned address,
    the primary unicast address of the node, or a group address, all other
    values are Prohibited."
    
    X-Original-Commit: c68515cab681ca222a1d06e1e4dcdcbd5c029662

 nimble/host/mesh/src/cfg.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 0444501872c8c13f35474a67f09d0b537bd47396
Author: William San Filippo <wills@runtime.io>
Date:   Mon Nov 6 17:56:58 2017 -0800

    net/nimble: MYNEWT-862 HFXO not always turning off
    
    This commit should fix the issue where the HFXO was not being
    turned off when advertising is stopped. The code needed to turn
    off the HFXO even if the LL state was in standby. Furthermore,
    it needed to make sure the rfclk timer was stopped, otherwise
    it might fire off and turn back on the HFXO.
    
    X-Original-Commit: ba6139adf6e41e3b2f8026f4040ebee1582c19ae

 nimble/controller/src/ble_ll_adv.c   |  9 +++------
 nimble/controller/src/ble_ll_sched.c | 27 +++++++++++++++------------
 2 files changed, 18 insertions(+), 18 deletions(-)

commit a7037da4eff60d6da7bb8955fb2a52d8b5220312
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 18 12:47:32 2017 -0700

    BLE Host - Delay sync callback after IRK restore
    
    -Prior to commit-
    
    On startup, the host executes the following steps:
    
    1. HCI startup sequence
    2. Call sync callback
    3. Restore IRKs from flash
    
    The problem is that step 3 (IRK restoration) causes a GAP preemption if
    there are any persisted IRKs.  If the application initiates a GAP
    procedure during the sync callback, it will be immediately preempted.
    This happens in the bleprph app, for example.
    
    -After commit-
    
    Don't call the sync callback until after IRK restoration is complete.
    
    X-Original-Commit: 28f4a0d78df247d25542801ed79c3f6d9aed4983

 nimble/host/src/ble_hs.c | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

commit 389f11b55882ace339d8a75c0095788bbff51be4
Merge: c7d99857 b1c45fa4
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Nov 3 16:38:23 2017 -0700

    Merge pull request #632 from ccollins476ad/rm-conn-cancel
    
    BLE Host - Remove BLE_GAP_EVENT_CONN_CANCEL
    
    X-Original-Commit: 9844b16d31b4079b4646f80694c2f0639b98d79c

commit 44d5c462d51b3c12c9cdc37156f60e1fbe34b4fa
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 10:53:06 2017 +0100

    mesh: Fail init on keys generation error
    
    Fail on Mesh initialization if provisioning is enabled and keys were
    not generated. This make it simpler to debug misconfigured devices.
    
    Ported from Zephyr PR #4691
    
    X-Original-Commit: 935073256bf3eb64a499d4186b41f9b744302655

 nimble/host/mesh/src/mesh.c |  6 +++++-
 nimble/host/mesh/src/prov.c | 11 ++++++++---
 nimble/host/mesh/src/prov.h |  2 +-
 3 files changed, 14 insertions(+), 5 deletions(-)

commit c7d998579343876520f4e4cbcbacc9b064275fb2
Merge: 60be7dc8 eeaa3c8a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Nov 3 10:42:30 2017 +0100

    Merge pull request #641 from michal-narajowski/mesh-iv-update-fix
    
    mesh: Fix and clean up iv update procedure
    
    X-Original-Commit: e4e9097ee3899be58c06cbfbcf0cf2ece61fc493

commit eeaa3c8a99c9226318c2da422a39e857f140129a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 17 12:05:35 2017 +0200

    mesh: Fix and clean up iv update procedure
    
    This patch fixes issue when receiving iv index greater than current
    index + 42 in update mode. According to Specification when node is in update
    state it should only accept iv index equal to the current iv index. When
    node is in normal mode it should ignore index that is greater than current
    index + 42.
    
    This allows to pass MESH/NODE/IVU/BI-02-C.
    
    Also this patch cleans up the iv update procedure, to make it easier to
    read.
    
    X-Original-Commit: 51fbf89bd981eca731b78956e0a26cff2d0e7a02

 nimble/host/mesh/src/net.c | 57 +++++++++++++++++++++++++++++-----------------
 1 file changed, 36 insertions(+), 21 deletions(-)

commit 60be7dc869ecce7dd5b21d720b75ced5af0d8801
Merge: 1be35493 408a7b71
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Nov 2 15:26:05 2017 +0100

    Merge pull request #622 from andrzej-kaczmarek/nimble-aux-sched-fix
    
    nimble: Some fixes for scheduling aux tx/rx
    
    X-Original-Commit: 19ade1f47477785bb0c205b01f9d305aca828e81

commit 1be35493142d8a87c8c515a40faf32f241607a20
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 30 13:39:33 2017 -0700

    BLE Host - Lock mutex in ble_hs_id_infer_auto()
    
    This function requires the host mutex to be locked.  Since this function
    is part of the application API, the function needs to lock the mutex
    itself.
    
    X-Original-Commit: ad715a95348f0a8aee0e8085607b0a2ffe9c94b6

 nimble/host/src/ble_hs_id.c           | 12 +++++++++---
 nimble/host/test/src/ble_hs_id_test.c |  2 --
 2 files changed, 9 insertions(+), 5 deletions(-)

commit 24d8169951b4875ca386ee63e29477e039be88a0
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 30 13:37:56 2017 -0700

    BLE Host - Corrections for heartrate PR (591).
    
    * Make ble_hs_id_use_addr() private to net/nimble/host
    * Remove call to ble_hs_id_use_addr() in blehr app
    * Remove duplicate ble_hs_id_infer_auto() prototype
    
    X-Original-Commit: aadf9baf059844d1e6b9803f2e08398faa4f2d4e

 nimble/host/include/host/ble_hs_id.h | 3 ---
 1 file changed, 3 deletions(-)

commit e0afcdece566ddaa5b0e670cd84fd9189295992e
Author: szymon-czapracki <szymonczapracki@gmail.com>
Date:   Fri Sep 29 14:09:40 2017 +0200

    apps/blehr: Added heart-rate sensor app
    
    X-Original-Commit: aacacde347fdc239629e0edc1716decf3336138f

 nimble/host/include/host/ble_hs_id.h | 3 +++
 1 file changed, 3 insertions(+)

commit b1c45fa4572ae554c29923e4f89debb685eb3692
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 18 17:15:48 2017 -0700

    BLE Host - Remove BLE_GAP_EVENT_CONN_CANCEL
    
    Cancelled connect procedures are reported as:
        event.type: BLE_GAP_EVENT_CONNECT
        event.connect.status: BLE_HS_EAPP
    
    Discussion regarding this change can be found here:
    https://lists.apache.org/thread.html/6575cbf8faef793381845aaa99bea7c4c053926af43928c82f62e236@%3Cdev.mynewt.apache.org%3E
    
    X-Original-Commit: 5d5b7bd340ad5f02fa4215aa8467d0690018096e

 nimble/host/include/host/ble_gap.h  |  2 +-
 nimble/host/src/ble_gap.c           | 13 +++++--------
 nimble/host/test/src/ble_gap_test.c |  9 ++++-----
 3 files changed, 10 insertions(+), 14 deletions(-)

commit df8f403e00c1954012f8e49b999ab4c27c5d43c9
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 23 16:08:03 2017 -0700

    BLE socket transport - don't drop large frames.
    
    For large incoming ACL packets, the "current offset" field was rolling
    over, making it look like the packet was being dropped.  The fix is to
    change the offset member from uint8_t to uint16_t.
    
    X-Original-Commit: 24da43b88ec78642562c5020386d06a26d497955

 nimble/transport/socket/src/ble_hci_socket.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a33e2c8d8cde354e964dc7b3e3bcd4dd40b3ed52
Merge: 0e54407c 65290790
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Thu Oct 19 12:24:59 2017 -0700

    Merge pull request #633 from ccollins476ad/frag-typo
    
    BLE Host - Fix typo in flag check
    
    X-Original-Commit: 22596498aaafdce35d0b2b85f399dbc9fa882cb3

commit 0e54407ca9d9cec7c6f8798c9d94d83a2848a988
Author: Jonathan Seroussi <seryoni@gmail.com>
Date:   Tue Oct 17 16:55:40 2017 +0300

    Removing use of undefined TASKS_START behavior
    
    This is a follow up commit to a the same fix in the nRF52. Tested using the bleprph app - but only on an emulator. Seems to be working the same as before. Happy to help testing further!
    
    The problem was that the behavior of the RNG TASKS_START is defined to be write only. Reading from it is undefined and though it might have worked up until now doesn't mean it'll constantly work. I was only able to catch on to this using an emulator.
    
    X-Original-Commit: 0a1569b315ce3d2ef772343cbc30aa4e843b2626

 nimble/drivers/nrf51/src/ble_hw.c | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit 6400747699d1d94e08a3b590806d736f60925025
Author: Jonathan Seroussi <seryoni@gmail.com>
Date:   Sun Oct 15 14:58:14 2017 +0300

    Removing use of undefined TASKS_START behavior
    
    Tested using the bleprph app. The problem was that the behavior of the RNG TASKS_START is defined to be write only. Reading from it is undefined and though it might have worked up until now doesn't mean it'll constantly work. I was only able to catch on to this using an emulator.
    
    X-Original-Commit: fc0da53f8abedb1c7fce4e35ee565e310e971fdb

 nimble/drivers/nrf52/src/ble_hw.c | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit 408a7b71bca43388d5a8db7de029f2ffdd01fa91
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 19 16:19:07 2017 +0200

    nimble/ll: Drop event if adv ext is delayed beyond aux
    
    Sometimes if things are delayed we may try to send adv ext after
    scheduled aux - in this case just drop entire event as it won't make
    much sense for receiver anyway.
    
    This can easily happen when connecting debugger to running platform.
    
    X-Original-Commit: 949fa18456278f7774016e68cdc6f294a955d3c6

 nimble/controller/src/ble_ll_adv.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit b18234068e788e8676176f7c0ce63e0aa43f2ae6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 19 16:18:42 2017 +0200

    nimble/ll: Add stat for dropped adv event
    
    X-Original-Commit: f92d765ac68ff83a910287b2bea975e761b3d279

 nimble/controller/include/controller/ble_ll.h | 1 +
 nimble/controller/src/ble_ll.c                | 1 +
 nimble/controller/src/ble_ll_adv.c            | 2 ++
 3 files changed, 4 insertions(+)

commit 6ad13711f11a295efade0aed470a601d5fa9b6f5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 17 13:33:23 2017 +0200

    nimble/ll: Set phy mode before scheduling tx
    
    We need to set phy mode before scheduling tx as otherwise calculations
    in ble_phy will use invalid phy and can be off few usecs.
    
    X-Original-Commit: 9dc306abccf7d5ecd13e63bb9b681aa420776a85

 nimble/controller/src/ble_ll_adv.c | 33 ++++++++++++++++++---------------
 1 file changed, 18 insertions(+), 15 deletions(-)

commit 535aa224b1224738538458e3876ec525ea9e2f5f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 17 15:09:13 2017 +0200

    nimble/phy: Fix RXd packet start time calculation
    
    Packet start time calculations did not take T_rxaddrdelay into account
    so it was couple of msecs ahead of actual RX start time. This caused
    scanning for aux to be scheduled later than it should be so intead of
    listening at the time aux should start, we usually started somewhere
    in the middle of preamble.
    
    X-Original-Commit: 1b553dcca9cf36b176fd85d0c15d421eccf2a246

 nimble/drivers/nrf52/src/ble_phy.c | 25 +++++++++++++++++++------
 1 file changed, 19 insertions(+), 6 deletions(-)

commit 4215108b7f034f7ba24a314c4929eee3db64a20a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 17 12:37:20 2017 +0200

    nimble/phy: Fix scheduling gap between coded and uncoded
    
    TX scheduled at certain time will be off by 2 usecs depending on which
    phy (coded/uncoded) it is scheduled. This is due to different T_txdelay
    on coded and uncoded. It's not a big problem when scheduling e.g. conn
    events, but it can affect ext advertising if primary and secondary use
    different phys.
    
    Right now, if we use coded for primary, aux pdu is calculated at either
    1.77 or 1.80 msecs from 2nd ext adv pdu which is also multiply of full
    ticks (57.99 or 58.98 ticks respectively) without usecs remainder. Not
    a problem if secondary is also coded, but in case it is uncoded aux is
    sent 2 usecs too early since T_txdelay is 2 usecs less for coded that
    for uncoded. To fix this we need to take T_txdelay into account when
    scheduling TX to start in the future.
    
    X-Original-Commit: ae33245c42e38897828c261b0bf29a1aff7bd490

 nimble/drivers/nrf52/src/ble_phy.c | 46 +++++++++++++++++++++++---------------
 1 file changed, 28 insertions(+), 18 deletions(-)

commit c4f80cc25403ae5588c37923735924e120e93fc2
Merge: c3dcb770 80eabbb8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Oct 19 09:23:27 2017 +0200

    Merge pull request #621 from michal-narajowski/heartbeat
    
    mesh: Heartbeat fixes for message count
    
    X-Original-Commit: 92cf3b288d5f45f274903a19b5a36c2ec6debb64

commit c3dcb770de802fb50ae3739397fface849ba8ca3
Merge: 77769db8 f2a7c505
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Oct 19 09:23:21 2017 +0200

    Merge pull request #620 from michal-narajowski/bt_mesh_feat_bits
    
    mesh: Fix missing feature bits
    
    X-Original-Commit: e868874ed08fb691b3b5c3833dc264bcfef994cd

commit 652907900f2669e4ae518f6623435b4d40e997d2
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 18 17:39:05 2017 -0700

    BLE Host - Fix typo in flag check
    
    X-Original-Commit: 6ff705535199318e475f7391e366a0b75e616e15

 nimble/host/src/ble_hs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 77769db824b3672f2bc3f4995fb5d02800c50d19
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 18 09:46:08 2017 +0200

    nimble/host: Fix build issue
    
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:125:8:
    error: 'pktlen' may be used uninitialized in this function
    [-Werror=maybe-uninitialized]
         rc = ble_hs_hci_set_buf_sz(pktlen, max_pkts);
            ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:106:14:
    note: 'pktlen' was declared here
         uint16_t pktlen;
                  ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:125:8:
    error: 'max_pkts' may be used uninitialized in this function
    [-Werror=maybe-uninitialized]
         rc = ble_hs_hci_set_buf_sz(pktlen, max_pkts);
            ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:105:14:
    note: 'max_pkts' was declared here
         uint16_t max_pkts;
                  ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:117:18:
    error: 'le_max_pkts' may be used uninitialized in this function
    [-Werror=maybe-uninitialized]
             max_pkts = le_max_pkts;
                      ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:107:13:
    note: 'le_max_pkts' was declared here
         uint8_t le_max_pkts;
                 ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:115:8:
    error: 'le_pktlen' may be used uninitialized in this function
    [-Werror=maybe-uninitialized]
         if (le_pktlen != 0) {
            ^
    repos/apache-mynewt-core/net/nimble/host/src/ble_hs_startup.c:104:14:
    note: 'le_pktlen' was declared here
         uint16_t le_pktlen;
                  ^
    cc1: all warnings being treated as errors
    
    X-Original-Commit: 56215ad512665abcc01c86cfef489536cbbff9e4

 nimble/host/src/ble_hs_startup.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit d8cc9cbda75cfe70c28c2be7ba2816bdb9eb5e54
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Oct 17 13:44:38 2017 -0700

    BLE Host - Fix build errors for non-centrals.
    
    X-Original-Commit: 8a3574b08acc2c4f44792235c2bd9642fc10a9f6

 nimble/host/src/ble_gap.c | 129 +++++++++++++++++++++++-----------------------
 1 file changed, 65 insertions(+), 64 deletions(-)

commit 16acde564ff1654d2ec5e6cf3d03e756da277b2f
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 15:06:02 2017 -0700

    MYNEWT-842 - Unit tests for adding IRK entries.
    
    X-Original-Commit: d98ad86f5da0398425ccc207d036e983a4cc2588

 nimble/host/test/src/ble_hs_pvcy_test.c     | 390 +++++++++++++++++++++++++---
 nimble/host/test/src/ble_hs_test_util.c     |  20 +-
 nimble/host/test/src/ble_hs_test_util.h     |   1 +
 nimble/host/test/src/ble_hs_test_util_hci.c |   8 +-
 4 files changed, 383 insertions(+), 36 deletions(-)

commit 2daa87d6dd7eb2d9de3d675dc562f25f615170bf
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 15:05:43 2017 -0700

    MYNEWT-842 BLE Host - Stop GAP, add to rslv list
    
    If an attempt to add a peer's IRK to the resolving list fails, the
    failure is not reported, and the operation is not reattempted. Adding to
    the resolving list fails if the host is scanning or advertising at the
    time, so this is a common occurrence.
    
    This commit address this problem as follows.  Before attempting to add
    an entry to the resolving list, the host stops all active GAP
    procedures.  After the entry has been successfully added, the
    application must restart interrupted procedures as needed.
    
    Interrupted procedures are reported with a reason or status code of
    `BLE_HS_EPREEMPTED`.  Furthermore, an attempt to initiate a new GAP
    procedure during preemption fails with a return code of
    `BLE_HS_EPREEMPTED`.
    
    There is one additional requirement which complicates this feature:
    interrupted procedures must not be reported until after preemption has
    ended.  That way, the application can restart the procedure immediately
    upon receiving the event.  This requirement implies a somewhat strange
    order of events when an entry is added to the resolving list:
    
    1. Set the preempted state.
    2. Abort all GAP procedures, but don't report anything.
    3. Add the entry to the resolving list.
    4. Clear the preempted state.
    5. Finally, report interrupted procedures.
    
    The implementation is further complicated by the nature of the
    'cancel-create-connection' HCI exchange.  The cancel operation can be
    considered complete as soon as the command-complete event is received,
    but it does not get reported until the subsequent
    'le-connection-complete' event is received.  For this reason, the GAP
    must stay in the preempted state indefinitely until the expected event
    is received.
    
    X-Original-Commit: 76bfc3ba0d85ab591c97ba54728d5c3fa0669b57

 nimble/host/src/ble_hs.c      |  1 +
 nimble/host/src/ble_hs_pvcy.c | 53 +++++++++++++++++++++++++++++++++++--------
 nimble/host/src/ble_store.c   | 11 ---------
 3 files changed, 45 insertions(+), 20 deletions(-)

commit a16e7a2971d5da85e1c03ee782c4d0ccedc09fb5
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 15:02:27 2017 -0700

    BLE Host - Allow GAP to be preempted.
    
    Privacy requires this functionality.  An entry can only be added to the
    controller's resolving list when there are no active advertising,
    create connection, or discovery procedures.  We ensure the entry is
    successfully added by preempting GAP first.  When preemption occurs, all
    active GAP procedures are aborted, and no new ones can be started until
    the `ble_gap_preempt_done()` function is called.
    
    X-Original-Commit: 47d7bc44777eec68d87c45673e75f59bbba1f9f9

 nimble/host/include/host/ble_hs.h |   1 +
 nimble/host/src/ble_gap.c         | 151 ++++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_gap_priv.h    |   3 +
 3 files changed, 149 insertions(+), 6 deletions(-)

commit cc64c707dee57a1b774f804cbaf55e590aeea87c
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 15:01:06 2017 -0700

    BLE Host - no_lock versions of GAP cancel fns.
    
    X-Original-Commit: 4a51ebe11bb0e20d76e3a2459e34a93e227a3e4a

 nimble/host/src/ble_gap.c | 166 +++++++++++++++++++++++++++++++---------------
 1 file changed, 112 insertions(+), 54 deletions(-)

commit 787edbc6d73f4563b7c5341a3abe1f5edf822328
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 14:58:51 2017 -0700

    BLE Host - add reason for adv / disc complete.
    
    X-Original-Commit: 437f8b0a7f030059c5522c79f4f2787ce02cab4a

 nimble/host/include/host/ble_gap.h | 33 +++++++++++++++++++++++++++++++++
 nimble/host/src/ble_gap.c          |  3 ++-
 2 files changed, 35 insertions(+), 1 deletion(-)

commit 952b68290042ae5196ed950d26dec50326deaf0d
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 10:44:37 2017 -0700

    BLE Host - Fix a few coding style issues.
    
    X-Original-Commit: a087870b10fec87d0635d1cd62a19c8b78c0c612

 nimble/host/src/ble_gap.c | 118 +++++++++++++++++++++++++---------------------
 1 file changed, 65 insertions(+), 53 deletions(-)

commit 25bf79c17886c4ab0608293cedec887cbb470fc5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 12 10:54:05 2017 +0200

    nimble/controller: remove reduntant return
    
    X-Original-Commit: b224ff786bb7807f7891a97256b341c2867266e1

 nimble/controller/src/ble_ll_scan.c | 1 -
 1 file changed, 1 deletion(-)

commit 3dcfd67d785118c501a7bc389a47befb7f23ab73
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 12 10:45:35 2017 +0200

    nimble/controller: Fix connecting on long scan interval
    
    If long scan interval was set in le create connection and it happens
    that we got packet with crc error, scan maschine stopped to scan until
    the end of scan inteval. With this patch we make sure that scan machine
    keep scanning when crc error packet arrives
    
    X-Original-Commit: 8a6c8807b705625673d28d91f163cff951b43dfa

 nimble/controller/src/ble_ll_conn.c | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)

commit 35e4b86ab00e2b075472842382e0fee217a103ee
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 12 10:45:07 2017 +0200

    nimble/controller: minor coding style fix
    
    X-Original-Commit: 6d8b3e95593b3b7bf5253171b959ee86d1da210a

 nimble/controller/src/ble_ll_conn.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 67827f1612227f4af3e09de59d2b128b739b77c8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 11 13:52:57 2017 +0200

    nimble/controller: Store missing DID from ext adv
    
    X-Original-Commit: ee4b69412593c458ef108932703565ce51a6b02c

 nimble/controller/src/ble_ll_scan.c | 1 +
 1 file changed, 1 insertion(+)

commit 2243ff676d54075f8b0f0ca27be5bf2cbc95ba0d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Oct 10 19:05:14 2017 +0200

    nimble/controller: Fix extended connect
    
    With this patch we make sure that LE Enhanced Connection complete event
    is sent to host after controller receives AUX_CONNECT_RSP
    
    X-Original-Commit: 60632db3189078499a8b049ba715b04d7f3635f5

 nimble/controller/src/ble_ll_conn.c | 38 +++++++++++++++++++++++++------------
 1 file changed, 26 insertions(+), 12 deletions(-)

commit f2a7c505f9dcc90c200252a7c47cb61de0cd9f35
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 17 10:17:35 2017 +0200

    mesh: Fix missing feature bits
    
    The feature bits for Proxy and Friend were missing in the composition
    data and heart beat messages.
    
    Ported from Zephyr PR #4345
    
    X-Original-Commit: 510b2e3851538fcae55276f89668033253b59aeb

 nimble/host/mesh/src/cfg.c | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 80eabbb81e72d39d4ca12d8ac52ff68fcc69c234
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 17 10:06:23 2017 +0200

    mesh: Heartbeat fixes for message count
    
    Both count and period must be non-zero for message publication
    Stop publication when count becomes zero
    Add count to debug message in hb_publish
    
    Ported from Zephyr PR #4354
    
    X-Original-Commit: 03d343d1147eca07c123e787b1368bf5234f64c5

 nimble/host/mesh/src/cfg.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 0fb3508ab74e10e2a9a72428b3e8c11514b83ab6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 9 23:47:39 2017 +0200

    nimble/controller: Fix off one issue with ext adv data
    
    This patch fixes advertising data when coping to host via ext
    advertising event
    
    X-Original-Commit: f1b692bcaeea649483cf01e36f27621aff054930

 nimble/controller/src/ble_ll_scan.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 99074c425d05c745fa852ef0fef99a7ebd647cb2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 9 23:13:01 2017 +0200

    nimble/controller: Fix handling ext adv with advA
    
    It is possible that adva is already in ext adv. This patch handles this.
    Also having address is aux_data is needed for chainning support.
    
    X-Original-Commit: 91f40b2e3321382159e9a5d5eaaaa10f05b7ca4a

 nimble/controller/include/controller/ble_ll_scan.h |  3 ++
 nimble/controller/src/ble_ll_scan.c                | 47 +++++++++++++++++-----
 2 files changed, 41 insertions(+), 9 deletions(-)

commit 74b4fc1f51ca140755f6683b8ef8017ffbde2677
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 9 21:48:09 2017 +0200

    nimble/controller: Fix wl for extended scanner
    
    This is regression after moving aux scheduling to LL task
    
    X-Original-Commit: 2a979fd3e9131c299a320917ce2d4ea69297d483

 nimble/controller/src/ble_ll_scan.c | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 07d2fe2dd2184e028eced09e0a89fc953415e691
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 9 11:41:53 2017 +0200

    nimble/controller: Move scheduling aux to LL
    
    It is better to do it not in interrupt but in LL task
    
    X-Original-Commit: 9bf987d7c763dd2056f386ffe4e12815914b5c1e

 nimble/controller/src/ble_ll_conn.c | 12 ++++++------
 nimble/controller/src/ble_ll_scan.c | 26 ++++++++++++++++----------
 2 files changed, 22 insertions(+), 16 deletions(-)

commit 2f24dce05fc461a4b754f5e77364a49428d0e720
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 12 18:03:30 2017 +0200

    nimble/controller: Improve ext connection creation
    
    This patch make sure to continue scanning while waiting for AUX_ADV_IND
    or when got invalid ext advertising data.
    
    X-Original-Commit: 17395ab36fb2c52f3ede7012359af09fe134f971

 nimble/controller/src/ble_ll_conn.c | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

commit 0a3a8bb276eae634ac472eb95f717d01b7ce87fa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 12 18:02:05 2017 +0200

    nimble/controller: Fix memory leaks when creating connection
    
    This patch makes sure to release aux data if something goes wrong.
    
    X-Original-Commit: 9012fcdb5323e488758ac5914c75d9f4016f7903

 nimble/controller/src/ble_ll_conn.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit f6df70ac1668274c4a215cb872e09310f25f699c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 5 14:50:26 2017 +0200

    nimble/controller: Improve getting aux ptr code
    
    ble_ll_scan_get_aux_data() function gets current aux data from
    scansm->cur_aux_ptr or creates a new one for new AUX_ADV_IND.
    When it succeed, scansm->cur_aux_ptr is NULL-ed
    
    X-Original-Commit: d78b565475b4b2f08840607e2911aeebe0c62fae

 nimble/controller/src/ble_ll_scan.c | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit 5f17f610567c2a2f3969c57ba8f92613b34ff3a1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Oct 6 20:17:53 2017 +0200

    nimble/controller: Fix memory leaks in the ext scanner
    
    With this patch we make sure that current aux data are in the
    ble_hdr->rxinfo.user_data and LL task will free it whenever it is
    needed.
    
    X-Original-Commit: b428b68d14782df56920a479f852d0b4a100ca7c

 nimble/controller/src/ble_ll_scan.c | 31 ++++++++++++++++++++-----------
 1 file changed, 20 insertions(+), 11 deletions(-)

commit 68aa4589684fc73928d88da9c791dc0078ca0ba9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 4 16:04:59 2017 +0200

    nimble/controller: Always check if we need to continue scan
    
    X-Original-Commit: 2319c1676805c223738ccf372818115630c0e95a

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6172f2d151060561ec6ba3ae3b944ef3e2a9ebe1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 4 15:51:22 2017 +0200

    nimble/controller: Fix missleading variable name
    
    X-Original-Commit: 720ea976734445098ca4e59f598bcd592baa2abf

 nimble/controller/src/ble_ll_scan.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit c33b1fe276b9a94ed2de54ff81fe7336dd489ed1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Oct 5 05:32:13 2017 +0200

    nimble/controller: Improve wfr timer for aux ptr
    
    With this patch we allow to wait as long as header of aux ptr last
    plus offset unit
    
    X-Original-Commit: ccb19bc9e41c3068278e0c1e1611688b7832ac7f

 nimble/controller/include/controller/ble_ll_scan.h | 3 ++-
 nimble/controller/src/ble_ll_scan.c                | 6 +++++-
 2 files changed, 7 insertions(+), 2 deletions(-)

commit b5ad65b198e7543a26f627cb5aabce39a9688917
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Oct 4 15:41:13 2017 +0200

    nimble/controller: Fix freeze in extended scanning
    
    When scan timer fires (on each interval) and scanner is currently
    waiting for aux ptr, timer is not restarted. It will be restared
    once aux data come or wfr timer will fire
    
    X-Original-Commit: 09ace36899a88c260306945f2638139f494e213e

 nimble/controller/include/controller/ble_ll.h      |  2 ++
 nimble/controller/include/controller/ble_ll_scan.h |  3 ++-
 nimble/controller/src/ble_ll.c                     |  2 ++
 nimble/controller/src/ble_ll_scan.c                | 18 +++++++++++++++---
 4 files changed, 21 insertions(+), 4 deletions(-)

commit 2d39fab88d9b7952b69e3dfcc50ad8fe1187e2b1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 2 14:59:39 2017 +0200

    nimble/gap: Fix usage of BLE_GAP_OBSERVER
    
    This patch fixes compile errors when BLE_GAP_OBSERVER is '0' and
    BLE_EXT_ADV is '1'
    
    Also does a cleaning of usage of this flag.
    
    X-Original-Commit: 499601be9878c5f0e2f4691faf38a64c14254fc4

 nimble/host/src/ble_gap.c | 37 +++++++++++++++++++++++++++++++------
 1 file changed, 31 insertions(+), 6 deletions(-)

commit 25d86f898c0657b0ac78b686fdba8e960c2b7364
Merge: 6c090b5c ed81c5fe
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Oct 13 22:32:05 2017 +0200

    Merge pull request #617 from andrzej-kaczmarek/nimble-ll-fix-build
    
    nimble/ll: Fix build w/o ext adv
    
    X-Original-Commit: b3f434ef8ef3649db4ebf21496f61c7d792cd8cd

commit 6c090b5cfd93abce0e3c19f53d7db124ac62429f
Merge: 6257b89b 60769bb3
Author: mkiiskila <marko@runtime.io>
Date:   Fri Oct 13 13:04:30 2017 -0700

    Merge pull request #612 from mkiiskila/debug_mX_flags
    
    compiler m0/m4; use -Og instead of -O1 with debug build_profile.
    
    X-Original-Commit: b485f5e2de5fe8246e17dbf83dea52a4719d0e6a

commit ed81c5fe1751f200d557f40710bdd2be58471f50
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Oct 13 22:01:03 2017 +0200

    nimble/ll: Fix build w/o ext adv
    
    X-Original-Commit: c67edd1ebf67236f354a35eafbdc3b28020740d7

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6257b89b3c461429292119b73ff2371b8896a795
Merge: 0de7d6cd dfd9dd33
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Oct 13 10:27:12 2017 -0700

    Merge pull request #616 from ccollins476ad/ble-hs-test-refactor
    
    BLE Host - Move HCI test util code into a new file
    
    X-Original-Commit: a488c5871a9296e24141303d9f927fd9f6fffe3b

commit 60769bb314e0d6524e9de9ba2bd9e8b82aa14923
Author: Marko Kiiskila <marko@runtime.io>
Date:   Fri Oct 13 10:15:44 2017 -0700

    ble controller; was not building properly with FEAT_LL_PRIVACY set to 0.
    
    X-Original-Commit: f5830505bd9846e3e4a409f78c1523e256b1ef4c

 nimble/controller/src/ble_ll_conn.c | 2 ++
 1 file changed, 2 insertions(+)

commit 0de7d6cdddfe8e5c682ccafcf913f5e9fedd3a0c
Merge: c7453954 7e09cf33
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Oct 13 14:00:29 2017 +0200

    Merge pull request #615 from andrzej-kaczmarek/nimble-phy-mode-fix
    
    nimble/ll: Fix scheduling of new connection in slave role
    
    X-Original-Commit: 05ef620b041799e12ce84b69cd38bd1af066a962

commit 9adc3ee41685d7f9f06f49f81434a851d777ad74
Author: Marko Kiiskila <marko@runtime.io>
Date:   Thu Oct 12 16:38:13 2017 -0700

    Fix new warnings caused by change in compiler flag setting.
    
    X-Original-Commit: 95e40f28b7dfd484f48047e98b6e57de381a7f7d

 nimble/host/src/ble_att_svr.c | 1 +
 1 file changed, 1 insertion(+)

commit dfd9dd33b3b4749050c830ea7728e35023138b52
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 15:43:21 2017 -0700

    BLE Host - Move HCI test util code into a new file
    
    The BLE host test code was getting out of hand, and this is a small
    step towards making it manageable again.  This commit moves all the
    HCI-related test utility functions into a new file:
    `net/nimble/host/test/src/ble_hs_test_util_hci.c`.  Furthermore, all the
    functions in this file have been renamed to use the common prefix
    `ble_hs_test_util_hci_`.
    
    X-Original-Commit: 4af5eb7a138d198deac281e7b8329992009d23e5

 nimble/host/test/src/ble_att_svr_test.c     |   4 +-
 nimble/host/test/src/ble_gap_test.c         | 149 +++---
 nimble/host/test/src/ble_gatt_conn_test.c   |  11 +-
 nimble/host/test/src/ble_gatt_disc_s_test.c |   2 +-
 nimble/host/test/src/ble_hs_adv_test.c      |   8 +-
 nimble/host/test/src/ble_hs_conn_test.c     |   6 +-
 nimble/host/test/src/ble_hs_hci_test.c      |  36 +-
 nimble/host/test/src/ble_hs_pvcy_test.c     |  52 +--
 nimble/host/test/src/ble_hs_test_util.c     | 691 ++++------------------------
 nimble/host/test/src/ble_hs_test_util.h     |  57 +--
 nimble/host/test/src/ble_hs_test_util_hci.c | 555 ++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util_hci.h |  99 ++++
 nimble/host/test/src/ble_l2cap_test.c       |  10 +-
 nimble/host/test/src/ble_os_test.c          |  18 +-
 nimble/host/test/src/ble_sm_test_util.c     |  20 +-
 15 files changed, 926 insertions(+), 792 deletions(-)

commit c7453954e4a0016ca1df242bb9dedd89992ce419
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Oct 7 23:47:49 2017 +0200

    nimble/ll: Fix scheduling of extended advertising events
    
    The advertising state machine uses flag to distinguish between two phys
    when handling events sent from interrupt to ll task, but is problematic
    since flag is set in an interrupt and then usually checked in ll task
    so race may occur when two events for different phys are passed to the
    task. This makes advertising unstable in non-ideal conditons.
    
    To fix this we use separate events for pri and sec phys for advertising
    so there will be no races when accessing the flag since it is done in
    isr only (except for cases where we want to stop advertising but it
    does not matter there).
    
    X-Original-Commit: 80134cd8321bde22e982c2c7f0173c4a8bbd2215

 nimble/controller/src/ble_ll_adv.c | 336 ++++++++++++++++++++++++++-----------
 nimble/include/nimble/ble.h        |   4 +
 2 files changed, 243 insertions(+), 97 deletions(-)

commit 7e09cf330bbbff2c2be28dd224002413bde802b0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 12 15:48:27 2017 +0200

    nimble/ll: Fix scheduling new connection in slave role
    
    If we do ext adv with secondary on coded phy, we use coded s2 for rx.
    If initiator sends AUX_CONNECT_REQ with s8, we'll calculate packet
    length incorrectly and schedule connection event too early by ~2 msecs
    which is the different between tx time of AUX_CONNECT_REQ on s8 and s2.
    
    With this fix we'll use actual phy mode of the received packet so we
    can schedule connection event properly.
    
    X-Original-Commit: 99f81e5d2ca59989852fd64f9c1a0abdd1c8428f

 nimble/controller/src/ble_ll_conn.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit 9cd9ca086e2be6861242ed9025d7fc268b7d973c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 12 15:49:49 2017 +0200

    nimble/phy: Fix usage of rx phy_mode
    
    We now have phy_mode for rx available in rxinfo so let's use it.
    
    X-Original-Commit: 9cdfe8c07d53c608475c147702857fe5de267f61

 nimble/drivers/nrf52/src/ble_phy.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

commit ba73e1b07638c201e799dcea54c9498f6b771c80
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 12 12:33:36 2017 +0200

    nimble/phy: Add phy_mode to rxinfo
    
    We only have phy which does not tell us whether we received S2 or S8
    when doing coded phy. Let's add proper phy_mode there.
    
    X-Original-Commit: a326f99b89a35f7ad3ca52d7fe38a126b34b07c3

 nimble/drivers/nrf51/src/ble_phy.c | 1 +
 nimble/drivers/nrf52/src/ble_phy.c | 1 +
 nimble/include/nimble/ble.h        | 2 ++
 3 files changed, 4 insertions(+)

commit ad918bd1de1cbb38ce61c254fc718995e6ae6e01
Merge: 419a1f26 52ff2aa9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 12 14:11:03 2017 +0200

    Merge pull request #608 from andrzej-kaczmarek/nimble-ll-aux-sched
    
    nimble/ll: Fix scanning schedule for aux packets
    
    X-Original-Commit: 8f23db5ce586b80c82acf878b80692364c38f35a

commit 419a1f26ea2828a0361948b32824ffbb2b1fa26b
Merge: 44d79c88 2b8ddea6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Oct 12 11:02:01 2017 +0200

    Merge pull request #609 from michal-narajowski/mesh-fixes
    
    Mesh improvements
    
    X-Original-Commit: e2bf004fac29b801d5ddb39c916176495e65a0ff

commit 44d79c88cf377db02d16f9486f191bf7bc6dd642
Merge: d10f382f 9eec13ec
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Wed Oct 11 15:36:29 2017 -0700

    Merge pull request #613 from ccollins476ad/ble-max-pkts
    
    BLE Host - Honor controller's flow control
    
    X-Original-Commit: ca449ea140ce320915c2d0ef90529158e43f7f8e

commit 9eec13ecb0a95a6a36506d55c707b67f3c999bed
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Oct 11 10:54:59 2017 -0700

    BLE Host - Read BR/EDR buffer size at startup.
    
    If the LE buffer size is 0, the controller shares the same buffers for
    LE and BR/EDR.  In this case, use the BR/EDR values.
    
    X-Original-Commit: ad838b4b69571d844600503209cd741f20379673

 nimble/host/src/ble_hs_conn_priv.h |  2 +-
 nimble/host/src/ble_hs_hci.c       |  6 ++--
 nimble/host/src/ble_hs_hci_priv.h  |  4 +--
 nimble/host/src/ble_hs_startup.c   | 65 ++++++++++++++++++++++++++++++++------
 nimble/include/nimble/hci_common.h |  5 +++
 5 files changed, 67 insertions(+), 15 deletions(-)

commit d10f382f1cebbc35dd2cffb79be1c64813a09ad4
Merge: bf8f40be 29adaa81
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Oct 11 17:05:59 2017 +0200

    Merge pull request #611 from andrzej-kaczmarek/nimble-phy-rxtx-s8
    
    nimble/phy: Change TX scheduling in RX-TX transition
    
    X-Original-Commit: d9919e040b962b908b43c56cdb49ef5cf95070d2

commit ca8d204d8b44c62cd04eaff679cc031996373bb4
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Oct 10 18:31:34 2017 -0700

    BLE Host - Remove ACL transmit queue.
    
    This queue (`ble_hs_tx_q`) stopped serving any purpose a while ago.
    This queue was introduced back when the host ran in its own dedicated
    task.  When Mynewt packages were made cooperative, this queue became
    unnecessary.
    
    Now that each connection has its own transmit queue, it is time to
    finally remove this useless queue.
    
    X-Original-Commit: 73dfd8f43cec1e618fd1375f88ca92db49d88a63

 nimble/host/src/ble_hs.c                     | 39 +++++++---------------------
 nimble/host/src/ble_hs_priv.h                |  1 -
 nimble/host/test/src/ble_att_clt_test.c      |  6 -----
 nimble/host/test/src/ble_att_svr_test.c      | 29 ---------------------
 nimble/host/test/src/ble_gap_test.c          |  2 --
 nimble/host/test/src/ble_gatt_conn_test.c    |  1 -
 nimble/host/test/src/ble_gatt_disc_c_test.c  | 14 ----------
 nimble/host/test/src/ble_gatt_disc_d_test.c  |  8 ------
 nimble/host/test/src/ble_gatt_disc_s_test.c  | 14 ----------
 nimble/host/test/src/ble_gatt_find_s_test.c  |  9 -------
 nimble/host/test/src/ble_gatt_read_test.c    |  9 -------
 nimble/host/test/src/ble_gatt_write_test.c   | 18 -------------
 nimble/host/test/src/ble_gatts_notify_test.c | 14 ----------
 nimble/host/test/src/ble_gatts_read_test.c   |  1 -
 nimble/host/test/src/ble_gatts_reg_test.c    |  1 -
 nimble/host/test/src/ble_hs_hci_test.c       |  6 -----
 nimble/host/test/src/ble_hs_test_util.c      | 31 ----------------------
 nimble/host/test/src/ble_hs_test_util.h      |  1 -
 nimble/host/test/src/ble_l2cap_test.c        | 18 -------------
 nimble/host/test/src/ble_os_test.c           |  1 -
 nimble/host/test/src/ble_sm_test.c           |  4 ---
 nimble/host/test/src/ble_sm_test_util.c      | 37 --------------------------
 22 files changed, 9 insertions(+), 255 deletions(-)

commit 7f1c7cac850c1281144ea1ca4da11c343ad194e1
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Oct 10 17:27:22 2017 -0700

    BLE Host - Honor controller's flow control
    
    Prior to this commit, the host ignored any "Number of Completed Packets"
    events from the controller.  If the host had any data to send, it would
    always send it, even if the controller had no free buffers.
    
    Now, the host only sends an ACL packet if the controller has a buffer to
    hold it:
    
    * When the controller cannot accept more data, the host enqueues
    outgoing data to the appropriate connection's transmit queue.
    
    * If the host has queued data and the controller indicates that it has
    freed up buffers, the host attempts to send all its queued data.
    
    * If a disconnect occurs, all outstanding packets associated with the
    connection are considered flushed.
    
    X-Original-Commit: fea90524264693a9d22e91a6015b87db68369107

 nimble/host/src/ble_hs.c                |  70 +++++++++
 nimble/host/src/ble_hs_conn.c           |   2 +
 nimble/host/src/ble_hs_conn_priv.h      |  11 +-
 nimble/host/src/ble_hs_hci.c            | 104 +++++++++++---
 nimble/host/src/ble_hs_hci_evt.c        |  42 +++++-
 nimble/host/src/ble_hs_hci_priv.h       |   9 +-
 nimble/host/src/ble_hs_priv.h           |   1 +
 nimble/host/src/ble_l2cap.c             |  17 ++-
 nimble/host/test/src/ble_hs_hci_test.c  | 246 ++++++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.c |  44 +++++-
 nimble/host/test/src/ble_hs_test_util.h |   3 +
 11 files changed, 513 insertions(+), 36 deletions(-)

commit 29adaa817d66dbd819a0991065b9c04947848ff9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 10 20:56:37 2017 +0200

    nimble/phy: Change TX scheduling in RX-TX transition
    
    We fail to reply AUX_ADV_IND with a AUX_CONNECT_REQ if auxiliary packet
    was received on LE Coded S8 phy. This is because time required to
    process this packet is rought the same as when we need to enable radio
    before transmission so we simply miss the slot and set the timer0 to
    fire in the past.
    
    The solution is to setup timer0 before processing the packet so radio
    can be enabled on time and in case we don't need to tx anything we'll
    just disable the timer and nothing will be transmitted.
    
    X-Original-Commit: bb48d9e20e25f952ec085cca34f75967b54fca84

 nimble/drivers/nrf52/src/ble_phy.c | 42 +++++++++++++++++++++++++-------------
 1 file changed, 28 insertions(+), 14 deletions(-)

commit 2b8ddea6b67a8df3a98f2f19e721bdbf1066d9ad
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Oct 6 16:42:17 2017 +0200

    mesh: Fix sending unassigned variable in mod_sub_va_overwrite
    
    X-Original-Commit: f19a465cd25f65f79cf42b2b8bfcf296d38393cb

 nimble/host/mesh/src/cfg.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 226ad0c032840d70e1eb0ea632e584c413bf6e26
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Oct 6 16:01:49 2017 +0200

    mesh: Fix setting mod sub status parameters
    
    Mesh Profile Specification v1.0, 4.4.1.2.8:
    
    "When an element receives a Config Model Subscription Add message
    or a Config Model Subscription Virtual Address Add message that
    is not successfully processed (i.e., it results in an error condition
    listed in Table 4.113), it shall respond with the Config Model
    Subscription Status message, setting its fields to the values
    of the corresponding fields (i.e., the identically named fields)
    of the incoming message and setting the Status field to a status code
    (defined in Table 4.113), and setting all other fields to 0."
    
    The same applies to other Model Subscription messages.
    
    X-Original-Commit: a2c8f1c38c780dea323f20bc1ea9c8ded1e4e545

 nimble/host/mesh/src/cfg.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

commit 6e759e63bffe4aca22ac115455d7faaff6c1f6a3
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 3 12:13:53 2017 +0200

    mesh: Fix missing argument in k_delayed_work
    
    X-Original-Commit: 081e4520f49e0769319dbf8aef82d4225809720f

 nimble/host/mesh/src/health.c | 1 +
 1 file changed, 1 insertion(+)

commit bf8f40befd611ed19969138af59d8258647b63e0
Merge: 3f781737 3307086b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 10 10:32:51 2017 +0200

    Merge pull request #604 from michal-narajowski/mesh_app_key_revoke
    
    mesh: Fix revoking app keys
    
    X-Original-Commit: 1e4af1c3a0965425389f64d65372b72c26ee2bfb

commit 52ff2aa92433b17ef4fde3eeecf481c8e5600e99
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 9 12:12:35 2017 +0200

    nimble/ll: Improve scheduling of aux scan
    
    This patch makes scheduling of aux scan much more precise by using
    usecs remainder for both ext packet start and scheduled item time
    (instead of just using plain ticks). It should be accurate up to
    1 usec now.
    
    X-Original-Commit: 136134b59fc4bfeef370c339928911a5d2b5c6f6

 nimble/controller/src/ble_ll_scan.c  | 30 ++++++++++++++++++++++--------
 nimble/controller/src/ble_ll_sched.c | 16 +++++++++++++---
 2 files changed, 35 insertions(+), 11 deletions(-)

commit 427f49383b90dff5c01497d295baa5d96af1d3fc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 9 11:13:36 2017 +0200

    nimble/ll: Cleanup aux scheduling function
    
    Cleanup variable names and comments to make it logical, i.e. there's no
    "earliest start" here since we either can schedule aux scan at specific
    point of time or not - we can't adjust it.
    
    X-Original-Commit: 09af9bdcf80e0d493180a1e3045402cfb48f55aa

 nimble/controller/src/ble_ll_sched.c | 24 +++++++++---------------
 1 file changed, 9 insertions(+), 15 deletions(-)

commit 3f781737b92ca55f1336ad9447466b5cbba42c79
Merge: a493ab8a 33d421e1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 9 10:55:33 2017 +0200

    Merge pull request #602 from andrzej-kaczmarek/nimble-phy-fix
    
    nimble/phy: Few fixes for handling debug gpio pins
    
    X-Original-Commit: b9e81fff81e68ee33b6b61ead200e9b564881af0

commit a493ab8a9d46cc54421755eb72324b7fdf093f3e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Oct 9 00:33:34 2017 +0200

    nimble/ll: Fix consecutive bits detection in AA
    
    Initial value for number of consecutive bits should be 1, i.e. single
    bit is "1 consecutive bit".
    
    With this set to 0 we calculate number of consecutive bits 1 less than
    we should and thus allow for 7 consecutive bits in AA which is invalid.
    
    Also, in case 7 msb have the same value, we would detect this at the
    last iteration of loop which means mask value is already set to final
    value so invalid sequence won't be detected. To make this simple, let's
    just set mask value to 0 in case consecutive bits violation is detected
    so it is always properly detected as invalid sequence.
    
    X-Original-Commit: 83a67239f859298380fc70448e03eacaec987795

 nimble/controller/src/ble_ll_conn.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 3307086b612e469650581388ef107dcb91bb58de
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Oct 6 13:05:02 2017 +0200

    mesh: Fix revoking app keys
    
    The needed code for taking updated app keys into use and revoking the
    old ones was missing.
    
    X-Original-Commit: 960c8571ba3d45a69dc380f3743bb3a157ae0775

 nimble/host/mesh/src/cfg.c |  2 +-
 nimble/host/mesh/src/net.c | 23 +++++++++++++++++++++--
 nimble/host/mesh/src/net.h |  3 +++
 3 files changed, 25 insertions(+), 3 deletions(-)

commit 1e5da3464c30602892c94ca0b74e627bcb8b0d03
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 20:29:40 2017 +0200

    nimble/ll: Add extra assertion for adv chanmask
    
    X-Original-Commit: 5fa7fe868866f78a484933c8b6d16a4cb598672e

 nimble/controller/src/ble_ll_adv.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 53aa77acc8f3db91a475690fc812efe102ef5c52
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 11:56:53 2017 +0200

    nimble/ll: Fix calculating auxiliary offset in AUX_ADV_IND
    
    The auxiliary offset should be calculated as time difference between
    current packet and auxiliary packet as set in scheduler. This gives
    precise time so there's no need for magic "plus ones" anymore.
    
    X-Original-Commit: f84a0f64ecbfc921fa1fb165c2f613a8d2392ef0

 nimble/controller/src/ble_ll_adv.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 79d9ce8d1329c806cea0a47106ba67f85a90c34b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 10:25:17 2017 +0200

    nimble/ll: Fix scheduling of AUX_ADV_IND packets
    
    This patch fixes few issues with scheduling of auxiliary packets when
    doing extended advertising.
    
    The main problem here was that there was TX-RX transition done after
    ADV_EXT_IND so it increased interval between subsequent packets and
    this was not accounted for properly in calculations so some weird
    values had to be added here and there to make it "work". But event
    with these additions the last packet in advertising event could not
    be scheduled before auxiliary packet so we skipped it.
    
    So the transition is now removed, the packets are sent closer together
    and calculations are fixed. This means we spend less time with radio
    turned on which is nice thing.
    
    X-Original-Commit: 597d7f2435e0fbf0d739aabc61b741808e7a2d9d

 nimble/controller/include/controller/ble_ll.h |  1 +
 nimble/controller/src/ble_ll.c                |  1 +
 nimble/controller/src/ble_ll_adv.c            | 57 ++++++++++++++++++---------
 3 files changed, 41 insertions(+), 18 deletions(-)

commit c4dc74cba1fc8721b846d25e8597ff762202429e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 10:02:14 2017 +0200

    nimble/ll: Add ble_ll_usecs_to_ticks_round_up
    
    This is a wrapper for os_cputime_usecs_to_ticks but it will always
    round ticks up.
    
    X-Original-Commit: 1fdffe57c74cccde2f1e09118436f45c5525c624

 nimble/controller/include/controller/ble_ll.h | 7 +++++++
 1 file changed, 7 insertions(+)

commit 1ac143a01360aff0005d473dfa56075a24479136
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 10:12:41 2017 +0200

    nimble/ll: Fix weird symbol name usage
    
    BLE_LL_SCHED_MAX_TXRX_SLOT is in fact defined as 5 secs but I does not
    seem to be related in any way to context in which it is used. Just
    hardcode '5000' instead, the comment above explains everything.
    
    X-Original-Commit: fd409d9d233081db5bb18ec0b7ffe6696a4a7f46

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b53637952914084a035420f769fb9bd204a56e86
Merge: 41f19051 dc87ef49
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Thu Oct 5 12:49:30 2017 -0700

    Merge pull request #595 from ccollins476ad/no-conn-fail-evt
    
    BLE Host - Connect failures were not reported.
    
    X-Original-Commit: 6f27b3605f9f438f10f79796b0958b918ecbad2b

commit dc87ef496d430bdadcd86f09b96ad2f4b5bc5f4d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Oct 5 12:46:59 2017 -0700

    BLE Host - Unit test for unreported connect fails.
    
    X-Original-Commit: 8a14dae1399b78b487ca8749bc1f829dd1d87975

 nimble/host/test/src/ble_gap_test.c | 38 +++++++++++++++++++++++++++++++++++++
 1 file changed, 38 insertions(+)

commit 33d421e1d1b7fb77aa1d1f93534a84673c397e50
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 12:35:18 2017 +0200

    nimble/phy: Add note about used PPI channels
    
    X-Original-Commit: c96ad62ffde63ac5641e151945ce6647ec70f6e7

 nimble/drivers/nrf52/src/ble_phy.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit b94f0aefcdfebdbcf7ee9767fd8fb777d937cae9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 12:27:04 2017 +0200

    nimble/phy: Change PPI channels for debug pins
    
    Let's use last 3 available channels instead of something in the middle.
    
    X-Original-Commit: 8a6d9fd72034150cad021bba84c925c21ec45f9a

 nimble/drivers/nrf52/src/ble_phy.c | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 37f5711d6b014b3c300304aea6ef7bd50b31dab0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Oct 5 10:06:37 2017 +0200

    nimble/phy: Make sure wfr debug pin is properly disabled
    
    wfr debug pin should be disabled if:
    - address is matched and we start receiving (CH4)
    - timeout occurs (CH5)
    - radio is disabled for any other reason (CH8)
    
    X-Original-Commit: 892fc3760dd4b92802ab20d9fab239ca71922f7e

 nimble/drivers/nrf52/src/ble_phy.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 41f190514adba0a1c1293d10cb12a0a188ac8bc5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Oct 3 12:15:58 2017 +0200

    nimble/host: Fix ble_hs_adv_parse()
    
    X-Original-Commit: 807dc0c7c62a6e5ad2fc6d9dc2aa4d3aa7e6e3b8

 nimble/host/src/ble_hs_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6bce742f13e48a7736e52dd2495d21b073c7c6a4
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 22 10:56:02 2017 +0200

    mesh: Don't send health status messages if a test fails
    
    The test failure may be e.g. because of an unknown company id, and in
    that case the spec expects us to ignore the message.
    
    With this patch it should be possible to pass MESH/SR/HM/RFS/BI-01-C.
    
    X-Original-Commit: 6e12df091d4a04dd854b5a5a1fee4877523a137f

 nimble/host/mesh/src/health.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 74ad5844b57fe5ed9c10ed835dcfb76362c7b78a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Oct 3 10:43:38 2017 +0200

    mesh: Fix setting health period divider
    
    A previous patch which moved dispatching the health publish callback
    to a later moment introduced a regression where the period divider
    does not get updated when it should. In fact, having the divider as
    part of the Health Server context is redundant, since the same
    information is already stored generically in the model publication
    context. Switching to using the model publication context makes things
    simpler and ensures that the value is always up-to-date.
    
    With this patch it is possible to pass MESH/SR/HM/CFS/BV-02-C.
    
    X-Original-Commit: 442ad286b40ef37ff624e1119bd9995888ea74f7

 nimble/host/mesh/include/mesh/mesh.h |  3 ---
 nimble/host/mesh/src/health.c        | 11 +++--------
 2 files changed, 3 insertions(+), 11 deletions(-)

commit 02b3ffa88f68c2951ce58a52a518e328540a92d6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 22 11:22:52 2017 +0200

    mesh: Fix Set LPNTimeout message handling
    
    We should ignore invalid addresses (helps pass
    MESH/NODE/CFG/LPNPT/BI-01-C). Also fix a copy-paste issue in an error
    log.
    
    X-Original-Commit: 3b445e152ec62fd5872e0d491b4b4dc36cdd407d

 nimble/host/mesh/src/cfg.c | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

commit 8658a9474b6e34a97f3800409377bfcb00c56c47
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 22 14:07:06 2017 +0200

    mesh: Fix resetting heartbeat subscription expiry properly
    
    Set the value clearly to 0 instead of letting the old expiry time stay
    around.
    
    X-Original-Commit: 37f270cf792f64eef9a4af2c02f09a07d72b3149

 nimble/host/mesh/src/cfg.c | 2 ++
 1 file changed, 2 insertions(+)

commit 0b4bd03718577420996e56c291a3d9b9fc1dacf8
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 21 16:29:46 2017 +0200

    mesh: Fix zeroing heartbeat state
    
    The values all need to be zeroed when heartbeat subscription is
    disabled. This makes it possible to pass MESH/NODE/CFG/HBS/BV-01-C.
    
    X-Original-Commit: d8be74d7e7a22e2fb3ebbad19829fd04aaca80c1

 nimble/host/mesh/src/cfg.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 0bf0f1a09e93006e57a943014adb5bf2d7888536
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 21 15:56:36 2017 +0200

    mesh: Fix spelling of "heartbeat"
    
    X-Original-Commit: 7d5f33a34d5134ada12f81cd85654de53591436a

 nimble/host/mesh/src/cfg.c | 32 ++++++++++++++++----------------
 1 file changed, 16 insertions(+), 16 deletions(-)

commit a85f00620631bdefaad77aa9845ae2720cf9fa4a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 20 16:07:41 2017 +0200

    mesh: Fix encoding fault count to Health Current Status
    
    There was a missing adjustment to buf->len after fetching the faults
    from the app.
    
    X-Original-Commit: cad5746c49b0e774d7cd3886563aea63b871a8b3

 nimble/host/mesh/src/health.c | 1 +
 1 file changed, 1 insertion(+)

commit 23b686d15f29416d59778cffc8075d5e6b49789b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 20 16:04:37 2017 +0200

    mesh: Fix Health Period Set OpCode
    
    This was a copy-paste mistake.
    
    X-Original-Commit: 9a75c131940dd41ff8859cdd56cca83e132d71d6

 nimble/host/mesh/src/foundation.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit afa4ac5ac1569a077eb5ce4f809f59fd5c17f1d6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 27 09:20:45 2017 +0200

    mesh: Fix SDU length check
    
    The code was passing the wrong first parameter to the sdu_len_is_ok()
    function.
    
    X-Original-Commit: c5553b0e7f5afc36dba8efbf0b23de474c576c86

 nimble/host/mesh/src/transport.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e8059e87a49663f1408b7e419ef38e275e8addbf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 27 09:19:40 2017 +0200

    mesh: Fix string signedness issue
    
    Some compilers (like icx) may complain about unsigned vs signed strings.
    
    X-Original-Commit: f544190b63cd2612d2e9aeb73af2c98793aa8834

 nimble/host/mesh/src/prov.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 8bf81891affce7754065059037dbdfece3ce02a4
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 2 13:57:17 2017 -0700

    BLE Host - Connect failures were not reported.
    
    X-Original-Commit: 5f0e14047d33a60d6489b989c766bb1b1ed08191

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7166a14e6e9aec14455d59eede23e5737d286032
Merge: 5ac775f1 2ac08fb8
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Mon Oct 2 10:37:26 2017 -0700

    Merge pull request #593 from ccollins476ad/restore-irks
    
    BLE Host - Populate resolving list with persisted IRKs at startup
    
    X-Original-Commit: 4437116900bcfc7df1f3a584731dd4b133ccfad1

commit 5ac775f1c021e90ad4c68146fb6d22ebce189e74
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Oct 2 13:38:47 2017 +0200

    nimble: Don't hardcode TinyCrypt rand function
    
    TinyCrypt requires rand function to be implemented by user. Instead of
    hardcoding it, user is required to provide own implementation by
    uECC_set_rng. This allows to provide different implementations
    depending on supported features (eg BLE controller).
    
    X-Original-Commit: f4b900abc1c4759fbaf344f291f2c3002c356223

 nimble/host/mesh/src/mesh.c   |  3 +++
 nimble/host/src/ble_sm_alg.c  | 10 ++++++++--
 nimble/host/src/ble_sm_priv.h |  1 +
 nimble/host/src/ble_sm_sc.c   |  1 +
 4 files changed, 13 insertions(+), 2 deletions(-)

commit 458af7469f91741578b61c38b7329936731fc6e8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 21 11:18:21 2017 +0200

    nimble/mesh: Fix address type handling
    
    X-Original-Commit: c020bf9ccbf8bedec11f9c36acf34a2e7417d3bd

 nimble/host/mesh/src/adv.c  | 8 +++-----
 nimble/host/mesh/src/adv.h  | 2 +-
 nimble/host/mesh/src/glue.c | 5 ++++-
 nimble/host/mesh/src/mesh.c | 5 ++++-
 4 files changed, 12 insertions(+), 8 deletions(-)

commit a4780b43a00fa086c4b973759034be1fd08d3656
Merge: 51792adb bc3d918d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Oct 2 12:26:45 2017 +0200

    Merge pull request #589 from rymanluk/mesh_proxy_fix
    
    mesh: Fix dropping valid proxy configuration messages
    
    X-Original-Commit: f2263d9e009cc287feb0109eb8c167b088d869d6

commit 2ac08fb85cc3519ba42ba47efe29d6e178c8b197
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Sep 29 14:26:47 2017 -0700

    BLE Host - Unit tests for IRK restore on startup.
    
    X-Original-Commit: 32dbb8034713014b0d97d7465b1fc597a8c7c877

 nimble/host/test/src/ble_hs_pvcy_test.c | 144 ++++++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test.c      |   1 +
 nimble/host/test/src/ble_hs_test_util.c |  99 +++++++++++++++++++---
 nimble/host/test/src/ble_hs_test_util.h |  11 +++
 4 files changed, 243 insertions(+), 12 deletions(-)

commit d70a26ca991d6edd47c3a081b422160ce99fadb4
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Sep 29 14:26:31 2017 -0700

    MYNEWT-841 BLE Host - Fill resolve list at startup
    
    [Prior to this commit]
    
    Identity information gets persisted during pairing, but it is never
    restored after a reboot.
    
    [After commit]
    
    At startup and on stack reset, the host populates the resolving list
    with the persisted entries.
    
    X-Original-Commit: a041a481874c9bf74e6f6eabe94c2019b56c8717

 nimble/host/include/host/ble_hs_test.h |  1 +
 nimble/host/src/ble_hs.c               |  5 +++++
 nimble/host/src/ble_hs_misc.c          | 32 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_priv.h          |  3 +++
 nimble/host/src/ble_hs_pvcy.c          | 13 ++++++++++---
 5 files changed, 51 insertions(+), 3 deletions(-)

commit 10b870c6eab2d12225657094e1110c783626f41e
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Sep 29 14:20:40 2017 -0700

    BLE Host - Reduce line length to <= 79 chars.
    
    X-Original-Commit: 755ed10257a864264b359c962ac199704e8ac3a1

 nimble/host/src/ble_store.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit fa94bcce91263ed938bc2b1e0d7669d9962d7416
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Sep 29 14:19:19 2017 -0700

    BLE Host - rename `default_irk` --> `ble_hs_pvcy_default_irk`
    
    X-Original-Commit: 98c0da1b4445978c24a4354a0e3799eb3a03bfaf

 nimble/host/src/ble_hs_pvcy.c      | 4 ++--
 nimble/host/src/ble_hs_pvcy_priv.h | 2 ++
 2 files changed, 4 insertions(+), 2 deletions(-)

commit 51792adbeddcbf11cfaf7071553caf2212eda080
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Sep 29 13:42:42 2017 +0200

    mesh: Fix compilation with GCC 7.1
    
    Fix following error emitted by GCC 7.1:
    
    Error: repos/apache-mynewt-core/apps/blemesh/src/main.c:83:38: error:
     duplicate 'const' declaration specifier [-Werror=duplicate-decl-specifier]
     static const struct bt_mesh_model_op const gen_onoff_op[] = {
                                          ^~~~~
    repos/apache-mynewt-core/apps/blemesh/src/main.c:132:38: error:
     duplicate 'const' declaration specifier [-Werror=duplicate-decl-specifier]
     static const struct bt_mesh_model_op const gen_level_op[] = {
    
    Error: repos/apache-mynewt-core/net/nimble/host/mesh/src/access.c:32:3:  error:
      duplicate 'const' declaration specifier [-Werror=duplicate-decl-specifier]
     } const model_init[] = {
       ^~~~~
    
    X-Original-Commit: 97fa829ed62ca4fbb39e8ed83805386cd0ae6083

 nimble/host/mesh/src/access.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bc3d918d401a540fdde759df214d72e6b8350614
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 29 11:11:26 2017 +0200

    mesh: Fix dropping valid proxy configration messages
    
    Proxy configuration messages are allowed (in fact required) to use
    unassigned addresses, so they should be exempt from this check.
    
    X-Original-Commit: ae8c9582a2eb99e839e1af46e17bc8c2b8b972e4

 nimble/host/mesh/src/net.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 1e52e8d729d035efaaf96a514169cef2e1eb61ae
Merge: 24c1d9c9 d359be94
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Sep 29 10:37:45 2017 +0200

    Merge pull request #578 from sjanc/tc
    
    Update TinyCrypt to 0.2.8
    
    X-Original-Commit: a0ec64040156fe3d916be05d875aad8ebfe8f8fe

commit 24c1d9c999783c2f070dfe3937a9ef32d6a490b4
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Sep 28 17:14:08 2017 -0700

    BLE Host - Make ble_hs_id_infer_auto() public.
    
    This function was intended to be public from the start, but was
    accidentally declared in the wrong header.
    
    X-Original-Commit: 27e6ebe323d74cc849b876a90a6d2fd784b60ade

 nimble/host/include/host/ble_hs_id.h | 1 +
 nimble/host/src/ble_hs_id_priv.h     | 1 -
 2 files changed, 1 insertion(+), 1 deletion(-)

commit 3ba9b33cf96f5fce3927d069a6d027afdcea4aaa
Merge: 57d67a44 1ee52603
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Thu Sep 28 12:54:10 2017 -0700

    Merge pull request #582 from ccollins476ad/native-sock-write
    
    Native socket fixes
    
    X-Original-Commit: 4817a0e6d034ec99dcf16e428399459107f1a254

commit 57d67a448faa8e528c4b85c856f1dca046614b2f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 28 16:07:16 2017 +0200

    nimble/host: Allow setting adv data when advertising
    
    Not sure why this was not allowed, but it is perfectly ok to do so and
    controller will update data while advertising. And even if for some
    reason it won't, there will be proper error returned.
    
    X-Original-Commit: 103638b5e98cfabf59fc1ac646c71840071ec22a

 nimble/host/src/ble_gap.c | 12 ------------
 1 file changed, 12 deletions(-)

commit 1ee52603dc9dec2a24abfad4235cd1335001dac2
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Sep 27 18:03:33 2017 -0700

    Rename BLE socket task "sock" --> "hci_sock"
    
    "sock" was a bit ambiguous since there is already a "socket" task.
    
    X-Original-Commit: 466259deec02325a48a0fecda24427374cd5c065

 nimble/transport/socket/src/ble_hci_socket.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit cd000e3c27c11dc7006b1404c6858b60460517d7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 27 14:47:45 2017 +0200

    mesh: Allow TTL <= 1 for the local net interface
    
    The bt_mesh_net_relay() function needs to allow TTL <= 1 for the local
    network interface since that's the code path that locally originated
    outgoing packets take.
    
    X-Original-Commit: e16ed9fd54d854922b1f21ebf5aca961dbe7d2ef

 nimble/host/mesh/src/net.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 01acbe48fcd9a1cb54db143ef0f43b5a28f5f404
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 27 14:41:55 2017 +0200

    mesh: Remove local network interface MYNEWT_VAL option
    
    From section 3.4.5.3 in the Mesh Profile Specification 1.0:
    
            "A node shall implement a Local Network Interface."
    
    This patch solves also the issue when sending group message and
    BT_MESH_RELAY us not on. In such case message whas not broadcasted.
    
    X-Original-Commit: bd916bd90d897a65701ba5cf8455aff761b49482

 nimble/host/mesh/src/net.c  | 16 ----------------
 nimble/host/mesh/src/net.h  |  2 --
 nimble/host/mesh/syscfg.yml |  7 -------
 3 files changed, 25 deletions(-)

commit 0296a84643166ac2b11f9950837919128e958e17
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 27 14:35:59 2017 +0200

    Revert "mesh: fix handling group send with local interface enabled"
    
    This reverts commit 32df45dff30b7cae70103ffbb0eeae0810493409.
    
    Correct fix on the issue which was solved by this patch is in following
    patch
    
    X-Original-Commit: b8feae34467191f5ad3697a7a3fd422d84194199

 nimble/host/mesh/src/net.c | 17 +++++------------
 1 file changed, 5 insertions(+), 12 deletions(-)

commit ffd3f6458cfe998b3df21e55b2981bb86adff85d
Merge: e945bfc7 2f56305e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Sep 27 13:48:03 2017 +0200

    Merge pull request #576 from andrzej-kaczmarek/tifs-rework
    
    [MYNEWT-783] nimble/phy: Fix T_IFS on coded phy
    
    X-Original-Commit: f3f148ffba65f31a37896df64624a16529984a3d

commit 2f56305e5ca7a99d1cbe34a8d72f69ecc78fd19c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Sep 27 13:08:29 2017 +0200

    nimble/phy: Allow extra t_ifs margin on receive
    
    This is only for debugging purposes as some controllers violate t_ifs
    and we won't be now able to maintain connection with such hw.
    
    X-Original-Commit: a0434c3fd666ea049318b866ca625ab483c34716

 nimble/drivers/nrf52/src/ble_phy.c | 11 +++++++++++
 nimble/drivers/nrf52/syscfg.yml    | 10 ++++++++++
 2 files changed, 21 insertions(+)

commit ba8dac38e3c8cff6101b74d8671146fe2725a952
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Sep 23 18:41:18 2017 +0200

    nimble/phy: Add code to debug radio timings
    
    This patch adds two settings to phy package which use GPIO pins to
    output events from radio for debugging. When captured along air traffic
    it provides useful informations about radio timings.
    
    * pulse between TASKS_TXEN/TASKS_RXEN and EVENTS_READY
      can be used to measure radio ramp-up and TX delay
    * pulse between EVENTS_READY and EVENTS_END
      can be used to measure RX and TX delays
    * pulse between EVENTS_RXREADY and EVENTS_COMPARE[3]
      can be used to debug wfr issues
    
    This was also used to measure timings for new T_IFS code.
    
    X-Original-Commit: da6d46f4ece05b0714f7e55472df30ab5779f1ba

 nimble/drivers/nrf52/src/ble_phy.c | 64 ++++++++++++++++++++++++++++++++++++++
 nimble/drivers/nrf52/syscfg.yml    | 44 ++++++++++++++++++++++++++
 2 files changed, 108 insertions(+)

commit c9c22a1dd31563bc81c6e6d1cd0461baa97e3494
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 22 15:28:42 2017 +0200

    nimble/phy: Fix possible race between wfr and EVENTS_ADDRESS
    
    See comment in code for details.
    
    This was not observed with old wfr code since wfr calculation for TX-RX
    was less accurate and most importantly it used 16 usecs (jitter only
    applicable to anchor point timing) to adjust for clock accuracy instead
    of 2 usecs (as defined by Core spec) so the wfr time was always couple
    of usecs after EVENTS_ADDRESS.
    
    With new wfr code the calculations are more accurate so it's possible
    both events will happen at the same time.
    
    X-Original-Commit: 742e0c3ae95a72c8f00dc0ee941f656458a51eb8

 nimble/drivers/nrf52/src/ble_phy.c | 21 +++++++++++++++++----
 1 file changed, 17 insertions(+), 4 deletions(-)

commit 1c7c3ac26207b10153bebd7ccf6411b97b1e7163
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 21 23:21:33 2017 +0200

    nimble/phy: Fix wfr time calculations
    
    Rewritten code works with new T_IFS control and fixes few issues:
    * delay of RX pipeline is included in calculation (time between access
      address in the air and EVENTS_ADDRESS)
    * delay of TX pipeline of preceding packet is also included
    * TX->RX transition should be adjusted by only 2 usecs for clock
      accuracy since jitter is intended for wake ups only
    * we do not need to adjust for jitter at all since this is covered by
      LL and included in wfr_time
    * strange workaround for LE Coded is not needed anymore since this is
      now covered by TX/RX pipelines delays which were missing pieces of
      the puzzle
    
    X-Original-Commit: c4bf3324d65e47aa5cd8510784c825344cdcafc9

 nimble/controller/include/controller/ble_phy.h |  2 +-
 nimble/controller/src/ble_ll_conn.c            |  2 +-
 nimble/controller/src/ble_ll_scan.c            |  2 +-
 nimble/drivers/native/src/ble_phy.c            |  2 +-
 nimble/drivers/nrf51/src/ble_phy.c             |  5 ++-
 nimble/drivers/nrf52/src/ble_phy.c             | 59 +++++++++++++-------------
 6 files changed, 36 insertions(+), 36 deletions(-)

commit cd97ab4c89a90db673c61c88990c31659760a567
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 21 17:45:29 2017 +0200

    nimble/phy: Implement software T_IFS control
    
    We use hw controlled T_IFS which does not work well on LE Coded PHY and
    we're way off required 150 usecs so it is not possible to have reliable
    connection with other devices (...or impossible to connect at all).
    
    To fix this we need to control T_IFS in sw which means we do not use
    DISABLED_TXEN and DISABLED_RXEN shorts and schedule TXEN and RXEN using
    TIMER0. The radio timings in nRF specification are either missing or
    inaccurate so they were measured instead for each PHY.
    
    With new implementation measured T_IFS on each PHY is 150 +/- 1 usec
    which is on par with TIMER0 resolution.
    
    X-Original-Commit: 700cb7d6c969e80e926a211e97811f25dd4da34a

 nimble/drivers/nrf52/src/ble_phy.c | 77 ++++++++++++++++++++++++++++++++++++--
 1 file changed, 73 insertions(+), 4 deletions(-)

commit f05e87bb0364cd165a5cc1e09b141a84fbd4e7c8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 22 19:00:50 2017 +0200

    nimble/phy: Enable fast radio ramp-up
    
    This will be needed for manual T_IFS control.
    
    ...and this may not work with hw T_IFS control even for 1M, but we'll
    fix this in subsequent patches so don't care now.
    
    X-Original-Commit: d344e36c2e53b3fc8a919340880ecf38c2b3a2d9

 nimble/drivers/nrf52/include/ble/xcvr.h |  7 ++++--
 nimble/drivers/nrf52/src/ble_phy.c      | 43 +++++++++++++++------------------
 2 files changed, 25 insertions(+), 25 deletions(-)

commit d359be94ef07ce16889fd8318033905b09091fd9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 17 21:11:00 2017 +0200

    nimble/host: Update with new Tinycrypt ECC API
    
    Unfortunatelly latest TinyCrypt changed API for ECC so SM crypto needs
    to be adjusted.
    
    X-Original-Commit: 7200999b5c74e9a1e234bde8c0c7c6c5cae4925c

 nimble/host/mesh/src/glue.c   |  2 +-
 nimble/host/src/ble_sm_alg.c  | 57 +++++++++++++++++++++++++------------------
 nimble/host/src/ble_sm_priv.h |  4 +--
 nimble/host/src/ble_sm_sc.c   | 34 +++++++++-----------------
 4 files changed, 47 insertions(+), 50 deletions(-)

commit e945bfc73c0a4b5441db8e4a0b876157d48a81ef
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Sep 27 09:31:53 2017 +0200

    nimble/controller: Remove misleading TODO
    
    This comment is no longer valid as with Extended Advertising all
    channels are used for advertising.
    
    X-Original-Commit: b92e1172f971a933b36e6c86689ba83a3d440fd8

 nimble/controller/src/ble_ll_adv.c | 1 -
 1 file changed, 1 deletion(-)

commit 1724135b910b9da76ddb3066f668d192a9b47e7e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Sep 25 00:25:27 2017 +0200

    nimble/ll: Drop packets with empty payload for LL Control PDU
    
    Only continuation/empty LL Data PDU can have empty payload.
    
    Reference: Core v5.0, Vol 6, Part B, section 2.4
    
    X-Original-Commit: dfa5d749cc1f9573e375589abbce00a906b8b8c1

 nimble/controller/src/ble_ll_conn.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 76bfb6ece2f6f3db8a999152d611709ae0422806
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Sep 24 23:30:44 2017 +0200

    nimble/ll: Enforce minimum payload length for coded phy
    
    Lower bound of connEffectiveMaxTxTime depends on current phy but it is
    always at least the time required to send 27 bytes of payload. This
    patch enforces this.
    
    Without this fix we were sending control packets with no payload after
    phy has changed from uncoded to coded which had really strange results.
    
    X-Original-Commit: 5344b77d4e5f3663c239d13b2f2d7a7f8ad80ad1

 nimble/controller/src/ble_ll.c | 18 +++++++++++++++---
 1 file changed, 15 insertions(+), 3 deletions(-)

commit f83cfe20247057717be87845202d7e7376f4c36f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Sep 24 23:23:33 2017 +0200

    nimble/ll: Fix setting default phy prefs
    
    With no preference from host, we should set 'all' instead of 'none' :)
    
    X-Original-Commit: 13e4d7e4089be90c5d9ebd841e7801968112f3ef

 nimble/controller/src/ble_ll_hci.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a0a4fa6d6217460dc1b3dd291d33c304e40d6e9a
Merge: d7308fbf a3a94a3f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 26 22:00:07 2017 +0200

    Merge pull request #572 from andrzej-kaczmarek/nimble-host-symbol-fix
    
    nimble/host: Add symbol for 'any' phy mask
    
    X-Original-Commit: 1bb6153698c9bd60b04e8627a6127c19f04f5fca

commit d7308fbfcb2464accef0b5ff98fe7808d6932644
Merge: 5a15974c f5534272
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Sep 26 21:58:48 2017 +0200

    Merge pull request #569 from andrzej-kaczmarek/nimble-phy-fix
    
    nimble/phy: Various fixes
    
    X-Original-Commit: c5a8a91549186ea0f12d75647371a3944301a29b

commit f5534272b8a832d24944dfa73da1eef4fe66aba7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 21 21:11:37 2017 +0200

    nimble/phy: Enable workaround for nRF52840 errata #164
    
    This adds workaround from "nRF52840 Engineering A Errata v1.2" for
    issue affecting radio sensitivity in BLE long range mode.
    
    X-Original-Commit: f8ec07cb9b51df97cb2b502768e30c2ccf8628f6

 nimble/drivers/nrf52/src/ble_phy.c | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit c0aa11f91094b0fdeed6edfbecb05275e2883966
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 21 21:44:12 2017 +0200

    nimble/phy: Remove unused code
    
    This code does not seem to do anything useful.
    
    X-Original-Commit: b9daffc2d277b32791c5af90510c1d9515e27c71

 nimble/drivers/nrf52/src/ble_phy.c | 10 +---------
 1 file changed, 1 insertion(+), 9 deletions(-)

commit a3a94a3ffc85219c7e2bdd5168b6d0d0cf64f08f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Sep 25 12:47:33 2017 +0200

    nimble/host: Add symbol for 'any' phy mask
    
    X-Original-Commit: adafefef38376f7aeea5ec2080d1162182bea760

 nimble/host/include/host/ble_gap.h | 1 +
 1 file changed, 1 insertion(+)

commit 5a15974c6df2d00403b2c76d7930d52f4a6be8f4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Sep 24 23:23:58 2017 +0200

    nimble/host: Fix invalid symbol name
    
    This can be considered API change but the symbol name is obviously
    invalid as it does not follow naming scheme so let's change it anyway.
    
    X-Original-Commit: ea901abcdf35a2ca433bf7624956b02b0839d730

 nimble/host/include/host/ble_gap.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5214fd372c4a30c800d01e25050ce9ae4aff8804
Merge: 02b43a9e 51440bb5
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Sep 22 11:11:46 2017 -0700

    Merge pull request #562 from ccollins476ad/bswap-errors
    
    Remove extraneous #include.
    
    X-Original-Commit: 450b9421d5cdc3c965c91a40c49816de66d45986

commit 02b43a9eb385019a042b303b64ba365966113831
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 20 11:11:00 2017 +0200

    mesh: set company id field in health status message
    
    X-Original-Commit: c72a57836bfe4b20c864854a1fb50002c902b33e

 nimble/host/mesh/src/health.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 810eb2e03a51b388b862d4cf376780f138f2b1ab
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Sep 20 11:07:13 2017 +0200

    mesh: set delayed timer for periodic publish before publishing
    
    Encrypting and sending a message takes a considerable amount of time
    which makes the publication period longer than expected.
    
    With this patch it is possible to pass MESH/SR/HM/CFS/BV-02-C test.
    
    X-Original-Commit: bd394afb2112eb32b3e436bbc9e25cedcfd3649a

 nimble/host/mesh/src/access.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 2e170243336b6055147f4abfab3f1d5513af4c5a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 19 17:11:02 2017 +0200

    mesh: add more debug logs in network layer
    
    X-Original-Commit: c0a7b44c15f8b15e9d64846650c93464ac5649c9

 nimble/host/mesh/src/net.c | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

commit 73d1586b668805b838a115a83aecd2a8d7b059e1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 19 16:52:40 2017 +0200

    mesh: fix setting message fields in health model
    
    X-Original-Commit: 3189cf10c69731243cf52983503ccbf5180a5461

 nimble/host/mesh/src/health.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 1fdd3dfdc84b26880e3d4ed048ecba3f1b5744fa
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 19 16:52:07 2017 +0200

    mesh: add missing delayed work argument
    
    X-Original-Commit: 4b970bdbd6b9699d741b108f6510f34cb3d1d588

 nimble/host/mesh/src/access.c | 1 +
 1 file changed, 1 insertion(+)

commit 1d8f51a7fc74129ced32651c7deed90062321f24
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 19 16:46:43 2017 +0200

    mesh: fix toggling debug logs per layer
    
    X-Original-Commit: 50ebf6f0abff80776f8c570719161954a58bca0a

 nimble/host/mesh/include/mesh/glue.h | 7 +++++--
 nimble/host/mesh/src/access.c        | 1 +
 nimble/host/mesh/src/adv.c           | 2 ++
 nimble/host/mesh/src/beacon.c        | 1 +
 nimble/host/mesh/src/cfg.c           | 1 +
 nimble/host/mesh/src/crypto.c        | 1 +
 nimble/host/mesh/src/health.c        | 2 +-
 nimble/host/mesh/src/mesh.c          | 2 +-
 nimble/host/mesh/src/net.c           | 3 ++-
 nimble/host/mesh/src/transport.c     | 1 +
 10 files changed, 16 insertions(+), 5 deletions(-)

commit 4ff2f27a28f939e7199e708ad49c20b5da732f86
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Sep 18 16:18:13 2017 +0200

    mesh: fix typo in setting friend config
    
    X-Original-Commit: c4cc98e757fe7b78c3079f7e0a9866335dfd52a5

 nimble/host/mesh/src/cfg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5deed11c3f0f49301a6739b904a8df6940287c09
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 15 10:59:34 2017 +0200

    mesh: add extended debug flag for printing adv packets
    
    X-Original-Commit: 7d48a04ee7ed68aa42c472ce1f9b96c0105c9879

 nimble/host/mesh/include/mesh/mesh.h | 7 +++++++
 nimble/host/mesh/src/adv.c           | 4 ++++
 2 files changed, 11 insertions(+)

commit 01fc29635a86efb2e6943bd8fa0fb4753a7634a1
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 14 16:20:59 2017 +0200

    mesh: add log message when dropping packet because unprovisioned
    
    X-Original-Commit: 6ae7b5309d89ad54e78a194d58be213cdbad8bcd

 nimble/host/mesh/src/net.c | 1 +
 1 file changed, 1 insertion(+)

commit 9bae4edc18ab608b5006136dbfde1d1c978c5710
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 14 16:20:31 2017 +0200

    mesh: check destination address on receive
    
    X-Original-Commit: 59ab73a8598b975212d602ce931743783634c20b

 nimble/host/mesh/src/mesh_priv.h |  1 +
 nimble/host/mesh/src/net.c       | 10 ++++++++++
 2 files changed, 11 insertions(+)

commit d2961344031db28f45b2f41336a5708853916cf2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 14 13:40:08 2017 +0200

    mesh: fix initialize message queue
    
    X-Original-Commit: fe385ad7ead993d28d14eebca9a9da8f2125531b

 nimble/host/mesh/src/net.c | 1 +
 1 file changed, 1 insertion(+)

commit d8a8d09201bb113da6d316361515f0dae7cb8a1b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 14 13:39:41 2017 +0200

    mesh: fix handling group send with local interface enabled
    
    Previously, if address was all-nodes (checked in
    bt_mesh_fixed_group_match), then it was sent only to the local
    interface, but should also be broadcast.
    
    X-Original-Commit: 32df45dff30b7cae70103ffbb0eeae0810493409

 nimble/host/mesh/src/net.c | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit 0e5c63f066041f504cd9be5af4fd49b76f68b26d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 14 13:38:16 2017 +0200

    mesh: return buffer even when no usrhdr
    
    X-Original-Commit: e1f1fe457572df41231ac27197e4513f1a126e98

 nimble/host/mesh/src/glue.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3e5c676e11a69b6c47cfb1ee764495b504689611
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Sep 14 13:37:55 2017 +0200

    mesh: fix null ptr access
    
    X-Original-Commit: 88023f0413ef535a0e0326410a5309ecec9720d7

 nimble/host/mesh/src/glue.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 1b1443c3954926fa52056ec30ee96fa3779602d6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 12 11:14:49 2017 +0200

    mesh: add missing argument to delayed work in configuration
    
    X-Original-Commit: e9c87497f638b96f3da30184cdadc192576ad546

 nimble/host/mesh/src/cfg.c | 1 +
 1 file changed, 1 insertion(+)

commit 275f2a49aaa6c6f9bd1bfd3085779fdbc63ca7bc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Sep 12 10:17:12 2017 +0200

    mesh: send ack for every message with matching FSC
    
    Mesh Profile Specification v1.0, 5.3.3:
    
    "On the PB-ADV bearer, when the receiver has received all segments of
    a transaction, the receiver shall calculate the FCS for the received
    Provisioning PDU, and if it matches the FCS field in the Transaction
    Start PDU, it shall send a Transaction Acknowledgment PDU after
    a random delay between 20 and 50 milliseconds."
    
    X-Original-Commit: 1eacb58ad46bcef4a6cc723dbffa079ba01d1e9a

 nimble/host/mesh/src/prov.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 51440bb5fddaee916c611114f4ff3cb6943f38de
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Sep 19 18:35:30 2017 -0700

    Remove extraneous #include.
    
    This include was causing build errors on a Linux system with the
    following identity:
    
        Linux bleh 4.4.0-93-generic #116-Ubuntu SMP Fri Aug 11 21:17:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
    
    The build errors were:
    
        In file included from repos/apache-mynewt-core/kernel/os/include/os/os.h:77:0,
                         from repos/apache-mynewt-core/net/nimble/transport/socket/src/ble_hci_socket.c:46:
        repos/apache-mynewt-core/kernel/os/include/os/endian.h:43:40: error: expected declaration specifiers or ‘...’ before ‘(’ token
         #define os_bswap_32(x)    ((uint32_t) ((((x) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >>  8) | (((x) & 0x0000ff00) <<  8) | (((x) & 0x000000ff) << 24)))
                                                ^
        In file included from repos/apache-mynewt-core/kernel/os/include/os/os.h:77:0,
                         from repos/apache-mynewt-core/net/nimble/transport/socket/src/ble_hci_socket.c:46:
        repos/apache-mynewt-core/kernel/os/include/os/endian.h:48:6: error: expected declaration specifiers or ‘...’ before ‘(’ token
             ((((x) & 0xff00) >> 8) |                        \
              ^
        In file included from repos/apache-mynewt-core/kernel/os/include/os/os.h:77:0,
                         from repos/apache-mynewt-core/net/nimble/transport/socket/src/ble_hci_socket.c:46:
        repos/apache-mynewt-core/kernel/os/include/os/endian.h:43:40: error: expected declaration specifiers or ‘...’ before ‘(’ token
         #define os_bswap_32(x)    ((uint32_t) ((((x) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >>  8) | (((x) & 0x0000ff00) <<  8) | (((x) & 0x000000ff) << 24)))
                                                ^
        In file included from repos/apache-mynewt-core/kernel/os/include/os/os.h:77:0,
                         from repos/apache-mynewt-core/net/nimble/transport/socket/src/ble_hci_socket.c:46:
        repos/apache-mynewt-core/kernel/os/include/os/endian.h:48:6: error: expected declaration specifiers or ‘...’ before ‘(’ token
             ((((x) & 0xff00) >> 8) |                        \
    
    The problem was caused by Mynewt's hton/ntoh macros interfering with the
    system's functions with the same name declared in `netinet/in.h`.
    
    `os.h` gets included later in this file anyway (after the inclusion of
    `netinet/in.h`), so removing this include does not cause any problems.
    
    X-Original-Commit: e47ad6536bc7f72b00359f196f82c6927ea62bcc

 nimble/transport/socket/src/ble_hci_socket.c | 1 -
 1 file changed, 1 deletion(-)

commit ae9a7a80421d213df4fa56e97f00f136d086f2d4
Merge: 9af4f745 25f35afa
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 8 10:18:55 2017 +0200

    Merge pull request #538 from andrzej-kaczmarek/nimble-ll-stack-fix
    
    nimble/ll: Increase stack for ble_ll_task
    
    X-Original-Commit: 7eb740f4ed630a21f3121b45bbcce5895b7622ee

commit 9af4f7451c4a96df0e96876e1556b83195451efa
Merge: 490ed014 aecb3961
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 8 07:23:31 2017 +0200

    Merge pull request #539 from rymanluk/scan_fix
    
    nimble/controller: Drop adv event if it is too big
    
    X-Original-Commit: 2b3e30aa491a39cb597ca364e8c3f2ef9f7f9b56

commit 25f35afaaaf6aa145a6038c885dcbfcbfa0388e3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Sep 7 14:55:31 2017 +0200

    nimble/ll: Increase stack for ble_ll_task
    
    Default stack size for ble_ll_task is too low.
    
    Failing scenario can be reproduced using optimized bleprph build for
    nRF51 (M0). We have following call stack:
    
    os_eventq_put() at os_eventq.c:99 0x8d7e
    ble_hs_enqueue_hci_event() at ble_hs.c:431 0x14204
    ble_hs_hci_rx_evt() at ble_hs_hci.c:357 0x14d4a
    ble_hci_trans_ll_evt_tx() at ble_hci_ram.c:95 0x1b860
    ble_ll_hci_event_send() at ble_ll_hci.c:79 0xec90
    ble_ll_conn_comp_event_send() at ble_ll_conn_hci.c:250 0xd6a2
    ble_ll_adv_send_conn_comp_ev() at ble_ll_adv.c:2,849 0xb490
    ble_ll_conn_created() at ble_ll_conn.c:2,511 0xc0e4
    ble_ll_conn_slave_start() at ble_ll_conn.c:4,076 0xd2e6
    ble_ll_adv_conn_req_rxd() at ble_ll_adv.c:2,341 0xb3f0
    ble_ll_adv_rx_pkt_in() at ble_ll_adv.c:2,456 0xb3f0
    ble_ll_rx_pkt_in() at ble_ll.c:720 0xa43a
    ble_ll_event_rx_pkt() at ble_ll.c:982 0xa43a
    os_eventq_run() at os_eventq.c:178 0x8e38
    ble_ll_task() at ble_ll.c:1,025 0xa2ae
    0x0
    
    The os_eventq_put() causes a context switch (interrupt) and registers
    put on stack overwrite memory outside stack - we're 4 bytes (a single
    register) off here. The overwritten memory is a g_dev_addr so our
    address changes unexpectedly after successful connection.
    
    This works fine on debug build and on nRF52 due to differents stack
    usage. For example, on optimized build for M0, gcc aligns uint8_t on
    stack for faster access thus increases its usage if there are local
    uint8_t variables in function (like in ble_ll_conn_comp_event_send).
    
    This patch increases stack size by 10 elements (40 bytes) to have some
    free space left in case something extra pops up.
    
    X-Original-Commit: bce78ce39bcc18af23d356fbff185e7a989d62f9

 nimble/controller/src/ble_ll.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 490ed0143f5e954365c61afdf22d156f1dfa735c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 7 19:15:16 2017 +0200

    nimble/mesh: Return once app-key is found and handled
    
    X-Original-Commit: ee7e2769f553aeb8c33f468cc343ae26a8f39092

 nimble/host/mesh/src/transport.c | 1 +
 1 file changed, 1 insertion(+)

commit aecb3961be441cfa820c451786cdc186a1901608
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 7 18:59:52 2017 +0200

    nimble/controller: Drop adv event if it is too big
    
    If the BLE_HCI_EVT_BUF_SIZE is too small for advertising events,
    then adv will be dropped. There is also stats adv_evt_dropped added
    for debuging purposes
    
    X-Original-Commit: 439b63713614bba43a8080c7fe857379e3ae2613

 nimble/controller/include/controller/ble_ll.h |  1 +
 nimble/controller/src/ble_ll.c                |  1 +
 nimble/controller/src/ble_ll_scan.c           | 20 ++++++++++++++++++++
 3 files changed, 22 insertions(+)

commit 0d3bbd17ebae3ddfd732ef6178872b24db5da817
Merge: 3107fa6a 4e58b272
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 7 14:33:00 2017 +0200

    Merge pull request #537 from rymanluk/scan_fix
    
    nimble/controller: Fix scan long advertising packets
    
    X-Original-Commit: fdab78d558b3364bf4b9792482f417a0ab5121a4

commit 3107fa6a7b7008677c4f23912eb1e62a4f5da181
Merge: 122af7a9 181c4779
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 7 14:31:59 2017 +0200

    Merge pull request #534 from rymanluk/priv_fix
    
    nimble/sm: Use privacy device mode as default
    
    X-Original-Commit: c9a36fa1c7bcda548d0ee5ebddaba42ebd385ce9

commit 122af7a98e4fb68249514d2c27b44cd231541a02
Merge: 825d0ed5 9c8eb7c3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Sep 7 12:27:43 2017 +0200

    Merge pull request #533 from andrzej-kaczmarek/nimble-ll-dup-fix
    
    nimble/ll: Fix duplicates filtering in scanner
    
    X-Original-Commit: 5a8d998f65d02c5b19ca4cb37a776f168f804516

commit 4e58b272425a7754ccd7cbba1a5bf81432bb76fa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 7 10:44:29 2017 +0200

    nimble/controller: Decrease size of struct ble_mbuf_hdr
    
    X-Original-Commit: 8fb67e3889a6a06066a3624db3bbcc9bb8990c35

 nimble/controller/src/ble_ll_adv.c  |  6 +++---
 nimble/controller/src/ble_ll_scan.c | 12 ++++++------
 nimble/drivers/nrf51/src/ble_phy.c  |  2 +-
 nimble/drivers/nrf52/src/ble_phy.c  |  2 +-
 nimble/include/nimble/ble.h         |  4 +---
 5 files changed, 12 insertions(+), 14 deletions(-)

commit e9f824cfdb47686054ed40ca0556bae3d832861e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Sep 7 10:15:05 2017 +0200

    nimble/controller: Fix scan long advertising packets
    
    This patch fixes corrupted long advertising data when BLE_EXT_ADV is
    used. It is allowed now that advertising data are in the chain of
    os_mbufs.
    
    X-Original-Commit: d18c3bbab23a57b29cce16e57b6262533f9e5bc8

 nimble/controller/include/controller/ble_ll_scan.h |  4 +--
 nimble/controller/src/ble_ll.c                     |  2 +-
 nimble/controller/src/ble_ll_scan.c                | 41 +++++++++++++---------
 3 files changed, 27 insertions(+), 20 deletions(-)

commit 181c477958c97cd714a631d9634d29b092963716
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Sep 6 11:11:46 2017 +0200

    nimble/sm: Use privacy device mode as default
    
    In order to not brake existing applications lets use privacy
    device mode instead of network mode which is default in the
    Controller accorting to BT 5 specification.
    
    X-Original-Commit: d31e05251097426373fac3df3a892122db022866

 nimble/host/src/ble_store.c             | 11 +++++++++++
 nimble/host/test/src/ble_hs_test_util.c | 10 +---------
 nimble/host/test/src/ble_hs_test_util.h |  9 +++++++++
 nimble/host/test/src/ble_sm_test_util.c | 16 +++++++++++++---
 4 files changed, 34 insertions(+), 12 deletions(-)

commit 9c8eb7c31e0b99708149168764aba55ccd42c36b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Sep 6 10:55:47 2017 +0200

    nimble/ll: Fix duplicates filtering in scanner
    
    With duplicates filtering enabled, we will filter out scan response
    from advertiser if we already sent advertising report for the same
    device. However, Core specification (Vol 6, Part B, section 4.4.3.5)
    states:
    
    "For each non-duplicate advertising or scan response PDU from an
    advertiser, the Link Layer shall send an advertising report to the
    Host."
    
    This patch fixes this by tracking advertising reports and scan
    responses separately for duplicates filtering.
    
    X-Original-Commit: 7ea097f3e1944c51e17a9d2a9f89b4c845652711

 nimble/controller/src/ble_ll_scan.c | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)

commit 825d0ed5d4c99fc927f1a97f77da9ac9d85c632c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 5 19:40:52 2017 +0200

    nimble/controller: Fix disconnection event status
    
    If connection is disconnected because it has not been established,
    error code 0x3e should be used.
    
    X-Original-Commit: 72a3b9f034ac756d4688327b0a20e5c38b0105d8

 nimble/controller/src/ble_ll_conn.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 63aef01e6b9f97e619813abd86392efcebc5e96e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Sep 5 11:37:03 2017 +0200

    nimble/mesh: Clear link TX when ACK arrived on it
    
    Without this fix there is an issue when doing PB-ADV provisioning with PTS.
    We keep retransmitting Public Key which is ACKed by PTS and this leads
    to transaction timeout as PTS does not send confirm probably because it
    keep receiving PK from us.
    
    This patch also makes sure that transaction id is between 0x80 - 0xFF
    
    X-Original-Commit: d957d9a96003fdf40850bcf18ab598d0b682c076

 nimble/host/mesh/src/prov.c | 30 +++++++++++++++++++++++++-----
 1 file changed, 25 insertions(+), 5 deletions(-)

commit 0a418b4bcba2787d92ff0221f5a31b1ecb0721ea
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Sep 5 10:48:44 2017 +0200

    nimble/gap: Fix pointer to local outside of scope
    
    X-Original-Commit: 93b924b9b1badaae9a41f3a9da82210251203c97

 nimble/host/src/ble_gap.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 784b3b01f8da62218614e531783944631d00ba6d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Sep 5 09:06:07 2017 +0200

    nimble/l2cap: Fix use on uninitialized value
    
    X-Original-Commit: 60cf149ff041ffced8b0729928fa17149b2a72a8

 nimble/host/src/ble_l2cap_coc.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 97c760888270c1254915b81917f4a8bef1e0c719
Merge: 0c56f9cf 0fff4461
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Sep 4 11:05:59 2017 +0200

    Merge pull request #519 from andrzej-kaczmarek/monitor-dev
    
    nimble/monitor: Various improvements
    
    X-Original-Commit: c02b2f248dea963d21a13b342975c5b886a4dbad

commit 0fff4461215c29dd8c4e17d8640e187e9c308185
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 30 11:30:44 2017 +0200

    nimble/monitor: Add reporting of dropped packets
    
    When using RTT in buffered mode it's possible that we drop some packets
    due to not enough space in RTT buffer. In this case btsnoop format has
    headers to include this information so it can be decoded by btmon.
    
    X-Original-Commit: 22e68eb67da87cb9b807e8d99dfdd6d6835b5721

 nimble/host/src/ble_monitor.c      | 156 ++++++++++++++++++++++++++++++-------
 nimble/host/src/ble_monitor_priv.h |  17 +++-
 2 files changed, 144 insertions(+), 29 deletions(-)

commit 0c56f9cffca7d27422a95112637b23e4f18e4e57
Merge: 01d3514b e37134cc
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Sep 1 15:24:32 2017 +0200

    Merge pull request #520 from sjanc/static_check
    
    nimble/test: Assert os_mbuf operations in GATT tests
    
    X-Original-Commit: 489c73d835b7580841bd2c420df65d29a769073f

commit 01d3514bdfbcfb56a72e457e89e686e75ffb5bea
Merge: ea1af250 818c02ef
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 1 15:23:54 2017 +0200

    Merge pull request #521 from michal-narajowski/mesh-porting-fixes
    
    Mesh fixes after PTS testing
    
    X-Original-Commit: 42e65ef90fa8a65639f1a316460d95f2121cb771

commit 818c02ef1468d676a6530dcdb40a17ed7cb70027
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 1 15:15:26 2017 +0200

    nimble/mesh: Fix failed provisioning response
    
    Found during PTS testing. With this patch following test cases pass:
    
    MESH/NODE/PROV/UPD/BV-10-C
    MESH/NODE/PROV/BI-02-C
    
    X-Original-Commit: e992ec3b022c4e9ad95e13be6e0ab80b3a623e9d

 nimble/host/mesh/src/prov.c | 31 +++++++++++++++++++++++--------
 1 file changed, 23 insertions(+), 8 deletions(-)

commit e37134cc1cada14310bb34b7298f8ea4247fdad3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Sep 1 11:48:37 2017 +0200

    nimble/test: Assert os_mbuf operations in GATT tests
    
    X-Original-Commit: 3a15a23c8801acd06a6516c0bc8608d20f8efb38

 nimble/host/test/src/ble_att_svr_test.c | 4 ++++
 1 file changed, 4 insertions(+)

commit ea1af2500c4d82a4740ae3e769539c960610b1eb
Merge: 7bcddcf2 23827a8d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 1 15:10:20 2017 +0200

    Merge pull request #511 from rymanluk/porting
    
    nimble: Port Bluetooth Mesh from Zephyr to Mynewt
    
    X-Original-Commit: afe2a6a94aa65323684a54f1eff85ee63d8ddde3

commit 3bdb93c678deb7d710cc27d4882fe576f9fd564c
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Sep 1 11:55:44 2017 +0200

    nimble/mesh: assert on out of prov buffers
    
    X-Original-Commit: 119fba4bf88219272fbef15a5555437ed29ccdf4

 nimble/host/mesh/src/prov.c | 1 +
 1 file changed, 1 insertion(+)

commit 23827a8daa2b6af691339d67c022e8c037a6a488
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Sep 1 13:35:36 2017 +0200

    mesh: Fix setting the right value for Static OOB type
    
    According to Mesh Profile spec 1.0, chapter 5.4.1.1 table 5.20 Bit 0
    shall be set when static OOB is available
    
    X-Original-Commit: aed386724116c187564fd8b9ddb4cfaf2264000d

 nimble/host/mesh/src/prov.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ba6b17748ecd83fa4c6a797872a820642aebd856
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 30 16:06:22 2017 +0200

    nimble/monitor: Fix ble_monitor_out
    
    It skipped character when breaking line on full buffer.
    
    X-Original-Commit: 5f5f286b4881abb142c9256be122cbe5d3fc7459

 nimble/host/src/ble_monitor.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit bc988624b305a0608f071f49bd202c23ca895fa9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 30 10:43:26 2017 +0200

    nimble/monitor: Always use uptime for timestamp
    
    The timestamp code was there "for historical reasons" and is not used
    anymore.
    
    X-Original-Commit: 2e88c5ee5ece454725e065134eba3cf7f53b3896

 nimble/host/src/ble_monitor.c | 26 +++++++-------------------
 1 file changed, 7 insertions(+), 19 deletions(-)

commit ec11d6873be23b6aed00641f34cee5c7c2b640a1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 1 10:56:34 2017 +0200

    nimble/monitor: Make console out buffer size configurable
    
    X-Original-Commit: a2b060c0cd83c7267eea89c95b0b0e770966c1d4

 nimble/host/src/ble_monitor.c | 2 +-
 nimble/host/syscfg.yml        | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 16ce31f32379e1ffa38a8231d9f544626633bf77
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 30 11:32:00 2017 +0200

    nimble/monitor: Make UART ring buffer size configurable
    
    X-Original-Commit: 8c7328b27eb75305e469226e707fd1062308d566

 nimble/host/src/ble_monitor.c | 2 +-
 nimble/host/syscfg.yml        | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 30fcf7fe5f5220d4da9097fb792217c544c9b351
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Aug 30 10:30:42 2017 +0200

    nimble/monitor: Make RTT buffer size configurable
    
    X-Original-Commit: ffea98197595438460e15d855a721a5bed0d1029

 nimble/host/src/ble_monitor.c | 4 ++--
 nimble/host/syscfg.yml        | 3 +++
 2 files changed, 5 insertions(+), 2 deletions(-)

commit f361dd563a5d58fa3f91718129d170ae3db21da5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Sep 1 10:28:04 2017 +0200

    nimble/hs: Make ble_hs_evq_get() private API
    
    References in ble_hs.c are replaced by direct access to ble_hs_evq so
    there is no function call penalty.
    
    X-Original-Commit: 410366c9306100700339ca66c22529693d4439a1

 nimble/host/src/ble_hs.c      | 14 +++++++-------
 nimble/host/src/ble_hs_priv.h |  1 +
 2 files changed, 8 insertions(+), 7 deletions(-)

commit b871a00a0f684bb20b35a0ceb93c7782152ac35b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 11 16:39:03 2017 +0200

    nimble/mesh: Porting Mesh to Mynewt
    
    This patch adds glue layer for mesh together with blemesh sample
    application.
    
    X-Original-Commit: 1a6239b0b98a000da62357fe4d62726c7ccec19c

 nimble/host/include/host/ble_gap.h           |   7 +
 nimble/host/include/host/ble_hs_adv.h        |   3 +
 nimble/host/mesh/include/mesh/atomic.h       | 386 ++++++++++++++++
 nimble/host/mesh/include/mesh/glue.h         | 318 ++++++++++++++
 nimble/host/mesh/include/mesh/mesh.h         | 617 ++++++++++++++++++++++++++
 nimble/host/mesh/pkg.yml                     |  38 ++
 nimble/host/mesh/src/Kconfig                 | 377 ----------------
 nimble/host/mesh/src/Makefile                |  21 -
 nimble/host/mesh/src/TODO                    |  15 -
 nimble/host/mesh/src/access.c                |  46 +-
 nimble/host/mesh/src/access.h                |  61 ++-
 nimble/host/mesh/src/adv.c                   | 355 +++++++++------
 nimble/host/mesh/src/adv.h                   |  73 +--
 nimble/host/mesh/src/beacon.c                |  64 ++-
 nimble/host/mesh/src/beacon.h                |  26 +-
 nimble/host/mesh/src/cfg.c                   | 557 ++++++++++++-----------
 nimble/host/mesh/src/crypto.c                |  90 ++--
 nimble/host/mesh/src/crypto.h                |  28 +-
 nimble/host/mesh/src/foundation.h            |  41 +-
 nimble/host/mesh/src/friend.c                |  43 +-
 nimble/host/mesh/src/friend.h                |  28 +-
 nimble/host/mesh/src/glue.c                  | 486 ++++++++++++++++++++
 nimble/host/mesh/src/health.c                |  70 +--
 nimble/host/mesh/src/lpn.c                   |  71 +--
 nimble/host/mesh/src/lpn.h                   |  62 ++-
 nimble/host/mesh/src/main.c                  | 185 --------
 nimble/host/mesh/src/mesh.c                  | 202 +++++++++
 nimble/host/mesh/src/{mesh.h => mesh_priv.h} |   7 +-
 nimble/host/mesh/src/net.c                   | 205 +++++----
 nimble/host/mesh/src/net.h                   | 430 +++++++++---------
 nimble/host/mesh/src/prov.c                  | 394 +++++++++--------
 nimble/host/mesh/src/prov.h                  |  33 +-
 nimble/host/mesh/src/proxy.c                 | 633 +++++++++++++++++----------
 nimble/host/mesh/src/proxy.h                 |  18 +-
 nimble/host/mesh/src/test.c                  |  22 -
 nimble/host/mesh/src/test.h                  |  16 -
 nimble/host/mesh/src/transport.c             | 188 ++++----
 nimble/host/mesh/src/transport.h             | 142 +++---
 nimble/host/mesh/syscfg.yml                  | 322 ++++++++++++++
 nimble/host/pkg.yml                          |   3 +
 nimble/host/src/ble_gap.c                    |  97 +++-
 nimble/host/syscfg.yml                       |   8 +
 42 files changed, 4533 insertions(+), 2255 deletions(-)

commit 7bcddcf2c7acac4069b9c781d138ecbab5126428
Merge: c4fb11c1 566ddaca
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Sep 1 09:38:50 2017 +0200

    Merge pull request #483 from ccollins476ad/ble-auto-addr
    
    BLE Host - Automatic own-addr-type resolution
    
    X-Original-Commit: 4ab14f93e7a057d1a66a6dea72a036dd67211415

commit c4fb11c15c3a5be1d8921c2470f5b15b5f7d0638
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 31 15:42:22 2017 +0200

     Remove some dead code from native controller FIXXXX
    
    X-Original-Commit: e72951d0fccd22bbd700ec7e825b7fcb295fed1b

 nimble/drivers/native/src/ble_phy.c | 24 ++++++------------------
 1 file changed, 6 insertions(+), 18 deletions(-)

commit 5516512bd7e6d9c615110dd643e81f2350ff9d5e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 31 15:37:15 2017 +0200

    Remove some dead code from native controller
    
    X-Original-Commit: 44326d3ae2ad38a3e065eb69d796a8e213cb9658

 nimble/drivers/native/src/ble_phy.c | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit 24c39e216240b0df894956993a742b98535d05db
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 31 13:26:46 2017 +0200

    nimble/test: Limit max characteristics when validating handling FIX
    
    X-Original-Commit: aeee05761453b36f81426ce95de1e4c6ce70697d

 nimble/host/test/src/ble_gatt_disc_d_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ea1c51a57d23fc9ef4921942edecbce154a00638
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 31 13:25:25 2017 +0200

    nimble/test: Fix max intervals in L2CAP tests
    
    X-Original-Commit: 9052bf21754420dffc97e0ae04332dff761f1ed9

 nimble/host/test/src/ble_l2cap_test.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 56e470ed3d9633a59f3cd1f492fb363ad3bc42ce
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 31 12:31:06 2017 +0200

    nimble/test: Limit max characteristics when validating handling
    
    This isn't a real bug as chars passed to
    ble_gatt_disc_c_test_misc_verify_chars() are always smaller than
    ble_gatt_disc_c_test_chars but it was configusing static checkers.
    
    X-Original-Commit: 7fbad114ee1a76234253457b6fef338b6751303f

 nimble/host/test/src/ble_gatt_disc_c_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d65d2d8969acc2ba1f952065cc71685f96c48da0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 31 11:42:37 2017 +0200

    nimble/test: Fix setting channel map for CSA2
    
    X-Original-Commit: 54a29bc0f8ed14981f2f36c6b3c3876955c2a245

 nimble/controller/test/src/ble_ll_csa2_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4dad6ae62f98ff622d25ab1e01bce057bcffbff9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 30 16:28:35 2017 +0200

    nimble/tests: Fix possible NULL pointer dereference
    
    X-Original-Commit: 79b6aa7b60d8e598e19ad8332aeaa4da58ddee2b

 nimble/host/test/src/ble_hs_test_util.c | 2 ++
 1 file changed, 2 insertions(+)

commit f38900bcade6b89aac6e9bbc0dd233a5051318fa
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 30 16:24:14 2017 +0200

    nimble/test: Assert all os_mbuf operations
    
    This makes sure tests don't use invalid memory in case of os_mbuf bug.
    
    X-Original-Commit: 1a43ed04274fb24c1c7588b62925a23b229ebc08

 nimble/host/test/src/ble_att_svr_test.c     | 59 ++++++++++++++++++++---------
 nimble/host/test/src/ble_gatt_disc_c_test.c | 14 +++++--
 nimble/host/test/src/ble_gatt_disc_d_test.c |  6 ++-
 nimble/host/test/src/ble_gatt_disc_s_test.c | 15 +++++---
 nimble/host/test/src/ble_gatt_find_s_test.c |  6 ++-
 nimble/host/test/src/ble_gatt_read_test.c   | 16 +++++---
 nimble/host/test/src/ble_gatt_write_test.c  | 12 ++++--
 nimble/host/test/src/ble_hs_test_util.c     | 13 +++++--
 nimble/host/test/src/ble_l2cap_test.c       | 13 +++++--
 9 files changed, 107 insertions(+), 47 deletions(-)

commit bfa341f17380fb72e62483a1d00339e29cca75a6
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Aug 29 16:25:41 2017 +0200

    nimble/test: Check for ble_gap_conn_find return value
    
    Make sure ble_gap_test_conn_desc is not left in invalid state if
    connection (on bug) wasn't found.
    
    X-Original-Commit: f307b7226d0003c7bf8c0811ff196df1ff463ade

 nimble/host/test/src/ble_gap_test.c | 20 +++++++++++++-------
 1 file changed, 13 insertions(+), 7 deletions(-)

commit dfca210761725515b99b169b8ce0956ee388e852
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Aug 29 16:16:53 2017 +0200

    nimble/test: Pass SM public key structure to ble_sm_dbg_set_sc_keys
    
    While this is the same pointer avoid confusion when pasing 32 bytes
    buffer (x) to function using 64 buyes (x and y).
    
    X-Original-Commit: c3eaaebdd640ebd48e25acfbc2f10836354b077b

 nimble/host/test/src/ble_sm_test_util.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 1b5691b07cbbaf746e49dca590b1d2bff89af1a6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Aug 11 16:37:59 2017 +0200

    mesh: One to one copy of Mesh from Zephyr
    
    X-Original-Commit: f3b2a1e1bb956068a7aa215a40247a3e30800c07

 nimble/host/mesh/src/Kconfig      |  377 +++++
 nimble/host/mesh/src/Makefile     |   21 +
 nimble/host/mesh/src/TODO         |   15 +
 nimble/host/mesh/src/access.c     |  539 +++++++
 nimble/host/mesh/src/access.h     |   42 +
 nimble/host/mesh/src/adv.c        |  279 ++++
 nimble/host/mesh/src/adv.h        |   54 +
 nimble/host/mesh/src/beacon.c     |  391 +++++
 nimble/host/mesh/src/beacon.h     |   19 +
 nimble/host/mesh/src/cfg.c        | 3092 +++++++++++++++++++++++++++++++++++++
 nimble/host/mesh/src/crypto.c     |  877 +++++++++++
 nimble/host/mesh/src/crypto.h     |  156 ++
 nimble/host/mesh/src/foundation.h |  135 ++
 nimble/host/mesh/src/friend.c     |  212 +++
 nimble/host/mesh/src/friend.h     |   23 +
 nimble/host/mesh/src/health.c     |  447 ++++++
 nimble/host/mesh/src/lpn.c        |  882 +++++++++++
 nimble/host/mesh/src/lpn.h        |   45 +
 nimble/host/mesh/src/main.c       |  185 +++
 nimble/host/mesh/src/mesh.h       |   18 +
 nimble/host/mesh/src/net.c        | 1207 +++++++++++++++
 nimble/host/mesh/src/net.h        |  278 ++++
 nimble/host/mesh/src/prov.c       | 1480 ++++++++++++++++++
 nimble/host/mesh/src/prov.h       |   19 +
 nimble/host/mesh/src/proxy.c      | 1072 +++++++++++++
 nimble/host/mesh/src/proxy.h      |   33 +
 nimble/host/mesh/src/test.c       |   22 +
 nimble/host/mesh/src/test.h       |   16 +
 nimble/host/mesh/src/transport.c  | 1133 ++++++++++++++
 nimble/host/mesh/src/transport.h  |   84 +
 30 files changed, 13153 insertions(+)

commit 7351399ca41627786bd012e0e20b96dc1bb8bfb0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 30 14:21:36 2017 +0200

    Revert "nimble/host: Fix build with new TinyCrypt"
    
    This reverts commit d5d0082168a02401c63b83eed65dac3a5e5348c0.
    
    X-Original-Commit: c173f788344f150e155750e98c67005099f08479

 nimble/host/src/ble_sm_alg.c  | 57 ++++++++++++++++++-------------------------
 nimble/host/src/ble_sm_priv.h |  4 +--
 nimble/host/src/ble_sm_sc.c   | 34 +++++++++++++++++---------
 3 files changed, 49 insertions(+), 46 deletions(-)

commit 725aa7def12b626743cdd2c92526a0f5a3204736
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Aug 29 12:05:13 2017 +0200

    nimble/host: fix event flag check
    
    Previous check resulted in assert in ble_gap_subscribe_event when
    prev_flags had BLE_GATTS_CLT_CFG_F_MODIFIED bit set
    
    X-Original-Commit: 8bade89cbc7c2d27563aa4d6879baa775295d68c

 nimble/host/src/ble_gatts.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c8e26ec6a334142a5a19d0bd230fc3e6dd00d051
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 17 21:11:00 2017 +0200

    nimble/host: Fix build with new TinyCrypt
    
    Unfortunatelly latest TinyCrypt changed API for ECC so SM crypto needs
    to be adjusted.
    
    X-Original-Commit: d5d0082168a02401c63b83eed65dac3a5e5348c0

 nimble/host/src/ble_sm_alg.c  | 57 +++++++++++++++++++++++++------------------
 nimble/host/src/ble_sm_priv.h |  4 +--
 nimble/host/src/ble_sm_sc.c   | 34 +++++++++-----------------
 3 files changed, 46 insertions(+), 49 deletions(-)

commit 7c4d17527ff3c74772db0483d5d3bc063ae945c2
Merge: 29e7f828 2b5468af
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Aug 28 16:25:41 2017 +0200

    Merge pull request #493 from sjanc/static_check
    
    Few more fixes for issues reported by static checker
    
    X-Original-Commit: 95a88dd106c62ba1a49b715258988578a53c0f86

commit 29e7f82859e1d691709d2670aab1f3449e67b87a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 23 16:06:15 2017 -0700

    BLE Host - Don't abort reset if HCI restart fails.
    
    While the host is resetting, it attempts to restart the HCI transport.
    This may involve some communication with hardware.  For example, when
    the UART transport resets, it closes, reopens, and reconfigures the
    UART.
    
    *** Old behavior:
    If the HCI transport fails to restart due to a hardware failure, the
    host aborts its reset.  As a consequence, stale connections remain open,
    and the reset callback does not get called.
    
    *** New behavior:
    The host restarts the HCI transport and assumes success.  If the
    transport failed to reset, the host will reset itself again when it
    fails to sync with the controller.
    
    X-Original-Commit: 11d1a9e5de17c792ce55402fbf19a4308825b015

 nimble/host/src/ble_hs.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 96d8275df5d91babd995ad91e0ac121aec6e5616
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Aug 21 18:53:46 2017 +0200

    nimble/host: Fix searching for descriptor in gatts
    
    We should stop looking for descriptors on first attribute *beyond*
    service handles range, not on the one that matches service end handle.
    
    X-Original-Commit: a6335e28b6517f015c3436374566e0dc19f81b4a

 nimble/host/src/ble_gatts.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 787769057b3a130eebd09fcc5715e213436081d3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Aug 18 15:11:12 2017 +0200

    nimble/host: Allow to hide GATT services from clients
    
    This patch introduces ble_gatts_svc_set_visibility() API to allow any
    service to be hidden (and then restored) from clients. From GATT pov,
    the service is still registered and has the same handle range assigned
    and it is ATT server which hides the attributes from the client.
    
    To achieve this, there is also new API in ATT server which allows to
    remove range of attributes from the server. These attributes are not
    removed entirely, but moved to separate list and can be restored later
    in unchanged state.
    
    Since it is perfectly fine to hide/restore service during an active
    connection, it is up to application to inform clients about the change.
    
    X-Original-Commit: 1eef055ced3159bd4d1b29f1bb7b7c7972563d7a

 nimble/host/include/host/ble_gatt.h |  1 +
 nimble/host/src/ble_att_priv.h      |  2 +
 nimble/host/src/ble_att_svr.c       | 81 +++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_gatts.c         | 21 ++++++++++
 4 files changed, 105 insertions(+)

commit 2b5468af441109bf0e4be42d7800213521dba208
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 18 14:12:36 2017 +0200

    nimble/ans: Fix out of bounds access
    
    cat_id is used as index to access ble_svc_ans_new_alert_cnt and
    ble_svc_ans_unr_alert_cnt and shall be validated before doing so.
    
    X-Original-Commit: 5d8dbaf5e22c9f6cbf2370a03410a0cef0fca83a

 nimble/host/services/ans/src/ble_svc_ans.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 947a8ab17de718cd580d385aa3d0601413d921fa
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 18 12:33:59 2017 +0200

    nimble/ans: Assert on invalid operation
    
    This could happend only on server bug so assert on invalid operation.
    
    X-Original-Commit: 3dc64116bbec9688ed128ece74da2adbefbffcea

 nimble/host/services/ans/src/ble_svc_ans.c | 2 ++
 1 file changed, 2 insertions(+)

commit 2e66dcd07f8289492d6004eed4921ba9f74a3384
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 18 12:29:07 2017 +0200

    nimble/controller: Fix validating extended advertising phy
    
    Primary PHY was validated instead of secondary PHY.
    
    X-Original-Commit: 523a6eb3f3600b740510083a0b7d4b8e0c84d58e

 nimble/controller/src/ble_ll_adv.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 969bd2601574c43101159a8c68e6ad43707cf7ad
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 18 11:48:56 2017 +0200

    nimble/l2cap: Remove redundant NULL check
    
    This poitner is already dereferences and cannot be NULL.
    
    X-Original-Commit: 3748db02dd24375b81c573a89d67d18a08292806

 nimble/host/src/ble_l2cap_coc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 72549d41ba7e17fafdcf9be8ef12ff42d27b6d03
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Aug 14 18:11:55 2017 +0200

    nimble/host: Refactor HCI commands sending functions
    
    This refactors the way HCI commands are constructed and pass to
    controller. Instead of embedding opcode and len in command parameters
    buffer just pass it along with it. This has few adventages:
     - opcode OCF/OGF are contructed once on build time
     - buffer is always pass along with len
     - code is less confusing for static analysis tools (0 len buffer is
       always pass as NULL so no dangling pointers)
     - it is easier to follow (and debug)
    
    Nice bonus is ROM size reduction of net_nimble_host.a (54304->53710).
    
    This is also first step to making use of packed structures for HCI
    command instead of builders functions. This should reduce code size
    even further.
    
    X-Original-Commit: e2b0668fe0eb322ae346b393134f369b2af39bc1

 nimble/host/src/ble_gap.c          | 157 ++++++++----
 nimble/host/src/ble_hs_hci.c       |  12 +-
 nimble/host/src/ble_hs_hci_cmd.c   | 510 ++++++-------------------------------
 nimble/host/src/ble_hs_hci_priv.h  |  19 +-
 nimble/host/src/ble_hs_hci_util.c  |  50 ++--
 nimble/host/src/ble_hs_pvcy.c      |  49 ++--
 nimble/host/src/ble_hs_startup.c   |  41 +--
 nimble/host/src/ble_sm.c           |  22 +-
 nimble/include/nimble/hci_common.h |   3 +
 9 files changed, 284 insertions(+), 579 deletions(-)

commit c52f0c50da50d9762d068c0c0d75f12f4fe14f5f
Merge: 5acfc479 4b7856de
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Aug 17 16:41:52 2017 +0200

    Merge pull request #489 from sjanc/static_check
    
    Random fixes for issues reported by static analysis
    
    X-Original-Commit: 5712cb6eb9e9665a32ec6aa44a7c5bc961ac58b2

commit 5acfc479c6a9428409836ba3b746e33c540c04dc
Merge: b86f28dd dd66006c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 16 11:22:50 2017 -0700

    This closes #480.
    
    Merge remote-tracking branch 'ccollins476ad/gatts-reset'
    
    * ccollins476ad/gatts-reset:
      BLE Host - GATT svr now Initializes ATT svr.
      BLE Host - Function to copy a UUID.
      BLE Host - Remove unnecessary const in chr def.
      BLE Host - Allow GATT svcs to be reg. after init.
    
    X-Original-Commit: 4416e33ca20bd8a34f640f5cf3dcbd727effaba1

commit 4b7856debdbfdd834a0acae14cbf1bde646a0151
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 16 18:28:47 2017 +0200

    nimble/controller: Fix checking for invalid PHY in aux ptr
    
    Use 0 instead of -1 for indicating no valid PHY were provided (valid
    PHYs are counted from 1). aux_ptr is uint8_t so checking for it being
    negative is invalid.
    
    X-Original-Commit: 935070e4059b053b04bce0e6b30f0c96af467cff

 nimble/controller/src/ble_ll_scan.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 68db52f250d62fd953a06a91c133723b1233697f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 16 18:19:41 2017 +0200

    nimble/controller: Remove redundant NULL checks
    
    scansm is always a valid pointer so there is no need for checking
    it against NULL.
    
    X-Original-Commit: 1c38896e27f6d6569c391fcfe6ba0257a2beab81

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 056f5498c8c1156f6f509fc2db5f8eb6cd747e7e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 16 18:03:31 2017 +0200

    nimble/controller: Fix out of bound access to g_ble_ll_adv_sm
    
    Instances are counted from 0 so last valid instance is
    BLE_LL_ADV_INSTANCES - 1.
    
    X-Original-Commit: 507e3d3f8f60dbd0245d0b408a9450a2f4479d46

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b6b97dc8b5d61e7eacc78cb0abfda05828929861
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Aug 16 16:55:18 2017 +0200

    nimble/host: Remove redundant check for unsigned value
    
    Unsigned value is always equal or larger than zero.
    
    X-Original-Commit: 6fa11acf9d602f8a9c485e91afd87d2a32511d6e

 nimble/host/src/ble_gattc.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit b86f28dd1fa4a5301374eee40088b354f420ba18
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 11 16:28:53 2017 -0700

    BLE Host - Change unit test to use dflt evq.
    
    Prior to this change, a BLE host unit test used a dedicated
    eventq.  Now the unit test uses the default eventq exclusively.
    
    Unlike applications, unit tests don't have a default task to process the
    default event queue.  Instead, the default event queue only gets
    processed if the test does it in one of its dedicated tasks.  The unit
    test wasn't processing the default event queue, causing the host to fail
    to start.
    
    Rather than add a second task to process the default event queue, the
    test now uses the default event queue exclusively.
    
    X-Original-Commit: 391051be8f439668e18f68ca66b4613d891c763f

 nimble/host/test/src/ble_hs_test_util.c | 5 -----
 nimble/host/test/src/ble_hs_test_util.h | 1 -
 nimble/host/test/src/ble_os_test.c      | 2 +-
 3 files changed, 1 insertion(+), 7 deletions(-)

commit ec5b610f57dc0f4999d01900f574e7775c5084c6
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 11 16:28:13 2017 -0700

    BLE Host - Remove start event.
    
    X-Original-Commit: 2134a64bd7ece9e40626bf7afdbb621fbd6288d0

 nimble/host/src/ble_hs.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 7fc9bcb2623db58909b961b090730dfe5b88e96f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 11 15:49:29 2017 +0200

    nimble/sm: Fix os_mbuf leaks on keys distribution
    
    X-Original-Commit: 15d2cf967027d033a2c71bd6323fa89e160f51ca

 nimble/host/src/ble_sm.c | 3 +++
 1 file changed, 3 insertions(+)

commit eb3468d03874a54739612a05823fcb1565197fe4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 11 15:37:05 2017 +0200

    nimble/sm: Fix NULL pointer dereference
    
    X-Original-Commit: f119d8915ab293cff9b4db8e903c02dae6c905b1

 nimble/host/src/ble_sm.c | 4 ++++
 1 file changed, 4 insertions(+)

commit ad615109ebc0f9c2ed16518562235b5360e01879
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 11 15:26:38 2017 +0200

    nimble/gap: Fix storing pointer for local outside of scope
    
    X-Original-Commit: c3730053ee28ad4df137090623279592716c88cb

 nimble/host/src/ble_gap.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 0b40a2307fb7f2a44969a3280a36e0cd4eb61a08
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 11 15:22:48 2017 +0200

    nimble/gap: Fix NULL pointer dereference
    
    X-Original-Commit: bf6cd291f8a135928dbd2f58cabe48c840db7a6b

 nimble/host/src/ble_gap.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit 67734bc8b444b39c66848d9494a8e6771cae65ef
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 11 15:16:35 2017 +0200

    nimble/sm: Fix buffer overflow when copying address
    
    Since there is type defined for Bluetooth address use it instead of
    passing type and value separately.
    
    X-Original-Commit: cb887ca6443e6c27ae2796b1fc77f9122d5760ae

 nimble/host/src/ble_sm.c | 13 ++++++-------
 1 file changed, 6 insertions(+), 7 deletions(-)

commit a0809fa3cd327fc03f104e0739c9d22d96be6f92
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Aug 11 11:01:05 2017 +0200

    nimble/sm: Fix passing uninitialized variable
    
    X-Original-Commit: 5efb3f49c5d69dca5679e4cbbe83b63f2cd96166

 nimble/host/src/ble_sm.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 566ddaca3acb525eaadc7fa7ccb86580dac2b070
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 9 17:29:01 2017 -0700

    Add function to load at least one BLE addr from hw
    
    This is just a helper function, so it is not going in the nimble stack
    itself.  Instead, I have created a supplementary package:
    net/nimble/host/util.
    
    X-Original-Commit: b185ac0bd90c1f3ad3bc481fe1c4ec63a7e8238c

 nimble/host/util/include/host/util/util.h |  33 +++++++++
 nimble/host/util/pkg.yml                  |  29 ++++++++
 nimble/host/util/src/addr.c               | 109 ++++++++++++++++++++++++++++++
 nimble/host/util/syscfg.yml               |  21 ++++++
 4 files changed, 192 insertions(+)

commit e5154f2c6477ddaeb7f8cf33186c21d8ba2a2183
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 9 17:28:34 2017 -0700

    BLE Host - Allow NULL output params in ID fns.
    
    X-Original-Commit: 27dc774b176b14b72e580050d98ba6b76da01337

 nimble/host/src/ble_hs_id.c | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

commit 43468525767bc0522260f283b9689ec1801338db
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 9 13:04:18 2017 -0700

    BLE Host - Automatic own-addr-type resolution
    
    This commit adds a new function to the NimBLE host API:
    
    /**
     * Determines the best address type to use for automatic address type
     * resolution.  Calculation of the best address type is done as follows:
     *
     * if privacy requested:
     *     if we have a random static address:
     *          --> RPA with static random ID
     *     else
     *          --> RPA with public ID
     *     end
     * else
     *     if we have a random static address:
     *          --> random static address
     *     else
     *          --> public address
     *     end
     * end
     *
     * @param privacy               (0/1) Whether to use a private address.
     * @param out_addr_type         On success, the "own addr type" code gets
     *                                  written here.
     *
     * @return                      0 if an address type was successfully inferred.
     *                              BLE_HS_ENOADDR if the device does not have a
     *                                  suitable address.
     *                              Other BLE host core code on error.
     */
    int
    ble_hs_id_infer_auto(int privacy, uint8_t *out_addr_type)
    
    The motivation for this change is to allow BLE packages to be more
    self-contained.  If a package doesn't care what type of address it uses,
    it can just use whatever is available.
    
    X-Original-Commit: f7d304af11c46976d62244bbaaa329853aed3daf

 nimble/host/include/host/ble_hs_test.h  |   3 +-
 nimble/host/src/ble_hs_id.c             | 102 ++++++++++++++++++++++++--
 nimble/host/src/ble_hs_id_priv.h        |   1 +
 nimble/host/test/src/ble_gap_test.c     |   2 +-
 nimble/host/test/src/ble_hs_id_test.c   | 126 ++++++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test.c      |   1 +
 nimble/host/test/src/ble_hs_test_util.c |   6 +-
 nimble/host/test/src/ble_hs_test_util.h |   2 +-
 8 files changed, 232 insertions(+), 11 deletions(-)

commit 9dfb1fe2be9670b66cb1e0ba57eb3af043121a18
Merge: a598de01 44eb4170
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Aug 9 11:42:17 2017 +0200

    Merge pull request #461 from rymanluk/bt5_scanner_improve
    
    nimble/controller: Improve extended scanner
    
    X-Original-Commit: 572f95c7d40ad723be78cbce3434ad67918a954f

commit a598de01a4d0bd331fd32b022713ffd531c7c206
Merge: 663ec2fc 06e748dd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Aug 8 11:48:49 2017 +0200

    Merge pull request #476 from rymanluk/bt5_privacy_mode_fix
    
    nimble/controller: Fix for privacy mode
    
    X-Original-Commit: 52e046e613a6800d9a8ed11db3bb528e62e3550f

commit dd66006c268c48f0f4de0b0610083faef3554263
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 26 18:15:49 2017 -0700

    BLE Host - GATT svr now Initializes ATT svr.
    
    This change simplifies the API for registering new services at runtime.
    
    X-Original-Commit: 23f5603a198567ff967b0473a601bfe31c5bec5f

 nimble/host/src/ble_gatts.c | 7 ++++++-
 nimble/host/src/ble_hs.c    | 5 -----
 2 files changed, 6 insertions(+), 6 deletions(-)

commit 594dc857216f65a1644a8faf21e2f4f65a37c27c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 26 18:15:32 2017 -0700

    BLE Host - Function to copy a UUID.
    
    X-Original-Commit: bb260eacce93508ad407ef3d5976289da1edc1ff

 nimble/host/include/host/ble_uuid.h |  1 +
 nimble/host/src/ble_uuid.c          | 19 +++++++++++++++++++
 2 files changed, 20 insertions(+)

commit 061848308d87e4c762dd118b3377dc3b57ea4441
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 26 18:14:40 2017 -0700

    BLE Host - Remove unnecessary const in chr def.
    
    This const is not necessary, as the containing type
    (`struct ble_gatt_svc_def`) must be declared as const anyway.
    
    This change is required to allow the set of supported GATT services to
    be changed after initialization.
    
    X-Original-Commit: a1e93efc36eb549a87cbd432df82ff784600458b

 nimble/host/include/host/ble_gatt.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ec377c122832dafa761878362ec57b23d81b3fa3
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 18 19:03:32 2017 -0700

    BLE Host - Allow GATT svcs to be reg. after init.
    
    Prior to this change, supported GATT services could only be registered
    once.  This change allows the set of supported servces to be replaced
    "on the fly".
    
    /**
     * Resets the GATT server to its initial state.  On success, this function
     * removes all supported services, characteristics, and descriptors.  This
     * function requires that:
     *     o No peers are connected, and
     *     o No GAP operations are active (advertise, discover, or connect).
     *
     * @return                      0 on success;
     *                              BLE_HS_EBUSY if the GATT server could not be
     *                                  reset due to existing connections or active
     *                                  GAP procedures.
     */
    int
    ble_gatts_reset(void)
    
    /**
     * Makes all registered services available to peers.  This function gets called
     * automatically by the NimBLE host on startup; manual calls are only necessary
     * for replacing the set of supported services with a new one.  This function
     * requires that:
     *     o No peers are connected, and
     *     o No GAP operations are active (advertise, discover, or connect).
     *
     * @return                      0 on success;
     *                              A BLE host core return code on unexpected
     *                                  error.
     */
    int
    ble_gatts_start(void)
    
    X-Original-Commit: 8c5ceca7a2fc5f83d4019d2cc7499d904abfe9ac

 nimble/host/include/host/ble_gatt.h          |   2 +
 nimble/host/src/ble_att_priv.h               |   1 +
 nimble/host/src/ble_att_svr.c                |  21 +++++
 nimble/host/src/ble_gatt_priv.h              |   1 -
 nimble/host/src/ble_gatts.c                  | 125 ++++++++++++++++++++++++---
 nimble/host/test/src/ble_gatts_notify_test.c |  17 +---
 nimble/host/test/src/ble_gatts_read_test.c   |   8 +-
 nimble/host/test/src/ble_hs_test_util.c      |  20 +++++
 nimble/host/test/src/ble_hs_test_util.h      |   3 +
 9 files changed, 165 insertions(+), 33 deletions(-)

commit 663ec2fc76135d9e94b08e9b76205106b4568d01
Author: Marko Kiiskila <marko@runtime.io>
Date:   Wed Aug 2 15:09:03 2017 -0700

    nrf51 ble; fix compilation when BLE_LL_CFG_FEAT_LL_PRIVACY is not set.
    
    X-Original-Commit: 92a17431d05c53f583648de789de4ceead87e7cb

 nimble/drivers/nrf51/src/ble_phy.c | 2 ++
 1 file changed, 2 insertions(+)

commit 06e748dd00089b94544b3bf00f146b158d7eb481
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 26 13:09:15 2017 +0200

    nimble/controller: Fix handling privacy mode
    
    According to Bluetooth specificatoin 5.0 Vol 2. Part E 7.8.12, in LE
    Create Connection Command:
    
    "The Host shall not set Peer_Address_Type to either 0x02 or 0x03
    if both the Host and the Controller support the LE Set Privacy Mode
    command."
    
    With this patch, when peer_address_type in LE Create Connection command
    is set to 0x00 or 0x01 it is possible to connect to remote device
    which is in controller resolving list and advertise with rpa
    
    With this patch it is not possible to connect to remote device which is
    in the controller resolving list in privacy mode network and advertise
    with its identity address.
    
    X-Original-Commit: e67a483889ebc6d79744e27a0c06b819547143d8

 nimble/controller/src/ble_ll_conn.c | 31 ++++++++++++++++++++++++++++---
 1 file changed, 28 insertions(+), 3 deletions(-)

commit 44eb41709da7b0ef372b988ce0e061b99478665d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Aug 2 12:14:52 2017 +0200

    nimble/controller: Fix build issue when PHY is not set
    
    This patch fixes following issue:
    
    Error:
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_sched.c: In
    function 'ble_ll_sched_aux_scan':
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_sched.c:1350:9:
    error: variable 'phy_mode' set but not used
    [-Werror=unused-but-set-variable]
    
    X-Original-Commit: c654acbb291bbeb32e546105e137e3bfceb28fd4

 nimble/controller/include/controller/ble_ll.h |  6 ----
 nimble/controller/src/ble_ll.c                |  8 ++++--
 nimble/controller/src/ble_ll_conn.c           | 40 +++++++++++++++++++++------
 3 files changed, 37 insertions(+), 17 deletions(-)

commit 969af0699e8d9dc75aad48ef39ed8fc1c59f5de3
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 27 12:45:51 2017 +0200

    nimble/controller: Fix for checking valid scanning PHY
    
    X-Original-Commit: 57a154bfc481addbe232dfb007ddf0b0956da682

 nimble/controller/src/ble_ll_scan.c | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)

commit 690c5f295446a4b7aaa6d559ab244f5a2795def0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 25 10:40:30 2017 +0200

    nimble/controller: Fix duration for aux packet
    
    With this patch scheduler set fixed duration for upcoming aux packet.
    In case this is too short, scanner will handle it.
    
    X-Original-Commit: 944bdabf7aba23c29e48d2e7da07e2fc8abf929c

 nimble/controller/include/controller/ble_ll_sched.h |  5 +++++
 nimble/controller/src/ble_ll_sched.c                | 18 ++++++++----------
 2 files changed, 13 insertions(+), 10 deletions(-)

commit 5157ca128175d25e152d7e05b388705bb899ecad
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 25 10:36:37 2017 +0200

    nimble/controller: Improve handling aux ptr scheduller
    
    With this patch, scheduler does not disable phy when aux ptr is
    scheduled and LL state is scanning por initiating. Otherwise
    scanner will decide if procced scheduled item or drop its.
    
    Also with this patch, when scheduler disables PHY in scanning or
    initiating state, it does proper scan sm cleaning.
    
    X-Original-Commit: 3fc335d64fdbd2f6059aa2111b99cb29af7ec900

 nimble/controller/include/controller/ble_ll_scan.h |  3 ++
 nimble/controller/src/ble_ll_conn.c                | 16 ++++++
 nimble/controller/src/ble_ll_conn_priv.h           |  2 +-
 nimble/controller/src/ble_ll_scan.c                | 62 ++++++++++++++++------
 nimble/controller/src/ble_ll_sched.c               | 57 +++++++++++++-------
 5 files changed, 106 insertions(+), 34 deletions(-)

commit 31721e865a3897aeed47bf8ff62fe717a3c9e102
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 27 12:47:54 2017 +0200

    nimble: Fix setting advertising instance random address
    
    This fix extended advertising with random address provided by application.
    
    X-Original-Commit: 3f02494ca1df6f5293cccfe45f006e4afadd8eff

 nimble/host/src/ble_hs_hci_util.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 5faa62b84adb7c05db66f7b1a04213c8229bc96a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 27 10:28:52 2017 +0200

    nimble/controller: Fix build issue when BT5_PHY is set but not EXT ADV
    
    This fixes:
    Error: repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_conn.c:
    In function 'ble_ll_conn_slave_start':
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll_conn.c:4003:5:
    error: implicit declaration of function 'ble_ll_conn_init_phy'
    [-Werror=implicit-function-declaration]
         ble_ll_conn_init_phy(connsm, rxhdr->rxinfo.phy);
    
    X-Original-Commit: f327b644af20d7a3289c723b7c8f9ed119f7a7c7

 nimble/controller/src/ble_ll_conn.c | 38 ++++++++++++++++++-------------------
 1 file changed, 19 insertions(+), 19 deletions(-)

commit 1f9772acd045af784ad08d661bcc30dc9e7c3893
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 27 10:29:51 2017 +0200

    nimble/controller: Fix scan response set for legacy
    
    With this patch we configure all the adv instance to be legacy on init.
    
    X-Original-Commit: 2af30b0ff755f3109f588bb9d7e024750bb9d625

 nimble/controller/src/ble_ll_adv.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 0de57d5f7ed8d7abea83bffde8e9ac86e370ba18
Merge: 77b3bdb0 1758c04d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 27 00:33:54 2017 +0200

    Merge pull request #467 from andrzej-kaczmarek/bt5-resolv-fix
    
    [MYNEWT-819] nimble/phy: Fix resolving address on nRF51
    
    X-Original-Commit: 01b675702e93cd8b9eeab2a352e0509faa89e600

commit 77b3bdb01f1d79d4a124031118d7e3c22dfa654c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 26 10:55:28 2017 -0700

    Fix host unit test compiler error on mac.
    
    This addresses the following compiler error encountered in macOS:
    
        Compiling net/nimble/host/test/src/ble_hs_test_util.c
        net/nimble/host/test/src/ble_hs_test_util.c: In function 'ble_hs_test_util_create_rpa_conn':
        net/nimble/host/test/src/ble_hs_test_util.c:411:79: error: macro "memcpy" passed 10 arguments, but takes just 3
             memcpy(evt2.features, (uint8_t[]){ conn_features, 0, 0, 0, 0, 0, 0, 0 }, 8);
                                                                                       ^
        net/nimble/host/test/src/ble_hs_test_util.c:411:5: error: statement with no effect [-Werror=unused-value]
             memcpy(evt2.features, (uint8_t[]){ conn_features, 0, 0, 0, 0, 0, 0, 0 }, 8);
             ^
        cc1: all warnings being treated as errors
    
    This error occurs on the mac because its standard library implements
    `memcpy()` as a macro rather than a function.  The reason for the error
    is explained here: https://stackoverflow.com/a/5559334.  Basically, the
    preprocessor doesn't understand the full C syntax, so arguments to
    macros need special treatment.
    
    The fix is to surround the compound literal argument with an extra set
    of parenthesis.
    
    X-Original-Commit: 0bf7a4009fe683178d8912641f02d88314ec312b

 nimble/host/test/src/ble_hs_test_util.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1758c04d09258296793aefcf4e344303e168f33f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 25 19:20:12 2017 +0200

    nimble/phy: Fix resolving address on nRF51
    
    This is the same as 2d34c653a but for nRF51 which I forgot to change
    there...
    
    X-Original-Commit: 8ce36f00865e4c8708baba794904d30a00672343

 nimble/drivers/nrf51/src/ble_phy.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 2829735cca3b04a8b04c7bec9014e5770290e3de
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 25 19:20:12 2017 +0200

    nimble/phy: Fix resolving address
    
    g_ble_phy_rx_buf is declared as uint32_t[] so [3] and [5] does not
    really point where I expected...
    
    X-Original-Commit: 2d34c653a79b3b301a5be466c587bbea145f23fc

 nimble/drivers/nrf52/src/ble_phy.c | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit fad07474c49259992194d4b8b35b2a7cdfc0b528
Merge: 9029951b 1f101263
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 25 17:41:43 2017 +0200

    Merge pull request #463 from sjanc/directed_adv_fixes
    
    Directed adv fixes
    
    X-Original-Commit: f73a79e4211d349f7133d9cde9c1950280098160

commit 9029951bbabd38f62b48e316f4e6d158966c91b5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 25 13:23:40 2017 +0200

    nimble/controller: Fix handling direct advertising
    
    If init address is set that means we do have directed advertising:
    legacy one or extended.
    Without this patch we missed that check for extended advertising.
    
    X-Original-Commit: 8dec01c69421780b04fc039b4f04ddc2e93de90d

 nimble/controller/src/ble_ll_scan.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit e3d67662db165093d9c383f71c1f5d65fc398785
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 25 12:17:42 2017 +0200

    nimble/controller: Fix privacy mode
    
    Make sure that privacy mode is checked only for direct advertising.
    
    Without this patch it was not possible to connect to remote using
    undirected advertising when this remote device was in resolving list.
    
    X-Original-Commit: fd5c0ee8bc2a23436caed7a25bf8dcc2111e002c

 nimble/controller/src/ble_ll_conn.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 1f1012636a51bce6d36f38a4d575f26e79e4cb33
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 25 15:17:42 2017 +0200

    nimble/host: Fix HD directed advertising with extended advertising
    
    IF HD directed advertising is enabled then duration must be non-zero
    but smaller than 1.28ms. Otherwise HCI command is rejected by
    controller. We always set duration to maximum allowed value since
    shorter duration is already handled by host timer.
    
    X-Original-Commit: f7891658c07ea9f2661cd0a21922e69cc7108200

 nimble/host/src/ble_gap.c | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)

commit 368f819e87bd85e1ea6e988c8958ef5b5664879e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 25 14:56:31 2017 +0200

    nimble/controller: Fix interval settings for directed advertising
    
    Those should be ingnored only for high duty directed advertising.
    
    X-Original-Commit: 819c15c7dd9fade54ded072fdd2443b32be43c8e

 nimble/controller/src/ble_ll_adv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5945b72542a3a4694a55d610e014748c6df1f781
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 24 22:04:48 2017 +0200

    nimble/phy: Fix build error on nRF52
    
    nRF52 does not have symbols for 125/500 data rates in CCM defined (for
    LE Coded PHY - we only allow 1M on nRF52 anyway). Also CCM is only
    configured if encryption is enabled.
    
    Error: repos/apache-mynewt-core/hw/drivers/nimble/nrf52/src/ble_phy.c: In
    function 'ble_phy_get_ccm_datarate':
    repos/apache-mynewt-core/hw/drivers/nimble/nrf52/src/ble_phy.c:505:16:
    error: 'CCM_MODE_DATARATE_125Kbps' undeclared (first use in this
    function)
             return CCM_MODE_DATARATE_125Kbps << CCM_MODE_DATARATE_Pos;
                    ^~~~~~~~~~~~~~~~~~~~~~~~~
    repos/apache-mynewt-core/hw/drivers/nimble/nrf52/src/ble_phy.c:505:16:
    note: each undeclared identifier is reported only once for each function
    it appears in
    repos/apache-mynewt-core/hw/drivers/nimble/nrf52/src/ble_phy.c:507:16:
    error: 'CCM_MODE_DATARATE_500Kbps' undeclared (first use in this
    function)
             return CCM_MODE_DATARATE_500Kbps << CCM_MODE_DATARATE_Pos;
                    ^~~~~~~~~~~~~~~~~~~~~~~~~
    
    X-Original-Commit: 86d78797ca1e56ee3d9d20088862fe4c40aa8518

 nimble/drivers/nrf52/src/ble_phy.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit c47129ed290e0f2562e7e1477e09ab69e9fe94ba
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 24 19:04:52 2017 +0200

    nimble/phy: Fix key-stream generation in CCM
    
    Key-stream generation is triggered by PPI after EVENT_READY event from
    radio. This does not seem to work properly for 2M and Coded PHYs (tbh,
    I have no idea why) and we cannot decrypt anything on these PHYs.
    
    This fixes the problem by manually triggering TASK_KSGEN immediately
    after CCM is configured.
    
    X-Original-Commit: 865382ba3bd469cad664c0da3b5d77c1963152dd

 nimble/drivers/nrf52/src/ble_phy.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 33871c9f7155eab9867b96280915db2db081c696
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 24 19:11:11 2017 +0200

    nimble/phy: Set proper CCM datarate
    
    CCM needs to be configured with proper radio data rate to work properly
    with phys other than 1M.
    
    X-Original-Commit: 4beee51423c5fe21f8e599e07c85ee7a670e6052

 nimble/drivers/nrf52/src/ble_phy.c | 23 +++++++++++++++++++++--
 1 file changed, 21 insertions(+), 2 deletions(-)

commit b34074c7ef627dfa8da0dcb17cf34c3c8551f24a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jul 24 15:36:43 2017 +0200

    nimble/controller: Minor fix function name
    
    X-Original-Commit: d93f07dd79894a33193f0cde82b3965bd2e7e4d3

 nimble/controller/src/ble_ll.c           | 2 +-
 nimble/controller/src/ble_ll_conn.c      | 2 +-
 nimble/controller/src/ble_ll_conn_priv.h | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit b42af78306404530ebf4266f31cb1970edc04139
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jul 24 14:58:20 2017 +0200

    nimble/controller: Minor comment fix and cleanup
    
    X-Original-Commit: 2d3af8fbd37c513d641a09c0108169d9a4e19877

 nimble/controller/src/ble_ll_conn.c |  2 +-
 nimble/controller/src/ble_ll_scan.c | 20 +++++++++++++++++++-
 2 files changed, 20 insertions(+), 2 deletions(-)

commit 72d2e492282ebd4b44efda4a8c607088ad675af9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jul 24 14:36:33 2017 +0200

    nimble/controller: Minor coding style
    
    X-Original-Commit: e0f9cd09e6f3b9bf1cac8825f055b75e75c429b6

 nimble/controller/src/ble_ll_conn.c | 1 -
 1 file changed, 1 deletion(-)

commit 51ba4109c45256f61b3926877ccdf494b341ea18
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 24 10:02:14 2017 +0200

    nimble/controller: Add stat for AUX_CONNECT_RSP tx
    
    X-Original-Commit: 71e990d4b16ea6eaae0d9e63bbfe481f74f372ac

 nimble/controller/include/controller/ble_ll.h | 1 +
 nimble/controller/src/ble_ll.c                | 1 +
 nimble/controller/src/ble_ll_adv.c            | 2 +-
 3 files changed, 3 insertions(+), 1 deletion(-)

commit cb5077ae82fc209ce7d6ece2e050697c37ee4fca
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 24 10:00:21 2017 +0200

    nimble/phy: Fix BCC for LE Coded PHY
    
    BCC starts counting after ADDRESS event so in case of LE Coded PHY it
    also counts CI and TERM1 fields. This has to be taken into account when
    setting BCC as otherwise we may start reading RX buffer before complete
    byte is received.
    
    X-Original-Commit: 9c316f348d057f02779fb4c720ca711f058dc0dc

 nimble/drivers/nrf52/src/ble_phy.c | 25 +++++++++++++++++++++----
 1 file changed, 21 insertions(+), 4 deletions(-)

commit c0ad1401f5dc87ba3319b153fc778a510f5d6acf
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 14:23:36 2017 +0200

    nimble/controller: Fix AUX_CONNECT_RSP handling
    
    After sending AUX_CONNECT_REQ we check for AUX_CONNECT_RSP at the time
    1st connection event should occur so if we miss AUX_CONNECT_RSP, we
    still have connection scheduled. We can be smarter here and just
    remove connection from scheduler if we do not receive AUX_CONNECT_RSP
    as a direct response for AUX_CONNECT_REQ.
    
    In addition this fixes problem where we were stuck after missing
    AUX_CONNECT_RSP - on 2nd AUX_CONNECT_REQ we tried to schedule the same
    connection again, but it was already in the scheduler so it always
    overlapped itself resulting in an infinite loop.
    
    X-Original-Commit: 61effe82b46ea352e2183822f423dd72e93b771c

 nimble/controller/include/controller/ble_ll_conn.h |  2 -
 nimble/controller/src/ble_ll_conn.c                | 63 ++++++++++++++++------
 nimble/controller/src/ble_ll_conn_priv.h           |  1 +
 nimble/controller/src/ble_ll_scan.c                |  9 ++++
 nimble/controller/src/ble_ll_sched.c               |  7 ++-
 5 files changed, 62 insertions(+), 20 deletions(-)

commit 2216adc085978bf5755fb18430e36e3880f9b576
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 14:24:21 2017 +0200

    nimble/controller: Fix wfr timer handling in init state
    
    We need to use SM for initiating connection, not for an active one
    (since there is no active connection).
    
    X-Original-Commit: 94e11ea8a2de96dc3f79b8841ddfb0b377f8d9b5

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e89f71269d71063b11d9802533574213dd7ec508
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 13:19:47 2017 +0200

    nimble/controller: Ignore PDUs with invalid CRC in init state
    
    PDUs with invalid CRC shall be discarded (Vol 6, Part B, section 3.1)
    
    X-Original-Commit: f07c2abcadf93db57d2064a9e37c40e7d0be7d9e

 nimble/controller/src/ble_ll_conn.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 6bbbc778b2bf3f6cceb55236898909f53a613983
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 13:18:57 2017 +0200

    nimble/controller: Remove invalid comment
    
    This looks like copy&paste from end of function.
    
    X-Original-Commit: 471094c18ab8917fa27a621ef744c6073be98b46

 nimble/controller/src/ble_ll_conn.c | 4 ----
 1 file changed, 4 deletions(-)

commit 0b2cd31f7af2551fd11950c28851d5399317a085
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 13:16:57 2017 +0200

    nimble/controller: Apply wfr workaround to Coded PHY only
    
    We still need to fix this, but at least make this magic workaround be
    applied only for LE Coded since there's no need for it on 1M and 2M.
    
    X-Original-Commit: 3a24cfb3e0c4cf00e91966a4a549b05acd006d8c

 nimble/drivers/nrf52/src/ble_phy.c | 19 ++++++++++++-------
 1 file changed, 12 insertions(+), 7 deletions(-)

commit 4778a10a402e5353aca8e7df5cbdfce48e9694ec
Merge: 3f50cd70 33706186
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 21 16:04:22 2017 +0200

    Merge pull request #452 from andrzej-kaczmarek/bt5-legacy-scan-fix
    
    nimble/controller: Fix legacy scanning
    
    X-Original-Commit: 0cabb4eadc6fc864f840f7cd9649f1cd0f88c453

commit 3f50cd702c98b88002f3f13fd84453e900b5aac9
Merge: e33baef7 cd5448cf
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jul 21 13:59:25 2017 +0200

    Merge pull request #422 from wes3/bsnbranch
    
    Merge bsnbranch
    
    X-Original-Commit: e53b123aa0369840546bba7b2356c79580bf9047

commit 33706186bae4cc59a7ec6335b873f849973e1cb8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 22:44:01 2017 +0200

    nimble/controller: Fix legacy scanning
    
    In legacy scanning next_phy is unconfigured so we should not try to
    configure channels for next_phy as it will corrupt some random
    memory.
    
    Also add assert to make sure cur_phy is always configured, because it
    should be.
    
    X-Original-Commit: 9e24b8ad69966995b1b5582a310a59d350ad45db

 nimble/controller/src/ble_ll_scan.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit e33baef7793c34add138052f5dfad15377637d2f
Merge: 763ca94a a6f48d61
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 22:45:38 2017 +0200

    Merge pull request #449 from andrzej-kaczmarek/nimble-crc-check
    
    [MYNEWT-285] nimble/phy: Fix CRC checking
    
    X-Original-Commit: d04fc83c1011a457c1a6398c70180e3b862dcfb8

commit a6f48d616fbe3f1c8e0142c2f771116db9f80770
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 20 18:49:35 2017 +0200

    [MYNEWT-285] nimble/phy: Fix CRC checking
    
    The CRCSTATUS register is not cleared automatically by hardware so it
    may not reflect current state of CRC check in some cases. The better way
    to check CRC is to clear EVENT_CRCOK when starting to receive a packet
    and then check its state when done.
    
    X-Original-Commit: 97353f844c48de443ca546e1b3fdfce039bfadd3

 nimble/drivers/nrf52/src/ble_phy.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 763ca94a127ad2d901a196e72f8423c1450fcc8c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 20 15:59:27 2017 +0200

    Remove last incubator leftovers
    
    X-Original-Commit: aca10a2adc456e5b562c663ac35de41a4f2dee01

 nimble/controller/test/pkg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bfcf2ed69ba088aaa9eaaecd53246834045f311c
Merge: c145f985 74b772c5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 20 11:47:31 2017 +0200

    Merge pull request #437 from sjanc/master_bluetooth5
    
    merge bluetooth5 branch into master
    
    X-Original-Commit: 54a77a0d5b4515967ae0e298064410031b2850f1

commit 74b772c568060ba7af609461290abe8c0b28a5f0
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 19 12:33:34 2017 +0200

    nimble/test: update tests after bugfix in SM legacy
    
    X-Original-Commit: 1b4a4f4377b50530c5a7d72f8574f28f82b953f1

 nimble/host/test/src/ble_sm_lgcy_test.c | 2 +-
 nimble/host/test/src/ble_sm_test_util.c | 6 +-----
 2 files changed, 2 insertions(+), 6 deletions(-)

commit b257408e21675ba86046c82fed5562a5c753923b
Merge: 5738a4de 6ad9cf2d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jul 19 11:50:01 2017 +0200

    Merge pull request #428 from sjanc/bt5_ext_adv_host
    
    ext advertising support for host
    
    X-Original-Commit: 6920a1e24c17a226cbc4eb6af82b5b3253200c9d

commit c145f9859fd023d3d26fd870a6a7951a39648482
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jul 19 10:34:25 2017 +0200

    Remove incubator leftovers
    
    X-Original-Commit: 2a1ba94d60e3b305fe572707cb6992a1e0e9f35f

 nimble/controller/pkg.yml            | 2 +-
 nimble/drivers/native/pkg.yml        | 2 +-
 nimble/drivers/nrf51/pkg.yml         | 2 +-
 nimble/drivers/nrf52/pkg.yml         | 2 +-
 nimble/host/pkg.yml                  | 2 +-
 nimble/host/services/ans/pkg.yml     | 2 +-
 nimble/host/services/bleuart/pkg.yml | 2 +-
 nimble/host/services/gap/pkg.yml     | 2 +-
 nimble/host/services/gatt/pkg.yml    | 2 +-
 nimble/host/services/ias/pkg.yml     | 2 +-
 nimble/host/services/lls/pkg.yml     | 2 +-
 nimble/host/services/tps/pkg.yml     | 2 +-
 nimble/host/store/config/pkg.yml     | 2 +-
 nimble/host/store/ram/pkg.yml        | 2 +-
 nimble/host/test/pkg.yml             | 2 +-
 nimble/pkg.yml                       | 2 +-
 nimble/transport/ram/pkg.yml         | 2 +-
 nimble/transport/socket/pkg.yml      | 2 +-
 nimble/transport/uart/pkg.yml        | 2 +-
 19 files changed, 19 insertions(+), 19 deletions(-)

commit 5738a4de0e08cdc98c8c54fb0efbd2acd61de0c9
Merge: 7c12d8ec dccb5177
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 19 10:29:38 2017 +0200

    Merge pull request #415 from michal-narajowski/bt5-regression-tests
    
    MYNEWT-659 Rerun PTS on Bluetooth5 branch (regression testing)
    
    X-Original-Commit: d3e3d68c5ee14813efe860e1f22b0d92d8742474

commit 6ad9cf2defb71240a88a4c148cfae5f9a6c40eca
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 18 19:36:40 2017 +0200

    nimble/host: Add support for using Extended Advertising
    
    This allows to:
     - set more than 31 bytes of advertising date or scan response
     - enabling advertising on secondary channels
     - configure PHYs for primary and secondary channels
     - configure TX power
    
    X-Original-Commit: 95d17971af9161e918783d678db035b8df5da19e

 nimble/host/include/host/ble_gap.h |   6 +
 nimble/host/src/ble_gap.c          | 243 +++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs_hci_util.c  |  23 +++-
 3 files changed, 264 insertions(+), 8 deletions(-)

commit b57fc4f96bfcf5128c8146a2f4325c228b49d3d4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jul 17 16:19:11 2017 +0200

    nimble/host: Add builder functions for Ext Adv HCI commands
    
    X-Original-Commit: dfc8912907e030323f4609caebafb0bbf01c470e

 nimble/host/src/ble_hs_hci_cmd.c   | 126 +++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  |  29 +++++++++
 nimble/include/nimble/hci_common.h |  27 ++++++++
 3 files changed, 182 insertions(+)

commit cd5448cf42889a46a41e211f5c2d7097fe38d832
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jul 18 09:55:40 2017 -0700

    nimble/controller: bsnbranch merge into bluetooth5
    
    By default, strict connection scheduling should be off in the
    controller syscfg. It is turned on for the bsncent app. Fixed
    a merge error when checking for next scheduled connection
    time when strict scheduling is defined.
    
    X-Original-Commit: bac7ee6576b7aa2483a98408f7981ab5cd9545af

 nimble/controller/src/ble_ll_conn.c | 5 +++++
 nimble/controller/syscfg.yml        | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)

commit badbbf8ecd42f81097041bebbecba8a13bd19a21
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jul 17 15:12:49 2017 -0700

    nimble/controller: merge bsnbranch into bluetooth5
    
    Fix merge errors from first pass of merge.
    
    X-Original-Commit: d072535a415d23c3237a204f3c455f8d730df767

 nimble/controller/include/controller/ble_ll_conn.h | 3 ---
 nimble/controller/src/ble_ll_sched.c               | 6 +++---
 2 files changed, 3 insertions(+), 6 deletions(-)

commit 735b12518ea82d3ffaab02f0585dca812fd79480
Author: William San Filippo <wills@runtime.io>
Date:   Tue Mar 21 13:56:57 2017 -0700

    Initial commit for the "body sensor network" code changes.
    
    X-Original-Commit: 4d4c3e18284af0d2bd2e085c89c71078c5d0d01c

 nimble/controller/include/controller/ble_ll_conn.h |   7 +
 .../controller/include/controller/ble_ll_sched.h   |  34 +++
 nimble/controller/src/ble_ll.c                     |   3 +
 nimble/controller/src/ble_ll_conn.c                |  26 ++-
 nimble/controller/src/ble_ll_sched.c               | 246 +++++++++++++++++++++
 nimble/controller/syscfg.yml                       |  21 ++
 6 files changed, 336 insertions(+), 1 deletion(-)

commit 7c12d8ec4140c2befa725f3f9676b5e80dcc03c4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 18 16:06:16 2017 +0200

    nimble/controller: Improve advertising report HCI event building
    
    We should use 'subev' parameter to determine contents of HCI event.
    
    Also add some sanity checks.
    
    X-Original-Commit: 101526a814893820c12d18010554e6b46409ff2b

 nimble/controller/src/ble_ll_scan.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 5ba8fb58788262f12658d73d97f12a4b3c47f4d6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 18 16:04:19 2017 +0200

    nimble/controller: Remove unused subev parameter
    
    This is not used inside function and is just confusing.
    
    X-Original-Commit: bf378b198d62693368c2212e923e4f113ebf6aa2

 nimble/controller/src/ble_ll_scan.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 0d83f2abfd21bdaf93dc4203cb852bbdcc4fc526
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 18 16:03:08 2017 +0200

    nimble/controller: Fix event mask checking for advertising report HCI events
    
    X-Original-Commit: df97b8294cc31b6111d065a53a0066d8b9db7a6c

 nimble/controller/src/ble_ll_scan.c | 22 +++++++++++++++-------
 1 file changed, 15 insertions(+), 7 deletions(-)

commit 9fc4c79ce48ab1a483562563ed016e25abea12bd
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 18 16:00:52 2017 +0200

    nimble/controller: Fix advertising report HCI event with empty adv data
    
    X-Original-Commit: 2aa264ca5b799d7c3a3e134fc09d3171372de98e

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 98abc42ab508f249d97e375d38aebe852a50d1ca
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 18 15:57:16 2017 +0200

    nimble/controller: Fix length for advertising report HCI event
    
    X-Original-Commit: 15445662f3c9413ae11733f78a6033dfcdee59d0

 nimble/controller/src/ble_ll_scan.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit e9fa51d2fb4ced7345511cbef5d734cc514ac1f9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 10 15:38:52 2017 +0200

    nimble/hs: Update enabled LE Event Mask
    
    X-Original-Commit: 4a95d569c74e7ac1f126a8c9e4f6f2be31c07c46

 nimble/host/src/ble_hs_startup.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit dccb5177d23395f5ced9e9c945575df40dd33c09
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 18 10:01:48 2017 +0200

    nimble/host: fix SM SC authenticated pairing
    
    X-Original-Commit: 21f5066cf2248f55ba71d38d7aa49a944f3fb36f

 nimble/host/src/ble_sm_sc.c | 12 ++----------
 1 file changed, 2 insertions(+), 10 deletions(-)

commit 95eb9f588414b3cf9a874c932b134008b533e350
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 17 16:03:01 2017 +0200

    nimble/host: fix SM legacy authenticated pairing
    
    X-Original-Commit: 21431847dbaa1e0523e0c4f66a1719fb96feed8c

 nimble/host/src/ble_sm_lgcy.c | 12 ++----------
 1 file changed, 2 insertions(+), 10 deletions(-)

commit f59ca372ae651442533d516d8ad05967970178cf
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 18 15:25:11 2017 +0200

    nimble/pts: update testing dates
    
    X-Original-Commit: b0219a80f4aebe1c6b705c6e389db897d445b2a5

 nimble/host/pts/pts-gap.txt   | 2 +-
 nimble/host/pts/pts-gatt.txt  | 2 +-
 nimble/host/pts/pts-l2cap.txt | 2 +-
 nimble/host/pts/pts-sm.txt    | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit 8cf705c44f1db8ec54cd8826a73efd3144188e29
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 11 12:23:26 2017 +0200

    nimble/pts: update PTS GATT test scenarios
    
    X-Original-Commit: 79f6c75736f0a9f78cad26eef23ae9794e7fc15f

 nimble/host/pts/pts-gatt.txt | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 07c3802b1bfa70b0f8ce28d7ff5f712789ce1dea
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 16:12:38 2017 +0200

    nimble/pts: update PTS SM test scenarios
    
    X-Original-Commit: bfeeb6b1b3af8828a520e87e9ae90a8ee4ff6ed8

 nimble/host/pts/pts-sm.txt | 25 ++++++++++++++++++-------
 1 file changed, 18 insertions(+), 7 deletions(-)

commit 7cd361a713d6f775062922dddd6b31fec1127b5e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 7 09:50:48 2017 +0200

    nimble/pts: update PTS GAP test scenarios
    
    X-Original-Commit: 20d21997d0d50d1bdc467438a7329affcd86c9c5

 nimble/host/pts/pts-gap.txt | 87 ++++++++++++++++++++++++++-------------------
 1 file changed, 51 insertions(+), 36 deletions(-)

commit 33b131ca53580942f499ff009459bbfe1b18ec0c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 14 09:39:38 2017 +0200

    nimble/controller: Fix initial conn event scheduling on ext adv
    
    We schedule packet from the end of AUX_ADV_IND packet (like in legacy
    advertising), not from its beginning.
    
    X-Original-Commit: a3513040c792a352a3d0ef1693fb2a687bc218fa

 nimble/controller/src/ble_ll_sched.c | 34 +++++++++++++---------------------
 1 file changed, 13 insertions(+), 21 deletions(-)

commit c79ef7fe6a0bdf4a330787aa11d3bc99af4fe756
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 14 11:08:30 2017 +0200

    nimble/controller: Fix connMaxTxTime calculation on coded PHY
    
    X-Original-Commit: f33ae68ef2109d1ae536a55415eaecfad240176b

 nimble/controller/src/ble_ll_conn.c      | 99 +++++++++++++++++++++++---------
 nimble/controller/src/ble_ll_conn_priv.h |  9 ++-
 2 files changed, 80 insertions(+), 28 deletions(-)

commit 934583190bb808dd7666d9d110d98ae15bce5d53
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 14 11:08:03 2017 +0200

    nimble/controller: Fix typo
    
    X-Original-Commit: cbba5d4a26d09fb1ba4ace38be737b2c68299ef2

 nimble/controller/src/ble_ll_conn.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 9f278a57c8d82f9b3ac6ea5f7885f77f8d953821
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 13 15:19:28 2017 +0200

    nimble/controller: Fix setting PHY for slave connection
    
    Slave connection was always created with 1M PHY instead of last used
    one. This fix connection on 2M and coded PHYs.
    
    X-Original-Commit: c788257bbf3b6d8d3bf437331694b3e13787ce6d

 nimble/controller/src/ble_ll_conn.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 09cc501ce69e5e4645854da111fcdbe964023243
Merge: e859bc9e 4168d7c9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 13 11:21:10 2017 +0200

    Merge branch 'master' into bluetooth5_master
    
    Conflicts:
            hw/bsp/ruuvi_tag_revb2/syscfg.yml
            net/nimble/controller/src/ble_ll_adv.c
    
    X-Original-Commit: 590e8a73a8c448aeff1bddf3b913ade7f70acdce

commit 4168d7c9b5bba202a8afa50cd865baf63a4bcc58
Merge: 09c106cd 431f640f
Author: wes3 <wills@runtime.io>
Date:   Wed Jul 12 10:27:07 2017 -0700

    Merge pull request #403 from wes3/myn810
    
    nimble/controller: Fix scheduler advertising halt error
    
    X-Original-Commit: abe5e6b39526aef7c1c18d08f41f30606b25f17f

commit e859bc9e338b9cb205388110df4373c12b81befb
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jul 11 14:50:39 2017 +0200

    nimble: convert HCI error codes to hex
    
    Spec defines these error codes as hexes so it's easier to read
    and compare them as hexes.
    
    X-Original-Commit: 7426bfb377cf892bc71cea8f2d8f2bca3a6aa0d5

 nimble/include/nimble/ble.h | 140 ++++++++++++++++++++++----------------------
 1 file changed, 70 insertions(+), 70 deletions(-)

commit 93d1540a40e59c5402e02abe40ef42dff235b58a
Merge: 6654d3b2 43118c2f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Jul 12 16:00:17 2017 +0200

    Merge pull request #398 from michal-narajowski/bt5-fixes
    
    [RFC] Fixes for possible issues found with clang-check
    
    X-Original-Commit: bb9a2b00e0fdbe8d93a76c0d73c638f6007daba0

commit 6654d3b2ba6138ad3a320bf5a02727a8d24a3ea5
Merge: 6ced7773 f9bf7610
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jul 12 15:57:00 2017 +0200

    Merge pull request #402 from sjanc/bt5_ext_adv
    
    nimble/controller: Fixes for advertising timeout handling
    
    X-Original-Commit: 02c45e00f34e08f5cb3f4f43acf39f429521e4fa

commit 43118c2f0b52141081be608afd55d8e01a740e91
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 11:39:37 2017 +0200

    nimble/host: handle error case on ble_svc_ans_chr_write
    
    X-Original-Commit: 6fd67bfdec7f801122fece18ba77ae4e6ec0caa6

 nimble/host/services/ans/src/ble_svc_ans.c | 3 +++
 1 file changed, 3 insertions(+)

commit b4a67384be9ccb79217e86d26fa482008483019d
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 10:56:31 2017 +0200

    nimble/host: add missing rc check when setting adv fields
    
    X-Original-Commit: 4b807342ef52c3264de0a1711b313d71ee322521

 nimble/host/src/ble_hs_adv.c | 4 ++++
 1 file changed, 4 insertions(+)

commit a65e329d473cc875de140ae6f56ef693c686a57a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 10:44:39 2017 +0200

    nimble/controller: fix undefined result of << expression
    
    X-Original-Commit: b1a15dc42777e9e69e285ec169396a2a8363da3f

 nimble/controller/src/ble_ll_ctrl.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 43de01f045e5b9429cb3e13a4876eca2a3a69e1e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 10:16:23 2017 +0200

    nimble/controller: fix null pointer dereference
    
    X-Original-Commit: 3efb475d7077faff710844cf8b79602e8b0c8154

 nimble/controller/src/ble_ll_sched.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 191fac43312bfc1e4b56c95f353d7cf04b8e249f
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 10:12:31 2017 +0200

    nimble/controller: fix uninitialized value
    
    X-Original-Commit: 345d469147fdc1c74f703a754c16d25bd272cf9d

 nimble/controller/src/ble_ll_scan.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 6f5e96dcefcd2394a811222a9ff37e70c793b230
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 10 09:45:56 2017 +0200

    nimble/host: fix uninitialized value
    
    X-Original-Commit: 40f169c7115d04726a7514c99251899996d79060

 nimble/host/src/ble_att_svr.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

commit 09c106cd83189d3028ea3ecd7b21f5309621d2f7
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 11 17:27:24 2017 -0700

    BLE Host - Add comments; move decls to priv hdrs.
    
    * Add API documentation in comments above some public functions.
    * Move prototypes for non-API functions into "[...]_priv.h" headers.
    * Delete some obsolete and unused functions.
    
    X-Original-Commit: 58fbf771ff5c48a949b20c46d78fcb580273dc8b

 nimble/host/include/host/ble_gap.h  | 17 +++++++--------
 nimble/host/include/host/ble_gatt.h | 34 ------------------------------
 nimble/host/src/ble_att.c           |  6 ++++--
 nimble/host/src/ble_gap.c           |  4 ++--
 nimble/host/src/ble_gap_priv.h      |  5 +++++
 nimble/host/src/ble_gatt_priv.h     | 32 ++++++++++++++++++++++++++++
 nimble/host/src/ble_gatts.c         |  2 +-
 nimble/host/src/ble_hs.c            | 16 +++++++++++++-
 nimble/host/src/ble_uuid.c          | 42 +++++++++++++++++++++++++++++++++++++
 9 files changed, 109 insertions(+), 49 deletions(-)

commit f7d6997edcf1f2b6e99f55717ef818e6b3ca03a9
Merge: 10e524c2 1d241799
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 22:21:40 2017 +0200

    Merge pull request #372 from andrzej-kaczmarek/btmon_core
    
    nimble: add monitor protocol/interface
    
    X-Original-Commit: b609a1017593bb5e3ab54e472e2ee1bbf27719ea

commit 6ced777370277c76e7a1df0abd7eeabb87568353
Merge: bbcd2a40 742b3b04
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 22:20:34 2017 +0200

    Merge pull request #401 from andrzej-kaczmarek/bt5-aar-fix
    
    nimble/phy: Cleanup AAR initialization
    
    X-Original-Commit: 6df0f5d083661990a05fc9bd9871936b60bb2935

commit 431f640fc204b304ca851445b7d5480760d402d2
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jul 11 10:37:56 2017 -0700

    nimble/controller: Fix scheduler advertising halt error
    
    MYNEWT-810: This fixes the scheduler error where the controller
    would send the wrong state machine to the advertising halt
    function and an incorrect event would get sent to the LL for
    processing.
    
    X-Original-Commit: 76a1a16db57133fcb13341eff33eed785187f460

 nimble/controller/include/controller/ble_ll_adv.h | 2 +-
 nimble/controller/src/ble_ll_adv.c                | 6 ++++--
 nimble/controller/src/ble_ll_sched.c              | 2 +-
 3 files changed, 6 insertions(+), 4 deletions(-)

commit f9bf7610247320907ad9bed71fd200f0869d1e23
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 11 16:49:49 2017 +0200

    nimble/controller: Remove redundant call to ble_ll_scan_chk_resume
    
    ble_ll_scan_chk_resume() is already called unconditionaly on begining
    of the function so there is no need to call it again when stopping
    advertising.
    
    X-Original-Commit: eee646b691dfeb84a8d6cad0d60a88526cbf7c88

 nimble/controller/src/ble_ll_adv.c | 1 -
 1 file changed, 1 deletion(-)

commit 0274081467542c4c7f3c055795c03553dc2ec49e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jul 11 16:28:49 2017 +0200

    nimble/controller: Add support for ext advertising duration
    
    This allows to configure how long advertising instance should be
    active. High duty directed advertising is now just a special case of
    this and duration is verified when advertising is enabled.
    
    X-Original-Commit: 4ec087d1e1b7f476a0fc3391f6d7b73121e3d7c4

 nimble/controller/include/controller/ble_ll_adv.h |   2 +-
 nimble/controller/src/ble_ll_adv.c                | 103 +++++++++++++++++++---
 nimble/controller/src/ble_ll_hci.c                |   2 +-
 3 files changed, 91 insertions(+), 16 deletions(-)

commit 742b3b0473b002189654142ebc0c91c9e777b19e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 16:10:50 2017 +0200

    nimble/phy: Cleanup AAR initialization
    
    AAR address pointer and BCC value can be calculated after we know type
    of advertising packet which was received - move setting both values
    to the same place in all cases and add extra comment.
    
    X-Original-Commit: 648eeb0cea3608bc7db7173499a385d210a09e6b

 nimble/drivers/nrf51/src/ble_phy.c | 25 +++++++++++++------------
 nimble/drivers/nrf52/src/ble_phy.c | 25 +++++++++++++------------
 2 files changed, 26 insertions(+), 24 deletions(-)

commit 1d241799ba01bc106a43f2f90da353b747843461
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 13:36:56 2017 +0200

    nimble/monitor: Use vsnprintf to calculate characters in log message
    
    vsnprintf() called with size=0 will return number of characters that
    would have been written if large enough buffer was provided. In this
    case we can also pass NULL as a buffer and nothing will be written there
    (this is guaranteed by C99).
    
    X-Original-Commit: 8de5cbb46fc578fad0e6ada5e2d073dc6aa567cf

 nimble/host/src/ble_monitor.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 92019680a71c64e3e3158c6edc67b6b3f0f986cd
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 13:36:51 2017 +0200

    nimble/monitor: Make controller name static
    
    X-Original-Commit: dc885394290d643502b150e427a83e9d69e04b92

 nimble/host/src/ble_monitor.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2318e740acc66d0a4dabdf151c57383ce374a5d4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 13:36:21 2017 +0200

    nimble/monitor: Make RTT upstream buffer name configurable
    
    X-Original-Commit: c4826c054203ffbf7d3df0f4ec753730e99e3898

 nimble/host/src/ble_monitor.c | 6 ++++--
 nimble/host/syscfg.yml        | 3 +++
 2 files changed, 7 insertions(+), 2 deletions(-)

commit 1dce77db797866c160721adb20f25c0e8dccb108
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 13:36:00 2017 +0200

    nimble/monitor: Make UART device configurable in syscfg
    
    X-Original-Commit: 9a6071d1507f512ff3ae64d40ae17db0da99845d

 nimble/host/src/ble_monitor.c | 4 ++--
 nimble/host/syscfg.yml        | 3 +++
 2 files changed, 5 insertions(+), 2 deletions(-)

commit 31b573029386f7f4d9acb0ec0590369972d0e21e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 13:35:31 2017 +0200

    nimble/monitor: Fix coding style
    
    X-Original-Commit: 03e6119c882d4d48351cfe45e34ee954f3a6d841

 nimble/host/src/ble_monitor.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e0e59399f615d4864050952b62df1be84df04959
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 11 13:35:09 2017 +0200

    nimble/monitor: Add delay in UART queue flush
    
    This is to be sure we do not starve other tasks.
    
    X-Original-Commit: 65c9cfde89a0f789199c09cbb432a7e9c0c1eac4

 nimble/host/src/ble_monitor.c | 3 +++
 1 file changed, 3 insertions(+)

commit bbcd2a4031839cc34ba0737c6412e3f26972a89d
Merge: db2c2aae 10e524c2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jul 10 11:55:58 2017 +0200

    Merge branch 'master' into bluetooth5_master
    
    Conflicts:
            hw/bsp/bbc_microbit/syscfg.yml
            net/nimble/transport/socket/syscfg.yml
    
    X-Original-Commit: 5a4fa1202415c3705f477a80114ae1217e94c120

commit 10e524c29bf7afc9427fc35752af908f4f8a9b57
Merge: 5e1bc546 970a199b
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Jul 7 16:22:43 2017 -0700

    Merge pull request #380 from ccollins476ad/ble-store-clear
    
    MYNEWT-268 BLE Host - enable factory reset
    
    X-Original-Commit: a95eab0c2a38aac90a8956e80551268db52a3aef

commit 5e1bc546c40c47f5ff7ebf8529f71c788c48595c
Merge: 5d3ce87a 8d96286f
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Jul 7 16:22:29 2017 -0700

    Merge pull request #363 from ccollins476ad/testutil-init
    
    testutil - Remove init boilerplate
    
    X-Original-Commit: 7fa825fdcba998883525b98b082052aec910ddc6

commit 5d3ce87a75b3e4627411c52e3d776e351425dd7f
Merge: 13467bca 07651bd3
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Jul 7 16:21:03 2017 -0700

    Merge pull request #384 from ccollins476ad/ble-hci-task
    
    Give HCI socket transport its own task.
    
    X-Original-Commit: 2fe6801a6e8aef58dc300f39ffcb6b0b2f598b71

commit 13467bca4a87620986e75cc2c3eb3611e189f99a
Merge: 4a44a7e8 2872354f
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Jul 7 11:12:49 2017 -0700

    Merge pull request #370 from ccollins476ad/key-dist-0
    
    BLE Host - Don't persist security material if either key distribution field is 0
    
    X-Original-Commit: 8f499dd073e11ceb749650a561b52421e318b470

commit db2c2aae9029f2cf50a1117e8cb6a33ded0724ac
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Jul 7 17:04:06 2017 +0200

    nimble/controller: fix null pointer dereference
    
    X-Original-Commit: 8052a2202d5672b6aebd4a760e6253732262ac05

 nimble/controller/src/ble_ll_scan.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 4246f6c0c8b9397850ea960bfdb9a74d08113e0c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 7 14:19:09 2017 +0200

    nimble/controller: Fix build error with ext adv disabled
    
    X-Original-Commit: 9275d9abb69236f192322b537df74de243c4204c

 nimble/controller/src/ble_ll_conn_hci.c | 3 +++
 1 file changed, 3 insertions(+)

commit 8efd7e9f3c9335001a3a969b2d355dff924feab6
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 7 11:25:45 2017 +0200

    nimble/controller: Minor doxygen fixes
    
    X-Original-Commit: cd144cec1d6596544bd37442cde3f5eceef6218e

 nimble/controller/src/ble_ll_conn.c | 2 ++
 nimble/controller/src/ble_ll_scan.c | 3 ++-
 2 files changed, 4 insertions(+), 1 deletion(-)

commit fa39a9e950d0354faf980c8586a57e6541867335
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 7 11:24:17 2017 +0200

    nimble/controller/nrf51: Fix configuration for privacy in BT5
    
    Fix configuration for AAR resolving rpa when extended advertising is
    used.
    
    X-Original-Commit: 8c58c3a2d9eb4b271ffc89f942125845d9a2bfb2

 nimble/drivers/nrf51/src/ble_phy.c | 17 ++++++++++++++++-
 1 file changed, 16 insertions(+), 1 deletion(-)

commit d1860ba467924bda30e91619c31f869ee60d22f9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 7 11:14:15 2017 +0200

    nimble/controller: Fix AAR usage for extended advertising
    
    This fix nrf52 configuration for handling resolving rpa from
    extended advertising packets
    
    X-Original-Commit: af41b0e461aadfb56810726ce8023d0358a27da4

 nimble/controller/src/ble_ll_conn.c |  1 +
 nimble/controller/src/ble_ll_scan.c |  8 ++++++--
 nimble/drivers/nrf52/src/ble_phy.c  | 18 +++++++++++++++++-
 nimble/include/nimble/ble.h         |  4 ++++
 4 files changed, 28 insertions(+), 3 deletions(-)

commit ba00a13d82d37c2408b4c9bcf943d0b0ce99bb89
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 7 11:02:44 2017 +0200

    nimble/controller: Create ble_ll_init_rx_isr_start
    
    Just to keep consistency and because some more code will go there in
    next patch
    
    X-Original-Commit: accbcc9a5db7e3649afe1a6c086115fbd90f1197

 nimble/controller/src/ble_ll.c           | 17 +-------------
 nimble/controller/src/ble_ll_conn.c      | 40 ++++++++++++++++++++++++++++++++
 nimble/controller/src/ble_ll_conn_priv.h |  1 +
 3 files changed, 42 insertions(+), 16 deletions(-)

commit dd272593696d8514d6c1b51ef14eda82415b3ed1
Merge: 3b9ca6bd fceb860c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 7 13:17:02 2017 +0200

    Merge pull request #387 from rymanluk/bt5_fix
    
    nimble/controller: Improve validation on extended connect
    
    X-Original-Commit: daea5235989d70f9685007c445511960ecf390df

commit fceb860cceeebed35845d2ff347b74e5110f6dd2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jul 7 12:35:01 2017 +0200

    nimble/controller: Improve validation on extended connect command
    
    X-Original-Commit: a0b2e5c3a188794c4889dcf432d17d1c02adcd40

 nimble/controller/src/ble_ll_conn_hci.c | 32 +++++++++++++++++++-------------
 1 file changed, 19 insertions(+), 13 deletions(-)

commit 3b9ca6bda7d59e5da67c6e4aec8bcd5ea7336cb2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jul 7 11:12:30 2017 +0200

    nimble/controller: Disable LL logs
    
    Seems like this was enabled some time ago by mistake and consumed
    4K of RAM for no reason.
    
    X-Original-Commit: ee5f15a43c8fc5c2ecea97a909d4de594c99503a

 nimble/controller/include/controller/ble_ll.h | 5 -----
 1 file changed, 5 deletions(-)

commit 07651bd3d5a2bfa21aed274cc30ef0aba8e649cb
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 6 16:24:18 2017 -0700

    Give HCI socket transport its own task.
    
    This prevents deadlock while the host waits for a command-complete event
    from the controller.
    
    X-Original-Commit: 06551943b9aca46e39e4df20dd34575737ddb9e5

 nimble/transport/socket/src/ble_hci_socket.c | 37 ++++++++++++++++++++++------
 nimble/transport/socket/syscfg.yml           |  7 ++++++
 2 files changed, 37 insertions(+), 7 deletions(-)

commit 14215cfb17d2a8303fd63b0c22e252b96ab0f351
Merge: df46ec91 4852591d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jul 7 00:39:51 2017 +0200

    Merge pull request #382 from sjanc/bluetooth5_master
    
    merge master in bluetooth5 branch
    
    X-Original-Commit: cc32aee1d91aee90caa1b56c862ed441e13ef5c0

commit df46ec91ff10f7722dc254f586496191c190c8e5
Merge: 55b4e1cd 9102eafd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jul 7 00:38:53 2017 +0200

    Merge pull request #379 from sjanc/bt5_ext_adv
    
    Some improvements for Extended Advertiser
    
    X-Original-Commit: fe6ff6dec17e3a8ce4ca0b419b8a0bc09a82139c

commit 4a44a7e8498454e02ce42135b50dc77c1dfdab7d
Merge: 5ba4329f dfbbc364
Author: mkiiskila <marko@runtime.io>
Date:   Thu Jul 6 13:44:08 2017 -0700

    Merge pull request #371 from bgiori/remove_lls
    
    remove misplaced duplicate of link lost service
    
    X-Original-Commit: ab7d6fb5c47b86ec305d0bea2a2988a7f0f98bf4

commit 4852591dae64f7d3901f5517d30c8cbc49d98ab2
Merge: 55b4e1cd 5ba4329f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 6 20:30:13 2017 +0200

    Merge branch 'master' into bluetooth5_master
    
    X-Original-Commit: a8a2bc470305c47b23b02169068627fde9796051

commit 55b4e1cd2e37b865e669b62d9786ae9c4391bf91
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 6 15:08:57 2017 +0200

    nimble/controller: Fix window delay for PHY 2M
    
    It shall be 2.5ms same as for PHY 1M.
    
    X-Original-Commit: 041ffc4a8cc103b835b3592e3f24cf599c75f6c0

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 62aec609694663c56b3f4afeec5a715cef796dbf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 6 14:29:36 2017 +0200

    nimble/controller: Improve handling hci create connection command
    
    According to Bluetooth 5.0 spec Vol 2, Part E, 7.8.66, when connection
    is done on PHY not specified in the initiating PHY, controller shall use
    connection parameters specified by PHY which is set.
    
    X-Original-Commit: e4436cb2811168fa126cf477cc32c4d3de3cc2b5

 nimble/controller/src/ble_ll_conn_hci.c | 35 +++++++++++++++++++++++++++++++++
 1 file changed, 35 insertions(+)

commit 84c5863ef6ff34f43b752d82a92f690b40405b08
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jul 6 13:09:31 2017 +0200

    nimble/controller: Fix for regression in extended connect
    
    This is related to changes aroung ble_ll_scan_get_aux_data()
    
    X-Original-Commit: 8dcaa544a816be500768ec770fc08c61b97919a3

 nimble/controller/src/ble_ll_conn.c | 26 +++++++++++++-------------
 1 file changed, 13 insertions(+), 13 deletions(-)

commit 8ce9597014f8020096d7617ed0e96c73e907b8fd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 14:07:52 2017 +0200

    nimble/controller: Remove not needed flag from header
    
    X-Original-Commit: 08b3ee6cd0f893a2e6ae38bc4c979a2fead0334c

 nimble/controller/src/ble_ll_scan.c | 2 --
 nimble/include/nimble/ble.h         | 3 +--
 2 files changed, 1 insertion(+), 4 deletions(-)

commit 3b123a8c20778c8ac85156b7009f4f659a1a5115
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 14:07:17 2017 +0200

    nimble/controller: Support ext scanner for chain aux ptr
    
    X-Original-Commit: c69370a564a7e47cba482788fa1bf531817b9acd

 nimble/controller/include/controller/ble_ll.h      |  2 +
 nimble/controller/include/controller/ble_ll_scan.h |  8 ++
 nimble/controller/src/ble_ll.c                     |  2 +
 nimble/controller/src/ble_ll_scan.c                | 90 ++++++++++++++++------
 4 files changed, 80 insertions(+), 22 deletions(-)

commit 4a00779f4fb46f96777accc659b35444f9ca08c0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 13:24:30 2017 +0200

    nimble/controller: Add stats for aux scan req/rsp
    
    X-Original-Commit: 5d61e3833c5db8dac1035da25fd649ed4a05d01e

 nimble/controller/include/controller/ble_ll.h | 2 ++
 nimble/controller/src/ble_ll.c                | 2 ++
 nimble/controller/src/ble_ll_scan.c           | 3 +++
 3 files changed, 7 insertions(+)

commit 71fd58aefbc26c5be3e412ea9b5168c1916e8d14
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 12:25:27 2017 +0200

    nimble/controller: Improve handling aux scan response
    
    With this patch we make sure that scan response has correct
    primary and secondary phy information
    
    X-Original-Commit: b34d350be71c72dabd8d87dc7e7638103b1f1ffa

 nimble/controller/src/ble_ll_scan.c | 32 ++++++++++++++++++++++++++++++--
 1 file changed, 30 insertions(+), 2 deletions(-)

commit 53b56b15e892fdd2146131f2f0fb7924ca372f5d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 12:15:19 2017 +0200

    nimble/controller: Make sure auxiliary offset is good enough
    
    According to Bluetooth 5 specification, there should at minimum T_MAFS
    between ADV_EXT_IND and AUX_ADV_IND
    
    X-Original-Commit: edb84be13af5575974725f04f7791718b498c295

 nimble/controller/src/ble_ll_scan.c | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit b93172081dc96e91d6f756eeb546361dc3870440
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 12:08:55 2017 +0200

    nimble/controller: Minor fix for correct define usage
    
    X-Original-Commit: b6635a70c37943bb26ad5758514201083d59dc1e

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c5206743c5a44ec20f2584ef718959785f9a7963
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 08:03:34 2017 +0200

    nimble/controller: Fix BLE_LL_MAX_EVT_LEN
    
    Make dependency to to MYNEWT_VAL_BLE_HCI_EVT_BUF_SIZE
    
    X-Original-Commit: b8d82a7eb3f48f0b2a20c6117dfd4e9eb5feb45e

 nimble/controller/include/controller/ble_ll_hci.h | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 5c8a37b965f390604db96459b83c2816b28a7bff
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 27 11:36:29 2017 +0200

    nimble/controller: Add MYNEWT_VAL BLE_LL_EXT_ADV_AUX_PTR_CNT
    
    This flag is used to configure max number of scheduled outstanding
    auxiliary packets
    
    X-Original-Commit: a6b85cc6e3583ecc56514fa9f583c3d02ef979da

 nimble/controller/src/ble_ll_scan.c | 8 +++-----
 nimble/controller/syscfg.yml        | 7 +++++++
 2 files changed, 10 insertions(+), 5 deletions(-)

commit 7bb2827b056b6d25f4ac718f7f7dedd674e0f4d8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Jul 5 07:09:31 2017 +0200

    nimble/transport: Add support fot extended advertising
    
    Payload for extended advertising can be up to 255 bytes however maximum
    extended advertising event controllers sends to the host might have up
    to 274
    
    X-Original-Commit: 2d8a77d92b0565badbe15db162f24f6a1e68791b

 nimble/transport/ram/syscfg.yml    | 3 +++
 nimble/transport/socket/syscfg.yml | 2 ++
 nimble/transport/uart/syscfg.yml   | 3 +++
 3 files changed, 8 insertions(+)

commit 03c4084eea1cd04af44f449199a613fe4f422231
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jul 6 10:08:04 2017 +0200

    nimble/test: Update unittests after features exchange changes
    
    After connection complete event host will read peers features and then
    will use this information when selecting procedure for connection
    parameters update. Both changes requires unittests to be updated:
    - phony ack is added for complete event since it will send extra HCI
      command if connection is successful
    - features event is injected to set features properly
    - connection update failover from HCI to L2CAP is removed since this
      is selected based on features
    
    X-Original-Commit: d4e2081c764d1cced4b61b8c03f8f52c5e76f418

 nimble/host/test/src/ble_gap_test.c     | 98 +++++++++++----------------------
 nimble/host/test/src/ble_hs_conn_test.c | 12 ++++
 nimble/host/test/src/ble_hs_test_util.c | 38 ++++++++++++-
 nimble/host/test/src/ble_hs_test_util.h |  7 +++
 nimble/host/test/src/ble_os_test.c      | 10 ++++
 nimble/host/test/src/ble_sm_test_util.c |  6 +-
 6 files changed, 101 insertions(+), 70 deletions(-)

commit 5ba4329f43cc8a82bc3797c33d732f0500e841a7
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 5 19:14:30 2017 -0700

    BLE Host - Remove BLE_EDDYSTONE syscfg setting.
    
    This syscfg setting is unnecessary, as none of the eddystone code gets
    included in the final build if it isn't referenced.
    
    X-Original-Commit: b156b1f01288557cb6cdfc8642ce2d179ea420f8

 nimble/host/include/host/ble_hs.h | 1 +
 nimble/host/src/ble_eddystone.c   | 8 --------
 nimble/host/syscfg.yml            | 6 ------
 3 files changed, 1 insertion(+), 14 deletions(-)

commit 2872354fd3ae8a04b6156400bf9fdc62b7ad0372
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 30 16:57:14 2017 -0700

    MYNEWT-749 BLE Host - Don't persist if keydist==0
    
    In legacy mode, if either peer indicates a key distribution flags value
    of 0, then don't persist security material when pairing completes.
    
    It isn't clear from the spec what should happen when both peers indicate
    bonding support, but one indicates a 0 key distribution field.  I think
    proceding with pairing and just not persisting makes the most sense.
    This is also what Lightblue (or CoreBluetooth, I guess) seems to do.
    
    X-Original-Commit: e3bc451f80adbaaa50d6851effa7ff6bafbb19d2

 nimble/host/src/ble_sm.c | 19 ++++++++++++++-----
 1 file changed, 14 insertions(+), 5 deletions(-)

commit 970a199b60a9cb4e1f9b63407555c129ca63e1b8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 5 15:47:33 2017 -0700

    MYNEWT-268 BLE Host - enable factory reset
    
    This commit adds a new function to the host API:
    
        /**
         * Deletes all objects from the BLE host store.
         *
         * @return                      0 on success; nonzero on failure.
         */
        int
        ble_store_clear(void)
    
    This function can be used to effect a factory reset.
    
    X-Original-Commit: 584616581cf74efaad67db27fcbbb2ff1823c677

 nimble/host/include/host/ble_store.h  |  2 +
 nimble/host/src/ble_store.c           | 37 ++++++++++++++++
 nimble/host/test/src/ble_store_test.c | 83 +++++++++++++++++++++++++++++++++++
 3 files changed, 122 insertions(+)

commit 9102eafd97910a88d4ae59a9508554dc3ffb97ea
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jul 6 00:04:38 2017 +0200

    nimble/controller: Fix calculating ext advertising PDUs TX time
    
    We need to acount for any PDUs that may be received or send in result
    of advertising PDUs. This also needs to account for different PHYs.
    
    X-Original-Commit: 6c65980e0e6aab88d72e36ca6b362a1e83d485ca

 nimble/controller/src/ble_ll_adv.c | 46 +++++++++++++++++++++++++++++++++-----
 1 file changed, 40 insertions(+), 6 deletions(-)

commit 641715f0a833209ad7d7dbd48820ea4e939becd5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jul 5 23:42:21 2017 +0200

    nimble/controller: Fix calculating AUX_ADV_IND start time
    
    We need to account for number of primary advertising channels used.
    
    X-Original-Commit: 1ed0e0c29dc2cd56c1c6e7218e28335aa805dbc8

 nimble/controller/src/ble_ll_adv.c | 1 +
 1 file changed, 1 insertion(+)

commit 6284f5c22c6747dfbaaf0f6f49426b6f9a68e293
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jul 5 11:15:06 2017 +0200

    nimble/controller: Allow to use larger advertising data
    
    Extended advertising supports to use up to 1650 bytes of advertising
    data or scan response data in single PDU. This patch allows to
    configure it. Currently this is limited to 238 bytes as chaining
    (fragmentation) support is not present yet.
    
    X-Original-Commit: 4cb230ac5c9771a7d9a1dd5ad202bcaea6a56384

 nimble/controller/include/controller/ble_ll_adv.h  | 10 ++++++++--
 nimble/controller/include/controller/ble_ll_scan.h |  7 ++++---
 nimble/controller/src/ble_ll_adv.c                 | 18 +++++++++---------
 nimble/controller/src/ble_ll_scan.c                |  2 +-
 nimble/syscfg.yml                                  |  6 ++++++
 5 files changed, 28 insertions(+), 15 deletions(-)

commit 2919576d2347bdef9eb8918db922a4603f3c5729
Merge: 023a95fd eea3d0a6
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jul 5 23:33:16 2017 +0200

    Merge pull request #375 from andrzej-kaczmarek/bt5-featexch
    
    Nimble: improvements on controller/peer features handling
    
    X-Original-Commit: 087e80189a8b52018ecba2d5aa81b40fcbb5fc14

commit eea3d0a67a3e1ab070a1506dc87578f577785371
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 4 14:33:32 2017 +0200

    nimble/host: Do not enable unnecessary events from controller
    
    We only need few events enabled from controller since we're LE-only
    stack - no need to enable almost all of them.
    
    X-Original-Commit: 9654153e6daeaeb62999e3cdc6f4ca6df850cf19

 nimble/host/src/ble_hs_startup.c | 36 +-----------------------------------
 1 file changed, 1 insertion(+), 35 deletions(-)

commit 11f1689685a6979b3f4489bdd6e3f20312c31c4b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jul 5 11:03:58 2017 +0200

    nimble/controller: Remove callout for HCI Read Remote Features event
    
    We don't need this callout - it's enough that we wait until end of conn
    event and send an event from there.
    
    X-Original-Commit: 75ba1ad07189835a309a8b71c44d2f34278ef33c

 nimble/controller/include/controller/ble_ll_conn.h |  2 --
 nimble/controller/src/ble_ll_conn.c                | 29 ++++++++++++++++------
 nimble/controller/src/ble_ll_conn_hci.c            |  2 --
 3 files changed, 22 insertions(+), 11 deletions(-)

commit 0c51139e4394c92c70dcb7ba2a782351d98ff08d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 4 11:54:10 2017 +0200

    nimble/controller: Update supported HCI commands mask
    
    X-Original-Commit: 3605631b8c22cda30224856169af480e1f5e0878

 nimble/controller/include/controller/ble_ll_hci.h |   2 +-
 nimble/controller/src/ble_ll_supp_cmd.c           | 186 +++++++++++++++++++++-
 2 files changed, 183 insertions(+), 5 deletions(-)

commit 023a95fd4eabedcbebcb86464fd44ca5f50ff218
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 4 11:39:43 2017 +0200

    nimble/controller: Remove reduntant checks for OS_CPUTIME_FREQ
    
    X-Original-Commit: a61d57e87d09255a8f705badaf6e6032ea570c8c

 nimble/controller/include/controller/ble_ll.h | 4 ----
 nimble/controller/src/ble_ll_conn.c           | 2 --
 nimble/controller/src/ble_ll_sched.c          | 3 ---
 3 files changed, 9 deletions(-)

commit 7c77f174ec78eb32a6a96cc71cf51ce970c25110
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jul 4 11:35:07 2017 +0200

    nimble/controller: Fix for missing scansm pointer in connsm
    
    This fix issue with creating legacy connection when BLE_EXT_ADV is on.
    
    X-Original-Commit: 0faccea4d62ddbc7f72e4f72c58765cd40d04e5f

 nimble/controller/include/controller/ble_ll_scan.h |  3 ++-
 nimble/controller/src/ble_ll_conn_hci.c            |  2 +-
 nimble/controller/src/ble_ll_scan.c                | 20 ++++++++++++++++++--
 3 files changed, 21 insertions(+), 4 deletions(-)

commit ef7803a1d7634003c8d0e427967daa2e1643fc66
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 3 12:17:09 2017 +0200

    nimble/controller: Initiate data length update if remote supports it
    
    We initiate data length update procedure as soon as we receive features
    from remote and know that this is supported on connection.
    
    This fixes issue with some crippled controllers which do not indicate
    DLE support but will reply with LL_LENGTH_RSP but with broken payload
    (e.g. the one in Sony Xperia Z5). This would result in LL timeout since
    we properly ignore broken PDU.
    
    X-Original-Commit: 456682623f454710824ad97213ab7576ddeca4e9

 nimble/controller/src/ble_ll_ctrl.c | 35 +++++++++++++++++++++++++++++++----
 1 file changed, 31 insertions(+), 4 deletions(-)

commit c2f06e654bdb9614117c14c312a04d15921760be
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 3 16:22:47 2017 +0200

    nimble/controller: Refactor remote features handling
    
    This patch changes the way we handle features exchange in controller.
    
    On new connection, the controller will automatically initiate features
    exchange and store complete features mask. This makes used features
    available immediately after connection.
    
    Also we cache remote's features so the LE Read Remote Supported Features
    command does not initiate features exchange procedure at any time and
    will always return cached data.
    
    Initial Data Length Update procedure is removed as it should be now
    started after features exchange is completed - this will be added soon.
    
    X-Original-Commit: c5177bd24239ae17ea260ccce459c70697205e9a

 nimble/controller/include/controller/ble_ll_conn.h |  4 ++
 nimble/controller/src/ble_ll_conn.c                | 43 +++++++++++++++-------
 nimble/controller/src/ble_ll_conn_hci.c            | 13 +++----
 nimble/controller/src/ble_ll_conn_priv.h           |  1 +
 nimble/controller/src/ble_ll_ctrl.c                | 17 ++++++++-
 5 files changed, 56 insertions(+), 22 deletions(-)

commit ccae5412a1eabd168c304387fb6caea765befaab
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jul 3 16:11:50 2017 +0200

    nimble/controller: Fix features handling
    
    Octets 2-8 in LL_FEATURE_REQ and LL_FEATURE_RSP shall be always set to
    features supported by controller which sends PDU. Only 1st octet shall
    be set to features supported by both controllers.
    
    This patch renames "common_features" to "conn_features" to indicate
    that this stores features used on connection (as called by spec) and
    introduces new "remote_features" which caches remaining 7 octets of
    remote features so we can properly reply on LL and HCI.
    
    X-Original-Commit: b661780a48470bbd10fcef833c81240bf5bc6487

 nimble/controller/include/controller/ble_ll_conn.h |  3 ++-
 nimble/controller/src/ble_ll_conn.c                |  3 ++-
 nimble/controller/src/ble_ll_conn_hci.c            |  2 +-
 nimble/controller/src/ble_ll_ctrl.c                | 27 +++++++++++++++-------
 nimble/controller/src/ble_ll_hci_ev.c              |  3 ++-
 5 files changed, 26 insertions(+), 12 deletions(-)

commit 54ded8ea2e32c99f648c1fb11890d0c513d36d2d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 2 13:47:28 2017 +0200

    nimble/controller: Enable Connection Parameters Request procedure
    
    We support it so there is no reason to have it disabled.
    
    X-Original-Commit: dc44ca021a0fb6755bcdd7987d880a427ff465f2

 nimble/controller/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 94bf0464846fc1105ab4edcd11437f799632a55a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 18:33:04 2017 +0200

    nimble/controller: Fix LE Connection Update status code in slave role
    
    LE Connection Update called on slave when both sides do not support
    Connection Parameters Request procedure should return "command
    disallowed" error code. The "unknown HCI command" suggests that this
    command is not supported at all which is not correct.
    
    X-Original-Commit: ca655b536be7178557f7925622fe6bc29ce4808d

 nimble/controller/src/ble_ll_conn_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d3024b70570c709d8ebef7c5340fd3b96f7d0237
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 19:55:42 2017 +0200

    nimble/host: Use features to check parameters update procedure
    
    We can check features used on connection to figure out what is the
    proper proceduer to update connection parameters (LL or L2CAP).
    
    Checking for specific error code from LE Connection Update is not really
    reliable and works probably only with Nimble controller which uses this
    specific error code.
    
    X-Original-Commit: 683ed916cb447ce56b687d20aa58076ec3771e35

 nimble/host/src/ble_gap.c | 36 ++++++++++++++++++------------------
 1 file changed, 18 insertions(+), 18 deletions(-)

commit b29268d25b4a8f90d83cd4aa74179bbcd87c3a04
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 26 00:05:44 2017 +0200

    nimble/host: Store peer supported features
    
    X-Original-Commit: 8a9141f6c9c3c71d6700c1ea2b4ad963b9876873

 nimble/host/src/ble_gap.c          | 41 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_gap_priv.h     |  1 +
 nimble/host/src/ble_hs_conn_priv.h |  2 ++
 nimble/host/src/ble_hs_hci_cmd.c   | 22 ++++++++++++++++++++
 nimble/host/src/ble_hs_hci_evt.c   | 23 +++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  |  3 +++
 nimble/include/nimble/hci_common.h |  9 +++++++++
 7 files changed, 101 insertions(+)

commit 3c7c4f6b3468b6fbe31c8921447cd2aa4df865ff
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 19:54:09 2017 +0200

    nimble/host: Store local controller supported features
    
    X-Original-Commit: f01074c4d664441c01313d5e1a26323ea7a45e30

 nimble/host/include/host/ble_hs_hci.h |  2 ++
 nimble/host/src/ble_hs_hci.c          | 13 +++++++++++++
 nimble/host/src/ble_hs_hci_priv.h     | 21 +++++++++++++++++++++
 nimble/host/src/ble_hs_startup.c      |  6 +++++-
 4 files changed, 41 insertions(+), 1 deletion(-)

commit 89055ff346235f2e797558c64d2d66df2335f6e9
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jul 4 09:27:16 2017 +0200

    nimble/controller: Remove phy_data from non-phy builds
    
    phy_data is only initialized when PHY support is enabled so we can
    remove it from non-phy builds to save some RAM.
    
    This also fixes regression where phy_data was used without proper
    initialization when PHY support was disabled.
    
    X-Original-Commit: e4f3dfb767d29dbba5cc0b786388500d05d292b0

 nimble/controller/include/controller/ble_ll_conn.h |  3 ++-
 nimble/controller/src/ble_ll_conn.c                | 11 +++++++++++
 2 files changed, 13 insertions(+), 1 deletion(-)

commit 5ea6f0e93e1621de28b1659847373bd1a63f7fa5
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jul 3 15:23:46 2017 +0200

    nimble/controller: Fix set adv enable hci cmd processing
    
    X-Original-Commit: 1371f0ee20915c659aacd0ecc26d2d6d22857ab5

 nimble/controller/src/ble_ll_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6f28fee08cad49f3afe51ef1ec87cc0be8961436
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 13 14:05:32 2017 +0200

    nimble: Disable HCI logs when monitor is enabled
    
    This patch will disable any debug logs with HCI traces if monitor
    interface is enabled - these are redundant since complete HCI traffic
    is available via monitor.
    
    X-Original-Commit: 7d25b5608aa23a03dee62fd19ab940ed3b764b6b

 nimble/host/src/ble_hs_dbg.c     | 3 ++-
 nimble/host/src/ble_hs_hci.c     | 5 +++++
 nimble/host/src/ble_hs_hci_cmd.c | 4 ++++
 nimble/host/src/ble_hs_hci_evt.c | 3 +++
 nimble/host/src/ble_hs_priv.h    | 3 ++-
 nimble/host/src/ble_l2cap_sig.c  | 6 ++++++
 6 files changed, 22 insertions(+), 2 deletions(-)

commit 0d3b490d4ea7d71daa77ba71212486a99b8dc4f0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 20 17:49:58 2017 +0200

    nimble/monitor: Add intermediate buffer option for RTT
    
    With RTT enabled, packets are written directly to RTT buffer in chunks
    which means we need to ensure all data are written to RTT properly.
    The disadvantage here is that if there is no reader connected, monitor
    will block as soon as it filled RTT buffer (which is basically almost
    immediately after startup).
    
    This patch adds option for intermediate buffer on RTT (enabled by
    default) where chunks are buffered and then complete packet is written
    directly to RTT. The advantage here is that we can just skip complete
    packet if there is no free space in RTT buffer, but we need a bit of
    extra memory for the intermediate buffer and do extra copy.
    
    X-Original-Commit: e54736da69c7e9f51d78b280e185bb7f3190544d

 nimble/host/src/ble_monitor.c | 34 ++++++++++++++++++++++++++++++++++
 nimble/host/syscfg.yml        |  8 ++++++++
 2 files changed, 42 insertions(+)

commit f9ceee4477f2c9596a1e2dbf67711cebf8401e90
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 12 17:02:10 2017 +0200

    nimble/monitor: Add call to output text via monitor interface
    
    X-Original-Commit: 43076e62d6623f31adef9356d9cce633d2c6d718

 nimble/host/include/host/ble_monitor.h |  2 ++
 nimble/host/src/ble_monitor.c          | 19 +++++++++++++++++++
 2 files changed, 21 insertions(+)

commit 9eb124b7576a8c008c63dbc3e391ffc2406539a7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 11 17:53:48 2017 +0200

    nimble/monitor: Add call to log via monitor interface
    
    X-Original-Commit: 72f911c6119ff0e96c9b46fe4d27ff515e845e5f

 nimble/host/include/host/ble_monitor.h |  2 +-
 nimble/host/src/ble_monitor.c          | 68 ++++++++++++++++++++++++++++++++++
 2 files changed, 69 insertions(+), 1 deletion(-)

commit 78232da3dfe79097125a212fe2dbf844948cb4c0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 4 09:23:44 2017 +0200

    nimble/monitor: Add monitor interface over RTT
    
    This patch makes monitor interface accessible over RTT. There is
    separate upstream buffer called 'monitor' created for monitor traffic.
    
    X-Original-Commit: 658bbc43cde099fa368de91dd107c1e6330e0cbd

 nimble/host/include/host/ble_monitor.h |  2 +-
 nimble/host/pkg.yml                    |  3 +++
 nimble/host/src/ble_monitor.c          | 36 ++++++++++++++++++++++++++++++++++
 nimble/host/syscfg.yml                 |  3 +++
 4 files changed, 43 insertions(+), 1 deletion(-)

commit 9b5c46ca157650e557df7ed7f44311e3959c4bdb
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Apr 3 17:57:10 2017 +0200

    nimble/monitor: Add monitor interface over UART
    
    This patch implements monitor protocol defined by BlueZ [1] to allow
    real-time capture of HCI traffic and other debugging information from
    Nimble stack.
    
    Features included in this patch:
    - logging over UART
    - HCI traffic only
    
    [1] https://git.kernel.org/pub/scm/bluetooth/bluez.git/tree/doc/btsnoop.txt
    
    X-Original-Commit: 7c2c8c47d4b99831860bd0d709476717d9f6dce4

 nimble/host/include/host/ble_monitor.h |  38 ++++++
 nimble/host/src/ble_hs.c               |  23 ++++
 nimble/host/src/ble_hs_hci.c           |   7 ++
 nimble/host/src/ble_hs_hci_cmd.c       |   6 +
 nimble/host/src/ble_monitor.c          | 210 +++++++++++++++++++++++++++++++++
 nimble/host/src/ble_monitor_priv.h     |  87 ++++++++++++++
 nimble/host/syscfg.yml                 |   8 ++
 7 files changed, 379 insertions(+)

commit 7134ac5735aa67bd855122dacf53a76a788b3fe8
Merge: c6190cb4 3500995b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jul 3 08:54:01 2017 +0200

    Merge pull request #367 from rymanluk/bt5_scanner
    
    nimble: Couple of fixes and improvements to bluetooth 5
    
    X-Original-Commit: 3953acb90a20d145245e7c3466757f72e898bd10

commit dfbbc3641d2518110b870c701b53dbe91291ae3f
Author: Brian Giori <bgiori@users.noreply.github.com>
Date:   Sat Jul 1 09:39:19 2017 -0700

    remove misplaced duplicate of link lost service
    
    X-Original-Commit: 0c47c277c400a02f28102b4c4a12d044c9939522

 .../lls/include/profiles/lls/ble_svc_lls.h         |  52 ------
 nimble/host/profiles/lls/pkg.yml                   |  31 ----
 nimble/host/profiles/lls/src/ble_svc_lls.c         | 201 ---------------------
 3 files changed, 284 deletions(-)

commit c6190cb44abf545d710260b887cc776f7e0d0778
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 14:46:28 2017 +0200

    nimble/controller: For Bluetooth5 disable HW whitelist
    
    Nrf52 does not support HW for extended advertising reports
    Therefore disable it when BLE_EXT_ADV is set
    
    X-Original-Commit: b72390536cf2f4e6cb2f35250689fa0287126a78

 nimble/controller/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8423c0ee462fa875369d61fcc59802a4efa894c3
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 14:45:46 2017 +0200

    nimble/controller: Add MYNEWT_VAL to enable/disable HW whitelist
    
    X-Original-Commit: 5d68786a16aeadc268a24de86f71aa60377460f0

 nimble/controller/include/controller/ble_hw.h | 4 +++-
 nimble/controller/syscfg.yml                  | 5 +++++
 2 files changed, 8 insertions(+), 1 deletion(-)

commit 3500995b8fb81c52ae6d2d117489fbd98eb0ef05
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 13:11:25 2017 +0200

    nimble/hci: Fix mapping legacy event types
    
    X-Original-Commit: 1ad12faae71d5b32d2dfa3721f997eba57a511c2

 nimble/host/src/ble_hs_hci_evt.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 56bc5d295ba1dcc08ac9ad5bf93efe2479fa90aa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 13:14:33 2017 +0200

    nimble/controller: Ignore scan rsp which is not an answer on scan req
    
    According to spec in active scan we should listend for advertising pdu's
    and when doing scan request we should listen for scan rsp. Otherwise we
    should not care about scan rsp.
    
    One of the issue due to this is following scenario:
    * user put device a into white list
    * user enable active scan with white list
    
    result:
    If more devices around, user got notification on scan response from
    devices not in the wl
    
    X-Original-Commit: 2a36552518a790614c1951f13fe8f663bad5e9e0

 nimble/controller/src/ble_ll_scan.c | 3 +++
 1 file changed, 3 insertions(+)

commit f04dda4a9f698b9ddd88941a3423704004959072
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 13:12:26 2017 +0200

    nimble/controller: Add default values to extended advertising event
    
    This patch sets sid and address type to default values which should be
    used when DID or ADDR is not present in ext adv pdu
    
    X-Original-Commit: a1552cb1019295ec06a29f6fa757ce5f6102ea70

 nimble/controller/src/ble_ll_scan.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 4cd204227f24d5a2e28623b4a7c9fd346f6dd7bb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jun 29 16:10:45 2017 +0200

    nimble/controller: Add support for whitelist and privacy for extended adv
    
    X-Original-Commit: e26a41bc9f899cc70e55a05bce06ea377a6ce2e9

 nimble/controller/include/controller/ble_ll_scan.h |   3 +-
 nimble/controller/src/ble_ll_conn.c                |   5 +-
 nimble/controller/src/ble_ll_scan.c                | 139 +++++++++++----------
 nimble/include/nimble/ble.h                        |   3 +
 4 files changed, 81 insertions(+), 69 deletions(-)

commit c319cafc680f2e4ea4fd290fb55aff3865f60cab
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 27 12:24:05 2017 +0200

    nimble/controller: Fix handling scan req during extended scan
    
    This patch gixes sending of scan_req packet.
    
    It also improves it in the way, that:
    * code makes sure that scan_req has always time to complete.
        i.e will not be interruped by scheduled aux_scan.
    * scan_req has higier prio than aux_scan
    
    X-Original-Commit: e7880a92c81886d8dea89799593bfca678f4a9ff

 .../controller/include/controller/ble_ll_sched.h   |  2 +-
 nimble/controller/src/ble_ll_scan.c                | 49 ++++++-----------
 nimble/controller/src/ble_ll_sched.c               | 61 ++++++++++++++++------
 nimble/include/nimble/ble.h                        |  3 ++
 4 files changed, 65 insertions(+), 50 deletions(-)

commit 7b7d06fa7687cb1a5b18f1aab95512880c0982e1
Merge: 7c79cdff 837cb1c3
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 11:49:58 2017 +0200

    Merge pull request #364 from sjanc/bluetooth5_master
    
    merge master branch into bluetooth5
    
    X-Original-Commit: e6b348003df1f10f575d03345e5ef4cfad675581

commit 837cb1c37357cfab0b861664ece51e04c8c1ca2e
Merge: b8308fa9 95e350a5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 30 10:26:34 2017 +0200

    Merge branch 'master' into bluetooth5_master
    
     Conflicts:
            apps/bletiny/src/main.c
            net/nimble/host/include/host/ble_gap.h
            net/nimble/host/src/ble_hs_hci_cmd.c
    
    X-Original-Commit: ffbd4c80567667736bf17767c421a05ab7fc9a85

commit 7c79cdff0c49bd9ef5dc4de96419fdcf016eeaed
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 10:39:45 2017 +0200

    nimble/controller: Remove restriction whcih does not work in this case
    
    When BLE_EXT_ADV is set to 0 then we got:
    
    Error: Syscfg restriction violations detected:
        BLE_LL_CFG_FEAT_LL_EXT_ADV=MYNEWT_VAL_BLE_EXT_ADV requires
    BLE_EXT_ADV be set, but BLE_EXT_ADV=0
    
    Setting history (newest -> oldest):
        BLE_EXT_ADV: [net/nimble:0]
        BLE_LL_CFG_FEAT_LL_EXT_ADV:
    [net/nimble/controller:MYNEWT_VAL_BLE_EXT_ADV]
    
    This is because BLE_LL_CFG_FEAT_LL_EXT_ADV value is other flag which is
    not resolved yet.
    
    This patch remove restrictions. It should still work fine until user use
    BLE_EXT_ADV to configure extended advertising - will put it in
    documentation
    
    X-Original-Commit: 33085dea2df1c0b23d5dc7647278a00ed3afef24

 nimble/controller/syscfg.yml | 3 ---
 1 file changed, 3 deletions(-)

commit b8308fa9f051a876b3bac7ef6dac5001b98a5f9d
Merge: d10f1981 7d331060
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 30 08:04:25 2017 +0200

    Merge pull request #360 from sjanc/bt5_ext_adv
    
    MYNEWT-715 Extended Advertising - Advertiser support for controller
    
    X-Original-Commit: 0d96596be5e2473b7f27f097ae845dc6d90fa76b

commit 95e350a584e7ccc43f4b03184452b788df9e4277
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 29 17:45:08 2017 -0700

    BLE Host - Add missing #include.
    
    X-Original-Commit: 9badd7176419fbaf08226900c7c86a9f88a96dae

 nimble/host/include/host/ble_hs.h | 1 +
 1 file changed, 1 insertion(+)

commit 7d331060ab202efb3966ec2e1141b9219b9b29bb
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Jun 29 15:28:11 2017 +0200

    nimble/controller: Use flag for marking advertising on data channel
    
    There is no need for adding additional bytes to advertising state
    machine structure.
    
    X-Original-Commit: ccc75ea7cec2ba4a64864c03508fae366b4ebccc

 nimble/controller/src/ble_ll_adv.c | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

commit 5b0eb584cb1e584586341216126e14f45766d667
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 27 15:48:37 2017 +0200

    nimble/controller: Store DID and SID in single variable
    
    SID and DID are always transmitted together in ADI field. There is no
    need to keep them separated as ADI can be constructed when setting it
    from HCI. This saves both memory and computing
    
    X-Original-Commit: 8934c5387d2ea9f10a30cbf11a56b88a81b254eb

 nimble/controller/src/ble_ll_adv.c | 19 +++++++++----------
 1 file changed, 9 insertions(+), 10 deletions(-)

commit 6aa48e00a3597350a6cd818137328d41127c3a70
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 27 13:54:36 2017 +0200

    nimble/controller: Fix build with extended advertising disabled
    
    X-Original-Commit: cf1aa4deb5050d299a6a9f7175d49de15405b2ee

 nimble/controller/src/ble_ll_adv.c    | 50 ++++++++++++++++++++++++++++++++++-
 nimble/controller/src/ble_ll_hci_ev.c |  4 +++
 2 files changed, 53 insertions(+), 1 deletion(-)

commit 85ff7e4bb7ef9962415f8aaaefd9d57934691c08
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 27 11:54:08 2017 +0200

    nimble/controller: Remove support for Android specific HCI commands
    
    All functionality provided by those commands is available via standard
    HCI commands introduced in Bluetooth 5 specification. Also events
    generated but Android commands were not implemented correctly as
    vendor events. This resulted in spurious events being sent to host.
    
    X-Original-Commit: 4f5ffa33991588da657bd0b1f9651879bb3b9870

 nimble/controller/include/controller/ble_ll_adv.h |   5 +-
 nimble/controller/src/ble_ll_adv.c                | 150 +++-------------------
 nimble/controller/src/ble_ll_hci.c                |  89 +------------
 nimble/include/nimble/ble.h                       |   5 +-
 nimble/include/nimble/hci_vendor.h                | 112 ----------------
 nimble/syscfg.yml                                 |   3 -
 6 files changed, 20 insertions(+), 344 deletions(-)

commit 2b5c570ab362237d0463c7a3b4e1569ca2ac7ef2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 26 16:51:21 2017 +0200

    nimble/controller: Reduce padding in ble_ll_adv_sm
    
    Move some fields around to minimize padding.
    
    X-Original-Commit: fca1b8a5c110f6a2c15d34e0d1730b36adc9ea3a

 nimble/controller/src/ble_ll_adv.c | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)

commit 3ac3f417ac2c4793663cede47f1964543d0485f7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 26 16:07:16 2017 +0200

    nimble/controller: Add support for setting advertising TX power
    
    This allows host to set prefered TX power for advertising instance.
    Controller is allowed to ignore or adjust this value.
    
    X-Original-Commit: b6d919375838e6b03748725d47bb59aee94ece2f

 nimble/controller/include/controller/ble_phy.h |  3 +++
 nimble/controller/src/ble_ll_adv.c             | 10 +++++++++-
 nimble/drivers/native/src/ble_phy.c            | 23 +++++++++++++++++++++++
 nimble/drivers/nrf51/src/ble_phy.c             | 23 +++++++++++++++++++++++
 nimble/drivers/nrf52/src/ble_phy.c             | 23 +++++++++++++++++++++++
 5 files changed, 81 insertions(+), 1 deletion(-)

commit 580c0dde9395e6e95c1b7b19a647c07dead53a53
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jun 26 15:07:34 2017 +0200

    nimble/controller: Schedule AUX_ADV_IND based ADV_EXT_IND channel mask
    
    This gets rid of artificial delays in scheduling of AUX_ADV_IND.
    
    X-Original-Commit: 52314320d6bad451a6dcee304e4ebb7b96ca71d7

 nimble/controller/include/controller/ble_ll.h |  1 +
 nimble/controller/src/ble_ll_adv.c            | 36 +++++++++++++++++++--------
 2 files changed, 26 insertions(+), 11 deletions(-)

commit 1f616d3bc1bc75bce31d2d2010d34acf59dce8b7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 20 21:51:20 2017 +0200

    nimble/controller: Adjust slave anchor point based on PHY used
    
    Anchor point depends on PHY used and should be adjusted accordingly.
    
    X-Original-Commit: 7915aef02c5cd496a37401a52e53902c9ba79d70

 nimble/controller/src/ble_ll_conn.c | 21 ++++++++++++++++++---
 1 file changed, 18 insertions(+), 3 deletions(-)

commit 0f41b34a7c8c42fefce69fc24e11bf613524774c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 20 21:45:27 2017 +0200

    nimble/controller: Use flags for storing flag-like values
    
    RxAdd, TxAdd, Scan Request Notifications and Connection Response Sent
    are single bit values and can be stored as flags in common byte.
    
    X-Original-Commit: f9ad82d9311965da122d5c2e3d1e53dc019002d1

 nimble/controller/src/ble_ll_adv.c | 61 ++++++++++++++++++++++----------------
 1 file changed, 35 insertions(+), 26 deletions(-)

commit ff5d9601e02d447bc903ec5d186e85f6fce2b978
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 14 15:21:28 2017 +0200

    nimble/controller: Remove leftover TODOs
    
    Those parameters are already handled.
    
    X-Original-Commit: 0aa5b8b5d1c799373a2567dfa9ab33f8a96f91d1

 nimble/controller/src/ble_ll_adv.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 4bb1e1d25a5f9d1cc5ad24a28327bbe26c4b91e0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 13 17:36:15 2017 +0200

    nimble/controller: Add support for sending Set Terminated event
    
    Currently this is done only for connection complete.
    
    X-Original-Commit: e2eb1a0fdd7948b854ad4c341d3cad0f94ede25a

 nimble/controller/include/controller/ble_ll_ctrl.h |  2 ++
 nimble/controller/src/ble_ll_adv.c                 | 40 ++++++++++++++++++++--
 nimble/controller/src/ble_ll_hci_ev.c              | 25 ++++++++++++++
 nimble/include/nimble/ble.h                        |  3 ++
 nimble/include/nimble/hci_common.h                 |  3 ++
 5 files changed, 71 insertions(+), 2 deletions(-)

commit acc80719988d8704bc156f77452c8bf100ba1382
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:26 2017 +0200

    nimble/controller: Reply with AUX_CONN_RSP for connection request
    
    This allows to create connection while advertising using Extended
    Advertising PDUs. CSA2 is mandatory for this type of connection so
    ChSel bit is RFU and is not used.
    
    X-Original-Commit: 3f280f04d8e45985796ba2f8868b2f43b2e3627d

 nimble/controller/src/ble_ll_adv.c       | 114 +++++++++++++++++++++++++++++--
 nimble/controller/src/ble_ll_conn.c      |   7 +-
 nimble/controller/src/ble_ll_conn_priv.h |   2 +-
 3 files changed, 113 insertions(+), 10 deletions(-)

commit 79e2ff47724f4920f71d653cbfd6b20f872a8981
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:26 2017 +0200

    nimble/controller: Send LE Scan Request Received Event
    
    Notify host about SCAN_REQ received if event is enabled.
    
    X-Original-Commit: 5524d9bca54e9fc83d68be314fe39c020546d17e

 nimble/controller/include/controller/ble_ll_ctrl.h |  2 ++
 nimble/controller/src/ble_ll_adv.c                 |  6 ++++++
 nimble/controller/src/ble_ll_hci_ev.c              | 24 ++++++++++++++++++++++
 nimble/include/nimble/hci_common.h                 |  3 +++
 4 files changed, 35 insertions(+)

commit 80075eb4797481cbde918957a51f39c338e12a1a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:26 2017 +0200

    nimble/controller: Add support for sending AUX_SCAN_RSP
    
    If AUX_SCAN_REQ is received then reply with AUX_SCAN_RSP.
    
    X-Original-Commit: bb8d1aab0142d3fe9bb8746548a854ea2ba6131f

 nimble/controller/src/ble_ll_adv.c | 93 +++++++++++++++++++++++++++++++++++---
 1 file changed, 87 insertions(+), 6 deletions(-)

commit ec76874b4825b08eb2a928a506c6ef831cf13278
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:26 2017 +0200

    nimble/controller: Add support for non-connectable advertising
    
    This allows to advertise with ADV_EXT_IND and AUX_ADV_IND PDUs using
    supported PHYs. AUX_ADV_IND are scheduled separately and ADV_EXT_IND
    use its start time for offset calculation. This is initial support
    and not all options are supported yet.
    
    X-Original-Commit: 965fe93735116db042f016bebf969097cd6a2987

 nimble/controller/include/controller/ble_ll.h      |  28 ++
 nimble/controller/include/controller/ble_ll_adv.h  |   3 -
 .../controller/include/controller/ble_ll_sched.h   |   5 +-
 nimble/controller/src/ble_ll_adv.c                 | 455 ++++++++++++++++++++-
 nimble/controller/src/ble_ll_sched.c               |   6 +-
 5 files changed, 470 insertions(+), 27 deletions(-)

commit fff1b2c964d2473f77d5520dfcd9fc1e87c47530
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:26 2017 +0200

    nimble/controller: Use properties for storing advertising type
    
    This is in preparation for handling extended advertising PDUs. Legacy
    advertising PDUs are mapped as describbed in Core Spec Vol. 2 Part E.
    7.8.53 table 7.2.
    
    X-Original-Commit: de29d08a03657887b3b24369f64a24e932588f5a

 nimble/controller/src/ble_ll_adv.c | 130 ++++++++++++++-----------------------
 1 file changed, 50 insertions(+), 80 deletions(-)

commit 9ff6333f39feda94787695105c69dcee3a17eeab
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:26 2017 +0200

    nimble/controller: Add LE Set Extended Advertising Parameters Command
    
    X-Original-Commit: 42f51756ba2e378c6da895adbdb5e5e26f49621d

 nimble/controller/include/controller/ble_ll_adv.h |   2 +-
 nimble/controller/src/ble_ll_adv.c                | 174 +++++++++++++++++++++-
 nimble/controller/src/ble_ll_hci.c                |   2 +-
 nimble/include/nimble/hci_common.h                |  14 ++
 4 files changed, 187 insertions(+), 5 deletions(-)

commit fad18e99286d6976f52fb1aabb6296d999ee9a96
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Add LE Set Extended Scan Response Data Command
    
    X-Original-Commit: ec0f29a1df3cae213be7bf72768cf7420291a798

 nimble/controller/include/controller/ble_ll_adv.h |  3 +-
 nimble/controller/src/ble_ll_adv.c                | 83 ++++++++++++++++++++---
 nimble/controller/src/ble_ll_hci.c                |  3 +-
 nimble/include/nimble/hci_common.h                |  4 ++
 4 files changed, 81 insertions(+), 12 deletions(-)

commit 8d96286f81ca1a67af0dd0bde5daf66f34d9cf01
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 29 10:47:41 2017 -0700

    testutil - Remove init boilerplate.
    
    All selftest main() functions had the same initialization sequence for
    the testutil package:
    
        (a) ts_config.ts_print_results = 1;
        (b) tu_init();
        (c) (sometimes) tu_parse_args(argc, argv);
    
    The issues with this are:
    
    * Since (a) is always present, it could be performed by the tu_init()
      function call automatically.
    
    * (b) is inconsistent with regular apps.  An app calls sysinit() from
      main, but selftest programs call tu_init(), which in turn calls
      sysinit().
    
    * (c) is obsolete; "newt run <test-pkg>" takes care of argument parsing
      now.
    
    This commit addresses these issues as follows:
    
    1. Move `ts_config.ts_print_results = 1;` into tu_init().
    
    2. Turn tu_init() into a sysinit function.  That is, have it get called
    automatically by sysinit().
    3. Remove tu_parse_args() entirely.
    
    4. In selftest main() functions, call sysinit() instead of tu_init()
    like a regular app.
    
    The motivation for this commit is to make unit test documentation
    easier to understand.
    
    X-Original-Commit: 1570240fd1e388339f95ee8158ecf9195be93315

 nimble/host/test/src/ble_hs_test.c      | 6 ++----
 nimble/host/test/src/ble_hs_test_util.c | 3 ++-
 2 files changed, 4 insertions(+), 5 deletions(-)

commit 2c53ab274d4dee0700fb207c3b5b71f21454e6bc
Merge: 59ea30e5 d382f347
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jun 29 09:48:44 2017 +0200

    Merge pull request #344 from michal-narajowski/systemview
    
    [RFC] MYNEWT-430: Segger's SystemView working with Mynewt
    
    X-Original-Commit: 3eb5cdb87d3269004da4ef93b6d74fcc83557d9b

commit 92d91a5094ce4e59c06957ae65b93ca53c9a6a3a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Add LE Set Extended Advertising Data Command
    
    X-Original-Commit: be4689bb4f1b55cc2ac9d646f86a6b82a273da35

 nimble/controller/include/controller/ble_ll_adv.h |   2 +-
 nimble/controller/src/ble_ll_adv.c                | 104 +++++++++++++++++++---
 nimble/controller/src/ble_ll_hci.c                |   3 +-
 nimble/include/nimble/hci_common.h                |   5 ++
 4 files changed, 101 insertions(+), 13 deletions(-)

commit f11c4c5733fa84557c86951367721c727731b671
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Add LE Clear Advertising Sets Command
    
    X-Original-Commit: f8e73d261f551b2e27a0640c6a2e78dd7fe8bfb9

 nimble/controller/src/ble_ll_adv.c | 18 ++++++++++++++++--
 1 file changed, 16 insertions(+), 2 deletions(-)

commit 0fcafef31728670dfb05b45312dbe06eedd3625d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Add LE Remove Advertising Set Command
    
    X-Original-Commit: 89e6b59827993bb085abd9044e1b71d6a8448983

 nimble/controller/src/ble_ll_adv.c | 61 ++++++++++++++++++++++++++++----------
 1 file changed, 46 insertions(+), 15 deletions(-)

commit c8ad2c7ab04edcf2db86d0f5072f35f6d5c3c9cc
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Add LE Set Extended Advertising Enable Command
    
    X-Original-Commit: 9709c43814b0fd8fcb9a4fefbb47782f5c614d49

 nimble/controller/include/controller/ble_ll_adv.h |  3 +-
 nimble/controller/src/ble_ll_adv.c                | 92 +++++++++++++++++++++--
 nimble/controller/src/ble_ll_hci.c                |  2 +-
 3 files changed, 89 insertions(+), 8 deletions(-)

commit 0766c508e916df818c74c876ce203fdb1a3071f4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Add initial stubs for Ext Advertising HCI commands
    
    This adds the necessary boilerplater for new commands.
    
    X-Original-Commit: ee960d823a96ff427973c7edacc78a81eb9b3ae2

 nimble/controller/include/controller/ble_ll_adv.h |  8 +++
 nimble/controller/src/ble_ll_adv.c                | 42 ++++++++++++++
 nimble/controller/src/ble_ll_hci.c                | 70 +++++++++++++++++++++++
 nimble/include/nimble/hci_common.h                |  6 ++
 4 files changed, 126 insertions(+)

commit 96989da35263dbd246a52c03b6304ff932e78355
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Reject le set adv if connectable
    
    As defined in Core Specification 5.0 Vol. 2 Part E 7.8.52.
    
    X-Original-Commit: e641a9fdc4667ecc742959ee86d701f888c1bdee

 nimble/controller/src/ble_ll_adv.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit e45518d3a82c084a35da476130e0e44516adf6d8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Don't build VS code if Android VS are not enabled
    
    There is no need for handling VS commands if none is required.
    
    X-Original-Commit: 6b03aa6af9fa21c1d01cdc3fb56218e149da1606

 nimble/controller/src/ble_ll_hci.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 9c5f0deccab68e7ea3b4f9750be774d724b6940d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:25 2017 +0200

    nimble/controller: Rename BLE_MULTI_ADV_SUPPORT
    
    Name it BLE_ANDROID_MULTI_ADV_SUPPORT as it will be used only do enable
    Android specific vendor commands.
    
    X-Original-Commit: 01b9ef9da0e00a45fd270bcdd661b7e4cf5b1fa8

 nimble/controller/src/ble_ll_adv.c | 20 ++++++++++----------
 nimble/controller/src/ble_ll_hci.c |  2 +-
 nimble/include/nimble/ble.h        |  2 +-
 nimble/syscfg.yml                  |  4 ++--
 4 files changed, 14 insertions(+), 14 deletions(-)

commit a21974068fc7b60ffb6cfd7d2782e9719d00ef4b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jun 9 12:51:24 2017 +0200

    nimble/controller: Remove few not needed #ifdefs
    
    There is no need for special handling of single iteration loop as
    compiler should catch this.
    
    X-Original-Commit: 9878a220f4f9bd0fda1c4f452425cb3475a0a2d9

 nimble/controller/include/controller/ble_ll_adv.h |  2 --
 nimble/controller/src/ble_ll_adv.c                | 13 +------------
 2 files changed, 1 insertion(+), 14 deletions(-)

commit 59ea30e58eb7b913ec038824f3c97ba49cfa2ed4
Merge: 5bb7bceb d3501bec
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Wed Jun 28 15:28:40 2017 -0700

    Merge pull request #280 from ccollins476ad/store-config
    
    BLE Host - Persist bonding material to sys/config
    
    X-Original-Commit: e416c090e04cc580926467c127900e9380395ab3

commit d3501becbaeaaaaab567e763160385fa3758c7ec
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 4 12:00:26 2017 -0700

    MYNEWT-743 BLE Host - Persist bonds to sys/config
    
    X-Original-Commit: 858e59595311423deb674959841c3d3b8eb9e100

 nimble/host/include/host/ble_hs.h                  |   1 +
 .../config/include/store/config/ble_store_config.h |  39 ++
 nimble/host/store/config/pkg.yml                   |  38 ++
 nimble/host/store/config/src/ble_store_config.c    | 533 +++++++++++++++++++++
 .../host/store/config/src/ble_store_config_conf.c  | 231 +++++++++
 .../host/store/config/src/ble_store_config_priv.h  |  59 +++
 nimble/host/store/config/syscfg.yml                |  25 +
 nimble/host/store/ram/pkg.yml                      |   5 +-
 nimble/host/syscfg.yml                             |  15 +-
 nimble/host/test/pkg.yml                           |   2 +-
 nimble/host/test/src/ble_hs_test_util.c            |   8 +-
 nimble/host/test/src/ble_sm_test_util.c            |   1 -
 nimble/host/test/src/ble_store_test.c              |  52 +-
 nimble/host/test/syscfg.yml                        |   1 +
 14 files changed, 986 insertions(+), 24 deletions(-)

commit d10f19815edb02ee94e43d836d76651d18031deb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jun 26 13:12:48 2017 +0200

    nimble: Add BLE_EXT_ADV MYNEWT_VAL
    
    This flag is used to enable extended advertising in host and controller
    (due to dependecies)
    
    X-Original-Commit: 1879eaeb023256a1e81714cfe94b06728e36afc8

 nimble/controller/syscfg.yml | 5 ++++-
 nimble/syscfg.yml            | 4 ++++
 2 files changed, 8 insertions(+), 1 deletion(-)

commit 460b464f2aa1d3fb7f84a3533b7d9387193dd4bd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Jun 4 17:45:29 2017 +0200

    nimble/gap: Add support for handling extended advertising event
    
    X-Original-Commit: 0429b5e67e1a9cdfd832463eac2ebab85870f26a

 nimble/host/include/host/ble_gap.h | 34 +++++++++++++--
 nimble/host/src/ble_gap.c          | 72 +++++++++++++++++++++++---------
 nimble/host/src/ble_gap_priv.h     |  3 ++
 nimble/host/src/ble_hs_hci_evt.c   | 85 +++++++++++++++++++++++++++++++++++++-
 nimble/include/nimble/hci_common.h | 27 ++++++++++++
 5 files changed, 196 insertions(+), 25 deletions(-)

commit 3a0e8f86ed3d193cce5ee161c03d728bf74a7c10
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 2 11:15:13 2017 +0200

    nimble/gap: Add GAP API for extended connection
    
    For now we have separate function but maybe we could do it better.
    
    X-Original-Commit: a1ad55b988b7bea5426c1645a20a1055112a0999

 nimble/host/include/host/ble_gap.h |   6 +
 nimble/host/src/ble_gap.c          | 236 +++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  |   3 +
 3 files changed, 245 insertions(+)

commit 30eb800cbe01a3558638853c5c43b0327d17648c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 2 11:13:26 2017 +0200

    nimble/hci: Add support for HCI create ext connect
    
    X-Original-Commit: 19ab65955c1d757d3c9371bea557fa4817eef42a

 nimble/host/src/ble_hs_hci_cmd.c   | 160 +++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  |  10 +++
 nimble/include/nimble/hci_common.h |   3 +-
 3 files changed, 172 insertions(+), 1 deletion(-)

commit 3014e45f9fba91b212fb0f9b7e8cdd36d116ade0
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 2 11:11:33 2017 +0200

    nimble/hci: Minor coding style fix
    
    X-Original-Commit: c25e7bcf6ecee85ce8c6696e35bbc4e25b8bf5f1

 nimble/host/src/ble_hs_hci_priv.h | 28 +++++++++++++++-------------
 1 file changed, 15 insertions(+), 13 deletions(-)

commit 1cfe6334551c150865fa3d0d12423a3321c1d7ea
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 2 11:10:55 2017 +0200

    nimble/hci: Remove reduntant declaration
    
    X-Original-Commit: 457fc9815b9b01bcca1aa76beb1b9bba97f2e0b4

 nimble/host/src/ble_hs_hci_priv.h | 1 -
 1 file changed, 1 deletion(-)

commit 13c519b398c8774620c41b2c9797eb97daef77fb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 16 22:45:29 2017 +0200

    nimble/gap: Add API for extended scan
    
    X-Original-Commit: 1c4c5f0b8118ab1d40d86ec3b74d0f54de4419f6

 nimble/host/include/host/ble_gap.h |  15 +++
 nimble/host/src/ble_gap.c          | 228 ++++++++++++++++++++++++++++++++++---
 2 files changed, 229 insertions(+), 14 deletions(-)

commit df49632d49286f96f82b8ee2689c6de2f05d48cf
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 25 21:35:32 2017 +0200

    nimble/hci: Add set extended scan parameters command
    
    X-Original-Commit: 0e4fd66e8e3b67fd8898541743fcf6d678014d69

 nimble/host/src/ble_hs_hci_cmd.c   | 146 ++++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_hs_hci_priv.h  |  23 ++++++
 nimble/include/nimble/hci_common.h |   2 +
 3 files changed, 170 insertions(+), 1 deletion(-)

commit 388fbe79383351243ff6e99cbc5198c68c5c1f0f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 25 20:06:38 2017 +0200

    nimble/hci: Add HCI commands for enhanced trans/recv test
    
    X-Original-Commit: 371438c03737694cb2a053fe7bd986eddb341460

 nimble/host/src/ble_hs_hci_cmd.c   | 78 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  | 12 +++++-
 nimble/include/nimble/hci_common.h |  5 +++
 3 files changed, 94 insertions(+), 1 deletion(-)

commit d382f3477f060a677d1ac1be56865dab1b41d377
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Apr 18 14:31:58 2017 +0200

    hw/drivers: trace ble_rng_isr calls
    
    X-Original-Commit: ec3f0b331f779ab4e976426842dccc6514517349

 nimble/drivers/nrf52/src/ble_hw.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 5bb7bceb351264b1be786823d6a5a1b92d7f596b
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 27 16:06:21 2017 -0700

    BLE Host - Allow get / set of channel map.
    
    X-Original-Commit: fba37e26c37c7986932777ebff8f3dff174c853f

 nimble/host/include/host/ble_hs.h     |  1 +
 nimble/host/include/host/ble_hs_hci.h | 34 +++++++++++++
 nimble/host/src/ble_hs_hci_cmd.c      | 44 ++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h     |  4 ++
 nimble/host/src/ble_hs_hci_util.c     | 96 +++++++++++++++++++++++++++++++++++
 5 files changed, 179 insertions(+)

commit 51706155cc11bc194b137fd8bb98be297b70b8f6
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 27 16:06:06 2017 -0700

    BLE Host - Remove unused functions.
    
    X-Original-Commit: 28ce7ea880979bff92916963ba98b43a2a460013

 nimble/host/src/ble_hs_hci_cmd.c  | 14 --------------
 nimble/host/src/ble_hs_hci_priv.h |  2 --
 2 files changed, 16 deletions(-)

commit 0ac066ca15971395f65abca81a976ada6c0a3106
Merge: 9398310f 67b5c462
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 28 00:03:43 2017 +0200

    Merge pull request #341 from andrzej-kaczmarek/remove_1mhz
    
    MYNEWT-785: Remove support for 1MHz clock in nimble
    
    X-Original-Commit: 0c8f869a63dac8046a6d9fa285f13ef5e8bff199

commit 9398310f591f9bbec18e49242fbec8d325707022
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 27 10:56:01 2017 +0200

    nimble/controller: Header already contains valid phy
    
    X-Original-Commit: a6f00d6e17224254e5d8d4b61287816aadf77022

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 37904f3ef2de1bb1e36f5b325f850509d8fdf253
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 27 10:53:03 2017 +0200

    nimble/controller: Fix native and nrf51 header on RX
    
    With this patch we make sure phy and aux_data are set correctly in
    data receive header for all the supported phy
    
    X-Original-Commit: ab1ce17187828b547b9043e416913e3e14b6b7b3

 nimble/drivers/native/src/ble_phy.c | 4 ++++
 nimble/drivers/nrf51/src/ble_phy.c  | 4 ++++
 2 files changed, 8 insertions(+)

commit 1510f66c2b153fc3d185229c13c608715180242d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 27 10:29:03 2017 +0200

    nimble/controller: Fix for write above array bound
    
    X-Original-Commit: f83df312e1ef5b86929c1e35a428cddcc2564702

 nimble/controller/src/ble_ll_scan.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 3ccbf9d90d1380b7870674d346c10b889aa26e41
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 27 10:22:19 2017 +0200

    nimble/controller: Minor coding style fix
    
    X-Original-Commit: 4b0e7682fcd19452b53b936881def67b5a5d1d07

 nimble/controller/include/controller/ble_ll_scan.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 40cdbe6c4d30b312332e223fe0daacb77de60d04
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jun 26 14:20:29 2017 +0200

    nimble/controller: CSA2 is mandatory for extended advertising
    
    Make sure CSA2 is enabled when extended advertising is on
    
    X-Original-Commit: 801d2ce82273ccbd1e121affef022cd77e311d7b

 nimble/controller/syscfg.yml | 4 ++++
 1 file changed, 4 insertions(+)

commit 67b5c4627101f2282e5e9280e48ce1a8c4adafe7
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jun 22 14:43:03 2017 +0200

    nimble/controller: Add LP clock sysval to configure BSP
    
    Controller package defines new sysval (BLE_LP_CLOCK) which is then used
    to configure ticks and timers accordingly.
    
    X-Original-Commit: 0f20fa272a88c8af7ae02d94475f618148cba3a6

 nimble/controller/syscfg.yml | 5 +++++
 1 file changed, 5 insertions(+)

commit 2d8e3debb654462125e8fe13b8b7acf3597d8250
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 20 15:03:34 2017 +0200

    nimble/controller: Emit build error when building with non-32kHz clock
    
    X-Original-Commit: cdf566d3747ec6f50fc5c0ecfb10d357bc1da2be

 nimble/controller/include/controller/ble_ll.h | 4 ++++
 1 file changed, 4 insertions(+)

commit 3d97cd6b3db49f426e4763f51f158e4c1c5d8265
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 20 14:15:44 2017 +0200

    nimble/controller: Fix build with native phy
    
    X-Original-Commit: 53f97314cc13723d32d00c5d1f517ba86dd4d712

 nimble/controller/src/ble_ll_sched.c |  2 +-
 nimble/drivers/native/src/ble_phy.c  | 11 +++++++++--
 2 files changed, 10 insertions(+), 3 deletions(-)

commit b8a50593513d0be4a7127156bedad2f67e9b7c07
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 20 10:53:19 2017 +0200

    nimble/controller: Remove code for 1MHz clock
    
    We will only support LP 32.768kHz clock from now on.
    
    X-Original-Commit: e399b1518de3fd9acf44cf6ddf9ca19f9518d4e4

 nimble/controller/include/controller/ble_ll_conn.h |   2 -
 .../controller/include/controller/ble_ll_sched.h   |   2 -
 nimble/controller/include/controller/ble_phy.h     |  10 --
 nimble/controller/src/ble_ll.c                     |  16 ---
 nimble/controller/src/ble_ll_adv.c                 |  35 +-----
 nimble/controller/src/ble_ll_conn.c                | 105 +-----------------
 nimble/controller/src/ble_ll_scan.c                |   4 -
 nimble/controller/src/ble_ll_sched.c               |  52 ---------
 nimble/drivers/nrf51/include/ble/xcvr.h            |   9 +-
 nimble/drivers/nrf51/src/ble_phy.c                 | 121 --------------------
 nimble/drivers/nrf52/include/ble/xcvr.h            |   9 +-
 nimble/drivers/nrf52/src/ble_phy.c                 | 122 ---------------------
 nimble/include/nimble/ble.h                        |   2 -
 13 files changed, 7 insertions(+), 482 deletions(-)

commit b99f4d0760f2c21c67ba3d6e1aaf8f24d83dc30c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jun 20 12:25:20 2017 +0200

    nimble/controller: Allow 2M and Coded PHYs only on nRF52840
    
    Other SoCs only support 1M officially.
    
    X-Original-Commit: 64758da50a8feac6340be4f4ceaffa2f25ac7821

 nimble/controller/include/controller/ble_phy.h | 8 ++++++++
 1 file changed, 8 insertions(+)

commit a0f6959eb6f8ed20a8df4e4550471c294789e731
Merge: 004df08a a1cbecad
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Mon Jun 26 09:14:09 2017 -0700

    Merge pull request #279 from ccollins476ad/key-wont-fit
    
    BLE Host - Policy for SM key overflow
    
    X-Original-Commit: d877c32d698bbca943bdbc8cccd50e9c18de0977

commit 468638ddab76b1b39bac4e9965ba8ee0cb42b23e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jun 26 12:14:02 2017 +0200

    nimble/controller: Fix checking for supported PHY
    
    When using extended HCI commands, we need to make sure that requested
    PHY is supported by controller
    
    X-Original-Commit: c8afc9d3f02424ab43dbd60fce9fb04fad284769

 nimble/controller/src/ble_ll_conn_hci.c | 8 ++++++++
 nimble/controller/src/ble_ll_scan.c     | 4 ++++
 2 files changed, 12 insertions(+)

commit b0235a4f90206f2cc65cec896a6fd8adda25b475
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Jun 26 11:18:24 2017 +0200

    nimble/controller: Fix for nrf51 build error
    
    X-Original-Commit: c17a2192971f18d205b1fd8b979f529436f789ba

 nimble/drivers/nrf51/src/ble_phy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a1cbecadff0afe50f301ab50d6243a7f202156ff
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 22 15:01:10 2017 -0700

    MYNEWT-751 store event API change
    
    1. Rename BLE_STORE_EVENT_OVERFLOW_NEXT --> BLE_STORE_EVENT_FULL
    2. For store events, encapsulate event contents in structs.
    
    X-Original-Commit: 94247e1917c362c109efbbb4fa8ae7636fa5511b

 nimble/host/include/host/ble_store.h  | 36 ++++++++++++++++++++---------------
 nimble/host/src/ble_sm.c              |  2 +-
 nimble/host/src/ble_store.c           | 12 ++++++------
 nimble/host/src/ble_store_util.c      | 17 +++++++++--------
 nimble/host/test/src/ble_store_test.c |  5 +++--
 5 files changed, 40 insertions(+), 32 deletions(-)

commit 71038d873525834320fdfc555d8973c45ebe9555
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 23 14:55:42 2017 +0200

    nimble/controller: Fix build issue for non Bluetooth 5 configuration
    
    X-Original-Commit: ed985211195f9bd3152f9803f2ba46d9f94032d0

 nimble/controller/include/controller/ble_ll_conn.h | 1 +
 nimble/controller/include/controller/ble_phy.h     | 2 +-
 nimble/controller/src/ble_ll.c                     | 2 +-
 nimble/controller/src/ble_ll_scan.c                | 2 ++
 nimble/drivers/nrf52/src/ble_phy.c                 | 6 +++++-
 5 files changed, 10 insertions(+), 3 deletions(-)

commit c7408d0722452aba1a5aefd8a8fd9ae0a9b5b8cd
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jun 22 13:48:30 2017 +0200

    nimble/controller: Fix build for 1M
    
    X-Original-Commit: b900a1dee4c2d67133f593cbf691fd8f04940b30

 nimble/controller/include/controller/ble_phy.h | 6 ++++--
 nimble/controller/src/ble_ll_conn.c            | 2 +-
 nimble/controller/src/ble_ll_sched.c           | 4 ++--
 nimble/drivers/nrf52/src/ble_phy.c             | 2 +-
 4 files changed, 8 insertions(+), 6 deletions(-)

commit bc80060a6b5d335b860f6a9c44c6a916d4dd7e82
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 23 12:43:48 2017 +0200

    nimble/controller: Sort out flag configuration for BT5
    
    In order to enable extended advertising feature from Bluetooth 5
    MYNEWT_VAL BLE_LL_CFG_FEAT_LL_EXT_ADV shall be set to 1
    
    With this patch controller succesfull builds with and without this
    flag
    
    X-Original-Commit: 926b9598ec7c3ff8b751f2aed662bbb838e5c522

 nimble/controller/include/controller/ble_ll_conn.h |  2 +
 nimble/controller/include/controller/ble_ll_scan.h |  6 +--
 .../controller/include/controller/ble_ll_sched.h   |  2 +-
 nimble/controller/src/ble_ll_conn.c                | 31 ++++++++++-----
 nimble/controller/src/ble_ll_conn_hci.c            |  2 +-
 nimble/controller/src/ble_ll_conn_priv.h           |  4 +-
 nimble/controller/src/ble_ll_hci.c                 |  2 +-
 nimble/controller/src/ble_ll_scan.c                | 45 ++++++++++++++--------
 nimble/controller/src/ble_ll_sched.c               |  4 +-
 nimble/controller/syscfg.yml                       |  7 ++++
 nimble/drivers/nrf52/src/ble_phy.c                 |  2 +-
 nimble/include/nimble/ble.h                        |  2 +-
 nimble/include/nimble/hci_common.h                 |  2 +-
 nimble/syscfg.yml                                  |  3 --
 14 files changed, 73 insertions(+), 41 deletions(-)

commit 613ac7518e7ede9e54b6a30b8d54f64ce4fd42d7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jun 22 13:47:06 2017 +0200

    nimble/controller: Minor coding style fix
    
    X-Original-Commit: d3171276d2d96bf11a0096d66c939d686614fd10

 nimble/controller/src/ble_ll_conn.c | 19 ++++++++++---------
 1 file changed, 10 insertions(+), 9 deletions(-)

commit f241110bc8a77107dc63959088ccf32043530946
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jun 22 13:46:28 2017 +0200

    nimble/controller: Increase stack
    
    X-Original-Commit: becd62954671e5d692d38946f8ddc48d0415387c

 nimble/controller/src/ble_ll.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit c36094b79c7065e74a7aec9d199c8fe64372022d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Jun 22 12:00:41 2017 +0200

    nimble/controller: Fix conn params check
    
    X-Original-Commit: abc3e12fe313667df0a178e933b5947a4a14c9f5

 nimble/controller/src/ble_ll_conn_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 464508c070b3cfb6fb141d651d2dca49779c50a8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 21 15:01:17 2017 +0200

    nimble/controller: Fix rxinfo rx state mask
    
    There are five states (standby, adv, scanning, initiating and
    connection) so mask should be 3 bits long.
    
    This allows to get rid of hack that checked channel number used for
    packet instead of state for determining if it is connection or not.
    
    X-Original-Commit: 506a0a68ac50a8bbe54bfd3db555c69a3df36cad

 nimble/include/nimble/ble.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 35f4b71383c9d49ed5edddcecfb69873ea4ed0de
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jun 21 14:59:33 2017 +0200

    nimble/controller: Make rxinfo macros return casted values
    
    X-Original-Commit: ec320692e199652cf83b0bb161f75b22dc370aff

 nimble/include/nimble/ble.h | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit e1cd9364e231f130658596d429ac2947e252bf84
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 16 08:55:39 2017 +0200

    nimble/controller: Fix for scanning freeze
    
    It happened that scanner goes into aux scan state and could not get out
    of it. The reason was that ble_ll_scan_start() did not start RX which
    leads us to stay in standby state for ever.
    
    X-Original-Commit: 4bd9300e16ceac85a9b8b0e465a88341faf10539

 nimble/controller/src/ble_ll_scan.c | 23 +++++++++++++++--------
 nimble/drivers/nrf52/src/ble_phy.c  |  2 +-
 2 files changed, 16 insertions(+), 9 deletions(-)

commit ab9593ab0e8bca9b8cdc9aa5002f29af19cc62a2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Jun 4 14:46:18 2017 +0200

    nimble/controller: Add support to create extended connection
    
    X-Original-Commit: 841984f98b79b0d408b8ca97a9edaec523c179c0

 nimble/controller/include/controller/ble_ll.h      |   3 +
 nimble/controller/include/controller/ble_ll_conn.h |  10 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   3 +-
 nimble/controller/include/controller/ble_ll_scan.h |  13 +
 nimble/controller/src/ble_ll.c                     |  25 +-
 nimble/controller/src/ble_ll_conn.c                | 386 ++++++++++++++++-----
 nimble/controller/src/ble_ll_conn_hci.c            | 220 +++++++++++-
 nimble/controller/src/ble_ll_conn_priv.h           |  19 +-
 nimble/controller/src/ble_ll_hci.c                 |   6 +-
 nimble/controller/src/ble_ll_scan.c                |  69 +++-
 nimble/controller/src/ble_ll_sched.c               |  39 ++-
 nimble/include/nimble/hci_common.h                 |  25 ++
 12 files changed, 687 insertions(+), 131 deletions(-)

commit 3fc3ecd9de238c57bdcc8d22fef32a34b4a63124
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 25 12:50:48 2017 +0200

    nimble/controller: Add parser for extended advertising
    
    This patch adds scanner part from extended advertising feature.
    It does not support chaining and periodic scaning
    
    X-Original-Commit: 0b254d334400949c4ead05d667b20ed6b058c64d

 nimble/controller/include/controller/ble_ll.h      |  17 +
 nimble/controller/include/controller/ble_ll_scan.h |  31 +-
 .../controller/include/controller/ble_ll_sched.h   |  11 +
 nimble/controller/src/ble_ll.c                     |  10 +
 nimble/controller/src/ble_ll_scan.c                | 784 ++++++++++++++++++++-
 nimble/controller/src/ble_ll_sched.c               | 125 +++-
 nimble/drivers/nrf52/src/ble_phy.c                 |   5 +
 nimble/include/nimble/ble.h                        |  28 +-
 nimble/include/nimble/hci_common.h                 |  14 +
 9 files changed, 993 insertions(+), 32 deletions(-)

commit 84673de642259594fa132daf15e6ea8d478914ce
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 25 12:33:19 2017 +0200

    nimble/controller/sched: Remove reduntant declarations
    
    X-Original-Commit: 5bc00f6f5f28324eba9c0880d81494292e534df6

 nimble/controller/include/controller/ble_ll_sched.h | 6 ------
 1 file changed, 6 deletions(-)

commit c6809afbababe0e702dbc7ffe86bedf59d418206
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon May 29 16:06:09 2017 +0200

    nimble/controller: Refactor a bit ble_ll_init_rx_isr_end
    
    This is minor refactor as a preparation for bluetooth5 support
    
    X-Original-Commit: 0c1c4aea89b983b53536870075de8ceea2958e6e

 nimble/controller/include/controller/ble_ll.h |   9 ++
 nimble/controller/src/ble_ll_conn.c           | 188 ++++++++++++++------------
 2 files changed, 109 insertions(+), 88 deletions(-)

commit 1fe8606145f69fb7ad68d9f62ef5f7d0c090558f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon May 29 14:03:46 2017 +0200

    nimble/controller: Improve flow for handling connection data
    
    Since in BT5 introduce secondary advertising channels, we need to make
    sure to handle it corretly. So far all data on data channels we treat as
    the connection data.
    
    X-Original-Commit: 9977f9d771e5f0d6ea7fe36b4e5ffae25cb9d0f6

 nimble/controller/src/ble_ll.c | 82 ++++++++++++++++--------------------------
 1 file changed, 30 insertions(+), 52 deletions(-)

commit 2a4f74c6f0afa1837ec5d92cc7a26216e1862210
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 25 15:32:53 2017 +0200

    nimble/controller: Extract function to prepare and send adv report
    
    This patch did minor refactor which will be needed for legacy extended
    advertising support
    
    X-Original-Commit: d070d7336e87522b4341049b48c45229e4d8512c

 nimble/controller/src/ble_ll_scan.c | 130 ++++++++++++++++++++----------------
 1 file changed, 71 insertions(+), 59 deletions(-)

commit 20250b5aba8e8bc0117c149b46cd137fd2524f69
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 23 10:40:52 2017 +0200

    nimble/controller: Make use of access_add nad crcinit for scan/adv
    
    Since in bluetooth5 advertising/scanning are also done on data channel
    (secondary advertising channel) we need to make sure that for data
    channels we can set correct access addres and crcini
    
    X-Original-Commit: 29380511422775f7fc25a8aa0c8e7c9485133ba5

 nimble/controller/src/ble_ll_adv.c  | 2 +-
 nimble/controller/src/ble_ll_scan.c | 2 +-
 nimble/drivers/native/src/ble_phy.c | 8 ++------
 nimble/drivers/nrf52/src/ble_phy.c  | 4 ++--
 4 files changed, 6 insertions(+), 10 deletions(-)

commit 4384b6eb543eaef559508d6aa89bf62c30660299
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed May 17 11:28:15 2017 +0200

    nimble/controller: Change PHY when extended scan requires that
    
    X-Original-Commit: b76b34d89abb3ea6adc800fc2d2da2a174a5ed3e

 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll_scan.c                | 12 ++++++++++--
 2 files changed, 11 insertions(+), 2 deletions(-)

commit f62411d13f43d46489bcc269474315850cfc8d10
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 12 10:53:18 2017 +0200

    nimble/controller: Add support for scan using two PHYs
    
    With this patch controller shares time for scanning on two PHYs.
    Idea is that whenever one PHY is out of its scan window,
    scan on second PHY is started.
    
    X-Original-Commit: bb5eee2cfc0b81082c3d6397deb0aba1bb817fff

 nimble/controller/include/controller/ble_ll_scan.h |  2 +
 nimble/controller/src/ble_ll_scan.c                | 99 ++++++++++++++++++++--
 2 files changed, 93 insertions(+), 8 deletions(-)

commit 32ebb02961cb8998b2936cca048aaa7da1be3a34
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 12 09:33:59 2017 +0200

    nimble/controller: Add restriction for extended scan
    
    For now lets don't accept HOST request on two PHYs scan when at least on
    one PHY continuous scan is requested
    
    X-Original-Commit: 3d1af7372b3f9eed07de4cdf9798dbdd05b1deb3

 nimble/controller/src/ble_ll_scan.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit b9cf4fa274b7a5e6f4cece773e48b3faa45ea2c4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 11 13:50:32 2017 +0200

    nimble/controller: Refactor ble_ll_scan_proc function
    
    This patch does not change any behavior. Just a refactor for future
    work on Bluetooth 5.0
    
    X-Original-Commit: 0a10a121edcc7ec0312561b5714f9dc6d0b709b3

 nimble/controller/src/ble_ll_scan.c | 56 +++++++++++++++----------------------
 1 file changed, 23 insertions(+), 33 deletions(-)

commit 9c12a715a47502ecf7052a0168b4e09b4f5dd311
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 11 10:53:14 2017 +0200

    nimble/controller: Refactor ble_ll_scan_window_chk
    
    Lets make this function do what is says. Based on return we can take
    actions.
    
    This is cleaning done for bluetooth5 purposes
    
    X-Original-Commit: 120ff86482bc5ff97cdfd8a6c0c25e86b4b5fcec

 nimble/controller/src/ble_ll_scan.c | 56 ++++++++++++++++++++-----------------
 1 file changed, 31 insertions(+), 25 deletions(-)

commit ddec542a2c677e51e28a05608532b066ebae5b21
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 9 10:47:08 2017 +0200

    nimble/controller: Fix scan comment
    
    X-Original-Commit: eaca84006209b10cb26cdf11dac3aabe43ea5a51

 nimble/controller/src/ble_ll_scan.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit f8a1544189a6b5d408a2480da77c074e120b5fc2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 26 03:04:06 2017 +0200

    nimble/controller: Add support for extended scan
    
    This patch adds support to set extended scan parameters and to enable
    extended scan
    
    X-Original-Commit: 1e9875bcdbce3544c9b267f75aa03c5230d59c10

 nimble/controller/include/controller/ble_ll_scan.h |   9 +-
 nimble/controller/src/ble_ll_hci.c                 |  10 +-
 nimble/controller/src/ble_ll_scan.c                | 138 ++++++++++++++++++++-
 3 files changed, 150 insertions(+), 7 deletions(-)

commit 1cd9839188ab7c8ca914d4658e4407c58cb837ef
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 9 15:21:32 2017 +0200

    nimble/controller: Enhance scansm for future support of Bluetooth 5.0
    
    We are going to have array of struct ble_ll_scan_sm.
    First array element is reserved for PHY_1M and second for PHY_CODED
    
    X-Original-Commit: b6cb09b7f0d7816c45732b208abbe0fbeff0bcbd

 nimble/controller/include/controller/ble_ll_scan.h |  28 ++++--
 nimble/controller/src/ble_ll_scan.c                | 107 ++++++++++++++-------
 nimble/syscfg.yml                                  |   3 +
 3 files changed, 97 insertions(+), 41 deletions(-)

commit 54129ea32b09932cffd8963838d6ec5b4b91a5e4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 9 15:18:16 2017 +0200

    nimble/controller: Fix compiler warning
    
    X-Original-Commit: 1de334518ac1cec120ec961969a3450caeb71872

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2c99e3914476f630e5a85b771aff35f93e68e6e1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jun 2 15:45:13 2017 +0200

    nimble/controller/phy: Move helper function to header
    
    This is because we will need it from other places in the controller code
    
    X-Original-Commit: 8458335d52d249044f80c2e7a5f6ce9cf90a99e7

 nimble/controller/include/controller/ble_phy.h | 21 +++++++++++++++++++++
 nimble/controller/src/ble_ll_conn.c            | 25 ++-----------------------
 2 files changed, 23 insertions(+), 23 deletions(-)

commit 202d4dd97c258bd4e9f471dec84fb4a81b56d0c8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue May 16 21:35:20 2017 +0200

    nimble/controller: Minor fix: Keep consistent function names
    
    X-Original-Commit: f6c0ea9484fe946ffaab6570257692acb2734aef

 nimble/host/src/ble_gap.c         |  6 +++---
 nimble/host/src/ble_hs_hci_cmd.c  | 18 +++++++++---------
 nimble/host/src/ble_hs_hci_priv.h |  8 ++++----
 nimble/host/src/ble_hs_pvcy.c     |  2 +-
 4 files changed, 17 insertions(+), 17 deletions(-)

commit 5d6a0a9e8124e24a09feb78e62daf5980bc4a82f
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon Jun 5 00:46:04 2017 +0200

    nimble/controller: Add proper conn event scheduling for secondary adv ch
    
    X-Original-Commit: 02f7512a706d1728f9c18d142778427b71a4844b

 nimble/controller/src/ble_ll_sched.c | 41 ++++++++++++++++++++++++++++++++++--
 nimble/drivers/nrf52/src/ble_phy.c   |  1 +
 nimble/include/nimble/ble.h          |  1 +
 3 files changed, 41 insertions(+), 2 deletions(-)

commit 5b4f3d88916ed53d6dcd33199ff4f317f8bbdc48
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jun 2 15:36:05 2017 +0200

    nimble/controller: Add current phy getter
    
    X-Original-Commit: 66032b507fcadfab4f2c6c7b37eb6bfba89c5b1e

 nimble/controller/include/controller/ble_phy.h |  1 +
 nimble/drivers/nrf52/src/ble_phy.c             | 17 +++++++++++++++++
 2 files changed, 18 insertions(+)

commit b60c13b54f68b21b9934bf30f97171cea127989b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jun 2 11:29:11 2017 +0200

    nimble/controller: Adjust TX size to fit in maxTxTime
    
    X-Original-Commit: e33d566cb41276466c40d91245d2cc055726eeb7

 nimble/controller/src/ble_ll_conn.c | 50 +++++++++++++++++++++++++------------
 1 file changed, 34 insertions(+), 16 deletions(-)

commit 284262475b17bce60322a9d47cede94089d39988
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu May 25 12:46:20 2017 +0200

    nimble/controller: Store max TX octets in each PHY mode
    
    This patch adds store for max TX octets that can be transferred in each
    PHY mode taking connEfectiveTxTime into account. This allow to access
    this value quickly without need to calculate it over and over again.
    
    X-Original-Commit: 1f6f210d18c08680c59349b9e531e3b00e158322

 nimble/controller/include/controller/ble_ll_conn.h |  1 +
 nimble/controller/src/ble_ll_conn.c                | 21 +++++++++++++++++++++
 2 files changed, 22 insertions(+)

commit a3fc2f6d3a04480c5e99da14f5dca6c12807950a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 24 17:43:57 2017 +0200

    nimble/controller: Add helper to calculate payload octets per TX time
    
    We will need this to check constraints when txing PDU over the air which
    is now not in place, but is apparently important when changing PHYs.
    
    X-Original-Commit: 8784789ea821cdfe8ad33ba973ad2ca6d8113438

 nimble/controller/include/controller/ble_ll.h |  3 +++
 nimble/controller/src/ble_ll.c                | 36 +++++++++++++++++++++++++++
 2 files changed, 39 insertions(+)

commit 6b7eab8b11bc79801a2d973581989b5a0ef99049
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 24 17:58:03 2017 +0200

    nimble/controller: Make PDU header TX times easily accessible
    
    We store TX time of PDU header on any PHY in global array so it can be
    easily accessible - makes code which uses it easier to follow.
    
    X-Original-Commit: c2d204f49ca258b23b84d30c3d8146c29d981765

 nimble/controller/src/ble_ll.c | 44 ++++++++++++++++++++++++++----------------
 1 file changed, 27 insertions(+), 17 deletions(-)

commit ec2903bf7c20f896892e8ec419166fd96515ff1a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 24 17:47:15 2017 +0200

    nimble/controller: Make number of PHY modes a common definition
    
    The number of PHY modulations (or PHY modes - changed to follow other
    names) is the same regardless of phy implementation used so move it to
    ble_phy.h.
    
    X-Original-Commit: 8d4f5c0cc81977d9db3658580de4b11b27d18a57

 nimble/controller/include/controller/ble_phy.h | 3 +++
 nimble/drivers/nrf52/src/ble_phy.c             | 5 +----
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 004df08a6645e34599cf3113b9e6c6e2819328cb
Merge: de78fc0d b0b7c112
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Jun 22 09:23:10 2017 +0200

    Merge pull request #293 from michal-narajowski/btshell
    
    apps/btshell: add bletiny clone that uses new shell
    
    X-Original-Commit: 2c4980afe34ca9ebde2f693c1c7962a683cd3ec8

commit de78fc0d5ae63ff91363d8bb8b9eea314d50e702
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 20 14:36:47 2017 -0700

    BLE Host - decrease dflt mtu; make cfgable.
    
    This commit introduces two changes:
    
    1. Reduce the default preferred ATT MTU from 527 to 256.  This is
    desirable because supporting such a large MTU requires more mbuf space
    than the example apps allocate.  Furthermore, such a large MTU requires
    more stack space from higher layer protocols.
    
    2. Make default preferred MTU configurable via the following syscfg
    setting:
    
        BLE_ATT_PREFERRED_MTU:
            description: The preferred MTU to indicate in MTU exchange commands.
            value: 256
    
    X-Original-Commit: d2dc333d75ab751dc7b64116bb744649d6f5acf2

 nimble/host/include/host/ble_att.h      | 1 -
 nimble/host/src/ble_att.c               | 2 +-
 nimble/host/syscfg.yml                  | 4 ++++
 nimble/host/test/src/ble_hs_conn_test.c | 6 +++---
 4 files changed, 8 insertions(+), 5 deletions(-)

commit b0b7c112a9ac1add5da2e87283588578a7b44576
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Thu Apr 6 15:29:04 2017 +0200

    nimble/host: add api to print local gatt server database
    
    X-Original-Commit: 1b1c40d9d5e28d1a31690d9a7e288a8399f2099f

 nimble/host/include/host/ble_gatt.h |   6 ++
 nimble/host/src/ble_gatts.c         |  12 +++
 nimble/host/src/ble_gatts_lcl.c     | 164 ++++++++++++++++++++++++++++++++++++
 3 files changed, 182 insertions(+)

commit aaa684008f00d82033e723f5ce0c60f021bc8dad
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 19 11:45:59 2017 -0700

    MYNEWT-751 Make ble_store_status() private.
    
    Now ble_store_status() is private; it only gets called by the following
    new functions:
    
        int ble_store_overflow_event(int obj_type,
                                     const union ble_store_value *value);
        int ble_store_overflow_next_event(int obj_type, uint16_t conn_handle);
    
    X-Original-Commit: 049ee0a22b3db64d787bdd6fa40c9edcf8487ef7

 nimble/host/include/host/ble_store.h |  3 ++-
 nimble/host/src/ble_sm.c             |  7 +------
 nimble/host/src/ble_store.c          | 32 ++++++++++++++++++++++++++------
 3 files changed, 29 insertions(+), 13 deletions(-)

commit d410bf96d15438e01a68fe83172f48203f10faca
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 5 14:34:14 2017 -0700

    MYNEWT-751 - Slight change to internal function.
    
    This change affects the ble_sm_chk_store_overflow_once() function as
    follows:
    
    1. Rename to ble_sm_chk_store_overflow_by_type()
    2. Change first parameter from a boolean (is_our_sec) to a numeric code
    (obj_type).
    
    X-Original-Commit: db4d5a18615f4a3a0e8633299be3268689446480

 nimble/host/src/ble_sm.c | 15 +++++----------
 1 file changed, 5 insertions(+), 10 deletions(-)

commit 04ba711dba4027016beb3124835deae70fb66c3a
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 19 11:51:40 2017 -0700

    MYNEWT-751 BLE Host - Policy for SM key overflow
    
    X-Original-Commit: 9bd533000dff3ba0a4d7e00e3e08bb8a05166703

 nimble/host/include/host/ble_hs.h         |  11 +++
 nimble/host/include/host/ble_store.h      |  61 ++++++++++++
 nimble/host/src/ble_sm.c                  | 156 ++++++++++++++++++++++++------
 nimble/host/src/ble_sm_priv.h             |   4 +-
 nimble/host/src/ble_store.c               |  59 ++++++++++-
 nimble/host/src/ble_store_util.c          |  89 +++++++++++++++++
 nimble/host/store/ram/src/ble_store_ram.c |  10 +-
 nimble/host/test/src/ble_sm_test.c        |   2 +-
 nimble/host/test/src/ble_sm_test_util.c   | 138 +++++++++++++-------------
 nimble/host/test/src/ble_store_test.c     | 153 ++++++++++++++++++++++++++++-
 10 files changed, 568 insertions(+), 115 deletions(-)

commit 52f431db7250475ed816dbd8b7a7adb27374c013
Merge: 95dc9bbf 327e5e59
Author: ccollins476ad <ccollins476ad@gmail.com>
Date:   Fri Jun 16 13:20:12 2017 -0700

    Merge pull request #287 from ccollins476ad/repeat-pairing
    
    Repeat pairing
    
    X-Original-Commit: 1a077e85df3963a1033fdc53d8f4e3d00684d2ab

commit 9dcf3f348f5cb86ff0dd12d2f727948748a8b6dc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 24 17:22:22 2017 +0200

    nimble/controller: Move helpers for PDU duration from phy to ll
    
    PDU transmit times are independent of PHY implementation and are defined
    at LL level so move helpers used to calculate these to LL. Also they are
    used only in LL so this makes sense.
    
    The LL API already has ble_ll_pdu_tx_time_get() prototype which is not
    even implemented, but since this is a nice name we'll keep it.
    
    X-Original-Commit: 200f44ef28f1db8c2ac19799deaeb9944f535f7b

 nimble/controller/include/controller/ble_ll.h  | 12 +++++--
 nimble/controller/include/controller/ble_phy.h |  5 ---
 nimble/controller/src/ble_ll.c                 | 38 ++++++++++++++++++++
 nimble/controller/src/ble_ll_adv.c             |  2 +-
 nimble/controller/src/ble_ll_conn.c            | 21 +++++------
 nimble/drivers/nrf52/src/ble_phy.c             | 48 --------------------------
 6 files changed, 60 insertions(+), 66 deletions(-)

commit fde83b6f2f245126886298ca2bc25065e9977eff
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 24 16:11:19 2017 +0200

    nimble/controller: Fix applying PHY Options in LE Set PHY
    
    We need to fully validate parameters in LE Set PHY before setting new
    PHY Options as otherwise we may return error to host, but update options
    anyway.
    
    X-Original-Commit: bb473daf33e84139dba2ebe7d5b7ef63cb39409e

 nimble/controller/src/ble_ll_conn_hci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e82c4cb9112e31af18778b8b91c2121a6653d377
Merge: 3a551c56 95dc9bbf
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jun 13 14:08:11 2017 +0200

    Merge branch 'master' into bluetooth5_master
    
    X-Original-Commit: 669d73dc83c910b7d8cb333ae6e8d9a1ca6d4473

commit 95dc9bbf8d7e90c4f389d229d0e6d8ea67d22cc1
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 8 14:59:25 2017 -0700

    BLE Host - Make ble_hs_sched_reset()
    
    This function is needed by the blehostd app.  More generally, the
    ability to reset the host may be useful to other apps.
    
    X-Original-Commit: abd9e63feab54b3ac614f6957a48acd6fbb0562e

 nimble/host/include/host/ble_hs.h | 1 +
 nimble/host/src/ble_hs_priv.h     | 1 -
 2 files changed, 1 insertion(+), 1 deletion(-)

commit 7dc237a8ee60af555f290fd0a0213d3a910bc396
Merge: 5cbefd23 52e21705
Author: Szymon Janc <szymon.janc@gmail.com>
Date:   Thu Jun 8 21:41:43 2017 +0200

    Merge pull request #311 from wes3/myn738
    
    MYNEWT-738: Fix parameter arrays
    
    X-Original-Commit: f0ca77a427f0aca30400b71a21f3206471a878fa

commit 5cbefd23a6d6bade0852f6571643e9e9b0217c68
Merge: 75ac749f f5919407
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 7 17:56:59 2017 -0700

    This closes #310.
    
    Merge remote-tracking branch 'ccollins476ad/indicate-custom'
    
    * ccollins476ad/indicate-custom:
      Fix typo ("ACM" should be "ACL").
      MYNEWT-550 Add ble_gattc_indicate_custom()
      MYNEWT-550 Signal GAP event for custom notifies.
    
    X-Original-Commit: be089fcd5b36c6ae2e24c157be111ab47721a100

commit f5919407d353866ed164860327ad101311540f54
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 5 18:53:10 2017 -0700

    Fix typo ("ACM" should be "ACL").
    
    X-Original-Commit: c5b035d16bf8f40f3eea27445f4970488a6e0314

 nimble/host/src/ble_hs_hci.c       | 2 +-
 nimble/host/src/ble_hs_mbuf.c      | 8 ++++----
 nimble/host/src/ble_hs_mbuf_priv.h | 2 +-
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 7a1d8ec85303bda298399307fc7f11865d1fadc5
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 5 18:50:07 2017 -0700

    MYNEWT-550 Add ble_gattc_indicate_custom()
    
    X-Original-Commit: 314d7ab58e7a90b2db5c2fd2424ab8b62cf3b198

 nimble/host/include/host/ble_gatt.h          |  2 +
 nimble/host/src/ble_gattc.c                  | 61 +++++++++++++++++++---------
 nimble/host/test/src/ble_gatts_notify_test.c | 25 +++++++++++-
 3 files changed, 67 insertions(+), 21 deletions(-)

commit 75ac749f1bcb5f7c00cd53c61b15128bb86faf75
Merge: 81cc455c 083bc634
Author: wes3 <wills@runtime.io>
Date:   Wed Jun 7 09:35:50 2017 -0700

    Merge branch 'master' into myn689
    
    X-Original-Commit: e7a2fdfcdc4a479c80297bc1ea62e1da290f72e9

commit 81cc455c1428e313de885611f7254b5314e520c9
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 30 13:56:22 2017 -0700

    MYNEWT-772 BLE Host - Rsrvd bits in set-event-mask
    
    The host intends to enable the following events at start up:
    
        /**
         * Enable the following events:
         *     0x0000000000000001 Inquiry Complete Event
         *     0x0000000000000002 Inquiry Result Event
         *     0x0000000000000004 Connection Complete Event
         *     0x0000000000000008 Connection Request Event
         *     0x0000000000000010 Disconnection Complete Event
         *     0x0000000000000020 Authentication Complete Event
         *     0x0000000000000040 Remote Name Request Complete Event
         *     0x0000000000000080 Encryption Change Event
         *     0x0000000000000100 Change Connection Link Key Complete Event
         *     0x0000000000000200 Master Link Key Complete Event
         *     0x0000000000000400 Read Remote Supported Features Complete Event
         *     0x0000000000000800 Read Remote Version Information Complete Event
         *     0x0000000000001000 QoS Setup Complete Event
         *     0x0000000000002000 Reserved
         *     0x0000000000004000 Reserved
         *     0x0000000000008000 Hardware Error Event
         *     0x0000000000010000 Flush Occurred Event
         *     0x0000000000020000 Role Change Event
         *     0x0000000000040000 Reserved
         *     0x0000000000080000 Mode Change Event
         *     0x0000000000100000 Return Link Keys Event
         *     0x0000000000200000 PIN Code Request Event
         *     0x0000000000400000 Link Key Request Event
         *     0x0000000000800000 Link Key Notification Event
         *     0x0000000001000000 Loopback Command Event
         *     0x0000000002000000 Data Buffer Overflow Event
         *     0x0000000004000000 Max Slots Change Event
         *     0x0000000008000000 Read Clock Offset Complete Event
         *     0x0000000010000000 Connection Packet Type Changed Event
         *     0x0000000020000000 QoS Violation Event
         *     0x0000000040000000 Page Scan Mode Change Event [deprecated]
         *     0x0000000080000000 Page Scan Repetition Mode Change Event
         *     0x0000000100000000 Flow Specification Complete Event
         *     0x0000000200000000 Inquiry Result with RSSI Event
         *     0x0000000400000000 Read Remote Extended Features Complete Event
         *     0x0000080000000000 Synchronous Connection Complete Event
         *     0x0000100000000000 Synchronous Connection Changed Event
         *     0x0000800000000000 Encryption Key Refresh Complete Event
         *     0x2000000000000000 LE Meta-Event
         */
    
    It does this by setting the following bit mask: 0x20009fffffffffff. This
    mask is incorrect; it should be: 0x20009807ffffffff
    
    X-Original-Commit: 17ddd9e19ee0c5ea82e086f05b6c16208951275a

 nimble/host/src/ble_hs_startup.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 083bc634f77e5e9f26d0ce388b0d2d3e45103921
Merge: b2d90df8 e9a60cec
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 6 14:45:44 2017 -0700

    This closes #307.
    
    Merge branch 'rsrvd-event-mask'
    
    * rsrvd-event-mask:
      MYNEWT-772 BLE Host - Rsrvd bits in set-event-mask
    
    X-Original-Commit: 76ff74b5a7cceb713a46350cd7329561e4321558

commit 52e2170575158df036a25df13a752576e640146d
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jun 6 13:56:04 2017 -0700

    MYNEWT-738: Fix parameter arrays
    
    This code change fixes our incorrect interpretation of the BLE
    specification regarding parameter arrays when parsing
    advertising reports.
    
    X-Original-Commit: c921fd5c652fad3505d598f14f53441d4be32566

 nimble/host/src/ble_hs_hci_evt.c | 68 +++++++++++++++-------------------------
 1 file changed, 25 insertions(+), 43 deletions(-)

commit b2d90df8c9bba05f1a4a38eec02ecafacf35ac13
Merge: 111c2fae 6b20018b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jun 6 05:42:13 2017 +0200

    Merge pull request #296 from jacobrosenthal/gap-log
    
    Improve gap logging
    
    X-Original-Commit: 6ec8616fe897a065e4cf3bfee210ba75b5419c1a

commit c6d7cc6f21fcbc7d489a97b4abe8f683e3478163
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 5 18:49:25 2017 -0700

    MYNEWT-550 Signal GAP event for custom notifies.
    
    Prior to this change, only "non-custom" notifications signalled a GAP
    event.  This is not right; all outgoing notifications should be
    indicated to the application.
    
    X-Original-Commit: 7bf8bf314891b3ee0b08ce76d7a9ed28fa061d32

 nimble/host/src/ble_gattc.c                  | 16 +++++++---------
 nimble/host/test/src/ble_gatts_notify_test.c | 20 +++++++++++++++++++-
 2 files changed, 26 insertions(+), 10 deletions(-)

commit 111c2faeb924e3cbaecda61f1fbd50aee1721de8
Author: jacobrosenthal <jacobrosenthal@localhost.localdomain>
Date:   Thu May 25 17:24:38 2017 -0700

    ibeacon: add fields.flags
    
    X-Original-Commit: b8d0a1645995f7ff5e2601db692daeeaef34e194

 nimble/host/src/ble_ibeacon.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit e9a60cec0ba8021b10c743c044edc0aacccec887
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 30 13:56:22 2017 -0700

    MYNEWT-772 BLE Host - Rsrvd bits in set-event-mask
    
    The host intends to enable the following events at start up:
    
        /**
         * Enable the following events:
         *     0x0000000000000001 Inquiry Complete Event
         *     0x0000000000000002 Inquiry Result Event
         *     0x0000000000000004 Connection Complete Event
         *     0x0000000000000008 Connection Request Event
         *     0x0000000000000010 Disconnection Complete Event
         *     0x0000000000000020 Authentication Complete Event
         *     0x0000000000000040 Remote Name Request Complete Event
         *     0x0000000000000080 Encryption Change Event
         *     0x0000000000000100 Change Connection Link Key Complete Event
         *     0x0000000000000200 Master Link Key Complete Event
         *     0x0000000000000400 Read Remote Supported Features Complete Event
         *     0x0000000000000800 Read Remote Version Information Complete Event
         *     0x0000000000001000 QoS Setup Complete Event
         *     0x0000000000002000 Reserved
         *     0x0000000000004000 Reserved
         *     0x0000000000008000 Hardware Error Event
         *     0x0000000000010000 Flush Occurred Event
         *     0x0000000000020000 Role Change Event
         *     0x0000000000040000 Reserved
         *     0x0000000000080000 Mode Change Event
         *     0x0000000000100000 Return Link Keys Event
         *     0x0000000000200000 PIN Code Request Event
         *     0x0000000000400000 Link Key Request Event
         *     0x0000000000800000 Link Key Notification Event
         *     0x0000000001000000 Loopback Command Event
         *     0x0000000002000000 Data Buffer Overflow Event
         *     0x0000000004000000 Max Slots Change Event
         *     0x0000000008000000 Read Clock Offset Complete Event
         *     0x0000000010000000 Connection Packet Type Changed Event
         *     0x0000000020000000 QoS Violation Event
         *     0x0000000040000000 Page Scan Mode Change Event [deprecated]
         *     0x0000000080000000 Page Scan Repetition Mode Change Event
         *     0x0000000100000000 Flow Specification Complete Event
         *     0x0000000200000000 Inquiry Result with RSSI Event
         *     0x0000000400000000 Read Remote Extended Features Complete Event
         *     0x0000080000000000 Synchronous Connection Complete Event
         *     0x0000100000000000 Synchronous Connection Changed Event
         *     0x0000800000000000 Encryption Key Refresh Complete Event
         *     0x2000000000000000 LE Meta-Event
         */
    
    It does this by setting the following bit mask: 0x20009fffffffffff. This
    mask is incorrect; it should be: 0x20009807ffffffff
    
    X-Original-Commit: a56d659361fc25ac75fca399ac89838cc5847b74

 nimble/host/src/ble_hs_startup.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 04fb48f9b8435aebc8418ccb884e85bd22be2ca8
Merge: 02322e1f 0bc61d1a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed May 31 09:58:23 2017 +0200

    Merge pull request #255 from ccollins476ad/ble-preserve-ota
    
    BLE Host - Fix peer OTA addr and type on pairing.
    
    X-Original-Commit: 591068c0db53e4276125f1b8b2a46dfa680f7ff2

commit 327e5e59da37c62f1b3daedac3514b7747e6337a
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 23 17:49:48 2017 -0700

    MYNEWT-750 Fix build when SM disabled.
    
    X-Original-Commit: 729c34e4e2f692a9c5fc4a8d4024b91eff856358

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 915d370c0b264e78fa410b1b961e6ce1c9c9002b
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 17 15:13:43 2017 -0700

    MYNEWT-750 BLE Host - Ignore pair from bonded peer
    
    If a device is already bonded, ;he host should not allow the same device
    to pair again. Currently, the host blindly proceeds with the pairing
    operation. This should not be allowed because the second peer could be
    an imposter masquerading as the original.
    
    New behavior in such a scenario:
    
    1. Host notifies application of the duplicate pairing attempt via the
    gap event callback. The callback specifies a new event code
    (BLE_GAP_EVENT_REPEAT_PAIRING) that specifically indicates a duplicate
    pairing attempt.
    
    2. The gap event callback returns an error code indicating which
    of the following behaviors to perform:
    
        a. Retry: Return BLE_GAP_REPEAT_PAIRING_RETRY after deleting the
           conflicting bond. The stack will verify the bond has been deleted
           and continue the pairing procedure. If the bond is still present,
           this event will be reported again.
    
        b. Ignore: Return BLE_GAP_REPEAT_PAIRING_IGNORE. The stack will
           silently ignore the pairing request.
    
    X-Original-Commit: b6d96411b6af18360c5a8fc4f8d31d473b99118a

 nimble/host/include/host/ble_gap.h      |  39 ++++
 nimble/host/include/host/ble_sm.h       |   1 -
 nimble/host/src/ble_gap.c               |  17 ++
 nimble/host/src/ble_gap_priv.h          |   1 +
 nimble/host/src/ble_sm.c                | 227 ++++++++++++------
 nimble/host/test/src/ble_sm_test_util.c | 398 ++++++++++++++++++++++++++------
 nimble/host/test/src/ble_sm_test_util.h |   1 +
 7 files changed, 542 insertions(+), 142 deletions(-)

commit ecbdb915656987c2e62fdfd6bbe3efa045a20ade
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 17 15:40:03 2017 -0700

    MYNEWT-750 - Authenticated flag incorrect.
    
    We would persist the authenticated flag if either peer supported
    authentication.  We should only persist it if both support it.
    
    X-Original-Commit: 6e380728c1382e679e2c6967e6820dfc4f48b116

 nimble/host/src/ble_sm_lgcy.c           | 12 ++++++++++--
 nimble/host/src/ble_sm_sc.c             | 12 ++++++++++--
 nimble/host/test/src/ble_sm_lgcy_test.c |  2 +-
 3 files changed, 21 insertions(+), 5 deletions(-)

commit 92c7b67000e477c895c7152223a88b93e858e39a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 17 15:38:07 2017 -0700

    MYNEWT-750 BLE Host - Persist SC flag for bonds.
    
    X-Original-Commit: 9572c52fa2a0c67b6a2a15ec3dca4501fd24a29b

 nimble/host/include/host/ble_store.h | 7 ++++---
 nimble/host/src/ble_sm.c             | 8 ++++++--
 2 files changed, 10 insertions(+), 5 deletions(-)

commit c9fc6ccd504df8c30684beb02d10856740ea6d55
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 17 10:34:36 2017 -0700

    MYNEWT-750 Fix some coding style issues.
    
    X-Original-Commit: cb7782d7b4f322799510d293a23a65061244f6c8

 nimble/host/src/ble_sm.c                |  5 +--
 nimble/host/test/src/ble_sm_test_util.c | 59 +++++++++++++++++++++------------
 2 files changed, 40 insertions(+), 24 deletions(-)

commit 02322e1f0da1484f555c6c1dbc1fb87e99157cf4
Author: Pierre Kircher <pkircher@me.com>
Date:   Tue May 30 15:07:20 2017 +0100

    double include nrf52_bitfields.h
    
    X-Original-Commit: 9eaac82277870403a990add9171b12592a99b18d

 nimble/drivers/nrf52/src/ble_hw.c | 2 --
 1 file changed, 2 deletions(-)

commit 6b20018bdeada3733da2688e2dda737ea1fff22b
Author: Jacob Rosenthal <jakerosenthal@gmail.com>
Date:   Fri May 26 19:19:57 2017 -0700

    nimble: gap slave remove unused struct items
    
    X-Original-Commit: bc32f03a046ce2a5da94e9cca6f30baade8180bf

 nimble/host/src/ble_gap.c | 11 ++---------
 1 file changed, 2 insertions(+), 9 deletions(-)

commit 1cab82f7c066f42629d08050be743523ec26dde0
Author: Jacob Rosenthal <jakerosenthal@gmail.com>
Date:   Fri May 26 19:13:21 2017 -0700

    nimble: fix gap logging on advertise
    
    X-Original-Commit: e435fdfd5c983917c098ae97b8387123e68b9a26

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 290d19f3e907025bd8a0c0bfd34583dc715496d0
Merge: afcabd35 3d60c8c0
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 25 17:53:12 2017 -0700

    This closes #292.
    
    Merge remote-tracking branch 'rymanluk/fix_double_free'
    
    * rymanluk/fix_double_free:
      nimble/sm: Fix passing rx_buf to the sm callback
      nimble/l2cap: Fix double free when calling ble_l2cap_discard_rx
    
    X-Original-Commit: 16323b514bc7dd45db9db163e24f477b3c2082ae

commit 3d60c8c007496c2dca2da0e763321b7dec325c66
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed May 24 13:17:53 2017 +0200

    nimble/sm: Fix passing rx_buf to the sm callback
    
    This patch makes sure that address of rx_buf is passed correctly
    to sm callback.
    
    X-Original-Commit: b31d9efd00474315f4cdaf8c40b23ecd8822ed3a

 nimble/host/src/ble_sm.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit afcabd3572d0c1340b9f8d4ee7ed8ceff5c6faa0
Merge: e356a09c 2a6c7374
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed May 24 10:19:59 2017 +0200

    This closes #290
    
    X-Original-Commit: 69a7889677a1b4452c530c00d456f1300ab41738

commit c05770222092acd587483fbdd6b74b359f8db29d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed May 24 09:31:19 2017 +0200

    nimble/l2cap: Fix double free when calling ble_l2cap_discard_rx
    
    With this patch we remove ble_l2cap_discard_rx and ble_l2cap_forget_rx
    and replace them by ble_l2cap_remove_rx.
    
    This is because those two mentioned functions want to do exactly the
    same thing: free rxbuf from channel and remove all the rx channel
    information from conn.
    
    X-Original-Commit: a51bec6cb535a3513678b37dfa514b0716bfab33

 nimble/host/src/ble_hs_hci_evt.c        |  2 +-
 nimble/host/src/ble_l2cap.c             | 13 +++----------
 nimble/host/src/ble_l2cap_priv.h        |  3 ++-
 nimble/host/test/src/ble_hs_test_util.c |  2 +-
 4 files changed, 7 insertions(+), 13 deletions(-)

commit 2a6c7374794fd4b7eda147bde3af6b3b417ff7a8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 23 10:17:24 2017 +0200

    nimble/controller: Fix setting parameters for scanning
    
    Parameters set by HCI LE Set Scan Parameters should be stored and then
    applied each time scan is enabled using HCI LE Set Scan Enable. This way
    scan uses proper parameters as set by host.
    
    Without this fix scan parameters in SM will be overwritten when
    initiating new connection. Since also scan type is set to 'initiating'
    in such case, no advertising reports will be sent to host until scan
    parameters are set once more by the host.
    
    X-Original-Commit: 75770c86bd1d988e9bb2e2b5af1cd3c9b7af7963

 nimble/controller/include/controller/ble_ll_scan.h |  9 ++++++
 nimble/controller/src/ble_ll_scan.c                | 34 +++++++++++++++++-----
 2 files changed, 35 insertions(+), 8 deletions(-)

commit e356a09cd4fffc6c8bec1c17576b6ea8108ab0ad
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue May 23 11:23:48 2017 +0200

    nimble/host: fix find by address when addr is NULL
    
    Addr is NULL when sending le connection request using whitelist.
    Error occurs on bsp/native when trying to do ble_addr_cmp
    with NULL addr. There is segmentation fault when reading from NULL.
    
    X-Original-Commit: 536fee4310fadeb5a10732cbbca67593bd22ae44

 nimble/host/src/ble_hs_conn.c | 4 ++++
 1 file changed, 4 insertions(+)

commit ea54e59a83ed42808f45e9435565684f10dff263
Merge: de749c27 a9a953db
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 18 16:56:23 2017 -0700

    This closes #277.
    
    Merge branch 'key-overflow'
    
    * key-overflow:
      MYNEWT-754 BLE Host - Support deleting of CCCDs.
      MYNEWT-754 BLE Host - Basic store util unit tests.
      MYNEWT-754 BLE Host - Add some missing consts.
      MYNEWT-754 BLE Host - Store mgmt API additions
      MYNEWT-754 BLE Host - iterate: return err on fail
      MYNEWT-754 BLE host - addrcmp ignores padding.
      MYNEWT-754 BLE host - Store cb can abort iterate.
      MYNEWT-754 BLE Host - cfgable RAM store capacity
    
    X-Original-Commit: c7d7a0ebf294af93ff298f244863645be3d01c12

commit 3a551c569a8386d98af41ae099f925f8056ba445
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 16 12:12:47 2017 +0200

    nimble/phy: Ugly hack for TX/RX transition timing
    
    Calculated RX time after TX/RX transition seems to be too short for
    Coded PHY - not sure why, but adding extra 32us solves the problem.
    
    This is temporary fix until we figure out what is really wrong.
    
    X-Original-Commit: 5a8f5168d264bf8c9e12eb4a2848cc85c1a5e6ea

 nimble/drivers/nrf52/src/ble_phy.c | 8 ++++++++
 1 file changed, 8 insertions(+)

commit d4fb1cbc3152596a23fef16499926b4897def3b2
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 15 18:01:41 2017 +0200

    nimble/phy: Fix access address configuration
    
    Currently logical address 0 was preconfigured for advertising and
    address 1 was used for connection. This works fine for 1M and 2M PHYs
    but for unknown reason nRF52 does not receive anything when using
    logical address 1 on Coded PHY.
    
    Althoough it works fine on Coded PHY with swapped logical addresses,
    let's just use logical address 0 for everything instead so we don't
    have problems soon again with scanning on Coded PHY.
    
    X-Original-Commit: af6be360a1589a3beccd02dc8943ccad1f2d41e2

 nimble/drivers/nrf52/src/ble_phy.c | 50 +++++++++++++++++++++++---------------
 1 file changed, 30 insertions(+), 20 deletions(-)

commit 48f9cd418d833b27892123259dd371594e7f9dc8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 15 17:21:58 2017 +0200

    nimble/phy: Fix CRC poly configuration
    
    It works now probably because 8 MSb in CRCPOLY registers are unused
    in nRF52 (for now).
    
    X-Original-Commit: aa387adda43fccdf0eb141b7ee2f5985624d0670

 nimble/drivers/nrf52/src/ble_phy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3680ced61d7b8b9dfbd9b9f998faf04b8c9833bc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Mon May 15 17:21:45 2017 +0200

    nimble/phy: Fix CRC configuration
    
    The SKIPADDR field has allowed values 0, 1 and 2 - for unknown reason
    it works even if set to 3 as we do, but better have this configured
    properly.
    
    X-Original-Commit: 01308580e7f673b38fdcfbb8642c223cfce36910

 nimble/drivers/nrf52/src/ble_phy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3e2e34de33adfbac1f5d13595611463f6a162008
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri May 12 10:58:54 2017 +0200

    nimble/phy: Cleanup PCNF0 settings
    
    This patch makes PCNF0 settings explicit to make code easier to read:
    - always set S1LEN (even though it is predefined to 0)
    - set PLEN in ble_phy_mode_set for each case (do not make "implicit" set
      to 8bits in ble_phy_init)
    
    X-Original-Commit: c91bd6cf8a57bf67ab6bfd4c19365106af270545

 nimble/drivers/nrf52/src/ble_phy.c | 22 ++++++++++++----------
 1 file changed, 12 insertions(+), 10 deletions(-)

commit 66dceff5bc82fb9eaf1e5dcdd237c32866e75fd4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Apr 29 00:55:31 2017 +0200

    nimble/controller: Add configuration for LE Coded PHY
    
    This patch adds nRF52 configuration for LE Coded PHY.
    
    X-Original-Commit: 24131d55f6f67f7015f7098d7fb2a3004abb6a84

 nimble/controller/src/ble_ll_conn.c |  4 +++-
 nimble/drivers/nrf52/src/ble_phy.c  | 40 ++++++++++++++++++++++++++++++++-----
 2 files changed, 38 insertions(+), 6 deletions(-)

commit 2ae275fc9989b261b6796dbb608c0c294d07bd0c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed May 10 17:58:23 2017 +0200

    nimble/controller: Add access address constraints for LE Coded PHY
    
    X-Original-Commit: 1f5c04d24b144de3cbccfa422ca7f26a2641f261

 nimble/controller/src/ble_ll_conn.c | 23 ++++++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)

commit e3690aafbe170501470afc73d643e90459659741
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 9 15:43:47 2017 +0200

    nimble/controller: Fix setting LE Coded PHY feature flag
    
    X-Original-Commit: b07f4a7fe11517b1d8b4272eb59ad662a84df452

 nimble/controller/src/ble_ll.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3391831716ec41de4935b54f475ffdce74c150b3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 9 14:51:22 2017 +0200

    nimble/controller: Cleanup PHY symbols names
    
    To avoid confusion which phy-value goes where, let's use following
    terms in LL code:
    - phy = numeric PHY value (1M, 2M, Coded => 1, 2, 3)
    - phy_mask = PHY bitmask (1M, 2M, Coded -> 0x01, 0x02, 0x04)
    - phy_mode = actual PHY used in radio (1M, 2M, Coded S=2, Coded S=8)
    
    Values for phy and phy_mask are the same as used in HCI and LL so can
    be exchanged between layers.
    
    Value for phy_mode is calculated from phy and phy_options using helper.
    
    This patch adjusts various symbols names to the above, so in case e.g.
    phy-variable is assigned to phy_mode-variable directly somewhere, this
    potentially could indicate there is some issue in code.
    
    X-Original-Commit: 8ae34ada1413714da929b709d2cbe5b25b8d38fe

 nimble/controller/include/controller/ble_ll_conn.h |  8 +-
 nimble/controller/include/controller/ble_phy.h     | 32 +++++---
 nimble/controller/src/ble_ll_adv.c                 |  4 +-
 nimble/controller/src/ble_ll_conn.c                | 88 +++++++++++++---------
 nimble/controller/src/ble_ll_conn_hci.c            |  4 +-
 nimble/controller/src/ble_ll_ctrl.c                | 62 +++++++--------
 nimble/controller/src/ble_ll_scan.c                |  2 +-
 nimble/controller/src/ble_ll_sched.c               |  4 +-
 nimble/drivers/nrf51/src/ble_phy.c                 | 14 ++--
 nimble/drivers/nrf52/src/ble_phy.c                 | 57 +++++++-------
 10 files changed, 152 insertions(+), 123 deletions(-)

commit a0b7168f94a8b91695eddca5e1e693dec47003cf
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue May 9 15:21:17 2017 +0200

    nimble/controller: Fix applying PHY update
    
    New m_to_s and s_to_m PHYs shall be applied before converting them to
    bitmasks. This works now only because bitmasks for 1M and 2M are the
    same as numeric values, but won't work for Coded.
    
    X-Original-Commit: dfeee7b49b50aac54f455e84390b7f5bd0abe888

 nimble/controller/src/ble_ll_ctrl.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 44c8a8303fdbbfeb9c72f5dbd654e0a5d157ae08
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Apr 28 00:44:15 2017 +0200

    nimble/controller: Fix checking PHY Options in LE Set PHY
    
    We need to check complete value here, then we can store only lsb since
    msb will be zero anyway.
    
    X-Original-Commit: 502fbb752d18316eab8fb55e223a837b99452675

 nimble/controller/src/ble_ll_conn_hci.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit de749c272a4af1efe8fc81d3e7171f7cd74a82c3
Author: Marko Kiiskila <marko@runtime.io>
Date:   Wed Apr 26 17:32:47 2017 -0700

    net/nimble; adjust BCM2837 fix to print a warning instead of erroring.
    Keep header file define the same.
    
    X-Original-Commit: be82a7ad60926d746a77409c322449563f02cce5

 nimble/host/src/ble_hs_hci_util.c  | 3 +--
 nimble/include/nimble/hci_common.h | 2 +-
 2 files changed, 2 insertions(+), 3 deletions(-)

commit 357838f731c960c36a2e479aef97a251ce556fd4
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Apr 25 11:06:10 2017 -0700

    net/nimble/hs; QCA6234 rejects 2nd page of event settings.
    Instead of failing, log the event as warning and continue.
    
    X-Original-Commit: 1db1b3c17264cf42ef210d1c00cb7ef15ec07f09

 nimble/host/src/ble_hs_startup.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f5b80b14e26b942194d0539d866b936cc04eb64a
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Apr 25 11:03:20 2017 -0700

    net/nimble; we reject BCM2837 on raspberry pi for higher tx power
    report. Up the allowed range to accomodate it.
    
    X-Original-Commit: 83c0b03e28c0fea8b5bec46b0075aebdf01984dd

 nimble/include/nimble/hci_common.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e895f244f7144a582ee22f88a906a1725a79d756
Merge: e291fa74 de05abb7
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue May 16 10:02:24 2017 +0200

    Merge branch 'master' into bluetooth5_master
    
     Conflicts:
            net/nimble/controller/src/ble_ll_ctrl.c
            net/nimble/controller/src/ble_ll_sched.c
    
    X-Original-Commit: c6003a43437ee2c275fdc8f1a247e38fc0fa8962

commit a9a953db6ea99ee3d0087e5ab6bd178a6a0abf20
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 17:02:28 2017 -0700

    MYNEWT-754 BLE Host - Support deleting of CCCDs.
    
    X-Original-Commit: c24413e1106042015a693713305f046845169a2e

 nimble/host/store/ram/src/ble_store_ram.c | 26 ++++++++++++++++++++++++--
 1 file changed, 24 insertions(+), 2 deletions(-)

commit e55fdba6425bb93a3cbc6d599b1b001e79881b3d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 17:16:16 2017 -0700

    MYNEWT-754 BLE Host - Basic store util unit tests.
    
    X-Original-Commit: fd6da967a98574e0593508217b1eca8c26f97ac5

 nimble/host/include/host/ble_hs_test.h |   1 +
 nimble/host/test/src/ble_hs_test.c     |   3 +-
 nimble/host/test/src/ble_store_test.c  | 172 +++++++++++++++++++++++++++++++++
 3 files changed, 175 insertions(+), 1 deletion(-)

commit 405d3a7900ceadff25590c776c44789504d7cb0e
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 15:40:59 2017 -0700

    MYNEWT-754 BLE Host - Add some missing consts.
    
    X-Original-Commit: 507773fdcd1aff62db51fe1f8afdf7b0014e4099

 nimble/host/include/host/ble_store.h               | 36 ++++++++++----------
 nimble/host/src/ble_hs_pvcy.c                      |  5 +--
 nimble/host/src/ble_hs_pvcy_priv.h                 |  5 +--
 nimble/host/src/ble_store.c                        | 33 ++++++++++---------
 .../store/ram/include/store/ram/ble_store_ram.h    |  6 ++--
 nimble/host/store/ram/src/ble_store_ram.c          | 38 +++++++++++-----------
 nimble/host/test/src/ble_gatts_notify_test.c       |  4 +--
 nimble/host/test/src/ble_hs_test_util.c            |  6 ++--
 8 files changed, 68 insertions(+), 65 deletions(-)

commit 86f1ffc1981e21321621b282209cdeba2760dcf9
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 15:19:22 2017 -0700

    MYNEWT-754 BLE Host - Store mgmt API additions
    
    /**
     * Deletes all entries from the store that match the specified key.
     *
     * @param type                  The type of store entry to delete.
     * @param key                   Entries matching this key get deleted.
     *
     * @return                      0 on success;
     *                              Other nonzero on error.
     */
    int
    ble_store_util_delete_all(int type, const union ble_store_key *key)
    
    /**
     * Retrieves the set of peer addresses for which a bond has been
     * established.
     *
     * @param out_peer_id_addrs     On success, the set of bonded peer
     *                                  addresses gets written here.
     * @param out_num_peers         On success, the number of bonds gets
     *                                  written here.
     * @param max_peers             The capacity of the destination buffer.
     *
     * @return                      0 on success;
     *                              BLE_HS_ENOMEM if the destination buffer
     *                                  is too small;
     *                              Other nonzero on error.
     */
    int
    ble_store_util_bonded_peers(ble_addr_t *out_peer_id_addrs,
                                int *out_num_peers, int max_peers)
    
    /**
     * Deletes all entries from the store that are attached to the specified
     * peer address.  This function deletes security entries and CCCD
     * records.
     *
     * @param peer_id_addr          Entries with this peer address get
     *                                  deleted.
     *
     * @return                      0 on success;
     *                              Other nonzero on error.
     */
    int
    ble_store_util_delete_peer(const ble_addr_t *peer_id_addr)
    
    X-Original-Commit: 7ad98820d8c7692e3c39d66c7b736ca7df3c1cb0

 nimble/host/include/host/ble_store.h |  12 +++
 nimble/host/src/ble_store.c          |  22 +++++
 nimble/host/src/ble_store_util.c     | 164 +++++++++++++++++++++++++++++++++++
 3 files changed, 198 insertions(+)

commit e38f45402f96f0130f8371b6d02f5046d29bddbe
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 14:48:49 2017 -0700

    MYNEWT-754 BLE Host - iterate: return err on fail
    
    X-Original-Commit: c542807fb3af50962d55bb669ae7f149cb208150

 nimble/host/include/host/ble_store.h |  7 ++++---
 nimble/host/src/ble_store.c          | 38 ++++++++++++++++++++++++------------
 2 files changed, 29 insertions(+), 16 deletions(-)

commit cb63ab9d81cbd0c79608549d899b34c9cca1e52f
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 14:39:23 2017 -0700

    MYNEWT-754 BLE host - addrcmp ignores padding.
    
    A straight memcmp of the ble_addr_t struct won't always work,
    particularly if one of the structs is allocated on the stack.  The
    contents of the padding bytes are indeterminate, and could cause a false
    negative.
    
    X-Original-Commit: 02f60846684b0f51dbfe050795b144e0f8b35641

 nimble/include/nimble/ble.h | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit d0abe94c81d16b4a8b870bb2bcd801bdb0f463b7
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 11 14:36:11 2017 -0700

    MYNEWT-754 BLE host - Store cb can abort iterate.
    
    X-Original-Commit: f0a1ea83726a488734c7ad957ef7c2ac956a42b4

 nimble/host/src/ble_store.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit ea659ce59aaf92e331dc0848e40b2dde464e1df1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Apr 28 18:09:41 2017 -0700

    MYNEWT-754 BLE Host - cfgable RAM store capacity
    
    X-Original-Commit: c2654f308cb21b41653583b951fcdcd85bb17f4e

 nimble/host/store/ram/src/ble_store_ram.c | 21 ++++++++++-----------
 nimble/host/syscfg.yml                    | 11 +++++++++++
 2 files changed, 21 insertions(+), 11 deletions(-)

commit de05abb7409fd596e6e18d0033f35a7be742efb7
Author: Jacob Rosenthal <jakerosenthal@gmail.com>
Date:   Wed May 10 22:03:33 2017 -0700

    fix double semicolons
    
    X-Original-Commit: 4e06eb5d8dc93edfbc14e1a00b3edf8ebc93b1dc

 nimble/host/src/ble_sm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit cd184cef08e3853d22382952ecb30a1396331474
Merge: bea3e7d7 e930d096
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu May 11 19:19:27 2017 +0200

    This closes #276
    
    X-Original-Commit: d96b601572271c90a6031529b47a667c7c5fc8d0

commit e930d096c85fc1f06ecbc481000dd8cbf944b81e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri May 5 14:12:47 2017 +0200

    nimble/controller: Use scansm from function parameter
    
    X-Original-Commit: ef1b67ff8700db9e191ec5a67c74c6e29311ff26

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2c4bef933f7ba5672e16262270c0c69548109112
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sat Apr 29 00:50:50 2017 +0200

    nimble/gap: Fix lock issue
    
    Make sure proper cleaning is done when return error on connect and
    discovery
    
    X-Original-Commit: f05185188a15af2b5ead490b9d47e40ce6e5731a

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit bea3e7d79d9278569c40d68d3e905882b6348b12
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 20:00:20 2017 +0200

    nimble/ll: Check peer features for LE Connection Update
    
    We should use Connection Parameters Request procedure only if both
    master and slave support this feature so we need to check features
    masks of both sides.
    
    In other case, we can do Connection Update procedure only if we're
    master.
    
    X-Original-Commit: 80793bf6e36e13953fce18950929af5e91867d12

 nimble/controller/src/ble_ll_conn_hci.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 685ca06cebc94f53ed6f53048bde02c05151d1a3
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 08:19:00 2017 +0200

    nimble/ll: Change LL PDU name to match spec
    
    The LL_CONNECTION_UPDATE_REQ is renamed to LL_CONNECTION_UPDATE_IND in
    the latest versions of spec, so let's follow this.
    
    X-Original-Commit: fb476e7192c4f84b1eb9618c65f94eabd4ee3c23

 nimble/controller/include/controller/ble_ll_ctrl.h | 2 +-
 nimble/controller/src/ble_ll_ctrl.c                | 8 ++++----
 2 files changed, 5 insertions(+), 5 deletions(-)

commit a280e189ab3f5f462f3503bc2ece94d1c86bb558
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 08:08:10 2017 +0200

    nimble/ll: Add option to schedule connection with non-zero WindowOffset
    
    Devices based on TI CC254x with older stack version have bug where
    connection parameters are not updated properly on slave device if
    transmitWindowOffset in CONNECT_IND was set to 0 (and apparently this
    applies to 1 as well).
    
    To workaround this, we allow to use larger transmitWindowOffset in
    CONNECT_IND - by default this is set to 0, for old TI CC254x IOP should
    be set to at least 2.
    
    This also fixes MYNEWT-526.
    
    X-Original-Commit: 9f3452cab921043743b9512c55e248acdb676d5d

 nimble/controller/src/ble_ll_sched.c |  7 ++++---
 nimble/controller/syscfg.yml         | 10 ++++++++++
 2 files changed, 14 insertions(+), 3 deletions(-)

commit 16f9fe2b667f6e515514e1d3e63d921c00b6875b
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Apr 25 08:11:31 2017 +0200

    nimble/ll: Fix sending features xchange PDUs
    
    We only set single octet of CtrData field so need to clear other octets
    as otherwise we can send some random value there.
    
    X-Original-Commit: baa74ed2d3f6a5936b59c599265d2cd0296a6d69

 nimble/controller/src/ble_ll_ctrl.c | 1 +
 1 file changed, 1 insertion(+)

commit e291fa7428937cb6abbebd9f8c202f015a928e7b
Merge: f530137e ad61581a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 8 15:48:48 2017 +0200

    Merge branch 'master' into bluetooth5
    
    X-Original-Commit: 10e041be14edd747b16ea515b9c1b34bb06811b7

commit f530137ef3d89045fe13d3be00a283d874c6456c
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 8 14:19:10 2017 +0200

    Fix native controller build
    
    Fix following link error when build unit tests forcontroller:
    unittest/net_nimble_controller_test/app/net/nimble/controller/
       net_nimble_controller.a(ble_ll.o): In function `ble_ll_wfr_timer_exp':
    net/nimble/controller/src/ble_ll.c:505: undefined reference to
       `ble_phy_xcvr_state_get'
    
    X-Original-Commit: 9b31d7452610f3cdab5ccce10f49ae9806535fd3

 nimble/drivers/native/src/ble_phy.c | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit ef448905fd0b73206e8e257c319f06cd4dc9af24
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon May 8 14:09:38 2017 +0200

    nimble/controller: Fix controller unit test
    
    This fix following build error due to uint32_t being defined as 'unsigned int'
    instead of 'unsigned long int'
    Error: repos/apache-mynewt-core/net/nimble/controller/src/ble_ll.c: In function 'ble_ll_log_dump_index':
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll.c:1391:30: error: format '%u' expects argument
        of type 'unsigned int', but argument 2 has type 'uint32_t {aka long unsigned int}' [-Werror=format=]
         console_printf("cputime=%u id=%u a8=%u a16=%u a32=%u\n",
                                  ^
    repos/apache-mynewt-core/net/nimble/controller/src/ble_ll.c:1391:56: error: format '%u' expects argument
        of type 'unsigned int', but argument 6 has type 'uint32_t {aka long unsigned int}' [-Werror=format=]
         console_printf("cputime=%u id=%u a8=%u a16=%u a32=%u\n",
    cc1: all warnings being treated as errors
    
    This is just a quick workaround for now.
    
    X-Original-Commit: 34670d729cec2d99b1408a74cb69d60364d8a867

 nimble/controller/src/ble_ll.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 0bc61d1abf34588966a55ebbd26112ea1b467a52
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 1 19:07:25 2017 -0700

    BLE Host - Fix peer OTA addr and type on pairing.
    
    This change address the following scenario:
    
    * Both devices using public addresses; no privacy.
    
    1. A connects to B.
    2. A initiates pairing.
    3. Pairing succeeds; B indicates that its ID address is the same public
       or static random address it was advertising with (i.e., no change in
       address).
    
    After this sequence completes, the connection object should be populated
    as follows (from A's perspective):
    
        * bhc_peer_addr.type: BLE_ADDR_PUBLIC
    
    However, I see the following instead:
    
        * bhc_peer_addr.type: BLE_ADDR_PUBLIC_ID
    
    This is problematic because BLE_ADDR_PUBLIC_ID indicates that the peer
    is using an RPA ("Public Identity Address (Corresponds to Resolved
    Private Address)").  The ble_hs_addrs() function uses the address type
    to determine the peer's OTA (over-the-air) address.  If the peer's
    address type is an "_ID" type, the rpa field is used for the OTA
    address.  In this case, the peer is not using an RPA, so its OTA address
    is identical to its identity address.
    
    The change is to only set the peer's address type to "_ID" if it is
    using an RPA.
    
    X-Original-Commit: f58d8cfd96b4d8bd736f4034b9b2cccc044acc92

 nimble/host/src/ble_sm.c | 23 +++++++++++------------
 1 file changed, 11 insertions(+), 12 deletions(-)

commit 9dff9953dfb3baf57dd786b2256cc89bbbe5535e
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sat Apr 29 01:13:38 2017 +0200

    MYNEWT-723: Fix build issue
    
    X-Original-Commit: 1a344896d7fd7063240893de69fda5baadb96631

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c25e436ed73473007371d20fae47324b01f078bc
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 27 23:20:23 2017 +0200

    MYNEWT-723: Fix creating LL_PHY_REQ
    
    X-Original-Commit: ad980ee8a581b8adf22e6b94817b20dc751a0f9f

 nimble/controller/src/ble_ll_ctrl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7a2f0a03a3d0cb5d11fb52b0b4a4acf8860aecb5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Apr 27 23:19:09 2017 +0200

    MYNEWT-723: Fix setting current PHY
    
    If new PHY is set to 0 (no change), we should just leave current PHY
    without change and not set it to 0.
    
    X-Original-Commit: aebec2580f3c4faef2c50111abae825b0448e681

 nimble/controller/src/ble_ll_conn.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit d00d551c91c2d300376db9379985f4705ef3d1c0
Author: William San Filippo <wills@runtime.io>
Date:   Wed Apr 26 16:45:03 2017 -0700

    MYNEWT-723: Some additional changes to get the basic 2Mbps PHY support.
    
    X-Original-Commit: 230462f8f6d76cd37ed58f0524f709ea1e9fe796

 nimble/controller/include/controller/ble_ll.h      |  2 +-
 nimble/controller/include/controller/ble_ll_conn.h | 13 ++++++++++---
 nimble/controller/src/ble_ll_conn.c                | 16 ++++++++--------
 nimble/controller/src/ble_ll_ctrl.c                | 14 ++++++++++++--
 nimble/controller/src/ble_ll_hci.c                 |  8 ++++----
 nimble/controller/src/ble_ll_hci_ev.c              |  2 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |  3 ++-
 nimble/host/src/ble_hs_dbg.c                       |  5 +++++
 nimble/host/src/ble_hs_startup.c                   |  3 ++-
 9 files changed, 45 insertions(+), 21 deletions(-)

commit 72f7eab9f0424c0f207b32a065cacbe147c746ec
Author: William San Filippo <wills@runtime.io>
Date:   Sun Apr 23 15:02:14 2017 -0700

    MYNEWT-723: Add control procedure code and HCI command/event code.
    
    X-Original-Commit: bb2c04ed88cbfe8eb15fa1d68a7d8b8b2b1b69a6

 nimble/controller/src/ble_ll_conn_hci.c | 3 ++-
 nimble/include/nimble/hci_common.h      | 8 ++++----
 2 files changed, 6 insertions(+), 5 deletions(-)

commit 8d5679f7a6ca62e980cb743ccd2b4ca023642a71
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 25 17:17:22 2017 -0700

    MYNEWT-723: Add PHY support to change modulations for 2M phy.
    
    X-Original-Commit: 5741441768360699cf778022dea522f5e9992d01

 nimble/controller/include/controller/ble_ll.h      |  35 +-----
 nimble/controller/include/controller/ble_ll_conn.h |  24 ++--
 .../controller/include/controller/ble_ll_sched.h   |   3 -
 nimble/controller/include/controller/ble_phy.h     |  28 +++++
 nimble/controller/src/ble_ll_adv.c                 |   7 +-
 nimble/controller/src/ble_ll_conn.c                |  92 ++++++++++----
 nimble/controller/src/ble_ll_conn_priv.h           |   3 -
 nimble/controller/src/ble_ll_ctrl.c                |  32 ++---
 nimble/controller/src/ble_ll_scan.c                |   6 +
 nimble/controller/src/ble_ll_sched.c               |  12 +-
 nimble/drivers/nrf51/src/ble_phy.c                 |  26 ++--
 nimble/drivers/nrf52/src/ble_phy.c                 | 133 ++++++++++++++++++---
 12 files changed, 277 insertions(+), 124 deletions(-)

commit e121baa839302b1e24395882bbb8e543dc831f97
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 24 09:11:59 2017 -0700

    MYNEWT-723: L# 2Mbit and Long range support
    
    Some refactoring to combine code.
    
    X-Original-Commit: 3f997c2aec0e8cc70dcb13691e0b218e665310bc

 nimble/controller/src/ble_ll_conn_hci.c |  4 ++--
 nimble/controller/src/ble_ll_ctrl.c     | 33 ++++++++++++---------------------
 2 files changed, 14 insertions(+), 23 deletions(-)

commit 568b75053f4b16d28aca6b667d615484b57c28de
Author: William San Filippo <wills@runtime.io>
Date:   Sun Apr 23 15:02:14 2017 -0700

    MYNEWT-723: Add control procedure code and HCI command/event code.
    
    X-Original-Commit: 4e347012011204fd92bf1c3512debe93ae802b2f

 nimble/controller/include/controller/ble_ll.h      |  20 +-
 nimble/controller/include/controller/ble_ll_conn.h |  57 ++-
 nimble/controller/include/controller/ble_ll_ctrl.h |  28 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   2 +
 nimble/controller/src/ble_ll.c                     |  12 +
 nimble/controller/src/ble_ll_conn.c                |  94 ++++
 nimble/controller/src/ble_ll_conn_hci.c            | 128 ++++-
 nimble/controller/src/ble_ll_conn_priv.h           |   4 +
 nimble/controller/src/ble_ll_ctrl.c                | 543 ++++++++++++++++++++-
 nimble/controller/src/ble_ll_hci.c                 |  83 ++++
 nimble/controller/src/ble_ll_hci_ev.c              |  33 ++
 nimble/controller/syscfg.yml                       |  10 +
 nimble/include/nimble/hci_common.h                 |  10 +-
 13 files changed, 988 insertions(+), 36 deletions(-)

commit d7c0ae0e3e2fbbc49ab1cc1eda323cfe452e7e32
Author: William San Filippo <wills@runtime.io>
Date:   Fri Apr 14 12:51:51 2017 -0700

    nimble/controller: MYNEWT-726
    
    Modify how the controller deals with the terminate procedure. The
    old method set a pending control procedure bit and it was not the
    best way to deal with this since the terminate procedure can
    occur while another control procedure is in process. The
    new method uses a flag in the connection state machine flags
    to denote that the terminate procedure was started. Started means
    a control pdu was allocated and enqueued. The disconnect reason
    being non-zero means that the connection is to be terminated.
    
    X-Original-Commit: 46d67b04b26d25391d057785765549e5f72d04d0

 nimble/controller/include/controller/ble_ll_conn.h | 1 +
 1 file changed, 1 insertion(+)

commit ad61581ab38f5dc3db7a80b70e7ce05cbdb79b54
Merge: 0a326225 75cb545a
Author: William San Filippo <wills@runtime.io>
Date:   Wed Apr 26 17:38:34 2017 -0700

    This closes #245
    
    Fix number of completed packet events in both controller and host.
    
    X-Original-Commit: eb4f28984bce5812e1759049425ef5fbe42518da

commit 2094a954fd638efd55b64e5c0bd1ff73392b714d
Merge: a6e239e8 0a326225
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 26 14:23:02 2017 -0700

    This closes #250.
    
    Merge branch 'master' into bluetooth5
    
    X-Original-Commit: 87329b51421d24d87b3ca17862e236cd985f8196

commit 0a3262258109014f283fe785682e283bc7ad5203
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 24 12:19:01 2017 -0700

    nimble/transport; MYNEWT-737: Make ble_hci_uart_tx_char more efficient
    
    Per pull request review, add assert() if om is NULL. Did not
    modify the rest of the code in case assert() is compiled out
    by NDEBUG being defined.
    
    X-Original-Commit: 5a869e3e2e791fd83e763a02fcecb4803de6ce37

 nimble/transport/uart/src/ble_hci_uart.c | 1 +
 1 file changed, 1 insertion(+)

commit 75cb545a1a7bdb4aa070b68fc49d7a0e20c8cb13
Author: William San Filippo <wills@runtime.io>
Date:   Sun Apr 23 16:40:46 2017 -0700

    MYNEWT-738: Fix parameter array errors
    
    Fix number of completed packet events
    
    X-Original-Commit: af6fb7e052873dee489ebe73e3b52f867ba3e255

 nimble/controller/src/ble_ll_conn_hci.c | 12 ++----------
 nimble/host/src/ble_hs_dbg.c            |  7 ++-----
 nimble/host/src/ble_hs_hci_evt.c        |  5 +++--
 3 files changed, 7 insertions(+), 17 deletions(-)

commit d7792a2041392681da7d8c7bfd9bcdb0413b211c
Author: William San Filippo <wills@runtime.io>
Date:   Thu Apr 20 19:36:37 2017 -0700

    nimble/transport; MYNEWT-737: Make ble_hci_uart_tx_char more efficient
    
    Modified the code in ble_hci_uart_tx_char to be faster. This
    added a bit more code (should not have increased ram usage) and
    should in general be faster than the old method and should also
    free the mbufs slightly faster (each one is freed as it is
    used).
    
    X-Original-Commit: be6ce3cc261f0fedee0807ce85aae0b287d13dd2

 nimble/transport/uart/src/ble_hci_uart.c | 65 ++++++++++++++++++++++++++------
 1 file changed, 54 insertions(+), 11 deletions(-)

commit 0d081665cf659103364dc8632ae13cbdb1bc6c47
Merge: 47d32167 853b97c0
Author: Marko Kiiskila <marko@runtime.io>
Date:   Thu Apr 20 08:29:39 2017 -0700

    This closes #221.
    
    Merge branch 'hcioversocket' of https://github.com/mkiiskila/incubator-mynewt-core
    
    X-Original-Commit: a34f65387d3b5299ad68380f87558d4cce944bee

commit 47d321674ae12a09818e593d395b7e1b32b6d7ce
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 19 20:13:59 2017 -0700

    MYNEWT-736 NimBLE - UART xport can't send multibuf
    
    The UART transport assumes outgoing ACL data packets consist of a single
    mbuf. If the chain contains multiple buffers, the later part of the
    outgoing packet consists of all zeros.
    
    X-Original-Commit: 7669e9715e9eee5cccea0074208e6915258d3d3a

 nimble/transport/uart/src/ble_hci_uart.c | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

commit 22a4ece016457f11d726c697a26594ffa867e142
Merge: a3e08629 9f5852b3
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 19 12:00:16 2017 -0700

    This closes #237.
    
    Merge remote-tracking branch 'simonratner/MYNEWT-732'
    
    * simonratner/MYNEWT-732:
      MYNEWT-732: Fix ble_gattc_disc_svc_by_uuid
    
    X-Original-Commit: 43e3f72351dc632731138ef297dae386c7e96e62

commit a3e0862982e3fc98a858c8ed584658a270b6f9ae
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 19 11:57:28 2017 -0700

    BLE Host - Check tx of disc-svc-uuid in unit tests
    
    X-Original-Commit: a1e5c1253b670f90ac59decce2917c179b0dfb96

 nimble/host/test/src/ble_gatt_disc_s_test.c |  2 ++
 nimble/host/test/src/ble_hs_test_util.c     | 35 +++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.h     |  6 +++++
 3 files changed, 43 insertions(+)

commit 9f5852b35af6bcf340ad249b68d0bed0648e004f
Author: Simon Ratner <simon+github@probablyprime.net>
Date:   Wed Apr 19 10:48:34 2017 -0700

    MYNEWT-732: Fix ble_gattc_disc_svc_by_uuid
    
    Broken in a refactor in 191acab73c9c77c157a806d8871b653f3c64cbc9.
    
    X-Original-Commit: 1ae17576b9d9c48c659397afd03d053a8b896a00

 nimble/host/src/ble_att_clt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a6e239e84b31de1da7b743337faca888c3a69d08
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 11 11:22:17 2017 +0200

    nimble/gap: Add API to manage LE PHY
    
    X-Original-Commit: c7aa21c3f49e01393af9c94f67bcd62a5e45f447

 nimble/host/include/host/ble_gap.h | 35 ++++++++++++++
 nimble/host/src/ble_gap.c          | 94 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_gap_priv.h     |  1 +
 nimble/host/src/ble_hs_hci_evt.c   | 23 ++++++++++
 nimble/include/nimble/hci_common.h | 13 ++++++
 5 files changed, 166 insertions(+)

commit 5b13a72d476f20242029927273cfd4c28374dc20
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 11 10:13:06 2017 +0200

    nimble/hci: Add LE set PHY command
    
    With this command we can change prefered PHY for given connection
    
    X-Original-Commit: 2210e7e1de7a6c3c0e53380d290c763b9eacb6ab

 nimble/host/src/ble_hs_hci_cmd.c   | 76 ++++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs_hci_priv.h  |  3 ++
 nimble/include/nimble/hci_common.h |  3 ++
 3 files changed, 79 insertions(+), 3 deletions(-)

commit 02307b6cdbc642da3790b4a3bbbd21de68e9beee
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 11 09:17:33 2017 +0200

    nimble/hci: Add LE set default PHY command
    
    X-Original-Commit: 086c852fa67375b5a5ce3875456875330051c56c

 nimble/host/src/ble_hs_hci_cmd.c   | 53 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  |  3 +++
 nimble/include/nimble/hci_common.h |  6 +++++
 3 files changed, 62 insertions(+)

commit 9ac701098b778f4ca6172e1e128484eb18e79b42
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 11 09:16:39 2017 +0200

    nimble/hci: Add LE read PHY command
    
    With this command we can read used PHY on given connection
    
    X-Original-Commit: 7744296bc2b9783678c64f632ed7668c3f76ad6d

 nimble/host/src/ble_hs_hci_cmd.c  | 17 +++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h |  3 +++
 2 files changed, 20 insertions(+)

commit d9926b43b00eb812896720ac6151065a8c99b465
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 11 08:39:38 2017 +0200

    nimble/hci: Remove reduntant checks
    
    X-Original-Commit: 1caef7af29db648da90e5be0c33a485a9b9e3e3a

 nimble/host/src/ble_hs_hci_cmd.c | 186 ++++++---------------------------------
 1 file changed, 29 insertions(+), 157 deletions(-)

commit 7753345e2797da5b2f41788b029372d380cf22f3
Author: William San Filippo <wills@runtime.io>
Date:   Fri Apr 14 12:51:51 2017 -0700

    nimble/controller: MYNEWT-726
    
    Modify how the controller deals with the terminate procedure. The
    old method set a pending control procedure bit and it was not the
    best way to deal with this since the terminate procedure can
    occur while another control procedure is in process. The
    new method uses a flag in the connection state machine flags
    to denote that the terminate procedure was started. Started means
    a control pdu was allocated and enqueued. The disconnect reason
    being non-zero means that the connection is to be terminated.
    
    X-Original-Commit: 9c482910e6f4848ebdd7f8fe9138e29f40e7cf33

 nimble/controller/include/controller/ble_ll_conn.h |  3 ++-
 nimble/controller/src/ble_ll_conn.c                |  8 ++++++--
 nimble/controller/src/ble_ll_conn_hci.c            |  2 +-
 nimble/controller/src/ble_ll_ctrl.c                | 21 +++++++++++++--------
 4 files changed, 22 insertions(+), 12 deletions(-)

commit bd5e1895ab9b923a112faed1ce1f5299473812f4
Author: William San Filippo <wills@runtime.io>
Date:   Fri Apr 14 09:39:53 2017 -0700

    nimble/controller: No jira ticket.
    
    Removing some unused variables from code and connection state
    machine.
    
    X-Original-Commit: 566b5c6918d1a22872020bc647e04dc0bb81aa9d

 nimble/controller/include/controller/ble_ll_conn.h | 2 --
 nimble/controller/src/ble_ll_conn.c                | 2 --
 2 files changed, 4 deletions(-)

commit 31488f53de1ac48aa05634c80538f0aabdcff55c
Author: William San Filippo <wills@runtime.io>
Date:   Fri Apr 14 09:39:53 2017 -0700

    nimble/controller: No jira ticket.
    
    Removing some unused variables from code and connection state
    machine.
    
    X-Original-Commit: b3187bd7db3401709ed6e96d3b44f17b15cfafb3

 nimble/controller/include/controller/ble_ll_conn.h | 2 --
 nimble/controller/src/ble_ll_conn.c                | 2 --
 2 files changed, 4 deletions(-)

commit b07436d8ea57738a457a804f85ae14e459df5d49
Merge: 7c1e45f8 e810d9f5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 12 00:45:13 2017 +0200

    This closes #226.
    
    Merge branch 'bluetooth5' of https://github.com/rymanluk/incubator-mynewt-core into bluetooth5
    
    X-Original-Commit: 6fba2048eab01271107eb1f5792a647358a7bbaf

commit 7c1e45f8489100a3eb9d909f7c91f9e12a7a19b9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 11 14:47:26 2017 +0200

    nimble/controller: Allow to configure CSA #2 support
    
    This allows to enable/disable CSA #2 support in Nimble controller.
    By default it is disabled.
    
    X-Original-Commit: 1630d8e37459fc2ce8259a05c2f1e0f6bf5c2e98

 nimble/controller/src/ble_ll.c          |  2 ++
 nimble/controller/src/ble_ll_adv.c      |  9 +++++++--
 nimble/controller/src/ble_ll_conn.c     | 12 +++++++++++-
 nimble/controller/src/ble_ll_conn_hci.c |  3 ++-
 nimble/controller/src/ble_ll_hci_ev.c   |  2 ++
 nimble/controller/syscfg.yml            |  6 ++++++
 nimble/controller/test/syscfg.yml       |  1 +
 7 files changed, 31 insertions(+), 4 deletions(-)

commit 9b28fc78ad3fa7d35f3d4bf80ade8d53585e7bd5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 11 13:39:39 2017 +0200

    nimble/controller: Move latency calculations to ble_ll_conn_calc_dci
    
    This is to localize CSA #2 related code in order for easier compile
    time configuration.
    
    X-Original-Commit: 3acdf385fa4bfc94081005d359073f0e114825b6

 nimble/controller/include/controller/ble_ll_conn.h |  3 +-
 nimble/controller/src/ble_ll_conn.c                | 62 ++++++++++++----------
 nimble/controller/test/src/ble_ll_csa2_test.c      | 12 ++---
 3 files changed, 42 insertions(+), 35 deletions(-)

commit 0e1b37e0138ba3d9f6d3ac2fa765b2d4d6968c2f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 11 11:30:31 2017 +0200

    nimble/controller: Use single function for DCI calculation
    
    Select CSA #1 or #2 from within ble_ll_conn_calc_dci.
    
    X-Original-Commit: 6b57da91fd474655a8a1e8342b05ae84b0b9e41a

 nimble/controller/include/controller/ble_ll_conn.h |  2 +-
 nimble/controller/src/ble_ll_conn.c                | 20 +++++++++++++-------
 nimble/controller/test/src/ble_ll_csa2_test.c      | 16 ++++++++++------
 3 files changed, 24 insertions(+), 14 deletions(-)

commit 6f8122859092d5c0e415a3b1639bb7a647bfdb2f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 11 11:13:38 2017 +0200

    nimble/controller: Rename and move ble_ll_conn_csa2_remapped_channel
    
    This function is use both by CSA #1 and #2 so name it accordingly. Also
    move it up in the source file - this is in preparation for optional
    CSA #2 support.
    
    X-Original-Commit: 22271049c61f4796f23f272cadd5d555ece37136

 nimble/controller/src/ble_ll_conn.c | 76 ++++++++++++++++++-------------------
 1 file changed, 38 insertions(+), 38 deletions(-)

commit 26e9b558c02ecf9e08c12c9b529419b1289cbaa8
Merge: d0eb8cab 7afc9a2c
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 10 17:25:05 2017 -0700

    This closes #206.
    
    Merge remote-tracking branch 'rymanluk/fix_l2cap_coc_locking'
    
    * rymanluk/fix_l2cap_coc_locking:
      nimble/l2cap: Add PTS instructions for LE CoC and run all the testcases
      nimble/pts: Update pts files due to L2CAP LE CoC
      nimble/l2cap: Add initial unit tests for LE CoC
      nimble/l2cap: Fix hs locking issue when sending le_credit_update
      nimble/l2cap: Fix logs on LE CoC receive data
      nimble/l2cap: Fix for reject incoming LE CoC channel
      nimble/l2cap: Fix locking on incoming LE CoC connect request
      nimble/l2cap: Fix locking on LE CoC connect
      nimble/l2cap: Fix locking when receiving LE CoC credit update
    
    X-Original-Commit: f6605c2ab4a664fee54f13eb0b0fc091baf1fde2

commit e810d9f5c5a7bf2f187dea0d45e7af52b32080af
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 10 12:11:25 2017 +0200

    controller: Minor comment fix
    
    Errata 6471 clarifies what AdvA shall be in Scan Resp and nimble does good.
    This errata is adopted into Bluetooth 5.0
    
    X-Original-Commit: 07d7daaa065c6306b688718a25913a2e1ea52cad

 nimble/controller/src/ble_ll_adv.c | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)

commit d0eb8cab9553e98cde6f02f8639cb5c0014e517f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:10 2017 +0100

    nimble: Remove ble_hs_endian_priv.h API
    
    This API is no longer used and so/endian.h should be used instead.
    
    X-Original-Commit: dccf07dc4cb7fae81c6942b135f6a67cfa03a631

 nimble/host/src/ble_hs_endian_priv.h | 65 ------------------------------------
 nimble/host/src/ble_hs_priv.h        |  1 -
 2 files changed, 66 deletions(-)

commit 1b00d2ad0e41fa1f93be74586a4da9e90a3e9e48
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:09 2017 +0100

    nimble/l2cap: Use endian.h API for protocol data
    
    Don't use TOFROMLE16 API for protocol data. This API hide direction of
    convertion making code hard to follow.
    
    X-Original-Commit: 7e1ac05a06168984fa0bf772fdb72caedd086327

 nimble/host/src/ble_l2cap_sig_cmd.c | 16 ++++++----------
 1 file changed, 6 insertions(+), 10 deletions(-)

commit f4d099541dc7618662d4ee845814897dd17f47d1
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:08 2017 +0100

    nimble/l2cap: Remove some dead code
    
    Those functions are not used anymore.
    
    X-Original-Commit: fd6c58a82396a6b59772b9781ecfe25d4b39b2b9

 nimble/host/src/ble_l2cap_sig_cmd.c  | 8 --------
 nimble/host/src/ble_l2cap_sig_priv.h | 4 ----
 2 files changed, 12 deletions(-)

commit 0c5ff370176995671d0177a7827c170356c63707
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:08 2017 +0100

    nimble/sm: Use endian.h API for protocol data
    
    Don't use TOFROMLE16 API for protocol data. This API hide direction of
    convertion making code hard to follow.
    
    X-Original-Commit: 7674f26323d8dfce61fcfd6e2175894a7eb89f10

 nimble/host/src/ble_sm.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit e12a2c4865dd6d627fa808ada6d648b89c929b99
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:08 2017 +0100

    nimble/att: Use endian.h API for protocol data
    
    Don't use TOFROMLE16 API for protocol data. This API hide direction of
    convertion making code hard to follow.
    
    X-Original-Commit: 32db7782acd49b787d76d9afb05ea6092844f90b

 nimble/host/src/ble_att_cmd.c | 251 ++++++++++++++++--------------------------
 1 file changed, 92 insertions(+), 159 deletions(-)

commit 0a61a0f8a026219abad9c97cb3a24a4a500bede9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:08 2017 +0100

    nimble/att: Strip common ATT header before passing buf to handlers
    
    This reduce code size and move common part in single place.
    
    X-Original-Commit: d458bb8c3b6ea61ed6b05b1465bc876dc070b3bb

 nimble/host/src/ble_att.c     |  3 ++
 nimble/host/src/ble_att_clt.c | 55 ----------------------------------
 nimble/host/src/ble_att_svr.c | 70 -------------------------------------------
 3 files changed, 3 insertions(+), 125 deletions(-)

commit 583bcfc3fadee12bd1db85c659e725981230d678
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:07 2017 +0100

    nimble/att: Use packed struct for receiving Write Command
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 3876f10f11473407fb8326cacd15956105fc10b4

 nimble/host/src/ble_att_svr.c | 27 ++++++++++++++-------------
 1 file changed, 14 insertions(+), 13 deletions(-)

commit 834ae5c41e1761ced44d6b4d02b934a7d9f0521a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:07 2017 +0100

    nimble/att: Use packed struct for receiving Indication
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 255debf84dfea8ff0beb2f7e4729ee09c0226c90

 nimble/host/src/ble_att_svr.c | 39 ++++++++++++++++++---------------------
 1 file changed, 18 insertions(+), 21 deletions(-)

commit 7df74a709939a8c20f42d7c2aeaafaf65adb3306
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:06 2017 +0100

    nimble/att: Use packed struct for receiving Notification
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 7ea6ad8838ffd9b99989eddd5c4317938ce4ae69

 nimble/host/src/ble_att_svr.c | 25 +++++++++++++++----------
 1 file changed, 15 insertions(+), 10 deletions(-)

commit 5eff388ec9f496ba00138df147280106202a0f03
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:06 2017 +0100

    nimble/att: Use packed struct for receiving Execute Write Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: f495fa70a9a4870f306b8248c79371a0c2bade83

 nimble/host/src/ble_att_clt.c | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)

commit 61230620a2f9d6abf6144c2de10df33274a64bd4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:06 2017 +0100

    nimble/att: Use packed struct for receiving Execute Write Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: ca16b6bc33e35418d2e0aa80cd57d5b918d6e1c8

 nimble/host/src/ble_att_svr.c | 64 +++++++++++++++----------------------------
 1 file changed, 22 insertions(+), 42 deletions(-)

commit a8946a41e9e555f1d693a38eff08ef385c8e34fd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:06 2017 +0100

    nimble/att: Use packed struct for receiving Prepare Write Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 2b2c14e71f9308014c2c13f58681c1c4f2a9586c

 nimble/host/src/ble_att_clt.c | 25 +++++++++++++++++--------
 1 file changed, 17 insertions(+), 8 deletions(-)

commit f51563a07a165d5aca20a65da1784f768f449396
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:06 2017 +0100

    nimble/att: Use packed struct for receiving Prepare Write Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 3a3571ecdf46be5957a2004d5ee210f413f08d39

 nimble/host/src/ble_att_svr.c | 41 +++++++++++++++++++++++++----------------
 1 file changed, 25 insertions(+), 16 deletions(-)

commit ab22cddd824c51a8015c5593eca762cc04001a71
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:05 2017 +0100

    nimble/att: Use packed struct for receiving Write Request and Command
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: be6aace608a3acf890c2eb704c6d1bcefe8ef34b

 nimble/host/src/ble_att_svr.c | 35 +++++++++++++++++------------------
 1 file changed, 17 insertions(+), 18 deletions(-)

commit 310eac12fbf7ea12d623c4df8d197d595627bd86
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:05 2017 +0100

    nimble/att: Use packed struct for receiving Read By Group Type Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 37cec14c0d828dbb71febbb6ffaa2ad5ad1b6819

 nimble/host/src/ble_att_clt.c | 24 ++++++++++++++++--------
 1 file changed, 16 insertions(+), 8 deletions(-)

commit 3a8c5130926dcb05309905b779afc55a9977629b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:05 2017 +0100

    nimble/att: Use packed struct for receiving Read By Group Type Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: de742e26ccadf17c129d149f4c7c25c6670429e3

 nimble/host/src/ble_att_svr.c | 74 ++++++++++++++++++++++---------------------
 1 file changed, 38 insertions(+), 36 deletions(-)

commit 9d53deaa4e2736bd5304317162341aea6becdbb9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:05 2017 +0100

    nimble/att: Use packed struct for receiving Read Multiple Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: a36089c42de642b1678ccede93d7606a6c6796e9

 nimble/host/src/ble_att_clt.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit dfaa3614020b88c2f8a58cb7cca803606f193255
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:05 2017 +0100

    nimble/att: Use packed struct for receiving Read Multiple Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: d7da6aa8ceff9e18ffda5cc7eee2f407a19b6110

 nimble/host/src/ble_att_svr.c | 33 ++++++++-------------------------
 1 file changed, 8 insertions(+), 25 deletions(-)

commit 23d4eafd43fc0ac9b677a12b1b3159b07b404647
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:04 2017 +0100

    nimble/att: Use packed struct for receiving Read Blob Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: ac38eb72d6525c1b21b95ec8af5e0c3976d2746a

 nimble/host/src/ble_att_clt.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 220c2c5487e225cc6d42247ffa03dd4dcb3514f0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:04 2017 +0100

    nimble/att: Use packed struct for receiving Read Blob Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 9c897e5cc99bfe7adc2857e729bafec41fdccdac

 nimble/host/src/ble_att_svr.c | 25 ++++++++++++++-----------
 1 file changed, 14 insertions(+), 11 deletions(-)

commit 3b85591d355c11763500940abeda9a92e144a6a8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:04 2017 +0100

    nimble/att: Use packed struct for receiving Read Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 3b2507644e34a87016fce639416ea47302169ae2

 nimble/host/src/ble_att_svr.c | 23 ++++++++++++-----------
 1 file changed, 12 insertions(+), 11 deletions(-)

commit cb0a7dae58a1077e04cfae04a2cde8924fb6a396
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:03 2017 +0100

    nimble/att: Use packed struct for receiving Read By Type Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: c3cca4259a16b116b3a17a44896195483fdc38fa

 nimble/host/src/ble_att_clt.c | 55 +++++++++++++++++++++++--------------------
 1 file changed, 29 insertions(+), 26 deletions(-)

commit 104b679083bb25c30e57230ceab89b2515660589
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:03 2017 +0100

    nimble/att: Use packed struct for receiving Read By Type Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: e15ad929887f470e3bd39535666bb66a077fd4ac

 nimble/host/src/ble_att_cmd_priv.h |  7 ++++
 nimble/host/src/ble_att_svr.c      | 66 +++++++++++++++++++++-----------------
 2 files changed, 44 insertions(+), 29 deletions(-)

commit b4b8222d2fff2c421e87b18b2eb61572a5143bcd
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:50:02 2017 +0100

    nimble/att: Fix no responding with error for invalid data
    
    We should always responde to avoid stalling ATT channel.
    
    X-Original-Commit: f6800fc7e083c392fb50c05637714dfe7cff29a2

 nimble/host/src/ble_att_svr.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e952a754abf29e46a037f49062c1eb0f0a9d4a27
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:49:19 2017 +0100

    nimble/att: Use packed struct for receiving Find By Type Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 1e81657393641c3cccbc4fda600104bc7777f28e

 nimble/host/src/ble_att_clt.c      | 19 +++++++++++--------
 nimble/host/src/ble_att_cmd_priv.h |  9 +++++++++
 2 files changed, 20 insertions(+), 8 deletions(-)

commit 971be8e049873fe9ba9152b4387e87b10138e32e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:49:10 2017 +0100

    nimble/att: Use packed struct for receiving Find By Type Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: f0949b9f61a1ffd0be7083874c37d96c79c6fe1c

 nimble/host/src/ble_att_svr.c | 58 ++++++++++++++++++++++++-------------------
 1 file changed, 33 insertions(+), 25 deletions(-)

commit 3185e3736a2108955f514670f64c236519021983
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:48:26 2017 +0100

    nimble/att: Use packed struct for receiving Find Information Request
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: fefbc8198c5ef807c19c732939ee63aa91a7c869

 nimble/host/src/ble_att_svr.c | 55 +++++++++++++++++++++++--------------------
 1 file changed, 30 insertions(+), 25 deletions(-)

commit 76fd666efce8b71339824d160ffadd368dc7a370
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:47:53 2017 +0100

    nimble/att: Use packed struct for receiving MTU Exchange
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 1a6ebaa3128a2b854d5c35a65d4a7a50308e75ca

 nimble/host/src/ble_att_svr.c | 30 ++++++++++++++++++------------
 1 file changed, 18 insertions(+), 12 deletions(-)

commit 43c3f35f8084032b3e46e83dd15ba6d7a9cf6c58
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:47:10 2017 +0100

    nimble/att: Use packed struct for receiving Find Information Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: fe97914df0e8a0c497a3f737754d8873e8399959

 nimble/host/src/ble_att_clt.c | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)

commit 4d2962c508bf5ebd61cf4f43d07151584718e8aa
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:46:20 2017 +0100

    nimble/att: Use packed struct for receiving MTU exchange
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: a31e34bb4dd830603115bc31d27551a9e578786b

 nimble/host/src/ble_att_clt.c | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

commit 912f12b194b7e81bff4e13cd543b88fa5e25e925
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:40:05 2017 +0100

    nimble/att: Use packed struct for receiving Error Response
    
    Use packed structure to map it to received mbuf instead of using
    dedicated parsing function. Modern compilers generate effective code
    in such case anyway.
    
    X-Original-Commit: 8e602737948270f5d40369d354f485a41ef94caa

 nimble/host/src/ble_att_clt.c | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit 0f28899ced1075b6f68d2ad25fa2052ce9a72505
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:39:11 2017 +0100

    nimble/att: Don't pass Writes Response as packed structure
    
    Use packed structure only for mapping it onto received mbuf. Data is
    passed to upper layers in native form. This allows compiler to generate
    more effective code with regards to unaligned access.
    
    X-Original-Commit: a63f7d30ca2f0128973b258d6592d49775f2fbd5

 nimble/host/src/ble_att_clt.c   |  3 ++-
 nimble/host/src/ble_gatt_priv.h |  2 +-
 nimble/host/src/ble_gattc.c     | 25 +++++++++++++------------
 3 files changed, 16 insertions(+), 14 deletions(-)

commit c140fc1f97d3bbc826dc857938b38b0881fdaa1e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:35:59 2017 +0100

    nimble/att: Don't pass Error Responce as packed structure
    
    Use packed structure only for mapping it onto received mbuf. Data is
    passed to upper layers in native form. This allows compiler to generate
    more effective code with regards to unaligned access.
    
    X-Original-Commit: 4e0f1b9183a44d896d1a58be6d4bf42ab9fbb620

 nimble/host/src/ble_att_clt.c   | 2 +-
 nimble/host/src/ble_gatt_priv.h | 2 +-
 nimble/host/src/ble_gattc.c     | 5 ++---
 3 files changed, 4 insertions(+), 5 deletions(-)

commit de2d0e0477fadbe4a60dbcd074c843e6ad74af28
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:35:42 2017 +0100

    nimble/att: Use new helpers for sending Indication
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 8dbabc6e1ee9dbc9f0fa116815a7ec5ad9f3f391

 nimble/host/src/ble_att_clt.c  | 53 +++++++-----------------------------------
 nimble/host/src/ble_att_priv.h |  3 +--
 nimble/host/src/ble_gattc.c    |  4 +---
 3 files changed, 11 insertions(+), 49 deletions(-)

commit 886bbe66036c0da122adc0883d938379ef8649a8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:35:09 2017 +0100

    nimble/att: Use new helpers for sending Notification
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 504e0e132f3462275c7aef8fd1a4cc6b3b819e16

 nimble/host/src/ble_att_clt.c  | 21 +++++++++------------
 nimble/host/src/ble_att_priv.h |  3 +--
 nimble/host/src/ble_gattc.c    |  4 +---
 3 files changed, 11 insertions(+), 17 deletions(-)

commit 13ac13c99a184b90138a8d18eed54f5559f5a1b3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:34:55 2017 +0100

    nimble/att: Use new helpers for sending Execute Write Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: d74cc3eeb8a729346de2208fdf9f57593d1627a3

 nimble/host/src/ble_att_clt.c           | 47 ++++++---------------------------
 nimble/host/src/ble_att_priv.h          |  3 +--
 nimble/host/src/ble_gattc.c             | 22 ++++++---------
 nimble/host/test/src/ble_att_clt_test.c |  7 ++---
 4 files changed, 19 insertions(+), 60 deletions(-)

commit e819558efae1bd09880d3c137d077c7b040e2f00
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:34:39 2017 +0100

    nimble/att: Use new helpers for sending Prepare Write Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: d290cd7eb79540f1d9f14623861894e0dbd8ee9e

 nimble/host/src/ble_att_clt.c           | 29 ++++++++++++-----------------
 nimble/host/src/ble_att_cmd_priv.h      |  1 +
 nimble/host/src/ble_att_priv.h          |  5 ++---
 nimble/host/src/ble_gattc.c             | 15 +++++----------
 nimble/host/test/src/ble_att_clt_test.c |  9 ++-------
 5 files changed, 22 insertions(+), 37 deletions(-)

commit 0348beb6abc99e619d1c8bd4ce1d5fdb196b5f96
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:34:01 2017 +0100

    nimble/att: Use new helpers for sending Write Request and Command
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: a9549fdbc17383c00851dde7bd555cf628d3876b

 nimble/host/src/ble_att_clt.c           | 65 ++++++++++++---------------------
 nimble/host/src/ble_att_cmd.c           | 10 ++++-
 nimble/host/src/ble_att_cmd_priv.h      | 17 ++++++++-
 nimble/host/src/ble_att_priv.h          |  6 +--
 nimble/host/src/ble_att_svr.c           |  4 +-
 nimble/host/src/ble_gattc.c             |  8 +---
 nimble/host/test/src/ble_att_clt_test.c | 14 +++----
 7 files changed, 59 insertions(+), 65 deletions(-)

commit 0404634d5f146e3bcdc68e7ffdfa42bd452ba7b3
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:33:07 2017 +0100

    nimble/att: Use new helpers for sending Find By Type Value Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    read
    
    X-Original-Commit: 191acab73c9c77c157a806d8871b653f3c64cbc9

 nimble/host/src/ble_att_clt.c      | 48 ++++++++++++++------------------------
 nimble/host/src/ble_att_cmd_priv.h |  1 +
 nimble/host/src/ble_att_priv.h     |  6 ++---
 nimble/host/src/ble_gattc.c        | 10 ++++----
 4 files changed, 26 insertions(+), 39 deletions(-)

commit 9ff4b029f6b1bbc5e23a7a1d46b2fa3a14f26a61
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:32:18 2017 +0100

    nimble/att: Use new helpers for sending Find Information Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 5e82b3f7c0daf08547b51ec47907891e4cbb1b38

 nimble/host/src/ble_att_clt.c           | 25 ++++++++++---------------
 nimble/host/src/ble_att_priv.h          |  4 ++--
 nimble/host/src/ble_gattc.c             |  8 +++-----
 nimble/host/test/src/ble_att_clt_test.c | 17 ++++-------------
 4 files changed, 19 insertions(+), 35 deletions(-)

commit c4d71bcb6acd9904ac99e8acbfa55efdac7bbb01
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:31:52 2017 +0100

    nimble/att: Use new helpers for sending Read By Group Type Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 1c08e62b42bed9fe0ba83d564548b388c55ebc45

 nimble/host/src/ble_att_clt.c      | 40 ++++++++++++--------------------------
 nimble/host/src/ble_att_cmd_priv.h |  1 +
 nimble/host/src/ble_att_priv.h     |  6 +++---
 nimble/host/src/ble_gattc.c        |  7 +++----
 4 files changed, 19 insertions(+), 35 deletions(-)

commit 6a26ec29a711407d788cac096eb238a3c7eb3c18
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:29:40 2017 +0100

    nimble/att: Use new helpers for sending Read By Type Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 3f4cac389abd597446cfdd5edbbf535b9142e294

 nimble/host/src/ble_att_clt.c      | 43 ++++++++++++--------------------------
 nimble/host/src/ble_att_cmd_priv.h |  1 +
 nimble/host/src/ble_att_priv.h     |  5 ++---
 nimble/host/src/ble_gattc.c        | 41 +++++++++++-------------------------
 4 files changed, 28 insertions(+), 62 deletions(-)

commit 95a706bc07879808f5b9b90f8817e40a0d493bfc
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:29:05 2017 +0100

    nimble/att: Use new helpers for sending Read Multiple Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: ab23765903ebeab9303d639fb5b52924ce5bb923

 nimble/host/src/ble_att_clt.c      | 61 ++++++++------------------------------
 nimble/host/src/ble_att_cmd_priv.h |  3 ++
 2 files changed, 16 insertions(+), 48 deletions(-)

commit 5183afbfdcd0329e75c089c78ff3c7b5e01514d0
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:28:38 2017 +0100

    nimble/att: Use new helpers for sending Read Blob Request
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 090f62b725b2713cb4dd9013ff7f4f3fa413a2cc

 nimble/host/src/ble_att_clt.c           | 18 ++++++++++--------
 nimble/host/src/ble_att_priv.h          |  4 ++--
 nimble/host/src/ble_gattc.c             |  7 +++----
 nimble/host/test/src/ble_att_clt_test.c |  9 ++-------
 4 files changed, 17 insertions(+), 21 deletions(-)

commit d958e0d98ba8208366e1417dde744a1335e856b6
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:27:57 2017 +0100

    nimble/att: Use new helpers for sending read command
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 58743be0c8f1991e4dc98b4c33d3b0420bdb3743

 nimble/host/src/ble_att_clt.c           | 16 +++++++++-------
 nimble/host/src/ble_att_priv.h          |  3 +--
 nimble/host/src/ble_gattc.c             | 13 ++++---------
 nimble/host/test/src/ble_att_clt_test.c |  7 ++-----
 4 files changed, 16 insertions(+), 23 deletions(-)

commit 1507bbc1cdaf4d032884d3883c4a2c3ac8f80c69
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 15:27:26 2017 +0100

    nimble/att: Use new helpers for sending MTU exchange
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: 55b8a5c20766f93996cd04d8ba06f8b77787932d

 nimble/host/src/ble_att_clt.c           | 16 +++++++++-------
 nimble/host/src/ble_att_priv.h          |  3 +--
 nimble/host/src/ble_gattc.c             | 15 +++++----------
 nimble/host/test/src/ble_att_clt_test.c |  4 +---
 4 files changed, 16 insertions(+), 22 deletions(-)

commit 0ca890d2e9dda17b022f365fee871eacdb95cead
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 12:52:57 2017 +0100

    nimble/att: Use new helpers for sending error response
    
    This constructs response directly on mbuf reducing number of memcopies.
    
    X-Original-Commit: b50707b6a67dd8b4d6b168904b0a4d6b8a79bcf7

 nimble/host/src/ble_att_svr.c | 71 ++++++++++++++++---------------------------
 1 file changed, 27 insertions(+), 44 deletions(-)

commit 517876561c1ecd9dd61dec071a4bbc920ac215f8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 12:51:52 2017 +0100

    nimble/att: Add generic helpers for sending commands
    
    Those will be used to construct ATT command directly in os_mbuf.
    
    X-Original-Commit: 71a8a47cb6acaad0d7899adbfbc09d23e4e7a9d5

 nimble/host/src/ble_att_cmd.c      | 55 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_att_cmd_priv.h | 12 +++++++++
 2 files changed, 67 insertions(+)

commit 482e49fc64b2f6e484c08ef888b4cb5acaf78e32
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Mar 24 12:51:46 2017 +0100

    nimble/att: Remove not needed forward declaration
    
    X-Original-Commit: a94e4ded374cde5615bb4c69b393971adc2ba764

 nimble/host/src/ble_att_cmd_priv.h | 2 --
 1 file changed, 2 deletions(-)

commit 826d53762477f876419f7db847510fe41da90d12
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Thu Apr 6 15:47:05 2017 +0200

    nimble/controller: Send LE Channel Selection Algorithm Event
    
    If connection is created and LE Channel Selection Algorithm Event is
    unmasked send it immediately after LE (Enhanced) Connection Complete
    event.
    
    < HCI Command: LE Set Event Mask (0x08|0x0001) plen 8       25.731854
            Mask: 0x000000000008045f
              LE Connection Complete
              LE Advertising Report
              LE Connection Update Complete
              LE Read Remote Used Features Complete
              LE Long Term Key Request
              LE Data Length Change
              LE Direct Advertising Report
              LE Channel Selection Algorithm
    
    ....
    
    > HCI Event: LE Meta Event (0x3e) plen 19                   44.589758
          LE Connection Complete (0x01)
            Status: Success (0x00)
            Handle: 1
            Role: Master (0x00)
            Peer address type: Public (0x00)
            Peer address: 0A:0A:0A:0A:0A:0A (OUI 0A-0A-0A)
            Connection interval: 18.75 msec (0x000f)
            Connection latency: 0.00 msec (0x0000)
            Supervision timeout: 32000 msec (0x0c80)
            Master clock accuracy: 0x04
    > HCI Event: LE Meta Event (0x3e) plen 4                    44.589780
          LE Channel Selection Algorithm (0x14)
            Handle: 1
            LE Channel Selection Algorithm #2 (0x01)
    
    X-Original-Commit: a7d39f9295576faf9f04ce89f6ee223643dd4f87

 nimble/controller/include/controller/ble_ll_ctrl.h |  2 +-
 nimble/controller/src/ble_ll_adv.c                 |  1 +
 nimble/controller/src/ble_ll_conn.c                |  1 +
 nimble/controller/src/ble_ll_hci_ev.c              | 23 ++++++++++++++++++++++
 nimble/include/nimble/hci_common.h                 |  3 +++
 5 files changed, 29 insertions(+), 1 deletion(-)

commit 863834abab9cae8a39ece8e7e1c30c54f16898df
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 5 18:20:18 2017 +0200

    nimble/controller: Add CSA #2 to supported features
    
    Feature bit should be set if CSA #2 is supported.
    
    < HCI Command: LE Read Local Supported Features (0x08|0x0003) plen 0
    > HCI Event: Command Complete (0x0e) plen 12
          LE Read Local Supported Features (0x08|0x0003) ncmd 1
            Status: Success (0x00)
            Features: 0xfd 0x40 0x00 0x00 0x00 0x00 0x00 0x00
              LE Encryption
              Extended Reject Indication
              Slave-initiated Features Exchange
              LE Ping
              LE Data Packet Length Extension
              LL Privacy
              Extended Scanner Filter Policies
              Channel Selection Algorithm #2
    
    X-Original-Commit: 8e0cf0dc75da6597561596c09362bb7d3b14d2d6

 nimble/controller/include/controller/ble_ll.h      | 33 ++++++++++++++--------
 nimble/controller/include/controller/ble_ll_conn.h |  2 +-
 nimble/controller/src/ble_ll.c                     |  9 ++++--
 nimble/controller/src/ble_ll_ctrl.c                | 14 +++++----
 nimble/controller/src/ble_ll_hci.c                 |  3 +-
 nimble/controller/src/ble_ll_hci_ev.c              |  2 +-
 6 files changed, 40 insertions(+), 23 deletions(-)

commit 24399a99fcf795db250a9453380f1212770c5847
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Apr 7 13:53:11 2017 +0200

    nimble/controller: Improve CSA #2 channel identifier calculation
    
    Channel identifier is fixed for connection (calculated from access
    address) so there is no need to calculate it every time algorithm
    function is called. The drawback is extra 2 bytes in ble_ll_conn_sm
    structure.
    
    X-Original-Commit: c74e47a4f8133a9941864bac6167c4a0eea61403

 nimble/controller/include/controller/ble_ll_conn.h | 1 +
 nimble/controller/src/ble_ll_conn.c                | 8 +++-----
 2 files changed, 4 insertions(+), 5 deletions(-)

commit 88b9b284fcd95bca895ce1ea680f7bf4daa97d35
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Apr 5 14:33:33 2017 +0200

    nimble/controller: Add support for Channel Selection Algorithm #2
    
    When both sides indicate support for CSA #2 (by setting ChSel bit in
    respective PDUs) it is used for channels selection.
    
    X-Original-Commit: 96797c92e9bb7d27119bf48020bd1bead117b1db

 nimble/controller/include/controller/ble_ll.h      |  4 +++
 nimble/controller/include/controller/ble_ll_conn.h |  2 ++
 nimble/controller/src/ble_ll_adv.c                 |  7 ++++
 nimble/controller/src/ble_ll_conn.c                | 38 ++++++++++++++++------
 nimble/controller/src/ble_ll_conn_hci.c            |  4 +++
 5 files changed, 45 insertions(+), 10 deletions(-)

commit f0a4d4e15ecbb0912a5f201ee77d5ad58ea3127e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Apr 4 11:58:09 2017 +0200

    nimble/controller: Add initial unit tests for controller
    
    This adds unit tests boilerplate and initial unit tests for controller.
    Currently only tests for Channel Selection Algorithm #2 are implemented.
    
    X-Original-Commit: 9cf07fda600f04971bb894ff405d07ad80c588f3

 nimble/controller/include/controller/ble_ll_conn.h |   3 +
 nimble/controller/include/controller/ble_ll_test.h |  35 ++++++
 nimble/controller/src/ble_ll_sched.c               |   1 +
 nimble/controller/src/ble_ll_xcvr.c                |   1 +
 nimble/controller/test/pkg.yml                     |  33 ++++++
 nimble/controller/test/src/ble_ll_csa2_test.c      | 119 +++++++++++++++++++++
 nimble/controller/test/src/ble_ll_test.c           |  40 +++++++
 nimble/controller/test/syscfg.yml                  |  21 ++++
 8 files changed, 253 insertions(+)

commit e95b5a1c771a611995562285a3519aa59c546e3b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 3 17:08:44 2017 +0200

    nimble/controller: Use common implementation for channel remapping
    
    Both CSA #1 and #2 use same concept of using remapping index for
    selecting used channel.
    
    X-Original-Commit: 2566748c612b1c32d94f9a41150c829ca01e12c7

 nimble/controller/src/ble_ll_conn.c | 39 ++++++-------------------------------
 1 file changed, 6 insertions(+), 33 deletions(-)

commit 5b0e50ccae0cdcc5a49ba4838b24736ab3a5b7a2
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Apr 3 17:03:13 2017 +0200

    nimble/controller: Add Channel Selection Algorithm #2 implementation
    
    This adds implementation of Channel Selection Algorithm #2 as specified
    in Core Specification 5.0 Vol 6 Part B 4.6.14.
    
    X-Original-Commit: 51d1ea26a6436be6c9fde415e0b973bc81381ce1

 nimble/controller/src/ble_ll_conn.c | 105 ++++++++++++++++++++++++++++++++++++
 1 file changed, 105 insertions(+)

commit 0c8e780b794de96218f710e97e96a518f87ff96f
Author: Vipul Rahane <vipulrahane@apache.org>
Date:   Thu Apr 6 15:50:17 2017 -0700

    MYNEWT-713 Sysinit: nimble controller crashes
    
    - It crashes because of uninitialized callback
      function, changing initialization priority fixes this.
    
    X-Original-Commit: fe4b763a95ab9b0ce1a165b3401f51db504c73ef

 nimble/controller/pkg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 853b97c0846745c69c7b7d1a20eb419310d95aca
Author: Marko Kiiskila <marko@runtime.io>
Date:   Thu Apr 6 14:32:47 2017 -0700

    nimble/transport/socket; forgot to register with stats package.
    
    X-Original-Commit: 52a585c13b9b60d28bfa5d2b0f3193f0d59cee03

 nimble/transport/socket/src/ble_hci_socket.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 7afc9a2c81b42356f76cfbbf23bb18849d12b0e9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 21 14:19:02 2017 +0100

    nimble/l2cap: Add PTS instructions for LE CoC and run all the testcases
    
    This patch adds instructions for LE CoC and fixes adv data settings
    for previous test cases.
    
    X-Original-Commit: b907e7d3ea98965dae6d3b8d1bf858bce48c96aa

 nimble/host/pts/pts-l2cap.txt | 75 +++++++++++++++++++++++++++++++------------
 1 file changed, 55 insertions(+), 20 deletions(-)

commit 768267a5e71304ff1ac90caf08508a11a9d38388
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 17 15:22:55 2017 +0100

    nimble/pts: Update pts files due to L2CAP LE CoC
    
    X-Original-Commit: 5a6fd54f1ca6c8efb7a010137e78065320c4569f

 nimble/host/pts/tpg/90359-20161220-172100175.tpg   | 1022 -------------------
 nimble/host/pts/tpg/94654-20170317-085122560.tpg   | 1026 ++++++++++++++++++++
 ...-172113981.pts => 94654-20170317-085441153.pts} |    3 +-
 3 files changed, 1028 insertions(+), 1023 deletions(-)

commit c29f4081b98548858db9a9b9ab8739f239fbd501
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 17 13:40:00 2017 +0100

    nimble/l2cap: Add initial unit tests for LE CoC
    
    X-Original-Commit: 082d066ef9f1d4ffcb4a4a1103c3dda7ff18cfeb

 nimble/host/test/src/ble_hs_test_util.c |  73 ++++
 nimble/host/test/src/ble_hs_test_util.h |   7 +
 nimble/host/test/src/ble_l2cap_test.c   | 696 +++++++++++++++++++++++++++++++-
 nimble/host/test/syscfg.yml             |   1 +
 4 files changed, 776 insertions(+), 1 deletion(-)

commit 621e2d92231d1bb5d04c0bcc5c247a750096f7b8
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 17 15:32:12 2017 +0100

    nimble/l2cap: Fix hs locking issue when sending le_credit_update
    
    X-Original-Commit: 0b3ea953da71eca84fdcbcfd7affbea2e615ce8e

 nimble/host/src/ble_l2cap_coc.c      | 7 +++++--
 nimble/host/src/ble_l2cap_sig.c      | 6 +++---
 nimble/host/src/ble_l2cap_sig_priv.h | 3 ++-
 3 files changed, 10 insertions(+), 6 deletions(-)

commit 1294a7f3d73399a9be1e0a4c907bbe9d4cbbe66b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 17 13:35:37 2017 +0100

    nimble/l2cap: Fix logs on LE CoC receive data
    
    X-Original-Commit: 8a64a498afdcc1d7b7b46436f87e16a393521c77

 nimble/host/src/ble_l2cap_coc.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit dfe35ac4c74443d264e864ec1e11b101588ad151
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 15 14:02:17 2017 +0100

    nimble/l2cap: Fix for reject incoming LE CoC channel
    
    With this patch, when user rejects incoming connection stack not send
    BLE_L2CAP_EVENT_COC_DISCONNECTED event
    
    X-Original-Commit: 41c9c799807bc654ef20361611ba732c68012979

 nimble/host/src/ble_l2cap_sig.c | 4 ++++
 1 file changed, 4 insertions(+)

commit ab7dc69416e44ceafdcd13cb7e044a1d7b9fad02
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 15 12:29:54 2017 +0100

    nimble/l2cap: Fix locking on incoming LE CoC connect request
    
    Just use lock when retrieve or add channel to conn object.
    Without this patch there is a locking issue when ble_l2cap_recv_read()
    is called on BLE_L2CAP_EVENT_COC_ACCEPT
    
    Issue found during unit test writing for LE CoC
    
    X-Original-Commit: 11d2cb595e40943463f8b9f349820a3fda28f7a5

 nimble/host/src/ble_l2cap_sig.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit a8f33148aa657d2cbd9e0b4a9f0eb8746c872b19
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 15 12:28:21 2017 +0100

    nimble/l2cap: Fix locking on LE CoC connect
    
    Make sure to do hs unlock before ble_l2cap_sig_tx() as this function
    does it's own locking.
    Found during writing unit test for LE CoC
    
    X-Original-Commit: e6d3b0e6c2ed8351e0931ec4858be2651e21bfd9

 nimble/host/src/ble_l2cap_sig.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit a7c7ce871def6016793bca45b2d7e33e267280a9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 14 14:37:20 2017 +0100

    nimble/l2cap: Fix locking when receiving LE CoC credit update
    
    Lets remove lock once we have conn and chan.
    Functions ble_l2cap_coc_continue_tx() and ble_l2cap_sig_disconnect()
    do own locking when needed,
    
    X-Original-Commit: f902592a8e83030111a5555be12530a681ca6b97

 nimble/host/src/ble_l2cap_coc.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit 0389031d651f8c960dc6b216f99b22a0acaf61f5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 5 15:34:59 2017 +0200

    nimble/host: Add support for privacy modes
    
    With this patch application can set privacy mode for peer devices
    as per Bluetooth 5.0 specification Vol 6, Part B, chapter 4.7
    
    X-Original-Commit: 674af9341189c3996bfbf966605045a1d05e59fe

 nimble/host/include/host/ble_gap.h |  4 ++++
 nimble/host/src/ble_gap.c          |  6 +++++
 nimble/host/src/ble_hs_hci_cmd.c   | 46 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_priv.h  |  3 +++
 nimble/host/src/ble_hs_pvcy.c      | 15 +++++++++++++
 nimble/host/src/ble_hs_pvcy_priv.h |  1 +
 6 files changed, 75 insertions(+)

commit e88edf870fe6bc59820110001587a8647d66a1f2
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Apr 6 09:40:04 2017 +0200

    nimble/controller: Add helper to check if controller is busy
    
    In couple of places we were checking if controller is scanning, advertising
    or connection is in progress. Lets make a helper for this
    
    X-Original-Commit: 0536012adbda8df58e2e1f7d548abb626012a2d1

 nimble/controller/src/ble_ll_resolv.c | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)

commit 5cbc31d53b9a93dd6d41e6f3f048b2cdd9d6c1c4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Apr 5 15:33:30 2017 +0200

    nimble/controller: Add support for handling privacy modes
    
    With this patch nimble controller supports network and device
    privacy mode as per Bluetooth 5.0 Vol 6, Part B, chapter 4.7
    
    Host can set privacy mode using LE set privacy mode command.
    
    X-Original-Commit: ac7b489a693accf3abe98628a9395e13f69f2c71

 .../controller/include/controller/ble_ll_resolv.h  |  6 ++++-
 nimble/controller/src/ble_ll_conn.c                | 25 ++++++++++++++---
 nimble/controller/src/ble_ll_hci.c                 |  3 +++
 nimble/controller/src/ble_ll_resolv.c              | 31 ++++++++++++++++++++++
 nimble/include/nimble/hci_common.h                 |  2 ++
 5 files changed, 63 insertions(+), 4 deletions(-)

commit 9a78c0b5423e56f993db7b67a3aa0cedf0fd3bd7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Apr 4 10:39:58 2017 +0200

    nimble: Add defines for all Bluetooth 5.0 HCI commands and events
    
    X-Original-Commit: 0c627e2bc01ec1d9d32cc706c2cbd61e600147d3

 nimble/controller/src/ble_ll_hci.c |   2 +-
 nimble/include/nimble/hci_common.h | 228 +++++++++++++++++++++++++++----------
 nimble/src/hci_common.c            |  35 +++++-
 3 files changed, 204 insertions(+), 61 deletions(-)

commit 2c2601860852d027c06b38bf2b17c9f975163c7e
Merge: 8f626dc5 8996b02d
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Apr 5 15:06:26 2017 +0200

    This closes #212.
    
    Merge branch 'sc_mynewt_661' of https://github.com/rymanluk/incubator-mynewt-core into develop
    
    X-Original-Commit: eea7f7ce9685f98431172025e75433919d96676f

commit 71666cec67bc1b906875e5d5fb1ba4f3e80ddb8b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 31 10:55:18 2017 +0200

    nimble/controller: Add support for high duty cycle non-conn
    
    Bluetooth specification 5.0 removes restrictions regarding minimum
    advertising interval for non-connectable advertising. This enables
    high duty cycle for this advertising type.
    
    X-Original-Commit: aa7a2745937afd94882a13051d7fb52aa88dec01

 nimble/controller/include/controller/ble_ll_adv.h | 1 -
 nimble/controller/src/ble_ll_adv.c                | 2 +-
 2 files changed, 1 insertion(+), 2 deletions(-)

commit ec0ad6a0b0df171fe9ebe410fe078123a5c37264
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 31 10:52:53 2017 +0200

    nimble/controller: Change LL and HCI version to Bluetooth 5.0
    
    We start adding features from Bluetooth 5.0 so lets move on with version
    first
    
    < HCI Command: Read Local Version Information (0x04|0x0001) plen 0
    > HCI Event: Command Complete (0x0e) plen 12
          Read Local Version Information (0x04|0x0001) ncmd 1
            Status: Success (0x00)
            HCI version: Bluetooth 5.0 (0x09) - Revision 0 (0x0000)
            LMP version: Bluetooth 5.0 (0x09) - Subversion 0 (0x0000)
            Manufacturer: internal use (65535)
    
    X-Original-Commit: 9ed2a9e611f2485caa06b371770ad04867ae9dcc

 nimble/controller/src/ble_ll_ctrl.c | 2 +-
 nimble/controller/src/ble_ll_hci.c  | 4 ++--
 nimble/include/nimble/hci_common.h  | 2 ++
 3 files changed, 5 insertions(+), 3 deletions(-)

commit 8f626dc5d59a6cbfed2ac0f1e795bd8f2736876b
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 4 15:30:20 2017 -0700

    No jira ticket: fix uninitialized local variable.
    
    X-Original-Commit: 79e45a56bb9f9f32604324760d275bc7cf75bdc2

 nimble/controller/src/ble_ll_ctrl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2e5f891939e731998b2ce65fa8862ff18e19f8a8
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 4 15:11:28 2017 -0700

    No jira ticket: get native ble building.
    
    X-Original-Commit: 8b595e29cf734b14320a39eb691dbfc9a0139725

 nimble/controller/src/ble_ll_xcvr.c |  1 +
 nimble/drivers/native/src/ble_hw.c  | 14 ++++++++++++++
 nimble/drivers/native/src/ble_phy.c |  5 +++++
 3 files changed, 20 insertions(+)

commit 4ee9441ebc49fa5e252a56be6092252403616ffb
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 4 15:03:21 2017 -0700

    No jira ticket. Remove unused header file bsp.h
    
    X-Original-Commit: 75d9c304e99cb12754c02a1b5ed42a8b6fb25b7d

 nimble/controller/src/ble_ll_sched.c | 1 -
 1 file changed, 1 deletion(-)

commit 8a8a82b78d895bee8cdb10c5ba962755a95dd98d
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 4 14:00:11 2017 -0700

    MYNEWT-707: Add API to retrieve public and random static address
    
    Please read the Jira ticket for more information on how to use
    these API. The controller now calls ble_hw_get_public_addr() and
    will use that address for its public address. The global
    device address has not been hidden yet since some apps rely on
    the ability to modify it.
    
    X-Original-Commit: 95c7d3e5f951e381bd8dbfc82335a3a3384d9f56

 nimble/controller/include/controller/ble_hw.h |  6 ++++
 nimble/controller/src/ble_ll.c                | 13 +++++++
 nimble/controller/syscfg.yml                  |  9 +++++
 nimble/drivers/nrf51/src/ble_hw.c             | 52 +++++++++++++++++++++++++++
 nimble/drivers/nrf52/src/ble_hw.c             | 52 +++++++++++++++++++++++++++
 5 files changed, 132 insertions(+)

commit 53c595dc083ad489d7f4496656307651881a2e88
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Apr 4 09:40:55 2017 -0700

    net/nimble; add HCI transport which has Linux bluetooth socket,
    or TCP socket as it's target.
    
    X-Original-Commit: 9fcbd0d0d5d45b4495a93f71fe17b23d7761e44f

 .../socket/include/socket/ble_hci_socket.h         |  34 +
 nimble/transport/socket/pkg.yml                    |  38 +
 nimble/transport/socket/src/ble_hci_socket.c       | 797 +++++++++++++++++++++
 nimble/transport/socket/syscfg.yml                 |  66 ++
 4 files changed, 935 insertions(+)

commit d64f4a4d9ffe01e16bd5c558e0d7a6725fe18bbd
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 3 18:24:26 2017 -0700

    MYNEWT-702 dbg: Erase mempool entries during free.
    
    This behavior only takes effect when BLE_HS_DEBUG is enabled.  When a
    host mempool entry is freed, it is memset to 0xff.  This will hopefully
    help catch dangling pointer bugs.
    
    X-Original-Commit: b8380e94765005b48bfeebe06dee2c2ac924da96

 nimble/host/src/ble_att_svr.c   | 3 +++
 nimble/host/src/ble_gattc.c     | 3 +++
 nimble/host/src/ble_hs_conn.c   | 3 +++
 nimble/host/src/ble_l2cap.c     | 3 +++
 nimble/host/src/ble_l2cap_sig.c | 3 +++
 nimble/host/src/ble_sm.c        | 4 +++-
 6 files changed, 18 insertions(+), 1 deletion(-)

commit 32b552e1670ef212e1d46a39528706523bf5aeb3
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 3 18:23:58 2017 -0700

    MYNEWT-702 BLE Host - duplicate update entries
    
    Fix similar issue for L2CAP updates.
    
    X-Original-Commit: e33dbd45aa2de1209ef36d2cc0cf7016d97f2828

 nimble/host/src/ble_gap.c           | 6 ++++--
 nimble/host/test/src/ble_gap_test.c | 9 +++++++++
 2 files changed, 13 insertions(+), 2 deletions(-)

commit 2231a26c5e2329ac9605bb3e59d4454fb2985168
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 3 15:35:05 2017 -0700

    MYNEWT-668: Improve throughput of BLE connections
    
    We will now send the number of completed packets event faster
    than it was being sent before, assuming that more than 2 packets
    were completed in a connection event. The old code would send
    the event at the end of the connection event and this impacted
    single connection throughput when trying to max out the
    throughput.
    
    X-Original-Commit: f6014227f9173aec3c27e7c109f8a2289255eaca

 nimble/controller/include/controller/ble_ll.h |  3 +++
 nimble/controller/src/ble_ll.c                | 14 +++++++++-----
 nimble/controller/src/ble_ll_conn.c           |  8 +++++---
 nimble/controller/src/ble_ll_conn_hci.c       |  7 ++++++-
 4 files changed, 23 insertions(+), 9 deletions(-)

commit 73e0a4936a592cead9738fc3c58b1fae6c326ca8
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 3 09:34:55 2017 -0700

    MYNEWT-698: Unhandled exception in ble_ll_conn_end
    
    This is another issue that should not occur but was discovered
    when testing with other devices. If the device sends a TERMINATE
    with "unknown connection ID (error 2)" this would cause the
    controller to access a NULL variable. This has now been fixed.
    
    X-Original-Commit: a73a65bfce7a86c0ef1d481c2506ab07a19f18fe

 nimble/controller/src/ble_ll_conn.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 4116ca3dfc309d9a1eb0afa64580fdbcfa4a4caa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 3 16:01:43 2017 +0200

    nimble/controller: Fix mixed AdvAdd and InitA in the advertising report
    
    With this patch InitA is put into 'Direct address' field and AdvAdd is
    put into 'Address' field of LE Direct Advertising Report event
    
    Also RSSI has been added in the end of this report:
    
    > HCI Event: LE Meta Event (0x3e) plen 18
          LE Direct Advertising Report (0x0b)
            Num reports: 1
            Event type: Connectable directed - ADV_DIRECT_IND (0x01)
            Address type: Random (0x01)
            Address: 7F:1B:6A:0E:32:CF (Resolvable)
            Direct address type: Random (0x01)
            Direct address: 5E:10:15:22:54:00 (Resolvable)
            RSSI: -22 dBm (0xea)
    
    X-Original-Commit: ce3e0378d3f6c8bba4158aa8f6ba7cc839dadef8

 nimble/controller/src/ble_ll_scan.c | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)

commit 5f9754facd4c37d19802bbe7e49aeace730f951d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 3 15:59:10 2017 +0200

    nimble/controller: Fix len of InitA in advertising report
    
    X-Original-Commit: 94cfca3213f90310e9273836d664f3de393a5ed9

 nimble/controller/src/ble_ll_scan.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7296555038f9545d4430082b587b7a433174c34c
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Apr 3 15:42:06 2017 +0200

    nimble/controller: Fix for directed advertising report
    
    Whenever scan filtering is 0x02 and initA is not resolved RPA,
    we should send to host LE Direct Advertising Report event instead of
    LE Advertising Report.
    If InitA is not a RPA we should rather drop the adv packet.
    
    With this patch we also stop to determine subevent type on own_address_type
    as this is not related.
    
    X-Original-Commit: bf72b358b0d79e37bb0ab8fc3240beacdb0f7c42

 nimble/controller/src/ble_ll_scan.c | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

commit 5650ffddfb1ae25309fcf2206fec56b5f6f044a1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 31 15:20:06 2017 -0700

    MYNEWT-702 BLE Host - duplicate update entries
    
    If the application calls ble_gap_update_params() while an update
    connection procedure for that connection is already in progress, the
    existing entry gets re-inserted in the ble_gap_update_entries list. This
    yields a cycle in the list, causing the host task to loop endlessly
    during iteration.
    
    More details:
    
    1. Host initiates a connection update procedure; creates an entry and
       inserts it into the list (ble_gap_update_entries).
    
    2. Host attempts to initiate a second connection update procedure for
       the same connection. Since an existing update procedure is ongoing,
       this attempt fails with a status code of BLE_HS_EALREADY.
    
    3. On detecting the error, the ble_gap_update_params() function tries
       to clean up (goto done). Part of this cleanup involves freeing the
       update entry that got allocated earlier in the function but never got
       inserted into the list. In this case, no entry was allocated, but it
       looks like one was, because the entry pointer was used to detect a
       duplicate entry. Consequently, the entry is freed but never removed
       from the list!
    
    4. The host initiates a third connection update procedure for the same
       connection. This time, no duplicate is detected because the entry in
       the list got corrupted when it was freed, making its connection
       handle value indeterminate. The host allocates the same entry from
       the pool, populates it, and inserts it into the list. Now the same
       entry is in the list twice, creating a cycle. When the host iterates
       this list, it loops forever.
    
    X-Original-Commit: 091fbe124365ee8b109368928526ed86301b5af8

 nimble/host/src/ble_gap.c           | 10 ++++++++--
 nimble/host/test/src/ble_gap_test.c |  9 +++++++++
 2 files changed, 17 insertions(+), 2 deletions(-)

commit a993c43c9fed0db649a0ae2c8b1f642418405640
Author: William San Filippo <wills@runtime.io>
Date:   Thu Mar 30 13:30:57 2017 -0700

    MYNEWT-701: Low power timer support
    
    This commit adds low power timer support to the controller for
    the nordic chips. Please see the Jira ticket for more information.
    
    X-Original-Commit: 3c7859538a63df76d170fb5cc30cac902f13a7b0

 nimble/controller/include/controller/ble_ll.h |   2 +-
 nimble/controller/src/ble_ll_conn.c           |   6 +-
 nimble/drivers/nrf51/include/ble/xcvr.h       |  11 +-
 nimble/drivers/nrf51/src/ble_phy.c            | 440 +++++++++++++++++++++++---
 nimble/drivers/nrf52/src/ble_phy.c            |   5 +
 5 files changed, 423 insertions(+), 41 deletions(-)

commit e0b708124cf20cd30239682b431d6c5bd66390f5
Author: William San Filippo <wills@runtime.io>
Date:   Thu Feb 16 16:12:39 2017 -0800

    Low power timer. Only nrf52 right now.
    
    X-Original-Commit: 507f493ab86266528c7f921784978e63a07ddd33

 nimble/controller/include/controller/ble_ll.h      |  51 ++-
 nimble/controller/include/controller/ble_ll_conn.h |   5 +
 .../controller/include/controller/ble_ll_sched.h   |  32 +-
 nimble/controller/include/controller/ble_ll_xcvr.h |  48 +++
 nimble/controller/include/controller/ble_phy.h     |  31 +-
 nimble/controller/src/ble_ll.c                     |  37 ++
 nimble/controller/src/ble_ll_adv.c                 |  86 +++-
 nimble/controller/src/ble_ll_conn.c                | 265 +++++++++++--
 nimble/controller/src/ble_ll_conn_priv.h           |   3 +-
 nimble/controller/src/ble_ll_scan.c                | 145 ++++++-
 nimble/controller/src/ble_ll_sched.c               | 354 +++++++++++++----
 nimble/controller/src/ble_ll_xcvr.c                | 153 +++++++
 nimble/controller/syscfg.yml                       |   8 +
 nimble/drivers/nrf52/include/ble/xcvr.h            |  12 +-
 nimble/drivers/nrf52/src/ble_phy.c                 | 438 +++++++++++++++++++--
 nimble/host/src/ble_hs_hci_evt.c                   |   6 +-
 nimble/include/nimble/ble.h                        |   3 +
 17 files changed, 1472 insertions(+), 205 deletions(-)

commit ac11c3b35fa3a7fc06ecd4eb94640e49b4d14e96
Author: William San Filippo <wills@runtime.io>
Date:   Thu Jan 19 14:57:21 2017 -0800

    nimble/controller: Slight refactor of use of pkt receive time
    
    Modified the code so that the packet receive time is used in less
    places. No functionality change.
    
    X-Original-Commit: 8158805cd5d86b3fb17365065425711f0cb6b7ea

 nimble/controller/include/controller/ble_ll_conn.h |  2 +-
 nimble/controller/src/ble_ll_adv.c                 |  7 +------
 nimble/controller/src/ble_ll_conn.c                | 21 ++++++++-------------
 nimble/controller/src/ble_ll_conn_priv.h           |  2 +-
 4 files changed, 11 insertions(+), 21 deletions(-)

commit c686e878fbfa57d5c74e46d1d4c98fc1e8540e1b
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 30 12:09:48 2017 -0700

    MYNEWT-700 BLE Host - Race condition: discon + att
    
    Some parts of the ATT code assume a peer is still connected after an
    initial check. This assumption leads to a race condition when a task
    other than the host task is doing the transmitting (e.g., tx of
    unsolicited notification). It is possible that the peer gets
    disconnected after the tx function is called, but before it completes.
    When this occurs, an assertion fails (ble_att_conn_chan_find()).
    
    The fix is to remove this assumption. Always check that the connection /
    channel lookup succeeds before accessing the returned pointers.
    
    X-Original-Commit: 9b6c2847d4fef37e2cbe47b5dfc4b85555c8e3a7

 nimble/host/src/ble_att.c               | 11 +++--
 nimble/host/src/ble_att_clt.c           | 26 +++++++----
 nimble/host/src/ble_att_priv.h          |  4 +-
 nimble/host/src/ble_att_svr.c           | 82 ++++++++++++++++++++-------------
 nimble/host/src/ble_gattc.c             | 10 +++-
 nimble/host/test/src/ble_att_svr_test.c |  6 ++-
 nimble/host/test/src/ble_hs_test_util.c |  6 ++-
 7 files changed, 91 insertions(+), 54 deletions(-)

commit 69d782a136e9b5c4b16a58d9313f8f1a7ff4c804
Author: William San Filippo <wills@runtime.io>
Date:   Wed Mar 29 21:07:33 2017 -0700

    MYNEWT-698: Unhandled exception in controller in ble_ll_conn_end
    
    Not sure what happened but only some of the fix was committed
    in the prior commit. This is the actual fix for this issue.
    
    X-Original-Commit: 612f8efe462f27641cc4fd87993f7a3a079ec67b

 nimble/controller/src/ble_ll_conn.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit e171c863d840fa3cccbb4b18e204969a85e46b71
Author: William San Filippo <wills@runtime.io>
Date:   Wed Mar 29 20:47:49 2017 -0700

    MYNEWT-698: Unhandled exception in controller in ble_ll_conn_end
    
    The controller was generating an unhandled exception inside the
    function ble_ll_conn_end. This was occurring when the controller
    was scheduling a new connection (master role) but no mbufs were
    available to hand the received pdu to the link layer task. The
    code attempts to schedule a master role connection and send a
    connection request prior to allocating a receive buffer for the
    received advertising pdu. It does this to save time since we need
    all the time available from when the advertising pdu is received
    until the time we need to send the connect request.
    
    I am not terribly pleased with the fix since it is inefficient.
    However, I wanted to get a fix in now. A better way might not be
    to re-enable scanning or initiating unless a buffer is available
    for receive but that change would be a bit more work.
    
    X-Original-Commit: 3538765730aa8aaa1b49fd4a2b3a263272bcff4f

 nimble/controller/src/ble_ll_conn.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 94d9a59542942165c601926b4f442af5978819e7
Author: William San Filippo <wills@runtime.io>
Date:   Wed Mar 29 20:15:55 2017 -0700

    MYNEWT-697: Controller can leak connection state machines
    
    Fixed bug where it was possible that a controller could allocate
    a connection state machine and never make it active or free it.
    If this happens, it is possible that the controller would not
    be able to create a new connection. This particular bug would
    only occur if the device was a central and would occur during
    the le create connection command.
    
    X-Original-Commit: bf901055b8e6b24072f2ae1dd3b2ccf0f0a4fac3

 nimble/controller/src/ble_ll_conn_hci.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit a28b394ae44cfba4a6d7ed400404bd827b9a2bae
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 18:11:06 2017 -0700

    BLE Host - Remove duplicate conn check.
    
    X-Original-Commit: fdc3d2b3ef64e95401fb2431adf2072b551d4c1e

 nimble/host/src/ble_gap.c | 6 ------
 1 file changed, 6 deletions(-)

commit b5185c542acd8e631e3ceca9fd56cc741c828f65
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 7 17:19:15 2017 -0800

    BLE uart transport: Add text to sysinit panic.
    
    X-Original-Commit: 70191424871b916134ff9829d59bb12075790de9

 nimble/transport/uart/src/ble_hci_uart.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 89efd17fa8c9fb095ef47aa759ee752c7c4f9b54
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 16:40:38 2017 -0700

    BLE Host - If initial sync fails, retry later.
    
    X-Original-Commit: e679687fcd6a98a622054ac5786682fe0aa9cc9a

 nimble/host/src/ble_hs.c | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

commit b5288b15ae385611249f2c817ea9232646b58c12
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 16:39:36 2017 -0700

    BLE Host - Make L2CAP CID definitions public.
    
    X-Original-Commit: 9b9820611e7554557612dc13b6b42b0019c7ec88

 nimble/host/include/host/ble_hs.h    | 1 +
 nimble/host/include/host/ble_l2cap.h | 4 ++++
 nimble/host/src/ble_l2cap_priv.h     | 4 ----
 3 files changed, 5 insertions(+), 4 deletions(-)

commit 989a3023e435c4e4bfbf2600ace8ff5014dd9214
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 16:38:19 2017 -0700

    BLE UART xport - sysinit panic on init fail.
    
    X-Original-Commit: c44b4adeae797ec89f32fe821f062a7f27ee33be

 .../uart/include/transport/uart/ble_hci_uart.h     |  2 +-
 nimble/transport/uart/src/ble_hci_uart.c           | 60 +++-------------------
 2 files changed, 9 insertions(+), 53 deletions(-)

commit 98b9d9d8ace408ec139b5667dbd392b161ba5233
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 16:37:21 2017 -0700

    BLE Host - Add missing #include.
    
    X-Original-Commit: e51ce9de50b2950273b1db79e26e43e01b0082b0

 nimble/host/include/host/ble_uuid.h | 3 +++
 nimble/host/src/ble_uuid.c          | 1 +
 2 files changed, 4 insertions(+)

commit 1cd36ff007ab865d1d64a5dd68686cbf94930dc8
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 16:34:15 2017 -0700

    BLE Host - Additional debug logging.
    
    X-Original-Commit: 519e5164bbee1e3c75e679f9d5dc1201af3b8f93

 nimble/host/src/ble_att_clt.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit bb70d97ecb340b0c4931cb925cac2934321832fb
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 28 16:32:25 2017 -0700

    BLE Host - Don't allow conn to already-conned peer
    
    X-Original-Commit: 5ae196a95248b3531f7e3c940f0444df78d3e554

 nimble/host/src/ble_gap.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit ead8995ce1ff2e421503b896f3de92b5e48d441e
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 17 15:24:50 2017 -0700

    BLE Host - Rename parameter for clarity
    
    X-Original-Commit: 03650bcaf55c9d0fec4178f69635b6f7553ae6ac

 nimble/host/include/host/ble_gap.h |  2 +-
 nimble/host/src/ble_gap.c          | 15 ++++++++-------
 2 files changed, 9 insertions(+), 8 deletions(-)

commit 3d7ef4b5e9267d2056c97b49ade4f40403436384
Author: William San Filippo <wills@runtime.io>
Date:   Fri Mar 24 14:02:31 2017 -0700

    MYNEWT-687: Reduce encryption scratchpad size on nrf51
    
    The nrf51 only required the maximum encrypted packet length (plus 16)
    for its encryption scratchpad register. The code was using the max
    PDU length of 251. The nrf51 can only support 27 byte encrypted frames.
    
    X-Original-Commit: e7934fafce21fd27138fd9e15373ce44e30da682

 nimble/drivers/nrf51/src/ble_phy.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit 8996b02dee4567b500d6b5fb51fe9b6c361b30a5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 22 23:48:46 2017 +0100

    nimble/sm: Fix Secure Connection only mode
    
    This patch fix scenarion when one device has set SC only mode
    and second device Legacy pairing
    
    X-Original-Commit: 51d355330554af2ac86a7119f8b8b0bdc624642c

 nimble/host/src/ble_sm.c      | 50 ++++++++++++++++++++++++++++++------------
 nimble/host/src/ble_sm_lgcy.c | 19 ++++++++--------
 nimble/host/src/ble_sm_priv.h |  8 +++----
 nimble/host/src/ble_sm_sc.c   | 51 ++++++++++++++++++++++++++++++-------------
 4 files changed, 85 insertions(+), 43 deletions(-)

commit e3833ef1452a7febb953315fb7d408960b16bc6f
Author: William San Filippo <wills@runtime.io>
Date:   Wed Mar 22 10:17:30 2017 -0700

    MYNEWT-633: Controller does not respond on LL_PHY_REQ
    
    Fix uninitialized local variable.
    
    This closes #211.
    
    X-Original-Commit: ded20e11444d67e6b040a50ab2623002cd513727

 nimble/controller/src/ble_ll_ctrl.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 2ef898318675444519174cdda40665f6f650726a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 22 14:15:53 2017 +0100

    nimble/controller: Fix handling incorrect LL opcode
    
    According to BT specification v5.0 Vol.6 Part B, 2.4.2
    
    If an LL Control PDU is:
    * not supported
    * not used
    * invalid i.e. set to value that is Reserved for Future use
    
    or CtrlData is invalid, the Link Layer shall respond with an
    LL_UNKNOWN_RSP PDU.
    
    This closes #633
    
    X-Original-Commit: f5b3bf68445d645866366bd8c25ce2031215770f

 nimble/controller/src/ble_ll_ctrl.c | 23 ++++++++++++++---------
 1 file changed, 14 insertions(+), 9 deletions(-)

commit 937ef955a40255ca3efc3eb273d327e12fd0ed48
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 21 11:50:35 2017 +0100

    nimble/controller: Minor fix to avoid magic number
    
    X-Original-Commit: 0f1037994bfd4d5007a50f9f80d5f544fc885bd7

 nimble/controller/src/ble_ll_ctrl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 90f0e52cb4850fec6b23ecf637f63b1d02ba8cd9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Mar 7 11:08:38 2017 +0100

    nimble/gap: Fix bad calculation on connection parameters validation
    
    X-Original-Commit: 785d1e1d62566c21575ff24df62ab0eaf5b2c293

 nimble/host/src/ble_gap.c           | 7 ++++++-
 nimble/host/test/src/ble_gap_test.c | 2 +-
 2 files changed, 7 insertions(+), 2 deletions(-)

commit 0ce14e56e579489bf478ad8682e5353cd869724b
Author: Simon Ratner <simon+github@probablyprime.net>
Date:   Sat Mar 4 12:02:40 2017 -0800

    Fix invalid memory accesses in ble_uuid_cmp
    
    When the two uuid values differ in type, one of two things can happen:
    
    1. Access to unallocated or uninitialised memory
    2. Unaligned access to 16/32-bit values
    
    Both of these cause crashes, so always make sure we are comparing like types.
    
    X-Original-Commit: d50951d05479ea3e2749068e7f5cab3c635c3412

 nimble/host/src/ble_uuid.c | 4 ++++
 1 file changed, 4 insertions(+)

commit caa36e8ff0f587e3daf6c7d891731658afcd851e
Merge: bd50101f d6726b20
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 3 09:18:06 2017 -0800

    This closes #190.
    
    Merge remote-tracking branch 'rymanluk/l2cap_coc' into develop
    
    * rymanluk/l2cap_coc: (25 commits)
      nimble/l2cap: Add initial credits calculations
      nimble/l2cap: Improve L2CAP LE CoC connection handling
      nimble/l2cap: Fix hanlding broken ACL during L2CAP procedure
      nimble/l2cap: Fix for possible memory leak
      nimble/l2cap: Handle REJECT CMD on L2CAP LE CoC connection create req
      nibmle/l2cap: Clear LE CoC channel on ACL drop
      nimble/l2cap: Add suppport to send data over L2CAP LE CoC
      nimble/l2cap: Add helper to clean L2CAP LE CoC channel
      nimble/l2cap: Add handling receiving SDU over L2CAP LE CoC
      nimble/l2cap: Add LE credits update handling
      nimble/l2cap: Remove not needed **om from ble_l2cap_rx_fn
      nimble/l2cap: Make ble_l2cap_chan available in ble_l2cap_rx_fn
      nimble/l2cap: Remove not needed function ble_l2cap_sig_init_cmd
      nimble/l2cap: Refactor handling L2CAP reject command
      nimble/l2cap: Fix handling bad data in L2CAP update parameters response
      nimble/l2cap: Add helper to create L2CAP channel for LE CoC
      nimble/l2cap: Refactor update parameters handling
      nimble/l2cap: Fix L2CAP LE CoC disconnection handling
      nimble/l2cap: Memset response in L2CAP LE CoC connect request
      nimble/l2cap: Fix handling scid/dcid in the channel.
      ...
    
    X-Original-Commit: b2ea1dc2caeb0706bad7d30e83488f48b56e1a3f

commit d6726b208fe971069e850cc13603b51590c93768
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Mar 3 11:30:45 2017 +0100

    nimble/l2cap: Add initial credits calculations
    
    With this patch we calculate initial credits in that way that
    peer device is able to send full SDU by fill up fully LE frames.
    
    If it happens that peer is not filling up LE Frames, there is mechanism
    to handling it already in receiving function
    
    X-Original-Commit: 750707ba60915ea182d416c8289324d16af8fa64

 nimble/host/src/ble_l2cap_coc.c  | 16 ++++++++++------
 nimble/host/src/ble_l2cap_priv.h |  1 +
 2 files changed, 11 insertions(+), 6 deletions(-)

commit e9a021eeb464b65b7f0eab3e4e5c625b2eae230b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 1 11:42:43 2017 +0100

    nimble/l2cap: Improve L2CAP LE CoC connection handling
    
    With this patch we make sure remote does not use already used CID
    
    X-Original-Commit: 6963daf878259509b367e9a538302429bb5da0da

 nimble/host/src/ble_l2cap_sig.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 05f4e6e5e267a7d3a8d2e8e2d2f3bf327c7aa6ba
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 1 09:26:17 2017 +0100

    nimble/l2cap: Fix hanlding broken ACL during L2CAP procedure
    
    With this patch we make sure that all processing procedures are
    free and user is notified about broken link
    
    X-Original-Commit: 38ae570452466f55cd15f7b03b78b25babcd1c66

 nimble/host/src/ble_l2cap_sig.c | 27 ++++++++++++++++++---------
 1 file changed, 18 insertions(+), 9 deletions(-)

commit 2f9ee02158d733f1e217f30253f172cc8734383b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Mar 1 09:24:35 2017 +0100

    nimble/l2cap: Fix for possible memory leak
    
    With this patch we remove allocated memory for proc in case we could
    not allocate signaling request later on.
    
    X-Original-Commit: 34e648624d8b005a1aec4bd6ecb1b6a6a3b3cafa

 nimble/host/src/ble_l2cap_sig.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 5c3210adfa2baf933a63071db744f230fac5d9b7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Feb 12 21:49:47 2017 +0100

    nimble/l2cap: Handle REJECT CMD on L2CAP LE CoC connection create req
    
    With this patch, if legacy device response with REJECT CMD on
    LE Create Base Connection request, application will be corretly
    notified.
    
    X-Original-Commit: 44df175e480d0935346edf5b5b8be3bfa03f3304

 nimble/host/src/ble_l2cap_coc.c |  5 +++++
 nimble/host/src/ble_l2cap_sig.c | 39 ++++++++++++++++++++++++++++++++++++++-
 2 files changed, 43 insertions(+), 1 deletion(-)

commit bbb0ece60f4edc639412a06b7e895f5881af3394
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Feb 12 21:45:29 2017 +0100

    nibmle/l2cap: Clear LE CoC channel on ACL drop
    
    When ACL is disconnected before L2CAP is disconnected we need to
    make sure proper cleaning is done and application is notified
    about channel disconnection.
    
    Therefore with this patch sending DISCONNECTED EVENT is moved to
    function doing free of COC specific data in the channel
    
    X-Original-Commit: e488b9df404e1dc45ce6494d66fbe965d66a1758

 nimble/host/src/ble_l2cap_coc.c | 14 ++++++++++++++
 nimble/host/src/ble_l2cap_sig.c | 16 ----------------
 2 files changed, 14 insertions(+), 16 deletions(-)

commit 64edb92022bccda97d679ea7fed02ee98ac14837
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Feb 12 15:26:25 2017 +0100

    nimble/l2cap: Add suppport to send data over L2CAP LE CoC
    
    X-Original-Commit: 93ac0dfaf68e8b5614413b03b0ca787dc9f6142b

 nimble/host/src/ble_l2cap.c          |   3 +-
 nimble/host/src/ble_l2cap_coc.c      | 124 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap_coc_priv.h |   2 +
 3 files changed, 127 insertions(+), 2 deletions(-)

commit 1494ad555ed7e724ff6796c7c209bf307a6672eb
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Feb 12 15:23:09 2017 +0100

    nimble/l2cap: Add helper to clean L2CAP LE CoC channel
    
    With this patch we make sure that when CoC is used, outstanding
    os_mbufs are freed when channel is closing
    
    X-Original-Commit: fbceba584c5cd31f2b1253527023469b0a262162

 nimble/host/src/ble_l2cap.c          |  1 +
 nimble/host/src/ble_l2cap_coc.c      | 12 ++++++++++++
 nimble/host/src/ble_l2cap_coc_priv.h |  2 ++
 3 files changed, 15 insertions(+)

commit b9f20097260d626baa8d4a0085268dfb3e3bd89d
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Feb 12 15:20:50 2017 +0100

    nimble/l2cap: Add handling receiving SDU over L2CAP LE CoC
    
    With this patch nimble can receive full SDU from remote device.
    Once it is done, callback with SDU is called to application.
    
    X-Original-Commit: 98e2cb9d3c8cbb75be0c6462aa09391d8df31cbd

 nimble/host/src/ble_l2cap.c          |   2 +-
 nimble/host/src/ble_l2cap_coc.c      | 136 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap_coc_priv.h |   4 ++
 3 files changed, 141 insertions(+), 1 deletion(-)

commit 455a21e0df197239c6396b85ab870e17b823d547
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Sun Feb 12 15:30:21 2017 +0100

    nimble/l2cap: Add LE credits update handling
    
    This patch add support to send singaling request to update LE creadits
    as well as handle remote device sending us LE credits update.
    
    Note, that this patch introduces also helper function to find channel
    by scid and dcid
    
    X-Original-Commit: 754c4456a022f89135bedc80807c755950d2d201

 nimble/host/src/ble_att.c               |  2 +-
 nimble/host/src/ble_hs_conn.c           | 23 ++++++++++++++-
 nimble/host/src/ble_hs_conn_priv.h      |  4 ++-
 nimble/host/src/ble_hs_misc.c           |  2 +-
 nimble/host/src/ble_l2cap.c             |  2 +-
 nimble/host/src/ble_l2cap_coc.c         | 32 +++++++++++++++++++++
 nimble/host/src/ble_l2cap_coc_priv.h    |  2 ++
 nimble/host/src/ble_l2cap_sig.c         | 50 +++++++++++++++++++++++++++++++--
 nimble/host/src/ble_l2cap_sig_priv.h    |  6 ++++
 nimble/host/test/src/ble_hs_conn_test.c |  6 ++--
 10 files changed, 119 insertions(+), 10 deletions(-)

commit d3001dfec3c772962a4f51a0d9f8b37c1d0d63a1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 2 15:00:25 2017 +0100

    nimble/l2cap: Remove not needed **om from ble_l2cap_rx_fn
    
    Since this callback function has ble_l2cap_chan as a parameter,
    we don't need to provide there os_mbuf with data as this is already
    in chan->rx_buf
    
    X-Original-Commit: 9b3899a0000e5c0425b097a536e98eee800e0c2e

 nimble/host/src/ble_att.c               |  6 +++++-
 nimble/host/src/ble_hs_hci_evt.c        |  7 ++-----
 nimble/host/src/ble_l2cap.c             |  7 +++----
 nimble/host/src/ble_l2cap_coc.c         |  2 +-
 nimble/host/src/ble_l2cap_priv.h        |  3 +--
 nimble/host/src/ble_l2cap_sig.c         |  8 ++++++--
 nimble/host/src/ble_sm.c                | 14 +++++++++-----
 nimble/host/test/src/ble_hs_test_util.c |  7 ++-----
 nimble/host/test/src/ble_l2cap_test.c   |  2 +-
 9 files changed, 30 insertions(+), 26 deletions(-)

commit 271ad91abcee160221944bcf34428136e062e8c3
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 2 14:44:47 2017 +0100

    nimble/l2cap: Make ble_l2cap_chan available in ble_l2cap_rx_fn
    
    Each L2CAP channel has its data handler function. Till now we had
    function per CID. In order to handle COC we need to have possibility
    to handle more channels in same data handler function. For this reason
    we need to have pointer to ble_l2cap_chan to which data are comming.
    
    This patch does it.
    
    X-Original-Commit: 27bc9edf37d344ba67110ee80af148b1861392c6

 nimble/host/include/host/ble_l2cap.h    |  1 +
 nimble/host/src/ble_att.c               | 12 +++++++++---
 nimble/host/src/ble_att_priv.h          |  2 +-
 nimble/host/src/ble_gap.c               |  3 +--
 nimble/host/src/ble_hs_conn.c           |  9 +++++----
 nimble/host/src/ble_hs_conn_priv.h      |  2 +-
 nimble/host/src/ble_hs_hci_evt.c        |  3 ++-
 nimble/host/src/ble_l2cap.c             | 16 +++++++++++++---
 nimble/host/src/ble_l2cap_coc.c         |  5 ++---
 nimble/host/src/ble_l2cap_priv.h        |  7 ++++---
 nimble/host/src/ble_l2cap_sig.c         |  7 ++++---
 nimble/host/src/ble_l2cap_sig_priv.h    |  2 +-
 nimble/host/src/ble_sm.c                | 20 ++++++++++++++++----
 nimble/host/src/ble_sm_priv.h           |  2 +-
 nimble/host/test/src/ble_hs_test_util.c |  3 ++-
 nimble/host/test/src/ble_l2cap_test.c   |  4 ++--
 16 files changed, 65 insertions(+), 33 deletions(-)

commit 956dc4b3448c037169e48ccd744b4f0a187ca1dc
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Feb 28 13:23:41 2017 +0100

    nimble/l2cap: Remove not needed function ble_l2cap_sig_init_cmd
    
    After refactor this function is not needed anymore in the host code.
    The only user of it is unitest and this patch fixes that.
    
    X-Original-Commit: d9f788b49df395538cc2081eabe38161a3165ca7

 nimble/host/src/ble_l2cap_sig_cmd.c     | 34 -------------------------------
 nimble/host/test/src/ble_hs_test_util.c | 22 +++++---------------
 nimble/host/test/src/ble_l2cap_test.c   | 36 ++++++++-------------------------
 3 files changed, 13 insertions(+), 79 deletions(-)

commit 49f19e00738bd06e7d42075624713710c7b03bde
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Feb 28 12:14:46 2017 +0100

    nimble/l2cap: Refactor handling L2CAP reject command
    
    With this patch L2CAP reject command uses a new way of preparing
    command and sending it
    
    X-Original-Commit: ba9de55afb41bf1c1b837ae93041953aa2f59493

 nimble/host/src/ble_l2cap_sig_cmd.c  | 40 +++++++-----------------------------
 nimble/host/src/ble_l2cap_sig_priv.h |  1 +
 2 files changed, 8 insertions(+), 33 deletions(-)

commit 906d035fe322db002387ff8e2444a35e9ab793aa
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 2 11:32:25 2017 +0100

    nimble/l2cap: Fix handling bad data in L2CAP update parameters response
    
    Returning error will cause sending L2CAP REJECT on that response and
    this is incorrect. This patch fixes that.
    
    X-Original-Commit: a4430354b14e932312210adcf6b2830070abb9cd

 nimble/host/src/ble_l2cap_sig.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 166b97617da6cc44666faf1e44ce5270608300a5
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 2 11:27:14 2017 +0100

    nimble/l2cap: Add helper to create L2CAP channel for LE CoC
    
    With this patch, creating L2CAP channel for LE CoC purposes is moved
    to ble_l2cap_coc.c. It is because in that file we want to have
    all the logic related to CoC e.g. credits, available servers, data handling
    
    X-Original-Commit: eb576bc2036d1322cbc1fb216dea8fa0153968d9

 nimble/host/src/ble_l2cap_coc.c      | 57 ++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_l2cap_coc_priv.h | 11 +++++--
 nimble/host/src/ble_l2cap_sig.c      | 43 +++++++--------------------
 3 files changed, 73 insertions(+), 38 deletions(-)

commit 1b222067d06ea5d4a9a1615bc977a1f622ea32a7
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 2 10:21:57 2017 +0100

    nimble/l2cap: Refactor update parameters handling
    
    With this patch l2cap update parameters is handled in similar way as
    other signaling commands.
    
    X-Original-Commit: 98ebb5133ac345d8a9a93b335722e88b68373673

 nimble/host/src/ble_l2cap_sig.c         | 55 ++++++++++++-------
 nimble/host/src/ble_l2cap_sig_cmd.c     | 94 ---------------------------------
 nimble/host/src/ble_l2cap_sig_priv.h    | 17 +-----
 nimble/host/test/src/ble_hs_test_util.c | 42 ++++++++++++++-
 nimble/host/test/src/ble_l2cap_test.c   | 20 ++++++-
 5 files changed, 98 insertions(+), 130 deletions(-)

commit 9d848c9a0b549930a38dc2764a20e780e69a63d9
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Feb 22 17:37:39 2017 +0100

    nimble/l2cap: Fix L2CAP LE CoC disconnection handling
    
    This patch fixes mess around scid/dcid on L2CAP disconnection
    request
    
    X-Original-Commit: 506e3738f7cd4155b5126fa7427536b81613536f

 nimble/host/src/ble_l2cap_sig.c | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

commit 1b3d07070959489aa99d9d9b8e63caef3d2ed1e4
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Feb 22 17:15:35 2017 +0100

    nimble/l2cap: Memset response in L2CAP LE CoC connect request
    
    This is in order to not send trash in case of error response.
    
    X-Original-Commit: ced3e8b2469a914562abbbb3c8711629fd69f846

 nimble/host/src/ble_l2cap_sig.c | 2 ++
 1 file changed, 2 insertions(+)

commit 6198c071924e8581ba276911626691ec1ca9643b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 16 06:31:43 2017 +0100

    nimble/l2cap: Fix handling scid/dcid in the channel.
    
    This patch makes sure that each l2cap channel has corretly
    set scid and dcid. In the same time dcid is use when sending
    data.
    
    X-Original-Commit: 509cd5fb6bffd3cc1e682ae247b28687cbac2354

 nimble/host/src/ble_att.c        | 1 +
 nimble/host/src/ble_l2cap.c      | 2 +-
 nimble/host/src/ble_l2cap_priv.h | 2 +-
 nimble/host/src/ble_l2cap_sig.c  | 1 +
 nimble/host/src/ble_sm.c         | 1 +
 5 files changed, 5 insertions(+), 2 deletions(-)

commit bd50101f4df72f77a9165ed5fb6f5c12b7508ec2
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 2 17:41:40 2017 -0800

    MYNEWT-492 Add missing syscfg setting descriptions
    
    X-Original-Commit: b7c8714b865bfa022fc174ff9adb84f2409de32f

 nimble/host/services/bleuart/syscfg.yml |   4 +-
 nimble/host/syscfg.yml                  | 179 +++++++++++++++++++++++---------
 nimble/syscfg.yml                       |  18 ++--
 3 files changed, 141 insertions(+), 60 deletions(-)

commit 1a1637a6e52f86c9e977773db5854fca4e7c0d95
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 2 17:03:21 2017 -0800

    MYNEWT-492 - Remove unused obsolete settings.
    
    X-Original-Commit: cc8ead34b536f13ed20ab6ea10137550b2262c89

 nimble/host/src/ble_hs.c | 3 ---
 nimble/host/syscfg.yml   | 5 -----
 2 files changed, 8 deletions(-)

commit b65d57655a007d6b09fb477d33dd7ca74dd0f105
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 27 20:31:12 2017 -0800

    MYNEWT-642 Eddystone buf: one byte too large.
    
    X-Original-Commit: 6af94808683a2cf2233fc70415273033e72fd909

 nimble/host/src/ble_eddystone.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 83d0e6899fe42133cc0c2af82a321dd618e6fa56
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 27 20:25:53 2017 -0800

    MYNEWT-642 Eddystone UID format is incorrect
    
    The tx power and reserved bytes were missing.
    
    X-Original-Commit: e6594232f39f717eb5cdeb954a1dc69542b9212e

 nimble/host/src/ble_eddystone.c | 22 +++++++++++++++++++---
 1 file changed, 19 insertions(+), 3 deletions(-)

commit 0ec5e2dc5f7b91f41082bf74942791ad4413ca15
Author: William San Filippo <wills@runtime.io>
Date:   Fri Feb 24 19:54:22 2017 -0800

    MYNEWT-638: Bug when resetting controller while creating connection
    
    This fix should address the issue where the controller was reset
    while attempting to create a connection. It should now be possible
    to create a connection after the reset. The bug was that a
    global variable was not getting cleared which prevented
    acceptance of the conn create command.
    
    X-Original-Commit: c5c9b6e2e3f8aea74efd5ff99f7ed4334166e1c7

 nimble/controller/src/ble_ll_conn.c | 3 +++
 1 file changed, 3 insertions(+)

commit e432d3615dca1262abe764909c31a1b014be9bd5
Merge: 60cf7424 d8acafa1
Author: Vipul Rahane <vipulrahane@apache.org>
Date:   Fri Feb 24 11:37:12 2017 -0800

    Merge branch 'sensors_branch' of https://github.com/vrahane/incubator-mynewt-core into develop
    
    X-Original-Commit: 514797cc3dc3e4aae06198d7300f621a3a04ba76

commit 60cf742443b0b27cd247da5d49936411abdc590b
Merge: 2180c8bd b3911bb9
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Feb 23 19:45:50 2017 -0800

    This closes #182.
    
    Merge remote-tracking branch 'rymanluk/upf56_fixes' into develop
    
    * rymanluk/upf56_fixes:
      nimble/sm: Fix for bonding information storing
      nimble/l2cap: Drop packets bigger than MTU on the channel
    
    X-Original-Commit: b41d25e6f619966bab95bdafdbc21b236bfd8939

commit d8acafa1dd8408f9efa1dcb7aa6cd0baa4830c99
Merge: bafb7d1d 2180c8bd
Author: Vipul Rahane <vipulrahane@apache.org>
Date:   Thu Feb 23 13:13:29 2017 -0800

    Merge branch 'develop' of https://git-wip-us.apache.org/repos/asf/incubator-mynewt-core into sensors_branch
    
    X-Original-Commit: d21ef0fdd1215c2cd52871d0b5d5d11be3de1682

commit b3911bb9fc65b5be6afb7f0c3dccc620e1899952
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Feb 15 01:19:17 2017 +0100

    nimble/sm: Fix for bonding information storing
    
    Consider following scenario:
    Devices are bonded with unathenticated link key and after that
    they decide to increase security. In this case old link keys
    are not deleted.
    That leads to situation that authenticated keys where never used
    for encription but instead re-bonding was performed for following
    encryption attempts. It was happening because each time SM checks
    for keys in the storage, it found unauthenticated keys in first place
    which did not match security level.
    This patch fixes that.
    
    X-Original-Commit: 71fdd5db184f56ca945cd352f922ce626b143a88

 nimble/host/src/ble_sm.c | 3 +++
 1 file changed, 3 insertions(+)

commit 70b94cc2886f8d921051172158a3d325f600b45f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Thu Feb 23 00:22:56 2017 +0100

    nimble/l2cap: Drop packets bigger than MTU on the channel
    
    X-Original-Commit: 673169f527a2bde1fecbbaf848800f4546af2d38

 nimble/host/src/ble_l2cap.c               | 21 +++++++++++++++++++++
 nimble/host/test/src/ble_gatt_read_test.c |  3 +++
 nimble/host/test/src/ble_hs_test_util.c   | 18 ++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.h   |  1 +
 nimble/host/test/src/ble_l2cap_test.c     |  6 ++++--
 5 files changed, 47 insertions(+), 2 deletions(-)

commit 2180c8bd0760297fbf1f6037b8a1c4181e79e7da
Author: William San Filippo <wills@runtime.io>
Date:   Wed Feb 22 09:36:20 2017 -0800

    MYNEWT-629: Unexpected advertising state machine stop.
    
    This commit should fix the bug where an advertising state machine that
    was not expected to be stopped could be stopped when a different
    state machine was stopped through the hci advertising enable command.
    
    This change does affect both MULTI_ADV_SUPPORT and normal builds.
    
    X-Original-Commit: 1449ffcdbac75131f98f933036696427bbc3b57a

 nimble/controller/src/ble_ll_adv.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 24295dbb69e33932018724d51435775955c413da
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Feb 21 09:19:13 2017 -0800

    BLE Host - Remove extraneous indentation.
    
    X-Original-Commit: a42c0c10952f3319e1f8834f863f956de2e8a487

 nimble/host/src/ble_gap.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 8259f8a60b424ff678e2ea7011d1ebdd9ec14159
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Feb 21 13:49:26 2017 +0100

    nimble/gap-test: Add unit tests
    
    This patch adds couple of unit test which verifies connection update
    parameters
    
    X-Original-Commit: 866ef31456c9aa623357dfe39189cdc2f019197b

 nimble/host/test/src/ble_gap_test.c | 85 +++++++++++++++++++++++++++++++++++++
 1 file changed, 85 insertions(+)

commit 25a5c49a796b65fce2fca2a360809b1284207338
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Feb 14 05:58:42 2017 +0100

    nimble/gap: Fix validation of conn parameters
    
    This fix obvious incorrect check for parameter validation.
    
    Note, with this patch we finaly start check for requirements on
    supervision timeout, that's why test script update was needed.
    
    X-Original-Commit: a246f526267bc81199e57a22535b5d3f0173a660

 nimble/host/src/ble_gap.c             |  2 +-
 nimble/host/test/src/ble_gap_test.c   | 52 +++++++++++++++++------------------
 nimble/host/test/src/ble_l2cap_test.c |  4 +--
 3 files changed, 29 insertions(+), 29 deletions(-)

commit 2cf951db0f4bdb8b49be96ed0c4afd3279d4322b
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Feb 16 13:25:13 2017 -0800

    BLE Host - Minor formatting change.
    
    X-Original-Commit: cfc231441a7d7cf94ba96efc58913b1c510d4c9a

 nimble/host/src/ble_eddystone.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit daa18058676f4f63ed97c85332e68391564c3563
Author: William San Filippo <wills@runtime.io>
Date:   Wed Feb 15 11:37:04 2017 -0800

    MYNEWT-492: Update TBD in syscfg files.
    
    X-Original-Commit: 745d6279d482aae185d60fd151b88147a596bfb1

 nimble/controller/syscfg.yml     | 35 ++++++++++++++++++++++++-----------
 nimble/transport/uart/syscfg.yml | 18 +++++++++---------
 2 files changed, 33 insertions(+), 20 deletions(-)

commit 691c60bd5355b3b62afc96c1da8573709a9dd19e
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Feb 14 12:30:26 2017 -0800

    MYNEWT-627 BLE Host - Join rx frags into 1 mbuf
    
    X-Original-Commit: 408caf5c0f7fd5e77846ede3df37954fa7a859ad

 nimble/host/src/ble_l2cap.c | 26 +++++++++++++++++++++++++-
 nimble/host/syscfg.yml      |  7 +++++++
 2 files changed, 32 insertions(+), 1 deletion(-)

commit 58da2ccaf5c754259d7064595edaaa0fcc8a0511
Merge: e6f5c8d1 6f64a255
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 13 11:33:37 2017 -0800

    This closes #174.
    
    Merge remote-tracking branch 'andrzej-kaczmarek/nimble/cleanup' into develop
    
    * andrzej-kaczmarek/nimble/cleanup:
      apps/blesplit: Fix build after ble_uuid and ble_addr changes
      nimble: Cleanup address types usage
    
    X-Original-Commit: 57a5bb60278ecf84b991042057561111750b2fcf

commit e6f5c8d1e67843f79715c9923ec688a23df08d6d
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 13 11:25:04 2017 -0800

    BLE Host - Update for CoC field name change.
    
    X-Original-Commit: 8b510e973cec21c776fdd2ab4801793a2339dd09

 nimble/host/src/ble_l2cap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c15f6dbf72982fc263b02461cd7d938ed88acee8
Merge: 76085d9b 7e10c06e
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Feb 13 11:23:27 2017 -0800

    This closes #171.
    
    Merge remote-tracking branch 'rymanluk/l2cap_coc_sig' into develop
    
    * rymanluk/l2cap_coc_sig:
      bletiny: Add support to connect/disconnect L2CAP LE COC
      nimble/l2cap: Add support to disconnect L2CAP LE COC
      nimble/l2cap: Add support to connect L2CAP LE COC
      nimble/l2cap: Add LE L2CAP COC API
      nimble/l2cap: Move ble_l2cap_chan_mtu() to ble_att
      nimble/l2cap: Remove prefix blc_ and blh_ from L2CAP structs
      nimble/l2cap: Remove not needed checks
      kernel/queue: Fix SLIST_REMOVE macro
    
    X-Original-Commit: 0727c55dcfb6a7718b38bcfec4068f652ca314fa

commit 76085d9b144ef4a38358b77abdb81b594de5c5c9
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Feb 11 12:06:53 2017 -0800

    BLE host - add chr-read app err to unit tests.
    
    X-Original-Commit: d61c6cd08b054e1ea8b829a0b74aa6ce2688357a

 nimble/host/test/src/ble_att_svr_test.c | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)

commit 6f53861158a5ca8d579d029cb6167a15a44b02c8
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Feb 11 12:05:08 2017 -0800

    MYNEWT-579 Free rxed l2cap frags on disconnect.
    
    This may not a different mbuf leak, but it was discovered while
    debugging this issue.
    
    X-Original-Commit: 206d7fdb9ab7751ebfc276fc551767949e9a2eab

 nimble/host/src/ble_l2cap.c           | 2 ++
 nimble/host/test/src/ble_l2cap_test.c | 5 +++++
 2 files changed, 7 insertions(+)

commit 2d4ff1c4ed60c05cc7d09fc759d76f8ac516a944
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Feb 8 18:51:38 2017 -0800

    MYNEWT-534 Pkgs set dflt eventq in init function.
    
    X-Original-Commit: 5c8e04f162d5afc250c16274ed6c2e8943718fd5

 nimble/host/src/ble_hs.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 4f30b4c69a5ee956452f5daa11be98a930b67290
Merge: 157ecf02 a51ffc6c
Author: Marko Kiiskila <marko@runtime.io>
Date:   Wed Feb 8 13:45:02 2017 -0800

    Merge branch '1_0_0_b2_dev' of https://git-wip-us.apache.org/repos/asf/incubator-mynewt-core into develop
    
    X-Original-Commit: 4719b3f503e70e0da59a724aff08b1992b2a0781

commit 6f64a25571337818ec4be4f3d4fc8460d81509db
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Feb 3 13:21:24 2017 +0100

    nimble: Cleanup address types usage
    
    The symbols and variable names should be used properly for own_address
    and peer_address everywhere (even though they have the same values) to
    make code easier to follow.
    
    X-Original-Commit: 0a79ee07cfe7961cbfb99fa3ea14c9733e95e538

 nimble/host/src/ble_hs_id.c             |  8 ++++----
 nimble/host/src/ble_hs_misc.c           | 12 ++++++------
 nimble/host/test/src/ble_gap_test.c     | 24 ++++++++++++------------
 nimble/host/test/src/ble_hs_test_util.c |  2 +-
 nimble/host/test/src/ble_os_test.c      |  2 +-
 nimble/host/test/src/ble_sm_lgcy_test.c | 24 ++++++++++++------------
 nimble/host/test/src/ble_sm_sc_test.c   | 24 ++++++++++++------------
 7 files changed, 48 insertions(+), 48 deletions(-)

commit 157ecf02e176fc7d68fd7537d8fa4fe1edc11d22
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Feb 2 19:58:31 2017 -0800

    MYNEWT-617 BLE Host - UUID-string conv missing '-'
    
    X-Original-Commit: f4a9711f5ee922da0b90dd5a77f52ad9716d3c16

 nimble/host/src/ble_uuid.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit a51ffc6c51b5e0d6dcc34ec824301e62004b141e
Author: Marko Kiiskila <marko@runtime.io>
Date:   Thu Feb 2 14:43:55 2017 -0800

    nimble/controller; silence compile warning about uninitialized
    variable.
    
    X-Original-Commit: 196cf7d4b6160a6b675a5e579128a8ce7413d84e

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7e10c06e83a1c2e940987b583653a144a2713699
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 31 01:28:20 2017 +0100

    bletiny: Add support to connect/disconnect L2CAP LE COC
    
    With this patch bletiny gets support to test LE COC.
    In order to do this, new options to 'b l2cap' command has been added:
    * create_srv psm=<psm>
    * connect conn=<conn_handle> psm=<psm>
    * disconnect idx=<idx>
    
    In order to get 'idx' required to disconnect you should call
    
    "b show coc"
    
    X-Original-Commit: 8b73a4d81480d6753ff019cd26f89ef606b0b247

 nimble/host/src/ble_l2cap_sig.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 72aebbd4de096d6d8336dcd47d473d03fe30d18b
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 31 01:13:09 2017 +0100

    nimble/l2cap: Add support to disconnect L2CAP LE COC
    
    With this patch nibmle is able to initiate LE COC disconnect
    and handle incoming disconnection request
    
    X-Original-Commit: 2082dc6919f461e05cdf23b5e27e95adc01792ca

 nimble/host/src/ble_hs_conn_priv.h   |   3 +
 nimble/host/src/ble_l2cap.c          |   3 +-
 nimble/host/src/ble_l2cap_sig.c      | 192 ++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_l2cap_sig_priv.h |  13 +++
 4 files changed, 207 insertions(+), 4 deletions(-)

commit a37888248faa6114e653564a4489485c0cbb7a07
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 31 00:08:13 2017 +0100

    nimble/l2cap: Add support to connect L2CAP LE COC
    
    With this patch nibmle is support to create L2CAP LE COC
    and handle incoming connection request.
    
    Note: New error codes (BLE_HS_EFOO) has been added in
    order to translate L2CAP COC error codes to user
    
    X-Original-Commit: 696e79d3455d4141b6a17e649219140db9f7e66f

 nimble/host/include/host/ble_hs.h    |   4 +
 nimble/host/src/ble_hs_priv.h        |   1 +
 nimble/host/src/ble_l2cap.c          |  15 +-
 nimble/host/src/ble_l2cap_coc.c      | 131 +++++++++++++
 nimble/host/src/ble_l2cap_coc_priv.h |  68 +++++++
 nimble/host/src/ble_l2cap_priv.h     |   9 +-
 nimble/host/src/ble_l2cap_sig.c      | 365 ++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_l2cap_sig_cmd.c  |  29 ++-
 nimble/host/src/ble_l2cap_sig_priv.h |  31 ++-
 9 files changed, 633 insertions(+), 20 deletions(-)

commit e9e6b3230d83451d15e89c158060924c18bfa759
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 17 14:13:24 2017 +0100

    nimble/l2cap: Add LE L2CAP COC API
    
    This patch adds API for LE Connection Oriented Channels.
    Note that implementation is hided behind BLE_L2CAP_COC_MAX_NUM flag
    which defines maximum number of supported dynamic channels
    
    Overview:
    Idea is that credits are hidden from the user and controlled by the
    stack. User creates its own memory pool for SDU taking into account
    SDU size and number of L2CAP LE COC channels he expect to use.
    User profiles SDU (os_mbuf) to the stack when creates or accepts
    connection.
    
    Flow overview.
    
    Similar to GAP, L2CAP defines following events:
    
    BLE_L2CAP_EVENT_COC_CONNECTED
    BLE_L2CAP_EVENT_COC_DISCONNECT
    BLE_L2CAP_EVENT_COC_ACCEPT
    BLE_L2CAP_EVENT_COC_DATA_RECEIVED
    
    which application should handle in ble_l2cap_event_fn() called cb in
     description below.
    
    Outgoing connection:
    1. *chan = ble_l2cap_connect(conn_handle, psm, mtu, struct os_mbuf *sdu_rx,
                                 *cb, *cb_arg);
    
    2. BLE_L2CAP_EVENT_COC_CONNECTED event is sent when channel has been
     established or rejected. If connection has been rejected, event contains
     reason for that.
    
    3. BLE_L2CAP_EVENT_COC_DATA_RECEIVED event is sent  on incoming data.
     Note, it is sent when SDU is completed
    3a. User needs to call ble_l2cap_recv_ready(*chan, sdu_rx) where
     sdu_rx is os_mbuf for next SDU.
    
    4. To send data do remote device ble_l2cap_send(*chan, sdu_tx) shall
     be called
    
    5. To drop channel ble_l2cap_disconnect(*chan) shall be called.
    6. When disconnected BLE_L2CAP_EVENT_COC_DISCONNECTD event is sent
    
    Incoming connection:
    1. ble_l2cap_create_server(psm, mtu, *cb, *cb_arg)
    2. BLE_L2CAP_COC_EVENT_ACCEPT event is sent on create connection request
     if there is server for given PSM in the stack.
    2a. User might want to check required security and MTU requirements
     before accepts connection.
    2b. User needs to call ble_l2cap_recv_ready(*chan, sdu_rx) where
     sdu_rx is os_mbuf for next SDU.
    2c. If accept_cb returns 0, connection response is sent
    2d. User gets BLE_L2CAP_EVENT_COC_CONNECTED event with a status
    
    X-Original-Commit: 1afc08a637e0c9b94e78387ef4fe3aeffb1a37f1

 nimble/host/include/host/ble_l2cap.h | 114 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap.c          |  47 ++++++++++++++-
 nimble/host/src/ble_l2cap_priv.h     |  18 ++++++
 nimble/host/syscfg.yml               |   5 ++
 4 files changed, 181 insertions(+), 3 deletions(-)

commit e9e029d164071f38a93eaf5bc7ccef9200464d41
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 20 13:06:13 2017 +0100

    nimble/l2cap: Move ble_l2cap_chan_mtu() to ble_att
    
    MTU Exchange procedure belongs to ATT. Also concept of default MTU
    belongs to ATT. This patch removes default_mtu from ble_l2cap_chan and
    moves function choosing MTU for ATT channel to ble_att
    
    X-Original-Commit: 552adce6ed25a46eb40266342c719da478c89a6f

 nimble/host/src/ble_att.c               | 26 +++++++++++++++++++++++---
 nimble/host/src/ble_att_clt.c           |  2 +-
 nimble/host/src/ble_att_priv.h          |  1 +
 nimble/host/src/ble_att_svr.c           |  2 +-
 nimble/host/src/ble_l2cap.c             | 21 +++------------------
 nimble/host/src/ble_l2cap_priv.h        |  4 +---
 nimble/host/src/ble_l2cap_sig.c         |  1 -
 nimble/host/src/ble_sm.c                |  1 -
 nimble/host/test/src/ble_att_svr_test.c |  4 ++--
 nimble/host/test/src/ble_hs_conn_test.c |  3 ---
 nimble/host/test/src/ble_l2cap_test.c   |  1 -
 11 files changed, 32 insertions(+), 34 deletions(-)

commit 3d89ff1ff6603d6e5bd693c33ef72b18f06b4f12
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Fri Jan 20 12:39:00 2017 +0100

    nimble/l2cap: Remove prefix blc_ and blh_ from L2CAP structs
    
    Remove blc_ and blh_ prefix as it does not really gives us any value.
    With this patch we make struct fields names shorter.
    
    X-Original-Commit: 1c66c7902827ce2830fc1db21dfc0648f1e9ff68

 nimble/host/src/ble_att.c               | 14 ++++-----
 nimble/host/src/ble_att_clt.c           |  4 +--
 nimble/host/src/ble_att_svr.c           |  4 +--
 nimble/host/src/ble_gattc.c             |  2 +-
 nimble/host/src/ble_hs_conn.c           | 20 ++++++-------
 nimble/host/src/ble_l2cap.c             | 52 ++++++++++++++++-----------------
 nimble/host/src/ble_l2cap_priv.h        | 22 +++++++-------
 nimble/host/src/ble_l2cap_sig.c         |  8 ++---
 nimble/host/src/ble_sm.c                |  8 ++---
 nimble/host/test/src/ble_att_svr_test.c | 10 +++----
 nimble/host/test/src/ble_hs_conn_test.c | 18 ++++++------
 nimble/host/test/src/ble_hs_test_util.c |  6 ++--
 nimble/host/test/src/ble_l2cap_test.c   | 16 +++++-----
 13 files changed, 92 insertions(+), 92 deletions(-)

commit 01f1a2d7ff0bba3eaf3d29199c833cf8a777fa5f
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Jan 17 15:37:30 2017 +0100

    nimble/l2cap: Remove not needed checks
    
    Minor change removing not needed check for return code.
    
    X-Original-Commit: e9bb23e6176a55bd4897f6b8bd2213c87a04f0d6

 nimble/host/src/ble_l2cap_sig_cmd.c | 26 ++++----------------------
 1 file changed, 4 insertions(+), 22 deletions(-)

commit 339b519932e113de6b0041b972ce1324c2cafd1e
Author: William San Filippo <wills@runtime.io>
Date:   Wed Feb 1 14:50:52 2017 -0800

    nimble/host: Add generic BD address type
    
    Just a few minor fixes as the BLE_ADDR_TYPE_xxx macros were renamed BLE_ADDR_xxx
    but not updated in all files.
    
    X-Original-Commit: e9ff7acba2fa7877b45ca9c71fb0f9c53ab21b2e

 nimble/drivers/nrf51/src/ble_hw.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 423c67be4239d228cd91572b93dd6e159faa17a0
Author: William San Filippo <wills@runtime.io>
Date:   Wed Feb 1 14:50:52 2017 -0800

    nimble/host: Add generic BD address type
    
    Just a few minor fixes as the BLE_ADDR_TYPE_xxx macros were renamed BLE_ADDR_xxx
    but not updated in all files.
    
    X-Original-Commit: 6f99c8cc14f41a4381ebf5fcb035f6ac66e94c8e

 nimble/drivers/nrf51/src/ble_hw.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 87cfb974612b53b875f116393a1ef4b9079c8876
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Feb 1 14:12:06 2017 -0800

    BLE Host - Remove dead code.
    
    X-Original-Commit: ad4050f3639b90a4c9303b301bae413a4cd8e135

 nimble/host/include/host/ble_store.h | 2 --
 1 file changed, 2 deletions(-)

commit 66e2733ef8a4b5eb60057e8d5861e80d31ad69e8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Feb 1 14:09:50 2017 -0800

    BLE Host - Fix crash in unit test
    
    X-Original-Commit: 5a0f8021ad8082b542baf6945cb5322c5fcf1a4e

 nimble/host/src/ble_sm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 960ee9caa61a83a1fae1f1bea909521ff808a290
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Feb 1 17:14:51 2017 +0100

    nimble/sm: Update peer's identity after pairing
    
    After pairing, when Identity Address Information is received, we update
    peer's identity in conn and dispatch this information using new event
    so application knows that we now know peer's identity address and not
    only RPA.
    
    X-Original-Commit: f52185c2494d2945b6814fb4692c0ade229ae9aa

 nimble/host/include/host/ble_gap.h | 13 +++++++++++++
 nimble/host/src/ble_gap.c          | 17 +++++++++++++++++
 nimble/host/src/ble_gap_priv.h     |  1 +
 nimble/host/src/ble_sm.c           | 31 +++++++++++++++++++++++++++++++
 4 files changed, 62 insertions(+)

commit 35c71a4dcd2ad859e66746088042c50b8a0add39
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 31 15:04:18 2017 +0100

    nimble/host: Add generic type for BD address
    
    This patch introduces ble_addr_t (with additional helpers/symbols) type
    to pass complete device address via API instead of separate type and
    address value.
    
    Note that it only makes sure public APIs use new type. Both apps and
    host internals may still use type/addr combination in many places, but
    this can be changed later without affecting backwards compatibility.
    
    X-Original-Commit: 6d0e7fb8aef7f767949b767478c88df0ce0f7cdb

 nimble/controller/src/ble_ll_adv.c           |   8 +-
 nimble/controller/src/ble_ll_scan.c          |   4 +-
 nimble/drivers/nrf52/src/ble_hw.c            |   4 +-
 nimble/host/include/host/ble_gap.h           |  40 +---
 nimble/host/include/host/ble_hs_id.h         |   3 +-
 nimble/host/include/host/ble_store.h         |  23 +-
 nimble/host/src/ble_att_svr.c                |   3 +-
 nimble/host/src/ble_gap.c                    | 184 ++++++---------
 nimble/host/src/ble_gatts.c                  |  16 +-
 nimble/host/src/ble_hs_conn.c                |  39 ++--
 nimble/host/src/ble_hs_conn_priv.h           |  22 +-
 nimble/host/src/ble_hs_hci_cmd.c             |  10 +-
 nimble/host/src/ble_hs_hci_evt.c             |  16 +-
 nimble/host/src/ble_hs_id.c                  |  30 +--
 nimble/host/src/ble_hs_misc.c                |  14 +-
 nimble/host/src/ble_sm.c                     |  54 +++--
 nimble/host/src/ble_sm_sc.c                  |  45 ++--
 nimble/host/src/ble_store.c                  |  31 ++-
 nimble/host/store/ram/src/ble_store_ram.c    |  23 +-
 nimble/host/test/src/ble_gap_test.c          | 326 +++++++++++++--------------
 nimble/host/test/src/ble_gatts_notify_test.c |   2 +-
 nimble/host/test/src/ble_hs_adv_test.c       |   4 +-
 nimble/host/test/src/ble_hs_conn_test.c      |  32 ++-
 nimble/host/test/src/ble_hs_test_util.c      |  58 ++---
 nimble/host/test/src/ble_hs_test_util.h      |   9 +-
 nimble/host/test/src/ble_os_test.c           |  29 ++-
 nimble/host/test/src/ble_sm_lgcy_test.c      |   4 +-
 nimble/host/test/src/ble_sm_sc_test.c        |  24 +-
 nimble/host/test/src/ble_sm_test_util.c      |  12 +-
 nimble/include/nimble/ble.h                  |  40 +++-
 30 files changed, 510 insertions(+), 599 deletions(-)

commit 844550400bfecbe2c1d490fb46299a69c352711e
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Feb 1 16:23:49 2017 +0100

    nimble/sm: Use proper address types for confirm
    
    We should always use OTA address types for calculating confirm value.
    Also if our OTA is an RPA, then always assume address type as random,
    not address type that was used to start connection since this is
    different kind of type (incompatible with actual address type).
    
    Without this fix, pairing fails if privacy is used (e.g. we use RPA).
    
    Note:
    SM SC test cases were disabled with this fix since test vectors needs
    to be recalculated due to input data (address type) changed.
    
    X-Original-Commit: 0b59cb3c1a60ead6a4aee6c113cf388ce337a248

 nimble/host/src/ble_hs_conn.c         | 2 +-
 nimble/host/src/ble_sm.c              | 8 ++++----
 nimble/host/src/ble_sm_sc.c           | 4 ++--
 nimble/host/test/src/ble_gap_test.c   | 2 +-
 nimble/host/test/src/ble_sm_sc_test.c | 4 +++-
 5 files changed, 11 insertions(+), 9 deletions(-)

commit 5bbb7a12c1f87e5496dce296fdc552fe5caab7ed
Merge: 73ef0299 b0008ee3
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Feb 1 11:15:32 2017 -0800

    This closes #172.
    
    Merge remote-tracking branch 'rymanluk/fixes' into develop
    
    * rymanluk/fixes:
      nimble/ll: Fix for compiler warning
      nordic/i2c: Fix for compiler warning
    
    X-Original-Commit: 5b09171d2413aaeaaa719641fca3818006086fcf

commit b0008ee3654ff719bbe50cb75d2d4c49ab93564a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Wed Feb 1 15:25:50 2017 +0100

    nimble/ll: Fix for compiler warning
    
    This patch solves issue which is visible when building with -Og option.
    ble_ll_conn.c:2365:18: error: 'init_addr' may be used uninitialized in this function [-Werror=maybe-uninitialized]
    
    X-Original-Commit: ed8564d9b0a91bd1ae0fa3157f3df274eaf2bf78

 nimble/controller/src/ble_ll_conn.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 73ef029935376f1aba6b20400d6a9b419eeaa5ac
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 30 17:03:15 2017 +0100

    nimble/gatts: Fix use of uninitialized variable
    
    new_notification was set to 1 only on complete iteration of loop. If
    ble_hs_conn_find_by_idx would return NULL on first iteration it would
    be used uninitialized
    
    X-Original-Commit: 3f1ea82ac4ef1043f595ccc7ded14d57279efa62

 nimble/host/src/ble_gatts.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bb977042e5c2249eb7a848558e32f328d5efa821
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 30 16:43:37 2017 +0100

    nimble/hci: Fix passing uninitialized data
    
    In ble_hs_hci_evt_le_dir_adv_rpt function desc.length_data was passed
    uninitialized to ble_gap_rx_adv_report. While it shouldn't be access
    if desc.data is NULL it is better to just initialize it to 0.
    
    X-Original-Commit: 4e7d583466b6bd3917e984eb47d8b06f2e20c353

 nimble/host/src/ble_hs_hci_evt.c | 1 +
 1 file changed, 1 insertion(+)

commit cec87c62e28f9420704f4f2873ec5f1695580328
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 30 16:33:47 2017 +0100

    nimble/l2cap: Fix possible NULL pointer dereference
    
    os_mbuf_free expects valid pointer which could result in dereferencing
    NULL pointer if ble_hs_mbuf_l2cap_pkt failed.
    
    X-Original-Commit: 1c49145107cc8d320977f0ed7a155a2edd7ab5db

 nimble/host/src/ble_l2cap_sig_cmd.c | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit 70180970af8173594e475387edb442b615d96721
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 30 16:06:06 2017 +0100

    nimble/sm: Fix out of bound access with logs enabled
    
    TK is 16 bytes long.
    
    X-Original-Commit: 98f2a20120ebd397f6e1cf14a16ec35e65936fe0

 nimble/host/src/ble_sm_sc.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit df39c454fd2f30d5b9312665c8e6660827c7bfa7
Merge: cb5e8ac3 5a90ac07
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jan 27 10:45:52 2017 -0800

    This closes #169.
    
    Merge remote-tracking branch 'andrzej-kaczmarek/nimble/adv' into develop
    
    * andrzej-kaczmarek/nimble/adv:
      nimble/adv: Use ble_uuid types in ble_hs_adv_fields
      nimble/gap: Use raw data only in ble_gap_disc_desc struct
      nimble/adv: Remove invalid data types
    
    X-Original-Commit: 2551b3c0bcb9ee1b552b9b0f5f6f563949341d8a

commit cb5e8ac3a1119abcee5278843be253fae0e51bfc
Merge: 462bc677 f598ff7d
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jan 27 10:44:18 2017 -0800

    This closes #166.
    
    Merge remote-tracking branch 'sjanc/sm' into develop
    
    * sjanc/sm:
      nimble/sm: Make ble_sm_build_authreq static
      nimble/sm: Move PDU parsing functions to tests
      nimble/sm: Remove op parameter from ble_sm_rx_fn
      nimble/sm: Remove unused functions
      nimble/sm: Use packed structures for dhkey check
      nimble/sm: Use packed structures for pub key
      nimble/sm: Use packed structures for sec req
      nimble/sm: Use packed structures for sign info
      nimble/sm: Use packed structures for id addr info
      nimble/sm: Use packed structures for id info
      nimble/sm: Use packed structures for master id
      nimble/sm: Use packed structures for encrypt info
      nimble/sm: Use packed structures for pairing failed
      nimble/sm: Use packed structures for random
      nimble/sm: Use packed structures for confirm
      nimble/sm: Use packed structures for pairing req and rsp
      nimble/sm: Remove useless function declaration
    
    X-Original-Commit: 5728339c97e76693d9278e902ffdcf809b57df5e

commit 5a90ac0731730b900273320ba979805e18fb0544
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 27 13:26:11 2017 +0100

    nimble/adv: Use ble_uuid types in ble_hs_adv_fields
    
    X-Original-Commit: ef6808ab5ed765ff2e3f35d5a60901c81a03fe42

 nimble/host/include/host/ble_hs_adv.h  |   7 +-
 nimble/host/src/ble_eddystone.c        |   6 +-
 nimble/host/src/ble_hs_adv.c           | 129 ++++++++++++++++++++++++++-------
 nimble/host/test/src/ble_hs_adv_test.c |  66 ++++++++++++-----
 4 files changed, 156 insertions(+), 52 deletions(-)

commit e88aef776d5cb1069c1b9597672797596ef870f1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Thu Jan 26 17:19:11 2017 +0100

    nimble/gap: Use raw data only in ble_gap_disc_desc struct
    
    The main API to set adv data now accepts raw buffers with helper func
    to create data from ble_hs_adv_fields.
    
    This patch does the same for the data that host sends as an even to
    application, i.e. ble_gap_disc_desc contains only raw buffer and there
    are helpers to parse them into ble_hs_adv_fields struct or iterate
    using a callback.
    
    X-Original-Commit: 1fe117a67d65cb8e827f39048ce549d2e983776c

 nimble/host/include/host/ble_gap.h    |  4 +--
 nimble/host/include/host/ble_hs_adv.h | 15 ++++++++
 nimble/host/src/ble_gap.c             | 20 +++++------
 nimble/host/src/ble_hs_adv.c          | 67 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_adv_priv.h     |  4 +--
 nimble/host/src/ble_hs_hci_evt.c      |  1 -
 nimble/host/test/src/ble_gap_test.c   |  2 +-
 7 files changed, 94 insertions(+), 19 deletions(-)

commit b6c0a951fb68dca21e926075cfde75f355aaf836
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 17 14:59:12 2017 +0100

    nimble/adv: Remove invalid data types
    
    "Class of Device", "LE Bluetooth Device Address" and "LE Role" data
    types are only applicable for OOB data blocks, as defined by Core
    Specification Supplement 7.
    
    Other symbols removed were not used in AD, but there is also no point
    in having them defined as BLE_HS_ADV_TYPE_* if they cannot be used.
    
    X-Original-Commit: c5b5588bd32b92785d45c622f643c7c7f74a50d0

 nimble/host/include/host/ble_hs_adv.h  |  34 -------
 nimble/host/src/ble_hs_adv.c           |  54 -----------
 nimble/host/test/src/ble_hs_adv_test.c | 164 ---------------------------------
 3 files changed, 252 deletions(-)

commit 462bc677df997f3ce7ea2c80a535d51f6d1e3556
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jan 25 19:05:08 2017 -0800

    MYNEWT-564 BLE Host - Allow byte buf for adv data
    
    X-Original-Commit: 0fc206fb9d22dd7eb706b4ef0daeaf7f6823c494

 nimble/host/include/host/ble_gap.h      |   4 +-
 nimble/host/include/host/ble_hs_adv.h   |   8 +-
 nimble/host/src/ble_gap.c               | 249 ++++++----------
 nimble/host/src/ble_gap_priv.h          |   8 +-
 nimble/host/src/ble_hs_adv.c            |  18 +-
 nimble/host/src/ble_hs_adv_priv.h       |   2 -
 nimble/host/test/src/ble_gap_test.c     |  55 ++--
 nimble/host/test/src/ble_hs_adv_test.c  | 484 ++++++++++++++------------------
 nimble/host/test/src/ble_hs_conn_test.c |   2 +-
 nimble/host/test/src/ble_hs_test_util.c |  83 ++++--
 nimble/host/test/src/ble_hs_test_util.h |   7 +-
 11 files changed, 406 insertions(+), 514 deletions(-)

commit f598ff7d32f630cd4a718c2a0d72f84ac223d489
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 25 15:40:43 2017 +0100

    nimble/sm: Make ble_sm_build_authreq static
    
    This is used only inside ble_sm.c so make it static to give compiler
    option to inline it.
    
    X-Original-Commit: 0189dab05c02ddcfa3287d949083470ca235e238

 nimble/host/src/ble_sm.c      | 2 +-
 nimble/host/src/ble_sm_priv.h | 2 --
 2 files changed, 1 insertion(+), 3 deletions(-)

commit 254bb435b952b5beef9d5613146b3ff15b9b7d81
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 25 15:13:14 2017 +0100

    nimble/sm: Move PDU parsing functions to tests
    
    Those are now only used by tests to verify PDUs formats.
    
    X-Original-Commit: a7ddc25c2c4f5787d90f62f9e9b1d2c4d431c3c2

 nimble/host/src/ble_sm_cmd.c            | 294 --------------------------------
 nimble/host/src/ble_sm_priv.h           |  44 -----
 nimble/host/test/src/ble_sm_test_util.c | 289 +++++++++++++++++++++++++++++++
 3 files changed, 289 insertions(+), 338 deletions(-)

commit 140d09897e9b682545a7e4c5807d2aa981cd7f79
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 18 10:41:36 2017 +0100

    nimble/sm: Remove op parameter from ble_sm_rx_fn
    
    Each callback handles single PDU type so opcode is never used.
    
    X-Original-Commit: a8fb9ff80acc0a03402b3f6372f0165dcd4a670f

 nimble/host/src/ble_sm.c      | 30 +++++++++++++++---------------
 nimble/host/src/ble_sm_priv.h |  7 +++----
 nimble/host/src/ble_sm_sc.c   |  4 ++--
 3 files changed, 20 insertions(+), 21 deletions(-)

commit 0833fb859ca33f87476c3220310f1aace62f858a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:43 2017 +0100

    nimble/sm: Remove unused functions
    
    X-Original-Commit: 4bdaa471bc75bfdc3cc23466f218fb00145ba59c

 nimble/host/src/ble_sm_cmd.c  | 311 ------------------------------------------
 nimble/host/src/ble_sm_priv.h |  17 ---
 2 files changed, 328 deletions(-)

commit 5eb25a419eca640dae2d0897c2b4655572f85c6b
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:42 2017 +0100

    nimble/sm: Use packed structures for dhkey check
    
    X-Original-Commit: bd23aef107a64dd3d2b46afd0753110129cd4f7d

 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/src/ble_sm_sc.c             | 25 ++++++++++++++++---------
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 4 files changed, 22 insertions(+), 16 deletions(-)

commit d34450d8b16c53493a7b89d5ad20b8b0656d50d9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:41 2017 +0100

    nimble/sm: Use packed structures for pub key
    
    X-Original-Commit: 6ab4a7140744a9259502efec84076419e9698695

 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/src/ble_sm_sc.c             | 28 +++++++++++++++++++---------
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 4 files changed, 25 insertions(+), 16 deletions(-)

commit c42e8d4f1de43a7e756aa84eb44ccf5e7f65f83a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:40 2017 +0100

    nimble/sm: Use packed structures for sec req
    
    X-Original-Commit: 34e5a4b24e5d8af23ee4cdab48692f585a03f4bc

 nimble/host/src/ble_sm.c                | 25 ++++++++++++++++---------
 nimble/host/src/ble_sm_cmd.c            |  6 +++---
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 4 files changed, 23 insertions(+), 17 deletions(-)

commit 7f89dc7b8358489874730679157fc774fdafc5d8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:39 2017 +0100

    nimble/sm: Use packed structures for sign info
    
    X-Original-Commit: 14d869c43b821a4459667c29e1baa4fa776e9a05

 nimble/host/src/ble_sm.c                | 30 ++++++++++++++++++++----------
 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 4 files changed, 26 insertions(+), 17 deletions(-)

commit 4c871ab131c6044d41ec7c67b6a62b7aca1b01e5
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:38 2017 +0100

    nimble/sm: Use packed structures for id addr info
    
    X-Original-Commit: b371c867b1bec20ebb421d39b3116b73ab73cdda

 nimble/host/src/ble_sm.c                | 40 ++++++++++++++++++++-------------
 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/test/src/ble_sm_test_util.c |  6 ++---
 4 files changed, 30 insertions(+), 23 deletions(-)

commit 092bcf162384c3527a0a105261b61450c8931bf6
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:37 2017 +0100

    nimble/sm: Use packed structures for id info
    
    X-Original-Commit: b9abdc407533f4a425b784b4a4a6f5520898572a

 nimble/host/src/ble_sm.c                | 21 ++++++++++++---------
 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  4 +---
 nimble/host/test/src/ble_sm_test_util.c |  8 ++++----
 4 files changed, 19 insertions(+), 18 deletions(-)

commit 13c45f736f70b8afaa49aa7ed6646b8b9255c2de
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:34 2017 +0100

    nimble/sm: Use packed structures for master id
    
    X-Original-Commit: be16f180a5dcc4021eae9cb94188971e705d293b

 nimble/host/src/ble_sm.c                | 36 +++++++++++++++++++++------------
 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 4 files changed, 29 insertions(+), 20 deletions(-)

commit c3efdfa9ee821ecb0b18938f17ac4b1d7d318309
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:32 2017 +0100

    nimble/sm: Use packed structures for encrypt info
    
    X-Original-Commit: 284285304f0df393b1bf3fcee705856fc6113db9

 nimble/host/src/ble_sm.c                | 31 +++++++++++++++++++++----------
 nimble/host/src/ble_sm_cmd.c            |  4 ++--
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 4 files changed, 27 insertions(+), 17 deletions(-)

commit f32eac3ea9ee803c920e0c4e38fca1a268cb1c29
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:31 2017 +0100

    nimble/sm: Use packed structures for pairing failed
    
    X-Original-Commit: 19d27a1606849752317b1bb08fa202770037fb28

 nimble/host/src/ble_sm.c                | 45 ++++++++++++++++++---------------
 nimble/host/src/ble_sm_cmd.c            |  9 +++----
 nimble/host/src/ble_sm_priv.h           |  8 +++---
 nimble/host/test/src/ble_sm_test_util.c |  2 +-
 4 files changed, 32 insertions(+), 32 deletions(-)

commit 68f39e60628d8236ae2d55f605165ebc7e26827a
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:30 2017 +0100

    nimble/sm: Use packed structures for random
    
    X-Original-Commit: 09431b86782a37754a5d66cf7f7584d2ec2c51ee

 nimble/host/src/ble_sm.c                | 11 ++++++-----
 nimble/host/src/ble_sm_cmd.c            |  6 +++---
 nimble/host/src/ble_sm_lgcy.c           | 15 ++++++++++++---
 nimble/host/src/ble_sm_priv.h           |  3 +--
 nimble/host/src/ble_sm_sc.c             | 15 ++++++++++++---
 nimble/host/test/src/ble_sm_test_util.c |  6 +++---
 6 files changed, 37 insertions(+), 19 deletions(-)

commit 1929ed0e423aabb642e61d521ad4e912694bcffe
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:29 2017 +0100

    nimble/sm: Use packed structures for confirm
    
    X-Original-Commit: bc0e7594db3078ae7e9f4798aa746b119611d3f6

 nimble/host/src/ble_sm.c                | 11 ++++++-----
 nimble/host/src/ble_sm_cmd.c            |  6 +++---
 nimble/host/src/ble_sm_lgcy.c           | 17 ++++++++++++++---
 nimble/host/src/ble_sm_priv.h           |  4 ++--
 nimble/host/src/ble_sm_sc.c             | 17 ++++++++++++++---
 nimble/host/test/src/ble_sm_test_util.c |  7 +++----
 6 files changed, 42 insertions(+), 20 deletions(-)

commit e3d8347f62d3f1167bba1e74005fe3e4d0be2b14
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:28 2017 +0100

    nimble/sm: Use packed structures for pairing req and rsp
    
    X-Original-Commit: cb4de66a54899d5afe5ca22a86d1c95e25c9ddd0

 nimble/host/src/ble_sm.c                | 107 ++++++++++++++++++++------------
 nimble/host/src/ble_sm_cmd.c            |  71 +++++++++++++--------
 nimble/host/src/ble_sm_lgcy.c           |  72 ++++++---------------
 nimble/host/src/ble_sm_priv.h           |  18 ++++--
 nimble/host/src/ble_sm_sc.c             |  55 ++++++++--------
 nimble/host/test/src/ble_sm_test_util.c |  52 ++++++++--------
 6 files changed, 197 insertions(+), 178 deletions(-)

commit 5b98573c1f75b513380b3a3cecba2fe4582c16a4
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 17 19:24:27 2017 +0100

    nimble/sm: Remove useless function declaration
    
    This function is not defined anywhere.
    
    X-Original-Commit: 286a0a2efc4765950c41e471ae44ee54a21e5539

 nimble/host/src/ble_sm_priv.h | 1 -
 1 file changed, 1 deletion(-)

commit be2503b5cb5b4e503df9b0af3abf4db1a470672f
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Mon Jan 23 17:14:33 2017 +0100

    Move endiannes related API from ble.h to endian.h
    
    It makes more sense to have this API available for all components.
    
    X-Original-Commit: 4045e96124f2f1bea3fea4b6a68a590e0aa294ed

 nimble/include/nimble/ble.h |  16 ----
 nimble/src/util.c           | 219 --------------------------------------------
 2 files changed, 235 deletions(-)

commit 35e7e9029c794c36cf2f1cf225f61f183b83461d
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Fri Jan 20 13:54:44 2017 +0100

    nimble: Rename htol* and htobe* functions
    
    Use put_le*, get_le*, put_be* and get_be* names for functions
    used to write and read non-hostbyte order data. Original names
    were conflicting with functions typically provided in <endian.h>.
    
    X-Original-Commit: 31f894b64da05d87cbadc29b7978df52e8128c0e

 nimble/controller/src/ble_ll.c               |   4 +-
 nimble/controller/src/ble_ll_adv.c           |   6 +-
 nimble/controller/src/ble_ll_conn.c          |  16 ++--
 nimble/controller/src/ble_ll_conn_hci.c      | 118 +++++++++++++--------------
 nimble/controller/src/ble_ll_ctrl.c          | 116 +++++++++++++-------------
 nimble/controller/src/ble_ll_hci.c           |  34 ++++----
 nimble/controller/src/ble_ll_hci_ev.c        |  44 +++++-----
 nimble/controller/src/ble_ll_resolv.c        |   2 +-
 nimble/controller/src/ble_ll_scan.c          |   4 +-
 nimble/drivers/nrf51/src/ble_hw.c            |   8 +-
 nimble/drivers/nrf52/src/ble_hw.c            |   8 +-
 nimble/host/services/gatt/src/ble_svc_gatt.c |   4 +-
 nimble/host/src/ble_att_clt.c                |  10 +--
 nimble/host/src/ble_att_svr.c                |  14 ++--
 nimble/host/src/ble_eddystone.c              |   2 +-
 nimble/host/src/ble_gattc.c                  |  12 +--
 nimble/host/src/ble_gatts.c                  |  12 +--
 nimble/host/src/ble_hs_adv.c                 |  12 +--
 nimble/host/src/ble_hs_dbg.c                 |  72 ++++++++--------
 nimble/host/src/ble_hs_hci.c                 |  10 +--
 nimble/host/src/ble_hs_hci_cmd.c             | 100 +++++++++++------------
 nimble/host/src/ble_hs_hci_evt.c             |  42 +++++-----
 nimble/host/src/ble_hs_hci_util.c            |   8 +-
 nimble/host/src/ble_hs_startup.c             |   2 +-
 nimble/host/src/ble_ibeacon.c                |   4 +-
 nimble/host/src/ble_l2cap.c                  |   8 +-
 nimble/host/src/ble_sm_alg.c                 |   2 +-
 nimble/host/src/ble_sm_cmd.c                 |  12 +--
 nimble/host/src/ble_uuid.c                   |   8 +-
 nimble/host/test/src/ble_att_clt_test.c      |  26 +++---
 nimble/host/test/src/ble_att_svr_test.c      |   6 +-
 nimble/host/test/src/ble_gap_test.c          |  40 ++++-----
 nimble/host/test/src/ble_gatt_disc_c_test.c  |   4 +-
 nimble/host/test/src/ble_gatt_disc_d_test.c  |   2 +-
 nimble/host/test/src/ble_gatt_disc_s_test.c  |   8 +-
 nimble/host/test/src/ble_gatt_find_s_test.c  |  10 +--
 nimble/host/test/src/ble_gatt_read_test.c    |   2 +-
 nimble/host/test/src/ble_gatts_notify_test.c |   4 +-
 nimble/host/test/src/ble_hs_adv_test.c       |   4 +-
 nimble/host/test/src/ble_hs_hci_test.c       |   4 +-
 nimble/host/test/src/ble_hs_test_util.c      |  38 ++++-----
 nimble/host/test/src/ble_l2cap_test.c        |  14 ++--
 nimble/host/test/src/ble_sm_test_util.c      |  14 ++--
 nimble/include/nimble/ble.h                  |  36 +++-----
 nimble/src/util.c                            |  24 +++---
 45 files changed, 459 insertions(+), 471 deletions(-)

commit bc726319e3436e765772474a256a8f4b121c2baa
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 24 12:04:08 2017 +0100

    nimble/gatt: unify discovery api
    
    This patch unifies api to make it consistent across all discovery
    methods. Always pass true range of attributes to search (start-handle,
    end-handle).
    
    X-Original-Commit: fecfe796b0bc9d4759253f068d4c497290c4cec1

 nimble/host/include/host/ble_gatt.h |  4 ++--
 nimble/host/pts/pts-gatt.txt        |  4 ++--
 nimble/host/src/ble_gattc.c         | 10 +++++-----
 3 files changed, 9 insertions(+), 9 deletions(-)

commit bafb7d1d6cfd810fa7f1f0253e3a13136edba959
Merge: 080df0af 7bb51262
Author: Sterling Hughes <sterling@runtime.io>
Date:   Mon Jan 23 19:01:08 2017 -0800

    merge from develop, and update to support new sysinit
    
    X-Original-Commit: 2681044e84b6446a1a354278d8f5ca69bf6d447d

commit 7bb512623a148f7955733a8745b85ec59b35b320
Merge: 1cbaa547 cc4a4b92
Author: Marko Kiiskila <marko@runtime.io>
Date:   Mon Jan 23 15:09:27 2017 -0800

    Merge branch 'def_task' of https://git-wip-us.apache.org/repos/asf/incubator-mynewt-core into develop
    
    X-Original-Commit: 71f7d65ae8ea62172dac182b469d0124a96fb273

commit 1cbaa547d9b390fc8e7917c48a8a457e38adbc58
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jan 22 10:14:04 2017 -0800

    MYNEWT-555 BLE Host - Avoid mbuf copy on chr read
    
    When the host receives any form of characteristic read request, an
    extraneous mbuf gets allocated. The sequence is:
    
        1. Allocate new mbuf.
        2. Pass new mbuf to application code so app can fill in
           characteristic value.
        3. Copy characteristic value out of new mbuf into response mbuf
        4. Free new mbuf
    
    The reason for the extra allocation is to simplify reads that specify
    non-zero offsets. In the case of a GATT read, the peer may read from
    different offsets of the characteristic. In an effort to simplify the
    API, I decided the requested offset should be hidden from the
    application. Instead, the application always provides the full
    characteristic value, and the host copies the requested portion out of
    the user-filled mbuf and into the ACL data packet.
    
    The fix is to try to reuse the response to hold the characteristic data.
    This can be done if the read request specifies an offset of 0. For
    non-zero offsets, the old behavior remains: allocate an extra mbuf and
    copy the data.
    
    Additional context:
    https://lists.apache.org/thread.html/78358745716cac9512b3c659dfe9b9b7bbb1354ee4c38d6da137bcc0@%3Cdev.mynewt.apache.org%3E
    
    X-Original-Commit: 6410e4375caf15bb265cf4a641f8e669e45bbd8c

 nimble/host/src/ble_gatts.c | 37 ++++++++++++++++++++++++++++++-------
 1 file changed, 30 insertions(+), 7 deletions(-)

commit cc4a4b921ed1e6912f4c3f37d000f4b600ff98c8
Author: Marko Kiiskila <marko@runtime.io>
Date:   Fri Jan 20 18:15:19 2017 -0800

    pkg.yml; update to use the new format of specifying package initialization
    functions.
    
    X-Original-Commit: eced03f21908ad72c73355dac30a38b6e9d6cc2e

 nimble/controller/pkg.yml            | 4 ++--
 nimble/host/pkg.yml                  | 4 ++--
 nimble/host/services/ans/pkg.yml     | 4 ++--
 nimble/host/services/bleuart/pkg.yml | 4 ++--
 nimble/host/services/gap/pkg.yml     | 4 ++--
 nimble/host/services/gatt/pkg.yml    | 4 ++--
 nimble/host/services/ias/pkg.yml     | 4 ++--
 nimble/host/services/tps/pkg.yml     | 4 ++--
 nimble/host/store/ram/pkg.yml        | 4 ++--
 nimble/transport/ram/pkg.yml         | 4 ++--
 nimble/transport/uart/pkg.yml        | 4 ++--
 11 files changed, 22 insertions(+), 22 deletions(-)

commit f7a9cdece95bb07aef91f870ebdb013d2202a46e
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jan 20 11:57:59 2017 -0800

    BLE Host - Allow reconf of connection GAP event cb
    
    /**
     * Configures a connection to use the specified GAP event callback.  A
     * connection's GAP event callback is first specified when the
     * connection is created, either via advertising or initiation.  This
     * function replaces the callback that was last configured.
     *
     * @param conn_handle           The handle of the connection to
     *                                  configure.
     * @param cb                    The callback to associate with the
     *                                  connection.
     * @param cb_arg                An optional argument that the callback
     *                                  receives.
     *
     * @return                      0 on success;
     *                              BLE_HS_ENOTCONN if there is no
     *                                  connection with the specified
     *                                  handle.
     */
    int
    ble_gap_set_event_cb(uint16_t conn_handle, ble_gap_event_fn *cb,
                         void *cb_arg)
    
    X-Original-Commit: 449ef81c5a0ae01f6a767c3797535ce212461e93

 nimble/host/include/host/ble_gap.h      |  2 +
 nimble/host/src/ble_gap.c               | 37 ++++++++++++++++++
 nimble/host/test/src/ble_gap_test.c     | 68 +++++++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.c | 13 ++++---
 4 files changed, 114 insertions(+), 6 deletions(-)

commit 9a9088569923cefade4719922272ac8d3df5799a
Merge: a5b3c144 efba132c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jan 18 12:22:48 2017 -0800

    This closes #160.
    
    Merge remote-tracking branch 'andrzej-kaczmarek/nimble/uuid' into develop
    
    * andrzej-kaczmarek/nimble/uuid:
      nimble: Refactor UUID handling (ATT/GATT)
    
    X-Original-Commit: 0266b224925bbf37059900baff63b7f7d1557c81

commit a5b3c1440600704499a397729d4056081f7510f4
Merge: 1e7fd2cc 818f3f38
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jan 18 11:35:04 2017 -0800

    This closes #161.
    
    Merge remote-tracking branch 'sjanc/sm_tc' into develop
    
    * sjanc/sm_tc:
      nimble/sm: Use TinyCrypt for AES
      Update TinyCrypt library to version 0.2.5
      bletiny: Use proper options for SM configuration
    
    X-Original-Commit: 38d5ca851dd4251aa4de35ffe54e7119c0ff4f03

commit 1e7fd2cc5893390d6df7f3bd428d81feaf291812
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 18 14:24:44 2017 +0100

    nimble/sm: Use TinyCrypt for AES
    
    TinyCrypt is smaller than mbedTLS and is already used for ECDH.
    Using TC for all crypto in SM results in following code size reductions
    for bletiny application:
    
    Legacy Pairing only from
    >     250     277 *fill*
    >   11160       0 crypto_mbedtls.a
    >   48581    3410 net_nimble_host.a
    >  144992    2784   15788  163564   27eec apps/bletiny/bletiny.elf
    
    to
    <     252     277 *fill*
    <    1112       0 crypto_tinycrypt.a
    <   48563    3130 net_nimble_host.a
    <  134928    2784   15508  153220   25684 app/apps/bletiny/bletiny.elf
    
    Legacy + LE SC from
    >     264     276 *fill*
    >   11160       0 crypto_mbedtls.a
    >   51881    3627 net_nimble_host.a
    >  152272    2980   16004  171256   29cf8 app/apps/bletiny/bletiny.elf
    
    to
    <     254     276 *fill*
    <   51863    3347 net_nimble_host.a
    <  141084    2980   15724  159788   2702c app/apps/bletiny/bletiny.elf
    
    X-Original-Commit: a8e3fe08fd85b78064a8be07f906caa98d525471

 nimble/host/pkg.yml          |  2 +-
 nimble/host/src/ble_sm_alg.c | 21 +++++++--------------
 2 files changed, 8 insertions(+), 15 deletions(-)

commit 9010260ac84436484ee985e134415b144de9df8e
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 18 13:38:31 2017 +0100

    Update TinyCrypt library to version 0.2.5
    
    Also add VERSION and LICENSE files from upstream repo.
    
    X-Original-Commit: 813d4dcc9e5922728dd2ef8904252e8dcb19db8c

 nimble/host/src/ble_sm_alg.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 818f3f38b130c0d23dd23deee0c58077c72f6bfb
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 18 14:24:44 2017 +0100

    nimble/sm: Use TinyCrypt for AES
    
    TinyCrypt is smaller than mbedTLS and is already used for ECDH.
    Using TC for all crypto in SM results in following code size reductions
    for bletiny application:
    
    Legacy Pairing only from
    >     250     277 *fill*
    >   11160       0 crypto_mbedtls.a
    >   48581    3410 net_nimble_host.a
    >  144992    2784   15788  163564   27eec apps/bletiny/bletiny.elf
    
    to
    <     252     277 *fill*
    <    1112       0 crypto_tinycrypt.a
    <   48563    3130 net_nimble_host.a
    <  134928    2784   15508  153220   25684 app/apps/bletiny/bletiny.elf
    
    Legacy + LE SC from
    >     264     276 *fill*
    >   11160       0 crypto_mbedtls.a
    >   51881    3627 net_nimble_host.a
    >  152272    2980   16004  171256   29cf8 app/apps/bletiny/bletiny.elf
    
    to
    <     254     276 *fill*
    <   51863    3347 net_nimble_host.a
    <  141084    2980   15724  159788   2702c app/apps/bletiny/bletiny.elf
    
    X-Original-Commit: 2785cad50147160d21bef9aef143199f294ed093

 nimble/host/pkg.yml          |  2 +-
 nimble/host/src/ble_sm_alg.c | 21 +++++++--------------
 2 files changed, 8 insertions(+), 15 deletions(-)

commit dc5536682f67a7fa6e04f8e10c659a964b8f4ab9
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Jan 18 13:38:31 2017 +0100

    Update TinyCrypt library to version 0.2.5
    
    Also add VERSION and LICENSE files from upstream repo.
    
    X-Original-Commit: a46fdfe8683b970bb1f928d8d52e73439041db4d

 nimble/host/src/ble_sm_alg.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 26f14b2488f76c368883260ed7756e2b8bc9cee6
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Jan 9 09:51:52 2017 +0100

    nimble/pts: update test results for PTS 7.0
    
    X-Original-Commit: 9d255f916bbc0bc4f5bfce33eb0f525d63ff948f

 nimble/host/pts/pts-gap.txt   |  34 ++-
 nimble/host/pts/pts-gatt.txt  | 629 +++++++++++++++++++++++-------------------
 nimble/host/pts/pts-l2cap.txt | 361 +++++++++++++-----------
 nimble/host/pts/pts-sm.txt    | 160 ++++++-----
 4 files changed, 659 insertions(+), 525 deletions(-)

commit c8b708f0952100fe72a32738a2fb1b0a9871a399
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 10 13:35:23 2017 +0100

    nimble/privacy: fix set private address timeout
    
    Actually send the hci command after building it.
    
    SET_RPA_TMO should be expected only when test uses RPA and privacy has
    not yet been enabled. The Bluetooth stack remembers that privacy is
    enabled and does not send SET_RPA_TMO every time. For test purpose
    let's track privacy state in here.
    
    X-Original-Commit: 34d34e1d661643a446b542492cd775cb01cf54cb

 nimble/host/src/ble_hs_pvcy.c           |  6 +++-
 nimble/host/test/src/ble_hs_test_util.c | 52 +++++++++++++++++++++++++--------
 2 files changed, 45 insertions(+), 13 deletions(-)

commit 3fc7f7b1527dc8539bf3e324da3320aefa64295b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 10 13:25:59 2017 +0100

    nimble/ll: fix and refactor set rpa timeout
    
    os_callout_reset return value was not assigned to rc.
    Additionally code was refactored to improve readability.
    
    X-Original-Commit: f1a94d2a32b7a93bae5ef6b90e249cb4494202a0

 nimble/controller/src/ble_ll_resolv.c | 19 +++++++++----------
 1 file changed, 9 insertions(+), 10 deletions(-)

commit c9de71ada8ffd81c7bb8418b81e435cb0b4252da
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 10 11:43:38 2017 +0100

    nimble/hci: remove redundant check
    
    X-Original-Commit: 882748946137caa295dcf4f4753720910e8b37f0

 nimble/host/src/ble_hs_hci_cmd.c | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

commit 101044b6cf9cb1727c4b0261052bf403ec4a9249
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Jan 10 13:58:19 2017 +0100

    nimble/gatt: fix zero length attribute read
    
    It is possible to read with offset equal to the length of the
    attribute.
    
    With this patch it is possible to pass GATT/SR/GAR/BV-08-C.
    
    X-Original-Commit: 118e3993830495025c037e63b23bd3a2d319bf5b

 nimble/host/src/ble_gatts.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2e00667f51213f9ec872aa35e7f1921e312bc22b
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Jan 17 15:42:40 2017 -0800

    sys/log; move log module to sys/log/full.
    This package exports api 'log'.
    Packages which used to depend on 'sys/log' now depend on that API.
    Update apps/unit tests to depend on sys/log/full.
    
    X-Original-Commit: 008962911000947171c4a0be9216aff6c4fbf27c

 nimble/host/pkg.yml      | 2 +-
 nimble/host/test/pkg.yml | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

commit 17109692aee9c89bace1b6f98c402dd02d629c58
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Jan 17 14:29:21 2017 -0800

    sys/stats; add STATS_RESET() to clear counter area from stats structure.
    
    X-Original-Commit: f89dd34602d49dcdb1de8bfcd2b81a77d2ef0982

 nimble/controller/src/ble_ll.c      | 3 +--
 nimble/controller/src/ble_ll_conn.c | 3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

commit cb5dc3c3a0d115b2f8e1c937b42ee11e6d593381
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Jan 17 14:26:40 2017 -0800

    sys/stats; move the stats module to sys/stats/full.
    Tell that sys/stats/full package exports API 'stats'.
    Packages list 'stats' as required API.
    Update apps to depend on sys/stats/full.
    
    X-Original-Commit: 002424b24b683f4b54952967f42cb14122a3ecc7

 nimble/controller/pkg.yml | 2 +-
 nimble/host/pkg.yml       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit efba132c213530cf678a778886097c148b217fce
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Fri Jan 6 16:31:04 2017 +0100

    nimble: Refactor UUID handling (ATT/GATT)
    
    This patch introduces dedicated type for UUIDs in order to handle them
    consistently everywhere. It not only makes handling of UUIDs easier,
    but also allows for some flash and RAM savings due to some extra code
    being removed and less memory required to store UUIDs in common cases
    (especially with 16-bit UUIDs).
    
    *IMPORTANT NOTES*
    - ble_uuid_t is a "stub" type which shall be always used as a pointer;
      to access actual UUID value other helpers and types shall be used
    - when registering services using new API, only UUID pointer is stored
      for all attributes (there is *no* copy of value made) thus it is not
      allowed to pass UUIDs created e.g. on stack
    - it is illegal to have 128-bit UUID declared which has its 16-bit UUID
      equivalent - there is no implicit conversion from 128-bit to 16-bit
      UUID done inside Nimble
    - ...but this means you can rely on UUID type received from Nimble and
      128-bit UUID will be always non-Bluetooth one
    
    Below are few examples how to use new UUIDs API:
    
    // 16-bit UUID value with initialization
    ble_uuid16_t uuid16 = BLE_UUID16_INIT(0x2801);
    // 128-bit UUID value with initialization
    ble_uuid128_t uuid128 = BLE_UUID128_INIT(0x00, 0x11, ... 0xFF);
    
    // "stub" type is used to pass any type of UUID via API
    ble_uuid_t *uuid1 = &uuid16.u;
    ble_uuid_t *uuid2 = &uuid128.u;
    
    // comparing UUIDs is really easy now
    if (ble_uuid_cmp(uuid1, uuid2) == 0) { /* equal */ )
    
    // since in most cases we use 16-bit UUIDs, it's convenient to easily
    // retrieve 16-bit value (or 0 if UUID is not 16-bit)
    uint16_t u16 = ble_uuid_u16(uuid1);
    
    // the above is equivalent of
    u16 = uuid1->type == BLE_UUID_TYPE_16 ? BLE_UUID16(uuid1)->value : 0;
    
    // we can easily define UUID inline as well, e.g. when defining service
    static const struct ble_gatt_svc_def ble_svc_gap_defs[] = {
        {
            .type = BLE_GATT_SVC_TYPE_PRIMARY,
            .uuid = BLE_UUID16_DECLARE(BLE_SVC_GAP_UUID16),
    (...)
    
    // finally, if we need to store any UUID there is an union defined to help
    ble_uuid_any_t uuid;
    uuid.u16 = uuid16;
    
    X-Original-Commit: b1c14f3fd599198995602dc7de3572d719942df0

 nimble/host/include/host/ble_gatt.h                |  39 ++--
 nimble/host/include/host/ble_uuid.h                |  92 ++++++--
 nimble/host/profiles/lls/src/ble_svc_lls.c         |   4 +-
 nimble/host/services/ans/src/ble_svc_ans.c         |  14 +-
 .../services/bleuart/include/bleuart/bleuart.h     |   2 +-
 nimble/host/services/bleuart/src/bleuart.c         |  28 ++-
 nimble/host/services/gap/src/ble_svc_gap.c         |  16 +-
 nimble/host/services/gatt/src/ble_svc_gatt.c       |   4 +-
 nimble/host/services/ias/src/ble_svc_ias.c         |   4 +-
 nimble/host/services/lls/src/ble_svc_lls.c         |   4 +-
 nimble/host/services/tps/src/ble_svc_tps.c         |   4 +-
 nimble/host/src/ble_att_clt.c                      |  14 +-
 nimble/host/src/ble_att_priv.h                     |  16 +-
 nimble/host/src/ble_att_svr.c                      | 199 +++++++----------
 nimble/host/src/ble_gattc.c                        | 146 ++++---------
 nimble/host/src/ble_gatts.c                        | 138 ++++++------
 nimble/host/src/ble_uuid.c                         | 240 +++++++++++++--------
 nimble/host/src/ble_uuid_priv.h                    |   9 +-
 nimble/host/test/src/ble_att_svr_test.c            | 169 +++++++--------
 nimble/host/test/src/ble_gatt_conn_test.c          |  16 +-
 nimble/host/test/src/ble_gatt_disc_c_test.c        | 150 ++++++-------
 nimble/host/test/src/ble_gatt_disc_d_test.c        |  74 +++----
 nimble/host/test/src/ble_gatt_disc_s_test.c        | 119 +++++-----
 nimble/host/test/src/ble_gatt_find_s_test.c        |  56 ++---
 nimble/host/test/src/ble_gatt_read_test.c          |  12 +-
 nimble/host/test/src/ble_gatts_notify_test.c       |  16 +-
 nimble/host/test/src/ble_gatts_read_test.c         |   8 +-
 nimble/host/test/src/ble_gatts_reg_test.c          | 190 ++++++++--------
 nimble/host/test/src/ble_hs_test_util.c            |  76 +++----
 nimble/host/test/src/ble_hs_test_util.h            |  10 +-
 nimble/host/test/src/ble_uuid_test.c               |  93 ++++----
 31 files changed, 948 insertions(+), 1014 deletions(-)

commit 11d4414c1754c8931975365e713bf46f496a57fc
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jan 13 13:17:28 2017 -0800

    BLE Host - disallow conn to already-connected peer
    
    Now, ble_gap_connect() returns BLE_HS_EDONE if the specified peer is
    already connected.
    
    (BLE_HS_EALREADY is already being used here.  It gets returned if a
    connect procedure is already in progress.)
    
    X-Original-Commit: 4b17e1692358fa438b59aae6627cd7251658e029

 nimble/host/src/ble_gap.c                  | 14 +++++++++++++-
 nimble/host/src/ble_hs_conn.c              |  2 +-
 nimble/host/src/ble_hs_conn_priv.h         |  3 ++-
 nimble/host/test/src/ble_gap_test.c        | 22 ++++++++++++++++++++++
 nimble/host/test/src/ble_gatt_write_test.c |  2 --
 5 files changed, 38 insertions(+), 5 deletions(-)

commit 2cdde8b577df03c66cf7a8ce3b2ebd85eddaf05c
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jan 10 21:56:18 2017 -0800

    MYNEWT-542: Controller not working if os cputime not 1 MHz.
    
    There were additional places that microseconds were not being
    converted into ticks. Now converted.
    
    X-Original-Commit: 797836452faf6e9317d0389d890e8abd2395a138

 nimble/controller/src/ble_ll_adv.c  | 2 +-
 nimble/controller/src/ble_ll_conn.c | 4 +++-
 nimble/drivers/nrf51/src/ble_phy.c  | 6 +++---
 nimble/drivers/nrf52/src/ble_phy.c  | 6 +++---
 4 files changed, 10 insertions(+), 8 deletions(-)

commit 08322b5c620b1559952dc22c11c39c5a4c3991b7
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Jan 10 18:23:49 2017 -0800

    nimble host test; change the way empty struct is initialized to
    get this to compile on linux gcc.
    
    X-Original-Commit: 433aab55c42347bbba92df60ab869d0d6bf81933

 nimble/host/test/src/ble_hs_test_util.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 2a1edb216d9af4e205d9a5e1fda6f4ce75f82e01
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jan 9 17:57:35 2017 -0800

    MYNEWT-542: Controller not working properly if os cputime not 1MHz
    
    The code was not correctly usecs to ticks in all cases. The changes
    to the code should now allow a cputime to be set differently than
    1MHz. Note that nrf51 platforms will not work (but for other reasons).
    Read the jira ticket for more information.
    
    X-Original-Commit: fa73ce5950bd7d52c3f743390c6884d89221ef06

 nimble/controller/src/ble_ll_adv.c  | 3 ++-
 nimble/controller/src/ble_ll_conn.c | 9 ++++++---
 nimble/drivers/nrf51/src/ble_phy.c  | 4 ++--
 nimble/drivers/nrf52/src/ble_phy.c  | 4 ++--
 4 files changed, 12 insertions(+), 8 deletions(-)

commit 9cd56123e926e0bd05b7b8802b0f262857486e3a
Author: Marko Kiiskila <marko@runtime.io>
Date:   Mon Jan 9 10:38:45 2017 -0800

    nimble ble host; assert if host fails to start.
    
    X-Original-Commit: 708d3240aa61eb342064034038249989ef9771db

 nimble/host/src/ble_hs.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit b9fd1288ed0379eef5e4af6f7462c33059be124e
Merge: b391625d d89941d1
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jan 7 07:36:35 2017 -0800

    This closes #156.
    
    Merge remote-tracking branch 'sjanc/sm' into develop
    
    * sjanc/sm:
      nimble/sm: Remove not needed stack variables
      nimble/sm: Add support for rejecting pairing with disabled SM
    
    X-Original-Commit: 4a287aa01906e98a2f512ab7faff008e443f8243

commit b391625d0a1af082f0e3c6884b769836dc28fdde
Merge: e6db37e9 0f96d038
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jan 7 07:33:26 2017 -0800

    This closes #155.
    
    Merge remote-tracking branch 'andrzej-kaczmarek/nimble/att_encrypt' into develop
    
    * andrzej-kaczmarek/nimble/att_encrypt:
      nimble/pts: Update PTS-GAP test results
      nimble/pts: Update PTS-GATT test results
      bletiny: Add minimum encryption key size for attrs
      nimble/att: Support "Insufficient Encryption Key Size" error code
      nimble/att: Support "Insufficient Encryption" error code
      nimble/att: Add mimimum encryption key size for attribute
      nimble/sm: Store encryption key size in link security state
      nimble/sm: Persist encryption key size
    
    X-Original-Commit: 0442a1e1e16701f88f4ff096fc209bb1566bd7c4

commit e6db37e9834f7971d9b266191963252f0e0be0b9
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jan 6 16:39:13 2017 -0800

    MYNEWT-539: Controller allocates too many os events for commands
    
    The controller now uses a global os event and does not allocate a
    memory pool.
    
    X-Original-Commit: f10034d73e2cb5667bc1948f0a7b12af9aad9f1a

 nimble/controller/include/controller/ble_ll_hci.h |  4 +++-
 nimble/controller/src/ble_ll.c                    | 13 -------------
 nimble/controller/src/ble_ll_conn_priv.h          |  3 ---
 nimble/controller/src/ble_ll_hci.c                | 16 ++++++++--------
 4 files changed, 11 insertions(+), 25 deletions(-)

commit 884c98a2fc3142afe8bfb311c27551d88eb6cc85
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jan 6 14:28:23 2017 -0800

    BLE Host - Fix double mbuf free.
    
    ble_l2cap_tx() always consumes the supplied mbuf, regardless of return
    code.  However, ble_att_clt_tx() was freeing the mbuf again when
    ble_l2cap_tx() failed.
    
    X-Original-Commit: 28a8d7c39a9931b781f14222cf8763a01b1e64f6

 nimble/host/src/ble_att_clt.c | 1 +
 1 file changed, 1 insertion(+)

commit 39095043136ec4aec9bcfce830010a1e1b0c8a0f
Author: William San Filippo <wills@runtime.io>
Date:   Wed Jan 4 18:00:21 2017 -0800

    MYNEWT-536: mbuf exhaustion can cause supervision timeout
    
    The fix to this bug involved removing the supervision timers and replacing
    it with a variable in the connection state machine that records the last
    received pdu time (that was valid). This reduced RAM and code usage but
    does slightly change when the supervision timeout will actually occur.
    
    The supervision timeout will now occur before the actual timer due
    to the fact that we check the supervision timeout at connection
    event end. There is no reason to not end the connection at this point
    since there is no possible way to receive a data pdu before the timer
    would have fired off. There is also the slight possibility that the supervision
    timeout will occur slightly later than expected but this would be for a short
    amount of time and be unlikely.
    
    X-Original-Commit: d1af59d32818a2ec079b9475ab595dcc9c3d86b6

 nimble/controller/include/controller/ble_ll_conn.h |   7 +-
 nimble/controller/src/ble_ll_conn.c                | 108 +++++++++------------
 2 files changed, 45 insertions(+), 70 deletions(-)

commit d89941d16f0c7350bb25cc599f865bad23b56ee8
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 3 11:03:31 2017 +0100

    nimble/sm: Remove not needed stack variables
    
    Remove prev stack variable for ble_sm_proc_find if caller makes no
    use of it.
    
    X-Original-Commit: eece2d74d099f05259e751592c140b69f8570e18

 nimble/host/src/ble_sm.c    | 39 +++++++++++----------------------------
 nimble/host/src/ble_sm_sc.c |  6 ++----
 2 files changed, 13 insertions(+), 32 deletions(-)

commit 884bde43c253b82f442385e34b4b0d9df9034356
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Tue Jan 3 17:37:21 2017 +0100

    nimble/sm: Add support for rejecting pairing with disabled SM
    
    If pairing is not supported host shall response to Pairing Request
    or Security Request with Pairing Failed PDU and set reason to
    "Pairing not supported".
    
    < ACL Data TX: Handle 76 flags 0x00 dlen 11
          SMP: Pairing Request (0x01) len 6
            IO capability: DisplayYesNo (0x01)
            OOB data: Authentication data not present (0x00)
            Authentication requirement: Bonding, MITM, SC, No Keypresses (0x0d)
            Max encryption key size: 16
            Initiator key distribution: EncKey Sign LinkKey (0x0d)
            Responder key distribution: EncKey IdKey Sign LinkKey (0x0f)
    > ACL Data RX: Handle 76 flags 0x02 dlen 6
          SMP: Pairing Failed (0x05) len 1
            Reason: Pairing not supported (0x05)
    
    X-Original-Commit: f50818b2ad5fa8af2d9fd5c5f5a19e1e54ee550a

 nimble/host/src/ble_hs_conn.c |  6 ++--
 nimble/host/src/ble_sm.c      | 66 +++++++++++++++++++++++++++++++------------
 nimble/host/src/ble_sm_priv.h |  5 ++--
 3 files changed, 52 insertions(+), 25 deletions(-)

commit 0f96d038066f30b45ed782f5df126ed11b309454
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Wed Jan 4 13:22:57 2017 +0100

    nimble/pts: Update PTS-GAP test results
    
    X-Original-Commit: e81b1b1e8cdd38db9cd384e35189dcc398d0864c

 nimble/host/pts/pts-gap.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bc74c15639e8a1036791b7ecc47ceddcdabf66f8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 3 15:24:59 2017 +0100

    nimble/pts: Update PTS-GATT test results
    
    X-Original-Commit: 6b7db4cb74cf2630102cb4ab2368826c1178b4ed

 nimble/host/pts/pts-gatt.txt | 23 ++++++++++++-----------
 1 file changed, 12 insertions(+), 11 deletions(-)

commit 799e1f16bcb1c6b19377c75d0f2df6b701091c95
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Dec 31 22:18:48 2016 +0100

    nimble/att: Support "Insufficient Encryption Key Size" error code
    
    Access to attributes which require minimum key size on a link encrypted
    with shorter encryption key shall fail with "Insufficient Encryption
    Key Size" error code.
    
    Reference:
    Bluetooth Specification 4.2, Vol. 3, Part C, Section 10.3.1
    
    X-Original-Commit: 7fd14c4e2b89a7006a4759e0407aca1498cac2f0

 nimble/host/src/ble_att_svr.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 109046b1536f353f43f2a0452bd56b8b38e17e85
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sat Dec 31 22:18:48 2016 +0100

    nimble/att: Support "Insufficient Encryption" error code
    
    Access to attributes which require encryption (so this also includes
    authentication) on an unencrypted link should check if there is LTK
    available. If present, the proper error response is "Insufficient
    Encryption" and "Insifficient Authentication" otherwise.
    
    Reference:
    Bluetooth Specification 4.2, Vol. 3, Part C, Section 10.3.1
    
    X-Original-Commit: 4ce576178432c6bf7bd8db2ec2bb05b0434bc734

 nimble/host/src/ble_att_svr.c | 29 ++++++++++++++++++++++++-----
 1 file changed, 24 insertions(+), 5 deletions(-)

commit 016672ed71a44211d56cd2e579c24518041aa6c8
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 3 15:24:12 2017 +0100

    nimble/att: Add mimimum encryption key size for attribute
    
    Each attribute in database can have minimum encryption key size which
    is required to access this attribute.
    
    X-Original-Commit: 7cd398d8a70052849b2195a1bfb4bb25f805c238

 nimble/host/include/host/ble_gatt.h       |  6 ++++++
 nimble/host/src/ble_att_priv.h            |  8 +++----
 nimble/host/src/ble_att_svr.c             | 13 ++++++-----
 nimble/host/src/ble_gatts.c               | 17 ++++++++-------
 nimble/host/test/src/ble_att_svr_test.c   | 36 +++++++++++++++----------------
 nimble/host/test/src/ble_gatt_conn_test.c |  4 ++--
 6 files changed, 47 insertions(+), 37 deletions(-)

commit 767cbf61a26ba7f802d30a94ef1022ae3f5f59c0
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Jan 3 15:22:54 2017 +0100

    nimble/sm: Store encryption key size in link security state
    
    Encryption key size is stored in link security state so it can be
    accessed in other code (e.g. ATT).
    
    X-Original-Commit: a9deae139837af5089582c60f9464ba01cb6dc83

 nimble/host/include/host/ble_gap.h |  1 +
 nimble/host/src/ble_sm.c           | 17 ++++++++++++++---
 2 files changed, 15 insertions(+), 3 deletions(-)

commit a8b20f9f10fd9951d26d75f1e6891630072e9c4c
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 29 11:59:18 2016 +0100

    nimble/sm: Persist encryption key size
    
    Encryption key size is stored in persistent storage with encrpytion
    keys.
    
    X-Original-Commit: 8f6e37fde2211b087b9f9a610f38053e1f49c817

 nimble/host/include/host/ble_store.h | 1 +
 nimble/host/src/ble_sm.c             | 1 +
 nimble/host/src/ble_sm_priv.h        | 1 +
 3 files changed, 3 insertions(+)

commit 6a5c869cf6203185eae29eb8c87d0bdba4f0afa0
Merge: 9acc53fd 58c303cf
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jan 3 14:17:19 2017 -0800

    This closes #154.
    
    Merge remote-tracking branch 'michal-narajowski/write-cancel' into develop
    
    * michal-narajowski/write-cancel:
      nimble: fixed nested long writes
      nimble: added missing descriptors
      nimble: passed some PTS tests
      nimble: fix send cancel pending writes on error
      nimble: fix execute write flags
    
    X-Original-Commit: ac14962592d94543065f461d9963f7cadf6bc190

commit 9acc53fd65e87ca40ea16221f0b2881764e7dccb
Merge: 3d704c0f e2fbd4f5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jan 3 14:13:19 2017 -0800

    This closes #148.
    
    Merge remote-tracking branch 'michal-narajowski/fix-offset-pts' into develop
    
    * michal-narajowski/fix-offset-pts:
      nimble: add offset option to write long in client
      nimble: add offset option to read long in client
    
    X-Original-Commit: 56e711b8fd35f358a83d32367f05eeae1f94dc5c

commit 58c303cf54e89720e26147b9a6e47dfba976438e
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 30 17:07:27 2016 +0100

    nimble: fixed nested long writes
    
    The test was looking for second long descriptor.
    
    With this patch it is possible to pass TC_GAW_SR_BV_10_C.
    
    X-Original-Commit: 20539f6da0db392ba8571f510aed985014479b46

 nimble/host/pts/pts-gatt.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 65baabb2f9c85e2c1fa6ec199927cb754455ec85
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 30 16:42:27 2016 +0100

    nimble: added missing descriptors
    
    With this patch it is possible to pass TC_GAW_SR_BV_08_C,
    TC_GAW_SR_BV_09_C, TC_GAW_SR_BV_27_C.
    
    X-Original-Commit: fae2eb35c088aaa0f4ea3b9280932821fb80d3f7

 nimble/host/pts/pts-gatt.txt | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 88abb79d888e0510351cd7fa09cf1f268f5617bc
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 30 16:28:26 2016 +0100

    nimble: passed some PTS tests
    
    X-Original-Commit: e0421ecc9c86461c67507eddf800b195c3a0a265

 nimble/host/pts/pts-gatt.txt | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

commit 45659f3e62efb55e5ab45ba99686776182fe3579
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Fri Dec 30 11:11:16 2016 +0100

    nimble: fix send cancel pending writes on error
    
    Changed the cur_attr range check, because cur_attr is still 0 when first
    response is received.
    
    With this patch it is possible to pass TC_GAW_CL_BI_32_C.
    
    X-Original-Commit: 4a9c7e6fbc40243fa74af34784b0ed53fae2533c

 nimble/host/pts/pts-gatt.txt | 3 ++-
 nimble/host/src/ble_gattc.c  | 5 ++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 39c39b7b7b22e2fa4aa519393dbf4335b9120512
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 20 15:24:35 2016 +0100

    nimble: fix execute write flags
    
    Changed the definition and interpretation of exec write flags
    to similar to Bluez.
    
    X-Original-Commit: 48bce399c8eda704abe2d81d3c0f038ca8d61241

 nimble/host/src/ble_att_clt.c              |  4 ----
 nimble/host/src/ble_att_cmd_priv.h         |  4 ++--
 nimble/host/src/ble_att_svr.c              |  2 +-
 nimble/host/src/ble_gattc.c                |  8 ++++----
 nimble/host/test/src/ble_att_clt_test.c    |  8 ++++----
 nimble/host/test/src/ble_att_svr_test.c    | 20 ++++++++++----------
 nimble/host/test/src/ble_gatt_write_test.c | 10 +++++-----
 7 files changed, 26 insertions(+), 30 deletions(-)

commit 3d704c0f340816a645c6aa12b125ccf16ef22039
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 29 17:01:34 2016 -0800

    BLE uart - fix host-only build error.
    
    X-Original-Commit: 9d0b1d4904183a375ca33c969fd785b548ff0a05

 nimble/transport/uart/src/ble_hci_uart.c | 8 ++++++++
 1 file changed, 8 insertions(+)

commit f6cf77f938521187ed2d1c2a3e27f05377727ee3
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 29 14:28:45 2016 -0800

    Add BLE_HOST syscfg setting.
    
    X-Original-Commit: 46e25ed74f79984c3dd5beee1ad4666893b200ee

 nimble/host/syscfg.yml | 4 ++++
 1 file changed, 4 insertions(+)

commit e2fbd4f5a552d0a0fea7aadbdc1a41cef8770e0a
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 20 13:46:44 2016 +0100

    nimble: add offset option to write long in client
    
    With this patch it is possible to pass TC_GAW_CL_BI_09_C and
    TC_GAW_CL_BI_27_C.
    
    X-Original-Commit: 37fb8a6970d15e9d1f8ab1dc85c5520cf74052b8

 nimble/host/include/host/ble_gatt.h     | 2 +-
 nimble/host/src/ble_gattc.c             | 5 +++--
 nimble/host/test/src/ble_hs_test_util.c | 3 ++-
 3 files changed, 6 insertions(+), 4 deletions(-)

commit d74fb8f37223c8efc17428fc0bd9b43cdce5a5fe
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Tue Dec 20 11:49:41 2016 +0100

    nimble: add offset option to read long in client
    
    With this patch it is possible to pass TC_GAR_CL_BI_13_C and
    TC_GAR_CL_BI_29_C.
    
    X-Original-Commit: c90a3036d01326b926a57dfd76303110ab7ee7c7

 nimble/host/include/host/ble_gatt.h       |  2 +-
 nimble/host/src/ble_gattc.c               |  4 ++--
 nimble/host/test/src/ble_gatt_conn_test.c |  6 ++++--
 nimble/host/test/src/ble_gatt_read_test.c | 11 +++++++----
 4 files changed, 14 insertions(+), 9 deletions(-)

commit 42fcfa44e866a44b95e39cef6be221cf93b060d1
Merge: c802a69b 6ec5a04c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Dec 21 17:05:05 2016 -0800

    This closes #146.
    
    Merge remote-tracking branch 'sjanc/pts' into develop
    
    * sjanc/pts:
      nimble: Add PTS tests results and TPG files
    
    X-Original-Commit: dd29d7785e5423a9578253d750946be76f1cb0f0

commit c802a69b3a403a3a30c1e97c1a359a57f3c21b71
Merge: a14f63e0 bdfb3add
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Dec 21 15:30:39 2016 -0800

    This closes #143.
    
    Merge remote-tracking branch 'andrzej-kaczmarek/nimble/find_by_type_fix' into develop
    
    * andrzej-kaczmarek/nimble/find_by_type_fix:
      nimble/att: Refactor Find By Type Value handling
      nimble/att: Rename ble_att_svr_is_valid_group_type
      nimble/test: Fix ble_att_svr_test_find_type_value test cases
    
    X-Original-Commit: abfe994832bc07fa205694f9a2301bc527070986

commit a14f63e08efa7e6ad109c88169c5b1dc12b92756
Merge: 16928153 e0303f81
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Dec 21 15:25:28 2016 -0800

    This closes #142.
    
    Merge remote-tracking branch 'michal-narajowski/fix-gatt-pts' into develop
    
    * michal-narajowski/fix-gatt-pts:
      nimble: fix not handling invalid offset read
      bletiny: fix passing correct handle to gattc disc all dscs
      nimble: fix sending uuid16 when possible in disc_svc_uuid
      bletiny: fix passing svc_start_handle as callback param
    
    X-Original-Commit: c928be0de5fd8ebe4eef83896cc675af08040f43

commit 6ec5a04cd39ca2721c56c4cbdec1ec667b94b644
Author: Szymon Janc <szymon.janc@codecoup.pl>
Date:   Wed Dec 21 17:51:52 2016 +0100

    nimble: Add PTS tests results and TPG files
    
    This adds curent results for qualification tests against BT SIG PTS.
    TPG files are also included for importing tests configuration into
    PTS tool.
    
    X-Original-Commit: 63389970913959490dfee07b79a59243d5c39d79

 nimble/host/pts/README.txt                       |    8 +
 nimble/host/pts/pts-gap.txt                      |  360 ++++++++
 nimble/host/pts/pts-gatt.txt                     |  465 ++++++++++
 nimble/host/pts/pts-l2cap.txt                    |  184 ++++
 nimble/host/pts/pts-sm.txt                       |  117 +++
 nimble/host/pts/tpg/90359-20161220-172100175.tpg | 1022 ++++++++++++++++++++++
 nimble/host/pts/tpg/90359-20161220-172113981.pts |  288 ++++++
 7 files changed, 2444 insertions(+)

commit bdfb3addf9903729eee5c8ba8367ea07f8277700
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Dec 20 13:21:09 2016 +0100

    nimble/att: Refactor Find By Type Value handling
    
    Current implementation of "Find By Type Value" handler is broken as it
    assumes that group is a sequence of consecutive attributes with the
    same type and value. This is incorrect and it breaks "Discover Primary
    Services By Service UUID" GATT procedure effectively making impossible
    to search for service by UUID on local GATT server.
    
    This fixes the problem by refactoring ble_att_svr_fill_type_value() to
    use proper grouping as defined by Bluetooth Specification, Vol 3, Part
    G, Section 2.5.3.
    
    X-Original-Commit: 483eb817675666542ed02aec172815b88e291990

 nimble/host/src/ble_att_svr.c | 178 ++++++++++++++++++------------------------
 1 file changed, 76 insertions(+), 102 deletions(-)

commit b48db615a619affd0acbb01db36e3c8bae032fc4
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Dec 13 16:25:14 2016 +0100

    nimble/att: Rename ble_att_svr_is_valid_group_type
    
    The ble_att_svr_is_valid_read_group_type() checks if given type is
    valid for Read By Group Type Request only, not if it is valid group
    type in general. Rename this function so it is more clear what it
    does.
    
    X-Original-Commit: 0b81089fc7554cea59aa503905a193c008de70da

 nimble/host/src/ble_att_svr.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 9300a971824ab9ee5fd25fb9b5e4118496b0ccd5
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Dec 20 15:24:46 2016 +0100

    nimble/test: Fix ble_att_svr_test_find_type_value test cases
    
    Test cases for "Find By Type Value" are incorrect since they are based
    on an assumption that attribute group is a sequence of consecutive
    attributes with the same type and value.
    
    This fixes the test cases to check for proper grouping as defined by
    Bluetooth Specification 4.2, Vol 3, Part G, Section 2.5.3.
    
    Since the actual ATT implementation is based on the same incorrect
    assumtpion, the test cases will now fail until ATT is fixed as well.
    
    X-Original-Commit: 1f2b6bb2661d95421a00c4c01d75866bde7ba8f1

 nimble/host/test/src/ble_att_svr_test.c | 76 ++++++++++++++++-----------------
 1 file changed, 38 insertions(+), 38 deletions(-)

commit e0303f81ffacb8981332c4326c2f025e8d4f08b2
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Dec 19 16:51:03 2016 +0100

    nimble: fix not handling invalid offset read
    
    With this patch it is possible to pass TC_GAR_SR_BI_13_C and
    TC_GAR_SR_BI_29_C.
    
    X-Original-Commit: 2c34fe2a7095882001d1fe48acc0370241088df7

 nimble/host/src/ble_gatts.c | 2 ++
 1 file changed, 2 insertions(+)

commit 2bb183546c885f8ff92e92ca46720abef90de040
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Dec 14 15:46:18 2016 +0100

    nimble: fix sending uuid16 when possible in disc_svc_uuid
    
    With this patch it is possible to pass TC_GAD_CL_BV_02_C.
    
    X-Original-Commit: 7dee316d9a3aae1897baa2f417e3958f3d4fe428

 nimble/host/src/ble_gattc.c | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 169281537b56137f95c5b0b6e52ad57b5800437d
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Dec 19 15:26:12 2016 -0800

    Revert "MYNEWT-512 Replace gen. sysinit with linker sect"
    
    This reverts commit 43a5ef8860cbf4bc5bf43fde8a29fe74361536fa.
    
    X-Original-Commit: c870a0fe51e8e2ecc0e42a952799272bb45ef825

 nimble/controller/include/controller/ble_ll.h      |  3 ++
 nimble/controller/pkg.yml                          |  3 ++
 nimble/controller/src/ble_ll.c                     |  4 +--
 nimble/host/include/host/ble_hs.h                  |  1 +
 nimble/host/pkg.yml                                |  3 ++
 .../ans/include/services/ans/ble_svc_ans.h         |  2 ++
 nimble/host/services/ans/pkg.yml                   |  3 ++
 nimble/host/services/ans/src/ble_svc_ans.c         |  4 +--
 .../services/bleuart/include/bleuart/bleuart.h     |  2 ++
 nimble/host/services/bleuart/pkg.yml               |  3 ++
 nimble/host/services/bleuart/src/bleuart.c         |  4 +--
 .../gap/include/services/gap/ble_svc_gap.h         |  2 ++
 nimble/host/services/gap/pkg.yml                   |  3 ++
 nimble/host/services/gap/src/ble_svc_gap.c         |  4 +--
 .../gatt/include/services/gatt/ble_svc_gatt.h      |  1 +
 nimble/host/services/gatt/pkg.yml                  |  3 ++
 nimble/host/services/gatt/src/ble_svc_gatt.c       |  4 +--
 .../ias/include/services/ias/ble_svc_ias.h         |  1 +
 nimble/host/services/ias/pkg.yml                   |  3 ++
 nimble/host/services/ias/src/ble_svc_ias.c         |  4 +--
 .../tps/include/services/tps/ble_svc_tps.h         |  4 +++
 nimble/host/services/tps/pkg.yml                   |  3 ++
 nimble/host/services/tps/src/ble_svc_tps.c         |  4 +--
 nimble/host/src/ble_hs.c                           |  6 ++--
 nimble/host/store/ram/pkg.yml                      |  3 ++
 nimble/host/store/ram/src/ble_store_ram.c          |  4 +--
 nimble/transport/ram/pkg.yml                       |  3 ++
 nimble/transport/ram/src/ble_hci_ram.c             |  4 +--
 .../uart/include/transport/uart/ble_hci_uart.h     | 33 ++++++++++++++++++++++
 nimble/transport/uart/pkg.yml                      |  3 ++
 nimble/transport/uart/src/ble_hci_uart.c           |  8 +++---
 31 files changed, 98 insertions(+), 34 deletions(-)

commit 52416be61f39a01bd2b30a39c3a7a3a2fcea0f65
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Dec 19 09:47:29 2016 -0800

    MYNEWT-346 BLE Host - Remove extraneous dep.
    
    X-Original-Commit: 73f125679afaa31b19d95b0b6f0abf2b8361e8a5

 nimble/host/pkg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2e51860de09b260f1da820140f99e0e6bd189ae3
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Dec 14 18:07:50 2016 -0800

    MYNEWT-512 Replace gen. sysinit with linker sect
    
    OLD MECHANISM:
    
        * pkg.yml file specifies "init_function" and "init_stage"
        * newt generates sysinit C files which call the packages' init functions in
          the specified order.
    
    NEW MECHANISM:
    
        * Each package defines an "init entry" struct containing:
            * pointer to init function
            * uint8_t stage
        * Init entry structs are placed in a special section.
        * At startup, the sysinit() function walks the list of entries in the
          special section and calls their corresponding init functions in the
          correct order.
    
    INTERFACE:
    
        /* Package initialization function. */
        typedef void sysinit_init_fn(struct sysinit_init_ctxt *ctxt);
    
        struct sysinit_entry {
            /* Initializes a package. */
            sysinit_init_fn *init_fn;
    
            /* Specifies when the init function gets called.  0=first, 1=next, etc. */
            uint8_t stage;
        };
    
        struct sysinit_init_ctxt {
            /* Corresponds to the init function currently executing. */
            const struct sysinit_entry *entry;
    
            /* The stage that sysinit is currently processing. */
            uint8_t cur_stage;
        };
    
        /**
         * Registers a package initialization function
         *
         * @param init_cb               Pointer to the init function to register.
         * @param init_stage            Indicates when this init function gets called,
         *                                  relative to other init functions.  0=first,
         *                                  1=next, etc.
         */
        #define SYSINIT_REGISTER_INIT(init_cb, init_stage) /* ... */
    
    EXAMPLE:
    
        static void
        my_pkg_init(struct sysinit_init_ctxt *ctxt)
        {
            /* ... */
        }
    
        SYSINIT_REGISTER(my_pkg_init, 2);
    
    X-Original-Commit: 43a5ef8860cbf4bc5bf43fde8a29fe74361536fa

 nimble/controller/include/controller/ble_ll.h      |  3 --
 nimble/controller/pkg.yml                          |  3 --
 nimble/controller/src/ble_ll.c                     |  4 ++-
 nimble/host/include/host/ble_hs.h                  |  1 -
 nimble/host/pkg.yml                                |  3 --
 .../ans/include/services/ans/ble_svc_ans.h         |  2 --
 nimble/host/services/ans/pkg.yml                   |  3 --
 nimble/host/services/ans/src/ble_svc_ans.c         |  4 ++-
 .../services/bleuart/include/bleuart/bleuart.h     |  2 --
 nimble/host/services/bleuart/pkg.yml               |  3 --
 nimble/host/services/bleuart/src/bleuart.c         |  4 ++-
 .../gap/include/services/gap/ble_svc_gap.h         |  2 --
 nimble/host/services/gap/pkg.yml                   |  3 --
 nimble/host/services/gap/src/ble_svc_gap.c         |  4 ++-
 .../gatt/include/services/gatt/ble_svc_gatt.h      |  1 -
 nimble/host/services/gatt/pkg.yml                  |  3 --
 nimble/host/services/gatt/src/ble_svc_gatt.c       |  4 ++-
 .../ias/include/services/ias/ble_svc_ias.h         |  1 -
 nimble/host/services/ias/pkg.yml                   |  3 --
 nimble/host/services/ias/src/ble_svc_ias.c         |  4 ++-
 .../tps/include/services/tps/ble_svc_tps.h         |  4 ---
 nimble/host/services/tps/pkg.yml                   |  3 --
 nimble/host/services/tps/src/ble_svc_tps.c         |  4 ++-
 nimble/host/src/ble_hs.c                           |  6 ++--
 nimble/host/store/ram/pkg.yml                      |  3 --
 nimble/host/store/ram/src/ble_store_ram.c          |  4 ++-
 nimble/transport/ram/pkg.yml                       |  3 --
 nimble/transport/ram/src/ble_hci_ram.c             |  4 ++-
 .../uart/include/transport/uart/ble_hci_uart.h     | 33 ----------------------
 nimble/transport/uart/pkg.yml                      |  3 --
 nimble/transport/uart/src/ble_hci_uart.c           |  8 +++---
 31 files changed, 34 insertions(+), 98 deletions(-)

commit 080df0af12701167063b5dc3226810bc0619e6f3
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Dec 13 18:10:15 2016 -0800

    BLE Host - Use generic fragmentation function.
    
    X-Original-Commit: 256f8b641fa354dd0a4bd4ee5026271c8ec6654f

 nimble/host/pkg.yml          |  1 +
 nimble/host/src/ble_hs_hci.c | 65 +++++---------------------------------------
 2 files changed, 8 insertions(+), 58 deletions(-)

commit 75bd912355d33fad042b24683ca112e8cd10ef19
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Dec 13 15:19:25 2016 -0800

    BLE ctlr - Fix maybe-uninitialized warning.
    
    This warning was only getting reported with the "debug" profile (-O1).
    
    X-Original-Commit: 7f8109d3330187668b722d5c53fcfa5258176c08

 nimble/controller/src/ble_ll_sched.c | 1 +
 1 file changed, 1 insertion(+)

commit 001f1144efa69be4644e8f5619887286df49c6c3
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Dec 12 15:15:17 2016 +0100

    nimble/gap: Fix for missing ble_hs_unlock
    
    Use goto done; so lock can be released properly
    
    X-Original-Commit: e527e305a0732d46ed8da72c19574fadab4170be

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 113665e2d861e7b5a6dd8019707e89a76cebc519
Author: William San Filippo <wills@runtime.io>
Date:   Tue Dec 13 11:45:56 2016 -0800

    MYNEWT-508: The ocf at the host needs to be a uint16_t.
    
    This is due to the vendor specific ocf added for multi-advertising.
    
    X-Original-Commit: 982dfa7b979221e80d76486d64bf687450095f94

 nimble/host/src/ble_hs_hci_cmd.c  | 6 +++---
 nimble/host/src/ble_hs_hci_priv.h | 4 ++--
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 572352945b8480bffa98de92229a9536067babe6
Author: William San Filippo <wills@runtime.io>
Date:   Tue Dec 13 11:41:57 2016 -0800

    MYNEWT-508: Add multiple advertising instances
    
    This commit adds the ability for the nimble controller to have
    multiple advertising instances. There were many changes to the code
    to support this feature. More on how to enable it is in the jira
    ticket.
    
    X-Original-Commit: 8c876d8c350e71026827f35868356a1af6826b46

 nimble/controller/include/controller/ble_ll_adv.h  |  46 +-
 .../controller/include/controller/ble_ll_sched.h   |  25 +-
 nimble/controller/src/ble_ll_adv.c                 | 479 ++++++++++++++++-----
 nimble/controller/src/ble_ll_conn.c                |  24 +-
 nimble/controller/src/ble_ll_conn_hci.c            |   7 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   7 +-
 nimble/controller/src/ble_ll_hci.c                 | 103 ++++-
 nimble/controller/src/ble_ll_sched.c               | 185 ++++++--
 nimble/controller/syscfg.yml                       |  11 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |   2 +-
 nimble/include/nimble/ble.h                        |   4 +
 nimble/include/nimble/hci_common.h                 |   1 +
 nimble/include/nimble/hci_vendor.h                 | 112 +++++
 nimble/syscfg.yml                                  |  10 +
 14 files changed, 817 insertions(+), 199 deletions(-)

commit 0c5700962691a73704efd6537c04c9c9d4de6173
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Dec 5 15:25:24 2016 +0100

    gattc: Fix unnecessary status overwrite in read by type err
    
    This status change is not needed. With this patch it is possible to
    pass TC_GAR_CL_BI_07_C.
    
    X-Original-Commit: c656e5a92e54e88c1d196ffbb8a5b73c9ab42129

 nimble/host/src/ble_gattc.c | 4 ----
 1 file changed, 4 deletions(-)

commit a14a00b54524a64b653fb7960eb8993ee5d95ff7
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Dec 13 18:10:15 2016 -0800

    BLE Host - Use generic fragmentation function.
    
    X-Original-Commit: f23d9430e2c8b1687f003143973fc5ae8014c610

 nimble/host/pkg.yml          |  1 +
 nimble/host/src/ble_hs_hci.c | 65 +++++---------------------------------------
 2 files changed, 8 insertions(+), 58 deletions(-)

commit 183cb6f0e489a476c91f79f57ed7ce39846ce14d
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Dec 13 15:19:25 2016 -0800

    BLE ctlr - Fix maybe-uninitialized warning.
    
    This warning was only getting reported with the "debug" profile (-O1).
    
    X-Original-Commit: 0ad8062089ca3d0525b7b1bd471ae2d67a9b589c

 nimble/controller/src/ble_ll_sched.c | 1 +
 1 file changed, 1 insertion(+)

commit 1a42c7d0ea04710f76ca469540de7533d8e23271
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Dec 12 15:15:17 2016 +0100

    nimble/gap: Fix for missing ble_hs_unlock
    
    Use goto done; so lock can be released properly
    
    X-Original-Commit: bd546f763a9b68c3a09de867845bec3a3208e88a

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d27e1e9b14e9c074ec24cc2263876fbc198c2dd5
Author: William San Filippo <wills@runtime.io>
Date:   Tue Dec 13 11:45:56 2016 -0800

    MYNEWT-508: The ocf at the host needs to be a uint16_t.
    
    This is due to the vendor specific ocf added for multi-advertising.
    
    X-Original-Commit: 5e0f1bce52c53756a2e4547be3ed1f9e4a84b3ed

 nimble/host/src/ble_hs_hci_cmd.c  | 6 +++---
 nimble/host/src/ble_hs_hci_priv.h | 4 ++--
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 681f6ac39e17fc3250d18b4f8edd9bd7836c6736
Author: William San Filippo <wills@runtime.io>
Date:   Tue Dec 13 11:41:57 2016 -0800

    MYNEWT-508: Add multiple advertising instances
    
    This commit adds the ability for the nimble controller to have
    multiple advertising instances. There were many changes to the code
    to support this feature. More on how to enable it is in the jira
    ticket.
    
    X-Original-Commit: f1924c558bb385a586f18cf313682ec6a48c449a

 nimble/controller/include/controller/ble_ll_adv.h  |  46 +-
 .../controller/include/controller/ble_ll_sched.h   |  25 +-
 nimble/controller/src/ble_ll_adv.c                 | 479 ++++++++++++++++-----
 nimble/controller/src/ble_ll_conn.c                |  24 +-
 nimble/controller/src/ble_ll_conn_hci.c            |   7 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   7 +-
 nimble/controller/src/ble_ll_hci.c                 | 103 ++++-
 nimble/controller/src/ble_ll_sched.c               | 185 ++++++--
 nimble/controller/syscfg.yml                       |  11 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |   2 +-
 nimble/include/nimble/ble.h                        |   4 +
 nimble/include/nimble/hci_common.h                 |   1 +
 nimble/include/nimble/hci_vendor.h                 | 112 +++++
 nimble/syscfg.yml                                  |  10 +
 14 files changed, 817 insertions(+), 199 deletions(-)

commit 2ff55faad58a96c0100385197ce390a661e5e079
Merge: d86ab335 aacba0c1
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Dec 13 10:21:37 2016 -0800

    This closes #132.
    
    Merge remote-tracking branch 'michal-narajowski/gattc-read-uuid-fix' into develop
    
    * michal-narajowski/gattc-read-uuid-fix:
      gattc: Fix unnecessary status overwrite in read by type err
    
    X-Original-Commit: 06251feec1f1dee430b8c806d541f5880c425421

commit d86ab335a472c692c607452896f91ced47ae7986
Merge: e921ab59 4a9cfc7e
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Dec 12 19:07:04 2016 -0800

    This closes #130.
    Merge remote-tracking branch 'andrzej-kaczmarek/nimble-fixing' into develop
    
    * andrzej-kaczmarek/nimble-fixing:
      bletiny: Add characteristic with auth required permission
      nimble/sm: Fix obvious array size mismatch
      nimble/sm: Use proper key size for encryption
      nimble/sm: Improve pairing req/rsp validation
      nimble/sm: Fix AuthReq/KeyDist validation in pairing req/rsp
      nimble/test: Remove invalid SM test cases
      nimble/test: Fix expected error for key size lower than minimum
      nimble/test: Fix expected value in ble_sm_test_util_us_fail_inval
    
    X-Original-Commit: 7c218f67ee8dcec6dd8fe755198793747bc282f4

commit e921ab590ae2be32162203c64de6ba1d60477a32
Merge: add67fa5 418e3773
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Dec 12 16:01:22 2016 -0800

    This closes #136.
    
    Merge remote-tracking branch 'michal-narajowski/redundant-includes' into develop
    
    * michal-narajowski/redundant-includes:
      Remove redundant includes
    
    X-Original-Commit: 52cfd96926fcbb37e4240dfcbaa7020583c28345

commit 4a9cfc7e627f7076b23b20ea3748383ded610eaa
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 29 11:31:01 2016 +0100

    nimble/sm: Fix obvious array size mismatch
    
    X-Original-Commit: 838b53a5c4712269edf3b747992fb8befa38412a

 nimble/host/src/ble_sm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2e98ab6ecc80255b50845de7256901369ee0bf61
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 22 23:46:31 2016 +0100

    nimble/sm: Use proper key size for encryption
    
    This patch adds proper masking of STK/LTK keys depending on encryption
    key size as defined in Bluetooth Specification 4.2, Vol 3, Part H,
    Section 2.3.4.
    
    This also fixes following PTS test cases for SM:
    - TP/EKS/BV-01-C
    - TP/EKS/BV-02-C
    
    X-Original-Commit: a034ac10ac6b02413e47f8d74652c99eae3763c3

 nimble/host/src/ble_sm.c      | 10 ++++++++--
 nimble/host/src/ble_sm_lgcy.c |  5 ++++-
 nimble/host/src/ble_sm_priv.h |  1 +
 nimble/host/src/ble_sm_sc.c   |  3 +++
 4 files changed, 16 insertions(+), 3 deletions(-)

commit ffa0636719391c464c565dbf93e2cb3427f653b1
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 22 21:09:22 2016 +0100

    nimble/sm: Improve pairing req/rsp validation
    
    The "Invalid Parameters" error code is only valid if encryption key
    size it larger than allowed maximum - if it is lower than supported
    minimum key size, the error code shall be "Encryption Key Size".
    
    Also we should accept pairing req/rsp in case either IO Capabilities
    or OOB Flags are set to reserved values by forcing either Just Works
    or discarding OOB Flags information respectively. This should allow
    to handle pairing with future specs (if reserved values are used) and
    is inline with other stacks (e.g. BlueZ, Zephyr).
    
    X-Original-Commit: 3d129607c9078bde96753208d35829e2c762e8ae

 nimble/host/src/ble_sm.c      | 12 +++++++++---
 nimble/host/src/ble_sm_cmd.c  | 21 ---------------------
 nimble/host/src/ble_sm_lgcy.c |  6 +++++-
 nimble/host/src/ble_sm_sc.c   |  6 +++++-
 4 files changed, 19 insertions(+), 26 deletions(-)

commit 29c4294df647d2000ddca5694352af9238796ccd
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Tue Nov 15 22:56:02 2016 +0100

    nimble/sm: Fix AuthReq/KeyDist validation in pairing req/rsp
    
    The reserved bits in AuthReq and key distribution flags shall be
    ignored on reception thus non-zero values do not make pairing command
    invalid. This is to ensure compatibility with future specs.
    
    This fixes following PTS test cases for SM:
    - TP/JW/BI-03-C
    - TP/JW/BI-04-C
    
    Reference:
    Bluetooth Specification 4.2, Vol 3, Part H, Section 3.5.2
    Bluetooth Specification 4.2, Vol 3, Part H, Section 3.6.1
    
    X-Original-Commit: 9627249a1fd3ce031fdca821646692adb9ebe31a

 nimble/host/src/ble_sm_cmd.c | 12 ------------
 1 file changed, 12 deletions(-)

commit 724e41d3fce590ac776ecb737c1c6b29c642c331
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Dec 11 23:47:48 2016 +0100

    nimble/test: Remove invalid SM test cases
    
    Test cases which check for pairing failing on reserved values are
    invalid since reserved values shall be ignored as required by spec and
    pairing shall succeed. These test cases will be replaced with ones that
    check for pairing success when reserved bits are used.
    
    X-Original-Commit: 2e6367caef814958f65a644c8d41df765ef98ece

 nimble/host/test/src/ble_sm_test.c | 268 +------------------------------------
 1 file changed, 2 insertions(+), 266 deletions(-)

commit 13fc8a872ebd5335b8fcebeb490d9587211d084a
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Dec 11 23:46:14 2016 +0100

    nimble/test: Fix expected error for key size lower than minimum
    
    For key size lower than minimum, an "Encryption Key Size" error shall
    be returned, not "Invalid Parameters".
    
    X-Original-Commit: c3f9aa1968a483183de60ad9a8bf43545fa0c36a

 nimble/host/test/src/ble_sm_test.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 7b56d698d50a6dfd77f8820cc36919487fa27f52
Author: Andrzej Kaczmarek <andrzej.kaczmarek@codecoup.pl>
Date:   Sun Dec 11 23:44:02 2016 +0100

    nimble/test: Fix expected value in ble_sm_test_util_us_fail_inval
    
    Value from test def should be used, not hardcoded one.
    
    X-Original-Commit: a3f6ea1de07e04e302dd442a6b72ecfdeb1aed49

 nimble/host/test/src/ble_sm_test_util.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit add67fa5086bc8cca7061793d9a3eda4a6687c8c
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 8 23:17:30 2016 -0600

    MYNEWT-346 BLE Host - Add BLE_SM_LEGACY setting.
    
    X-Original-Commit: 42d981f282369a3d9d3ee4c35dea8abfee9effd8

 nimble/host/src/ble_sm.c                |  2 +-
 nimble/host/src/ble_sm_alg.c            |  3 ++-
 nimble/host/src/ble_sm_lgcy.c           |  2 +-
 nimble/host/src/ble_sm_priv.h           |  7 +++++++
 nimble/host/syscfg.yml                  |  2 +-
 nimble/include/nimble/nimble_opt_auto.h | 13 +++----------
 6 files changed, 15 insertions(+), 14 deletions(-)

commit 2c89b0263a087f97a322315af3ec9eea53d1d817
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 8 23:15:30 2016 -0600

    BLE Host - Work around gcc bug
    
    gcc 4 was warning about an initialization:
    https://gcc.gnu.org/bugzilla/show_bug.cgi?id=53119
    
    X-Original-Commit: ac9e2e142e4602aa0126c9a0fd24e6b850e3ee52

 nimble/host/src/ble_sm.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 09fe575855b3d5999ab01d686f15fc2d5ff8a555
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 8 21:48:57 2016 -0600

    MYNEWT-349 BLE Host - API for gatt-service-changed
    
    X-Original-Commit: 1e57852633bca23d2f5fedf62f1b36f635600332

 .../gatt/include/services/gatt/ble_svc_gatt.h      |  3 ++
 nimble/host/services/gatt/src/ble_svc_gatt.c       | 32 ++++++++++++++++++----
 2 files changed, 29 insertions(+), 6 deletions(-)

commit cba839a9e1de7a241b5cbc671f0a845875e221a9
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 8 16:20:03 2016 -0600

    MYNEWT-383 BLE Host - Allow programmatic unbonding
    
    X-Original-Commit: 71503c55a9f0e41ec8ba18c35be71c7a73aaded3

 nimble/host/include/host/ble_sm.h       |  1 +
 nimble/host/src/ble_sm.c                | 36 ++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.c | 46 +++++++++++++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.h |  2 ++
 nimble/host/test/src/ble_sm_test_util.c | 44 +++++++++++++++++++++++++++++++
 5 files changed, 129 insertions(+)

commit fc88453f2504f31514791d7d35941279d3b99607
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 8 10:33:48 2016 -0600

    MYNEWT-383 - BLE Host - use ram store in unittests
    
    Previously, the unit tests were using a custom store implementation.
    This resulted in needless code duplication.  Now the tests use the
    standard RAM store.
    
    X-Original-Commit: 1eef1ae59f3c4a1e4670278b6901ffd425cf6185

 nimble/host/test/pkg.yml                      |   1 +
 nimble/host/test/src/ble_gatts_notify_test.c  |  18 +-
 nimble/host/test/src/ble_hs_test_util.c       |  72 ++++++++
 nimble/host/test/src/ble_hs_test_util.h       |   2 +-
 nimble/host/test/src/ble_hs_test_util_store.c | 248 --------------------------
 nimble/host/test/src/ble_hs_test_util_store.h |  44 -----
 nimble/host/test/src/ble_sm_test_util.c       |  34 +---
 7 files changed, 83 insertions(+), 336 deletions(-)

commit 026329daea4d025404aa02bea5c4e1709eddbe80
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 8 10:28:18 2016 -0600

    MYNEWT-383 BLE Host - Deletion from ram store.
    
    Previously, deleting security material from the RAM store was not
    implemented.
    
    X-Original-Commit: ed6b9c56dbb5383daf83c8edff2dc25e36234926

 nimble/host/include/host/ble_store.h               |   2 +
 nimble/host/src/ble_store.c                        |  63 +++++-------
 .../store/ram/include/store/ram/ble_store_ram.h    |   1 +
 nimble/host/store/ram/src/ble_store_ram.c          | 113 +++++++++++++++++++--
 4 files changed, 137 insertions(+), 42 deletions(-)

commit 418e377308306cce4434b02772d6e73c0b48a13b
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Wed Dec 7 12:55:19 2016 +0100

    Remove redundant includes
    
    X-Original-Commit: c2e3a1bc962747411c56a090577211b2f10ef029

 nimble/host/include/host/ble_hs.h          | 1 -
 nimble/host/test/src/ble_gatt_write_test.c | 1 -
 2 files changed, 2 deletions(-)

commit aacba0c105e5320d1e395809ef101004316adc58
Author: Michał Narajowski <michal.narajowski@codecoup.pl>
Date:   Mon Dec 5 15:25:24 2016 +0100

    gattc: Fix unnecessary status overwrite in read by type err
    
    This status change is not needed. With this patch it is possible to
    pass TC_GAR_CL_BI_07_C.
    
    X-Original-Commit: b8d59715c8f4fd2a4b82d632cfe1188e1e969449

 nimble/host/src/ble_gattc.c | 4 ----
 1 file changed, 4 deletions(-)

commit fb4d413f84967eca045b44584f4b23be5bb23a1a
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Dec 2 15:17:30 2016 -0800

    BLE Host - Don't send l2cap error to unconn. peer.
    
    X-Original-Commit: 63ce485ff30bbea7b6833d9ad3ef5a6631a56bba

 nimble/host/src/ble_hs_hci_evt.c      |  3 +++
 nimble/host/test/src/ble_l2cap_test.c | 18 ++++++++++++++++++
 2 files changed, 21 insertions(+)

commit 77bdd0f35dbeff3ece3685ce1b0f52db03196123
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Dec 2 12:50:52 2016 -0800

    MYNEWT-487 BLE Host - Execute GATT proc cb on tmo.
    
    X-Original-Commit: ec16344c9dcfb4de487a172a8335cbc0341d3723

 nimble/host/src/ble_gattc.c                 | 215 +++++++++++++++++++++++++++-
 nimble/host/test/src/ble_gatt_conn_test.c   | 177 +++++++++++++----------
 nimble/host/test/src/ble_gatt_disc_s_test.c |   4 +
 3 files changed, 318 insertions(+), 78 deletions(-)

commit 0a10e867a79d52df1e33ffb7d954f5a01de15262
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Dec 2 11:23:58 2016 -0800

    MYNEWT-324 BLE Host - Don't use req buf for wr.rsp
    
    Never reuse the request mbuf for a write response.  The rationale is
    explained in the comment below:
    
    /**
     * Notes on buffer reuse:
     * Most request handlers reuse the request buffer for the reponse.  This
     * is done to prevent out-of-memory conditions.  However, there are two
     * handlers which do not reuse the request buffer:
     *     1. Write request.
     *     2. Indicate request.
     *
     * Both of these handlers attempt to allocate a new buffer for the
     * response prior to processing the request.  If allocation fails, the
     * request is not processed, and the request buffer is reused for the
     * transmission of an "insufficient resources" ATT error response.
     * These handlers don't reuse the request mbuf for an affirmative
     * response because the buffer contains the attribute data that gets
     * passed to the application callback.  The application may choose to
     * retain the mbuf during the callback, so the stack
     */
    
    X-Original-Commit: 9f9377088815bd987564064c433d43552ad3e1ef

 nimble/host/src/ble_att_svr.c           | 62 +++++++++++++++++++++------------
 nimble/host/test/src/ble_att_svr_test.c |  9 ++---
 2 files changed, 45 insertions(+), 26 deletions(-)

commit c1acf207a6447e460657edb9c05e650056c7fe55
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 1 18:32:20 2016 -0800

    BLE Host - rename BLE_ATT_MAX_PREP_ENTRIES
    
    Rename BLE_ATT_MAX_PREP_ENTRIES to BLE_ATT_SVR_MAX_PREP_ENTRIES.  The
    new name is consistent with the other settings.
    
    X-Original-Commit: e679552c15d00b8164bccb408e207d2b6c8f55e6

 nimble/host/src/ble_att_svr.c | 6 +++---
 nimble/host/syscfg.yml        | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 6c83f647e6a758bb80ae46f3601de3f7ace10644
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 1 18:25:46 2016 -0800

    MYNEWT-353 BLE Host - Timeout for ATT queued write
    
    If a queued write is only partially received, and 30 seconds has passed
    since the last prepare write was received, a timeout occurs.  When this
    happens, the connection is terminated.
    
    X-Original-Commit: 198143989112b3b55f1d50619c938e3b34fc63f9

 nimble/host/src/ble_att_priv.h          |  4 ++-
 nimble/host/src/ble_att_svr.c           | 40 +++++++++++++++++++++
 nimble/host/src/ble_gap.c               | 10 +++++-
 nimble/host/src/ble_hs.c                |  2 +-
 nimble/host/src/ble_hs_conn.c           | 50 ++++++++++++++++++++++-----
 nimble/host/src/ble_hs_priv.h           |  8 +++++
 nimble/host/src/ble_l2cap.c             |  6 +++-
 nimble/host/src/ble_l2cap_priv.h        |  2 --
 nimble/host/syscfg.yml                  | 13 +++++++
 nimble/host/test/src/ble_att_svr_test.c | 61 ++++++++++++++++++++++++++++++++-
 nimble/host/test/src/ble_l2cap_test.c   |  8 ++---
 11 files changed, 184 insertions(+), 20 deletions(-)

commit 55449f2c9c75cdc0bc8a30410667830fc26421e9
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 1 18:25:08 2016 -0800

    BLE Host - Combine PREP_WRITE, EXEC_WRITE syscfg
    
    This commit combines the BLE_ATT_SVR_PREP_WRITE and
    BLE_ATT_SVR_EXEC_WRITE syscfg settings into one:
    BLE_ATT_SVR_QUEUED_WRITE.
    
    It didn't make sense to support one without the other.
    
    X-Original-Commit: defd62a78d62563a151b1efdac9e68491b02fde3

 nimble/host/src/ble_att_svr.c | 4 ++--
 nimble/host/syscfg.yml        | 9 ++++-----
 2 files changed, 6 insertions(+), 7 deletions(-)

commit 3f896c99215093ed24f1d05d8de055daa4c7a31c
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 1 16:39:05 2016 -0800

    BLE Host - Fix SM unit test.
    
    This test was testing two things at once; it should only be testing one.
    
    X-Original-Commit: 80f4e7f167ba66664010bdecc6ca1690782cf88d

 nimble/host/test/src/ble_sm_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d74ca6c49ed40ba088720e82358c3b30e5cb5354
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Dec 1 16:35:59 2016 -0800

    MYNEWT-341 BLE Host - Handle missing ACL fragments
    
    If a packet is only partially received, and 30 seconds has passed since
    the last fragment was received, a timeout occurs.  When this happens,
    the connection is terminated.
    
    X-Original-Commit: 0d402e54aa6d0fa24f31eebac15038b1d00b969b

 nimble/host/src/ble_hs.c                |  9 +++--
 nimble/host/src/ble_hs_conn.c           | 61 +++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_conn_priv.h      |  3 ++
 nimble/host/src/ble_l2cap.c             |  2 ++
 nimble/host/src/ble_l2cap_priv.h        |  2 ++
 nimble/host/test/src/ble_hs_conn_test.c |  6 ++--
 nimble/host/test/src/ble_l2cap_test.c   | 46 +++++++++++++++++++++++++
 7 files changed, 124 insertions(+), 5 deletions(-)

commit a571a311037d1e65bc3afe4796dd5a9d311f6a82
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 30 14:44:34 2016 -0800

    MYNEWT-491 Prevent repeated package initialization
    
    A function can ensure it only gets called during system initialization
    by invoking the SYSINIT_ASSERT_ACTIVE() macro.  If the function gets
    called outside of sysinit, a failed assert is triggered.
    
    X-Original-Commit: 259c670486422dd9beb891d403e700af08189eb6

 nimble/controller/src/ble_ll.c               | 3 +++
 nimble/host/services/ans/src/ble_svc_ans.c   | 3 +++
 nimble/host/services/bleuart/src/bleuart.c   | 3 +++
 nimble/host/services/gap/src/ble_svc_gap.c   | 3 +++
 nimble/host/services/gatt/src/ble_svc_gatt.c | 3 +++
 nimble/host/services/ias/src/ble_svc_ias.c   | 3 +++
 nimble/host/services/tps/src/ble_svc_tps.c   | 3 +++
 nimble/host/src/ble_hs.c                     | 3 +++
 nimble/host/store/ram/src/ble_store_ram.c    | 4 ++++
 nimble/transport/ram/src/ble_hci_ram.c       | 3 +++
 nimble/transport/uart/src/ble_hci_uart.c     | 6 +++++-
 11 files changed, 36 insertions(+), 1 deletion(-)

commit ef72e30f5e4fbb515d97571a4c69f22af3e5e9ef
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 28 23:43:03 2016 +0100

    nimble/l2cap: Fix for L2CAP connection parameters update
    
    If GAP does not accept parameters (core spec requirements),
    BLE_L2CAP_SIG_OP_UPDATE_RSP with a reason
    BLE_L2CAP_SIG_UPDATE_RSP_RESULT_REJECT shell be sent back to the
    remote device.
    
    This patch fixes PTS test cases TC_LE_CPU_BI_01_C,TC_LE_CPU_BV_02_C.
    
    X-Original-Commit: 6dc0292935290a95c4d1f37cf13c25e69a57478a

 nimble/host/src/ble_l2cap_sig.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit b592c4c22578eed03e4194f1fbdd6774ebf419ce
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 28 23:41:40 2016 +0100

    nimble/gap: Add check for connection parameters
    
    With this patch GAP will make sure that requested connection parameters
    are valid. If not BLE_HS_EINVAL will be returned
    
    X-Original-Commit: 3e8cbec34ba02cfcce901a84069bcdf2d1fb2f12

 nimble/host/src/ble_gap.c | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)

commit 0e412cb5b1e7007bd2ec0da25e2fce180857f354
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 28 16:32:33 2016 +0100

    nimble/l2cap: Minor flow refactor of ble_l2cap_sig_update_req_rx
    
    With this patch we exit this function immediately in case device
    is not a master on the link.
    
    X-Original-Commit: 9cacc49af745404111697d13b857c1bd6b61cd2a

 nimble/host/src/ble_l2cap_sig.c | 50 ++++++++++++++++++++---------------------
 1 file changed, 24 insertions(+), 26 deletions(-)

commit a9dc06ac324a3ddbe4a9990f1bec46452df8407a
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 28 16:12:10 2016 +0100

    nimble/l2cap: Fix L2CAP command not understood handling
    
    Since BLE_L2CAP_SIG_ERR_CMD_NOT_UNDERSTOOD is 0x0,
    BLE_HS_L2C_ERR(BLE_L2CAP_SIG_ERR_CMD_NOT_UNDERSTOOD)
    also gives 0x0 which makes this error not possible to distinguish from
    a success case which has value 0x0. For this reason we start to use
    BLE_HS_EREJECT instead BLE_HS_L2C_ERR(BLE_L2CAP_SIG_ERR_CMD_NOT_UNDERSTOOD).
    
    X-Original-Commit: 8ddcb0b846da853b2a09b0f39856f16254432ded

 nimble/host/src/ble_l2cap_sig.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 3a820bd176434b6a13373ac41ec9366bf5fbb1e1
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 28 15:07:01 2016 +0100

    nimble/l2cap: Fix for handling unknown L2CAP signaling commands
    
    With this patch, all unsupported signaling commands are rejected with
    a reason "command not understood".
    
    Note that with this patch reject command goes from a single place for
    signaling commands.
    
    This patch is a fix for qualification test TC_LE_REJ_BI_02
    
    X-Original-Commit: 63c20682e5acb8fbd7ec6928364d30aa965e90c8

 nimble/host/src/ble_l2cap_sig.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit f58ce79355bf579dc0842330181752f31747e334
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Tue Nov 29 22:54:15 2016 +0100

    nimble/l2cap: Fix for handling unknown response
    
    According to BT Spec.v4.2 [Vol 3, Part A], command response with
    unknown identifier shall be silently ignored.
    For this reason we return 0 as next patches will start to send
    "command not understood" in case of error.
    
    Unit test updated accordingly.
    
    X-Original-Commit: 9db957a5e70b97418fe65803f344a640a6e18f93

 nimble/host/src/ble_l2cap_sig.c       | 2 +-
 nimble/host/test/src/ble_l2cap_test.c | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 9328405b2b8bd6cd51e7235cc3ffb862283060ab
Author: Łukasz Rymanowski <lukasz.rymanowski@codecoup.pl>
Date:   Mon Nov 28 15:03:07 2016 +0100

    nimble/l2cap: Fix for l2cap rx handles
    
    This patch makes sure that ble_l2cap_sig_dispatch_get always returns
    valid data.
    
    X-Original-Commit: 0850fcda110a44d61926cf7619a51f60b58d4e6f

 nimble/host/src/ble_l2cap_sig.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 80233c94215ee3314a0a32e6c9fdafa9aec9d110
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 28 16:17:25 2016 -0800

    MYNEWT-324 BLE Host - Reuse rxbuf for MTU rsp.
    
    More diligent reuse of reuest buffers.
    
    X-Original-Commit: 28c48007e05eb3590d8104c13319968b8164226f

 nimble/host/src/ble_att_svr.c           | 109 ++++++-----
 nimble/host/test/src/ble_att_svr_test.c | 328 ++++++++++----------------------
 nimble/host/test/src/ble_hs_test_util.c | 116 +++++++++++
 nimble/host/test/src/ble_hs_test_util.h |  17 ++
 4 files changed, 286 insertions(+), 284 deletions(-)

commit 5b4fac9c5d05284f1fd20c57e264580ba047bf2e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 23 14:48:34 2016 -0800

    MYNEWT-324 BLE Host - Reuse inbuf for error rsp.
    
    Add remaining unit tests.
    
    X-Original-Commit: 1ad17c8c9c8bdfea4c03cab9487935e363054d50

 nimble/host/test/src/ble_att_svr_test.c | 644 +++++++++++++-------------------
 nimble/host/test/src/ble_hs_test_util.c | 293 ++++++++++++++-
 nimble/host/test/src/ble_hs_test_util.h |  59 ++-
 3 files changed, 596 insertions(+), 400 deletions(-)

commit 5c9455a69350b974999f7394475526fdce4ad22d
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 23 14:46:33 2016 -0800

    BLE Host - On rx indicate, allocate rsp first.
    
    Don't process the indicate command until after we have successfully
    allocated a response.  If response allocation fails, then reply with an
    "insufficient resources" ATT error and throw away the indication.
    Indicates are a bit different from other ATT commands because the
    request is forwarded to the application as a GAP event, so we can't
    reuse the request mbuf in the response.
    
    X-Original-Commit: be0d6430de7762d226413a2efe9a0124f86b3a8f

 nimble/host/src/ble_att_svr.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit df09860e6a3dc126831a7581b3f63afa75aa265a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 23 14:45:08 2016 -0800

    BLE Host - Differentiate prep-q-full / insuf. res.
    
    There are still some decisions to be made here.  If we receive a
    subsequent prep write command, and we have no mbufs, is it a prepare
    queue full or insufficient resources error?
    
    X-Original-Commit: fc4c950f6285af66df5b9ad10969d27c2fe8fb97

 nimble/host/src/ble_att_svr.c | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

commit e62ef98f665c24d120b28ce8c4f3b42b12905441
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 23 14:43:43 2016 -0800

    MYNEWT-324 BLE Host - Reuse rxbuf for write rsp..
    
    The write response is smaller than the request, so it is safe to assume
    it will fit in the buffer.
    
    X-Original-Commit: ed2ff11166a38b162f6eb59cbeff720b2b66bf30

 nimble/host/src/ble_att_svr.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 3d893ba06441ed754932d50c3937f5b99ac0f21d
Merge: 056f300f 35e33a17
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 23 10:37:04 2016 -0800

    Merge branch '1_0_0_b1_dev' into develop
    
    X-Original-Commit: 5c42d5037ee12868a53d9b2cf5d461af8c51d87a

commit 35e33a173e1c38bc17b0ec09a879fec7be5f615f
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 22 17:42:42 2016 -0800

    BLE Host - Fix warning reported by gcc 6.
    
    X-Original-Commit: c6a8f88f6b8dc7c8eee6dc75a34c9b6ea295b05d

 nimble/host/test/src/ble_hs_test_util.c | 3 ---
 1 file changed, 3 deletions(-)

commit 056f300fea94cda5c9ea7f6f6e401ead0ee60764
Merge: e6639618 8344172d
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Nov 22 12:02:37 2016 -0800

    Merge branch '1_0_0_b1_dev' of https://git-wip-us.apache.org/repos/asf/incubator-mynewt-core into develop
    
    X-Original-Commit: c55703d89f467b1decae885c57042c4a21bdcd78

commit e6639618c9a2ede71e74a9c03557dd659e0dcb29
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 18 19:06:44 2016 -0800

    MYNEWT-324 BLE Host - Reuse inbuf for error rsp.
    
    Not all unit tests are done yet.
    
    X-Original-Commit: a6e55c8d7c8cd8b7d33f0f42332fd048afc8b74e

 nimble/host/src/ble_att_svr.c           | 148 ++++++++++++++++++--------------
 nimble/host/test/src/ble_att_svr_test.c | 126 +++++++++++++++------------
 nimble/host/test/src/ble_gap_test.c     |   7 +-
 nimble/host/test/src/ble_hs_test_util.c |  36 +++++++-
 nimble/host/test/src/ble_hs_test_util.h |   7 +-
 5 files changed, 197 insertions(+), 127 deletions(-)

commit 8344172deff0e6c6ccd5e2fc16089fe07beb5d26
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 18 16:46:33 2016 -0800

    BLE Host - ble_att_clt_tx_read_type() return bad.
    
    This function always returned success regardless of the outcome.
    
    X-Original-Commit: 8f8d26a7b406cb85369cd488d2afbe44447159a7

 nimble/host/src/ble_att_clt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1901d083cdfae0fcd49443a1e4c31d1154e1a910
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 18 16:51:42 2016 -0800

    MYNEWT-339 BLE host - Retry GATT on mbuf exhaust.
    
    Unit tests for this fix.
    
    X-Original-Commit: 1114831ea4ef88d8a60d1218a1503646137a1247

 nimble/host/test/src/ble_gatt_disc_c_test.c | 196 ++++++++++++++++++++++
 nimble/host/test/src/ble_gatt_disc_d_test.c | 107 +++++++++++-
 nimble/host/test/src/ble_gatt_disc_s_test.c | 249 +++++++++++++++++++++++++++-
 nimble/host/test/src/ble_gatt_find_s_test.c | 104 ++++++++++++
 nimble/host/test/src/ble_gatt_read_test.c   |  95 +++++++++++
 nimble/host/test/src/ble_gatt_write_test.c  | 198 ++++++++++++++++++++++
 nimble/host/test/src/ble_hs_test_util.c     |  34 ++++
 nimble/host/test/src/ble_hs_test_util.h     |   1 +
 8 files changed, 981 insertions(+), 3 deletions(-)

commit 203139e138598005e0721f14c6fdbd29124eec9d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 16:06:34 2016 -0800

    MYNEWT-339 BLE host - Retry GATT on mbuf exhaust.
    
    If a GATT transmission fails due to mbuf exhaustion, the procedure is
    marked as stalled.  The host attempts to resume stalled procedures once
    per second (configurable: BLE_GATT_RESUME_RATE).
    
    X-Original-Commit: 984cebdff768945a0cd5dee55c0cc66b94a27899

 nimble/host/src/ble_att.c          |   4 +-
 nimble/host/src/ble_att_cmd_priv.h |   2 +
 nimble/host/src/ble_gatt_priv.h    |   6 +
 nimble/host/src/ble_gattc.c        | 763 +++++++++++++++++++++++++++----------
 nimble/host/syscfg.yml             |  13 +-
 5 files changed, 583 insertions(+), 205 deletions(-)

commit df231b9ad39475ca8b37d0052fc6fdf0744585de
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 18 16:46:33 2016 -0800

    BLE Host - ble_att_clt_tx_read_type() return bad.
    
    This function always returned success regardless of the outcome.
    
    X-Original-Commit: d13fe65b7246ec5e411c32c3f4242312c1cd143f

 nimble/host/src/ble_att_clt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 054db93011f9aed6c6283b9b759b530ac79ad52c
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 11:22:23 2016 -0800

    BLE Host - Don't allow ATT tx to unconnected peer
    
    The ATT client transmit function (ble_att_clt_tx_req) assumed the
    specified connection handle was valid, and proceded to dereference some
    null pointers.
    
    Now, the function returns BLE_HS_ENOTCONN immediately if the specified
    connection handle is not valid.
    
    X-Original-Commit: 68e8ec557151dff701b3014146c6682b1364d52d

 nimble/host/src/ble_att_clt.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 3aaef502bc7705b2f793b5df351cc2563c14fc6e
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 12:31:41 2016 -0800

    BLE Host - Increase max ATT MTU to 527 (was: 240).
    
    Now that there are no restrictions or known bugs involving transmission
    of chained mbufs, we can lift the artificial ceiling on ATT MTU.
    
    The new number, 527, was derived as follows:
        * Largest ATT command, signed write: 15 + attribute length.
        * Max attribute size: 512
        * 15 + 512 = 527
    
    X-Original-Commit: 8813bdf0040cb9a6583e1d4f7003293545631e77

 nimble/host/include/host/ble_att.h | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

commit 881f6bc7050a6fadda46ab06c97a69f753b11d48
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 12:25:16 2016 -0800

    BLE Host - Don't send overly-large ACL data pkts.
    
    The host was misinterpreting the buffer size that the controller
    indicates in its response to the LE Read Buffer Size HCI command.
    Specifically, the host interpreted the value as the number of bytes it
    can put in an ACL payload.  This is wrong; the value is the total size
    of an ACL data packet, including the ACL data header.
    
    The fix is to reduce the maximum number of data bytes the host includes
    in an ACL data packet by four (size of an ACL data header).
    
    X-Original-Commit: b4c9f850d8562f9f1201728476546540243ba7c1

 nimble/host/src/ble_hs_hci.c            | 18 +++++++++++++++---
 nimble/host/test/src/ble_hs_test_util.c |  4 ++--
 2 files changed, 17 insertions(+), 5 deletions(-)

commit be9412600ef81472a2ac90a14073e83210c5548e
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 12:15:10 2016 -0800

    BLE Host - whitespace fix.
    
    X-Original-Commit: f31fbdd4f918c541548a8af2035f98a4e315dead

 nimble/transport/ram/src/ble_hci_ram.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2167619a18613b9d2845907f0971436be50f330e
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 11:22:23 2016 -0800

    BLE Host - Don't allow ATT tx to unconnected peer
    
    The ATT client transmit function (ble_att_clt_tx_req) assumed the
    specified connection handle was valid, and proceded to dereference some
    null pointers.
    
    Now, the function returns BLE_HS_ENOTCONN immediately if the specified
    connection handle is not valid.
    
    X-Original-Commit: 0d77b691a3367ddf37d3ea0a7c0e08e0ace4fa3c

 nimble/host/src/ble_att_clt.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit f85ee0bedcf91657c079b77d8a85a1bf80c1b33d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 10:21:47 2016 -0800

    BLE Host - Allow tx of chained mbufs.
    
    Prior to this change, the host would only send single contiguous mbufs
    to the controller.  This behavior came from a requirement in the
    controller that has since been removed.
    
    Now the host sends mbuf chains as necessary.
    
    X-Original-Commit: 88fcc21b33e798cf519261b1356e30b43234c594

 nimble/host/src/ble_hs_hci.c | 11 -----------
 1 file changed, 11 deletions(-)

commit 55224e4050206037aeecba5c861eac0b6aee843f
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 17 10:00:54 2016 -0800

    BLE Host - Remove debug console_printf.
    
    X-Original-Commit: 4cccad0c81e030f5b34e99fa77c9eee0efbd8507

 nimble/host/src/ble_hs.c | 1 -
 1 file changed, 1 deletion(-)

commit a927645bc956e9206af4bb2d4d206a274141e928
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 16 18:31:10 2016 -0800

    BLE Host - Add test for interrupted indicate.
    
    X-Original-Commit: 50871d1a6c32dcc0a6725ea2bd44d05adb1c6366

 nimble/host/test/src/ble_gatt_conn_test.c | 44 +++++++++++++++++++++++++++----
 1 file changed, 39 insertions(+), 5 deletions(-)

commit ee4b0a6bdcd89ace6c68c979d35455d6b25f1ab2
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 16 18:11:35 2016 -0800

    BLE Host - Unit tests for GATT timeouts.
    
    X-Original-Commit: 85e6f3ca290c42ce1893837710676507d9b13746

 nimble/host/src/ble_hs_hci_cmd.c          |   2 +-
 nimble/host/test/src/ble_gatt_conn_test.c | 159 +++++++++++++++++++++++++++++-
 nimble/host/test/src/ble_hs_test_util.c   |  32 +++++-
 nimble/host/test/src/ble_hs_test_util.h   |   3 +
 4 files changed, 188 insertions(+), 8 deletions(-)

commit 360acb1da0792413bfef1f12998f9f5b963ed36c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 16 16:29:44 2016 -0800

    BLE Host - Eliminate spurious time expirations.
    
    Prior to this change, the host timer would expire at least once per
    second to clean up expired procedures.  This approach was used in lieu
    of more diligent bookkeeping.  Functionally, this is OK, since these
    timers don't need to be particularly precise.  However, this approach is
    bad for power management, as it requires the processor to periodically
    wake up from deep sleep when there is no work to do.
    
    X-Original-Commit: d0cc83304baacb1626a5540323316bf9a6f094ed

 nimble/host/src/ble_gap.c           |  69 +++++++++++------------
 nimble/host/src/ble_gap_priv.h      |   2 +-
 nimble/host/src/ble_gatt_priv.h     |   2 +-
 nimble/host/src/ble_gattc.c         |  46 ++++++++++------
 nimble/host/src/ble_hs.c            | 106 +++++++++++++++++++-----------------
 nimble/host/src/ble_hs_priv.h       |   2 +-
 nimble/host/src/ble_l2cap_sig.c     |  10 +---
 nimble/host/src/ble_sm.c            |  43 +++++++++------
 nimble/host/src/ble_sm_priv.h       |   4 +-
 nimble/host/test/src/ble_gap_test.c |  28 +++++-----
 10 files changed, 161 insertions(+), 151 deletions(-)

commit 7e04a3709633464362dc52a0e5a49344ea39560a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 16 16:16:27 2016 -0800

    BLE Host - L2CAP intrnl API chg: handle, not ptrs.
    
    This addresses a glaring inconsistency in the NimBLE host.  All other
    transmit functions accepted a connection handle and a payload.  The
    L2CAP tx functions were different; rather than taking a connection
    handle, they took pointers to a connection and L2CAP channel.
    
    A related difference was that the L2CAP tx functions required the caller
    to lock the host mutex, while the other tx functions locked the mutex
    themselves.
    
    Now the L2CAP tx functions resemble the others:
        * they take a connection handle.
        * they lock the host mutex themselves.
    
    X-Original-Commit: 2fcb28b27637886d7884e1f38dfc305f791aa665

 nimble/host/src/ble_hs_hci_evt.c        | 18 ++++---
 nimble/host/src/ble_l2cap.c             | 44 +++++++++++++---
 nimble/host/src/ble_l2cap_priv.h        |  3 +-
 nimble/host/src/ble_l2cap_sig.c         | 92 ++++++++++++++++++++-------------
 nimble/host/src/ble_l2cap_sig_cmd.c     | 37 ++++++++-----
 nimble/host/src/ble_l2cap_sig_priv.h    | 15 ++----
 nimble/host/test/src/ble_hs_test_util.c |  7 ++-
 7 files changed, 140 insertions(+), 76 deletions(-)

commit 8c0f6dc2ead580464d02f6e38d3191ced071f9e7
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 14 10:57:52 2016 -0800

    BLE Host - Compilation error for SC without DEBUG.
    
    X-Original-Commit: a38b75732363899ab24cf1a47de5aa9a4e778c62

 nimble/host/src/ble_sm_sc.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c0215bf6b5ec4f3b9a54eab98086b7fbacbf785e
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 14 16:25:37 2016 -0800

    BLE Host - Remove unused sc bit from persisted sec
    
    X-Original-Commit: 03c38d938dbcb4a0aa4b5fac90949fa9b8f097f0

 nimble/host/include/host/ble_store.h | 1 -
 nimble/host/src/ble_sm.c             | 1 -
 2 files changed, 2 deletions(-)

commit a57182e572df3e4c33271e91cd1ede3ee6615cd4
Author: William San Filippo <wills@runtime.io>
Date:   Mon Nov 14 15:48:41 2016 -0800

    MYNEWT-486: Further fixes for ACL data buffer size/count.
    
    While not exactly related to the ACL data buffer size, when
    testing the controller-only blehci code we noticed that the number
    of ACL buffers being reported by the controller and what was sent
    to the host in the read buffer size command were not the same.
    These changes address that issue.
    
    X-Original-Commit: 0874dceae14dbc8301bed36a104f7c3f249dba49

 nimble/controller/src/ble_ll.c           |  4 ++--
 nimble/controller/syscfg.yml             |  9 ---------
 nimble/transport/ram/syscfg.yml          | 10 ++++++++++
 nimble/transport/uart/src/ble_hci_uart.c |  6 +++---
 nimble/transport/uart/syscfg.yml         | 21 ++++++++++++++++-----
 5 files changed, 31 insertions(+), 19 deletions(-)

commit 6c0fed1ed1e9679f42f5d238ab4d1242fa3bd2c3
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 14 10:57:52 2016 -0800

    BLE Host - Compilation error for SC without DEBUG.
    
    X-Original-Commit: aa214cc43300267a1b948fbe458e586bc2d10279

 nimble/host/src/ble_sm_sc.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 0ee85e3132b52137256d646b251f1f451446fa71
Author: William San Filippo <wills@runtime.io>
Date:   Mon Nov 14 09:21:27 2016 -0800

    MYNEWT-486: Controller cannot accept ACL data packets > 255 bytes.
    
    X-Original-Commit: 4660b41c84b60a1f3f7b9d23771b2d025e7ab531

 nimble/controller/syscfg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit cf03abdde2b411417bff4dd6970ff8eccd519d08
Author: William San Filippo <wills@runtime.io>
Date:   Fri Nov 11 16:21:32 2016 -0800

    MYNEWT-336: Allow for smaller mbufs in nimble.
    
    The controller should now support the usage of smaller mbufs.
    Please read the Jira ticket for more information regarding mbuf
    usage by the controller and nimble. The major change associated
    with this commit was fixing a routine that was called when data
    packets where enqueued to a connection. The code was assuming
    that all the data was in one mbuf and was overwriting the first
    mbuf in the chain with the total mbuf chain length (the packet
    header length). Also modified the bletest code to create chained
    mbufs if the total packet length being sent exceeded a single mbuf.
    
    X-Original-Commit: ba2c6fc68073103bf04b75d59f4bb40941fb1f4c

 nimble/controller/include/controller/ble_ll_adv.h  |  1 +
 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll.c                     |  5 +++++
 nimble/controller/src/ble_ll_adv.c                 |  5 +++--
 nimble/controller/src/ble_ll_conn.c                | 16 ++++++++++++----
 nimble/controller/src/ble_ll_scan.c                |  2 +-
 nimble/include/nimble/ble.h                        |  8 +-------
 nimble/transport/uart/src/ble_hci_uart.c           | 17 ++++++++---------
 8 files changed, 32 insertions(+), 23 deletions(-)

commit 9a8fe37b04c77f34c20242503570184b278936c7
Author: William San Filippo <wills@runtime.io>
Date:   Fri Nov 11 16:21:32 2016 -0800

    MYNEWT-336: Allow for smaller mbufs in nimble.
    
    The controller should now support the usage of smaller mbufs.
    Please read the Jira ticket for more information regarding mbuf
    usage by the controller and nimble. The major change associated
    with this commit was fixing a routine that was called when data
    packets where enqueued to a connection. The code was assuming
    that all the data was in one mbuf and was overwriting the first
    mbuf in the chain with the total mbuf chain length (the packet
    header length). Also modified the bletest code to create chained
    mbufs if the total packet length being sent exceeded a single mbuf.
    
    X-Original-Commit: de4784827da2128a4bbec78397a986ff9c0a3773

 nimble/controller/include/controller/ble_ll_adv.h  |  1 +
 nimble/controller/include/controller/ble_ll_scan.h |  1 +
 nimble/controller/src/ble_ll.c                     |  5 +++++
 nimble/controller/src/ble_ll_adv.c                 |  5 +++--
 nimble/controller/src/ble_ll_conn.c                | 16 ++++++++++++----
 nimble/controller/src/ble_ll_scan.c                |  2 +-
 nimble/include/nimble/ble.h                        |  8 +-------
 nimble/transport/uart/src/ble_hci_uart.c           | 17 ++++++++---------
 8 files changed, 32 insertions(+), 23 deletions(-)

commit 0bbf36b07686b1c1f7b169a4ac7cb5335dc34442
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Nov 11 11:27:06 2016 -0800

    ble uart transport - Add mising init function.
    
    The package was never getting initialized by sysinit.
    
    X-Original-Commit: bedb31d42728c78babeb3aa451227c25dcbb3e02

 nimble/transport/uart/pkg.yml | 3 +++
 1 file changed, 3 insertions(+)

commit 736168d7ce12ceed7ddd0aa46e432fc9eb41b4cc
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 10 17:48:42 2016 -0800

    ble_store_ram - Set the persist callbacks on init.
    
    Before this change, the app had to set the callbacks manually.  Now, the
    callbacks get set automatically by sysinit.
    
    X-Original-Commit: f6992258335baea527a48f28a3b543c286993828

 nimble/host/store/ram/pkg.yml             | 3 +++
 nimble/host/store/ram/src/ble_store_ram.c | 7 +++++++
 2 files changed, 10 insertions(+)

commit d6e425e4a0736975ef865b5cd42937d8ca11c341
Merge: d5df41f6 a993eeb8
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Nov 10 11:06:24 2016 -0800

    Merge remote-tracking branch 'apache/master' into develop
    
    X-Original-Commit: 406eeb0c2fc736f3a13c8d7320c0b65eb44474c4

commit d5df41f6d6cc79cc5b50a1b9b1c1a4266168a72c
Author: William San Filippo <wills@runtime.io>
Date:   Wed Nov 9 16:48:06 2016 -0800

    The ACL data packet length being reported by the LE read buffer size
    command included the HCI ACL data packet header. Well, there still
    needs more work to be done here to reconcile the constants being
    used, but the current code could have caused issues. We now
    report a ACL data packet length of 256 bytes.
    
    X-Original-Commit: d476d026c24c81abf0fd2336abf1e9ccbf35e394

 nimble/controller/syscfg.yml | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 18f92a724350ac8ad960f39d1577cd06f1f55abb
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Nov 9 15:54:52 2016 -0800

    License audit
    
    Add apache licenses where needed; augment .rat-excludes for
    third-party packages.
    
    X-Original-Commit: 5020d45127bc33ac96c24e7d965f7d1126f46b26

 nimble/controller/syscfg.yml                          | 18 ++++++++++++++++++
 nimble/host/services/bleuart/syscfg.yml               | 18 ++++++++++++++++++
 nimble/host/src/ble_hs_mbuf_priv.h                    | 19 +++++++++++++++++++
 nimble/host/syscfg.yml                                | 18 ++++++++++++++++++
 nimble/host/test/syscfg.yml                           | 18 ++++++++++++++++++
 nimble/host/tools/log2smtest.rb                       | 19 +++++++++++++++++++
 nimble/syscfg.yml                                     | 18 ++++++++++++++++++
 .../transport/ram/include/transport/ram/ble_hci_ram.h | 19 +++++++++++++++++++
 nimble/transport/ram/syscfg.yml                       | 18 ++++++++++++++++++
 nimble/transport/uart/syscfg.yml                      | 18 ++++++++++++++++++
 10 files changed, 183 insertions(+)

commit 485a0cea3cfeaf033ce52aa76f30f225776d1194
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:53:40 2016 -0800

    BLE TPS service - Use latest host API.
    
    X-Original-Commit: 524af89eee7c166e451eb4f923ffc3d533ad8d12

 nimble/host/services/tps/src/ble_svc_tps.c | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

commit 21039e545a86729246c76b26a1aa559d99dc5257
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:46:40 2016 -0800

    BLE TPS service - use sysinit.
    
    X-Original-Commit: 58d6bcd13c5e57741be1db292de012b5c92daa7a

 .../host/services/tps/include/services/tps/ble_svc_tps.h |  2 +-
 nimble/host/services/tps/pkg.yml                         |  2 ++
 nimble/host/services/tps/src/ble_svc_tps.c               | 16 +++++-----------
 3 files changed, 8 insertions(+), 12 deletions(-)

commit 01a25afcab3929ca08a306ed70902ea05136460f
Merge: 0019b41a 49114e3d
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:41:39 2016 -0800

    This closes #84.
    
    Merge remote-tracking branch 'bgiori/feature-tps' into develop
    
    * bgiori/feature-tps:
      moved tps to services dir.
      variables declared at top of function scope
      coding style changes
      updated comments and error return value
      Tx Power Service implementation
      added tx power service to profiles
    
    X-Original-Commit: 5663384b2aebdb19c1f2da2d0052f5f5be893263

commit 0019b41a5c4f65b73c5f03fc862928d1ed0b1422
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:40:56 2016 -0800

    BLE ANS service - Use sysinit.
    
    X-Original-Commit: 32b0d33a3a409668e9199c9bb6c28a8f5db3d374

 .../ans/include/services/ans/ble_svc_ans.h         |  4 +-
 nimble/host/services/ans/pkg.yml                   |  3 +
 nimble/host/services/ans/src/ble_svc_ans.c         | 65 +++++++++-------------
 nimble/host/services/ans/syscfg.yml                | 25 +++++++++
 4 files changed, 56 insertions(+), 41 deletions(-)

commit 886423f3136ada1db6643df97064a1e8de5f49e4
Merge: 0bf8ab32 91b4ac8d
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:29:28 2016 -0800

    This closes #85.
    
    Merge remote-tracking branch 'bgiori/feature-ans' into develop
    
    * bgiori/feature-ans:
      update include path
      moved location to services from profiles
      Variables declared at top of function scope
      updated comments
      Alert Notification Service implemented.
      fixed compilation errors and runs. Untested. Unfinished.
      unfinished changes
    
    X-Original-Commit: ff4ce4660d43d3e1d24e3e66f277c0939cd3ff0c

commit 0bf8ab32e7012dd6ffcf9a3b7e32888a8b535bfc
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:15:09 2016 -0800

    BLE IAS svc - Update to use sysinit.
    
    X-Original-Commit: bbe1c78a1896c1a5f12839514aecba0add6610f4

 .../ias/include/services/ias/ble_svc_ias.h         |  6 ++--
 nimble/host/services/ias/pkg.yml                   |  2 ++
 nimble/host/services/ias/src/ble_svc_ias.c         | 38 ++++++++++------------
 3 files changed, 22 insertions(+), 24 deletions(-)

commit 371f249cbe127ddd885f3dbcdee4a85d9f29efbe
Merge: fe19e255 4d87c08d
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 8 14:01:56 2016 -0800

    This closes #87.
    
    Merge remote-tracking branch 'bgiori/feature-ias' into develop
    
    * bgiori/feature-ias:
      update ias package structure into host/services
      Immediate Alert Service implemented.
    
    X-Original-Commit: 44fffd4d28f3b3880db0f3b7dd1deaec6eae35f3

commit fe19e2557234964d506453aff46019f75fae25ec
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Nov 7 17:23:01 2016 -0800

    BLE host - Fix incorrect expiry issue
    
    Sometimes an event expiry would get "dropped"; the event would not
    expire at the appropriate time.  Instead, the event would expire late,
    simultaneuous with the following event.
    
    The bug was: a relative time was being compared against an absolute
    time, yielding an incorrect result.
    
    X-Original-Commit: fcef18f37d3e9dd1c3069351db2093e693e495db

 nimble/host/src/ble_hs.c                |  5 ++++-
 nimble/host/test/src/ble_gap_test.c     | 14 +++++++-------
 nimble/host/test/src/ble_hs_adv_test.c  |  4 ++--
 nimble/host/test/src/ble_hs_conn_test.c |  6 ++++--
 nimble/host/test/src/ble_hs_test_util.c |  3 ++-
 nimble/host/test/src/ble_hs_test_util.h |  1 +
 nimble/host/test/src/ble_os_test.c      |  9 +++++++++
 7 files changed, 29 insertions(+), 13 deletions(-)

commit 72d352fd6f8969760a033672965e828921728a40
Author: William San Filippo <wills@runtime.io>
Date:   Fri Nov 4 16:01:23 2016 -0700

    No jira ticket: It seems that with some of the syscfg changes
    that these values got reverted or modified unintentionally. The
    number and size of the events has now been corrected.
    
    X-Original-Commit: 8bdfc5a0106a122837e19882a3a1c3d676140ead

 nimble/transport/ram/syscfg.yml | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit da10a68e0287921106a44abb9c4e45e93ffb6267
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Nov 1 11:21:41 2016 -0700

    obsolete defs
    
    X-Original-Commit: 702ad3b9511b619b8321b3ddab87f890c879b4ab

 nimble/host/src/ble_hs_priv.h | 5 -----
 1 file changed, 5 deletions(-)

commit 2ea830ef52c3c482e3a17cc556804ac649dca1a9
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Oct 31 17:43:27 2016 -0700

    BLE Controller: Event codes -> callbacks
    
    X-Original-Commit: cf38f1ff6fc2946e3e4caafb37c521890fcfc251

 nimble/controller/include/controller/ble_ll.h      | 12 +---
 nimble/controller/include/controller/ble_ll_adv.h  |  3 -
 nimble/controller/include/controller/ble_ll_conn.h |  4 +-
 nimble/controller/include/controller/ble_ll_hci.h  |  3 -
 nimble/controller/include/controller/ble_ll_scan.h |  3 -
 nimble/controller/src/ble_ll.c                     | 83 +++++++++-------------
 nimble/controller/src/ble_ll_adv.c                 | 20 +++---
 nimble/controller/src/ble_ll_conn.c                | 38 +++++-----
 nimble/controller/src/ble_ll_conn_hci.c            |  2 +-
 nimble/controller/src/ble_ll_conn_priv.h           |  2 -
 nimble/controller/src/ble_ll_ctrl.c                | 19 ++---
 nimble/controller/src/ble_ll_hci.c                 |  6 +-
 nimble/controller/src/ble_ll_resolv.c              | 24 +++----
 nimble/controller/src/ble_ll_scan.c                |  8 +--
 14 files changed, 99 insertions(+), 128 deletions(-)

commit eb77173ea196ded3bbaa8ae45c5ea2e2b1ff92e9
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Oct 27 16:10:21 2016 -0700

    BLE Host: Event codes -> callbacks
    
    X-Original-Commit: 17eded92b71b4ca80a38553cc7938200595094e9

 nimble/host/include/host/ble_hs.h       |   3 +-
 nimble/host/pkg.yml                     |   1 -
 nimble/host/src/ble_hs.c                | 148 +++++++++++++++++---------------
 nimble/host/src/ble_hs_cfg.c            |   2 -
 nimble/host/src/ble_hs_priv.h           |   1 +
 nimble/host/test/src/ble_hs_test_util.c |   4 +-
 nimble/host/test/src/ble_os_test.c      |  19 +---
 7 files changed, 84 insertions(+), 94 deletions(-)

commit b0aeded14efafad0ce9d0a8c194970f304d348b2
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Oct 27 08:55:14 2016 -0700

    Replace os_event types with callback functions.
    
    All scheduled events contain a pointer to a callback function.  When a
    task dequeues an event, it just executes the callback.  Before this
    change, the task would inspect the event type and use it to decide what
    action to take.
    
    The reason for this change is to allow "taskless" packages to seamlessly
    use any task's eventq.  With event codes, there would be conflicts in
    the global event ID number space.
    
    X-Original-Commit: 918811f826f9308e0b0b5abb0c0328be3c4dc6f4

 nimble/host/pkg.yml      |   5 ++-
 nimble/host/src/ble_hs.c | 108 +++++++++++++++++------------------------------
 2 files changed, 41 insertions(+), 72 deletions(-)

commit 2321a28d40a2f4088d92164d30ccbede68de8995
Author: Sterling Hughes <sterling@apache.org>
Date:   Mon Oct 24 18:55:06 2016 -0700

    basic doxygen support in OS (modules) and update Apache License header.
    
    X-Original-Commit: 0f223f417d07f9ca136cb26daa4085134dd112cd

 nimble/controller/include/controller/ble_hw.h                  | 2 +-
 nimble/controller/include/controller/ble_ll.h                  | 2 +-
 nimble/controller/include/controller/ble_ll_adv.h              | 2 +-
 nimble/controller/include/controller/ble_ll_conn.h             | 2 +-
 nimble/controller/include/controller/ble_ll_ctrl.h             | 2 +-
 nimble/controller/include/controller/ble_ll_hci.h              | 2 +-
 nimble/controller/include/controller/ble_ll_resolv.h           | 2 +-
 nimble/controller/include/controller/ble_ll_scan.h             | 2 +-
 nimble/controller/include/controller/ble_ll_sched.h            | 2 +-
 nimble/controller/include/controller/ble_ll_whitelist.h        | 2 +-
 nimble/controller/include/controller/ble_phy.h                 | 2 +-
 nimble/controller/src/ble_ll.c                                 | 2 +-
 nimble/controller/src/ble_ll_adv.c                             | 2 +-
 nimble/controller/src/ble_ll_conn.c                            | 2 +-
 nimble/controller/src/ble_ll_conn_hci.c                        | 2 +-
 nimble/controller/src/ble_ll_conn_priv.h                       | 2 +-
 nimble/controller/src/ble_ll_ctrl.c                            | 2 +-
 nimble/controller/src/ble_ll_hci.c                             | 2 +-
 nimble/controller/src/ble_ll_hci_ev.c                          | 2 +-
 nimble/controller/src/ble_ll_rand.c                            | 2 +-
 nimble/controller/src/ble_ll_resolv.c                          | 2 +-
 nimble/controller/src/ble_ll_scan.c                            | 2 +-
 nimble/controller/src/ble_ll_sched.c                           | 2 +-
 nimble/controller/src/ble_ll_supp_cmd.c                        | 2 +-
 nimble/controller/src/ble_ll_whitelist.c                       | 2 +-
 nimble/drivers/native/include/ble/xcvr.h                       | 2 +-
 nimble/drivers/native/src/ble_hw.c                             | 2 +-
 nimble/drivers/native/src/ble_phy.c                            | 2 +-
 nimble/drivers/nrf51/include/ble/xcvr.h                        | 2 +-
 nimble/drivers/nrf51/src/ble_hw.c                              | 2 +-
 nimble/drivers/nrf51/src/ble_phy.c                             | 2 +-
 nimble/drivers/nrf52/include/ble/xcvr.h                        | 2 +-
 nimble/drivers/nrf52/src/ble_hw.c                              | 2 +-
 nimble/drivers/nrf52/src/ble_phy.c                             | 2 +-
 nimble/host/include/host/ble_att.h                             | 2 +-
 nimble/host/include/host/ble_eddystone.h                       | 2 +-
 nimble/host/include/host/ble_gap.h                             | 2 +-
 nimble/host/include/host/ble_gatt.h                            | 2 +-
 nimble/host/include/host/ble_hs.h                              | 2 +-
 nimble/host/include/host/ble_hs_adv.h                          | 2 +-
 nimble/host/include/host/ble_hs_id.h                           | 2 +-
 nimble/host/include/host/ble_hs_log.h                          | 2 +-
 nimble/host/include/host/ble_hs_mbuf.h                         | 2 +-
 nimble/host/include/host/ble_hs_test.h                         | 2 +-
 nimble/host/include/host/ble_ibeacon.h                         | 2 +-
 nimble/host/include/host/ble_l2cap.h                           | 2 +-
 nimble/host/include/host/ble_sm.h                              | 2 +-
 nimble/host/include/host/ble_store.h                           | 2 +-
 nimble/host/include/host/ble_uuid.h                            | 2 +-
 nimble/host/profiles/lls/include/profiles/lls/ble_svc_lls.h    | 2 +-
 nimble/host/profiles/lls/src/ble_svc_lls.c                     | 2 +-
 nimble/host/services/bleuart/include/bleuart/bleuart.h         | 2 +-
 nimble/host/services/bleuart/src/bleuart.c                     | 2 +-
 nimble/host/services/gap/include/services/gap/ble_svc_gap.h    | 2 +-
 nimble/host/services/gap/src/ble_svc_gap.c                     | 2 +-
 nimble/host/services/gatt/include/services/gatt/ble_svc_gatt.h | 2 +-
 nimble/host/services/gatt/src/ble_svc_gatt.c                   | 2 +-
 nimble/host/services/lls/include/services/lls/ble_svc_lls.h    | 2 +-
 nimble/host/services/lls/src/ble_svc_lls.c                     | 2 +-
 nimble/host/src/ble_att.c                                      | 2 +-
 nimble/host/src/ble_att_clt.c                                  | 2 +-
 nimble/host/src/ble_att_cmd.c                                  | 2 +-
 nimble/host/src/ble_att_cmd_priv.h                             | 2 +-
 nimble/host/src/ble_att_priv.h                                 | 2 +-
 nimble/host/src/ble_att_svr.c                                  | 2 +-
 nimble/host/src/ble_eddystone.c                                | 2 +-
 nimble/host/src/ble_gap.c                                      | 2 +-
 nimble/host/src/ble_gap_priv.h                                 | 2 +-
 nimble/host/src/ble_gatt_priv.h                                | 2 +-
 nimble/host/src/ble_gattc.c                                    | 2 +-
 nimble/host/src/ble_gatts.c                                    | 2 +-
 nimble/host/src/ble_hs.c                                       | 2 +-
 nimble/host/src/ble_hs_adv.c                                   | 2 +-
 nimble/host/src/ble_hs_adv_priv.h                              | 2 +-
 nimble/host/src/ble_hs_atomic.c                                | 2 +-
 nimble/host/src/ble_hs_atomic_priv.h                           | 2 +-
 nimble/host/src/ble_hs_cfg.c                                   | 2 +-
 nimble/host/src/ble_hs_conn.c                                  | 2 +-
 nimble/host/src/ble_hs_conn_priv.h                             | 2 +-
 nimble/host/src/ble_hs_dbg.c                                   | 2 +-
 nimble/host/src/ble_hs_dbg_priv.h                              | 2 +-
 nimble/host/src/ble_hs_endian_priv.h                           | 2 +-
 nimble/host/src/ble_hs_hci.c                                   | 2 +-
 nimble/host/src/ble_hs_hci_cmd.c                               | 2 +-
 nimble/host/src/ble_hs_hci_evt.c                               | 2 +-
 nimble/host/src/ble_hs_hci_priv.h                              | 2 +-
 nimble/host/src/ble_hs_hci_util.c                              | 2 +-
 nimble/host/src/ble_hs_id.c                                    | 2 +-
 nimble/host/src/ble_hs_id_priv.h                               | 2 +-
 nimble/host/src/ble_hs_log.c                                   | 2 +-
 nimble/host/src/ble_hs_mbuf.c                                  | 2 +-
 nimble/host/src/ble_hs_misc.c                                  | 2 +-
 nimble/host/src/ble_hs_priv.h                                  | 2 +-
 nimble/host/src/ble_hs_pvcy.c                                  | 2 +-
 nimble/host/src/ble_hs_pvcy_priv.h                             | 2 +-
 nimble/host/src/ble_hs_startup.c                               | 2 +-
 nimble/host/src/ble_hs_startup_priv.h                          | 2 +-
 nimble/host/src/ble_ibeacon.c                                  | 2 +-
 nimble/host/src/ble_l2cap.c                                    | 2 +-
 nimble/host/src/ble_l2cap_priv.h                               | 2 +-
 nimble/host/src/ble_l2cap_sig.c                                | 2 +-
 nimble/host/src/ble_l2cap_sig_cmd.c                            | 2 +-
 nimble/host/src/ble_l2cap_sig_priv.h                           | 2 +-
 nimble/host/src/ble_sm.c                                       | 2 +-
 nimble/host/src/ble_sm_cmd.c                                   | 2 +-
 nimble/host/src/ble_sm_lgcy.c                                  | 2 +-
 nimble/host/src/ble_sm_priv.h                                  | 2 +-
 nimble/host/src/ble_sm_sc.c                                    | 2 +-
 nimble/host/src/ble_store.c                                    | 2 +-
 nimble/host/src/ble_uuid.c                                     | 2 +-
 nimble/host/src/ble_uuid_priv.h                                | 2 +-
 nimble/host/store/ram/include/store/ram/ble_store_ram.h        | 2 +-
 nimble/host/store/ram/src/ble_store_ram.c                      | 2 +-
 nimble/host/test/src/ble_att_clt_test.c                        | 2 +-
 nimble/host/test/src/ble_att_svr_test.c                        | 2 +-
 nimble/host/test/src/ble_gap_test.c                            | 2 +-
 nimble/host/test/src/ble_gatt_conn_test.c                      | 2 +-
 nimble/host/test/src/ble_gatt_disc_c_test.c                    | 2 +-
 nimble/host/test/src/ble_gatt_disc_d_test.c                    | 2 +-
 nimble/host/test/src/ble_gatt_disc_s_test.c                    | 2 +-
 nimble/host/test/src/ble_gatt_find_s_test.c                    | 2 +-
 nimble/host/test/src/ble_gatt_read_test.c                      | 2 +-
 nimble/host/test/src/ble_gatt_write_test.c                     | 2 +-
 nimble/host/test/src/ble_gatts_notify_test.c                   | 2 +-
 nimble/host/test/src/ble_gatts_read_test.c                     | 2 +-
 nimble/host/test/src/ble_gatts_reg_test.c                      | 2 +-
 nimble/host/test/src/ble_hs_adv_test.c                         | 2 +-
 nimble/host/test/src/ble_hs_conn_test.c                        | 2 +-
 nimble/host/test/src/ble_hs_hci_test.c                         | 2 +-
 nimble/host/test/src/ble_hs_test.c                             | 2 +-
 nimble/host/test/src/ble_hs_test_util.c                        | 2 +-
 nimble/host/test/src/ble_hs_test_util.h                        | 2 +-
 nimble/host/test/src/ble_hs_test_util_store.c                  | 2 +-
 nimble/host/test/src/ble_hs_test_util_store.h                  | 2 +-
 nimble/host/test/src/ble_l2cap_test.c                          | 2 +-
 nimble/host/test/src/ble_os_test.c                             | 2 +-
 nimble/host/test/src/ble_sm_lgcy_test.c                        | 2 +-
 nimble/host/test/src/ble_sm_sc_test.c                          | 2 +-
 nimble/host/test/src/ble_sm_test.c                             | 2 +-
 nimble/host/test/src/ble_sm_test_util.c                        | 2 +-
 nimble/host/test/src/ble_sm_test_util.h                        | 2 +-
 nimble/host/test/src/ble_uuid_test.c                           | 2 +-
 nimble/include/nimble/ble.h                                    | 2 +-
 nimble/include/nimble/ble_hci_trans.h                          | 2 +-
 nimble/include/nimble/hci_common.h                             | 2 +-
 nimble/include/nimble/nimble_opt.h                             | 2 +-
 nimble/include/nimble/nimble_opt_auto.h                        | 2 +-
 nimble/src/ble_util.c                                          | 2 +-
 nimble/src/hci_common.c                                        | 2 +-
 nimble/src/util.c                                              | 2 +-
 nimble/transport/ram/src/ble_hci_ram.c                         | 2 +-
 nimble/transport/uart/include/transport/uart/ble_hci_uart.h    | 2 +-
 nimble/transport/uart/src/ble_hci_uart.c                       | 2 +-
 153 files changed, 153 insertions(+), 153 deletions(-)

commit 30e6e3c81395a4f11e09280a77fc0f4d140b6e33
Author: William San Filippo <wills@runtime.io>
Date:   Sun Oct 23 17:31:13 2016 -0700

    No jira ticket: fix old (erroneous) comment.
    
    X-Original-Commit: 59e673f20e5b99e24628a8eaf5d92fc4b4b3ca1b

 nimble/controller/syscfg.yml | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit b034e1fe62b316a2e27b392fa7b25e6c391843da
Author: Marko Kiiskila <marko@runtime.io>
Date:   Thu Oct 20 15:56:09 2016 -0700

    nimble uart transport; fix broken build.
    
    X-Original-Commit: 598cd4b4c7fe6d4e28bc8c938442ef52ba93145e

 nimble/transport/uart/pkg.yml            | 1 +
 nimble/transport/uart/src/ble_hci_uart.c | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

commit 6e7026bfd6b8212d43da8da18603b1c6fc268a7f
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Oct 20 09:08:51 2016 -0700

    sample apps - initialize nimble host log.
    
    X-Original-Commit: b2b72da0fa1525ef1d21273a38e42ed1665ae013

 nimble/host/src/ble_hs.c | 7 -------
 1 file changed, 7 deletions(-)

commit 6b6f2899438b885cd3d12493d71701d3e2f5fb63
Author: Peter Snyder <git@peterfs.com>
Date:   Mon Oct 17 17:56:20 2016 -0700

    MYNEWT-444 - Configure log level per-module
    
    Add argument to log_register specifying the log level (e.g, LOG_WARN, etc) to be
    accepted in the log. A new field was added to log structure to store the log level.
    New define LOG_SYSLEVEL is the "defined" system log level.
    
    Bonus fixes for log and nimble unit tests.
    
    X-Original-Commit: 4ae25f3a3a77c4a9f5704b6194b72e02dbea89a7

 nimble/host/src/ble_hs.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 696212f594674e127dac67c829aa97a483f504c4
Author: Peter Snyder <git@peterfs.com>
Date:   Sun Oct 16 20:32:04 2016 -0700

    Unit test infrastructure
    
    Rework unit test infrastructure to enable target applications to run unit tests.
    Unit tests were split up into individual files enabling applications to select individual tests across subsystems. Unit test case macros updated to allow
    initialization and pre/post callbackas on a per-testcase basis. Test suite macros
    updated to allow pre/post, pass/fail callbacks on individual testcases in
    the suite as well as initialization and completion callbacks for the suite.
    The intention is that enable customization of test suites for target devices.
    
    Partial checkin for MYNEWT-139 and MYNEWT-41.
    
    X-Original-Commit: 75101ba4f3e9416602ca1ea2344d92c6a0ce3fea

 nimble/host/test/src/ble_hs_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8c002582622c115a4e6813038d79e5f7369e2a0e
Author: Sterling Hughes <sterling@apache.org>
Date:   Tue Oct 11 14:23:34 2016 +0200

    final re-org of directories -- removing the lib/ directory.
    
    X-Original-Commit: bed47f0ab918984a09b898d61b3e2a477001f21e

 nimble/host/pkg.yml                    | 1 -
 nimble/host/src/ble_gap.c              | 2 +-
 nimble/transport/ram/src/ble_hci_ram.c | 2 +-
 3 files changed, 2 insertions(+), 3 deletions(-)

commit f3b4f76c32144b31b220a07c3083f177383e7697
Author: William San Filippo <wills@runtime.io>
Date:   Mon Oct 10 13:37:56 2016 -0700

    MYNEWT-431: Move cputime from HAL into os.
    
    X-Original-Commit: ac2d49e31c49ddfe0b107862b4504364f32736df

 nimble/controller/include/controller/ble_ll.h      |  4 +-
 nimble/controller/include/controller/ble_ll_conn.h |  4 +-
 nimble/controller/include/controller/ble_ll_scan.h |  4 +-
 nimble/controller/src/ble_ll.c                     | 12 ++---
 nimble/controller/src/ble_ll_adv.c                 | 26 ++++-----
 nimble/controller/src/ble_ll_conn.c                | 46 ++++++++--------
 nimble/controller/src/ble_ll_ctrl.c                |  4 +-
 nimble/controller/src/ble_ll_scan.c                | 24 ++++-----
 nimble/controller/src/ble_ll_sched.c               | 62 +++++++++++-----------
 nimble/controller/src/ble_ll_whitelist.c           |  1 -
 nimble/drivers/nrf51/src/ble_phy.c                 |  6 +--
 nimble/drivers/nrf52/src/ble_phy.c                 |  6 +--
 nimble/transport/uart/src/ble_hci_uart.c           |  3 +-
 13 files changed, 101 insertions(+), 101 deletions(-)

commit a04922f4c54f3e12fffdc74534f94c215bffaa5c
Author: Tim Hutt <tdhutt@gmail.com>
Date:   Sat Oct 1 15:25:27 2016 +0100

    Add #ifdef __cplusplus guards
    
    This commit adds them to almost every header. There are a few that don't have any normal header include guards because they don't define anything.
    
    X-Original-Commit: d69b07986397dfc841ee6618301af5ba08ddc058

 nimble/controller/include/controller/ble_hw.h                  | 8 ++++++++
 nimble/controller/include/controller/ble_ll.h                  | 8 ++++++++
 nimble/controller/include/controller/ble_ll_adv.h              | 8 ++++++++
 nimble/controller/include/controller/ble_ll_conn.h             | 8 ++++++++
 nimble/controller/include/controller/ble_ll_ctrl.h             | 8 ++++++++
 nimble/controller/include/controller/ble_ll_hci.h              | 8 ++++++++
 nimble/controller/include/controller/ble_ll_resolv.h           | 8 ++++++++
 nimble/controller/include/controller/ble_ll_scan.h             | 8 ++++++++
 nimble/controller/include/controller/ble_ll_sched.h            | 8 ++++++++
 nimble/controller/include/controller/ble_ll_whitelist.h        | 8 ++++++++
 nimble/controller/include/controller/ble_phy.h                 | 8 ++++++++
 nimble/controller/src/ble_ll_conn_priv.h                       | 8 ++++++++
 nimble/drivers/native/include/ble/xcvr.h                       | 8 ++++++++
 nimble/drivers/nrf51/include/ble/xcvr.h                        | 8 ++++++++
 nimble/drivers/nrf52/include/ble/xcvr.h                        | 8 ++++++++
 nimble/host/include/host/ble_att.h                             | 8 ++++++++
 nimble/host/include/host/ble_eddystone.h                       | 8 ++++++++
 nimble/host/include/host/ble_gap.h                             | 8 ++++++++
 nimble/host/include/host/ble_gatt.h                            | 8 ++++++++
 nimble/host/include/host/ble_hs.h                              | 8 ++++++++
 nimble/host/include/host/ble_hs_adv.h                          | 8 ++++++++
 nimble/host/include/host/ble_hs_id.h                           | 8 ++++++++
 nimble/host/include/host/ble_hs_log.h                          | 8 ++++++++
 nimble/host/include/host/ble_hs_mbuf.h                         | 8 ++++++++
 nimble/host/include/host/ble_hs_test.h                         | 8 ++++++++
 nimble/host/include/host/ble_ibeacon.h                         | 8 ++++++++
 nimble/host/include/host/ble_l2cap.h                           | 8 ++++++++
 nimble/host/include/host/ble_sm.h                              | 8 ++++++++
 nimble/host/include/host/ble_store.h                           | 8 ++++++++
 nimble/host/include/host/ble_uuid.h                            | 8 ++++++++
 nimble/host/profiles/lls/include/profiles/lls/ble_svc_lls.h    | 8 ++++++++
 nimble/host/services/bleuart/include/bleuart/bleuart.h         | 8 ++++++++
 nimble/host/services/gap/include/services/gap/ble_svc_gap.h    | 8 ++++++++
 nimble/host/services/gatt/include/services/gatt/ble_svc_gatt.h | 8 ++++++++
 nimble/host/services/lls/include/services/lls/ble_svc_lls.h    | 8 ++++++++
 nimble/host/src/ble_att_cmd_priv.h                             | 8 ++++++++
 nimble/host/src/ble_att_priv.h                                 | 8 ++++++++
 nimble/host/src/ble_gap_priv.h                                 | 8 ++++++++
 nimble/host/src/ble_gatt_priv.h                                | 8 ++++++++
 nimble/host/src/ble_hs_adv_priv.h                              | 8 ++++++++
 nimble/host/src/ble_hs_atomic_priv.h                           | 8 ++++++++
 nimble/host/src/ble_hs_conn_priv.h                             | 8 ++++++++
 nimble/host/src/ble_hs_dbg_priv.h                              | 8 ++++++++
 nimble/host/src/ble_hs_endian_priv.h                           | 8 ++++++++
 nimble/host/src/ble_hs_hci_priv.h                              | 8 ++++++++
 nimble/host/src/ble_hs_id_priv.h                               | 8 ++++++++
 nimble/host/src/ble_hs_mbuf_priv.h                             | 8 ++++++++
 nimble/host/src/ble_hs_priv.h                                  | 8 ++++++++
 nimble/host/src/ble_hs_pvcy_priv.h                             | 8 ++++++++
 nimble/host/src/ble_hs_startup_priv.h                          | 8 ++++++++
 nimble/host/src/ble_l2cap_priv.h                               | 8 ++++++++
 nimble/host/src/ble_l2cap_sig_priv.h                           | 8 ++++++++
 nimble/host/src/ble_sm_priv.h                                  | 8 ++++++++
 nimble/host/src/ble_uuid_priv.h                                | 8 ++++++++
 nimble/host/store/ram/include/store/ram/ble_store_ram.h        | 8 ++++++++
 nimble/host/test/src/ble_hs_test_util.h                        | 8 ++++++++
 nimble/host/test/src/ble_hs_test_util_store.h                  | 8 ++++++++
 nimble/host/test/src/ble_sm_test_util.h                        | 8 ++++++++
 nimble/include/nimble/ble.h                                    | 8 ++++++++
 nimble/include/nimble/ble_hci_trans.h                          | 8 ++++++++
 nimble/include/nimble/hci_common.h                             | 8 ++++++++
 nimble/include/nimble/nimble_opt.h                             | 8 ++++++++
 nimble/include/nimble/nimble_opt_auto.h                        | 8 ++++++++
 nimble/transport/ram/include/transport/ram/ble_hci_ram.h       | 8 ++++++++
 nimble/transport/uart/include/transport/uart/ble_hci_uart.h    | 8 ++++++++
 65 files changed, 520 insertions(+)

commit 2e5d3e266bca5f8baaaecf403c307c9e94080a55
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Oct 2 11:38:51 2016 -0700

    Move syscfg from pkg.yml to syscfg.yml.
    
    X-Original-Commit: 4b708c89f485ac6df0795d8941f20cc47e6e4a3d

 nimble/controller/pkg.yml               | 166 ----------------------------
 nimble/controller/syscfg.yml            | 167 ++++++++++++++++++++++++++++
 nimble/host/pkg.yml                     | 186 -------------------------------
 nimble/host/services/bleuart/pkg.yml    |   5 -
 nimble/host/services/bleuart/syscfg.yml |   6 +
 nimble/host/syscfg.yml                  | 187 ++++++++++++++++++++++++++++++++
 nimble/host/test/pkg.yml                |  10 --
 nimble/host/test/syscfg.yml             |  11 ++
 nimble/pkg.yml                          |  22 ----
 nimble/syscfg.yml                       |  23 ++++
 nimble/transport/ram/pkg.yml            |  13 ---
 nimble/transport/ram/syscfg.yml         |  14 +++
 nimble/transport/uart/pkg.yml           |  38 -------
 nimble/transport/uart/syscfg.yml        |  39 +++++++
 14 files changed, 447 insertions(+), 440 deletions(-)

commit a993eeb85a5b2f146b5ee122d59683fc16a5f478
Author: William San Filippo <wills@runtime.io>
Date:   Thu Sep 29 10:45:57 2016 -0700

    MYNEWT-397: Nimble controller assert if advertising started/stopped frequently
    
    There was an assert in the advertising code in the nimble controller that
    would assert if the advertising state machine was not enabled and an
    advertising event finished. The code contained a race condition where
    it was possible that the advertising state machine was stopped but
    an advertising end event was processed by the Link Layer. The code will
    now ignore advertising packets that are processed after advertising has
    been stopped as these events are asynchronous to the controller.
    
    X-Original-Commit: 1e5239485af3c056b9a053b60b778a30b2635e44

 nimble/controller/src/ble_ll_adv.c | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

commit fee4a4fa8d3b2dab0265f74e38f224fdfbf3172d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Sep 29 11:35:16 2016 -0700

    BLE Host - Trust conn-complete-evt role field
    
    Prior to this change: for failed connection-complete events, the host
    fully inferred the role from the status code.  A code of
    BLE_ERR_DIR_ADV_TMO implied the slave role; all other roles implied the
    master role.
    
    Now: for failed connection-complete events, the host only infers the
    role from the status code when the status is BLE_ERR_DIR_ADV_TMO
    (role=slave).  For all other status codes, the host reads the role field
    directly.
    
    X-Original-Commit: b51a2985222a1c7b5c5ae1e4257caf067dfc1dfd

 nimble/host/src/ble_gap.c | 23 ++++++++++++++++-------
 1 file changed, 16 insertions(+), 7 deletions(-)

commit 3150aa98f7a5cb6b03d4cd1bba23916b11e5072a
Author: Sterling Hughes <sterling@apache.org>
Date:   Fri Sep 30 10:42:14 2016 -0700

    correct a few more pkg names
    
    X-Original-Commit: 17b46ca03d650248b4ac8a819d2526a57a2dddcc

 nimble/host/services/bleuart/pkg.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4c170dba257596eb1f68f94ff522944db97b6436
Author: William San Filippo <wills@runtime.io>
Date:   Thu Sep 29 10:45:57 2016 -0700

    MYNEWT-397: Nimble controller assert if advertising started/stopped frequently
    
    There was an assert in the advertising code in the nimble controller that
    would assert if the advertising state machine was not enabled and an
    advertising event finished. The code contained a race condition where
    it was possible that the advertising state machine was stopped but
    an advertising end event was processed by the Link Layer. The code will
    now ignore advertising packets that are processed after advertising has
    been stopped as these events are asynchronous to the controller.
    
    X-Original-Commit: 317f82c61cbf22cfe11305809b3765ae64d46515

 nimble/controller/src/ble_ll_adv.c | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

commit 07aa4f5dbdcdfeff6538d01469743d353142afc3
Author: Sterling Hughes <sterling@apache.org>
Date:   Wed Sep 28 18:54:02 2016 -0700

    newt test all compiling again.
    
    X-Original-Commit: 040aa6f2321600aa46c8cc1c91b41385c6e95269

 nimble/host/test/pkg.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit ca3b76958ecde27a0a56cc608ceabd00879326ad
Author: Sterling Hughes <sterling@apache.org>
Date:   Wed Sep 28 16:34:02 2016 -0700

    directory re-org
    
    X-Original-Commit: 6a7432f493900f8adad0fe9416b65d477fc5b316

 nimble/controller/pkg.yml                          |   2 +-
 nimble/host/pkg.yml                                |   2 +-
 .../services/bleuart/include/bleuart/bleuart.h     |  34 ++++
 nimble/host/services/bleuart/pkg.yml               |  42 +++++
 nimble/host/services/bleuart/src/bleuart.c         | 201 +++++++++++++++++++++
 nimble/host/src/ble_hs.c                           |   5 +-
 nimble/pkg.yml                                     |   2 +-
 nimble/transport/ram/pkg.yml                       |   2 +-
 nimble/transport/uart/pkg.yml                      |   2 +-
 9 files changed, 284 insertions(+), 8 deletions(-)

commit f3e111daa86022dc822627fa79a6d3e66015bd19
Author: Sterling Hughes <sterling@apache.org>
Date:   Tue Sep 27 17:41:39 2016 -0700

    directory re-org, part 1
    
    X-Original-Commit: 0216c73e5ed24b39d04908801f88410d6eab7cbb

 nimble/drivers/native/pkg.yml | 2 +-
 nimble/drivers/nrf51/pkg.yml  | 2 +-
 nimble/drivers/nrf52/pkg.yml  | 2 +-
 nimble/host/pkg.yml           | 4 ++--
 4 files changed, 5 insertions(+), 5 deletions(-)

commit bbf1f1243f489d2ea57b5096e66583c248b9c45f
Author: Sterling Hughes <sterling@apache.org>
Date:   Tue Sep 27 14:39:23 2016 -0700

    move nimble drivers into standard drivers
    
    X-Original-Commit: 514bffaf4544a1093e02d7e117b9233314b5277f

 nimble/drivers/native/pkg.yml | 2 +-
 nimble/drivers/nrf51/pkg.yml  | 2 +-
 nimble/drivers/nrf52/pkg.yml  | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit a9760242857710760a8817bcce49e0a3dd034ad5
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Sep 26 15:16:08 2016 -0700

    BLE Host - Move SC-specific functions into SC file
    
    X-Original-Commit: 1cf40bb047cdd3ada46bd64878d14f9762a5044b

 nimble/host/src/ble_sm.c      | 35 -----------------------------------
 nimble/host/src/ble_sm_priv.h |  1 -
 nimble/host/src/ble_sm_sc.c   | 40 ++++++++++++++++++++++++++++++++++++++++
 3 files changed, 40 insertions(+), 36 deletions(-)

commit 0803d354d5d764fb9890206f009b55ed0dce6b0b
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Sep 21 19:07:36 2016 -0700

    Conclude merge from sterly_refactor.
    
    Additional changes to fix post-merge build failures.
    
    X-Original-Commit: 8dffea7d030262f574ce2c0f8e3d7dd2599b74f8

 nimble/controller/pkg.yml                          |  2 +-
 nimble/controller/src/ble_ll_adv.c                 |  8 +-
 nimble/controller/src/ble_ll_conn.c                | 56 ++++++------
 nimble/controller/src/ble_ll_conn_hci.c            |  4 +-
 nimble/controller/src/ble_ll_scan.c                |  6 +-
 .../gap/include/services/gap/ble_svc_gap.h         |  2 +-
 nimble/host/services/gap/pkg.yml                   |  3 +
 nimble/host/services/gap/src/ble_svc_gap.c         | 14 ++-
 .../gatt/include/services/gatt/ble_svc_gatt.h      |  2 +-
 nimble/host/services/gatt/pkg.yml                  |  2 +-
 nimble/host/services/gatt/src/ble_svc_gatt.c       | 13 +--
 .../services/mandatory/src/ble_svc_mandatory.c     | 36 --------
 nimble/host/src/ble_gap.c                          |  2 +-
 nimble/host/src/ble_hs.c                           | 20 -----
 nimble/host/src/test/ble_hs_hci_test.c             | 99 ----------------------
 nimble/host/test/src/ble_gap_test.c                | 28 +++---
 nimble/host/test/src/ble_hs_test_util.c            | 17 ----
 nimble/transport/ram/src/ble_hci_ram.c             |  2 +
 nimble/transport/uart/src/ble_hci_uart.c           | 28 +++---
 19 files changed, 81 insertions(+), 263 deletions(-)

commit 91eb8d144a05ca87fb023afce30baee795ced8b2
Merge: 2d4c054d 63b80b00
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Sep 21 15:06:50 2016 -0700

    Merge branch 'develop' into sterly_refactor
    
    X-Original-Commit: c5901fcc12db4f4a689728a9a9ff74ff3d0f7d40

commit 4d87c08d2d792254be64f01a47f0f6f33bcad758
Author: Brian Giori <briangiori@gmail.com>
Date:   Tue Sep 20 13:42:11 2016 -0700

    update ias package structure into host/services
    
    X-Original-Commit: 635dc153edc5de4f4389c4878ffbe77b28ff5dd5

 .../profiles => services/ias/include/services}/ias/ble_svc_ias.h      | 0
 nimble/host/{profiles => services}/ias/pkg.yml                        | 4 ++--
 nimble/host/{profiles => services}/ias/src/ble_svc_ias.c              | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 63b80b001e8f9f56c0305ee0d5213c18e26e3ea8
Author: William San Filippo <wills@runtime.io>
Date:   Fri Sep 16 16:39:43 2016 -0700

    MYNEWT-388: HCI uart should not assert if a command, event or ACL buffer not available
    
    There were a number of changes committed to fix a few BLE HCI issues
    1) On HCI sync loss, the controller will now send a HW error and wait
    to find a reset command in the byyte stream in order to re-sync.
    2) If no ACL data buffer available, the ACL packet is skipped and a
    data buffer overflow event is sent.
    3) If no command buffer is available, the current command is simply
    skipped. No response is sent in this case. The spec was not clear
    and since this should never happen we simply decided to skip the
    command.
    
    X-Original-Commit: aed4343e6047a4c837b1db89ac4d6d9500ec8a41

 nimble/controller/include/controller/ble_ll.h      |  13 +
 nimble/controller/include/controller/ble_ll_ctrl.h |   3 +
 nimble/controller/src/ble_ll.c                     |  53 +++
 nimble/controller/src/ble_ll_hci_ev.c              |  44 +++
 nimble/include/nimble/ble.h                        |   4 +
 nimble/include/nimble/hci_common.h                 |   4 +
 .../uart/include/transport/uart/ble_hci_uart.h     |   4 +-
 nimble/transport/uart/src/ble_hci_uart.c           | 377 ++++++++++++++++++---
 8 files changed, 452 insertions(+), 50 deletions(-)

commit 478e27d73e0abf37494d5e0d5f9d6e71623a5a59
Author: William San Filippo <wills@runtime.io>
Date:   Fri Sep 16 15:43:47 2016 -0700

    Add Apache License header. Not sure why this was omitted.
    
    X-Original-Commit: 622b4622f0f35122868d151fa93586b1caf43ce4

 nimble/transport/ram/src/ble_hci_ram.c | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit 42abb02a0ee319c854264258a563f36eef8be01d
Author: William San Filippo <wills@runtime.io>
Date:   Fri Sep 16 16:39:43 2016 -0700

    MYNEWT-388: HCI uart should not assert if a command, event or ACL buffer not available
    
    There were a number of changes committed to fix a few BLE HCI issues
    1) On HCI sync loss, the controller will now send a HW error and wait
    to find a reset command in the byyte stream in order to re-sync.
    2) If no ACL data buffer available, the ACL packet is skipped and a
    data buffer overflow event is sent.
    3) If no command buffer is available, the current command is simply
    skipped. No response is sent in this case. The spec was not clear
    and since this should never happen we simply decided to skip the
    command.
    
    X-Original-Commit: 473e050f7fde744ad198d9ce3234115fa5940750

 nimble/controller/include/controller/ble_ll.h      |  13 +
 nimble/controller/include/controller/ble_ll_ctrl.h |   3 +
 nimble/controller/src/ble_ll.c                     |  53 +++
 nimble/controller/src/ble_ll_hci_ev.c              |  44 +++
 nimble/include/nimble/ble.h                        |   4 +
 nimble/include/nimble/hci_common.h                 |   4 +
 .../uart/include/transport/uart/ble_hci_uart.h     |   4 +-
 nimble/transport/uart/src/ble_hci_uart.c           | 377 ++++++++++++++++++---
 8 files changed, 452 insertions(+), 50 deletions(-)

commit 4b36f7d271f3256f420d705507bbfa6c494adae9
Author: William San Filippo <wills@runtime.io>
Date:   Fri Sep 16 15:43:47 2016 -0700

    Add Apache License header. Not sure why this was omitted.
    
    X-Original-Commit: dd79d9310ae84e9f7090ab09141f9916f2c2e102

 nimble/transport/ram/src/ble_hci_ram.c | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit 5532d0e59d9086ab4f5100d85f96681851cc4336
Author: William San Filippo <wills@runtime.io>
Date:   Tue Sep 13 12:27:44 2016 -0700

    MYNEWT-387: Separate ACL data buffer pool for controller only
    
    This change insures that there is the proper user header on the
    mbufs that the HCI interface hands to the controller. It worked
    before as the controller was using the bytes that were stripped
    from the hci header.
    
    X-Original-Commit: 959b389154a3f65e4347642d624bceca6479622f

 nimble/transport/uart/src/ble_hci_uart.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit b990879cc9b7f9747a02f35a7149e013b870d190
Author: William San Filippo <wills@runtime.io>
Date:   Tue Sep 13 08:42:45 2016 -0700

    MYNEWT-387: Separate ACL buffer pool for controller only
    
    The controller (for the controller only implementation) now uses
    a separate pool of buffers for ACL data. This pool is only used
    by the host to send ACL data; the controller will never grab a
    buffer from this pool for any other reason. This was done so that
    the controller and host will stay in sync regarding reported
    total ACL buffers and the number of completed packets. By default,
    4 ACL buffers are allocated. This is quite an arbitrary number
    and should be modified based on memory available and application
    requirements.
    
    X-Original-Commit: 6773301d2fd3f66faed1f466e0235bb65681d510

 .../uart/include/transport/uart/ble_hci_uart.h     |  1 +
 nimble/transport/uart/src/ble_hci_uart.c           | 50 +++++++++++++++++++++-
 2 files changed, 49 insertions(+), 2 deletions(-)

commit 9a363243eabc8c321c829c93b5a01fa8d2a43726
Author: William San Filippo <wills@runtime.io>
Date:   Tue Sep 13 12:27:44 2016 -0700

    MYNEWT-387: Separate ACL data buffer pool for controller only
    
    This change insures that there is the proper user header on the
    mbufs that the HCI interface hands to the controller. It worked
    before as the controller was using the bytes that were stripped
    from the hci header.
    
    X-Original-Commit: 2dfc9bd9be795a6da6f2fc7f14e70e95ae8eb2cb

 nimble/transport/uart/src/ble_hci_uart.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit be4ba608fd1f97762ae55498f2e1e1e378fb9050
Author: William San Filippo <wills@runtime.io>
Date:   Tue Sep 13 08:42:45 2016 -0700

    MYNEWT-387: Separate ACL buffer pool for controller only
    
    The controller (for the controller only implementation) now uses
    a separate pool of buffers for ACL data. This pool is only used
    by the host to send ACL data; the controller will never grab a
    buffer from this pool for any other reason. This was done so that
    the controller and host will stay in sync regarding reported
    total ACL buffers and the number of completed packets. By default,
    4 ACL buffers are allocated. This is quite an arbitrary number
    and should be modified based on memory available and application
    requirements.
    
    X-Original-Commit: 0fa968e2db3f18442ee417affb9fe2105c6f4b09

 .../uart/include/transport/uart/ble_hci_uart.h     |  1 +
 nimble/transport/uart/src/ble_hci_uart.c           | 50 +++++++++++++++++++++-
 2 files changed, 49 insertions(+), 2 deletions(-)

commit 2d4c054d05097e6f8dafbc363ee73c05767446f4
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Sep 12 19:49:17 2016 -0700

    syscfg / sysinit
    
    X-Original-Commit: d98ddc1c5e877d18e5ac68b6d342cf39ba068b20

 nimble/controller/include/controller/ble_ll.h      |   5 +-
 nimble/controller/include/controller/ble_ll_conn.h |   6 +-
 nimble/controller/pkg.yml                          | 170 +++++++++-
 nimble/controller/src/ble_ll.c                     |  68 ++--
 nimble/controller/src/ble_ll_adv.c                 |  21 +-
 nimble/controller/src/ble_ll_conn.c                |  71 ++--
 nimble/controller/src/ble_ll_conn_hci.c            |  13 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   2 +-
 nimble/controller/src/ble_ll_ctrl.c                |  27 +-
 nimble/controller/src/ble_ll_hci.c                 |  21 +-
 nimble/controller/src/ble_ll_hci_ev.c              |   3 +-
 nimble/controller/src/ble_ll_rand.c                |  11 +-
 nimble/controller/src/ble_ll_resolv.c              |  11 +-
 nimble/controller/src/ble_ll_rng.c                 |   2 +-
 nimble/controller/src/ble_ll_scan.c                |  25 +-
 nimble/controller/src/ble_ll_supp_cmd.c            |   4 +-
 nimble/controller/src/ble_ll_whitelist.c           |   5 +-
 nimble/drivers/native/src/ble_hw.c                 |   3 +-
 nimble/drivers/native/src/ble_phy.c                |   5 +-
 nimble/drivers/nrf51/src/ble_hw.c                  |   9 +-
 nimble/drivers/nrf51/src/ble_phy.c                 |  39 +--
 nimble/drivers/nrf52/src/ble_hw.c                  |  11 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |  31 +-
 nimble/host/include/host/ble_gatt.h                |   3 +-
 nimble/host/include/host/ble_hs.h                  | 121 +------
 nimble/host/include/host/ble_sm.h                  |   4 +-
 nimble/host/pkg.yml                                | 206 ++++++++++-
 .../include/services/mandatory/ble_svc_gap.h       |   2 +-
 .../include/services/mandatory/ble_svc_gatt.h      |   2 +-
 nimble/host/services/mandatory/pkg.yml             |   3 +
 nimble/host/services/mandatory/src/ble_svc_gap.c   |   4 +-
 nimble/host/services/mandatory/src/ble_svc_gatt.c  |   4 +-
 .../services/mandatory/src/ble_svc_mandatory.c     |  36 ++
 nimble/host/src/ble_att_clt.c                      |  48 +--
 nimble/host/src/ble_att_priv.h                     |   2 +
 nimble/host/src/ble_att_svr.c                      |  73 ++--
 nimble/host/src/ble_eddystone.c                    |   4 +-
 nimble/host/src/ble_gap.c                          |  40 +--
 nimble/host/src/ble_gattc.c                        | 101 +++---
 nimble/host/src/ble_gatts.c                        | 136 ++++----
 nimble/host/src/ble_hs.c                           | 175 ++++------
 nimble/host/src/ble_hs_adv.c                       |   4 +-
 nimble/host/src/ble_hs_cfg.c                       |  69 +---
 nimble/host/src/ble_hs_conn.c                      |  57 ++--
 nimble/host/src/ble_hs_dbg.c                       |   2 +-
 nimble/host/src/ble_hs_hci.c                       |   6 +-
 nimble/host/src/ble_hs_hci_priv.h                  |   2 +-
 nimble/host/src/ble_hs_misc.c                      |  20 --
 nimble/host/src/ble_hs_priv.h                      |  19 +-
 nimble/host/src/ble_hs_pvcy.c                      |   2 +-
 nimble/host/src/ble_l2cap.c                        |  39 +--
 nimble/host/src/ble_l2cap_sig.c                    |  38 +--
 nimble/host/src/ble_sm.c                           |  69 ++--
 nimble/host/src/ble_sm_alg.c                       | 134 ++++----
 nimble/host/src/ble_sm_cmd.c                       |   2 +-
 nimble/host/src/ble_sm_lgcy.c                      |   2 +-
 nimble/host/src/ble_sm_priv.h                      |   9 +-
 nimble/host/src/ble_sm_sc.c                        |   4 +-
 nimble/host/test/pkg.yml                           |  41 +++
 .../host/{src/test => test/src}/ble_att_clt_test.c |   0
 .../host/{src/test => test/src}/ble_att_svr_test.c |   0
 nimble/host/{src/test => test/src}/ble_gap_test.c  |   2 +
 .../{src/test => test/src}/ble_gatt_conn_test.c    |   0
 .../{src/test => test/src}/ble_gatt_disc_c_test.c  |   0
 .../{src/test => test/src}/ble_gatt_disc_d_test.c  |   0
 .../{src/test => test/src}/ble_gatt_disc_s_test.c  |   0
 .../{src/test => test/src}/ble_gatt_find_s_test.c  |   0
 .../{src/test => test/src}/ble_gatt_read_test.c    |   0
 .../{src/test => test/src}/ble_gatt_write_test.c   |   0
 .../{src/test => test/src}/ble_gatts_notify_test.c |   0
 .../{src/test => test/src}/ble_gatts_read_test.c   |   0
 .../{src/test => test/src}/ble_gatts_reg_test.c    |   0
 .../host/{src/test => test/src}/ble_hs_adv_test.c  |   0
 .../host/{src/test => test/src}/ble_hs_conn_test.c |   0
 .../host/{src/test => test/src}/ble_hs_hci_test.c  |   0
 nimble/host/{src/test => test/src}/ble_hs_test.c   |   3 +-
 .../host/{src/test => test/src}/ble_hs_test_util.c |  70 +---
 .../host/{src/test => test/src}/ble_hs_test_util.h |   1 +
 .../test => test/src}/ble_hs_test_util_store.c     |   0
 .../test => test/src}/ble_hs_test_util_store.h     |   0
 .../host/{src/test => test/src}/ble_l2cap_test.c   |   0
 nimble/host/{src/test => test/src}/ble_os_test.c   |   2 +-
 .../host/{src/test => test/src}/ble_sm_lgcy_test.c |   2 +-
 .../host/{src/test => test/src}/ble_sm_sc_test.c   |   4 +-
 nimble/host/{src/test => test/src}/ble_sm_test.c   |   4 +-
 .../host/{src/test => test/src}/ble_sm_test_util.c |   6 +
 .../host/{src/test => test/src}/ble_sm_test_util.h |   0
 nimble/host/{src/test => test/src}/ble_uuid_test.c |   0
 nimble/include/nimble/nimble_opt.h                 | 377 ---------------------
 nimble/include/nimble/nimble_opt_auto.h            | 104 +++---
 nimble/pkg.yml                                     |  22 ++
 .../ram/include/transport/ram/ble_hci_ram.h        |  24 +-
 nimble/transport/ram/pkg.yml                       |  16 +
 nimble/transport/ram/src/ble_hci_ram.c             |  28 +-
 .../uart/include/transport/uart/ble_hci_uart.h     |   2 +-
 nimble/transport/uart/pkg.yml                      |  32 ++
 nimble/transport/uart/src/ble_hci_uart.c           |  63 ++--
 97 files changed, 1316 insertions(+), 1492 deletions(-)

commit c47f1a6a373002db805f8979e7f0561519457e44
Author: William San Filippo <wills@runtime.io>
Date:   Mon Sep 12 11:20:13 2016 -0700

    MYNEWT-386: Controller should always send connection complete event
    
    The following changes were made to insure that the controller will
    always send a connection complete event to the host. When either
    a connection create command is sent or a start advertising command
    is sent, the controller will attempt to allocate an event buffer
    with which to send the connection complete event. If this fails,
    the controller will return an error: BLE_ERR_MEM_CAPACITY. If
    this succeeds, the controller will then be able to send the
    connection complete event to the host.
    
    X-Original-Commit: 840bb64710b0f576fd39f21ad9dcd62c6fcb322b

 nimble/controller/include/controller/ble_ll_adv.h |   3 +
 nimble/controller/src/ble_ll_adv.c                |  51 ++++++++-
 nimble/controller/src/ble_ll_conn.c               |  40 ++++++-
 nimble/controller/src/ble_ll_conn_hci.c           | 130 +++++++++++++---------
 nimble/controller/src/ble_ll_conn_priv.h          |   3 +-
 5 files changed, 172 insertions(+), 55 deletions(-)

commit 8d6e3b82423657376fb57e8f18e3e35189c3a0fb
Author: William San Filippo <wills@runtime.io>
Date:   Mon Sep 12 11:20:13 2016 -0700

    MYNEWT-386: Controller should always send connection complete event
    
    The following changes were made to insure that the controller will
    always send a connection complete event to the host. When either
    a connection create command is sent or a start advertising command
    is sent, the controller will attempt to allocate an event buffer
    with which to send the connection complete event. If this fails,
    the controller will return an error: BLE_ERR_MEM_CAPACITY. If
    this succeeds, the controller will then be able to send the
    connection complete event to the host.
    
    X-Original-Commit: d56270d97a068e8f0b4116210b66cd01d9c28e20

 nimble/controller/include/controller/ble_ll_adv.h |   3 +
 nimble/controller/src/ble_ll_adv.c                |  51 ++++++++-
 nimble/controller/src/ble_ll_conn.c               |  40 ++++++-
 nimble/controller/src/ble_ll_conn_hci.c           | 130 +++++++++++++---------
 nimble/controller/src/ble_ll_conn_priv.h          |   3 +-
 5 files changed, 172 insertions(+), 55 deletions(-)

commit fa8d3e68fe8866a880a999e0871f6925e8c90f5a
Author: William San Filippo <wills@runtime.io>
Date:   Fri Sep 9 12:38:38 2016 -0700

    MYNEWT-382: Controller number of completed packets event changes
    
    The controller will now send a completed packets event when a
    connection event ends and there is at least one completed
    packet. The NIMBLE_OPT_NUM_COMP_PKT_RATE is still in the code but
    its only real purpose now is to periodically send the number of
    completed packet events when a connection has data buffers in its
    transmit queue but the packets are not completing. The spec
    requires the controller to periodically inform the host in this
    case.
    
    X-Original-Commit: 8559e07f83c48d4749a5f1e710d7843fcd8a83fe

 nimble/controller/src/ble_ll_conn.c      |  4 +---
 nimble/controller/src/ble_ll_conn_hci.c  | 38 +++++++++++++++++++++++++-------
 nimble/controller/src/ble_ll_conn_priv.h |  2 +-
 nimble/include/nimble/nimble_opt.h       | 18 ++++++++++++---
 4 files changed, 47 insertions(+), 15 deletions(-)

commit 38e625ca6944ea74d41e2e8e2c1eae2a6d24f840
Author: William San Filippo <wills@runtime.io>
Date:   Fri Sep 9 12:38:38 2016 -0700

    MYNEWT-382: Controller number of completed packets event changes
    
    The controller will now send a completed packets event when a
    connection event ends and there is at least one completed
    packet. The NIMBLE_OPT_NUM_COMP_PKT_RATE is still in the code but
    its only real purpose now is to periodically send the number of
    completed packet events when a connection has data buffers in its
    transmit queue but the packets are not completing. The spec
    requires the controller to periodically inform the host in this
    case.
    
    X-Original-Commit: 1efc7116c98edc0eccc837c4280b66b6083aa1b5

 nimble/controller/src/ble_ll_conn.c      |  4 +---
 nimble/controller/src/ble_ll_conn_hci.c  | 38 +++++++++++++++++++++++++-------
 nimble/controller/src/ble_ll_conn_priv.h |  2 +-
 nimble/include/nimble/nimble_opt.h       | 18 ++++++++++++---
 4 files changed, 47 insertions(+), 15 deletions(-)

commit 2b41aba07cc78284aa4656ebc42ac85f876ac8c1
Author: Peter Snyder <git@peterfs.com>
Date:   Wed Sep 7 18:46:59 2016 -0700

    Logging format and initialization
    
    MYNEWT-368: Complete logging format changes including saving log format version in fcb struct in flash
    
    MYNEWT-262: Move initialization of logging resources to application. Logging handler is chosen by application and uses standard log_handlers rather than having each app call the handler_init function. Per-instance log structure are declared and initialized in each app and are associated with the log calls by log_register. Separate notion of log "type" for newtmgr (i.e, stream, memory,storage), and how log records are handled (e.g, cbmem, fcb).
    
    Also - fix console_print_prompt() warning, nffs logging
    
    X-Original-Commit: 1fd3fbfe068ed496b92523185a093ecee7c52164

 nimble/host/src/ble_hs.c | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

commit 02fc0e9623c19fd6f3ae9a67a11e99a566e919ec
Author: William San Filippo <wills@runtime.io>
Date:   Tue Sep 6 14:15:28 2016 -0700

    MYNEWT-385: Controller not sending connection update complete event
    
    The nimble controller was not sending the connection update
    complete event if the connection was a slave, the host initiated
    the connection parameter request and only an anchor point move was
    requested. The spec is not perfectly clear but it seems this was a
    bug and that the host should always be notified if it initiates
    the connection update or connection parameter request.
    
    X-Original-Commit: 0bbed7dad069b6f9ddce8fb771a0e47344e0f53d

 nimble/controller/src/ble_ll_conn.c | 2 ++
 1 file changed, 2 insertions(+)

commit 00b60a3176676073dd9224d5a7251156ce365a06
Author: William San Filippo <wills@runtime.io>
Date:   Tue Sep 6 14:15:28 2016 -0700

    MYNEWT-385: Controller not sending connection update complete event
    
    The nimble controller was not sending the connection update
    complete event if the connection was a slave, the host initiated
    the connection parameter request and only an anchor point move was
    requested. The spec is not perfectly clear but it seems this was a
    bug and that the host should always be notified if it initiates
    the connection update or connection parameter request.
    
    X-Original-Commit: 97189e716b11ab59599a7693e838f9ccf51c071f

 nimble/controller/src/ble_ll_conn.c | 2 ++
 1 file changed, 2 insertions(+)

commit 2425a09a18fab10e6df007dd8b7c10fc4a9919f8
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Sep 5 11:10:30 2016 -0700

    MYNEWT-347 BLE Host - GAP update; use L2CAP proc.
    
    Prior to this change, the host did not failover to the L2CAP connection
    parameter update procedure when the GAP update procedure failed.
    Rather, it was up to the application to manually do that.
    
    Now, if the host automatically performs the L2CAP procedure if all of
    the following are true:
        * We are the slave.
        * Controller reports the following status code in its command
          status event:
            o Unknown HCI command (0x01).
        * Controller reports the following status code in its LE connection
          update complete event:
            o Unsupported remote feature (0x1a).
    
    In addition, there was some missing functionality that this commit fills
    in:
        * Timeouts for GAP update procedures (30 seconds).
        * Report and delete outstanding L2CAP sig procedures when the
          connection is broken.
    
    X-Original-Commit: f77bf7fcc18029dd8fc5c7ae380b40d6d3c67465

 nimble/host/include/host/ble_gap.h      |   1 +
 nimble/host/include/host/ble_l2cap.h    |   3 +-
 nimble/host/src/ble_gap.c               | 394 ++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs_conn_priv.h      |   1 -
 nimble/host/src/ble_l2cap_sig.c         |  34 ++-
 nimble/host/src/ble_l2cap_sig_priv.h    |   1 +
 nimble/host/src/test/ble_gap_test.c     | 411 +++++++++++++++++++++++++++-----
 nimble/host/src/test/ble_hs_test_util.c | 112 ++++++++-
 nimble/host/src/test/ble_hs_test_util.h |  14 ++
 nimble/host/src/test/ble_l2cap_test.c   | 135 ++---------
 10 files changed, 887 insertions(+), 219 deletions(-)

commit ca311f922fa8f5891a95c8df6cb8b5b46e84c457
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Sep 5 11:10:30 2016 -0700

    MYNEWT-347 BLE Host - GAP update; use L2CAP proc.
    
    Prior to this change, the host did not failover to the L2CAP connection
    parameter update procedure when the GAP update procedure failed.
    Rather, it was up to the application to manually do that.
    
    Now, if the host automatically performs the L2CAP procedure if all of
    the following are true:
        * We are the slave.
        * Controller reports the following status code in its command
          status event:
            o Unknown HCI command (0x01).
        * Controller reports the following status code in its LE connection
          update complete event:
            o Unsupported remote feature (0x1a).
    
    In addition, there was some missing functionality that this commit fills
    in:
        * Timeouts for GAP update procedures (30 seconds).
        * Report and delete outstanding L2CAP sig procedures when the
          connection is broken.
    
    X-Original-Commit: a3704587c40893b0021a099a9b451653f16c17d6

 nimble/host/include/host/ble_gap.h      |   1 +
 nimble/host/include/host/ble_l2cap.h    |   3 +-
 nimble/host/src/ble_gap.c               | 394 ++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs_conn_priv.h      |   1 -
 nimble/host/src/ble_l2cap_sig.c         |  34 ++-
 nimble/host/src/ble_l2cap_sig_priv.h    |   1 +
 nimble/host/src/test/ble_gap_test.c     | 411 +++++++++++++++++++++++++++-----
 nimble/host/src/test/ble_hs_test_util.c | 112 ++++++++-
 nimble/host/src/test/ble_hs_test_util.h |  14 ++
 nimble/host/src/test/ble_l2cap_test.c   | 135 ++---------
 10 files changed, 887 insertions(+), 219 deletions(-)

commit df122aa24e3f979b99b771224fb791fbe88c9813
Author: William San Filippo <wills@runtime.io>
Date:   Mon Aug 29 22:35:40 2016 -0700

    MYNEWT-374 Code does not build if BLE_LLC_FEAT_LL_PRIVACY=0
    
    The code would not compile if this setting was turned off. It
    is now possible to set this feature to zero to reduce code
    and ram usage of the controller. Also fixed the comment that
    said this feature (privacy) was not supported by the nimble
    controller.
    
    X-Original-Commit: fa876031ec261da95b8fbc45ec63f2c338dea5a3

 nimble/controller/src/ble_ll_adv.c  |  4 ++++
 nimble/controller/src/ble_ll_conn.c | 15 +++++++++++++--
 nimble/controller/src/ble_ll_scan.c | 12 +++++++++---
 nimble/include/nimble/nimble_opt.h  |  3 +--
 4 files changed, 27 insertions(+), 7 deletions(-)

commit 89753b6af4dd16d2d1bcc0903e5b8ece28896623
Author: William San Filippo <wills@runtime.io>
Date:   Mon Aug 29 22:35:40 2016 -0700

    MYNEWT-374 Code does not build if BLE_LLC_FEAT_LL_PRIVACY=0
    
    The code would not compile if this setting was turned off. It
    is now possible to set this feature to zero to reduce code
    and ram usage of the controller. Also fixed the comment that
    said this feature (privacy) was not supported by the nimble
    controller.
    
    X-Original-Commit: 7b5462126e58ea775cfab07f63e71740e0b706f1

 nimble/controller/src/ble_ll_adv.c  |  4 ++++
 nimble/controller/src/ble_ll_conn.c | 15 +++++++++++++--
 nimble/controller/src/ble_ll_scan.c | 12 +++++++++---
 nimble/include/nimble/nimble_opt.h  |  3 +--
 4 files changed, 27 insertions(+), 7 deletions(-)

commit 79b81c1c1fd4cd05640ba511ae3c93318d9a2243
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 26 11:22:10 2016 -0700

    Use SDK include paths for nRF SDK headers.
    
    X-Original-Commit: 24fed7b3fc46159a0c0659316711757991e41364

 nimble/drivers/nrf51/src/ble_hw.c  | 2 +-
 nimble/drivers/nrf51/src/ble_phy.c | 2 +-
 nimble/drivers/nrf52/src/ble_hw.c  | 2 +-
 nimble/drivers/nrf52/src/ble_phy.c | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit 7ed1d2314337a13d6f0813474c5b8a2a9030a417
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Mon Jun 27 09:43:03 2016 -0700

    MYNEWT-317
    
    changes to the code tree to support split applications
    Create a new split library that does the split image functionality for loader, app including config and newtmgr
    fix miscellanous global appearing in header files
    remove unused duplicate bluetooth code
    rework bootutil to add functionality for split images
    format new imagemgr commands for list2 and boot
    
    X-Original-Commit: 5fa1a912e8cacda4609027999ced53d330aa73e0

 nimble/controller/src/ble_ll_rng.c | 60 --------------------------------------
 1 file changed, 60 deletions(-)

commit 132927874d962f3bdd93e3f7dc9b039da7cdcb5b
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Aug 22 17:36:12 2016 -0700

    Fix warnings reported by clang.
    
    X-Original-Commit: 18c8837bdd7bca02771dcc9eaf783d9b2ce01764

 nimble/host/src/ble_sm.c                | 15 +++++----------
 nimble/host/src/ble_sm_alg.c            | 28 ----------------------------
 nimble/host/src/test/ble_hs_test_util.c |  3 ---
 nimble/host/src/test/ble_sm_test_util.c |  3 +--
 4 files changed, 6 insertions(+), 43 deletions(-)

commit 3a249063083aecb3a1e4fdaab3aa589d468a89fa
Author: William San Filippo <wills@runtime.io>
Date:   Mon Aug 22 15:00:45 2016 -0700

    MYNEWT-354
    
    This fixes the compilation error when BLE_LL_CFG_FEAT_LE_ENCRYPTION
    was set to 0. The issue here was that BLE_LL_CFG_FEAT_LE_PING cannot
    be set to 1 if encryption is not defined (set to 0). Note that
    LE_PING can be either defined or undefined (1 or 0) if encryption
    is defined.
    
    X-Original-Commit: 6f3d956f863e03f52ef22513c4b8501a58d6843d

 nimble/include/nimble/nimble_opt.h | 5 +++++
 1 file changed, 5 insertions(+)

commit 155ca3ba75c705158403969de446c84d49e9107b
Author: William San Filippo <wills@runtime.io>
Date:   Mon Aug 15 19:44:27 2016 -0700

    MYNEWT-83: use a fixed buffer for reception.
    
    The changes for this ticket caused the code to ack a packet at
    the link layer even though it was not handed to the host. This
    is an error; the link layer should only ack data packets that
    were handed to the host.
    
    X-Original-Commit: 40c072ebdde316339581823525b5237d4c5565f4

 nimble/controller/include/controller/ble_ll.h  | 11 ++++
 nimble/controller/include/controller/ble_phy.h |  8 +--
 nimble/controller/src/ble_ll.c                 | 73 +++++++++++++++++++++++++-
 nimble/controller/src/ble_ll_conn.c            | 24 ++++++---
 nimble/drivers/native/src/ble_phy.c            | 55 ++++++-------------
 nimble/drivers/nrf51/src/ble_phy.c             | 62 ++++++----------------
 nimble/drivers/nrf52/src/ble_phy.c             | 62 ++++++----------------
 7 files changed, 149 insertions(+), 146 deletions(-)

commit b86bf043adbe619443029ec31490312febd7083d
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 12 18:10:39 2016 -0700

    BLE Host - Only log ATT cmd after tx succeeds.
    
    Before, we were logging each ATT transmission as soon as a higher layer
    requested the send.
    
    Now:
    
    * For client requests, don't log until after transmit succeeds.
    
    * For server responses, don't log until we are sure we will attempt a
    transmission.  Unfortunately, due to the way the server code is
    structures, we don't have the necessary information for logging after
    the transmit occurs.  This is still an improvement, as it prevents
    spurious logging when there are invalid arguments or insufficient
    resources.
    
    X-Original-Commit: 032d0a791af19899312dd9fe8a1053a81b69cf92

 nimble/host/src/ble_att_clt.c | 76 ++++++++++++++++++++++++-------------------
 nimble/host/src/ble_att_svr.c | 10 +++---
 2 files changed, 48 insertions(+), 38 deletions(-)

commit fc7c53bcad9b8188213ace10e35826bb46b2d225
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 12 17:48:00 2016 -0700

    BLE Host - Report updated MTU via GAP event cb.
    
    Before this commit, MTU changes were only reported when we initiated the
    exchange via a GATT procedure.  If the peer initiated the exchange, the
    application never learned of an MTU update.
    
    Now all MTU changes are reported through the GAP event callback.  The
    callback passed to ble_gattc_exchange_mtu() is not very useful anymore.
    Its only real purpose is to inform the user if the peer failed to
    respond to the MTU request, which causes the connection to be terminated
    anyway.
    
    Relevant additions to the API:
    
     #define BLE_GAP_EVENT_MTU                   15
    
     struct ble_gap_event {
         /* [...] */
    
         /**
          * Represents a change in an L2CAP channel's MTU.
          *
          * Valid for the following event types:
          *     o BLE_GAP_EVENT_MTU
          */
         struct {
             /** The handle of the relevant connection. */
             uint16_t conn_handle;
    
             /**
              * Indicates the channel whose MTU has been updated; either
              * BLE_L2CAP_CID_ATT or the ID of a connection-oriented
              * channel.
              */
             uint16_t channel_id;
    
             /* The channel's new MTU. */
             uint16_t value;
         } mtu;
     };
    
    X-Original-Commit: e3750fe0d1e05829b97f6e635d23977369383dd6

 nimble/host/include/host/ble_gap.h      |  21 ++++++
 nimble/host/src/ble_att_clt.c           |   4 +-
 nimble/host/src/ble_att_cmd.c           |  31 ++++-----
 nimble/host/src/ble_att_cmd_priv.h      |   4 +-
 nimble/host/src/ble_att_svr.c           |   6 +-
 nimble/host/src/ble_gap.c               |  17 +++++
 nimble/host/src/ble_gap_priv.h          |   1 +
 nimble/host/src/test/ble_att_clt_test.c |  31 +++++++++
 nimble/host/src/test/ble_att_svr_test.c |   2 +-
 nimble/host/src/test/ble_gap_test.c     | 111 ++++++++++++++++++++++++--------
 nimble/host/src/test/ble_hs_test_util.c |  42 +++++++++++-
 nimble/host/src/test/ble_hs_test_util.h |   5 +-
 12 files changed, 224 insertions(+), 51 deletions(-)

commit d3b0160e288c379d9618d30ceff25f1320a01462
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 12 17:46:39 2016 -0700

    BLE Host - Don't allow >1 tx MTU request per conn.
    
    X-Original-Commit: 277edafa0cdf40067cfffc4596a5bb65d4645986

 nimble/host/src/ble_att_clt.c | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

commit db424f146ee114270213d9cba83c87c83fd44dde
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 12 17:44:19 2016 -0700

    BLE Host - Update conns' pref. MTU
    
    Prior to this commit, setting the preferred MTU only affected future
    connections.
    
    Now, an existing connection is updated if we haven't transmitted our
    preferred MTU over it yet.
    
    X-Original-Commit: 30d5d15550c0c464a7a185a554794730d498dd7e

 nimble/host/src/ble_att.c | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)

commit faba99eb9e0b60e94726f51886e48663b3cd25ff
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 12 17:43:28 2016 -0700

    BLE Host - Function to retrieve preferred ATT MTU.
    
    uint16_t ble_att_preferred_mtu(void);
    
    X-Original-Commit: 567c9c1df35c0c7399fd060145f50072f8e7b6a9

 nimble/host/include/host/ble_att.h |  1 +
 nimble/host/src/ble_att.c          | 19 +++++++++++++++----
 2 files changed, 16 insertions(+), 4 deletions(-)

commit 700728800961324b23890f25017bbaa39e365a33
Author: William San Filippo <wills@runtime.io>
Date:   Thu Aug 11 14:19:56 2016 -0700

    MYNEWT-358: nrf51 cannot connect to directed advertisers w/privacy
    
    In order to fix this issue I have added the local RPA to the resolving list and
    modified the code so that the RPA timer is a true LL timer that will be used
    to regenerate local RPAs at the specified timeout. This allows the local RPA
    to be generated early and not during an IFS interval
    
    X-Original-Commit: 726a600cd594f7c6ae6092a3df58d469178806aa

 .../controller/include/controller/ble_ll_resolv.h  |   7 +-
 nimble/controller/src/ble_ll_adv.c                 |  17 +++
 nimble/controller/src/ble_ll_conn.c                |   1 +
 nimble/controller/src/ble_ll_resolv.c              | 150 ++++++++++++++++-----
 nimble/controller/src/ble_ll_scan.c                |   2 +-
 5 files changed, 142 insertions(+), 35 deletions(-)

commit de00c59b174a6c41056e6b481faa25222f71c77c
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jul 25 10:16:41 2016 -0700

    MYNEWT_83: Use fixed buffer for reception.
    
    On the nrf51, copying the fixed buffer was taking too long for certain
    operations. The code changes associated with this commit are due to
    this issue.
    
    X-Original-Commit: ea5736edb6914f1a56905fbce00ede5938aa7824

 nimble/controller/src/ble_ll.c           | 16 ++++++-------
 nimble/controller/src/ble_ll_conn.c      | 41 +++++++++++++++++++-------------
 nimble/controller/src/ble_ll_conn_priv.h |  3 ++-
 nimble/controller/src/ble_ll_resolv.c    | 25 +++++++++++++++----
 nimble/controller/src/ble_ll_scan.c      |  4 ++--
 5 files changed, 57 insertions(+), 32 deletions(-)

commit 4aa1641809b893471897e321f69baabb00c2fb76
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jul 25 10:06:41 2016 -0700

    MYNEWT-83: use fixed buffer for reception. Get native arch building
    
    X-Original-Commit: 7c8cca9f88ebf86717b2941c4484065ffb2a2438

 nimble/drivers/native/src/ble_phy.c | 184 ++++++++++++++++++++++++++++--------
 1 file changed, 142 insertions(+), 42 deletions(-)

commit 62e1d7503987d2105cfd4b3c3f0648ed1c4c99b7
Author: William San Filippo <wills@runtime.io>
Date:   Wed Jul 20 04:19:57 2016 -0700

    MYNEWT-83: Use a fixed buffer for reception for controller stack
    
    The nimble stack was using mbufs for reception and now uses a
    static buffer. The reason behind the change is that we wanted
    to be able to receive a frame even though no mbufs were available.
    This would allow transmit packets to receive ACKs and thus free
    up transmit buffers waiting on connection queues.
    
    There were a number of code changes associated with the phy API.
    Implemented a more efficient copy routine to copy words from
    the static rx buffer into mbufs. Note that this is not yet done
    for transmit frames as we are not sure we could guarantee that
    the data pointer is aligned.
    
    X-Original-Commit: 580f5b6dd8c56c4fe3e0b4df287c25506a8ec048

 nimble/controller/include/controller/ble_ll.h      |  11 +-
 nimble/controller/include/controller/ble_ll_scan.h |   2 +-
 nimble/controller/include/controller/ble_phy.h     |   7 +
 nimble/controller/src/ble_ll.c                     |  64 ++----
 nimble/controller/src/ble_ll_conn.c                |  77 ++++----
 nimble/controller/src/ble_ll_conn_priv.h           |   2 +-
 nimble/controller/src/ble_ll_scan.c                |   6 +-
 nimble/controller/src/ble_ll_sched.c               |  14 +-
 nimble/drivers/nrf51/src/ble_phy.c                 | 215 +++++++++++++-------
 nimble/drivers/nrf52/src/ble_phy.c                 | 217 ++++++++++++++-------
 nimble/include/nimble/nimble_opt.h                 |   4 +-
 11 files changed, 383 insertions(+), 236 deletions(-)

commit f424b9a16944f0b3547c8561d118a236df8854fd
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 11 15:56:09 2016 -0700

    BLE Host - sm,sc - ask for pk after rx pubkey
    
    This bug occurs during secure connections pairing under the following
    conditions:
    
    * Initiator
    * Pairing algorithm = passkey
    
    The bug is that the host asked the application to input the passkey
    before it was ready to accept it.  The host was asking for the passkey
    immediately after sending its public key, but it isn't ready to accept
    it until after the reponder sends its public key.  The fix is to wait
    until receiving the responder's public key before asking for the
    passkey.
    
    This fix isn't ideal.  Ideally, the host would continue asking for the
    passkey immediately, and would be able to accept it.  The easy
    short-term fix is to hold off on asking the application.
    
    X-Original-Commit: 95c70a5f0c20421131114d2c40853c469bddf8ed

 nimble/host/src/ble_sm_sc.c             | 16 +++++++++++-----
 nimble/host/src/test/ble_sm_test_util.c |  9 +++++++--
 2 files changed, 18 insertions(+), 7 deletions(-)

commit 23ab5f5d74a8e0d706618dfed048271d65dc84de
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 11 13:49:16 2016 -0700

    BLE - Fix out-of-date comment.
    
    X-Original-Commit: bfdeb421058a3b253bd83d3a4d3c01847b80a01c

 nimble/transport/ram/src/ble_hci_ram.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit efe1e214d26f55bbc7b08fee48d1acc1e783e1a5
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 11 13:39:53 2016 -0700

    BLE Ctlr - max evt sz too low for rd-lcl-sup-ftrs
    
    In a previous commit (8b8d887358be1d64e6002fb4efb6b4e0673a1760), the max
    event size was reduced from 260 to 45.  The belief was that the largest
    event the NimBLE controller sends is 45 bytes (advertising report with
    one entry, entry has 0x1f data bytes).  However, the controller's
    response to the read-local-supported-features HCI command is larger:
    0x44 + 2 byte header = 0x46 (70).
    
    X-Original-Commit: 3b6e2f10b034f367320addba2cf1372637e24f36

 nimble/controller/include/controller/ble_ll_hci.h | 2 +-
 nimble/transport/ram/src/ble_hci_ram.c            | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 249f84e4888e6c468638df6f5cbfa40294c873a3
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 11 13:31:37 2016 -0700

    BLE Host - Send correct error code for unsup. n/i.
    
    Previously, if a peer attempted to enable notifications or indications
    for a characteristic that did not support them, the elicited error
    response had an error code of 3 (BLE_ATT_ERR_WRITE_NOT_PERMITTED).
    
    Now, the error response has a code of 6 (BLE_ATT_ERR_REQ_NOT_SUPPORTED).
    
    The spec does not appear to indicate the correct error t osend in this
    case.  I believe req-not-supported is more correct than
    write-not-permitted.
    
    X-Original-Commit: c7511b3dade17eb9853c293bab27952bd6fdd6f6

 nimble/host/src/ble_gatts.c                  |  2 +-
 nimble/host/src/test/ble_att_svr_test.c      | 98 ++++++++-------------------
 nimble/host/src/test/ble_gatts_notify_test.c | 99 ++++++++++++++++++++++++++--
 nimble/host/src/test/ble_hs_test_util.c      | 39 +++++++++++
 nimble/host/src/test/ble_hs_test_util.h      |  3 +
 5 files changed, 167 insertions(+), 74 deletions(-)

commit 9946e00ebd13b9876695e5379cb18e9d20815d63
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 10 17:30:21 2016 -0700

    BLE Host - Allow MTU to be checked for unconn peer
    
    A previous commit (8ec1b8d9aa8b33a1a26e0d47841331870e97cd88) went a
    little overboard in assuming a peer is connected.  Some code checks a
    peer's MTU without knowing if the peer is connected.  A return value of
    0 indicates the peer is not connected.
    
    X-Original-Commit: 06c79c4be3d39acfeba09d843355411d6a28627f

 nimble/host/src/ble_att.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit aaa995deabdb75991c9b11a400249b1c7b8688fd
Merge: 6fdebaf9 8fcf0503
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 10 14:13:31 2016 -0700

    This closes #88.
    Merge remote-tracking branch 'bgiori/refactor-services' into develop
    
    * bgiori/refactor-services:
      Refactored file structure for premade services.
    
    X-Original-Commit: e291e12d37c24f3124553dea454b303d561a7cb2

commit 6fdebaf95187141d481939f574d4aae9dde7e230
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 10 13:45:12 2016 -0700

    BLE Host - Check conn state once before proc.
    
    Much of the host code repeatedly checks if a peer is connected while it
    processes incoming data packets.  This is not necessary, because:
    
    1. The peer's connected state is checked at the top level before the
       packet is processed.
    2. Peer removal and packet processing is done in the same task.
    
    This commit removes a bunch of redundant connectivity checks.
    
    X-Original-Commit: 8ec1b8d9aa8b33a1a26e0d47841331870e97cd88

 nimble/host/src/ble_att.c          |   9 +-
 nimble/host/src/ble_att_clt.c      |  22 ++---
 nimble/host/src/ble_att_priv.h     |   4 +-
 nimble/host/src/ble_att_svr.c      | 179 ++++++++++++-------------------------
 nimble/host/src/ble_gattc.c        |  10 +--
 nimble/host/src/ble_hs_conn.c      |  11 +++
 nimble/host/src/ble_hs_conn_priv.h |   1 +
 nimble/host/src/ble_hs_misc.c      |   6 +-
 nimble/host/src/ble_hs_priv.h      |   6 +-
 nimble/host/src/ble_l2cap_sig.c    |  45 ++++------
 nimble/host/src/ble_sm.c           |  68 ++++----------
 nimble/host/src/ble_sm_cmd.c       |   9 +-
 nimble/host/src/ble_sm_lgcy.c      |   7 +-
 nimble/host/src/ble_sm_priv.h      |   8 +-
 nimble/host/src/ble_sm_sc.c        |  43 +++------
 15 files changed, 143 insertions(+), 285 deletions(-)

commit b68a6709be49d77b9d2317065031959e2326d9f7
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 17:53:46 2016 -0700

    BLE RAM trans: evt buf sz 260-->45; ct 3-->14
    
    For the combined host-controller (RAM HCI transport), the default HCI
    event buffer size was much larger than necessary.  The largest event the
    NimBLE controller will send is 45 bytes, but the default buffer size was
    260.
    
    This change:
    
    * reduces the default event buffer size from 260 to 45
    * increases the default lo-prio event count from 2 to 12
    * increases the default hi-prio event count from 1 to 2
    
    X-Original-Commit: 8b8d887358be1d64e6002fb4efb6b4e0673a1760

 nimble/controller/include/controller/ble_ll_hci.h |  3 +++
 nimble/controller/src/ble_ll_conn_hci.c           | 32 +++++++++++------------
 nimble/controller/src/ble_ll_hci.c                |  2 ++
 nimble/host/include/host/ble_hs.h                 | 18 ++-----------
 nimble/host/src/ble_hs_cfg.c                      |  2 +-
 nimble/transport/ram/src/ble_hci_ram.c            |  8 +++---
 6 files changed, 29 insertions(+), 36 deletions(-)

commit 66b754b6940f9144ea26174045bc54bb1bf19d0f
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 17:51:37 2016 -0700

    BLE Host - Fix crash when #-evt-bufs > #-os-events
    
    When the host could not allocate an OS event for the incoming HCI event,
    it tried to free the wrong thing, resulting in a null pointer
    dereference.
    
    X-Original-Commit: 22e7eabb0238e93bab7e0a48dc3ba505150426fa

 nimble/host/src/ble_hs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4b82b5ef243208523b80457dd22429a32e55d21e
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 17:50:21 2016 -0700

    BLE Host - Add missing break statement.
    
    This fixes a minor bug - the sending of notifications / indications
    would cause the tx and rx queues to be processed unnecessarily.
    
    X-Original-Commit: 665d8dc4d07c0aa65e3fdc1eb26a673c001c5930

 nimble/host/src/ble_hs.c | 1 +
 1 file changed, 1 insertion(+)

commit 844ed0a9b3166b2f77b6e184321a254eb9b5dd15
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 17:01:02 2016 -0700

    fixup adv
    
    X-Original-Commit: e02d7abab902a1ad509bef3b45a225df2e45e026

 nimble/host/include/host/ble_hs_adv.h | 3 +++
 nimble/host/src/ble_hs_adv.c          | 3 ---
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 7c1d8e175b1cb26adec7ce2158bfb7274e05dc26
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 16:57:35 2016 -0700

    BLE Host - Don't reject max-size adv field.
    
    The host would reject an advertising report if it contains a 31-byte
    field (maximum size allowed).  It was incorrectly limiting fields to 30
    bytes.
    
    X-Original-Commit: 0d279b6933a15c5c76264a1f4325810470dd0fdb

 nimble/host/src/ble_hs_adv.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit bbbde4f365161334bc14dbe456c2e2b0bb40eee3
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 16:36:02 2016 -0700

    BLE Host - Set state before tx HCI enable.
    
    Prior to this change, for advertising, connecting, and scanning, the
    host didn't update its GAP state until after all HCI commands were sent
    to the controller.  This creates a race condition, because the
    controller may act on the enable command before the host GAP state has
    been updated.
    
    For example, as soon as the host tells the controlller to
    start scanning, the controller may send an advertisement report event.
    If the host has not updated its state yet, the advertising report gets
    dropped.
    
    Now, the host updates its state before sending the enable command to the
    controller.  Unfortunately, this means the host needs to undo the state
    update if the enable command fails to be sent.
    
    X-Original-Commit: defcd4195f1c4e4d80935f371a0677ff66c0a42e

 nimble/host/src/ble_gap.c | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

commit b6884c44afcd0af9df4c2c2e9fc2ed91725e4299
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 12:46:50 2016 -0700

    BLE Host - Cleanup att_svr rx prep / exec write.
    
    While debugging an mbuf leak, I noticed this code was much more
    complicated than it needs to be.
    
    X-Original-Commit: 79922ef3b2f0f52721a23f4a62d0f9a34f39737d

 nimble/host/src/ble_att_svr.c | 123 ++++++++++++++++++++----------------------
 1 file changed, 57 insertions(+), 66 deletions(-)

commit 8191d200a6516a8bf698c3e102ccdd9590fc5ac5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 12:41:53 2016 -0700

    BLE Host - reuse exec-write-req mbuf for rsp.
    
    The response has the same contents as the request; only the op code is
    different.  By reusing the mbuf, it makes failure due to mbuf exhaustion
    less likely.
    
    X-Original-Commit: abd5a7527234d834d1bf2bde9e1ddbf288674821

 nimble/host/src/ble_att_svr.c | 41 +++++++++++++----------------------------
 1 file changed, 13 insertions(+), 28 deletions(-)

commit fd1cfbdcf2a16fee79d3fa121fe671cc0bace3fc
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 10:33:36 2016 -0700

    ble - Transports return BLE_ERR_ return codes.
    
    Prior to this change, the HCI transports return code behavior was
    inconsistent.  Sometimes BLE_ERR codes were returned; other times plain
    errno values were returned.
    
    Now only BLE_ERR error codes are returned.
    
    X-Original-Commit: 2521994509555c194f1e4886f1f707f8eb59620c

 nimble/include/nimble/ble.h              |  2 ++
 nimble/src/ble_util.c                    | 43 ++++++++++++++++++++++++++++++++
 nimble/transport/ram/src/ble_hci_ram.c   | 42 +++++++++++--------------------
 nimble/transport/uart/src/ble_hci_uart.c | 40 ++++++++++-------------------
 4 files changed, 73 insertions(+), 54 deletions(-)

commit a363d3f14792f5b02edae10b0f257e9c50becc13
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 18:13:26 2016 -0700

    BLE Host - Fix unit test SIGSEGV.
    
    An array was missing a '0' terminator.
    
    X-Original-Commit: 8cecd61dfd5aa38a68bd508ed8f077b9288cca9a

 nimble/host/src/test/ble_hs_test_util.c | 3 +++
 1 file changed, 3 insertions(+)

commit 3501040777a5a4aca6383de68cfb9962778386e4
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 17:59:02 2016 -0700

    BLE Host - prep/exec tests: better mbuf leak check
    
    When ensuring no mbuf leaks at the end of the att_svr_test suite, also
    ensure that each connection's prep list is empty.
    
    X-Original-Commit: 004d61d9b35c5d9a12cc83f7d1c1c01b9067ce2d

 nimble/host/src/test/ble_att_svr_test.c |  9 ++++++-
 nimble/host/src/test/ble_hs_test_util.c | 46 +++++++++++++++++++++++----------
 nimble/host/src/test/ble_hs_test_util.h | 12 +++++++--
 3 files changed, 50 insertions(+), 17 deletions(-)

commit 47f0e5b1eaf7b8e10d68df0870be9430a4b21e6a
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 17:58:16 2016 -0700

    BLE Host - gap test needs to hb when checking tmo.
    
    When ensuring that the passage of time causes no effects, the test node
    needs to call ble_hs_heartbeat() to let the host know that time has
    passed.  This is only necessary because the OS is not running during
    this test.
    
    X-Original-Commit: f1020d3e60b743d1784a5225ae9b57a07e5cebf0

 nimble/host/src/test/ble_gap_test.c | 1 +
 1 file changed, 1 insertion(+)

commit 48eb5276d0630b41d63dec6bbce42e40521baddd
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 17:48:44 2016 -0700

    BLE Host - validate write upon rx of prep write
    
    Before, upon receiving a prepare write request, the code was only
    verifying that the specified attribute existed.  There are a number of
    checks that need to be performed in addition to that one:
    
    1. Insufficient authorization.
    2. Insufficient authentication.
    3. Insufficient encryption key size.
    4. Insufficient encryption (check if persisted bond exists for
       unencrypted peer).
    5. Invalid handle.
    6. Write not permitted.
    
    The host does not properly handle 3 and 4 yet (for any writes).
    
    Now the host rejects a prepare write request if any of the above issues
    are detected (except for 3 and 4).
    
    X-Original-Commit: d6fab4dc747569d176782a056544572c0b746c72

 nimble/host/src/ble_att_svr.c           | 69 ++++++++++++++++++++-------------
 nimble/host/src/test/ble_att_svr_test.c | 62 ++++++++++++++++++++++++-----
 2 files changed, 95 insertions(+), 36 deletions(-)

commit 976b04b9d75892b732ff625be668cfc311ddb92b
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 02:34:00 2016 -0700

    BLE Host - Free mbufs on exec-write-failure
    
    The previous fix didn't fix an mbuf leak.  It added one!  The real bug
    was that an exec-write-response (success) gets sent when a write fails.
    This commit fixes the mbuf leak that was introduced.
    
    X-Original-Commit: de85f43dec28a329d5b937936045ba840423318f

 nimble/host/src/ble_att_svr.c | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit 8167790d37e7d032e4349c6ca7dedc1483402d6a
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 16:06:06 2016 -0700

    BLE Host - Send exec-write when prep-writes cmplt.
    
    This fixes a bug where the GATT client would never send the execute
    write command when performing a long-write procedure.  Instead, it would
    repeatedly send 0-length prepare write requests.
    
    Also, the GATT client is now more strict about when it accepts prepare
    write responses and execute write responses.  Some unit tests were
    passing, despite the bug described in the above paragraph, because an
    incoming execute write response was accepted when it should have been.
    
    X-Original-Commit: aadba6283aabeacd9a4dfc7c7c3c0ddfbe8b04c1

 nimble/host/src/ble_gattc.c                | 44 +++++++++-------
 nimble/host/src/test/ble_gatt_write_test.c | 82 ++++++++++++++++++++++++------
 nimble/host/src/test/ble_hs_test_util.c    | 23 +++++++++
 nimble/host/src/test/ble_hs_test_util.h    |  3 ++
 4 files changed, 120 insertions(+), 32 deletions(-)

commit 95ba2e90feb5b9981c5a0cd6d08d87a524b9ee00
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 16:04:17 2016 -0700

    BLE Host - Free mbufs on exec-write-failure
    
    This was an mbuf leak.  If the device receives an exec-write request,
    and the attribute callback fails (or the attribute doesn't allow writes
    at all), the mbufs holding the data intended to be written to that
    attribute never got freed.
    
    X-Original-Commit: fbdb1baee9f88899eb61470a44fea4cca06e52a3

 nimble/host/src/ble_att_svr.c           |  6 ++++--
 nimble/host/src/ble_gattc.c             |  8 ++++++++
 nimble/host/src/test/ble_att_svr_test.c | 14 +++++++++++++-
 3 files changed, 25 insertions(+), 3 deletions(-)

commit 1476f737f156f4424a40469fe4d273e8579fb26c
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 14:12:03 2016 -0700

    BLE Host - doxy comments for ble_gatts_count_cfg()
    
    X-Original-Commit: f36fa7c09a2fb9a8e099fd0d06f8f63c5849de05

 nimble/host/src/ble_gatts.c | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

commit f5f377057926b1ca62729f2dad3d99df913b04c1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:19:15 2016 -0700

    BLE Host - Don't assume leading space in l2cap tx.
    
    Call os_mbuf_prepend_pullup() rather than calling os_mbuf_prepend() and
    assuming the resulting buffer is the same as the input.
    
    X-Original-Commit: 1efa31fc2ef422d804c926271516c8735b833f05

 nimble/host/src/ble_l2cap.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit 7445c126f34620197c279715aae602e5170e46ce
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:18:13 2016 -0700

    BLE Host - Clean up ACL tx fragmentation.
    
    This commit does not result in a change in behavior.  The fragmentation
    code was overly complicated.  This change just simplifies the
    implementation.
    
    X-Original-Commit: 009bb6cce4be2a2431d4084f630f152220abeb0d

 nimble/host/src/ble_hs_hci.c | 34 ++++++++++++----------------------
 1 file changed, 12 insertions(+), 22 deletions(-)

commit b05a792e88936b8149bdeb6058151aa6a843bdab
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:16:40 2016 -0700

    BLE Host - Free mbuf on os_mqueue_put() failure.
    
    This fixes a theoretical mbuf leak.  In practice, the call to
    os_mqueue_put() will never fail.
    
    X-Original-Commit: 259f4c3bfc72afdd69c78b82ffbc43fc9d2a39d8

 nimble/host/src/ble_hs.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 9c021c74bb3c4122103d64acc7c8d1c3ba831c87
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:15:11 2016 -0700

    BLE Host - Use os_mbuf_append_from, not handrolled
    
    This commit does not change any behavior.  Some code was re-inventing
    os_mbuf_append_from().  Now it just calls the function.
    
    X-Original-Commit: a449b7027cdfae7941c24c434c7cb2c713b1bf4e

 nimble/host/src/ble_att_svr.c | 17 +++++------------
 1 file changed, 5 insertions(+), 12 deletions(-)

commit 8b94ea07bff53f342ed4ecbc2a0b07d8949ae066
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 14:08:59 2016 -0700

    BLE Host - distinguish already/busy in conn/disc.
    
    Prior to this change, both ble_gap_connect() and ble_gap_disc() return
    BLE_HS_EALREADY if any master procedure was already in progress (either
    connect or discover).
    
    Now, Each function returns:
    
        * BLE_HS_EALREDY if the same procedure is already in progress
        * BLE_HS_EBUSY if the other procedure is already in progress
    
    X-Original-Commit: 5863ce670c583412b951103a849497d2347907cc

 nimble/host/src/ble_gap.c           |  13 ++++-
 nimble/host/src/test/ble_gap_test.c | 111 ++++++++++++++++++++++++++++++------
 2 files changed, 105 insertions(+), 19 deletions(-)

commit e8a430e4344f077e8d0aa5251b5fc0545a8185aa
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 10:37:27 2016 -0700

    BLE UART HCI - Remove debug log.
    
    This was accidentally included in the initial commit!
    
    X-Original-Commit: 8f4f2cbb98118da03e77f8f8518885c306a0a978

 nimble/transport/uart/src/ble_hci_uart.c | 18 ------------------
 1 file changed, 18 deletions(-)

commit 04346bb98f7cb0747283fc1bd67fcbeb7c7e6a86
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 4 16:31:05 2016 -0700

    NimBLE - high / low prio event buffers.
    
    Events have one of two priorities:
    o Low-priority   (BLE_HCI_TRANS_BUF_EVT_LO)
    o High-priority  (BLE_HCI_TRANS_BUF_EVT_HI)
    
    Low-priority event buffers are only used for advertising reports.  If
    there are no free low-priority event buffers, then an incoming
    advertising report will get dropped.
    
    High-priority event buffers are for everything except advertising
    reports.  If there are no free high-priority event buffers, a request to
    allocate one will try to allocate a low-priority buffer instead.
    
    If you want all events to be given equal treatment, then you should
    allocate low-priority events only.
    
    Event priorities solve the problem of critical events getting dropped
    due to a flood of advertising reports.  This solution is likely
    temporary: when HCI flow control is added, event priorities may become
    obsolete.
    
    Not all transports distinguish between low and high priority events.  If
    the transport does not have separate settings for low and high buffer
    counts, then it treats all events with equal priority.
    
    X-Original-Commit: a7f8b7ac6dec6551c55fb4237b086373b15fa67b

 nimble/host/src/test/ble_hs_test_util.c            |  1 -
 nimble/include/nimble/ble_hci_trans.h              | 27 ++++--
 .../ram/include/transport/ram/ble_hci_ram.h        | 17 +++-
 nimble/transport/ram/src/ble_hci_ram.c             | 95 ++++++++++++++++------
 4 files changed, 110 insertions(+), 30 deletions(-)

commit e8beeffb155dff806d8804630d49ba07e1511b90
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 4 13:39:25 2016 -0700

    BLE Host - Use os_eventq_poll()
    
    Before, the host code implemented an eventq "peek" operation:
    * disable interrupts
    * check whether anything is on the eventq
    * enable interrupts
    * if something was on the queue, call os_eventq_get().
    
    Unlike os_eventq_get(), os_eventq_poll() takes a timeout parameter.  Now
    the host calls os_eventq_poll() with a timeout of 0 to perform a
    non-blocking read of the eventq.
    
    X-Original-Commit: f3d4aaae011cc027ffa73a5a1d77d54a4e59d6d7

 nimble/host/src/ble_hs.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

commit 0dac878baea7f5b72717bae93f5a69b6d3b822c8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 3 18:41:01 2016 -0700

    BLE Host - Rename HCI identifiers and files.
    
    The HCI-related host functionality was using some really inconsistent
    names.  Identifiers and files have been renamed as reorganized as
    follows:
    
    * host_dbg      --> ble_hs_dbg
    * host_hci_cmd  --> ble_hs_hci_cmd
    * host_hci      --> ble_hs_hci_evt / ble_hs_hci
    * ble_hci_util  --> ble_hs_hci_util
    
    X-Original-Commit: 36254fc19e47969cd13338ea065625c886df5881

 nimble/host/include/host/ble_hs.h                  |   1 -
 nimble/host/include/host/ble_hs_test.h             |   2 +-
 nimble/host/include/host/host_hci.h                | 130 -----
 nimble/host/src/ble_eddystone.c                    |   2 +-
 nimble/host/src/ble_gap.c                          |  85 ++--
 nimble/host/src/ble_gap_priv.h                     |   2 +-
 nimble/host/src/ble_gattc.c                        |   4 +-
 nimble/host/src/ble_hci_cmd.c                      | 320 -------------
 nimble/host/src/ble_hci_priv.h                     |  51 --
 nimble/host/src/ble_hs.c                           |   9 +-
 nimble/host/src/ble_hs_adv.c                       |   2 +-
 nimble/host/src/ble_hs_conn.c                      |   1 -
 nimble/host/src/{host_dbg.c => ble_hs_dbg.c}       |  48 +-
 .../src/{host_dbg_priv.h => ble_hs_dbg_priv.h}     |   7 +-
 nimble/host/src/ble_hs_hci.c                       | 528 +++++++++++++++++++++
 .../host/src/{host_hci_cmd.c => ble_hs_hci_cmd.c}  | 453 +++++++++---------
 nimble/host/src/{host_hci.c => ble_hs_hci_evt.c}   | 392 ++++-----------
 nimble/host/src/ble_hs_hci_priv.h                  | 158 ++++++
 .../host/src/{ble_hci_util.c => ble_hs_hci_util.c} |  58 ++-
 nimble/host/src/ble_hs_id.c                        |   4 +-
 nimble/host/src/ble_hs_priv.h                      |   7 +-
 nimble/host/src/ble_hs_pvcy.c                      |  18 +-
 nimble/host/src/ble_hs_startup.c                   |  35 +-
 nimble/host/src/ble_ibeacon.c                      |   2 +-
 nimble/host/src/ble_l2cap.c                        |   3 +-
 nimble/host/src/ble_sm.c                           |  26 +-
 nimble/host/src/ble_sm_alg.c                       |   5 +-
 nimble/host/src/ble_sm_sc.c                        |   2 +-
 nimble/host/src/test/ble_att_clt_test.c            |   9 +-
 nimble/host/src/test/ble_gap_test.c                |  49 +-
 nimble/host/src/test/ble_gatt_read_test.c          |  21 +-
 nimble/host/src/test/ble_hs_adv_test.c             |   1 -
 nimble/host/src/test/ble_hs_conn_test.c            |   1 -
 .../{ble_host_hci_test.c => ble_hs_hci_test.c}     |  27 +-
 nimble/host/src/test/ble_hs_test.c                 |   2 +-
 nimble/host/src/test/ble_hs_test_util.c            |  83 ++--
 nimble/host/src/test/ble_l2cap_test.c              |   4 +-
 nimble/host/src/test/ble_os_test.c                 |   3 +-
 nimble/host/src/test/ble_sm_lgcy_test.c            |   1 -
 nimble/host/src/test/ble_sm_sc_test.c              |   1 -
 nimble/host/src/test/ble_sm_test.c                 |   1 -
 nimble/host/src/test/ble_sm_test_util.c            |  21 +-
 nimble/host/store/ram/src/ble_store_ram.c          |   3 +-
 43 files changed, 1302 insertions(+), 1280 deletions(-)

commit a1291acb5bc2b98d99e095263a38b2bd8545b54f
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 3 13:30:54 2016 -0700

    BLE Host - Reset on hardware error.
    
    X-Original-Commit: c78db9702cd9b092756cabbeab6694e4f9608315

 nimble/host/include/host/ble_hs.h  |  4 ++++
 nimble/host/src/ble_hs.c           |  6 ++++++
 nimble/host/src/ble_hs_priv.h      |  1 +
 nimble/host/src/host_hci.c         | 17 +++++++++++++++++
 nimble/include/nimble/hci_common.h |  3 +++
 5 files changed, 31 insertions(+)

commit 2da4e98d7d90b489326f953924a67fc43312e729
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 3 19:44:39 2016 -0700

    BLE Host - Use HCI transport API
    
    Prior to this change, the host assumed it was running with a combined
    host-controller setup.  Now it uses the available HCI transport instead.
    
    X-Original-Commit: 0fd02e1e719c9f296e151e89d57ac34c80a870f1

 nimble/controller/include/controller/ble_ll.h      |   1 +
 nimble/controller/pkg.yml                          |   6 +-
 nimble/controller/src/ble_ll.c                     |  17 +
 nimble/controller/src/ble_ll_conn.c                |   6 +-
 nimble/controller/src/ble_ll_conn_hci.c            |   9 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   7 +
 nimble/controller/src/ble_ll_hci.c                 |  14 +-
 nimble/controller/src/ble_ll_hci_ev.c              |  15 +-
 nimble/controller/src/ble_ll_scan.c                |   3 +-
 nimble/host/include/host/ble_hs.h                  |  28 +-
 nimble/host/include/host/ble_hs_test.h             |   3 -
 nimble/host/include/host/host_hci.h                |   8 +-
 nimble/host/pkg.yml                                |  15 +-
 nimble/host/src/ble_gap.c                          |   2 +-
 nimble/host/src/ble_gap_priv.h                     |   2 +-
 nimble/host/src/ble_hci_cmd.c                      |  58 +-
 nimble/host/src/ble_hs.c                           | 224 ++++--
 nimble/host/src/ble_hs_atomic.c                    |  20 +
 nimble/host/src/ble_hs_atomic_priv.h               |   1 +
 nimble/host/src/ble_hs_priv.h                      |  16 +
 nimble/host/src/ble_hs_pvcy.c                      |  27 +-
 nimble/host/src/ble_hs_pvcy_priv.h                 |   2 +-
 nimble/host/src/ble_hs_startup.c                   |   4 -
 nimble/host/src/host_dbg.c                         |   2 +-
 nimble/host/src/host_hci.c                         |  49 +-
 nimble/host/src/host_hci_cmd.c                     |  52 +-
 nimble/host/src/test/ble_gap_test.c                |  11 +-
 nimble/host/src/test/ble_host_hci_test.c           |   8 +-
 nimble/host/src/test/ble_hs_test.c                 |  16 -
 nimble/host/src/test/ble_hs_test_util.c            |  96 ++-
 nimble/host/src/test/ble_hs_test_util.h            |   2 +
 nimble/host/src/test/ble_os_test.c                 |   2 +-
 nimble/host/src/test/ble_sm_test_util.c            |  20 +-
 nimble/include/nimble/ble.h                        |   4 -
 nimble/include/nimble/ble_hci_trans.h              | 152 ++++
 nimble/include/nimble/hci_transport.h              |  32 -
 .../ram/include/transport/ram/ble_hci_ram.h        |  15 +
 nimble/transport/ram/pkg.yml                       |  33 +
 nimble/transport/ram/src/ble_hci_ram.c             | 190 +++++
 .../uart/include/transport/uart/ble_hci_uart.h     |  19 +
 nimble/transport/uart/pkg.yml                      |  34 +
 nimble/transport/uart/src/ble_hci_uart.c           | 775 +++++++++++++++++++++
 42 files changed, 1731 insertions(+), 269 deletions(-)

commit 4bc1f1d9fb01d783f4a4face1a38c4fca205ea73
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Aug 1 13:32:25 2016 -0700

    BLE Host - Read BD_ADDR on startup.
    
    X-Original-Commit: aff82c39b896b46a4041669126bcb6e42f117be0

 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/ble_hs_startup.c    | 30 +++++++++++++++++++++++++++---
 nimble/host/src/host_hci_cmd.c      | 14 ++++++++++++++
 nimble/include/nimble/hci_common.h  |  3 +++
 4 files changed, 45 insertions(+), 3 deletions(-)

commit 19521f56520bacccf686210f59953e2347168b80
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 12:46:50 2016 -0700

    BLE Host - Cleanup att_svr rx prep / exec write.
    
    While debugging an mbuf leak, I noticed this code was much more
    complicated than it needs to be.
    
    X-Original-Commit: 96b7f79f2c6348b257f4b43cc153b0c5604a5434

 nimble/host/src/ble_att_svr.c | 123 ++++++++++++++++++++----------------------
 1 file changed, 57 insertions(+), 66 deletions(-)

commit 95f7f2f085cab940edad35c31d21acd78671ab46
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 12:41:53 2016 -0700

    BLE Host - reuse exec-write-req mbuf for rsp.
    
    The response has the same contents as the request; only the op code is
    different.  By reusing the mbuf, it makes failure due to mbuf exhaustion
    less likely.
    
    X-Original-Commit: 5877bada3719bf1d31cad810a9c58f27c3c25e3f

 nimble/host/src/ble_att_svr.c | 41 +++++++++++++----------------------------
 1 file changed, 13 insertions(+), 28 deletions(-)

commit 8a91ae4b27346e12e820f62df1b9b7303b6a3907
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Aug 9 10:33:36 2016 -0700

    ble - Transports return BLE_ERR_ return codes.
    
    Prior to this change, the HCI transports return code behavior was
    inconsistent.  Sometimes BLE_ERR codes were returned; other times plain
    errno values were returned.
    
    Now only BLE_ERR error codes are returned.
    
    X-Original-Commit: b077f8a9ccd5dab21b62159a3c2092244d7951b7

 nimble/include/nimble/ble.h              |  2 ++
 nimble/src/ble_util.c                    | 43 ++++++++++++++++++++++++++++++++
 nimble/transport/ram/src/ble_hci_ram.c   | 42 +++++++++++--------------------
 nimble/transport/uart/src/ble_hci_uart.c | 40 ++++++++++-------------------
 4 files changed, 73 insertions(+), 54 deletions(-)

commit b4a5f95fde8a44ddfcea6b97a2cd0956d806520b
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 18:13:26 2016 -0700

    BLE Host - Fix unit test SIGSEGV.
    
    An array was missing a '0' terminator.
    
    X-Original-Commit: 51294d51a469c9d193611833313eb61a9a5839dc

 nimble/host/src/test/ble_hs_test_util.c | 3 +++
 1 file changed, 3 insertions(+)

commit 6619939c387e445f4fa6522416a8e1eb3fcf0849
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 17:59:02 2016 -0700

    BLE Host - prep/exec tests: better mbuf leak check
    
    When ensuring no mbuf leaks at the end of the att_svr_test suite, also
    ensure that each connection's prep list is empty.
    
    X-Original-Commit: a9e009199a33c2d4edf94c9c608fea6d8a2879ec

 nimble/host/src/test/ble_att_svr_test.c |  9 ++++++-
 nimble/host/src/test/ble_hs_test_util.c | 46 +++++++++++++++++++++++----------
 nimble/host/src/test/ble_hs_test_util.h | 12 +++++++--
 3 files changed, 50 insertions(+), 17 deletions(-)

commit e2edf72332399b3f2784b7e0d664cf0e512d62d3
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 17:58:16 2016 -0700

    BLE Host - gap test needs to hb when checking tmo.
    
    When ensuring that the passage of time causes no effects, the test node
    needs to call ble_hs_heartbeat() to let the host know that time has
    passed.  This is only necessary because the OS is not running during
    this test.
    
    X-Original-Commit: f409079f316848f4121fed80311bb9f8289a9a54

 nimble/host/src/test/ble_gap_test.c | 1 +
 1 file changed, 1 insertion(+)

commit c2c50e84d2712ee1b9c07ea4c0d6948d2c7c678a
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 17:48:44 2016 -0700

    BLE Host - validate write upon rx of prep write
    
    Before, upon receiving a prepare write request, the code was only
    verifying that the specified attribute existed.  There are a number of
    checks that need to be performed in addition to that one:
    
    1. Insufficient authorization.
    2. Insufficient authentication.
    3. Insufficient encryption key size.
    4. Insufficient encryption (check if persisted bond exists for
       unencrypted peer).
    5. Invalid handle.
    6. Write not permitted.
    
    The host does not properly handle 3 and 4 yet (for any writes).
    
    Now the host rejects a prepare write request if any of the above issues
    are detected (except for 3 and 4).
    
    X-Original-Commit: ee510c02dff3daba9808317b33f7442375bc6f55

 nimble/host/src/ble_att_svr.c           | 69 ++++++++++++++++++++-------------
 nimble/host/src/test/ble_att_svr_test.c | 62 ++++++++++++++++++++++++-----
 2 files changed, 95 insertions(+), 36 deletions(-)

commit b1348956dfd566d2879df38a89ce79290481de60
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Aug 7 02:34:00 2016 -0700

    BLE Host - Free mbufs on exec-write-failure
    
    The previous fix didn't fix an mbuf leak.  It added one!  The real bug
    was that an exec-write-response (success) gets sent when a write fails.
    This commit fixes the mbuf leak that was introduced.
    
    X-Original-Commit: 36de005b3dc0b18aeace6d58d9a7f167294fba2a

 nimble/host/src/ble_att_svr.c | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit 026f32d0578553bb20f672fddf4f4af88eac4eba
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 16:06:06 2016 -0700

    BLE Host - Send exec-write when prep-writes cmplt.
    
    This fixes a bug where the GATT client would never send the execute
    write command when performing a long-write procedure.  Instead, it would
    repeatedly send 0-length prepare write requests.
    
    Also, the GATT client is now more strict about when it accepts prepare
    write responses and execute write responses.  Some unit tests were
    passing, despite the bug described in the above paragraph, because an
    incoming execute write response was accepted when it should have been.
    
    X-Original-Commit: 50d349b9f77db8d971e2f260a62f0e497bcd69bf

 nimble/host/src/ble_gattc.c                | 44 +++++++++-------
 nimble/host/src/test/ble_gatt_write_test.c | 82 ++++++++++++++++++++++++------
 nimble/host/src/test/ble_hs_test_util.c    | 23 +++++++++
 nimble/host/src/test/ble_hs_test_util.h    |  3 ++
 4 files changed, 120 insertions(+), 32 deletions(-)

commit dba623cefb7b0f0b0ef6096d963d513e18b3021c
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 16:04:17 2016 -0700

    BLE Host - Free mbufs on exec-write-failure
    
    This was an mbuf leak.  If the device receives an exec-write request,
    and the attribute callback fails (or the attribute doesn't allow writes
    at all), the mbufs holding the data intended to be written to that
    attribute never got freed.
    
    X-Original-Commit: 80f488f75e2147ff90a5646940c51857e473778a

 nimble/host/src/ble_att_svr.c           |  6 ++++--
 nimble/host/src/ble_gattc.c             |  8 ++++++++
 nimble/host/src/test/ble_att_svr_test.c | 14 +++++++++++++-
 3 files changed, 25 insertions(+), 3 deletions(-)

commit 167e420d4396a48de8725f8e17c34c956eb9480b
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 14:12:03 2016 -0700

    BLE Host - doxy comments for ble_gatts_count_cfg()
    
    X-Original-Commit: a590ce0774f26f2da84a7942140a094eb6b53289

 nimble/host/src/ble_gatts.c | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

commit f63148afd8ba85811577bb52f9d2c66920f2959e
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:19:15 2016 -0700

    BLE Host - Don't assume leading space in l2cap tx.
    
    Call os_mbuf_prepend_pullup() rather than calling os_mbuf_prepend() and
    assuming the resulting buffer is the same as the input.
    
    X-Original-Commit: 409c06710021f9afd98955e008ed5f46dbede237

 nimble/host/src/ble_l2cap.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit 97b1c717f751a7162d96aa8bdf0734d32056f393
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:18:13 2016 -0700

    BLE Host - Clean up ACL tx fragmentation.
    
    This commit does not result in a change in behavior.  The fragmentation
    code was overly complicated.  This change just simplifies the
    implementation.
    
    X-Original-Commit: 5897ba992d76975706dbc606a96095f52f48a18a

 nimble/host/src/ble_hs_hci.c | 34 ++++++++++++----------------------
 1 file changed, 12 insertions(+), 22 deletions(-)

commit 04230d67b9fa5000d5fee27aef5832886ae82e16
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:16:40 2016 -0700

    BLE Host - Free mbuf on os_mqueue_put() failure.
    
    This fixes a theoretical mbuf leak.  In practice, the call to
    os_mqueue_put() will never fail.
    
    X-Original-Commit: 448dfacaaf933720dec4280f8cd92bd8259ad3e0

 nimble/host/src/ble_hs.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit a232e8608249679cc769f6fe57aac5848145b34e
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 12:15:11 2016 -0700

    BLE Host - Use os_mbuf_append_from, not handrolled
    
    This commit does not change any behavior.  Some code was re-inventing
    os_mbuf_append_from().  Now it just calls the function.
    
    X-Original-Commit: 2ec94a12244a687a873b665a128dad5bdd6156ae

 nimble/host/src/ble_att_svr.c | 17 +++++------------
 1 file changed, 5 insertions(+), 12 deletions(-)

commit 9d12ee7a75bc1db68b5642dc1d5faeb6e564a47b
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Aug 6 14:08:59 2016 -0700

    BLE Host - distinguish already/busy in conn/disc.
    
    Prior to this change, both ble_gap_connect() and ble_gap_disc() return
    BLE_HS_EALREADY if any master procedure was already in progress (either
    connect or discover).
    
    Now, Each function returns:
    
        * BLE_HS_EALREDY if the same procedure is already in progress
        * BLE_HS_EBUSY if the other procedure is already in progress
    
    X-Original-Commit: f153e244ebd8080a6a72183a2b5b2d320047c8af

 nimble/host/src/ble_gap.c           |  13 ++++-
 nimble/host/src/test/ble_gap_test.c | 111 ++++++++++++++++++++++++++++++------
 2 files changed, 105 insertions(+), 19 deletions(-)

commit 20700464ab255a7604dea8220cb78740a4e13aca
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Aug 5 10:37:27 2016 -0700

    BLE UART HCI - Remove debug log.
    
    This was accidentally included in the initial commit!
    
    X-Original-Commit: 13f4b150fe8647a1d944c0d5e2694b3710ac0be6

 nimble/transport/uart/src/ble_hci_uart.c | 18 ------------------
 1 file changed, 18 deletions(-)

commit a8f207554c11501e422b57e9d90d4e44f217e941
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 4 16:31:05 2016 -0700

    NimBLE - high / low prio event buffers.
    
    Events have one of two priorities:
    o Low-priority   (BLE_HCI_TRANS_BUF_EVT_LO)
    o High-priority  (BLE_HCI_TRANS_BUF_EVT_HI)
    
    Low-priority event buffers are only used for advertising reports.  If
    there are no free low-priority event buffers, then an incoming
    advertising report will get dropped.
    
    High-priority event buffers are for everything except advertising
    reports.  If there are no free high-priority event buffers, a request to
    allocate one will try to allocate a low-priority buffer instead.
    
    If you want all events to be given equal treatment, then you should
    allocate low-priority events only.
    
    Event priorities solve the problem of critical events getting dropped
    due to a flood of advertising reports.  This solution is likely
    temporary: when HCI flow control is added, event priorities may become
    obsolete.
    
    Not all transports distinguish between low and high priority events.  If
    the transport does not have separate settings for low and high buffer
    counts, then it treats all events with equal priority.
    
    X-Original-Commit: f8922493a9751ecf6618595f4b126e6449cfb21a

 nimble/host/src/test/ble_hs_test_util.c            |  1 -
 nimble/include/nimble/ble_hci_trans.h              | 27 ++++--
 .../ram/include/transport/ram/ble_hci_ram.h        | 17 +++-
 nimble/transport/ram/src/ble_hci_ram.c             | 95 ++++++++++++++++------
 4 files changed, 110 insertions(+), 30 deletions(-)

commit a2e3e067c5392b0ff6f5c9a605f4602c8f42cd36
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Aug 4 13:39:25 2016 -0700

    BLE Host - Use os_eventq_poll()
    
    Before, the host code implemented an eventq "peek" operation:
    * disable interrupts
    * check whether anything is on the eventq
    * enable interrupts
    * if something was on the queue, call os_eventq_get().
    
    Unlike os_eventq_get(), os_eventq_poll() takes a timeout parameter.  Now
    the host calls os_eventq_poll() with a timeout of 0 to perform a
    non-blocking read of the eventq.
    
    X-Original-Commit: b187e6dc21e87ce3f4592786506793f132779c06

 nimble/host/src/ble_hs.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

commit c213f7fd42d2a22ade3d5d68e11064081790818e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 3 18:41:01 2016 -0700

    BLE Host - Rename HCI identifiers and files.
    
    The HCI-related host functionality was using some really inconsistent
    names.  Identifiers and files have been renamed as reorganized as
    follows:
    
    * host_dbg      --> ble_hs_dbg
    * host_hci_cmd  --> ble_hs_hci_cmd
    * host_hci      --> ble_hs_hci_evt / ble_hs_hci
    * ble_hci_util  --> ble_hs_hci_util
    
    X-Original-Commit: d842a43c98ee8acc812b49ac6a4da3681af86ed9

 nimble/host/include/host/ble_hs.h                  |   1 -
 nimble/host/include/host/ble_hs_test.h             |   2 +-
 nimble/host/include/host/host_hci.h                | 130 -----
 nimble/host/src/ble_eddystone.c                    |   2 +-
 nimble/host/src/ble_gap.c                          |  85 ++--
 nimble/host/src/ble_gap_priv.h                     |   2 +-
 nimble/host/src/ble_gattc.c                        |   4 +-
 nimble/host/src/ble_hci_cmd.c                      | 320 -------------
 nimble/host/src/ble_hci_priv.h                     |  51 --
 nimble/host/src/ble_hs.c                           |   9 +-
 nimble/host/src/ble_hs_adv.c                       |   2 +-
 nimble/host/src/ble_hs_conn.c                      |   1 -
 nimble/host/src/{host_dbg.c => ble_hs_dbg.c}       |  48 +-
 .../src/{host_dbg_priv.h => ble_hs_dbg_priv.h}     |   7 +-
 nimble/host/src/ble_hs_hci.c                       | 528 +++++++++++++++++++++
 .../host/src/{host_hci_cmd.c => ble_hs_hci_cmd.c}  | 453 +++++++++---------
 nimble/host/src/{host_hci.c => ble_hs_hci_evt.c}   | 392 ++++-----------
 nimble/host/src/ble_hs_hci_priv.h                  | 158 ++++++
 .../host/src/{ble_hci_util.c => ble_hs_hci_util.c} |  58 ++-
 nimble/host/src/ble_hs_id.c                        |   4 +-
 nimble/host/src/ble_hs_priv.h                      |   7 +-
 nimble/host/src/ble_hs_pvcy.c                      |  18 +-
 nimble/host/src/ble_hs_startup.c                   |  35 +-
 nimble/host/src/ble_ibeacon.c                      |   2 +-
 nimble/host/src/ble_l2cap.c                        |   3 +-
 nimble/host/src/ble_sm.c                           |  26 +-
 nimble/host/src/ble_sm_alg.c                       |   5 +-
 nimble/host/src/ble_sm_sc.c                        |   2 +-
 nimble/host/src/test/ble_att_clt_test.c            |   9 +-
 nimble/host/src/test/ble_gap_test.c                |  49 +-
 nimble/host/src/test/ble_gatt_read_test.c          |  21 +-
 nimble/host/src/test/ble_hs_adv_test.c             |   1 -
 nimble/host/src/test/ble_hs_conn_test.c            |   1 -
 .../{ble_host_hci_test.c => ble_hs_hci_test.c}     |  27 +-
 nimble/host/src/test/ble_hs_test.c                 |   2 +-
 nimble/host/src/test/ble_hs_test_util.c            |  83 ++--
 nimble/host/src/test/ble_l2cap_test.c              |   4 +-
 nimble/host/src/test/ble_os_test.c                 |   3 +-
 nimble/host/src/test/ble_sm_lgcy_test.c            |   1 -
 nimble/host/src/test/ble_sm_sc_test.c              |   1 -
 nimble/host/src/test/ble_sm_test.c                 |   1 -
 nimble/host/src/test/ble_sm_test_util.c            |  21 +-
 nimble/host/store/ram/src/ble_store_ram.c          |   3 +-
 43 files changed, 1302 insertions(+), 1280 deletions(-)

commit 16d6592380603c37a80319f4b8914ebb5a5cdbbd
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 3 13:30:54 2016 -0700

    BLE Host - Reset on hardware error.
    
    X-Original-Commit: ef6ef4c50980df5a0d28b9bdff51118d6a41c8c9

 nimble/host/include/host/ble_hs.h  |  4 ++++
 nimble/host/src/ble_hs.c           |  6 ++++++
 nimble/host/src/ble_hs_priv.h      |  1 +
 nimble/host/src/host_hci.c         | 17 +++++++++++++++++
 nimble/include/nimble/hci_common.h |  3 +++
 5 files changed, 31 insertions(+)

commit 9bfa1a0dcb8fa357700662097e2845046529b30b
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Aug 3 19:44:39 2016 -0700

    BLE Host - Use HCI transport API
    
    Prior to this change, the host assumed it was running with a combined
    host-controller setup.  Now it uses the available HCI transport instead.
    
    X-Original-Commit: 2444d8f66060385b3b3dce29b1b7ff09cacdf9eb

 nimble/controller/include/controller/ble_ll.h      |   1 +
 nimble/controller/pkg.yml                          |   6 +-
 nimble/controller/src/ble_ll.c                     |  17 +
 nimble/controller/src/ble_ll_conn.c                |   6 +-
 nimble/controller/src/ble_ll_conn_hci.c            |   9 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   7 +
 nimble/controller/src/ble_ll_hci.c                 |  14 +-
 nimble/controller/src/ble_ll_hci_ev.c              |  15 +-
 nimble/controller/src/ble_ll_scan.c                |   3 +-
 nimble/host/include/host/ble_hs.h                  |  28 +-
 nimble/host/include/host/ble_hs_test.h             |   3 -
 nimble/host/include/host/host_hci.h                |   8 +-
 nimble/host/pkg.yml                                |  15 +-
 nimble/host/src/ble_gap.c                          |   2 +-
 nimble/host/src/ble_gap_priv.h                     |   2 +-
 nimble/host/src/ble_hci_cmd.c                      |  58 +-
 nimble/host/src/ble_hs.c                           | 224 ++++--
 nimble/host/src/ble_hs_atomic.c                    |  20 +
 nimble/host/src/ble_hs_atomic_priv.h               |   1 +
 nimble/host/src/ble_hs_priv.h                      |  16 +
 nimble/host/src/ble_hs_pvcy.c                      |  27 +-
 nimble/host/src/ble_hs_pvcy_priv.h                 |   2 +-
 nimble/host/src/ble_hs_startup.c                   |   4 -
 nimble/host/src/host_dbg.c                         |   2 +-
 nimble/host/src/host_hci.c                         |  49 +-
 nimble/host/src/host_hci_cmd.c                     |  52 +-
 nimble/host/src/test/ble_gap_test.c                |  11 +-
 nimble/host/src/test/ble_host_hci_test.c           |   8 +-
 nimble/host/src/test/ble_hs_test.c                 |  16 -
 nimble/host/src/test/ble_hs_test_util.c            |  96 ++-
 nimble/host/src/test/ble_hs_test_util.h            |   2 +
 nimble/host/src/test/ble_os_test.c                 |   2 +-
 nimble/host/src/test/ble_sm_test_util.c            |  20 +-
 nimble/include/nimble/ble.h                        |   4 -
 nimble/include/nimble/ble_hci_trans.h              | 152 ++++
 nimble/include/nimble/hci_transport.h              |  32 -
 .../ram/include/transport/ram/ble_hci_ram.h        |  15 +
 nimble/transport/ram/pkg.yml                       |  33 +
 nimble/transport/ram/src/ble_hci_ram.c             | 190 +++++
 .../uart/include/transport/uart/ble_hci_uart.h     |  19 +
 nimble/transport/uart/pkg.yml                      |  34 +
 nimble/transport/uart/src/ble_hci_uart.c           | 775 +++++++++++++++++++++
 42 files changed, 1731 insertions(+), 269 deletions(-)

commit 5118116e7fa6763fc0d5a5fe17d534ec1c2c9ead
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Aug 1 13:32:25 2016 -0700

    BLE Host - Read BD_ADDR on startup.
    
    X-Original-Commit: 93c01c53da4e79430ed2bb64d89a2ab37a3fe1cc

 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/ble_hs_startup.c    | 30 +++++++++++++++++++++++++++---
 nimble/host/src/host_hci_cmd.c      | 14 ++++++++++++++
 nimble/include/nimble/hci_common.h  |  3 +++
 4 files changed, 45 insertions(+), 3 deletions(-)

commit eef20558beb698e9c78a9648950daab447e56c12
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Aug 1 14:04:42 2016 -0700

    BLE lls - Move variable defn. to top of fn.
    
    X-Original-Commit: ce2e596d564758ed0198d0175aeba8d3b84233ce

 nimble/host/profiles/lls/src/ble_svc_lls.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit fdd0ddbaacfa82511968237c2c7a0ac209b85439
Author: Brian Giori <briangiori@gmail.com>
Date:   Fri Jul 29 09:46:08 2016 -0700

    renamed on_gap_event to on_gap_disconnect to better describe functionality
    
    X-Original-Commit: d6343b5024318a3948dd00e2c8d8e82f75ae3c69

 nimble/host/profiles/lls/include/profiles/lls/ble_svc_lls.h | 2 +-
 nimble/host/profiles/lls/src/ble_svc_lls.c                  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 23ddead7fe2767ac19d50d2868619fc11d3d517c
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:26:47 2016 -0700

    added doxygen style comments
    
    X-Original-Commit: bcca6cc6e8cfb8fcd5e544e09fa7908eb554d2c8

 nimble/host/profiles/lls/src/ble_svc_lls.c | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 34848dc993d097c53e3c813421ce3840ab47890e
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:07:42 2016 -0700

    forgot to change header file
    
    X-Original-Commit: d763fee5936c66f829ce90ba01d837c5e3e76ffa

 nimble/host/profiles/lls/include/profiles/lls/ble_svc_lls.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 73307e992cc084628dd92e16c0221db8c19bd492
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:06:00 2016 -0700

    coding standard and on_gap_event changes.
    
    X-Original-Commit: 202ce3cce072ed264e87a2d5dc3d9e4f5ee92ae5

 nimble/host/profiles/lls/src/ble_svc_lls.c | 42 +++++++++++++++++-------------
 1 file changed, 24 insertions(+), 18 deletions(-)

commit 86addc60f3f2fc30f052e8bbdcb8f848b81265da
Author: Brian Giori <briangiori@gmail.com>
Date:   Wed Jul 27 16:22:25 2016 -0700

    updated lls location to host and new api
    
    X-Original-Commit: ba37dff1453d9120f01ab429d4bf95f714831a08

 .../lls/include/profiles/lls}/ble_svc_lls.h        |  3 +-
 nimble/{profiles => host/profiles/lls}/pkg.yml     | 10 ++--
 .../profiles/lls}/src/ble_svc_lls.c                | 69 ++++++++++++++--------
 3 files changed, 51 insertions(+), 31 deletions(-)

commit 0bedb10174f3577d4176e66f794894a31c58dfb2
Author: Brian Giori <briangiori@gmail.com>
Date:   Fri Jul 22 10:55:51 2016 -0700

    Update Lost to Loss in comments.
    
    X-Original-Commit: a1f73dc1f6979be2e744cfae4b082361934306dd

 nimble/profiles/src/ble_svc_lls.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 90f83d44dcef76fe062153f9f589d394b4a1bca6
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 21 19:05:04 2016 -0700

    Added the profiles dir. Added Link Lost Service
    
    X-Original-Commit: 8dfadef3ae24592d284860d419bbd099e854e946

 nimble/profiles/include/profiles/ble_svc_lls.h |  45 +++++++
 nimble/profiles/pkg.yml                        |  31 +++++
 nimble/profiles/src/ble_svc_lls.c              | 166 +++++++++++++++++++++++++
 3 files changed, 242 insertions(+)

commit 49114e3d408254389f81658530c4a295505fddbb
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 17:20:30 2016 -0700

    moved tps to services dir.
    
    X-Original-Commit: df94f0101803639aa412193a8eb6f0677ac94c27

 .../profiles => services/tps/include/services}/tps/ble_svc_tps.h        | 0
 nimble/host/{profiles => services}/tps/pkg.yml                          | 2 +-
 nimble/host/{profiles => services}/tps/src/ble_svc_tps.c                | 2 +-
 3 files changed, 2 insertions(+), 2 deletions(-)

commit 91b4ac8d7904fcb0b8517ee482f852f94239a242
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 17:16:02 2016 -0700

    update include path
    
    X-Original-Commit: 1d68f68fe0c612a3105872d9000b552977cae154

 nimble/host/services/ans/include/{profiles => services}/ans/ble_svc_ans.h | 0
 1 file changed, 0 insertions(+), 0 deletions(-)

commit 570fd102a3639408f011695c8027d9456ef4bac8
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 17:11:54 2016 -0700

    moved location to services from profiles
    
    X-Original-Commit: 64b1cd986c864006dc8e644a0e94788302157adc

 .../host/{profiles => services}/ans/include/profiles/ans/ble_svc_ans.h  | 0
 nimble/host/{profiles => services}/ans/pkg.yml                          | 2 +-
 nimble/host/{profiles => services}/ans/src/ble_svc_ans.c                | 2 +-
 3 files changed, 2 insertions(+), 2 deletions(-)

commit 8fcf0503059a14b03340e93fc1e9ca0114a45095
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 16:44:30 2016 -0700

    Refactored file structure for premade services.
    
    X-Original-Commit: ddba2ab6bacd04aa16151e09b93568b42b4b117e

 .../include/services/gap}/ble_svc_gap.h            |  0
 nimble/host/services/gap/pkg.yml                   | 31 ++++++++++++++++++++++
 .../services/{mandatory => gap}/src/ble_svc_gap.c  |  2 +-
 .../gatt/include/services/gatt/ble_svc_gatt.h      | 29 ++++++++++++++++++++
 nimble/host/services/{mandatory => gatt}/pkg.yml   |  5 ++--
 .../{mandatory => gatt}/src/ble_svc_gatt.c         |  2 +-
 .../lls/include/services}/lls/ble_svc_lls.h        |  0
 nimble/host/{profiles => services}/lls/pkg.yml     |  4 +--
 .../{profiles => services}/lls/src/ble_svc_lls.c   |  2 +-
 .../include/services/mandatory/ble_svc_gatt.h      | 10 -------
 10 files changed, 67 insertions(+), 18 deletions(-)

commit 879871a6827bdc7aceef4693488caf7a357bb36b
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 14:14:51 2016 -0700

    Variables declared at top of function scope
    
    X-Original-Commit: 34406078522a6f7411bf958cadf81e81fabf7383

 nimble/host/profiles/ans/src/ble_svc_ans.c | 43 +++++++++++++++++++-----------
 1 file changed, 27 insertions(+), 16 deletions(-)

commit 68b8c884361a40ae9912f990bce7e0af429d748c
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Aug 1 14:04:42 2016 -0700

    BLE lls - Move variable defn. to top of fn.
    
    X-Original-Commit: b005e150ea12dd2409240e577c287466eb2ffcd0

 nimble/host/profiles/lls/src/ble_svc_lls.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 6845e581c3f43c185da16c22259fbeb6dde30704
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 14:03:38 2016 -0700

     variables declared at top of function scope
    
    X-Original-Commit: ef3024f99d6b805e37b1a8e91057e4992e98b845

 nimble/host/profiles/tps/src/ble_svc_tps.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 258cfaee543c6f838fc3cef35fe7a0471f5b41d7
Merge: 653c6054 59039833
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Aug 1 13:58:55 2016 -0700

    This closes #83.
    Merge remote-tracking branch 'bgiori/develop' into develop
    
    * bgiori/develop:
      renamed on_gap_event to on_gap_disconnect to better describe functionality
      added doxygen style comments
      forgot to change header file
      coding standard and on_gap_event changes.
      updated lls location to host and new api
      Update Lost to Loss in comments.
      Added the profiles dir. Added Link Lost Service
    
    X-Original-Commit: 88e3cb60ed53d0e87aa024fbce2470fce9de1425

commit 4ca71a39b2a845d3469c07229f0c4206da4eae8e
Author: Brian Giori <briangiori@gmail.com>
Date:   Mon Aug 1 13:40:58 2016 -0700

    Immediate Alert Service implemented.
    
    X-Original-Commit: 5091e748508c8a7a9126dd05a9ac8a346c12e97a

 .../ias/include/profiles/ias/ble_svc_ias.h         |  40 ++++++
 nimble/host/profiles/ias/pkg.yml                   |  32 +++++
 nimble/host/profiles/ias/src/ble_svc_ias.c         | 146 +++++++++++++++++++++
 3 files changed, 218 insertions(+)

commit 6418926f941fa3e4abbfad01377d37c3626d8371
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 30 17:29:38 2016 -0700

    BLE Host - Wait for conn-cmplt-ev for GAP conn tmo
    
    Prior to this change, the host had the following behavior when a GAP
    connect procedure timed out:
    
    1. Send a cancel create connection HCI command to the controller.
    2. Wait for the command status event from the controller.
    3. Stop the connection-timeout timer.
    4. Indicate to the application that the connect procedure has timed out.
    5. Receive the connection complete event from the controller indicating
    that the cancel procedure succeeded.
    
    This was problematic for a number of reasons:
    
    * The necessary context was discarded before the impending connection
    complete event was received from the controller.  When the event arrived
    (step 5), the host would interpret it as if the application had manually
    cancelled a connect procedure in progress.
    
    * If the application attempted another master procedure before the
    controller cancelled the connect procedure, the controller would report
    a failure with status 0x0c (Command Disallowed).  This happened because
    the controller cannot perform two connect procedures at the same time.
    
    * If the application attempted another master procedure after the
    controller cancelled the connect procedure, but before the host received
    the connection complete event, the timer for the second procedure would
    never get set.  Consequently, the second procedure would never time out.
    
    The new behavior is:
    
    1. Send a cancel create connection HCI command to the controller.
    2. Wait for the command status event from the controller.
    3. Stop the connection-timeout timer.
    4. Receive the connection complete event from the controller indicating
    that the cancel procedure succeeded.
    5. Indicate to the application that the connect procedure has timed out.
    
    X-Original-Commit: db980b24e5e66a5d9a038fd4ac43c9c6f65911bc

 nimble/host/src/ble_gap.c               |  95 ++++----
 nimble/host/src/test/ble_gap_test.c     | 386 +++++++++++++++++++++++---------
 nimble/host/src/test/ble_hs_test_util.c |  98 ++++++++
 nimble/host/src/test/ble_hs_test_util.h |   3 +
 4 files changed, 441 insertions(+), 141 deletions(-)

commit 2190555f0c9688d5b09c2f88be053d8d7b693eda
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jul 29 08:33:30 2016 -0700

    Fix memory overwrite in random number generation code. This overwrite could cause privacy to fail
    
    X-Original-Commit: 5092dc34b9c6729fc9f7284aace84fa38f66a8b2

 nimble/controller/src/ble_ll_rand.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 9fc231e595a6b7e2db26e1dd3e01859c143612ed
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jul 26 10:44:32 2016 -0700

    MYNEWT-342: Fix invalid access address generation
    
    X-Original-Commit: 37f8bb58ddf0b9aef5c180543b5f1e1b1f3ad127

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c295738af040753dd9a5deaa30b0aaf0fa089e9e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 27 18:52:39 2016 -0700

    BLE ctlr - Use updated host rx data API.
    
    X-Original-Commit: 83d62d26542621eb6061b371e7ad61272c0a0966

 nimble/controller/src/ble_ll_conn.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 03d0effb860496164df88c32e240f76ea1636dc9
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 27 17:30:34 2016 -0700

    BLE Host - Remove double indirection from tx API.
    
    Prior to this change, data buffers for tx operations were passed as type
    (struct os_mbuf **).  The second pointer was used so that the host could
    set the caller's pointer to NULL, indicating that the mbuf had been
    consumed and preventing a double-free.
    
    This was useful, but confusing.  Using a single pointer is simpler and
    consistent with the other networking libraries in core.  It is up to the
    caller to read the function spec and understand that ownership of the
    mbuf is transferred.
    
    X-Original-Commit: 40695b35d2711895bd950076f45c8e619d250c6f

 nimble/host/include/host/ble_att.h      |   2 +-
 nimble/host/include/host/ble_gatt.h     |   8 +-
 nimble/host/include/host/ble_hs.h       |   2 +-
 nimble/host/include/host/host_hci.h     |   2 +-
 nimble/host/src/ble_att_clt.c           | 171 +++++++++++++++-----------------
 nimble/host/src/ble_att_priv.h          |  14 +--
 nimble/host/src/ble_att_svr.c           |  90 ++++++++---------
 nimble/host/src/ble_gatt_priv.h         |   8 +-
 nimble/host/src/ble_gattc.c             |  78 ++++++---------
 nimble/host/src/ble_hs.c                |  13 ++-
 nimble/host/src/ble_l2cap.c             |  24 ++---
 nimble/host/src/ble_l2cap_priv.h        |   5 +-
 nimble/host/src/ble_l2cap_sig_cmd.c     |   6 +-
 nimble/host/src/ble_sm_cmd.c            | 151 +++++++++++-----------------
 nimble/host/src/ble_sm_priv.h           |   5 +-
 nimble/host/src/host_hci.c              |  30 +++---
 nimble/host/src/test/ble_att_clt_test.c |  11 +-
 nimble/host/src/test/ble_hs_test_util.c |  13 +--
 18 files changed, 276 insertions(+), 357 deletions(-)

commit 653c6054736f816ea033363e8094ec52b8e8cd1f
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 30 17:29:38 2016 -0700

    BLE Host - Wait for conn-cmplt-ev for GAP conn tmo
    
    Prior to this change, the host had the following behavior when a GAP
    connect procedure timed out:
    
    1. Send a cancel create connection HCI command to the controller.
    2. Wait for the command status event from the controller.
    3. Stop the connection-timeout timer.
    4. Indicate to the application that the connect procedure has timed out.
    5. Receive the connection complete event from the controller indicating
    that the cancel procedure succeeded.
    
    This was problematic for a number of reasons:
    
    * The necessary context was discarded before the impending connection
    complete event was received from the controller.  When the event arrived
    (step 5), the host would interpret it as if the application had manually
    cancelled a connect procedure in progress.
    
    * If the application attempted another master procedure before the
    controller cancelled the connect procedure, the controller would report
    a failure with status 0x0c (Command Disallowed).  This happened because
    the controller cannot perform two connect procedures at the same time.
    
    * If the application attempted another master procedure after the
    controller cancelled the connect procedure, but before the host received
    the connection complete event, the timer for the second procedure would
    never get set.  Consequently, the second procedure would never time out.
    
    The new behavior is:
    
    1. Send a cancel create connection HCI command to the controller.
    2. Wait for the command status event from the controller.
    3. Stop the connection-timeout timer.
    4. Receive the connection complete event from the controller indicating
    that the cancel procedure succeeded.
    5. Indicate to the application that the connect procedure has timed out.
    
    X-Original-Commit: 0de126ab933697d4df71dfe5c7bb8b7e5747bc1d

 nimble/host/src/ble_gap.c               |  95 ++++----
 nimble/host/src/test/ble_gap_test.c     | 386 +++++++++++++++++++++++---------
 nimble/host/src/test/ble_hs_test_util.c |  98 ++++++++
 nimble/host/src/test/ble_hs_test_util.h |   3 +
 4 files changed, 441 insertions(+), 141 deletions(-)

commit f269294ac11133f1451f1214a16f0690656cef97
Author: Brian Giori <briangiori@gmail.com>
Date:   Fri Jul 29 18:09:03 2016 -0700

    updated comments
    
    X-Original-Commit: ca151c07899733443e657af88b8b2eb10744eac2

 nimble/host/profiles/ans/src/ble_svc_ans.c | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)

commit 59abadbaeecefa55422f802d8ac0bc16d397c5bf
Author: Brian Giori <briangiori@gmail.com>
Date:   Fri Jul 29 15:06:26 2016 -0700

    Alert Notification Service implemented.
    
    X-Original-Commit: 619af6e8fe9afbc3c23124b6a81a689f903b60e3

 .../ans/include/profiles/ans/ble_svc_ans.h         |  45 +--
 nimble/host/profiles/ans/src/ble_svc_ans.c         | 308 ++++++++++++++-------
 2 files changed, 231 insertions(+), 122 deletions(-)

commit 59039833535c03dd1a773ab2cfbd6e541e329b4a
Author: Brian Giori <briangiori@gmail.com>
Date:   Fri Jul 29 09:46:08 2016 -0700

    renamed on_gap_event to on_gap_disconnect to better describe functionality
    
    X-Original-Commit: 47b955283e585fd8363ce22d33863cffba09be73

 nimble/host/profiles/lls/include/profiles/lls/ble_svc_lls.h | 2 +-
 nimble/host/profiles/lls/src/ble_svc_lls.c                  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 9c29d88d230d38d49d44da8bb3e873df3ee4861c
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jul 29 08:33:30 2016 -0700

    Fix memory overwrite in random number generation code. This overwrite could cause privacy to fail
    
    X-Original-Commit: 1a14ba8b6ad67acd89fec59d9d43b3eefa22f9b4

 nimble/controller/src/ble_ll_rand.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 060237db09d14523f4f837860b5966d2a2fdd2c1
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jul 26 10:44:32 2016 -0700

    MYNEWT-342: Fix invalid access address generation
    
    X-Original-Commit: 62943fbe074e4a57bbb882fefaeac75c36e3d1aa

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 08c2ac509b3511450861e28dba12079cec757fa7
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:33:34 2016 -0700

    coding style changes
    
    X-Original-Commit: 98caf9f298499df9571c7ad96bcccbd75586f1e0

 nimble/host/profiles/tps/src/ble_svc_tps.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c53c42386601b84241c4d86ce185d53615bbceb2
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:26:47 2016 -0700

    added doxygen style comments
    
    X-Original-Commit: 4f13d6804c44c4f39a75ee1049ea3977e57063d3

 nimble/host/profiles/lls/src/ble_svc_lls.c | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 32d8bec3e8391bb17d93745b90217f03a5e1e071
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:07:42 2016 -0700

    forgot to change header file
    
    X-Original-Commit: 5d4620ebea8a7469b881f6e2b67e2fdad21e915a

 nimble/host/profiles/lls/include/profiles/lls/ble_svc_lls.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3e70d701e47e66b8d1dbaf660afc4206f0e7c2f6
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 14:06:00 2016 -0700

    coding standard and on_gap_event changes.
    
    X-Original-Commit: 5a7d18c13b6011f4e9292456ab945a948c5b5d6b

 nimble/host/profiles/lls/src/ble_svc_lls.c | 42 +++++++++++++++++-------------
 1 file changed, 24 insertions(+), 18 deletions(-)

commit 762724a18bf442320ac079f04c1c781852a82664
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 13:46:04 2016 -0700

    fixed compilation errors and runs. Untested. Unfinished.
    
    X-Original-Commit: c41f7f39bad22610aec5e01b8ace709504aef4a0

 .../ans/include/profiles/ans/ble_svc_ans.h         | 35 ++++----
 nimble/host/profiles/ans/pkg.yml                   | 31 +++++++
 nimble/host/profiles/ans/src/ble_svc_ans.c         | 96 +++++++++-------------
 3 files changed, 88 insertions(+), 74 deletions(-)

commit 802e7f483f017364cee1cde3f10f4fa96bd0a299
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 11:28:40 2016 -0700

    unfinished changes
    
    X-Original-Commit: 2aba7605b377e1046e6b03705a919f2b960ac06a

 .../ans/include/profiles/ans/ble_svc_ans.h         |  81 +++++
 nimble/host/profiles/ans/src/ble_svc_ans.c         | 369 +++++++++++++++++++++
 2 files changed, 450 insertions(+)

commit c725849e4b66b418dece0825e876f78c880b7599
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 09:42:43 2016 -0700

    updated comments and error return value
    
    X-Original-Commit: d0b6d35a879e02dc5bb9c734091c111d1dc10c07

 nimble/host/profiles/tps/src/ble_svc_tps.c | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit 5aba3a8aefde288de14823f8b5f64fd5219469b3
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 28 09:37:02 2016 -0700

    Tx Power Service implementation
    
    X-Original-Commit: b4ae19f09222d57f5d446d0b163d79ace8725f11

 nimble/host/profiles/tps/src/ble_svc_tps.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit b94b794117e8154453386b75f4a1bc7a319ea3b0
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 27 18:52:39 2016 -0700

    BLE ctlr - Use updated host rx data API.
    
    X-Original-Commit: 5a7826456ad4a7bd1a81b7041e94b0565b7c402d

 nimble/controller/src/ble_ll_conn.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6c85050776a1565bcad3de3e2e0c530fb243bad7
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 27 17:30:34 2016 -0700

    BLE Host - Remove double indirection from tx API.
    
    Prior to this change, data buffers for tx operations were passed as type
    (struct os_mbuf **).  The second pointer was used so that the host could
    set the caller's pointer to NULL, indicating that the mbuf had been
    consumed and preventing a double-free.
    
    This was useful, but confusing.  Using a single pointer is simpler and
    consistent with the other networking libraries in core.  It is up to the
    caller to read the function spec and understand that ownership of the
    mbuf is transferred.
    
    X-Original-Commit: f4796bc366a1e7a682e150e8775e8c2a80ef33f9

 nimble/host/include/host/ble_att.h      |   2 +-
 nimble/host/include/host/ble_gatt.h     |   8 +-
 nimble/host/include/host/ble_hs.h       |   2 +-
 nimble/host/include/host/host_hci.h     |   2 +-
 nimble/host/src/ble_att_clt.c           | 171 +++++++++++++++-----------------
 nimble/host/src/ble_att_priv.h          |  14 +--
 nimble/host/src/ble_att_svr.c           |  90 ++++++++---------
 nimble/host/src/ble_gatt_priv.h         |   8 +-
 nimble/host/src/ble_gattc.c             |  78 ++++++---------
 nimble/host/src/ble_hs.c                |  13 ++-
 nimble/host/src/ble_l2cap.c             |  24 ++---
 nimble/host/src/ble_l2cap_priv.h        |   5 +-
 nimble/host/src/ble_l2cap_sig_cmd.c     |   6 +-
 nimble/host/src/ble_sm_cmd.c            | 151 +++++++++++-----------------
 nimble/host/src/ble_sm_priv.h           |   5 +-
 nimble/host/src/host_hci.c              |  30 +++---
 nimble/host/src/test/ble_att_clt_test.c |  11 +-
 nimble/host/src/test/ble_hs_test_util.c |  13 +--
 18 files changed, 276 insertions(+), 357 deletions(-)

commit 8f224dc6b6f294262c1ca99c329fd8c05a068b65
Author: Vipul Rahane <vipul@runtime.io>
Date:   Wed Jul 27 15:55:26 2016 -0700

    BLEuart app changes and host fix
    
    - Fix newtmgr initialization
    - Ensure data packets are in a single mbuf in the nimBLE host
    - Prevent double free on the last fragment
    
    X-Original-Commit: 9a6dfbda5c8f5b0962be459739d3257b09973d95

 nimble/host/src/host_hci.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 931e3bebe49cdffbd692bddb85775f3617902f79
Author: Brian Giori <briangiori@gmail.com>
Date:   Wed Jul 27 17:07:11 2016 -0700

    added tx power service to profiles
    
    X-Original-Commit: 626b219e0d0f6cb6e79802ed7e6612b3856363bb

 .../tps/include/profiles/tps/ble_svc_tps.h         | 31 +++++++
 nimble/host/profiles/tps/pkg.yml                   | 32 ++++++++
 nimble/host/profiles/tps/src/ble_svc_tps.c         | 96 ++++++++++++++++++++++
 3 files changed, 159 insertions(+)

commit 0e5638d5a897972bc01dc2313fba6366e9d17406
Author: Brian Giori <briangiori@gmail.com>
Date:   Wed Jul 27 16:22:25 2016 -0700

    updated lls location to host and new api
    
    X-Original-Commit: b26285f212e627d5e72cc95dcc8df0e7c2545d5a

 .../lls/include/profiles/lls}/ble_svc_lls.h        |  3 +-
 nimble/{profiles => host/profiles/lls}/pkg.yml     | 10 ++--
 .../profiles/lls}/src/ble_svc_lls.c                | 69 ++++++++++++++--------
 3 files changed, 51 insertions(+), 31 deletions(-)

commit 7504f5962e7cb05572f382bdea0b763556f6d56e
Author: Brian Giori <briangiori@gmail.com>
Date:   Fri Jul 22 10:55:51 2016 -0700

    Update Lost to Loss in comments.
    
    X-Original-Commit: d21530db2be8ed3bf867e0508a87eff5e37680cb

 nimble/profiles/src/ble_svc_lls.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a8b436be702c501c26f452d41423064a5f866b8a
Author: Brian Giori <briangiori@gmail.com>
Date:   Thu Jul 21 19:05:04 2016 -0700

    Added the profiles dir. Added Link Lost Service
    
    X-Original-Commit: e91a0d980ef892f57dbe941ebdb6988958fd5917

 nimble/profiles/include/profiles/ble_svc_lls.h |  45 +++++++
 nimble/profiles/pkg.yml                        |  31 +++++
 nimble/profiles/src/ble_svc_lls.c              | 166 +++++++++++++++++++++++++
 3 files changed, 242 insertions(+)

commit 8ed5499967e4392241067548c0ab1806926fbf18
Author: Vipul Rahane <vipul@runtime.io>
Date:   Wed Jul 27 15:55:26 2016 -0700

    BLEuart app changes and host fix
    
    - Fix newtmgr initialization
    - Ensure data packets are in a single mbuf in the nimBLE host
    - Prevent double free on the last fragment
    
    X-Original-Commit: ac78fde543700fc2ab7ec55b67bb98e15ee4f4b8

 nimble/host/src/host_hci.c | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit d0448ce05df83f843b102a29e714bf80adc0ea2e
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 26 12:01:45 2016 -0700

    BLE Host - Oops, remove debug code.
    
    X-Original-Commit: a6dcf427fb0fa9d555fe04c7d30a91061f5749fc

 nimble/host/src/ble_att_svr.c | 5 -----
 1 file changed, 5 deletions(-)

commit 53299092b38eca9ea5109f75375963cb0b35e842
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 25 13:49:35 2016 -0700

    BLE Host - Update unit tests for new GATTs API.
    
    X-Original-Commit: 1d8ecf9f41b2bffcaffa02697310a5f7aa431b2b

 nimble/host/src/ble_gatts.c               |  1 +
 nimble/host/src/test/ble_gatts_reg_test.c | 13 +++++++------
 2 files changed, 8 insertions(+), 6 deletions(-)

commit 59e06349be1dcd92e26a791d87c971bbc5c386ec
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 25 13:09:08 2016 -0700

    BLE Host - Don't require 2-phase GATT server init.
    
    Prior to this change: the application had initialize each GATT service
    in two steps:
        1. (before ble_hs_init())- Account for cfg resource requirements.
        2. (after ble_hs_init())-  Register service.
    
    Now: Each service definition array gets added to a global array of
    pointers when step one is performed.  When ble_hs_init() is called, all
    queued service automatically get registered.
    
    X-Original-Commit: fb6b480413e7f019f32e3bab3ad4836d7cbc92b6

 nimble/host/include/host/ble_gatt.h                |  1 +
 nimble/host/include/host/ble_hs.h                  | 12 ++++
 .../include/services/mandatory/ble_svc_gap.h       |  1 -
 .../include/services/mandatory/ble_svc_gatt.h      |  1 -
 nimble/host/services/mandatory/src/ble_svc_gap.c   | 14 ++--
 nimble/host/services/mandatory/src/ble_svc_gatt.c  | 14 ++--
 nimble/host/src/ble_gatts.c                        | 75 +++++++++++++++++++---
 7 files changed, 89 insertions(+), 29 deletions(-)

commit 257417d7bb9d0103f5dec78f012d794af552b3b2
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 25 13:05:56 2016 -0700

    BLE Host - Reduce dflt # of hci bufs.
    
    Reduce ble_hs_cfg_dflt.max_hci_bufs from 8 to 3.
    
    X-Original-Commit: 65e9a50af21abdbbc120dc9efd88b7cda6fc10fd

 nimble/host/src/ble_hs_cfg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 60205077b57e67941532afc7e698b07e061ef952
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jul 24 13:29:22 2016 -0700

    BLE Host - Update unit tests to use new dflt cfg.
    
    X-Original-Commit: bcbfb4129b1d702dc235b68303500d780c5d3dd1

 nimble/host/src/test/ble_hs_test_util.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit f701b7e212f9501e52dd2ae1b1ce0024ca43305f
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jul 24 13:27:59 2016 -0700

    BLE Host - Fix null pointer dereference.
    
    ble_att_svr_write_handle() writes to the output parameter out_att_err if
    a write error is encountered.  However, this argument is optional, as it
    is meaningless for local writes.  The code was writing to this argument
    without checking if it is null (i.e., not provided by caller).
    
    X-Original-Commit: 64e2ccb88138ed1726b9d382b5f9c7bfdbe843a1

 nimble/host/src/ble_att_svr.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit d7aac2694b6ff37d914f89cc2efbc453f2726195
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jul 24 11:55:06 2016 -0700

    BLE Host - Fix default ble_hs configuration.
    
    This commit includes the following changes:
    
    * Set default max_l2cap_chans to: (3 * max_connections).  This is
      exactly the number of required channels, and is the only logical value
      to use since we don't support connection-oriented channels yet.  Prior
      to this change, this setting was arbitrarily set to 16.
    
    * Set all default GATT server resource counts to 0.  The expectation is
      that these values will be increased as appropriate as GATT services
      are initialized.
    
    * Reduce some overly-ambitious numbers to defaults that are more
      realistic:
    
          o max_gattc_procs:        16 --> 4
          o max_l2cap_sig_procs:    8  --> 1
    
    X-Original-Commit: db3c76b3293d05b8b1ad8380384e49e6daf0eea1

 nimble/host/src/ble_hs_cfg.c | 32 ++++++++++++++++++++------------
 1 file changed, 20 insertions(+), 12 deletions(-)

commit ac5c4ad3e2551a1e29b70d6791b8be0162cf75e0
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 22 19:34:03 2016 -0700

    BLE Host - Small doxygen update.
    
    X-Original-Commit: beab6f23b48c47b115c5ff1cd237d441ebf2122c

 nimble/host/include/host/ble_att.h  | 74 -------------------------------------
 nimble/host/include/host/ble_gatt.h | 51 +++++++++++++++----------
 nimble/host/src/ble_hs_mbuf.c       | 27 ++++++++++++++
 nimble/host/src/ble_uuid.c          |  2 +-
 4 files changed, 59 insertions(+), 95 deletions(-)

commit 5579d10f3963662cbf47835eac460ba8faa6d8a1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 22 12:02:37 2016 -0700

    BLE Host - Use mbufs instead of flat bufs.
    
    X-Original-Commit: ef7abf7d06e4cbf90f0e11c0762ee83d7b5a5add

 nimble/controller/src/ble_ll_conn.c               |   4 +-
 nimble/host/include/host/ble_att.h                |   8 +-
 nimble/host/include/host/ble_gap.h                |  14 +-
 nimble/host/include/host/ble_gatt.h               |  53 +-
 nimble/host/include/host/ble_hs.h                 |   3 +
 nimble/host/include/host/ble_hs_mbuf.h            |  31 +
 nimble/host/include/host/host_hci.h               |   2 +-
 nimble/host/services/mandatory/src/ble_svc_gap.c  |  37 +-
 nimble/host/services/mandatory/src/ble_svc_gatt.c |  10 +-
 nimble/host/src/ble_att.c                         |  50 +-
 nimble/host/src/ble_att_clt.c                     | 741 ++++++----------------
 nimble/host/src/ble_att_priv.h                    |  22 +-
 nimble/host/src/ble_att_svr.c                     | 642 ++++++++-----------
 nimble/host/src/ble_gap.c                         |   7 +-
 nimble/host/src/ble_gap_priv.h                    |   3 +-
 nimble/host/src/ble_gatt_priv.h                   |  12 +-
 nimble/host/src/ble_gattc.c                       | 541 +++++++++++-----
 nimble/host/src/ble_gatts.c                       | 190 +++---
 nimble/host/src/ble_hs.c                          |  13 +-
 nimble/host/src/ble_hs_mbuf.c                     | 171 +++++
 nimble/host/src/ble_hs_mbuf_priv.h                |  11 +
 nimble/host/src/ble_hs_misc.c                     |  41 --
 nimble/host/src/ble_hs_priv.h                     |   7 +-
 nimble/host/src/ble_l2cap.c                       |  18 +-
 nimble/host/src/ble_l2cap_priv.h                  |   4 +-
 nimble/host/src/ble_l2cap_sig.c                   |   6 +-
 nimble/host/src/ble_l2cap_sig_cmd.c               |  28 +-
 nimble/host/src/ble_sm.c                          |  22 +-
 nimble/host/src/ble_sm_cmd.c                      |  84 ++-
 nimble/host/src/ble_sm_sc.c                       |   4 +-
 nimble/host/src/host_hci.c                        |  18 +-
 nimble/host/src/test/ble_att_clt_test.c           |  21 +-
 nimble/host/src/test/ble_att_svr_test.c           | 230 +++----
 nimble/host/src/test/ble_gap_test.c               |  20 +
 nimble/host/src/test/ble_gatt_conn_test.c         |  55 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c       |   2 +
 nimble/host/src/test/ble_gatt_disc_d_test.c       |   2 +
 nimble/host/src/test/ble_gatt_disc_s_test.c       |   2 +
 nimble/host/src/test/ble_gatt_find_s_test.c       |   2 +
 nimble/host/src/test/ble_gatt_read_test.c         | 208 +++---
 nimble/host/src/test/ble_gatt_write_test.c        |  75 ++-
 nimble/host/src/test/ble_gatts_notify_test.c      |  16 +-
 nimble/host/src/test/ble_gatts_read_test.c        |  31 +-
 nimble/host/src/test/ble_gatts_reg_test.c         |   2 +
 nimble/host/src/test/ble_host_hci_test.c          |   2 +
 nimble/host/src/test/ble_hs_adv_test.c            |   2 +
 nimble/host/src/test/ble_hs_conn_test.c           |   2 +
 nimble/host/src/test/ble_hs_test_util.c           | 204 +++++-
 nimble/host/src/test/ble_hs_test_util.h           |  33 +
 nimble/host/src/test/ble_l2cap_test.c             |   8 +-
 nimble/host/src/test/ble_os_test.c                |   2 +
 nimble/host/src/test/ble_sm_lgcy_test.c           |   2 +
 nimble/host/src/test/ble_sm_sc_test.c             |   2 +
 nimble/host/src/test/ble_sm_test.c                |   2 +
 nimble/host/src/test/ble_sm_test_util.c           |  22 +-
 nimble/host/src/test/ble_uuid_test.c              |   5 +-
 nimble/include/nimble/nimble_opt.h                |   8 +
 57 files changed, 2096 insertions(+), 1661 deletions(-)

commit ae063d625dd4667a941555c1f8b18bdad20f17be
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 18 15:20:29 2016 -0700

    BLE Host - unit test for rx GATT long read.
    
    X-Original-Commit: 245d516e967f313dd28a580197ab1ba215db3f4d

 nimble/host/src/test/ble_gatts_read_test.c | 48 ++++++++++++++++++++++++++++--
 nimble/host/src/test/ble_hs_test_util.c    | 19 ++++++++++--
 nimble/host/src/test/ble_hs_test_util.h    |  2 ++
 3 files changed, 65 insertions(+), 4 deletions(-)

commit 81ae196db0d25db2d33cbc0168e888201a65a104
Author: Vipul Rahane <vipul@runtime.io>
Date:   Tue Jul 12 16:22:39 2016 -0700

    MYNEWT-266 Newtmgr over BLE
    
    - Enable remote configuration, remote soft reset,
      firmware upgrade
    - Adding a seperate package for BLE newtmgr transport
    - Adding BLE_HOST feature
    - Moving logs constants from source file to header file; Were causing
      issues while testing
    - Increasing imgmgr max msg size to 400; Can be increased further when
      we support higher MTUs with BLE
    - Increasing stack size and number of mbufs for bleprph
    - Creating a separate library for newtmgr over BLE
    
    X-Original-Commit: f1ff4abfe63c88dcd599fcea2743c3739cc32661

 nimble/host/pkg.yml | 3 +++
 1 file changed, 3 insertions(+)

commit 9f142c0493dd1915330ff7301c092e15a9adadc0
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 18 11:26:01 2016 -0700

    BLE Host - Only enable GATT procs for centrals.
    
    X-Original-Commit: 96c5e008a22617bd2c056ad717f1461d3d16f7fb

 nimble/include/nimble/nimble_opt.h | 36 ++++++++++++++++++++----------------
 1 file changed, 20 insertions(+), 16 deletions(-)

commit 0ac798d5fd870660c5ce21f47d8fcde4613dfce7
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 16 12:01:12 2016 -0700

    BLE Host - Ensure proper ordering of notify GAP ev
    
    Prior to this change, GAP callbacks were executed out of order when a
    connection with an in-progress indication procedure was terminated.
    
    The correct order is:
        1. notify-tx event (status=BLE_HS_ENOTCONN).
        2. subscribe event (cur-statuses=0;
           reason=BLE_GAP_SUBSCRIBE_REASON_TERM).
    
    X-Original-Commit: ab617b5f7733163d6717d876c55dfaf498d832a0

 nimble/host/include/host/ble_gatt.h          |   1 -
 nimble/host/src/ble_gap.c                    |   8 +-
 nimble/host/src/ble_gatt_priv.h              |   5 +-
 nimble/host/src/ble_gattc.c                  | 163 +++++++++++++++------------
 nimble/host/src/ble_gatts.c                  |  35 ++++--
 nimble/host/src/test/ble_gatt_conn_test.c    |  30 -----
 nimble/host/src/test/ble_gatts_notify_test.c |  57 ++++++----
 7 files changed, 157 insertions(+), 142 deletions(-)

commit d5a9f88aab740199281c589c9ef9ea6d72ef9367
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 16 10:21:14 2016 -0700

    BLE Host - GAP event when peer subscribes to CCCD.
    
    API changes (minus comments):
    
    +define BLE_GAP_EVENT_SUBSCRIBE             14
    
    +define BLE_GAP_SUBSCRIBE_REASON_WRITE      1
    +define BLE_GAP_SUBSCRIBE_REASON_TERM       2
    +define BLE_GAP_SUBSCRIBE_REASON_RESTORE    3
    
    struct {
        uint16_t conn_handle;
        uint16_t attr_handle;
        uint8_t reason;
        uint8_t prev_notify:1;
        uint8_t cur_notify:1;
        uint8_t prev_indicate:1;
        uint8_t cur_indicate:1;
    } subscribe;
    
    X-Original-Commit: 7c8a4d68a27c639dfcfdefd05bca7db533a54d3a

 nimble/host/include/host/ble_gap.h           |  60 +++-
 nimble/host/src/ble_gap.c                    |  31 ++
 nimble/host/src/ble_gap_priv.h               |   4 +
 nimble/host/src/ble_gatt_priv.h              |   2 +-
 nimble/host/src/ble_gatts.c                  | 140 +++++++--
 nimble/host/src/ble_hs_conn.c                |   2 -
 nimble/host/src/test/ble_gatts_notify_test.c | 430 +++++++++++++++++++++------
 7 files changed, 538 insertions(+), 131 deletions(-)

commit 632ffadf12fd4ad6d2b808ccfb01ee38e7bd5fb6
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 15 17:23:01 2016 -0700

    BLE Host - Don't include conn-desc in GAP event.
    
    Prior to this change, GAP performed a connection lookup on the peer for
    each reported event.  This poses a potential performance issue, and is
    often unnecessary.
    
    Now, GAP only indicates the connection handle in its events.  The
    application can perform the connection lookup in the callback if needed.
    
    X-Original-Commit: 3f735f639f4272534e5bd247170505c548e8ea03

 nimble/host/include/host/ble_gap.h      |  67 ++++++-----
 nimble/host/src/ble_gap.c               | 190 +++++++++++++-------------------
 nimble/host/src/test/ble_att_svr_test.c |   2 +-
 nimble/host/src/test/ble_gap_test.c     |  11 +-
 nimble/host/src/test/ble_os_test.c      |  13 ++-
 nimble/host/src/test/ble_sm_test_util.c |   6 +-
 6 files changed, 129 insertions(+), 160 deletions(-)

commit b6b7c891f10dd5d1e98dd19f3198dcea13eb5c24
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 16 10:32:19 2016 -0700

    BLE Host - Send notify/indicate in parent task.
    
    Prior to this change, notifications and indications that could be sent
    immediately were sent by whichever task told the stack to send it.
    
    This was problematic for non-custom notifications, because
    characteristic reads need to happen in the host parent task exclusively.
    This is because there is only a single ATT buffer, and contention is
    prevented by forcing all uses of this buffer into a single task.
    Non-custom notifications and indications need to read the corresponding
    characteristic to generate the command payload.
    
    Now: Non-custom notifications and indications are only performed by the
    parent task.  When such a command needs to be sent, an event is placed
    on the hsot parent event queue.  When the event is processed, all
    pending notifications and indications are sent.
    
    X-Original-Commit: aeaa96d09b954ed1417435ff1b6a99e1412c9bd9

 nimble/host/src/ble_gatt_priv.h |   3 +-
 nimble/host/src/ble_gatts.c     | 180 +++++++++++++++++++++++++++++-----------
 nimble/host/src/ble_hs.c        |  25 ++++++
 nimble/host/src/ble_hs_priv.h   |   2 +
 4 files changed, 159 insertions(+), 51 deletions(-)

commit 9a210347b39810c35f31b350ac0dd1704c642319
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 16 10:31:40 2016 -0700

    BLE Host - Call GAP cb for notify tx events.
    
    A connection's GAP callback now gets called for the following events
    with the BLE_GAP_EVENT_NOTIFY_TX type:
        * Notification tx attempt (success or failure).
        * Indication tx attempt (success or failure).
        * Indication acknowledgment received.
        * Indication timeout.
    
    In addition, the event type corresponding to received notifications and
    indications has been renamed from BLE_GAP_EVENT_NOTIFY to
    BLE_GAP_EVENT_NOTIFY_RX, and the union member has been renamed from
    notify to notify_rx.
    
    X-Original-Commit: cf5d66dbacf2a65a441c7a5997bc7f3aa8324aa2

 nimble/host/include/host/ble_gap.h           | 41 +++++++++++++++++++++++---
 nimble/host/src/ble_att_svr.c                |  4 +--
 nimble/host/src/ble_gap.c                    | 43 ++++++++++++++++++++++------
 nimble/host/src/ble_gap_priv.h               |  8 ++++--
 nimble/host/src/ble_gattc.c                  | 19 ++++++++----
 nimble/host/src/ble_gatts.c                  |  3 ++
 nimble/host/src/test/ble_att_svr_test.c      | 14 ++++-----
 nimble/host/src/test/ble_gatts_notify_test.c |  8 +++---
 8 files changed, 107 insertions(+), 33 deletions(-)

commit a837f8d60f4fc2fc44dca6613a25051750ac03c3
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 20:09:40 2016 -0700

    BLE Host - Package for mandatory svcs (GAP & GATT)
    
    X-Original-Commit: c5694893e3c3437e7f25f2b1ba1fa8197f0b3bff

 nimble/host/include/host/ble_gap.h                 |   9 --
 nimble/host/include/host/ble_gatt.h                |   5 +-
 .../include/services/mandatory/ble_svc_gap.h       |  40 +++++
 .../include/services/mandatory/ble_svc_gatt.h      |  11 ++
 nimble/host/services/mandatory/pkg.yml             |  32 ++++
 nimble/host/services/mandatory/src/ble_svc_gap.c   | 172 +++++++++++++++++++++
 nimble/host/services/mandatory/src/ble_svc_gatt.c  |  88 +++++++++++
 nimble/host/src/ble_gatt_priv.h                    |   2 -
 nimble/host/src/ble_gatts.c                        |  21 +++
 9 files changed, 368 insertions(+), 12 deletions(-)

commit 39bb21255e0fb6756e30a889a883b4490f41472e
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 19:33:56 2016 -0700

    BLE Host - RAM persistence layer package.
    
    X-Original-Commit: db4ca38aad14bec43325580a49343f3f45b8414e

 .../store/ram/include/store/ram/ble_store_ram.h    |  30 ++
 nimble/host/store/ram/pkg.yml                      |  31 ++
 nimble/host/store/ram/src/ble_store_ram.c          | 372 +++++++++++++++++++++
 3 files changed, 433 insertions(+)

commit 08c61a429bbfabe49f614e7482186804658e819d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 17:42:08 2016 -0700

    BLE Host - GATT procedures handled in wrong order.
    
    This was a problem when the application initiated two concurrent GATT
    procedures with the same op code.  In this case, when a response was
    received, it was paired with the incorrect GATT procedure when the
    callback was executed.
    
    The fix is to append GATT procedures to the tail of the stailq rather
    than the head.
    
    X-Original-Commit: 3326bba629e24c6f173ac46dd54c23d80f9373b9

 nimble/host/src/ble_gattc.c               |  2 +-
 nimble/host/src/test/ble_gatt_read_test.c | 52 +++++++++++++++++++++++++++++++
 2 files changed, 53 insertions(+), 1 deletion(-)

commit 7f466c6a20eb953398b92ac17bbeddb761f1f2e9
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 12:03:35 2016 -0700

    BLE Host - rxed adv: UUIDs directly accessible.
    
    Prior to this change, the uuids16 and uuids32 fields were just void
    pointers which pointed to the raw data.  This is inconvenient for the
    user for two reasons:
        * Data is not necessarily aligned for uint16 or uint32 reads.
        * UUIDs are in little-endian, not host byte order.
    
    Now the host allocates a bit of space up front where it can store more
    easily accessible UUIDs.
    
    X-Original-Commit: 938d3ce8f39f006c0d12d368b39fde545d5519ff

 nimble/host/include/host/ble_hs_adv.h |  4 +-
 nimble/host/src/ble_hs_adv.c          | 82 +++++++++++++++++++++++++++--------
 2 files changed, 66 insertions(+), 20 deletions(-)

commit 32780cf8809ab3d8612eebc82b0fb91942b17233
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 12:02:57 2016 -0700

    BLE Host - Move logging into separate file.
    
    X-Original-Commit: 621629d6782b5af120006a818f75f1d131f21f17

 nimble/host/include/host/ble_hs.h     |  5 +++-
 nimble/host/include/host/ble_hs_log.h | 39 +++++++++++++++++++++++++++++
 nimble/host/src/ble_hs.c              |  1 -
 nimble/host/src/ble_hs_log.c          | 47 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_misc.c         | 24 ------------------
 nimble/host/src/ble_hs_priv.h         | 12 ---------
 nimble/host/src/ble_l2cap_sig.c       |  2 +-
 nimble/host/src/ble_sm_alg.c          | 36 +++++++++++++--------------
 nimble/host/src/ble_sm_cmd.c          | 16 ++++++------
 nimble/host/src/ble_sm_sc.c           |  8 +++---
 nimble/host/src/host_hci.c            |  4 +--
 nimble/host/src/host_hci_cmd.c        |  2 +-
 12 files changed, 124 insertions(+), 72 deletions(-)

commit 72998ff95fefa725b560e71219ab94e1852f959d
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 11:28:53 2016 -0700

    BLE Host - Move opcode into gatt register ctxt.
    
    X-Original-Commit: 78d4bed28f006931e2a20e921d8b0a8ac61fb2dd

 nimble/host/include/host/ble_gatt.h          | 131 +++++++++++++++------------
 nimble/host/src/ble_gatts.c                  |  15 +--
 nimble/host/src/test/ble_gatts_notify_test.c |   8 +-
 nimble/host/src/test/ble_gatts_read_test.c   |   8 +-
 nimble/host/src/test/ble_gatts_reg_test.c    |   7 +-
 5 files changed, 90 insertions(+), 79 deletions(-)

commit b9fe08b6881324af4cd5f144006164f662b5246a
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 14 11:07:33 2016 -0700

    BLE Host - Move opcode into gatt access ctxt.
    
    X-Original-Commit: 147a56321108440ddb6077415248964b057b0780

 nimble/host/include/host/ble_gatt.h          | 13 +++++++++++--
 nimble/host/src/ble_gatts.c                  | 18 ++++++++----------
 nimble/host/src/test/ble_gatts_notify_test.c |  6 +++---
 nimble/host/src/test/ble_gatts_read_test.c   | 12 ++++++------
 nimble/host/src/test/ble_gatts_reg_test.c    |  2 +-
 5 files changed, 29 insertions(+), 22 deletions(-)

commit 56a93eac409cc042f273cf211e45ab9d18bfc7c0
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 17:13:46 2016 -0700

    BLE Host - scan: svc data fields had 0 length.
    
    When parsing an advertising report, the host code forgot to fill in the
    length of each service data field.
    
    X-Original-Commit: 9420c875e184a2f5511c21aa609e1011d107d22f

 nimble/host/src/ble_hs_adv.c | 3 +++
 1 file changed, 3 insertions(+)

commit 12e7c8a0ebb61445a49ecd91e38f6961ba935dd2
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 16:49:46 2016 -0700

    MYNEWT-350 BLE Host - Fn to calc GATT server rsrcs
    
    X-Original-Commit: d38f1583659428a7d1cb4c53b98de877d68da634

 nimble/host/include/host/ble_gatt.h |  30 ++++++++++
 nimble/host/src/ble_gatts.c         | 109 ++++++++++++++++++++++++++++++++++++
 2 files changed, 139 insertions(+)

commit 27426ecc9935bbb7cd95484360537e937373c3f1
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 15:40:12 2016 -0700

    BLE Host - Fix filter-duplicates in GAP discovery.
    
    X-Original-Commit: fb3eae7c221abfa86bb4d43acfd391652bdaaa4a

 nimble/host/src/ble_gap.c | 33 ++++++++++-----------------------
 1 file changed, 10 insertions(+), 23 deletions(-)

commit 989817749e40f8abdf5d108b7da45fad54594c56
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 14:04:59 2016 -0700

    BLE Host - Move ATT MTU defines into public hdr.
    
    X-Original-Commit: e6602f6c28febadc18d50c880f6d4d9cf4f133ad

 nimble/host/include/host/ble_att.h | 4 ++++
 nimble/host/src/ble_att_priv.h     | 4 ----
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 16aee6637ecfcd081874d16d9a128f884be96cb3
Merge: e54ee03e e82809d6
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 13:52:24 2016 -0700

    Merge branch 'ble_hs_api' into develop
    
    X-Original-Commit: 3dd354e26d76e2136f79cb7e124399faf9e1544a

commit e82809d67f562b5a6028785b147cedcb9e7eb6d6
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 12:16:45 2016 -0700

    BLE Host - combine adv enable/disable tx commands.
    
    There is no need for separate functions for the same HCI command.  Also,
    the function that was removed allocated an overly large buffer.
    
    X-Original-Commit: bcdaa4731133d0881f522f7bf79bc4f7f136a9a1

 nimble/host/src/ble_gap.c | 28 ++++++----------------------
 1 file changed, 6 insertions(+), 22 deletions(-)

commit 6ad74a6d779c9eaf5618924d3af55c7c1b8b5072
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 12:04:09 2016 -0700

    BLE Host - HCI commands were logged incorrectly.
    
    We were logging the outgoing HCI command after sending it.  Since the
    controller writes its acknowledgement event to the same buffer, the
    event was getting logged rather than the command.
    
    X-Original-Commit: df81d18d95ef6b2fe746d62047b28ac05d82ab56

 nimble/host/src/host_hci_cmd.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 7de4a9dca701212575a4631f4b4f92326159a4b9
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 12 17:49:26 2016 -0700

    Nimble: rename g_hci_cmd_pool --> g_hci_evt_pool
    
    This pool is only used for events; it is no longer used for commands.
    
    X-Original-Commit: 895e8037c7fb8b412f770622e93e24e5c308788b

 nimble/controller/src/ble_ll_conn_hci.c |  8 ++++----
 nimble/controller/src/ble_ll_hci.c      |  2 +-
 nimble/controller/src/ble_ll_hci_ev.c   | 14 +++++++-------
 nimble/controller/src/ble_ll_scan.c     |  2 +-
 nimble/host/include/host/host_hci.h     |  1 +
 nimble/host/src/ble_hs.c                | 18 +++++++++---------
 nimble/host/src/host_hci.c              |  4 ++--
 nimble/host/src/host_hci_cmd.c          |  8 +++++++-
 nimble/host/src/test/ble_hs_test.c      |  2 +-
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 nimble/include/nimble/ble.h             |  2 +-
 11 files changed, 35 insertions(+), 28 deletions(-)

commit 791e630722f6737b9572d3512fcf51d1b7559cb6
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 13 10:47:15 2016 -0700

    BLE Host - gattc: dsc refers to chr val handle.
    
    Prior to this change, the corresponding characteristic's definition
    handle was required to initiate descriptor discovery.  Now it is the
    characteristic's *value* handle.
    
    Rationale: an app likely doesn't care at all about characteristic
    definition handles; it is the value handles that are interesting.  The
    app should not need to calculate the definition handle from the value
    handle just to discover descriptors.
    
    X-Original-Commit: c7c7c9c18febecf9a36231c9e4dc416a40f684d3

 nimble/host/src/ble_gattc.c                 | 16 +++----
 nimble/host/src/test/ble_gatt_conn_test.c   |  4 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c | 72 ++++++++++++++---------------
 3 files changed, 46 insertions(+), 46 deletions(-)

commit e54ee03e471afd013e7d0d2459d8977d2dc3c1d2
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 12 17:49:26 2016 -0700

    Nimble: rename g_hci_cmd_pool --> g_hci_evt_pool
    
    This pool is only used for events; it is no longer used for commands.
    
    X-Original-Commit: 509df9d49bab55aaca6349fe1a46db67626c8304

 nimble/controller/src/ble_ll_conn_hci.c |  8 ++++----
 nimble/controller/src/ble_ll_hci.c      |  2 +-
 nimble/controller/src/ble_ll_hci_ev.c   | 14 +++++++-------
 nimble/controller/src/ble_ll_scan.c     |  2 +-
 nimble/host/include/host/host_hci.h     |  1 +
 nimble/host/src/ble_hs.c                | 18 +++++++++---------
 nimble/host/src/host_hci.c              |  4 ++--
 nimble/host/src/host_hci_cmd.c          |  8 +++++++-
 nimble/host/src/test/ble_hs_test.c      |  2 +-
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 nimble/include/nimble/ble.h             |  2 +-
 11 files changed, 35 insertions(+), 28 deletions(-)

commit b467d413bbda3bcd2e7f6735fcb1805afcd1afd2
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 11 19:42:43 2016 -0700

    BLE Host - Add duration param to ble_gap_connect()
    
    X-Original-Commit: 8da07efd3c2bcad79d4efbafe451c4a3a99f7206

 nimble/host/include/host/ble_gap.h      |   4 ++
 nimble/host/src/ble_gap.c               |  61 ++++++++++++++---
 nimble/host/src/test/ble_gap_test.c     | 113 ++++++++++++++++++++++++++++----
 nimble/host/src/test/ble_hs_conn_test.c |   2 +-
 nimble/host/src/test/ble_hs_test_util.c |  12 ++--
 nimble/host/src/test/ble_hs_test_util.h |   4 +-
 nimble/host/src/test/ble_os_test.c      |  12 ++--
 7 files changed, 173 insertions(+), 35 deletions(-)

commit b977f7a6b28c70ae123d7e96efa3c43bb998b210
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 11 16:48:25 2016 -0700

    BLE Host - Fix spurious maybe-uninitialized warn.
    
    X-Original-Commit: 5ccea9b6c74a35ca34be7a17b5d63fc3dcda0bda

 nimble/host/src/ble_gap.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 75ff1def1aaf9917c57e4e8a96d8fb3756f2e6bd
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 9 13:23:58 2016 -0700

    BLE Host - Fix for spurious gcc warning.
    
    X-Original-Commit: 77b9d5ea0f75a77e9275d68a06aa9d710fe1560b

 nimble/host/src/host_hci.c | 62 +++++++++++++++++++++++++++-------------------
 1 file changed, 37 insertions(+), 25 deletions(-)

commit 3890a653c1ed40d5f91ad20b222d244e79f30e0b
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 9 12:37:06 2016 -0700

    BLE Host - Additional doxygen comments.
    
    X-Original-Commit: 3714aea7a2e5fe52fcdb87f8214f7e1ed6187ea5

 nimble/host/include/host/ble_att.h  | 151 ++++++++++++++++--------------------
 nimble/host/include/host/ble_gatt.h |  15 ++++
 nimble/host/src/ble_att.c           |  16 ++++
 nimble/host/src/ble_att_priv.h      |  24 ++++++
 nimble/host/src/ble_att_svr.c       |  33 ++++++++
 5 files changed, 154 insertions(+), 85 deletions(-)

commit 21c1214f6714063594995085c302b80accfb110b
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 8 19:54:22 2016 -0700

    BLE Host - ACL data packet fragmentation.
    
    X-Original-Commit: cd66efc0120d6a8a26a4c62ac82869d0de9b0b6e

 nimble/host/src/ble_hci_priv.h          |   2 +
 nimble/host/src/ble_hci_util.c          |  19 +++++
 nimble/host/src/host_hci.c              | 138 ++++++++++++++++++++++++--------
 nimble/host/src/test/ble_hs_test.c      |   2 -
 nimble/host/src/test/ble_hs_test_util.c |  58 ++++++++++++--
 nimble/host/src/test/ble_sm_test_util.c |   2 +-
 6 files changed, 179 insertions(+), 42 deletions(-)

commit 1b938ab9d9a5602256571ef1191d9ea701e92500
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 8 13:22:42 2016 -0700

    BLE Host - ble_gap_conn_rssi().
    
    X-Original-Commit: 44b45e97b14cd7b58a7394e96215d204fbb3878a

 nimble/host/include/host/ble_gap.h |  1 +
 nimble/host/src/ble_gap.c          | 26 ++++++++++++++++++++++++++
 2 files changed, 27 insertions(+)

commit 1f2ea317efcfc1a8658f5ee7860b511de0e65deb
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 7 13:44:46 2016 -0700

    BLE Host - GAP event callback updates.
    
    X-Original-Commit: 27445b801be5ed517b2577b7c4e335fdfb20b75b

 nimble/host/include/host/ble_gap.h      | 226 ++++++++++++++++----
 nimble/host/include/host/ble_hs.h       |   6 +-
 nimble/host/src/ble_gap.c               | 362 +++++++++++++++++---------------
 nimble/host/src/ble_gap_priv.h          |   2 +-
 nimble/host/src/ble_gattc.c             |   2 +-
 nimble/host/src/ble_hs.c                |  11 +-
 nimble/host/src/ble_sm.c                |   8 +-
 nimble/host/src/ble_sm_priv.h           |   2 +-
 nimble/host/src/ble_sm_sc.c             |   8 +-
 nimble/host/src/test/ble_att_svr_test.c |  17 +-
 nimble/host/src/test/ble_gap_test.c     |  98 ++++-----
 nimble/host/src/test/ble_hs_test_util.c |   4 +-
 nimble/host/src/test/ble_hs_test_util.h |   2 +-
 nimble/host/src/test/ble_l2cap_test.c   |   5 +-
 nimble/host/src/test/ble_os_test.c      |  56 ++---
 nimble/host/src/test/ble_sm_test_util.c |  36 ++--
 nimble/host/src/test/ble_sm_test_util.h |   3 +-
 17 files changed, 497 insertions(+), 351 deletions(-)

commit 79672516aac9190175687541765b8666c2a86326
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jul 6 15:32:57 2016 -0700

    BLE Host - Move ibeacon prototypes to new header.
    
    net/nimble/host/include/host/ble_ibeacon.h
    
    X-Original-Commit: 3bb24191ff01994a094fb2505d9fa4a303492178

 nimble/host/include/host/ble_hs.h      |  1 -
 nimble/host/include/host/ble_ibeacon.h | 25 +++++++++++++++++++++++++
 2 files changed, 25 insertions(+), 1 deletion(-)

commit cbe21227424d244b3ab40658ed3bb8f5c1af7769
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 5 12:18:03 2016 -0700

    BLE Host - Clean up error codes.
    
    X-Original-Commit: f1554a0b5dd6bc07593bdcd1351dcdc857de4624

 nimble/host/src/ble_att_svr.c           | 4 ++--
 nimble/host/src/test/ble_att_svr_test.c | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)

commit ee1150ea9bdcbb699815c6f8a26adbfbe6bfa2fc
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 5 13:28:29 2016 -0700

    BLE Host - BLE_HS_ERR_SM_THEM ->BLE_HS_ERR_SM_PEER
    
    This is just a rename.
    
    X-Original-Commit: 0ebad0f9519c921edf4d3ad5b3be9b0c99f0bdf2

 nimble/host/include/host/ble_hs.h | 4 ++--
 nimble/host/src/ble_sm.c          | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit a93ee817e9cbb902161d2855e631b83b9422d0e5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 5 12:18:03 2016 -0700

    BLE Host - Clean up error codes.
    
    X-Original-Commit: cd4283ec4d0d4c80e0459c57093b55da47ae70a9

 nimble/host/include/host/ble_att.h | 5 ++++-
 nimble/include/nimble/ble.h        | 1 -
 2 files changed, 4 insertions(+), 2 deletions(-)

commit daa601599f1962339d5101c040774147d0a47f5a
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jul 5 12:18:03 2016 -0700

    BLE Host - Remove obsolete error codes.
    
    X-Original-Commit: faed993b3d9295fd402408eebcbb3f0258f7cf67

 nimble/host/include/host/ble_hs.h | 22 ++++++++++------------
 1 file changed, 10 insertions(+), 12 deletions(-)

commit c4baec5f49f100a79ab213947cc24de7f9dbf718
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 1 15:58:11 2016 -0700

    BLE Host - Fill in privacy API.
    
    X-Original-Commit: 7efbf0ee9cdc27bda570f3e3e6c8f27436840c67

 nimble/host/include/host/ble_gap.h      |   1 -
 nimble/host/include/host/ble_hs.h       |   1 +
 nimble/host/include/host/ble_hs_id.h    |  30 ++++
 nimble/host/src/ble_gap.c               |  64 +++++----
 nimble/host/src/ble_gatts.c             |  12 +-
 nimble/host/src/ble_hci_priv.h          |   2 +-
 nimble/host/src/ble_hci_util.c          |   2 +-
 nimble/host/src/ble_hs_conn.c           |  50 +++----
 nimble/host/src/ble_hs_conn_priv.h      |  20 +--
 nimble/host/src/ble_hs_id.c             | 248 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_id_priv.h        |  30 ++++
 nimble/host/src/ble_hs_misc.c           |   6 +-
 nimble/host/src/ble_hs_priv.h           |   5 +-
 nimble/host/src/ble_hs_pvcy.c           |  99 +++----------
 nimble/host/src/ble_hs_pvcy_priv.h      |   7 +-
 nimble/host/src/ble_hs_startup.c        |   3 +-
 nimble/host/src/ble_sm.c                |  29 ++--
 nimble/host/src/ble_sm_alg.c            |   9 +-
 nimble/host/src/ble_sm_priv.h           |   7 +-
 nimble/host/src/ble_sm_sc.c             |  12 +-
 nimble/host/src/test/ble_gap_test.c     |   1 +
 nimble/host/src/test/ble_hs_conn_test.c |   6 +-
 nimble/host/src/test/ble_hs_test.c      |   2 +-
 nimble/host/src/test/ble_hs_test_util.c |  24 +++-
 nimble/host/src/test/ble_hs_test_util.h |   2 +-
 nimble/host/src/test/ble_sm_test_util.c |  21 +--
 nimble/include/nimble/ble.h             |   2 +-
 nimble/src/util.c                       |   2 +-
 28 files changed, 489 insertions(+), 208 deletions(-)

commit 2e76cc370c8ee5154da9ff5a7f43d062e9ed7535
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 1 12:13:58 2016 -0700

    BLE Host - Add API doxygen comments.
    
    X-Original-Commit: 085395877352913107a5895d6ae087f8eaf559b2

 nimble/host/include/host/ble_store.h |  72 +++++++++++++
 nimble/host/src/ble_eddystone.c      |  12 ++-
 nimble/host/src/ble_gap.c            | 200 +++++++++++++++++++++++++++++++----
 nimble/host/src/ble_gattc.c          | 127 +++++++++++++++++-----
 nimble/host/src/ble_gatts.c          |  18 ++++
 nimble/host/src/ble_hs.c             |  26 ++++-
 nimble/host/src/ble_hs_adv.c         |   2 +-
 nimble/host/src/ble_ibeacon.c        |  13 +++
 nimble/host/src/ble_uuid.c           |  21 +++-
 9 files changed, 433 insertions(+), 58 deletions(-)

commit 022c203c8b811efd00ee09c70f6910e7d1fea271
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jul 1 12:13:23 2016 -0700

    BLE Host - Clean up private headers.
    
    X-Original-Commit: 40b635e6d3b10449e98fe67aea7edb019c23aeee

 nimble/host/include/host/ble_hs_adv.h              |  6 ---
 nimble/host/include/host/ble_uuid.h                |  2 -
 nimble/host/src/ble_hci_priv.h                     | 49 ++++++++++++++++++++++
 nimble/host/src/ble_hci_util.c                     |  2 +-
 nimble/host/src/ble_hs_adv_priv.h                  | 30 +++++++++++++
 nimble/host/src/ble_hs_priv.h                      | 32 ++------------
 nimble/host/src/ble_hs_pvcy.c                      |  4 +-
 nimble/host/src/ble_hs_pvcy_priv.h                 | 34 +++++++++++++++
 .../src/{ble_hci_util_priv.h => ble_uuid_priv.h}   | 14 +++----
 9 files changed, 126 insertions(+), 47 deletions(-)

commit 62f0dc95a8dd417bc962e213eeafd8e19dd65cd3
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 30 17:23:14 2016 -0700

    BLE Host - ble_gap_conn_cancel() - rc when !active
    
    Previously this returned BLE_HS_ENOENT
    Now it returns BLE_HS_EALREADY.
    
    X-Original-Commit: 16e987169b63ae3eb3fa50de609f0442bd774146

 nimble/host/src/ble_gap.c           | 2 +-
 nimble/host/src/test/ble_gap_test.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit f809be7fb173aaa223b45b04fb97f9cb6daed6db
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 30 15:42:59 2016 -0700

    BLE Host - Add missing 'static'
    
    X-Original-Commit: 270fcf611f0215f133ae27c146c51fa3b590bffd

 nimble/host/src/ble_gattc.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit d14724c23fd62c15b7db98424fea443350b67146
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 30 11:32:10 2016 -0700

    BLE Host - Allow HCI reason in ble_gap_terminate()
    
    X-Original-Commit: f962497bd82556987e33731f228a7437427db07f

 nimble/host/include/host/ble_gap.h      | 2 +-
 nimble/host/src/ble_gap.c               | 7 ++++---
 nimble/host/src/ble_gattc.c             | 2 +-
 nimble/host/src/ble_l2cap_sig.c         | 2 +-
 nimble/host/src/test/ble_hs_test_util.c | 2 +-
 5 files changed, 8 insertions(+), 7 deletions(-)

commit b35a9355d6139397e7ddf083df307a37c6eef748
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 30 11:21:55 2016 -0700

    BLE Host - ble_gap_[...]_active() functions.
    
    * ble_gap_adv_active()
    * ble_gap_conn_active()
    * ble_gap_disc_active()
    
    These function indicate whether the specified type of GAP procedure is
    currently in progress.
    
    X-Original-Commit: 375708941487dd28c416a8279e99e03fbea20c0c

 nimble/host/include/host/ble_gap.h      |  5 ++-
 nimble/host/src/ble_gap.c               | 69 ++++++++++++++++++++++++---------
 nimble/host/src/ble_gap_priv.h          |  1 -
 nimble/host/src/test/ble_gap_test.c     | 42 ++++++++++++--------
 nimble/host/src/test/ble_hs_conn_test.c | 12 +++---
 5 files changed, 85 insertions(+), 44 deletions(-)

commit 17886ed60dede162d292845d9e4fb00ced8e7a1a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 29 14:13:54 2016 -0700

    BLE Host - Indicate GATT proc done - BLE_HS_EDONE
    
    X-Original-Commit: 2447ea0e1e24859073babda8094d7547cf5df6e6

 nimble/host/src/ble_gattc.c                 | 258 +++++++++++++++++-----------
 nimble/host/src/test/ble_gatt_disc_c_test.c |  16 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c |  16 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c |  17 +-
 nimble/host/src/test/ble_gatt_find_s_test.c |  16 +-
 5 files changed, 204 insertions(+), 119 deletions(-)

commit 01c0eaa261e8565b5c8014ee1a9233b7c045c4d9
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 29 12:39:45 2016 -0700

    BLE Host - GATT client cb: error arg never null.
    
    Prior to this change, the GATT client indicated success by passing a
    null error argument to the application callback.  This made it
    unnecessarily difficult for application code, because it would always
    have to check error for null before looking at its status field.
    
    Now, the error argument is never null.  Success is indicated by setting
    error->status = 0.
    
    X-Original-Commit: 079aff14eafdec45d0aab5a7874d8ec35df6826e

 nimble/host/src/ble_gattc.c                 | 3 ++-
 nimble/host/src/test/ble_gatt_disc_c_test.c | 2 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c | 2 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c | 2 +-
 nimble/host/src/test/ble_gatt_find_s_test.c | 2 +-
 nimble/host/src/test/ble_gatt_read_test.c   | 8 ++++++--
 nimble/host/src/test/ble_gatt_write_test.c  | 9 +++++----
 7 files changed, 17 insertions(+), 11 deletions(-)

commit 9e5eab027eb9125e5a515144545226f34177c1a9
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 29 10:10:57 2016 -0700

    BLE Host - Lookup svc,chr,dsc handles by UUID.
    
    X-Original-Commit: 787463b5aac59a6d089621c00be14649cb3a97d5

 nimble/host/include/host/ble_gatt.h       |   7 +
 nimble/host/src/ble_att_priv.h            |   5 +-
 nimble/host/src/ble_att_svr.c             |  20 +--
 nimble/host/src/ble_gatts.c               | 253 +++++++++++++++++++++++++-----
 nimble/host/src/test/ble_gatts_reg_test.c | 252 +++++++++++++++++++++++++++--
 5 files changed, 483 insertions(+), 54 deletions(-)

commit c8c97a1ce4fb99646f3ecb61d3a2fc06ac38240f
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 27 18:02:16 2016 -0700

    BLE Host - Comments for GATT server structs.
    
    X-Original-Commit: 2997fff8aaea5f18482506a609b9d28491fb1d1e

 nimble/host/include/host/ble_gatt.h | 215 ++++++++++++++++++++++++++----------
 nimble/host/src/ble_gatts.c         |   4 +
 2 files changed, 160 insertions(+), 59 deletions(-)

commit cb37cd4aa61a8e3d3d95e37c84ff52f210ffee4f
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 24 17:00:15 2016 -0700

    BLE Host - Const correctness.
    
    X-Original-Commit: 6353155771e1de9d1cd619b97fbe86e1265a5d59

 nimble/host/include/host/ble_att.h           |  69 ++++++++-
 nimble/host/include/host/ble_gap.h           |  12 +-
 nimble/host/include/host/ble_gatt.h          | 137 +++++------------
 nimble/host/include/host/ble_hs_adv.h        |   4 +-
 nimble/host/include/host/ble_uuid.h          |   2 +-
 nimble/host/include/host/host_hci.h          |  75 +++++-----
 nimble/host/src/ble_att_clt.c                | 112 +++++++-------
 nimble/host/src/ble_att_cmd.c                | 213 ++++++++++++++-------------
 nimble/host/src/ble_att_cmd_priv.h           | 125 ++++++++--------
 nimble/host/src/ble_att_priv.h               |  50 ++++---
 nimble/host/src/ble_att_svr.c                | 113 +++++++++-----
 nimble/host/src/ble_gap.c                    |  25 ++--
 nimble/host/src/ble_gatt_priv.h              |   2 -
 nimble/host/src/ble_gattc.c                  |  54 +++----
 nimble/host/src/ble_gatts.c                  | 159 +++++---------------
 nimble/host/src/ble_hs_adv.c                 |   8 +-
 nimble/host/src/ble_hs_priv.h                |   4 +-
 nimble/host/src/ble_hs_pvcy.c                |   4 +-
 nimble/host/src/ble_sm.c                     |   2 +-
 nimble/host/src/ble_sm_priv.h                |   2 +-
 nimble/host/src/ble_uuid.c                   |   2 +-
 nimble/host/src/host_hci_cmd.c               | 100 +++++++------
 nimble/host/src/test/ble_att_svr_test.c      |  50 +++----
 nimble/host/src/test/ble_gatt_conn_test.c    |  69 +++++----
 nimble/host/src/test/ble_gatt_disc_c_test.c  |   4 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c  |   5 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c  |   5 +-
 nimble/host/src/test/ble_gatt_find_s_test.c  |   4 +-
 nimble/host/src/test/ble_gatt_read_test.c    |  11 +-
 nimble/host/src/test/ble_gatt_write_test.c   |  13 +-
 nimble/host/src/test/ble_gatts_notify_test.c |  16 +-
 nimble/host/src/test/ble_gatts_read_test.c   |  34 ++---
 nimble/host/src/test/ble_gatts_reg_test.c    |   2 +-
 33 files changed, 741 insertions(+), 746 deletions(-)

commit 5cfecb16420547ed65f9cffb9b7a7d6de0cfdd66
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 24 15:10:27 2016 -0700

    BLE Host - Add missing fields to ble_gap_conn_desc
    
    * role
    * master_clock_accuracy
    
    X-Original-Commit: 46801abffb80666a2da503a5bf1b3ea9251f4e2c

 nimble/host/include/host/ble_gap.h  |   7 +-
 nimble/host/src/ble_gap.c           |  10 ++-
 nimble/host/src/ble_hs_conn_priv.h  |   1 +
 nimble/host/src/test/ble_gap_test.c | 155 ++++++++++++++++++++++++++++++------
 4 files changed, 147 insertions(+), 26 deletions(-)

commit e4e985c724796edd3535881d8f771ab734870e1b
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 24 11:20:18 2016 -0700

    BLE Host - ble_gap_conn_ctxt->ble_gap_event_ctxt
    
    X-Original-Commit: 9fd788983de9aceb4bd7b03537f1e9d081b10885

 nimble/host/include/host/ble_gap.h      |  4 ++--
 nimble/host/src/ble_gap.c               | 28 ++++++++++++++--------------
 nimble/host/src/test/ble_att_svr_test.c |  2 +-
 nimble/host/src/test/ble_gap_test.c     |  2 +-
 nimble/host/src/test/ble_l2cap_test.c   |  2 +-
 nimble/host/src/test/ble_os_test.c      |  4 ++--
 nimble/host/src/test/ble_sm_test_util.c |  2 +-
 nimble/host/src/test/ble_sm_test_util.h |  2 +-
 8 files changed, 23 insertions(+), 23 deletions(-)

commit 171e4f1db3f3ea76c25f2f7eabab6d331995dcfc
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 24 11:15:08 2016 -0700

    BLE Host - Always increment GAP stats on failure.
    
    X-Original-Commit: 3890be3232feccd09d44be818212c68736dbe43d

 nimble/host/src/ble_gap.c              | 146 ++++++++++++++++++++++-----------
 nimble/host/src/ble_gap_priv.h         |   2 +
 nimble/host/src/test/ble_hs_adv_test.c |   5 ++
 3 files changed, 104 insertions(+), 49 deletions(-)

commit 031c5df2c3203f97d7ffb295a6725cfb5574e453
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 23 20:34:36 2016 -0700

    BLE Host - handle direct advertising report event.
    
    X-Original-Commit: e4c0c0ad4966a7329de4d3ea317a4f2061896732

 nimble/host/include/host/ble_gap.h      | 16 +++++-
 nimble/host/src/ble_eddystone.c         |  1 +
 nimble/host/src/ble_gap.c               | 44 +++++++--------
 nimble/host/src/ble_gap_priv.h          |  2 +-
 nimble/host/src/ble_hs_adv.c            |  1 +
 nimble/host/src/ble_hs_adv_priv.h       | 35 ------------
 nimble/host/src/ble_hs_priv.h           |  2 +-
 nimble/host/src/ble_ibeacon.c           |  1 +
 nimble/host/src/host_hci.c              | 97 ++++++++++++++++++++++++++++-----
 nimble/host/src/test/ble_gap_test.c     | 32 ++++++-----
 nimble/host/src/test/ble_hs_adv_test.c  |  1 +
 nimble/host/src/test/ble_hs_conn_test.c |  1 +
 nimble/host/src/test/ble_hs_test_util.c |  1 +
 nimble/include/nimble/hci_common.h      |  3 +
 14 files changed, 146 insertions(+), 91 deletions(-)

commit 0858f471e4ef87c958950672c7f388a3627f92ff
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 23 20:00:33 2016 -0700

    BLE Host - Don't auto-generate NRPA.
    
    We were overwriting our random address with a new NRPA whenever the
    application performed a discovery or advertise procedure with an
    own_addr_type of random.  The stack should not overwrite the address
    automatically, the application should set it.
    
    X-Original-Commit: 9e781e9af3139efb74e41a216c60598c02fc7cf7

 nimble/host/src/ble_gap.c | 8 --------
 1 file changed, 8 deletions(-)

commit a2ea8e061f0be850977a88d2e66b5988b026d613
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 23 19:31:51 2016 -0700

    BLE Host - Updated GAP discovery API.
    
    X-Original-Commit: d586c0e6dfc4aa4fd1523fc580ae2fc6ba6ecc7c

 nimble/host/include/host/ble_gap.h      |  21 +++-
 nimble/host/src/ble_gap.c               | 170 +++++++++++++++++-----------
 nimble/host/src/test/ble_gap_test.c     | 190 +++++++++++++++++++++++++-------
 nimble/host/src/test/ble_hs_test_util.c |  21 +++-
 nimble/host/src/test/ble_hs_test_util.h |   5 +-
 nimble/host/src/test/ble_os_test.c      |  13 +--
 6 files changed, 296 insertions(+), 124 deletions(-)

commit 49ac95ce68b5e9ab9f6b605cd57e1ef51f52b46f
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 23 16:04:42 2016 -0700

    BLE Host - Add duration parameter for advertising.
    
    X-Original-Commit: b92ddcd89af37036765a362e429a566f5d4c22b1

 nimble/host/include/host/ble_gap.h      |   2 +-
 nimble/host/include/host/ble_hs.h       |   2 +
 nimble/host/src/ble_gap.c               | 239 ++++++++++++++++++++++++--------
 nimble/host/src/ble_gap_priv.h          |   2 +-
 nimble/host/src/ble_gatt_priv.h         |   2 +-
 nimble/host/src/ble_gattc.c             |   4 +-
 nimble/host/src/ble_hs.c                |  43 ++++--
 nimble/host/src/ble_hs_priv.h           |   1 +
 nimble/host/src/ble_l2cap_sig.c         |   4 +-
 nimble/host/src/ble_l2cap_sig_priv.h    |   2 +-
 nimble/host/src/ble_sm.c                |   4 +-
 nimble/host/src/ble_sm_priv.h           |   4 +-
 nimble/host/src/test/ble_hs_test_util.c |   2 +-
 13 files changed, 225 insertions(+), 86 deletions(-)

commit 62e69fbf60567cf85f7445e7b800e44aacf74c4e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 22 11:55:49 2016 -0700

    BLE Host - GATT registration API changes
    
    * In the GATT registration context struct (ble_gatt_register_ctxt),
      rename svc_reg, chr_reg, and dsc_reg to svc, chr, and dsc.
    
    * The characteristic registration context (ble_gatt_register_ctxt.chr)
      now contains a pointer to the parent service definition.  This is
      necessary for identifying the characteristic being registered in case
      multiple characteristics have identical UUIDs.
    
    * The descriptor registration context (ble_gatt_register_ctxt.dsc) now
      contains the parent characteristic value handle (in addition to the
      definition handle that it always contained).
    
    X-Original-Commit: 980c9379ff9a34e4b7ae3718d0e0ea23d214ba63

 nimble/host/include/host/ble_gatt.h          | 19 ++++++++++---------
 nimble/host/src/ble_gatts.c                  | 21 +++++++++++----------
 nimble/host/src/test/ble_att_svr_test.c      |  8 ++++----
 nimble/host/src/test/ble_gatts_notify_test.c |  6 +++---
 nimble/host/src/test/ble_gatts_read_test.c   | 18 +++++++++++++-----
 nimble/host/src/test/ble_gatts_reg_test.c    |  6 +++---
 6 files changed, 44 insertions(+), 34 deletions(-)

commit b0781b6a5e72704dedd084575806e0b6dd6b0db5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 22:13:13 2016 -0700

    BLE Host - Update ble_gap_adv_start() API.
    
    * Move own_addr_type from params into a separate parameter.
    * Add optional parameter: high_duty_cycle.
    * Make read-only parameters const.
    * Remove support for default parameters when null is passed.
    * Make channel map an optional parameeter.
    
    X-Original-Commit: a3969853398c9b711a2f9d1625d72c9fc2157af3

 nimble/host/include/host/ble_gap.h      |  41 ++--
 nimble/host/src/ble_gap.c               | 333 +++++++++++++++++---------------
 nimble/host/src/ble_hs_misc.c           |   2 +
 nimble/host/src/ble_hs_priv.h           |   5 +-
 nimble/host/src/test/ble_gap_test.c     | 177 +++++++++++++----
 nimble/host/src/test/ble_hs_adv_test.c  |  12 +-
 nimble/host/src/test/ble_hs_conn_test.c |  67 +------
 nimble/host/src/test/ble_hs_test_util.c |  25 ++-
 nimble/host/src/test/ble_hs_test_util.h |  13 +-
 9 files changed, 384 insertions(+), 291 deletions(-)

commit d26f7eb63facac8ab47cfcb7d35996bd3d7e7591
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 20:19:49 2016 -0700

    BLE Host - ble_gap_cancel->ble_gap_conn_cancel
    
    This function was renamed accidentally.
    
    X-Original-Commit: b9a61e2e6a507a419c8443c9fd8119d906117d1a

 nimble/host/include/host/ble_gap.h      | 2 +-
 nimble/host/src/ble_gap.c               | 2 +-
 nimble/host/src/test/ble_hs_test_util.c | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 9e11f476d8ead40b7b6cd51128939dd2d235b73b
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 20:16:48 2016 -0700

    BLE Host - ble_gap_conn_initiate->ble_gap_connect
    
    The new name is more intuitive.
    
    X-Original-Commit: 5f4967d69928a37f365aa46078e4e3e71c8d79cd

 nimble/host/include/host/ble_gap.h      |  8 ++---
 nimble/host/src/ble_gap.c               |  8 ++---
 nimble/host/src/test/ble_gap_test.c     | 54 ++++++++++++++++++---------------
 nimble/host/src/test/ble_hs_conn_test.c |  4 +--
 nimble/host/src/test/ble_hs_test_util.c |  6 ++--
 nimble/host/src/test/ble_hs_test_util.h |  2 +-
 nimble/host/src/test/ble_os_test.c      |  6 ++--
 7 files changed, 46 insertions(+), 42 deletions(-)

commit f0c2b5bd795b0d178e7c529d54723f5ed9dbb0ac
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 19:58:57 2016 -0700

    BLE Host - Update ble_gap_conn_initiate() API.
    
    Changes:
        * own_addr_type is moved out from the parameter struct into a
          separate parameter.
        * pointers to read-only are marked const.
    
    X-Original-Commit: 026d11d7dda70634632f0aa89f6af6ba4ce51337

 nimble/host/include/host/ble_gap.h      |  8 ++--
 nimble/host/src/ble_gap.c               | 68 +++++++++++++++++++--------------
 nimble/host/src/test/ble_gap_test.c     | 18 +++++----
 nimble/host/src/test/ble_hs_conn_test.c |  7 +++-
 nimble/host/src/test/ble_hs_test_util.c | 30 +++++++++------
 nimble/host/src/test/ble_hs_test_util.h | 13 ++++---
 nimble/host/src/test/ble_os_test.c      |  9 +++--
 nimble/host/src/test/ble_sm_test_util.c | 26 ++++++++-----
 8 files changed, 109 insertions(+), 70 deletions(-)

commit 86a9b1c78824ec4e162ed91145837e1388ceaffd
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 18:21:51 2016 -0700

    BLE Host - ble_gap_crt_params->ble_gap_conn_params
    
    The new name is more intuitive than the old name ("crt" was short for
    create, as in create-connection).
    
    X-Original-Commit: c8c8a4a9118c0a24ebed5d75c2cb424466056dfd

 nimble/host/include/host/ble_gap.h      | 4 ++--
 nimble/host/src/ble_gap.c               | 8 ++++----
 nimble/host/src/test/ble_hs_test_util.c | 2 +-
 nimble/host/src/test/ble_hs_test_util.h | 2 +-
 4 files changed, 8 insertions(+), 8 deletions(-)

commit e4943db7186cafbe45d3e035ada8764a17d77fe3
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 18:19:04 2016 -0700

    BLE Host - Remove 'enhanced' from connect ctxt.
    
    This struct served no purpose.
    
    X-Original-Commit: 0cb8d2525ab2f7d92f634b548808cb5b6b64d150

 nimble/host/include/host/ble_gap.h | 6 ------
 nimble/host/src/ble_gap.c          | 4 ----
 2 files changed, 10 deletions(-)

commit ff833fa33e69dc2190d4434368572971283ca960
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 20 17:30:10 2016 -0700

    BLE Host - Change GATT server callback API.
    
    New API:
    
    /**
     * Context for reads of characteristics and descriptors.  An instance of this
     * gets passed to an application callback whenever a local characteristic or
     * descriptor is read.
     */
    struct ble_gatt_read_ctxt {
        /**
         * (stack --> app)
         * Maximum number of data bytes the stack can send in the read response.
         * This is based on the connection's ATT MTU.
         */
        uint16_t max_data_len;
    
        /**
         * (stack --> app)
         * A buffer that the app can use to write the characteristic response value
         * to.
         */
        uint8_t *buf;
    
        /**
         * (app --> stack)
         * App points this at the characteristic data to respond with.  Initially
         * this points to "buf".
         */
        const void *data;
    
        /**
         * (app --> stack)
         * App fills this with the number of data bytes contained in characteristic
         * response.
         */
        uint16_t len;
    };
    
    /**
     * Context for writes of characteristics and descriptors.  An instance of this
     * gets passed to an application callback whenever a local characteristic or
     * descriptor is written.
     */
    struct ble_gatt_write_ctxt {
        /**
         * (stack --> app)
         * The data that the peer is writing to the characteristic.
         */
        const void *data;
    
        /**
         * (stack --> app)
         * The number of bytes of characteristic data being written.
         */
        int len;
    };
    
    union ble_gatt_access_ctxt {
        struct {
            /**
             * Points to the characteristic defintion corresponding to the
             * characteristic being accessed.  This is what the app registered at
             * startup.
             */
            const struct ble_gatt_chr_def *def;
    
            union {
                struct ble_gatt_read_ctxt read;
                struct ble_gatt_write_ctxt write;
            };
        } chr;
    
        struct {
            /**
             * Points to the descriptor defintion corresponding to the descriptor
             * being accessed.  This is what the app registered at startup.
             */
            const struct ble_gatt_dsc_def *def;
    
            union {
                struct ble_gatt_read_ctxt read;
                struct ble_gatt_write_ctxt write;
            };
        } dsc;
    };
    
    X-Original-Commit: a7e2a2e14da9ae58fde08500274867533d5ef6e4

 nimble/host/include/host/ble_att.h           |   3 +-
 nimble/host/include/host/ble_gatt.h          |  91 ++++++++++--
 nimble/host/include/host/ble_hs_test.h       |   6 +-
 nimble/host/include/host/ble_uuid.h          |   2 +-
 nimble/host/src/ble_att_svr.c                |   2 +-
 nimble/host/src/ble_gatts.c                  | 116 ++++++++++++---
 nimble/host/src/ble_uuid.c                   |   4 +-
 nimble/host/src/test/ble_att_svr_test.c      |  28 +---
 nimble/host/src/test/ble_gatts_notify_test.c |  17 +--
 nimble/host/src/test/ble_gatts_read_test.c   | 206 +++++++++++++++++++++++++++
 nimble/host/src/test/ble_gatts_reg_test.c    |   8 +-
 nimble/host/src/test/ble_hs_test.c           |   1 +
 nimble/host/src/test/ble_hs_test_util.c      |  26 ++++
 nimble/host/src/test/ble_hs_test_util.h      |   1 +
 nimble/include/nimble/ble.h                  |  12 +-
 nimble/src/util.c                            |  24 ++--
 16 files changed, 455 insertions(+), 92 deletions(-)

commit c363ffe6fe4ff4b87e6b6556fb99fa7db833b5f9
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jun 18 22:38:50 2016 -0700

    BLE Host - Allow app to specify adv flags,txpwr
    
    PRIOR TO THIS CHANGE:
    
    * Flags:
        The host always inserted the flags field into undirected
        advertisements.
    
    * TX Power Level:
        The application could indicate whether the tx power level field
        should be included in an advertisement, but it could not specify the
        value; the stack always filled in the value.
    
    NOW:
    
    * Flags:
        The application has three options concerning the flags field:
        1. Don't include it in advertisements (!flags_is_present).
        2. Explicitly specify the value (flags_is_present && flags != 0).
        3. Let stack calculate the value (flags_is_present && flags == 0).
    
        For option 3, the calculation is delayed until advertising is
        enabled.  The delay is necessary because the flags value depends on
        the type of advertising being performed which is not known at this
        time.
    
        Note: The CSS prohibits advertising a flags value of 0, so this
        method of specifying option 2 vs. 3 is sound.
    
    * TX Power Level:
        The application has three options concerning the TX power level
        field:
        1. Don't include it in advertisements (!tx_pwr_lvl_is_present).
        2. Explicitly specify the value
           (tx_pwr_lvl_is_present &&
            tx_pwr_lvl != BLE_HS_ADV_TX_PWR_LVL_AUTO).
        3. Let stack calculate the value
           (tx_pwr_lvl_is_present &&
            tx_pwr_lvl == BLE_HS_ADV_TX_PWR_LVL_AUTO).
    
    X-Original-Commit: c3b71fea2d822a76f94ff1bd58d4be27f34c7eae

 nimble/host/include/host/ble_hs_adv.h   |   8 +-
 nimble/host/src/ble_gap.c               |  78 +++---
 nimble/host/src/ble_hs_adv.c            |  40 ++-
 nimble/host/src/test/ble_gap_test.c     |  51 ++--
 nimble/host/src/test/ble_hs_adv_test.c  | 451 +++++++++++++++++++-------------
 nimble/host/src/test/ble_hs_test_util.c |  63 ++++-
 nimble/host/src/test/ble_hs_test_util.h |   4 +
 7 files changed, 431 insertions(+), 264 deletions(-)

commit aec67d1f40ac543645ceedc4cd6adf72c1573197
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 17 19:51:08 2016 -0700

    BLE Host - Indicate service in chr reg callback.
    
    X-Original-Commit: 81fd4cda94e724bc2e8a6437a842d61ac3917931

 nimble/host/include/host/ble_gatt.h | 1 +
 nimble/host/src/ble_gatts.c         | 6 ++++--
 2 files changed, 5 insertions(+), 2 deletions(-)

commit 2b4322de59c543f6b760b4bfed86ab9930f8c7de
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jul 11 15:22:20 2016 -0700

    BLE Host - Limit to 2 consecutive OS events.
    
    Prior to this change:
    
    When the host had work to do, it would process its eventq until it was
    empty.  This is the correct behavior for most tasks, since the OS will
    interrupt the task when a higher priority task has work to do.  However,
    this is wrong for the NimBLE host because the host doesn't have a task
    of its own; it runs within a parent task.  This previous behavior caused
    the following two problems:
    
    1. When the host sets a timer, the timer is associated with the parent
    task's eventq.  When the timer expires, it is the parent task which
    executes the callout.  If the host is busy with an endless series of
    events (e.g., during scanning, if the application logs every
    advertisement), then the callout never gets processed because the host
    event queue is never empty.  This is especially problematic in the case
    of scanning, because it is a time which terminates the scan procedure!
    
    2. The parent task could get starved when the host had too much work to
    do (again, the example is when logging incoming advertisement reports).
    This isn't as big of a problem, because the application could always
    move functionality out of the parent task and into something with a
    higher priority.
    
    New behavior:
    
    After the host processes two consecutive events, it relinquishes control
    back to the parent task.  If the parent task has no work to do, control
    is immediately given back to the host.
    
    X-Original-Commit: 364bcc3ea3db00ade4e0a8c6290ff8f8b2f1158c

 nimble/host/src/ble_hs.c | 23 +++++++++++++++++------
 1 file changed, 17 insertions(+), 6 deletions(-)

commit 22700ea755e271ef12eb64b9a7590dca251baab6
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jul 8 13:39:15 2016 -0700

    MYNEWT-83: Controller should use a fixed buffer for reception
    
    In preparation for the rather large code change that will come
    with this ticket, I am moving some things from the connection
    receive end ISR processing into either the rx start is or the
    Link Layer. The reason is that when we use a fixed buffer for
    reception we will have to copy the receive buffer into a mbuf.
    This will take extra time so we need to do everything we can do
    to remove time from the rx end isr.
    
    The changes are pretty simple: move the check for proper access
    address into the rx start isr and we can do that there. We also
    moved the anchor point processing into the receive start ISR as
    we use the receive start time to calculate the anchor point.
    
    X-Original-Commit: 28e2a8b4efcda9d241720f25749137de37ad71e8

 nimble/controller/src/ble_ll.c           | 10 +++----
 nimble/controller/src/ble_ll_conn.c      | 49 +++++++++++++++++++-------------
 nimble/controller/src/ble_ll_conn_priv.h |  4 +--
 3 files changed, 35 insertions(+), 28 deletions(-)

commit d17cd31edd068d9e881fa3f378869563f8daec24
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jul 7 19:49:33 2016 -0700

    NimBLE - Host frees HCI cmd buf on ev alloc fail.
    
    Old behavior: when ble_hci_transport_host_cmd_send() failed to allocate
    an event for the HCI command, it tried to free the command buffer to the
    g_hci_cmd_pool pool.  This became a problem when the host started using
    a single statically-allocated buffer for all of its HCI commands.
    
    New behavior: ble_hci_transport_host_cmd_send() doesn't free the buffer
    on failure.  Instead, it is up to the caller to check the return code
    and free the buffer on failure.
    
    X-Original-Commit: 53d7e653b9239f1f17e99e7d757dad8b74c805a4

 nimble/controller/src/ble_ll_hci.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 5014b2dc9617efb6198b4f2ed857235f19ef273e
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 2 19:51:34 2016 -0700

    BLE Host - unit tests for reading RSSI.
    
    X-Original-Commit: 127d42593fcffad2f8e7b9b419822bddcd97713d

 nimble/host/src/test/ble_host_hci_test.c | 43 ++++++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)

commit a3ab0d0eb18dea016d71632d0023747e693dd244
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 2 19:50:15 2016 -0700

    BLE Host - BLE_HS_EMSGSIZE used incorrectly.
    
    For many HCI events, BLE_HS_EMSGSIZE was used when the event's length
    was unexpected.  The correct error code to use in this case is
    BLE_HS_ECONTROLLER.
    
    X-Original-Commit: 41291575c8a4b74a215a46a01fd2ae093fd6d7c5

 nimble/host/src/ble_hci_cmd.c |  6 +++---
 nimble/host/src/host_hci.c    | 24 ++++++++++++------------
 2 files changed, 15 insertions(+), 15 deletions(-)

commit 9c422406fd6e460dc1bb5d90123cde1895647b20
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jul 2 19:28:41 2016 -0700

    BLE Host - Fix read-rssi bug.
    
    The host was passing a too-short buffer to the HCI tx function.  The
    result was a BLE_HS_EMSGSIZE error.
    
    Fix: pass correct buffer size (3) rather than 1.
    
    X-Original-Commit: 2e643fd2515d163b8343b8b72e7b2daea5f55f69

 nimble/host/src/ble_hci_util.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a3f7d3de1de12aaf084310d6f3819c31d760cde4
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 30 16:30:04 2016 -0700

    BLE Host - Report HCI error code on terminate.
    
    The host reports a disconnect event via the BLE_GAP_EVENT_DISCONNECT
    event code.
    
    Prior to this change: locally-terminated connections were reported with
    a status code of BLE_HS_ENOTCONN.
    
    Now: locally-terminated connections are reported with a status code of
    BLE_HS_HCI_ERR(BLE_ERR_CONN_TERM_LOCAL).
    
    X-Original-Commit: baee9cd0593d32bacf919aea51527d1859cdfa52

 nimble/host/src/ble_gap.c           | 9 +--------
 nimble/host/src/test/ble_gap_test.c | 3 ++-
 2 files changed, 3 insertions(+), 9 deletions(-)

commit 0939e68421a8e333688eff2dc6fd61d14c8e684e
Author: William San Filippo <wills@runtime.io>
Date:   Thu Jun 30 13:05:36 2016 -0700

    MYNEWT-332: Return error if initiating and host attempts to enable scanning
    
    X-Original-Commit: 251ba7a1fce27dd62cc6826bb27e50ef25a68278

 nimble/controller/src/ble_ll_scan.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 611b8c494154538f44d51ecb108c2b8faf299869
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 23 14:56:58 2016 -0700

    log2smtest.rb: generates BLE SM unit tests.
    
    X-Original-Commit: e0c73d247bb96c7a825894a469b34845b92ced60

 nimble/host/tools/log2smtest.rb | 1010 +++++++++++++++++++++++++++++++++++++++
 1 file changed, 1010 insertions(+)

commit 1dd04898b0aa8fe847fa3e8621ca9c5e1358d79d
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 22 11:23:55 2016 -0700

    BLE Host - ble_att_svr_read_local()
    
    Also add corresponding unit tests.
    
    X-Original-Commit: e942cec79c9774b7da8ec29f88f2ca9540f5d2f6

 nimble/host/include/host/ble_att.h      |   2 +
 nimble/host/src/ble_att_svr.c           |  29 +++++++-
 nimble/host/src/test/ble_att_svr_test.c | 113 +++++++++++++++++++++++++++++++-
 3 files changed, 139 insertions(+), 5 deletions(-)

commit d6a175a0b49bd6b5871d1d009b420661d84416db
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 22 10:45:44 2016 -0700

    BLE Host - Remove extra sec check on ATT write.
    
    This looks like a merge mistake.
    
    X-Original-Commit: 9a8d36e17d6e2f3f4d7ba610092f5d9143752cbf

 nimble/host/src/ble_att_svr.c | 5 -----
 1 file changed, 5 deletions(-)

commit 99e9a73ee28490986c00d276f7451385a187a171
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 16:42:17 2016 -0700

    BLE Host - Fix build error caused by prev commit.
    
    The build errors were caused by:
    
    commit a27e86ffffcaef04dce633901bbecf60c0033027
    Author: Christopher Collins <ccollins@apache.org>
    Date:   Tue Jun 21 15:50:42 2016 -0700
    
        BLE Host - Clean up runtime settings.
    
    X-Original-Commit: f664c50911b68546e9b11e86f97ef8d0d917d76b

 nimble/host/src/ble_hs_cfg.c            | 4 ----
 nimble/host/src/test/ble_hs_test_util.c | 3 ---
 2 files changed, 7 deletions(-)

commit 8b13a404e4a5ddf9455d1221fd6eed1a780561b8
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 15:50:42 2016 -0700

    BLE Host - Clean up runtime settings.
    
    X-Original-Commit: a27e86ffffcaef04dce633901bbecf60c0033027

 nimble/host/include/host/ble_hs.h | 119 +++++++++++++++++++++++++++++++++-----
 1 file changed, 104 insertions(+), 15 deletions(-)

commit 6f7469dce798f2532ee3c7b6368d754a48fb4de3
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 14:18:10 2016 -0700

    BLE Host - Single buffer for HCI cmds and acks.
    
    This fixes the problem where the host is starved of HCI buffers when the
    controller sends a flurry of unsolicited events.  Rather than allocating
    a buffer from a shared pool, the host uses a single static buffer for
    all of its commands.  This solution works for the following two reasons:
    
    1. The host never sends a second command before the previous one is
       acknowledged by the controller.
    2. The controller reuses the command buffer when it sends back an
       acknowledgement event (command complete or command status).
    
    X-Original-Commit: 9b56c3c1038468141b0c7830fba1738572a0bcb8

 nimble/host/include/host/host_hci.h |  4 +++
 nimble/host/src/ble_hci_cmd.c       | 49 ++++++++++++++++---------------------
 nimble/host/src/ble_hs.c            |  1 -
 nimble/host/src/host_hci_cmd.c      | 22 ++++++-----------
 4 files changed, 33 insertions(+), 43 deletions(-)

commit dd8c1ada0e8f9278e9b558e62aa1317b81c789b3
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 21 11:57:31 2016 -0700

    BLE Host - Stop scan timer when disc. proc. cncld.
    
    X-Original-Commit: ac9f865dafdebfafc2415c7c6ca09705b5c50bb4

 nimble/host/src/ble_gap.c | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)

commit b106bb8ad42f6a48b4c68da7f289770d27bbb303
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 20 20:34:49 2016 -0700

    BLE Host - Remove obsolete ble_hs_thread_safe() fn
    
    X-Original-Commit: eacea950a9226533f0a6bd9138ae0986ffdad7dc

 nimble/host/src/ble_hs.c        |  6 ------
 nimble/host/src/ble_hs_conn.c   | 12 ++++++------
 nimble/host/src/ble_hs_priv.h   |  1 -
 nimble/host/src/ble_l2cap_sig.c |  2 +-
 nimble/host/src/ble_sm.c        |  2 +-
 nimble/host/src/ble_sm_cmd.c    |  2 +-
 6 files changed, 9 insertions(+), 16 deletions(-)

commit 3490a4dcc4772c6f435493e450105184c3c0d8ef
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 20 20:22:23 2016 -0700

    BLE Host - Return oom errors on no hci buf / no ev.
    
    X-Original-Commit: 39660c0fca5899f346574782bc245db553170169

 nimble/controller/src/ble_ll_hci.c |  7 +++++--
 nimble/host/include/host/ble_hs.h  |  2 ++
 nimble/host/src/ble_hci_cmd.c      |  2 +-
 nimble/host/src/host_hci_cmd.c     | 42 +++++++++++++++++++++++++-------------
 4 files changed, 36 insertions(+), 17 deletions(-)

commit 4f7049ef5377b1cca05d31848204aae7b184a139
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 20 20:06:03 2016 -0700

    BLE Host - Return BLE_HS_ETIMEOUT_HCI on ack tmo.
    
    X-Original-Commit: b8b32326ccfcc1dfdef1b1d36051a4345e249c20

 nimble/host/include/host/ble_hs.h       |  1 +
 nimble/host/src/ble_hci_cmd.c           | 12 +++++++++++-
 nimble/host/src/test/ble_hs_conn_test.c |  2 +-
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 4 files changed, 14 insertions(+), 3 deletions(-)

commit 73fa147d44670c7546d41b5235238e2b39f0f7cd
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 19 15:43:46 2016 -0700

    BLE Host - Ability to cancel discovery operation.
    
    "discovery" here is in the GAP sense (i.e., scanning).
    
    /**
     * Cancels the discovery procedure currently in progress.  A success return
     * code indicates that scanning has been fully aborted; a new discovery or
     * connect procedure can be initiated immediately.
     *
     * @return                      0 on success;
     *                              BLE_HS_EALREADY if there is no discovery
     *                                  procedure to cancel;
     *                              Other nonzero on unexpected error.
     */
    int
    ble_gap_disc_cancel(void)
    
    X-Original-Commit: 63b20b2cd705da1516c0e97998c58d458d43d84f

 nimble/host/include/host/ble_gap.h |  1 +
 nimble/host/src/ble_gap.c          | 50 +++++++++++++++++++++++++++++++++++---
 nimble/host/src/ble_gap_priv.h     |  2 ++
 3 files changed, 50 insertions(+), 3 deletions(-)

commit cab8d21fbd2422f603d34547a3ad6b78578596ce
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jun 18 13:09:27 2016 -0700

    BLE Host - Handle overflow in large scan duration.
    
    Use the os_time_ms_to_ticks() function to convert the scan duration from
    milliseconds to OS ticks.  This function uses a uint64_t for its
    intermediate value, preventing overflow.  This fixes the bug where a
    large scan duration resulted in a short scan operation.
    
    X-Original-Commit: 2f57efe25b20c7dc693e305d771dfce1c925c288

 nimble/host/src/ble_gap.c | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit a45d3fe612f8961b6fc007a55dc9dddf0ffdc6af
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 17 19:37:01 2016 -0700

    BLE Host - Fix broken scan timeout.
    
    The timer used for discovery (scan) procedures was not correct.  A
    discovery procedure would often last much longer than requested.
    
    X-Original-Commit: b7fa20bbdfb21e5652862ff272b8673ef55ca7e5

 nimble/host/src/ble_gap.c            | 72 ++++++++++++++++++++++++------------
 nimble/host/src/ble_gap_priv.h       |  2 +-
 nimble/host/src/ble_gatt_priv.h      |  2 +-
 nimble/host/src/ble_gattc.c          | 15 +++++---
 nimble/host/src/ble_hs.c             | 29 ++++++++++-----
 nimble/host/src/ble_l2cap_sig.c      | 15 +++++---
 nimble/host/src/ble_l2cap_sig_priv.h |  2 +-
 nimble/host/src/ble_sm.c             | 16 +++++++-
 nimble/host/src/ble_sm_priv.h        |  4 +-
 9 files changed, 106 insertions(+), 51 deletions(-)

commit 4f641c04e31da6ef00acabfe7b1d1e0731edc0d0
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 17 17:03:57 2016 -0700

    BLE Host - Clean up host privacy.
    
    Adjust code to meet coding standards document and more closely resemble
    the rest of the host code.
    
    X-Original-Commit: 6970f587fab919d61b5a142c72c5002bfe3126f9

 nimble/host/include/host/ble_hs.h       |   2 +-
 nimble/host/include/host/host_hci.h     |  18 +--
 nimble/host/src/ble_gap.c               |  10 +-
 nimble/host/src/ble_hci_util.c          |   2 +-
 nimble/host/src/ble_hs_cfg.c            |   2 +-
 nimble/host/src/ble_hs_conn.c           |   2 +-
 nimble/host/src/ble_hs_priv.c           | 256 --------------------------------
 nimble/host/src/ble_hs_priv.h           |  17 +--
 nimble/host/src/ble_hs_pvcy.c           | 245 ++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_startup.c        |   4 +-
 nimble/host/src/ble_sm.c                |   7 +-
 nimble/host/src/ble_store.c             |   4 +-
 nimble/host/src/host_hci_cmd.c          |  90 +++++------
 nimble/host/src/test/ble_hs_test_util.c |   2 +-
 nimble/host/src/test/ble_sm_test_util.c |   4 +-
 15 files changed, 321 insertions(+), 344 deletions(-)

commit b79d22cfe3fc4716047d18cd1fa98741123dab44
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 17 17:01:35 2016 -0700

    BLE Host - Fix bug; lgcy pairing iocap=4.
    
    X-Original-Commit: bd458b5596bf05e3c6ac8d6e320ad254ec00fadd

 nimble/host/src/ble_sm.c                |   2 +-
 nimble/host/src/test/ble_sm_lgcy_test.c | 136 ++++++++++++++++++++++++++++++++
 2 files changed, 137 insertions(+), 1 deletion(-)

commit d874aafad5c5cbb064502bb44694a90e7028de44
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 15 20:47:20 2016 -0700

    BLE Host - More SM unit tests.
    
    X-Original-Commit: 39dd36c86734aa438fd6a4b583007c612e0ca420

 nimble/host/include/host/ble_hs_test.h  |    4 +-
 nimble/host/src/ble_sm.c                |    5 +-
 nimble/host/src/ble_sm_cmd.c            |   35 +-
 nimble/host/src/test/ble_hs_test.c      |    3 +-
 nimble/host/src/test/ble_sm_lgcy_test.c |  702 ++++++++++
 nimble/host/src/test/ble_sm_sc_test.c   |   68 +-
 nimble/host/src/test/ble_sm_test.c      | 2239 +++----------------------------
 nimble/host/src/test/ble_sm_test_util.c | 1610 ++++++++++++----------
 nimble/host/src/test/ble_sm_test_util.h |   67 +-
 9 files changed, 1883 insertions(+), 2850 deletions(-)

commit 78d1f32b93283ad093780b5a2e8738b775d59110
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 16 20:48:15 2016 -0700

    BLE Host - Rename start_rand to master_id_rand.
    
    X-Original-Commit: e347a0d6832540fdd8c01ddfcd73a5aa164b9d7b

 nimble/host/src/ble_sm.c      | 22 +++++++++++-----------
 nimble/host/src/ble_sm_priv.h |  2 +-
 2 files changed, 12 insertions(+), 12 deletions(-)

commit eec1c3052d517d28961ab3e9acca02101b8697d4
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 16 20:47:32 2016 -0700

    BLE Host - Deal with va_args bug for master_id log
    
    X-Original-Commit: cda2363f16535c903c15063bd33006a247e1c61a

 nimble/host/src/ble_sm_cmd.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 65fb953fa9e340c8180c79e84f8703442814b97b
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 16 20:46:39 2016 -0700

    BLE Host - Consider bonding flag in rxed sec req.
    
    X-Original-Commit: 24c093c67e1e7d24f00efc261db3387c71566c55

 nimble/host/src/ble_sm.c | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

commit b6ff96d39cd3b79f77f01ab75f3cced952fa65fb
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 16 20:45:34 2016 -0700

    BLE Host - Don't restore bonding on enc. fail.
    
    X-Original-Commit: 8b26f565f7f3b12b84b18f47b161ca0a2ababd96

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 56e00a3f6c6dea52a19a72bbc0bfa0e61f4a1f70
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 15 20:46:29 2016 -0700

    BLE Host - SM: remove obsolete ediv,rand field
    
    X-Original-Commit: 06e134c7c545c5112ad8ae39ce3a04da8978a0ef

 nimble/host/src/ble_sm_lgcy.c | 4 ++--
 nimble/host/src/ble_sm_priv.h | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)

commit ececaa7bc46bb38dd7d4cfe6cdcb5952ddf73328
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 15 15:20:03 2016 -0700

    BLE Host - Fix unit tests with new startup seq.
    
    X-Original-Commit: daab0741ccf3b86dc425c008ec4a4f1acc133ad7

 nimble/host/src/test/ble_hs_test_util.c | 4 ++++
 1 file changed, 4 insertions(+)

commit a3dc1ab7385591342b6074c6472ba380c2143699
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 15 13:03:04 2016 -0700

    BLE Host - Fix build when SM disabled
    
    X-Original-Commit: d6e28db2d463e673b6992f9cea6a8aeb561fb4e3

 nimble/host/src/ble_sm_priv.h | 1 +
 1 file changed, 1 insertion(+)

commit da9fb3b1534e83608123868f485b0968260c0e3a
Author: William San Filippo <wills@runtime.io>
Date:   Wed Jun 15 08:29:35 2016 -0700

    Turn LE ping on by default
    
    X-Original-Commit: ec3cc917f1acf2220eab1812080a6d9b9c531c27

 nimble/include/nimble/nimble_opt.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 55f62952f4eead3df61ed544d8c23d1aa361765a
Author: William San Filippo <wills@runtime.io>
Date:   Wed Jun 15 08:28:44 2016 -0700

    Add LE ping and Authenticated Payload Timeout event
    
    X-Original-Commit: 3bed228d3ec8ec88f0dd09837931eb00f85d2d07

 nimble/controller/include/controller/ble_ll_conn.h |   7 ++
 nimble/controller/include/controller/ble_ll_ctrl.h |   2 +-
 nimble/controller/src/ble_ll.c                     |   4 +
 nimble/controller/src/ble_ll_conn.c                |  77 +++++++++++++++
 nimble/controller/src/ble_ll_conn_hci.c            | 106 +++++++++++++++++++++
 nimble/controller/src/ble_ll_conn_priv.h           |  15 +++
 nimble/controller/src/ble_ll_ctrl.c                |  44 +++++++--
 nimble/controller/src/ble_ll_hci.c                 |  42 +++++++-
 nimble/host/include/host/host_hci.h                |   2 +
 nimble/host/src/ble_hs_startup.c                   |  10 ++
 nimble/host/src/host_dbg.c                         |  25 +++++
 nimble/host/src/host_hci_cmd.c                     |  15 +++
 nimble/include/nimble/hci_common.h                 |   8 +-
 13 files changed, 346 insertions(+), 11 deletions(-)

commit fe31c09cba494f0763f98137adfd08db64f4c554
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 19:02:54 2016 -0700

    BLE Host - Clean up endianness confusion.
    
    X-Original-Commit: 4739392c098215e96bd628a4ca132c489b48dbf5

 nimble/host/src/ble_sm.c                | 24 ++++++++++++------------
 nimble/host/src/ble_sm_cmd.c            | 11 +++++------
 nimble/host/src/ble_sm_priv.h           |  2 +-
 nimble/host/src/test/ble_sm_test_util.c | 21 ++++++---------------
 4 files changed, 24 insertions(+), 34 deletions(-)

commit 641a7205a25e2afd76cc13a64db6a0af69805225
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 18:33:23 2016 -0700

    BLE Host - unit tests for combined priv/sc.
    
    X-Original-Commit: b4c34462bcda85dd7630207874c9e9f6f7ea8b7c

 nimble/host/src/test/ble_hs_test_util.c |   25 +-
 nimble/host/src/test/ble_hs_test_util.h |    5 +
 nimble/host/src/test/ble_sm_sc_test.c   | 1900 ++++++++++++++++++++++++++++++-
 nimble/host/src/test/ble_sm_test.c      |   72 +-
 nimble/host/src/test/ble_sm_test_util.c |  163 ++-
 nimble/host/src/test/ble_sm_test_util.h |   16 +-
 6 files changed, 2064 insertions(+), 117 deletions(-)

commit 252f8068dda9f7f641d2d31fbf70c6a48675843b
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 18:32:55 2016 -0700

    BLE Host - Include our_id_addr/type in conn desc.
    
    X-Original-Commit: ad94ca6a9f14ea452056898567f3d1c296bb0b0c

 nimble/host/include/host/ble_gap.h | 2 ++
 nimble/host/src/ble_gap.c          | 2 ++
 nimble/host/src/ble_hs_misc.c      | 2 +-
 nimble/host/src/ble_hs_priv.h      | 2 +-
 nimble/host/src/ble_sm.c           | 2 +-
 5 files changed, 7 insertions(+), 3 deletions(-)

commit 8c83741065d7d738f6207b0b0240e0c4d01430a5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 16:19:39 2016 -0700

    bletiny - Separate pairing from encryption.
    
    X-Original-Commit: ed9fea61fcaea134383aa3a76b48a19f1804a90d

 nimble/host/include/host/ble_gap.h |  6 +++---
 nimble/host/src/ble_gap.c          | 10 ++++++++++
 2 files changed, 13 insertions(+), 3 deletions(-)

commit 440edb8b1bd33cbd841b2393caaf60e302019afb
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 12:37:24 2016 -0700

    BLE Host - unit tests: restore via enc in sc tests
    
    X-Original-Commit: 67f01929acc32b3efc85264617cf169ffe33b4bb

 nimble/host/src/test/ble_sm_test.c      |  58 ---------
 nimble/host/src/test/ble_sm_test_util.c | 222 ++++++++++++++++----------------
 nimble/host/src/test/ble_sm_test_util.h |   6 -
 3 files changed, 110 insertions(+), 176 deletions(-)

commit 09db4056220c0606db0fa12612f3dac0628c3ab5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 12:36:57 2016 -0700

    BLE Host - Search DB when initiating security.
    
    X-Original-Commit: 7792ec58b93c914698df77c9f2db3d848e844b13

 nimble/host/src/ble_gap.c | 32 +++++++++++++++++++++++++++-----
 1 file changed, 27 insertions(+), 5 deletions(-)

commit e27a49939475aa77cdf80476a38b9e676cb725f5
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 11:27:38 2016 -0700

    BLE Host - More SM SC unit tests.
    
    X-Original-Commit: ad243cff72d4809faf22753bded194314dcc996a

 nimble/host/src/test/ble_sm_sc_test.c | 1357 +++++++++++++++++++++++++++++++++
 1 file changed, 1357 insertions(+)

commit 7fbffbccf47e310807ac49bb86b6c6ab8196109e
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 09:25:02 2016 -0700

    BLE Host - Rename mst/slv sec -> peer/our
    
    The "master security" and "slave security" nomenclature was misguided.
    It only made sense for the LTK persisted during legacy pairing.
    
    X-Original-Commit: d47d308a6ec1c0eaced171a805c05c1f5f353caa

 nimble/host/include/host/ble_store.h          | 20 +++-----
 nimble/host/src/ble_sm.c                      |  8 +--
 nimble/host/src/ble_store.c                   | 26 +++++-----
 nimble/host/src/test/ble_hs_test_util_store.c | 70 +++++++++++++--------------
 nimble/host/src/test/ble_sm_test_util.c       | 28 +++++------
 5 files changed, 73 insertions(+), 79 deletions(-)

commit d5d41773829bb633c93c20be0a709b16757b987e
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 14 09:19:54 2016 -0700

    BLE Host - Persist our IRK.
    
    X-Original-Commit: c684288390b808827f08fa7c62b3ad50522f2efd

 nimble/host/src/ble_sm.c | 1 +
 1 file changed, 1 insertion(+)

commit ae1a52d4843cb79da99ecd474a928d7cfdd083fe
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 13 16:23:29 2016 -0700

    BLE Host - SM SC unit tests.
    
    X-Original-Commit: 4f9739f74ec89743316bb0792c757bfbbb3153d4

 nimble/host/include/host/ble_hs_test.h  |   27 +-
 nimble/host/src/ble_hs_conn.c           |    1 +
 nimble/host/src/ble_sm.c                |    4 +-
 nimble/host/src/ble_sm_alg.c            |    7 -
 nimble/host/src/ble_sm_cmd.c            |   10 +-
 nimble/host/src/ble_sm_priv.h           |    4 +-
 nimble/host/src/ble_sm_sc.c             |    7 +
 nimble/host/src/host_hci_cmd.c          |   15 +-
 nimble/host/src/test/ble_hs_test.c      |    1 +
 nimble/host/src/test/ble_sm_sc_test.c   | 1696 ++++++++++++++++++++
 nimble/host/src/test/ble_sm_test.c      | 2557 ++++---------------------------
 nimble/host/src/test/ble_sm_test_util.c | 2092 +++++++++++++++++++++++++
 nimble/host/src/test/ble_sm_test_util.h |  145 ++
 13 files changed, 4287 insertions(+), 2279 deletions(-)

commit 483a0e3d62b0b270f3aeefb9ac7a4aaea24430f5
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 13 16:23:39 2016 -0700

    BLE Host - ble_hs_addrs() function.
    
    X-Original-Commit: 80fbd38b8258fd4c4c2f42644a056ee72b86fba1

 nimble/host/src/ble_gap.c          | 20 +++++-----
 nimble/host/src/ble_hs_conn.c      | 79 +++++++++-----------------------------
 nimble/host/src/ble_hs_conn_priv.h | 20 ++++++----
 nimble/host/src/ble_sm.c           | 66 ++++++++++---------------------
 nimble/host/src/ble_sm_priv.h      |  6 ++-
 nimble/host/src/ble_sm_sc.c        | 11 +++---
 6 files changed, 71 insertions(+), 131 deletions(-)

commit c818ca3e591a6dad061391f2d9ab972242d651f7
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 13 16:22:50 2016 -0700

    BLE Host - Add write functions for key exch msgs.
    
    X-Original-Commit: 8d06088276ca8500c56185fbc54b0243b02b6c12

 nimble/host/src/ble_sm_cmd.c | 66 +++++++++++++++++++++++++++++++++-----------
 1 file changed, 50 insertions(+), 16 deletions(-)

commit 5c91b9146e49d14eb5f0a10361a1c9c1ce39f9d0
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 9 19:56:00 2016 -0700

    BLE Host - SM; remove obsolete KEY_EXCH flag.
    
    X-Original-Commit: fb4b6cdaa1b4099089fc53d5cfa8d3968456bec6

 nimble/host/src/ble_sm.c      | 20 ++++++--------------
 nimble/host/src/ble_sm_cmd.c  |  4 ++--
 nimble/host/src/ble_sm_priv.h |  5 ++---
 3 files changed, 10 insertions(+), 19 deletions(-)

commit b53beb102abc26fe0c908e0336021783ac89243d
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 10 10:09:15 2016 +0800

    BLE Host - Send correct SM err on confirm mismatch.
    
    X-Original-Commit: c72b6b4c04aa9437230e825df30622e8814d2236

 nimble/host/src/ble_sm_sc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f708a9bdc2cccdcdcf5850041a81fd53a5ee0856
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 10 10:08:44 2016 +0800

    BLE Host - Fix mistakes in IO capabilities tables.
    
    X-Original-Commit: 84519461a1d2c1ea50d89168d832d55f43de0dee

 nimble/host/src/ble_sm_lgcy.c |  8 ++++----
 nimble/host/src/ble_sm_sc.c   | 36 ++++++++++++++++++++----------------
 2 files changed, 24 insertions(+), 20 deletions(-)

commit 4f237f4d5e557de73ee9bed81bc8efdab2fddaed
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 10 10:06:08 2016 +0800

    BLE Host - Persist keys if both sides want bonding
    
    X-Original-Commit: 24cd9ab92ea33cfcf87df2ac35580d85be09dd60

 nimble/host/src/ble_sm.c      | 23 ++++++++++++++---------
 nimble/host/src/ble_sm_priv.h |  5 +++--
 2 files changed, 17 insertions(+), 11 deletions(-)

commit 33ca43b17ea8ff5965ce6cc7f56af2a794817a6c
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 10 10:00:24 2016 +0800

    BLE Host - Log addresses in big endian.
    
    X-Original-Commit: 18bd234f58f1b27b364a7933a367d5ed28d1fd1b

 nimble/host/src/ble_hs_priv.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 3e8711c4d28b92889a83ec11f809fede392a68e3
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 9 08:00:54 2016 +0800

    BLE Host - Fix compiler errors!
    
    X-Original-Commit: 89d36b5cd24490a142bf5d371a9111dce1614712

 nimble/host/src/ble_gattc.c   | 5 ++---
 nimble/host/src/ble_hs_conn.c | 2 +-
 2 files changed, 3 insertions(+), 4 deletions(-)

commit 13408e52685f93d4751230762de4a649c38af757
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 19:50:20 2016 +0800

    BLE Host - Clear queue on gatt-reliable-write fail
    
    X-Original-Commit: af8610ac9c5c843f9ed786d6c5e5d2a71053846a

 nimble/host/src/ble_gattc.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit 42cd8c5ec995caba450f1f80ee8503e3831582af
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 19:48:22 2016 +0800

    BLE Host - Clear queue on gatt-long-write failure.
    
    X-Original-Commit: 1a7949f8f805a81c349bf0a1ebd0dda6ffa9314e

 nimble/host/src/ble_gattc.c                | 12 +++++++
 nimble/host/src/test/ble_gatt_write_test.c | 53 ++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test_util.c    | 14 ++++++++
 nimble/host/src/test/ble_hs_test_util.h    |  1 +
 4 files changed, 80 insertions(+)

commit 5f80243db40a06b61221131b2e31141a97d07e5a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 19:19:28 2016 +0800

    BLE Host - Don't kill SM proc when bad io injected
    
    X-Original-Commit: d43cb528518d8a473ad395f0b9f19abf44dd8ce2

 nimble/host/include/host/ble_sm.h  |  1 +
 nimble/host/src/ble_sm.c           | 32 ++++++++------
 nimble/host/src/test/ble_sm_test.c | 86 +++++++++++++++++++++++++++++++++++++-
 3 files changed, 106 insertions(+), 13 deletions(-)

commit ef32f01b1f0d5460c0f13da64caa38ed0a837481
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 18:46:27 2016 +0800

    BLE Host - Don't print status for no-op event.
    
    X-Original-Commit: 1fd06b576827f23f2070d736c2d59ca68c60403c

 nimble/host/src/host_dbg.c | 20 +++++++++++++++++---
 1 file changed, 17 insertions(+), 3 deletions(-)

commit 5e93fa48c08df6758be9f9d8a471be901c957ebe
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 18:36:44 2016 +0800

    BLE Host - Nack unexpected LTK reqs from ctlr.
    
    X-Original-Commit: a5f37f296655c4022cd29118b800198ec2f8231a

 nimble/host/src/ble_sm.c | 39 +++++++++++++++++++++++----------------
 1 file changed, 23 insertions(+), 16 deletions(-)

commit 618ce27250f5dedba9e185c3986a9c152af005a6
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 18:21:30 2016 +0800

    BLE Host - Rename sec_state.enc_enabled->encrypted
    
    X-Original-Commit: 5bbe2672dd41305e25d4e6bc8313297a6acdbcf3

 nimble/host/include/host/ble_gap.h           |   2 +-
 nimble/host/src/ble_att_svr.c                |   2 +-
 nimble/host/src/ble_sm.c                     |   2 +-
 nimble/host/src/test/ble_gatts_notify_test.c |   4 +-
 nimble/host/src/test/ble_sm_test.c           | 162 +++++++++++++--------------
 5 files changed, 86 insertions(+), 86 deletions(-)

commit 9e7731d3f3832b085297a896989cd3c0aac26b02
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 18:19:45 2016 +0800

    BLE Host - always honor ctlr encryption events.
    
    Update a connection's encryption state according to the incoming event,
    even if the event is unexpected.
    
    X-Original-Commit: 7a751686239704027a8eb88783296d6907b5c478

 nimble/host/include/host/ble_gap.h |   1 -
 nimble/host/src/ble_gap.c          |  21 +---
 nimble/host/src/ble_gap_priv.h     |   2 +-
 nimble/host/src/ble_sm.c           | 228 ++++++++++++++++++-------------------
 nimble/host/src/ble_sm_priv.h      |   7 +-
 nimble/host/src/test/ble_sm_test.c |  16 ---
 6 files changed, 119 insertions(+), 156 deletions(-)

commit 2319b45ef14aa874820bf792036fc2cbc852a213
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 15:06:07 2016 +0800

    BLE Host - SM SC: Log public / private keys.
    
    X-Original-Commit: 4fe1ee7aded29053554b28b480d57971065c3a5c

 nimble/host/src/ble_sm_alg.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit 1b407b27b1452603e5156313aa378579a66cbddc
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 15:05:28 2016 +0800

    BLE Host - Do key exchange if only one side txes.
    
    X-Original-Commit: ef291718a9c1ac4beabc286c15b8864836d85728

 nimble/host/src/ble_sm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 7eae23fa27d53331b6f63b9a781d6519343e2608
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 15:04:26 2016 +0800

    BLE Host - initiator tx key exch if no keys rx.
    
    X-Original-Commit: 0fea97810e84002b1ee1ec5b31cdbd88ac3e6e97

 nimble/host/src/ble_sm.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit e3c672e5853d589e490b5c0cf47e3ffab3e214e4
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 15:03:18 2016 +0800

    BLE Host - Never persist our own IRK in keystore.
    
    X-Original-Commit: 830149ea66137b43d72efc31f05dc3d48abf810f

 nimble/host/src/ble_sm.c | 1 +
 1 file changed, 1 insertion(+)

commit a3deed2f19e4b33d200c5157d6338a19b59a465e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 15:02:49 2016 +0800

    BLE Host - Reject SMP opcode 15.
    
    X-Original-Commit: a481a840bb8efca9abc5f3472b6835e7afa8464e

 nimble/host/src/ble_sm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d3c176ddb887e39969879b8679cf5fcf0ad41fd0
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jun 7 23:26:13 2016 -0700

    Fix resolving INITA in directed advertisement when initiating
    
    The code was not correctly handling the resolving of the INITA
    when we were the initiator and ther advertiser was sending a
    resolvable private address. The code needs to resolve the INITA
    and then make sure it is our device address.
    
    X-Original-Commit: af67329dfbc00d551d4905c42de75a4d5acfa8a0

 nimble/controller/src/ble_ll_conn.c | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

commit ecb9cd428fddc5939763312ba11d513a08b4b430
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 09:55:36 2016 +0800

    BLE Host - SM: Remove accidental assignment.
    
    X-Original-Commit: 6695d0c3810191c7f25314ab566a59ba2128d0ca

 nimble/host/src/ble_sm.c | 1 -
 1 file changed, 1 deletion(-)

commit 2ef1d9a6d0c39ad65decfce4e0ca7007fd76a40e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 09:36:27 2016 +0800

    BLE Host - Fix wrong peer addr type in ltk req rx.
    
    X-Original-Commit: d986a276f6210700ba96c6a426a5a7e767e0dcb1

 nimble/host/include/host/ble_gap.h |  2 ++
 nimble/host/src/ble_gap.c          |  3 ++-
 nimble/host/src/ble_sm.c           | 13 ++++++++++---
 3 files changed, 14 insertions(+), 4 deletions(-)

commit c3017926e2bcd2f9b60fd75d3b2ec2884129ec8c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 08:45:23 2016 +0800

    BLE Host - rename effective->ota; identity->id
    
    X-Original-Commit: 60e0453108d5a933f100e0d0c18797d107027e48

 nimble/host/include/host/ble_gap.h |   4 +-
 nimble/host/src/ble_gap.c          |  10 ++--
 nimble/host/src/ble_hs_conn.c      | 100 ++++++++++++++++++-------------------
 nimble/host/src/ble_hs_conn_priv.h |  16 +++---
 nimble/host/src/ble_sm.c           |  16 +++---
 nimble/host/src/ble_sm_sc.c        |  32 ++++++------
 6 files changed, 89 insertions(+), 89 deletions(-)

commit a559111557aeba0e42c88500ba0c21880f27198b
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 08:19:29 2016 +0800

    BLE Host - SM: correctly report encrypted state.
    
    Prior to this change, encryption was always reported as disabled.
    
    X-Original-Commit: fbc2b6093acaf98b124a001e2e9cf3a52f76e0b1

 nimble/host/src/ble_sm.c | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

commit fece89fa14d1e956302ea26057139257c306a9f5
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 08:18:23 2016 +0800

    BLE Host - include both addresses in conn desc.
    
    Previous to this change, the connection descriptor returned by the GAP
    only contained the peer identity address.  Now it contains both the
    peer's effective address and identity address, as well as the local
    effective address.
    
    X-Original-Commit: c589590065e8f04ca75f4a0503642ee61f798a17

 nimble/host/include/host/ble_gap.h      |  6 ++++--
 nimble/host/src/ble_gap.c               | 14 ++++++++++++--
 nimble/host/src/test/ble_gap_test.c     | 30 +++++++++++++++---------------
 nimble/host/src/test/ble_hs_test_util.c |  2 ++
 nimble/host/src/test/ble_os_test.c      |  4 ++--
 5 files changed, 35 insertions(+), 21 deletions(-)

commit 51c9f52cd6158b1137ceda013f9efaec372dd10a
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jun 7 17:38:10 2016 -0700

    Forget to initialize rxadd properly if directed advertising
    
    X-Original-Commit: e03ce5ed696853e76205d4d1190e36fbbe3f9cc1

 nimble/controller/src/ble_ll_adv.c | 5 +++++
 1 file changed, 5 insertions(+)

commit 8bdd7d9cb2ae3ee68679b7b5cc7cdb326ccc5f02
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 8 05:50:16 2016 +0800

    BLE Host - Fix privacy+pairing bug.
    
    We were still not using the correct address types and adresses in the
    cryptographic functions when privacy was in effect.  All crypto
    functions now use:
        * identity address type
        * effective address (RPA if privacy in use; else identity addr).
    
    X-Original-Commit: eb177946f0fa7b80eaf67fda60639c1fe88a1efd

 nimble/host/src/ble_gap.c          |   2 +-
 nimble/host/src/ble_hs_conn.c      | 111 ++++++++++++++++++++++++++-----------
 nimble/host/src/ble_hs_conn_priv.h |  14 +++--
 nimble/host/src/ble_sm.c           |  30 ++++++----
 nimble/host/src/ble_sm_alg.c       |   3 +
 nimble/host/src/ble_sm_lgcy.c      |   2 +-
 nimble/host/src/ble_sm_priv.h      |   3 +-
 nimble/host/src/ble_sm_sc.c        |  66 +++++++++++++++-------
 8 files changed, 164 insertions(+), 67 deletions(-)

commit bb1407587346ded842c0511145f802f506e5e760
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 22:38:48 2016 +0800

    BLE Host - Always use effective addrs during SMP.
    
    Prior to this change, SM procedures used identity addresses as inputs
    into the crypto functions.  Now we always use the effective address (RPA
    is one is being used, else public or random static).
    
    X-Original-Commit: be5a98505e12d24b66eedb96b0580790ea0a6680

 nimble/host/include/host/ble_store.h |  4 +++
 nimble/host/src/ble_gap.c            |  3 +++
 nimble/host/src/ble_hs_conn.c        | 52 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_conn_priv.h   |  4 +++
 nimble/host/src/ble_hs_misc.c        | 18 +++++++++++++
 nimble/host/src/ble_hs_priv.h        |  2 ++
 nimble/host/src/ble_sm.c             | 21 +++++++++------
 nimble/host/src/ble_store.c          | 11 ++++++++
 8 files changed, 107 insertions(+), 8 deletions(-)

commit 24e93bf76ef5744e6e3e44ad3ebfc7ece1056d1b
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 22:34:07 2016 +0800

    BLE Host - persist irk properly when ltk not xchgd
    
    This change addresses a bug that occurred when IRKs are exchanged during
    SM key exchange, but LTKs are not exchanged.  Under these conditions,
    the peer's address was not correctly associated with the persisted IRK.
    The result was that subsequent IRK lookups would fail.
    
    X-Original-Commit: 32afd9cacd7844f64545f6f4007967cec9fd7baf

 nimble/host/src/ble_sm.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit c989e4d072874c588955e788a076db9025c08eb0
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 18:43:57 2016 +0800

    BLE Host - Enable data-length-change event by dflt
    
    X-Original-Commit: a96152c317148be63c4e0f36d259841716ebe67c

 nimble/host/src/ble_hs_startup.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 62e53ae685b48920a452b9a63184cdee7ec9b374
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 18:37:01 2016 +0800

    BLE Host - set data length HCI command.
    
    X-Original-Commit: 3390ece181c643a0a8e76958149f4b6337acf96b

 nimble/host/include/host/host_hci.h |  3 ++
 nimble/host/src/ble_hci_util.c      | 35 +++++++++++++
 nimble/host/src/ble_hci_util_priv.h |  2 +
 nimble/host/src/host_hci_cmd.c      | 99 ++++++++++++++++++++++++++++++-------
 nimble/include/nimble/hci_common.h  |  5 ++
 5 files changed, 125 insertions(+), 19 deletions(-)

commit ffa46194b2007b718a58cd54321d33093965356c
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 08:07:48 2016 +0800

    BLE Host - Don't change enc status on SMP timeout.
    
    X-Original-Commit: 3550530574c04da35d028641ec20c1e2f9c78ae3

 nimble/host/src/ble_sm.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 8bfd7e6853d1772533957a02eb45754809758f55
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 07:59:54 2016 +0800

    BLE Host - Fix for encryption key refresh.
    
    X-Original-Commit: 466a619cb9d46b2c2e40f8489435e11ef1299744

 nimble/host/src/ble_sm.c | 2 ++
 1 file changed, 2 insertions(+)

commit c78ce5fb0fae1940276b2de41c7f26bdcb3e2258
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 07:58:08 2016 +0800

    BLE Host - enable key rfrsh & param req events.
    
    X-Original-Commit: c6e2b7a5c929cb4b9e25a1315f366ff8d2f827f0

 nimble/host/src/ble_hs_startup.c | 58 +++++++++++++++++++++++++++++++++++++---
 1 file changed, 54 insertions(+), 4 deletions(-)

commit d10e8a135408b56e052c97518b00e961c4f84ded
Author: William San Filippo <wills@runtime.io>
Date:   Tue Jun 7 01:43:08 2016 -0700

    Fix directed advertising when using rpa for inita
    
    X-Original-Commit: 2961d20a5c15d6b809b089d000e292d00f7d15d7

 nimble/controller/src/ble_ll_adv.c | 17 +++++++++++++----
 1 file changed, 13 insertions(+), 4 deletions(-)

commit b45a1e22f7836238663391c75ebd367c53ad3380
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 22:29:39 2016 +0800

    BLE Host - Encryption key refresh.
    
    X-Original-Commit: 00857834da9bc1a52d5bd104ed6cd8073c891177

 nimble/host/src/ble_sm.c           | 78 ++++++++++++++++++++++++++++++++------
 nimble/host/src/ble_sm_priv.h      |  4 ++
 nimble/host/src/host_hci.c         | 19 ++++++++++
 nimble/include/nimble/hci_common.h |  9 +++++
 4 files changed, 99 insertions(+), 11 deletions(-)

commit 3a2b9b39c678295ca2d8596e97536fa91fb4b4f1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 10 11:23:52 2016 -0700

    BLE Host - Fix build when security disabled.
    
    The host failed to compile when NIMBLE_OPT_SM was disabled.  This commit
    fixes this build error.
    
    The change which broke the build should never have been committed in the
    first place.  That change is part of a larger set of changes that need
    to be committed at the same time.  This was my screw up.  Sorry
    everyone!
    
    X-Original-Commit: 84f0e6c72b1cc0f7502955b1a2483378407b4ca0

 nimble/host/include/host/ble_gap.h      |  1 +
 nimble/host/src/ble_gap.c               | 18 ++++++++++++++++--
 nimble/host/src/ble_sm_lgcy.c           |  4 ++++
 nimble/host/src/ble_sm_priv.h           |  5 +++++
 nimble/host/src/test/ble_sm_test.c      |  1 +
 nimble/include/nimble/nimble_opt.h      |  4 ++--
 nimble/include/nimble/nimble_opt_auto.h | 12 ++++++++++++
 7 files changed, 41 insertions(+), 4 deletions(-)

commit 24c73b605764952f3b6ae2ec7b9448b31a91eec6
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 9 08:40:03 2016 +0800

    BLE Host - Fix for builds with debug log disabled.
    
    X-Original-Commit: 4300d57c8897a95fd9063fe878b0920d2193593d

 nimble/host/src/ble_hs_priv.h | 1 +
 1 file changed, 1 insertion(+)

commit b47445c6affaf07c01781d9f0101723fa90e661f
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Jun 7 08:00:04 2016 +0800

    BLE Host - More log cleanup.
    
    X-Original-Commit: 86dcaf93dba50f5caa1f0d6cb5ade01829dd468b

 nimble/host/src/ble_att_svr.c |  9 +++++----
 nimble/host/src/ble_hs_priv.h | 24 ++++++++++++------------
 2 files changed, 17 insertions(+), 16 deletions(-)

commit 591cc8cf58464a37f7e137f140d817acc2a2c017
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jun 6 14:18:29 2016 -0700

    Add statistic to count received l2cap bytes at LL
    
    X-Original-Commit: d42eddc47836f50ea4879c7c6bcdc67f4d1d393d

 nimble/controller/src/ble_ll_conn.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 249b5b328908d83734ba1dc63dc47d221bbc4644
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 21:41:33 2016 +0800

    BLE Host - clean up packet logging.
    
    X-Original-Commit: a3e7ae6d03d67ef402091e209c14aeba1c567137

 nimble/host/src/ble_att_clt.c      | 59 ++++++++++++++++++++++++
 nimble/host/src/ble_att_cmd.c      | 94 +++++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_att_cmd_priv.h | 30 ++++++++----
 nimble/host/src/ble_att_priv.h     |  3 ++
 nimble/host/src/ble_att_svr.c      | 44 +++++++++++++++++-
 nimble/host/src/ble_hs_priv.h      |  7 +++
 6 files changed, 227 insertions(+), 10 deletions(-)

commit 2fcf83d390c0a58b16164696515bbab885cf4b32
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 20:34:39 2016 +0800

    INTERIM - logging
    
    X-Original-Commit: 7120ba14d012890632aa8d06a51ebad924e58cb3

 nimble/host/src/ble_att_clt.c  |   4 +-
 nimble/host/src/ble_att_priv.h |  22 +----
 nimble/host/src/ble_att_svr.c  |   2 +-
 nimble/host/src/ble_hs_priv.h  |  17 ++++
 nimble/host/src/ble_sm.c       |  47 ++++------
 nimble/host/src/ble_sm_cmd.c   | 193 +++++++++++++++++++++++++----------------
 nimble/host/src/ble_sm_priv.h  |  76 +++++++++-------
 nimble/host/src/ble_sm_sc.c    |  15 +---
 8 files changed, 206 insertions(+), 170 deletions(-)

commit 547b37d9b5c4f8d839de80f1bfe8f66e604a0612
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 19:43:37 2016 +0800

    BLE Host - Rename SM identifiers for consistency.
    
    X-Original-Commit: 6c8d7bd3d619b74a47809ddf92a3706f3bfe31a5

 nimble/host/include/host/ble_sm.h  |  20 +--
 nimble/host/src/ble_sm.c           | 279 +++++++++++++++++++------------------
 nimble/host/src/ble_sm_lgcy.c      |  51 ++++---
 nimble/host/src/ble_sm_priv.h      |  55 ++++----
 nimble/host/src/ble_sm_sc.c        | 111 +++++++--------
 nimble/host/src/host_hci.c         |   4 +-
 nimble/host/src/test/ble_sm_test.c | 128 +++++++++--------
 7 files changed, 325 insertions(+), 323 deletions(-)

commit f60ce985fdf21a7ad2793169726b7a3ab8315d45
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 19:16:14 2016 +0800

    BLE Host - Fix inconsistent GATT identifier names.
    
    X-Original-Commit: baa7a027f55b357fc9de733ddd5fa8b322c8d3f4

 nimble/host/include/host/ble_gatt.h         |   8 +-
 nimble/host/src/ble_gattc.c                 |  22 +--
 nimble/host/src/test/ble_gatt_conn_test.c   |   6 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c | 210 ++++++++++++++--------------
 nimble/host/src/test/ble_gatt_disc_s_test.c |   4 +-
 nimble/host/src/test/ble_gatt_find_s_test.c |   6 +-
 6 files changed, 128 insertions(+), 128 deletions(-)

commit 3c9d3f46999ecd2673d5ae2c3ddb708ceaff13f5
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 18:27:37 2016 +0800

    BLE Host - Add comment about ltk endianness.
    
    X-Original-Commit: 0b120257b855f08225b9dc5fce097eea94971da3

 nimble/host/src/ble_sm_priv.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3e0e4716bfed6ef1d161a9f515c03af36159c52d
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jun 6 03:41:54 2016 -0700

    Fix ble log being turned on by default
    
    X-Original-Commit: 873180f6542eb816b009432b2c18bab25c5f00fc

 nimble/controller/include/controller/ble_ll.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 84f707fe3709031cc989306c05d2baed970342c6
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jun 6 03:37:41 2016 -0700

    Fix issue when receiving an invalid pdu type
    
    When doing testing at unplugfest we noticed devices sending an invalid
    pdu type. This was causing our code to restart reception without first
    disabling the PHY. This was showing up as a radio state error. We now
    disable the PHY first.
    
    X-Original-Commit: be4996dcf1ce8c7c6c8901b04cb6462da84b6d8f

 nimble/controller/src/ble_ll.c      | 1 -
 nimble/controller/src/ble_ll_conn.c | 1 +
 nimble/controller/src/ble_ll_scan.c | 1 +
 3 files changed, 2 insertions(+), 1 deletion(-)

commit a111a3f1541f0f38fc48964bf7877f2a88e5c05b
Author: William San Filippo <wills@runtime.io>
Date:   Mon Jun 6 01:39:33 2016 -0700

    Fix TXADD bit not being set correctly in advertisements for all cases
    
    X-Original-Commit: 344418270465ab93633d03c0034f95fb38ae9654

 nimble/controller/include/controller/ble_ll.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5550f64b15c0b661f1137e0a5777aa6c875a0bfa
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 09:05:07 2016 +0800

    BLE controller - enable data length extension.
    
    I accidentally disabled this feature by default!
    
    X-Original-Commit: 3e6710122cc27c97ad528cdd61384f32c52b73ea

 nimble/include/nimble/nimble_opt.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b2b79fefbddbeb9078ed07acd6ea6357b29e2ed1
Author: William San Filippo <wills@runtime.io>
Date:   Sun Jun 5 17:04:50 2016 -0700

    Add privacy and extended scanner filter policy to supported features
    
    X-Original-Commit: bb30502d2d27d3b2f8b79627b38808bab4244f07

 nimble/controller/src/ble_ll.c | 1 +
 1 file changed, 1 insertion(+)

commit 36eb1d08ca09faf8076f16ce9e7dbc3471c0296b
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Jun 6 06:50:11 2016 +0800

    BLE Host - Clean up debug logging.
    
    X-Original-Commit: cbeee54400def52228b67e41c6451f68f490c459

 nimble/host/src/ble_att_clt.c      |  9 ++++++---
 nimble/host/src/ble_att_cmd.c      | 13 +++++++++++++
 nimble/host/src/ble_att_cmd_priv.h |  2 ++
 nimble/host/src/ble_att_priv.h     | 21 ++++++++++++++++++---
 nimble/host/src/ble_att_svr.c      |  1 +
 nimble/host/src/ble_l2cap.c        |  3 ---
 6 files changed, 40 insertions(+), 9 deletions(-)

commit 1a0b3a809753e93bbf2165455205429d1d5657db
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 5 19:45:35 2016 +0800

    BLE Host - Remove stray memcpy.
    
    X-Original-Commit: 5f74e4fd1d1a2b1df701186ca1777594e45d1501

 nimble/host/src/ble_sm.c | 1 -
 1 file changed, 1 deletion(-)

commit b2d5bafa0e2d112625c1a28ffa33eb0aa0842cf0
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 5 18:52:18 2016 +0800

    BLE Host - SC "us" unit tests.
    
    X-Original-Commit: 3f1802e563a931cc228d1d86a074d27b292996a3

 nimble/host/src/ble_sm.c           |  27 +-
 nimble/host/src/ble_sm_priv.h      |   1 +
 nimble/host/src/ble_sm_sc.c        |  20 +-
 nimble/host/src/test/ble_sm_test.c | 846 ++++++++++++++++++++++++++++++++++++-
 4 files changed, 864 insertions(+), 30 deletions(-)

commit efd485afc26e7e1cc34952a6e758e69a61ab33ce
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 5 18:51:24 2016 +0800

    BLE Host - Log outgoing SM commands.
    
    X-Original-Commit: 924792b02a6f271da85123220d02637d9a23b80d

 nimble/host/src/ble_sm_cmd.c | 53 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 53 insertions(+)

commit 4311983ac9afcb6d7d1e90d101046050725b3c57
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 5 16:08:37 2016 +0800

    BLE Host - sc; persist both slv and mst keys.
    
    X-Original-Commit: f409863df342a6aacc373211f352de525edd5a1f

 nimble/host/src/ble_sm.c           | 48 +++++++++++++++++++++++---------------
 nimble/host/src/ble_sm_sc.c        |  6 +++++
 nimble/host/src/test/ble_sm_test.c | 16 ++++++++++---
 3 files changed, 48 insertions(+), 22 deletions(-)

commit 94574055b927d73b754a395e1e76b2fa21360fc4
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat Jun 4 12:50:11 2016 -0700

    BLE Host - Don't build SC unless so configured.
    
    X-Original-Commit: fa48add93707fd09e304b9f8247b56909a6c3db2

 nimble/host/include/host/ble_sm.h  |  2 +-
 nimble/host/pkg.yml                |  5 +++++
 nimble/host/src/ble_hs.c           |  2 --
 nimble/host/src/ble_sm.c           |  2 ++
 nimble/host/src/ble_sm_priv.h      | 29 +++++++++++++++--------------
 nimble/host/src/ble_sm_sc.c        |  5 +++++
 nimble/include/nimble/nimble_opt.h |  4 ++--
 7 files changed, 30 insertions(+), 19 deletions(-)

commit c3b2fca34464380a913c1ac418d67f87f98ea2e4
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 3 23:39:47 2016 -0700

    BLE Host - SC unit test, us as initiator.
    
    X-Original-Commit: 8a13fa370827de8b457d0643a4785a67f3493fba

 nimble/host/src/ble_sm.c           |  16 ++--
 nimble/host/src/ble_sm_priv.h      |   1 +
 nimble/host/src/ble_sm_sc.c        |  25 +++++-
 nimble/host/src/test/ble_sm_test.c | 179 ++++++++++++++++++++++++++++++++++++-
 4 files changed, 205 insertions(+), 16 deletions(-)

commit a6d715741de57ba2467fda870e4c999e185c01da
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 3 12:47:24 2016 -0700

    BLE Host - Rearrange SM test code.
    
    X-Original-Commit: fcafe0a2be165787b727cca8b0d27ac9ab71c132

 nimble/host/include/host/ble_store.h |    7 +-
 nimble/host/src/test/ble_sm_test.c   | 2933 +++++++++++++++++-----------------
 2 files changed, 1473 insertions(+), 1467 deletions(-)

commit fe7a04784377e143ec3d36ff3cd4d845a79611a1
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Jun 3 08:43:14 2016 -0700

    BLE Host - Persist LTK on SC success.
    
    X-Original-Commit: caf7588b37ca4fdd509d5c2f2424bb5f4d0d3da1

 nimble/host/include/host/ble_store.h          |   1 -
 nimble/host/src/ble_sm.c                      |  38 ++++----
 nimble/host/src/ble_sm_sc.c                   |  10 ++-
 nimble/host/src/ble_store.c                   |  51 ++++++++---
 nimble/host/src/test/ble_hs_test_util_store.c |  28 +++---
 nimble/host/src/test/ble_sm_test.c            | 119 ++++++++++++++++++++++++--
 6 files changed, 193 insertions(+), 54 deletions(-)

commit 521678f14dbd8b4056e2db2584fd4a66210b2dce
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 2 19:28:24 2016 -0700

    BLE Host - Remove extraneous log message
    
    X-Original-Commit: 0f774257417efd04cc1786498dfec28cd3c9a16e

 nimble/host/src/ble_gap.c | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

commit b2b5a78dc9777653430c933d75120c813d841cb6
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 2 19:25:09 2016 -0700

    BLE Host - Merge privacy changes.
    
    X-Original-Commit: f03daf58ea6fc69edd27334ccc3f3a7fc6fc6e98

 nimble/host/src/ble_sm.c      | 91 ++++++++++++++++---------------------------
 nimble/host/src/ble_sm_lgcy.c | 28 +++----------
 nimble/host/src/ble_sm_priv.h |  4 +-
 nimble/host/src/ble_sm_sc.c   | 20 ++++++----
 4 files changed, 54 insertions(+), 89 deletions(-)

commit 41bf7936c85d6d5d5a4ca0f156e6b080d7e3f0ec
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 2 18:35:51 2016 -0700

    BLE Host - SC cosmetic changes.
    
    X-Original-Commit: 10d7a5292a8f290cbea77668c29eefa9f23aecc2

 nimble/host/src/ble_sm.c      |  16 +++--
 nimble/host/src/ble_sm_alg.c  |  17 ++---
 nimble/host/src/ble_sm_lgcy.c |   2 +-
 nimble/host/src/ble_sm_priv.h |  33 +++++-----
 nimble/host/src/ble_sm_sc.c   | 141 ++++++++++++++++++++++++------------------
 5 files changed, 110 insertions(+), 99 deletions(-)

commit 0b532c966e20e244badf33135b184da4342cd4f1
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Jun 2 16:17:09 2016 -0700

    BLE Host - unit test for SC passkey.
    
    X-Original-Commit: 1e085a07a20139ad89f3f8557947624459e1bb14

 nimble/host/src/test/ble_sm_test.c | 658 +++++++++++++++++++++++++++++++++++--
 1 file changed, 628 insertions(+), 30 deletions(-)

commit c3680442d9ad618bbdc12543886ddf1b53f967ec
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 5 19:16:43 2016 +0800

    BLE Host - Fix SM bug - keydist use pair rsp.
    
    Previously we were looking at both the pair req and pair rsp.
    
    X-Original-Commit: 32494608ad31fc6193c406da85e307881c7247ba

 nimble/host/src/ble_sm.c      |  20 +++----
 nimble/host/src/ble_sm_priv.h |   4 ++
 nimble/host/src/ble_sm_sc.c   | 125 ++++++++++++++++++++++++++++++++++--------
 3 files changed, 117 insertions(+), 32 deletions(-)

commit c528b7c8e51f45f52d2ea60d322ec7914d652a46
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 19:00:43 2016 -0700

    BLE Host - Fix SM bug - keydist use pair rsp.
    
    Previously we were looking at both the pair req and pair rsp.
    
    X-Original-Commit: 3c3c49fa4b33a0b43423366879ca97836716c6d6

 nimble/host/src/ble_sm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9412801c9f3188a6a7e8c1fdda5f466fe77f4fb4
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 18:19:50 2016 -0700

    BLE Host - SC numeric comparison.
    
    X-Original-Commit: f84a1127bfb59edadfa8f18dcf9efe605d999f05

 nimble/host/src/ble_sm.c           |  29 +++--
 nimble/host/src/ble_sm_alg.c       |   2 +-
 nimble/host/src/ble_sm_priv.h      |   4 +-
 nimble/host/src/ble_sm_sc.c        |  27 ++--
 nimble/host/src/test/ble_sm_test.c | 253 +++++++++++++++++++++++++++++++++----
 5 files changed, 265 insertions(+), 50 deletions(-)

commit 30f0897ef2e5062b777347d6866f7caf4a870644
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 15:13:02 2016 -0700

    BLE Host - Fix log issue.
    
    X-Original-Commit: 133e0605e80a53a61d4a19ec5329118fc9ea4aae

 nimble/host/src/ble_gap.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit d5354f0cbd00651b6b4640a823653cd820e85b3c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 15:12:30 2016 -0700

    BLE Host - Fix SC unit test.
    
    X-Original-Commit: aa9df8daac55c0e1113a7bab71c5a84d88363363

 nimble/host/src/test/ble_sm_test.c | 75 ++++++++++++++++++--------------------
 1 file changed, 36 insertions(+), 39 deletions(-)

commit c2e1ce9fc594e4b7c69616bd77e213726e768703
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 13:18:23 2016 -0700

    BLE Host - Initial numeric comparison impl.
    
    X-Original-Commit: f63ff4fb39a32b9ab3d5048c341e3ff519d7d24c

 nimble/host/include/host/ble_gap.h | 25 +++--------
 nimble/host/include/host/ble_sm.h  |  3 +-
 nimble/host/src/ble_gap.c          |  5 ++-
 nimble/host/src/ble_gap_priv.h     |  3 +-
 nimble/host/src/ble_sm.c           | 88 +++++++++++++++++++++++++++++---------
 nimble/host/src/ble_sm_priv.h      |  4 +-
 nimble/host/src/ble_sm_sc.c        | 47 +++++++++++++++++---
 7 files changed, 123 insertions(+), 52 deletions(-)

commit 2265253b4e11b710cdffc0626595bbf13b494af1
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 10:22:38 2016 -0700

    BLE Host - Ignore EncKey flag in SC.
    
    X-Original-Commit: 487eabf0004bc0df16287481ee080de46c98dad2

 nimble/host/src/ble_sm.c | 44 ++++++++++++++++++++++++++++++++------------
 1 file changed, 32 insertions(+), 12 deletions(-)

commit 8351609a5d110df7c8942b6a99a70e62349dc8ca
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 10:01:58 2016 -0700

    BLE Host - Initial numeric comparison work.
    
    X-Original-Commit: 67fbdd4e132f4a9b0b4550112f084b7cf162ad03

 nimble/host/include/host/ble_gap.h |  1 +
 nimble/host/include/host/ble_sm.h  |  2 +-
 nimble/host/src/ble_sm_sc.c        | 68 ++++++++++++++++++++++++++++++++------
 3 files changed, 59 insertions(+), 12 deletions(-)

commit d01ffaff5a882c378edbfac76cdc3884e6a2f1b2
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 31 22:47:00 2016 -0700

    BLE Host - Fix incorrect IO capabilities table.
    
    X-Original-Commit: e4bab3334c5cced1023443403b4eb78d42cb83cf

 nimble/host/src/ble_sm_lgcy.c | 19 ++++++++++---------
 1 file changed, 10 insertions(+), 9 deletions(-)

commit f6534db921d571d664cb304cc24bca2bec06d348
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 31 14:11:42 2016 -0700

    BLE Host - Use tinycrypt for SC.
    
    X-Original-Commit: 892a80a1bfecbd83475641051a36bb48ed13f2ee

 nimble/host/include/host/ble_sm.h  |   1 +
 nimble/host/pkg.yml                |   1 +
 nimble/host/src/ble_hs.c           |   2 +
 nimble/host/src/ble_sm.c           |  48 +++++++-
 nimble/host/src/ble_sm_alg.c       | 201 +++++++++++++++++++--------------
 nimble/host/src/ble_sm_priv.h      |  12 +-
 nimble/host/src/ble_sm_sc.c        | 226 +++++++++++++++++++++++++++++--------
 nimble/host/src/test/ble_sm_test.c | 197 +++++++++++++++++++++++++-------
 nimble/include/nimble/nimble_opt.h |   8 +-
 9 files changed, 517 insertions(+), 179 deletions(-)

commit b8d486e12e70460643333501547a8fb6a47ef2fa
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 31 10:39:45 2016 -0700

    BLE Host - Rearrange some SM code.
    
    X-Original-Commit: e673cace077b789bf1a54680f940bab630951203

 nimble/host/src/ble_sm.c    | 1164 ++++++++++++++++++++++---------------------
 nimble/host/src/ble_sm_sc.c |    4 -
 2 files changed, 584 insertions(+), 584 deletions(-)

commit 944186dc56c7db42731ee46e9939ad48f6e7a103
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 30 23:32:40 2016 -0700

    BLE Host - rename sm identifiers for consistency.
    
    X-Original-Commit: ac11583f7baf651f964b0ec34f3d7c37554ba694

 nimble/host/include/host/ble_l2cap.h |  85 ----------------------
 nimble/host/include/host/ble_sm.h    |  96 +++++++++++++++++++++++++
 nimble/host/src/ble_gap.c            |   2 +-
 nimble/host/src/ble_gap_priv.h       |   2 +-
 nimble/host/src/ble_sm.c             | 136 +++++++++++++++++------------------
 nimble/host/src/ble_sm_cmd.c         |  55 +++++++-------
 nimble/host/src/ble_sm_lgcy.c        |  25 +++----
 nimble/host/src/ble_sm_priv.h        | 129 +++++++++++++++++----------------
 nimble/host/src/ble_sm_sc.c          |  13 ++--
 nimble/host/src/test/ble_sm_test.c   |  23 +++---
 10 files changed, 289 insertions(+), 277 deletions(-)

commit 9c5e1a0cff7635511541d3eeecb9107512e8f5ef
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 30 20:45:55 2016 -0700

    BLE Host - separate key exchange into functions.
    
    X-Original-Commit: 2fa2f24d757095f2bcf90e20f7188ed96a3b7e50

 nimble/host/src/ble_sm.c | 324 +++++++++++++++++++++++++----------------------
 1 file changed, 170 insertions(+), 154 deletions(-)

commit 60ee99bffa81e856468b1b4ab0fda22b8a2e6203
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 30 20:19:53 2016 -0700

    BLE Host - Don't forget to persist keys.
    
    X-Original-Commit: e4b08e805d1cf151d36f23c3ae3321e2a740d1cd

 nimble/host/src/ble_sm.c | 2 ++
 1 file changed, 2 insertions(+)

commit e915d0182c51742e2c051767bfdac76e393829f3
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 30 13:21:00 2016 -0700

    BLE Host - Move state repetition go->process_result.
    
    X-Original-Commit: d9b093253b7f87a0b54c01cedee232adfe3e20a1

 nimble/host/include/host/ble_gap.h                 |    2 +-
 nimble/host/include/host/ble_hs_test.h             |    2 +-
 nimble/host/include/host/ble_l2cap.h               |  182 +-
 nimble/host/src/ble_gap.c                          |    8 +-
 nimble/host/src/ble_hs.c                           |    2 +-
 nimble/host/src/ble_hs_conn.c                      |    2 +-
 nimble/host/src/ble_hs_priv.h                      |    2 +-
 nimble/host/src/ble_l2cap.c                        |    2 +-
 nimble/host/src/ble_l2cap_sm.c                     | 2434 --------------------
 nimble/host/src/ble_l2cap_sm_cmd.c                 |  645 ------
 nimble/host/src/ble_l2cap_sm_priv.h                |  447 ----
 nimble/host/src/ble_sm.c                           | 2190 ++++++++++++++++++
 .../host/src/{ble_l2cap_sm_alg.c => ble_sm_alg.c}  |  158 +-
 nimble/host/src/ble_sm_cmd.c                       |  633 +++++
 nimble/host/src/ble_sm_lgcy.c                      |  120 +-
 nimble/host/src/ble_sm_priv.h                      |  445 ++++
 nimble/host/src/ble_sm_sc.c                        |  284 ++-
 nimble/host/src/host_hci.c                         |    4 +-
 nimble/host/src/test/ble_hs_test.c                 |    2 +-
 .../test/{ble_l2cap_sm_test.c => ble_sm_test.c}    | 1230 +++++-----
 nimble/include/nimble/nimble_opt.h                 |    2 +-
 21 files changed, 4252 insertions(+), 4544 deletions(-)

commit 579ba9dd8168100c7702cf910cfd825b7aa596d9
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 27 10:27:41 2016 -0700

    BLE Host - Rearrange SM.
    
    X-Original-Commit: 023769e4765672e064aa22d76e804a2aab028f33

 nimble/host/pkg.yml                      |    1 +
 nimble/host/src/ble_l2cap_sm.c           | 1505 +++++++++++++-----------------
 nimble/host/src/ble_l2cap_sm_cmd.c       |    1 +
 nimble/host/src/ble_l2cap_sm_priv.h      |   78 +-
 nimble/host/src/ble_sm_lgcy.c            |  171 +++-
 nimble/host/src/ble_sm_sc.c              |  359 +++++++
 nimble/host/src/test/ble_l2cap_sm_test.c |   63 +-
 7 files changed, 1256 insertions(+), 922 deletions(-)

commit a563d204ad5d6a0927079c067c435d01f410b5cc
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 26 20:16:50 2016 -0700

    BLE Host - separate lgcy/sc
    
    X-Original-Commit: b8437929023893dbee73968f292110d03dfd6fe5

 nimble/host/src/ble_l2cap_sm.c      | 218 ++++++------------------------------
 nimble/host/src/ble_l2cap_sm_priv.h |  80 +++++++++++++
 nimble/host/src/ble_sm_lgcy.c       | 174 ++++++++++++++++++++++++++++
 3 files changed, 291 insertions(+), 181 deletions(-)

commit 8fc421a5b3b93ec2394f5c143008d3a1b01d7ede
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 28 18:13:07 2016 -0700

    BLE Host - Initial secure connections support.
    
    X-Original-Commit: 00f17424bc170aff896a4bacab2cfb2eb58f3994

 nimble/host/include/host/ble_l2cap.h     |   1 +
 nimble/host/src/ble_l2cap_sm.c           | 511 +++++++++++++++++++++++++++----
 nimble/host/src/ble_l2cap_sm_alg.c       | 292 ++++++++++++++++++
 nimble/host/src/ble_l2cap_sm_cmd.c       | 124 ++++++++
 nimble/host/src/ble_l2cap_sm_priv.h      |  48 ++-
 nimble/host/src/test/ble_hs_test_util.c  |   2 +-
 nimble/host/src/test/ble_l2cap_sm_test.c | 412 +++++++++++++++++++++++--
 nimble/include/nimble/ble.h              |   3 +
 8 files changed, 1306 insertions(+), 87 deletions(-)

commit fde824063d44944e63d719d0e729fa1ea1973835
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun Jun 5 13:31:35 2016 +0800

    BLE Host - Add "black hole" L2CAP CID.
    
    This L2CAP channel is only useful for testing.  Sometimes we don't want
    "invalid CID" responses to be sent.
    
    X-Original-Commit: 02ab1a63be4c5403c855e090e8613172c743c68d

 nimble/host/src/ble_l2cap.c      | 19 +++++++++++++------
 nimble/host/src/ble_l2cap_priv.h | 11 ++++++++---
 2 files changed, 21 insertions(+), 9 deletions(-)

commit e3cc7e5feb0c59e0ed09b10dc7652e002394b7fe
Author: William San Filippo <wills@runtime.io>
Date:   Sat Jun 4 20:29:54 2016 -0700

    Add privacy stubs for native ble
    
    X-Original-Commit: e128963daba172c2f221e94d940cefe07e82c0b2

 nimble/drivers/native/include/ble/xcvr.h |   6 ++
 nimble/drivers/native/src/ble_hw.c       | 124 +++++++++++++++++++++++--------
 nimble/drivers/native/src/ble_phy.c      |  15 ++++
 3 files changed, 113 insertions(+), 32 deletions(-)

commit e888321e2fab030f474a13834163ff8c0e2e85f8
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Fri Jun 3 14:49:54 2016 -0700

    we also need to keep the peers RPA in case we do a pairing with that address while
    using resolvable private addresses
    
    X-Original-Commit: b256be023b94dab2dfaee0ae3eeba674e6b24321

 nimble/host/src/ble_gap.c          |  1 +
 nimble/host/src/ble_hs_conn_priv.h |  1 +
 nimble/host/src/ble_l2cap_sm.c     | 25 +++++++++++++++++++++----
 3 files changed, 23 insertions(+), 4 deletions(-)

commit fdaf4f45e3341ad087a138f99853a6606ba701ce
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Fri Jun 3 14:09:27 2016 -0700

    ensure that we do security pairing with the correct address type
    and address for our device and theirs.
    
    The security legacy pairing algorithm uses 1-bit address type but
    the new enhanced connection command uses 2 bit address types.  This
    code serves to map between them for pairing.
    
    With this code I tested
    
    public addr adv and connect to iphone and then pair
    random addr adv and connect to iphone and then pair
    rpa adv and connect to iphone and then pair
    
    In all cases, I re-advertised and ensure that I coud reconnect (except random)
    
    X-Original-Commit: 8c891bed0850b84665722c58a0ced8da491ef6c7

 nimble/host/src/ble_gap.c          |  7 ++++++
 nimble/host/src/ble_hs_conn_priv.h |  2 ++
 nimble/host/src/ble_hs_priv.c      | 11 +++++++++-
 nimble/host/src/ble_hs_priv.h      |  1 +
 nimble/host/src/ble_l2cap_sm.c     | 44 ++++++++++++++++++++++++++++++++++----
 5 files changed, 60 insertions(+), 5 deletions(-)

commit 2572df31330f1c984dad2d5d5945502152da7758
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jun 3 08:40:09 2016 -0700

    Fix TXADD bit not being set correctly in advertisements for all cases
    
    X-Original-Commit: 8b9c0813940695f786e431f73a484b8b5feacfcf

 nimble/controller/src/ble_ll_adv.c | 23 ++++++++++++++++++-----
 1 file changed, 18 insertions(+), 5 deletions(-)

commit 446f959f9e9dafc6bc3f726ccc56a37c13e99162
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jun 3 08:39:30 2016 -0700

    Fix RPA usage for scanner when advertising not using RPA
    
    X-Original-Commit: c6725f9c64f76ac0a47ff6933c9cc1d5e25505cf

 nimble/controller/src/ble_ll_scan.c | 19 ++++++++++---------
 1 file changed, 10 insertions(+), 9 deletions(-)

commit 82caeea3686f01f61f24f4506e200980183b4b1f
Author: William San Filippo <wills@runtime.io>
Date:   Fri Jun 3 08:38:32 2016 -0700

    Fix error in RPA timeout value
    
    X-Original-Commit: 81fe1326ee478575b465ddef733b6c40fd54200a

 nimble/controller/src/ble_ll_resolv.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2bb7d528e1801b2668e497f53a9d968e141ded65
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Thu Jun 2 17:11:09 2016 -0700

    when we do a key exchange and get an identity address from the peer
    make sure we use that address and not the device address in the
    key store
    
    X-Original-Commit: 6a72c5452f0375d5ffcc2bee5ddf59a16a149512

 nimble/host/src/ble_l2cap_sm.c | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

commit be61b98d93aa0d54dc975d0d825d46dcb8c284a2
Author: William San Filippo <wills@runtime.io>
Date:   Wed May 18 15:59:54 2016 -0700

    first cut at LL privacy
    
    X-Original-Commit: d6bbacbd95693af7bfdefef6ccdc4863dd6c53c9

 nimble/controller/include/controller/ble_ll.h      |   2 +-
 nimble/controller/include/controller/ble_ll_adv.h  |   6 +
 nimble/controller/include/controller/ble_ll_conn.h |   3 +
 .../controller/include/controller/ble_ll_resolv.h  |  27 +-
 nimble/controller/include/controller/ble_ll_scan.h |  14 +-
 .../include/controller/ble_ll_whitelist.h          |   2 +-
 nimble/controller/src/ble_ll.c                     |  16 +-
 nimble/controller/src/ble_ll_adv.c                 | 227 +++++++++++-----
 nimble/controller/src/ble_ll_conn.c                | 247 ++++++++++++-----
 nimble/controller/src/ble_ll_conn_hci.c            | 100 ++++---
 nimble/controller/src/ble_ll_conn_priv.h           |   3 +-
 nimble/controller/src/ble_ll_hci.c                 |   2 +-
 nimble/controller/src/ble_ll_resolv.c              | 148 +++++++++--
 nimble/controller/src/ble_ll_scan.c                | 296 ++++++++++++++++-----
 nimble/controller/src/ble_ll_whitelist.c           | 105 ++++----
 nimble/drivers/nrf51/include/ble/xcvr.h            |   6 +
 nimble/drivers/nrf51/src/ble_hw.c                  |   9 +-
 nimble/drivers/nrf51/src/ble_phy.c                 |   3 +-
 nimble/drivers/nrf52/include/ble/xcvr.h            |   8 +-
 nimble/drivers/nrf52/src/ble_hw.c                  |   9 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |   2 +
 nimble/host/src/host_dbg.c                         |  23 +-
 nimble/include/nimble/ble.h                        |   2 +-
 nimble/include/nimble/hci_common.h                 |   4 +
 24 files changed, 915 insertions(+), 349 deletions(-)

commit 47fc72b9b60f19fc4607e86bd8ae630f3eaa1894
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Wed May 18 14:25:17 2016 -0700

    second cut at host privacy
    
    X-Original-Commit: 34e4509af1f497c6b85cf16f1f43755a998f8e4b

 nimble/controller/src/ble_ll_hci.c      |   4 +-
 nimble/controller/src/ble_ll_rand.c     |   2 +-
 nimble/host/include/host/ble_gap.h      |   7 ++
 nimble/host/include/host/ble_keycache.h |  75 ------------
 nimble/host/include/host/ble_store.h    |   7 ++
 nimble/host/src/ble_gap.c               |  61 +++++-----
 nimble/host/src/ble_hs_priv.c           | 161 +++++++++++++++++++------
 nimble/host/src/ble_hs_priv.h           |   5 +-
 nimble/host/src/ble_hs_startup.c        |   5 +-
 nimble/host/src/ble_keycache.c          | 205 --------------------------------
 nimble/host/src/ble_l2cap_sm.c          |  11 +-
 nimble/host/src/ble_store.c             |  72 +++++++++++
 nimble/host/src/host_hci.c              |  30 ++++-
 nimble/host/src/host_hci_cmd.c          |   4 +-
 nimble/host/src/test/ble_hs_test_util.c |  20 +++-
 nimble/include/nimble/hci_common.h      |   2 +
 16 files changed, 308 insertions(+), 363 deletions(-)

commit 1d77cbfa5c7a6b3425005ce8d6e304bb7a7e57ca
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 17 20:23:36 2016 -0700

    BLE Host - Separate secure-read from secure-write
    
    Prior to this change, attributes required encryption, authentication,
    and / or authorization; these were applied to both reads and writes.
    Now security requirements can be different for reads vs. writes.
    
    X-Original-Commit: a8c1718281f2cb925a215d508074aaa849443348

 nimble/host/src/ble_att_svr.c | 16 +++++++---------
 1 file changed, 7 insertions(+), 9 deletions(-)

commit 72cb7d07456b760bc4b32c6de38a5120d14edbd1
Author: William San Filippo <wills@runtime.io>
Date:   Wed May 18 14:06:01 2016 -0700

    Initial cut of LL privacy
    
    X-Original-Commit: 7327c542d000b1323c669bba791da45fd87139b3

 nimble/controller/include/controller/ble_hw.h      |  35 +-
 nimble/controller/include/controller/ble_ll.h      |   1 +
 .../controller/include/controller/ble_ll_resolv.h  |  79 +++++
 nimble/controller/include/controller/ble_phy.h     |   6 +
 nimble/controller/src/ble_ll.c                     |  29 +-
 nimble/controller/src/ble_ll_adv.c                 | 255 +++++++-------
 nimble/controller/src/ble_ll_conn.c                |  34 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   3 +-
 nimble/controller/src/ble_ll_ctrl.c                |   2 +-
 nimble/controller/src/ble_ll_hci.c                 |  27 ++
 nimble/controller/src/ble_ll_rand.c                |  26 ++
 nimble/controller/src/ble_ll_resolv.c              | 378 +++++++++++++++++++++
 nimble/controller/src/ble_ll_scan.c                |   2 +
 nimble/drivers/nrf51/src/ble_hw.c                  | 195 ++++++++---
 nimble/drivers/nrf51/src/ble_phy.c                 | 107 +++++-
 nimble/drivers/nrf52/src/ble_hw.c                  | 116 ++++++-
 nimble/drivers/nrf52/src/ble_phy.c                 |  85 ++++-
 nimble/host/src/host_hci_cmd.c                     |   4 +-
 nimble/include/nimble/ble.h                        |   6 +-
 nimble/include/nimble/hci_common.h                 |   2 +-
 nimble/include/nimble/nimble_opt.h                 |   7 +-
 21 files changed, 1189 insertions(+), 210 deletions(-)

commit 049cd394092498da6dbf4cfeb2169ddb300073cc
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Fri May 13 10:07:44 2016 -0700

    first cut at Host Privacy
    
    X-Original-Commit: 6e95f44444865cf1edf7c913ddacf26e5d4ab22d

 nimble/host/include/host/ble_gap.h      |  17 +-
 nimble/host/include/host/ble_hs.h       |   7 +-
 nimble/host/include/host/ble_keycache.h |  75 ++++++++
 nimble/host/include/host/host_hci.h     |  25 ++-
 nimble/host/src/ble_gap.c               | 144 ++++++++++------
 nimble/host/src/ble_hci_util.c          |  19 ++-
 nimble/host/src/ble_hci_util_priv.h     |   3 +-
 nimble/host/src/ble_hs.c                |   3 +-
 nimble/host/src/ble_hs_cfg.c            |   2 +
 nimble/host/src/ble_hs_priv.c           | 154 +++++++++++++++++
 nimble/host/src/ble_hs_priv.h           |  14 +-
 nimble/host/src/ble_hs_startup.c        |   4 +-
 nimble/host/src/ble_keycache.c          | 205 ++++++++++++++++++++++
 nimble/host/src/ble_l2cap_sm.c          |  77 +++------
 nimble/host/src/host_hci_cmd.c          | 293 ++++++++++++++++++++++++++++++--
 nimble/host/src/test/ble_gap_test.c     |   4 +-
 nimble/host/src/test/ble_hs_test_util.c |  12 +-
 nimble/host/src/test/ble_hs_test_util.h |   2 +-
 nimble/include/nimble/ble.h             |   6 +-
 nimble/include/nimble/hci_common.h      |  23 ++-
 nimble/src/hci_common.c                 |   3 +-
 21 files changed, 943 insertions(+), 149 deletions(-)

commit 78bb15f7551d96df9188ef8dc07f34f597cb8bf8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 11:18:56 2016 -0700

    BLE Host - Handle oddly sized read-group-type rsp.
    
    X-Original-Commit: 43143c9027aef473c22b2b6a6accaa4cfe1237c5

 nimble/host/src/ble_att_svr.c | 1 +
 1 file changed, 1 insertion(+)

commit 96a68957ed205a622731977da182bdc58469f430
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Jun 1 10:55:33 2016 -0700

    BLE Host - Add idx to store sec key.
    
    X-Original-Commit: f5a89066c158ec56d9c722b6892fc1b41bb14621

 nimble/host/include/host/ble_store.h | 3 +++
 nimble/host/src/ble_store.c          | 1 +
 2 files changed, 4 insertions(+)

commit 90c2fce5fe6376faad06780860bbf0774c8a06f2
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 19:11:35 2016 -0700

    BLE Host - Unit test for indicate without ack.
    
    X-Original-Commit: b1d01329e4e5c54cd21d21b67e5af15f1597c08d

 nimble/host/src/test/ble_gatts_notify_test.c | 254 ++++++++++++++++-----------
 1 file changed, 152 insertions(+), 102 deletions(-)

commit 9a17ce230ba9b9777e92682a8c7fa25360e8f4f1
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 15:37:51 2016 -0700

    BLE Host - rename store ltk to sec.
    
    X-Original-Commit: 4e16b9adef41636af13d409bf78d1a4aeda3ef32

 nimble/host/include/host/ble_gap.h            |  17 ----
 nimble/host/include/host/ble_store.h          |  47 +++++----
 nimble/host/src/ble_l2cap_sm.c                | 134 ++++++++++++++++----------
 nimble/host/src/ble_l2cap_sm_cmd.c            |   2 +-
 nimble/host/src/ble_store.c                   |  40 ++++----
 nimble/host/src/test/ble_hs_test_util_store.c | 108 +++++++++++----------
 nimble/host/src/test/ble_l2cap_sm_test.c      |  62 ++++++------
 7 files changed, 214 insertions(+), 196 deletions(-)

commit 133ed7c9cfddb661758784aa2f06747194355412
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 15:03:45 2016 -0700

    BLE Host - Fix some SM mst/slv mismatches.
    
    X-Original-Commit: cc094c5cd1c0b3ffc604853bdffab75db63f849b

 nimble/host/src/ble_l2cap_sm.c           | 41 +++++++++++++-------------------
 nimble/host/src/ble_store.c              |  8 +++----
 nimble/host/src/test/ble_l2cap_sm_test.c |  6 ++---
 3 files changed, 23 insertions(+), 32 deletions(-)

commit 5d2a9f61eedded59cb6d58c7a87c31ee6ed8cdde
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 11:59:48 2016 -0700

    fixup
    
    X-Original-Commit: 62db4fe210509b51b9e77825e69d29f98735c007

 nimble/host/src/test/ble_hs_test_util_store.c | 62 +++++++++++++--------------
 1 file changed, 31 insertions(+), 31 deletions(-)

commit 3dba79ca82eba6d3c24176e5dc1f440a8e928309
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 11:53:10 2016 -0700

    BLE Host - Clarify keys; our/peer -> mst/slv
    
    Prior to this change:
        * our key = key we generated while we are slave
        * peer key = key peer generated while we are master
    
    Now:
        * master key = key we should use when we are master (was: peer key).
        * slave key = key we should use when we are slave (was: our key).
    
    X-Original-Commit: ba96fba7e3d859f34b913c32a30aeabf9a84bbf9

 nimble/host/include/host/ble_store.h          | 22 ++++-----
 nimble/host/src/ble_l2cap_sm.c                | 71 +++++++++++++++++++--------
 nimble/host/src/ble_store.c                   | 24 ++++-----
 nimble/host/src/test/ble_hs_test_util_store.c | 15 +++---
 nimble/host/src/test/ble_l2cap_sm_test.c      | 18 +++----
 5 files changed, 90 insertions(+), 60 deletions(-)

commit b637ceb8710352e766248f933b115e67bf0149f1
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 11:22:56 2016 -0700

    BLE Host - Handle sec-req via db lookup.
    
    Prior to this change, the master would always react to a security
    request by initiating pairing.  Now, the master checks the key database
    for an appropriate LTK.  If a key is found, the master initiates the
    encryption procedure.  Else, the master initiates pairing.
    
    X-Original-Commit: c7d3c0c0f847a14fe01e63381bfc23c6869ed6e4

 nimble/host/include/host/ble_store.h          |  14 +-
 nimble/host/src/ble_gatts.c                   |   2 +-
 nimble/host/src/ble_l2cap_sm.c                |   4 +-
 nimble/host/src/ble_store.c                   |  36 +++++
 nimble/host/src/test/ble_hs_test_util.h       |   1 +
 nimble/host/src/test/ble_hs_test_util_store.c |   4 +-
 nimble/host/src/test/ble_l2cap_sm_test.c      | 222 ++++++++++++++++++--------
 7 files changed, 207 insertions(+), 76 deletions(-)

commit 4b032069f9a3d60c4a05fcb7ce5595486fede763
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 25 09:36:17 2016 -0700

    BLE Host - Add peer address to ltk store.
    
    X-Original-Commit: 7b6fcb93922587c40480eb492a15d9421d830958

 nimble/host/include/host/ble_store.h          | 20 ++++++
 nimble/host/src/ble_att_svr.c                 | 23 ++++---
 nimble/host/src/ble_l2cap_sm.c                | 90 +++++++++++++++++----------
 nimble/host/src/ble_store.c                   | 20 ++++++
 nimble/host/src/test/ble_hs_test_util_store.c | 37 ++++++++---
 nimble/host/src/test/ble_l2cap_sm_test.c      |  1 +
 6 files changed, 139 insertions(+), 52 deletions(-)

commit df56fa1fcc3c2d3bfd3689ceb6c56cd33aa76526
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 24 18:47:52 2016 -0700

    BLE Host - Much needed comment re: CCCD persist.
    
    X-Original-Commit: ce14aee034e46d88e2df9214c9a00c6d74406ab3

 nimble/host/src/ble_gatts.c | 27 ++++++++++++++++++++++++---
 1 file changed, 24 insertions(+), 3 deletions(-)

commit 38493df17d075a9ad8f8d82f065a6cfb36973418
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 24 17:43:30 2016 -0700

    bleprph - Use new BLE host persist store.
    
    X-Original-Commit: 5585ad20227c32a9c1049268b8b1b2877c7b372e

 nimble/host/include/host/ble_store.h | 2 ++
 nimble/host/src/ble_store.c          | 8 ++++++++
 2 files changed, 10 insertions(+)

commit fc0a86ad5ed54c4088705b3bbd275e2d9eb95265
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 24 14:24:18 2016 -0700

    BLE Host - unit tests for persisted CCCDs.
    
    X-Original-Commit: f98cc5679ce1b3ac803fdde36907b8cd9ee21f81

 nimble/host/src/test/ble_gatts_notify_test.c | 337 ++++++++++++++++++++++++---
 nimble/host/src/test/ble_hs_test_util.c      |   8 +-
 nimble/host/src/test/ble_l2cap_sm_test.c     |  18 ++
 3 files changed, 325 insertions(+), 38 deletions(-)

commit d0802e600fd4627eab1bd6f2df60b2cde9f85887
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 24 14:23:45 2016 -0700

    BLE Host - fix bug caused by outdated code.
    
    The ble store code used to expect a key and value as arguments to a
    write operation.  Now it just expects a value.
    
    X-Original-Commit: 54a4b7f17ae444fa67e6a5547642fd8b3b47b4a8

 nimble/host/include/host/ble_store.h |  3 +++
 nimble/host/src/ble_gatts.c          | 35 +++++++++++++++--------------------
 nimble/host/src/ble_store.c          | 12 ++++++++++++
 3 files changed, 30 insertions(+), 20 deletions(-)

commit 0cf5efec672e3d3be99220d015464b6fb441cc9a
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 24 14:22:39 2016 -0700

    BLE Host - Implement unittest persist store
    
    X-Original-Commit: 6866ef970d2f90133a22fa37fb370424802f6aa8

 nimble/host/src/test/ble_hs_test_util_store.c | 220 ++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test_util_store.h |  36 +++++
 2 files changed, 256 insertions(+)

commit 2a9f3098b0fe7fc64bda2ad65387d3f8c4881101
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 24 11:34:29 2016 -0700

    BLE Host tests - n/i disabled for unbonded reconn.
    
    X-Original-Commit: ec187b9130b49af894a7f69d262f43770f068b14

 nimble/host/src/test/ble_gatts_notify_test.c | 99 ++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c           |  4 +-
 nimble/host/src/test/ble_hs_test_util.c      | 16 +++++
 nimble/host/src/test/ble_hs_test_util.h      |  1 +
 4 files changed, 119 insertions(+), 1 deletion(-)

commit f5d6315bf7eac5cfd602f6ae95b738284f3c1b0c
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 21 15:25:17 2016 -0700

    BLE Host - Silence some warnings.
    
    Forgot to build with optimization!
    
    X-Original-Commit: 42b5203a942a67bedff9a8ad9f92fc32afca640b

 nimble/host/src/ble_gatts.c | 7 +++++++
 1 file changed, 7 insertions(+)

commit 7f3c1f25497aad7d974bd3c58e941d7ce80a616b
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 21 15:18:25 2016 -0700

    BLE Host - Tx updates upon rebonding.
    
    When bonding is restored:
        * Restores persisted CCCD entries for the connected peer.
        * Sends all pending notifications to the connected peer.
        * Sends up to one pending indication to the connected peer;
          schedules any remaining pending indications.
    
    X-Original-Commit: 486dd57057a20c6adc81e904e7baed2e9b9c9d94

 nimble/host/src/ble_gap.c       |   8 +-
 nimble/host/src/ble_gap_priv.h  |   2 +-
 nimble/host/src/ble_gatt_priv.h |   3 +-
 nimble/host/src/ble_gatts.c     | 215 +++++++++++++++++++++++++++++++---------
 nimble/host/src/ble_l2cap_sm.c  |   3 +-
 5 files changed, 179 insertions(+), 52 deletions(-)

commit ed8e7fbf22c134847bada6a26d4c22c332ac1823
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 21 13:48:04 2016 -0700

    BLE Host - Use chr val handle for stores.
    
    We used to use the definition handle.  This was clumsy and provided no
    benefit.
    
    X-Original-Commit: d98f4d1a3803c161e232619519dad357761f2132

 nimble/host/include/host/ble_store.h         |  7 ++--
 nimble/host/src/ble_gatts.c                  | 48 ++++++++++++----------------
 nimble/host/src/test/ble_gatts_notify_test.c |  8 ++---
 3 files changed, 29 insertions(+), 34 deletions(-)

commit a072c743e025322999b3726c5b94a7e886768607
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 21 13:38:13 2016 -0700

    BLE Host - Corner case: chr updated before ind ack
    
    X-Original-Commit: 58dde847493c483902626fcaea92c5e131a47291

 nimble/host/include/host/ble_store.h |  8 ++--
 nimble/host/src/ble_att_clt.c        | 19 +-------
 nimble/host/src/ble_gap.c            |  4 ++
 nimble/host/src/ble_gatt_priv.h      |  3 ++
 nimble/host/src/ble_gattc.c          | 27 ++++++-----
 nimble/host/src/ble_gatts.c          | 90 ++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs_conn_priv.h   |  1 -
 7 files changed, 116 insertions(+), 36 deletions(-)

commit 774a20a13092c15801dfe11f07c56ffa8789250e
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 21 12:27:43 2016 -0700

    BLE Host - Combine CCCD store into a single key.
    
    X-Original-Commit: 18a91e8152676d52f934fb47aa86b63bab90b97a

 nimble/host/include/host/ble_store.h | 19 ++++++++++++++-----
 nimble/host/src/ble_gatts.c          | 19 ++++++++++++++-----
 nimble/host/src/ble_store.c          |  6 +++---
 3 files changed, 31 insertions(+), 13 deletions(-)

commit fcb45d4cc6b2227469a290e63be6461f57c87cd0
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 20 19:29:45 2016 -0700

    BLE Host - Chr updates for unconnected bonded peer
    
    We need to persist the fact that the characteristic was updated while
    the peer was unconnected or unbonded.  When the peer restores bonding,
    we should send the notification or indication.
    
    X-Original-Commit: 825f488b4d57d30e530469f8705ae3f8da994fbf

 nimble/host/include/host/ble_store.h |   8 ++
 nimble/host/src/ble_gatt_priv.h      |   2 +-
 nimble/host/src/ble_gattc.c          |   2 +-
 nimble/host/src/ble_gatts.c          | 210 ++++++++++++++++-------------------
 nimble/host/src/ble_hs_conn.c        |  46 ++++++++
 nimble/host/src/ble_hs_conn_priv.h   |   3 +
 nimble/host/src/ble_store.c          |  14 +++
 7 files changed, 168 insertions(+), 117 deletions(-)

commit 214f2180230d772792ede28cfe55f518050b2b04
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 20 18:24:12 2016 -0700

    BLE Host - Don't require key in persist write.
    
    X-Original-Commit: ddd76b6b3953ba5eab18a39cdcc3d83bf2e3cc5c

 nimble/host/include/host/ble_store.h     | 55 +++++++++++++++++++-------------
 nimble/host/src/ble_gatts.c              | 34 ++++++++++++++++----
 nimble/host/src/ble_l2cap_sm.c           | 18 ++++-------
 nimble/host/src/ble_store.c              | 31 +++++++++++++++---
 nimble/host/src/test/ble_hs_test.c       |  1 -
 nimble/host/src/test/ble_l2cap_sm_test.c |  7 ++--
 6 files changed, 95 insertions(+), 51 deletions(-)

commit ff227f9122d41c00f603ea2b2df9da3f710ccedc
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 20 16:26:22 2016 -0700

    BLE Host - Persistence mechanism.
    
    The BLE host used to use the GAP callback to read and write LTKs.  Now,
    there is a separate set of persistence callbacks that get configured.
    
    X-Original-Commit: e62cabf5487409d33f11d48e4e2e39d06c5f03f7

 nimble/host/include/host/ble_gap.h       |  14 +----
 nimble/host/include/host/ble_hs.h        |   6 ++
 nimble/host/include/host/ble_store.h     |  67 ++++++++++++++++++++
 nimble/host/src/ble_gap.c                |  47 --------------
 nimble/host/src/ble_gap_priv.h           |   4 --
 nimble/host/src/ble_gatts.c              |  12 +++-
 nimble/host/src/ble_l2cap_sm.c           |  49 +++++++++++----
 nimble/host/src/ble_store.c              |  65 +++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c       |   1 +
 nimble/host/src/test/ble_l2cap_sm_test.c | 103 ++++++++++++++++++++++---------
 10 files changed, 261 insertions(+), 107 deletions(-)

commit 8a9d80b81ad81651f82eacdd89c7c1c9eafc94cf
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 20 10:42:42 2016 -0700

    BLE Host - comment indicating irk endianness.
    
    X-Original-Commit: b9b11219f0e5696e9f6d175ebef8853ac1b3f712

 nimble/host/src/ble_l2cap_sm_priv.h | 1 +
 1 file changed, 1 insertion(+)

commit 82ba87cd4f4eff32776f8df8fac9711333dead86
Author: William San Filippo <wills@runtime.io>
Date:   Fri May 20 11:02:01 2016 -0700

    Get native ble building.
    
    X-Original-Commit: 663d8e632781de9edc99535bcd727f0b82b1c49b

 nimble/controller/src/ble_ll_conn.c      |  1 +
 nimble/drivers/native/include/ble/xcvr.h | 32 +++++++++++++
 nimble/drivers/native/src/ble_phy.c      | 80 ++++++++++++++++++++++++++++++++
 3 files changed, 113 insertions(+)

commit ce8df1da0b9a0e0670a2a9b97d85104a09215546
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 19 20:29:33 2016 -0700

    BLE Host - Move status into GAP ctxt object.
    
    X-Original-Commit: 37d199cd9346b6f04cb966fa23bce9180ebe8c30

 nimble/host/include/host/ble_gap.h       |  75 ++++++++---
 nimble/host/src/ble_gap.c                | 220 ++++++++++++++++++++-----------
 nimble/host/src/ble_gap_priv.h           |   3 +-
 nimble/host/src/ble_hs_conn_priv.h       |   2 +-
 nimble/host/src/ble_l2cap_sm.c           |   4 +-
 nimble/host/src/test/ble_att_svr_test.c  |  12 +-
 nimble/host/src/test/ble_gap_test.c      |  69 ++++++----
 nimble/host/src/test/ble_hs_test_util.c  |   6 +-
 nimble/host/src/test/ble_hs_test_util.h  |   6 +-
 nimble/host/src/test/ble_l2cap_sm_test.c |  18 ++-
 nimble/host/src/test/ble_l2cap_test.c    |   6 +-
 nimble/host/src/test/ble_os_test.c       |  26 ++--
 12 files changed, 277 insertions(+), 170 deletions(-)

commit 2cb721df14db30461b5f83769c96a1c2ee0a9f70
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 19 17:09:14 2016 -0700

    BLE Host - Use GAP callback for notifications.
    
    X-Original-Commit: 3e86d591299a6896821f6dbe74d2798091e422fc

 nimble/host/include/host/ble_att.h      |  2 --
 nimble/host/include/host/ble_gap.h      | 10 +++++++
 nimble/host/src/ble_att.c               |  7 -----
 nimble/host/src/ble_att_priv.h          |  3 --
 nimble/host/src/ble_att_svr.c           | 23 ++-------------
 nimble/host/src/ble_gap.c               | 31 ++++++++++++++++++++
 nimble/host/src/ble_gap_priv.h          |  3 ++
 nimble/host/src/test/ble_att_svr_test.c | 52 +++++++++++++++------------------
 8 files changed, 69 insertions(+), 62 deletions(-)

commit f8250627ff5e65b105368f1772f528204755572f
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 19 16:26:07 2016 -0700

    BLE Host - (dbg) Assert proc entries not in list.
    
    When BLE_HS_DEBUG is defined, assert that an l2cap_sig proc entry is not
    in the list before freeing or inserting it.
    
    X-Original-Commit: 8a315f46393aa534d97f0b2595b7e85cc0227157

 nimble/host/src/ble_l2cap_sig.c | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

commit bb6ad7bf5add472357edc54aacb7eed85425b15e
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 19 12:55:40 2016 -0700

    BLE Host - dbg, ensure sm proc not in list on free
    
    This code only runs when BLE_HS_DEBUG is defined (generally just during
    unit tests).  This change would have caught a bug that got fixed a few
    days ago.
    
    X-Original-Commit: b1858ea16993e71e7c4fabfe48d0c6ddc554b1df

 nimble/host/src/ble_l2cap_sm.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit eafc238256e28b16e6ecc41050ad6b9651f16739
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 18 22:52:46 2016 -0700

    BLE Host - Fix misordered fields in unit test.
    
    Newer versions of gcc warn about the misordered fields.  This was
    causing a unit test to fail to compile under Linux.
    
    X-Original-Commit: 48df9b088c50cfc97d2518a823294ace761633d6

 nimble/host/src/test/ble_gatt_conn_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 11c1bdce11f326f77548acf63a2b68628179a437
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 18 16:10:18 2016 -0700

    BLE Host - Fix typo in log message.
    
    X-Original-Commit: 94ae8bd0de56525d9f2357de7a9b287de73edcc9

 nimble/host/src/ble_gap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit dc7861bd1cc3de37c0629fc3f1f6759aa52fa84c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 18 12:00:00 2016 -0700

    BLE Host - Use macro to check NIMBLE_OPT defines.
    
    define NIMBLE_OPT(x)                           NIMBLE_OPT_ ## x
    This macro exists to help catch bugs at compile time.  If code uses this
    macro to check an option value, the compiler will complain when this
    header is not included.  If the code checks the option symbol directly
    without including this header, it will appear as though the option is
    set to 0.
    
    X-Original-Commit: 47a1ead602b788af00dc6a54dae2ee69ece2b206

 nimble/host/src/ble_att_clt.c            | 48 ++++++++++++------------
 nimble/host/src/ble_att_svr.c            | 26 ++++++-------
 nimble/host/src/ble_eddystone.c          |  4 +-
 nimble/host/src/ble_gap.c                | 30 +++++++--------
 nimble/host/src/ble_gattc.c              | 64 ++++++++++++++++----------------
 nimble/host/src/ble_gatts.c              |  2 +-
 nimble/host/src/ble_hs_adv.c             |  4 +-
 nimble/host/src/ble_hs_cfg.c             |  4 +-
 nimble/host/src/ble_hs_conn.c            | 22 +++++------
 nimble/host/src/ble_l2cap_sm.c           |  2 +-
 nimble/host/src/ble_l2cap_sm_alg.c       |  2 +-
 nimble/host/src/ble_l2cap_sm_cmd.c       |  2 +-
 nimble/host/src/ble_l2cap_sm_priv.h      |  4 +-
 nimble/host/src/test/ble_l2cap_sm_test.c |  4 +-
 nimble/include/nimble/nimble_opt.h       |  9 ++++-
 15 files changed, 118 insertions(+), 109 deletions(-)

commit 5c723d0ef58aee6e1e53a988a65fd9d7c40ee13c
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 18 10:15:40 2016 -0700

    BLE Host - Enable security manager by default.
    
    X-Original-Commit: 04ace8e6c36bbc0863f785032e7abb65745becd6

 nimble/include/nimble/nimble_opt.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 9906b8a51db80cdbfb58b7477000c8ebf490862d
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 17 20:23:36 2016 -0700

    BLE Host - Separate secure-read from secure-write
    
    Prior to this change, attributes required encryption, authentication,
    and / or authorization; these were applied to both reads and writes.
    Now security requirements can be different for reads vs. writes.
    
    X-Original-Commit: c40856105ab97ea3fa976a270bf4df5ed20e1edf

 nimble/host/include/host/ble_att.h        | 17 ++++++++------
 nimble/host/include/host/ble_gatt.h       |  9 +++++---
 nimble/host/src/ble_att_svr.c             | 38 ++++++++++++++++++++-----------
 nimble/host/src/ble_gatts.c               | 33 +++++++++++++++++----------
 nimble/host/src/ble_hs_cfg.c              |  2 ++
 nimble/host/src/ble_l2cap_sm.c            | 11 +++------
 nimble/host/src/test/ble_gatt_conn_test.c |  2 +-
 7 files changed, 68 insertions(+), 44 deletions(-)

commit f2dd157e9622a3935bd6566ce6b9582ffa1eb820
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 17 13:41:14 2016 -0700

    BLE Host - On disconnect, call non-conn CBs first.
    
    The connection object should still be in existence when the GATT and SM
    callbacks get executed.  However, the connection object needs to be
    deleted prior to the GAP callback, in case the app wants to reestablish
    the connection.
    
    X-Original-Commit: 62f66192780d28b0b4b5ccc8bc7fbb98a670d63c

 nimble/host/src/ble_gap.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 554031715bcf9df5b9695acb02bd1c3fee4c4929
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 17 13:28:59 2016 -0700

    BLE Host - disconn: delete conn before app cb.
    
    If the app wants to create a new connection as a result of the existing
    connection being destroyed, we need to free the memory first.
    
    X-Original-Commit: 79f32b111901e9f83a0a6b6da05d1cff50deebbf

 nimble/host/src/ble_gap.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 5018b9b2dac1c4188021b0f4c7378623dc0d6929
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 16 20:43:45 2016 -0700

    BLE Host - Send irk and csrk during key dist.
    
    X-Original-Commit: 935806ba37a137af1ff87aee2241c1db02e30b89

 nimble/host/include/host/ble_gap.h  |   2 +-
 nimble/host/src/ble_l2cap_sm.c      | 126 ++++++++++++++++++++++++++++++++----
 nimble/host/src/ble_l2cap_sm_priv.h |   5 +-
 3 files changed, 118 insertions(+), 15 deletions(-)

commit 58023370a9f137a4d8cdc78fa32c8d64d81af5f3
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 16 19:46:49 2016 -0700

    BLE Host - tx slave security request.
    
    X-Original-Commit: 26eef9af3409225c2da26830cc9da2fd2375754c

 nimble/host/src/ble_gap.c                |  11 +-
 nimble/host/src/ble_l2cap_sm.c           | 177 +++++++++++++++++--------
 nimble/host/src/ble_l2cap_sm_priv.h      |   3 +
 nimble/host/src/test/ble_l2cap_sm_test.c | 218 ++++++++++++++++++++++++++++---
 4 files changed, 337 insertions(+), 72 deletions(-)

commit 1a3138d5ed8b0173764934d54668f872e93f523a
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 16 16:33:06 2016 -0700

    BLE Host - rx slave security request.
    
    X-Original-Commit: 91e810186b882750a0f3fc48be7ad6b659e934e4

 nimble/host/src/ble_l2cap_sm.c           | 56 ++++++++++++++++++++++-
 nimble/host/src/ble_l2cap_sm_cmd.c       | 46 +++++++++++++++++++
 nimble/host/src/ble_l2cap_sm_priv.h      | 17 +++++++
 nimble/host/src/test/ble_hs_test_util.c  |  8 ++++
 nimble/host/src/test/ble_hs_test_util.h  |  1 +
 nimble/host/src/test/ble_l2cap_sm_test.c | 76 ++++++++++++++++++++++++++++++++
 6 files changed, 203 insertions(+), 1 deletion(-)

commit 2cdec1e3790c8bf6d0237d612bffa5ef36aea9d8
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 16 13:06:04 2016 -0700

    BLE Host - Add bonded flag to SM proc.
    
    This is needed so that the host/app/someone can determine if the
    persisted client characteristic configuration should be restored upon
    receiving an encryption-change HCI event.
    
    X-Original-Commit: 28327e946faebd02fee3913e175c01df2cbd7bac

 nimble/host/include/host/ble_gap.h | 1 +
 nimble/host/src/ble_l2cap_sm.c     | 7 +++++++
 2 files changed, 8 insertions(+)

commit 3b5a05bbc81f5d9e188ae6892b775e5fcdedfaed
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 16 13:03:26 2016 -0700

    BLE Host - Rename sec procs to match spec language
    
    X-Original-Commit: aeb46abade038e6b62b0b7603455e8e8eda01bac

 nimble/host/src/ble_gap.c           |  5 ++---
 nimble/host/src/ble_l2cap_sm.c      | 19 ++++++++++---------
 nimble/host/src/ble_l2cap_sm_priv.h |  4 ++--
 3 files changed, 14 insertions(+), 14 deletions(-)

commit 5e40d93ffbbd933dc43d4ac458aa17cd91059b38
Author: William San Filippo <wills@runtime.io>
Date:   Mon May 16 13:07:12 2016 -0700

    Fix scheduling bugs
    
    There were two scheduling bugs that were uncovered during recent
    testing. The first was that we should have removed the schedule
    element prior to calling the connection start callback. The
    second is that a currently scheduled connection could get moved
    when a new connection is added. Both of these bugs could cause
    connections to become disconnected if more than one connection
    is ongoing.
    
    X-Original-Commit: 4d5aa14f6dcca4be04581367b786c3daa873ea05

 nimble/controller/src/ble_ll_sched.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 80870dd96039644e085b62e1dce46ff283c066d6
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 13 16:04:27 2016 -0700

    BLE Host - Enforce thread safety in unit tests.
    
    X-Original-Commit: 2dd32b7dfe83359d0f9c7975a9c0c17205687a98

 nimble/host/src/ble_att_clt.c                |  42 +-
 nimble/host/src/ble_att_cmd.c                |   2 +-
 nimble/host/src/ble_att_priv.h               |   6 +-
 nimble/host/src/ble_att_svr.c                |  41 +-
 nimble/host/src/ble_gap.c                    |  43 +-
 nimble/host/src/ble_gap_priv.h               |   1 -
 nimble/host/src/ble_gatt_priv.h              |   5 +-
 nimble/host/src/ble_gattc.c                  |  11 +-
 nimble/host/src/ble_gatts.c                  | 143 +++++--
 nimble/host/src/ble_hs.c                     |  36 +-
 nimble/host/src/ble_hs_atomic.c              |  31 +-
 nimble/host/src/ble_hs_atomic_priv.h         |   2 +
 nimble/host/src/ble_hs_conn.c                |   2 +-
 nimble/host/src/ble_hs_conn_priv.h           |   1 +
 nimble/host/src/ble_hs_priv.h                |   1 -
 nimble/host/src/ble_l2cap_sig.c              |   3 +-
 nimble/host/src/test/ble_att_clt_test.c      | 157 ++++----
 nimble/host/src/test/ble_att_svr_test.c      | 565 +++++++++++++++------------
 nimble/host/src/test/ble_gap_test.c          |  60 +--
 nimble/host/src/test/ble_gatt_disc_c_test.c  |  34 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c  |  22 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c  |  46 +--
 nimble/host/src/test/ble_gatt_find_s_test.c  |  55 ++-
 nimble/host/src/test/ble_gatt_read_test.c    | 115 +++---
 nimble/host/src/test/ble_gatt_write_test.c   |  90 ++---
 nimble/host/src/test/ble_gatts_notify_test.c |  67 ++--
 nimble/host/src/test/ble_hs_conn_test.c      |  40 +-
 nimble/host/src/test/ble_hs_test_util.c      |  48 +--
 nimble/host/src/test/ble_hs_test_util.h      |  16 +-
 nimble/host/src/test/ble_l2cap_sm_test.c     | 155 +++++---
 nimble/host/src/test/ble_l2cap_test.c        | 206 +++++-----
 31 files changed, 1148 insertions(+), 898 deletions(-)

commit 44b4baf3f527261b324e87418e522d60bfd1d332
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu May 12 17:15:06 2016 -0700

    BLE Host - Formalize some GATT thread safety reqs.
    
    X-Original-Commit: ee4fbed39aa002bd862ec0ae45b28ef61d0ef86b

 nimble/host/src/ble_gattc.c             | 152 ++++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs.c                |   2 +-
 nimble/host/src/test/ble_hs_test_util.c |  42 ++++++++-
 nimble/host/src/test/ble_hs_test_util.h |   3 +
 nimble/host/src/test/ble_os_test.c      |   8 +-
 5 files changed, 193 insertions(+), 14 deletions(-)

commit f3290204f651a8fdd03d09ce2bcc95b9833d7e44
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 11 20:39:07 2016 -0700

    BLE host - rename struct with appropriate prefix.
    
    X-Original-Commit: 9eeec05f0dd52219bf46a2a031d1e5d1fae1da0f

 nimble/host/include/host/ble_l2cap.h     | 5 +++--
 nimble/host/src/ble_l2cap_sm.c           | 2 +-
 nimble/host/src/test/ble_l2cap_sm_test.c | 4 ++--
 3 files changed, 6 insertions(+), 5 deletions(-)

commit 59dd52e889b7a9bab93fc8d377588b0b9e928461
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 11 20:36:01 2016 -0700

    BLE Host - SM passkey unit tests.
    
    X-Original-Commit: ffd58caf2f6c61ff7ed6b3146ff8902261fc9237

 nimble/host/include/host/ble_gap.h       |   2 +-
 nimble/host/src/ble_hci_cmd.c            |   2 +
 nimble/host/src/ble_l2cap_sm.c           |  60 +++-
 nimble/host/src/ble_l2cap_sm_priv.h      |   1 +
 nimble/host/src/test/ble_l2cap_sm_test.c | 522 +++++++++++++++++++------------
 5 files changed, 376 insertions(+), 211 deletions(-)

commit 8f051555d4195fa19abfc2815b1e761367b556c8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 11 18:46:33 2016 -0700

    BLE Host unit tests - queue of previous data txes.
    
    X-Original-Commit: 65d9dc4689fd6ab5a709ffc26016462b3e5ddf99

 nimble/host/src/test/ble_att_clt_test.c      |  20 +----
 nimble/host/src/test/ble_att_svr_test.c      | 117 +++++++++++++--------------
 nimble/host/src/test/ble_gatt_find_s_test.c  |  10 +--
 nimble/host/src/test/ble_gatts_notify_test.c |  40 ++++-----
 nimble/host/src/test/ble_hs_test.c           |   4 +-
 nimble/host/src/test/ble_hs_test_util.c      |  75 +++++++++++++++--
 nimble/host/src/test/ble_hs_test_util.h      |   6 +-
 nimble/host/src/test/ble_l2cap_sm_test.c     |  58 +++++++------
 nimble/host/src/test/ble_l2cap_test.c        |  74 ++++++++++-------
 9 files changed, 231 insertions(+), 173 deletions(-)

commit 43b61909d43baba487909d3dbea6e1709ef5a8e7
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 11 15:06:51 2016 -0700

    BLE Host - callback when SM proc ends due to term.
    
    Unabbreviated: Execute application callback when a security manager
    procedure ends due to the connection being terminated.
    
    X-Original-Commit: 5cfe29f8590366c6b721ca27dac4d3343f09ba7a

 nimble/host/src/ble_l2cap_sm.c           |  9 ++++++---
 nimble/host/src/test/ble_l2cap_sm_test.c | 28 ++++++++++++++++++++++++++++
 2 files changed, 34 insertions(+), 3 deletions(-)

commit 4da08d13edcfe01c7dacf706479dc6e589a25889
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 11 12:36:42 2016 -0700

    BLE Host - Always set timer for GATT client procs.
    
    X-Original-Commit: 7eb9d5ca2ecdb348f355628e09847e6997d7f0f3

 nimble/host/src/ble_att_svr.c             |   4 +-
 nimble/host/src/ble_gattc.c               | 257 +++++++++------
 nimble/host/src/test/ble_gatt_conn_test.c | 508 ++++++++++++++++++++++++++----
 3 files changed, 610 insertions(+), 159 deletions(-)

commit b8afcd704909747a6d42bbfef36d0811dad253d6
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue May 10 13:25:18 2016 -0700

    BLE host - More specific reasons for disconnect.
    
    X-Original-Commit: c7755e0a62c9b2d09a62cc4332119c8a47aacf8f

 nimble/host/src/ble_gap.c | 17 +++++++++++++----
 1 file changed, 13 insertions(+), 4 deletions(-)

commit 74894bae30aca3b51bdca0ef0555c3e7750e993e
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 9 21:00:56 2016 -0700

    BLE host - fix check for sufficient conn resources
    
    X-Original-Commit: fc5d42d50c883d338a89e9982a11fb9fc0ab1c9a

 nimble/host/src/ble_gatt_priv.h              |  2 ++
 nimble/host/src/ble_gatts.c                  | 24 +++++++++---------------
 nimble/host/src/ble_hs.c                     |  2 ++
 nimble/host/src/ble_hs_conn.c                | 10 +++++++++-
 nimble/host/src/ble_l2cap.c                  |  2 +-
 nimble/host/src/ble_l2cap_priv.h             |  2 ++
 nimble/host/src/test/ble_gatts_notify_test.c |  2 ++
 7 files changed, 27 insertions(+), 17 deletions(-)

commit f088464ddcb52d71cc5831fb7ef1ba81b776f638
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 9 18:46:51 2016 -0700

    BLE host - Set random address HCI command.
    
    X-Original-Commit: f4c734e3924ef439a8554ff8d6f2bc0d5f10a2e3

 nimble/host/include/host/host_hci.h |  2 ++
 nimble/host/src/host_hci_cmd.c      | 16 ++++++++++++++++
 nimble/include/nimble/hci_common.h  |  3 +++
 3 files changed, 21 insertions(+)

commit 30e1f126b82c847ae5eab3e8b0af17076709d46c
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 9 17:40:29 2016 -0700

    BLE host - only include eddystone if specified.
    
    X-Original-Commit: 7ce7eb1438c7a448da4ab799e5f36e65166748fb

 nimble/host/include/host/ble_eddystone.h |  2 +-
 nimble/host/src/ble_eddystone.c          | 12 +++++++++++-
 nimble/include/nimble/nimble_opt.h       |  8 ++++++++
 3 files changed, 20 insertions(+), 2 deletions(-)

commit ba457bfd29e189f19bdfd35089e4761dca9ee0a9
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 9 11:59:37 2016 -0700

    BLE Host: Send invalid CID l2cap sig err.
    
    X-Original-Commit: 5516847d9eec7c2723c1e816c79082775c4b3913

 nimble/host/src/ble_l2cap.c          |   6 ++
 nimble/host/src/ble_l2cap_sig.c      | 140 ++++++++++++++++++-----------------
 nimble/host/src/ble_l2cap_sig_cmd.c  |  80 +++++++++++---------
 nimble/host/src/ble_l2cap_sig_priv.h |  16 +++-
 4 files changed, 139 insertions(+), 103 deletions(-)

commit 9d64d951bdd627a176efbd50ee53b3ef7543a75b
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 9 16:36:33 2016 -0700

    BLE host - eddystone advertisements.
    
    X-Original-Commit: 2fa4773eed19764a7d6ec19e053ca37d2d947dea

 nimble/host/include/host/ble_eddystone.h |  56 +++++++++
 nimble/host/src/ble_eddystone.c          | 187 +++++++++++++++++++++++++++++++
 2 files changed, 243 insertions(+)

commit 0b8b52c549e4424c30dc19ac69c76372f84206e2
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 9 08:35:33 2016 -0700

    BLE host - unit test for invalid pair-rsp.
    
    X-Original-Commit: e1cf9e648403ac9ee2b21a1efd1c695cfe53b06d

 nimble/host/src/ble_l2cap_sm.c           |  12 +-
 nimble/host/src/test/ble_l2cap_sm_test.c | 257 ++++++++++++++++++++++++++++++-
 2 files changed, 262 insertions(+), 7 deletions(-)

commit 188a246ea76e8cebda63e1599d3d04c1cf7e1c87
Author: Christopher Collins <ccollins@apache.org>
Date:   Sun May 8 21:33:32 2016 -0700

    BLE host - remove ble_l2cap_sm_process_status().
    
    This function was ill-conceived.
    
    X-Original-Commit: e76defb0437e1811dffe3f630405627eb6b3bf2a

 nimble/host/src/ble_l2cap_sm.c           | 120 ++++---
 nimble/host/src/test/ble_l2cap_sm_test.c | 578 +++++++++++++++++++++----------
 2 files changed, 463 insertions(+), 235 deletions(-)

commit b9098e2fa351dafba413b45bf62cb1a3042a03b9
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 7 13:12:58 2016 -0700

    BLE host - Ensure pair-req sender is master.
    
    X-Original-Commit: 2a6cf9936308255fa76bcba744cd461781628fda

 nimble/host/src/ble_l2cap_sm.c           | 14 ++++++++++++--
 nimble/host/src/test/ble_l2cap_sm_test.c |  6 ++++++
 2 files changed, 18 insertions(+), 2 deletions(-)

commit b6b86471e7b0b6fb889a3f7f04f7d0e76d318e49
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 7 12:58:55 2016 -0700

    BLE host - Validate pair req/rsp at rx time.
    
    X-Original-Commit: 7a3a9464052c59ddbc4919a881961613564c617c

 nimble/host/include/host/ble_l2cap.h |  29 +++++++--
 nimble/host/src/ble_l2cap_sm.c       | 119 +++++++++++++++++------------------
 nimble/host/src/ble_l2cap_sm_cmd.c   |  33 ++++++++++
 nimble/host/src/ble_l2cap_sm_priv.h  |   8 +--
 nimble/include/nimble/ble.h          |   3 +
 5 files changed, 120 insertions(+), 72 deletions(-)

commit a31fcf62cd88edb6c37718d1c8a2a611a8c2b4b6
Author: Christopher Collins <ccollins@apache.org>
Date:   Sat May 7 12:07:33 2016 -0700

    BLE host - whitespace fix.
    
    X-Original-Commit: ee13afed061a8b06fe9b6adbb5207cbe6045128f

 nimble/host/src/ble_l2cap_sm.c | 50 +++++++++++++++++++++---------------------
 1 file changed, 25 insertions(+), 25 deletions(-)

commit 189abca11795424fcfb6a855984bc9c513029fe6
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri May 6 19:03:52 2016 -0700

    BLE host - bonding.
    
    This is a collection of many commits from Paul and me.  Unfortunately,
    merging properly proved to be too difficult for my feeble git skills due
    to the original branch coming from master rather than develop.
    
    X-Original-Commit: 264a67b95ef65e7a60117a22f40989ccd54ffeca

 nimble/host/include/host/ble_gap.h       |  42 +-
 nimble/host/include/host/ble_l2cap.h     |   5 +
 nimble/host/include/host/host_hci.h      |   3 +-
 nimble/host/src/ble_att_svr.c            |  14 +-
 nimble/host/src/ble_gap.c                |  76 ++-
 nimble/host/src/ble_gap_priv.h           |   6 +-
 nimble/host/src/ble_hs_conn_priv.h       |   2 +-
 nimble/host/src/ble_l2cap_sm.c           | 824 +++++++++++++++++++++++++------
 nimble/host/src/ble_l2cap_sm_cmd.c       | 160 +++++-
 nimble/host/src/ble_l2cap_sm_priv.h      |  95 +++-
 nimble/host/src/host_hci_cmd.c           |  14 +
 nimble/host/src/test/ble_l2cap_sm_test.c | 263 ++++++++--
 nimble/include/nimble/hci_common.h       |   6 +-
 13 files changed, 1296 insertions(+), 214 deletions(-)

commit b44c42509fa847e16b6a6166b9f06f2252cf4603
Merge: 6fc6d14f fbb520c7
Author: Sterling Hughes <sterling@apache.org>
Date:   Fri May 6 13:15:05 2016 -0700

    fix merge conflict
    
    X-Original-Commit: 78ebe68aa17a6d4abb45707d4268da12554a67b0

commit 6fc6d14fe2eb47e7b0a31abfa7f181b5eeb5772e
Author: Sterling Hughes <sterling@apache.org>
Date:   Fri May 6 13:14:22 2016 -0700

    add more documentation of callouts.  remove os_callout_init() which was unused, have everything be a callout_func.  include os/time.h for eventq_poll()
    
    X-Original-Commit: 9ea6176f16a32f4df2b4f1bc6f76868e2560038d

 nimble/host/src/test/ble_os_test.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit fbb520c793579b6e3ad9ebc8d45832fd91b55b72
Author: William San Filippo <wills@runtime.io>
Date:   Fri May 6 11:05:34 2016 -0700

    Code now asks PHY maximum data pdu payload size
    
    The connection initialization code now asks the PHY for its
    maximum supported PDU. If this size is smaller than the
    configured size, the PHY maximum supported size is used.
    
    X-Original-Commit: 4d2b24c5ed6a14ba9fae61c10aa89dfd8c7d9293

 nimble/controller/include/controller/ble_ll.h  |  1 +
 nimble/controller/include/controller/ble_phy.h | 13 +++++++++
 nimble/controller/src/ble_ll_conn.c            | 28 ++++++++++--------
 nimble/drivers/nrf51/src/ble_phy.c             | 39 ++++++++++++++++++++------
 nimble/drivers/nrf52/src/ble_phy.c             | 13 +++++++++
 nimble/include/nimble/nimble_opt.h             |  2 +-
 6 files changed, 76 insertions(+), 20 deletions(-)

commit 8b0c11c0bfd9ca6218239e2c130a133a49ed0bea
Author: William San Filippo <wills@runtime.io>
Date:   Thu May 5 21:47:04 2016 -0700

    LL feature configuration for controller moved to nimble_opt.h
    
    The features supported by the controller which were previously
    configured in the controller (ble_ll.h) have been moved into
    nimble_opt.h to allow for targets to configure whether or not
    the controller supports the feature.
    
    X-Original-Commit: f5ee7ec08b044b0213eacf9f7f7f2b2a95522592

 nimble/controller/include/controller/ble_ll.h      | 13 +---
 nimble/controller/include/controller/ble_ll_conn.h |  4 +-
 nimble/controller/src/ble_ll.c                     | 18 +++---
 nimble/controller/src/ble_ll_adv.c                 |  2 +-
 nimble/controller/src/ble_ll_conn.c                | 34 +++++-----
 nimble/controller/src/ble_ll_conn_hci.c            |  4 +-
 nimble/controller/src/ble_ll_ctrl.c                | 20 +++---
 nimble/controller/src/ble_ll_hci.c                 | 14 ++---
 nimble/controller/src/ble_ll_hci_ev.c              |  2 +-
 nimble/controller/src/ble_ll_rng.c                 |  2 +-
 nimble/controller/src/ble_ll_scan.c                |  2 +-
 nimble/controller/src/ble_ll_supp_cmd.c            |  4 +-
 nimble/drivers/nrf51/src/ble_phy.c                 | 24 ++++----
 nimble/drivers/nrf52/src/ble_phy.c                 | 16 ++---
 nimble/include/nimble/nimble_opt.h                 | 72 ++++++++++++++++++++++
 15 files changed, 148 insertions(+), 83 deletions(-)

commit cba11b0b1965e5aaac1ffde11f5afe61b965bacc
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 4 19:46:09 2016 -0700

    BLE host - Add BLE_GAP_ prefix to passkey actions.
    
    X-Original-Commit: 8051041b8412d28cd13a6f44c2c96fb523dbafb8

 nimble/host/include/host/ble_gap.h |  8 +++---
 nimble/host/src/ble_l2cap_sm.c     | 59 ++++++++++++++++++++++----------------
 2 files changed, 38 insertions(+), 29 deletions(-)

commit 9a042d866739918311090c7ef93139d24ad10f97
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 4 19:36:41 2016 -0700

    BLE host - fix typo in iocap-pairing tables.
    
    X-Original-Commit: 0b42e392b23bc5d2abedd4558aa0c62d20007078

 nimble/host/src/ble_l2cap_sm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit cb5567f248b51ea8c222d8814a0951a223b751c8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 4 19:08:48 2016 -0700

    BLE host: Return correct att err for sec issues.
    
    X-Original-Commit: fbe90aec020647f3e6d8f361dd20425e2409c149

 nimble/host/include/host/ble_att.h  |  1 +
 nimble/host/include/host/ble_gatt.h |  3 ++
 nimble/host/src/ble_att_svr.c       | 89 +++++++++++++++++++++++++++++++------
 nimble/host/src/ble_gatts.c         | 11 ++++-
 4 files changed, 90 insertions(+), 14 deletions(-)

commit 22da971e7373ad3eba326f50dda4a3e4a3aae3dd
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 4 19:05:41 2016 -0700

    BLE host - indicate correct peer addr type in pair
    
    X-Original-Commit: 4fa4d63402e0cf4c7ac88e38bce51ee442b5e217

 nimble/host/src/ble_gap.c | 1 +
 1 file changed, 1 insertion(+)

commit 7da681b027497c0a16077e21d0aaca1ab399d4d2
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed May 4 15:24:04 2016 -0700

    BLE host - swap PIN endianness in TK.
    
    X-Original-Commit: a4ee384182535a5894d28cc228688022b0d5f86d

 nimble/host/src/ble_l2cap_sm.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit c49146dda6832bb4d0fe250c6617c54824b20a14
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon May 2 15:43:00 2016 -0700

    BLE Host - use big endian for iBeacon ver fields.
    
    X-Original-Commit: 478eaad89cf2efb71e9c0dc7bc430f49ba199dca

 nimble/host/src/ble_ibeacon.c |  4 +--
 nimble/include/nimble/ble.h   |  6 ++++
 nimble/src/util.c             | 84 +++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 92 insertions(+), 2 deletions(-)

commit b4af9863a1ec0790ea629e08e7c2184ac48f8651
Author: Paul Dietrich <paulfdietrich@yahoo.com>
Date:   Fri Apr 29 11:49:38 2016 -0700

    changes to support passkey requests and MITM
    
    This adds the legacy pairing modes between devices.
    
    In BLETiny, several commands were added
    
    b set sm_data oob_flag := set the devices OOB flag
    b set sm_data mitm_flag := set the devices mitm flag
    b set sm_data io_capabilities := set the devices io capbilities
    
    The devices IO capabilities can be one of
      0 - display only
      1 = display yes/no
      2 = keyboard only
      3 = no io
      4 = keyboard and display
    
    When pairing in bletiny if you set these options and the peer
    is also doing OOB or MITM, the log messages will show
    a request for passkey action
    
    104424:[ts=104424000ssb, mod=4 level=1] send passkey action request 2
    
    The possible passkey action requests are:
    
     #define PKACT_OOB          1
     #define PKACT_INPUT        2
     #define PKACK_GEN_DISP     3
    
    For OOB the application needs to pass back a 128-bit key
    For INPUT the application needs to accept and passback a integer key 0-999999
    for GEN_DISPLAY, the application needs to generate and display an integer
        key (0-999999) and then pass the key back
    
    The passkeys are passed back to the stack through an API
    
    int
    ble_l2cap_sm_set_tk(uint16_t conn_handle, struct passkey_action *pkey)
    
    The action must match the action requested.
    
    There is a bletiny command "passkey" that allows test programs to pass back these keys
    
    b passkey conn=1 action=1 oob=00-11-22-33-44-55-66-77-88-99-aa-bb-cc-dd-ee-fe
    b passkey conn=1 action=2 key=34567
    b passkey conn=1 action=3 key=34567
    
    To perform a pairing with LE pairing do the following.
    
    1) assign addresses (and names) to your devices
    2) connect the two devices with b adv conn=und disc=gen and b conn addr_type=public addr=00:01:02:00:01:02
    3) set the oob and mitm and io_capabilities dpeending on your needs
    b set sm_data oob_flag=1
    b set sm_data mitm_flag=1
    b set sm_data io_capabilities=3
    
    4) start pairing b sec start conn=1
    
    5) look for the send passkey event in the log
    
    6) call b passkey for each device with the right key and action
    
    X-Original-Commit: c3c1c246246af973e0d3028656566a98b2b269e8

 nimble/host/include/host/ble_gap.h       |  21 ++-
 nimble/host/include/host/ble_hs.h        |   9 +-
 nimble/host/include/host/ble_hs_adv.h    |   2 +-
 nimble/host/include/host/ble_l2cap.h     |  19 ++-
 nimble/host/src/ble_gap.c                |  33 +++++
 nimble/host/src/ble_gap_priv.h           |   6 +-
 nimble/host/src/ble_hs_cfg.c             |   4 +-
 nimble/host/src/ble_l2cap_sm.c           | 242 ++++++++++++++++++++++++++-----
 nimble/host/src/test/ble_l2cap_sm_test.c |  18 +--
 9 files changed, 299 insertions(+), 55 deletions(-)

commit 1c272a748713e51833dca8954edfc1b07753badb
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 27 17:10:21 2016 -0700

    Fix l2cap-sm thread-safety.
    
    Prior to this change, thread-saftey was achieved as follows:
    
    The only resource protected by the mutex is the list of active
    procedures (ble_l2cap_sm_procs).  Thread-safety is achieved by locking
    the mutex during removal and insertion operations.  Procedure objects
    are only modified while they are not in the list.
    
    The problem with this approach is that it is not always possible to
    determine if an SM operation is currently in progress for a particular
    connection.  If the relevant proc entry is is currently in use (and
    therefore not in the list), a conflicting entry could be inserted into
    the list.
    
    The new behavior is:
        * Don't remove proc entries from the list until they are no longer
          needed.
        * Keep the host mutex locked whenever:
            o An entry is read from or written to.
            o The list is read or modified.
    
    X-Original-Commit: 7bd699bd1109e6204fecd63147bb3e8f22a0ecec

 nimble/host/include/host/ble_hs.h        |   2 +-
 nimble/host/src/ble_l2cap_sm.c           | 257 +++++++++++++++++++------------
 nimble/host/src/ble_l2cap_sm_cmd.c       |   6 +-
 nimble/host/src/test/ble_l2cap_sm_test.c |  12 +-
 4 files changed, 167 insertions(+), 110 deletions(-)

commit bc52e3dd4e62a4b6ac1822a2faab474c629153ba
Author: William San Filippo <wills@runtime.io>
Date:   Tue May 3 14:20:50 2016 -0700

    Do not obtain and hold a mbuf just to transmit advertisements.
    
    The code prior to this change would grab a mbuf and hold it
    forever (in the state machine) so that it could transmit
    advertisements. The new code just attempts to allocate a mbuf
    to transmit. If it cannot, that advertisement just doesnt
    get sent.
    
    X-Original-Commit: bfb7f447ed62756219598e00cb278d1e883e1163

 nimble/controller/src/ble_ll_adv.c | 81 ++++++++++++++++----------------------
 1 file changed, 33 insertions(+), 48 deletions(-)

commit 2470c88e7ebd4ed5c7420860ad4275aee0f60649
Author: William San Filippo <wills@runtime.io>
Date:   Tue May 3 14:15:39 2016 -0700

    Fix encryption event error
    
    The code could erroneously send an encryption key refresh event
    instead of an encryption change event when a connection was
    terminated and then restarted. The encryption key refresh event
    should only be emitted when an already encrypted connection is
    asked to start encryption.
    
    X-Original-Commit: 8c412beebdbea1ebd165ac545ae2e4345101e19e

 nimble/controller/include/controller/ble_ll_conn.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c8af19bf074cf7edc1eeff3c5369f43fad088ebf
Author: William San Filippo <wills@runtime.io>
Date:   Mon May 2 13:25:51 2016 -0700

    MYNEWT-85: Transmit timing fixes
    MYNEWT-99: Encryption.
    
    This is a fix related to the above commits. The code was not
    properly calculating the receive end time of the frame if
    the frame was encrypted.
    
    X-Original-Commit: 7a11762e2267a3304bfbfdd611cc463f956fe47c

 nimble/controller/include/controller/ble_phy.h |  3 +++
 nimble/controller/src/ble_ll.c                 |  5 ++--
 nimble/controller/src/ble_ll_conn.c            | 33 ++++++++------------------
 nimble/drivers/nrf51/src/ble_phy.c             | 21 +++++++++++++++-
 nimble/drivers/nrf52/src/ble_phy.c             | 20 +++++++++++++++-
 5 files changed, 55 insertions(+), 27 deletions(-)

commit 99928cec4603eff64b09282ec95d5887fe23f479
Author: William San Filippo <wills@runtime.io>
Date:   Wed Apr 27 16:45:17 2016 -0700

    MYNEWT-85: Fix BLE timing for start of connection events.
    MYNEWT-283: Slave anchor point now set correctly on CRC error.
    
    Please read the respective tickets for a discussion of
    the changes.
    
    X-Original-Commit: 8ddc20eed045e5d9d0abe6b0bd5d6af83f872dcf

 nimble/controller/include/controller/ble_ll.h  |   5 +
 nimble/controller/include/controller/ble_phy.h |  21 +-
 nimble/controller/pkg.yml                      |   1 +
 nimble/controller/src/ble_ll.c                 |   2 +-
 nimble/controller/src/ble_ll_adv.c             |  34 +-
 nimble/controller/src/ble_ll_conn.c            |  86 ++---
 nimble/controller/src/ble_ll_scan.c            |   3 +-
 nimble/controller/src/ble_ll_sched.c           |   1 +
 nimble/drivers/native/src/ble_phy.c            |   2 +-
 nimble/drivers/nrf51/include/ble/xcvr.h        |  32 ++
 nimble/drivers/nrf51/src/ble_phy.c             | 419 ++++++++++++++----------
 nimble/drivers/nrf52/include/ble/xcvr.h        |  32 ++
 nimble/drivers/nrf52/src/ble_phy.c             | 423 ++++++++++++++-----------
 nimble/include/nimble/ble.h                    |   2 +-
 14 files changed, 634 insertions(+), 429 deletions(-)

commit 021b4705d15142371773126152e93c485e2c3cae
Merge: cc409d98 40361f72
Author: Marko Kiiskila <marko@runtime.io>
Date:   Tue Apr 26 12:54:00 2016 -0700

    Merge branch 'master' of https://git-wip-us.apache.org/repos/asf/incubator-mynewt-core into develop
    
    X-Original-Commit: c12dbb96baa8026cd43082ac6c4f3dfa8a9f9e17

commit cc409d9888275711b251cc5c23c5e0ff24b83d29
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 25 20:06:00 2016 -0700

    MYNEWT-99: implement encryption pause procedure
    
    This allows keys to be changed on an already encrypted connection.
    The code was tested on a bmd300, nrf52dk and also a nrf51. The
    nrf51 with encryption enabled was disconnecting and/or getting
    MIC failures with large frames; was working fine for small
    frames. We are investigating similar issues on the nrf51 so I
    do not necessarily believe these to be encryption related which
    is why I am committing the changes.
    
    X-Original-Commit: 470262a29a9bccfbffbd27b83c139cc109e5c2af

 nimble/controller/include/controller/ble_ll_conn.h |   3 +
 nimble/controller/include/controller/ble_ll_ctrl.h |   4 -
 nimble/controller/src/ble_ll_conn.c                | 101 +++++++++++++--
 nimble/controller/src/ble_ll_conn_hci.c            |   8 +-
 nimble/controller/src/ble_ll_ctrl.c                | 138 ++++++++++++++++-----
 nimble/controller/src/ble_ll_hci_ev.c              |  27 ++--
 nimble/host/include/host/host_hci.h                |   1 -
 nimble/host/src/host_dbg.c                         |  25 +++-
 nimble/host/src/host_hci_cmd.c                     |  38 ------
 nimble/include/nimble/hci_common.h                 |   1 +
 10 files changed, 255 insertions(+), 91 deletions(-)

commit ebda3af91fadd10aca5b37eb2e74278d0a724139
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 25 19:24:52 2016 -0700

    Fix bug in data length extension procedure
    
    Changes were made to make sure that the hosts suggested data
    sizes were never greater than the supported controller size.
    That check was wrong (should have been less than or equal to) so
    the controller would not perform the data length extension
    procedure in some cases (when the maximum supported size was
    requested).
    
    X-Original-Commit: 4ad86e91ab5be6693aa13668e7f9f6ef50d72f4c

 nimble/controller/src/ble_ll_hci.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 7285268e92335090269857e8423c7db01b740480
Author: William San Filippo <wills@runtime.io>
Date:   Fri Apr 22 13:56:59 2016 -0700

    Modify bletest for new host
    
    X-Original-Commit: 6d8a3a76f173913e6ab5cd442d130abab644cea5

 nimble/host/include/host/host_hci.h |  32 ---
 nimble/host/src/host_hci_cmd.c      | 559 +-----------------------------------
 nimble/include/nimble/hci_common.h  |   1 +
 3 files changed, 4 insertions(+), 588 deletions(-)

commit 7b24450627c033259a8a0ed43d3947aaba4ab67a
Author: William San Filippo <wills@runtime.io>
Date:   Thu Apr 21 14:46:17 2016 -0700

    MYNEWT-284: fix nrf51 radio state errors
    
    X-Original-Commit: 27705013e505dc6b90a7a946e7ce7f8e064ef0f4

 nimble/drivers/nrf51/src/ble_phy.c | 272 +++++++++++++++++--------------------
 nimble/drivers/nrf52/src/ble_phy.c | 272 +++++++++++++++++--------------------
 2 files changed, 249 insertions(+), 295 deletions(-)

commit 4d16fc2bfd57b8b0b1ab0df733f027fcdba05faf
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 20 16:10:54 2016 -0700

    ble host - make priv header filenames consistent.
    
    X-Original-Commit: 832637dbb20a9d5c0bee09aa1dfab157beecce96

 .../host/src/{ble_att_cmd.h => ble_att_cmd_priv.h} |  0
 nimble/host/src/ble_hci_cmd.c                      |  2 +-
 .../src/{ble_hci_util.h => ble_hci_util_priv.h}    |  0
 .../src/{ble_hs_atomic.h => ble_hs_atomic_priv.h}  |  2 +-
 .../host/src/{ble_hs_conn.h => ble_hs_conn_priv.h} |  0
 .../src/{ble_hs_endian.h => ble_hs_endian_priv.h}  |  0
 nimble/host/src/ble_hs_priv.h                      | 16 ++---
 .../{ble_hs_startup.h => ble_hs_startup_priv.h}    |  0
 nimble/host/src/ble_l2cap_priv.h                   | 76 ++++-----------------
 nimble/host/src/ble_l2cap_sig.h                    | 27 --------
 nimble/host/src/ble_l2cap_sig_priv.h               | 77 ++++++++++++++++++++++
 .../src/{ble_l2cap_sm.h => ble_l2cap_sm_priv.h}    |  0
 nimble/host/src/{host_dbg.h => host_dbg_priv.h}    |  0
 nimble/host/src/host_hci.c                         |  2 +-
 nimble/host/src/host_hci_cmd.c                     |  2 +-
 15 files changed, 100 insertions(+), 104 deletions(-)

commit fbd18677557b4e5d50fbed3b3c2e09ddaa78a9a8
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 20 15:30:23 2016 -0700

    ble host - rename "app task" to "parent task"
    
    X-Original-Commit: 99dc724ab938b69fa7ac18a2725398164621fb0c

 nimble/host/src/ble_att.c     |  2 +-
 nimble/host/src/ble_hs.c      | 27 ++++++++++++++++-----------
 nimble/host/src/ble_hs_priv.h |  2 +-
 3 files changed, 18 insertions(+), 13 deletions(-)

commit 20ed62357eb20f655b679cb27be921aec512016d
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 20 15:26:16 2016 -0700

    ble ll - don't undef feature macros.
    
    X-Original-Commit: e4669ed649daac57a130b58fc555fa2592b0fbb5

 nimble/controller/include/controller/ble_ll.h | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 2894e9845dae35b2ba108c7335844f562601524b
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 20 12:27:36 2016 -0700

    ble host - clarify locking restrictions.
    
    X-Original-Commit: 61458e37bf166ecb85c292485bd72e095cc46b4d

 nimble/host/src/ble_att.c           |  37 ++----
 nimble/host/src/ble_att_clt.c       | 180 +-------------------------
 nimble/host/src/ble_att_priv.h      |   3 +-
 nimble/host/src/ble_att_svr.c       | 156 ++---------------------
 nimble/host/src/ble_gap.c           | 248 ++++++------------------------------
 nimble/host/src/ble_gattc.c         |  59 ++++++---
 nimble/host/src/ble_gatts.c         | 105 ---------------
 nimble/host/src/ble_hs.c            |  47 ++++---
 nimble/host/src/ble_hs_adv.c        |   2 -
 nimble/host/src/ble_hs_atomic.c     |  21 +++
 nimble/host/src/ble_hs_atomic.h     |   5 +
 nimble/host/src/ble_hs_conn.c       |  68 +---------
 nimble/host/src/ble_hs_conn.h       |   1 -
 nimble/host/src/ble_hs_misc.c       |   8 --
 nimble/host/src/ble_hs_priv.h       |  12 +-
 nimble/host/src/ble_l2cap.c         |  41 ------
 nimble/host/src/ble_l2cap_sig.c     |  29 ++++-
 nimble/host/src/ble_l2cap_sig_cmd.c |   4 -
 nimble/host/src/ble_l2cap_sm.c      |  43 +++++--
 nimble/host/src/test/ble_os_test.c  |  48 ++++---
 20 files changed, 270 insertions(+), 847 deletions(-)

commit 57b776430d89ca8c20b5d47e2a9759c3709c768b
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 20 13:55:31 2016 -0700

    ble host - fix SM bug; r1/r2 misordered on master.
    
    X-Original-Commit: 3befe370a84d50281001f695983f10f04774764e

 nimble/host/src/ble_l2cap_sm.c | 36 ++++++++++++++++++++++++++++--------
 1 file changed, 28 insertions(+), 8 deletions(-)

commit cde9b15a63539b62104c9953378bc2325b0e908e
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 20 12:42:32 2016 -0700

    ble host - separate blocking HCI from rx
    
    X-Original-Commit: 151139ced61ffdeb339977844be5bb99ed0986f3

 nimble/host/include/host/host_hci.h |   1 -
 nimble/host/src/ble_gap.c           |  32 ++--
 nimble/host/src/ble_hci_cmd.c       | 293 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hci_util.c      |   6 +-
 nimble/host/src/ble_hs.c            |   2 +-
 nimble/host/src/ble_hs_priv.h       |  10 +-
 nimble/host/src/ble_hs_startup.c    |  10 +-
 nimble/host/src/ble_l2cap_sm.c      |   4 +-
 nimble/host/src/host_hci.c          | 235 +----------------------------
 9 files changed, 327 insertions(+), 266 deletions(-)

commit b0108751a043327e2997107e9630011263511f17
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 19 20:01:01 2016 -0700

    ble host - fix security bug
    
    The master (initiator) was overwriting its ltk while verifying the
    slave's response.
    
    X-Original-Commit: 9131d1e4cc55cd49a417182c9c205ca9c2320bb3

 nimble/host/src/ble_hs.c       |  2 --
 nimble/host/src/ble_l2cap_sm.c | 67 ++++++++++++++++++------------------------
 2 files changed, 29 insertions(+), 40 deletions(-)

commit b0a19f707bb1466697167caf6068931bdfb1527a
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Apr 15 21:04:28 2016 -0700

    Update example apps to account for blehost changes
    
    X-Original-Commit: 7235e90ad0fdbe44faa2afce0130c3f1cdc782d7

 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/ble_hci_util.c      | 29 +++++++++++++++++++++++++++++
 nimble/host/src/ble_hci_util.h      |  1 +
 nimble/host/src/host_hci_cmd.c      | 32 ++++++++++++++++++++++++++++++--
 nimble/include/nimble/hci_common.h  |  3 ++-
 5 files changed, 63 insertions(+), 3 deletions(-)

commit 67225d5c71e5d049b8ff2df8f9428fdf3f1f5142
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 12 11:31:14 2016 -0700

    ble host - major changes.
    
    These changes are detailed in this thread on the mynewt dev list:
    http://mail-archives.apache.org/mod_mbox/incubator-mynewt-dev/201604.mbox/%3C20160417225734.GB8991%40iori.nightmare-heaven.no-ip.biz%3E
    
    Here is a summary of the changes:
    
    1. All HCI command/acknowledgement exchanges are blocking.
    
        * FSM machinery goes away; controller response is indicated in the
          return code of the HCI send function.
        * Nearly all HCI failures are indicated to the application
          immediately, so there is no need for lots of mutexes and temporary
          copies of data structures.
        * API is simplified; operation results are indicated via a simple
          function return code.
    
    2. The Nimble host is "taskless"
    
    the Nimble host is now a "flat" library that runs in an application
    task.  When the application initializes the host, it indicates which OS
    event queue should be used for host-related events.  Host operations are
    captured in OS_EVENT_TIMER events that the application task would need
    to handle generically, as it most likely already does.
    
    X-Original-Commit: e32f9f9f20666ecbb42598db0737b9c8f1ca6c74

 nimble/host/include/host/ble_gatt.h        |   14 +-
 nimble/host/include/host/ble_hs.h          |    7 +-
 nimble/host/include/host/ble_l2cap.h       |    1 +
 nimble/host/include/host/host_hci.h        |   20 +-
 nimble/host/src/ble_att.c                  |    7 +-
 nimble/host/src/ble_att_clt.c              |   24 +-
 nimble/host/src/ble_att_svr.c              |   28 +-
 nimble/host/src/ble_fsm.c                  |  530 ------
 nimble/host/src/ble_fsm_priv.h             |   88 -
 nimble/host/src/ble_gap.c                  | 1146 ++++--------
 nimble/host/src/ble_gatt_priv.h            |    1 -
 nimble/host/src/ble_gattc.c                | 2690 ++++++++++------------------
 nimble/host/src/ble_gatts.c                |    8 +-
 nimble/host/src/ble_hci_block.c            |  229 ---
 nimble/host/src/ble_hci_sched.c            |  474 -----
 nimble/host/src/ble_hci_sched.h            |   47 -
 nimble/host/src/ble_hci_util.c             |   78 +
 nimble/host/src/ble_hci_util.h             |   26 +
 nimble/host/src/ble_hs.c                   |  179 +-
 nimble/host/src/ble_hs_atomic.c            |   45 +
 nimble/host/src/ble_hs_atomic.h            |   25 +
 nimble/host/src/ble_hs_cfg.c               |    1 -
 nimble/host/src/ble_hs_conn.c              |  120 +-
 nimble/host/src/ble_hs_conn.h              |    6 +-
 nimble/host/src/ble_hs_misc.c              |   10 +-
 nimble/host/src/ble_hs_priv.h              |   44 +-
 nimble/host/src/ble_hs_startup.c           |  213 +--
 nimble/host/src/ble_ibeacon.c              |    9 +-
 nimble/host/src/ble_l2cap_priv.h           |    3 +-
 nimble/host/src/ble_l2cap_sig.c            |  439 ++---
 nimble/host/src/ble_l2cap_sig_cmd.c        |    4 +-
 nimble/host/src/ble_l2cap_sm.c             | 1142 +++++-------
 nimble/host/src/ble_l2cap_sm.h             |    9 +-
 nimble/host/src/ble_l2cap_sm_cmd.c         |   13 +-
 nimble/host/src/host_hci.c                 |  356 ++--
 nimble/host/src/host_hci_cmd.c             |  240 ++-
 nimble/host/src/test/ble_gap_test.c        |  155 +-
 nimble/host/src/test/ble_gatt_conn_test.c  |   50 +-
 nimble/host/src/test/ble_gatt_read_test.c  |   55 +-
 nimble/host/src/test/ble_gatt_write_test.c |    9 +-
 nimble/host/src/test/ble_host_hci_test.c   |  133 --
 nimble/host/src/test/ble_hs_conn_test.c    |   69 -
 nimble/host/src/test/ble_hs_test.c         |   27 +-
 nimble/host/src/test/ble_hs_test_util.c    |  149 +-
 nimble/host/src/test/ble_hs_test_util.h    |   13 +-
 nimble/host/src/test/ble_l2cap_sm_test.c   |   30 +-
 nimble/host/src/test/ble_l2cap_test.c      |   12 +-
 nimble/host/src/test/ble_os_test.c         |   99 +-
 nimble/include/nimble/hci_common.h         |    2 +-
 49 files changed, 2950 insertions(+), 6129 deletions(-)

commit 409bcca8d4d9ba3f1c0ccb30469d5511045e4cae
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 18 23:25:04 2016 -0700

    MYNEWT-99: Port encryption to nrf51
    
    Add encryption support for the nrf51. The nrf51 cannot encrypt
    or decrypt frames with payload greater than 27 bytes. This
    means if you turn on encryption you will have to change the
    maximum LL packet size in the nimble options header file to
    27 as the default is 251.
    
    X-Original-Commit: a590265d37f3bf671969f15cccf8b92828a1da92

 nimble/controller/src/ble_ll.c      |   3 +-
 nimble/controller/src/ble_ll_ctrl.c |  14 +-
 nimble/drivers/nrf51/src/ble_phy.c  | 247 +++++++++++++++++++++++++++++++++++-
 nimble/drivers/nrf52/src/ble_phy.c  |  40 ++++--
 nimble/include/nimble/nimble_opt.h  |  52 ++++----
 5 files changed, 303 insertions(+), 53 deletions(-)

commit ca34e8c4d7e89b9fb4c67857eaf83b679bf24e80
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 18 23:12:10 2016 -0700

    Modify write suggested default data length command in controller
    
    The prior implementation of this command allowed the host to set
    the initial max tx octets/time for a device to a value that it
    did not support. The controller will now ignore the host request
    if it is not in the supported range.
    
    X-Original-Commit: 73ee5e8b0b0913280637af866d41c54a633aef25

 nimble/controller/src/ble_ll_hci.c | 18 ++++++++++++++----
 1 file changed, 14 insertions(+), 4 deletions(-)

commit 9c055c7c0a8d8103cc39fda37dc192cb68c7ccda
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Apr 15 16:44:00 2016 -0700

    ble host - revert accidental test commit.
    
    (this commit made the host always report that it was using a random
    address, which caused pairing to fail).
    
    X-Original-Commit: a006be675a25ae1c1a0016917b83a0c85ed7d838

 nimble/host/src/ble_l2cap_sm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 0413c49a476c1ebec57512fdd822d5265c733424
Author: William San Filippo <wills@runtime.io>
Date:   Fri Apr 15 15:52:37 2016 -0700

    MYNEWT-99: Implement LL encryption procedure.
    
    This is the first cut at LL encryption for the controller. The
    feature is currently turned off in the code but I wanted to
    commit it so others could take a look. There are a number of
    unresolved issues:
    1) This does not yet implement the encryption pause procedure.
    2) This has yet to be ported to the nrf51.
    3) We see occasional HW errors with decryption. We are ignoring
    these currently but they need to be explained. We are working
    with nordic on this.
    
    X-Original-Commit: 33afb22a2ce574c9a50c7afef675846c80ed1b6c

 nimble/controller/include/controller/ble_ll.h      |  12 +
 nimble/controller/include/controller/ble_ll_conn.h |  89 +++-
 nimble/controller/include/controller/ble_ll_ctrl.h |  17 +-
 nimble/controller/include/controller/ble_phy.h     |   5 +
 nimble/controller/src/ble_ll.c                     |  34 +-
 nimble/controller/src/ble_ll_adv.c                 |   4 +
 nimble/controller/src/ble_ll_conn.c                | 428 +++++++++++----
 nimble/controller/src/ble_ll_conn_hci.c            | 106 +++-
 nimble/controller/src/ble_ll_conn_priv.h           |   2 +
 nimble/controller/src/ble_ll_ctrl.c                | 580 +++++++++++++++++++--
 nimble/controller/src/ble_ll_hci.c                 |  10 +
 nimble/controller/src/ble_ll_hci_ev.c              |  63 +++
 nimble/controller/src/ble_ll_scan.c                |   4 +
 nimble/controller/src/ble_ll_supp_cmd.c            |   4 +
 nimble/drivers/nrf51/src/ble_phy.c                 |  14 +-
 nimble/drivers/nrf52/src/ble_hw.c                  |  81 +--
 nimble/drivers/nrf52/src/ble_phy.c                 | 210 +++++++-
 nimble/host/src/ble_l2cap_sm.c                     |   6 +-
 nimble/include/nimble/ble.h                        |  15 +-
 19 files changed, 1427 insertions(+), 257 deletions(-)

commit 3f62d5a387654c40243ed63cde5a53a1171b945a
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 12 17:16:25 2016 -0700

    Minor encryption/decrpytion host changes
    
    Added some additional host debug in preparation for BLE
    security. Added LTK request negative reply command.
    Copied LTK instead of swapping as LTK should be in LE
    order at the host.
    
    X-Original-Commit: a04dba6a50fecb3b4ab5a7ad0a92ba5778cec34c

 nimble/host/include/host/host_hci.h |   7 +-
 nimble/host/src/host_dbg.c          | 108 +++++++++-----
 nimble/host/src/host_hci_cmd.c      | 278 +++++++++++++++++++-----------------
 3 files changed, 220 insertions(+), 173 deletions(-)

commit 356106ddb970d7e52c423d2d86829be649376d32
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 12 14:15:37 2016 -0700

    Add remaining command LE HCI command lengths
    
    Decided to add all the commands to this array regardless of whether
    or not they are implemented.
    
    X-Original-Commit: aefda63ff6368d081c78f7473f083296f89528c7

 nimble/include/nimble/hci_common.h | 20 ++++++++++++++++-
 nimble/src/hci_common.c            | 45 +++++++++++++++++++-------------------
 2 files changed, 41 insertions(+), 24 deletions(-)

commit 33d8c89023952d330267383c08ebdbd49739b1da
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 12 10:58:32 2016 -0700

    Move connection request txd flag to connection state machine
    
    This flag more correctly belongs in the connections state
    machine as opposed to the mbuf header. We also need a ble
    mbuf flag for upcoming encryption changes.
    
    X-Original-Commit: 9e1d390f65b75642b7e995887d00b33598109063

 nimble/controller/include/controller/ble_ll_conn.h | 11 ++++++-----
 nimble/controller/src/ble_ll_conn.c                | 13 ++++++-------
 nimble/controller/src/ble_ll_ctrl.c                |  4 ++--
 3 files changed, 14 insertions(+), 14 deletions(-)

commit f5871bafafb6d984bfdc2f1829dbd532a3c5e4e6
Author: William San Filippo <wills@runtime.io>
Date:   Tue Apr 12 00:02:01 2016 -0700

    Add PHY statistics
    
    X-Original-Commit: 7dc2980e48d8582dd856a221b8e602d2cf557e70

 nimble/drivers/nrf51/src/ble_phy.c | 130 +++++++++++++++++++++++--------------
 nimble/drivers/nrf52/src/ble_phy.c | 130 +++++++++++++++++++++++--------------
 2 files changed, 160 insertions(+), 100 deletions(-)

commit 8617ac9cd7ac106b69a1662f2e315a76e4c832a1
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 11 23:17:42 2016 -0700

    Finish half-completed transition to packed structs
    
    X-Original-Commit: 84621ed150b7ad973f5c18e121842853d461090f

 nimble/host/src/ble_att_cmd.c | 20 ++++++++++----------
 nimble/host/src/ble_att_cmd.h | 28 ++++++++++++++--------------
 2 files changed, 24 insertions(+), 24 deletions(-)

commit c0874f3da5def83d3e915cd389df0331186a60ac
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 11 22:26:26 2016 -0700

    Remove space at end of line
    
    X-Original-Commit: bfcc17d5bc220d3ff86faaea37bf9ff83e0e7cf7

 nimble/controller/include/controller/ble_ll.h      |  50 +-
 nimble/controller/include/controller/ble_ll_adv.h  |  38 +-
 nimble/controller/include/controller/ble_ll_conn.h |  14 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |  28 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   4 +-
 nimble/controller/include/controller/ble_ll_scan.h |  18 +-
 .../controller/include/controller/ble_ll_sched.h   |  22 +-
 .../include/controller/ble_ll_whitelist.h          |   2 +-
 nimble/controller/include/controller/ble_phy.h     |   6 +-
 nimble/controller/src/ble_ll.c                     | 230 ++++----
 nimble/controller/src/ble_ll_adv.c                 | 358 ++++++------
 nimble/controller/src/ble_ll_conn.c                | 644 ++++++++++-----------
 nimble/controller/src/ble_ll_conn_hci.c            | 218 +++----
 nimble/controller/src/ble_ll_conn_priv.h           |  14 +-
 nimble/controller/src/ble_ll_ctrl.c                | 362 ++++++------
 nimble/controller/src/ble_ll_hci.c                 | 242 ++++----
 nimble/controller/src/ble_ll_hci_ev.c              |  12 +-
 nimble/controller/src/ble_ll_rand.c                |  18 +-
 nimble/controller/src/ble_ll_rng.c                 |   2 +-
 nimble/controller/src/ble_ll_scan.c                | 256 ++++----
 nimble/controller/src/ble_ll_sched.c               |  96 +--
 nimble/controller/src/ble_ll_supp_cmd.c            |  28 +-
 nimble/controller/src/ble_ll_whitelist.c           |  60 +-
 nimble/drivers/native/src/ble_phy.c                |  82 +--
 nimble/drivers/nrf51/src/ble_phy.c                 | 120 ++--
 nimble/drivers/nrf52/src/ble_phy.c                 | 120 ++--
 nimble/include/nimble/ble.h                        |  10 +-
 27 files changed, 1527 insertions(+), 1527 deletions(-)

commit b6e067b893caa15e31ff4f5fe7162dfff496778c
Author: William San Filippo <wills@runtime.io>
Date:   Mon Apr 11 20:39:28 2016 -0700

    Advertising receive isr start only requires pdu type
    
    X-Original-Commit: fde7d8289f497bcdda5a2ae9ee7b71cb4111ac1a

 nimble/controller/include/controller/ble_ll_adv.h | 2 +-
 nimble/controller/src/ble_ll.c                    | 2 +-
 nimble/controller/src/ble_ll_adv.c                | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 4125d6ea3ea695a757f30c2a4c39e50660123f58
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 6 20:45:00 2016 -0700

    ble host - Use blocking HCI tx in GAP procedures.
    
    Prior to this change, all HCI exchanges were performed asynchronously
    (non-blocking).  The transmits were non-blocking because all HCI
    activity was performed in a single task (ble_hs).  With this change,
    whenever possible, HCI transmits are done in the application task, which
    blocks until the ble_hs task completes the transmit and receives the
    acknowledgement (or times out).
    
    This simplifies the GAP code, as it allows us to remove much of the FSM
    machinery that was required before.  In addition, it simplifies the API
    provided to the application by collapsing several failure scenarios into
    a single function return.
    
    X-Original-Commit: 199d3941d221940638e695d567204231e0aa8390

 nimble/host/include/host/ble_gap.h       |   8 +-
 nimble/host/include/host/host_hci.h      |  30 +
 nimble/host/pkg.yml                      |   1 +
 nimble/host/src/ble_gap.c                | 928 ++++++++-----------------------
 nimble/host/src/ble_gap_priv.h           |   1 -
 nimble/host/src/ble_hci_block.c          | 132 +++--
 nimble/host/src/ble_hci_sched.c          |   2 +-
 nimble/host/src/ble_hci_sched.h          |   1 -
 nimble/host/src/ble_hs_priv.h            |  18 +-
 nimble/host/src/ble_ibeacon.c            |  11 +-
 nimble/host/src/host_hci_cmd.c           | 548 +++++++++++++++---
 nimble/host/src/test/ble_att_svr_test.c  |   1 -
 nimble/host/src/test/ble_gap_test.c      | 638 +++++++--------------
 nimble/host/src/test/ble_hs_adv_test.c   |  76 ++-
 nimble/host/src/test/ble_hs_conn_test.c  |  74 +--
 nimble/host/src/test/ble_hs_test.c       |   7 +-
 nimble/host/src/test/ble_hs_test_util.c  | 411 +++++++++++---
 nimble/host/src/test/ble_hs_test_util.h  |  32 +-
 nimble/host/src/test/ble_l2cap_sm_test.c |   4 -
 nimble/host/src/test/ble_l2cap_test.c    |  11 +-
 nimble/host/src/test/ble_os_test.c       |  38 +-
 21 files changed, 1477 insertions(+), 1495 deletions(-)

commit f70bf76bdf97b1d1c44a60ef6221be8286cf25ad
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 11 15:31:32 2016 -0700

    ble host - fix bug for incoming ATT read-type-req.
    
    When processing a follow-up request, if the host reached the end of its
    attribute list, it would respond with an error rather than the
    matching attributes already found.
    
    X-Original-Commit: 9fdc67d3faa09f3ab5576d1e6a42d95df2f863b4

 nimble/host/src/ble_att_svr.c           |   6 +-
 nimble/host/src/test/ble_att_svr_test.c | 122 +++++++++++++++++++-------------
 2 files changed, 77 insertions(+), 51 deletions(-)

commit f9363b32873a2e1881a426f83bf01547816a63b8
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 11 14:24:26 2016 -0700

    ble host: fix bug in att statistics
    
    For outgoing responses, the wrong stats were being incremented.  We
    double counted the rxed request, and did not count the txed response at
    all.
    
    X-Original-Commit: 479381e5778157b7d6d8e291598582e7655052b1

 nimble/host/src/ble_att_clt.c | 7 ++-----
 nimble/host/src/ble_att_svr.c | 3 ++-
 2 files changed, 4 insertions(+), 6 deletions(-)

commit c9627b93a7aaa4e8f898c6bfd7d427878f199162
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Apr 8 18:14:11 2016 -0700

    ble host - fix LTK generation bugs
    
    There were three bugs:
    
    * The LTK was getting byte-swapped twice before being passed to the
    controller.  (should be little endian; was big endian).
    
    * The initiator was never actually generating a key; it was sending
    garbage to the controller!
    
    * The slave was generating the key too late in the process.  As a
    consequence, some inputs into the s1 function had been rendered invalid
    by overlaid data (they are in a union).
    
    X-Original-Commit: c8d9ce1c288bb80a4ab038722798da816533ce0a

 nimble/host/src/ble_hs_misc.c            |  7 ++++
 nimble/host/src/ble_l2cap.c              |  3 ++
 nimble/host/src/ble_l2cap_sm.c           | 32 ++++++++++-------
 nimble/host/src/ble_l2cap_sm_alg.c       | 62 +++++++++++++++++---------------
 nimble/host/src/ble_l2cap_sm_cmd.c       |  6 ++++
 nimble/host/src/host_hci_cmd.c           | 16 ++++++++-
 nimble/host/src/test/ble_l2cap_sm_test.c | 34 ++++++++----------
 7 files changed, 98 insertions(+), 62 deletions(-)

commit 52b318a46f66044e1955ddaccac397cacd19ebc3
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Apr 8 11:25:01 2016 -0700

    ble-host: Prevent warning in debug builds.
    
    X-Original-Commit: f01bf32d7627fdfd544852816596757946300063

 nimble/host/src/ble_gatts.c | 3 +++
 1 file changed, 3 insertions(+)

commit f4ab7a64be5a3b698259fc39bb87f48ad70a6521
Author: William San Filippo <wills@runtime.io>
Date:   Thu Apr 7 00:11:21 2016 -0700

    Fix error in le64toh
    
    X-Original-Commit: 1b91ac5e5d97717d9c3c68dfbe0127043d253394

 nimble/src/util.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6f2b218ed345d39214a65fcadc75062e5b15ea13
Author: William San Filippo <wills@runtime.io>
Date:   Thu Apr 7 00:08:18 2016 -0700

    Fix incorrect scan response advertising event type
    
    X-Original-Commit: fbc310f6e36009d5e6fdec60eaf7b8876bd6941c

 nimble/include/nimble/hci_common.h | 22 +++++++++++-----------
 1 file changed, 11 insertions(+), 11 deletions(-)

commit 209e221e0b20d453607635234f19913d7567036a
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 6 16:49:56 2016 -0700

    MYNEWT-265 BLE - advertise iBeacon
    
    X-Original-Commit: 03a60f654edf91393ec217240e2ba1e2311ebaeb

 nimble/host/include/host/ble_hs.h |  1 +
 nimble/host/src/ble_ibeacon.c     | 68 +++++++++++++++++++++++++++++++++++++++
 2 files changed, 69 insertions(+)

commit 3dbd9ba1cb7496388c30ac293f369e507907b1f7
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 6 16:49:17 2016 -0700

    MYNEWT-265 BLE - advertise iBeacon
    
    Blocking HCI transmits.
    
    X-Original-Commit: 8fc5098e8812da06e3e9b89eb75848ea8cb79cd5

 nimble/host/include/host/host_hci.h |   1 +
 nimble/host/src/ble_hci_block.c     | 159 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs.c            |   4 +-
 nimble/host/src/ble_hs_priv.h       |  20 +++++
 nimble/host/src/host_hci.c          |   6 ++
 5 files changed, 189 insertions(+), 1 deletion(-)

commit 600bf8706633e949f074d814d833e5c72a2ef0f1
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 6 11:18:16 2016 -0700

    MYNEWT-265 BLE - advertise iBeacon
    
    Combine non/und/dir adv state machines.  Prior to this change, the slave
    used separate state machines for different connectable modes.  The code
    is simpler (and smaller) if all connectable modes use the same state
    machine.
    
    X-Original-Commit: 338fe0f5c84f7dbc53772639bb665223aadae249

 nimble/host/src/ble_gap.c               | 148 ++++++++++++++------------------
 nimble/host/src/test/ble_gap_test.c     |   8 ++
 nimble/host/src/test/ble_hs_conn_test.c |   6 ++
 3 files changed, 77 insertions(+), 85 deletions(-)

commit 38eca8a3ebd3566bfcd29a3018b98de5fc987ffd
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 5 20:31:02 2016 -0700

    MYNEWT-265 BLE - advertise iBeacon
    
    Only include AD tx-pwr field if requested.  The iBeacon advertisement
    format requires that undirected advertisements not include the
    tx-power-level AD field.  Prior to this change, this field was always
    inserted into an undirected advertisement.
    
    X-Original-Commit: 13747ab33342e7ccf050c1bff24703e1d653240f

 nimble/host/src/ble_gap.c              | 39 ++++++++++++++++++++++++----------
 nimble/host/src/test/ble_hs_adv_test.c | 22 +++++++++++++++++++
 2 files changed, 50 insertions(+), 11 deletions(-)

commit 21709f1d3fce604e8ee6086c6bbd8d7c51156d1f
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Apr 6 15:56:07 2016 -0700

    ble host - fix build when security is disabled.
    
    X-Original-Commit: 738c6e7ca09b437d6101da80b0152b8408eeb178

 nimble/host/src/ble_l2cap_sm.h | 2 ++
 1 file changed, 2 insertions(+)

commit 09d100016df404d2511be6925e0b3246b3d7f853
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 5 17:34:23 2016 -0700

    ble host: cancel sm proc when connection broken.
    
    X-Original-Commit: 655d02396b4c5302df067e7f3eb43ead1a72995a

 nimble/host/include/host/ble_l2cap.h |  1 +
 nimble/host/src/ble_gap.c            |  1 +
 nimble/host/src/ble_l2cap_sm.c       | 83 +++++++++++++++++++++++++++++++++++-
 3 files changed, 83 insertions(+), 2 deletions(-)

commit 8541ddab1302ea49a526d7d799d598a3e32c7584
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 5 16:29:48 2016 -0700

    ble host: sm procedures time out after 30 seconds.
    
    X-Original-Commit: 6e099aa6c1e2d660b77a78a90249c4fba23e7a28

 nimble/host/src/ble_hs.c       |  1 +
 nimble/host/src/ble_l2cap_sm.c | 56 +++++++++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_l2cap_sm.h |  2 ++
 3 files changed, 58 insertions(+), 1 deletion(-)

commit b2bdbe6bbee97a9380234f8864f7fbaca52a2971
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 5 14:55:48 2016 -0700

    ble host: use one 1hz timer for lazy procedures.
    
    X-Original-Commit: 5bf00b0c3c7648b043a69bd9a82a43f2659c03b7

 nimble/host/src/ble_gap.c        | 76 +++++++++++++++++++++-------------------
 nimble/host/src/ble_gap_priv.h   |  2 ++
 nimble/host/src/ble_gatt_priv.h  |  2 +-
 nimble/host/src/ble_gattc.c      | 39 ++-------------------
 nimble/host/src/ble_hs.c         | 46 +++++++++++++++++++++++-
 nimble/host/src/ble_hs_startup.c |  2 ++
 6 files changed, 93 insertions(+), 74 deletions(-)

commit e18351c5d13f1c32d331f9a6aedc9a34ef17a5b6
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Apr 5 12:43:55 2016 -0700

    ble host: Minor change in BLE_HS_DBG_ASSERT macros
    
    X-Original-Commit: d06f5b5c9283467c66b4595122f12f19f9f4b9da

 nimble/host/src/ble_hs_priv.h | 12 ++++--------
 1 file changed, 4 insertions(+), 8 deletions(-)

commit bedc7adac0f0783c9ecab782d040b31d0202b5bd
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Apr 4 20:19:07 2016 -0700

    ble host - fix bug: ensure proc inserted.
    
    This bug occurred when the application task is running at a lower
    priority than the host task.  When the application initiates pairing,
    the host code kicked the host task before the pairing operation was
    inserted into the procedure list.  As a consequence, the pairing
    procedure did not execute.
    
    X-Original-Commit: 1f4662b1e9d3dcfed4a8db3de2b5ce02b280399f

 nimble/host/src/ble_l2cap_sm.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 1d915f7468b537513cea7fdc72105882c894d485
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Apr 1 18:02:21 2016 -0700

    ble host: reduce code size.
    
    * Use packed structs for over-the-air ATT and L2CAP commands.
    * Compile-out ~90% of asserts except when BLE_HS_DEBUG is defined.
    
    X-Original-Commit: 2fef21d6a1f9d3d83b88ecf11b825a6e5a354a47

 nimble/host/src/ble_att.c                    |   1 -
 nimble/host/src/ble_att_clt.c                | 231 +++----
 nimble/host/src/ble_att_cmd.c                | 987 ++++++++++-----------------
 nimble/host/src/ble_att_cmd.h                | 168 ++---
 nimble/host/src/ble_att_priv.h               |  16 +-
 nimble/host/src/ble_att_svr.c                | 348 +++-------
 nimble/host/src/ble_fsm.c                    |  26 +-
 nimble/host/src/ble_fsm_priv.h               |   2 +
 nimble/host/src/ble_gap.c                    | 124 ++--
 nimble/host/src/ble_gattc.c                  |  19 +-
 nimble/host/src/ble_gatts.c                  |  43 +-
 nimble/host/src/ble_hci_sched.c              |  22 +-
 nimble/host/src/ble_hs.c                     |   2 +-
 nimble/host/src/ble_hs_adv.c                 |   3 +-
 nimble/host/src/ble_hs_conn.c                |  11 +-
 nimble/host/src/ble_hs_endian.h              |  57 ++
 nimble/host/src/ble_hs_misc.c                |  12 +-
 nimble/host/src/ble_hs_priv.h                |  26 +-
 nimble/host/src/ble_hs_startup.c             |  26 +-
 nimble/host/src/ble_l2cap.c                  |   5 +-
 nimble/host/src/ble_l2cap_priv.h             |  40 +-
 nimble/host/src/ble_l2cap_sig.c              |  16 +-
 nimble/host/src/ble_l2cap_sig_cmd.c          | 318 ++++-----
 nimble/host/src/ble_l2cap_sm.c               |  39 +-
 nimble/host/src/ble_l2cap_sm.h               |  40 +-
 nimble/host/src/ble_l2cap_sm_cmd.c           |  84 +--
 nimble/host/src/ble_uuid.c                   |   5 +-
 nimble/host/src/host_dbg.c                   |   4 +
 nimble/host/src/host_hci.c                   |  23 +-
 nimble/host/src/host_hci_cmd.c               |   4 +-
 nimble/host/src/test/ble_att_clt_test.c      |  33 +-
 nimble/host/src/test/ble_att_svr_test.c      | 180 ++---
 nimble/host/src/test/ble_gatt_disc_c_test.c  |   3 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c  |   3 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c  |   5 +-
 nimble/host/src/test/ble_gatt_find_s_test.c  |  12 +-
 nimble/host/src/test/ble_gatt_read_test.c    |   3 +-
 nimble/host/src/test/ble_gatt_write_test.c   |   9 +-
 nimble/host/src/test/ble_gatts_notify_test.c |  12 +-
 nimble/host/src/test/ble_hs_test_util.c      |  38 +-
 nimble/host/src/test/ble_hs_test_util.h      |   4 +
 nimble/host/src/test/ble_l2cap_sm_test.c     |  61 +-
 nimble/host/src/test/ble_l2cap_test.c        |  74 +-
 nimble/include/nimble/ble.h                  |   1 +
 44 files changed, 1265 insertions(+), 1875 deletions(-)

commit 4e5e93cc426d84377a17de6a059cc8c8e46ae999
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 31 19:11:34 2016 -0700

    ble host: support for initiating pairing.
    
    X-Original-Commit: ca2d8fbe4351ea18a5acd91529e892a63e74edff

 nimble/host/include/host/ble_gap.h       |   1 +
 nimble/host/include/host/ble_hs.h        |   3 +
 nimble/host/include/host/host_hci.h      |   1 +
 nimble/host/src/ble_gap.c                |  30 +++-
 nimble/host/src/ble_l2cap_sm.c           | 288 +++++++++++++++++++++++++------
 nimble/host/src/ble_l2cap_sm.h           |   5 +-
 nimble/host/src/ble_l2cap_sm_alg.c       |  68 ++++----
 nimble/host/src/host_hci_cmd.c           |  21 +++
 nimble/host/src/test/ble_l2cap_sm_test.c | 277 +++++++++++++++++++++++++----
 nimble/include/nimble/hci_common.h       |  16 +-
 10 files changed, 594 insertions(+), 116 deletions(-)

commit 3114289c79c9f0499575ab19a98555c7f717d6c2
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 31 13:40:14 2016 -0700

    ble ctlr: clear filtered advertisers on scan start
    
    Prior to this change, advertisers remained filtered forever.  Now, the
    filter only lasts until the end of the scan procedure.
    
    This change applies to both advertisements and scan responses.
    
    X-Original-Commit: 87003af9a41000c73b1aa676fb17be98e740702d

 nimble/controller/src/ble_ll_scan.c | 4 ++++
 1 file changed, 4 insertions(+)

commit d5e228698496116f9794ff766c5ab5ff1463fef4
Author: William San Filippo <wills@runtime.io>
Date:   Thu Mar 31 10:47:18 2016 -0700

    Fix nrf51 receive mbuf data pointer error
    
    X-Original-Commit: e9d16c2c2f855d23b1d699376721a3417610aebe

 nimble/drivers/nrf51/src/ble_phy.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 38a19f30aa84961f195f1c94c92e1290bd60b604
Author: wes3 <wills@runtime.io>
Date:   Thu Mar 31 00:45:35 2016 -0700

    Add random number code back to build if LE encryption not defined
    
    X-Original-Commit: d582cfba6084966308cfc0ca90d71306bb0990ef

 nimble/controller/src/ble_ll.c          | 4 +---
 nimble/controller/src/ble_ll_hci.c      | 4 ++--
 nimble/controller/src/ble_ll_rand.c     | 3 ---
 nimble/controller/src/ble_ll_supp_cmd.c | 3 +--
 4 files changed, 4 insertions(+), 10 deletions(-)

commit 0f2dc893b3552705c514998f9569f5b54289a0c2
Author: wes3 <will@micosa.io>
Date:   Wed Mar 30 17:33:21 2016 -0700

    No jira ticket: modified api to ble_ll_hci_is_event_enabled() to pass in the event as opposed to the bit position as this was confusing
    
    X-Original-Commit: 5998d17381207f4ec9a6b248a489bba3161a0533

 nimble/controller/include/controller/ble_ll_hci.h |  2 +-
 nimble/controller/src/ble_ll_conn_hci.c           |  2 +-
 nimble/controller/src/ble_ll_hci.c                | 19 +++++++++++--------
 3 files changed, 13 insertions(+), 10 deletions(-)

commit 5e096fff64b22d554fc8336dedd33cc4e0398ab7
Author: wes3 <will@micosa.io>
Date:   Wed Mar 30 16:57:15 2016 -0700

    No jira ticket for this commit. Renamed a BLE error code since it was very poorly named. The old name was 'unsupported feature' when it really was an error denoting 'unsupported remote feature'. This was confusing and was leading to bugs so I modified the name and also returned the proper error code in cases where we dont support a feature (as opposed to the remote)
    
    X-Original-Commit: ad0cbc548365b19f5149d299a4e51a93ca2defad

 nimble/controller/src/ble_ll_conn_hci.c |  8 ++++----
 nimble/controller/src/ble_ll_ctrl.c     | 20 ++++++++++++--------
 nimble/include/nimble/ble.h             |  2 +-
 3 files changed, 17 insertions(+), 13 deletions(-)

commit fe562fc68deded305e3d8d5ea424e323db01f257
Author: wes3 <will@micosa.io>
Date:   Wed Mar 30 15:41:33 2016 -0700

    MYNEWT-277: add commands that need to be supported for data length extension. This also fixes a bug in the code regarding fragmentation of frames. Prior code was not fragmenting frames correctly
    
    X-Original-Commit: 2aa3caf33345343beadeb41ea0d732101d962b22

 nimble/controller/include/controller/ble_ll.h | 10 ++--
 nimble/controller/src/ble_ll.c                | 30 ++++++++++++
 nimble/controller/src/ble_ll_conn.c           | 11 +++++
 nimble/controller/src/ble_ll_conn_hci.c       | 41 +++++++++++++++++
 nimble/controller/src/ble_ll_conn_priv.h      |  6 ++-
 nimble/controller/src/ble_ll_hci.c            | 66 +++++++++++++++++++++++++++
 nimble/host/include/host/host_hci.h           |  4 ++
 nimble/host/src/host_dbg.c                    |  9 ++++
 nimble/host/src/host_hci_cmd.c                | 57 +++++++++++++++++++++++
 nimble/include/nimble/hci_common.h            |  9 ++++
 nimble/include/nimble/nimble_opt.h            |  2 +-
 nimble/src/hci_common.c                       |  6 +--
 12 files changed, 242 insertions(+), 9 deletions(-)

commit 9620998ed0d50572977cd159be58cb6231ae77d7
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 30 14:37:31 2016 -0700

    ble host- fix crash upon gatt procedure timeout.
    
    Unlock the gattc mutex prior to executing the application callback.
    
    X-Original-Commit: 46ce9f98a30708a80742a3d2dd415361e08d1db4

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 4c4054009c6d6db572e9f565d2c6fa4353a182d7
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 30 13:44:13 2016 -0700

    nimble host: Fix failing adv unit tests.
    
    X-Original-Commit: 0f53c93e8e31d7efe4887ff7589edc48b2a04356

 nimble/host/src/test/ble_hs_adv_test.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit ff6ce4acb7c6aff5a09798d615f29d4713797623
Author: wes3 <will@micosa.io>
Date:   Tue Mar 29 21:23:00 2016 -0700

    MYNEWT-271: the same issue regarding set advertising data was present in set scan response data.
    
    X-Original-Commit: 94f2947216d1ae60efb247591058b68a1c5d3925

 nimble/controller/src/ble_ll_adv.c | 2 +-
 nimble/host/src/host_hci_cmd.c     | 7 +++++--
 nimble/include/nimble/hci_common.h | 1 +
 nimble/src/hci_common.c            | 2 +-
 4 files changed, 8 insertions(+), 4 deletions(-)

commit b41a347b9d757320794860ffbb49fdcf77aa7754
Author: wes3 <will@micosa.io>
Date:   Tue Mar 29 17:01:56 2016 -0700

    MYNEWT-272: Fix error in octets 34 and 35 of supported commands returned from the controller
    
    X-Original-Commit: 40ed37d3d44ffb430b038ee7c7cec2e755a6dbe8

 nimble/controller/src/ble_ll_supp_cmd.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 33a5f91cb8a46159d156bfe6245f56e104060bdc
Author: wes3 <will@micosa.io>
Date:   Tue Mar 29 14:34:45 2016 -0700

    MYNEWT-271: fix nimble stack set advertising data HCI command bugs.
    
    X-Original-Commit: 2686299d02ada35c5070fd4d7822480b98cd6408

 nimble/controller/src/ble_ll_adv.c |  2 +-
 nimble/host/src/host_hci_cmd.c     | 16 ++++++++++++++--
 nimble/include/nimble/hci_common.h |  1 +
 nimble/src/hci_common.c            |  2 +-
 4 files changed, 17 insertions(+), 4 deletions(-)

commit 2a1223d7d103703a94c5b61635d7f7cfda448020
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 28 14:15:45 2016 -0700

    Some preliminary passkey & OOB.
    
    X-Original-Commit: 696683c9af2ded7d741f9d2e26d9716420f58ee9

 nimble/host/include/host/ble_gap.h       |   2 +-
 nimble/host/include/host/ble_hs.h        |  75 ++++++++++--------
 nimble/host/include/host/ble_l2cap.h     |  28 ++++++-
 nimble/host/pkg.yml                      |   4 +-
 nimble/host/src/ble_gap.c                |  30 +-------
 nimble/host/src/ble_gap_priv.h           |   5 +-
 nimble/host/src/ble_hs_cfg.c             |   8 ++
 nimble/host/src/ble_l2cap_sig.c          |   4 +-
 nimble/host/src/ble_l2cap_sm.c           | 127 +++++++++++++++++++++++--------
 nimble/host/src/ble_l2cap_sm.h           |  15 ----
 nimble/host/src/test/ble_l2cap_sm_test.c |  62 ++++++++++++---
 11 files changed, 234 insertions(+), 126 deletions(-)

commit ef0fe38b23900cddccfa125d8b9905e1fb677eb8
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 28 12:28:00 2016 -0700

    Look at nimble options before #if NIMBLE_OPT_SM !
    
    X-Original-Commit: 44cc9fd672fbe427b3b328e9f5010cb1780dcea4

 nimble/host/src/ble_l2cap_sm.c           | 5 +++--
 nimble/host/src/ble_l2cap_sm_alg.c       | 5 +++--
 nimble/host/src/ble_l2cap_sm_cmd.c       | 5 +++--
 nimble/host/src/test/ble_l2cap_sm_test.c | 5 +++--
 4 files changed, 12 insertions(+), 8 deletions(-)

commit 785da2447983f8122e996ef7606deb1517c9a2cf
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 28 12:06:54 2016 -0700

    Reduce blehost code size - disable SM by default.
    
    Security support results in 10 kB of mbedtls code getting pulled in.
    For now, disable BLE security by default to prevent flash overflow.
    These ugly "#if"s are temporary.  We will need more fine-grained SM
    configurability.
    
    X-Original-Commit: 7006159d929655762fb8755e32e90d378bb55e44

 nimble/host/src/ble_hs_conn.c            |  2 ++
 nimble/host/src/ble_l2cap_sm.c           |  4 ++++
 nimble/host/src/ble_l2cap_sm.h           | 37 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap_sm_alg.c       |  4 ++++
 nimble/host/src/ble_l2cap_sm_cmd.c       |  4 ++++
 nimble/host/src/test/ble_l2cap_sm_test.c |  7 ++++++
 nimble/include/nimble/nimble_opt.h       |  6 ++++++
 7 files changed, 64 insertions(+)

commit 6ade22f918a5972b106d7632b7d142c8e6bc19cf
Author: wes3 <will@micosa.io>
Date:   Mon Mar 28 09:04:22 2016 -0700

    MYNEWT-99: add random number genration/support for LE encryption
    
    X-Original-Commit: f936daef15fb3cf9da66aebdc3224ba6c9842c26

 nimble/controller/include/controller/ble_hw.h |  25 +++++
 nimble/controller/include/controller/ble_ll.h |  17 +++-
 nimble/controller/src/ble_ll.c                |  19 ++--
 nimble/controller/src/ble_ll_ctrl.c           |  80 ++++++++-------
 nimble/controller/src/ble_ll_hci.c            |  27 +++++
 nimble/controller/src/ble_ll_rand.c           | 136 ++++++++++++++++++++++++++
 nimble/controller/src/ble_ll_rng.c            |  60 ++++++++++++
 nimble/controller/src/ble_ll_supp_cmd.c       |  11 ++-
 nimble/drivers/native/src/ble_hw.c            |  48 +++++++++
 nimble/drivers/nrf51/src/ble_hw.c             | 122 +++++++++++++++++++++++
 nimble/drivers/nrf52/src/ble_hw.c             | 122 +++++++++++++++++++++++
 nimble/host/include/host/host_hci.h           |   1 +
 nimble/host/src/host_dbg.c                    |   6 ++
 nimble/host/src/host_hci_cmd.c                |  28 +++++-
 nimble/include/nimble/hci_common.h            |   3 +
 nimble/include/nimble/nimble_opt.h            |  13 ++-
 nimble/src/hci_common.c                       |   2 +-
 17 files changed, 663 insertions(+), 57 deletions(-)

commit eec9fb7e3fe56f76879bff15bf6c28f15443bf61
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 25 19:34:11 2016 -0700

    nimble host: notify app when encryption changes.
    
    X-Original-Commit: ea3ff1802c60f9a7a9c7d4e920f6687b2a40d3e8

 nimble/host/include/host/ble_gap.h       |   2 +
 nimble/host/src/ble_gap.c                |  35 +++++++----
 nimble/host/src/ble_gap_priv.h           |   3 +-
 nimble/host/src/ble_hs_conn.h            |   2 +
 nimble/host/src/ble_l2cap_sm.c           | 101 ++++++++++++++++++++++---------
 nimble/host/src/ble_l2cap_sm.h           |   2 +
 nimble/host/src/host_hci.c               |   2 +-
 nimble/host/src/test/ble_l2cap_sm_test.c |  30 +++++++++
 8 files changed, 134 insertions(+), 43 deletions(-)

commit 4f672f9106aa9cc62521959a6c28a26d83dceb4c
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 22 15:47:30 2016 -0700

    nimble host: Initial security manager (SM)
    
    * Currently, only legacy "Just Works" mode is supported.
    * Application is not properly notified when security is established.
    * Security procedures should fail due to timeout; currently they go on
      forever.
    
    X-Original-Commit: fc1748819e195ac002cc07fc1201a3b80f2a42a8

 nimble/host/include/host/ble_gap.h       |  16 +-
 nimble/host/include/host/ble_hs.h        |   6 +-
 nimble/host/include/host/ble_hs_test.h   |   1 +
 nimble/host/include/host/ble_l2cap.h     |   2 +-
 nimble/host/include/host/host_hci.h      |   1 +
 nimble/host/pkg.yml                      |   2 +
 nimble/host/src/ble_fsm.c                |  10 +-
 nimble/host/src/ble_gap.c                | 150 +++--
 nimble/host/src/ble_gap_priv.h           |   3 +
 nimble/host/src/ble_hs.c                 |  20 +-
 nimble/host/src/ble_hs_cfg.c             |   1 +
 nimble/host/src/ble_hs_misc.c            |   2 +-
 nimble/host/src/ble_hs_priv.h            |   2 +
 nimble/host/src/ble_l2cap.c              |   5 +
 nimble/host/src/ble_l2cap_priv.h         |   1 -
 nimble/host/src/ble_l2cap_sig.c          |   3 +-
 nimble/host/src/ble_l2cap_sm.c           | 933 +++++++++++++++++++++++++++++--
 nimble/host/src/ble_l2cap_sm.h           | 118 ++++
 nimble/host/src/ble_l2cap_sm_alg.c       | 155 +++++
 nimble/host/src/ble_l2cap_sm_cmd.c       | 311 +++++++++++
 nimble/host/src/host_hci.c               |  71 ++-
 nimble/host/src/host_hci_cmd.c           |  14 +
 nimble/host/src/test/ble_gap_test.c      |   4 +-
 nimble/host/src/test/ble_hs_test.c       |   4 +
 nimble/host/src/test/ble_hs_test_util.c  |   8 +
 nimble/host/src/test/ble_hs_test_util.h  |   1 +
 nimble/host/src/test/ble_l2cap_sm_test.c | 538 ++++++++++++++++++
 nimble/include/nimble/hci_common.h       |  34 ++
 28 files changed, 2294 insertions(+), 122 deletions(-)

commit 928a7ce63c396903766d52fd87b26609c81dff58
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 25 12:32:49 2016 -0700

    nimble host: Clarify host address and address type
    
    X-Original-Commit: d2f4d851aa9c086b8f2e09f1b649aee24e15084d

 nimble/host/src/ble_gap.c        | 16 ++++++++--------
 nimble/host/src/ble_hs.c         |  1 +
 nimble/host/src/ble_hs_priv.h    |  8 ++++++++
 nimble/host/src/ble_hs_startup.c |  4 ++++
 4 files changed, 21 insertions(+), 8 deletions(-)

commit 21c98b5b246f59d9895383ebfc2ea45a8383db78
Author: Christopher Collins <ccollins@apache.org>
Date:   Wed Mar 23 19:15:23 2016 -0700

    nimble host - Add missing "\n" at end of log lines
    
    X-Original-Commit: a8cd0f7bd6c8a0c2d98accdc126d2be899f61663

 nimble/host/src/host_hci.c | 2 ++
 1 file changed, 2 insertions(+)

commit c4279f5c5fc3baf80c5e84ca40efa0fdd6f8ad71
Author: Christopher Collins <ccollins@apache.org>
Date:   Tue Mar 22 18:45:48 2016 -0700

    nimble host: Misc fixes related to fsm.
    
    X-Original-Commit: 733f6d3f7cbf3dffd5b69567decd283936480342

 nimble/host/src/ble_fsm.c       | 2 +-
 nimble/host/src/ble_fsm_priv.h  | 2 --
 nimble/host/src/ble_gatt_priv.h | 2 --
 nimble/host/src/ble_gattc.c     | 4 ++--
 4 files changed, 3 insertions(+), 7 deletions(-)

commit 147c7a1502fa65b280a7ab1dc9a10ff099bb27ce
Author: wes3 <will@micosa.io>
Date:   Thu Mar 24 20:39:24 2016 -0700

    Add LE encrypt command
    
    X-Original-Commit: 3128593448c9c70ae5c4d3fadb04b48ff22352ea

 nimble/controller/include/controller/ble_hw.h |  4 +++
 nimble/controller/include/controller/ble_ll.h |  1 +
 nimble/controller/src/ble_ll_hci.c            | 43 ++++++++++++++++++++++++++-
 nimble/controller/src/ble_ll_supp_cmd.c       |  2 +-
 nimble/drivers/native/src/ble_hw.c            |  9 ++++++
 nimble/drivers/nrf51/src/ble_hw.c             | 33 ++++++++++++++++++++
 nimble/drivers/nrf52/src/ble_hw.c             | 33 ++++++++++++++++++++
 nimble/host/include/host/host_hci.h           |  1 +
 nimble/host/src/host_dbg.c                    | 10 +++++++
 nimble/host/src/host_hci_cmd.c                | 22 ++++++++++++++
 nimble/include/nimble/ble.h                   | 11 +++++++
 nimble/include/nimble/hci_common.h            |  3 ++
 nimble/src/hci_common.c                       |  2 +-
 nimble/src/util.c                             | 12 ++++++++
 14 files changed, 183 insertions(+), 3 deletions(-)

commit f4094c940fa8b4a530d5706f14e5a8bca2ac49d7
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 24 20:35:20 2016 -0700

    ble host: Don't call system assert in tests.
    
    X-Original-Commit: 0544eb4f59afaa67e53ca51c88004bfd3f528c9b

 nimble/host/src/test/ble_hs_test.c | 1 -
 1 file changed, 1 deletion(-)

commit 9c2030f979b9e543421b00ce9b9d82ad5a75f267
Author: Christopher Collins <ccollins@apache.org>
Date:   Thu Mar 24 17:28:02 2016 -0700

    Add swap_in_place() for arbitrary byte-swapping.
    
    X-Original-Commit: 6ea754b20dc0ede78e3f1af4b245f2c37fb6b93d

 nimble/include/nimble/ble.h |  1 +
 nimble/src/util.c           | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+)

commit 58d5d2e6df608db924ebcc4c48ec3139b00bcb30
Author: wes3 <will@micosa.io>
Date:   Tue Mar 22 23:12:38 2016 -0700

    Add read supported commands and read local supported features commands
    
    X-Original-Commit: 8a7eb7d4817d935feb8cf8492685d9251a7651fd

 nimble/controller/include/controller/ble_ll_hci.h |   4 +
 nimble/controller/src/ble_ll_hci.c                |  49 ++++++
 nimble/controller/src/ble_ll_supp_cmd.c           | 197 ++++++++++++++++++++++
 nimble/host/include/host/host_hci.h               |   2 +
 nimble/host/src/host_dbg.c                        |  83 ++++++---
 nimble/host/src/host_hci_cmd.c                    |  20 +++
 nimble/include/nimble/hci_common.h                | 101 ++++++-----
 7 files changed, 378 insertions(+), 78 deletions(-)

commit e890dfa77fe682cbe280e45d4acf73357deb1e6f
Author: wes3 <will@micosa.io>
Date:   Tue Mar 22 17:01:09 2016 -0700

    MYNEWT-100: remove need for each connection to have its own empty pdu
    
    X-Original-Commit: 3dc5a478405b66e318b3b80b1306ce9dc4e7ebb2

 nimble/controller/include/controller/ble_ll_conn.h |  18 +-
 nimble/controller/src/ble_ll_conn.c                | 303 +++++++++++----------
 nimble/host/src/host_hci.c                         |   2 +
 nimble/include/nimble/ble.h                        |  20 +-
 4 files changed, 184 insertions(+), 159 deletions(-)

commit 0c2d7a09c6e58f3d1b2e58ec8c1b0a2b5e18e5c7
Author: wes3 <will@micosa.io>
Date:   Tue Mar 22 16:59:05 2016 -0700

    Add the following commands to the controller: read BD address, read supported states and read maximum data length
    
    X-Original-Commit: d360e4fcd36e368b4887dbf17f0e6e40f94a94d4

 nimble/controller/include/controller/ble_ll.h |   3 +
 nimble/controller/src/ble_ll.c                | 109 +++++++++++++++++++++++++-
 nimble/controller/src/ble_ll_hci.c            |  90 ++++++++++++++++++---
 nimble/host/include/host/host_hci.h           |   4 +-
 nimble/host/src/host_dbg.c                    |  26 ++++--
 nimble/host/src/host_hci_cmd.c                |  38 +++++++++
 nimble/include/nimble/hci_common.h            |   9 +++
 nimble/src/hci_common.c                       |   4 +-
 8 files changed, 261 insertions(+), 22 deletions(-)

commit 40361f72f770e672b175f7bb684bd265d5696b1b
Merge: 59e1d7de c8c1a6a8
Author: Christopher Collins <ccollins@apache.org>
Date:   Fri Mar 18 18:02:04 2016 -0700

    Merge branch 'develop'
    
    X-Original-Commit: 2bec33d4dba12094f32ca560410b8671c0ce1d22

commit c8c1a6a81d859f65becfd75b48a19913aa4c8bf4
Author: wes3 <will@micosa.io>
Date:   Fri Mar 18 17:14:55 2016 -0700

    Fix crash in bletiny (stack overflow). Get 16K working
    
    X-Original-Commit: 59a095b56357d87e562cb4b4b9d5494802558021

 nimble/controller/include/controller/ble_ll.h | 2 +-
 nimble/host/src/ble_hs.c                      | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 59e1d7deb4c3e17e001fd46bf76fb740d7a280a5
Merge: 16499d4d 0b847d31
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 14 17:27:00 2016 -0700

    Merge branch 'develop' for 0.8.0 B2
    
    X-Original-Commit: 3020b32d67ff2c04da69bed9d76df43bf9bbed70

commit 0b847d311af8fea9a70a571590cd3260fbe7ab5b
Author: wes3 <will@micosa.io>
Date:   Mon Mar 14 16:31:45 2016 -0700

    MYNEWT-96: Moved LL configuration items out of controller code into nimble_opt.h. This also caused the LL init API to change which is why the main C modules were modified in some of the apps
    
    X-Original-Commit: 27a3fd47f30bb45d042ca734f1d875fa8b827cfa

 nimble/controller/include/controller/ble_ll.h      | 29 +++----
 nimble/controller/include/controller/ble_ll_hci.h  | 11 ---
 nimble/controller/include/controller/ble_ll_scan.h | 18 -----
 .../include/controller/ble_ll_whitelist.h          |  2 -
 nimble/controller/src/ble_ll.c                     |  6 +-
 nimble/controller/src/ble_ll_conn.c                | 48 ++++++------
 nimble/controller/src/ble_ll_conn_hci.c            | 10 +--
 nimble/controller/src/ble_ll_ctrl.c                |  3 +-
 nimble/controller/src/ble_ll_hci.c                 |  7 +-
 nimble/controller/src/ble_ll_scan.c                | 19 ++++-
 nimble/controller/src/ble_ll_whitelist.c           | 12 +--
 nimble/include/nimble/nimble_opt.h                 | 89 +++++++++++++++++++++-
 12 files changed, 157 insertions(+), 97 deletions(-)

commit a6ca79a1bcc33699318d8cd3b100c8519139bd94
Author: Sterling Hughes <sterling@apache.org>
Date:   Mon Mar 14 15:55:06 2016 -0700

    remove empty readmes, fixup readmes with content.  some of these may be re-added, but shouldn't be in the release empty.  top-level readme suffices
    
    X-Original-Commit: fc3116a91eeb2c7d0efd2bb7cbf2b75ee41d86f5

 nimble/README.md | 22 ----------------------
 1 file changed, 22 deletions(-)

commit c3e81d6e1eb7c540b6d1acd272c8f84bd46480d4
Author: Christopher Collins <ccollins@apache.org>
Date:   Mon Mar 14 14:10:24 2016 -0700

    Replace some common fields in pkg.yml.
    
    X-Original-Commit: 2fb63deb4653b80737d267a63a655d1f9e33754b

 nimble/controller/pkg.yml     | 6 ++----
 nimble/drivers/native/pkg.yml | 6 ++----
 nimble/drivers/nrf51/pkg.yml  | 6 ++----
 nimble/drivers/nrf52/pkg.yml  | 6 ++----
 nimble/host/pkg.yml           | 6 ++----
 nimble/pkg.yml                | 6 ++----
 6 files changed, 12 insertions(+), 24 deletions(-)

commit 4c26b88c39d8d6bec7a065bd7c74d0aa0efd631b
Author: wes3 <will@micosa.io>
Date:   Fri Mar 11 16:22:21 2016 -0800

    No jira ticket for this commit. Modifying some of how the nimble stack gets initialized and also trying to move configuration options out of the controller code into nimble_opt.h
    
    X-Original-Commit: ec4830c93bdd3fd2e10e15535fb1424e70fd56fd

 nimble/controller/include/controller/ble_ll.h |  2 +-
 nimble/controller/src/ble_ll.c                | 14 ++++----------
 nimble/controller/src/ble_ll_adv.c            | 12 ++----------
 nimble/controller/src/ble_ll_hci.c            |  4 ++--
 nimble/controller/src/ble_ll_scan.c           | 13 ++++---------
 nimble/include/nimble/nimble_opt.h            |  5 +++++
 6 files changed, 18 insertions(+), 32 deletions(-)

commit 7634604962fbe85053e628c6742a104b4acdbb90
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Mar 11 12:12:02 2016 -0800

    Initialize libs/os in libs/testutil's tu_init().
    
    This is necessary for unit tests that run in sim and which don't explicitly
    initialize the OS.  The set of blocked signals needs to be initialized before
    any OS functions are called.  os_init() initializes the signal set.
    
    X-Original-Commit: f51c77b08e56a6798c336424ce73d7cee2e6ce02

 nimble/host/src/test/ble_hs_test_util.c | 2 ++
 nimble/host/src/test/ble_os_test.c      | 6 ------
 2 files changed, 2 insertions(+), 6 deletions(-)

commit 6c5a0a7d2aff61f02c14fe1bb1679d7499f7dea8
Author: ccollins at iori.nightmare.heaven <ccollins@iori.nightmare-heaven.no-ip.biz>
Date:   Wed Mar 9 09:57:25 2016 -0800

    Undef byte swapping macros that exist in some envs.
    
    This allows the nimble unit tests to compile in sim on my linux machine.
    
    X-Original-Commit: 05ce86e74ca37058c2cdc9f70e2a1f57f1b0f2ca

 nimble/include/nimble/ble.h | 6 ++++++
 1 file changed, 6 insertions(+)

commit 5ae26cbb6dd7c7ebf385046237b3f2930fc1f77b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Mar 9 18:40:21 2016 -0800

    Capitalize unit test feature names.
    
    test -> TEST
    selftest -> SELFTEST
    
    It seems the convention is to use all caps for feature names.  These two
    were the only two features that didn't follow that convention.
    
    Also, the SELFTEST feature now adds this cflag: -DMYNEWT_SELFTEST
    
    It used to be: -DPKG_TEST.
    
    X-Original-Commit: 36afc70c580bbe2c71c4d21bb6cc39c0a82fb72c

 nimble/host/pkg.yml                | 6 +++---
 nimble/host/src/test/ble_hs_test.c | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit e6cb2c9ad2777dee34e17729ad78578ae6efee8c
Author: wes3 <will@micosa.io>
Date:   Wed Mar 9 15:50:46 2016 -0800

    MYNEWT-84: extend connection events beyond originally scheduled connection event
    
    X-Original-Commit: 4d1854dca59a5ceb3b03ef6da159876c1d2f568c

 nimble/controller/include/controller/ble_ll_conn.h |   1 +
 .../controller/include/controller/ble_ll_sched.h   |  19 +++
 nimble/controller/src/ble_ll_conn.c                | 181 +++++++++++++++------
 nimble/controller/src/ble_ll_ctrl.c                |   3 -
 nimble/controller/src/ble_ll_sched.c               |  53 +++++-
 nimble/drivers/nrf52/src/ble_phy.c                 |   4 +-
 6 files changed, 201 insertions(+), 60 deletions(-)

commit 6f6070de6c41ff11ddad5a534706ad364a0256f8
Author: Marko Kiiskila <marko@runtime.io>
Date:   Wed Mar 9 12:24:07 2016 -0800

    Reflect repository name change in yml files.
    Types in packages.
    Move projects -> apps.
    
    X-Original-Commit: a601f78b38a1974979ede2fb843b2d60eeda01c9

 nimble/controller/pkg.yml     | 4 ++--
 nimble/drivers/native/pkg.yml | 4 ++--
 nimble/drivers/nrf51/pkg.yml  | 4 ++--
 nimble/drivers/nrf52/pkg.yml  | 4 ++--
 nimble/host/pkg.yml           | 4 ++--
 nimble/pkg.yml                | 2 +-
 6 files changed, 11 insertions(+), 11 deletions(-)

commit 16499d4d0675f7ff7600d9c14573fa4036aa5be3
Author: ccollins at iori.nightmare.heaven <ccollins@iori.nightmare-heaven.no-ip.biz>
Date:   Wed Mar 9 09:57:25 2016 -0800

    Undef byte swapping macros that exist in some envs.
    
    This allows the nimble unit tests to compile in sim on my linux machine.
    
    X-Original-Commit: 849ca1da91eadc739c845b00f329ce4ad8ab6e97

 nimble/include/nimble/ble.h | 6 ++++++
 1 file changed, 6 insertions(+)

commit 0ebdc0a1d60a222d3f1cad136caeeee7c50283d2
Merge: 52a721bc c8ab02b3
Author: aditihilbert <aditi@runtime.io>
Date:   Fri Mar 4 15:06:42 2016 -0800

    Merge branch 'MYNEWT-230' of https://github.com/paulfdietrich/incubator-mynewt-larva into develop
    
    This closes #10.
    
    X-Original-Commit: 22c393a405e9d6f95bf2b1de359b0b70bf4c89c9

commit 52a721bc18c4d280211b87073755245b8a31bc25
Merge: 4df19d10 9b9c0741
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Mar 3 16:39:20 2016 -0800

    Merge remote-tracking branch 'origin/develop'
    
    X-Original-Commit: db0e97b1e771798f23c0c2651621486b20c939a5

commit c8ab02b3ad57a5002644c6e6561f7d8f2cdb94fe
Author: wes3 <will@micosa.io>
Date:   Thu Mar 3 16:32:59 2016 -0800

    MYNEWT-95: fix whitelist enable/disable in the controller code.
    
    X-Original-Commit: 8b94064d7e45e7bc9336a8c25f3df6fdf96d553c

 nimble/controller/src/ble_ll_adv.c  | 18 +++++++-----------
 nimble/controller/src/ble_ll_conn.c |  3 +++
 nimble/controller/src/ble_ll_scan.c | 17 +++++++----------
 3 files changed, 17 insertions(+), 21 deletions(-)

commit 9b9c07412a161cc0bada72b2ff11f82f842f58a5
Author: wes3 <will@micosa.io>
Date:   Wed Mar 2 11:57:17 2016 -0800

    MYNEWT-188: controller code now uses correct mbuf API to free a mbuf chain.
    
    X-Original-Commit: cdf3a77779540cb52bea1049f81195542bf2f559

 nimble/controller/src/ble_ll.c           | 12 ++++++------
 nimble/controller/src/ble_ll_adv.c       |  4 ++--
 nimble/controller/src/ble_ll_conn.c      | 14 +++++++-------
 nimble/controller/src/ble_ll_conn_priv.h |  2 +-
 nimble/controller/src/ble_ll_ctrl.c      |  4 ++--
 nimble/controller/src/ble_ll_scan.c      |  2 +-
 6 files changed, 19 insertions(+), 19 deletions(-)

commit 8065b7a8808cc93a2c128a47f10b6c4a3c165383
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 24 14:58:09 2016 -0800

    (MYNEWT-43) Update pkg.yml versions to 0.8.0.
    
    X-Original-Commit: e6eafcfd3cdc4a6ad5a188e064b9611099e72a46

 nimble/controller/pkg.yml     | 2 +-
 nimble/drivers/native/pkg.yml | 2 +-
 nimble/drivers/nrf51/pkg.yml  | 2 +-
 nimble/drivers/nrf52/pkg.yml  | 2 +-
 nimble/host/pkg.yml           | 2 +-
 nimble/pkg.yml                | 2 +-
 6 files changed, 6 insertions(+), 6 deletions(-)

commit ca3e48296bce17f0dd855d59b92cef60727ec15c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 24 14:57:20 2016 -0800

    (MYNEWT-43) Add missing fields to egg.yml files.
    
    X-Original-Commit: 2a2ae75cdfd88e126e65f81a4ad5115ccfebc391

 nimble/controller/pkg.yml     | 8 ++++++++
 nimble/drivers/native/pkg.yml | 8 ++++++++
 nimble/drivers/nrf51/pkg.yml  | 8 ++++++++
 nimble/drivers/nrf52/pkg.yml  | 8 ++++++++
 nimble/host/pkg.yml           | 8 ++++++++
 nimble/pkg.yml                | 8 ++++++++
 6 files changed, 48 insertions(+)

commit 88b89990ccbc9468930fba6bf5cd339b331b5b57
Author: wes3 <will@micosa.io>
Date:   Wed Feb 24 12:23:22 2016 -0800

    MYNEWT-111:support random static addresses
    
    X-Original-Commit: 555578380fefe40dca02a6e124a86d85a27ef1c0

 nimble/controller/src/ble_ll.c          |  3 +++
 nimble/controller/src/ble_ll_adv.c      | 35 +++++++++++++++++++--------------
 nimble/controller/src/ble_ll_conn.c     |  7 +++----
 nimble/controller/src/ble_ll_conn_hci.c | 11 +++++++++++
 nimble/controller/src/ble_ll_scan.c     | 16 ++++++---------
 nimble/host/src/host_hci_cmd.c          |  3 +--
 6 files changed, 44 insertions(+), 31 deletions(-)

commit b2e1409aef3ba9f88be8dbf3d0e24bfa01bd3849
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 23 12:39:44 2016 -0800

    (MYNEWT-127) - Fix ble_gap stat names.
    
    X-Original-Commit: b28b84cdba1fa5e9ccd04e3e1d2ef79902f2f4be

 nimble/host/src/ble_gap.c | 2 ++
 1 file changed, 2 insertions(+)

commit 064ea4b45f3e9e7f5c932eb6974d3b1930d70733
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 23 12:31:15 2016 -0800

    (MYNEWT-127) - rsp. data unit tests.
    
    X-Original-Commit: 0861b893c9377af353db5bd0a96cff258de859d3

 nimble/host/src/test/ble_hs_adv_test.c  | 899 +++++++++++++++++++++++++++-----
 nimble/host/src/test/ble_hs_test_util.c |  34 +-
 nimble/host/src/test/ble_hs_test_util.h |   2 +-
 3 files changed, 797 insertions(+), 138 deletions(-)

commit 6384e538c5d8fefa8276d09cc41141b1749bf4ea
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 23 11:53:17 2016 -0800

    (MYNEWT-127) - Expose scan response data.
    
    X-Original-Commit: 9a91c32bc1997cb9f6922ddfac52f52bc0e64581

 nimble/host/include/host/ble_gap.h |  1 +
 nimble/host/src/ble_gap.c          | 45 ++++++++++++++++++++++++++++++--------
 nimble/host/src/ble_gap_priv.h     |  6 +++--
 3 files changed, 41 insertions(+), 11 deletions(-)

commit 4df19d10be83ee149c00c1e9ff631596450aee5e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 22 13:42:39 2016 -0800

    Delete redundant .gitignore files.
    
    X-Original-Commit: e3d77fc9b869bec964d8788587051d5e5fd60de3

 nimble/.gitignore | 3 ---
 1 file changed, 3 deletions(-)

commit 6fd189eb79cbf390b7fb7ff2aba5b5ae0ce36464
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 22 11:15:23 2016 -0800

    Add missing Apache license to some files.
    
    X-Original-Commit: 50afb3a311d979bd1ea7df5bc4bc53f5124e1e8e

 nimble/README.md | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit cf4d09f6e80ffb82e993024587ec21dfafe296b6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 19 18:52:42 2016 -0800

    (MYNEWT-70) Add some GATT client logging.
    
    X-Original-Commit: 90380ae58394140375bb6d9f4435fddc4dca3008

 nimble/host/src/ble_gattc.c | 238 ++++++++++++++++++++++++++++++++++++++++++--
 1 file changed, 230 insertions(+), 8 deletions(-)

commit d5080377a6c3babcf8b618097a45f67f71c7998b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 19 14:47:41 2016 -0800

    (MYNEWT-69) More GAP stats.
    
    X-Original-Commit: 950e2246736ad20bee430f75f8ead5c4f176b0ef

 nimble/host/include/host/ble_gap.h  |   8 +--
 nimble/host/src/ble_gap.c           | 131 +++++++++++++++++-------------------
 nimble/host/src/ble_gap_priv.h      |   2 +-
 nimble/host/src/test/ble_gap_test.c |  19 +++---
 4 files changed, 77 insertions(+), 83 deletions(-)

commit 0c779163485a65beae60e8b7f1419d3843106dbb
Author: Sterling Hughes <sterling@apache.org>
Date:   Thu Feb 18 15:43:36 2016 -0800

    update for a 0.8.0 release
    
    X-Original-Commit: f2ef9f302e7372e92759abe729ec46abb83c8561

 nimble/controller/pkg.yml     | 2 +-
 nimble/drivers/native/pkg.yml | 2 +-
 nimble/drivers/nrf51/pkg.yml  | 2 +-
 nimble/drivers/nrf52/pkg.yml  | 2 +-
 nimble/host/pkg.yml           | 2 +-
 nimble/pkg.yml                | 2 +-
 6 files changed, 6 insertions(+), 6 deletions(-)

commit ad22fff7e348533ce9788d16e135a27a99025ec7
Author: Sterling Hughes <sterling@apache.org>
Date:   Thu Feb 18 15:33:31 2016 -0800

    add ASF license header
    
    X-Original-Commit: c659f5e61ab26d6bea8cd1d01cd897f10e0be3b5

 nimble/include/nimble/nimble_opt_auto.h | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit e50fad5720befc9fd154c73cf3e4178f5a46a429
Author: wes3 <will@micosa.io>
Date:   Thu Feb 18 09:56:30 2016 -0800

    MYNEWT-40: first cut at adding ble controller link layer statistics. There are two groups as of now: ble_ll and ble_ll_conn. I dont think this will be the final arrangement as some of the stats may move from ble_ll to ble_ll_conn
    
    X-Original-Commit: 598b6293101bb6163d2eabd5ff379c6f8a94bd5b

 nimble/controller/include/controller/ble_ll.h      |  69 ++++---
 nimble/controller/include/controller/ble_ll_ctrl.h |   2 +-
 nimble/controller/pkg.yml                          |   1 +
 nimble/controller/src/ble_ll.c                     | 130 ++++++++++----
 nimble/controller/src/ble_ll_adv.c                 |  31 +---
 nimble/controller/src/ble_ll_conn.c                | 198 +++++++++++++--------
 nimble/controller/src/ble_ll_ctrl.c                |   7 +-
 nimble/controller/src/ble_ll_hci.c                 |   6 +-
 nimble/controller/src/ble_ll_scan.c                |  22 +--
 nimble/controller/src/ble_ll_sched.c               |   4 +-
 10 files changed, 268 insertions(+), 202 deletions(-)

commit 7035c09e815de000e7782a6504533fe24499d301
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 20:59:57 2016 -0800

    (MYNEWT-69) BLE Host - Add some GAP fail stats.
    
    X-Original-Commit: e51ff900ed05d763d6f9a664d27060230cd9e6e6

 nimble/host/src/ble_gap.c      | 191 +++++++++++++++++++++++++++--------------
 nimble/host/src/ble_gap_priv.h |  13 ++-
 2 files changed, 137 insertions(+), 67 deletions(-)

commit 1e4c89d02755aaca714a269bf165bb1d98dedafe
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 20:09:50 2016 -0800

    (MYNEWT-70) BLE Host - Some GAP logging.
    
    X-Original-Commit: 9cc97ed7ca3c2003a4f7df4c33b5b311f127b88f

 nimble/host/src/ble_gap.c      | 191 ++++++++++++++++++++++++++++++++---------
 nimble/host/src/ble_gap_priv.h |  32 +++----
 nimble/host/src/ble_hs_priv.h  |   5 ++
 3 files changed, 170 insertions(+), 58 deletions(-)

commit 6d03aee325320d45b48361691a142c3e45688821
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 18:40:59 2016 -0800

    (MYNEWT-69) BLE Host - Missing l2cap stat names.
    
    X-Original-Commit: 4e42804fd9bba6f084ce205d9218dc1674acaeb3

 nimble/host/src/ble_l2cap.c | 4 ++++
 1 file changed, 4 insertions(+)

commit 28639aea1f739d416d6810db0a1339c7d03dd9b0
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 18:08:23 2016 -0800

    BLE host: Include all priv hdrs from ble_hs_priv.h
    
    X-Original-Commit: 6416839172c19fa101e69d7b8b5dbdebad589492

 nimble/host/src/ble_att.c                    |  4 ----
 nimble/host/src/ble_att_clt.c                |  4 ----
 nimble/host/src/ble_att_cmd.c                |  3 +--
 nimble/host/src/ble_att_svr.c                |  5 -----
 nimble/host/src/ble_fsm.c                    |  1 -
 nimble/host/src/ble_gap.c                    |  6 ------
 nimble/host/src/ble_gattc.c                  |  7 +------
 nimble/host/src/ble_gatts.c                  |  3 ---
 nimble/host/src/ble_hci_sched.c              |  1 -
 nimble/host/src/ble_hs.c                     |  6 ------
 nimble/host/src/ble_hs_adv.c                 |  1 -
 nimble/host/src/ble_hs_conn.c                |  6 ------
 nimble/host/src/ble_hs_conn.h                |  4 +---
 nimble/host/src/ble_hs_misc.c                |  3 ---
 nimble/host/src/ble_hs_priv.h                | 12 ++++++++++++
 nimble/host/src/ble_hs_startup.c             |  3 +--
 nimble/host/src/ble_l2cap.c                  |  4 +---
 nimble/host/src/ble_l2cap_sig.c              |  7 -------
 nimble/host/src/ble_l2cap_sig_cmd.c          |  3 ---
 nimble/host/src/ble_l2cap_sm.c               |  6 ------
 nimble/host/src/host_hci.c                   |  5 -----
 nimble/host/src/host_hci_cmd.c               |  5 +----
 nimble/host/src/test/ble_att_clt_test.c      |  4 ----
 nimble/host/src/test/ble_att_svr_test.c      |  7 +------
 nimble/host/src/test/ble_gap_test.c          |  6 ------
 nimble/host/src/test/ble_gatt_conn_test.c    |  3 ---
 nimble/host/src/test/ble_gatt_disc_c_test.c  |  4 ----
 nimble/host/src/test/ble_gatt_disc_d_test.c  |  4 ----
 nimble/host/src/test/ble_gatt_disc_s_test.c  |  3 ---
 nimble/host/src/test/ble_gatt_find_s_test.c  |  4 ----
 nimble/host/src/test/ble_gatt_read_test.c    |  4 ----
 nimble/host/src/test/ble_gatt_write_test.c   |  4 ----
 nimble/host/src/test/ble_gatts_notify_test.c |  4 ----
 nimble/host/src/test/ble_gatts_reg_test.c    |  2 --
 nimble/host/src/test/ble_host_hci_test.c     |  6 ------
 nimble/host/src/test/ble_hs_adv_test.c       |  9 +--------
 nimble/host/src/test/ble_hs_conn_test.c      |  8 +-------
 nimble/host/src/test/ble_hs_test.c           |  2 --
 nimble/host/src/test/ble_hs_test_util.c      |  8 +-------
 nimble/host/src/test/ble_hs_test_util.h      |  1 +
 nimble/host/src/test/ble_l2cap_test.c        |  7 +------
 nimble/host/src/test/ble_os_test.c           |  3 ---
 42 files changed, 24 insertions(+), 168 deletions(-)

commit 676f540ef95d1c8771d1c740c329f900f028e8cf
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 17:43:52 2016 -0800

    (MYNEWT-69) L2CAP stats.
    
    X-Original-Commit: f545e88266800065db9ff6ed2c2af5f1e8dfeba9

 nimble/host/src/ble_gatt_priv.h     |   1 +
 nimble/host/src/ble_gattc.c         |   1 +
 nimble/host/src/ble_hs.c            |   3 -
 nimble/host/src/ble_hs_conn.c       |  25 +++++++++
 nimble/host/src/ble_hs_conn.h       |   5 +-
 nimble/host/src/ble_hs_priv.h       |   2 -
 nimble/host/src/ble_l2cap.c         |  22 +++++++-
 nimble/host/src/ble_l2cap_priv.h    |  25 ++++++---
 nimble/host/src/ble_l2cap_sig.c     | 109 +++++++++++++++++-------------------
 nimble/host/src/ble_l2cap_sig_cmd.c |  43 ++++++++++----
 nimble/host/src/ble_l2cap_sm.c      |  53 +++++++++++-------
 11 files changed, 183 insertions(+), 106 deletions(-)

commit f84d037a95799ba96ca1e2aa5dda912db9418b90
Author: wes3 <will@micosa.io>
Date:   Wed Feb 17 16:34:25 2016 -0800

    MYNEWT-87: add channel map update procedure. This also fixes a big in the data channel selection index code that was not picking the correct channels if any channels were masked out
    
    X-Original-Commit: 9e54d5f5e076b6f39f6babc11aa20988c45c6455

 nimble/controller/include/controller/ble_ll.h      |   2 +-
 nimble/controller/include/controller/ble_ll_conn.h |   5 +-
 nimble/controller/src/ble_ll.c                     |   1 -
 nimble/controller/src/ble_ll_conn.c                | 104 ++++++++++++----
 nimble/controller/src/ble_ll_conn_hci.c            |  75 ++++++++++-
 nimble/controller/src/ble_ll_conn_priv.h           |  23 +++-
 nimble/controller/src/ble_ll_ctrl.c                |  92 +++++++++++---
 nimble/controller/src/ble_ll_hci.c                 | 137 ++++++++++-----------
 nimble/host/include/host/host_hci.h                |   2 +
 nimble/host/src/host_dbg.c                         |  11 ++
 nimble/host/src/host_hci_cmd.c                     |  36 ++++++
 nimble/include/nimble/hci_common.h                 |  15 +++
 nimble/src/hci_common.c                            |  80 ++++++++++++
 13 files changed, 467 insertions(+), 116 deletions(-)

commit 05b3ccff03b1f74bf737a577ef7bbf6d9d175f9c
Author: wes3 <will@micosa.io>
Date:   Mon Feb 15 13:34:28 2016 -0800

    Fix bug in PHY where it could overwrite the end of a mbuf. Remove global API to retrieve a ble mbuf
    
    X-Original-Commit: cf93bdc676779d5878248c53906e8f205e6639b5

 nimble/controller/src/ble_ll_adv.c  |  6 ++++--
 nimble/controller/src/ble_ll_conn.c |  4 ++--
 nimble/controller/src/ble_ll_scan.c |  3 ++-
 nimble/drivers/native/src/ble_phy.c |  2 +-
 nimble/drivers/nrf51/src/ble_phy.c  |  2 +-
 nimble/drivers/nrf52/src/ble_phy.c  |  7 ++++++-
 nimble/include/nimble/ble.h         | 21 +++++----------------
 7 files changed, 21 insertions(+), 24 deletions(-)

commit bb7b078c405b95c0be1454028aba8e84309f2822
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 13:10:15 2016 -0800

    (MYNEWT-69) BLE Hosti - att_clt stats.
    
    X-Original-Commit: e422f6143388da8a1f34fd6ab27f8256eb85993c

 nimble/host/src/ble_att.c       |  56 ++++++
 nimble/host/src/ble_att_clt.c   |   6 +
 nimble/host/src/ble_att_svr.c   |  12 +-
 nimble/host/src/ble_gap.c       |  15 +-
 nimble/host/src/ble_gatt_priv.h |  17 ++
 nimble/host/src/ble_gattc.c     | 378 ++++++++++++++++++++++++++--------------
 nimble/host/src/ble_gatts.c     |  12 ++
 nimble/host/src/ble_hs.c        |  21 +++
 nimble/host/src/ble_hs_conn.c   |   4 +
 nimble/host/src/ble_hs_priv.h   |  12 ++
 nimble/host/src/ble_l2cap.c     |   4 +
 nimble/host/src/host_hci.c      |  10 +-
 nimble/host/src/host_hci_cmd.c  |   2 +
 13 files changed, 404 insertions(+), 145 deletions(-)

commit 9a16d9e821218de6a9dc0a8daeac885c7cffe684
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 17 13:00:03 2016 -0800

    BLE host - Don't lock conn list before att tx.
    
    X-Original-Commit: 5bdd4af0ad4a321ff52354d5603cda7d75c54006

 nimble/host/src/ble_att.c               |   14 +-
 nimble/host/src/ble_att_clt.c           | 1002 ++++++++++++++++++++-----------
 nimble/host/src/ble_att_priv.h          |   30 +-
 nimble/host/src/ble_att_svr.c           |   12 +-
 nimble/host/src/ble_gattc.c             |  583 +++++++-----------
 nimble/host/src/ble_hs_misc.c           |   54 ++
 nimble/host/src/ble_hs_priv.h           |    8 +
 nimble/host/src/ble_l2cap_sig.c         |   20 +-
 nimble/host/src/test/ble_att_clt_test.c |   44 +-
 9 files changed, 976 insertions(+), 791 deletions(-)

commit 293249b1a3f900dc369146a53956e322152f9944
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 16 17:22:30 2016 -0800

    (MYNEWT-69) BLE Host - Initial set of statistics
    
    X-Original-Commit: bb97c9c4043e8437b3b9c878562079ecb6ddfdf2

 nimble/host/pkg.yml                     |   1 +
 nimble/host/src/ble_att.c               | 251 +++++++++++++++++++++++++++-
 nimble/host/src/ble_att_priv.h          |  62 ++++++-
 nimble/host/src/ble_att_svr.c           |  89 +++++-----
 nimble/host/src/ble_gap.c               | 133 +++++++++++----
 nimble/host/src/ble_gap_priv.h          |  22 +++
 nimble/host/src/ble_gatt_priv.h         |  36 ++++
 nimble/host/src/ble_gattc.c             |  54 +++++-
 nimble/host/src/ble_gatts.c             | 285 ++++++++++++++++++++------------
 nimble/host/src/ble_hs.c                |  13 +-
 nimble/host/src/ble_hs_priv.h           |   1 +
 nimble/host/src/test/ble_hs_test_util.c |   2 +
 12 files changed, 760 insertions(+), 189 deletions(-)

commit 755c955fd9278fde0f1a456f4b4adce9aba9a1f0
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Feb 13 22:04:09 2016 -0800

    Replace os_mbuf_pullup() calls with BLE hs version
    
    X-Original-Commit: eea6c825e124fbb4e5180378cae5894812c72391

 nimble/host/src/ble_l2cap_sig.c | 25 +++++++++----------------
 nimble/host/src/ble_l2cap_sm.c  |  4 ++--
 2 files changed, 11 insertions(+), 18 deletions(-)

commit 03510d41911c0c4fe7f6a1bc661bf18943ec4951
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Feb 13 21:40:21 2016 -0800

    (MYNEWT-68) BLE Host - mbuf size reqs; att_clt.
    
    X-Original-Commit: 6048c389e007c2c32a783f825c01478ac2785d5b

 nimble/host/src/ble_att_clt.c           | 153 ++++++++++++--------------------
 nimble/host/src/ble_att_svr.c           |  14 +--
 nimble/host/src/ble_hs_misc.c           |  15 ++++
 nimble/host/src/ble_hs_priv.h           |   2 +
 nimble/host/src/test/ble_hs_test_util.c |   5 +-
 5 files changed, 83 insertions(+), 106 deletions(-)

commit ee29720ca122dc7eb4272ead431edd03a3c684da
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 17:54:10 2016 -0800

    (MYNEWT-68) BLE Host - Overly strict mbuf reqs.
    
    att_svr - Nothing looked suspicious here, but I cleaned up the code
    surrounding mbuf operations.
    
    X-Original-Commit: 64ba05b6995fe00ec4a5f1443369a1b3c6c10e10

 nimble/host/src/ble_att.c      |   3 +
 nimble/host/src/ble_att_clt.c  |  77 +++++++++-------
 nimble/host/src/ble_att_priv.h |   2 +
 nimble/host/src/ble_att_svr.c  | 201 +++++++++++++++++++++++++----------------
 4 files changed, 173 insertions(+), 110 deletions(-)

commit 81e18e394cf9cca570646b66042589b31443fe8d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 15:08:37 2016 -0800

    BLE host: Check HCI handle on ack.
    
    This check exposed a blatant bug in our handling of a remote connection
    parameter request event.  The code was immediately transmitting HCI packets in
    the wrong context, rather than reserving HCI tx slots.
    
    X-Original-Commit: 75d5f52e91a0128fdd5b75d6484318b097e145db

 nimble/host/src/ble_gap.c | 122 ++++++++++++++++++++++++++++++++++++----------
 1 file changed, 95 insertions(+), 27 deletions(-)

commit 0ace739e97dca08bd8d36c8bbfee070bba7ae57d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 14:09:24 2016 -0800

    BLE host - only check mutex state if OS started.
    
    X-Original-Commit: fa169d3d2e1354eb527c04f83ff37e9795cb7185

 nimble/host/src/ble_hs_misc.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 0be7c7775868a7e5b442ebfbd389fa68aa91c2fb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 14:06:10 2016 -0800

    BLE host: Unit tests for HCI cancel.
    
    X-Original-Commit: 738750cb707490d6aa3c851b55526ba548d4b21b

 nimble/host/src/ble_hci_sched.c          | 39 ++++++++++++------
 nimble/host/src/ble_hci_sched.h          |  1 +
 nimble/host/src/test/ble_host_hci_test.c | 68 ++++++++++++++++++++++++++++++++
 3 files changed, 96 insertions(+), 12 deletions(-)

commit f02c551cce208181a71323949f4183cbe114fc81
Author: wes3 <will@micosa.io>
Date:   Fri Feb 12 13:44:21 2016 -0800

    If there is no connection handle and a read RSSI command is sent, return the handle and 127 for rssi (which is the number used by the specification to denote the fact that we dont know the RSSI for the connection)
    
    X-Original-Commit: 6f814264c2b09a0c375976cb6bcbda9ef0f6131d

 nimble/controller/src/ble_ll_conn_hci.c | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

commit 0a06294dc48b76bcacf90e4211cfc26c38dadbe4
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 13:40:27 2016 -0800

    BLE host - unset ack callback if HCI tx fails.
    
    X-Original-Commit: 04c5cff1ac5400bf1c3520888774fc279fab7ad2

 nimble/host/src/host_hci_cmd.c | 6 ++++++
 1 file changed, 6 insertions(+)

commit 3b81a8e7fd0f2f1c1d1b0aeb3135fe78eb924a43
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 13:39:55 2016 -0800

    BLE host: Make max HCI slots configurable.
    
    X-Original-Commit: 4990971ceeb4f98e96a61fa7776eeeb6327439ad

 nimble/host/include/host/ble_hs.h |  1 +
 nimble/host/src/ble_hci_sched.c   | 34 +++++++++++++++++-----------------
 nimble/host/src/ble_hs_cfg.c      |  1 +
 3 files changed, 19 insertions(+), 17 deletions(-)

commit 16ab191d4235abf319e793be0833ea51aabbbee5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 13:12:31 2016 -0800

    Remove ble_hci_ack.[ch]; merge into ble_hci_sched.
    
    X-Original-Commit: ef84dcf19317d5c44185bd4b8323e78223acda8c

 nimble/host/src/ble_gap.c               | 36 +++++++++----------
 nimble/host/src/ble_hci_ack.c           | 63 ---------------------------------
 nimble/host/src/ble_hci_ack.h           | 38 --------------------
 nimble/host/src/ble_hci_sched.c         | 42 ++++++++++++++++++----
 nimble/host/src/ble_hci_sched.h         | 11 ++++++
 nimble/host/src/ble_hs.c                |  3 --
 nimble/host/src/ble_hs_startup.c        | 11 +++---
 nimble/host/src/host_hci.c              |  8 ++---
 nimble/host/src/host_hci_cmd.c          |  1 -
 nimble/host/src/test/ble_hs_adv_test.c  |  1 -
 nimble/host/src/test/ble_hs_conn_test.c |  1 -
 nimble/host/src/test/ble_hs_test_util.c |  1 -
 12 files changed, 73 insertions(+), 143 deletions(-)

commit 0996fe2e6124554d41247cacabf8eeb7d04ab4ed
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 12 12:37:17 2016 -0800

    (MYNEWT-64) BLE Host - HCI callback thread-safety.
    
    This is implemented via two changes:
        * Add a ble_hci_sched mutex that gets locked whenever the list of
          HCI tx slots is read or modified.
        * Add a handle per HCI tx slot.  This allows client code to cancel
          an HCI transmission before the tx callback is rendered unusable.
    
    X-Original-Commit: a48970a5cd52ea3302b3c11886d52c4c11bd8a5a

 nimble/host/src/ble_gap.c        |  89 ++++++++----
 nimble/host/src/ble_hci_ack.c    |   2 +-
 nimble/host/src/ble_hci_sched.c  | 285 ++++++++++++++++++++++++++++++++++++---
 nimble/host/src/ble_hci_sched.h  |  10 +-
 nimble/host/src/ble_hs_misc.c    |   2 +
 nimble/host/src/ble_hs_startup.c |   2 +-
 6 files changed, 343 insertions(+), 47 deletions(-)

commit c7715117e346190f00e81b77bfd435e47ed1a18b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Feb 11 19:46:13 2016 -0800

    Separate user-specified options from auto options.
    
    X-Original-Commit: 4adc88c7b2b1e4fcbbc28678e3536465a3c2265e

 nimble/include/nimble/nimble_opt.h      | 71 +------------------------------
 nimble/include/nimble/nimble_opt_auto.h | 75 +++++++++++++++++++++++++++++++++
 2 files changed, 77 insertions(+), 69 deletions(-)

commit 8859be4081a945ef90725b0a81cd37a496769fc3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Feb 11 19:34:47 2016 -0800

    BLE host: hardcode max conns setting in unit tests
    
    X-Original-Commit: 2bb99e08ce5b9156c2a5faafe30329da3d946438

 nimble/host/src/test/ble_hs_test_util.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit eeb6e1f4e2a8cff7807f26aa2e99fa60c4dc036c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Feb 11 19:30:51 2016 -0800

    BLE: Compile-time NIMBLE_OPT_MAX_CONNECTIONS cfg.
    
    X-Original-Commit: dd04f5ecf5ee382199a3db594f68bb3d7c18d1b3

 nimble/controller/src/ble_ll_conn.c | 10 +++++-----
 nimble/host/src/ble_hs_cfg.c        |  2 +-
 nimble/include/nimble/nimble_opt.h  | 15 ++++++++++++---
 3 files changed, 18 insertions(+), 9 deletions(-)

commit ea6f78bdd8cd3dc2e88ef93dbeb828420ff2b8e3
Author: wes3 <will@micosa.io>
Date:   Thu Feb 11 07:17:26 2016 -0800

    Set RSSI in connection state machine when data frame received. Display RSSI for host command complete debug
    
    X-Original-Commit: cfeba8a595803f5b57429342c7c2c04c7cc0b63f

 nimble/controller/src/ble_ll_conn.c |  3 +++
 nimble/host/src/host_dbg.c          | 34 +++++++++++++++++++---------------
 2 files changed, 22 insertions(+), 15 deletions(-)

commit 33afdcc67fafdec0f3c1a23ca2c047d31973a82e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Feb 11 00:09:57 2016 -0800

    Remove some stray whitespace.
    
    X-Original-Commit: 837a6b1f9db5e49d0c5e81b6454fe2857a993cf2

 nimble/host/src/ble_gap.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a1d6b60b900925e6fcdbe62fa5b6f95d1df65fe7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Feb 11 00:08:46 2016 -0800

    Add struct for read-rssi ack parameters.
    
    X-Original-Commit: d8aea1c1c8ae8fc4f0aa14b8a995374087d6671e

 nimble/include/nimble/hci_common.h | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit aa6dbef6cb384b85b723f752694ac8e70dc22701
Author: wes3 <will@micosa.io>
Date:   Wed Feb 10 18:07:55 2016 -0800

    Initial read rssi command implementation. Currently returns unkwown rssi. Committing this so host can test before final implementation
    
    X-Original-Commit: 82ffa6a1de635af529447c28729df92ed3324015

 nimble/controller/include/controller/ble_ll_conn.h |  6 ++++
 nimble/controller/src/ble_ll_conn.c                |  1 +
 nimble/controller/src/ble_ll_conn_hci.c            | 30 ++++++++++++++++
 nimble/controller/src/ble_ll_conn_priv.h           |  2 +-
 nimble/controller/src/ble_ll_hci.c                 | 40 ++++++++++++++++++++++
 5 files changed, 78 insertions(+), 1 deletion(-)

commit e69a2fc410decaf6f740d7335de6e69e43cb9c5e
Author: Sterling Hughes <sterling@apache.org>
Date:   Wed Feb 10 17:27:19 2016 -0800

    rename package.yml to pkg.yml for consistency's sake.
    
    X-Original-Commit: 8ea1cd274aa1f28d1a24b78ec00b7101a70633df

 nimble/pkg.yml | 12 +-----------
 1 file changed, 1 insertion(+), 11 deletions(-)

commit ce00fb83b96102af47c3fb5eb1bfc56a2b880e6a
Author: Sterling Hughes <sterling@apache.org>
Date:   Wed Feb 10 17:42:07 2016 -0800

    rename repository to app, and fix merge conflicts
    
    X-Original-Commit: 3ab7f2e52855fe8ab06e84a862d86e9d5bc9f10a

 nimble/controller/{newt-pkg.yml => pkg.yml}     | 0
 nimble/drivers/native/{newt-pkg.yml => pkg.yml} | 0
 nimble/drivers/nrf51/{newt-pkg.yml => pkg.yml}  | 0
 nimble/drivers/nrf52/{newt-pkg.yml => pkg.yml}  | 0
 4 files changed, 0 insertions(+), 0 deletions(-)

commit c0adc8efa4a1bfbd5471f05e5c7323aa634efeb2
Author: Sterling Hughes <sterling@apache.org>
Date:   Wed Feb 10 17:35:30 2016 -0800

    remove interim egg files
    
    X-Original-Commit: b126dff6c37493b3723813f321dd58fb76260e0d

 nimble/controller/{egg.yml => newt-pkg.yml}     |  8 +++---
 nimble/drivers/native/{egg.yml => newt-pkg.yml} |  8 +++---
 nimble/drivers/nrf51/{egg.yml => newt-pkg.yml}  |  8 +++---
 nimble/drivers/nrf52/{egg.yml => newt-pkg.yml}  |  8 +++---
 nimble/egg.yml                                  | 23 -----------------
 nimble/host/{egg.yml => pkg.yml}                | 14 +++++------
 nimble/pkg.yml                                  | 33 +++++++++++++++++++++++++
 7 files changed, 56 insertions(+), 46 deletions(-)

commit 6e0f1a0b38f5913b0d5bcb3e08041ad407d2cb6e
Author: wes3 <will@micosa.io>
Date:   Wed Feb 10 17:36:30 2016 -0800

    Host HCI command to read RSSI
    
    X-Original-Commit: 545579000c84cf2c7caf4d57e0d33110ea0bad4a

 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/host_hci_cmd.c      | 20 ++++++++++++++++++++
 nimble/include/nimble/hci_common.h  |  3 +++
 3 files changed, 24 insertions(+)

commit 129bf6b115c07c2cc4c2dc006f262f6d0a487777
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 10 17:24:56 2016 -0800

    sys/log - Add nimble-ctrl and nimble-host modules.
    
    X-Original-Commit: a2be6d30d4f1340ff9fdfa549f07b5a2ab72a47e

 nimble/host/src/ble_hs_priv.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit ed10d8f676d96fc1aa5d6b99534ff4ca0eb609c9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 10 16:21:53 2016 -0800

    Integration of generic FSM into l2cap sig.
    
    X-Original-Commit: bc975606733d89d3213d115591ea32592dcb71c0

 nimble/host/src/ble_fsm.c       | 185 +++++++++++++++-
 nimble/host/src/ble_fsm_priv.h  |  18 +-
 nimble/host/src/ble_gattc.c     | 354 +++++++++++++++---------------
 nimble/host/src/ble_l2cap_sig.c | 464 +++++++++++-----------------------------
 4 files changed, 493 insertions(+), 528 deletions(-)

commit 4f06bf4dd07a3b860d66f2ea5898a90289b120be
Author: wes3 <will@micosa.io>
Date:   Tue Feb 9 23:12:26 2016 -0800

    Remove scanning events from the scheduler as the code was just too ugly. Scanning is started/stopped from link layer task
    
    X-Original-Commit: 425a9254eb3b860cd5239bb8f616f89dff214864

 nimble/controller/include/controller/ble_ll_scan.h |   4 +-
 .../controller/include/controller/ble_ll_sched.h   |   3 -
 nimble/controller/src/ble_ll_scan.c                | 269 +++++++++------------
 nimble/controller/src/ble_ll_sched.c               | 259 +++++---------------
 4 files changed, 178 insertions(+), 357 deletions(-)

commit 04ea05dd710b47dc0da7d7e8a20af77daab4731d
Author: wes3 <will@micosa.io>
Date:   Tue Feb 9 23:11:37 2016 -0800

    Advertising packets within an advertising event are now transmitted as fast as possible. We no longer put 10msecs between each transmission. This is not configurable
    
    X-Original-Commit: 8a8b601da7b7c9f42cc9b698e274cd73552bc344

 nimble/controller/src/ble_ll_adv.c | 104 ++++++++++++++++---------------------
 1 file changed, 46 insertions(+), 58 deletions(-)

commit d2b5cfd5454ad0e44661cf0a865aca24b7f20c7e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 9 21:02:18 2016 -0800

    ble host - generic fsm implementation.
    
    There was a lot of duplicated code among the GATT client, L2CAP signal, and
    L2CAP security manager.  This is a generic FSM implementation that they can all
    use.  Only gattc uses it at the moment.
    
    Still to do:
        * Switch L2CAP sig and L2CAP sm over.
        * Add generic proc extraction (lock mutex, remove all matching procs and
          insert them into a temporary list, unlock mutex).
    
    X-Original-Commit: e0ed9abc1be34d50e2df6469d622618f979483a3

 nimble/host/src/ble_fsm.c      | 360 +++++++++++++++++++++++++++
 nimble/host/src/ble_fsm_priv.h |  76 ++++++
 nimble/host/src/ble_gattc.c    | 545 +++++++++++------------------------------
 3 files changed, 575 insertions(+), 406 deletions(-)

commit 71a91bd134ef0169aede5385e7d55f233a02885a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 9 19:06:25 2016 -0800

    Stub security manager implementation.
    
    Right now we just respond to paring requests with a "pairing not
    supported" error response.
    
    X-Original-Commit: 3ad18b7f633833e8214947d66ea9354663099258

 nimble/host/include/host/ble_hs.h    |   1 +
 nimble/host/include/host/ble_l2cap.h |  15 +++
 nimble/host/src/ble_hs_conn.c        |  12 ++-
 nimble/host/src/ble_l2cap.c          |   2 +
 nimble/host/src/ble_l2cap_priv.h     |   1 +
 nimble/host/src/ble_l2cap_sm.c       | 202 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap_sm.h       |  27 +++++
 7 files changed, 258 insertions(+), 2 deletions(-)

commit 9689b9ced16e312bcbbf6a046386fecbe5355063
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 9 13:06:56 2016 -0800

    Reduce nimble ll RAM usage for low-memory devices.
    
    Specifically:
        * Reduce default max connections to 1 (from 4).
        * Reduce ble_ll stack size to 64 words (from 256 words).
    
    X-Original-Commit: 3485a6a051a12e72b229bae0fb662e44cd0f5ea9

 nimble/controller/src/ble_ll.c      | 2 +-
 nimble/controller/src/ble_ll_conn.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit a3faa33fd5dae20b73494939fc386544c098e3d8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 9 13:05:38 2016 -0800

    Increase ble_hs stack size to allow for logging.
    
    X-Original-Commit: c50e8b8d2fe3dc556f95546270e63303ad055c96

 nimble/host/src/ble_hs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit db8e94dee0f9607e86b84d87300786cd03019806
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 20:19:41 2016 -0800

    Convert nimble host from console_printf to sys/log
    
    X-Original-Commit: edb635795e8d0700fe37b1b74d8332b3f8e13e74

 nimble/host/egg.yml             |   1 +
 nimble/host/src/ble_hs.c        |   7 +++
 nimble/host/src/ble_hs_misc.c   |   6 +-
 nimble/host/src/ble_hs_priv.h   |   5 ++
 nimble/host/src/ble_l2cap_sig.c |   4 +-
 nimble/host/src/host_dbg.c      | 123 ++++++++++++++++++++--------------------
 nimble/host/src/host_hci.c      |  14 ++---
 nimble/host/src/host_hci_cmd.c  |   4 +-
 8 files changed, 90 insertions(+), 74 deletions(-)

commit 80fb86a5ae357d17ffa320abc80c18812f02d84d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 16:08:38 2016 -0800

    Make number of HCI bufs configurable.
    
    X-Original-Commit: f9c49254b88e0a4245f87e73658d3c5a1173c746

 nimble/host/include/host/ble_hs.h |  3 ++
 nimble/host/src/ble_hs.c          | 65 +++++++++++++++++++++++++++------------
 nimble/host/src/ble_hs_cfg.c      |  3 ++
 3 files changed, 51 insertions(+), 20 deletions(-)

commit 228d376164f0fa27a78730fe1751070f913c14b7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 15:50:01 2016 -0800

    Add some configurable settings to L2CAP.
    
    X-Original-Commit: 741edf531cb09b11c962ee076c15f706e6ef4507

 nimble/host/include/host/ble_hs.h | 1 +
 nimble/host/src/ble_hs_cfg.c      | 1 +
 nimble/host/src/ble_l2cap.c       | 6 ++----
 3 files changed, 4 insertions(+), 4 deletions(-)

commit 779492431581e02599530a5457174a059af1fc04
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 14:02:29 2016 -0800

    Ensure no locks when notify procedure calls ATT cb
    
    X-Original-Commit: 7f1e6d4928e7f1d06c75fe5a3369b55ea014123a

 nimble/host/include/host/ble_gatt.h |   2 +-
 nimble/host/src/ble_gattc.c         | 148 +++++++++++++++++++++++++-----------
 nimble/host/src/ble_gatts.c         |   4 +-
 3 files changed, 108 insertions(+), 46 deletions(-)

commit 27b933cb91d72a6344c78ef10c52f5557b63367e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 12:05:09 2016 -0800

    Allow values of 0 in configurable host options.
    
    X-Original-Commit: 774d72818d2dd1684996fbbacd47fca70c4f4cb3

 nimble/host/include/host/ble_hs.h       |  5 ++--
 nimble/host/src/ble_att_svr.c           |  2 +-
 nimble/host/src/ble_hs.c                |  4 +--
 nimble/host/src/ble_hs_cfg.c            | 44 +++++----------------------------
 nimble/host/src/ble_hs_priv.h           |  4 ++-
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 6 files changed, 16 insertions(+), 45 deletions(-)

commit 28a1a54d133c9830cd67efc1b4164554f517a0c8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 11:18:49 2016 -0800

    L2CAP configurability.
    
    X-Original-Commit: 91c2318ead0b87af48773a7ddd74dab026fd3898

 nimble/host/include/host/ble_hs.h |  3 +++
 nimble/host/src/ble_hs_cfg.c      |  7 +++++++
 nimble/host/src/ble_l2cap_sig.c   | 31 ++++++++++++++++---------------
 3 files changed, 26 insertions(+), 15 deletions(-)

commit 3859e7a8fd015eb940c07e30daaf03620c655e44
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 8 11:14:15 2016 -0800

    l2cap_sig thread safety.
    
    X-Original-Commit: 17338b6fa531bdb7d680389dca88eba767790f92

 nimble/host/src/ble_l2cap_priv.h |   1 +
 nimble/host/src/ble_l2cap_sig.c  | 233 ++++++++++++++++++++++++++++++---------
 2 files changed, 183 insertions(+), 51 deletions(-)

commit 704d51c20f0c97474af475c7bec9c596b9bfbb00
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sun Feb 7 23:15:50 2016 -0800

    Fill in some comments.
    
    X-Original-Commit: 7ebc72b2743a680790d57f6e7062cd50f358ec33

 nimble/host/src/ble_l2cap.c     | 18 ++++++++++++------
 nimble/host/src/ble_l2cap_sig.c | 27 +++++++++++++++++----------
 2 files changed, 29 insertions(+), 16 deletions(-)

commit 2e62af2244c5aa4cc394728db5c0ace3a940a8b4
Author: Sterling Hughes <sterling@apache.org>
Date:   Sat Feb 6 15:23:18 2016 -0800

    add license definitions to .yml files
    
    X-Original-Commit: f5641de057e69471f94ef54f96ba3350bfc4a9ac

 nimble/controller/egg.yml     | 19 +++++++++++++++++++
 nimble/drivers/native/egg.yml | 19 +++++++++++++++++++
 nimble/drivers/nrf51/egg.yml  | 19 +++++++++++++++++++
 nimble/drivers/nrf52/egg.yml  | 19 +++++++++++++++++++
 nimble/egg.yml                | 19 +++++++++++++++++++
 nimble/host/egg.yml           | 19 +++++++++++++++++++
 6 files changed, 114 insertions(+)

commit 470d32dc670ba4d606d4e503e984c98be2f1e7bc
Author: Sterling Hughes <sterling@apache.org>
Date:   Sat Feb 6 14:25:21 2016 -0800

    update license header files, continued.
    
    X-Original-Commit: b061d43a6bb7b33787b116cc65c138e55fea2667

 nimble/controller/include/controller/ble_hw.h      | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_ll.h      | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_ll_adv.h  | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_ll_conn.h | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_ll_ctrl.h | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_ll_hci.h  | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_ll_scan.h | 25 ++++++++++++----------
 .../controller/include/controller/ble_ll_sched.h   | 25 ++++++++++++----------
 .../include/controller/ble_ll_whitelist.h          | 25 ++++++++++++----------
 nimble/controller/include/controller/ble_phy.h     | 25 ++++++++++++----------
 nimble/controller/src/ble_ll.c                     | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_adv.c                 | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_conn.c                | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_conn_hci.c            | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_conn_priv.h           | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_ctrl.c                | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_hci.c                 | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_hci_ev.c              | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_scan.c                | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_sched.c               | 25 ++++++++++++----------
 nimble/controller/src/ble_ll_whitelist.c           | 25 ++++++++++++----------
 nimble/drivers/native/src/ble_hw.c                 | 25 ++++++++++++----------
 nimble/drivers/native/src/ble_phy.c                | 25 ++++++++++++----------
 nimble/drivers/nrf51/src/ble_hw.c                  | 25 ++++++++++++----------
 nimble/drivers/nrf51/src/ble_phy.c                 | 25 ++++++++++++----------
 nimble/drivers/nrf52/src/ble_hw.c                  | 25 ++++++++++++----------
 nimble/drivers/nrf52/src/ble_phy.c                 | 25 ++++++++++++----------
 nimble/host/include/host/ble_gap.h                 | 25 ++++++++++++----------
 nimble/host/include/host/ble_hs_test.h             | 25 ++++++++++++----------
 nimble/host/include/host/ble_uuid.h                | 25 ++++++++++++----------
 nimble/host/src/ble_uuid.c                         | 25 ++++++++++++----------
 nimble/host/src/host_dbg.c                         | 25 ++++++++++++----------
 nimble/host/src/host_hci.c                         | 25 ++++++++++++----------
 nimble/host/src/host_hci_cmd.c                     | 25 ++++++++++++----------
 nimble/include/nimble/ble.h                        | 25 ++++++++++++----------
 nimble/include/nimble/hci_common.h                 | 25 ++++++++++++----------
 nimble/include/nimble/hci_transport.h              | 25 ++++++++++++----------
 nimble/src/util.c                                  | 25 ++++++++++++----------
 38 files changed, 532 insertions(+), 418 deletions(-)

commit 6ed33aaffe5dd7efb3420ddac512825a4daa6df5
Author: Sterling Hughes <sterling@apache.org>
Date:   Sat Feb 6 14:15:18 2016 -0800

    replace license headers with ASF license.  first pass.
    
    X-Original-Commit: 415753274b9e8aa564fe3a8e9305f2e4c581b985

 nimble/host/include/host/ble_att.h           | 27 ++++++++++++++------------
 nimble/host/include/host/ble_gatt.h          | 27 ++++++++++++++------------
 nimble/host/include/host/ble_hs.h            | 27 ++++++++++++++------------
 nimble/host/include/host/ble_hs_adv.h        | 27 ++++++++++++++------------
 nimble/host/include/host/ble_l2cap.h         | 27 ++++++++++++++------------
 nimble/host/include/host/host_hci.h          | 27 ++++++++++++++------------
 nimble/host/src/ble_att.c                    | 27 ++++++++++++++------------
 nimble/host/src/ble_att_clt.c                | 27 ++++++++++++++------------
 nimble/host/src/ble_att_cmd.c                | 27 ++++++++++++++------------
 nimble/host/src/ble_att_cmd.h                | 27 ++++++++++++++------------
 nimble/host/src/ble_att_priv.h               | 27 ++++++++++++++------------
 nimble/host/src/ble_att_svr.c                | 27 ++++++++++++++------------
 nimble/host/src/ble_gap.c                    | 27 ++++++++++++++------------
 nimble/host/src/ble_gap_priv.h               | 27 ++++++++++++++------------
 nimble/host/src/ble_gatt_priv.h              | 27 ++++++++++++++------------
 nimble/host/src/ble_gattc.c                  | 29 +++++++++++++++-------------
 nimble/host/src/ble_gatts.c                  | 27 ++++++++++++++------------
 nimble/host/src/ble_hci_ack.c                | 27 ++++++++++++++------------
 nimble/host/src/ble_hci_ack.h                | 27 ++++++++++++++------------
 nimble/host/src/ble_hci_sched.c              | 27 ++++++++++++++------------
 nimble/host/src/ble_hci_sched.h              | 27 ++++++++++++++------------
 nimble/host/src/ble_hs.c                     | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_adv.c                 | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_adv_priv.h            | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_cfg.c                 | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_conn.c                | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_conn.h                | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_misc.c                | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_priv.h                | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_startup.c             | 27 ++++++++++++++------------
 nimble/host/src/ble_hs_startup.h             | 27 ++++++++++++++------------
 nimble/host/src/ble_l2cap.c                  | 27 ++++++++++++++------------
 nimble/host/src/ble_l2cap_priv.h             | 27 ++++++++++++++------------
 nimble/host/src/ble_l2cap_sig.c              | 27 ++++++++++++++------------
 nimble/host/src/ble_l2cap_sig.h              | 27 ++++++++++++++------------
 nimble/host/src/ble_l2cap_sig_cmd.c          | 27 ++++++++++++++------------
 nimble/host/src/host_dbg.h                   | 27 ++++++++++++++------------
 nimble/host/src/test/ble_att_clt_test.c      | 27 ++++++++++++++------------
 nimble/host/src/test/ble_att_svr_test.c      | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gap_test.c          | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_conn_test.c    | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_disc_c_test.c  | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_disc_d_test.c  | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_disc_s_test.c  | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_find_s_test.c  | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_read_test.c    | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatt_write_test.c   | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatts_notify_test.c | 27 ++++++++++++++------------
 nimble/host/src/test/ble_gatts_reg_test.c    | 27 ++++++++++++++------------
 nimble/host/src/test/ble_host_hci_test.c     | 27 ++++++++++++++------------
 nimble/host/src/test/ble_hs_adv_test.c       | 27 ++++++++++++++------------
 nimble/host/src/test/ble_hs_conn_test.c      | 27 ++++++++++++++------------
 nimble/host/src/test/ble_hs_test.c           | 27 ++++++++++++++------------
 nimble/host/src/test/ble_hs_test_util.c      | 27 ++++++++++++++------------
 nimble/host/src/test/ble_hs_test_util.h      | 27 ++++++++++++++------------
 nimble/host/src/test/ble_l2cap_test.c        | 27 ++++++++++++++------------
 nimble/host/src/test/ble_os_test.c           | 27 ++++++++++++++------------
 nimble/host/src/test/ble_uuid_test.c         | 27 ++++++++++++++------------
 nimble/include/nimble/nimble_opt.h           | 27 ++++++++++++++------------
 59 files changed, 886 insertions(+), 709 deletions(-)

commit 9b9a116b2135027f5235fcfe8ed0d5552adf9edf
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 5 17:33:51 2016 -0800

    Add some configurability to the host.
    
    X-Original-Commit: a1e419d0b1bc763a3605a8537a9186b9e5918c43

 nimble/host/include/host/ble_hs.h         |  13 ++
 nimble/host/src/ble_att_clt.c             |  96 +++++++++++
 nimble/host/src/ble_att_priv.h            |   4 +
 nimble/host/src/ble_att_svr.c             | 161 +++++++++++-------
 nimble/host/src/ble_gap.c                 |  97 +++++++++--
 nimble/host/src/ble_gattc.c               | 269 ++++++++++++++++--------------
 nimble/host/src/ble_gatts.c               |  45 +++--
 nimble/host/src/ble_hs.c                  |   4 +-
 nimble/host/src/ble_hs_adv.c              |   8 +
 nimble/host/src/ble_hs_cfg.c              |  57 ++++++-
 nimble/host/src/ble_hs_conn.c             |  48 ++++++
 nimble/host/src/ble_hs_priv.h             |   1 +
 nimble/host/src/test/ble_gatt_read_test.c | 217 ------------------------
 nimble/include/nimble/nimble_opt.h        | 243 +++++++++++++++++++++++++++
 14 files changed, 832 insertions(+), 431 deletions(-)

commit bae3c9c7deabc12cf7755f85639502427b234768
Author: wes3 <will@micosa.io>
Date:   Fri Feb 5 15:03:55 2016 -0800

    The temporary ble ll log should be disabled by default
    
    X-Original-Commit: 4b9be87632b04a067b23d070903f8323237ba681

 nimble/controller/include/controller/ble_ll.h |  2 +-
 nimble/controller/src/ble_ll_ctrl.c           | 28 ++++++++-------------------
 2 files changed, 9 insertions(+), 21 deletions(-)

commit d706794c736db4ff05ebb0a4aaf1a5e4d238bdd7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 5 14:29:26 2016 -0800

    Switch nimble host from private mbuf poool to msys
    
    X-Original-Commit: 336fa55feb68c9dd6e9111c9a4877d3277e0b6b0

 nimble/host/src/ble_att.c               | 21 ---------------------
 nimble/host/src/ble_att_clt.c           |  2 +-
 nimble/host/src/ble_att_priv.h          |  1 -
 nimble/host/src/ble_att_svr.c           | 24 ++++++++++++------------
 nimble/host/src/ble_hs.c                | 25 -------------------------
 nimble/host/src/ble_hs_misc.c           | 21 +++++++++++++++++++++
 nimble/host/src/ble_hs_priv.h           |  2 ++
 nimble/host/src/ble_l2cap_sig_cmd.c     |  6 +++---
 nimble/host/src/test/ble_hs_test_util.c | 31 ++++++++++++++++++++++++++++++-
 nimble/host/src/test/ble_l2cap_test.c   | 10 +++++-----
 10 files changed, 74 insertions(+), 69 deletions(-)

commit 6da810a4ca02b0dc4f46daf2a01aa27e980d51c9
Author: wes3 <will@micosa.io>
Date:   Fri Feb 5 14:09:40 2016 -0800

    We now only need to allocate msys for the nimble ble stack. The BLE stack defines the size of the mbufs needed
    
    X-Original-Commit: 3e50be7e3a3a1047af462342c7ef523f602c5af3

 nimble/include/nimble/ble.h | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit afa41864e388c20e1933785a1e1ebb75b59a0123
Author: wes3 <will@micosa.io>
Date:   Fri Feb 5 13:25:29 2016 -0800

    Modify code to use msys as opposed to mbuf. For now, we define the size of the msys buffer pool in ble.h and that is used by the project to allocate the memory blocks for the block
    
    X-Original-Commit: 4989659ff03f7548f6264259cfb0052c2c23e37a

 nimble/controller/include/controller/ble_ll.h      |  4 +++-
 nimble/controller/include/controller/ble_ll_conn.h |  2 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |  1 +
 nimble/controller/src/ble_ll_conn.c                |  2 +-
 nimble/controller/src/ble_ll_conn_hci.c            |  3 ++-
 nimble/controller/src/ble_ll_ctrl.c                |  5 +++--
 nimble/include/nimble/ble.h                        | 16 +++++++++++-----
 7 files changed, 22 insertions(+), 11 deletions(-)

commit 23dea6efbe860eccf97264f3ec2c109849bbaa4f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Feb 5 12:08:06 2016 -0800

    Rename ble_gap_conn* to ble_gap*.
    
    X-Original-Commit: 6be1192291c692816df9ded81d2f83dda4d864ef

 nimble/host/include/host/ble_gap.h            |   37 +-
 nimble/host/src/{ble_gap_conn.c => ble_gap.c} | 1111 ++++++++++++-------------
 nimble/host/src/ble_gap_priv.h                |   24 +-
 nimble/host/src/ble_gattc.c                   |    2 +-
 nimble/host/src/ble_hs.c                      |    2 +-
 nimble/host/src/ble_l2cap_sig.c               |    8 +-
 nimble/host/src/host_hci.c                    |   10 +-
 nimble/host/src/test/ble_gap_test.c           |  391 +++++----
 nimble/host/src/test/ble_hs_adv_test.c        |    6 +-
 nimble/host/src/test/ble_hs_conn_test.c       |   80 +-
 nimble/host/src/test/ble_hs_test_util.c       |   16 +-
 nimble/host/src/test/ble_l2cap_test.c         |    6 +-
 nimble/host/src/test/ble_os_test.c            |   34 +-
 13 files changed, 856 insertions(+), 871 deletions(-)

commit 7bd735233b7758e4a0193e26a47fc22011ea6bfb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Feb 4 19:01:57 2016 -0800

    GAP thread safty.
    
    X-Original-Commit: 96846eb4024c4106ce8609aa48e50aae7e714a59

 nimble/host/src/ble_gap_conn.c | 948 ++++++++++++++++++++++++++---------------
 nimble/host/src/ble_gap_priv.h |   1 +
 nimble/host/src/ble_hs_misc.c  |   2 +
 3 files changed, 597 insertions(+), 354 deletions(-)

commit 53749fd437c5b3b5bfce8727d757ca8204ae0bd2
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Feb 3 11:19:03 2016 -0800

    Add thread safety to GATT client.
    
    X-Original-Commit: 8edba486e5617c02c7ab4018f20ce1d2d5c1024d

 nimble/host/src/ble_gatt_priv.h    |    3 +
 nimble/host/src/ble_gattc.c        | 1201 +++++++++++++++++++++---------------
 nimble/host/src/ble_hs_conn.c      |    6 +
 nimble/host/src/ble_hs_misc.c      |    9 +
 nimble/host/src/ble_hs_priv.h      |    2 +
 nimble/host/src/test/ble_hs_test.c |    1 +
 6 files changed, 725 insertions(+), 497 deletions(-)

commit ef0c1b9414d35c1ccc3a0ea0692af6a5660c0da6
Author: wes3 <will@micosa.io>
Date:   Wed Feb 3 13:06:33 2016 -0800

    Remove some old todo comments
    
    X-Original-Commit: fec9e23e44dc205a30ff804b28e8e151812b57f4

 nimble/controller/src/ble_ll_conn.c | 26 +++++++++-----------------
 1 file changed, 9 insertions(+), 17 deletions(-)

commit 8a825684a9d7689fbd20bf485a28c2431a7883af
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 2 15:49:52 2016 -0800

    Add some missing copyright headers.
    
    X-Original-Commit: b23605b546ab55e3f0b1ceb9331e1c606712d349

 nimble/host/include/host/ble_l2cap.h | 16 ++++++++++++++++
 nimble/host/src/ble_l2cap_sig_cmd.c  | 16 ++++++++++++++++
 2 files changed, 32 insertions(+)

commit a0de164ad5c085c9d65ea2aeac47b48188413fb9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 2 16:54:27 2016 -0800

    Allow notifications with custom content.
    
    X-Original-Commit: e27b8db28f17ca17b2a74b3f3a54eea35374afef

 nimble/host/include/host/ble_gatt.h |  2 ++
 nimble/host/src/ble_gatt_priv.h     |  1 -
 nimble/host/src/ble_gattc.c         | 22 ++++++++++++++++++++++
 3 files changed, 24 insertions(+), 1 deletion(-)

commit 2eaf35a215fa4bdf284292146330349f4f27ead4
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 2 15:47:18 2016 -0800

    Missing support for server side write-no-rsp!
    
    X-Original-Commit: 053d1859d82647e4613d21f4a264b4f039895075

 nimble/host/src/ble_att.c      |  2 ++
 nimble/host/src/ble_att_priv.h |  1 +
 nimble/host/src/ble_att_svr.c  | 33 +++++++++++++++++++++++++++++++++
 3 files changed, 36 insertions(+)

commit c152a72a1bed4b7881a23a4f3c70fab75e640b2e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 2 13:08:50 2016 -0800

    Remove ATT mutex; list never modified after start.
    
    X-Original-Commit: 7b029d814ec5ec596c38e9b5288918df16a1a555

 nimble/host/src/ble_att_svr.c | 50 +------------------------------------------
 1 file changed, 1 insertion(+), 49 deletions(-)

commit 945502e9dcaeaf27b96b05c48fb6fc7d84d9470d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Feb 2 11:16:38 2016 -0800

    Ensure connection list never locked during att callback.
    
    X-Original-Commit: 4980dba7162c94eb493ba4d2d67bbac9d348af57

 nimble/host/src/ble_att.c      |   26 +
 nimble/host/src/ble_att_priv.h |    3 +-
 nimble/host/src/ble_att_svr.c  | 1457 ++++++++++++++++++++--------------------
 nimble/host/src/ble_gattc.c    |    6 +-
 4 files changed, 747 insertions(+), 745 deletions(-)

commit 339ff1b38ee62e908b4e8ad0ec14b3a103dec2ff
Author: wes3 <will@micosa.io>
Date:   Mon Feb 1 23:20:46 2016 -0800

    consolidate flags in connection state machine to save a little space. Lower number of mbufs and connections.
    
    X-Original-Commit: 5917f1dbe2d4f651a4aa1f44407ebf17b776939b

 nimble/controller/include/controller/ble_ll_conn.h | 35 ++++++++----
 nimble/controller/src/ble_ll_conn.c                | 66 ++++++++++------------
 nimble/controller/src/ble_ll_conn_hci.c            | 10 ++--
 nimble/controller/src/ble_ll_ctrl.c                | 21 +++----
 4 files changed, 69 insertions(+), 63 deletions(-)

commit 828b84953a2f615643e8a2c4dbd167a94d083aee
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Feb 1 11:56:20 2016 -0800

    Protect connection list with a mutex
    
    X-Original-Commit: cf46c07f926c44aebbb3f79fb001af7008cda424

 nimble/host/include/host/ble_gap.h      |    2 +-
 nimble/host/src/ble_att.c               |   60 +-
 nimble/host/src/ble_att_clt.c           |  218 ++++--
 nimble/host/src/ble_att_priv.h          |   87 +--
 nimble/host/src/ble_att_svr.c           |  357 ++++++++--
 nimble/host/src/ble_gap_conn.c          |  710 +++++++++++++------
 nimble/host/src/ble_gap_priv.h          |    2 +-
 nimble/host/src/ble_gatt_priv.h         |   32 +-
 nimble/host/src/ble_gattc.c             | 1141 +++++++++++++++++++------------
 nimble/host/src/ble_gatts.c             |  153 ++++-
 nimble/host/src/ble_hs_adv.c            |    2 +
 nimble/host/src/ble_hs_conn.c           |  126 +++-
 nimble/host/src/ble_hs_conn.h           |    4 +
 nimble/host/src/ble_l2cap.c             |   63 +-
 nimble/host/src/ble_l2cap_priv.h        |    9 +-
 nimble/host/src/ble_l2cap_sig.c         |  249 +++++--
 nimble/host/src/host_hci.c              |   59 +-
 nimble/host/src/test/ble_gap_test.c     |    2 +-
 nimble/host/src/test/ble_hs_test_util.c |   26 +-
 nimble/host/src/test/ble_hs_test_util.h |    3 +
 nimble/host/src/test/ble_l2cap_test.c   |   15 +-
 nimble/host/src/test/ble_os_test.c      |    8 +-
 22 files changed, 2318 insertions(+), 1010 deletions(-)

commit a62da3f6f664297f9ae919e5d1a4148633569f89
Author: wes3 <will@micosa.io>
Date:   Mon Feb 1 13:30:34 2016 -0800

    Use correct macro for nzbss section and add a newline when displaying received packet data on console
    
    X-Original-Commit: b55d138c4dbeb72bc98de5f6f8525db820d64189

 nimble/controller/src/ble_ll.c | 2 +-
 nimble/host/src/ble_hs_misc.c  | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

commit bfd63cf36618e0237540ac7b0df5acab45b9fc96
Author: wes3 <will@micosa.io>
Date:   Sun Jan 31 22:18:00 2016 -0800

    First cut (non-tested) port of nrf52 drivers to nrf51
    
    X-Original-Commit: acee0c38bdba6e89930266fb79a1060fde73a9f3

 nimble/drivers/nrf51/egg.yml       |   6 +
 nimble/drivers/nrf51/src/ble_hw.c  | 159 ++++++++
 nimble/drivers/nrf51/src/ble_phy.c | 728 +++++++++++++++++++++++++++++++++++++
 3 files changed, 893 insertions(+)

commit 02366cc6980a3387224706fb9312db14ea1ffc29
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 29 14:22:48 2016 -0600

    Optimization for processing of multi-entry rsps.
    
    For GATT.
    
    X-Original-Commit: c6d01fdadb0f9338ed84590c88a2421f98b035fd

 nimble/host/src/ble_gattc.c | 28 ++++++++++++++++++++++++++++
 1 file changed, 28 insertions(+)

commit 04d3f087422cc3ff8edd9acdeb837416a06b1710
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 28 14:00:31 2016 -0500

    L2CAP signal channel.
    
    X-Original-Commit: 894a15c30ddb9a37275056c09d3ae4a3184d077f

 nimble/host/include/host/ble_gap.h       |  15 +-
 nimble/host/include/host/ble_hs.h        |   4 +
 nimble/host/include/host/ble_l2cap.h     |  35 ++
 nimble/host/src/ble_att.c                |   2 +-
 nimble/host/src/ble_att_cmd.c            |   2 +-
 nimble/host/src/ble_att_svr.c            |   2 +-
 nimble/host/src/ble_gap_conn.c           |  59 ++-
 nimble/host/src/ble_gap_priv.h           |   3 +
 nimble/host/src/ble_gattc.c              |  54 +--
 nimble/host/src/ble_hs.c                 |  22 +-
 nimble/host/src/ble_hs_conn.c            |   2 +-
 nimble/host/src/ble_hs_conn.h            |   2 +-
 nimble/host/src/ble_hs_misc.c            |  25 ++
 nimble/host/src/ble_hs_priv.h            |   4 +
 nimble/host/src/ble_l2cap.c              |   7 +-
 nimble/host/src/ble_l2cap.h              | 114 -----
 nimble/host/src/ble_l2cap_priv.h         |  44 +-
 nimble/host/src/ble_l2cap_sig.c          | 720 ++++++++++++++++++++++++-------
 nimble/host/src/ble_l2cap_sig_cmd.c      | 277 ++++++++++++
 nimble/host/src/host_hci.c               |  19 +-
 nimble/host/src/host_hci_cmd.c           |   2 +-
 nimble/host/src/test/ble_att_svr_test.c  |   2 +-
 nimble/host/src/test/ble_host_hci_test.c |   2 +-
 nimble/host/src/test/ble_hs_adv_test.c   |   2 +-
 nimble/host/src/test/ble_hs_conn_test.c  |   2 +-
 nimble/host/src/test/ble_hs_test.c       |   2 +-
 nimble/host/src/test/ble_hs_test_util.c  |   3 +-
 nimble/host/src/test/ble_l2cap_test.c    | 561 +++++++++++++++++++-----
 28 files changed, 1537 insertions(+), 451 deletions(-)

commit dff8e13ef75d7f6ae65d942a6ed0793c50ea366e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 27 14:59:10 2016 -0500

    Sort L2CAP channels by channel ID.
    
    X-Original-Commit: f36c612872c03c8f76b847883399010d8fb1e1ce

 nimble/host/src/ble_hs_conn.c         | 68 ++++++++++++++++++++++++++---------
 nimble/host/src/ble_hs_conn.h         |  2 ++
 nimble/host/src/test/ble_l2cap_test.c |  2 +-
 3 files changed, 55 insertions(+), 17 deletions(-)

commit d03e12796596bc592461e80da8a0ee4b90018629
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 27 18:12:31 2016 -0500

    Last service should indicate end handle=0xffff
    
    This is an optimization that others seem to do.  By indicating that the
    final service ends at 0xffff, it saves the client from needing to send a
    follow-up request to find out that there are no undiscovered services.
    
    X-Original-Commit: 1afa1dac46b383088dc700ec0cacd4c9ba75b00f

 nimble/host/src/ble_att_svr.c           |  9 +++++++++
 nimble/host/src/test/ble_att_svr_test.c | 14 ++++++++++----
 2 files changed, 19 insertions(+), 4 deletions(-)

commit d54c1e3b9a667e6ed2affdb79a365ee8af818ef9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 27 14:48:51 2016 -0500

    Set preferred ATT MTU to 240 at startup.
    
    X-Original-Commit: 053f7fa2327db31c471735ed9f3030f3ab64b6f8

 nimble/host/src/ble_att.c               | 2 +-
 nimble/host/src/ble_att_priv.h          | 5 +++--
 nimble/host/src/test/ble_hs_conn_test.c | 6 +++---
 3 files changed, 7 insertions(+), 6 deletions(-)

commit 46c052f880c2f9f9992c86d3695b773a3fe2af5f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 27 12:10:27 2016 -0500

    Add some more connection update unit tests.
    
    X-Original-Commit: 0f06e5f7ad72a5a90c20a9e37770951b4d5ccdd2

 nimble/host/src/test/ble_gap_test.c | 74 +++++++++++++++++++++++++++----------
 1 file changed, 54 insertions(+), 20 deletions(-)

commit d5a34bc9d66004d62bad606c48fff0579b00749c
Author: wes3 <will@micosa.io>
Date:   Wed Jan 27 10:18:06 2016 -0800

    Return all parameters in events even if the status is not success and they may not make sense
    
    X-Original-Commit: 2261599bba5be6507c1a16af6bdc9cc62a876d0e

 nimble/controller/src/ble_ll_conn_hci.c | 18 ++++++++----------
 nimble/controller/src/ble_ll_hci_ev.c   |  8 +++-----
 2 files changed, 11 insertions(+), 15 deletions(-)

commit e6046af1818690c5626bbb92d7305f4ae0a3dfb7
Author: wes3 <will@micosa.io>
Date:   Wed Jan 27 10:14:23 2016 -0800

    First cut at connection parameter request procedure. Major modifications to scheduling code to fix some schedule bugs
    
    X-Original-Commit: d61dbe829f07da74cddb39f7be27a445969a936b

 nimble/controller/include/controller/ble_ll_conn.h |   3 +
 nimble/controller/src/ble_ll.c                     |   4 +-
 nimble/controller/src/ble_ll_conn.c                |  18 ++-
 nimble/controller/src/ble_ll_conn_hci.c            |  12 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   4 +-
 nimble/controller/src/ble_ll_ctrl.c                | 155 ++++++++++++---------
 nimble/controller/src/ble_ll_hci.c                 |   7 +-
 nimble/controller/src/ble_ll_hci_ev.c              |  10 +-
 nimble/controller/src/ble_ll_sched.c               | 105 +++++++-------
 9 files changed, 184 insertions(+), 134 deletions(-)

commit 132f2e184685eed592264cf89522e6f97fb3581b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 26 22:49:37 2016 -0500

    Honor L2CAP connection parameter update requests.
    
    X-Original-Commit: de4f67bc1f4b0af090dbc45f919ddfb785959fb8

 nimble/host/include/host/ble_l2cap.h  |  13 ++
 nimble/host/src/ble_l2cap.h           |  31 +++-
 nimble/host/src/ble_l2cap_priv.h      | 114 +++++++++++++
 nimble/host/src/ble_l2cap_sig.c       | 292 +++++++++++++++++++++++++++++++++-
 nimble/host/src/test/ble_l2cap_test.c |  88 +++++++++-
 5 files changed, 534 insertions(+), 4 deletions(-)

commit 40c7e3d89fe47c206a2bc4ead39a5a702de7b1a9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 27 00:08:30 2016 -0500

    Don't pass garbage arg to callout.
    
    X-Original-Commit: be3cb8bec2f299fd5725ad896dceb8506be75a36

 nimble/host/src/ble_hs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2840c267413315c66abe7ee62a62ae4a80cc1f00
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 26 21:13:15 2016 -0500

    Fix null pointer dereference bug in host.
    
    X-Original-Commit: 6271de76b62c5d192cc5bc825c694c00a2329064

 nimble/host/src/ble_gap_conn.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 9a534d93239c2809c4530f4aaa22d751ae586acb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 26 13:25:32 2016 -0500

    During svc disc, return 16-bit UUIDs if possible.
    
    X-Original-Commit: 5a05e3c8a0377629a593190779fb375fffc36de9

 nimble/host/src/ble_gatts.c | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 2310edc6456be85c9587d9f8e1f4f7c7274b63c0
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 26 13:12:53 2016 -0500

    Fix bug - Long reads caused GATT hang.
    
    X-Original-Commit: 3469733003f947057448800545a420ab0ba94f9f

 nimble/host/src/ble_gattc.c | 4 ++++
 1 file changed, 4 insertions(+)

commit dc0ac3cec710227747cdf068900d64f4c1473125
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 26 13:04:58 2016 -0500

    Remove temporary asserts.
    
    X-Original-Commit: f5640815930e6a61a5b88567267f24c239023598

 nimble/host/src/ble_gatts.c | 3 ---
 1 file changed, 3 deletions(-)

commit 0ffd55c873c8273d0230fb957dd9cabf6e39b38f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 26 13:04:28 2016 -0500

    Write to console on rx of L2CAP sig message.
    
    X-Original-Commit: 1e4b21ed70241ee160a9fe2109d3fa4ef6ae05c9

 nimble/host/src/ble_l2cap_sig.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 26b121b58b77218a693f11ccadc1d368c47c517f
Author: wes3 <will@micosa.io>
Date:   Tue Jan 26 00:47:41 2016 -0800

    Fix bug with remote read version control procedure where control procedure was being erroneously started and timing out
    
    X-Original-Commit: 41991697b791bdb4c9ff3e68282218c4bc41adc2

 nimble/controller/src/ble_ll_ctrl.c | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)

commit b912fc869ecb3c8e77d24422be9ad1cfcf49264a
Author: wes3 <will@micosa.io>
Date:   Mon Jan 25 22:20:08 2016 -0800

    Add local and remote version info commands, events and LL control procedures
    
    X-Original-Commit: 9263db577c210254d638a86ddfbe4628731481f7

 nimble/controller/include/controller/ble_ll.h      |   4 +
 nimble/controller/include/controller/ble_ll_conn.h |   6 +
 nimble/controller/include/controller/ble_ll_ctrl.h |   6 +-
 nimble/controller/src/ble_ll_conn.c                |  12 +-
 nimble/controller/src/ble_ll_conn_hci.c            |  50 +++++++-
 nimble/controller/src/ble_ll_conn_priv.h           |   1 +
 nimble/controller/src/ble_ll_ctrl.c                | 128 ++++++++++++++++-----
 nimble/controller/src/ble_ll_hci.c                 |  11 +-
 nimble/controller/src/ble_ll_hci_ev.c              |  24 +++-
 nimble/host/include/host/host_hci.h                |   1 +
 nimble/host/src/host_dbg.c                         |  18 +++
 nimble/host/src/host_hci_cmd.c                     |  12 ++
 nimble/include/nimble/hci_common.h                 |   6 +-
 13 files changed, 238 insertions(+), 41 deletions(-)

commit 6d9414ffbd6d72d3b0d052c10946f0924ca74eb4
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 25 20:51:23 2016 -0500

    Discard current packet when channel is deleted.
    
    This doesn't matter in our current code, since the only time a channel
    gets deleted is when its connection is destroyed.  However, I am adding
    this now so that I don't introduce a bug when we implement credit-based
    flow control channels.
    
    X-Original-Commit: 6132451df02b36b008c9d4d6cd8eec4afe3d67ae

 nimble/host/src/ble_hs_conn.c | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 361361995b3da9b733e8bda83076612bfd157681
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 25 20:34:45 2016 -0500

    Reassembly of fragmented HCI ACL data.
    
    X-Original-Commit: d52a4534644db6d80f3bc4c5624b2f3ce695138c

 nimble/host/include/host/ble_hs_test.h  |   2 +-
 nimble/host/src/ble_hs.c                |   2 +-
 nimble/host/src/ble_hs_conn.c           |   2 +
 nimble/host/src/ble_hs_conn.h           |   1 +
 nimble/host/src/ble_l2cap.c             | 104 ++++++++++-----
 nimble/host/src/ble_l2cap.h             |   4 +-
 nimble/host/src/test/ble_hs_test.c      |   2 +-
 nimble/host/src/test/ble_hs_test_util.c |   2 +-
 nimble/host/src/test/ble_l2cap_test.c   | 228 +++++++++++++++++++++++++++-----
 9 files changed, 281 insertions(+), 66 deletions(-)

commit 0a98a9ab2b840cb9e38d00d58b98b20d05334132
Author: wes3 <will@micosa.io>
Date:   Mon Jan 25 16:43:54 2016 -0800

    Implement local version info command
    
    X-Original-Commit: 147097ac0059b9cede9d710550c9625f10f00001

 nimble/controller/src/ble_ll_hci.c  | 69 ++++++++++++++++++++++++++++++++++---
 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/host_dbg.c          | 24 ++++++++++---
 nimble/host/src/host_hci_cmd.c      | 10 ++++++
 nimble/include/nimble/hci_common.h  | 38 ++++++++++++++++++++
 5 files changed, 133 insertions(+), 9 deletions(-)

commit 8216a16851cda8246663cc1965c9ac0a485b375b
Author: wes3 <will@micosa.io>
Date:   Mon Jan 25 12:33:37 2016 -0800

    Respond correctly if we receive a LL control request that we dont understand/implement. Also, fix bug where we would not stop our own initiated slave feature req if we received a unknown response from the peer
    
    X-Original-Commit: 0cbef2dde3a363752bfc71e891d449b75d1b6e1e

 nimble/controller/src/ble_ll_ctrl.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 2f201f984d89d3d082bee36f112595e84b839c9f
Author: wes3 <will@micosa.io>
Date:   Mon Jan 25 11:39:47 2016 -0800

    Add handle to debug log
    
    X-Original-Commit: 7a15092e576b878eaa3d2f8026a3bef83dae1393

 nimble/controller/src/ble_ll_conn.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 3f7f976249b18ad2ea40b9dde2569cb14ec1b729
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 25 12:50:04 2016 -0500

    Don't expect 'role' field for failed connections.
    
    X-Original-Commit: c18cb281c173c895858be19fb73f36d5012ee331

 nimble/host/src/ble_gap_conn.c      | 25 +------------
 nimble/host/src/host_hci.c          |  8 ++--
 nimble/host/src/test/ble_gap_test.c | 73 ++++++++++++++++++++++++++++++++++---
 3 files changed, 75 insertions(+), 31 deletions(-)

commit 38826c35ca7b9772fd1d2d517a351c72c59d17af
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 25 11:42:28 2016 -0500

    Allow advertising parameters to be specified.
    
    X-Original-Commit: b93171c837ff430fedafbe2cc7e20a734d4ac17a

 nimble/host/include/host/ble_gap.h      |  2 ++
 nimble/host/src/ble_gap_conn.c          | 33 +++++++++++++++++----------------
 nimble/host/src/test/ble_gap_test.c     | 14 +++++++-------
 nimble/host/src/test/ble_hs_adv_test.c  |  2 +-
 nimble/host/src/test/ble_hs_conn_test.c |  6 +++---
 5 files changed, 30 insertions(+), 27 deletions(-)

commit 3e3744df40b3878cfb79a721679f5561cfe66621
Author: wes3 <will@micosa.io>
Date:   Mon Jan 25 09:29:19 2016 -0800

    Add read remote used features and feature exchange control procedure
    
    X-Original-Commit: 9f7eb9c7858360252ef12df260a59fb8d9612ff1

 nimble/controller/include/controller/ble_ll_conn.h |  1 +
 nimble/controller/include/controller/ble_ll_ctrl.h |  2 +
 nimble/controller/src/ble_ll.c                     |  9 +--
 nimble/controller/src/ble_ll_conn.c                |  5 +-
 nimble/controller/src/ble_ll_conn_hci.c            | 34 ++++++++++
 nimble/controller/src/ble_ll_conn_priv.h           |  1 +
 nimble/controller/src/ble_ll_ctrl.c                | 75 +++++++++++++++++++++-
 nimble/controller/src/ble_ll_hci.c                 | 12 +++-
 nimble/controller/src/ble_ll_hci_ev.c              | 24 ++++++-
 nimble/host/include/host/host_hci.h                |  1 +
 nimble/host/src/host_dbg.c                         | 16 +++++
 nimble/host/src/host_hci_cmd.c                     | 16 +++++
 nimble/include/nimble/hci_common.h                 |  6 ++
 13 files changed, 190 insertions(+), 12 deletions(-)

commit 5f2f2f80e1485c2f15bce08c7f3dd360a47e3b95
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sun Jan 24 22:18:15 2016 -0500

    Connection update unit tests.
    
    X-Original-Commit: 1742527adad48536e5d5a4fd176689058a73cbe4

 nimble/host/include/host/ble_gap.h      |   5 +
 nimble/host/src/ble_gap_conn.c          |  47 ++-
 nimble/host/src/ble_gap_priv.h          |   1 +
 nimble/host/src/test/ble_gap_test.c     | 692 +++++++++++++++++++++++++++++++-
 nimble/host/src/test/ble_hs_test_util.c |   5 +
 5 files changed, 734 insertions(+), 16 deletions(-)

commit 4656361a5042a22d5b0a565665504ae2f3787730
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sun Jan 24 10:19:19 2016 -0800

    Discard cur conn-update upon rx of conn-param-req.
    
    X-Original-Commit: a5cebefcf67a595a7067548497f8f82295c00ec6

 nimble/host/src/ble_gap_conn.c | 64 ++++++++++++++++++++++++------------------
 1 file changed, 37 insertions(+), 27 deletions(-)

commit 761fe35e33fe78dd019ddfd8fe434e89d00374cb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Jan 23 20:48:04 2016 -0800

    Support for more advertisement data fields.
    
    X-Original-Commit: 14ef31cefec1d66dcba37e3aa83960e2a5a67eed

 nimble/host/include/host/ble_hs.h              |  39 ----
 nimble/host/{src => include/host}/ble_hs_adv.h | 121 ++++++++--
 nimble/host/src/ble_gap_conn.c                 |   4 +-
 nimble/host/src/ble_hs_adv.c                   | 275 +++++++++++++++++++++-
 nimble/host/src/ble_hs_adv_priv.h              |  32 +++
 nimble/host/src/host_hci.c                     |   2 +-
 nimble/host/src/test/ble_gap_test.c            |   2 +-
 nimble/host/src/test/ble_hs_adv_test.c         | 302 +++++++++++++++++++++++--
 8 files changed, 702 insertions(+), 75 deletions(-)

commit c2c34912dab3fadb4773a4ae148f55a2c09aee4d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Jan 23 15:54:42 2016 -0800

    Impose maximum ATT MTU of 240.
    
    X-Original-Commit: 044d34ad3bb49bab2dd342e095eb2712aee22aab

 nimble/host/src/ble_att.c      | 3 +++
 nimble/host/src/ble_att_priv.h | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

commit f91fd74ae427ac14ec97ccc5cfe7de4341d870aa
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Jan 23 15:45:10 2016 -0800

    Move some stuff into bssnz (from bss).
    
    X-Original-Commit: b3d21e4b38127a4a9dfaa8adae85806024c12eaa

 nimble/host/src/ble_att_svr.c  | 53 +++++++++++++++++++++---------------------
 nimble/host/src/ble_gap_conn.c | 13 +++--------
 2 files changed, 29 insertions(+), 37 deletions(-)

commit 351dfb09c9c2dd8f8ac35b6184fdf30658c045c6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Jan 23 15:06:57 2016 -0800

    Add additinoal adv field defines.
    
    X-Original-Commit: 67fa51a9b810c83c4818aeb9095196af072ca6bd

 nimble/host/src/ble_hs_adv.h | 27 ++++++++++++++++++++++++++-
 1 file changed, 26 insertions(+), 1 deletion(-)

commit fe3af12c0dd05f190406de328d972bf2591ca18b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Sat Jan 23 14:38:04 2016 -0800

    Fix failing advertisement tests.
    
    X-Original-Commit: a04061fecb625eda18ae2fc95afbabcb4de42f7a

 nimble/host/src/test/ble_hs_adv_test.c | 57 ++++++++++++++--------------------
 1 file changed, 23 insertions(+), 34 deletions(-)

commit db94b126bba3f80491654e88454048011306eda6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 22 19:07:19 2016 -0800

    Fix off-by-one bug in service end handle.
    
    X-Original-Commit: 4bd7f86adbcf940cb143f0191338c1bc3a87cd7b

 nimble/host/src/ble_att_svr.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 2ed3aaae22519f5a2b815cb654c63bb87693598a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 22 17:14:46 2016 -0800

    Move some global data into bss.nz.
    
    X-Original-Commit: 0e04c2a5cc7c73b38ccaebd0ef2fbfec030604b6

 nimble/host/src/ble_att_svr.c |  3 ++-
 nimble/host/src/ble_hs.c      | 10 ++++++----
 2 files changed, 8 insertions(+), 5 deletions(-)

commit b46b291f3d64d5f687da4168b97fab85e82e97b8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 22 17:13:10 2016 -0800

    Allow app to specify conn params.
    
    X-Original-Commit: eafbdeb0a702f4d8d4727375ee079eae88b62bfb

 nimble/host/include/host/ble_gap.h      | 20 ++++++++---
 nimble/host/src/ble_gap_conn.c          | 60 ++++++++++++++++++++++-----------
 nimble/host/src/test/ble_gap_test.c     | 28 +++++++--------
 nimble/host/src/test/ble_hs_conn_test.c |  4 +--
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 nimble/host/src/test/ble_os_test.c      | 11 +++---
 6 files changed, 80 insertions(+), 45 deletions(-)

commit 12f04098eb4eb7af785602317b19c56ecf578e1c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 22 13:09:08 2016 -0800

    Reliable Writes GATT procedure.
    
    X-Original-Commit: 5dd3cc0d6d3917133d84d838706bc3bbc6fe0abb

 nimble/host/include/host/ble_gatt.h        |   7 +
 nimble/host/src/ble_gattc.c                | 273 +++++++++++++++++++++++++++--
 nimble/host/src/test/ble_gatt_write_test.c | 121 +++++++++++++
 3 files changed, 391 insertions(+), 10 deletions(-)

commit 42b9a3089580deff2ae82c376e9d5ab72d8b8033
Author: wes3 <will@micosa.io>
Date:   Fri Jan 22 16:50:27 2016 -0800

    Fix slave latency bug
    
    X-Original-Commit: 1ede1c7dc3310fd37ae563a65c689c701a0cecac

 nimble/controller/src/ble_ll_conn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b40fb209fbad109daaa0b66f780854aa5c3d7756
Author: wes3 <will@micosa.io>
Date:   Fri Jan 22 15:20:17 2016 -0800

    Moved some events to new module since others getting cluttered
    
    X-Original-Commit: 7a82be0e594bc706f195aae15b8e711576adcf99

 nimble/controller/src/ble_ll_hci_ev.c | 106 ++++++++++++++++++++++++++++++++++
 1 file changed, 106 insertions(+)

commit 29f68202486d103839c18a7b6eff14687e514694
Author: wes3 <will@micosa.io>
Date:   Fri Jan 22 15:19:39 2016 -0800

    Connection update procedure implemented. Most of connection parameter request implemented but not final so connection parameter
    
    X-Original-Commit: 262b1be2f72c5e42d254dcc92e62598590988332

 nimble/controller/include/controller/ble_ll_conn.h |  46 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |  24 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   2 +-
 nimble/controller/src/ble_ll.c                     |  14 +-
 nimble/controller/src/ble_ll_adv.c                 |   2 +-
 nimble/controller/src/ble_ll_conn.c                | 127 +++-
 nimble/controller/src/ble_ll_conn_hci.c            | 256 +++++++-
 nimble/controller/src/ble_ll_conn_priv.h           |   4 +
 nimble/controller/src/ble_ll_ctrl.c                | 696 ++++++++++++++++++---
 nimble/controller/src/ble_ll_hci.c                 |  26 +-
 nimble/controller/src/ble_ll_scan.c                | 134 ++--
 11 files changed, 1130 insertions(+), 201 deletions(-)

commit 310a4a7d81ff0877ff89d8326c0abde44e47d156
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 19:15:30 2016 -0800

    Fix some typos.
    
    X-Original-Commit: 48c49b6e500b1927a9acf0df4d377b9c8e5c68d7

 nimble/include/nimble/hci_common.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit e04512e6dd1375b2005bb91345249f0e54f9a5a2
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 19:05:04 2016 -0800

    Allow app to specify scan type,filter policy.
    
    X-Original-Commit: 173a7f30e3055722a4ea46a9e671f64f0415381c

 nimble/host/include/host/ble_gap.h  |  1 +
 nimble/host/src/ble_gap_conn.c      | 68 +++++++++++++++++++++++++++++++------
 nimble/host/src/test/ble_gap_test.c | 14 +++++---
 nimble/host/src/test/ble_os_test.c  |  8 +++--
 4 files changed, 74 insertions(+), 17 deletions(-)

commit 9845b923e87e18761d1130a03f97ac69bb337fc6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 17:51:48 2016 -0800

    Handle Connection Update and Parameter Req events.
    
    X-Original-Commit: ac1c39dc1d0ed40592e2f2ce0dfd32666c5f2e56

 nimble/host/src/ble_gap_conn.c | 10 +++++
 nimble/host/src/ble_gap_priv.h |  2 +
 nimble/host/src/host_hci.c     | 83 ++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 95 insertions(+)

commit 51f9b3d9341c95fa3069e2db9afb153f78688c53
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 16:35:34 2016 -0800

    Rename GATT procedure for consistency.
    
    X-Original-Commit: b9a932fc0c57fc261956968b46ae877e6f0f28ef

 nimble/host/include/host/ble_gatt.h       | 6 +++---
 nimble/host/src/ble_gattc.c               | 6 +++---
 nimble/host/src/test/ble_gatt_read_test.c | 4 ++--
 3 files changed, 8 insertions(+), 8 deletions(-)

commit 9b2f09b2bc604ccc6c03efe95dca221964427dee
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 16:19:55 2016 -0800

    GATT service.
    
    X-Original-Commit: 04087b3e3c67d8cb9e02f8379573ce44f011e8a7

 nimble/host/include/host/ble_gatt.h | 3 +++
 1 file changed, 3 insertions(+)

commit fa18e462ab8afb04f428ccd52d61cbf90b46fb15
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 15:38:07 2016 -0800

    GAP service.
    
    X-Original-Commit: 430030c104c2ed22ab7c6550ca25cdf559b68cdf

 nimble/host/include/host/ble_gap.h | 54 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_gap_conn.c     | 43 ++----------------------------
 nimble/include/nimble/hci_common.h |  1 +
 3 files changed, 57 insertions(+), 41 deletions(-)

commit 2a0c0ab83af1644dd3843f43ff7b94a38f9f0d26
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 15:37:13 2016 -0800

    Make GATT services easier to define.
    
    Terminate arrays with 0 rather than named constants.
    
    X-Original-Commit: 88dc6a6a690bc246ef487f444b2c670c7a2ce441

 nimble/host/include/host/ble_gatt.h          |  2 +-
 nimble/host/src/test/ble_gatts_notify_test.c |  4 +-
 nimble/host/src/test/ble_gatts_reg_test.c    | 70 ++++++++++++----------------
 3 files changed, 33 insertions(+), 43 deletions(-)

commit 66905d61e4a5d04378d2b2ee76bf06c386047cca
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 14:11:56 2016 -0800

    GAP Connection Parameter Update procedure.
    
    Timeouts are not yet implemented.
    
    X-Original-Commit: dd338e9e0de211982fc039a95c5a0cd17be6db15

 nimble/host/include/host/ble_gap.h  |  43 +++-
 nimble/host/include/host/host_hci.h |   2 +
 nimble/host/src/ble_att_priv.h      |   1 +
 nimble/host/src/ble_gap_conn.c      | 397 ++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_gap_priv.h      |   2 +
 nimble/host/src/ble_hs_conn.h       |  10 +
 nimble/host/src/host_hci_cmd.c      |  33 +++
 nimble/host/src/test/ble_gap_test.c |  10 +-
 nimble/host/src/test/ble_os_test.c  |  30 +--
 nimble/include/nimble/hci_common.h  |  51 ++++-
 10 files changed, 528 insertions(+), 51 deletions(-)

commit 3bfd591e4ce44d916586255eb409a06571a5279e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 21 11:31:46 2016 -0800

    Fix GATT MTU exchange procedure.
    
    X-Original-Commit: 0cba42117963d5f8d5197ca8e54a0610f7e3849c

 nimble/host/include/host/ble_att.h |  2 ++
 nimble/host/src/ble_att.c          | 24 +++++++++++++++++++++++-
 nimble/host/src/ble_att_clt.c      |  2 ++
 nimble/host/src/ble_gattc.c        |  5 +++++
 nimble/host/src/ble_hs.c           |  4 +++-
 5 files changed, 35 insertions(+), 2 deletions(-)

commit 12c2f5df682b1944d17400d7535297d7e5d048a3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 20 15:40:38 2016 -0800

    Fix some failing tests.
    
    X-Original-Commit: 9b395cecb68a6042d93e3bb65cd231bca251926c

 nimble/host/src/test/ble_gatt_disc_d_test.c | 72 ++++++++++++++---------------
 nimble/host/src/test/ble_gatts_reg_test.c   |  8 ++--
 2 files changed, 40 insertions(+), 40 deletions(-)

commit f6da73fa5a803fe8b145ab5028be1d848704e9d5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 20 14:22:55 2016 -0800

    Register characteristics with proper ATT perms.
    
    X-Original-Commit: 8e30133a2943835f19656e605a179abde737bd07

 nimble/host/src/ble_gatts.c | 68 ++++++++++++++++++++++++++++++---------------
 1 file changed, 46 insertions(+), 22 deletions(-)

commit bb2d12cde5e1318a16349d68ef9af31d5594da3e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 20 14:21:21 2016 -0800

    Change GATT discover-descriptors interface.
    
    It used to expect the characgteristic value handle; not it takes the
    characteristic definition handle.
    
    X-Original-Commit: 471a6c8b5b508f41e47503aa1dda142b94e80f65

 nimble/host/include/host/ble_gatt.h |  2 +-
 nimble/host/src/ble_gattc.c         | 12 ++++++------
 2 files changed, 7 insertions(+), 7 deletions(-)

commit c1f034df5c6b5acaa62a22384bae7d49e05efbfe
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 20 14:20:05 2016 -0800

    Add function for local attribute write.
    
    X-Original-Commit: fe4756407c986127debe96f691c573c49e1c8df8

 nimble/host/include/host/ble_att.h |  3 +++
 nimble/host/src/ble_att_svr.c      | 22 ++++++++++++++++++++++
 2 files changed, 25 insertions(+)

commit 5a8953a8030df97b1dd943ac838a78a52173ba60
Author: wes3 <will@micosa.io>
Date:   Wed Jan 20 12:39:09 2016 -0800

    Addition of conn update command and debug display of connection update complete event and connection parameter request event
    
    X-Original-Commit: bacf3f12b8e46b026fa54eca0ec447799d734dbd

 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/host_dbg.c          | 42 +++++++++++++++++++++++++++----------
 nimble/host/src/host_hci_cmd.c      | 21 +++++++++++++++++++
 nimble/include/nimble/hci_common.h  | 26 +++++++++++++++++++++--
 4 files changed, 77 insertions(+), 13 deletions(-)

commit 138f030fb84f3d2d9c68bd95f813915b100933d8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 19 14:22:04 2016 -0800

    Fix const correctness issue.
    
    X-Original-Commit: 626adf0e312cafc93a09e35fbdbb631deb34305b

 nimble/host/include/host/ble_gatt.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4eadd5674ea2e37dc4a1a496a88a1c0f168010b6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 18 19:52:59 2016 -0800

    Fix two GATT bugs.
    
    * Always return either BLE_HS_EAGAIN or BLE_HS_EDONE from all GATT
      client kick functions.  Other return codes caused ambiguity for the
      caller.
    
    * Don't set a GATT entry's pending bit until it is entirely filled in.
      Half-filled entries were being processed prematurely when a low
      priority task initiated a GATT procedure.
    
    X-Original-Commit: dc72efa9be41a9cabcce490498f4b954a7f6ae6b

 nimble/host/src/ble_gattc.c | 47 +++++++++++++++++++++++++++++----------------
 1 file changed, 30 insertions(+), 17 deletions(-)

commit dbc39aa37a3c50b3c1797c4a6fa6d84b51a8e5b5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 18 17:28:00 2016 -0800

    Include all public host headers in ble_hs.h
    
    X-Original-Commit: 4fdf587d6b7b46d228df8a92c73c0fcafcdefa4e

 nimble/host/include/host/ble_hs.h   | 6 ++++++
 nimble/host/include/host/ble_uuid.h | 1 +
 2 files changed, 7 insertions(+)

commit e71e0abde457f3bc38cc1ed7b387f3c21ace7dde
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 17:02:21 2016 -0800

    Some miscellaneous renaming.
    
    X-Original-Commit: 9927c14f09e680a42e225e4dd0beea54f2533889

 nimble/host/include/host/ble_gap.h      |  6 ++--
 nimble/host/src/ble_gap_conn.c          | 53 +++++++++++++++++++---------
 nimble/host/src/ble_hs_adv.h            |  1 +
 nimble/host/src/test/ble_gap_test.c     | 26 +++++++-------
 nimble/host/src/test/ble_hs_adv_test.c  | 62 ++++++++++++++++++++++++++++++---
 nimble/host/src/test/ble_hs_conn_test.c |  4 +--
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 nimble/host/src/test/ble_os_test.c      | 11 +++---
 8 files changed, 119 insertions(+), 46 deletions(-)

commit 6a646e60f77b110cb4ef333f659e558649c9cba1
Author: wes3 <will@micosa.io>
Date:   Mon Jan 18 16:14:37 2016 -0800

    Many changes to the scheduler and link layer to allow for scheduling of multiple connections. Also allows concurrent connections and/or advertising and/or scanning and/or initiating state machines
    
    X-Original-Commit: b6e2b5ffa358ad9696f71d30df4f94466f78ae67

 nimble/controller/include/controller/ble_ll.h      |  26 +-
 nimble/controller/include/controller/ble_ll_adv.h  |  13 +-
 nimble/controller/include/controller/ble_ll_conn.h |   8 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   2 +-
 nimble/controller/include/controller/ble_ll_scan.h |  16 +-
 .../controller/include/controller/ble_ll_sched.h   |  47 +-
 nimble/controller/src/ble_ll.c                     | 125 ++--
 nimble/controller/src/ble_ll_adv.c                 | 264 ++++---
 nimble/controller/src/ble_ll_conn.c                | 682 ++++++++++--------
 nimble/controller/src/ble_ll_conn_hci.c            |   4 +-
 nimble/controller/src/ble_ll_conn_priv.h           |  16 +-
 nimble/controller/src/ble_ll_ctrl.c                |   2 +-
 nimble/controller/src/ble_ll_scan.c                | 386 +++++++----
 nimble/controller/src/ble_ll_sched.c               | 770 ++++++++++++++++++---
 nimble/drivers/native/src/ble_phy.c                |   9 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |  21 +-
 nimble/include/nimble/ble.h                        |  26 +-
 17 files changed, 1695 insertions(+), 722 deletions(-)

commit 23b1fa25c76cdd0f3f3a73550e5885ecbe61cc0e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 14:49:23 2016 -0800

    Add 'le read loc supp feat' to startup seq.
    
    X-Original-Commit: 35b6f852aad05ab62229ed5120796a6df9302cb0

 nimble/host/include/host/host_hci.h     |  1 +
 nimble/host/src/ble_hs_startup.c        | 49 ++++++++++++++++++++++++++++++---
 nimble/host/src/host_hci_cmd.c          | 12 ++++++++
 nimble/host/src/test/ble_hs_test_util.c | 10 +++++--
 4 files changed, 65 insertions(+), 7 deletions(-)

commit c58156afbad94863b56feab08b3e8839f32f9401
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 13:46:07 2016 -0800

    Tests for discovery GAP procedures.
    
    X-Original-Commit: 17c32e81511c077bac9878d1bb874fa173edd2bd

 nimble/host/src/ble_gap_conn.c      |   7 +-
 nimble/host/src/test/ble_gap_test.c | 248 +++++++++++++++++++++++++++++++++++-
 2 files changed, 245 insertions(+), 10 deletions(-)

commit c09d11831271c0286152e7c18889dd0a9e2abfad
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 12:48:57 2016 -0800

    Tests for stop-advertise GAP procedure.
    
    X-Original-Commit: a05d1469532d59024372508b11498bacb323caa4

 nimble/host/include/host/ble_gap.h      |  19 +++--
 nimble/host/src/ble_gap_conn.c          |  19 +----
 nimble/host/src/ble_gap_priv.h          |   4 +-
 nimble/host/src/test/ble_gap_test.c     | 132 ++++++++++++++++++++++++++------
 nimble/host/src/test/ble_hs_adv_test.c  |   2 +-
 nimble/host/src/test/ble_hs_conn_test.c |   6 +-
 6 files changed, 128 insertions(+), 54 deletions(-)

commit f335a01694e944e05aafb76cfd8c9b6305e47c15
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 11:54:20 2016 -0800

    Fix bugs found by slave-mode tests.
    
    X-Original-Commit: c1f48b228f38f73aa690abf1131ea8bb749d690a

 nimble/host/src/ble_gap_conn.c | 109 +++++++++++++++++++++++++++--------------
 nimble/host/src/ble_gap_priv.h |   3 ++
 nimble/host/src/ble_hci_ack.h  |   2 +-
 nimble/host/src/host_hci.c     |   2 +-
 4 files changed, 76 insertions(+), 40 deletions(-)

commit 7d4a641dafd7df9b310ca4a460b30e77108f95f5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 11:53:33 2016 -0800

    Add slave-mode unit tests.
    
    X-Original-Commit: 66738fba59b0894999d807200b75d29eb6dfcce0

 nimble/host/src/test/ble_gap_test.c | 336 +++++++++++++++++++++++++++++++++++-
 1 file changed, 328 insertions(+), 8 deletions(-)

commit 07f4c7cd4573afd175592f0aa23fa6b04dbc5b98
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 15 09:42:31 2016 -0800

    Some organization for ble_gap_test.c.
    
    X-Original-Commit: d846e987eefe5917896ec06bcabac8021539b047

 nimble/host/src/test/ble_gap_test.c | 266 ++++++++++++++++++++----------------
 1 file changed, 145 insertions(+), 121 deletions(-)

commit c5f32f8bc49e6ad2f629acb4625def4ecf1811ab
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 14 12:57:17 2016 -0800

    Add GAP callback per-connection, rather than single global.
    
    X-Original-Commit: ce53ccfd60f65d4e0a8bd93d15aef52598bca98e

 nimble/host/include/host/ble_gap.h                 |  75 ++--
 nimble/host/src/ble_gap_conn.c                     | 394 ++++++++++++-------
 nimble/host/src/{ble_gap_conn.h => ble_gap_priv.h} |   1 +
 nimble/host/src/ble_hci_ack.c                      |   2 +-
 nimble/host/src/ble_hs.c                           |   2 +-
 nimble/host/src/ble_hs_adv.h                       |   1 +
 nimble/host/src/ble_hs_conn.h                      |   5 +
 nimble/host/src/host_hci.c                         |   2 +-
 nimble/host/src/test/ble_att_clt_test.c            |   3 +-
 nimble/host/src/test/ble_att_svr_test.c            |   3 +-
 nimble/host/src/test/ble_gap_test.c                | 425 +++++++++++++++++++--
 nimble/host/src/test/ble_gatt_conn_test.c          |  11 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c        |   6 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c        |   3 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c        |   6 +-
 nimble/host/src/test/ble_gatt_find_s_test.c        |  12 +-
 nimble/host/src/test/ble_gatt_read_test.c          |  33 +-
 nimble/host/src/test/ble_gatt_write_test.c         |  12 +-
 nimble/host/src/test/ble_gatts_notify_test.c       |   3 +-
 nimble/host/src/test/ble_hs_adv_test.c             |   5 +-
 nimble/host/src/test/ble_hs_conn_test.c            |  22 +-
 nimble/host/src/test/ble_hs_test_util.c            |   7 +-
 nimble/host/src/test/ble_hs_test_util.h            |   5 +-
 nimble/host/src/test/ble_l2cap_test.c              |   3 +-
 nimble/host/src/test/ble_os_test.c                 |  52 +--
 25 files changed, 801 insertions(+), 292 deletions(-)

commit b2f0f4721cd54447235e5af2a18e35430021869b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 13 18:53:54 2016 -0800

    Separate white list operations from GAP connection operations.
    
    X-Original-Commit: 5187f4aa87ae9d892f3c3050a43f96e00730d5ce

 nimble/host/include/host/ble_gap.h  |  15 +-
 nimble/host/include/host/ble_hs.h   |   1 +
 nimble/host/src/ble_gap_conn.c      | 499 +++++++++++++++++-------------------
 nimble/host/src/test/ble_gap_test.c | 155 ++---------
 4 files changed, 276 insertions(+), 394 deletions(-)

commit 555b0b6b51a6c1cb40fcbee7dd4eecc91897e1bc
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 13 17:30:51 2016 -0800

    Unit tests for Direct Connection Establishment.
    
    X-Original-Commit: a255576b8d55c913361bb3d52e3cd98c5ccec73e

 nimble/host/src/test/ble_gap_test.c | 157 ++++++++++++++++++++++++++++++++----
 1 file changed, 140 insertions(+), 17 deletions(-)

commit f6d917b0fe381b895a373d4e89c46e06c5398f2c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Jan 13 16:39:49 2016 -0800

    Restructure GAP connection code.
    
    X-Original-Commit: 23180020e3ae89f85dc6b9f482e061228e04ed8a

 nimble/host/src/ble_gap_conn.c | 456 ++++++++++++++++++++++++-----------------
 1 file changed, 271 insertions(+), 185 deletions(-)

commit b751b4d42ef2490b5943160463809bd331341652
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 12 19:20:25 2016 -0800

    GAP Auto Connection Establishment procedure.
    
    X-Original-Commit: ca671d23694e97280816b1c97acdeabb20387cfb

 nimble/host/include/host/ble_gap.h        |   7 +
 nimble/host/include/host/ble_hs_test.h    |   1 +
 nimble/host/src/ble_gap_conn.c            | 290 +++++++++++++++++++++++++++---
 nimble/host/src/test/ble_gap_test.c       | 284 +++++++++++++++++++++++++++++
 nimble/host/src/test/ble_gatt_read_test.c |  10 +-
 nimble/host/src/test/ble_hs_test.c        |   1 +
 nimble/host/src/test/ble_hs_test_util.c   |  20 +++
 nimble/host/src/test/ble_hs_test_util.h   |   2 +
 8 files changed, 582 insertions(+), 33 deletions(-)

commit 49e5bb6894156908db59b7211ec550e2b375a906
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 12 17:35:55 2016 -0800

    Ensure GATT is notified when there is an ATT error
    
    X-Original-Commit: 40662ac7e553e15b7e3575a6987d381c59f8c74b

 nimble/host/src/ble_att_clt.c   | 53 +++++++++++++++++++++--------------------
 nimble/host/src/ble_gatt_priv.h |  2 +-
 nimble/host/src/ble_gattc.c     |  8 +++----
 3 files changed, 32 insertions(+), 31 deletions(-)

commit 1f0251072fc44c37c7470fbb731a30081a53860d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 12 14:11:09 2016 -0800

    Cleanup and comments for ble_gattc.c
    
    X-Original-Commit: 17ac9193dd4388c5553cadef085fb5b993de59e4

 nimble/host/src/ble_att_clt.c              |    4 +-
 nimble/host/src/ble_gattc.c                | 2398 ++++++++++++++++++----------
 nimble/host/src/test/ble_gatt_write_test.c |    8 +-
 3 files changed, 1580 insertions(+), 830 deletions(-)

commit b10b32c9dd760882272a42ce798bd5b9c4cad27f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 12 13:28:33 2016 -0800

    read (long), write (long) descriptors GATT procs.
    
    X-Original-Commit: 83801d4c9d3f45b112736d065a4f3b901dbfd96f

 nimble/host/include/host/ble_gatt.h       |  15 ++-
 nimble/host/src/ble_gattc.c               |  49 +++++++
 nimble/host/src/test/ble_gatt_read_test.c | 213 ++++++++++++++++++++++++++++++
 3 files changed, 275 insertions(+), 2 deletions(-)

commit 640b21c9aae2b37843cad54b8f8465e9bfcde184
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 19:05:46 2016 -0800

    Unit tests for GATT procedure: write long.
    
    Also associated bug fixes.
    
    X-Original-Commit: 9cf4327a2ddd394a5686011b7d8eb4e2079423ff

 nimble/host/egg.yml                        |   1 +
 nimble/host/include/host/ble_gatt.h        |   2 +-
 nimble/host/include/host/ble_hs.h          |   1 +
 nimble/host/src/ble_gattc.c                | 109 +++++++++-
 nimble/host/src/test/ble_gatt_write_test.c | 308 +++++++++++++++++++++++++++--
 5 files changed, 399 insertions(+), 22 deletions(-)

commit 935ea99491eec8bd5279e937701664ad5359bd79
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 18:42:46 2016 -0800

    ATT prep/exec unit tests.
    
    X-Original-Commit: c37ec7a0c59e7ae439ef2506bcd7496057b4f0bc

 nimble/host/src/ble_att_clt.c           |  12 ++-
 nimble/host/src/test/ble_att_clt_test.c | 164 ++++++++++++++++++++++++++++++++
 2 files changed, 172 insertions(+), 4 deletions(-)

commit e2053748c1acb3b10a37fdc2ce8d2d4455389f41
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 18:08:17 2016 -0800

    ATT client prep/exec ; GATT long write.
    
    X-Original-Commit: de91aec397b0d783b44a52a8e0cee5724a60054f

 nimble/host/include/host/ble_gatt.h |   2 +
 nimble/host/src/ble_att.c           |   2 +
 nimble/host/src/ble_att_clt.c       | 155 +++++++++++++++++++++++++++
 nimble/host/src/ble_att_cmd.h       |   1 +
 nimble/host/src/ble_att_priv.h      |  13 +++
 nimble/host/src/ble_gatt_priv.h     |   5 +
 nimble/host/src/ble_gattc.c         | 207 +++++++++++++++++++++++++++++++++++-
 7 files changed, 383 insertions(+), 2 deletions(-)

commit 99e8112985d4e38525d0465e69d5e9b6f881127b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 16:41:24 2016 -0800

    ATT MTU should be configured independent of GATT.
    
    X-Original-Commit: bde3e1da95cf29a826181af2d9d1fb6a00f5a42d

 nimble/host/include/host/ble_gatt.h | 2 +-
 nimble/host/src/ble_gattc.c         | 7 ++-----
 2 files changed, 3 insertions(+), 6 deletions(-)

commit cc6c2a3594198d2392ae426a1ce8568d1e4ff2a0
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 16:00:09 2016 -0800

    Modify GATT API s.t. errors include att handle.
    
    X-Original-Commit: 603d9ae0bf10344daff2e5556e8b0aa288dbb4ae

 nimble/host/include/host/ble_gatt.h         |  23 +-
 nimble/host/src/ble_gatt_priv.h             |   4 +-
 nimble/host/src/ble_gattc.c                 | 315 +++++++++++++++++-----------
 nimble/host/src/test/ble_gatt_conn_test.c   |  22 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c |   5 +-
 nimble/host/src/test/ble_gatt_disc_d_test.c |   5 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c |   5 +-
 nimble/host/src/test/ble_gatt_find_s_test.c |   5 +-
 nimble/host/src/test/ble_gatt_read_test.c   | 101 ++++++---
 nimble/host/src/test/ble_gatt_write_test.c  |   4 +-
 nimble/host/src/test/ble_hs_test_util.h     |   4 +-
 11 files changed, 311 insertions(+), 182 deletions(-)

commit ea10106014b3df8a6c4755606803d09bbecf37e1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 14:47:57 2016 -0800

    GATT procedure: Read Multiple Characteristics.
    
    X-Original-Commit: cc67071101da94c1bd97ca2bf448ff96c04d8687

 nimble/host/include/host/ble_gatt.h       |   8 ++
 nimble/host/src/ble_att_clt.c             |  14 +--
 nimble/host/src/ble_gatt_priv.h           |   2 +
 nimble/host/src/ble_gattc.c               | 134 ++++++++++++++++++++++-
 nimble/host/src/test/ble_gatt_read_test.c | 169 ++++++++++++++++++++++++++++++
 5 files changed, 316 insertions(+), 11 deletions(-)

commit 750adda59d066a6f11cbdd626432f8922b0a4fc1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 12:46:52 2016 -0800

    ATT Read multiple: client-side unit tests.
    
    X-Original-Commit: e3234fb56be32259a42092f5f6cd8bcebdf4796d

 nimble/host/src/ble_att_clt.c           |  5 +++
 nimble/host/src/test/ble_att_clt_test.c | 65 +++++++++++++++++++++++++++++++++
 2 files changed, 70 insertions(+)

commit 0eb49dfcdfb1c61c4c72c6b00651d7922444347b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 11 12:10:06 2016 -0800

    Unit tests for ATT command: read multiple.
    
    X-Original-Commit: 597374f937fed0d62e084c4cc660754fc656ead2

 nimble/host/src/ble_att_svr.c           |  11 +++
 nimble/host/src/test/ble_att_svr_test.c | 155 ++++++++++++++++++++++++++++++++
 2 files changed, 166 insertions(+)

commit 44dbbb8d8953a9d42ff13d45c363adfde7014bed
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 18:51:21 2016 -0800

    Fix compiler warning.
    
    X-Original-Commit: fddefd81edbf60a3a60476bf6ce54f0bf56ce347

 nimble/host/src/ble_att_svr.c | 2 ++
 1 file changed, 2 insertions(+)

commit cdbe0ca39900710e8ac12ba3024929260892a44a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 18:47:50 2016 -0800

    Server-side ATT command: Read Multiple.
    
    X-Original-Commit: 5b6d4bb030a94195ebbf3d04045858862d28f068

 nimble/host/src/ble_att.c      |   2 +
 nimble/host/src/ble_att_priv.h |   3 ++
 nimble/host/src/ble_att_svr.c  | 120 +++++++++++++++++++++++++++++++++++++++++
 3 files changed, 125 insertions(+)

commit 1ad42a22a7266c80d8059537d2b6eaf09d9d92c1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 18:25:33 2016 -0800

    Client-side ATT command: Read Multiple.
    
    X-Original-Commit: ce6bf1365c23706cb910f528ab017010f9f6b825

 nimble/host/include/host/ble_att.h |  2 +
 nimble/host/src/ble_att_clt.c      | 81 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_att_cmd.c      | 64 ++++++++++++++++++++++++++++++
 nimble/host/src/ble_att_cmd.h      | 36 +++++++++++++----
 nimble/host/src/ble_att_priv.h     |  5 +++
 5 files changed, 180 insertions(+), 8 deletions(-)

commit 298d1f0237aab2bf60cd0d3864a9ea08ff6ffd90
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 18:08:24 2016 -0800

    Tests for GATT procedure: read long characteristic
    
    X-Original-Commit: 9a869c056d023f034a9d91ca0deba09d2002418b

 nimble/host/src/ble_gattc.c               |   9 +-
 nimble/host/src/test/ble_gatt_read_test.c | 218 +++++++++++++++++++++++++++---
 2 files changed, 201 insertions(+), 26 deletions(-)

commit 37a99893d8be109b48e741b326a917a0a5aa7433
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 17:21:05 2016 -0800

    Replace descriptor fields with single struct.
    
    X-Original-Commit: b6566c44b30629cdb0222ed2882832bae2bcca51

 nimble/host/include/host/ble_gatt.h         |  9 +++++++--
 nimble/host/src/ble_gattc.c                 | 22 ++++++++++++----------
 nimble/host/src/test/ble_gatt_disc_d_test.c | 16 ++++++++--------
 3 files changed, 27 insertions(+), 20 deletions(-)

commit 492f90e4ed6ed109a9fbac3d58e74536d3d9e854
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 16:49:33 2016 -0800

    GATT Read Long Characteristic Value procedure.
    
    X-Original-Commit: 5cc71dffeffd045aba2e4b41a2b482bc76c2d522

 nimble/host/include/host/ble_att.h  |  12 +--
 nimble/host/include/host/ble_gatt.h |   3 +
 nimble/host/src/ble_att_clt.c       |  14 +--
 nimble/host/src/ble_gatt_priv.h     |   2 +
 nimble/host/src/ble_gattc.c         | 175 ++++++++++++++++++++++++++++++++++--
 5 files changed, 186 insertions(+), 20 deletions(-)

commit c823f3ba9a6cadf544acaf4fa487085ba022701c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 16:16:49 2016 -0800

    Some more client-side ATT tests.
    
    X-Original-Commit: 3e94452f3608a48906484aab096b7238ceeb959b

 nimble/host/src/test/ble_att_clt_test.c | 94 +++++++++++++++++++++++++++++++++
 1 file changed, 94 insertions(+)

commit c474adfc9b0e1cf33fd71d0801d44abf7843d0be
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 16:06:10 2016 -0800

    Unit tests for server-side read blob command.
    
    X-Original-Commit: 26ff74900536757578fc70071a499f36a30eb110

 nimble/host/include/host/ble_att.h      |   1 +
 nimble/host/src/ble_att_svr.c           |  49 ++++++++-----
 nimble/host/src/test/ble_att_svr_test.c | 119 ++++++++++++++++++++++++++++++--
 3 files changed, 146 insertions(+), 23 deletions(-)

commit 15a926dce188c75b40299f6fef34cf897b6cb0af
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 15:42:50 2016 -0800

    Server-side ATT read blob command.
    
    X-Original-Commit: c97f4f156afec3e656630ece7a45107e51254bd7

 nimble/host/src/ble_att.c      |   2 +-
 nimble/host/src/ble_att_priv.h |   3 +
 nimble/host/src/ble_att_svr.c  | 131 +++++++++++++++++++++++++++++++++++++++--
 3 files changed, 130 insertions(+), 6 deletions(-)

commit 78af61090465be254d8ca9f05ebc82a40cbe25a5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 15:36:37 2016 -0800

    Rename some fields in the ATT context struct.
    
    X-Original-Commit: f2de40aec6a1f93c9dbc913bc8c250529a73a568

 nimble/host/include/host/ble_att.h      |  3 ++-
 nimble/host/src/ble_att_svr.c           | 16 ++++++++--------
 nimble/host/src/ble_gattc.c             |  4 ++--
 nimble/host/src/ble_gatts.c             | 22 +++++++++++-----------
 nimble/host/src/test/ble_att_svr_test.c | 16 ++++++++--------
 5 files changed, 31 insertions(+), 30 deletions(-)

commit 1893f7d04d7dfd298467f95626c1b9f4ad97b33b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 15:28:56 2016 -0800

    Client-side ATT read blob command.
    
    X-Original-Commit: 5afe01a2742d13541dd9c03c849c90e67150fd01

 nimble/host/include/host/ble_att.h |  2 ++
 nimble/host/src/ble_att.c          |  2 ++
 nimble/host/src/ble_att_clt.c      | 73 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_att_cmd.c      | 41 +++++++++++++++++++++
 nimble/host/src/ble_att_cmd.h      | 25 +++++++++++++
 nimble/host/src/ble_att_priv.h     |  6 ++++
 6 files changed, 149 insertions(+)

commit ea2f20c2cc5e95d8a6d55ca0c6822a1d28ce90da
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 15:01:28 2016 -0800

    Change GATT naming to be more consistent.
    
    X-Original-Commit: c167105109c9bf27d3585cb7bf6681abc5a24924

 nimble/host/src/ble_att_clt.c   |   4 +-
 nimble/host/src/ble_gatt_priv.h |   6 +-
 nimble/host/src/ble_gattc.c     | 506 ++++++++++++++++++++++++----------------
 3 files changed, 312 insertions(+), 204 deletions(-)

commit a39a9da3eb77c9f332583539e41ff3277de8088b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 14:02:47 2016 -0800

    Add some sanity checking for GATT responses.
    
    X-Original-Commit: 54453e47624d7ba15980063909c5effe87f21b6d

 nimble/host/src/ble_gattc.c | 102 +++++++++++++++++++++++++++++++++++---------
 1 file changed, 83 insertions(+), 19 deletions(-)

commit a429c357a595c3b8784ddd535696fc58b6bc5d58
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 12:58:06 2016 -0800

    Minor change to make a macro more usable.
    
    X-Original-Commit: 4305b6ec8e54a887865e6777cb5d712c587868ad

 nimble/host/src/ble_gattc.c | 51 ++++++++++++++++++++++++++-------------------
 1 file changed, 30 insertions(+), 21 deletions(-)

commit 030522d8a724e7f958a89882a1ce04a199c07704
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 12:41:09 2016 -0800

    Read by UUID unit tests.
    
    X-Original-Commit: 869b798f3d918afa74d1291ffdca9c98e0b172bf

 nimble/host/src/ble_gattc.c               |   2 +-
 nimble/host/src/test/ble_gatt_read_test.c | 197 +++++++++++++++++++++++++++---
 2 files changed, 182 insertions(+), 17 deletions(-)

commit ebcf33aded89847568a055bd6c363f7f7dc78a87
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Jan 8 11:32:47 2016 -0800

    Modify read test to accommodate read by UUID.
    
    X-Original-Commit: e4002f02ff1f26768c1d2436bd46a11bfded371f

 nimble/host/src/test/ble_gatt_read_test.c | 107 ++++++++++++++++++++++--------
 1 file changed, 78 insertions(+), 29 deletions(-)

commit 34be06bf3d5b960102a6d889b006ae6f206a3315
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 7 19:03:02 2016 -0800

    GATT procedure: Read Using Characteristic UUID.
    
    X-Original-Commit: 234492562f8ae5a0e96c2c6777d5e02952be56d5

 nimble/host/include/host/ble_gatt.h |   3 +
 nimble/host/src/ble_gattc.c         | 198 +++++++++++++++++++++++++++++++-----
 2 files changed, 177 insertions(+), 24 deletions(-)

commit 5dfab70a788300f715d430ff77ff965c2df1af86
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 7 18:54:23 2016 -0800

    Reserve connection handle 0xffff for internal tx.
    
    X-Original-Commit: 7587a3735bddd556905629ef720d3627caa5a564

 nimble/host/include/host/ble_hs.h | 2 ++
 nimble/host/src/ble_att_svr.c     | 4 ++--
 2 files changed, 4 insertions(+), 2 deletions(-)

commit 0d630434bdb5dc32598f1f08982eb02d71be68db
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 7 18:23:27 2016 -0800

    Reorganize a bunch of ATT code.
    
    X-Original-Commit: d05dcac3ecc7b09f8793dd6390861ae350f46507

 nimble/host/include/host/ble_gatt.h |   1 -
 nimble/host/src/ble_att_clt.c       | 337 ++++++++++++++++++++----------------
 nimble/host/src/ble_att_priv.h      |  41 ++++-
 nimble/host/src/ble_gatt_priv.h     |  18 +-
 nimble/host/src/ble_gattc.c         |  41 ++---
 5 files changed, 251 insertions(+), 187 deletions(-)

commit f6aa14debc8517eb8ed73741f4b117a6e5a8abf3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 7 17:59:01 2016 -0800

    Fix up some missing tx calls in unit tests.
    
    X-Original-Commit: c5cb14a9e716292f3cfb05fedd1e70a0772f3c5f

 nimble/host/src/test/ble_att_clt_test.c      |  4 ++--
 nimble/host/src/test/ble_att_svr_test.c      | 22 +++++++++++-----------
 nimble/host/src/test/ble_gatt_conn_test.c    | 11 ++++-------
 nimble/host/src/test/ble_gatt_disc_c_test.c  |  5 ++---
 nimble/host/src/test/ble_gatt_disc_s_test.c  |  8 ++++----
 nimble/host/src/test/ble_gatt_find_s_test.c  |  6 ++----
 nimble/host/src/test/ble_gatt_read_test.c    |  4 ++--
 nimble/host/src/test/ble_gatt_write_test.c   |  6 ++----
 nimble/host/src/test/ble_gatts_notify_test.c |  6 ++----
 9 files changed, 31 insertions(+), 41 deletions(-)

commit 93c918a471528e995978bf71217a4f3825417817
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Jan 7 16:26:06 2016 -0800

    Discover All Characteristic Descriptors GATT proc.
    
    X-Original-Commit: d5ba6afe57d03f68626d254a22bf6615344083a8

 nimble/host/include/host/ble_gatt.h         |  10 +-
 nimble/host/include/host/ble_hs_test.h      |   1 +
 nimble/host/src/ble_att_clt.c               |  23 +-
 nimble/host/src/ble_att_cmd.h               |   3 +
 nimble/host/src/ble_gatt_priv.h             |   3 +
 nimble/host/src/ble_gattc.c                 | 165 ++++++++++++-
 nimble/host/src/test/ble_gatt_disc_d_test.c | 356 ++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c          |   1 +
 nimble/host/src/test/ble_hs_test_util.c     |   7 +
 nimble/host/src/test/ble_hs_test_util.h     |   1 +
 10 files changed, 555 insertions(+), 15 deletions(-)

commit 728df7a42537cd3fbe0484a51dc9260dd2900740
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 19:02:50 2016 -0800

    Find Included Services GATT procedure.
    
    X-Original-Commit: 40f04be63f112e09fe4e0f22e39b5a991d15b2d2

 nimble/host/include/host/ble_gatt.h          |  53 +-
 nimble/host/include/host/ble_hs_test.h       |   1 +
 nimble/host/include/host/ble_uuid.h          |   6 +
 nimble/host/src/ble_gatt.c                   | 109 ----
 nimble/host/src/ble_gatt_priv.h              |  27 +-
 nimble/host/src/ble_gattc.c                  | 763 ++++++++++++++++++++++-----
 nimble/host/src/ble_gatts.c                  |   4 +-
 nimble/host/src/test/ble_gatt_conn_test.c    |  40 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c  |   6 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c  |   8 +-
 nimble/host/src/test/ble_gatt_find_s_test.c  | 349 ++++++++++++
 nimble/host/src/test/ble_gatt_read_test.c    |   8 +-
 nimble/host/src/test/ble_gatt_write_test.c   |  12 +-
 nimble/host/src/test/ble_gatts_notify_test.c |   4 +-
 nimble/host/src/test/ble_gatts_reg_test.c    |  20 +-
 nimble/host/src/test/ble_hs_test.c           |   1 +
 16 files changed, 1069 insertions(+), 342 deletions(-)

commit a6061a585bc10bd570a36c88e9eeed2cd1fe7f4c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 18:37:22 2016 -0800

    Shorten some GATT identifiers.
    
    X-Original-Commit: 575619092ac94ea3b423964043c6d6a431502d6b

 nimble/host/src/ble_gattc.c | 221 ++++++++++++++++++++++----------------------
 1 file changed, 110 insertions(+), 111 deletions(-)

commit dc57c31f94be31913ffb3c5dafd3dc41d11bb3bb
Author: wes3 <will@micosa.io>
Date:   Wed Jan 6 13:40:29 2016 -0800

    Minor modifications to when a connection ends and some slight cleanup of timing
    
    X-Original-Commit: 659d55a9bd7ec40a761642e648ffbf3d3889589d

 nimble/controller/include/controller/ble_ll.h |  13 +++-
 nimble/controller/src/ble_ll.c                |  15 ----
 nimble/controller/src/ble_ll_conn.c           | 100 ++++++++++++++------------
 nimble/drivers/native/src/ble_phy.c           |   1 -
 nimble/drivers/nrf52/src/ble_phy.c            |  11 +--
 5 files changed, 68 insertions(+), 72 deletions(-)

commit cb170eaf915469306914aaeacc1a7c7f968978cc
Author: wes3 <will@micosa.io>
Date:   Wed Jan 6 09:07:25 2016 -0800

    Fix issues with Link Layer fragmentation. We now support (fully) the data length extension feature and fragmentation of ACL data packets inside the controller
    
    X-Original-Commit: f95ce4fe1d72dd5b1c3e9096e0651984587050ce

 nimble/controller/include/controller/ble_ll.h |  16 +--
 nimble/controller/src/ble_ll.c                |  38 ++----
 nimble/controller/src/ble_ll_conn.c           | 169 ++++++++++++++++++--------
 nimble/controller/src/ble_ll_conn_priv.h      |   8 +-
 nimble/drivers/nrf52/src/ble_phy.c            |   9 +-
 nimble/host/src/host_hci.c                    |   9 +-
 nimble/include/nimble/ble.h                   |   2 +-
 7 files changed, 159 insertions(+), 92 deletions(-)

commit cc05a594288b520515341147e6c79731d8d69617
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 18:15:17 2016 -0800

    Discover Characteristics by UUID GATT procedure.
    
    X-Original-Commit: f77968f019286dd442f95fbf3f7b0f6100f063c8

 nimble/host/include/host/ble_gatt.h         |   3 +
 nimble/host/src/ble_gatt.c                  |   9 +
 nimble/host/src/ble_gatt_priv.h             |   3 +
 nimble/host/src/ble_gattc.c                 |  83 ++++++---
 nimble/host/src/test/ble_gatt_disc_c_test.c | 253 ++++++++++++++++++++++++++--
 5 files changed, 318 insertions(+), 33 deletions(-)

commit f9226a61049e99518ede96e8f3f88f08fab10be7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 17:34:28 2016 -0800

    Fix some test name typos.
    
    X-Original-Commit: 2abaf0e1a9102d01a83057d4b6e9b37025a3c5a3

 nimble/host/src/test/ble_gatt_disc_c_test.c | 4 ++--
 nimble/host/src/test/ble_gatt_disc_s_test.c | 4 ++--
 nimble/host/src/test/ble_gatt_write_test.c  | 4 ++--
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 1a5be59745f8fc030c155b6b2d0c95227716104a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 17:21:17 2016 -0800

    Server tx of notifications / indications.
    
    X-Original-Commit: c096844c872eebae86b9025f1ff1b867a360c934

 nimble/host/include/host/ble_hs_test.h       |   1 +
 nimble/host/src/ble_gatt.c                   |  16 ++
 nimble/host/src/ble_gatt_priv.h              |  15 +-
 nimble/host/src/ble_gattc.c                  | 102 ++------
 nimble/host/src/ble_gatts.c                  |  62 ++++-
 nimble/host/src/test/ble_att_svr_test.c      |   4 +-
 nimble/host/src/test/ble_gatts_notify_test.c | 332 +++++++++++++++++++++++++++
 nimble/host/src/test/ble_gatts_reg_test.c    |   4 +-
 nimble/host/src/test/ble_hs_test.c           |   1 +
 9 files changed, 440 insertions(+), 97 deletions(-)

commit 91cac253e03e88eea23845f14138280936e341ad
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 15:13:22 2016 -0800

    Indication tests.
    
    X-Original-Commit: 6545cc0bbd1198447fde5db4104e02ba968cd9d6

 nimble/host/src/ble_att_cmd.c           |  32 ++++++++++
 nimble/host/src/ble_att_cmd.h           |  11 +++-
 nimble/host/src/ble_att_svr.c           |  77 +++++++++++++++++------
 nimble/host/src/test/ble_att_svr_test.c | 106 ++++++++++++++++++++++++++++++--
 4 files changed, 202 insertions(+), 24 deletions(-)

commit 37924aa298af3d3890c75439636279d876e00658
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 14:52:16 2016 -0800

    Notification tests.
    
    X-Original-Commit: b296dd4cb10602a08600aa6d9d57ee210a6ebffb

 nimble/host/src/ble_att.c               |   7 +++
 nimble/host/src/ble_att_cmd.c           |   4 +-
 nimble/host/src/ble_att_priv.h          |   3 +
 nimble/host/src/ble_att_svr.c           |   4 ++
 nimble/host/src/test/ble_att_svr_test.c | 104 ++++++++++++++++++++++++++++++++
 5 files changed, 120 insertions(+), 2 deletions(-)

commit 71d09a883dbdea3367529392cb7991b48297b4e0
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 14:12:52 2016 -0800

    Notifications and indications.
    
    X-Original-Commit: 8764e91d808bb997ee8b73cb8ea81d203e6d3652

 nimble/host/include/host/ble_att.h  |   9 ++
 nimble/host/include/host/ble_gatt.h |   2 +-
 nimble/host/src/ble_att.c           |   3 +
 nimble/host/src/ble_att_clt.c       | 132 ++++++++++++++++++++--
 nimble/host/src/ble_att_cmd.c       |  78 +++++++++++++
 nimble/host/src/ble_att_cmd.h       |  36 ++++++
 nimble/host/src/ble_att_priv.h      |  20 ++++
 nimble/host/src/ble_att_svr.c       | 138 +++++++++++++++++++++--
 nimble/host/src/ble_gatt_priv.h     |   5 +
 nimble/host/src/ble_gattc.c         | 214 +++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_gatts.c         |  63 +++++++++--
 11 files changed, 672 insertions(+), 28 deletions(-)

commit 68ea05cfa7ea18e334f29f3845083e25fc64e30c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 11:26:02 2016 -0800

    Log all outgoing HCI commands.
    
    X-Original-Commit: 2fdc717328cfc5259250bb145739b1befe52cd6e

 nimble/host/src/host_hci_cmd.c | 3 +++
 1 file changed, 3 insertions(+)

commit b19231e891dc0a1a8fbe5bbcfff0c162d14a79b3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Jan 5 11:25:36 2016 -0800

    Fix parsing bug for disconnection complete event.
    
    X-Original-Commit: 5e3d07d78e1bcacb45ae4f446f1acfda52f2a124

 nimble/host/src/host_hci.c         | 6 +++---
 nimble/include/nimble/hci_common.h | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit fada9ad351767a211cdbfa1bc0e8d8ebf00f053b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 4 22:30:27 2016 -0800

    Oops - wasn't setting GATT tx time.
    
    X-Original-Commit: 6cd3884a5317c6e399ae182251fd14f3af5613f3

 nimble/host/src/ble_gattc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e7f932c74ad15e0451af29c1f488b1b8d67f8dec
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 4 16:59:56 2016 -0800

    Disconnect from peers who don't respond to GATT.
    
    X-Original-Commit: 3c0a7b18925018b3bdd2f36855dccd2326e9233f

 nimble/host/src/ble_gatt_priv.h |  1 +
 nimble/host/src/ble_gattc.c     | 54 ++++++++++++++++++++++++++++-------------
 nimble/host/src/ble_hs.c        |  8 +++---
 3 files changed, 43 insertions(+), 20 deletions(-)

commit ca4e889e187e24f1794d8f06aae09c4df23ceb93
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Jan 4 15:57:16 2016 -0800

    Client configuration descriptor.
    
    X-Original-Commit: 46974abe8f8793877a4c55aa5495cfb791c6cb8d

 nimble/host/src/ble_gatt_priv.h |   9 ++-
 nimble/host/src/ble_gatts.c     | 140 +++++++++++++++++++++++++++++++++++++---
 nimble/host/src/ble_hs_conn.c   |   4 +-
 nimble/host/src/ble_hs_conn.h   |   2 +-
 4 files changed, 142 insertions(+), 13 deletions(-)

commit 0aa08024f09522b279bbe885bf85bd13ea08c402
Author: wes3 <will@micosa.io>
Date:   Mon Jan 4 11:19:23 2016 -0800

    Start modification of code so that we can fragment PDUs that we send to other devices if they do not accept as large a frame as we can
    
    X-Original-Commit: 1f32b48f753399acec61c2a64c2ef236ee014166

 nimble/controller/include/controller/ble_ll.h      |  20 ++--
 nimble/controller/include/controller/ble_ll_conn.h |   2 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |   2 +-
 nimble/controller/include/controller/ble_phy.h     |   9 +-
 nimble/controller/src/ble_ll.c                     |  33 +++++-
 nimble/controller/src/ble_ll_adv.c                 |  52 ++++----
 nimble/controller/src/ble_ll_conn.c                | 131 +++++++++++----------
 nimble/controller/src/ble_ll_conn_hci.c            |  11 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   3 +-
 nimble/controller/src/ble_ll_ctrl.c                |  47 +++-----
 nimble/controller/src/ble_ll_scan.c                |  38 +++---
 nimble/drivers/native/src/ble_phy.c                |  26 ++--
 nimble/drivers/nrf52/src/ble_phy.c                 |  59 +++++++---
 nimble/include/nimble/ble.h                        |  18 ++-
 14 files changed, 269 insertions(+), 182 deletions(-)

commit 6d727575664f074eb758fd69fcc668dae0041f4b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 30 14:19:14 2015 -0800

    Client-configurable GATT characteristics.
    
    X-Original-Commit: 7274fcae4b01d27857839df4b9034005e4587787

 nimble/host/include/host/ble_gatt.h       |  14 ++-
 nimble/host/src/ble_att_priv.h            |   1 +
 nimble/host/src/ble_att_svr.c             |  42 ++++---
 nimble/host/src/ble_gatt_priv.h           |  33 +++--
 nimble/host/src/ble_gatts.c               | 193 +++++++++++++++++++++++++++++-
 nimble/host/src/ble_hs.c                  |   5 +
 nimble/host/src/ble_hs_conn.c             |  13 +-
 nimble/host/src/ble_hs_conn.h             |   2 +
 nimble/host/src/test/ble_gatts_reg_test.c |  24 ++--
 9 files changed, 285 insertions(+), 42 deletions(-)

commit dff81787c2aff29594f8fc289d00510756c6bbbf
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 18:35:46 2015 -0800

    ATT permissions.
    
    X-Original-Commit: 6bdedf85473b8422cd5d157d8c505238bcdbe9ad

 nimble/host/include/host/ble_att.h      |  11 +-
 nimble/host/src/ble_att_svr.c           | 173 +++++++++++++++++++++-----------
 nimble/host/src/test/ble_att_svr_test.c |  40 ++++----
 3 files changed, 144 insertions(+), 80 deletions(-)

commit fb29bf1a2ac7bf4bac774829fb7fd7dc519de556
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 18:02:43 2015 -0800

    Remove obsolete ATT callback union.
    
    X-Original-Commit: 1b16fdde78353b203ed8acbb5040c8f1b6e6e916

 nimble/host/include/host/ble_att.h      | 10 +++----
 nimble/host/src/ble_att_svr.c           | 47 ++++++++++++++++-----------------
 nimble/host/src/ble_gatts.c             | 38 +++++++++++++-------------
 nimble/host/src/test/ble_att_svr_test.c | 36 ++++++++++++-------------
 4 files changed, 63 insertions(+), 68 deletions(-)

commit 983159ee5d8637fc0434b3ea8ce9e37ca8962529
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 17:44:42 2015 -0800

    Pass connection handle in ATT/GATT callbacks.
    
    This is required for connection-specific descriptors (e.g., Client
    Characteristic Configuration).
    
    X-Original-Commit: 2f6105c5a153ad8ae71201d539da8209f26262e4

 nimble/host/include/host/ble_att.h        |  4 ++--
 nimble/host/include/host/ble_gatt.h       |  5 +++--
 nimble/host/src/ble_att_svr.c             | 29 ++++++++++++++++-------------
 nimble/host/src/ble_gatts.c               | 30 ++++++++++++++++--------------
 nimble/host/src/test/ble_att_svr_test.c   | 23 ++++++++++++-----------
 nimble/host/src/test/ble_gatts_reg_test.c |  3 ++-
 6 files changed, 51 insertions(+), 43 deletions(-)

commit 49364f2b86fcaee1357d5f5f62f23d0663a8efd1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 17:06:12 2015 -0800

    Add some GATT server unit tests.
    
    X-Original-Commit: d67865a8f8614b5ed7c9dcac96706d325bce5f93

 nimble/host/src/test/ble_gatts_reg_test.c | 490 ++++++++++++++++++++++++++++++
 1 file changed, 490 insertions(+)

commit 82c5009205cbe8ebf1dad2d39cccbaa5ddf268c2
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 16:22:10 2015 -0800

    Read / write descriptors.
    
    X-Original-Commit: 10480cfc988399590bc0f59d00277a49955b1bf4

 nimble/host/include/host/ble_att.h      |   7 +-
 nimble/host/include/host/ble_gatt.h     |  47 +++---
 nimble/host/include/host/ble_hs_test.h  |   1 +
 nimble/host/src/ble_att_priv.h          |   1 +
 nimble/host/src/ble_att_svr.c           |  39 ++---
 nimble/host/src/ble_gatt.c              |   4 +-
 nimble/host/src/ble_gatt_priv.h         |   3 +-
 nimble/host/src/ble_gatts.c             | 246 +++++++++++++++++++++-----------
 nimble/host/src/test/ble_att_svr_test.c |  28 ++--
 nimble/host/src/test/ble_hs_test.c      |   1 +
 10 files changed, 236 insertions(+), 141 deletions(-)

commit fc636a1165d51e03d6062b6e75717605d2efeb46
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 14:16:57 2015 -0800

    Rename UUID identifiers.
    
    ble_hs_uuid.*       --> ble_uuid.*
    ble_uuid_16bit      --> ble_uuid_128_to_16
    ble_uuid_from_16bit --> ble_uuid_16_to_128
    
    X-Original-Commit: 14b5ded6d248376d117f7131310c77f05c9d5e7b

 nimble/host/include/host/ble_hs_test.h             |  2 +-
 .../include/host/{ble_hs_uuid.h => ble_uuid.h}     | 12 +++++-----
 nimble/host/src/ble_att_clt.c                      |  8 +++----
 nimble/host/src/ble_att_cmd.c                      |  2 +-
 nimble/host/src/ble_att_svr.c                      | 16 ++++++-------
 nimble/host/src/ble_gattc.c                        | 10 ++++-----
 nimble/host/src/ble_gatts.c                        |  6 ++---
 nimble/host/src/{ble_hs_uuid.c => ble_uuid.c}      | 20 ++++++++---------
 nimble/host/src/test/ble_att_svr_test.c            |  4 ++--
 nimble/host/src/test/ble_gatt_disc_c_test.c        |  4 ++--
 nimble/host/src/test/ble_gatt_disc_s_test.c        |  6 ++---
 nimble/host/src/test/ble_gatt_read_test.c          |  2 +-
 nimble/host/src/test/ble_gatt_write_test.c         |  2 +-
 nimble/host/src/test/ble_hs_test.c                 |  2 +-
 .../test/{ble_hs_uuid_test.c => ble_uuid_test.c}   | 26 +++++++++++-----------
 15 files changed, 61 insertions(+), 61 deletions(-)

commit 8609ac7f9fe59c06a19a0a92937a651b749b5ee8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 14:02:28 2015 -0800

    Use GATT-specific callbacks for GATT access.
    
    Instead of using the ATT-server callbacks.  Also, call a registration callback
    whenever a service, characteristic, or descriptor is successfully registered.
    
    X-Original-Commit: f0aa64b5005f5c163c858d6eb4b0485e55a163ab

 nimble/host/include/host/ble_att.h     |   6 +-
 nimble/host/include/host/ble_gatt.h    |  68 +++++++++++--
 nimble/host/include/host/ble_hs_uuid.h |  10 ++
 nimble/host/src/ble_gatt.c             |   5 +-
 nimble/host/src/ble_gatt_priv.h        |   3 +-
 nimble/host/src/ble_gattc.c            |   2 +-
 nimble/host/src/ble_gatts.c            | 180 +++++++++++++++++++++++++++------
 7 files changed, 227 insertions(+), 47 deletions(-)

commit 1c4ea46f480d8c8d9f809c2231fee9a0a9f69730
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 11:37:47 2015 -0800

    Fix some GATT server crashes.
    
    (complete lack of testing for last week's commit!)
    
    X-Original-Commit: 38d7d7371b0fefaeb1d43151300ba73ec95afbf0

 nimble/host/include/host/ble_att.h  |  3 +++
 nimble/host/include/host/ble_gatt.h |  5 +++--
 nimble/host/src/ble_att_svr.c       | 21 +++++++++++++++++++++
 nimble/host/src/ble_gatt.c          |  6 ++++++
 nimble/host/src/ble_gatts.c         | 37 +++++++++++++++++++++++++++++++------
 5 files changed, 64 insertions(+), 8 deletions(-)

commit bcb0704773b11a11dc861f2d7719734344132cb3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 28 10:59:23 2015 -0800

    Split hostctlrtest into centtest,prphtest projects
    
    X-Original-Commit: 23c28c05af6a2bb59cc64b3e4786681c27eb783c

 nimble/host/src/ble_gatts.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit eabf162bc59dd993031a93ddc24149f42514c94a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 23 16:45:23 2015 -0800

    GATT server
    
    X-Original-Commit: cc55da90aa35933dd456a4f2038fb69e31779fff

 nimble/host/include/host/ble_gatt.h |  11 ++-
 nimble/host/src/ble_gatts.c         | 190 +++++++++++++++++++++++++++++++++---
 2 files changed, 185 insertions(+), 16 deletions(-)

commit 8f45e180d5fa0dd2681978c3645d812659494c56
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 23 14:50:30 2015 -0800

    Fix bug: ATT server silent when read-type done!
    
    X-Original-Commit: ba4a7ed2b053c74533e1f7c4e8a5c60c2938c893

 nimble/host/src/ble_att_svr.c           |  20 ++-
 nimble/host/src/test/ble_att_svr_test.c | 252 ++++++++++++++++++++++++++++++--
 2 files changed, 256 insertions(+), 16 deletions(-)

commit 8e7594adc713c2dcc5f4377e5515149239bd3409
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 23 14:31:12 2015 -0800

    Use a different set of op codes for ATT callbacks.
    
    X-Original-Commit: 51bd2b46d2e44f76c42e932a7a66bf0d0ccc9461

 nimble/host/include/host/ble_att.h      |  3 +++
 nimble/host/src/ble_att_svr.c           | 12 ++++++------
 nimble/host/src/ble_gatts.c             |  2 +-
 nimble/host/src/test/ble_att_svr_test.c | 13 ++++++-------
 4 files changed, 16 insertions(+), 14 deletions(-)

commit 345fb04f3b07bc448cc623726e493fff6ee616cb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 23 14:00:33 2015 -0800

    Change function type for ATT callbacks.
    
    X-Original-Commit: 936b9e83adcf34f1359f688e0fda0f3dabf71f91

 nimble/host/include/host/ble_att.h      | 25 +++------
 nimble/host/include/host/ble_gatt.h     |  4 +-
 nimble/host/src/ble_att_priv.h          | 11 ++++
 nimble/host/src/ble_att_svr.c           | 71 +++++++++++++-----------
 nimble/host/src/ble_gatts.c             | 18 +++++-
 nimble/host/src/test/ble_att_svr_test.c | 97 +++++++++++++++++----------------
 6 files changed, 125 insertions(+), 101 deletions(-)

commit bf54de828247bc4845a3f84d8260671665fdc936
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 23 13:45:27 2015 -0800

    Initial implementation of GATT server.
    
    X-Original-Commit: e949b8ab29bcb1f48f786c3c82e431f07cd49be3

 nimble/host/include/host/ble_gatt.h |  27 +++++++
 nimble/host/src/ble_gatt_priv.h     |   7 +-
 nimble/host/src/ble_gatts.c         | 147 ++++++++++++++++++++++++++++++++++++
 3 files changed, 179 insertions(+), 2 deletions(-)

commit 2fafdd9723063385d399bc3da5bdbf0c0c4b6e17
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 23 11:00:53 2015 -0800

    Separate gatt source into gatt-client,gatt-server
    
    X-Original-Commit: 2c857eba2561329e5d146c9362a9722ddebd483a

 nimble/host/include/host/ble_gatt.h         |    2 +-
 nimble/host/src/ble_att_clt.c               |   22 +-
 nimble/host/src/ble_gap_conn.c              |    2 +-
 nimble/host/src/ble_gatt.c                  | 1285 +-------------------------
 nimble/host/src/ble_gatt_priv.h             |   56 +-
 nimble/host/src/ble_gattc.c                 | 1320 +++++++++++++++++++++++++++
 nimble/host/src/ble_hs.c                    |    4 +-
 nimble/host/src/ble_hs_conn.c               |    2 +-
 nimble/host/src/test/ble_gatt_conn_test.c   |    8 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c |    6 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c |   10 +-
 nimble/host/src/test/ble_gatt_read_test.c   |    8 +-
 nimble/host/src/test/ble_gatt_write_test.c  |    4 +-
 13 files changed, 1415 insertions(+), 1314 deletions(-)

commit 44d25f3d728ba19b0a0d582457f7aacdc3c313c7
Author: wes3 <will@micosa.io>
Date:   Tue Dec 22 22:05:27 2015 -0800

    Add actualy transmit end/receive end timing by using the chip to capture the rx/tx end times in a timer capture register. Add phy tx end callback. Get better connection timing using the tx/rx end times.
    
    X-Original-Commit: 63761d721560ca45bb92a2794659552bb672e6c8

 nimble/controller/include/controller/ble_ll.h      |  39 +++-
 nimble/controller/include/controller/ble_ll_adv.h  |  13 +-
 nimble/controller/include/controller/ble_ll_conn.h |   1 -
 nimble/controller/include/controller/ble_ll_scan.h |  12 +-
 nimble/controller/include/controller/ble_phy.h     |   9 +-
 nimble/controller/src/ble_ll.c                     | 129 ++++++-----
 nimble/controller/src/ble_ll_adv.c                 | 245 +++++++++++++--------
 nimble/controller/src/ble_ll_conn.c                | 219 ++++++++----------
 nimble/controller/src/ble_ll_conn_hci.c            |   4 +-
 nimble/controller/src/ble_ll_conn_priv.h           |  11 +-
 nimble/controller/src/ble_ll_hci.c                 |  20 --
 nimble/controller/src/ble_ll_scan.c                | 174 +++++++++------
 nimble/drivers/native/src/ble_phy.c                |  16 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |  64 +++++-
 nimble/include/nimble/ble.h                        |   5 +-
 15 files changed, 555 insertions(+), 406 deletions(-)

commit dd7bd4d0f128814819e044c7173b6396be5777f1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 22 18:43:02 2015 -0800

    Error code overhaul continues.
    
    X-Original-Commit: f17839ca02ca2439307b143432a095b71d6181d9

 nimble/host/include/host/ble_gap.h |  6 +++---
 nimble/host/include/host/ble_hs.h  | 17 +++++------------
 nimble/host/src/ble_att_priv.h     |  1 +
 nimble/host/src/ble_att_svr.c      |  2 +-
 nimble/host/src/ble_gap_conn.c     | 35 ++++++++++++++++-------------------
 nimble/host/src/ble_gatt.c         |  6 +++---
 nimble/host/src/ble_hci_ack.h      |  4 ++--
 nimble/host/src/ble_hs_conn.c      |  4 ++--
 nimble/host/src/ble_l2cap.c        |  2 +-
 nimble/host/src/host_hci.c         |  9 ++++-----
 10 files changed, 38 insertions(+), 48 deletions(-)

commit 22265e399179bac3ff2f55b1982b108fcdde87a3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 22 16:46:15 2015 -0800

    Error code overhaul!
    
    X-Original-Commit: 14f9937e2a0aabbe56b4750495ccb013163fa706

 nimble/host/include/host/ble_att.h          |   2 +
 nimble/host/include/host/ble_gatt.h         |  13 +-
 nimble/host/include/host/ble_hs.h           |  17 +-
 nimble/host/src/ble_att_clt.c               |  63 ++--
 nimble/host/src/ble_att_svr.c               | 564 ++++++++++++++++++----------
 nimble/host/src/ble_gatt.c                  | 159 ++++----
 nimble/host/src/ble_hs_cfg.c                |  16 +
 nimble/host/src/ble_hs_misc.c               |  16 +
 nimble/host/src/test/ble_gatt_conn_test.c   |  34 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c |  10 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c |  15 +-
 nimble/host/src/test/ble_gatt_read_test.c   |  71 +++-
 nimble/host/src/test/ble_gatt_write_test.c  |   8 +-
 nimble/host/src/test/ble_hs_test_util.c     |   4 +-
 nimble/host/src/test/ble_hs_test_util.h     |   2 +-
 15 files changed, 609 insertions(+), 385 deletions(-)

commit b5fd5c3cdd95a952599f97c92530f10940b40313
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 22 14:02:36 2015 -0800

    Add some more advertisement data fields.
    
    X-Original-Commit: 57949307617e9a53ea9255f7f5ec5fc8c5aec443

 nimble/host/include/host/ble_hs.h      |  32 +++++-
 nimble/host/src/ble_gap_conn.c         |  13 ++-
 nimble/host/src/ble_hs_adv.c           | 139 +++++++++++++++++++++++--
 nimble/host/src/ble_hs_adv.h           |  17 +--
 nimble/host/src/test/ble_hs_adv_test.c | 183 ++++++++++++++++++++++++++++++++-
 5 files changed, 354 insertions(+), 30 deletions(-)

commit afdddcd0600648d3c63f9fef12c21c2fc4729490
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 22 12:14:38 2015 -0800

    Add basic unit tests for adv. data.
    
    X-Original-Commit: 961bcd69b76319b1f8efaf71599d43ac4abcac47

 nimble/host/include/host/ble_hs.h       |   3 +
 nimble/host/include/host/ble_hs_test.h  |   3 +
 nimble/host/src/ble_gap_conn.c          |  28 ++--
 nimble/host/src/ble_hs_adv.c            |   2 +-
 nimble/host/src/ble_hs_adv.h            |   2 +
 nimble/host/src/host_hci_cmd.c          |   7 +-
 nimble/host/src/test/ble_hs_adv_test.c  | 229 ++++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_conn_test.c |   2 -
 nimble/host/src/test/ble_hs_test.c      |  10 ++
 nimble/host/src/test/ble_hs_test_util.c |  71 +++++++---
 nimble/host/src/test/ble_hs_test_util.h |   2 +
 11 files changed, 315 insertions(+), 44 deletions(-)

commit 0c926f37ca56ddc5bb63121f91ef5172479b11bc
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 19:00:49 2015 -0800

    Add ability to cancel a connection in progress.
    
    X-Original-Commit: cc5b7b724c1f064ae05a25977dffd44e24ca163f

 nimble/host/include/host/ble_gap.h  |  1 +
 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/ble_gap_conn.c      | 45 +++++++++++++++++++++++++++++++++++++
 nimble/host/src/host_hci_cmd.c      | 10 +++++++++
 4 files changed, 57 insertions(+)

commit a57f6dd4889e0c2983f710720c6d99919ec4c065
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 18:43:50 2015 -0800

    Reset FSM when the connect procedure completes.
    
    X-Original-Commit: 36945a713c6a081775320bea788dfe5d1059b968

 nimble/host/src/ble_gap_conn.c | 45 ++++++++++++++++++++++++------------------
 1 file changed, 26 insertions(+), 19 deletions(-)

commit c85aa18e24b4f5d6328770a96d8eaba679e63bab
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 18:39:34 2015 -0800

    Add ability to stop advertising.
    
    X-Original-Commit: 52d8fdfc69bb2e7c2b568ac9ffd14b7d57b7947a

 nimble/host/include/host/ble_gap.h |  6 ++++
 nimble/host/include/host/ble_hs.h  |  1 +
 nimble/host/src/ble_gap_conn.c     | 67 ++++++++++++++++++++++++++++++++++++++
 3 files changed, 74 insertions(+)

commit eff19e227529743801ebb5dadd3afcaf5fc4f03d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 17:50:37 2015 -0800

    Parse data field of incoming advertisement report.
    
    X-Original-Commit: 2b2118b37ebe732df984d88c530d5f8e3ddb01a1

 nimble/host/include/host/ble_gap.h |  4 ++-
 nimble/host/include/host/ble_hs.h  |  4 ++-
 nimble/host/src/ble_gap_conn.c     | 35 ++++++++++++++++------
 nimble/host/src/ble_gap_conn.h     |  3 +-
 nimble/host/src/ble_hs_adv.c       | 61 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_adv.h       | 10 +++++++
 nimble/host/src/host_hci.c         | 19 ++++++------
 7 files changed, 115 insertions(+), 21 deletions(-)

commit d5ff2882de511bbc11f2ea0f6cee96b03fe7892b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 16:25:48 2015 -0800

    split adv from gap
    
    X-Original-Commit: 1ce6fd0114f78d6f710a7c5d19624604ab62c99b

 nimble/host/include/host/ble_gap.h | 10 ++---
 nimble/host/include/host/ble_hs.h  |  6 +++
 nimble/host/src/ble_gap_conn.c     | 76 +++++++++++------------------------
 nimble/host/src/ble_gap_conn.h     | 15 -------
 nimble/host/src/ble_hs_adv.c       | 81 ++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_adv.h       | 42 ++++++++++++++++++++
 nimble/host/src/test/ble_os_test.c |  2 +-
 7 files changed, 156 insertions(+), 76 deletions(-)

commit 1b8adca0f1848fbcfbeded4e093cb6ed22026834
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 16:06:18 2015 -0800

    Combine all GAP discovery procedures.
    
    X-Original-Commit: a232d3297c872ee2a85c4a0784b24b1d9c370ff8

 nimble/host/include/host/ble_gap.h |  2 +-
 nimble/host/src/ble_gap_conn.c     | 63 ++++++++++++++++----------------------
 nimble/host/src/test/ble_os_test.c |  2 +-
 3 files changed, 28 insertions(+), 39 deletions(-)

commit 6c50aaf807e145f4ecac2a572854f8ac516c21d8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 15:33:09 2015 -0800

    Set advertising data.
    
    X-Original-Commit: 56f1ce6f8179c6c711d703de80e8a1c21d3499a5

 nimble/host/include/host/ble_gap.h |   6 ++
 nimble/host/src/ble_gap_conn.c     | 123 +++++++++++++++++++++++++++++++++----
 nimble/host/src/ble_gap_conn.h     |  18 +++++-
 3 files changed, 132 insertions(+), 15 deletions(-)

commit 0b52098b15009485ec8b24cf2587d7aeea73382a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 14:06:26 2015 -0800

    Combine all GAP slave connection procedures.
    
    The various discoverability and connectability modes can be "mixed and
    matched," so it doesn't make sense to have separate functions for each.
    Instead, the application specifies both modes in a single function call
    (ble_gap_conn_advertise()).
    
    X-Original-Commit: dc6289454141eeb33cdadd1f218cc4fc939f00a0

 nimble/host/include/host/ble_gap.h      |  18 +-
 nimble/host/src/ble_gap_conn.c          | 316 +++++++++-----------------------
 nimble/host/src/test/ble_hs_conn_test.c |   9 +-
 3 files changed, 104 insertions(+), 239 deletions(-)

commit 3959c808707831339839acf2529738eb68a7a48f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 14:05:48 2015 -0800

    Make maximum number of connections configurable.
    
    X-Original-Commit: 9ef0a5ecc4a234d72652794deb0461a2691f09f4

 nimble/host/include/host/ble_hs.h |  1 +
 nimble/host/src/ble_hs_cfg.c      |  1 +
 nimble/host/src/ble_hs_conn.c     | 14 ++++++++------
 nimble/host/src/ble_hs_conn.h     |  1 +
 4 files changed, 11 insertions(+), 6 deletions(-)

commit f4f0530dc748ed04ddcdc9cdf3d7acbfae9711eb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 21 11:52:42 2015 -0800

    Separate directed and undirected slave connections
    
    X-Original-Commit: d9aa88d232f1a762ee00ff9c7ba3ac21c126c455

 nimble/host/src/ble_gap_conn.c          | 164 ++++++++++++++++++++++++++------
 nimble/host/src/host_hci.c              |   6 ++
 nimble/host/src/test/ble_hs_conn_test.c |  58 ++++++++++-
 nimble/host/src/test/ble_hs_test_util.c |  16 +++-
 nimble/host/src/test/ble_hs_test_util.h |   3 +-
 nimble/include/nimble/hci_common.h      |   4 +-
 6 files changed, 217 insertions(+), 34 deletions(-)

commit 74df380d55990ac1be0aa9d08472b4c6adc6a84e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 18:08:55 2015 -0800

    GAP discoverable and connectable procedures.
    
    X-Original-Commit: fd3c7220fd9794b907b532cdc53ca1d0aa3f1023

 nimble/host/include/host/host_hci.h     |   1 +
 nimble/host/src/ble_gap_conn.c          | 281 ++++++++++++++++++++------------
 nimble/host/src/host_hci_cmd.c          |  15 ++
 nimble/host/src/test/ble_hs_conn_test.c |  19 +--
 nimble/host/src/test/ble_hs_test_util.c |  58 +++++++
 nimble/host/src/test/ble_hs_test_util.h |   5 +
 nimble/include/nimble/hci_common.h      |  37 +++--
 7 files changed, 284 insertions(+), 132 deletions(-)

commit 61fbea3c2036885d0d5200e86a4c647583d71555
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 13:53:24 2015 -0800

    GAP slave modes.
    
    X-Original-Commit: 7510bb5af115e13dc8e9c8aafa3429cb2cb62205

 nimble/host/include/host/ble_gap.h |   7 +-
 nimble/host/src/ble_gap_conn.c     | 488 ++++++++++++++++++++++++++++---------
 2 files changed, 378 insertions(+), 117 deletions(-)

commit 27611029cebf7e07cb399fe85da778fe1f75e4d7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 12:22:35 2015 -0800

    Reduce startup code with generic HCI ack fn.
    
    X-Original-Commit: ecb584ed0a82d06583c0827a253b1ac24c065aa0

 nimble/host/src/ble_hs_startup.c | 176 ++++++++++++++++-----------------------
 1 file changed, 71 insertions(+), 105 deletions(-)

commit 712540bd8d80a5dc25606170b6d8fdbfc83febdb
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 11:42:27 2015 -0800

    Fix startup sequence.
    
    X-Original-Commit: 3171a5ca72898a18c36c21a755ac769aa3fe68c6

 nimble/host/include/host/host_hci.h     |   1 +
 nimble/host/src/ble_hs_startup.c        | 145 +++++++++++++++++++++++++-------
 nimble/host/src/host_hci_cmd.c          |  16 ++++
 nimble/host/src/test/ble_hs_test_util.c |   7 +-
 4 files changed, 139 insertions(+), 30 deletions(-)

commit 2556f368973f9ff4ab471f5433b84f66e6b9d490
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 11:12:10 2015 -0800

    Replace ble_hs rx and tx tpq with mqueue.
    
    X-Original-Commit: 7f94b34354dd48bd1bf9f68393dfe812db2500bc

 nimble/host/src/ble_hs.c      | 109 +++++++++++-------------------------------
 nimble/host/src/ble_hs_priv.h |   2 -
 2 files changed, 29 insertions(+), 82 deletions(-)

commit ffd3f2b27648a2d4f0ace9bc1d21359a3ae17338
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 10:35:59 2015 -0800

    Add GATT congestion test.
    
    X-Original-Commit: aa8482eba5b2688c52cc68d98564217fbdd27b2e

 nimble/host/src/ble_gatt.c                |  4 +++
 nimble/host/src/test/ble_gatt_conn_test.c | 48 +++++++++++++++++++++++++++++++
 2 files changed, 52 insertions(+)

commit e51aebe936843b7194582693baf1531377fc00d3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 10:15:42 2015 -0800

    Add rudimentary configuration.
    
    X-Original-Commit: c2aec1550752289a2b7e51f5490a2c511a0c3cea

 nimble/host/include/host/ble_hs.h       |  5 +++++
 nimble/host/src/ble_hs.c                |  2 ++
 nimble/host/src/ble_hs_cfg.c            | 13 +++++++++++++
 nimble/host/src/ble_hs_conn.c           |  4 +++-
 nimble/host/src/ble_hs_priv.h           |  2 ++
 nimble/host/src/test/ble_hs_test_util.c |  3 +++
 6 files changed, 28 insertions(+), 1 deletion(-)

commit d43d775e42fe4a8cee744ec476fd975c3017e732
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 18 10:01:22 2015 -0800

    Rename ble_gatt_break_test to ble_gatt_conn_test.
    
    X-Original-Commit: 156ac89e03427bae19e11fd6cee14d5cff414ef6

 nimble/host/include/host/ble_hs_test.h             |  2 +-
 ...{ble_gatt_break_test.c => ble_gatt_conn_test.c} | 34 +++++++++++-----------
 nimble/host/src/test/ble_hs_test.c                 |  2 +-
 3 files changed, 19 insertions(+), 19 deletions(-)

commit 7140e733d4ed8fe3a567ec067bc35a0186e09891
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 17 17:04:46 2015 -0800

    Correct some incorrect default GAP timings.
    
    X-Original-Commit: 9930c2beca00403648f3b9f7df87f3ef98738922

 nimble/host/src/ble_gap_conn.c | 20 ++++++++++++++++----
 nimble/host/src/ble_hs_conn.c  | 24 +++++++++++++++++++++---
 2 files changed, 37 insertions(+), 7 deletions(-)

commit 6f16a62039662e318036657f5acc926ecd617772
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 17 16:28:20 2015 -0800

    GATT retries in case of congestion or OOM.
    
    X-Original-Commit: 7092b08b3640e7d4b07951203a64035f08239d99

 nimble/host/include/host/ble_hs.h |   1 +
 nimble/host/src/ble_att_clt.c     |   7 ++
 nimble/host/src/ble_gatt.c        | 130 +++++++++++++++++++++++++++++++++++++-
 nimble/host/src/ble_gatt_priv.h   |   1 +
 nimble/host/src/ble_hs_conn.c     |   7 ++
 nimble/host/src/ble_hs_conn.h     |   1 +
 6 files changed, 145 insertions(+), 2 deletions(-)

commit 152462175e8cb07dc43a43b5616676ac5cc8239c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 17 16:27:21 2015 -0800

    Don't overallocate for ble_hs events.
    
    X-Original-Commit: fac9b7466b05ee15d03436fc739b490b9333c543

 nimble/host/src/ble_hs.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit cb9352d2b61c2d729d9e43f0f1648962b34a6b62
Author: wes3 <will@micosa.io>
Date:   Fri Dec 18 10:16:29 2015 -0800

    Fix the completed packets event; it used to be a continuous counter which was incorrect. It should bea delta from the last time we sent it. Add the HCI reset command. Fix the mbuf pool that the bletest code was allocating; the size of the mbuf was incorrect.
    
    X-Original-Commit: 958a0aedaec426718a6c9cecc87dc7584de92804

 nimble/controller/include/controller/ble_ll.h      |  10 +-
 nimble/controller/include/controller/ble_ll_adv.h  |   6 +
 nimble/controller/include/controller/ble_ll_conn.h |   1 -
 nimble/controller/include/controller/ble_ll_scan.h |   3 +
 nimble/controller/src/ble_ll.c                     |  78 ++++++++++++
 nimble/controller/src/ble_ll_adv.c                 |  29 +++++
 nimble/controller/src/ble_ll_conn.c                | 133 ++++++++++++++-------
 nimble/controller/src/ble_ll_conn_hci.c            |   5 +-
 nimble/controller/src/ble_ll_conn_priv.h           |   1 +
 nimble/controller/src/ble_ll_hci.c                 |  21 +++-
 nimble/controller/src/ble_ll_scan.c                |  37 +++++-
 nimble/drivers/nrf52/src/ble_phy.c                 |  41 +++++--
 nimble/host/include/host/host_hci.h                |   1 +
 nimble/host/src/host_hci_cmd.c                     |   2 +-
 14 files changed, 304 insertions(+), 64 deletions(-)

commit e07aaa3dda7b573310d951ba18d267db6b86ab79
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 17 12:58:12 2015 -0800

    Cancel GATT procedures when connection is broken.
    
    X-Original-Commit: af5a7a729b7dff7ab89c314f8bada5957faf3b26

 nimble/host/include/host/ble_hs_test.h     |   1 +
 nimble/host/src/ble_gap_conn.c             |   2 +
 nimble/host/src/test/ble_gatt_break_test.c | 183 +++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c         |   1 +
 4 files changed, 187 insertions(+)

commit 0280c7d1f61b1ae652b4d6328a2d1c86169ce325
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 17 11:25:12 2015 -0800

    Number of Completed Packets event.
    
    X-Original-Commit: 9d96160469db4b22120332a6d196b62367723f5e

 nimble/host/src/ble_hs_conn.c            | 17 ++++++++
 nimble/host/src/ble_hs_conn.h            |  2 +
 nimble/host/src/host_hci.c               | 38 +++++++++++++++++-
 nimble/host/src/test/ble_host_hci_test.c |  2 +-
 nimble/host/src/test/ble_hs_conn_test.c  | 66 ++++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test_util.c  | 40 ++++++++++++++++++-
 nimble/host/src/test/ble_hs_test_util.h  |  7 ++++
 nimble/include/nimble/hci_common.h       |  4 ++
 8 files changed, 173 insertions(+), 3 deletions(-)

commit a22c3900b6ddcc59998d9f6c616644b130c76535
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 16 17:02:23 2015 -0800

    Rename ble_gap_test to ble_os_test.
    
    X-Original-Commit: abed8b723cf7c28231c693bca7b7695ce6dbff13

 nimble/host/include/host/ble_hs_test.h             |  2 +-
 nimble/host/src/test/ble_hs_test.c                 |  2 +-
 .../src/test/{ble_gap_test.c => ble_os_test.c}     | 58 +++++++++++-----------
 3 files changed, 31 insertions(+), 31 deletions(-)

commit 9ecf42f7452146f91d49b071b926dfcd887141d7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 16 16:58:42 2015 -0800

    Host HCI tx timeouts.
    
    X-Original-Commit: fcc40659b20407545de52b1fd4526bc6844956c0

 nimble/host/include/host/host_hci.h |  1 +
 nimble/host/src/ble_gap_conn.c      |  3 +--
 nimble/host/src/host_hci.c          | 44 +++++++++++++++++++++++++++++++++++--
 3 files changed, 44 insertions(+), 4 deletions(-)

commit 76ce2aefb2bca56976236f558ce8bfc12efc6ecc
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 16 13:51:17 2015 -0800

    GAP Terminate Connection procedure.
    
    X-Original-Commit: a11f6b3debc5d8b3485f5d3d78e33b6edb7e48f0

 nimble/host/include/host/ble_gap.h  |  15 +++-
 nimble/host/src/ble_gap_conn.c      |  95 ++++++++++++++++++-----
 nimble/host/src/ble_gap_conn.h      |   2 +-
 nimble/host/src/ble_hs.c            |   4 +-
 nimble/host/src/ble_hs_conn.c       |   2 -
 nimble/host/src/host_hci.c          |   6 +-
 nimble/host/src/host_hci_cmd.c      |   3 -
 nimble/host/src/test/ble_gap_test.c | 146 +++++++++++++++++++++++++++++++++---
 8 files changed, 229 insertions(+), 44 deletions(-)

commit 45d8a503e6af1d98cb001661cea9cbb2b9701dd3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 16 12:40:21 2015 -0800

    Unit tests for ATT prep write / exec write.
    
    X-Original-Commit: c2b6472e12085c7bb0086eb540688fe7d2d32270

 nimble/host/src/ble_att_cmd.c           |  19 +-
 nimble/host/src/ble_att_cmd.h           |   1 +
 nimble/host/src/ble_att_svr.c           |   4 +-
 nimble/host/src/test/ble_att_svr_test.c | 328 ++++++++++++++++++++++++++------
 4 files changed, 289 insertions(+), 63 deletions(-)

commit bad116ba9c05b0194c7e5058535a109bdf254f86
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 15 15:33:22 2015 -0800

    ATT prepare write and execute write commands.
    
    X-Original-Commit: 762dccc393780191a5544a62f3b507535f1d6534

 nimble/host/include/host/ble_att.h      |  11 +-
 nimble/host/src/ble_att.c               |   2 +
 nimble/host/src/ble_att_cmd.c           | 132 ++++++++++
 nimble/host/src/ble_att_cmd.h           |  52 +++-
 nimble/host/src/ble_att_priv.h          |  19 ++
 nimble/host/src/ble_att_svr.c           | 431 ++++++++++++++++++++++++++++++--
 nimble/host/src/ble_hs.c                |  27 +-
 nimble/host/src/ble_hs_conn.c           |   2 -
 nimble/host/src/ble_hs_conn.h           |   3 +-
 nimble/host/src/ble_hs_misc.c           |  23 ++
 nimble/host/src/ble_hs_priv.h           |   4 +
 nimble/host/src/test/ble_att_svr_test.c |  11 +-
 12 files changed, 664 insertions(+), 53 deletions(-)

commit 201c2088c0ac6a12d5075c6b43e62c87335c9306
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 15 13:55:31 2015 -0800

    ATT write req / cmd tests.
    
    X-Original-Commit: 27f8daf57471d06e16d9c8d66d09981b582d61cb

 nimble/host/src/ble_att_cmd.c           | 20 +++++++++
 nimble/host/src/ble_att_cmd.h           |  2 +
 nimble/host/src/test/ble_att_clt_test.c | 77 +++++++++++++++++++++++++++++++++
 3 files changed, 99 insertions(+)

commit 3f1835328eb7309137239f02af84115409722f1b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 15 13:27:28 2015 -0800

    In GATT write CBs, pass attr val so user can free
    
    X-Original-Commit: 1e3c52912c4a5bee67c0a9bcffa5dca398ad97a1

 nimble/host/include/host/ble_gatt.h        |  8 ++---
 nimble/host/src/ble_gatt.c                 | 48 ++++++++++++++----------------
 nimble/host/src/test/ble_gatt_write_test.c | 14 ++++++---
 3 files changed, 35 insertions(+), 35 deletions(-)

commit 8adda5be5caec22c685e9390ada8782dbe9a10a5
Author: wes3 <will@micosa.io>
Date:   Tue Dec 15 16:48:59 2015 -0800

    Add the number of completed packets event. Starting moving some code from the connection module to other modules. Fix some low duty cycle direct advertising issues.
    
    X-Original-Commit: 2b0f4e8264056935e3e7d3d57cf9f552961da652

 nimble/controller/include/controller/ble_ll.h      |   8 +-
 nimble/controller/include/controller/ble_ll_conn.h |  46 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |   1 +
 nimble/controller/include/controller/ble_ll_hci.h  |  15 +-
 nimble/controller/include/controller/ble_phy.h     |   3 +
 nimble/controller/src/ble_ll.c                     | 139 +++---
 nimble/controller/src/ble_ll_adv.c                 |  21 +-
 nimble/controller/src/ble_ll_conn.c                | 447 +++----------------
 nimble/controller/src/ble_ll_conn_hci.c            | 476 +++++++++++++++++++++
 nimble/controller/src/ble_ll_conn_priv.h           |  87 ++++
 nimble/controller/src/ble_ll_ctrl.c                |   2 +-
 nimble/controller/src/ble_ll_hci.c                 |  33 +-
 nimble/drivers/native/src/ble_phy.c                |  16 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |  16 +-
 nimble/host/src/host_dbg.c                         |  41 ++
 nimble/include/nimble/hci_common.h                 |  61 ++-
 16 files changed, 922 insertions(+), 490 deletions(-)

commit c37acf6c7790b1d0394b67e136416fc4e343c9ee
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 15 12:17:51 2015 -0800

    Add basic GATT characteristic value write tests.
    
    X-Original-Commit: 73db77e601c5cf205c5cf13a2cc290cf580fb0c8

 nimble/host/include/host/ble_gatt.h        |   2 +
 nimble/host/include/host/ble_hs_test.h     |   1 +
 nimble/host/src/ble_gatt.c                 |  64 +++++++-------
 nimble/host/src/test/ble_gatt_write_test.c | 129 +++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c         |   1 +
 5 files changed, 165 insertions(+), 32 deletions(-)

commit e113e1890da15546139d372ee101f914d664a132
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 15 12:02:11 2015 -0800

    Add additional characteristic-discovery tests.
    
    X-Original-Commit: 7d4a56096f8a0b68c651d2568e75486d69cff0c1

 nimble/host/src/test/ble_gatt_disc_c_test.c | 68 +++++++++++++++++++++--------
 1 file changed, 51 insertions(+), 17 deletions(-)

commit 31e32cda2305e2e1e4a7eb7484f49d0bc2b1483e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 14 19:59:25 2015 -0800

    GATT write without rsp, write char value procs.
    
    X-Original-Commit: 2254c0aa98ab287176e2b42007c64b66a0024ced

 nimble/host/include/host/ble_att.h          |   1 +
 nimble/host/include/host/ble_gatt.h         |  22 ++--
 nimble/host/src/ble_att.c                   |   1 +
 nimble/host/src/ble_att_clt.c               |  97 ++++++++++++++-
 nimble/host/src/ble_att_cmd.c               |  21 +++-
 nimble/host/src/ble_att_cmd.h               |   4 +-
 nimble/host/src/ble_att_priv.h              |  10 ++
 nimble/host/src/ble_att_svr.c               |   4 +-
 nimble/host/src/ble_gatt.c                  | 178 +++++++++++++++++++++++++++-
 nimble/host/src/ble_gatt_priv.h             |  17 +++
 nimble/host/src/ble_hs.c                    |   2 +-
 nimble/host/src/test/ble_att_svr_test.c     |   2 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c |   2 +-
 nimble/host/src/test/ble_gatt_read_test.c   |   2 +-
 14 files changed, 335 insertions(+), 28 deletions(-)

commit d23aa8c42c97edec9b85bc01e0dc42c13cb7b156
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 14 18:07:12 2015 -0800

    Notify application of rxed advertisement reports.
    
    X-Original-Commit: 94311f0442f136e0772d99d2fd0efe524d2e4d72

 nimble/host/include/host/ble_gap.h  | 26 +++++++++-
 nimble/host/src/ble_gap_conn.c      | 96 ++++++++++++++++++++++++++++---------
 nimble/host/src/ble_gap_conn.h      |  4 +-
 nimble/host/src/host_hci.c          | 93 +++++++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_gap_test.c | 15 +++---
 nimble/include/nimble/hci_common.h  |  7 +++
 6 files changed, 206 insertions(+), 35 deletions(-)

commit 0f593c935274b35d119afeabfb4a89877fbed3e3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 14 16:18:28 2015 -0800

    Add additional connection establishment tests.
    
    X-Original-Commit: 75e3cd0bbe16babec0eb30afc63c4c8f2980dd8a

 nimble/host/src/test/ble_hs_conn_test.c | 57 +++++++++++++++++++++++++++++----
 1 file changed, 51 insertions(+), 6 deletions(-)

commit 762949e25e7b4af86c1cdd12b4ed1dda368e990e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 14 16:04:53 2015 -0800

    Add connection timer for general discovery.
    
    X-Original-Commit: 6a864b999b7a4d02455c979fabe85473cdd2ead3

 nimble/host/include/host/ble_gap.h      |   2 +-
 nimble/host/src/ble_gap_conn.c          | 123 ++++++++++++++++++++++++++------
 nimble/host/src/test/ble_gap_test.c     | 101 ++++++++++++++++++++++----
 nimble/host/src/test/ble_hs_test_util.c |  12 ++++
 nimble/host/src/test/ble_hs_test_util.h |   1 +
 5 files changed, 203 insertions(+), 36 deletions(-)

commit 8d17c51ecb64609c2fe5f1a5be0b9dd268a68c4c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 14 14:32:29 2015 -0800

    Initial implementation of startup sequence.
    
    X-Original-Commit: 7ceb89dcc40ef8f96ec98c1f06e8a48b49b00e3a

 nimble/host/src/ble_hci_sched.c     |  16 ++++
 nimble/host/src/ble_hci_sched.h     |  16 ++++
 nimble/host/src/ble_hs.c            |  29 ++------
 nimble/host/src/ble_hs_startup.c    | 144 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_startup.h    |  22 ++++++
 nimble/host/src/test/ble_gap_test.c |   9 ++-
 6 files changed, 210 insertions(+), 26 deletions(-)

commit 7071b20b9022595ccdbafcf3c9ae008b92d35d1a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 14 12:12:33 2015 -0800

    Move ble_gap.c to ble_gap_conn.c.
    
    X-Original-Commit: eea8a48c597ac6cc46475ffe94a8652eb5942a71

 nimble/host/include/host/ble_gap.h      |   8 +-
 nimble/host/src/ble_gap.c               | 115 -------
 nimble/host/src/ble_gap_conn.c          | 557 ++++++++++++++++++--------------
 nimble/host/src/test/ble_gap_test.c     |   4 +-
 nimble/host/src/test/ble_hs_conn_test.c |   6 +-
 nimble/host/src/test/ble_hs_test_util.c |   2 +-
 6 files changed, 320 insertions(+), 372 deletions(-)

commit 0276afa7568ac32bf77fdc994eb2b09b8d2eb0a4
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 11 13:51:08 2015 -0800

    Generic HCI command queue.
    
    X-Original-Commit: 6d66ff88c911252a327ce8cd07477fb863cf2786

 nimble/host/include/host/ble_hs.h       |   1 +
 nimble/host/src/ble_gap.c               |  33 ++-----
 nimble/host/src/ble_gap_conn.c          | 170 +++++++++++++++++++++-----------
 nimble/host/src/ble_hci_ack.c           |   4 +
 nimble/host/src/ble_hci_sched.c         | 158 +++++++++++++++++++++++++++++
 nimble/host/src/ble_hci_sched.h         |  11 +++
 nimble/host/src/ble_hs.c                |  19 +++-
 nimble/host/src/ble_hs_hci_batch.c      | 170 --------------------------------
 nimble/host/src/ble_hs_hci_batch.h      |  55 -----------
 nimble/host/src/test/ble_gap_test.c     |   3 +-
 nimble/host/src/test/ble_hs_conn_test.c |  10 +-
 nimble/host/src/test/ble_hs_test_util.c |   4 +-
 12 files changed, 320 insertions(+), 318 deletions(-)

commit 4d3c884b0da77ff3ae793f491d84954a88deeb2c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 11 12:47:22 2015 -0800

    Rename ble_hs_ack to ble_hci_ack for consistency.
    
    X-Original-Commit: c2d99ecc6be93ffbc1c73133e0fc99b50dfece9f

 nimble/host/src/ble_gap_conn.c                  | 22 +++++++++---------
 nimble/host/src/ble_gap_conn.h                  |  2 +-
 nimble/host/src/{ble_hs_ack.c => ble_hci_ack.c} | 30 ++++++++++++-------------
 nimble/host/src/{ble_hs_ack.h => ble_hci_ack.h} | 14 ++++++------
 nimble/host/src/ble_hs.c                        |  4 ++--
 nimble/host/src/ble_hs_hci_batch.c              |  6 ++---
 nimble/host/src/host_hci.c                      | 10 ++++-----
 nimble/host/src/host_hci_cmd.c                  |  4 ++--
 nimble/host/src/test/ble_hs_conn_test.c         |  2 +-
 nimble/host/src/test/ble_hs_test_util.c         |  2 +-
 10 files changed, 48 insertions(+), 48 deletions(-)

commit d6dc477fe38982baa5993daad8067c6e930599b2
Author: wes3 <will@micosa.io>
Date:   Sun Dec 13 23:00:05 2015 -0800

    Add disconnect command and code to terminate a connection
    
    X-Original-Commit: 8323f4b76fb8440d8937e0b9401d6dc932afa7b2

 nimble/controller/include/controller/ble_ll.h      |   1 +
 nimble/controller/include/controller/ble_ll_conn.h |  23 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |   5 +
 nimble/controller/include/controller/ble_ll_hci.h  |   5 +-
 nimble/controller/src/ble_ll.c                     |   2 +-
 nimble/controller/src/ble_ll_conn.c                | 273 ++++++++++++++++++---
 nimble/controller/src/ble_ll_ctrl.c                |  80 +++++-
 nimble/controller/src/ble_ll_hci.c                 | 129 +++++++++-
 nimble/host/include/host/host_hci.h                |   2 +
 nimble/host/src/ble_hs.c                           |   2 +-
 nimble/host/src/host_dbg.c                         |  29 +++
 nimble/host/src/host_hci.c                         |  14 --
 nimble/host/src/host_hci_cmd.c                     |  54 +++-
 nimble/include/nimble/hci_common.h                 |   7 +
 14 files changed, 553 insertions(+), 73 deletions(-)

commit 8f030f1236a5eb67e955f5e9c0c18aa7a69b1f0a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 10 19:02:49 2015 -0800

    GAP General Discovery procedure.
    
    X-Original-Commit: 6377a6941e19bf8c0d5e8907580a70fd089ceb4f

 nimble/host/include/host/ble_gap.h |   1 +
 nimble/host/src/ble_gap.c          |  24 ++++++++
 nimble/host/src/ble_gap_conn.c     | 117 +++++++++++++++++++++++++++++--------
 nimble/host/src/ble_gap_conn.h     |   1 +
 nimble/host/src/ble_hs_hci_batch.c |   4 ++
 nimble/host/src/ble_hs_hci_batch.h |   3 +-
 6 files changed, 124 insertions(+), 26 deletions(-)

commit 00061f895f0f186a7842552fcdcd42eccc2c373a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 10 18:10:27 2015 -0800

    Reduce number of host mbufs to 8.
    
    X-Original-Commit: aa7f48779d56bcda685bfcb44c68ec6b7d971217

 nimble/host/src/ble_hs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f6be92693c123794cee3257f958351aa9d160fd2
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 10 16:08:57 2015 -0800

    Move ble host membufs from heap to bss.
    
    X-Original-Commit: c855c828c19fcde38c4604d1ca7fdfc96f795de0

 nimble/host/src/ble_hs.c | 12 ++----------
 1 file changed, 2 insertions(+), 10 deletions(-)

commit ec3db596f8fa38028b148095b806c7e41aea4005
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 10 12:59:39 2015 -0800

    Fix server side ATT read-by-group-type
    
    Vol. 3, Part G, 3.1:
    "All Attributes on a Server shall either contain a service declaration or exist
    within a service definition."
    
    X-Original-Commit: c45b1c4acd0b6a9595a4bebc7a60058541bbbf70

 nimble/host/src/ble_att_svr.c           | 15 +-------
 nimble/host/src/test/ble_att_svr_test.c | 67 ++++++++++++++-------------------
 2 files changed, 30 insertions(+), 52 deletions(-)

commit 3f7e09e6887a04bfbdc331014ef6b5791064ab4e
Author: wes3 <will@micosa.io>
Date:   Thu Dec 10 10:04:07 2015 -0800

    Fix a number of issues with high duty cycle advertising and direct advertising in general.
    
    X-Original-Commit: 4a12d183bb2234c8ad807eea4241cd7713eb7b08

 nimble/controller/include/controller/ble_ll_adv.h  |   3 +
 nimble/controller/include/controller/ble_ll_conn.h |   9 +-
 nimble/controller/src/ble_ll.c                     |  10 +-
 nimble/controller/src/ble_ll_adv.c                 | 153 +++++++++++++++++----
 nimble/controller/src/ble_ll_conn.c                |   8 +-
 nimble/controller/src/ble_ll_ctrl.c                |  24 ++--
 6 files changed, 148 insertions(+), 59 deletions(-)

commit b6b082563451944fb1bb9d436f25f9b4d6f7ddb9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 18:51:29 2015 -0800

    Add characteristic discovery and reads to proj.
    
    X-Original-Commit: cabd20eb775ff76981263c74d777e86553e54cdc

 nimble/host/src/ble_gatt.c | 2 ++
 1 file changed, 2 insertions(+)

commit 110cbce4322e0e9a793b4274f04c776a4599e382
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 18:51:02 2015 -0800

    Fix response format for characteristic discovery.
    
    X-Original-Commit: 3568947439a0711221c0e4e78dc1cd3613a64785

 nimble/host/include/host/ble_gatt.h         |  13 +++-
 nimble/host/include/host/ble_hs.h           |   1 +
 nimble/host/src/ble_att_clt.c               |   4 +
 nimble/host/src/ble_att_priv.h              |   2 +-
 nimble/host/src/ble_att_svr.c               |   2 +-
 nimble/host/src/ble_gatt.c                  |  80 +++++++++++++-------
 nimble/host/src/ble_gatt_priv.h             |  25 ++++++
 nimble/host/src/ble_hs.c                    |   2 +-
 nimble/host/src/ble_l2cap.c                 |  15 +++-
 nimble/host/src/host_hci_cmd.c              |   1 -
 nimble/host/src/test/ble_gatt_disc_c_test.c | 113 ++++++++++++++++++----------
 11 files changed, 181 insertions(+), 77 deletions(-)

commit 6c55d72806408cb1501d834739be45df37cb231c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 14:26:37 2015 -0800

    Split ble_hs.h into a public and private header.
    
    X-Original-Commit: 8c0118a14ba250fb55d6f3008045d8657605c8c2

 nimble/host/include/host/ble_hs.h        | 31 +++++++------------------
 nimble/host/src/ble_att.c                |  2 +-
 nimble/host/src/ble_att_clt.c            |  2 +-
 nimble/host/src/ble_att_cmd.c            |  2 +-
 nimble/host/src/ble_att_svr.c            |  2 +-
 nimble/host/src/ble_gap.c                |  2 +-
 nimble/host/src/ble_gap_conn.c           |  2 +-
 nimble/host/src/ble_gatt.c               |  2 +-
 nimble/host/src/ble_hs.c                 |  2 +-
 nimble/host/src/ble_hs_conn.c            |  2 +-
 nimble/host/src/ble_hs_hci_batch.c       |  2 +-
 nimble/host/src/ble_hs_priv.h            | 39 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_uuid.c            |  2 +-
 nimble/host/src/ble_l2cap.c              |  2 +-
 nimble/host/src/host_hci.c               |  2 +-
 nimble/host/src/host_hci_cmd.c           |  2 +-
 nimble/host/src/test/ble_att_clt_test.c  |  2 +-
 nimble/host/src/test/ble_att_svr_test.c  |  2 +-
 nimble/host/src/test/ble_gap_test.c      |  2 +-
 nimble/host/src/test/ble_host_hci_test.c |  2 +-
 nimble/host/src/test/ble_hs_conn_test.c  |  2 +-
 nimble/host/src/test/ble_hs_test.c       |  2 +-
 nimble/host/src/test/ble_hs_test_util.c  |  2 +-
 nimble/host/src/test/ble_l2cap_test.c    |  2 +-
 24 files changed, 69 insertions(+), 45 deletions(-)

commit 66c5a929c5723403c22e13632fbe5b71d4bdae96
Author: wes3 <will@micosa.io>
Date:   Wed Dec 9 16:56:50 2015 -0800

    Implement data length change procedure. Now the advertiser does not stop advertising after 60 seconds. Advertising will end only if there is a connection
    
    X-Original-Commit: 05254c74ca8854d6d8f2d595ec35c2f17fed7770

 nimble/controller/include/controller/ble_ll.h      |  26 +-
 nimble/controller/include/controller/ble_ll_conn.h |  14 +-
 nimble/controller/include/controller/ble_ll_ctrl.h |   7 +-
 nimble/controller/src/ble_ll.c                     |  48 +++-
 nimble/controller/src/ble_ll_conn.c                | 122 ++++++--
 nimble/controller/src/ble_ll_ctrl.c                | 320 +++++++++++++++++++--
 nimble/controller/src/ble_ll_hci.c                 |   1 +
 nimble/host/src/host_dbg.c                         |   8 +-
 8 files changed, 470 insertions(+), 76 deletions(-)

commit 21a3d601fe09bb6a7fb4c01760c4a85b1ea09524
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 13:50:08 2015 -0800

    Replace posix errno code with ble_hs codes.
    
    X-Original-Commit: 36b80fae3089636478b28cc366763ab49fd36840

 nimble/host/include/host/ble_hs.h        | 11 ++++-
 nimble/host/include/host/host_hci.h      |  3 +-
 nimble/host/src/ble_att.c                |  4 +-
 nimble/host/src/ble_att_clt.c            | 48 ++++++++++-----------
 nimble/host/src/ble_att_cmd.c            | 67 ++++++++++++++---------------
 nimble/host/src/ble_att_svr.c            | 73 +++++++++++++++++---------------
 nimble/host/src/ble_gap.c                |  5 ++-
 nimble/host/src/ble_gap_conn.c           | 13 +++---
 nimble/host/src/ble_gatt.c               | 34 +++++++++------
 nimble/host/src/ble_hs.c                 | 18 ++++----
 nimble/host/src/ble_hs_conn.c            |  4 +-
 nimble/host/src/ble_hs_hci_batch.c       |  4 +-
 nimble/host/src/ble_hs_uuid.c            |  9 ++--
 nimble/host/src/ble_l2cap.c              | 12 +++---
 nimble/host/src/host_hci.c               | 26 ++++++------
 nimble/host/src/test/ble_att_clt_test.c  |  5 ++-
 nimble/host/src/test/ble_host_hci_test.c | 10 ++---
 nimble/host/src/test/ble_l2cap_test.c    |  4 +-
 18 files changed, 189 insertions(+), 161 deletions(-)

commit e3a1385164af9b139e697cd0866cc4f278159ecc
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 12:58:35 2015 -0800

    Provide two error codes for GATT callbacks.
    
    X-Original-Commit: 6735a4a5e91033c69a2236d72f967b792f45da1f

 nimble/host/include/host/ble_gatt.h         |  11 +-
 nimble/host/src/ble_att_clt.c               |   2 +-
 nimble/host/src/ble_gatt.c                  | 216 ++++++++++++++--------------
 nimble/host/src/test/ble_gatt_disc_c_test.c |   7 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c |  19 +--
 nimble/host/src/test/ble_gatt_read_test.c   |   7 +-
 6 files changed, 134 insertions(+), 128 deletions(-)

commit ce79d6fc06fe2547a069fa66c2aff6ae7e4eabb6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 12:00:00 2015 -0800

    GATT: always call cb when something fails.
    
    X-Original-Commit: 7c4be5990e8365a98b12166d5987f0055378ee0b

 nimble/host/src/ble_gatt.c | 141 ++++++++++++++++++++++++++++++++++++---------
 1 file changed, 114 insertions(+), 27 deletions(-)

commit 8bb3945ffbc9acdc115941a14e658280dff958c7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 11:43:27 2015 -0800

    Organize GATT code by procedure.
    
    X-Original-Commit: 2844303f5e4a30dfce116dc3da2e4f75a9ab4514

 nimble/host/src/ble_gatt.c | 546 ++++++++++++++++++++++++---------------------
 1 file changed, 296 insertions(+), 250 deletions(-)

commit 8a346bb4d8a8eedf8df32b40764b8c10741899ab
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 9 11:11:32 2015 -0800

    Use util rxerr function in host test code.
    
    X-Original-Commit: d85dc98fb6f6a8b0b87ddc15c4dd70475e5575bd

 nimble/host/src/test/ble_att_svr_test.c     |  9 +++----
 nimble/host/src/test/ble_gatt_disc_c_test.c | 33 +++---------------------
 nimble/host/src/test/ble_gatt_disc_s_test.c | 40 ++++++-----------------------
 nimble/host/src/test/ble_hs_test_util.c     | 24 +++++++++++++++++
 nimble/host/src/test/ble_hs_test_util.h     |  3 ++-
 5 files changed, 42 insertions(+), 67 deletions(-)

commit 0904952af7ec6baaeb5f9bc10806ac5ccdc18331
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 8 20:34:18 2015 -0800

    Add ATT read by group type tests.
    
    X-Original-Commit: 65d4b7b4340354065e1ca278ca5110b25cccf45e

 nimble/host/include/host/ble_att.h      |   8 +
 nimble/host/src/ble_att_clt.c           |   3 +-
 nimble/host/src/ble_att_priv.h          |   7 -
 nimble/host/src/ble_att_svr.c           |  25 +-
 nimble/host/src/test/ble_att_svr_test.c | 414 +++++++++++++++++++++++++++++++-
 5 files changed, 435 insertions(+), 22 deletions(-)

commit c7ef6e5345574fec61061e9fe6b2dfe73e2052be
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 8 18:37:57 2015 -0800

    ATT read by group type; fix bugs.
    
    X-Original-Commit: c1ac77ce1231b259ea0283745fe145f83143d4a5

 nimble/host/include/host/ble_att.h      |  63 ++++---
 nimble/host/src/ble_att.c               |  21 +++
 nimble/host/src/ble_att_clt.c           | 107 ++++++------
 nimble/host/src/ble_att_cmd.h           |   2 +
 nimble/host/src/ble_att_priv.h          |   4 +
 nimble/host/src/ble_att_svr.c           | 301 +++++++++++++++++++++++++++++++-
 nimble/host/src/ble_gatt.c              |   3 -
 nimble/host/src/ble_hs.c                |   2 +-
 nimble/host/src/ble_hs_uuid.c           |   2 +-
 nimble/host/src/ble_l2cap.c             |   4 +-
 nimble/host/src/host_hci.c              |  21 ++-
 nimble/host/src/test/ble_hs_test_util.c |   3 +-
 nimble/host/src/test/ble_l2cap_test.c   |   2 +-
 13 files changed, 445 insertions(+), 90 deletions(-)

commit 275f44874fdc342627c3a5aa85fc71f56b7b4f20
Author: wes3 <will@micosa.io>
Date:   Tue Dec 8 14:14:32 2015 -0800

    Fix some connection bugs where I might not hand up all received PDUs. Fix bug in checking pb bits from host. Add start of LL control
    
    X-Original-Commit: 6b0845f4b1b3afbb23a9f56e3dbe56a298cd4681

 nimble/controller/include/controller/ble_ll.h      | 172 -----------------
 nimble/controller/include/controller/ble_ll_conn.h |   4 +
 nimble/controller/include/controller/ble_ll_ctrl.h |  22 +++
 nimble/controller/src/ble_ll.c                     |   1 +
 nimble/controller/src/ble_ll_adv.c                 |   2 +-
 nimble/controller/src/ble_ll_conn.c                |  85 ++++++---
 nimble/controller/src/ble_ll_ctrl.c                | 210 +++++++++++++++++++++
 7 files changed, 293 insertions(+), 203 deletions(-)

commit 78f00d5d52b83eae639018aa7423db6bba1c3e47
Author: wes3 <will@micosa.io>
Date:   Mon Dec 7 09:03:32 2015 -0800

    Move connection state machine structure definition to ble_ll_conn.h. No longer use memory pool for connections; just use an array (saves memory and code).
    
    X-Original-Commit: e5c758382fc194aa1c0f475d130f8949f0b7dc88

 nimble/controller/include/controller/ble_ll_conn.h | 107 +++++++++++
 nimble/controller/src/ble_ll_conn.c                | 200 +++++----------------
 nimble/include/nimble/hci_common.h                 |   1 +
 3 files changed, 153 insertions(+), 155 deletions(-)

commit ed2dfc1d5faac82e15c38f21aab34e667be8260e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 7 19:17:11 2015 -0800

    Fix ble host tests; I wasn't stripping the HCI hdr
    
    X-Original-Commit: cc3af6efc6a516fb4a0cd27b37d9e549af997621

 nimble/host/src/test/ble_att_svr_test.c | 2 +-
 nimble/host/src/test/ble_hs_test.c      | 5 +++--
 2 files changed, 4 insertions(+), 3 deletions(-)

commit 1b77121cfaa3608bfe643bf9abfbfcd6ae03de5f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Dec 7 18:56:09 2015 -0800

    Move some code around to expose some functions.
    
    X-Original-Commit: 225b7f36ab6fcac4db08f7ddf774385a2427168a

 nimble/host/include/host/ble_att.h              | 70 +++++++++++++++++++++++++
 nimble/host/{src => include/host}/ble_hs_uuid.h |  0
 nimble/host/src/ble_att.c                       |  2 +-
 nimble/host/src/ble_att_clt.c                   | 21 ++++----
 nimble/host/src/ble_att_cmd.c                   |  3 +-
 nimble/host/src/ble_att_cmd.h                   | 16 ------
 nimble/host/src/{ble_att.h => ble_att_priv.h}   | 55 ++-----------------
 nimble/host/src/ble_att_svr.c                   | 42 ++++++++-------
 nimble/host/src/ble_gap_conn.c                  |  9 ++--
 nimble/host/src/ble_gatt.c                      |  4 +-
 nimble/host/src/ble_hs.c                        |  7 ++-
 nimble/host/src/ble_hs_conn.c                   |  2 +-
 nimble/host/src/ble_hs_conn.h                   |  2 +-
 nimble/host/src/ble_hs_uuid.c                   |  2 +-
 nimble/host/src/ble_l2cap.c                     |  6 ++-
 nimble/host/src/ble_l2cap.h                     |  3 +-
 nimble/host/src/host_hci.c                      |  3 ++
 nimble/host/src/test/ble_att_clt_test.c         |  2 +-
 nimble/host/src/test/ble_att_svr_test.c         |  2 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c     |  2 +-
 nimble/host/src/test/ble_gatt_disc_s_test.c     |  2 +-
 nimble/host/src/test/ble_gatt_read_test.c       |  2 +-
 nimble/host/src/test/ble_host_hci_test.c        |  2 +-
 nimble/host/src/test/ble_hs_conn_test.c         |  2 +-
 nimble/host/src/test/ble_hs_uuid_test.c         |  2 +-
 25 files changed, 143 insertions(+), 120 deletions(-)

commit 6c9e04e3456c226bf895cfc60e75907d2801346b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 19:16:16 2015 -0800

    Add missing copyright header.
    
    X-Original-Commit: a98cde0f59a696b778347f20e94da39969340426

 nimble/host/include/host/ble_gatt.h | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

commit bcd51b8a397b68f82cc9269341a232d6aeaa9752
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 19:13:09 2015 -0800

    Add tests for GATT Read Characteristic Value.
    
    X-Original-Commit: 3ba0a1fc867bb3332b4ce8cdc1190f7fe2fa6ac3

 nimble/host/include/host/ble_hs_test.h    |   1 +
 nimble/host/src/test/ble_gatt_read_test.c | 126 ++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c        |   1 +
 3 files changed, 128 insertions(+)

commit b7d51e3b68da1953b7431fbc4998d1df5ded1af7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 18:48:03 2015 -0800

    GATT Read Characteristic Value procedure.
    
    X-Original-Commit: 248ae725435544b4d1c6bde5ea27cd1ce2bc1133

 nimble/host/include/host/ble_gatt.h |   4 ++
 nimble/host/src/ble_att.c           |   1 +
 nimble/host/src/ble_att.h           |  25 +++++----
 nimble/host/src/ble_att_clt.c       | 107 +++++++++++++++++++++++-------------
 nimble/host/src/ble_att_cmd.h       |   2 +-
 nimble/host/src/ble_gatt.c          |  94 ++++++++++++++++++++++++++++++-
 6 files changed, 182 insertions(+), 51 deletions(-)

commit d1eb4efe8ef0ba5e819b42eb5e2e4095dd16820e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 18:16:16 2015 -0800

    Remove dummy "find info" GATT procedure.
    
    X-Original-Commit: 3b14a945d6b647063c36578620d59920a7d5c767

 nimble/host/include/host/ble_gatt.h |  4 --
 nimble/host/src/ble_att_clt.c       | 19 ++------
 nimble/host/src/ble_gatt.c          | 93 ++-----------------------------------
 3 files changed, 9 insertions(+), 107 deletions(-)

commit 3cc1819a52f81d749f3ca6dcf19cc308b695e42a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 18:06:21 2015 -0800

    Add tests for discover characteristics GATT proc
    
    X-Original-Commit: b4241d69a5ad1f495893eb4fcbb1167ba81e0770

 nimble/host/include/host/ble_hs_test.h      |   1 +
 nimble/host/src/ble_att_cmd.h               |   2 +-
 nimble/host/src/ble_gatt.c                  |   2 +
 nimble/host/src/ble_hs.c                    |  14 +-
 nimble/host/src/test/ble_gatt_disc_c_test.c | 271 ++++++++++++++++++++++++++++
 nimble/host/src/test/ble_gatt_disc_s_test.c |   9 +-
 nimble/host/src/test/ble_hs_test.c          |   1 +
 7 files changed, 288 insertions(+), 12 deletions(-)

commit e3fa80a6c7ddffd88c5ee4baa9733137ff2215be
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 16:15:44 2015 -0800

    GATT Discover All Characteristics procedure.
    
    X-Original-Commit: 090d9fb3df27ba9d786ef856131baac028655a60

 nimble/host/include/host/ble_gatt.h |  14 ++++
 nimble/host/src/ble_att_clt.c       |   4 +-
 nimble/host/src/ble_gatt.c          | 142 +++++++++++++++++++++++++++++++++++-
 3 files changed, 156 insertions(+), 4 deletions(-)

commit 3dbd9cd30772c6e2bad342f41f4b6eeba8e0aa57
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 15:44:26 2015 -0800

    ATT Read By Type client-side.
    
    X-Original-Commit: 380c4b435eee199db3c2b46fbbbd60ce1048fd58

 nimble/host/src/ble_att.c     |   3 +-
 nimble/host/src/ble_att.h     |  13 +++--
 nimble/host/src/ble_att_clt.c | 117 ++++++++++++++++++++++++++++++++++++++++--
 nimble/host/src/ble_att_cmd.c |   8 +--
 nimble/host/src/ble_att_cmd.h |  12 +++--
 nimble/host/src/ble_att_svr.c |   7 ++-
 6 files changed, 138 insertions(+), 22 deletions(-)

commit 0878fe2e35884a8875b4327bdbbf3085137c4f4a
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 15:31:00 2015 -0800

    Rearrange some att client functions to match spec.
    
    X-Original-Commit: 300c33ce6561ed521e2d25db0c5a14b094623a42

 nimble/host/src/ble_att.h     |  12 ++--
 nimble/host/src/ble_att_clt.c | 144 +++++++++++++++++++++---------------------
 2 files changed, 78 insertions(+), 78 deletions(-)

commit 557f26f22b64216b4c2f47c9c55dc46239986398
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 15:26:12 2015 -0800

    Split service disc. tests from other GATT tests.
    
    X-Original-Commit: e0e22e136a8818e6718c5ca158a9d1591854cf10

 nimble/host/include/host/ble_hs_test.h             |   2 +-
 .../{ble_gatt_test.c => ble_gatt_disc_s_test.c}    | 143 +++++++++++----------
 nimble/host/src/test/ble_hs_test.c                 |   2 +-
 3 files changed, 77 insertions(+), 70 deletions(-)

commit 555950db6be7709b81e606ef6fcd938af1d1cccf
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 15:03:16 2015 -0800

    Some renaming for consistency.
    
    X-Original-Commit: dde460fe6b7724ea102e6b5e17a31095399a93d6

 nimble/host/src/ble_att_clt.c                      | 25 +++---
 nimble/host/src/ble_att_cmd.c                      | 74 ++++++++---------
 nimble/host/src/ble_att_cmd.h                      | 60 +++++++-------
 nimble/host/src/ble_att_svr.c                      | 52 ++++++------
 nimble/host/src/ble_gatt.c                         | 24 +++---
 .../{ble_hs_att_clt_test.c => ble_att_clt_test.c}  | 22 +++---
 .../{ble_hs_att_svr_test.c => ble_att_svr_test.c}  | 92 +++++++++++-----------
 nimble/host/src/test/ble_gatt_test.c               | 10 +--
 8 files changed, 180 insertions(+), 179 deletions(-)

commit 9453e9b4673b89c30607fc30a230909f2677dfde
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 14:41:29 2015 -0800

    GATT Discover Primary Service by Service UUID proc
    
    X-Original-Commit: 941319ca0a1a360680be8d3c96683f9e296bc7da

 nimble/host/include/host/ble_gatt.h        |   8 +-
 nimble/host/src/ble_att.c                  |   2 +
 nimble/host/src/ble_att.h                  |   9 ++
 nimble/host/src/ble_att_clt.c              | 135 +++++++++++++++++-
 nimble/host/src/ble_att_cmd.c              |   4 +-
 nimble/host/src/ble_att_cmd.h              |   5 +-
 nimble/host/src/ble_att_svr.c              |  10 +-
 nimble/host/src/ble_gatt.c                 | 218 ++++++++++++++++++++++++++---
 nimble/host/src/test/ble_gatt_test.c       | 207 +++++++++++++++++++++++++--
 nimble/host/src/test/ble_hs_att_svr_test.c |   4 +-
 10 files changed, 552 insertions(+), 50 deletions(-)

commit 4a655f34aa666e520984e1797224ba3776aa12cd
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Dec 4 11:12:53 2015 -0800

    Add additional GATT tests and fix UUID endianness.
    
    X-Original-Commit: f396cc2bf5e23448aad083305a65180c8cc9216c

 nimble/host/src/ble_hs_uuid.c              |  17 ++--
 nimble/host/src/test/ble_gatt_test.c       | 122 +++++++++++++++++++++++------
 nimble/host/src/test/ble_hs_att_svr_test.c |  15 ++--
 nimble/host/src/test/ble_hs_uuid_test.c    |  36 +++++----
 4 files changed, 134 insertions(+), 56 deletions(-)

commit 6c9f54b5aa56da7d1893869958f9eab60d4e9aa3
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 3 18:54:13 2015 -0800

    GATT Discover All Primary Services procedure.
    
    X-Original-Commit: f945610a8b07b90f23b58ed88eeb738de16ef6ab

 nimble/host/include/host/ble_gatt.h        |   4 +-
 nimble/host/include/host/ble_hs_test.h     |   1 +
 nimble/host/src/ble_att.c                  |   1 +
 nimble/host/src/ble_att.h                  |   1 +
 nimble/host/src/ble_att_clt.c              |  20 ++--
 nimble/host/src/ble_att_cmd.h              |  36 +++----
 nimble/host/src/ble_gap_conn.c             |   1 +
 nimble/host/src/ble_gatt.c                 |  52 ++++++++--
 nimble/host/src/ble_hs.c                   |  17 ++--
 nimble/host/src/ble_hs_conn.c              |   4 +-
 nimble/host/src/ble_l2cap.c                |   4 +-
 nimble/host/src/test/ble_gatt_test.c       | 151 +++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_att_clt_test.c |   7 +-
 nimble/host/src/test/ble_hs_test.c         |   1 +
 nimble/host/src/test/ble_hs_test_util.c    |   8 +-
 nimble/host/src/test/ble_hs_test_util.h    |   3 +-
 16 files changed, 259 insertions(+), 52 deletions(-)

commit 106069e3406b114f7316edc43bb899cafe432ffa
Author: wes3 <will@micosa.io>
Date:   Thu Dec 3 15:35:42 2015 -0800

    Fix a number of connection issues including crcinit and wait for response timer. Also added code to clear outstanding opcode for test project so host does not crash
    
    X-Original-Commit: 568f0c68213651336e2a0208dd696d5a1a1f1cc6

 nimble/controller/include/controller/ble_ll.h |  22 +++++
 nimble/controller/src/ble_ll.c                |  46 ++++++++++-
 nimble/controller/src/ble_ll_adv.c            |   4 +-
 nimble/controller/src/ble_ll_conn.c           | 113 ++++++++++++++++++++------
 nimble/controller/src/ble_ll_hci.c            |  19 +++--
 nimble/drivers/nrf52/src/ble_phy.c            |  17 ++--
 nimble/host/src/host_dbg.c                    |   8 +-
 nimble/host/src/host_hci_cmd.c                |   2 +-
 8 files changed, 184 insertions(+), 47 deletions(-)

commit f3cd3148b81fcb731b77eeb95a91f2fb39c8862b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 3 14:33:06 2015 -0800

    Add calls to os_mbuf_pullup; more GATT.
    
    X-Original-Commit: bf65252ed86acd84ab3f1219ae1fbd2ddbb31c58

 nimble/host/include/host/ble_gatt.h        |  18 +++
 nimble/host/src/ble_att.c                  |   8 +-
 nimble/host/src/ble_att.h                  |  34 ++---
 nimble/host/src/ble_att_clt.c              | 204 +++++------------------------
 nimble/host/src/ble_att_cmd.c              |  74 +++++------
 nimble/host/src/ble_att_cmd.h              |   4 +-
 nimble/host/src/ble_att_svr.c              | 115 ++++++++--------
 nimble/host/src/ble_gatt.c                 | 110 +++++++++++++++-
 nimble/host/src/ble_hs.c                   |   5 -
 nimble/host/src/ble_hs_conn.c              |   2 -
 nimble/host/src/ble_l2cap.c                |   2 +-
 nimble/host/src/ble_l2cap.h                |   2 +-
 nimble/host/src/ble_l2cap_sig.c            |   2 +-
 nimble/host/src/test/ble_hs_att_clt_test.c |  32 +----
 nimble/host/src/test/ble_hs_att_svr_test.c |   2 +-
 15 files changed, 277 insertions(+), 337 deletions(-)

commit b8947e0a6fce50553ab6461f71424c1108d3aa8b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Dec 3 10:54:52 2015 -0800

    Rename ble_hs_att_* to ble_att_*
    
    Identifiers are getting too long.
    
    X-Original-Commit: 31f0c10b69827333e42d2c071d19ab6dcb592d68

 nimble/host/include/host/ble_gatt.h                |   4 +-
 nimble/host/include/host/ble_hs_test.h             |   4 +-
 nimble/host/src/ble_att.c                          | 118 ++++++
 nimble/host/src/ble_att.h                          | 166 ++++++++
 .../host/src/{ble_hs_att_clt.c => ble_att_clt.c}   | 163 ++++----
 .../host/src/{ble_hs_att_cmd.c => ble_att_cmd.c}   | 186 ++++-----
 .../host/src/{ble_hs_att_cmd.h => ble_att_cmd.h}   | 186 ++++-----
 .../host/src/{ble_hs_att_svr.c => ble_att_svr.c}   | 430 ++++++++++-----------
 nimble/host/src/ble_gatt.c                         |  14 +-
 nimble/host/src/ble_hs.c                           |   6 +-
 nimble/host/src/ble_hs_att.c                       | 118 ------
 nimble/host/src/ble_hs_att.h                       | 171 --------
 nimble/host/src/ble_hs_conn.c                      |   6 +-
 nimble/host/src/ble_hs_conn.h                      |   4 +-
 nimble/host/src/test/ble_host_hci_test.c           |   4 +-
 nimble/host/src/test/ble_hs_att_clt_test.c         |  70 ++--
 nimble/host/src/test/ble_hs_att_svr_test.c         | 386 +++++++++---------
 nimble/host/src/test/ble_hs_conn_test.c            |  10 +-
 nimble/host/src/test/ble_hs_test.c                 |   4 +-
 19 files changed, 1019 insertions(+), 1031 deletions(-)

commit f1c63a4b1a3a0c07202e2b2434e2da48576ec7ae
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 2 17:53:09 2015 -0800

    ATT Read, Read By Group Type.
    
    X-Original-Commit: e878a3d55a9097d482072ed6cee80f1eb7fab61d

 nimble/host/src/ble_gatt.c       |  30 +++----
 nimble/host/src/ble_hs_att.h     |  13 ++-
 nimble/host/src/ble_hs_att_clt.c | 188 ++++++++++++++++++++++++++++++++++-----
 nimble/host/src/ble_hs_att_cmd.c |  82 +++++++++++++++++
 nimble/host/src/ble_hs_att_cmd.h |  38 ++++++++
 nimble/host/src/ble_hs_uuid.c    |  68 +++++++++++++-
 nimble/host/src/ble_hs_uuid.h    |   6 +-
 7 files changed, 382 insertions(+), 43 deletions(-)

commit 0736ec45267d786041338e7fa0d0283c367e3b73
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Dec 2 15:15:08 2015 -0800

    Initial GATT work.
    
    X-Original-Commit: 41db2873e957b70864d66be6b0fe4616cd226c0b

 nimble/host/include/host/ble_gatt.h |  19 ++
 nimble/host/include/host/ble_hs.h   |   6 +-
 nimble/host/src/ble_gatt.c          | 430 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs.c            |  21 +-
 nimble/host/src/ble_hs_att.h        |  12 -
 nimble/host/src/ble_hs_att_batch.c  | 294 ------------------------
 nimble/host/src/ble_hs_att_clt.c    |   7 +-
 7 files changed, 477 insertions(+), 312 deletions(-)

commit 3b0491ed7625050269d089f80f29dd092d3c1cc9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Dec 1 19:06:49 2015 -0800

    Remove generic work queue; add hci batch queue.
    
    X-Original-Commit: ddf5786319b3037f6fbd4ffdc68ad22ac9abc97d

 nimble/host/include/host/ble_hs.h       |   4 +-
 nimble/host/include/host/host_hci.h     |   3 +-
 nimble/host/src/ble_gap.c               |  30 +++---
 nimble/host/src/ble_gap_conn.c          |   8 +-
 nimble/host/src/ble_hs.c                |  34 +++----
 nimble/host/src/ble_hs_att.c            |  11 +++
 nimble/host/src/ble_hs_att.h            |   9 ++
 nimble/host/src/ble_hs_att_batch.c      | 138 ++++++++++++++++++--------
 nimble/host/src/ble_hs_att_clt.c        |  87 +++++++++++++++--
 nimble/host/src/ble_hs_att_svr.c        |  39 +++-----
 nimble/host/src/ble_hs_hci_batch.c      | 166 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_hci_batch.h      |  54 +++++++++++
 nimble/host/src/ble_hs_work.c           | 110 ---------------------
 nimble/host/src/ble_hs_work.h           |  53 ----------
 nimble/host/src/host_hci.c              |  36 +------
 nimble/host/src/test/ble_gap_test.c     |   6 +-
 nimble/host/src/test/ble_hs_conn_test.c |  16 ++-
 nimble/host/src/test/ble_hs_test_util.c |   5 +-
 18 files changed, 497 insertions(+), 312 deletions(-)

commit 8c4bbd35e7e29231dfc7b9666e2282b8c95a5a65
Author: wes3 <will@micosa.io>
Date:   Tue Dec 1 12:47:41 2015 -0800

    Fix some issues with initiating and starting a connection. Add API to send data packets from host to controller
    
    X-Original-Commit: b612bf4bbf730671fbebaec30c996942a67d82ce

 nimble/controller/include/controller/ble_ll.h      |  18 +-
 nimble/controller/include/controller/ble_ll_conn.h |   3 +-
 nimble/controller/include/controller/ble_ll_hci.h  |   2 +
 nimble/controller/src/ble_ll.c                     |  72 +++++-
 nimble/controller/src/ble_ll_adv.c                 |   7 +-
 nimble/controller/src/ble_ll_conn.c                | 285 ++++++++++++++-------
 nimble/controller/src/ble_ll_hci.c                 |   8 +
 nimble/host/src/ble_hs.c                           |   2 +-
 nimble/host/src/host_dbg.c                         |  45 +++-
 nimble/host/src/host_hci_cmd.c                     |   2 +-
 nimble/include/nimble/ble.h                        |  14 +-
 nimble/include/nimble/hci_transport.h              |   3 +
 12 files changed, 337 insertions(+), 124 deletions(-)

commit 4a3fdca39330231003c95bc7812df1a5e5cfd671
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 30 19:49:14 2015 -0800

    Add missing copyright headers.
    
    X-Original-Commit: 4fd25c4825f0de0ec95161682698082c43037f4a

 nimble/host/src/ble_hs_att_batch.c         | 16 ++++++++++++++++
 nimble/host/src/ble_hs_att_clt.c           | 16 ++++++++++++++++
 nimble/host/src/test/ble_hs_att_clt_test.c | 16 ++++++++++++++++
 3 files changed, 48 insertions(+)

commit 3029040306e78c3ae3839bcfe95f53309a684d8c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 30 19:47:49 2015 -0800

    Initial implementation of ATT batch commands.
    
    X-Original-Commit: af899083d2bfd760ea92f009dcea1662a5bfba0d

 nimble/host/src/ble_hs_att.h               |  4 +-
 nimble/host/src/ble_hs_att_batch.c         | 96 +++++++++++++++++++++++++++---
 nimble/host/src/ble_hs_att_clt.c           |  5 +-
 nimble/host/src/test/ble_hs_att_clt_test.c | 42 +++++++++++--
 4 files changed, 132 insertions(+), 15 deletions(-)

commit 6aaa7dfe14725400dc40027c8d62071f09e031d9
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 30 19:25:38 2015 -0800

    Allow simulataneous BLE host jobs.
    
    X-Original-Commit: b390b9f9f163f9a9d258919768cae321cbaad55a

 nimble/host/src/ble_gap_conn.c      |   8 ---
 nimble/host/src/ble_hs.c            |  10 ++-
 nimble/host/src/ble_hs_att.h        |   8 +++
 nimble/host/src/ble_hs_att_batch.c  | 134 ++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_att_clt.c    |  22 ++++--
 nimble/host/src/ble_hs_work.c       |  49 ++-----------
 nimble/host/src/ble_hs_work.h       |   6 +-
 nimble/host/src/host_hci.c          |   2 -
 nimble/host/src/test/ble_gap_test.c |   3 -
 9 files changed, 170 insertions(+), 72 deletions(-)

commit f9bdd2bd334107fc947c9efb72f0653e1c80eddc
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 30 17:37:40 2015 -0800

    Initial work for client-side ATT.
    
    X-Original-Commit: 61e167e603383dcc3db2031fede4a5e7d9caff95

 nimble/host/include/host/ble_hs_test.h             |   3 +-
 nimble/host/src/ble_hs.c                           |  30 ++-
 nimble/host/src/ble_hs_att.c                       |  74 +++++-
 nimble/host/src/ble_hs_att.h                       |  52 +++-
 nimble/host/src/ble_hs_att_clt.c                   | 263 ++++++++++++++++++++
 nimble/host/src/ble_hs_att_cmd.c                   | 103 ++++----
 nimble/host/src/ble_hs_att_cmd.h                   |  13 +-
 nimble/host/src/ble_hs_att_svr.c                   | 148 ++----------
 nimble/host/src/ble_hs_conn.c                      |  12 +-
 nimble/host/src/ble_hs_conn.h                      |   9 +-
 nimble/host/src/ble_hs_work.c                      |  41 +++-
 nimble/host/src/ble_hs_work.h                      |   6 +-
 nimble/host/src/host_hci.c                         |   5 +-
 nimble/host/src/test/ble_gap_test.c                |  11 +-
 nimble/host/src/test/ble_hs_att_clt_test.c         | 133 +++++++++++
 .../{ble_hs_att_test.c => ble_hs_att_svr_test.c}   | 264 ++++++++++-----------
 nimble/host/src/test/ble_hs_test.c                 |   3 +-
 nimble/host/src/test/ble_hs_test_util.c            |  24 +-
 nimble/host/src/test/ble_hs_test_util.h            |   1 +
 19 files changed, 844 insertions(+), 351 deletions(-)

commit 4215ed6a94201dfd2aee6dc440440d5f1e135f52
Author: wes3 <will@micosa.io>
Date:   Sun Nov 29 20:22:02 2015 -0800

    Merge new os mbuf changes into bletest
    
    X-Original-Commit: 72c8e58aa8553807e5865df0dc87977f89e16acc

 nimble/controller/src/ble_ll.c      |  4 +-
 nimble/controller/src/ble_ll_adv.c  |  4 +-
 nimble/controller/src/ble_ll_conn.c | 78 ++++++++++++++++++-------------------
 nimble/controller/src/ble_ll_scan.c |  2 +-
 nimble/drivers/native/src/ble_phy.c |  2 +-
 nimble/drivers/nrf52/src/ble_phy.c  |  7 +---
 nimble/include/nimble/ble.h         | 15 +++++++
 7 files changed, 59 insertions(+), 53 deletions(-)

commit 7f4b078264a470026b111738ab1efc6b4f4b48ed
Author: wes3 <will@micosa.io>
Date:   Sat Nov 28 08:00:33 2015 -0800

    Refactor connection handle code. Place all connections on a free list and assign the handles on init. Add active/free connection lists
    
    X-Original-Commit: 15a4a8cf3c33c842ce409d70d0da9ea4c75c8e03

 nimble/controller/include/controller/ble_ll.h      |   25 +-
 nimble/controller/include/controller/ble_ll_conn.h |    4 +-
 nimble/controller/src/ble_ll.c                     |  170 ++-
 nimble/controller/src/ble_ll_adv.c                 |    1 -
 nimble/controller/src/ble_ll_conn.c                | 1077 ++++++++++++++------
 nimble/drivers/native/src/ble_phy.c                |    4 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |   16 +-
 nimble/include/nimble/ble.h                        |    8 +
 8 files changed, 941 insertions(+), 364 deletions(-)

commit 00d6f19dc6df74727321138ad9fd31328d07fbdc
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 25 17:29:53 2015 -0800

    Clear ack callback when HCI tx fails.
    
    X-Original-Commit: 48d5b34fceaf591fb69b1d55d6c4349618331aa7

 nimble/host/src/host_hci_cmd.c | 3 +++
 1 file changed, 3 insertions(+)

commit b92cef860df0543aebb46f128f9e8f86635575c7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 25 17:24:43 2015 -0800

    Read buffer size HCI command.
    
    X-Original-Commit: 2cf8182d05eb6b0a553fa31a7be74ea196db8dd5

 nimble/host/include/host/host_hci.h |  2 ++
 nimble/host/src/ble_hs_ack.c        |  3 +++
 nimble/host/src/ble_hs_att_svr.c    | 30 +++++++++++-------------
 nimble/host/src/host_hci.c          | 46 +++++++++++++++++++++++++++++++++++++
 nimble/host/src/host_hci_cmd.c      |  9 ++++++++
 5 files changed, 74 insertions(+), 16 deletions(-)

commit 80110b8bd746d6e1dcf25c45166fab08ea6bb243
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 25 14:43:57 2015 -0800

    Separate ATT server functionality from client.
    
    X-Original-Commit: 1d1aea3518be0542e2e82d52dfdaccf8bcb0fee2

 nimble/host/include/host/host_hci.h     |    5 +
 nimble/host/src/ble_gap_conn.c          |   22 +
 nimble/host/src/ble_gap_conn.h          |    2 +
 nimble/host/src/ble_hs.c                |    2 +-
 nimble/host/src/ble_hs_att.c            | 1091 +------------------------
 nimble/host/src/ble_hs_att.h            |   37 +-
 nimble/host/src/ble_hs_att_cmd.c        |   78 ++
 nimble/host/src/ble_hs_att_cmd.h        |   40 +
 nimble/host/src/ble_hs_att_svr.c        | 1343 +++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_conn.c           |    7 +
 nimble/host/src/ble_hs_uuid.c           |   19 +
 nimble/host/src/ble_hs_uuid.h           |    1 +
 nimble/host/src/ble_l2cap.c             |  120 +--
 nimble/host/src/ble_l2cap.h             |    9 +-
 nimble/host/src/ble_l2cap_sig.c         |   47 ++
 nimble/host/src/ble_l2cap_sig.h         |   24 +
 nimble/host/src/host_hci.c              |   90 +++
 nimble/host/src/test/ble_hs_att_test.c  |   98 +--
 nimble/host/src/test/ble_hs_test_util.c |   30 +
 nimble/host/src/test/ble_hs_test_util.h |    5 +
 nimble/host/src/test/ble_l2cap_test.c   |   16 +-
 nimble/include/nimble/hci_common.h      |   19 +-
 22 files changed, 1832 insertions(+), 1273 deletions(-)

commit 21d01b51cf347d580aa12530ba082fed266c495d
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 25 14:10:38 2015 -0800

    Modify host ble to account for latest mbuf changes
    
    X-Original-Commit: 7a99eecdcd02bde898eb1d128944e64718990367

 nimble/host/src/ble_hs.c               |  6 ++--
 nimble/host/src/ble_hs_att.c           | 33 ++++++++++---------
 nimble/host/src/ble_hs_att_cmd.c       |  1 -
 nimble/host/src/ble_l2cap.c            | 24 +++++++-------
 nimble/host/src/ble_l2cap_util.c       | 58 ----------------------------------
 nimble/host/src/ble_l2cap_util.h       | 27 ----------------
 nimble/host/src/host_hci.c             |  4 +--
 nimble/host/src/test/ble_hs_att_test.c | 12 +++----
 nimble/host/src/test/ble_hs_test.c     |  4 +--
 nimble/host/src/test/ble_l2cap_test.c  |  8 ++---
 10 files changed, 45 insertions(+), 132 deletions(-)

commit d8d63450b7c6d23dec5d01473970e7587c556158
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 23 12:17:10 2015 -0800

    Use mbufs for incoming HCI ACL data packets.
    
    X-Original-Commit: 9601758b73bbde1a3e92981dbf7fa7af05381154

 nimble/host/include/host/host_hci.h |  2 +-
 nimble/host/src/ble_hs.c            | 11 ++++++++
 nimble/host/src/host_hci.c          | 53 ++++++++++++++++++-------------------
 3 files changed, 38 insertions(+), 28 deletions(-)

commit 99a0910dbb0673928f30fc68db4af843890501e0
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Nov 20 18:07:11 2015 -0800

    Integrate ble_hs packet queues into l2cap.
    
    X-Original-Commit: 9a778f621a6ee24e72c20ac5fa2b86c46a9ecde6

 nimble/host/src/ble_l2cap.c            | 134 ++++++++++++++++-----------------
 nimble/host/src/ble_l2cap.h            |  13 ++--
 nimble/host/src/host_hci.c             |   2 +
 nimble/host/src/test/ble_hs_att_test.c |  46 +++++------
 nimble/host/src/test/ble_l2cap_test.c  |  34 ++++++---
 5 files changed, 123 insertions(+), 106 deletions(-)

commit 49a2ddd7c9b7cc72c5b2c06ff7438a496b62126c
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Nov 20 15:39:02 2015 -0800

    Use selftest identity for self-contained test deps
    
    X-Original-Commit: 065725d559ce155c299791b17d22410be10c5790

 nimble/host/egg.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 13ab0056c677a735c9cf3faf3ab270a35ab73cfe
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Nov 20 14:55:33 2015 -0800

    Data queues in host task; remove l2cap buffers.
    
    X-Original-Commit: b7f7ed22d5e81859215ce8e3b529a65f89ff937b

 nimble/host/egg.yml                      |   2 +
 nimble/host/include/host/ble_hs.h        |  12 +++
 nimble/host/include/host/ble_hs_test.h   |   5 +-
 nimble/host/src/ble_hs.c                 | 177 ++++++++++++++++++++++++++++---
 nimble/host/src/ble_hs_att.c             |  33 +++---
 nimble/host/src/ble_hs_att.h             |   6 +-
 nimble/host/src/ble_hs_conn.c            |  43 ++++++--
 nimble/host/src/ble_l2cap.c              |  98 +++++++++--------
 nimble/host/src/ble_l2cap.h              |   1 -
 nimble/host/src/host_hci.c               |   6 +-
 nimble/host/src/test/ble_gap_test.c      |   2 +-
 nimble/host/src/test/ble_host_hci_test.c |   6 +-
 nimble/host/src/test/ble_hs_att_test.c   |  70 +++++++-----
 nimble/host/src/test/ble_hs_conn_test.c  |   9 +-
 nimble/host/src/test/ble_hs_test.c       |  14 +++
 nimble/host/src/test/ble_hs_test_util.c  |  14 +++
 nimble/host/src/test/ble_hs_test_util.h  |   4 +
 nimble/host/src/test/ble_l2cap_test.c    |   3 +-
 18 files changed, 376 insertions(+), 129 deletions(-)

commit c367d8e6e87857701d3573fead6b011e85f1c2a1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 19 18:09:39 2015 -0800

    att find type value command.
    
    X-Original-Commit: 34a6d69f282276e496e45df25bce90081b02a511

 nimble/host/src/ble_hs_att.c            | 538 ++++++++++++++++++++++++++------
 nimble/host/src/ble_hs_att.h            |   2 +
 nimble/host/src/ble_hs_uuid.c           |  10 +-
 nimble/host/src/ble_hs_uuid.h           |   2 +-
 nimble/host/src/ble_l2cap.c             |  56 +++-
 nimble/host/src/ble_l2cap.h             |   3 +-
 nimble/host/src/test/ble_hs_att_test.c  | 331 ++++++++++++++++++--
 nimble/host/src/test/ble_hs_uuid_test.c |   8 +-
 8 files changed, 803 insertions(+), 147 deletions(-)

commit 4d6b02eb726f2b128edb381980cc3c9a0f35f79f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 19 14:43:44 2015 -0800

    Change byte-swapping fns to use void pointers.
    
    X-Original-Commit: 95ec4cafea82a954c0a87ff23fb9b56142dc0429

 nimble/include/nimble/ble.h | 12 +++----
 nimble/src/util.c           | 84 ++++++++++++++++++++++++++-------------------
 2 files changed, 55 insertions(+), 41 deletions(-)

commit 1f1cdabd9469cd25ada4f43e61657f8e7d6d6ea7
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 19 13:08:05 2015 -0800

    att find type value parse / write cmds.
    
    X-Original-Commit: e52f46315d36bc29e2ab538a99e4d9a78b632f23

 nimble/host/src/ble_hs_att_cmd.c | 44 ++++++++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_att_cmd.h | 31 ++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap.h      |  2 +-
 3 files changed, 76 insertions(+), 1 deletion(-)

commit fcfce0d1ab0ad0d70e0576f8cee8ac9c46ea88e6
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 19 11:52:12 2015 -0800

    (ble host) Send MTU response as server.
    
    X-Original-Commit: 03abc47b044e6f73c4a3751e42131cc6d9750117

 nimble/host/src/ble_hs_att.c            |  76 +++++++++++++++------
 nimble/host/src/ble_hs_att_cmd.c        |  54 +++++++--------
 nimble/host/src/ble_hs_att_cmd.h        |  28 +++-----
 nimble/host/src/ble_l2cap.c             |   6 +-
 nimble/host/src/ble_l2cap.h             |   6 +-
 nimble/host/src/test/ble_hs_att_test.c  | 116 ++++++++++++++++++++++++--------
 nimble/host/src/test/ble_hs_conn_test.c |   4 +-
 7 files changed, 190 insertions(+), 100 deletions(-)

commit 2fc663e69215a4d147012e1001c902f89661d8c5
Author: wes3 <will@micosa.io>
Date:   Thu Nov 19 11:33:10 2015 -0800

    Remove erroneous debug commit and add ble_ll_ctrl header file
    
    X-Original-Commit: c9d16694d3080cfd7ef9225d4fdcf24e930a37ba

 nimble/controller/include/controller/ble_ll_ctrl.h | 190 +++++++++++++++++++++
 nimble/host/src/host_hci_cmd.c                     |   2 +-
 2 files changed, 191 insertions(+), 1 deletion(-)

commit f0a0fb337b78a7af8a9c5a07dd3cb83251a0cc29
Author: wes3 <will@micosa.io>
Date:   Thu Nov 19 11:30:58 2015 -0800

    Additional connection code: supervision timeout, connection scheduling, start/end event processing
    
    X-Original-Commit: 47dff3ec49a857efa192706c8175eacdb0073c5c

 nimble/controller/include/controller/ble_ll.h      |  74 +-
 nimble/controller/include/controller/ble_ll_conn.h |   7 +-
 .../controller/include/controller/ble_ll_sched.h   |   3 +-
 nimble/controller/include/controller/ble_phy.h     |   2 +-
 nimble/controller/src/ble_ll.c                     | 127 +--
 nimble/controller/src/ble_ll_adv.c                 |   5 +-
 nimble/controller/src/ble_ll_conn.c                | 926 ++++++++++++++++++---
 nimble/controller/src/ble_ll_scan.c                |  17 +-
 nimble/controller/src/ble_ll_sched.c               |  15 +-
 nimble/controller/src/ble_ll_whitelist.c           |   1 -
 nimble/drivers/native/src/ble_phy.c                |   4 +-
 nimble/drivers/nrf52/src/ble_phy.c                 |  34 +-
 nimble/host/src/host_hci_cmd.c                     |   2 +-
 nimble/include/nimble/ble.h                        |   6 +-
 14 files changed, 950 insertions(+), 273 deletions(-)

commit c0b3e3fac9e42c47c6d67a34a0ba7a2a29aca02f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 18 13:46:39 2015 -0800

    ATT MTU exchange.
    
    X-Original-Commit: 126f083ecce7a3d0a8b8fb2c0de488099d9236fd

 nimble/host/src/ble_hs_att.c            | 28 +++++++++++++++++++---------
 nimble/host/src/ble_hs_att.h            |  8 +++++---
 nimble/host/src/ble_hs_conn.c           | 16 ++++++++++++++--
 nimble/host/src/ble_hs_conn.h           | 10 +++++++---
 nimble/host/src/ble_l2cap.c             | 33 ++++++++++++++++++---------------
 nimble/host/src/ble_l2cap.h             |  6 ++++--
 nimble/host/src/test/ble_hs_att_test.c  |  9 +++++----
 nimble/host/src/test/ble_hs_conn_test.c | 16 ++++++++++++++--
 8 files changed, 86 insertions(+), 40 deletions(-)

commit f2cdc8d98267ce13420a92a46c213a859f70d62e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 16 18:45:12 2015 -0800

    Additional ATT find-info tests.
    
    X-Original-Commit: 55082ce6cd6597ce96f0c8c5d9134465a9bccf6e

 nimble/host/src/ble_hs_att.c            |   9 +-
 nimble/host/src/ble_hs_uuid.c           |   3 +
 nimble/host/src/test/ble_hs_att_test.c  | 177 +++++++++++++++++++++++++++++++-
 nimble/host/src/test/ble_hs_uuid_test.c |  22 +++-
 4 files changed, 203 insertions(+), 8 deletions(-)

commit a0387acf71acc0eb1e1afcdff9054e3b69339978
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 16 14:46:04 2015 -0800

    Fix 128-bit to 16-bit UUID conversion.
    
    X-Original-Commit: 4255270f43555fc59300597967ac72983f5b68e8

 nimble/host/include/host/ble_hs_test.h  |  1 +
 nimble/host/src/ble_hs_uuid.c           | 22 +++++++++--
 nimble/host/src/test/ble_hs_test.c      |  1 +
 nimble/host/src/test/ble_hs_uuid_test.c | 67 +++++++++++++++++++++++++++++++++
 4 files changed, 88 insertions(+), 3 deletions(-)

commit 5785c4c304d6cacbde40795b8d0e8793cc9c8e43
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 16 14:18:16 2015 -0800

    find-info ATT command.
    
    X-Original-Commit: a4cceb7eda31085d70b685b8b974b032e139dfe4

 nimble/host/src/ble_hs_att.c                       | 315 +++++++++++++++------
 nimble/host/src/ble_hs_att.h                       |  18 +-
 nimble/host/src/ble_hs_att_cmd.c                   |  82 ++++++
 nimble/host/src/ble_hs_att_cmd.h                   |  81 ++++--
 nimble/host/src/ble_hs_uuid.c                      |  41 +++
 .../{include/host/uuid.h => src/ble_hs_uuid.h}     |   6 +-
 nimble/host/src/test/ble_gap_test.c                |  16 ++
 nimble/host/src/test/ble_hs_att_test.c             |  66 ++++-
 8 files changed, 512 insertions(+), 113 deletions(-)

commit b94c07297c143bea6b05b6e97d34c95c0ca11b04
Author: wes3 <will@micosa.io>
Date:   Fri Nov 13 17:26:13 2015 -0800

    Start of connection process finished. Sending connect requests and receiving them and starting the connection is finished.
    
    X-Original-Commit: d478f7bce60928125771d781b051dab566b42ad8

 nimble/controller/include/controller/ble_ll.h      |  13 +-
 nimble/controller/include/controller/ble_ll_adv.h  |   3 +
 nimble/controller/include/controller/ble_ll_conn.h |  16 +
 nimble/controller/include/controller/ble_ll_scan.h |  45 +-
 nimble/controller/src/ble_ll.c                     |  53 +-
 nimble/controller/src/ble_ll_adv.c                 | 175 ++++--
 nimble/controller/src/ble_ll_conn.c                | 604 +++++++++++++++++++--
 nimble/controller/src/ble_ll_hci.c                 |   1 +
 nimble/controller/src/ble_ll_scan.c                |  81 ++-
 nimble/drivers/nrf52/src/ble_phy.c                 |   5 +
 10 files changed, 829 insertions(+), 167 deletions(-)

commit bf97c0815a244176d58bb3dd6399171047592598
Author: Marko Kiiskila <marko@runtime.io>
Date:   Fri Nov 13 14:52:18 2015 -0800

    Remove workaround for having capability for ble_driver in bsp egg.
    Move BLE_DRIVER identity from bletest project to nimble/controller.
    
    X-Original-Commit: c6ccb0e8ec93a9529b297348acfdf9cbdf00726e

 nimble/controller/egg.yml | 2 ++
 1 file changed, 2 insertions(+)

commit 041e9f24c0489b2d7811ca68e5f01d88a50fa918
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Nov 13 11:52:06 2015 -0800

    BLE host: add connection event callback.
    
    X-Original-Commit: c4ff5a8aca0d736cc3f166baa6aa851ae10b8382

 nimble/host/{src => include/host}/ble_gap.h | 10 ++++
 nimble/host/src/ble_gap.c                   | 18 ++++++-
 nimble/host/src/ble_gap_conn.c              | 79 ++++++++++++++++++++++++-----
 nimble/host/src/ble_gap_conn.h              |  4 ++
 nimble/host/src/test/ble_gap_test.c         | 35 ++++++++++++-
 5 files changed, 130 insertions(+), 16 deletions(-)

commit daf2c2f8509af8220b84912140c1507f6f423d97
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 12 19:44:36 2015 -0800

    Basic GAP test with running OS.
    
    X-Original-Commit: 069e95db76d513ef5f3b479dcd8e6e5c6fa01868

 nimble/host/include/host/ble_hs.h        |  2 +-
 nimble/host/include/host/ble_hs_test.h   |  1 +
 nimble/host/src/ble_hs.c                 | 17 +++++-
 nimble/host/src/ble_hs_work.c            |  4 ++
 nimble/host/src/test/ble_gap_test.c      | 95 ++++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_host_hci_test.c |  4 +-
 nimble/host/src/test/ble_hs_att_test.c   |  4 +-
 nimble/host/src/test/ble_hs_conn_test.c  |  6 +-
 nimble/host/src/test/ble_hs_test.c       |  1 +
 nimble/host/src/test/ble_l2cap_test.c    |  2 +-
 10 files changed, 125 insertions(+), 11 deletions(-)

commit f020775a0e2bb6c636d033caa74a8ff850ec85e5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 12 18:48:03 2015 -0800

    Directed Connectable Mode.
    
    X-Original-Commit: 23fe06693b103df37832dbb2213c255887586fae

 nimble/host/src/ble_gap.c               | 33 +++++++++++
 nimble/host/src/ble_gap.h               |  1 +
 nimble/host/src/ble_gap_conn.c          | 99 +++++++++++++++++++++++----------
 nimble/host/src/ble_gap_conn.h          |  4 +-
 nimble/host/src/ble_hs_work.c           |  8 ++-
 nimble/host/src/ble_hs_work.h           |  9 ++-
 nimble/host/src/test/ble_hs_conn_test.c |  6 +-
 nimble/host/src/test/ble_hs_test_util.c |  2 +-
 8 files changed, 126 insertions(+), 36 deletions(-)

commit 5e0ecf7d258edc85b0edba65b6ce6deb4854d347
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 12 17:59:45 2015 -0800

    Make HCI acks OGF-aware; work queue for GAP.
    
    X-Original-Commit: 629247cb1cedd7b98184fd3635c5888c5c64a370

 nimble/host/include/host/ble_hs.h       |   1 +
 nimble/host/src/ble_gap.c               |  54 ++++++++++++++++
 nimble/host/src/ble_gap.h               |  24 +++++++
 nimble/host/src/ble_gap_conn.c          |  22 ++++++-
 nimble/host/src/ble_gap_conn.h          |   2 +
 nimble/host/src/ble_hs.c                |  37 ++++++++++-
 nimble/host/src/ble_hs_ack.h            |   2 +-
 nimble/host/src/ble_hs_conn.c           |  33 ++--------
 nimble/host/src/ble_hs_conn.h           |   3 +-
 nimble/host/src/ble_hs_work.c           | 110 ++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_work.h           |  48 ++++++++++++++
 nimble/host/src/host_hci.c              |   4 +-
 nimble/host/src/host_hci_cmd.c          |   2 +-
 nimble/host/src/test/ble_hs_conn_test.c |   8 +--
 nimble/host/src/test/ble_hs_test_util.c |  13 ++--
 nimble/host/src/test/ble_hs_test_util.h |   3 +-
 nimble/include/nimble/hci_common.h      |  15 +++--
 17 files changed, 330 insertions(+), 51 deletions(-)

commit b0fc5d1e7aaecc172926d04f2a25e66011896e8f
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 12 13:53:22 2015 -0800

    Configurable ack callbacks for cmd sequences.
    
    X-Original-Commit: 3fea5a999adb16593f0b2215b46fadfd0ff734b8

 nimble/host/include/host/host_hci.h      |   3 +-
 nimble/host/src/ble_gap_conn.c           | 130 ++++++++++++++++++++-----------
 nimble/host/src/ble_gap_conn.h           |  15 +---
 nimble/host/src/ble_hs.c                 |   5 ++
 nimble/host/src/ble_hs_ack.c             |  59 +++++---------
 nimble/host/src/ble_hs_ack.h             |   6 +-
 nimble/host/src/host_hci.c               |  20 ++---
 nimble/host/src/host_hci_cmd.c           |   7 +-
 nimble/host/src/test/ble_host_hci_test.c |   2 +-
 nimble/host/src/test/ble_hs_conn_test.c  |  64 +++++++--------
 nimble/host/src/test/ble_hs_test_util.c  |  20 +++--
 nimble/host/src/test/ble_hs_test_util.h  |   1 +
 12 files changed, 177 insertions(+), 155 deletions(-)

commit 525df31584f3c15b3dbe970216e25b8daa0ee5aa
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 11 16:17:04 2015 -0800

    Concurrent roles; change ack mechanism.
    
    X-Original-Commit: a1dbea4a4e4d6830869c1e3f09f17943e6b09ce4

 nimble/host/src/ble_gap_conn.c          | 150 ++++++++++++++++++++++++++++-
 nimble/host/src/ble_gap_conn.h          |  18 ++++
 nimble/host/src/ble_hs.c                |   6 ++
 nimble/host/src/ble_hs_ack.c            |  90 ++++--------------
 nimble/host/src/ble_hs_ack.h            |  10 +-
 nimble/host/src/ble_hs_conn.c           | 161 +++++---------------------------
 nimble/host/src/ble_hs_conn.h           |   7 +-
 nimble/host/src/host_hci.c              |  52 +++++++----
 nimble/host/src/host_hci_cmd.c          |   2 +-
 nimble/host/src/test/ble_hs_conn_test.c | 103 +++++++++++++++-----
 nimble/host/src/test/ble_hs_test_util.c |  11 ++-
 nimble/include/nimble/hci_common.h      |   2 +
 12 files changed, 349 insertions(+), 263 deletions(-)

commit 0cfe163159b2c9d49be10a8a624f54d7ae37b3cd
Author: wes3 <will@micosa.io>
Date:   Wed Nov 11 13:36:04 2015 -0800

    Add BLE_DEVICE identity to project bletest. Also added ble_driver capability to the native and nrf52 drivers in net/nimble. No required capability yet as we need to modify the tool to support this
    
    X-Original-Commit: 218fb48626070f92628d5bbac77093ce8723e7a0

 nimble/drivers/native/egg.yml | 1 +
 nimble/drivers/nrf52/egg.yml  | 1 +
 2 files changed, 2 insertions(+)

commit bf3bcac05e063bc65d1711fc423bf0d39d80309d
Author: wes3 <will@micosa.io>
Date:   Tue Nov 10 21:54:33 2015 -0800

    Some additional LL connection related code
    
    X-Original-Commit: 7e35563cfc7cd1889eb27a45e0f08186f825779b

 nimble/controller/include/controller/ble_ll.h      |  28 ++
 nimble/controller/include/controller/ble_ll_adv.h  |  28 --
 nimble/controller/include/controller/ble_ll_scan.h |  12 +-
 nimble/controller/src/ble_ll.c                     |  53 ---
 nimble/controller/src/ble_ll_conn.c                | 392 ++++++++++++++++++---
 nimble/controller/src/ble_ll_hci.c                 |  27 +-
 nimble/controller/src/ble_ll_scan.c                |  42 ++-
 nimble/include/nimble/hci_common.h                 |   9 +
 8 files changed, 451 insertions(+), 140 deletions(-)

commit 9c4a5a5519a7c2f70e82ee91fa26b08926a51eff
Author: wes3 <will@micosa.io>
Date:   Tue Nov 10 21:53:39 2015 -0800

    Temporary fix to get projects building with addition of ble driver dependency
    
    X-Original-Commit: e50f0dc30714f3373cd711582e0b10d31a7aea7b

 nimble/drivers/nrf52/egg.yml | 3 +++
 1 file changed, 3 insertions(+)

commit ca8a8be64bfe8418cb3229cbb1839aef8a494ee1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Nov 10 17:27:05 2015 -0800

    Handle connection events.
    
    Also, remove obsolete host_test project.
    
    X-Original-Commit: 8895970ad4f878b18db08499ed957a2363e8e1d1

 nimble/controller/src/ble_ll_hci.c             |   2 +-
 nimble/host/include/host/ble_hs.h              |   7 -
 nimble/host/include/host/ble_hs_test.h         |   1 +
 nimble/host/src/arch/sim/ble_hs_itf.c          | 298 -------------------------
 nimble/host/src/ble_gap_conn.c                 |  61 +++++
 nimble/host/src/ble_gap_conn.h                 |  22 ++
 nimble/host/src/ble_hs.c                       |  46 ----
 nimble/host/src/ble_hs_ack.c                   | 120 ++++++++++
 nimble/host/src/{ble_hs_itf.h => ble_hs_ack.h} |  12 +-
 nimble/host/src/ble_hs_att_cmd.c               |  16 ++
 nimble/host/src/ble_hs_conn.c                  | 218 +++++++++++++-----
 nimble/host/src/ble_hs_conn.h                  |  12 +-
 nimble/host/src/host_hci.c                     | 121 +++++++++-
 nimble/host/src/test/ble_host_hci_test.c       |  63 +++---
 nimble/host/src/test/ble_hs_att_test.c         |   9 +-
 nimble/host/src/test/ble_hs_conn_test.c        | 127 +++++++++++
 nimble/host/src/test/ble_hs_test.c             |   1 +
 nimble/host/src/test/ble_hs_test_util.c        |  71 ++++++
 nimble/host/src/test/ble_hs_test_util.h        |  30 +++
 nimble/host/src/test/ble_l2cap_test.c          |  14 +-
 nimble/include/nimble/hci_common.h             |  26 ++-
 21 files changed, 798 insertions(+), 479 deletions(-)

commit aaf4d8d8794ddcc8feea3a07879d25c4c91b03a2
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 9 19:11:13 2015 -0800

    Some basic unit tests for HCI events.
    
    X-Original-Commit: ed3c9be5d2a2490fa2e919ad6ac6df153dafc67b

 nimble/host/include/host/ble_hs_test.h   |   1 +
 nimble/host/include/host/host_hci.h      |   3 +-
 nimble/host/src/ble_hs.c                 |   2 +-
 nimble/host/src/host_hci.c               |  25 +++++--
 nimble/host/src/test/ble_host_hci_test.c | 120 +++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c       |   1 +
 6 files changed, 143 insertions(+), 9 deletions(-)

commit 3f0dbc053c553a56fab11a8b2258fec4d9e21d41
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 9 18:28:09 2015 -0800

    Initial processing of HCI events.
    
    X-Original-Commit: 43f639ff2bed711a1466464278e53058627c7b1b

 nimble/host/include/host/host_hci.h |   2 +
 nimble/host/src/ble_hs_att.c        |   2 +-
 nimble/host/src/ble_hs_conn.c       |  54 +++++
 nimble/host/src/ble_hs_conn.h       |   1 +
 nimble/host/src/host_hci.c          | 450 ++++++++----------------------------
 nimble/host/src/host_hci_cmd.c      | 422 +++++++++++++++++++++++++++++++++
 nimble/include/nimble/hci_common.h  |   9 +-
 7 files changed, 585 insertions(+), 355 deletions(-)

commit 1cfa3a6cde022123c7c395e265618ad9591e01b7
Author: wes3 <will@micosa.io>
Date:   Mon Nov 9 18:18:01 2015 -0800

    Initial commit of drivers for ble stack. Ported to nrf52 and native bsp's. Includes hal_cputime implementation on native cpu
    
    X-Original-Commit: c0c07d8b07d88402a9fb5a59e9acefc94cde1c6c

 nimble/controller/include/controller/ble_hw.h      |   4 +
 nimble/drivers/native/egg.yml                      |   4 +
 nimble/drivers/native/src/ble_hw.c                 | 104 ++++++
 nimble/drivers/native/src/ble_phy.c                | 393 +++++++++++++++++++++
 nimble/drivers/nrf52/egg.yml                       |   2 +
 nimble/{controller => drivers/nrf52}/src/ble_hw.c  |   1 -
 nimble/{controller => drivers/nrf52}/src/ble_phy.c |   4 +-
 7 files changed, 508 insertions(+), 4 deletions(-)

commit fb79705cef8a6e510fdd46de7ec819834f3e55e5
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 9 14:10:54 2015 -0800

    Add basic HCI create connection command.
    
    X-Original-Commit: 8508d9563d7a3eac571fe8ca7bbf3180242472a5

 nimble/host/include/host/host_hci.h |  3 +-
 nimble/host/src/host_hci.c          | 78 +++++++++++++++++++++++++++++++++++++
 nimble/include/nimble/hci_common.h  |  6 +++
 3 files changed, 86 insertions(+), 1 deletion(-)

commit 55cd9ab11fce195470a6c599f98f39c6b85b86a8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Mon Nov 9 12:55:51 2015 -0800

    Merge host_hci task into ble_hs task.
    
    X-Original-Commit: 5113d5f9236e3d9d95ceb21830266d1fbb726efc

 nimble/host/include/host/ble_hs.h      |  6 +--
 nimble/host/include/host/host_hci.h    |  3 +-
 nimble/host/src/ble_hs.c               | 69 +++++++++++++++++++++++-----------
 nimble/host/src/host_hci.c             | 48 -----------------------
 nimble/host/src/test/ble_hs_att_test.c |  4 +-
 nimble/host/src/test/ble_l2cap_test.c  |  2 +-
 6 files changed, 55 insertions(+), 77 deletions(-)

commit 814dab26e7b66f9f9b77dc329e2cbc9fb030dd5b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Nov 6 15:37:24 2015 -0800

    Basic ATT write / ATT MTU exchange handling.
    
    X-Original-Commit: 98a83fa7198599f32e92aa18862f0fb7b872fc02

 nimble/host/src/ble_hs_att.c           | 133 ++++++++++++++++++++++++++++-----
 nimble/host/src/ble_hs_att.h           |  20 +++--
 nimble/host/src/ble_hs_att_cmd.c       | 114 ++++++++++++++++++++++++----
 nimble/host/src/ble_hs_att_cmd.h       |  71 +++++++++++++++---
 nimble/host/src/ble_l2cap.c            |  10 ++-
 nimble/host/src/ble_l2cap.h            |   3 +-
 nimble/host/src/test/ble_hs_att_test.c | 103 +++++++++++++++++++++++--
 7 files changed, 396 insertions(+), 58 deletions(-)

commit a05fc659c8f31832aea00fbed9715b71f6f6e1d7
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Nov 6 14:25:46 2015 -0800

    Add connection files to project (nothing implemented there yet)
    
    X-Original-Commit: ed00b2faa7d0a1ffca0c7576eff5a12882a9e4fe

 nimble/controller/include/controller/ble_ll_conn.h | 23 +++++
 nimble/controller/include/controller/ble_ll_scan.h |  4 +-
 nimble/controller/src/ble_ll_conn.c                | 97 ++++++++++++++++++++++
 nimble/controller/src/ble_ll_hci.c                 |  5 +-
 4 files changed, 124 insertions(+), 5 deletions(-)

commit 2b1717e4136dde782afbfe717e23d801c1c9a2ed
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Nov 6 09:50:17 2015 -0800

    Set response length of hci commands in the command processing functions themselves
    
    X-Original-Commit: 2920d569c69f297e5b1571fe46deda73a83f5fe2

 nimble/controller/include/controller/ble_ll_adv.h  |  2 +-
 .../include/controller/ble_ll_whitelist.h          |  2 +-
 nimble/controller/src/ble_ll_adv.c                 |  3 +-
 nimble/controller/src/ble_ll_hci.c                 | 64 ++++++++++++++++------
 nimble/controller/src/ble_ll_whitelist.c           |  3 +-
 nimble/include/nimble/hci_common.h                 | 46 ++++++++++++----
 6 files changed, 89 insertions(+), 31 deletions(-)

commit f5782bbf874c082dc21718acaf4be91aa724e635
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Nov 6 12:31:41 2015 -0800

    Don't send more than ATT_MTU-1 bytes of attr data.
    
    X-Original-Commit: 3f2a8b0f0878230dec0b4ab96cb0f4bd59ad863d

 nimble/host/src/ble_hs.c               |  2 --
 nimble/host/src/ble_hs_att.c           | 15 +++++++++++----
 nimble/host/src/ble_hs_att.h           |  2 +-
 nimble/host/src/ble_hs_conn.c          |  2 ++
 nimble/host/src/ble_hs_conn.h          |  1 +
 nimble/host/src/test/ble_hs_att_test.c | 34 +++++++++++++++++++++++++++-------
 6 files changed, 42 insertions(+), 14 deletions(-)

commit 8d3f1303d3e8a104d0714e4d2ec4dc4dcc616f7e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 5 19:15:41 2015 -0800

    Add some rudimentary att-read-req handling.
    
    X-Original-Commit: dfd27cb24b27de8a79c1ecd86496ef7fb1dde269

 nimble/host/src/ble_hs_att.c           | 184 +++++++++++++++++++++++++--------
 nimble/host/src/ble_hs_att.h           |  25 +++--
 nimble/host/src/ble_hs_att_cmd.h       |  29 ++++--
 nimble/host/src/ble_l2cap.c            |   2 -
 nimble/host/src/test/ble_hs_att_test.c |  65 +++++++++++-
 5 files changed, 238 insertions(+), 67 deletions(-)

commit 8ab1572c29e63e8ccfcb2bdff2f8cf60211c56bf
Author: Willam San Filippo <will@micosa.io>
Date:   Thu Nov 5 17:46:43 2015 -0800

    Add whitelist to advertising
    
    X-Original-Commit: 3176204a88f266b6ac54ba850f25f7caca5aa07d

 nimble/controller/include/controller/ble_ll_adv.h |  4 +-
 nimble/controller/src/ble_ll.c                    | 29 +++----
 nimble/controller/src/ble_ll_adv.c                | 93 ++++++++++++++++++++---
 nimble/controller/src/ble_ll_scan.c               |  4 +-
 nimble/controller/src/ble_ll_whitelist.c          | 16 ++--
 nimble/controller/src/ble_phy.c                   |  2 +
 nimble/host/src/host_dbg.c                        | 37 +++++++--
 7 files changed, 141 insertions(+), 44 deletions(-)

commit e72d13dca398237a815aa3b89cb4cf51939e2c7b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 5 16:55:07 2015 -0800

    Send error response on rx of bad attr read req.
    
    X-Original-Commit: 34d3b2e51c5d80a92f60de6d70911609098bfc45

 nimble/host/include/host/ble_hs_test.h |  1 +
 nimble/host/src/ble_hs.c               |  7 ++-
 nimble/host/src/ble_hs_att.c           | 76 ++++++++++++++++++----------
 nimble/host/src/ble_hs_att.h           |  6 +--
 nimble/host/src/ble_hs_att_cmd.c       | 90 +++++++++++++++++++++++++++++++++
 nimble/host/src/ble_hs_att_cmd.h       | 58 +++++++++++++++++++++
 nimble/host/src/ble_hs_itf.h           |  3 --
 nimble/host/src/ble_l2cap.c            | 76 ++++++++++++++++++++++++----
 nimble/host/src/ble_l2cap.h            | 16 ++++--
 nimble/host/src/test/ble_hs_att_test.c | 92 ++++++++++++++++++++++++++++++++++
 nimble/host/src/test/ble_hs_test.c     | 77 +++++++---------------------
 nimble/host/src/test/ble_l2cap_test.c  | 78 ++++++++++++++++++++++++++++
 12 files changed, 468 insertions(+), 112 deletions(-)

commit 632b9150923f4ad8ed2211ea3e6ff35f7a49ccd1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 5 14:01:18 2015 -0800

    Rename some host files with the "ble_hs_" prefix.
    
    X-Original-Commit: 4bb34e7f210c649d6b584f50e738488abfea9d6c

 nimble/host/include/host/attr.h                    | 79 ----------------------
 nimble/host/include/host/{host_task.h => ble_hs.h} |  0
 .../include/host/{host_test.h => ble_hs_test.h}    |  0
 nimble/host/src/arch/sim/{itf.c => ble_hs_itf.c}   |  6 +-
 nimble/host/src/{host_task.c => ble_hs.c}          |  6 +-
 nimble/host/src/ble_hs_att.c                       |  1 -
 nimble/host/src/ble_hs_att.h                       | 55 +++++++++++++++
 nimble/host/src/{itf.h => ble_hs_itf.h}            |  0
 nimble/host/src/host_hci.c                         |  2 +-
 .../host/src/test/{l2cap_test.c => ble_hs_test.c}  |  4 +-
 10 files changed, 64 insertions(+), 89 deletions(-)

commit e0f829b47c2ae99cbfedfa45b03277ee06bb77c1
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 5 13:43:09 2015 -0800

    Check result of writing l2cap header in test.
    
    X-Original-Commit: f67286ba7f1302d6c1486eb784c5260b200f3451

 nimble/host/src/test/l2cap_test.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 701b903740ae3a79fbd8a39a8a5c7405034baa8e
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 5 12:20:02 2015 -0800

    Oops - fix broken build.
    
    X-Original-Commit: 5efca3c9d3f060aee9fe17b4a53cfbf540c2f4c4

 nimble/host/src/ble_l2cap.c | 4 +++-
 nimble/host/src/ble_l2cap.h | 4 ++--
 2 files changed, 5 insertions(+), 3 deletions(-)

commit abde208ddeaf93f785e5be9801f08733b87d84a8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Thu Nov 5 12:17:27 2015 -0800

    Initial basic test for net/nimble/host.
    
    X-Original-Commit: b860779e1c603cb6909cf8a74e1000e7745e89cb

 nimble/host/egg.yml                  |  3 ++
 nimble/host/include/host/host_test.h | 23 +++++++++++
 nimble/host/src/ble_l2cap.c          | 23 +++++++++--
 nimble/host/src/ble_l2cap.h          |  6 +++
 nimble/host/src/test/l2cap_test.c    | 75 ++++++++++++++++++++++++++++++++++++
 5 files changed, 127 insertions(+), 3 deletions(-)

commit d12e3fd3aacc9f096ea4022c577f7c6393ee67a2
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 4 19:09:47 2015 -0800

    Use mbufs in l2cap channels; basic att-read handler.
    
    X-Original-Commit: 38067a3dfe43435f7439970a46f2de65a309a2e2

 nimble/host/src/ble_hs_att.c     | 66 +++++++++++++++++++++++++++++++++++-----
 nimble/host/src/ble_l2cap.c      | 44 ++++++++++++++++++++++++++-
 nimble/host/src/ble_l2cap.h      |  8 +++--
 nimble/host/src/ble_l2cap_util.c | 58 +++++++++++++++++++++++++++++++++++
 nimble/host/src/ble_l2cap_util.h | 27 ++++++++++++++++
 5 files changed, 191 insertions(+), 12 deletions(-)

commit 6790190c90fe30924d010575e8e31d59c4769967
Author: Willam San Filippo <will@micosa.io>
Date:   Wed Nov 4 17:28:04 2015 -0800

    Move bletest references out of host code and put it bletest project directory where they belong. If we are building for sim, dont include transport references
    
    X-Original-Commit: 7c50b189ec34453dd60e9537ab34b52964311169

 nimble/host/src/host_hci.c | 29 +++++------------------------
 1 file changed, 5 insertions(+), 24 deletions(-)

commit 9b30a672d61defcf844cd84dfd762313c9243183
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 4 16:22:48 2015 -0800

    Plug att stub into l2cap / hci.
    
    X-Original-Commit: b6cc8f81fe501fb22fd5a8bcd1d14ce61a49842b

 nimble/host/include/host/host_task.h     |  16 ----
 nimble/host/src/arch/sim/itf.c           |  98 ++++++++++---------
 nimble/host/src/{attr.c => ble_hs_att.c} |  80 ++++++++++++++--
 nimble/host/src/ble_hs_att.h             |  22 +++++
 nimble/host/src/ble_hs_conn.c            | 128 +++++++++++++++++++++++++
 nimble/host/src/ble_hs_conn.h            |  39 ++++++++
 nimble/host/src/ble_l2cap.c              | 155 +++++++++++++++++++++++++++++++
 nimble/host/src/{l2cap.h => ble_l2cap.h} |  36 ++++++-
 nimble/host/src/host_hci.c               |  25 +----
 nimble/host/src/host_task.c              |  72 +++++++-------
 nimble/host/src/l2cap.c                  |  59 ------------
 11 files changed, 540 insertions(+), 190 deletions(-)

commit 70e7f1e84cf76bff61c92c7312600ec2dace23a8
Author: Willam San Filippo <will@micosa.io>
Date:   Wed Nov 4 16:22:41 2015 -0800

    Fix module headers to use the correct copyright notice
    
    X-Original-Commit: fd08bee9714b567506c4c29ca842c233ed58694b

 nimble/controller/include/controller/ble_hw.h           | 2 +-
 nimble/controller/include/controller/ble_ll.h           | 2 +-
 nimble/controller/include/controller/ble_ll_adv.h       | 4 ++--
 nimble/controller/include/controller/ble_ll_hci.h       | 4 ++--
 nimble/controller/include/controller/ble_ll_scan.h      | 2 +-
 nimble/controller/include/controller/ble_ll_sched.h     | 2 +-
 nimble/controller/include/controller/ble_ll_whitelist.h | 2 +-
 nimble/controller/include/controller/ble_phy.h          | 2 +-
 nimble/controller/src/ble_hw.c                          | 3 ++-
 nimble/controller/src/ble_ll.c                          | 1 +
 nimble/controller/src/ble_ll_scan.c                     | 1 +
 nimble/controller/src/ble_phy.c                         | 3 ++-
 nimble/include/nimble/ble.h                             | 2 +-
 nimble/include/nimble/hci_common.h                      | 3 ++-
 nimble/include/nimble/hci_transport.h                   | 5 +++--
 15 files changed, 22 insertions(+), 16 deletions(-)

commit 6fcd05026813af16605c288c0700275a38c379a8
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Wed Nov 4 16:12:20 2015 -0800

    Add missing copyright headers to nimble/host files
    
    X-Original-Commit: 76bb1391860a66b70b535771c3b1ba8ccc73fd70

 nimble/host/include/host/host_hci.h |  4 ++--
 nimble/host/src/host_dbg.h          |  4 ++--
 nimble/host/src/itf.h               | 16 ++++++++++++++++
 nimble/host/src/l2cap.c             | 16 ++++++++++++++++
 nimble/host/src/l2cap.h             | 16 ++++++++++++++++
 5 files changed, 52 insertions(+), 4 deletions(-)

commit 8b771cda2c7fb13ba8be669d50343a011be2cdaa
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Tue Nov 3 19:00:07 2015 -0800

    Initial "scaffolding" for host-side data rx/tx.
    
    X-Original-Commit: 99feb02d0a4f7992c159951cb5e1f772b2d26bd8

 nimble/host/include/host/attr.h      |  79 ++++++++++
 nimble/host/include/host/host_hci.h  |   2 +
 nimble/host/include/host/host_task.h |  48 ++++++
 nimble/host/include/host/uuid.h      |  22 +++
 nimble/host/src/arch/sim/itf.c       | 290 +++++++++++++++++++++++++++++++++++
 nimble/host/src/attr.c               | 249 ++++++++++++++++++++++++++++++
 nimble/host/src/host_hci.c           |  83 +++++++++-
 nimble/host/src/host_task.c          | 127 +++++++++++++++
 nimble/host/src/itf.h                |  14 ++
 nimble/host/src/l2cap.c              |  43 ++++++
 nimble/host/src/l2cap.h              |  25 +++
 nimble/include/nimble/hci_common.h   |  11 ++
 12 files changed, 990 insertions(+), 3 deletions(-)

commit e2d936446ba3de151f5e7b6693cdbe06ec29ddf4
Author: Willam San Filippo <will@micosa.io>
Date:   Tue Nov 3 17:36:15 2015 -0800

    Add whitelisting
    
    X-Original-Commit: 5fcced15100a2782015642bd4bf3485d795f028c

 nimble/controller/include/controller/ble_hw.h      |  43 ++++
 .../include/controller/ble_ll_whitelist.h          |  43 ++++
 nimble/controller/src/ble_hw.c                     | 159 +++++++++++++
 nimble/controller/src/ble_ll_whitelist.c           | 253 +++++++++++++++++++++
 4 files changed, 498 insertions(+)

commit ea7de43b5ea23a9a7ecba0d9f66e8423f7e1968d
Author: Willam San Filippo <will@micosa.io>
Date:   Tue Nov 3 17:35:24 2015 -0800

    Add whitelisting. Not yet working for advertising filter policy but basically working for scanner filter policy
    
    X-Original-Commit: 3838ff01ff129ba6193c9225a4c4fb1b9d079408

 nimble/controller/include/controller/ble_ll.h      |   3 -
 nimble/controller/include/controller/ble_ll_adv.h  |   3 +
 nimble/controller/include/controller/ble_ll_scan.h |   8 +-
 nimble/controller/include/controller/ble_phy.h     |   1 -
 nimble/controller/src/ble_ll.c                     |  18 +-
 nimble/controller/src/ble_ll_adv.c                 |  26 ++-
 nimble/controller/src/ble_ll_hci.c                 |  30 ++-
 nimble/controller/src/ble_ll_scan.c                | 253 ++++++++++++++-------
 nimble/controller/src/ble_phy.c                    |   2 +
 nimble/host/include/host/host_hci.h                |   5 +
 nimble/host/src/host_hci.c                         |  83 +++++++
 nimble/include/nimble/ble.h                        |  11 +-
 nimble/include/nimble/hci_common.h                 |  13 +-
 13 files changed, 337 insertions(+), 119 deletions(-)

commit d4d35a23ee6d8dee73d6bf8daf06d68bd356551b
Author: Christopher Collins <ccollins476ad@gmail.com>
Date:   Fri Oct 30 18:57:29 2015 -0700

    Fix some minor ble spec comments.
    
    X-Original-Commit: 73f7db240a6e96762548648f0183144855d15729

 nimble/host/src/host_hci.c         | 3 +--
 nimble/include/nimble/hci_common.h | 7 +++----
 2 files changed, 4 insertions(+), 6 deletions(-)

commit 27954e0166a4e0cc360a0fe1d693060999c1f9bb
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 30 15:56:59 2015 -0700

    Prefix ble stack modules, functions, definitions and variables with ble_
    
    X-Original-Commit: ae2bd1f472d9132b1df2ef26ead5eb7ac5f084c0

 nimble/controller/src/ble_ll.c      | 4 ++--
 nimble/controller/src/ble_ll_adv.c  | 2 +-
 nimble/controller/src/ble_ll_hci.c  | 4 ++--
 nimble/controller/src/ble_ll_scan.c | 4 ++--
 4 files changed, 7 insertions(+), 7 deletions(-)

commit acba3ff6984a72215e12f2b351a628859fc9a28d
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 30 15:49:51 2015 -0700

    Prefix modules, functions, definitions and variables with ble_
    
    X-Original-Commit: 43735fadb673ed209e53f2666d49565c67a9660a

 nimble/controller/include/controller/{ll_hci.h => ble_ll_hci.h}   | 4 ++--
 nimble/controller/include/controller/{ll_scan.h => ble_ll_scan.h} | 0
 2 files changed, 2 insertions(+), 2 deletions(-)

commit a64ae2568093fafc1b512a9432dc9946dd93b75f
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 30 15:26:01 2015 -0700

    Prefix ble stack modules, functions, definitions and variables with ble_
    
    X-Original-Commit: faa8f5424f7242e0e10bfbcff72d097086915b9b

 nimble/controller/src/ble_ll.c       | 2 +-
 nimble/controller/src/ble_ll_adv.c   | 2 +-
 nimble/controller/src/ble_ll_scan.c  | 2 +-
 nimble/controller/src/ble_ll_sched.c | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit 52ca42ade7ca311271e17f7043affc4cf20daeb0
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 30 15:24:21 2015 -0700

    Prefix ble stack modules, functions, definitions and variables with ble_
    
    X-Original-Commit: 3b0f9ea8b273d0615a80a402e4e0829c430c1035

 nimble/controller/include/controller/{phy.h => ble_phy.h} | 0
 nimble/controller/src/{phy.c => ble_phy.c}                | 2 +-
 2 files changed, 1 insertion(+), 1 deletion(-)

commit 32156dabbbafd962914372fe0ba017978fd3828e
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 30 15:20:57 2015 -0700

    Prefix ll with ble_. This includes filenames
    
    X-Original-Commit: 36623dd5f5cdb07f60f72e3b7d995cc854b87b4e

 .../include/controller/{ll.h => ble_ll.h}          |  42 ++---
 .../include/controller/{ll_adv.h => ble_ll_adv.h}  |  22 +--
 .../controller/{ll_sched.h => ble_ll_sched.h}      |  22 +--
 nimble/controller/src/{ll.c => ble_ll.c}           | 118 +++++++-------
 nimble/controller/src/{ll_adv.c => ble_ll_adv.c}   | 178 ++++++++++-----------
 nimble/controller/src/{ll_hci.c => ble_ll_hci.c}   |  22 +--
 nimble/controller/src/ble_ll_scan.c                |  22 +--
 .../controller/src/{ll_sched.c => ble_ll_sched.c}  | 125 ++++++++-------
 nimble/controller/src/phy.c                        |   6 +-
 9 files changed, 281 insertions(+), 276 deletions(-)

commit 579afa1bb117152315e9136aaa1e9af45a359948
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 30 13:05:05 2015 -0700

    Fix scan response reception and modify code to add a packet number to advertisements (for debugging purposes). Use console for advertising report display
    
    X-Original-Commit: 85c4011ae0a53435e2f47bd609cbccf11133720e

 nimble/controller/include/controller/ll.h     |  5 +-
 nimble/controller/include/controller/ll_adv.h |  5 +-
 nimble/controller/src/ble_ll_scan.c           | 93 +++++++++++++-------------
 nimble/controller/src/ll.c                    | 70 +++++++++++++-------
 nimble/controller/src/ll_adv.c                | 61 +++++++----------
 nimble/controller/src/ll_hci.c                |  2 +-
 nimble/controller/src/phy.c                   | 14 ++--
 nimble/host/src/host_dbg.c                    | 95 +++++++++++++++++++++++++++
 nimble/host/src/host_dbg.h                    | 22 +++++++
 nimble/host/src/host_hci.c                    |  9 +--
 10 files changed, 254 insertions(+), 122 deletions(-)

commit 3e4dd97bd8b02f4512c4c0a0cb0c996a2fd26275
Author: Marko Kiiskila <marko@runtime.io>
Date:   Thu Oct 29 11:26:17 2015 -0700

    Console full/stub provide console API. nimble host depends on console
    API.
    
    X-Original-Commit: 9386f2dee7a781adb9fdf67b62424629b984fd1a

 nimble/host/egg.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e882e878eebb41763ff5eba2bdfd0deabc2f3d2e
Author: Willam San Filippo <will@micosa.io>
Date:   Wed Oct 28 13:11:17 2015 -0700

    Modify code to search for duplicate advertising addresses
    
    X-Original-Commit: 3e7e7e90f85d86b0fb948191fdea740505eb83e5

 nimble/controller/src/ble_ll_scan.c | 94 +++++++++++++++++++++++--------------
 1 file changed, 58 insertions(+), 36 deletions(-)

commit 7891e647314659fe1155ff81000acbc3075e1f8a
Author: Willam San Filippo <will@micosa.io>
Date:   Wed Oct 28 11:55:15 2015 -0700

    display received host events on console
    
    X-Original-Commit: fc281057e0ac3953e71017e20fc5a352bab781be

 nimble/controller/src/ble_ll_scan.c | 16 ++++++++--------
 nimble/host/egg.yml                 |  1 +
 nimble/host/src/host_hci.c          |  6 ++++++
 3 files changed, 15 insertions(+), 8 deletions(-)

commit 8bf91dc32f5e558ac122dca81c6a69e8dc1d8643
Author: Willam San Filippo <will@micosa.io>
Date:   Wed Oct 28 10:37:56 2015 -0700

    Add console to ble stack. Add sending of advertising report to host
    
    X-Original-Commit: d49b73ce2854f3f6eff8417f009f5042577f96bf

 nimble/controller/include/controller/ll_hci.h  |  11 +-
 nimble/controller/include/controller/ll_scan.h |   2 +-
 nimble/controller/src/ble_ll_scan.c            | 149 +++++++++++++++++++++----
 nimble/controller/src/ll.c                     |   7 +-
 nimble/controller/src/ll_hci.c                 |  86 +++++++++-----
 nimble/host/src/host_hci.c                     |   4 +-
 nimble/include/nimble/hci_common.h             |  20 ++++
 nimble/include/nimble/hci_transport.h          |   4 +-
 8 files changed, 224 insertions(+), 59 deletions(-)

commit d46d789298a4d3d006f91160d15b1747ebcd123f
Merge: d17f408a dd14d1e0
Author: Willam San Filippo <will@micosa.io>
Date:   Mon Oct 26 16:36:32 2015 -0700

    Merge branch 'master' of https://github.com/mynewt/larva
    
    X-Original-Commit: 4c92eb043da8da093611a7ff049fb1bd4f112f83

commit d17f408affccfdf7fbfad1ec882855ea5a36c0c5
Author: Willam San Filippo <will@micosa.io>
Date:   Mon Oct 26 16:36:18 2015 -0700

    Some ll hci event framework. Rename some LL/HCI defines. Call host_task from main and modify host task to be event driven
    
    X-Original-Commit: 7e8743463ebf31d33ec71a135ea5e42848f1fee8

 nimble/controller/include/controller/ll_adv.h |  23 +++++
 nimble/controller/include/controller/ll_hci.h |   6 ++
 nimble/controller/src/ble_ll_scan.c           |  22 +++--
 nimble/controller/src/ll.c                    |   1 -
 nimble/controller/src/ll_adv.c                |  68 +++++++------
 nimble/controller/src/ll_hci.c                |  67 ++++++-------
 nimble/controller/src/phy.c                   |  27 +++---
 nimble/host/include/host/host_hci.h           |   1 +
 nimble/host/src/host_hci.c                    | 131 +++++++++++++++++++++++---
 nimble/include/nimble/ble.h                   |   4 +
 nimble/include/nimble/hci_common.h            |  96 ++++++++-----------
 nimble/include/nimble/hci_transport.h         |   4 +-
 12 files changed, 294 insertions(+), 156 deletions(-)

commit dd14d1e032c8b8d2c50f1716275930152216bd70
Author: sterling <sterling@apache.org>
Date:   Mon Oct 26 14:27:41 2015 -0700

    bad merge, bad sterly.  fix the compile.
    
    X-Original-Commit: b8eb7c152beca8ab8f7403c177806e74cf60cbc7

 nimble/include/nimble/ble.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 40283162a8d98a25eeb3ec8c55fcdbcd939e5d6d
Author: sterling <sterling@apache.org>
Date:   Mon Oct 26 13:40:09 2015 -0700

    reserve err code.
    
    X-Original-Commit: ae0bd53821f59e096eb31b61c6c88d35d53472f9

 nimble/include/nimble/ble.h | 1 +
 1 file changed, 1 insertion(+)

commit 4e0e90a0a0af5a7ef6ae0ea464744ecbb0ab15d3
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 23 14:56:55 2015 -0700

    Basic scanning implemented
    
    X-Original-Commit: 88922dc820c81f6eb305aae2a570334bb899e224

 nimble/controller/include/controller/ll.h       |  46 +-
 nimble/controller/include/controller/ll_adv.h   |   4 +-
 nimble/controller/include/controller/ll_hci.h   |   4 +
 nimble/controller/include/controller/ll_scan.h  |  38 +-
 nimble/controller/include/controller/ll_sched.h |   2 +-
 nimble/controller/include/controller/phy.h      |  26 +-
 nimble/controller/src/ble_ll_scan.c             | 927 ++++++++++++++++++++++++
 nimble/controller/src/ll.c                      | 301 ++++++--
 nimble/controller/src/ll_adv.c                  | 106 +--
 nimble/controller/src/ll_hci.c                  | 110 ++-
 nimble/controller/src/phy.c                     | 128 +++-
 nimble/host/include/host/host_hci.h             |   7 +-
 nimble/host/src/host_hci.c                      | 172 +++--
 nimble/include/nimble/ble.h                     |  35 +-
 nimble/include/nimble/hci_common.h              |  89 ++-
 15 files changed, 1698 insertions(+), 297 deletions(-)

commit 05f49a5deee189304efed60af3c5496471486fd7
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 16 14:05:06 2015 -0700

    separate host and controller hci. Add some random address support
    
    X-Original-Commit: b8bb518d4b66b9e5895caa4343cf4675983de3bd

 nimble/controller/include/controller/ll.h      |  16 +-
 nimble/controller/include/controller/ll_adv.h  |  37 +--
 nimble/controller/include/controller/ll_hci.h  |  23 ++
 nimble/controller/include/controller/ll_scan.h |   2 +
 nimble/controller/src/ll.c                     | 170 ++++++++----
 nimble/controller/src/ll_adv.c                 | 359 ++++++++++++++++---------
 nimble/controller/src/ll_hci.c                 |  26 ++
 nimble/controller/src/phy.c                    |  17 +-
 nimble/host/src/host_hci.c                     |  32 +--
 nimble/include/nimble/hci_common.h             |  33 ++-
 nimble/include/nimble/hci_transport.h          |  25 ++
 11 files changed, 476 insertions(+), 264 deletions(-)

commit bef38055d430ef70f14a336070981bff02cde279
Author: Willam San Filippo <will@micosa.io>
Date:   Thu Oct 15 15:44:24 2015 -0700

    Some controller code cleanup
    
    X-Original-Commit: e2ac6770c3af3614859608c5b128deb8e0d3ca45

 nimble/controller/include/controller/ll.h  |  21 ++-
 nimble/controller/include/controller/phy.h |  48 +++++-
 nimble/controller/src/ll.c                 |  57 +++++-
 nimble/controller/src/ll_adv.c             | 267 +++++++++++++----------------
 nimble/controller/src/ll_hci.c             | 175 +++++++++++++------
 nimble/controller/src/ll_sched.c           |  44 ++---
 nimble/controller/src/phy.c                | 264 ++++++++++++++++++----------
 nimble/host/src/host_hci.c                 |   9 +-
 nimble/include/nimble/hci_common.h         |  47 ++++-
 9 files changed, 578 insertions(+), 354 deletions(-)

commit 01c3fb685c46c3e8bc8530df4c8c30d6fd7dd38c
Author: Willam San Filippo <will@micosa.io>
Date:   Tue Oct 13 16:03:08 2015 -0700

    Addition of set scan response data command and first attempt at receiving scan requests and sending scan responses
    
    X-Original-Commit: c583778cbce20deaef5bcfb58b865417eb21c2d7

 nimble/controller/include/controller/ll.h      |  60 ++++----
 nimble/controller/include/controller/ll_adv.h  |  17 ++-
 nimble/controller/include/controller/ll_scan.h |  51 +++++++
 nimble/controller/include/controller/phy.h     |   6 +-
 nimble/controller/src/ll.c                     | 204 +++++++++++++++++++++++--
 nimble/controller/src/ll_adv.c                 | 199 +++++++++++++++++++++---
 nimble/controller/src/ll_hci.c                 |   6 +
 nimble/controller/src/ll_sched.c               |  13 +-
 nimble/controller/src/phy.c                    | 173 ++++++++++++++++++---
 nimble/host/include/host/host_hci.h            |   1 +
 nimble/host/src/host_hci.c                     |  31 +++-
 nimble/include/nimble/hci_common.h             |   5 +-
 12 files changed, 660 insertions(+), 106 deletions(-)

commit ec003cce0cd1156ffd359fe5d7f5338ed429db85
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 9 14:18:35 2015 -0700

    Remove the htoleXX and leXXtoh from host_hci.c since they are in util
    
    X-Original-Commit: d090a4c6ef036177f42bd608a9138c716ebc72bc

 nimble/host/src/host_hci.c  | 70 ---------------------------------------------
 nimble/include/nimble/ble.h |  2 +-
 nimble/src/util.c           |  1 -
 3 files changed, 1 insertion(+), 72 deletions(-)

commit 5adc9930671e5b2436ca6e5fadd3b8b217731e08
Author: Willam San Filippo <will@micosa.io>
Date:   Fri Oct 9 12:36:07 2015 -0700

    Start of the nimble ble stack
    
    X-Original-Commit: c93688b4e746d3649b4dc35292b3711dfa63051d

 nimble/controller/include/controller/ll.h       | 419 +++++++++++++++
 nimble/controller/include/controller/ll_adv.h   | 153 ++++++
 nimble/controller/include/controller/ll_sched.h |  63 +++
 nimble/controller/include/controller/phy.h      |  63 +++
 nimble/controller/src/ll.c                      | 187 +++++++
 nimble/controller/src/ll_adv.c                  | 676 ++++++++++++++++++++++++
 nimble/controller/src/ll_hci.c                  | 132 +++++
 nimble/controller/src/ll_sched.c                | 243 +++++++++
 nimble/controller/src/phy.c                     | 351 ++++++++++++
 nimble/host/include/host/host_hci.h             |  30 ++
 nimble/host/src/host_hci.c                      | 311 +++++++++++
 nimble/include/nimble/ble.h                     | 105 ++++
 nimble/include/nimble/hci_common.h              | 150 ++++++
 nimble/src/util.c                               |  89 ++++
 14 files changed, 2972 insertions(+)

commit 94e37358ec684593206bd41b93bac05fe1c64e24
Author: sterling <sterling@apache.org>
Date:   Wed Oct 7 17:55:17 2015 -0700

    add net/nimble for the BLE skeleton project.
    
    X-Original-Commit: a208b24f7ce823e1d44ca135288c3d0ad528470c

 nimble/.gitignore         | 3 +++
 nimble/README.md          | 0
 nimble/controller/egg.yml | 5 +++++
 nimble/egg.yml            | 4 ++++
 nimble/host/egg.yml       | 5 +++++
 5 files changed, 17 insertions(+)

