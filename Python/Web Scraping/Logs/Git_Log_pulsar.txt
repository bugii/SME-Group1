commit 163aa43cb80ed40939ce161188286a875fc5b999
Author: tuteng <guangning@apache.org>
Date:   Sat Nov 30 21:37:33 2019 +0800

    Fix pulsar-manager download link (#5774)

 site2/website/pages/en/download.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f0b34e79d53a909fcce31f3231b03a308b5a6120
Author: Pierre Zemb <contact@pierrezemb.fr>
Date:   Sat Nov 30 07:02:43 2019 +0100

    Bump Lombok version to allow building with a JDK12>=12 (#5772) (#5773)
    
    Fixes #5772
    
    ### Motivation
    
    I would like to be able to build Pulsar with at least JDK12.
    
    ### Modifications
    
    Bumping lombok dep.
    
    ### Verifying this change
    
    
    This change is a trivial rework / code cleanup without any test coverage.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 035743ffa13de200c0fb36500c70d10b4c523a35
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Nov 29 21:56:39 2019 -0800

    [CLI] Add a broker tool for operations of a specific broker (#5768)
    
    *Motivation*
    
    Add a tool to collect load report on a specific broker.
    This is used for troubleshooting problems in a production cluster.
    
    *Modifications*
    
    Add a broker tool for operations of a specific broker.

 bin/pulsar                                         |   3 +
 pom.xml                                            |   6 +
 pulsar-broker/pom.xml                              |   5 +
 .../pulsar/broker/loadbalance/BrokerHostUsage.java |  11 +-
 .../impl/GenericBrokerHostUsageImpl.java           |  34 +++---
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java |  25 ++--
 .../org/apache/pulsar/broker/tools/BrokerTool.java |  47 ++++++++
 .../pulsar/broker/tools/LoadReportCommand.java     | 127 +++++++++++++++++++++
 .../apache/pulsar/broker/tools/package-info.java   |  22 ++++
 9 files changed, 252 insertions(+), 28 deletions(-)

commit e4fc60981625d77fb00e137ab5a154aeed9a63f1
Author: tuteng <guangning@apache.org>
Date:   Fri Nov 29 18:56:08 2019 +0800

    [website]Add content of pulsar-manager in website(include release notes, download link) (#5741)
    
    ### Motivation
    
    As a sub-project of the pulsar, pulsar-manager should update relevant content on the website after the first release is completed, so as to facilitate users' use.
    
    ### Modifications
    
    * Add pulsar-manager release notes page
    * Add pulsar-manager download page
    * Add a document in sidebar
    
    ### Verifying this change
    
    yarn build pass

 site2/docs/administration-pulsar-manager.md        | 132 +++++++++++++++++++++
 site2/website/pages/en/download.js                 |  56 +++++++++
 .../pages/en/pulsar-manager-release-notes.js       |  35 ++++++
 site2/website/pulsar-manager-release-notes.md      |  19 +++
 site2/website/pulsar-manager-release.json          |   3 +
 site2/website/sidebars.json                        |   1 +
 6 files changed, 246 insertions(+)

commit d9c2b8b60b92dccec6f37c84bc2dba086ea2c027
Author: lipenghui <penghui@apache.org>
Date:   Fri Nov 29 13:20:37 2019 +0800

    Add document for sticky consumer  (#5745)
    
    *Motivation*
    
    ManagedLedgerFactoryChangeLedgerPathTest sets the zk session timeout to 10 ms.
    
    10ms is too low for a zookeeper client to connect to the zookeeper server.
    
    *Modifications*
    
    Remove zkSessionTimeout and use the default

 site2/docs/client-libraries-java.md                       | 15 ++++++++++++++-
 site2/docs/concepts-messaging.md                          |  2 +-
 site2/website/blog/2019-07-05-Apache-Pulsar-2-4-0.md      |  2 +-
 .../versioned_docs/version-2.4.0/client-libraries-java.md |  2 +-
 .../versioned_docs/version-2.4.1/client-libraries-java.md |  2 +-
 .../versioned_docs/version-2.4.1/concepts-messaging.md    |  2 +-
 6 files changed, 19 insertions(+), 6 deletions(-)

commit ae59d5585e6479ff7f148dbe99e5d2065bfde155
Author: Sijie Guo <sijie@apache.org>
Date:   Thu Nov 28 21:08:29 2019 -0800

    [tests] ManagedLedgerFactoryChangeLedgerPathTest is flaky (#5766)
    
    *Motivation*
    
    ManagedLedgerFactoryChangeLedgerPathTest sets the zk session timeout to 10 ms.
    
    10ms is too low for a zookeeper client to connect to the zookeeper server.
    
    *Modifications*
    
    Remove zkSessionTimeout and use the default

 .../mledger/impl/ManagedLedgerFactoryChangeLedgerPathTest.java           | 1 -
 1 file changed, 1 deletion(-)

commit ecf779210c31d1051f9cd2c823a1a7d078cdfd75
Author: lipenghui <penghui@apache.org>
Date:   Fri Nov 29 06:38:23 2019 +0800

    Fix NPE when send a large message and don't release batchedMessageMetadataAndPayload when discard in batch message container. (#5748)
    
    Fixes #5746 #5747
    
    ### Motivation
    
    Fix NPE and release an already released ByteBuf when publish an oversize message.
    
    Here is error log:
    ```
    io.netty.util.IllegalReferenceCountException: refCnt: 0, decrement: 1
            at io.netty.util.internal.ReferenceCountUpdater.toLiveRealRefCnt(ReferenceCountUpdater.java:74) ~[netty-common-4.1.43.Final.jar:4.1.43.Final]
            at io.netty.util.internal.ReferenceCountUpdater.release(ReferenceCountUpdater.java:138) ~[netty-common-4.1.43.Final.jar:4.1.43.Final]
            at io.netty.buffer.AbstractReferenceCountedByteBuf.release(AbstractReferenceCountedByteBuf.java:100) ~[netty-buffer-4.1.43.Final.jar:4.1.43.Final]
            at io.netty.util.ReferenceCountUtil.release(ReferenceCountUtil.java:88) ~[netty-common-4.1.43.Final.jar:4.1.43.Final]
            at io.netty.util.ReferenceCountUtil.safeRelease(ReferenceCountUtil.java:113) [netty-common-4.1.43.Final.jar:4.1.43.Final]
            at org.apache.pulsar.client.impl.BatchMessageKeyBasedContainer$KeyedBatch.discard(BatchMessageKeyBasedContainer.java:244) [classes/:?]
            at org.apache.pulsar.client.impl.BatchMessageKeyBasedContainer.createOpSendMsg(BatchMessageKeyBasedContainer.java:125) [classes/:?]
            at org.apache.pulsar.client.impl.BatchMessageKeyBasedContainer.createOpSendMsgs(BatchMessageKeyBasedContainer.java:145) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerImpl.batchMessageAndSend(ProducerImpl.java:1426) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerImpl.triggerFlush(ProducerImpl.java:1411) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerBase.send(ProducerBase.java:112) [classes/:?]
            at org.apache.pulsar.client.impl.TypedMessageBuilderImpl.send(TypedMessageBuilderImpl.java:89) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerBase.send(ProducerBase.java:63) [classes/:?]
            at org.apache.pulsar.broker.service.BatchMessageTest.testSendOverSizeMessage(BatchMessageTest.java:875) [test-classes/:?]
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_201]
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_201]
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_201]
            at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_201]
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124) [testng-6.14.3.jar:?]
            at org.testng.internal.Invoker.invokeMethod(Invoker.java:583) [testng-6.14.3.jar:?]
            at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:719) [testng-6.14.3.jar:?]
            at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:989) [testng-6.14.3.jar:?]
            at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125) [testng-6.14.3.jar:?]
            at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109) [testng-6.14.3.jar:?]
            at org.testng.TestRunner.privateRun(TestRunner.java:648) [testng-6.14.3.jar:?]
            at org.testng.TestRunner.run(TestRunner.java:505) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.runTest(SuiteRunner.java:455) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:450) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.privateRun(SuiteRunner.java:415) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.run(SuiteRunner.java:364) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:84) [testng-6.14.3.jar:?]
            at org.testng.TestNG.runSuitesSequentially(TestNG.java:1208) [testng-6.14.3.jar:?]
            at org.testng.TestNG.runSuitesLocally(TestNG.java:1137) [testng-6.14.3.jar:?]
            at org.testng.TestNG.runSuites(TestNG.java:1049) [testng-6.14.3.jar:?]
            at org.testng.TestNG.run(TestNG.java:1017) [testng-6.14.3.jar:?]
            at org.testng.IDEARemoteTestNG.run(IDEARemoteTestNG.java:73) [testng-plugin.jar:?]
            at org.testng.RemoteTestNGStarter.main(RemoteTestNGStarter.java:123) [testng-plugin.jar:?]
    
    
    
    16:19:13.850 [main:org.apache.pulsar.client.impl.ProducerImpl@1439] WARN  org.apache.pulsar.client.impl.ProducerImpl - [persistent://prop/ns-abc/testSendOverSizeMessage-623833fc-d9f7-4b28-aead-27955928fae9] [test-0-0] error while create opSendMsg by batch message container
    java.lang.NullPointerException: null
            at org.apache.pulsar.client.impl.ProducerImpl.releaseSemaphoreForSendOp(ProducerImpl.java:858) ~[classes/:?]
            at org.apache.pulsar.client.impl.ProducerImpl.processOpSendMsg(ProducerImpl.java:1477) ~[classes/:?]
            at org.apache.pulsar.client.impl.ProducerImpl.batchMessageAndSend(ProducerImpl.java:1432) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerImpl.triggerFlush(ProducerImpl.java:1411) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerBase.send(ProducerBase.java:112) [classes/:?]
            at org.apache.pulsar.client.impl.TypedMessageBuilderImpl.send(TypedMessageBuilderImpl.java:89) [classes/:?]
            at org.apache.pulsar.client.impl.ProducerBase.send(ProducerBase.java:63) [classes/:?]
            at org.apache.pulsar.broker.service.BatchMessageTest.testSendOverSizeMessage(BatchMessageTest.java:875) [test-classes/:?]
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_201]
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_201]
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_201]
            at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_201]
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124) [testng-6.14.3.jar:?]
            at org.testng.internal.Invoker.invokeMethod(Invoker.java:583) [testng-6.14.3.jar:?]
            at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:719) [testng-6.14.3.jar:?]
            at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:989) [testng-6.14.3.jar:?]
            at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125) [testng-6.14.3.jar:?]
            at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109) [testng-6.14.3.jar:?]
            at org.testng.TestRunner.privateRun(TestRunner.java:648) [testng-6.14.3.jar:?]
            at org.testng.TestRunner.run(TestRunner.java:505) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.runTest(SuiteRunner.java:455) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:450) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.privateRun(SuiteRunner.java:415) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunner.run(SuiteRunner.java:364) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52) [testng-6.14.3.jar:?]
            at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:84) [testng-6.14.3.jar:?]
            at org.testng.TestNG.runSuitesSequentially(TestNG.java:1208) [testng-6.14.3.jar:?]
            at org.testng.TestNG.runSuitesLocally(TestNG.java:1137) [testng-6.14.3.jar:?]
            at org.testng.TestNG.runSuites(TestNG.java:1049) [testng-6.14.3.jar:?]
            at org.testng.TestNG.run(TestNG.java:1017) [testng-6.14.3.jar:?]
            at org.testng.IDEARemoteTestNG.run(IDEARemoteTestNG.java:73) [testng-plugin.jar:?]
            at org.testng.RemoteTestNGStarter.main(RemoteTestNGStarter.java:123) [testng-plugin.jar:?]
    ```
    
    ### Modifications
    
    Add check for processOpSendMsg, if the op is null, just return.
    Don't release the batchedMessageMetadataAndPayload since it is already released in getCompressedBatchMetadataAndPayload() method.

 .../pulsar/client/impl/BatchMessageContainerImpl.java    | 16 +++++-----------
 .../client/impl/BatchMessageKeyBasedContainer.java       | 16 ++++++----------
 .../java/org/apache/pulsar/client/impl/ProducerImpl.java |  3 +++
 3 files changed, 14 insertions(+), 21 deletions(-)

commit 2e30c086b2461531c62164d09ea148928a0e3ae6
Author: lipenghui <penghui@apache.org>
Date:   Fri Nov 29 06:12:49 2019 +0800

    Remove cursor while remove non-durable subscription (#5719)
    
    ### Motivation
    
    Remove cursor from cursors of managed ledger while remove non-durable subscription.  The data deletion is depends the mark delete position of all cursors, if left a unused cursor in the cursors of managed ledger, data can't be delete as expected.
    
    ### Modifications
    
    Remove cursor while remove non-durable subscription

 .../AbstractDispatcherSingleActiveConsumer.java    |  4 +-
 .../org/apache/pulsar/broker/service/Consumer.java | 12 +++++-
 .../apache/pulsar/broker/service/Dispatcher.java   |  6 ++-
 .../apache/pulsar/broker/service/Subscription.java |  6 ++-
 .../nonpersistent/NonPersistentDispatcher.java     |  4 +-
 .../NonPersistentDispatcherMultipleConsumers.java  |  2 +-
 .../nonpersistent/NonPersistentSubscription.java   |  2 +-
 .../PersistentDispatcherMultipleConsumers.java     |  4 +-
 .../service/persistent/PersistentSubscription.java | 14 ++++++-
 .../org/apache/pulsar/client/impl/ReaderTest.java  | 44 +++++++++++++++++++---
 10 files changed, 79 insertions(+), 19 deletions(-)

commit b23c732012f7ddce97422ad6651ae66bf16b0f0e
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Fri Nov 29 06:04:51 2019 +0800

    [Issue 3009][docs] Add presto sql REST APIs doc (#5376)
    
    Fixes #3009
    
    *Motivation*
    
    There are no REST APIs usage docs for the presto SQL.

 site2/docs/sql-rest-api.md  | 185 ++++++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json |   3 +-
 2 files changed, 187 insertions(+), 1 deletion(-)

commit da80606a62a225bad7862a73ba6ecac96b1c1360
Author: lsy180829 <42792704+lsy180829@users.noreply.github.com>
Date:   Thu Nov 28 21:33:55 2019 +0800

    [Issue 5614] Deprecate brokerServicePurgeInactiveFrequencyInSeconds (#5632)
    
    * Fix Issue 5614, Deprecate brokerServicePurgeInactiveFrequencyInSeconds
    
    * [Issue 5614] Deprecate brokerServicePurgeInactiveFrequencyInSeconds

 conf/broker.conf                                        |  6 +++---
 conf/standalone.conf                                    |  5 ++---
 deployment/terraform-ansible/templates/broker.conf      |  6 +++---
 .../org/apache/pulsar/broker/ServiceConfiguration.java  |  5 ++++-
 .../org/apache/pulsar/broker/service/BrokerService.java |  2 +-
 .../pulsar/broker/service/ReplicatorTestBase.java       |  6 +++---
 .../pulsar/client/api/NonPersistentTopicTest.java       |  6 +++---
 pulsar-client-cpp/test-conf/standalone-ssl.conf         | 16 +++++++++-------
 pulsar-client-cpp/test-conf/standalone.conf             | 17 +++++++++++------
 pulsar-client-cpp/tests/authentication.conf             | 10 ++++++----
 pulsar-client-cpp/tests/standalone.conf                 | 14 ++++++++------
 site2/docs/reference-configuration.md                   |  2 --
 .../version-2.4.0/reference-configuration.md            |  2 --
 .../version-2.4.1/reference-configuration.md            |  2 --
 14 files changed, 53 insertions(+), 46 deletions(-)

commit f9929d7569fb4e602a184f00588cc5ea02f5be49
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Thu Nov 28 15:40:43 2019 +0900

    Bump athenz libraries to 1.8.38 (#5756)
    
    Updated Athenz libraries to the latest version. The latest version of Athenz seems to include some bug fixes.
    https://github.com/yahoo/athenz/releases

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e00ad114d2fc4c547a1c9863bc333891d914261d
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Thu Nov 28 06:04:16 2019 +0800

    [Pulsar-sql]Using pulsar SQL query messages will appear `NoSuchLedger` when zk root directory changed (#5001)
    
    Fixes #4715
    
    *Motivation*
    
    When zookeeper ledgers root path is changed, using pulsar-sql to query messages will cause `BKNoSuchLedgerExistsException`.
    
    *Modifications*
    
    Make bookie using `setMetadataServiceUri` to set zookeeper uri.

 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 17 ++++-
 .../mledger/impl/ManagedLedgerBkTest.java          |  4 ++
 .../ManagedLedgerFactoryChangeLedgerPathTest.java  | 79 ++++++++++++++++++++++
 .../mledger/impl/ManagedLedgerFactoryTest.java     |  8 +++
 .../bookkeeper/test/BookKeeperClusterTestCase.java | 54 +++++++++++----
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java  | 28 ++++++++
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  4 +-
 7 files changed, 176 insertions(+), 18 deletions(-)

commit 3295f8094907a4e6628ec1bc16536be699101940
Author: Geoffroy Couprie <geo.couprie@gmail.com>
Date:   Wed Nov 27 22:46:26 2019 +0100

    use the authorization provider to check superuser access (#5718)

 .../pulsar/broker/web/PulsarWebResource.java       | 26 ++++++++++++++--------
 1 file changed, 17 insertions(+), 9 deletions(-)

commit 531aab0cd297cc91c613d0fd53a8820cfe60d6da
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Thu Nov 28 02:38:39 2019 +0800

    [Issue 5729]Picture and text are not match (#5737)
    
    
    Fixes #5729
    
    ### Motivation
    
    Picture and text are not match.
    
    ### Modifications
    changed the ```Consumer-A``` to ```Consumer A-0```

 site2/docs/concepts-messaging.md                                        | 2 +-
 .../versioned_docs/version-2.1.0-incubating/concepts-messaging.md       | 2 +-
 site2/website/versioned_docs/version-2.3.0/concepts-messaging.md        | 2 +-
 site2/website/versioned_docs/version-2.3.1/concepts-messaging.md        | 2 +-
 site2/website/versioned_docs/version-2.3.2/concepts-messaging.md        | 2 +-
 site2/website/versioned_docs/version-2.4.0/concepts-messaging.md        | 2 +-
 site2/website/versioned_docs/version-2.4.1/concepts-messaging.md        | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)

commit 0ce3371b4fa6a5e1acb9deda6d8927bf8cb6da98
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Nov 28 02:15:48 2019 +0800

    [Issue 4752][docs] Add language tabs and description for Go (#5750)
    
    ### Motivation
    Currently, the following features are not available in Go Functions: SerDe, metrics, state storage, user config.
    
    ### Modifications
    Add the language-specific tab for Go, and add a sentence "the feature is not available in Go".

 site2/docs/functions-develop.md | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit e372cc9c59de661fab6b7783394e993b0c23cf79
Author: Brian Candler <b.candler@pobox.com>
Date:   Wed Nov 27 07:28:06 2019 +0000

    Fix documentation: how to start server for cpp tests (#5549)
    
    ### Modifications
    
    Out-of-date instructions in pulsar-client-cpp/README.md about how to start test server

 pulsar-client-cpp/README.md | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit eee4d892a480906a467f9ada2cc85ab8789d416d
Author: Jia Zhai <zhaijia@apache.org>
Date:   Wed Nov 27 06:17:05 2019 +0800

    init broker publish limitor at broker start time (#5754)
    
    Broker publish limiter was not start at broker start time, and only init when dynamic system config happens.
    This change init broker publish limiter at broker start time, and add a test for it.

 .../pulsar/broker/service/BrokerService.java       |   8 ++
 .../impl/TopicPublishThrottlingInitTest.java       | 123 +++++++++++++++++++++
 2 files changed, 131 insertions(+)

commit a88300c40f5acce7f589740c738ccfc6cba7faa0
Author: kishorebhat-p <47098619+kishorebhat-p@users.noreply.github.com>
Date:   Tue Nov 26 22:25:30 2019 +0530

    Adding Spark example to Write Pojo classes to Stream  (#5470)
    
    ### Motivation
    
    Added the class SensorReading and class ProducerSparkWithPojo  to showcase writing Pojo as Json Object to Pulsar Queue
    
    ### Modifications
    
    Based on the documentation written example class to write Pojos to Pulsar
    This might be more real life examples for application than bytes stream

 .../receiver/example/ProducerSparkWithPojo.java    | 61 ++++++++++++++++++++++
 .../streaming/receiver/example/SensorReading.java  | 53 +++++++++++++++++++
 2 files changed, 114 insertions(+)

commit 14f3eee33b386150bc9a00ecb8d1169df738fc0f
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Wed Nov 27 00:51:32 2019 +0800

    [Issue 5287][docs] Add documentation on how to configure multiple broker services (#5722)
    
    Fixes #5287
    
    ### Motivation
    Users do not know how to specify cluster (multi broker/zk) connection for presto.
    
    ### Modifications
    Add content on how to configure multiple hosts for `pulsar.broker-service-url`.

 site2/docs/sql-deployment-configurations.md | 7 +++++++
 1 file changed, 7 insertions(+)

commit f83793ee7f3b3e10ebe50170f492cdfc36e87612
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Nov 26 08:50:43 2019 -0800

    fix potential deadlock in pulsar client close (#5731)
    
    # Motivation
    
    A deadlock on PulsarClient.close() can happen if there are producers/consumers that are not closed prior to calling PulsarClient.close() and we have to close them in the routine.  The deadlock happens be cause we piggy pack off of a "pulsar-io" thread that is used to shutdown the connection in producer/consumer close, to also shutdown the EventLoopGroup.  "pulsar-io" thread is part of the EventLoopGroup thus it tries to shutdown itself and causes a deadlock.
    
    Below is a stacktrace of what it look like:
    
    ```
    "pulsar-client-io-1-1" #20 prio=5 os_prio=31 tid=0x00007fc312a78800 nid=0x9a03 in Object.wait() [0x000070000384e000]
       java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        - waiting on <0x00000007b8532640> (a io.netty.util.concurrent.DefaultPromise)
        at java.lang.Object.wait(Object.java:502)
        at io.netty.util.concurrent.DefaultPromise.await(DefaultPromise.java:252)
        - locked <0x00000007b8532640> (a io.netty.util.concurrent.DefaultPromise)
        at io.netty.util.concurrent.DefaultPromise.sync(DefaultPromise.java:403)
        at io.netty.util.concurrent.DefaultPromise.sync(DefaultPromise.java:35)
        at org.apache.pulsar.client.impl.ConnectionPool.close(ConnectionPool.java:286)
        at org.apache.pulsar.client.impl.PulsarClientImpl.shutdown(PulsarClientImpl.java:578)
        at org.apache.pulsar.client.impl.PulsarClientImpl.lambda$closeAsync$18(PulsarClientImpl.java:560)
        at org.apache.pulsar.client.impl.PulsarClientImpl$$Lambda$82/878861517.run(Unknown Source)
        at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:705)
        at java.util.concurrent.CompletableFuture$UniRun.tryFire(CompletableFuture.java:687)
        at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474)
        at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1962)
        at org.apache.pulsar.client.impl.ProducerImpl.lambda$closeAsync$9(ProducerImpl.java:735)
        at org.apache.pulsar.client.impl.ProducerImpl$$Lambda$80/1123226989.apply(Unknown Source)
        at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:822)
        at java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:797)
        at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474)
        at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1962)
        at org.apache.pulsar.client.impl.ClientCnx.handleSuccess(ClientCnx.java:406)
        at org.apache.pulsar.common.protocol.PulsarDecoder.channelRead(PulsarDecoder.java:222)
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)
        at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:326)
        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:300)
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)
        at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1422)
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)
        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:931)
        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:700)
        at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:635)
        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:552)
        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:514)
        at io.netty.util.concurrent.SingleThreadEventExecutor$6.run(SingleThreadEventExecutor.java:1050)
        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
        at java.lang.Thread.run(Thread.java:748)
    ```
    
    This deadlock went unnoticed for a long time because in the past we never waited for the shutdown of the EventLoopGroup to complete
    
    Also #5628 does not solve the issue.  This PR should supersede that one.

 .../main/java/org/apache/pulsar/client/impl/ConnectionPool.java   | 7 ++++++-
 .../main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java | 8 ++++++--
 2 files changed, 12 insertions(+), 3 deletions(-)

commit 9e7b938995fa87d4668e7efcca1948498a77f5d4
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Nov 26 15:27:45 2019 +0800

    Add publish rate limit for each broker to avoid OOM (#5710)
    
    Fixes #5513
    
    ### Motivation
    
    Through #3985, user could set the publish rate for each topic, but the topic number for each broker is not limited, so there is case that a lot of topics served in same broker, and if each topic send too many message, it will cause the messages not able to send to BookKeeper in time,  and messages be hold in the direct memory of broker, and cause Broker out of direct memory.
    
    ### Modifications
    
    - add broker publish rate limit base on #3985,
    - add unit test.
    
    ### Verifying this change
    unit test passed.

 conf/broker.conf                                   |  24 +-
 conf/standalone.conf                               |  25 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  30 +-
 .../pulsar/broker/service/AbstractTopic.java       |  70 ++--
 .../pulsar/broker/service/BrokerService.java       | 148 ++++++--
 .../org/apache/pulsar/broker/service/Producer.java |   2 +-
 .../pulsar/broker/service/PublishRateLimiter.java  |  33 +-
 .../org/apache/pulsar/broker/service/Topic.java    |  12 +-
 .../client/impl/MessagePublishThrottlingTest.java  | 405 +++++++++++++++++++--
 9 files changed, 643 insertions(+), 106 deletions(-)

commit 48506e57ef16b68d4fe9a1c06d2c61f79793a711
Author: hangc0276 <hangc0276@163.com>
Date:   Tue Nov 26 14:06:37 2019 +0800

    fix setTxnidMostBits bug (#5743)
    
    In TypedMessageBuilderImpl::beforeSend function, when setting TxnIdMostBits field of msgMetadataBuilder, it sets into TxnidLeastBits field and override the original TxnIdLeastBits value.

 .../java/org/apache/pulsar/client/impl/TypedMessageBuilderImpl.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit de2ff6b121de740635d89360e03899a99b41e34f
Author: atlantic2099 <57935271+atlantic2099@users.noreply.github.com>
Date:   Tue Nov 26 14:06:14 2019 +0800

    Add right parenthesis for "(max size configurable" (#5744)
    
    Resolved issue #5728

 site2/docs/concepts-messaging.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4207de67e49dc78f24b75a6211e11dbe27ad2f5d
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Tue Nov 26 05:00:31 2019 +0800

    [Issues 5692]Add document for mongodb connector (#5715)
    
    [Issues 5692]Add document for mongodb connector
    
    Fixes #5692

 site2/docs/io-cdc-debezium.md | 126 +++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 125 insertions(+), 1 deletion(-)

commit f019ece6e57b6754718c1822d376979b8357a476
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Mon Nov 25 16:59:32 2019 +0800

    Add unit for storageSize (#5707)

 site2/docs/reference-pulsar-admin.md | 3 +++
 1 file changed, 3 insertions(+)

commit a00791d5d2d0cb236164c2270e05f94a4305fb1b
Author: Fernando Rejon Barrera <39321865+frejonb@users.noreply.github.com>
Date:   Sat Nov 23 00:08:36 2019 +0100

    [Issue 5676][C++ client] Expose redelivery count (#5677)
    
    Fixes #5676
    
    ### Motivation
    
    
    Expose the redelivery count in the C++ client.
    
    ### Modifications
    
    Exposed the redelivery count from the broker in `Message` and `MessageImpl`. Set the counter when receiving messages. Added test.

 pulsar-client-cpp/include/pulsar/Message.h      |  5 +++
 pulsar-client-cpp/include/pulsar/c/message.h    |  2 ++
 pulsar-client-cpp/lib/ConsumerImpl.cc           |  6 ++--
 pulsar-client-cpp/lib/ConsumerImpl.h            |  3 +-
 pulsar-client-cpp/lib/Message.cc                |  7 ++++
 pulsar-client-cpp/lib/MessageImpl.cc            |  6 +++-
 pulsar-client-cpp/lib/MessageImpl.h             |  4 +++
 pulsar-client-cpp/lib/c/c_Message.cc            |  4 +++
 pulsar-client-cpp/test-conf/standalone-ssl.conf |  2 ++
 pulsar-client-cpp/test-conf/standalone.conf     |  2 ++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc    | 47 +++++++++++++++++++++++++
 11 files changed, 84 insertions(+), 4 deletions(-)

commit 413aa74ed68557284d6f4502456b3bef2dbd9618
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Nov 22 08:19:07 2019 -0800

    Fix: Netty threads may still linger after client close (#5628)
    
    ### Motivation
    
    Even after the synchronous close() method is called on a PulsarClient, netty thread(s) from the EventLoopGroup used in the ConnectionPool may still linger around for another 2 seconds afterwards due to not wait for the the graceful shutdown to complete.
    
    While this usually doesn't cause any problems for a normal use case, it does cause problems in the Pulsar Flink sources and sinks.  Exceptions like the following can happen when the Flink job with a Pulsar source or sink gets closed:
    
    ```
    Exception in thread "pulsar-client-io-1-1" java.lang.NoClassDefFoundError: org/apache/pulsar/shade/io/netty/buffer/PoolArena$1
            at org.apache.pulsar.shade.io.netty.buffer.PoolArena.freeChunk(PoolArena.java:293)
            at org.apache.pulsar.shade.io.netty.buffer.PoolThreadCache$MemoryRegionCache.freeEntry(PoolThreadCache.java:460)
            at org.apache.pulsar.shade.io.netty.buffer.PoolThreadCache$MemoryRegionCache.free(PoolThreadCache.java:430)
            at org.apache.pulsar.shade.io.netty.buffer.PoolThreadCache$MemoryRegionCache.free(PoolThreadCache.java:422)
            at org.apache.pulsar.shade.io.netty.buffer.PoolThreadCache.free(PoolThreadCache.java:279)
            at org.apache.pulsar.shade.io.netty.buffer.PoolThreadCache.free(PoolThreadCache.java:270)
            at org.apache.pulsar.shade.io.netty.buffer.PoolThreadCache.free(PoolThreadCache.java:241)
            at org.apache.pulsar.shade.io.netty.buffer.PooledByteBufAllocator$PoolThreadLocalCache.onRemoval(PooledByteBufAllocator.java:450)
            at org.apache.pulsar.shade.io.netty.buffer.PooledByteBufAllocator$PoolThreadLocalCache.onRemoval(PooledByteBufAllocator.java:426)
            at org.apache.pulsar.shade.io.netty.util.concurrent.FastThreadLocal.remove(FastThreadLocal.java:271)
            at org.apache.pulsar.shade.io.netty.util.concurrent.FastThreadLocal.removeAll(FastThreadLocal.java:67)
            at org.apache.pulsar.shade.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:32)
            at java.lang.Thread.run(Thread.java:748)
    Caused by: java.lang.ClassNotFoundException: org.apache.pulsar.shade.io.netty.buffer.PoolArena$1
            at java.net.URLClassLoader.findClass(URLClassLoader.java:382)
            at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
            at org.apache.flink.runtime.execution.librarycache.FlinkUserCodeClassLoaders$ChildFirstClassLoader.loadClass(FlinkUserCodeClassLoaders.java:129)
            at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
            ... 13 more
    ```
    
    This is because threads from the EventLoopGroup lingers after the pulsar client is closed and the Flink job is unloaded.
    
    ### Modifications
    
    Shorten the graceful shutdown period and wait for it to complete

 .../src/main/java/org/apache/pulsar/client/impl/ConnectionPool.java    | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 2bbb10c03b528c09bbc10013aa85a4bb27bfcc86
Author: lipenghui <penghui@apache.org>
Date:   Sat Nov 23 00:18:39 2019 +0800

    Expose lastExpireTimestamp for subscription stats. (#5721)
    
    ### Motivation
    
    Expose lastExpireTimestamp for subscription stats. Can be used to troubleshooting TTL related issues
    
    ### Verifying this change
    
    Added new unit tests

 .../service/persistent/PersistentSubscription.java    |  5 ++++-
 .../org/apache/pulsar/broker/admin/AdminApiTest.java  | 19 +++++++++++++++++++
 .../common/policies/data/SubscriptionStats.java       |  4 ++++
 3 files changed, 27 insertions(+), 1 deletion(-)

commit 0565c78069323a348f71e06b82c902eccdc5a558
Author: sky-big <sky_big@yeah.net>
Date:   Fri Nov 22 03:37:00 2019 +0800

    fix prometheus need kubernetes all namespace access control bug (#5659)
    
    Fixes #5658
    
    ### Motivation
    Fix prometheus access control not enough in kubernetes
    
    ### Modifications
    Add service account for pulsar cluster prometheus, service account binding cluster role, cluster role have  access control.

 deployment/kubernetes/aws/monitoring.yaml          | 42 ++++++++++++++++++++++
 .../generic/k8s-1-9-and-above/monitoring.yaml      | 42 ++++++++++++++++++++++
 .../kubernetes/generic/original/monitoring.yaml    | 42 ++++++++++++++++++++++
 .../google-kubernetes-engine/monitoring.yaml       | 42 ++++++++++++++++++++++
 4 files changed, 168 insertions(+)

commit f68ee8bf37b1a4b5eb2d314e12444f27f9e3bce9
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Nov 22 03:36:17 2019 +0800

    [docs] Update Pulsar SQL configuration and deployment (#5651)
    
    ### Motivation
    The structure and content needs improvement.
    
    ### Modifications
    1. Improve the structure.
    2. Improve the deployment steps.

 site2/docs/sql-deployment-configurations.md | 72 ++++++++++++++---------------
 1 file changed, 34 insertions(+), 38 deletions(-)

commit fa029700d3edbc398356f6b74cad1120649d2494
Author: tuteng <guangning@apache.org>
Date:   Thu Nov 21 14:41:39 2019 +0800

    Fix consumer of python queue size is zero (#5706)
    
    Fixes https://github.com/apache/pulsar/issues/5634
    
    
    Master Issue: https://github.com/apache/pulsar/issues/5634
    
    ### Motivation
    
    In java clients, when we call the `receive`, we will block it until a message arrives. in python clients, when we call the `receive` function, we add a delay parameter of 100ms. when the queue size is 0, the `receive` will have a strict check on the queue size, causing the following exception to be thrown
    
    ```
    Traceback (most recent call last):
      File "tst.py", line 10, in <module>
        msg = consumer.receive()
      File "/python3.7/site-packages/pulsar/__init__.py", line 930, in receive
        msg = self._consumer.receive()
    Exception: Pulsar error: InvalidConfiguration
    ```
    ### Modifications
    
    * Removing timeout parameter in synchronous `receive`
    * Add test for queue size is 0
    
    ### Verifying this change
    
    Add Test

 pulsar-client-cpp/python/pulsar_test.py  | 17 +++++++++++++++++
 pulsar-client-cpp/python/src/consumer.cc |  4 +---
 2 files changed, 18 insertions(+), 3 deletions(-)

commit 39f37c96bc2446440c66f35f197533f3eaa4a0cf
Author: SandyWei <wsser@163.com>
Date:   Thu Nov 21 10:43:39 2019 +0800

    [issues 5698]Handle replicator producer as generated name producer (#5701)
    
    Fixes #5698
    
    Motivation
    Since #5571 handle the generated producer name, the replicator producer was created by broker, only one producer for a replicated topic.
    
    So, we can handle it simple by considered replicator producer as generated name producer.

 .../pulsar/broker/service/AbstractTopic.java       | 11 +++++---
 .../pulsar/broker/service/PersistentTopicTest.java | 30 +++++++++++++++++++---
 2 files changed, 35 insertions(+), 6 deletions(-)

commit 2de6a0fa7f672682b4e8584b4739e1e6f6f07f1a
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Nov 21 00:52:56 2019 +0800

    [Doc] Add HBase sink connector guide (#5671)
    
    Fix https://github.com/apache/pulsar/issues/5667
    
    Get configurations from [HbaseSinkConfig.java](https://github.com/apache/pulsar/blob/master/pulsar-io/hbase/src/main/java/org/apache/pulsar/io/hbase/sink/HbaseSinkConfig.java) and [HbaseAbstractConfig.java](https://github.com/apache/pulsar/blob/master/pulsar-io/hbase/src/main/java/org/apache/pulsar/io/hbase/HbaseAbstractConfig.java)
    
    Get configuration examples from [sinkConfig.yaml](https://github.com/apache/pulsar/blob/master/pulsar-io/hbase/src/test/resources/sinkConfig.yaml)

 site2/docs/io-hbase-sink.md | 63 +++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 63 insertions(+)

commit c368c33947597850dd7ae05d499f038d1b313fe0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Nov 20 08:52:31 2019 -0800

    Parametrize grpc and metrics ports so that they can be configured (#5674)
    
    ### Motivation
    Currently when running functions as kubernetes pods, the grpc/metrics port that the container binds to is hardcoded. This pr allows this to be configurable.

 .../runtime/kubernetes/KubernetesRuntime.java      | 25 +++++++++++++---------
 .../kubernetes/KubernetesRuntimeFactory.java       |  7 ++++++
 .../kubernetes/KubernetesRuntimeFactoryConfig.java |  9 ++++++++
 .../kubernetes/KubernetesRuntimeFactoryTest.java   |  2 ++
 .../runtime/kubernetes/KubernetesRuntimeTest.java  |  2 ++
 5 files changed, 35 insertions(+), 10 deletions(-)

commit 22a70c2b9392daa08e185ad0c0ef867792344407
Author: YeChao Chen <chenyechao@gmail.com>
Date:   Wed Nov 20 17:41:26 2019 +0800

    [pulsar-io] improve hbase sink performance (#5705)

 .../pulsar/io/hbase/sink/HbaseGenericRecordSink.java     | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

commit 91621bce821f456bbf7d034b04271306477b7098
Author: tuteng <guangning@apache.org>
Date:   Wed Nov 20 14:29:51 2019 +0800

    Update document for developer and old version (#5700)

 site2/docs/admin-api-schemas.md                    |  92 ----
 site2/docs/concepts-schema-registry.md             |  76 ---
 site2/docs/deploy-bare-metal.md                    |   2 +-
 site2/docs/functions-api.md                        |   5 +
 site2/docs/functions-debugging.md                  | 123 +----
 site2/docs/functions-deploying.md                  | 223 --------
 site2/docs/functions-guarantees.md                 |  36 --
 site2/docs/functions-metrics.md                    |  37 --
 site2/docs/functions-quickstart.md                 |   5 +
 site2/docs/functions-state.md                      |   5 +
 site2/docs/io-aerospike.md                         |  16 -
 site2/docs/io-cassandra.md                         |  17 -
 site2/docs/io-cdc-canal.md                         | 170 ------
 site2/docs/io-elasticsearch.md                     |  16 -
 site2/docs/io-file.md                              |  22 -
 site2/docs/io-hbase.md                             |  22 -
 site2/docs/io-hdfs.md                              |  21 -
 site2/docs/io-influxdb.md                          |  20 -
 site2/docs/io-jdbc.md                              |  18 -
 site2/docs/io-kafka.md                             |  39 --
 site2/docs/io-kinesis.md                           |  31 --
 site2/docs/io-mongo.md                             |  15 -
 site2/docs/io-netty.md                             |  15 -
 site2/docs/io-rabbitmq.md                          |  48 --
 site2/docs/io-redis.md                             |  22 -
 site2/docs/io-solr.md                              |  16 -
 site2/docs/io-tcp.md                               |  14 -
 site2/docs/io-twitter.md                           |  17 -
 site2/docs/reference-connector-admin.md            | 594 ---------------------
 .../version-2.3.2/admin-api-schemas.md             |  99 ++++
 .../version-2.4.1/develop-bare-metal.md            | 446 ++++++++++++++++
 31 files changed, 562 insertions(+), 1720 deletions(-)

commit 77a69e4ead698851a270ba303d5ae19e17c4b6d1
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Nov 19 10:03:50 2019 -0800

    Use simple GC settings when running integration tests (#5342)
    
    ### Motivation
    
    Services started in integration tests are using a very aggressive GC config, with many threads and trading more memory for pause times.
    
    Additionally, multiple variables are being passed in the wrong way to the bookie container, resulting in bookies using the default Xmx of 2 GB.

 tests/docker-images/latest-version-image/conf/bookie.conf           | 4 +---
 tests/docker-images/latest-version-image/conf/broker.conf           | 2 +-
 tests/docker-images/latest-version-image/conf/functions_worker.conf | 2 +-
 tests/docker-images/latest-version-image/conf/global-zk.conf        | 2 +-
 tests/docker-images/latest-version-image/conf/local-zk.conf         | 2 +-
 tests/docker-images/latest-version-image/conf/presto_worker.conf    | 2 +-
 tests/docker-images/latest-version-image/conf/proxy.conf            | 2 +-
 7 files changed, 7 insertions(+), 9 deletions(-)

commit 33dd8b79216de3c3f74b726e6995b586b871ba0e
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Wed Nov 20 02:00:40 2019 +0800

    update content of Pulsar SQL overview (#5647)
    
    ### Motivation
    There are some redundant and unclear description in the Overview.
    
    ### Modifications
    1. Refine it to be clear and concise.
    2. Adopt minimalism writing style.

 site2/docs/sql-overview.md | 17 +++++------------
 1 file changed, 5 insertions(+), 12 deletions(-)

commit 76b3720db897c710ba6716f9843372ada13f0934
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Wed Nov 20 02:00:26 2019 +0800

    [docs] Update sql getting started (#5648)
    
    ### Motivation
    The structure is not quite clear.
    
    ### Modifications
    Refine the structure, title and content, make it more clear to follow.

 site2/docs/sql-getting-started.md | 43 ++++++++++++++++++++-------------------
 1 file changed, 22 insertions(+), 21 deletions(-)

commit 1ec3cf4bfbd42163331a28d270c6225bb5b5d91c
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Nov 19 09:59:01 2019 -0800

    Fix ProxyLookupThrottlingTest (#5639)
    
    *Motivation*
    
    ProxyLookupThrottlingTest relies on the number of permits for testing the behavior of current lookup.
    We should reset the proxyService for each run.
    
    *Modifications*
    
    Change the setup and cleanup methods from `BeforeClass/AfterClass` to `BeforeMethod/AfterMethod`.

 .../org/apache/pulsar/proxy/server/ProxyLookupThrottlingTest.java   | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 9dd8dfdc5d02fa4072361e89d06a839289f55e41
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Nov 20 01:58:51 2019 +0800

    [Doc] Re-organize built-in connector guide (#5670)
    
    Fix https://github.com/apache/pulsar/issues/5667

 site2/docs/io-cdc.md            |   2 +-
 site2/docs/io-connectors.md     | 198 ++++++++++++++++++++++++++++++++++------
 site2/docs/io-kafka-sink.md     |   2 +
 site2/docs/io-kinesis-sink.md   |  37 +++++---
 site2/docs/io-kinesis-source.md |   4 -
 5 files changed, 194 insertions(+), 49 deletions(-)

commit 56517d5f3a75a167618657fbc40d144c7829d530
Author: lipenghui <penghui@apache.org>
Date:   Tue Nov 19 15:30:10 2019 +0800

    [PIP-38] Support batch receive in java client. (#4621)
    
    Motivation
    Support messages batch receiving, some application scenarios can be made simpler. Users often increase application throughput through batch operations. For example, batch insert or update database.
    
    At present, we provide the ability to receive a single message. If users want to take advantage of batch operating advantages, need to implement a message collector him self. So this proposal aims to provide a universal interface and mechanism for batch receiving messages.
    
    For example:
    ```
    Messages messages = consumer.batchReceive();
    insertToDB(messages);
    consumer.acknowledge(messages);
    Verifying this change
    Added new UT to verify this change.
    ```

 distribution/server/licenses/LICENSE-jcip.txt      |   7 +
 distribution/server/src/assemble/LICENSE.bin.txt   |   4 +
 distribution/server/src/assemble/NOTICE.bin.txt    |   3 +
 pom.xml                                            |   8 +-
 .../client/api/ConsumerBatchReceiveTest.java       | 296 +++++++++++++++++++++
 .../pulsar/client/api/BatchReceivePolicy.java      | 145 ++++++++++
 .../org/apache/pulsar/client/api/Consumer.java     |  75 ++++++
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  15 ++
 .../apache/pulsar/client/api/ConsumerStats.java    |  10 +
 .../org/apache/pulsar/client/api/Messages.java     |  31 +++
 pulsar-client/pom.xml                              |   5 +
 .../apache/pulsar/client/impl/ConsumerBase.java    | 267 +++++++++++++++----
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   9 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  78 +++++-
 .../pulsar/client/impl/ConsumerStatsDisabled.java  |  15 ++
 .../pulsar/client/impl/ConsumerStatsRecorder.java  |   2 +
 .../client/impl/ConsumerStatsRecorderImpl.java     |  32 ++-
 .../apache/pulsar/client/impl/MessagesImpl.java    |  80 ++++++
 .../client/impl/MultiTopicsConsumerImpl.java       |  76 +++++-
 .../impl/conf/ConsumerConfigurationData.java       |   5 +-
 .../client/impl/ConsumerBuilderImplTest.java       |  14 +
 .../pulsar/client/impl/ConsumerImplTest.java       |   2 +
 .../pulsar/PulsarConsumerSourceTests.java          |  26 ++
 pulsar-sql/presto-distribution/LICENSE             |   4 +
 site2/docs/client-libraries-java.md                |  40 +++
 src/check-binary-license                           |   2 +-
 26 files changed, 1181 insertions(+), 70 deletions(-)

commit dd9e669a179dd67b55b7d62f81a21e437a8656bb
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Tue Nov 19 15:27:55 2019 +0800

    fix example code of java client (#5691)

 site2/docs/client-libraries-java.md                                 | 2 +-
 site2/website/versioned_docs/version-2.4.0/client-libraries-java.md | 2 +-
 site2/website/versioned_docs/version-2.4.1/client-libraries-java.md | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 5d6b78ded1e2be0266af6e1e8e2885f90cce245e
Author: Fernando Rejon Barrera <39321865+frejonb@users.noreply.github.com>
Date:   Tue Nov 19 07:15:13 2019 +0100

    pin debian release (#5689)

 dashboard/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 16affa0d1680a764bbc9f4ea492aa9fc0eab265e
Author: hangc0276 <hangc0276@163.com>
Date:   Tue Nov 19 13:12:50 2019 +0800

    fix bkenv has no effect bug when start bookie using bin/pulsar-daemon (#5675)
    
    when i start bookie using `bin/pulsar-daemon start bookie` command, i found the bookie environment variable defined in conf/bkenv.sh has no effect, but using $PULSAR_MEM and $PULSAR_GC instead.
    
    Then i check the bin/pulsar shell script, i found as follow:
    ```
    elif [ $COMMAND == "bookie" ]; then
        PULSAR_LOG_FILE=${PULSAR_LOG_FILE:-"bookkeeper.log"}
        # Pass BOOKIE_EXTRA_OPTS option defined in pulsar_env.sh
        OPTS="$OPTS $BOOKIE_EXTRA_OPTS"
        exec $JAVA $OPTS -Dpulsar.log.file=$PULSAR_LOG_FILE org.apache.bookkeeper.proto.BookieServer --conf $PULSAR_BOOKKEEPER_CONF $@
    ```
    but in pulsar_env.sh, the `$BOOKIE_EXTRA_OPTS` defined as follow:
    ```
    # Set BOOKIE_EXTRA_OPTS option here to ensure that all pulsar scripts can work seamless with bookkeeper
    
    # Extra options to be passed to the jvm
    BOOKIE_EXTRA_OPTS="${BOOKIE_EXTRA_OPTS} -Dio.netty.leakDetectionLevel=disabled -Dio.netty.recycler.maxCapacity.default=1000 -Dio.netty.recycler.linkCapacity=1024"
    ```
    `$BOOKIE_EXTRA_OPTS` do not define `$BOOKIE_MEM` and `$BOOKIE_GC`, then the pulsar script will using `$PULSAR_MEM` and `$PULSAR_GC` instead to start bookkeeper.
    
    So, i suggest to load conf/bkenv.sh in bin/pulsar script and using `$BOOKIE_EXTRA_OPTS` in conf/bkenv.sh instread of `$BOOKIE_EXTRA_OPTS` in bin/pulsar_env.sh

 bin/pulsar         | 6 ++++++
 bin/pulsar-daemon  | 6 ++++++
 bin/pulsar-perf    | 6 ++++++
 conf/pulsar_env.sh | 4 ----
 src/pulsar-io-gen  | 6 ++++++
 5 files changed, 24 insertions(+), 4 deletions(-)

commit d16e79a1d42f1ad92c144f80ce429c3479d280a7
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Tue Nov 19 13:10:20 2019 +0800

     Fix hangs when type invalid args at command-line (#5615)
    
    Fixes #5533
    
    *Motivation*
    
    When we using command-line tools, it hangs after type an invalid args.
    
    *Modifications*
    
    We don't need to parse the command, just show the command usage.

 .../src/main/java/org/apache/pulsar/admin/cli/CmdBase.java  | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

commit bfcfdf6357addf8dbdccb96c158bf4a8d516c9b4
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Tue Nov 19 13:08:16 2019 +0800

    `hasMessageAvailable` should return false when Reader read from latest messages (#5023)
    
    Fixes #4912
    
    *Motivation*
    
    When the reader read from the latest message, `hasMessageAvailable` will timeout or hang on.
    
    *Modifications*
    
    Make `lastDequeuedMessage` start position should keep with `startMessageId`.

 .../org/apache/pulsar/client/impl/ReaderTest.java  | 32 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  7 +++++
 2 files changed, 39 insertions(+)

commit 568df47f6ef603a292f48d0a3bda8a1cea185981
Author: hangc0276 <hangc0276@163.com>
Date:   Tue Nov 19 12:51:20 2019 +0800

    [Issue 5346]bin/pulsar standalone --zookeeper-port 2183 does not work with version 2.4.1 (#5679)
    
    Fixes [#5346](https://github.com/apache/pulsar/issues/5346)
    
    When start pulsar in standalone mode, and specify zookeeper port using `bin/pulsar standalone --zookeeper-port 2183`, the pulsar will start failed if `configurationStoreServers` is set in conf/standalone.conf and the port not same with --zookeeper-port set in command line.
    
    The reason is `--zookeeper-port` set in command line only override zkServer configuration and will not override `configurationStoreServers` in conf/standalone.conf.
    
    In my fix, i will override `configurationStoreServers` if using `--zookeeper-port` to setup pulsar in standalone mode.

 .../src/main/java/org/apache/pulsar/PulsarStandaloneStarter.java      | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 75c7229bceccc6f70db192d221258cc86ae99f73
Author: lipenghui <penghui@apache.org>
Date:   Tue Nov 19 11:59:19 2019 +0800

    Add epoch for connection handler to handle create producer timeout. (#5571)
    
    Fixes #5535
    
    Motivation
    Currently, if user create producer timeout, the connection handler of producer will reconnect to the broker later, but if in broker already done the previous create producer request, the reconnection will failed with "producer with name xxx is already connected".
    
    So this PR will introduce epoch for connection handler and add a field named isGeneratedName for producer to handle above problem.
    
    This PR only handle the generated producer name scenario, so many users occur errors such like
    #5535, so we need to fix the generated producer name scenario first.
    
    For the scenario of user specified producer name, we can discuss later and find a simple approach to handle it, i left my idea here: using producer id and producer name as the identity of producer, producer name used for EO producer and producer id can used by the producer reconnect, but this approach depends on globally unique producer id generator.
    
    Modifications
    If the producer with generated producer name and epoch of the producer is bigger than the exists producer, the new producer will overwrite the old producer, so the reconnect producer will create succeed.
    
    Verifying this change
    Add unit tests to simulate producer timeout and reconnection

 .../pulsar/broker/service/AbstractTopic.java       |  67 ++++++++++--
 .../pulsar/broker/service/BacklogQuotaManager.java |   5 +-
 .../org/apache/pulsar/broker/service/Producer.java |  29 ++++--
 .../apache/pulsar/broker/service/ServerCnx.java    |  12 ++-
 .../org/apache/pulsar/broker/service/Topic.java    |   3 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  52 ++++------
 .../broker/service/persistent/PersistentTopic.java |  63 +++++-------
 .../stats/prometheus/NamespaceStatsAggregator.java |   2 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  62 +++++++++--
 .../pulsar/client/api/ProducerCreationTest.java    |  95 +++++++++++++++++
 .../client/impl/MessagePublishThrottlingTest.java  |   4 +-
 .../pulsar/client/impl/ConnectionHandler.java      |  18 +++-
 .../apache/pulsar/client/impl/ProducerImpl.java    |   7 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 114 +++++++++++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |   7 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   7 ++
 16 files changed, 435 insertions(+), 112 deletions(-)

commit 8d1f793b543250d44e97f29eb355c27ae900ffb7
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Tue Nov 19 09:53:37 2019 +0800

    [Issue 5474][pulsar-io-debezium] Support CDC Connector for MongoDB (#5590)
    
    * support mongodb connector
    
    * add tester
    
    * add tester
    
    * add tester
    
    * add  license header
    
    * fix by some comments
    
    * add jdbc source sink
    
    * add init data
    
    * fix code style and default port 27017 of mongodb

 distribution/io/src/assemble/io.xml                |  1 +
 pulsar-io/debezium/mongodb/pom.xml                 | 58 +++++++++++++++
 .../io/debezium/mongodb/DebeziumMongoDbSource.java | 36 +++++++++
 .../resources/META-INF/services/pulsar-io.yaml     | 22 ++++++
 .../resources/debezium-mongodb-source-config.yaml  | 38 ++++++++++
 pulsar-io/debezium/pom.xml                         |  1 +
 .../containers/DebeziumMongoDbContainer.java       | 51 +++++++++++++
 .../integration/functions/PulsarFunctionsTest.java | 62 ++++++++++++++++
 .../io/DebeziumMongoDbSourceTester.java            | 85 ++++++++++++++++++++++
 .../integration/io/DebeziumMySqlSourceTester.java  | 18 -----
 .../io/DebeziumPostgreSqlSourceTester.java         | 18 -----
 .../pulsar/tests/integration/io/SourceTester.java  | 31 ++++++++
 12 files changed, 385 insertions(+), 36 deletions(-)

commit 69cd6eb660afc421828a525d2c8be677d7eebc6f
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Fri Nov 15 15:06:45 2019 +0800

    fix typo error (#5663)
    
    fix typo error of website
    
    Fixes #5661
    
    
    
    ### Motivation
    fix typo error of website
    
    ### Modifications
    changed test-tentant to test-tenant

 .../version-2.1.0-incubating/deploy-bare-metal-multi-cluster.md         | 2 +-
 .../versioned_docs/version-2.2.0/deploy-bare-metal-multi-cluster.md     | 2 +-
 .../versioned_docs/version-2.3.1/deploy-bare-metal-multi-cluster.md     | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 8a7d690b394f2f4eaf6f82fb7727577120314dd7
Author: lipenghui <penghui@apache.org>
Date:   Fri Nov 15 15:03:29 2019 +0800

    Add highest sequenceId for CommandSendReceipt. (#5653)
    
    ## Motivation
    
    Since #5491 merged, while user use new pulsar client to produce batch messages to older version broker(e.g. 2.4.0), send ack error will occur:
    
    ```
    [pulsar-client-io-8-2] WARN  org.apache.pulsar.client.impl.ProducerImpl - [persistent://sandbox/pressure-test/test-A-partition-11] [pulsar-cluster-test-13-294] Got ack for msg. expecting: 13 - got: 224 - queue-size: 9
    ```
    
    The problem is client use highest sequence id to match the response sequence id, but in old version broker can not return the highest id.
    
    So, this pr is try to fix the problem of produce batch message with new version client and old version broker.
    
    ### Modifications
    
    Add highest sequence id to CommandSendReceipt. If the response highest sequence id of send receipt > lowest sequence id, it means broker is a new version broker, so we need to verify the highest sequence id, otherwise we only verify the lowest sequence id.

 .../org/apache/pulsar/broker/service/Producer.java |  3 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  3 +-
 .../apache/pulsar/client/api/ClientErrorsTest.java |  4 +-
 .../pulsar/client/api/MockBrokerService.java       |  2 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  3 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    | 46 +++++++++--------
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 ++++++++++++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |  4 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |  1 +
 .../PulsarStandaloneTestSuite2_3.java              | 42 ++++++++++++++++
 .../PulsarStandaloneTestSuite2_4.java              | 42 ++++++++++++++++
 .../backwardscompatibility/SmokeTest2_2.java       |  5 ++
 .../backwardscompatibility/SmokeTest2_3.java       | 36 ++++++++++++++
 .../backwardscompatibility/SmokeTest2_4.java       | 36 ++++++++++++++
 .../integration/containers/PulsarContainer.java    |  1 +
 .../integration/topologies/PulsarTestBase.java     | 41 ++++++++++++++++
 .../resources/pulsar-backwards-compatibility.xml   | 30 ++++++++++++
 tests/integration/src/test/resources/pulsar.xml    |  1 +
 18 files changed, 329 insertions(+), 28 deletions(-)

commit fe9633f79b104630194e29c21146c392fe576182
Author: wangyunpeng666 <57751906+wangyunpeng666@users.noreply.github.com>
Date:   Fri Nov 15 15:02:05 2019 +0800

    fix: modfiy tentant to tenant (#5665)
    
    modfiy tentant to tenant

 site2/docs/deploy-bare-metal-multi-cluster.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit dedfb2b5df865bcb04e66666b93e18cb25f5b60b
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Nov 15 11:44:33 2019 +0800

    [java-client] Introduce `batchingMaxBytes` setting in pulsar producer (#5045)
    
    * [client] Introduce `batchingMaxBytes` setting in pulsar producer
    
    *Motivation*
    
    The message size can vary between applications. Using number of messages to estimate
    the resources used for batching leads to unpredictability.
    
    This pull request introduces a new setting `batchingMaxBytes` in pulsar producer.
    It allows applications planning the resource usage for batching in a better way.
    
    * Address review comments
    
    * Use MaxMessageSize
    
    * Use MaxMessageSize as the cap for the buffer size
    
    * Address review comments
    
    * Fix tests
    
    * Fix PerformanceProducer

 .../pulsar/broker/service/BatchMessageTest.java    | 49 ++++++++++++++++++++++
 .../apache/pulsar/client/api/ProducerBuilder.java  | 20 ++++++++-
 .../client/impl/AbstractBatchMessageContainer.java | 15 +++++--
 .../client/impl/BatchMessageContainerBase.java     |  3 +-
 .../client/impl/BatchMessageContainerImpl.java     |  7 +++-
 .../client/impl/BatchMessageKeyBasedContainer.java |  5 ++-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  6 +++
 .../apache/pulsar/client/impl/ProducerImpl.java    |  8 +---
 .../impl/conf/ProducerConfigurationData.java       |  6 ++-
 .../client/impl/ProducerBuilderImplTest.java       |  5 ---
 .../pulsar/testclient/PerformanceProducer.java     | 21 +++++++---
 11 files changed, 118 insertions(+), 27 deletions(-)

commit 320cebe09f80116a2df81a5df1bcfd518ecf8c08
Author: Addison Higham <addisonj@gmail.com>
Date:   Thu Nov 14 07:13:24 2019 -0700

    [functions] Allow functions to pass runtime specific options (#5400)
    
    ### Motivation
    
    This commit adds a new argument for functions, customRuntimeOptions, which is passed to
    funcions (as well as sources/sinks) that enables the ability to
    customize the runtime.
    
    This is added primarily to support the `KubernetesManifestCustomizer`
    interface. This interface is intended, as the name indicates, allows for
    customizing how the kubernetes manifests are generated before they
    are sent off to the k8s cluster.
    
    This interface has a default implementation, which allows for
    changing the namespace, labels, nodeSelector labels, and toleratations per function.
    
    This interface is also pluggable, allowing for more customized
    implementations. For example, the functions for a given tenant could be
    mapped to different pools of compute for isolation.
    
    ### Modifications
    
    For the CLI and protobufs, the modifications just involve plumbing through the new option, `customRuntimeOptions` through the relevant code.
    
    For kubernetes runtime, the modifications are fairly straight forward, adding a new configuration option, `kubernetesManifestCustomizerClassName` and `kubernetesManifestCustomizerConfig` which are options under the kubernetes runtime.

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   6 +
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   6 +
 .../org/apache/pulsar/admin/cli/CmdSources.java    |   5 +
 .../pulsar/common/functions/FunctionConfig.java    |   4 +
 .../org/apache/pulsar/common/io/SinkConfig.java    |   4 +
 .../org/apache/pulsar/common/io/SourceConfig.java  |   4 +
 .../org/apache/pulsar/functions/LocalRunner.java   |   2 +-
 .../proto/src/main/proto/Function.proto            |   1 +
 .../auth/ClearTextFunctionTokenAuthProvider.java   |   9 +-
 .../functions/auth/FunctionAuthProvider.java       |  18 +--
 .../auth/KubernetesFunctionAuthProvider.java       |  18 ++-
 .../auth/KubernetesSecretsTokenAuthProvider.java   |  52 +++++---
 .../functions/runtime/RuntimeCustomizer.java       |  31 +++++
 .../pulsar/functions/runtime/RuntimeFactory.java   |  11 +-
 .../BasicKubernetesManifestCustomizer.java         | 113 +++++++++++++++++
 .../kubernetes/KubernetesManifestCustomizer.java   |  39 ++++++
 .../runtime/kubernetes/KubernetesRuntime.java      |  24 +++-
 .../kubernetes/KubernetesRuntimeFactory.java       |  50 ++++++--
 .../kubernetes/KubernetesRuntimeFactoryConfig.java |   1 +
 .../runtime/process/ProcessRuntimeFactory.java     |  25 +++-
 .../runtime/thread/ThreadRuntimeFactory.java       |   4 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  15 +++
 .../ClearTextFunctionTokenAuthProviderTest.java    |   5 +-
 .../KubernetesSecretsTokenAuthProviderTest.java    |  24 ++--
 .../kubernetes/KubernetesRuntimeFactoryTest.java   |  41 +++---
 .../runtime/kubernetes/KubernetesRuntimeTest.java  | 139 +++++++++++++++++++--
 .../runtime/process/ProcessRuntimeTest.java        |   2 +-
 .../functions/utils/FunctionConfigUtils.java       |  11 ++
 .../pulsar/functions/utils/SinkConfigUtils.java    |  11 ++
 .../pulsar/functions/utils/SourceConfigUtils.java  |  16 ++-
 .../pulsar/functions/worker/FunctionActioner.java  |   5 +-
 .../functions/worker/FunctionRuntimeManager.java   |  19 +--
 .../functions/worker/rest/api/FunctionsImpl.java   |  10 +-
 .../functions/worker/rest/api/SinksImpl.java       |   8 +-
 .../functions/worker/rest/api/SourcesImpl.java     |   8 +-
 .../functions/worker/FunctionActionerTest.java     |   2 +-
 site2/docs/functions-cli.md                        |  24 ++--
 site2/docs/functions-runtime.md                    |  43 ++++++-
 38 files changed, 665 insertions(+), 145 deletions(-)

commit b8667870f31ba2c200b8ddb24d2a25e187e0530f
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Nov 14 14:50:07 2019 +0800

    Upgrade bk version to 4.10.0 (#5607)
    
    * Upgrade bk version to 4.10.0
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * Handle NoSuchLedgerExistsOnMetadataServer error

 distribution/server/src/assemble/LICENSE.bin.txt   | 54 +++++++++++-----------
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 17 ++++---
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 14 ++++--
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |  3 +-
 .../org/apache/bookkeeper/mledger/util/Errors.java | 40 ++++++++++++++++
 .../mledger/impl/OffloadPrefixReadTest.java        |  5 ++
 pom.xml                                            |  2 +-
 .../pulsar/compaction/CompactedTopicTest.java      |  3 +-
 pulsar-sql/presto-distribution/LICENSE             | 22 ++++-----
 .../zookeeper/ZkBookieRackAffinityMapping.java     | 14 ++++--
 .../tests/integration/offload/TestBaseOffload.java |  3 +-
 .../offload/jcloud/impl/OffloadIndexBlockImpl.java |  5 ++
 12 files changed, 123 insertions(+), 59 deletions(-)

commit 74e210ed7b18f854b2811b9a71ce0d2728beb2f1
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Nov 14 14:19:12 2019 +0800

    Cherry-pick functions admin api docs to 2.4.1 (#5641)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../version-2.4.1/admin-api-functions.md           | 546 +++++++++++++++++++++
 .../versioned_sidebars/version-2.4.1-sidebars.json |   3 +-
 2 files changed, 548 insertions(+), 1 deletion(-)

commit ca361b58b47cd2104e06e6391c35dd36e11a4afb
Author: YeChao Chen <chenyechao@gmail.com>
Date:   Thu Nov 14 04:08:01 2019 +0800

    [pulsar-io] hbase table should be closed properly (#5646)

 .../main/java/org/apache/pulsar/io/hbase/sink/HbaseAbstractSink.java  | 4 ++++
 1 file changed, 4 insertions(+)

commit 73aaf6870e4f9468080f0e7a763c4f73ca6adbe2
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Nov 14 04:07:46 2019 +0800

    update python versions (#5649)

 pulsar-client-cpp/python/pulsar/__init__.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ca9e28bc513c71eff26ada4ecd2d5b07605083ba
Author: Sijie Guo <sijie@apache.org>
Date:   Wed Nov 13 19:44:12 2019 +0800

    Improve PartitionedTopicsSchemaTest (#5640)
    
    *Modifications*
    
    - Add `SubscriptionInitialPosition` when constructing consumers to provide a predictable consumption
      behavior for testings
    - Create a test base for bk ensemble tests `BkEnsemblesTestBase`
    - Make PartitionedTopicsSchemaTest extend BkEnsemblesTestBase

 .../pulsar/broker/service/BkEnsemblesTestBase.java | 115 +++++++++++++++++++++
 .../broker/service/BrokerBkEnsemblesTests.java     |  83 +--------------
 .../schema/PartitionedTopicsSchemaTest.java        |  36 ++++---
 3 files changed, 136 insertions(+), 98 deletions(-)

commit b7b9926b243fbf16e582c29fb1c2b0abe7777785
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Nov 13 03:18:47 2019 -0800

    Fix: don't set interrupt flag again after catching interrupt exception in Pulsar Client (#5643)

 .../main/java/org/apache/pulsar/client/api/PulsarClientException.java    | 1 -
 1 file changed, 1 deletion(-)

commit aeca8fe3adacf500a76eb6e5a5a5ebb92fe62313
Author: hangc0276 <hangc0276@163.com>
Date:   Wed Nov 13 15:40:13 2019 +0800

    fix prometheusMetrics export contains " bug (#5605)
    
    when i use Oracle JDK 10.0.2the broker metrics `jvm_info` will export as follow:
    ```
    # TYPE jvm_info gauge
    jvm_info{cluster="pulsar-cluster-zk",version="10.0.2+13",vendor=""Oracle Corporation"",runtime="Java(TM) SE Runtime Environment"} 1.0
    ```
    and then prometheus will failed when parsing `""Oracle Corporation""`
    ![image](https://user-images.githubusercontent.com/5436568/68560255-41398a80-047b-11ea-9fcb-b79d748a353d.png)
    
    
    The Reason is when using `io.prometheus:simpleclient:0.5.0` to collect jvm info, it returns jvm vendor with `"Oracle Corporation"`, and in the Pulsar source code, it adds `"` in both sides, so it comming with `vendor=""Oracle Corporation""`, and prometheus parse failed.

 .../pulsar/broker/stats/prometheus/PrometheusMetricsGenerator.java | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 1ab1ffd4b9b58b0a665902625d0d758b6ec6922a
Author: hangc0276 <hangc0276@163.com>
Date:   Wed Nov 13 14:45:21 2019 +0800

    update Maven version to 3.3.9+ in README.md (#5617)
    
    When compiled with maven version 3.0.4, it failed and report error message as follow:
    ```
    [ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3:test (default-test) on project pulsar-client-api: Execution default-test of goal org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3:test failed: Unable to load the mojo 'test' (or one of its required components) from the plugin 'org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3': com.google.inject.ProvisionException: Guice provision errors:
    [ERROR]
    [ERROR] 1) No implementation for org.codehaus.plexus.languages.java.jpms.LocationManager was bound.
    [ERROR] while locating org.apache.maven.plugin.surefire.SurefirePlugin
    [ERROR] at ClassRealm[plugin>org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3, parent: sun.misc.Launcher$AppClassLoader@5c647e05]
    [ERROR] while locating org.apache.maven.plugin.Mojo annotated with @com.google.inject.name.Named(value=org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3:test)
    [ERROR]
    [ERROR] 1 error
    [ERROR] role: org.apache.maven.plugin.Mojo
    [ERROR] roleHint: org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3:test
    [ERROR] -> [Help 1]
    [ERROR]
    [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
    [ERROR] Re-run Maven using the -X switch to enable full debug logging.
    [ERROR]
    [ERROR] For more information about the errors and possible solutions, please read the following articles:
    [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginContainerException
    [ERROR]
    [ERROR] After correcting the problems, you can resume the build with the command
    [ERROR]   mvn <goals> -rf :pulsar-client-api
    
    ```
    
    Error reference:
    `https://stackoverflow.com/questions/53211941/unable-to-load-the-mojo-test-org-apache-maven-pluginsmaven-surefire-plugin`
    
    When compiled with maven 3.3.3, it failed and report error message as follow:
    ```
    [ERROR] Failed to execute goal net.alchim31.maven:scala-maven-plugin:4.0.1:add-source (default) on project flink: The plugin net.alchim31.maven:scala-maven-plugin:4.0.1 requires Maven version 3.3.9 -> [Help 1]
    [ERROR]
    [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
    [ERROR] Re-run Maven using the -X switch to enable full debug logging.
    [ERROR]
    [ERROR] For more information about the errors and possible solutions, please read the following articles:
    [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginIncompatibleException
    [ERROR]
    [ERROR] After correcting the problems, you can resume the build with the command
    [ERROR]   mvn <goals> -rf :flink
    
    ```
    
    
    Only Maven 3.3.9+, the project can build success.

 README.md |  2 +-
 pom.xml   | 25 ++++++++++++++++++++++++-
 2 files changed, 25 insertions(+), 2 deletions(-)

commit d3cb108590713735ef1b23ff61997bf68e0fd7f3
Author: lipenghui <penghui@apache.org>
Date:   Wed Nov 13 10:42:16 2019 +0800

    [Issue 5476]Fix message deduplicate issue while using external sequence id with batch produce (#5491)
    
    Fixes #5476
    
    ### Motivation
    
    Fix #5476
    
    ### Modifications
    
    1. Add `last_sequence_id` in MessageMetadata and CommandSend, use sequence id and last_sequence_id  to indicate the batch `lowest_sequence_id` and `highest_sequence_id`.
    2. Handle batch message deduplicate check in MessageDeduplication
    3. Response the `last_sequence_id` to client and add message deduplicate check in client

 .../org/apache/pulsar/broker/service/Producer.java |  82 +++++++++++++--
 .../apache/pulsar/broker/service/ServerCnx.java    |   7 +-
 .../org/apache/pulsar/broker/service/Topic.java    |  16 ++-
 .../service/persistent/MessageDeduplication.java   |  12 ++-
 .../service/persistent/PersistentReplicator.java   |   3 +-
 .../service/persistent/MessageDuplicationTest.java |  43 ++++++++
 .../pulsar/client/api/ClientDeduplicationTest.java | 106 +++++++++++++++++++
 .../client/impl/BatchMessageContainerImpl.java     |  25 +++--
 .../apache/pulsar/client/impl/ProducerImpl.java    |  86 ++++++++++++----
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 114 +++++++++++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |  31 ++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   6 ++
 12 files changed, 487 insertions(+), 44 deletions(-)

commit f8e91a261fe28337eb748887bdcd10677ab01ced
Author: Guchman <frankiensteinmusic@gmail.com>
Date:   Wed Nov 13 05:41:39 2019 +0300

    fix: java doc on MessageListener - acknowledgement part (#5429)
    
    JavaDoc fix
    
    MessageListener's message ack responsibility was not documented

 .../src/main/java/org/apache/pulsar/client/api/MessageListener.java     | 2 ++
 .../src/main/java/org/apache/pulsar/client/api/MessageListener.java     | 2 ++
 2 files changed, 4 insertions(+)

commit 96acc57a19958ecce22e63d961ac5353a5cbaf64
Author: YeChao Chen <chenyechao@gmail.com>
Date:   Wed Nov 13 09:22:33 2019 +0800

    [pulsar-io] hbase sink avoid flushing hbase table (#5629)

 .../main/java/org/apache/pulsar/io/hbase/sink/HbaseAbstractSink.java   | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit c57d5c2ce2f3784faea364cd3298baf5617ce993
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Tue Nov 12 21:36:28 2019 -0300

    Expose include head message for durable consumers (#5622)
    
    *Motivation*
    
    Currently the option to include the very first message while consuming is just
    exposed for Reader interface only, but implemented in ConsumerImpl and using it
    only for non-durable subscription.
    
    This PR just expose this feature for normal consumers.
    
    *Modifications*
    
      - Expose `startMessageIdInclusive` method on ConsumerBuilder interface.
      - Fix message filter to consider all kind of subscriptions.
      - Add test to assert expected positions after reset on consumer.

 .../apache/pulsar/broker/admin/AdminApiTest.java   | 21 ++++---
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    | 18 ++++--
 .../client/api/SimpleProducerConsumerTest.java     | 67 +++++++++++++++++++++-
 .../client/api/v1/V1_ProducerConsumerTest.java     |  5 +-
 .../client/impl/BrokerClientIntegrationTest.java   |  1 +
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  8 +++
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  6 ++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  8 +--
 8 files changed, 114 insertions(+), 20 deletions(-)

commit 5beaa2841919fb1b44e045ad2dd6eb43471c8e92
Author: Sijie Guo <sijie@apache.org>
Date:   Wed Nov 13 08:35:59 2019 +0800

    [tests] remove redundant check in PulsarFunctionE2ESecurityTest (#5636)
    
    *Motivation*
    
    We use `retryStrategically` to wait for a condition being met.
    There is no need to check the condition again if the condition is already met.

 .../broker/auth/MockedPulsarServiceBaseTest.java   |  5 ++-
 .../worker/PulsarFunctionE2ESecurityTest.java      | 52 +++++++++++-----------
 2 files changed, 29 insertions(+), 28 deletions(-)

commit 9b9bff4959b5fc7a425bd7d501a51e937329a069
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Wed Nov 13 08:33:24 2019 +0800

    [Issue 5618] [docs]Correct python example (#5625)
    
    * correct python example
    
    * update two link issues
    
    * remove the default constructor
    
    * update content in version 2.4.1

 site2/docs/functions-develop.md                    |  23 +-
 .../version-2.4.1/functions-develop.md             | 282 ++++++++++++++++++++-
 2 files changed, 282 insertions(+), 23 deletions(-)

commit 3e7cb68bf9917f0701bfb3853fcf449926478b40
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Nov 12 21:32:42 2019 +0800

    Data is not deleted after expiration due to connected readers (#5621)
    
    * Data is not deleted after expiration due to connected readers
    
    *Problem*
    
    A problem is observed when stress testing pulsar using [pulsar-flink](https://github.com/streamnative/pulsar-flink) -
    No matter what TTL or retention setting is used, the data is never cleaned up. So the stress test ends up failing due
    to disk filled up.
    
    The root cause of the problem is described as below.
    
    when a reader is opened using `MessageId.earliest`, a non-durable cursor with position (-1, -2) is added to the cursor heap.
    The position `(-1, -2)` in the heap is never updated because non-durable cursors are never advanced when mark-deletions
    happen. So the slowest cursor position is always `(-1, -2)`, thus causing no ledger can be deleted even they are expired
    or over quota.
    
    *Motivation*
    
    Fix the problem to make sure Pulsar honor to TTL and retention settings.
    
    *Modifications*
    
    - Fix the `startPosition` when PersistentTopic opens a non-durable cursor on `MessageId.earliest`.
      So the `startPosition` is (-1, -1) not (-1, -2).
    
    - Fix the `NonDurableCursorImpl` constructor to check if the position in the ledger of `MessageId.earliest`.
      If the provided position is in the `earliest` ledger, the mark-deleted position will be set to the previous
      position of first position.
    
    - Fix the `NonDurableCursorImpl` to advance ledger cursor when mark-deletion happens on a non-durable cursor.
    
    *Verify this change*
    
    Unit tests are coming.

 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  6 +++
 .../mledger/impl/ManagedCursorContainer.java       |  2 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  4 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 12 +++---
 .../mledger/impl/NonDurableCursorImpl.java         |  8 +++-
 .../mledger/impl/NonDurableCursorTest.java         | 47 +++++++++++++++++++++-
 .../broker/service/persistent/PersistentTopic.java |  3 +-
 .../buffer/impl/PersistentTransactionBuffer.java   |  3 +-
 8 files changed, 71 insertions(+), 14 deletions(-)

commit 0279431121476b1d89a87448d2bc6abe4b919f3a
Author:  <ranxiaolong716@gmail.com>
Date:   Tue Nov 12 14:35:52 2019 +0800

    [Docs] Add admin api docs of Pulsar Functions (#5593)
    
    ### Motivation
    
    In admin api, the functions docs missing.
    
    ### Modifications
    
    Add admin api docs of Pulsar Functions.

 node_modules/.yarn-integrity      |  10 +
 site2/docs/admin-api-functions.md | 545 ++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json       |   3 +-
 3 files changed, 557 insertions(+), 1 deletion(-)

commit f2f801af9c4b16e4142078a556166e16317b2dd3
Author: SandyWei <wsser@163.com>
Date:   Mon Nov 11 13:43:45 2019 +0800

    [Issue 5585][pulsar-client] Fix producer Semaphore release error  (#5587)
    
    ### Motivation
    
    Fixes #5585
    
    This PR is try to fix the dead lock issue which mentioned in #5585. The core problem is the semaphore release count calculation in replicate scenario.
    
    Replicator send a batch message(from the original producer) without batcher, so that the batch message acquire 1 each batch message but release it by number of messages in the batch. This PR will handle the semaphore release in replicate scenario.
    
    ### Modifications
    
    Release only one semaphore in replicate scenario.

 .../pulsar/client/impl/ProducerSemaphoreTest.java  | 135 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ProducerImpl.java    |  31 +++--
 2 files changed, 157 insertions(+), 9 deletions(-)

commit 006f291b69ad49dbe0f682f6fe0d6a865f4c06fe
Author:  <ranxiaolong716@gmail.com>
Date:   Mon Nov 11 13:42:36 2019 +0800

    [Docs] Fix the go client docs missing in website (#5595)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    Fixes: #2719
    
    ### Motivation
    
    In website, the go client docs missing.
    
    ### Modifications
    
    Add missing docs for go client.

 site2/docs/client-libraries-go.md | 28 ++++++++++++++++++++++++----
 1 file changed, 24 insertions(+), 4 deletions(-)

commit 983d7907cd18bad4f3a63d89ff94d64420137b2b
Author: Collignon-Ducret Rmi <miton18@users.noreply.github.com>
Date:   Mon Nov 11 04:41:44 2019 +0100

    typo: traffic (#5327)

 .../apache/pulsar/broker/stats/prometheus/NamespaceStatsAggregator.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3195848d97990c92e548f18b4b2302b65ebd3734
Author: sky-big <sky_big@yeah.net>
Date:   Mon Nov 11 11:13:02 2019 +0800

    fix zookeeper kubernetes annotations for prometheus pull metrics from port 8000 (#5601)

 deployment/kubernetes/aws/zookeeper.yaml                       | 2 +-
 deployment/kubernetes/generic/k8s-1-9-and-above/zookeeper.yaml | 2 +-
 deployment/kubernetes/generic/original/zookeeper.yaml          | 2 +-
 deployment/kubernetes/google-kubernetes-engine/zookeeper.yaml  | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit 2fbe5f51df67b907f7f10c4873a54ffda6c593c6
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Mon Nov 11 11:04:00 2019 +0800

    [Issue 5553] [website] Add coding-guide page (#5594)
    
    * Add coding-guide page
    
    * update config
    
    * update contributing file

 site2/website/contributing.md          |  2 +-
 site2/website/core/Footer.js           |  2 ++
 site2/website/pages/en/coding-guide.js | 35 ++++++++++++++++++++++++++++++++++
 3 files changed, 38 insertions(+), 1 deletion(-)

commit 96a9418808d65d3cbcb57e39fccceebe609d3db3
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Mon Nov 11 01:33:19 2019 +0800

    [Issue 5575]  fix typo in BrokersBase file (#5596)
    
    * support mongodb connector
    
    * fix typo
    
    * revert

 .../src/main/java/org/apache/pulsar/broker/admin/impl/BrokersBase.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f2ee3fa6ab98ed284cd352a33286aa35135c237e
Author: Naveen Kumar <krnaveen14@gmail.com>
Date:   Sat Nov 9 01:15:32 2019 +0530

    [pulsar-io] [kafka-connect-adapter] KafkaSourceRecord - Initialize key property with Optional.empty() if keyBytes from SourceRecord is null (Optional property should never itself be null) (#5591)

 .../java/org/apache/pulsar/io/kafka/connect/KafkaConnectSource.java   | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 951664cfb9c4b54125477823e8e140692fb71970
Author: lipenghui <penghui@apache.org>
Date:   Fri Nov 8 14:15:35 2019 +0800

    [PIP-51] Introduce sticky consumer (#5388)
    
    ### Motivation
    
    Introduce sticky consumer, users can enable it by
    
    ```java
    client.newConsumer()
             .keySharedPolicy(KeySharedPolicy.exclusiveHashRange().hashRangeTotal(10).ranges(Range.of(0, 10)))
             .subscribe();
    ```
    
    ### Modifications
    
    Add a new consumer selector named HashRangeExclusiveStickyKeyConsumerSelector to support sticky consumer.
    
    This change added tests and can be verified as follows:
    
    Add new unit tests.

 .../org/apache/pulsar/broker/service/Consumer.java |   11 +-
 ...shRangeAutoSplitStickyKeyConsumerSelector.java} |    8 +-
 ...ashRangeExclusiveStickyKeyConsumerSelector.java |  118 +
 .../apache/pulsar/broker/service/ServerCnx.java    |    6 +-
 .../broker/service/StickyKeyConsumerSelector.java  |    9 +
 .../org/apache/pulsar/broker/service/Topic.java    |    3 +-
 ...istentStickyKeyDispatcherMultipleConsumers.java |   12 +-
 .../nonpersistent/NonPersistentSubscription.java   |   22 +-
 .../service/nonpersistent/NonPersistentTopic.java  |    5 +-
 ...istentStickyKeyDispatcherMultipleConsumers.java |   12 +-
 .../service/persistent/PersistentSubscription.java |   22 +-
 .../broker/service/persistent/PersistentTopic.java |    5 +-
 ...ngeAutoSplitStickyKeyConsumerSelectorTest.java} |   12 +-
 ...angeExclusiveStickyKeyConsumerSelectorTest.java |  191 +
 .../PersistentDispatcherFailoverConsumerTest.java  |   18 +-
 .../service/PersistentTopicConcurrentTest.java     |    8 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   61 +-
 .../client/api/KeySharedSubscriptionTest.java      |  181 +-
 .../NonPersistentKeySharedSubscriptionTest.java    |  181 +-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   27 +-
 .../apache/pulsar/client/api/KeySharedMode.java    |   36 +
 .../apache/pulsar/client/api/KeySharedPolicy.java  |  112 +
 .../java/org/apache/pulsar/client/api/Range.java   |   64 +
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   14 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |    2 +-
 .../impl/conf/ConsumerConfigurationData.java       |    3 +
 .../pulsar/client/api/KeySharedPolicyTest.java     |   62 +
 .../org/apache/pulsar/client/api/RangeTest.java    |   64 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 7948 +++++++++++---------
 .../apache/pulsar/common/protocol/Commands.java    |   33 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   21 +-
 31 files changed, 5688 insertions(+), 3583 deletions(-)

commit c460f226111ee03decbb47abb903ad1c9a8e9618
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Nov 8 02:13:17 2019 +0800

    Remove old Pulsar website (#5576)
    
    * Remove old Pulsar website
    
    * Remove `site/` reference

 README.md                                          |    2 +-
 deployment/kubernetes/README.md                    |    2 +-
 deployment/kubernetes/aws/README.md                |    2 +-
 distribution/server/src/assemble/src.xml           |    1 -
 pom.xml                                            |   13 -
 site/.gitignore                                    |   13 -
 site/.htmltest.yml                                 |   26 -
 site/Gemfile                                       |   23 -
 site/Gemfile.lock                                  |   66 -
 site/Makefile                                      |  100 -
 site/README.md                                     |  179 --
 site/VERSIONS                                      |    1 -
 site/_config.local.yml                             |   21 -
 site/_config.yml                                   |   65 -
 site/_data/cli/bookkeeper.yaml                     |   73 -
 site/_data/cli/pulsar-admin.yaml                   |  909 -------
 site/_data/cli/pulsar-client.yaml                  |   63 -
 site/_data/cli/pulsar-daemon.yaml                  |   34 -
 site/_data/cli/pulsar-perf.yaml                    |  153 --
 site/_data/cli/pulsar.yaml                         |  193 --
 site/_data/codebase-ja.yaml                        |   58 -
 site/_data/codebase.yaml                           |   58 -
 site/_data/config/bookkeeper.yaml                  |  230 --
 site/_data/config/broker.yaml                      |  355 ---
 site/_data/config/client.yaml                      |   35 -
 site/_data/config/discovery.yaml                   |   65 -
 site/_data/config/global_zookeeper.yaml            |   44 -
 site/_data/config/log4j-shell.yaml                 |   39 -
 site/_data/config/log4j.yaml                       |   57 -
 site/_data/config/proxy.yaml                       |   81 -
 site/_data/config/standalone.yaml                  |  219 --
 site/_data/config/websocket.yaml                   |   62 -
 site/_data/config/zookeeper.yaml                   |   44 -
 site/_data/connectors.yaml                         |   49 -
 site/_data/deps.yaml                               |   24 -
 site/_data/features.yaml                           |   60 -
 site/_data/messages-ja.yaml                        |   63 -
 site/_data/messages.yaml                           |   60 -
 site/_data/popovers-ja.yaml                        |  116 -
 site/_data/popovers.yaml                           |  124 -
 site/_data/resources/articles.yaml                 |   35 -
 site/_data/resources/presentations.yaml            |   39 -
 site/_data/sidebar-ja.yaml                         |  113 -
 site/_data/sidebar.yaml                            |  203 --
 site/_data/stats-ja.yaml                           |   69 -
 site/_data/stats.yaml                              |   70 -
 site/_includes/admonition.html                     |   26 -
 site/_includes/calendar.html                       |   22 -
 site/_includes/cli.html                            |  204 --
 site/_includes/codebase-ja.html                    |   34 -
 site/_includes/codebase.html                       |   34 -
 site/_includes/config.html                         |   40 -
 site/_includes/connectors.html                     |   44 -
 site/_includes/explanations/admin-setup.md         |   53 -
 site/_includes/explanations/client-url.md          |   40 -
 site/_includes/explanations/deploying-bk.md        |   59 -
 site/_includes/explanations/deploying-zk.md        |  141 --
 site/_includes/explanations/install-package.md     |   69 -
 site/_includes/explanations/ja/admin-setup.md      |   53 -
 site/_includes/explanations/ja/broker-admin.md     |  170 --
 site/_includes/explanations/ja/client-url.md       |   54 -
 site/_includes/explanations/ja/cluster-admin.md    |  205 --
 site/_includes/explanations/ja/deploying-bk.md     |   58 -
 site/_includes/explanations/ja/deploying-zk.md     |  136 -
 site/_includes/explanations/ja/install-package.md  |   75 -
 site/_includes/explanations/ja/instance-admin.md   |   22 -
 site/_includes/explanations/ja/namespace-admin.md  |  625 -----
 .../explanations/ja/non-persistent-topic-admin.md  |  239 --
 .../explanations/ja/non-persistent-topics.md       |   79 -
 .../explanations/ja/partitioned-topic-admin.md     |  293 ---
 .../explanations/ja/partitioned-topics.md          |   52 -
 site/_includes/explanations/ja/permissions.md      |  135 -
 .../explanations/ja/persistent-topic-admin.md      |  565 -----
 .../explanations/ja/properties-namespaces.md       |   42 -
 site/_includes/explanations/ja/property-admin.md   |   98 -
 .../explanations/ja/service-discovery-setup.md     |   48 -
 .../explanations/non-persistent-topics.md          |   28 -
 .../explanations/partitioned-topic-admin.md        |  293 ---
 site/_includes/explanations/partitioned-topics.md  |   52 -
 site/_includes/explanations/permissions.md         |  134 -
 .../explanations/service-discovery-setup.md        |   48 -
 site/_includes/explanations/tenants-namespaces.md  |   42 -
 site/_includes/figure.html                         |   28 -
 site/_includes/footer.html                         |   26 -
 site/_includes/fqfn.html                           |   23 -
 site/_includes/google-analytics.html               |   30 -
 site/_includes/head.html                           |   38 -
 site/_includes/message-ja.html                     |   27 -
 site/_includes/message.html                        |   27 -
 site/_includes/navbar.html                         |  155 --
 site/_includes/protobuf.html                       |  138 -
 site/_includes/python-deps.html                    |   29 -
 site/_includes/resources/articles.html             |   37 -
 site/_includes/resources/presentations.html        |   49 -
 site/_includes/sidebar-ja.html                     |   52 -
 site/_includes/sidebar.html                        |   52 -
 site/_includes/stats-ja.html                       |   37 -
 site/_includes/stats.html                          |   37 -
 site/_includes/swagger.html                        |  116 -
 site/_includes/tags-modal-ja.html                  |   38 -
 site/_includes/tags-modal.html                     |   38 -
 site/_includes/topic.html                          |   23 -
 site/_includes/version-warning.html                |   23 -
 site/_layouts/content.html                         |   50 -
 site/_layouts/default.html                         |   71 -
 site/_layouts/docs-ja.html                         |   61 -
 site/_layouts/docs-main.html                       |   43 -
 site/_layouts/docs.html                            |   65 -
 site/_layouts/rest-api-ja.html                     |   46 -
 site/_layouts/rest-api.html                        |   44 -
 site/_plugins/custom_tags.rb                       |  123 -
 site/_plugins/custom_tags_ja.rb                    |   46 -
 site/_sass/_admonition.scss                        |   79 -
 site/_sass/_cli.scss                               |  118 -
 site/_sass/_docs.scss                              |  291 ---
 site/_sass/_mixins.scss                            |   35 -
 site/_sass/_navbar.scss                            |   77 -
 site/_sass/_popover.scss                           |   43 -
 site/_sass/_protobuf.scss                          |   97 -
 site/_sass/_sidebar.scss                           |   84 -
 site/_sass/_swagger.scss                           |   66 -
 site/_sass/_syntax.scss                            |  171 --
 site/_sass/_toc.scss                               |   90 -
 site/_sass/_variables.scss                         |   73 -
 site/_sass/bootstrap-sass/.scss-lint.yml           |  567 -----
 site/_sass/bootstrap-sass/_alert.scss              |   55 -
 site/_sass/bootstrap-sass/_badge.scss              |   77 -
 site/_sass/bootstrap-sass/_breadcrumb.scss         |   38 -
 site/_sass/bootstrap-sass/_button-group.scss       |  202 --
 site/_sass/bootstrap-sass/_buttons.scss            |  170 --
 site/_sass/bootstrap-sass/_card.scss               |  276 --
 site/_sass/bootstrap-sass/_carousel.scss           |  178 --
 site/_sass/bootstrap-sass/_close.scss              |   31 -
 site/_sass/bootstrap-sass/_code.scss               |   64 -
 site/_sass/bootstrap-sass/_custom-forms.scss       |  263 --
 site/_sass/bootstrap-sass/_custom.scss             |    4 -
 site/_sass/bootstrap-sass/_dropdown.scss           |  161 --
 site/_sass/bootstrap-sass/_forms.scss              |  388 ---
 site/_sass/bootstrap-sass/_grid.scss               |   52 -
 site/_sass/bootstrap-sass/_images.scss             |   43 -
 site/_sass/bootstrap-sass/_input-group.scss        |  178 --
 site/_sass/bootstrap-sass/_jumbotron.scss          |   20 -
 site/_sass/bootstrap-sass/_list-group.scss         |  141 --
 site/_sass/bootstrap-sass/_media.scss              |    8 -
 site/_sass/bootstrap-sass/_mixins.scss             |   57 -
 site/_sass/bootstrap-sass/_modal.scss              |  142 --
 site/_sass/bootstrap-sass/_nav.scss                |  119 -
 site/_sass/bootstrap-sass/_navbar.scss             |  268 --
 site/_sass/bootstrap-sass/_normalize.scss          |  461 ----
 site/_sass/bootstrap-sass/_pagination.scss         |   67 -
 site/_sass/bootstrap-sass/_popover.scss            |  171 --
 site/_sass/bootstrap-sass/_print.scss              |  119 -
 site/_sass/bootstrap-sass/_progress.scss           |   32 -
 site/_sass/bootstrap-sass/_reboot.scss             |  389 ---
 site/_sass/bootstrap-sass/_responsive-embed.scss   |   52 -
 site/_sass/bootstrap-sass/_tables.scss             |  153 --
 site/_sass/bootstrap-sass/_tooltip.scss            |   90 -
 site/_sass/bootstrap-sass/_transitions.scss        |   34 -
 site/_sass/bootstrap-sass/_type.scss               |  143 --
 site/_sass/bootstrap-sass/_utilities.scss          |   13 -
 site/_sass/bootstrap-sass/_variables.scss          |  961 -------
 site/_sass/bootstrap-sass/bootstrap-grid.scss      |   43 -
 site/_sass/bootstrap-sass/bootstrap-reboot.scss    |   10 -
 site/_sass/bootstrap-sass/bootstrap.scss           |   54 -
 site/_sass/bootstrap-sass/mixins/_alert.scss       |   14 -
 .../bootstrap-sass/mixins/_background-variant.scss |   12 -
 site/_sass/bootstrap-sass/mixins/_badge.scss       |   11 -
 .../bootstrap-sass/mixins/_border-radius.scss      |   35 -
 site/_sass/bootstrap-sass/mixins/_breakpoints.scss |   95 -
 site/_sass/bootstrap-sass/mixins/_buttons.scss     |   86 -
 site/_sass/bootstrap-sass/mixins/_cards.scss       |   47 -
 site/_sass/bootstrap-sass/mixins/_clearfix.scss    |    7 -
 site/_sass/bootstrap-sass/mixins/_float.scss       |    9 -
 site/_sass/bootstrap-sass/mixins/_forms.scss       |   79 -
 site/_sass/bootstrap-sass/mixins/_gradients.scss   |   37 -
 .../bootstrap-sass/mixins/_grid-framework.scss     |   65 -
 site/_sass/bootstrap-sass/mixins/_grid.scss        |  100 -
 site/_sass/bootstrap-sass/mixins/_hover.scss       |   60 -
 site/_sass/bootstrap-sass/mixins/_image.scss       |   36 -
 site/_sass/bootstrap-sass/mixins/_list-group.scss  |   28 -
 site/_sass/bootstrap-sass/mixins/_lists.scss       |    7 -
 site/_sass/bootstrap-sass/mixins/_nav-divider.scss |   10 -
 .../_sass/bootstrap-sass/mixins/_navbar-align.scss |    9 -
 site/_sass/bootstrap-sass/mixins/_pagination.scss  |   21 -
 site/_sass/bootstrap-sass/mixins/_reset-text.scss  |   17 -
 site/_sass/bootstrap-sass/mixins/_resize.scss      |    6 -
 .../bootstrap-sass/mixins/_screen-reader.scss      |   32 -
 site/_sass/bootstrap-sass/mixins/_size.scss        |    6 -
 site/_sass/bootstrap-sass/mixins/_table-row.scss   |   30 -
 .../bootstrap-sass/mixins/_text-emphasis.scss      |   12 -
 site/_sass/bootstrap-sass/mixins/_text-hide.scss   |    8 -
 .../bootstrap-sass/mixins/_text-truncate.scss      |    8 -
 site/_sass/bootstrap-sass/mixins/_transforms.scss  |   14 -
 site/_sass/bootstrap-sass/mixins/_visibility.scss  |    5 -
 site/_sass/bootstrap-sass/utilities/_align.scss    |    6 -
 .../bootstrap-sass/utilities/_background.scss      |   19 -
 site/_sass/bootstrap-sass/utilities/_borders.scss  |   37 -
 site/_sass/bootstrap-sass/utilities/_clearfix.scss |    3 -
 site/_sass/bootstrap-sass/utilities/_display.scss  |   18 -
 site/_sass/bootstrap-sass/utilities/_flex.scss     |   48 -
 site/_sass/bootstrap-sass/utilities/_float.scss    |    9 -
 site/_sass/bootstrap-sass/utilities/_position.scss |   23 -
 .../bootstrap-sass/utilities/_screenreaders.scss   |   11 -
 site/_sass/bootstrap-sass/utilities/_sizing.scss   |   10 -
 site/_sass/bootstrap-sass/utilities/_spacing.scss  |   43 -
 site/_sass/bootstrap-sass/utilities/_text.scss     |   61 -
 .../bootstrap-sass/utilities/_visibility.scss      |   55 -
 site/_sass/font-awesome/_animated.scss             |   34 -
 site/_sass/font-awesome/_bordered-pulled.scss      |   25 -
 site/_sass/font-awesome/_core.scss                 |   12 -
 site/_sass/font-awesome/_fixed-width.scss          |    6 -
 site/_sass/font-awesome/_icons.scss                |  789 ------
 site/_sass/font-awesome/_larger.scss               |   13 -
 site/_sass/font-awesome/_list.scss                 |   19 -
 site/_sass/font-awesome/_mixins.scss               |   60 -
 site/_sass/font-awesome/_path.scss                 |   15 -
 site/_sass/font-awesome/_rotated-flipped.scss      |   20 -
 site/_sass/font-awesome/_screen-reader.scss        |    5 -
 site/_sass/font-awesome/_stacked.scss              |   20 -
 site/_sass/font-awesome/_variables.scss            |  799 ------
 site/_sass/font-awesome/font-awesome.scss          |   18 -
 site/contact.md                                    |   44 -
 site/css/style.scss                                |  279 --
 site/docs/latest/_config.version.yml               |   20 -
 site/docs/latest/adaptors/KafkaWrapper.md          |  277 --
 site/docs/latest/adaptors/PulsarSpark.md           |   95 -
 site/docs/latest/adaptors/PulsarStorm.md           |  124 -
 site/docs/latest/admin-api/brokers.md              |  177 --
 site/docs/latest/admin-api/clusters.md             |  236 --
 site/docs/latest/admin-api/namespaces.md           |  660 -----
 .../docs/latest/admin-api/non-persistent-topics.md |  273 --
 site/docs/latest/admin-api/overview.md             |   50 -
 site/docs/latest/admin-api/partitioned-topics.md   |   34 -
 site/docs/latest/admin-api/permissions.md          |   28 -
 site/docs/latest/admin-api/persistent-topics.md    |  664 -----
 site/docs/latest/admin-api/tenants.md              |  104 -
 site/docs/latest/admin/Dashboard.md                |   69 -
 site/docs/latest/admin/GeoReplication.md           |  144 --
 site/docs/latest/admin/LoadDistribution.md         |  235 --
 site/docs/latest/admin/Proxy.md                    |   59 -
 site/docs/latest/admin/Stats.md                    |   32 -
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |  179 --
 site/docs/latest/clients/Cpp.md                    |  147 --
 site/docs/latest/clients/Java.md                   |  474 ----
 site/docs/latest/clients/Python.md                 |  116 -
 site/docs/latest/clients/WebSocket.md              |  422 ----
 site/docs/latest/clients/go.md                     |  449 ----
 site/docs/latest/cookbooks/Encryption.md           |  194 --
 site/docs/latest/cookbooks/PartitionedTopics.md    |  110 -
 site/docs/latest/cookbooks/RetentionExpiry.md      |  317 ---
 site/docs/latest/cookbooks/compaction.md           |  125 -
 .../docs/latest/cookbooks/message-deduplication.md |  119 -
 site/docs/latest/cookbooks/message-queue.md        |  113 -
 .../latest/cookbooks/non-persistent-messaging.md   |   66 -
 site/docs/latest/cookbooks/tiered-storage.md       |  187 --
 site/docs/latest/deployment/Kubernetes.md          |  338 ---
 site/docs/latest/deployment/Monitoring.md          |  116 -
 site/docs/latest/deployment/aws-cluster.md         |  184 --
 site/docs/latest/deployment/cluster.md             |  257 --
 site/docs/latest/deployment/dcos.md                |  177 --
 site/docs/latest/deployment/instance.md            |  190 --
 site/docs/latest/functions/api.md                  |  704 ------
 site/docs/latest/functions/deployment.md           |  236 --
 site/docs/latest/functions/guarantees.md           |   41 -
 site/docs/latest/functions/metrics.md              |   41 -
 site/docs/latest/functions/overview.md             |  449 ----
 site/docs/latest/functions/quickstart.md           |  268 --
 site/docs/latest/getting-started/Clients.md        |   56 -
 .../getting-started/ConceptsAndArchitecture.md     |  657 -----
 site/docs/latest/getting-started/LocalCluster.md   |  110 -
 site/docs/latest/getting-started/Pulsar-2.0.md     |   62 -
 site/docs/latest/getting-started/docker.md         |  191 --
 site/docs/latest/io/overview.md                    |   51 -
 site/docs/latest/io/quickstart.md                  |   84 -
 site/docs/latest/project/BinaryProtocol.md         |  586 -----
 site/docs/latest/project/Codebase.md               |   29 -
 site/docs/latest/project/CompileCpp.md             |  120 -
 site/docs/latest/project/ModularLoadManager.md     |  232 --
 site/docs/latest/project/SimulationTools.md        |  124 -
 site/docs/latest/project/schema-storage.md         |   58 -
 site/docs/latest/reference/CliTools.md             |   62 -
 site/docs/latest/reference/Configuration.md        |  103 -
 site/docs/latest/reference/RestApi.md              |   29 -
 site/docs/latest/security/athenz.md                |  103 -
 site/docs/latest/security/authorization.md         |  126 -
 site/docs/latest/security/encryption.md            |  194 --
 site/docs/latest/security/extending.md             |  228 --
 site/docs/latest/security/openssl.cnf              |  152 --
 site/docs/latest/security/overview.md              |   57 -
 site/docs/latest/security/tls-transport.md         |  206 --
 site/docs/latest/security/tls.md                   |  152 --
 site/download.md                                   |   76 -
 site/events/current-event.md                       |   32 -
 site/fonts/font-awesome/FontAwesome.otf            |  Bin 259642 -> 0 bytes
 site/fonts/font-awesome/fontawesome-webfont.eot    |  Bin 165742 -> 0 bytes
 site/fonts/font-awesome/fontawesome-webfont.svg    | 2671 --------------------
 site/fonts/font-awesome/fontawesome-webfont.ttf    |  Bin 165548 -> 0 bytes
 site/fonts/font-awesome/fontawesome-webfont.woff   |  Bin 98024 -> 0 bytes
 site/fonts/font-awesome/fontawesome-webfont.woff2  |  Bin 77160 -> 0 bytes
 site/img/Binary Protocol - Connect.graffle         |  Bin 2718 -> 0 bytes
 site/img/Binary Protocol - Connect.png             |  Bin 10230 -> 0 bytes
 site/img/Binary Protocol - Consumer.graffle        |  Bin 3583 -> 0 bytes
 site/img/Binary Protocol - Consumer.png            |  Bin 32239 -> 0 bytes
 site/img/Binary Protocol - Producer.graffle        |  Bin 3480 -> 0 bytes
 site/img/Binary Protocol - Producer.png            |  Bin 33100 -> 0 bytes
 site/img/Binary Protocol - Topic lookup.graffle    |  Bin 3002 -> 0 bytes
 site/img/Binary Protocol - Topic lookup.png        |  Bin 29050 -> 0 bytes
 site/img/GeoReplication.png                        |  Bin 86141 -> 0 bytes
 site/img/Pulsar-icon.pdf                           |  Bin 8713 -> 0 bytes
 site/img/PulsarEncryptionConsumer.jpg              |  Bin 31221 -> 0 bytes
 site/img/PulsarEncryptionProducer.jpg              |  Bin 30885 -> 0 bytes
 site/img/broker-bookie.png                         |  Bin 136204 -> 0 bytes
 site/img/dcos/bookie_log.png                       |  Bin 668472 -> 0 bytes
 site/img/dcos/bookkeeper_in_zookeeper.png          |  Bin 264657 -> 0 bytes
 site/img/dcos/bookkeeper_run.png                   |  Bin 524502 -> 0 bytes
 site/img/dcos/bookkeeper_status.png                |  Bin 115364 -> 0 bytes
 site/img/dcos/broker_in_zookeeper.png              |  Bin 402876 -> 0 bytes
 site/img/dcos/broker_log.png                       |  Bin 689765 -> 0 bytes
 site/img/dcos/broker_run.png                       |  Bin 200575 -> 0 bytes
 site/img/dcos/broker_status.png                    |  Bin 144495 -> 0 bytes
 site/img/dcos/command_execute.png                  |  Bin 129195 -> 0 bytes
 site/img/dcos/command_execute2.png                 |  Bin 699589 -> 0 bytes
 site/img/dcos/consumer.png                         |  Bin 1620672 -> 0 bytes
 site/img/dcos/dcos-logo.png                        |  Bin 17756 -> 0 bytes
 site/img/dcos/grafana_dashboard.png                |  Bin 102136 -> 0 bytes
 site/img/dcos/grafana_endpoint.png                 |  Bin 277004 -> 0 bytes
 site/img/dcos/metrics.png                          |  Bin 389670 -> 0 bytes
 site/img/dcos/monitor_status.png                   |  Bin 136506 -> 0 bytes
 site/img/dcos/producer.png                         |  Bin 1542880 -> 0 bytes
 site/img/dcos/prom_endpoint.png                    |  Bin 224700 -> 0 bytes
 site/img/dcos/prom_targets.png                     |  Bin 240218 -> 0 bytes
 site/img/dcos/uninstall.png                        |  Bin 115389 -> 0 bytes
 site/img/exclusive-subscriptions.png               |  Bin 59440 -> 0 bytes
 site/img/failover-subscriptions.png                |  Bin 64604 -> 0 bytes
 site/img/feather.png                               |  Bin 37733 -> 0 bytes
 site/img/japan-flag.svg                            |    5 -
 site/img/message-deduplication.png                 |  Bin 116703 -> 0 bytes
 site/img/partitioning.png                          |  Bin 125576 -> 0 bytes
 site/img/pulsar-functions-overview.png             |  Bin 77077 -> 0 bytes
 site/img/pulsar-functions-routing-example.png      |  Bin 62087 -> 0 bytes
 site/img/pulsar-functions-word-count.png           |  Bin 85250 -> 0 bytes
 site/img/pulsar-io.png                             |  Bin 37316 -> 0 bytes
 site/img/pulsar-logo.png                           |  Bin 6156 -> 0 bytes
 site/img/pulsar-reader-consumer-interfaces.png     |  Bin 131839 -> 0 bytes
 site/img/pulsar-service-discovery.png              |  Bin 65898 -> 0 bytes
 site/img/pulsar-subscription-modes.png             |  Bin 66178 -> 0 bytes
 site/img/pulsar-system-architecture.png            |  Bin 309560 -> 0 bytes
 site/img/pulsar-tiered-storage.png                 |  Bin 9351 -> 0 bytes
 site/img/pulsar.pdf                                |  Bin 42581 -> 0 bytes
 site/img/pulsar.png                                |  Bin 6156 -> 0 bytes
 site/img/pulsar.svg                                |    1 -
 site/img/pulsar_partitioned_topic.jpg              |  Bin 73437 -> 0 bytes
 site/img/pulsar_subscriptions.jpg                  |  Bin 40837 -> 0 bytes
 site/img/retention-expiry.png                      |  Bin 113741 -> 0 bytes
 site/img/shared-subscriptions.png                  |  Bin 68922 -> 0 bytes
 site/index.html                                    |   80 -
 site/ja/adaptors/PulsarSpark.md                    |   84 -
 site/ja/adaptors/PulsarStorm.md                    |  124 -
 site/ja/admin/AdminInterface.md                    |  469 ----
 site/ja/admin/Authz.md                             |  328 ---
 site/ja/admin/ClustersBrokers.md                   |   43 -
 site/ja/admin/Dashboard.md                         |   57 -
 site/ja/admin/GeoReplication.md                    |  140 -
 site/ja/admin/ModularLoadManager.md                |  207 --
 site/ja/admin/PropertiesNamespaces.md              |   44 -
 site/ja/admin/Stats.md                             |   32 -
 site/ja/admin/ZooKeeperBookKeeper.md               |  178 --
 site/ja/advanced/PartitionedTopics.md              |  109 -
 site/ja/advanced/RetentionExpiry.md                |  307 ---
 site/ja/clients/Cpp.md                             |  180 --
 site/ja/clients/Java.md                            |  275 --
 site/ja/clients/Python.md                          |  121 -
 site/ja/clients/WebSocket.md                       |  312 ---
 site/ja/deployment/InstanceSetup.md                |  188 --
 site/ja/deployment/Kubernetes.md                   |  296 ---
 site/ja/deployment/Monitoring.md                   |  104 -
 site/ja/getting-started/Clients.md                 |   55 -
 site/ja/getting-started/ConceptsAndArchitecture.md |  307 ---
 site/ja/getting-started/LocalCluster.md            |  117 -
 site/ja/project/BinaryProtocol.md                  |  480 ----
 site/ja/project/Codebase.md                        |   29 -
 site/ja/project/SimulationTools.md                 |   95 -
 site/ja/reference/CliTools.md                      |   62 -
 site/ja/reference/Configuration.md                 |   96 -
 site/ja/reference/RestApi.md                       |   29 -
 site/javadoc/admin.html                            |   25 -
 site/javadoc/client.html                           |   25 -
 site/javadoc/pulsar-functions.html                 |   26 -
 site/js/jquery.scrollTo.min.js                     |    7 -
 site/js/jquery.tocify.min.js                       |    4 -
 site/js/main.js                                    |   99 -
 site/release-notes.md                              |  437 ----
 site/resources.md                                  |   33 -
 site/scripts/build-all-versions.sh                 |   25 -
 site/scripts/docker-build.sh                       |   43 -
 site/scripts/htmltest-setup.sh                     |   26 -
 site/scripts/protobuf-doc-gen.sh                   |   28 -
 site/scripts/swagger-definition-gen.sh             |   27 -
 site/team.md                                       |   66 -
 399 files changed, 3 insertions(+), 42793 deletions(-)

commit 45bb182131d257f19ef74011f4dd6c1c8e35152f
Author: Sijie Guo <sijie@apache.org>
Date:   Thu Nov 7 18:47:24 2019 +0800

    Fix license file in the distribution package (#5578)

 distribution/server/src/assemble/LICENSE.bin.txt |  7 ++---
 pulsar-sql/presto-distribution/LICENSE           | 33 ++++++++++++------------
 2 files changed, 20 insertions(+), 20 deletions(-)

commit cd259a443625dfa0710e79a87de65fd11b85d5bc
Author: Sijie Guo <sijie@apache.org>
Date:   Thu Nov 7 18:47:17 2019 +0800

    Fix schema static initialization sequence (#5577)
    
    *Motivation*
    
    Java doesn't guarantee the initialization order of the static fields of a class.
    It depends on the JVM version and race conditions.

 .../pulsar/client/impl/schema/BooleanSchema.java   |  8 +++----
 .../pulsar/client/impl/schema/ByteBufSchema.java   |  8 +++----
 .../client/impl/schema/ByteBufferSchema.java       |  8 +++----
 .../pulsar/client/impl/schema/ByteSchema.java      |  8 +++----
 .../pulsar/client/impl/schema/BytesSchema.java     |  7 +++---
 .../pulsar/client/impl/schema/DateSchema.java      |  7 +++---
 .../pulsar/client/impl/schema/DoubleSchema.java    |  7 +++---
 .../pulsar/client/impl/schema/FloatSchema.java     |  8 +++----
 .../pulsar/client/impl/schema/IntSchema.java       |  8 +++----
 .../pulsar/client/impl/schema/LongSchema.java      |  8 +++----
 .../pulsar/client/impl/schema/ShortSchema.java     |  8 +++----
 .../pulsar/client/impl/schema/TimeSchema.java      |  7 +++---
 .../pulsar/client/impl/schema/TimestampSchema.java |  7 +++---
 .../client/impl/schema/PrimitiveSchemaTest.java    | 27 ++++++++++++++--------
 14 files changed, 68 insertions(+), 58 deletions(-)

commit 4d0983a8fe345f46592dc5cbd329d3cd11068b5a
Author: Brian Candler <b.candler@pobox.com>
Date:   Thu Nov 7 06:40:38 2019 +0000

    [Issue 5541] cpp and python API: consumer and reader seek (#5542)
    
    * Extending CPP/Python API to seek by timestamp
    
    Untested, waiting for CI.  Please do not merge yet!
    
    * Part 2: add seek(messageId) and seek(timestamp) to cpp/python Reader
    
    * More realistic seek test
    
    Seek to actual message ids and timestamps, not just first
    
    * python3 compatibility fix
    
    In python3, 10/2 is float and cannot be used for range()
    10//2 works in both python2.7 and python3
    
    * pulsar_test silly mistake

 pulsar-client-cpp/include/pulsar/Consumer.h      | 16 +++++++
 pulsar-client-cpp/include/pulsar/Reader.h        | 40 ++++++++++++++++++
 pulsar-client-cpp/lib/Commands.cc                | 10 +++++
 pulsar-client-cpp/lib/Commands.h                 |  1 +
 pulsar-client-cpp/lib/Consumer.cc                | 20 +++++++++
 pulsar-client-cpp/lib/ConsumerImpl.cc            | 32 ++++++++++++++
 pulsar-client-cpp/lib/ConsumerImpl.h             |  1 +
 pulsar-client-cpp/lib/ConsumerImplBase.h         |  1 +
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc |  4 ++
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h  |  1 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc |  4 ++
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h  |  1 +
 pulsar-client-cpp/lib/Reader.cc                  | 32 ++++++++++++++
 pulsar-client-cpp/lib/ReaderImpl.cc              |  7 +++
 pulsar-client-cpp/lib/ReaderImpl.h               |  3 ++
 pulsar-client-cpp/python/pulsar/__init__.py      | 18 +++++++-
 pulsar-client-cpp/python/pulsar_test.py          | 54 +++++++++++++++++++++++-
 pulsar-client-cpp/python/src/consumer.cc         | 10 +++++
 pulsar-client-cpp/python/src/reader.cc           | 20 +++++++++
 19 files changed, 272 insertions(+), 3 deletions(-)

commit 89d2d8d69b1f74e2cacf9cdd42e951a609e808fd
Author: Naveen Kumar <krnaveen14@users.noreply.github.com>
Date:   Thu Nov 7 09:04:48 2019 +0530

    [Issue 5561] Update Debezium version to 0.10.0.Final (#5573)

 pom.xml                                                            | 2 +-
 .../java/org/apache/pulsar/io/debezium/PulsarDatabaseHistory.java  | 5 +++--
 .../org/apache/pulsar/io/debezium/PulsarDatabaseHistoryTest.java   | 7 ++++---
 3 files changed, 8 insertions(+), 6 deletions(-)

commit 0053dbc6a52700c87f44067c9fa9006918877afe
Author: Like <ke.like@outlook.com>
Date:   Wed Nov 6 20:33:28 2019 +0800

    Use StandardCharsets.UTF_8 for converting String to bytes (#5372)
    
    Use StandardCharsets.UTF_8 for converting String to bytes to avoid potential encoding error.

 .../streaming/receiver/example/ProducerSparkReceiverData.java      | 5 +++--
 .../receiver/example/SparkStreamingPulsarReceiverExample.java      | 4 ++--
 .../src/main/java/org/apache/pulsar/utils/CmdUtility.java          | 3 ++-
 .../java/org/apache/pulsar/utils/SimpleTextOutputStreamTest.java   | 4 ++--
 .../test/java/org/apache/pulsar/utils/StatsOutputStreamTest.java   | 4 ++--
 .../pulsar/client/kafka/test/KafkaProducerSimpleConsumerTest.java  | 3 ++-
 .../test/java/org/apache/pulsar/admin/cli/utils/IOUtilsTest.java   | 3 ++-
 .../src/main/java/org/apache/pulsar/io/kinesis/KinesisRecord.java  | 4 ++--
 .../src/main/java/org/apache/pulsar/io/mongodb/MongoSink.java      | 6 +++---
 .../src/main/java/org/apache/pulsar/io/mongodb/MongoSource.java    | 6 +++---
 .../org/apache/pulsar/zookeeper/ZookeeperClientFactoryImpl.java    | 3 ++-
 .../test/java/org/apache/pulsar/zookeeper/DeserializersTest.java   | 7 ++++---
 12 files changed, 29 insertions(+), 23 deletions(-)

commit e0ea6b53a2f6f655563df87afad4540c53e6bb0c
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Wed Nov 6 00:45:57 2019 -0800

    Validate topic name before creating partition/non partition topic via admin cli. (#5148)
    
    fix #4994
    For non partition topic,
    
    Topic name contains partition suffix "-partition-" and the remaining part follow the partition
    suffix is numeric value larger than the number of partition if there's already a partition topic with same
    name(the part before suffix "-partition-").
    2)Topic name contains partition suffix "-partition-" and the remaining part follow the partition
    suffix is numeric value but there isn't a partitioned topic with same name.
    For partition topic,
    Validation will fail and throw RestException if
    
    There's already a partitioned topic with same topic name and have some of its partition created.
    There's already non partition topic with same name and contains partition suffix "-partition-"
    followed by numeric value. In this case internal created partition of partitioned topic could override
    the existing non partition topic.
    This is for non partition topic created before we enforce the check as we will prevent creation of non partition topic with such name which could lost of confusion.
    For update partition topic,
    Validation will fail if there's already non partition topic with same name and contains partition suffix "-partition-" followed by numeric value X then the new number of partition of that partitioned topic can not be greater than that X else that non partition topic will essentially be overwritten and cause unexpected consequence.
    
    Also removed TopicsConsumerImplTest#testTopicAutoUpdatePartitions in flavor of PartitionedProducerConsumerTest#testAutoUpdatePartitionsForProducerConsumer, as they're both testing auto partition update to consumer/producer. But TopicsConsumerImplTest#testTopicAutoUpdatePartitions was trying to manually create non partitioned topic with name like "xyz-topic-partition-5" by creating new producer of that topic, while 5 is larger than a existing partitioned topic xyz-topic's actual number of partition. Which make the validation fails and shouldn't be encouraged.

 .../broker/admin/impl/PersistentTopicsBase.java    | 128 ++++++++++++++++++++-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   4 +-
 .../pulsar/broker/admin/PersistentTopicsTest.java  |  58 +++++++++-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |   6 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  52 ++++-----
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |   4 +-
 site2/docs/admin-api-non-partitioned-topics.md     |   6 +
 site2/docs/admin-api-partitioned-topics.md         |   8 ++
 8 files changed, 226 insertions(+), 40 deletions(-)

commit 5c771d20d9a4ef171d51aa7c5da9e646c8f11ac5
Author:  <ranxiaolong716@gmail.com>
Date:   Wed Nov 6 16:27:22 2019 +0800

    Fix protobuf schema of java function  error (#5569)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../src/main/java/org/apache/pulsar/functions/source/TopicSchema.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 99cfe3ecc831a4b6914a423fd903c995b65c0f53
Author: Like <ke.like@outlook.com>
Date:   Wed Nov 6 14:07:04 2019 +0800

    Fix log message bug (#5421)

 .../broker/service/AbstractDispatcherSingleActiveConsumer.java      | 2 +-
 .../main/java/org/apache/pulsar/broker/service/BrokerService.java   | 2 +-
 .../src/main/java/org/apache/pulsar/broker/service/Consumer.java    | 6 +++---
 .../service/persistent/PersistentDispatcherMultipleConsumers.java   | 2 +-
 .../apache/pulsar/broker/service/persistent/PersistentTopic.java    | 2 +-
 .../pulsar/broker/service/persistent/SubscribeRateLimiter.java      | 4 ++--
 .../apache/pulsar/broker/service/schema/SchemaRegistryService.java  | 2 +-
 7 files changed, 10 insertions(+), 10 deletions(-)

commit c70e1438f5641f8bde568e6b1b04791bfd3d1ba7
Author: Like <ke.like@outlook.com>
Date:   Wed Nov 6 14:06:41 2019 +0800

    Remove outdated method doc (#5422)

 .../org/apache/pulsar/broker/service/AbstractBaseDispatcher.java   | 2 --
 .../org/apache/pulsar/broker/service/PulsarChannelInitializer.java | 6 ++++--
 .../org/apache/pulsar/broker/stats/metrics/AbstractMetrics.java    | 7 +++----
 3 files changed, 7 insertions(+), 8 deletions(-)

commit 86ccfe877e483cce8c8481f5933dfb906f92ab42
Author: tuteng <eguangning@gmail.com>
Date:   Wed Nov 6 14:05:17 2019 +0800

    Add handle exception KeeperException.BadVersionException (#5563)
    
    Fixes https://github.com/apache/pulsar/issues/4790
    
    
    Master Issue: https://github.com/apache/pulsar/issues/4790
    
    ### Motivation
    Currently, when the brokerDeleteInactiveTopicsEnabled policy is enabled, the topic pulsar/standalone/127.0.0.1:8080/healthcheck will be deleted periodically, when creating producer and consumer for the second time https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/BrokersBase.java#L272, because both producer and consumer call putSchema in a short period of time, resulting in race conditions, Throwing exceptions of schema badVersion, only one of them could succeed. therefore, when badVersion exception occurs, call putSchema should be performed again.
    ### Modifications
    
    * Add operation to handle exception KeeperException.BadVersionException
    
    ### Verifying this change
    
    ```
    ./bin/pulsar standalone -nss -a 127.0.0.1
    curl -v http://127.0.0.1:8080/admin/v2/brokers/health
    
    # Waiting for more than 60 seconds, waiting for the topic pulsar/standalone/127.0.0.1:8080/healthcheck to be deleted
    
    curl -v http://127.0.0.1:8080/admin/v2/brokers/health
    ```

 .../apache/pulsar/broker/service/schema/BookkeeperSchemaStorage.java   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e0b36f9cc95aebb7767d4864e46026dfb7e89e08
Author: lipenghui <penghui@apache.org>
Date:   Wed Nov 6 11:41:39 2019 +0800

    [Transaction coordinator]Add transaction metadata store service (#5504)

 conf/broker.conf                                   |   3 +-
 conf/standalone.conf                               |   5 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |   7 ++
 pulsar-broker/pom.xml                              |  11 ++
 .../java/org/apache/pulsar/PulsarStandalone.java   |   3 +
 .../org/apache/pulsar/broker/PulsarService.java    |  15 +++
 .../broker/TransactionMetadataStoreService.java    | 119 +++++++++++++++++++++
 .../TransactionMetadataStoreServiceTest.java       | 115 ++++++++++++++++++++
 pulsar-transaction/coordinator/pom.xml             |   6 ++
 .../coordinator/TransactionCoordinatorID.java      |   4 +
 .../coordinator/TransactionMetadataStore.java      |   5 +
 .../TransactionMetadataStoreProvider.java          |   5 +-
 .../exceptions/CoordinatorException.java           |  24 +++++
 .../impl/InMemTransactionMetadataStore.java        |   6 ++
 .../InMemTransactionMetadataStoreProvider.java     |   7 +-
 .../TransactionMetadataStoreProviderTest.java      |   2 +-
 16 files changed, 330 insertions(+), 7 deletions(-)

commit bafde2c0611ee856ee5d166adc306195a0cc105f
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Nov 5 09:16:34 2019 -0800

    Fix Test Assertion retry (#5544)

 pom.xml                                            |   3 +-
 tests/integration/pom.xml                          |   7 +
 .../integration/functions/PulsarFunctionsTest.java | 305 +++++++++++----------
 .../functions/PulsarFunctionsTestBase.java         |  10 +-
 .../tests/integration/utils/DockerUtils.java       |  65 ++---
 5 files changed, 208 insertions(+), 182 deletions(-)

commit 1a63b08f40cb55c6bfe433f314da347ea807db7b
Author: Brian Candler <b.candler@pobox.com>
Date:   Tue Nov 5 10:22:55 2019 +0000

    [Issue 5518][docs] Update docs mainly for Python API (#5536)
    
    * Documentation updates, mainly for Python API
    
    * Corrections from @Jennifer88huang
    
    * Remove links to functions-api
    
    * Update functions-develop.md

 site2/docs/functions-api.md       | 731 --------------------------------------
 site2/docs/functions-debug.md     |   7 +
 site2/docs/functions-deploying.md |   2 +-
 site2/docs/functions-develop.md   | 199 +++++++++++
 site2/docs/functions-metrics.md   |   6 +-
 site2/docs/functions-overview.md  |  16 +-
 site2/docs/functions-state.md     | 117 ------
 7 files changed, 224 insertions(+), 854 deletions(-)

commit c4ffada1f9f171be06f3e41abee52de21759ade0
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue Nov 5 16:27:20 2019 +0800

    [Issue 5425][docs-website] Add coding guide for Apache Pulsar contributing guide (#5494)
    
    * Add coding guide for Apache Pulsar
    
    * update contributing guide
    
    * update coding guide
    
    * Update coding-guide.md
    
    * Update coding-guide.md

 site2/website/coding-guide.md | 79 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 79 insertions(+)

commit 80e4b5f662acf92d743b24d795a84a7ba4005400
Author:  <ranxiaolong716@gmail.com>
Date:   Tue Nov 5 13:11:33 2019 +0800

    Fix docs about reset cursor (#5551)
    
    * Fix docs about reset cursor
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../src/main/java/org/apache/pulsar/admin/cli/CmdTopics.java        | 2 +-
 site2/docs/reference-pulsar-admin.md                                | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)

commit 669b91635baa4be2a167651b4df5da204a85e871
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Tue Nov 5 11:07:07 2019 +0800

    expose new message with different schema (#5517)
    
    Master Issue: #5141
    
    Expose new message with different schema interface, which not required same parameterized type with the producer.
    Since the producer and messages sent by it may have different inner types, it's better to have a type agnostic producer interceptor with a checkin method.

 .../apache/pulsar/client/api/InterceptorsTest.java |  90 ++++++++++---------
 .../apache/pulsar/client/api/SimpleSchemaTest.java |  71 ++++++++++-----
 .../org/apache/pulsar/client/api/Producer.java     |  11 ++-
 .../apache/pulsar/client/api/ProducerBuilder.java  |  12 +++
 .../pulsar/client/api/ProducerInterceptor.java     |   1 +
 .../api/interceptor/ProducerInterceptor.java       | 100 +++++++++++++++++++++
 .../interceptor/ProducerInterceptorWrapper.java    |  56 ++++++++++++
 .../client/api/interceptor/package-info.java       |  22 +++++
 .../clients/producer/PulsarKafkaProducerTest.java  |  12 ++-
 .../KafkaProducerInterceptorWrapperTest.java       |  10 ++-
 .../client/impl/PartitionedProducerImpl.java       |   4 +-
 .../apache/pulsar/client/impl/ProducerBase.java    |  19 ++--
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  21 ++++-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  20 ++---
 .../pulsar/client/impl/ProducerInterceptors.java   |  34 ++++---
 .../pulsar/client/impl/PulsarClientImpl.java       |   4 +-
 .../client/impl/TypedMessageBuilderImpl.java       |   8 +-
 17 files changed, 379 insertions(+), 116 deletions(-)

commit 73861307ba09f51a5e8506ff82e80dd33982f3e3
Author: Brian Candler <b.candler@pobox.com>
Date:   Tue Nov 5 03:06:41 2019 +0000

    cpp/python: increase number of digits in temporary subscription name for readers (#5547)
    
    Fixes #5546
    
    ### Motivation
    
    Reduce risk of subscription name clash between readers.  Equivalence with Java client.
    
    ### Modifications
    
    Increase number of random hex digits in reader subscription name from 6 to 10.

 pulsar-client-cpp/lib/ClientImpl.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7d80ae8d8b09b4ec363cdb2b712a74dff270963d
Author: Brian Candler <b.candler@pobox.com>
Date:   Tue Nov 5 03:06:15 2019 +0000

    Document that reader is implemented as a consumer (#5556)
    
    ### Motivation
    
    I would have found it helpful to know earlier that a reader is implemented in terms of a consumer.

 site2/docs/concepts-clients.md | 2 ++
 1 file changed, 2 insertions(+)

commit f6701f1141b5ea138085b60c990564ed30c03f7f
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Mon Nov 4 23:12:38 2019 +0800

    [PIP-44] Separate schema compatibility checker for producer and consumer (#5227)
    
    * Change import org.apache.pulsar.common.policies.data.SchemaCompatibilityStrategy;
    
    * Schema compatibility check change
    
    * Add the test
    
    * modify the cmdNamespaces
    
    * Modify the variable name
    
    * Delete the configuration
    
    * Modify the variable name
    
    * modify the method
    
    * Fix some tests
    
    * add the integration test
    
    * Modify the test
    
    * modity the Timeout time
    
    * Modify the test's sequence
    
    * modify the exception message
    
    * Add the test
    
    * modify the httpLookupService
    
    * Add the license
    
    * add the method
    
    * Modify decode message throw exception
    
    * Add the import class
    
    * fix some comment
    
    * Modify the implments method
    
    * add the judgement for consumer schema compatibility check
    
    * add the import

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  37 +++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  55 +++
 .../pulsar/broker/admin/v2/SchemasResource.java    |  71 ++--
 .../pulsar/broker/service/AbstractTopic.java       |  27 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  20 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   4 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  20 +-
 .../broker/service/persistent/PersistentTopic.java |  36 +-
 .../schema/AvroSchemaBasedCompatibilityCheck.java  |   3 +
 .../service/schema/BookkeeperSchemaStorage.java    |  91 +----
 .../schema/DefaultSchemaRegistryService.java       |  11 +-
 .../schema/JsonSchemaCompatibilityCheck.java       |   1 +
 .../schema/KeyValueSchemaCompatibilityCheck.java   |   1 +
 .../service/schema/SchemaCompatibilityCheck.java   |   3 +-
 .../broker/service/schema/SchemaRegistry.java      |   5 +
 .../service/schema/SchemaRegistryServiceImpl.java  | 132 +++++---
 .../broker/service/schema/SchemaStorage.java       |   2 +-
 ...hemaRegistryServiceWithSchemaDataValidator.java |   7 +-
 .../broker/admin/AdminApiSchemaAutoUpdateTest.java |   2 +-
 .../schema/BaseAvroSchemaCompatibilityTest.java    |   1 +
 .../schema/JsonSchemaCompatibilityCheckTest.java   |   1 +
 .../KeyValueSchemaCompatibilityCheckTest.java      |   1 +
 .../broker/service/schema/SchemaServiceTest.java   |   2 +-
 ...RegistryServiceWithSchemaDataValidatorTest.java |   2 +-
 .../api/SimpleTypedProducerConsumerTest.java       |   5 +-
 .../SchemaCompatibilityCheckTest.java              | 370 +++++++++++++++++++++
 .../pulsar/schema/compatibility/Schemas.java       |  84 +++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  69 +++-
 .../client/admin/internal/NamespacesImpl.java      |  47 +++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  78 +++++
 .../pulsar/client/impl/HttpLookupService.java      |   5 +-
 .../pulsar/client/impl/schema/StructSchema.java    |   7 +-
 .../client/impl/schema/reader/AvroReader.java      |   2 +-
 .../pulsar/common/policies/data/Policies.java      |  19 +-
 .../data}/SchemaCompatibilityStrategy.java         |  25 +-
 .../tests/integration/schema/SchemaTest.java       |  21 +-
 .../pulsar/tests/integration/schema/Schemas.java   |  51 +++
 .../src/test/resources/pulsar-schema-suite.xml     |  28 ++
 .../src/test/resources/pulsar-schema.xml           |  28 ++
 tests/integration/src/test/resources/pulsar.xml    |   1 +
 40 files changed, 1112 insertions(+), 263 deletions(-)

commit 7f513e5fdc265e38d384eacc1999700a64a11157
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Mon Nov 4 23:11:18 2019 +0800

    [Doc] Add work flow of checking broken links (#5529)

 site2/README.md | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)

commit cbad217b9860976f9748f760d34d6cfa5580e092
Author: Keven Li <liyi.changde@gmail.com>
Date:   Mon Nov 4 23:06:18 2019 +0800

    add missed placeholder for log, delete redundant 'return' clause (#5550)
    
    ### Motivation
    
    - Adjust code style
    
    ### Modifications
    
    - Add the missing placeholder in log statement
    - Delete redundant `return clause` for void method

 .../java/org/apache/pulsar/functions/instance/JavaInstanceRunnable.java | 1 -
 .../main/java/org/apache/pulsar/functions/worker/FunctionActioner.java  | 2 --
 .../java/org/apache/pulsar/functions/worker/FunctionRuntimeManager.java | 2 +-
 3 files changed, 1 insertion(+), 4 deletions(-)

commit ec0d4a5b2902ea581693b97a47439b37264f0524
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Mon Nov 4 17:31:39 2019 +0800

    Add pulsar-admin command and fix inconsistencies (#5528)

 site2/docs/concepts-architecture-overview.md             |  2 +-
 .../version-2.1.0-incubating/admin-api-permissions.md    |  2 +-
 .../concepts-architecture-overview.md                    |  2 +-
 .../version-2.4.1/reference-pulsar-admin.md              | 16 ++++++++++++++++
 4 files changed, 19 insertions(+), 3 deletions(-)

commit 39af4777b142fbd97b3ffd72fc63a9732d531d19
Author:  <ranxiaolong716@gmail.com>
Date:   Mon Nov 4 15:30:03 2019 +0800

    Add subscribe position param for consumer of sink (#5532)
    
    * Add subscribe position param for consumer of sink
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java   |  8 ++++++++
 .../src/main/java/org/apache/pulsar/common/io/SinkConfig.java |  2 ++
 .../pulsar/functions/instance/JavaInstanceRunnable.java       | 11 +++++++++++
 .../java/org/apache/pulsar/functions/source/PulsarSource.java |  2 ++
 .../apache/pulsar/functions/source/PulsarSourceConfig.java    |  2 ++
 .../org/apache/pulsar/functions/source/PulsarSourceTest.java  |  5 +++++
 pulsar-functions/proto/src/main/proto/Function.proto          |  6 ++++++
 .../org/apache/pulsar/functions/utils/SinkConfigUtils.java    |  7 +++++++
 8 files changed, 43 insertions(+)

commit 7275d53af463ed3526d93a88d27d278802425a4d
Author: Keven Li <liyi.changde@gmail.com>
Date:   Sun Nov 3 20:53:33 2019 +0800

    fix repeated initialization of connectorsManager (#5545)
    
    ### Motivation
    
    - The connectorsManager is initialized twice in WorkerService, it seems to be a misoperation when merging codes.
    
    ### Modifications
    
    - Delete the redundant codes.

 .../main/java/org/apache/pulsar/functions/worker/WorkerService.java    | 3 ---
 1 file changed, 3 deletions(-)

commit 9728d5429bfe359dfc3de4b277b9fbe108e0bd8e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Nov 1 20:12:24 2019 -0700

    Function runtime pluggable (#5463)
    
    * Allow Pulsar Function Runtimes to be pluggable
    
    * cleaning up

 conf/functions_worker.yml                          |  38 ++-
 .../worker/PulsarFunctionE2ESecurityTest.java      |   8 +-
 .../worker/PulsarFunctionLocalRunTest.java         |   7 +-
 .../worker/PulsarFunctionPublishTest.java          |  10 +-
 .../worker/PulsarWorkerAssignmentTest.java         |   7 +-
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |   7 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  11 +-
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |   7 +-
 .../org/apache/pulsar/functions/LocalRunner.java   |   4 +-
 .../functions/runtime/JavaInstanceStarter.java     |   1 +
 .../pulsar/functions/runtime/RuntimeFactory.java   |  13 +
 .../pulsar/functions/runtime/RuntimeUtils.java     |   7 +-
 .../{ => kubernetes}/KubernetesRuntime.java        |   4 +-
 .../{ => kubernetes}/KubernetesRuntimeFactory.java | 277 ++++++++++-----------
 .../kubernetes/KubernetesRuntimeFactoryConfig.java | 128 ++++++++++
 .../runtime/{ => process}/ProcessRuntime.java      |   4 +-
 .../{ => process}/ProcessRuntimeFactory.java       |  68 ++++-
 .../process/ProcessRuntimeFactoryConfig.java       |  46 ++++
 .../runtime/{ => thread}/ThreadRuntime.java        |   5 +-
 .../runtime/{ => thread}/ThreadRuntimeFactory.java |  80 +++---
 .../runtime/thread/ThreadRuntimeFactoryConfig.java |  34 +++
 .../pulsar/functions/worker/WorkerConfig.java      | 212 +++++-----------
 .../KubernetesRuntimeFactoryTest.java              | 109 ++++++--
 .../{ => kubernetes}/KubernetesRuntimeTest.java    |  62 ++---
 .../runtime/{ => process}/ProcessRuntimeTest.java  |  33 ++-
 .../apache/pulsar/functions/utils/Reflections.java |   2 +-
 .../pulsar/functions/utils/ReflectionsTest.java    |   2 +-
 .../functions/worker/FunctionRuntimeManager.java   |  80 ++----
 .../functions/worker/FunctionsStatsGenerator.java  |   2 +-
 .../functions/worker/FunctionActionerTest.java     |  21 +-
 .../worker/FunctionRuntimeManagerTest.java         | 216 +++++++++++++++-
 .../functions/worker/MembershipManagerTest.java    |  19 +-
 .../functions/worker/SchedulerManagerTest.java     |   9 +-
 33 files changed, 1029 insertions(+), 504 deletions(-)

commit f4d954d328388c661f44d4dfbc21b3b844f174d3
Author: lipenghui <penghui@apache.org>
Date:   Fri Nov 1 21:13:25 2019 +0800

    [Transaction Coordinator] Bootstrap pulsar system namespace and create TC assign topic. (#5515)
    
    ### Motivation
    
    Introduce pulsar system namespace and init transaction coordinator assign topic when init pulsar cluster.
    
    Broker will bootstrap the system namespace if broker enable transaction coordinator.
    
    ### Verifying this change
    
    Added new unit tests for system namespace Bootstrap

 bin/pulsar                                         |   3 +
 conf/broker.conf                                   |   5 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   9 ++
 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 111 ++++++++++++++++-----
 .../PulsarTransactionCoordinatorMetadataSetup.java | 100 +++++++++++++++++++
 .../org/apache/pulsar/broker/PulsarService.java    |   5 +
 .../pulsar/broker/namespace/NamespaceService.java  |   2 +-
 .../apache/pulsar/broker/SLAMonitoringTest.java    |   2 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   4 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |   4 +-
 .../TransactionCoordinatorAssignTest.java          |  82 +++++++++++++++
 .../apache/pulsar/common/naming/NamespaceName.java |   2 +
 .../org/apache/pulsar/common/naming/TopicName.java |   3 +
 13 files changed, 303 insertions(+), 29 deletions(-)

commit 89a9aaab3c43d13f940195e1de49c9612a72ca00
Author: Addison Higham <addisonj@gmail.com>
Date:   Fri Nov 1 07:10:58 2019 -0600

    [zookeeper] bump zookeeper to version 3.5.6 (#5043)
    
    With zookeeper 3.5.5 now marked as stable and 3.5 being reccomend for
    the production branch (see https://zookeeper.apache.org/releases.html),
    this moves pulsar up to 3.5.6.
    
    Pulsar previously had 3.5.x support but was downgraded due to concerns
    of 3.5 still being a "beta", so this is a fairly simple change
    
    Fixes #4448
    
    As a follow on to this work, we should introduce new configuration options to support TLS connections to ZK, however, that is out of scope for this initial dependency bump.

 .../org/apache/bookkeeper/test/PortManager.java    |   7 --
 pom.xml                                            |   2 +-
 pulsar-io/flume/pom.xml                            |   4 +-
 ...TestAbstractZooKeeperConfigurationProvider.java |   5 +-
 .../org/apache/pulsar/metadata/TestZKServer.java   |   6 +-
 pulsar-sql/presto-distribution/LICENSE             |   2 +-
 .../pulsar/zookeeper/SerializeUtilsAspect.java     | 130 ---------------------
 .../src/main/resources/META-INF/aop.xml            |   2 -
 .../pulsar/zookeeper/ZookeeperServerTest.java      |   2 +
 9 files changed, 15 insertions(+), 145 deletions(-)

commit dd58baf840339df89c7d5e48c22ed415b2860364
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Oct 31 22:06:47 2019 -0700

    fix: Functions unnecessarily restart during FunctionRuntimeManager init phase (#5527)
    
    * fix: Functions unnecessarily restart during FunctionRuntimeManager init phase

 .../functions/worker/FunctionRuntimeManager.java   | 61 +++++++++++++-----
 .../worker/FunctionRuntimeManagerTest.java         | 74 ++++++++++------------
 2 files changed, 80 insertions(+), 55 deletions(-)

commit 79f47106e56c34676497e91520d0d8446936abf7
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Fri Nov 1 10:10:06 2019 +0800

    Fix list non-persistent topics shows the persistent topics (#5502)
    
    * Fix list non-persistent topics shows the persistent topics
    ---
    
    Fixes #5414
    
    *Motivation*
    
    When using the REST API to request to list all the non-persistent
    topics, it will show the persistent topics.
    
    *Modifications*
    
    - Add a filter when before sending the response

 .../pulsar/broker/admin/v2/NonPersistentTopics.java     |  8 +++++++-
 .../apache/pulsar/tests/integration/cli/CLITest.java    | 17 +++++++++++++++++
 2 files changed, 24 insertions(+), 1 deletion(-)

commit a4c330e0875f9512c19c9b37a1c8ec980b5ea037
Author: Brian Candler <b.candler@pobox.com>
Date:   Thu Oct 31 23:12:55 2019 +0000

    Python API: add get_input_topics() (#5526)
    
    Fixes #5525

 pulsar-client-cpp/python/pulsar/functions/context.py     | 5 +++++
 pulsar-functions/instance/src/main/python/contextimpl.py | 3 +++
 site2/docs/functions-api.md                              | 1 +
 site2/docs/functions-develop.md                          | 2 ++
 4 files changed, 11 insertions(+)

commit 3d5bc0a020355b91de36059e7956cd7f98d09113
Author: Like <ke.like@outlook.com>
Date:   Fri Nov 1 04:09:51 2019 +0800

    [Test] Migrate deprecated Matchers to ArgumentMatchers (#5423)
    
    * Migrate deprecated Matchers to ArgumentMatchers
    
    * Add ServerCnxTest
    
    * add PulsarKafkaProducerTest

 .../pulsar/broker/service/ServerCnxTest.java       |  2 +-
 .../buffer/PersistentTransactionBufferTest.java    | 27 +++++++++++-----------
 .../clients/producer/PulsarKafkaProducerTest.java  |  9 ++++----
 3 files changed, 18 insertions(+), 20 deletions(-)

commit f01ff8a8394d755ab1a24d66ab6e235f8f631f06
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Nov 1 04:09:25 2019 +0800

    [Issue 5475][docs] Update message deduplication (#5512)
    
    * update message deduplication
    
    * update

 site2/docs/cookbooks-deduplication.md | 63 +++++++++++++++++------------------
 1 file changed, 31 insertions(+), 32 deletions(-)

commit bcce54d09ee84e974c694963d37a1ac4606dc333
Author: Brian Candler <b.candler@pobox.com>
Date:   Thu Oct 31 19:56:25 2019 +0000

    Doc: add missing functions from Python context object (#5524)

 site2/docs/functions-api.md     | 10 +++++++
 site2/docs/functions-develop.md | 66 +++++++++++++++++++++++++++++++++++++++++
 2 files changed, 76 insertions(+)

commit d9ebec52482d7ca5e273f762b3828fb18f988f2c
Author: Brian Candler <b.candler@pobox.com>
Date:   Thu Oct 31 07:17:09 2019 +0000

    Python API: Add test case for create_reader(is_read_compacted) (#5488)
    
    * Add test case for PR #5483 / issue #5365
    
    * Python: apply timeout_millis to receive() and read_next() in tests

 pulsar-client-cpp/python/pulsar_test.py | 69 ++++++++++++++++++++-------------
 1 file changed, 42 insertions(+), 27 deletions(-)

commit 0076a1bc2d8c3e0fbdd1d210cea17efcf086c034
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 30 23:38:27 2019 -0700

    Upgrade dependencies for security fixes (#5232)
    
    * Upgrade dependencies for security fixes
    
    * Use guava 18 for jclouds-shaded
    
    * Fix the guava version for HDFS tiered storage component
    
    * Rollback guava to 25.1 since there are API breaking changes
    
    * Rollback to Maven 3.0.5 which has the fix for sec issue
    
    * Fixed Jetty SslContextFactory creation
    
    * Roll back to 9.4.20.v20190813

 distribution/server/src/assemble/LICENSE.bin.txt   | 49 ++++++++++-----------
 jclouds-shaded/pom.xml                             | 11 +++++
 pom.xml                                            |  9 ++--
 .../functions/runtime/KubernetesRuntime.java       |  5 ++-
 .../pulsar/functions/runtime/ProcessRuntime.java   | 11 ++---
 .../pulsar/io/cassandra/CassandraAbstractSink.java |  3 +-
 .../pulsar/proxy/server/AdminProxyHandler.java     |  3 +-
 pulsar-sql/presto-distribution/LICENSE             | 49 +++++++++++----------
 pulsar-sql/presto-distribution/pom.xml             | 50 +++++++++++++++++++++-
 pulsar-sql/presto-pulsar-plugin/pom.xml            |  1 -
 tiered-storage/file-system/pom.xml                 | 11 +++++
 11 files changed, 138 insertions(+), 64 deletions(-)

commit a9b893fa82dd7b0bff26e85216dc62573fe7a37a
Author: tuteng <eguangning@gmail.com>
Date:   Thu Oct 31 13:28:39 2019 +0800

    [Doc]Add md suffix for fix cdc link (#5511)
    
    * Fix md file
    
    * Delete # prefix for http link

 site2/website/versioned_docs/version-2.3.0/io-cdc.md        | 4 ++--
 site2/website/versioned_docs/version-2.4.0/io-quickstart.md | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 7abe690aeec9b878149c575264970dacb745fa03
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 30 21:58:58 2019 -0700

    [cpp-build] Do not install libsnappy at each build (#5458)
    
    * [cpp-build] Do not install libsnappy at each build
    
    * Fixed usage of deleted script

 pulsar-client-cpp/docker-build.sh     |  2 +-
 pulsar-client-cpp/docker-lib-check.sh | 23 -----------------------
 pulsar-client-cpp/docker-tests.sh     |  2 +-
 3 files changed, 2 insertions(+), 25 deletions(-)

commit 7b5693fed89a804c13120416fea16522ee7ada6d
Author: tuteng <eguangning@gmail.com>
Date:   Wed Oct 30 22:39:38 2019 +0800

    Fix broke link (#5501)

 site2/docs/admin-api-schemas.md                    |  98 +++
 site2/docs/concepts-schema-registry.md             |  81 +++
 site2/docs/functions-api.md                        | 720 +++++++++++++++++++++
 site2/docs/functions-debugging.md                  | 126 ++++
 site2/docs/functions-deploying.md                  | 228 +++++++
 site2/docs/functions-guarantees.md                 |  41 ++
 site2/docs/functions-metrics.md                    |  43 ++
 site2/docs/functions-state.md                      | 117 ++++
 site2/docs/io-tcp.md                               |  19 +
 site2/docs/security-token-admin.md                 | 158 +++++
 site2/website/pages/en/download.js                 |  38 +-
 .../getting-started-standalone.md                  |   2 +-
 .../version-2.1.0-incubating/io-managing.md        |   2 +-
 .../getting-started-standalone.md                  |   2 +-
 .../version-2.1.1-incubating/io-managing.md        |   2 +-
 .../version-2.2.0/getting-started-standalone.md    |   2 +-
 .../versioned_docs/version-2.2.0/io-managing.md    |   2 +-
 .../version-2.2.1/getting-started-standalone.md    |   2 +-
 .../versioned_docs/version-2.4.0/io-managing.md    |   2 +-
 19 files changed, 1660 insertions(+), 25 deletions(-)

commit fd8832a82c1af6bc2b39e95b7bbd09ad44fca5ef
Author: tuteng <eguangning@gmail.com>
Date:   Wed Oct 30 19:39:27 2019 +0800

    [Doc]Fix document link error (#5496)

 site2/docs/reference-connector-admin.md                     | 1 +
 site2/website/sidebars.json                                 | 1 +
 site2/website/versioned_docs/version-2.4.0/io-quickstart.md | 8 ++++----
 3 files changed, 6 insertions(+), 4 deletions(-)

commit b11211f43235d70dad0cab0d934f33dd5d9ff198
Author: lipenghui <penghui@apache.org>
Date:   Wed Oct 30 17:02:00 2019 +0800

    Trim messages which less than mark delete position for message redelivery (#5378)
    
    * Trim messages which less than mark delete position for message redelivery.

 .../service/persistent/PersistentSubscription.java | 13 ++++---
 .../pulsar/client/impl/MessageRedeliveryTest.java  | 41 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 4 deletions(-)

commit 96f14d287971cdbbba5e5b4e60508177da603d54
Author: Keven Li <liyi.changde@gmail.com>
Date:   Wed Oct 30 14:30:10 2019 +0800

    fix misspelling and adjust code style (#5497)
    
    Signed-off-by: KevenYLi <liyi.changde@gmail.com>

 .../apache/pulsar/broker/loadbalance/LoadManager.java    |  2 +-
 .../broker/loadbalance/impl/LoadManagerShared.java       | 16 +++++++---------
 .../broker/loadbalance/impl/ModularLoadManagerImpl.java  | 13 +++++--------
 .../pulsar/broker/loadbalance/impl/OverloadShedder.java  |  1 +
 4 files changed, 14 insertions(+), 18 deletions(-)

commit 01ca24b34f5b5ba68c5d216e8fec8f9d96cf0dda
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 29 22:54:20 2019 -0700

    Fixed dispatcher skipping delivery of a batch during concurrent replays (#5499)
    
    There is a race condition when replaying messages on the `PersistentDispatcherMultipleConsumers`. This is apparently only happening in the context of delivering messages after a scheduled delay.
    
    The `Dispatcher.readMoreEntries()` can get invoked in multiple occasions:
     * Piggybacking on the completion of the previous read operation
     * When the delaye tracker gets triggered
    
    If there is already a replay read operation pending, we're currently ignoring the message ids returned by the delay tracker. These messages will not be retried on any other occasion, leading to backlog building up (until a consumer disconnects/reconnects).

 .../PersistentDispatcherMultipleConsumers.java     | 13 ++---
 .../service/persistent/DelayedDeliveryTest.java    | 63 ++++++++++++++++++++++
 2 files changed, 70 insertions(+), 6 deletions(-)

commit 43bc7904ba471ba6228b2108478ea317f0ba6400
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Oct 30 06:53:34 2019 +0100

    [TIEREDSTORAGE] Only seek when reading unexpected entry (#5356)
    
    * [TIEREDSTORAGE] Only seek when reading unexpected entry
    
    The normal pattern from reading from an offloaded ledger is that the
    reader will read the ledger sequentially from start to end. This means
    that once a user reads an entry, we should expect that the next entry
    they read will be the next entry in the ledger.
    
    The initial implementation of the BlobStoreBackedReadHandleImpl (and
    the S3 variant that preceeded it) didn't take this into
    account. Instead it did a lookup in the index each time, to find the
    block that contained the entry, and then read forward in the block
    until it found the entry requested. This is fine for the first few
    entries in the block, not so much for the last.
    
    This PR changes the read behaviour to only seek if entryId read
    from the block is either:
    - greater than the entry we were expecting to read, in which case we
      need to seek backwards in the block.
    - less than the entry expected, but also belonging to a different
      block to the expected entry, in which case we need to seek to the
      correct block.
    
    This change improves read performance significantly. Adhoc benchmarks
    shows that we can read from offloaded topics at ~160MB/s whereas
    previously we could only manage <10MB/s.
    
    * Revert it back to debug

 .../jcloud/impl/BlobStoreBackedInputStreamImpl.java       |  2 +-
 .../jcloud/impl/BlobStoreBackedReadHandleImpl.java        | 15 ++++++++++-----
 .../mledger/offload/jcloud/impl/DataBlockHeaderImpl.java  |  6 ++++++
 .../offload/jcloud/impl/OffloadIndexEntryImpl.java        |  6 ++++++
 4 files changed, 23 insertions(+), 6 deletions(-)

commit ebaf97cc47ea3cc3723b9243847c7888af719fdb
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 29 22:53:00 2019 -0700

    [pulsar-broker] fix broken custom auth-provider that uses authenticationData (#5462)
    
    Fix broken custom auth-provider that uses authenticationData

 .../src/main/java/org/apache/pulsar/broker/service/ServerCnx.java        | 1 +
 1 file changed, 1 insertion(+)

commit 734e7484a23eedd0794b45d5f6d1f4464475d88a
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 29 22:07:24 2019 -0700

    Return after triggering callback with empty result (#5500)
    
    ### Motivation
    
    While this doesn't appear to affect the correctness, we should just return empty after we trigger the callback.

 .../main/java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java  | 1 +
 1 file changed, 1 insertion(+)

commit 467ffab15c862b240d805cf1b916777ba633392c
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 29 19:16:06 2019 -0700

    Efficiency improvements for delay delivery tracker (#5498)
    
    Efficiency improvements for delay delivery tracker

 .../delayed/InMemoryDelayedDeliveryTracker.java    | 12 ++++++----
 .../PersistentDispatcherMultipleConsumers.java     | 24 +++++++++----------
 .../delayed/InMemoryDeliveryTrackerTest.java       | 28 ++++++++++++++++++++++
 3 files changed, 48 insertions(+), 16 deletions(-)

commit 418362e11596b5ad83ec2cfd126ebadd7a87e992
Author: Raman Gupta <rocketraman@gmail.com>
Date:   Tue Oct 29 21:40:23 2019 -0400

    [Issue 5309][docs] Clarify wording around retention policies (#5482)
    
    * [Issue 5309][docs] Clarify wording around retention policies
    
    Fixes #5309
    
    Docs are confusing.
    
    Replaced retention wording to make distinction between acked and
    non-acked messages clearer.
    
    * [Issue 5309][docs] Remove TODO

 site2/docs/cookbooks-retention-expiry.md | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit de4bbe12e5f3ea4bd0378939e9a920a74c787597
Author: Chris Bartholomew <c_bartholomew@yahoo.com>
Date:   Tue Oct 29 21:07:28 2019 -0400

    Updating Docker command to work on Windows properly (#5419)

 site2/docs/getting-started-docker.md | 22 ++++++----------------
 1 file changed, 6 insertions(+), 16 deletions(-)

commit a2f5e30f501f87665a2983435b334caa5216f377
Author: cckellogg <cckellogg@gmail.com>
Date:   Tue Oct 29 18:06:12 2019 -0700

    Fix broken io connector links. (#5409)

 site2/docs/io-connectors.md             |  11 +-
 site2/docs/reference-connector-admin.md | 599 ++++++++++++++++++++++++++++++++
 2 files changed, 603 insertions(+), 7 deletions(-)

commit 1419483da24215c49b1d61006c1f56b494782f67
Author: cckellogg <cckellogg@gmail.com>
Date:   Tue Oct 29 11:57:22 2019 -0700

    Fix broker function token authentication link (#5410)

 site2/docs/functions-worker.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 2983175a64c8468c9979af95d02f3841e314a255
Author: Chris Bartholomew <c_bartholomew@yahoo.com>
Date:   Tue Oct 29 14:57:07 2019 -0400

    [Issue 5415][docker build]Updating docker build for pulsar-standalone to use main dashboard sou (#5420)
    
    * Updating docker build for puslar-standalone to use main dashboard source files; deleting duplicate files
    
    * Committed the wrong Dockerfile

 dashboard/django/collector.py                      |   2 +-
 docker/build.sh                                    |   3 +-
 docker/pulsar-standalone/Dockerfile                |  45 ++-
 docker/pulsar-standalone/conf/nginx-app.conf       |  37 ---
 docker/pulsar-standalone/conf/postgresql.conf      |  38 ---
 docker/pulsar-standalone/conf/supervisor-app.conf  |  34 --
 docker/pulsar-standalone/conf/uwsgi.ini            |  45 ---
 docker/pulsar-standalone/conf/uwsgi_params         |  16 -
 docker/pulsar-standalone/django/collector.py       | 345 ---------------------
 docker/pulsar-standalone/django/collector.sh       |  23 --
 .../pulsar-standalone/django/dashboard/__init__.py |  19 --
 .../pulsar-standalone/django/dashboard/settings.py | 181 -----------
 docker/pulsar-standalone/django/dashboard/urls.py  |  45 ---
 docker/pulsar-standalone/django/dashboard/wsgi.py  |  35 ---
 docker/pulsar-standalone/django/manage.py          |  41 ---
 docker/pulsar-standalone/django/stats/__init__.py  |  19 --
 docker/pulsar-standalone/django/stats/admin.py     |  34 --
 docker/pulsar-standalone/django/stats/apps.py      |  26 --
 .../django/stats/migrations/0001_initial.py        | 221 -------------
 .../django/stats/migrations/__init__.py            |  20 --
 docker/pulsar-standalone/django/stats/models.py    | 200 ------------
 .../django/stats/templates/stats/base.html         |  98 ------
 .../django/stats/templates/stats/broker.html       |  71 -----
 .../django/stats/templates/stats/brokers.html      |  90 ------
 .../django/stats/templates/stats/clusters.html     | 106 -------
 .../django/stats/templates/stats/home.html         |  74 -----
 .../django/stats/templates/stats/namespace.html    |  96 ------
 .../django/stats/templates/stats/property.html     |  72 -----
 .../django/stats/templates/stats/topic.html        | 197 ------------
 .../django/stats/templates/stats/topics.html       |  91 ------
 .../django/stats/templatetags/__init__.py          |  19 --
 .../django/stats/templatetags/stats_extras.py      |  64 ----
 .../django/stats/templatetags/table.py             |  91 ------
 docker/pulsar-standalone/django/stats/tests.py     |  22 --
 docker/pulsar-standalone/django/stats/urls.py      |  37 ---
 docker/pulsar-standalone/django/stats/views.py     | 283 -----------------
 36 files changed, 33 insertions(+), 2807 deletions(-)

commit 6df7cec62148c75ff9eb6f162985eeb33891a3a0
Author: Brian Candler <b.candler@pobox.com>
Date:   Tue Oct 29 15:01:35 2019 +0000

    Python API: fix reader_listener option (#5487)
    
    Fixes #5484

 pulsar-client-cpp/python/src/config.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 080d31e8f37bd12fc3ce83a33548accfd18b4421
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue Oct 29 21:46:17 2019 +0800

    Update getting-started-standalone.md (#5490)
    
    ### Motivation
    There is a link issue in getting-started-standalone.md in version 2.4.1.
    
    ### Modifications
    Fix the linked file name.

 .../website/versioned_docs/version-2.4.1/getting-started-standalone.md  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f538c522630eaa070cd042840165b9e1166f9dab
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue Oct 29 21:31:13 2019 +0800

    [docs] Update some links on Pulsar website (#5492)
    
    There are some link issues on Pulsar website, check and fix them.

 site2/docs/concepts-overview.md               | 2 +-
 site2/docs/deploy-bare-metal-multi-cluster.md | 2 +-
 site2/docs/functions-overview.md              | 2 +-
 site2/docs/getting-started-clients.md         | 2 +-
 site2/docs/getting-started-standalone.md      | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

commit 74ec9202117854bfd04ef44aa4111cf9a59ffc08
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Tue Oct 29 18:52:35 2019 +0800

    move general schema hash to common module (#5466)
    
    * move general schema hash to common module

 .../service/schema/SchemaRegistryServiceImpl.java  | 16 ++++-----
 .../apache/pulsar/client/impl/ProducerBase.java    |  2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  8 ++---
 .../pulsar/common/protocol}/schema/SchemaHash.java | 39 ++++++++++++++--------
 4 files changed, 36 insertions(+), 29 deletions(-)

commit 1a4b126b114249f14f4ca059a1fcfa6f05045738
Author: tuteng <eguangning@gmail.com>
Date:   Tue Oct 29 18:51:01 2019 +0800

    [Docs]Fix document of canal and debezium not found. (#5485)
    
    * Fix document of canal and debezium not found.
    
    * Fix link of postgresql, hdfs2, hdfs3
    
    * Update io-cdc-canal.md

 site2/docs/io-cdc-canal.md                         | 175 +++++++++++++++++++++
 site2/docs/io-cdc-debezium.md                      |   2 +-
 site2/docs/io-connectors.md                        |   6 +-
 .../website/versioned_docs/version-2.3.0/io-cdc.md |   4 +-
 4 files changed, 181 insertions(+), 6 deletions(-)

commit be5a7cf91319ce188ba5a2e27c47493ae8853efa
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 28 23:59:50 2019 -0700

    Set default ensemble size to 2 in service conf, to match broker.conf (#5359)
    
    * Set default ensemble size to 2 in service conf, to match broker.conf
    
    * Fixed test

 .../main/java/org/apache/pulsar/broker/ServiceConfiguration.java    | 6 +++---
 .../src/test/java/org/apache/pulsar/broker/admin/AdminApiTest.java  | 2 +-
 .../java/org/apache/pulsar/broker/admin/v1/V1_AdminApiTest.java     | 2 +-
 3 files changed, 5 insertions(+), 5 deletions(-)

commit 025f99a21f244623bf322e94921f11929b62750c
Author: lipenghui <penghui@apache.org>
Date:   Tue Oct 29 10:08:07 2019 +0800

    [transaction-coordinator] Ownership change listeners (#5457)
    
    ### Motivation
    
    This is the first part to implement transaction coordinator startup, this PR added ownership change listeners, using the ownership change listeners can get namespace bundle/topics is owned or unload by this broker.  transaction coordinator can add listeners to create  transaction coordinator instance, also some other component can use it to get the change event of ownership.
    
    ### Modifications
    
    Add namespace bundle ownership listener
    Add topic ownership listener

 .../NamespaceBundleOwnershipListener.java          |  41 +++++++
 .../pulsar/broker/namespace/NamespaceService.java  | 127 +++++++++++++++++++-
 .../pulsar/broker/namespace/OwnershipCache.java    |  14 ++-
 .../namespace/NamespaceOwnershipListenerTests.java | 129 +++++++++++++++++++++
 .../broker/namespace/OwnershipCacheTest.java       |  14 +--
 5 files changed, 313 insertions(+), 12 deletions(-)

commit df19f261def8e66de213bff310a8423ae133ef58
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 28 14:29:49 2019 -0700

    Allow to automatically assign TCP ports when starting a broker (#3555)
    
    * Allow to automatically assign TCP ports when starting a broker
    
    * Do not change the passed config, rather expose the effective port to PulsarService
    
    * Fixed accessor name
    
    * Also added same change for websocket and proxy
    
    * Removed mock line in test
    
    * Removed mistakenly duplicated bind line

 .../org/apache/pulsar/PulsarBrokerStarter.java     | 10 ---
 .../java/org/apache/pulsar/PulsarStandalone.java   | 10 ---
 .../org/apache/pulsar/broker/PulsarService.java    | 79 ++++++++++++++-------
 .../pulsar/broker/loadbalance/NoopLoadManager.java | 10 +--
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 37 +++++-----
 .../pulsar/broker/service/BrokerService.java       | 45 +++++++++---
 .../org/apache/pulsar/broker/web/WebService.java   | 54 ++++++++++++---
 .../apache/pulsar/compaction/CompactorTool.java    | 15 ++--
 .../broker/namespace/OwnershipCacheTest.java       |  1 -
 .../pulsar/discovery/service/DiscoveryService.java | 27 +++++---
 .../discovery/service/server/ServerManager.java    | 43 +++++++++---
 .../org/apache/pulsar/functions/worker/Worker.java | 11 ++-
 .../pulsar/functions/worker/rest/WorkerServer.java | 31 +++++++--
 .../apache/pulsar/proxy/server/ProxyService.java   | 81 +++++++++++++++-------
 .../org/apache/pulsar/proxy/server/WebServer.java  | 28 ++++++--
 .../pulsar/websocket/service/ProxyServer.java      | 28 ++++++--
 16 files changed, 354 insertions(+), 156 deletions(-)

commit 0984f42fcb1c32b19d16213abd4e15c80e8a6b01
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 28 14:04:18 2019 -0700

    Allow to specify delivery delay in C++ client (#5317)
    
    * Allow to specify delivery delay in C++ client
    
    * Fixed symbols visibility to make it available for unit tests
    
    * Fixed format

 pulsar-client-cpp/include/pulsar/MessageBuilder.h | 16 ++++++++++
 pulsar-client-cpp/include/pulsar/c/message.h      | 15 ++++++++++
 pulsar-client-cpp/lib/ConsumerImpl.cc             |  3 +-
 pulsar-client-cpp/lib/HandlerBase.cc              | 11 ++-----
 pulsar-client-cpp/lib/HandlerBase.h               |  3 --
 pulsar-client-cpp/lib/MessageBuilder.cc           | 11 +++++++
 pulsar-client-cpp/lib/ProducerImpl.cc             | 16 +++++-----
 pulsar-client-cpp/lib/TimeUtils.cc                | 32 ++++++++++++++++++++
 pulsar-client-cpp/lib/TimeUtils.h                 | 36 +++++++++++++++++++++++
 pulsar-client-cpp/lib/c/c_Message.cc              |  8 +++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc      | 33 ++++++++++++++++++++-
 11 files changed, 162 insertions(+), 22 deletions(-)

commit cfef0fb488f197436d3da34dbc8e5d98892d1d8f
Author: boncheff <boncheff@users.noreply.github.com>
Date:   Mon Oct 28 17:30:46 2019 +0000

    Update client-libraries-go.md (#5382)

 site2/docs/client-libraries-go.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 49a8658cac4b8f842feae9a00ad3b2480c7916ac
Author: Brian Candler <b.candler@pobox.com>
Date:   Mon Oct 28 16:16:30 2019 +0000

    Add is_read_compacted to create_reader() in python API (#5483)
    
    Fixes #5365

 pulsar-client-cpp/python/pulsar/__init__.py | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit c59a37b2a718e45866dc5b6b23d8daef9aa1e307
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 28 08:22:28 2019 -0700

    [pulsar-perf] record message failure and avoid exiting from process on publish failure (#5441)
    
    * [pulsar-perf] record message failure and avoid exiting from process on publish failure
    
    * add flag to exit on publish failure (default: disable and continue)

 .../org/apache/pulsar/testclient/PerformanceProducer.java  | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 0c7319fcb99d04fda0100cd2f2c46ed87fda3eb0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 28 08:22:20 2019 -0700

    [pulsar-client] print unknown exception stacktrace (#5444)

 .../src/main/java/org/apache/pulsar/client/impl/ProducerImpl.java       | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b61b325892d26e22eca19bb34efd1c4272f3fe5f
Author: Keven Li <liyi.changde@gmail.com>
Date:   Mon Oct 28 21:31:24 2019 +0800

    fix bug:external protocols not set to local broker data (#5479)
    
    # Motivation
    
    lastData set external protocolData twice, it seems to be a spelling mistake.
    
    ### Modifications
    
      - change the second 'lastData.setProtocols(protocolData);' to '  localData.setProtocols(protocolData);'
      - format relative codes

 .../pulsar/broker/loadbalance/impl/ModularLoadManagerImpl.java   | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 18712eb9acec2b400c4567087b4a02c38ab17078
Author:  <ranxiaolong716@gmail.com>
Date:   Mon Oct 28 21:06:10 2019 +0800

    [functions][Issue:5350]Fix pulsar can't load the customized SerDe (#5357)
    
    Fixes #5350
    
    ### Motivation
    
    When using the `--output-serde-classname` option, `functionClassLoader` is not set correctly.

 .../apache/pulsar/functions/sink/PulsarSink.java   |  2 +-
 .../pulsar/functions/source/TopicSchema.java       | 16 +++-
 .../integration/functions/PulsarFunctionsTest.java | 86 ++++++++++++++++++++++
 .../functions/PulsarFunctionsTestBase.java         |  5 ++
 4 files changed, 105 insertions(+), 4 deletions(-)

commit 28b0c3a3cd4898cc1c6f2ff8e4d0c6a636cb6f30
Author: Addison Higham <addisonj@gmail.com>
Date:   Mon Oct 28 06:43:27 2019 -0600

    [functions] Distributed the CA for KubernetesSecretsTokenAuthProvider (#5398)
    
    Currently, if a user has TLS enabled and is using a custom CA that isn't
    baked into the image, when the functions worker starts, it won't have
    the CA in order to validate the cert presented by the broker.
    
    This adds support to have  the `KubernetesSecretsTokenAuthProvider`
    also distribute the CA via the same kubernetes secret used for the
    token.

 .../auth/KubernetesFunctionAuthProvider.java       |  2 +-
 .../auth/KubernetesSecretsTokenAuthProvider.java   | 27 +++++++++--
 .../runtime/KubernetesRuntimeFactory.java          |  5 ++-
 .../KubernetesSecretsTokenAuthProviderTest.java    | 52 ++++++++++++++++++++--
 .../runtime/KubernetesRuntimeFactoryTest.java      |  3 +-
 .../functions/runtime/KubernetesRuntimeTest.java   |  1 +
 .../functions/worker/FunctionRuntimeManager.java   |  1 +
 .../pulsar/functions/worker/WorkerConfig.java      | 14 ++++++
 8 files changed, 95 insertions(+), 10 deletions(-)

commit 2a6d2c6a25e69e570a60f3b7a5ef88398863b05f
Author: tuteng <guangning@apache.org>
Date:   Mon Oct 28 20:08:53 2019 +0800

    Copy directory to content (#5478)

 site2/tools/build-site.sh | 1 +
 1 file changed, 1 insertion(+)

commit acc3fb7c72e0c779873a023e0ec2b8e4a54e4798
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Mon Oct 28 18:54:24 2019 +0800

    Update team.js (#5467)

 site2/website/data/team.js | 36 ++++++++++++++++++++++++++++++++++--
 1 file changed, 34 insertions(+), 2 deletions(-)

commit 309c78e782960118a2c1656c0a50e7b237795945
Author: johnwagster <johnwagster@users.noreply.github.com>
Date:   Mon Oct 28 04:27:33 2019 -0500

    added deletion of state for Functions (#5469)
    
    ### Motivation
    
    Adding support for state deletion for Functions.  Ran into a use-case where it would be nice to be able to let go of state wherein the key is changing but the data itself is ephemeral.
    
    ### Modifications
    
    I've reflected the changes in the bookkeepr API back through in the context and state context API's so that you can delete on a put by passing null or call the new api for delete.
    
    ### Verifying this change
    
    This change added tests and can be verified as follows:
     - Running the unit tests available in the ContextImplTest and ContextStateImplTest

 .../org/apache/pulsar/functions/api/Context.java   | 14 +++++++++++++
 .../pulsar/functions/instance/ContextImpl.java     | 16 +++++++++++++++
 .../functions/instance/state/StateContext.java     |  9 ++++++++-
 .../functions/instance/state/StateContextImpl.java | 23 +++++++++++++++++++---
 .../pulsar/functions/instance/ContextImplTest.java | 15 ++++++++++++--
 .../instance/state/StateContextImplTest.java       | 14 +++++++++++++
 6 files changed, 85 insertions(+), 6 deletions(-)

commit 09360682953d0cbc154630a470492c11a4f83184
Author: Jia Zhai <zhaijia@apache.org>
Date:   Mon Oct 28 17:11:25 2019 +0800

    Fix wrongly report "3600 messages have timed-out" (#5477)
    
    related issue #5349

 .../main/java/org/apache/pulsar/client/impl/UnAckedMessageTracker.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 89e3f30d572362e8cf541e67729371eaa26c2002
Author: Jia Zhai <zhaijia@apache.org>
Date:   Mon Oct 28 09:15:26 2019 +0800

    make some method of ManagedLedger public (#5472)
    
    Some of the ManagedLedger methods, such as hasMoreEntries/getPreviousPosition/getNextValidPosition, are protected. This change try to make them public.
    These methods are useful when user want to do some advanced operation in Data Processing.

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java       | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 6fb5fd207cfd3170446bbfff48558b475c60fca9
Author: Jia Zhai <zhaijia@apache.org>
Date:   Sun Oct 27 23:44:18 2019 +0800

    put protocol handler after loadmanagement (#5473)
    
    Pulsar service is available only after loadmanagement service is started, or user will meet error of bundle service errors when access pulsar service.  But protocol handler starting may need the Pulsar service.
    This change is try to put protocol handler starting after loadmanagement service.

 .../java/org/apache/pulsar/broker/PulsarService.java    | 17 ++++++++---------
 1 file changed, 8 insertions(+), 9 deletions(-)

commit 43984bacd1e318b7a3c00aa358d4acef7a20e7a3
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Sat Oct 26 11:50:42 2019 +0800

    Update resources.js (#5468)
    
    ### Motivation
    Some resources are not added to the Resources page.
    
    ### Modifications
    Add more resources related to Apache Pulsar blogs and presentations.

 site2/website/data/resources.js | 122 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 122 insertions(+)

commit fbe1ed209f2227195221daf8530508ab66481b50
Author: Tom Manderson <me@trm.io>
Date:   Sat Oct 26 09:28:25 2019 +1000

    Fix broken link to k8s YAML definitions (#5332)

 site2/docs/deploy-kubernetes.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c38be69a53a19657296aacf4ac3024c06f9dd1c4
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 25 09:43:45 2019 -0700

    Use individual netty-* artifacts instead of netty-all (#3613)

 distribution/server/src/assemble/LICENSE.bin.txt   |  20 +++-
 distribution/server/src/assemble/bin.xml           |  16 ----
 pom.xml                                            | 105 +++++++++++++++------
 pulsar-broker-shaded/pom.xml                       |   6 +-
 pulsar-broker/pom.xml                              |   2 +-
 pulsar-client-admin-shaded/pom.xml                 |   6 +-
 pulsar-client-shaded/pom.xml                       |   4 +-
 pulsar-client/pom.xml                              |  10 ++
 pulsar-common/pom.xml                              |  12 ++-
 pulsar-functions/localrun/pom.xml                  |   5 -
 pulsar-functions/utils/pom.xml                     |   6 --
 pulsar-functions/worker-shaded/pom.xml             |  34 -------
 pulsar-io/kinesis/pom.xml                          |   5 -
 pulsar-io/netty/pom.xml                            |   8 +-
 .../proxy/server/ProxyWithAuthorizationTest.java   |   2 +-
 pulsar-spark/pom.xml                               |   5 +-
 tiered-storage/file-system/pom.xml                 |   6 ++
 17 files changed, 133 insertions(+), 119 deletions(-)

commit d0fde6929a7da7a7d1748fdf555a55a4578b404a
Author: lipenghui <penghui@apache.org>
Date:   Fri Oct 25 23:23:03 2019 +0800

    [integration-tests]Enable messaging tests to integration tests. (#5456)
    
    * Enable messaging tests to integration tests.
    
    * Fix integration tests

 .../tests/integration/messaging/MessagingBase.java |  59 ++++---
 .../messaging/NonPersistentTopicMessagingTest.java |   4 +-
 .../integration/messaging/TopicMessagingBase.java  | 181 ++++++++-------------
 .../src/test/resources/pulsar-messaging.xml        |  29 ++++
 tests/integration/src/test/resources/pulsar.xml    |   1 +
 5 files changed, 130 insertions(+), 144 deletions(-)

commit 76865425b3d02e62593cdf156d07c749911f8c84
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Oct 25 00:06:23 2019 -0700

    [pulsar-broker] Introduce publish rate-limiting on topic (#3986)
    
    * [pulsar-broker] Introduce publish rate-limiting on topic
    
    disable auto-read on cnx for publish throttling
    
    Clean up
    
    * fix documentation
    
    * clean up conflict class

 conf/broker.conf                                   |   4 +
 conf/standalone.conf                               |   5 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   8 +
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  51 ++++++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  22 +++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  21 +++
 .../pulsar/broker/service/AbstractTopic.java       |  98 ++++++++++-
 .../pulsar/broker/service/BrokerService.java       |  49 ++++++
 .../org/apache/pulsar/broker/service/Producer.java |  11 +-
 .../pulsar/broker/service/PublishRateLimiter.java  | 163 ++++++++++++++++++
 .../broker/service/PulsarChannelInitializer.java   |   7 +
 .../apache/pulsar/broker/service/ServerCnx.java    |  31 +++-
 .../org/apache/pulsar/broker/service/Topic.java    |   8 +
 .../service/nonpersistent/NonPersistentTopic.java  |  16 +-
 .../broker/service/persistent/PersistentTopic.java |  48 +++---
 .../client/impl/MessagePublishThrottlingTest.java  | 186 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  22 +++
 .../client/admin/internal/NamespacesImpl.java      |  25 +++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   7 +
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  37 ++++
 .../pulsar/common/policies/data/Policies.java      |   5 +-
 .../pulsar/common/policies/data/PublishRate.java   |  65 +++++++
 22 files changed, 844 insertions(+), 45 deletions(-)

commit 13e35f7ff4c36e4c12905fcb55c83d97bc04cbf9
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Fri Oct 25 15:05:31 2019 +0800

    [PIP-43] Support producer to send msg with different schema (#5165)
    
    Master Issue: #5141
    
    ### Motivation
    
    Implement part-1 of [PIP-43](https://github.com/apache/pulsar/wiki/PIP-43%3A-producer-send-message-with-different-schema#changespart-1).
    
    ### Modifications
    
    * New message api to specify message schema explicitly;
    * Mechanism of registering schema on producing;
    * Batch message container support to check message schema;
    * Configuration for seamless introduction of this feature;

 .../apache/pulsar/broker/service/ServerCnx.java    |   72 +-
 .../apache/pulsar/client/api/SimpleSchemaTest.java |  220 +-
 .../apache/pulsar/client/api/ProducerBuilder.java  |   15 +
 .../java/org/apache/pulsar/client/api/Schema.java  |   12 +
 .../client/internal/DefaultImplementation.java     |    7 +
 pulsar-client-cpp/lib/Commands.cc                  |    4 +
 .../client/impl/BatchMessageContainerBase.java     |    9 +
 .../client/impl/BatchMessageContainerImpl.java     |   13 +
 .../client/impl/BatchMessageKeyBasedContainer.java |   15 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   43 +
 .../apache/pulsar/client/impl/HandlerState.java    |   10 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |   19 +
 .../apache/pulsar/client/impl/ProducerBase.java    |   20 +
 .../pulsar/client/impl/ProducerBuilderImpl.java    |    8 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  270 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |    3 +
 .../impl/conf/ProducerConfigurationData.java       |    2 +
 .../client/impl/schema/AutoProduceBytesSchema.java |   17 +-
 .../pulsar/client/impl/schema/SchemaHash.java      |   49 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 2643 +++++++++++++++-----
 .../apache/pulsar/common/protocol/Commands.java    |   44 +
 .../pulsar/common/protocol/PulsarDecoder.java      |   22 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   21 +
 23 files changed, 2749 insertions(+), 789 deletions(-)

commit 0281e83930b6752beeb36fca10d62fa2873b8f91
Author: xujianhai666 <52450794+xujianhai666@users.noreply.github.com>
Date:   Fri Oct 25 15:04:38 2019 +0800

    Documentation for delayed message delivery(#5293)

 site2/docs/assets/message_delay.png | Bin 0 -> 30906 bytes
 site2/docs/concepts-messaging.md    |  30 ++++++++++++++++++++++++++++++
 2 files changed, 30 insertions(+)

commit 6f113f730fbbd7ca63ae11f8f394d9e76d4899bd
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 24 23:54:53 2019 -0700

    [Cpp] Fixed negative ack tracker constructor sequence (#5453)
    
    * [Cpp] Fixed negative ack tracker constructor sequence
    
    * Fixed formatting
    
    * Fixed default for neg ack delay on partitioned topics
    
    * Fixed format

 .../include/pulsar/ConsumerConfiguration.h             |  6 ++++++
 pulsar-client-cpp/lib/ConsumerConfiguration.cc         | 10 ++++++++--
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h      |  3 ++-
 pulsar-client-cpp/lib/NegativeAcksTracker.cc           | 18 ++++++++++++------
 pulsar-client-cpp/lib/NegativeAcksTracker.h            |  2 --
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc       |  2 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc           |  4 +++-
 7 files changed, 32 insertions(+), 13 deletions(-)

commit bf9a9019adf3a073a8af6911383f654225a240e1
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 24 21:41:42 2019 -0700

    [pulsar-client] Fix message corruption on OOM for batch messages (#5443)
    
    * [pulsar-client] Fix message corruption on OOM for batch messages
    
    * remove comments
    
    * Address comments: index in local-var + remove lastSerializedMessageIndex var

 .../client/impl/BatchMessageContainerImpl.java     | 28 ++++++++++++++++++----
 .../apache/pulsar/client/impl/ProducerImpl.java    |  2 +-
 2 files changed, 25 insertions(+), 5 deletions(-)

commit 6823628733ef3021dd275d2fc947689c9c8c28c6
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Oct 24 20:37:40 2019 -0700

     Handle tearDown exception for test stability (#5460)

 .../bookkeeper/test/MockedBookKeeperTestCase.java  | 24 +++++++++++++---------
 1 file changed, 14 insertions(+), 10 deletions(-)

commit 7c3f3bdc33b152869c5d108701f1e407e21afbce
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 24 14:39:00 2019 -0700

    Expose metrics of Caffeine caches (#5320)
    
    * Expose metrics of Caffeine and Guava caches
    
    * Fixed test
    
    * removed guava cache instrumentation
    
    * Fixed test

 distribution/server/src/assemble/LICENSE.bin.txt   |  1 +
 pom.xml                                            |  6 +++++
 pulsar-broker/pom.xml                              |  1 -
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |  9 ++++---
 .../pulsar/broker/namespace/OwnershipCache.java    | 14 +++++++----
 .../common/naming/NamespaceBundleFactory.java      |  7 +++++-
 .../pulsar/broker/stats/PrometheusMetricsTest.java |  7 +++---
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  2 +-
 pulsar-zookeeper-utils/pom.xml                     |  4 ++++
 .../apache/pulsar/stats/CacheMetricsCollector.java | 28 ++++++++++++++++++++++
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |  2 +-
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |  2 +-
 .../zookeeper/ZkBookieRackAffinityMapping.java     |  3 ++-
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |  5 ++--
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    | 24 ++++++++++++++-----
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |  6 ++---
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java | 24 +++++++++----------
 17 files changed, 104 insertions(+), 41 deletions(-)

commit 402ecec9c3731711fd1bf700c30d09678aa9b1e5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 24 13:47:10 2019 -0700

    [pulsar-client] support set read-position based on timestamp (#5075)
    
    Fix formatting
    
    rename field

 .../apache/pulsar/broker/service/ServerCnx.java    |  7 +-
 .../org/apache/pulsar/broker/service/Topic.java    |  2 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  2 +-
 .../broker/service/persistent/PersistentTopic.java | 31 ++++++--
 .../apache/pulsar/client/impl/RawReaderImpl.java   |  1 +
 .../service/PersistentTopicConcurrentTest.java     |  8 +-
 .../pulsar/broker/service/PersistentTopicTest.java | 26 +++----
 .../pulsar/broker/service/ServerCnxTest.java       | 65 +++++++++-------
 .../client/api/SimpleProducerConsumerTest.java     |  1 +
 .../org/apache/pulsar/client/impl/ReaderTest.java  | 87 ++++++++++++++++++++++
 .../apache/pulsar/client/api/ReaderBuilder.java    | 13 ++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 22 ++++--
 .../pulsar/client/impl/ReaderBuilderImpl.java      |  7 ++
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  7 +-
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  |  5 +-
 .../client/impl/conf/ReaderConfigurationData.java  |  5 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 ++++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |  9 ++-
 pulsar-common/src/main/proto/PulsarApi.proto       |  6 +-
 19 files changed, 289 insertions(+), 72 deletions(-)

commit 991c2a27c0839f97bb01ecb494ef535496f8c586
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 24 11:27:30 2019 -0700

    Multiple unit tests improvements (#5439)
    
    * Multiple unit tests improvements
    
    * Fixed Storm integration tests
    
    * Fixed StringSchema static initialization
    
    * Peg number of forks to number of cores
    
    * Updated to 4 forks
    
    * Fixed resourcel leak in managed ledger tests
    
    * Use different temp folders for PulsarFunctionState test
    
    * Increase retries count for PulsarFunctionE2ESecurityTest
    
    * Fixed Flume connector test
    
    * Fixed race conditions in primitive schema types static initialization
    
    * Improve port manager
    
    * Removed PulsarFunctionStateTest to move to integration tests
    
    * Fixed dangling class reference

 .../apache/pulsar/tests/PulsarTestListener.java    |  17 +-
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |  20 +-
 .../mledger/impl/ManagedLedgerBkTest.java          |   2 +
 .../bookkeeper/test/BookKeeperClusterTestCase.java |   1 +
 .../org/apache/bookkeeper/test/PortManager.java    |  97 ++---
 pom.xml                                            |   7 +-
 .../org/apache/pulsar/PulsarBrokerStarter.java     |  11 +-
 .../apache/pulsar/broker/NoOpShutdownService.java  |  38 ++
 .../org/apache/pulsar/broker/PulsarService.java    |  19 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   2 +-
 .../pulsar/broker/service/BrokerService.java       |  10 +-
 .../stats/prometheus/NamespaceStatsAggregator.java |   1 +
 .../broker/BookKeeperClientFactoryImplTest.java    |   3 +
 .../apache/pulsar/broker/SLAMonitoringTest.java    |   4 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   6 +-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |   7 +-
 .../broker/admin/BrokerAdminClientTlsAuthTest.java |  14 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |   3 +
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |   4 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  28 +-
 .../broker/cache/ResourceQuotaCacheTest.java       |  10 +-
 .../AntiAffinityNamespaceGroupTest.java            |  44 ++-
 .../broker/loadbalance/LoadBalancerTest.java       |   9 +-
 .../loadbalance/ModularLoadManagerImplTest.java    |  35 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |  13 +-
 .../namespace/NamespaceCreateBundlesTest.java      |   4 +-
 .../broker/namespace/NamespaceServiceTest.java     |   4 +-
 .../broker/namespace/OwnershipCacheTest.java       |   6 +-
 .../broker/service/AdvertisedAddressTest.java      |  22 +-
 .../broker/service/BacklogQuotaManagerTest.java    |   2 +
 .../pulsar/broker/service/BatchMessageTest.java    |  11 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |   4 +-
 .../broker/service/BrokerBookieIsolationTest.java  |  26 +-
 .../pulsar/broker/service/MaxMessageSizeTest.java  |   2 +
 .../PersistentDispatcherFailoverConsumerTest.java  |  15 +-
 .../broker/service/PersistentFailoverE2ETest.java  |  30 +-
 .../service/PersistentMessageFinderTest.java       |  10 +-
 .../broker/service/PersistentQueueE2ETest.java     |   4 +-
 .../service/PersistentTopicConcurrentTest.java     |   2 +
 .../pulsar/broker/service/PersistentTopicTest.java |  12 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   4 +
 .../pulsar/broker/service/ServerCnxTest.java       |  12 +-
 .../persistent/PersistentSubscriptionTest.java     |  14 +-
 .../pulsar/broker/stats/PrometheusMetricsTest.java |   3 -
 .../buffer/PersistentTransactionBufferTest.java    |  10 +-
 .../apache/pulsar/broker/web/WebServiceTest.java   |   6 +-
 .../api/AuthorizationProducerConsumerTest.java     |  27 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |  49 ++-
 .../client/api/ClientDeduplicationFailureTest.java |  19 +-
 .../client/api/DispatcherBlockConsumerTest.java    | 118 ++++---
 .../pulsar/client/api/NonPersistentTopicTest.java  |  10 +-
 .../pulsar/client/api/ServiceUrlProviderTest.java  |   2 +-
 .../pulsar/client/api/TlsProducerConsumerBase.java |   9 +
 .../client/api/v1/V1_ProducerConsumerTest.java     |   4 +-
 .../client/impl/BrokerClientIntegrationTest.java   |  56 ++-
 .../pulsar/client/impl/ConnectionPoolTest.java     |   6 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |   1 +
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    | 152 ++++----
 .../worker/PulsarFunctionE2ESecurityTest.java      |   6 +-
 .../worker/PulsarFunctionLocalRunTest.java         |   2 +
 .../worker/PulsarFunctionPublishTest.java          |   7 +-
 .../functions/worker/PulsarFunctionStateTest.java  | 389 ---------------------
 .../worker/PulsarWorkerAssignmentTest.java         |   2 +
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |   2 +
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   6 +-
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  13 +-
 .../pulsar/client/cli/PulsarClientToolTest.java    |  11 +-
 .../pulsar/client/impl/schema/BooleanSchema.java   |  15 +-
 .../pulsar/client/impl/schema/ByteBufSchema.java   |  15 +-
 .../client/impl/schema/ByteBufferSchema.java       |  19 +-
 .../pulsar/client/impl/schema/ByteSchema.java      |  15 +-
 .../pulsar/client/impl/schema/BytesSchema.java     |  16 +-
 .../pulsar/client/impl/schema/DateSchema.java      |  15 +-
 .../pulsar/client/impl/schema/DoubleSchema.java    |  16 +-
 .../pulsar/client/impl/schema/FloatSchema.java     |  15 +-
 .../pulsar/client/impl/schema/IntSchema.java       |  15 +-
 .../pulsar/client/impl/schema/LongSchema.java      |  15 +-
 .../pulsar/client/impl/schema/ShortSchema.java     |  15 +-
 .../pulsar/client/impl/schema/TimeSchema.java      |  15 +-
 .../pulsar/client/impl/schema/TimestampSchema.java |  15 +-
 .../apache/pulsar/common/util/RateLimiterTest.java |   3 +-
 .../ConcurrentSortedLongPairSetTest.java           |   4 +-
 .../service/web/DiscoveryServiceServlet.java       |   9 +
 .../service/web/ZookeeperCacheLoader.java          |   5 +-
 .../pulsar/functions/worker/WorkerService.java     |   8 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |   1 +
 .../apache/pulsar/io/file/AbstractFileTests.java   |  52 ++-
 .../pulsar/io/file/FileConsumerThreadTests.java    |  48 +--
 .../pulsar/io/file/FileListingThreadTests.java     | 108 +++---
 .../pulsar/io/file/ProcessedFileThreadTests.java   | 104 +++---
 .../pulsar/io/flume/sink/StringSinkTests.java      |  29 +-
 .../pulsar/io/flume/source/StringSourceTests.java  |   6 +-
 pulsar-io/flume/src/test/resources/flume/sink.conf |   2 +-
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   5 +-
 .../zookeeper/LocalZooKeeperConnectionService.java |   8 +-
 .../pulsar/zookeeper/ZooKeeperSessionWatcher.java  |  16 +-
 .../LocalZooKeeperConnectionServiceTest.java       |  17 +-
 .../MockedZooKeeperClientFactoryImpl.java          |  17 +-
 .../org/apache/pulsar/storm/PulsarBoltTest.java    |   4 +-
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   4 +-
 100 files changed, 1099 insertions(+), 1051 deletions(-)

commit 978efaf11359101042ea80aefad5dd6c9b78d58a
Author: Addison Higham <addisonj@gmail.com>
Date:   Thu Oct 24 10:58:41 2019 -0600

    [proxy] Fix proxy to be able to re-send request body (#5361)
    
    Fixes #5360
    
    This adds a small cache of the request body to ensure that it can be
    re-sent.
    
    TODO: still needs tested

 .../pulsar/proxy/server/AdminProxyHandler.java     | 40 ++++++++++++++++++++++
 .../pulsar/tests/integration/proxy/TestProxy.java  | 24 +++++++++++++
 2 files changed, 64 insertions(+)

commit a71ac2084ba062b19c3b0a2238022459173b5092
Author: tuteng <eguangning@gmail.com>
Date:   Fri Oct 25 00:58:14 2019 +0800

    Fix website io connector 404 (#5347)

 site2/docs/io-aerospike.md       | 21 ++++++++++++++++
 site2/docs/io-cassandra.md       | 22 +++++++++++++++++
 site2/docs/io-connectors.md      |  1 -
 site2/docs/io-elasticsearch.md   | 21 ++++++++++++++++
 site2/docs/io-file-source.md     |  2 +-
 site2/docs/io-file.md            | 27 ++++++++++++++++++++
 site2/docs/io-hdfs.md            | 26 ++++++++++++++++++++
 site2/docs/io-influxdb.md        | 25 +++++++++++++++++++
 site2/docs/io-jdbc.md            | 23 +++++++++++++++++
 site2/docs/io-kafka.md           | 44 +++++++++++++++++++++++++++++++++
 site2/docs/io-kinesis.md         | 36 +++++++++++++++++++++++++++
 site2/docs/io-mongo.md           | 20 +++++++++++++++
 site2/docs/io-netty-source.md    |  2 +-
 site2/docs/io-netty.md           | 20 +++++++++++++++
 site2/docs/io-rabbitmq-source.md |  2 +-
 site2/docs/io-rabbitmq.md        | 53 ++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-redis.md           | 27 ++++++++++++++++++++
 site2/docs/io-solr.md            | 21 ++++++++++++++++
 site2/docs/io-twitter.md         | 23 +++++++++++++++++
 19 files changed, 412 insertions(+), 4 deletions(-)

commit b4e5d153e52e55d3e1cb48462ba75067cf9c60ce
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 24 08:38:18 2019 -0700

    Standalone should use crc32c by default as well (#5385)

 conf/standalone.conf | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit c5c44a926a3c4c8a2a58198a50e8e0f599ef8ade
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Oct 24 08:21:00 2019 -0700

    Add test for links to other markdown docs. (#5411)
    
    * Add test for links to other markdown docs.
    
    * Remove unused import.

 site2/README.md                           |   8 +
 site2/website/__tests__/doc-links.test.js |  67 ++++++
 site2/website/__tests__/docs.test.js      | 354 ------------------------------
 site2/website/__tests__/index.test.js     |  18 --
 site2/website/jest-puppeteer.config.js    |  10 -
 5 files changed, 75 insertions(+), 382 deletions(-)

commit ba6dfaf24d2c1133c94ea40ed00097ec7a3e2bc9
Author: Pierre Zemb <contact@pierrezemb.fr>
Date:   Thu Oct 24 17:20:38 2019 +0200

    [Doc] Add *authenticateMetricsEndpoint* option in administration-proxy.md (#5406)

 site2/docs/administration-proxy.md | 1 +
 1 file changed, 1 insertion(+)

commit a95bea6037ffbe7c9f7898d4413cefcf263db8dc
Author: lipenghui <penghui@apache.org>
Date:   Thu Oct 24 16:01:47 2019 +0800

    Add support for partitioned topic consumer seek by time. (#5435)
    
    ### Motivation
    
    Add support for partitioned topic consumer seek by time.
    
    ### Modifications
    
    Call each partition consumer seekAsync() while call partitioned consumer seekAsync()
    
    ### Verifying this change
    
    Update unit tests for consumer.seek().

 .../broker/service/SubscriptionSeekTest.java       | 57 +++++++++++++++++++---
 .../org/apache/pulsar/client/api/Consumer.java     |  6 ---
 .../client/impl/MultiTopicsConsumerImpl.java       |  4 +-
 3 files changed, 52 insertions(+), 15 deletions(-)

commit 997a1282511a49057736a37ea88fa6c08b67c729
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Oct 24 13:29:18 2019 +0800

    [Docs] Add functions-worker commands for pulsar admin CLI (#5405)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    [Docs] Add functions-worker commands for pulsar admin CLI

 site2/docs/reference-pulsar-admin.md | 61 ++++++++++++++++++++++++++++++++++++
 1 file changed, 61 insertions(+)

commit 0f57c606c20daa6b9cd72665d682bd66637deef5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Oct 23 18:15:12 2019 -0700

    [pulsar-perf] Add batching max message into perf-producer (#5440)
    
    * [pulsar-perf] Add batching max message into perf-producer
    
    * add default values

 .../client/impl/conf/ProducerConfigurationData.java   | 10 +++++++---
 .../apache/pulsar/testclient/PerformanceProducer.java | 19 ++++++++++++++-----
 2 files changed, 21 insertions(+), 8 deletions(-)

commit e97ea92b764e52c523c6827750f64b961aa256e2
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Oct 24 00:40:34 2019 +0800

    [Docs] Add delete-dynamic-config command for brokers (#5389)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 site2/docs/reference-pulsar-admin.md | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit 5d1529a745b295283fd84d5930fac0c3092ef036
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Oct 23 18:36:30 2019 +0200

    Give compacted ledger some time to update in python test(#2321) (#5448)
    
    After compaction completes the compacted ledger is recorded as a
    property of a cursor. As persisting the cursor is async and we don't
    wait for the acknowledgement of the acknowledgement, there may be a
    race if we try to read the compacted ledger immediately.
    
    To avoid this race, I've added a 1 second sleep to allow the compacted
    ledger to be updated on the broker.

 pulsar-client-cpp/python/pulsar_test.py | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

commit 8b7245c9c13ad9b64760930ec2139c461ca1cb3b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Oct 23 08:56:47 2019 -0700

    Make Function Authentication Provider pluggable (#5404)
    
    * Make Function Authentication Provider pluaggable
    
    * add config comments
    
    * cleaning up
    
    * cleaning up
    
    * fix test

 .../org/apache/pulsar/functions/LocalRunner.java   |   3 +-
 .../functions/auth/FunctionAuthProvider.java       |   5 +
 .../auth/KubernetesFunctionAuthProvider.java       |   8 ++
 .../auth/KubernetesSecretsTokenAuthProvider.java   |   8 +-
 .../functions/auth/NoOpFunctionAuthProvider.java   |  49 ----------
 .../functions/runtime/KubernetesRuntime.java       |   8 +-
 .../runtime/KubernetesRuntimeFactory.java          |  35 +++++--
 .../functions/runtime/ProcessRuntimeFactory.java   |  18 +++-
 .../pulsar/functions/runtime/RuntimeFactory.java   |   7 +-
 .../KubernetesSecretsTokenAuthProviderTest.java    |  13 ++-
 .../runtime/KubernetesRuntimeFactoryTest.java      |  97 ++++++++++++++++++-
 .../functions/runtime/KubernetesRuntimeTest.java   |   4 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   3 +-
 .../pulsar/functions/worker/FunctionActioner.java  |  30 +++---
 .../functions/worker/FunctionRuntimeManager.java   |  15 ++-
 .../pulsar/functions/worker/WorkerConfig.java      |   8 ++
 .../functions/worker/rest/api/FunctionsImpl.java   | 104 +++++++++++----------
 .../functions/worker/rest/api/SinksImpl.java       |  96 ++++++++++---------
 .../functions/worker/rest/api/SourcesImpl.java     |  96 ++++++++++---------
 .../functions/worker/FunctionActionerTest.java     |   7 +-
 20 files changed, 377 insertions(+), 237 deletions(-)

commit 7b0b55043150e1e1c0912710b87861c329963615
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 23 08:56:09 2019 -0700

    Update version of dockerfile-maven plugin (#5416)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 13ea25a3e0b1d4b01ec678049964816a1275a95f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Oct 23 04:06:26 2019 -0700

    [pulsar-broker] Fix: race condition : Failed to read-more entries on dispatcher (#5391)
    
    * [pulsar-broker] Fix: race condition : Failed to read-more entries on dispatcher
    
    * clean up non-used method

 .../PersistentDispatcherMultipleConsumers.java     | 28 ++++++----------------
 1 file changed, 7 insertions(+), 21 deletions(-)

commit 81e7950024d1e663844988a894dcf12dafb8200b
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Wed Oct 23 19:03:29 2019 +0800

    [Issue 5362][website]Update logo path for Pulsar users (#5374)
    
    * Update logo path for Pulsar users
    
    * Fix logo background for HSL and One click retail

 site2/website/data/users.js | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 492d92bd2bc14f8a4eed22bc9208d86141dc1c95
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Oct 23 19:39:15 2019 +0900

    Change state_ to closed when resultOk is returned (#5446)

 pulsar-client-cpp/lib/ConsumerImpl.cc | 6 +++++-
 pulsar-client-cpp/lib/ProducerImpl.cc | 6 +++++-
 2 files changed, 10 insertions(+), 2 deletions(-)

commit e73fc0007bd60cfa21accb819abacd4b3ebccd40
Author: Like <ke.like@outlook.com>
Date:   Wed Oct 23 18:38:36 2019 +0800

    Replace foreach with System.arraycopy (#5424)

 .../main/java/org/apache/pulsar/broker/stats/NamespaceStats.java  | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit 84a519fa7389c3d2609d7445c72c2b6750c607f0
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Wed Oct 23 16:30:35 2019 +0900

    [pulsar-broker] Fix bug that namespace policies does not take effect due to NPE (#5408)
    
    * Fix bug that namespace policies does not take effect due to NPE
    
    * Prevent NPE if Dispatcher and DispatchRateLimiter return to null

 .../org/apache/pulsar/broker/service/BrokerService.java    |  5 +++--
 .../pulsar/broker/service/persistent/PersistentTopic.java  | 14 ++++++++++----
 2 files changed, 13 insertions(+), 6 deletions(-)

commit ddf5429efb91e43386d506061b196330cbaae473
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 22 20:34:18 2019 -0700

    Fixed StringSchema static initialization (#5445)

 .../pulsar/client/impl/schema/StringSchema.java    | 38 +++++++++++++---------
 1 file changed, 23 insertions(+), 15 deletions(-)

commit b466b085449be5cea51539871636f51c2ec42014
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 22 20:33:18 2019 -0700

    [pulsar-client] Avoid leak on publish failure on batch message (#5442)

 .../main/java/org/apache/pulsar/client/impl/ProducerImpl.java | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

commit 625869597475915c1fee189680c12c92561e8126
Author:  <25.r55u2n444tag@gmail.com>
Date:   Wed Oct 23 10:41:57 2019 +0900

    Fix pulser-client-cpp Dockerfile (#5413)

 pulsar-client-cpp/pkg/deb/Dockerfile | 2 +-
 pulsar-client-cpp/pkg/rpm/Dockerfile | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 590b0684c1f92ff28f8e14b2f76447274eb65e53
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Oct 22 11:47:47 2019 -0700

    fix potential deadlock that can occur in addConsumer (#5371)
    
    * fix potential deadlock that can occur in addConsumer
    
    * add fix to PersistentDispatcherSingleActiveConsumer
    
    * fixing tests

 .../NonPersistentDispatcherSingleActiveConsumer.java     | 16 ++++++++++++----
 .../PersistentDispatcherMultipleConsumers.java           | 15 +++++++++++----
 .../PersistentDispatcherSingleActiveConsumer.java        | 16 ++++++++++++----
 .../pulsar/broker/service/PersistentTopicTest.java       | 10 +++++-----
 .../org/apache/pulsar/zookeeper/ZooKeeperDataCache.java  |  5 +++++
 5 files changed, 45 insertions(+), 17 deletions(-)

commit 54ce65edfd1937a7892f62b51561023d95dd9cd0
Author: Keven Li <liyi.changde@gmail.com>
Date:   Wed Oct 23 00:26:23 2019 +0800

    remove redundant condition (#5403)
    
    Signed-off-by: KevenYLi <liyi.changde@gmail.com>

 .../src/main/java/org/apache/pulsar/broker/web/RestException.java      | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 8a0220647df186d0bbdfc84abeffda9cebea82be
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Oct 22 02:21:51 2019 -0700

    Fix couple functions related integration tests (#5434)

 .../{functions => cli}/FunctionsCLITest.java       | 12 +++++-----
 .../integration/src/test/resources/pulsar-cli.xml  |  1 +
 .../src/test/resources/pulsar-function-state.xml   | 28 ++++++++++++++++++++++
 tests/integration/src/test/resources/pulsar.xml    |  1 +
 4 files changed, 36 insertions(+), 6 deletions(-)

commit c4035d3d76d46a519cea244ef331df85b7493b60
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Oct 21 20:58:16 2019 -0700

    Revert "Add default loader for latest pyyaml (#4974)" (#5432)
    
    This reverts commit d49e61e0907c30d71184da4eb769c9761456a80f.

 docker/pulsar/scripts/gen-yml-from-env.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit be6a102511560349701dbe6b83fabf831dc81340
Author:  <ranxiaolong716@gmail.com>
Date:   Mon Oct 21 12:01:36 2019 +0800

    [Issue: 3161][Go client] Return Message ID for send (#4811)
    
    ### Motivation
    
    The `Send(context.Context, ProducerMessage) error` should return `MessageID`.
    
    ```
     SendAsync(context.Context, ProducerMessage, func(ProducerMessage, error))
    ```

 pulsar-client-cpp/examples/SampleAsyncProducer.cc  |  4 +-
 .../include/pulsar/ProducerConfiguration.h         |  2 +-
 pulsar-client-cpp/include/pulsar/c/producer.h      |  2 +-
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |  2 +-
 pulsar-client-cpp/lib/BatchMessageContainer.h      |  7 ++-
 pulsar-client-cpp/lib/ClientConnection.cc          |  7 ++-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  2 +-
 pulsar-client-cpp/lib/Producer.cc                  | 10 ++--
 pulsar-client-cpp/lib/ProducerImpl.cc              | 26 +++++----
 pulsar-client-cpp/lib/ProducerImpl.h               |  5 +-
 pulsar-client-cpp/lib/c/c_Producer.cc              | 16 ++++--
 pulsar-client-cpp/perf/PerfProducer.cc             |  5 +-
 pulsar-client-cpp/python/src/producer.cc           |  4 +-
 pulsar-client-cpp/tests/AuthPluginTest.cc          |  7 +--
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 15 ++---
 pulsar-client-cpp/tests/BatchMessageTest.cc        | 14 ++---
 pulsar-client-cpp/tests/ProducerTest.cc            |  8 +--
 .../examples/sendWithMsgID/producer.go             | 63 ++++++++++++++++++++
 pulsar-client-go/pulsar/c_go_pulsar.h              |  7 +++
 pulsar-client-go/pulsar/c_message.go               |  6 ++
 pulsar-client-go/pulsar/c_producer.go              | 67 ++++++++++++++++++++++
 pulsar-client-go/pulsar/producer.go                | 13 +++++
 pulsar-client-go/pulsar/producer_test.go           | 28 +++++++++
 pulsar-client-go/pulsar/testhelps.go               | 10 ++++
 24 files changed, 265 insertions(+), 65 deletions(-)

commit 8ddd0a8df488639d19d3ff528628a09e4d213c0f
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Oct 17 09:26:04 2019 +0800

    Update connector guide overall (#5296)

 site2/docs/{io-cdc-canal.md => io-canal-source.md} |  12 +-
 site2/docs/io-cassandra-sink.md                    |  29 +-
 site2/docs/io-cdc-debezium.md                      |  13 +-
 site2/docs/io-cdc.md                               |   6 +-
 .../{reference-connector-admin.md => io-cli.md}    |   4 +-
 site2/docs/io-connectors.md                        |  77 +-
 site2/docs/io-debezium-source.md                   | 306 ++++++++
 site2/docs/io-jdbc-sink.md                         |   2 +-
 site2/docs/io-kafka-source.md                      |   4 +-
 site2/docs/io-kinesis-source.md                    |   9 +-
 site2/docs/io-quickstart.md                        | 818 +++++++++++----------
 site2/website/sidebars.json                        |   2 +-
 12 files changed, 835 insertions(+), 447 deletions(-)

commit 63a73fc896dda875d4884e569e3bfead853a8e59
Author: Chris Bartholomew <c_bartholomew@yahoo.com>
Date:   Tue Oct 15 13:41:53 2019 -0400

    Fixing pod anti-affinity rules in Kubernetes files including the Helm chart (#5381)

 deployment/kubernetes/aws/zookeeper.yaml                              | 4 ++++
 deployment/kubernetes/generic/k8s-1-9-and-above/zookeeper.yaml        | 4 ++++
 deployment/kubernetes/generic/original/zookeeper.yaml                 | 4 ++++
 deployment/kubernetes/google-kubernetes-engine/bookie.yaml            | 4 ++++
 deployment/kubernetes/google-kubernetes-engine/zookeeper.yaml         | 4 ++++
 .../kubernetes/helm/pulsar/templates/autorecovery-deployment.yaml     | 2 +-
 .../kubernetes/helm/pulsar/templates/bookkeeper-statefulset.yaml      | 2 +-
 deployment/kubernetes/helm/pulsar/templates/broker-deployment.yaml    | 2 +-
 deployment/kubernetes/helm/pulsar/templates/proxy-deployment.yaml     | 2 +-
 .../kubernetes/helm/pulsar/templates/zookeeper-statefulset.yaml       | 2 +-
 10 files changed, 25 insertions(+), 5 deletions(-)

commit 3a9854e99503a5d41531e949d05876cb1641b9e8
Author: lipenghui <penghui@apache.org>
Date:   Tue Oct 15 10:25:22 2019 +0800

    make skip all messages async. (#5375)

 .../broker/admin/impl/PersistentTopicsBase.java    | 31 +++++++++++++---------
 1 file changed, 18 insertions(+), 13 deletions(-)

commit 75060927882fb90243a086c936a2cb5d9519a949
Author: chanruida <vruc@users.noreply.github.com>
Date:   Fri Oct 11 15:48:03 2019 +0000

    Update schema-understand.md (#5233)
    
    fix full-width  to half-width "

 site2/docs/schema-understand.md | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 47d877f43e6a774e9bc628e975be89e3d0ae54c4
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Oct 11 10:09:03 2019 +0800

    Add *Rabbit sink connector guide* (#5290)

 site2/docs/io-rabbitmq-sink.md | 80 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 80 insertions(+)

commit daa546d92e2a4e22acaf98a9cf9c48a6fc057269
Author: lipenghui <penghui@apache.org>
Date:   Thu Oct 10 23:31:49 2019 +0800

    Not allow use acknowledgeCumulative on Key_shared subscription. (#5339)
    
    * Not allow use acknowledgeCumulative on Key_shared subscription.
    
    * fix comments
    
    * C++ Client add acknowledgeCumulative not allowed check.

 .../client/api/KeySharedSubscriptionTest.java      | 27 +++++++++++
 pulsar-client-cpp/include/pulsar/Result.h          |  2 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  8 ++++
 pulsar-client-cpp/lib/ConsumerImpl.h               |  1 +
 pulsar-client-cpp/lib/Result.cc                    |  3 ++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 55 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  4 +-
 7 files changed, 98 insertions(+), 2 deletions(-)

commit 5c4c7b727bd4119bf0d42094cb408498ec656008
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Oct 10 23:03:59 2019 +0800

    [Doc] Add *Kinesis source connector guide* (#5211)
    
    * Add *Kinesis source connector guide*
    
    * update
    
    * Update

 site2/docs/io-kinesis-source.md | 92 +++++++++++++++++++++++++++--------------
 1 file changed, 62 insertions(+), 30 deletions(-)

commit 3e70d365fbef6d219bec2386afa8f962b6cd12fb
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Oct 10 16:00:11 2019 +0100

    [TIEREDSTORAGE] Don't require both region and endpoint to be specified (#5355)
    
    There's a bug in how user metadata is attached to a block that if the
    user doesn't specify both the region and the endpoint, offloading will
    throw an exception, as you can't add a null value to an immutable
    map.
    
    This change elides null to the empty string in these cases, so that
    offloading can continue.

 .../org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java     | 1 +
 .../mledger/offload/jcloud/impl/BlobStoreManagedLedgerOffloader.java  | 4 ++--
 2 files changed, 3 insertions(+), 2 deletions(-)

commit dbd48ab177c42870dcd957198f69d245e15e46ec
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Thu Oct 10 20:17:25 2019 +0900

    Fix bad_weak_ptr error when closing producer (#5315)
    
    Master Issue: #5234
    
    ### Motivation
    
    The other day, I fixed a memory leak caused by not being executed the destructor of C++ producer in #5246. However, when running a producer application written in Go in an environment with the modified C++ client library installed, the program occasionally crashes due to a "bad_weak_ptr" error.
    
    ```
    2019/10/01 16:34:30.210 c_client.go:68: [info] INFO  | ProducerImpl:481 | [persistent://massakam/global/test/t1, dc1-904-1012912] Closing producer for topic persistent://massakam/global/test/t1
    2019/10/01 16:34:30.211 c_client.go:68: [info] INFO  | ProducerImpl:463 | Producer - [persistent://massakam/global/test/t1, dc1-904-1012912] , [batchMessageContainer = { BatchContainer [size = 0] [batchSizeInBytes_ = 0] [maxAllowedMessageBatchSizeInBytes_ = 131072] [maxAllowedNumMessagesInBatch_ = 1000] [topicName = persistent://massakam/global/test/t1] [producerName_ = dc1-904-1012912] [batchSizeInBytes_ = 0] [numberOfBatchesSent = 1] [averageBatchSize = 1]}]
    2019/10/01 16:34:30.211 c_client.go:68: [info] INFO  | BatchMessageContainer:171 | [numberOfBatchesSent = 1] [averageBatchSize = 1]
    terminate called after throwing an instance of 'std::bad_weak_ptr'
      what():  2019/10/01 16:34:30.211 c_client.go:68: [info] INFO  | ProducerImpl:463 | Producer - [persistent://massakam/global/test/t1, dc1-904-1012911] , [batchMessageContainer = { BatchContainer [size = 0] [batchSizeInBytes_ = 0] [maxAllowedMessageBatchSizeInBytes_ = 131072] [maxAllowedNumMessagesInBatch_ = 1000] [topicName = persistent://massakam/global/test/t1] [producerName_ = dc1-904-1012911] [batchSizeInBytes_ = 0] [numberOfBatchesSent = 1] [averageBatchSize = 1]}]
    bad_weak_ptr
    2019/10/01 16:34:30.211 c_client.go:68: [info] INFO  | BatchMessageContainer:171 | [numberOfBatchesSent = 1] [averageBatchSize = 1]
    2019/10/01 16:34:30.211 c_client.go:68: [info] INFO  | ProducerImpl:463 | Producer - [persistent://massakam/global/test/t1, dc1-904-1012910] , [batchMessageContainer = { BatchContainer [size = 0] [batchSizeInBytes_ = 0] [maxAllowedMessageBatchSizeInBytes_ = 131072] [maxAllowedNumMessagesInBatch_ = 1000] [topicName = persistent://massakam/global/test/t1] [producerName_ = dc1-904-1012910] [batchSizeInBytes_ = 0] [numberOfBatchesSent = 1] [averageBatchSize = 1]}]
    SIGABRT: abort
    PC=0x7fc78d39d2c7 m=0 sigcode=18446744073709551610
    ```
    
    As a result of the investigation, I found that the destructor was called before the process of closing `ProducerImpl` was completed, and the object was destroyed.
    
    ### Modifications
    
    To keep the `ProducerImpl` object alive, get its own shared pointer at the beginning of `ProducerImpl::closeAsync()`. And the pointer must be passed to `ProducerImpl::handleClose()`. Otherwise, the object will be destroyed before `handleClose()` is called.
    
    So far, this issue has not been reproduced in `ConsumerImpl`, but I fixed it in the same way as `ProducerImpl`.

 pulsar-client-cpp/lib/ConsumerImpl.cc | 10 +++++++---
 pulsar-client-cpp/lib/ConsumerImpl.h  |  2 +-
 pulsar-client-cpp/lib/ProducerImpl.cc | 25 +++++++++++++++++--------
 pulsar-client-cpp/lib/ProducerImpl.h  |  2 +-
 4 files changed, 26 insertions(+), 13 deletions(-)

commit e8adb0aa5a524c1eddda7607ab979192f293cfc2
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Oct 10 04:16:27 2019 -0700

    Build python 37 artifacts and use them for the docker image (#5335)

 docker/pulsar/Dockerfile                                 | 16 +++++-----------
 docker/pulsar/pom.xml                                    |  4 ++--
 ...l-pulsar-client-35.sh => install-pulsar-client-37.sh} |  4 ++--
 3 files changed, 9 insertions(+), 15 deletions(-)

commit 0d0af45e7b385456c2219558bcdb7f3cda6f7d54
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Oct 10 19:15:27 2019 +0800

    [Docs] Add putstate, set-replicator-dispatch-rate and get-replicator-dispatch-rate cli docs for pulsar admin (#5338)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    ### Motivation
    
    In [pulsar-admin](https://pulsar.apache.org/docs/en/pulsar-admin), we have not listed the document information related to the `putstate`, `set-replicator-dispatch-rate` and `get-replicator-dispatch-rate`command.
    
    ### Modifications
    
    *Describe the modifications you've done.*
    
    Add `putstate` command for **pulsar-admin functions**.
    Add `set-replicator-dispatch-rate` command for **pulsar-admin namespaces**.
    Add `get-replicator-dispatch-rate` command for **pulsar-admin namespaces**.

 site2/docs/reference-pulsar-admin.md | 43 ++++++++++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)

commit 1611470488aa53bec5646e5c19c782b8c8cfb5eb
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Oct 10 11:47:51 2019 +0800

    [Doc] Add *HDFS2 sink connector guide* (#5226)
    
    * Add *HDFS2 sink connector guide*
    
    * Update
    
    * Update

 site2/docs/io-connectors.md |  4 ++--
 site2/docs/io-hdfs.md       | 26 ----------------------
 site2/docs/io-hdfs2-sink.md | 53 +++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 55 insertions(+), 28 deletions(-)

commit 5df64881624c09d837ec86c3f77644ac6e9e9e6e
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu Oct 10 01:46:33 2019 +0900

    Use Buffered channels to avoid blocking on callback (#5336)

 pulsar-client-go/pulsar/c_client.go   | 14 +++++++-------
 pulsar-client-go/pulsar/c_consumer.go |  6 +++---
 pulsar-client-go/pulsar/c_producer.go |  6 +++---
 pulsar-client-go/pulsar/c_reader.go   |  2 +-
 4 files changed, 14 insertions(+), 14 deletions(-)

commit db15d3213cc58499457faadec5fd55fcc9a6851a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 9 00:49:32 2019 -0700

    Added basic metadata store API and initial ZK implementation (#5330)

 pom.xml                                            |   1 +
 pulsar-metadata/pom.xml                            |  51 +++++
 .../org/apache/pulsar/metadata/api/GetResult.java  |  38 ++++
 .../apache/pulsar/metadata/api/MetadataStore.java  | 111 +++++++++
 .../pulsar/metadata/api/MetadataStoreConfig.java   |  42 ++++
 .../metadata/api/MetadataStoreException.java       |  49 ++++
 .../pulsar/metadata/api/MetadataStoreFactory.java  |  46 ++++
 .../java/org/apache/pulsar/metadata/api/Stat.java  |  42 ++++
 .../metadata/impl/zookeeper/ZKMetadataStore.java   | 251 +++++++++++++++++++++
 .../apache/pulsar/metadata/MetadataStoreTest.java  | 250 ++++++++++++++++++++
 .../org/apache/pulsar/metadata/TestZKServer.java   | 119 ++++++++++
 11 files changed, 1000 insertions(+)

commit 136048c0a2100550bcc55d29e5ffef6bb99709ee
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Wed Oct 9 16:48:35 2019 +0900

    If cursor is not durable, close dispatcher when all consumers are removed from subscription (#5340)
    
    ### Motivation
    
    If cursor is not durable, the subscription is closed and removed from the topic when all consumers are removed.
    https://github.com/apache/pulsar/blob/413ba03050036a620fa346456ef6c3ff6071e9ab/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentSubscription.java#L237-L254
    
    As mentioned in #5288, the dispatcher also needs to be closed at this time. Otherwise, `RateLimiter` instances will not be garbage collected, causing a memory leak.

 .../service/persistent/PersistentSubscription.java | 17 ++++++++++++++-
 .../pulsar/broker/service/PersistentTopicTest.java | 24 ++++++++++++++++++++++
 2 files changed, 40 insertions(+), 1 deletion(-)

commit 5426c5a42dba9b55bb26dac6e19177d707f8ac79
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 8 18:53:14 2019 -0700

    Avoid exiting on OOM in uni tests (#5343)

 pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit 71cfe3a6e0b8c21da714902a07722afa96036a17
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 8 08:51:37 2019 -0700

    Ensure the handling of PartitionMetadataRequest is async end-to-end (#5307)
    
    * Ensure the handling of PartitionMetadataRequest is async end-to-end
    
    * Fixed z-node path

 .../apache/pulsar/broker/ServiceConfiguration.java |  18 +++
 .../broker/cache/ConfigurationCacheService.java    |  12 +-
 .../apache/pulsar/broker/admin/AdminResource.java  | 147 ++-------------------
 .../broker/admin/impl/PersistentTopicsBase.java    |   7 +-
 .../broker/cache/LocalZooKeeperCacheService.java   |   4 +
 .../pulsar/broker/namespace/NamespaceService.java  |  67 ++++++----
 .../pulsar/broker/service/BrokerService.java       |  74 +++++++++++
 .../apache/pulsar/broker/service/ServerCnx.java    |  61 ++++-----
 8 files changed, 189 insertions(+), 201 deletions(-)

commit fa6676a5a89a0a692b9e439783f9520c3449ebd4
Author: Keven Li <liyi.changde@gmail.com>
Date:   Tue Oct 8 23:49:19 2019 +0800

    to fix syntax err in the sample code: 'Close operations can also be asynchronous' (#5295)
    
    Signed-off-by: KevenYLi <liyi.changde@gmail.com>

 site2/docs/client-libraries-java.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 094ebf7af8d0bb27bd9df3bcea2dba4e9ba204fc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Oct 8 08:48:49 2019 -0700

    Fix instability in Pulsar Function window integration test (#5337)
    
    * fix instability with tumbling window test
    
    * cleaning up
    
    * cleaning up

 .../integration/functions/PulsarFunctionsTest.java | 47 ++++++++++++++--------
 .../tests/integration/suites/PulsarTestSuite.java  | 24 +++++++++--
 2 files changed, 50 insertions(+), 21 deletions(-)

commit 87aa78bac5bdb43c0705a6b7d244ae5c26c57aaf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 8 08:48:18 2019 -0700

    [pulsar-broker] Disable stickyRead by default (#5321)

 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 60abcaa96508fcf9faeeeff30266ff82e9f51390
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Oct 8 08:48:09 2019 -0700

    Fix bk write failure part 2 (#5322)
    
    * Bug in Message Deduplication that may cause incorrect behavior
    
    * add tests
    
    * fix error message
    
    * fix client backoff
    
    * fix tests
    
    * cleaning up
    
    * Fix handling of BK write failures for message dedup
    
    * tests and clean up
    
    * refactoring code
    
    * fixing bugs
    
    * addressing comments
    
    * add missing license header
    
    * Improve error handling of BK write failures
    
    * fixing tests
    
    * fixing bugs
    
    * cleaning up
    
    * addressing comments
    
    * fixing tests

 .../apache/bookkeeper/mledger/ManagedLedger.java   |   5 +
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  42 +++---
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |   2 +-
 .../mledger/impl/ManagedLedgerErrorsTest.java      |  47 ++-----
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |   1 +
 .../broker/service/persistent/PersistentTopic.java |   9 +-
 .../client/api/ClientDeduplicationFailureTest.java | 146 ++++++++++++++++++++-
 7 files changed, 189 insertions(+), 63 deletions(-)

commit 6208a2bd3772a27e35a6b64995bb6c0e8861acc7
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 8 08:47:58 2019 -0700

    Fix ConsumerRedeliveryTest by ensure clean state on each run (#5329)

 .../apache/pulsar/client/api/ConsumerRedeliveryTest.java | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

commit 252c739f90b8ce52039615827b7e50666ea07f09
Author: vicaya <vicaya@users.noreply.github.com>
Date:   Tue Oct 8 07:40:56 2019 -0700

    Fix resource usage percent display (#5301)

 .../org/apache/pulsar/broker/loadbalance/impl/OverloadShedder.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit ea172b92f0ecebba4dcfa742bc66fc8c21cafcfa
Author: Bruno Bonnin <bbonnin@gmail.com>
Date:   Tue Oct 8 12:09:09 2019 +0200

    (functions) Add log level in a property for log topic.

 .../main/java/org/apache/pulsar/functions/instance/LogAppender.java  | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit d7012aeb3914c6be55131cf2f01c7941c8a29ea6
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 7 20:01:23 2019 -0700

    Collect broker publish latency in prometheus (#5319)

 .../pulsar/broker/service/AbstractTopic.java       |  18 ++-
 .../pulsar/broker/service/BrokerService.java       |   3 +
 .../org/apache/pulsar/broker/service/Producer.java |   2 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   9 +-
 .../metrics/DataSketchesSummaryLogger.java         | 125 ++++++++++++++++++++
 .../broker/stats/prometheus/metrics/Summary.java   | 131 +++++++++++++++++++++
 6 files changed, 280 insertions(+), 8 deletions(-)

commit 21e2b52e2d2b53602a3fca5e712de70edfc60a5d
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Oct 7 13:01:47 2019 -0700

    Fix Cmake to build _pulsar for osx (#5263)

 pulsar-client-cpp/CMakeLists.txt | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 7b06d3a48da41ad54c25a911da19d94a7a4d6b43
Author: Sergii Zhevzhyk <vzhikserg@users.noreply.github.com>
Date:   Mon Oct 7 17:41:45 2019 +0200

    [doc] Fix broken links to the info about schemas and Schema Registry (#5205)
    
    * Fix broken links to the info about schemas and Schema Registry
    
    * Fix broken links to the info about schemas and Schema Registry in the 2.4.1 version

 site2/docs/client-libraries-java.md                                 | 2 +-
 site2/docs/concepts-messaging.md                                    | 2 +-
 site2/docs/concepts-overview.md                                     | 1 -
 site2/docs/sql-overview.md                                          | 2 +-
 site2/website/versioned_docs/version-2.4.1/client-libraries-java.md | 2 +-
 site2/website/versioned_docs/version-2.4.1/concepts-messaging.md    | 2 +-
 6 files changed, 5 insertions(+), 6 deletions(-)

commit e1357a7d1ae6a51dfa742986a4a2afe33beb0256
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 7 08:41:12 2019 -0700

    [pulsar-broker] fix ns-isolation api to fetch policy for specific broker (#5314)

 .../org/apache/pulsar/broker/admin/impl/ClustersBase.java | 15 ++++-----------
 .../policies/data/BrokerNamespaceIsolationData.java       | 12 ++++++++++++
 2 files changed, 16 insertions(+), 11 deletions(-)

commit de233d4e370149e8a8135d6d426e374baafd957d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 7 08:40:30 2019 -0700

    [pulsar-cli] fix ns-isolation-policy api output (#5313)

 .../src/main/java/org/apache/pulsar/admin/cli/CliCommand.java  | 10 +---------
 .../java/org/apache/pulsar/admin/cli/CmdFunctionWorker.java    |  6 +++---
 2 files changed, 4 insertions(+), 12 deletions(-)

commit e8403754122786be26a71c823c4c1625a4524a01
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 7 08:38:51 2019 -0700

    Fixed race condition while triggering message redelivery after an ack-timeout event (#5276)

 .../org/apache/pulsar/broker/service/Consumer.java | 30 ++++++++++++++--------
 1 file changed, 19 insertions(+), 11 deletions(-)

commit e5ded1b98f0d9669cfa5df0ffe2e0363faab9d14
Author: Bruno Bonnin <bbonnin@gmail.com>
Date:   Sun Oct 6 02:40:14 2019 +0200

    Add a source connector for MongoDB (#5316)
    
    * Add a source connector for MongoDB
    
    * Fix expected license header

 pulsar-io/mongo/pom.xml                            |   6 +-
 .../org/apache/pulsar/io/mongodb/MongoConfig.java  |  29 ++--
 .../org/apache/pulsar/io/mongodb/MongoSink.java    |  24 ++-
 .../org/apache/pulsar/io/mongodb/MongoSource.java  | 167 +++++++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |   3 +-
 .../apache/pulsar/io/mongodb/MongoConfigTest.java  |   6 +-
 .../apache/pulsar/io/mongodb/MongoSourceTest.java  | 129 ++++++++++++++++
 7 files changed, 330 insertions(+), 34 deletions(-)

commit 56bca161f7c981bfa6023382ff68b7b689171066
Author: Poule Dodue <745437+pouledodue@users.noreply.github.com>
Date:   Sat Oct 5 10:16:18 2019 -0400

    Update deploy-kubernetes.md (#5323)
    
    * Update deploy-kubernetes.md
    
    Be clear that P4r is not bound to a specific K8s version
    
    * Update deploy-kubernetes.md
    
    be more clear

 site2/docs/deploy-kubernetes.md | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 36f867e01c7da20d3fbcf21f97c46d0b8261ea47
Author: k2la <mzq6mft9zz@gmail.com>
Date:   Sat Oct 5 22:53:31 2019 +0900

    fix typo in metrics (#5299)

 .../java/org/apache/pulsar/broker/stats/prometheus/TopicStats.java    | 4 ++--
 site2/docs/reference-metrics.md                                       | 4 ++--
 site2/website/versioned_docs/version-2.4.1/reference-metrics.md       | 4 ++--
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 8e95f438acce495688f6e99f1e3034da572eab07
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Oct 4 20:43:02 2019 -0700

    Improve error handling logic for effectively once (#5271)
    
    * Bug in Message Deduplication that may cause incorrect behavior
    
    * add tests
    
    * fix error message
    
    * fix client backoff
    
    * fix tests
    
    * cleaning up
    
    * Fix handling of BK write failures for message dedup
    
    * tests and clean up
    
    * refactoring code
    
    * fixing bugs
    
    * addressing comments
    
    * add missing license header

 .../service/persistent/MessageDeduplication.java   |  34 ++-
 .../broker/service/persistent/PersistentTopic.java | 125 ++++++---
 .../service/persistent/MessageDuplicationTest.java | 180 ++++++++++++-
 .../client/api/ClientDeduplicationFailureTest.java | 278 +++++++++++++++++++++
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |  37 ++-
 5 files changed, 602 insertions(+), 52 deletions(-)

commit 3fa58320650809f39df741755e06702674e3f731
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Oct 4 20:25:00 2019 -0700

    Fix Cmake files for windows compilation (#5303)
    
    * Fix Cmake files for windows compilation
    
    Add import <string> to schema.h for msvc
    
    * Refactor if condition

 pulsar-client-cpp/CMakeLists.txt          | 13 ++++++++++++-
 pulsar-client-cpp/include/pulsar/Schema.h |  1 +
 2 files changed, 13 insertions(+), 1 deletion(-)

commit c9d5a9f4f0641a07f228d0cc27c7bcca0bb22185
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sat Oct 5 03:50:46 2019 +0800

    [Doc] Add *Redis sink connector guide* (#5291)
    
    * Add *Redis sink connector guide*
    
    * Update

 site2/docs/io-connectors.md |  2 +-
 site2/docs/io-redis-sink.md | 69 +++++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-redis.md      | 27 ------------------
 3 files changed, 70 insertions(+), 28 deletions(-)

commit a4c14cdfd9071bf9b9fa18d86b5473b1f918de1c
Author: Grant Wu <grantwwu@gmail.com>
Date:   Fri Oct 4 15:45:58 2019 -0400

    Rewrite portions of retention/message expiry cookbook (#4780)
    
    - Make sure terminology is precise
    - Clarify that each subscription has a backlog
    - Clarify how retention interacts with readers

 site2/docs/cookbooks-retention-expiry.md | 38 +++++++++++++++++++-------------
 1 file changed, 23 insertions(+), 15 deletions(-)

commit 962973fb66aa573afe75a646df911a6a85570bf8
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 4 12:44:13 2019 -0700

    Revert default topic type to non-partitioned (#5308)

 conf/broker.conf                                                        | 2 +-
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 3890c8a3c6cb97cc450dc40a8d4a9b6d30322ab2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 3 16:21:47 2019 -0700

    [pulsar-broker] support update partition for global topic (#5306)

 .../apache/pulsar/broker/admin/AdminResource.java  |  6 +-
 .../broker/admin/impl/PersistentTopicsBase.java    | 71 ++++++++++++++++++++--
 .../pulsar/broker/admin/v1/PersistentTopics.java   |  3 +-
 .../pulsar/broker/admin/v2/PersistentTopics.java   |  3 +-
 .../pulsar/broker/service/BrokerService.java       | 51 ++++++++++++++++
 .../pulsar/broker/service/ReplicatorTest.java      | 66 ++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Topics.java     | 18 ++++++
 .../pulsar/client/admin/internal/TopicsImpl.java   | 13 +++-
 8 files changed, 221 insertions(+), 10 deletions(-)

commit dc95abf4246c52d9ddb74e7d33a8074bbfc90786
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 3 09:43:35 2019 -0700

    [pulsar-broker] Fix: invalidate cache on zk-cache timeout (#5298)
    
    * [pulsar-broker] Fix: invalidate cache on zk-cache timeout
    
    * add test
    
    * fix test

 .../pulsar/zookeeper/ZooKeeperDataCache.java       |  8 ++-
 .../pulsar/zookeeper/ZookeeperCacheTest.java       | 65 ++++++++++++++++++++++
 2 files changed, 72 insertions(+), 1 deletion(-)

commit ab8db2d48f1358ffab1a1df6b35a29bf858267ff
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 3 09:31:15 2019 -0700

    [pulsar-proxy] add debug log + fix thread-factory name (#5302)
    
    ### Motivation
    We are debugging issue where client is timing out lookup request and it helps to have debug log for successful lookup response. and fix thread-factory name for proxy.

 .../java/org/apache/pulsar/proxy/server/LookupProxyHandler.java    | 7 +++++--
 .../src/main/java/org/apache/pulsar/proxy/server/ProxyService.java | 4 ++--
 2 files changed, 7 insertions(+), 4 deletions(-)

commit 6542c65a9a2bb09ede136ef4c479c6fcaa0cf6f6
Author: lipenghui <penghui@apache.org>
Date:   Thu Oct 3 00:56:56 2019 +0800

    Expose bookkeeperDiskWeightBasedPlacementEnabled in broker.conf (#5254)
    
    ### Motivation
    
    Allow users to enable bookkeeper DiskWeightBasedPlacement in broker.conf

 conf/broker.conf                                                 | 3 +++
 conf/standalone.conf                                             | 2 ++
 .../main/java/org/apache/pulsar/broker/ServiceConfiguration.java | 3 +++
 .../common/configuration/PulsarConfigurationLoaderTest.java      | 2 ++
 .../org/apache/pulsar/broker/BookKeeperClientFactoryImpl.java    | 5 ++++-
 .../apache/pulsar/broker/BookKeeperClientFactoryImplTest.java    | 9 +++++++++
 6 files changed, 23 insertions(+), 1 deletion(-)

commit 2ed17a633bac90217990a4a3d465733514eae11f
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Oct 3 00:55:57 2019 +0800

    [Doc] Add *MongoDB sink connector guide* (#5289)
    
    Fix https://github.com/apache/pulsar/issues/5015

 site2/docs/io-connectors.md |  2 +-
 site2/docs/io-mongo-sink.md | 51 +++++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-mongo.md      | 20 ------------------
 3 files changed, 52 insertions(+), 21 deletions(-)

commit 7bee3ed5fd50353f36987de65e439069ab5de9ce
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Oct 3 00:55:11 2019 +0800

    [Doc] Add *Solr sink connector guide* (#5292)
    
    Fix https://github.com/apache/pulsar/issues/5015

 site2/docs/io-connectors.md |  2 +-
 site2/docs/io-solr-sink.md  | 60 +++++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-solr.md       | 21 ----------------
 3 files changed, 61 insertions(+), 22 deletions(-)

commit 20b8625da49e617af395dd700ec74bc815ca0a25
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 1 15:20:15 2019 -0700

    Don't attempt to append on read-only cursor ledger (#5297)
    
    * Don't attempt to append on read-only cursor ledger
    
    * Additionally, ensures the ledger is properly closed

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 31 +++++++++++++++++-----
 1 file changed, 25 insertions(+), 6 deletions(-)

commit 413ba03050036a620fa346456ef6c3ff6071e9ab
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Tue Oct 1 16:38:54 2019 +0900

    [pulsar-broker] Close previous dispatcher when subscription type changes (#5288)
    
    * Close previous dispatcher when subscription type changes
    
    * Use isClosed directly to check if dispatcher is closed

 .../AbstractDispatcherMultipleConsumers.java       |  4 +++
 .../AbstractDispatcherSingleActiveConsumer.java    |  4 +++
 .../apache/pulsar/broker/service/Dispatcher.java   |  2 ++
 .../nonpersistent/NonPersistentSubscription.java   | 15 ++++++++++
 .../service/persistent/PersistentSubscription.java | 15 ++++++++++
 .../pulsar/broker/service/PersistentTopicTest.java | 33 ++++++++++++++++++++++
 6 files changed, 73 insertions(+)

commit da04dbe3b28f7720b815c93130b8fbb420ca785c
Author: tomix1337 <tm.zammit@gmail.com>
Date:   Mon Sep 30 16:31:20 2019 +0200

    Update io-cdc-canal.md (#5266)
    
    * Update io-cdc-canal.md
    
    Fixed a couple of things:
    Pulsar 2.3.0 connectors gives a 404 error.
    pulsar-admin does not support a "sources" command, but a "source"/
    
    Updated version 2.4.1 to proper version.

 site2/docs/io-cdc-canal.md                                 | 4 ++--
 site2/website/versioned_docs/version-2.4.1/io-cdc-canal.md | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)

commit 45921c8bdd997c56cc48b94454080e0b23bc56a9
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sun Sep 29 14:27:55 2019 +0800

    Add *ElasticSearch sink connector guide* (#5258)

 site2/docs/io-connectors.md         |  2 +-
 site2/docs/io-elasticsearch-sink.md | 49 +++++++++++++++++++++++++++++++++++++
 site2/docs/io-elasticsearch.md      | 21 ----------------
 3 files changed, 50 insertions(+), 22 deletions(-)

commit 30d280d986d439ccc56c832e872b9fbf51ba9e88
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Sun Sep 29 12:52:43 2019 +0900

    Fix memory leak caused by not being executed ClientConnection destructor (#5286)

 pulsar-client-cpp/lib/ClientConnection.cc | 13 ++++++++++---
 pulsar-client-cpp/lib/ClientImpl.cc       |  1 +
 pulsar-client-cpp/lib/ConnectionPool.cc   |  2 +-
 pulsar-client-cpp/lib/ConnectionPool.h    |  2 +-
 4 files changed, 13 insertions(+), 5 deletions(-)

commit 87ccdb09731a9ace997c5da57122988bba92041a
Author: Addison Higham <addisonj@gmail.com>
Date:   Fri Sep 27 21:33:10 2019 -0600

    [kinesis-source] Improvements to kinesis-source (#5180)
    
    * Move to using the KCL v2
    
    This moves to using KCL v2 with the new API which supports
    "enhanced fan-out". Enhanced fan-out is beneficial as we get more
    guranteed capacity and it won't compete with other consumers.
    
    However, support for ehanced fan-out requires pulling in v2 of AWS SDKs.
    
    This isn't a huge problem, as they can be shared, but it does mean
    implemting a few shim APIs around credentials.
    
    Most of the business logic remains largely the same, just using the
    newer interfaces. Enhanced fan-out can also be disabled and fall back to
    a polling model.
    
    Note, this also bumps the kinesis-producer to v0.13, which moves to an
    APL license (but has no other changes) to make this nicer to use in
    an Apache project without license concerns.
    
    * Add included providers for kinesis auth
    
    This adds two providers for Kinesis auth. First, the
    AwsDefaultProviderChain, which just uses the default provider chain
    which will pull from env vars, system configuration files, and the
    metadata API.
    
    Second, the STSAssumeRole plugin allows us to assume a role (which first
    relies on the default provider chain) to run the code under a given role
    
    * add some docs and minor cleanup

 pulsar-io/kinesis/pom.xml                          |  25 ++-
 .../io/kinesis/AbstractKinesisConnector.java       |  27 +++-
 .../io/kinesis/AwsCredentialProviderPlugin.java    |  26 ++++
 .../io/kinesis/AwsDefaultProviderChainPlugin.java  |  47 ++++++
 .../pulsar/io/kinesis/BaseKinesisConfig.java       |  25 +--
 .../apache/pulsar/io/kinesis/KinesisRecord.java    |  30 ++--
 .../pulsar/io/kinesis/KinesisRecordProcessor.java  | 104 +++++++------
 .../io/kinesis/KinesisRecordProcessorFactory.java  |  11 +-
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |   4 +-
 .../apache/pulsar/io/kinesis/KinesisSource.java    |  92 +++++++----
 .../pulsar/io/kinesis/KinesisSourceConfig.java     | 169 +++++++++++++++------
 .../io/kinesis/STSAssumeRoleProviderPlugin.java    |  64 ++++++++
 .../apache/pulsar/io/kinesis/KinesisSinkTest.java  |  12 +-
 .../io/kinesis/KinesisSourceConfigTests.java       |   3 +-
 site2/docs/io-connectors.md                        |  14 +-
 site2/docs/io-kinesis-sink.md                      |  15 +-
 site2/docs/io-kinesis-source.md                    |  49 ++++++
 site2/docs/io-overview.md                          |   6 +-
 .../version-2.1.0-incubating/io-kinesis.md         |   3 +-
 19 files changed, 549 insertions(+), 177 deletions(-)

commit 07bb84532f3da80d1717c16f377fade16b8c4360
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Sep 27 08:42:11 2019 -0700

    Allow for topic deletions with regex consumers (#5230)
    
    * Allow for topic deletions with regex consumers
    
    * Fixed test compilation
    
    * One more compile fix
    
    * Fixed BrokerServiceAutoTopicCreationTest

 .../broker/service/BrokerServiceException.java     |   8 ++
 .../apache/pulsar/broker/service/ServerCnx.java    |  19 +++-
 .../apache/pulsar/client/impl/RawReaderImpl.java   |   3 +-
 .../BrokerServiceAutoTopicCreationTest.java        |   3 +
 .../client/impl/PatternTopicsConsumerImplTest.java |  49 ++++++++++
 .../pulsar/client/impl/TopicsConsumerImplTest.java |   2 +-
 .../pulsar/client/api/PulsarClientException.java   |  16 ++++
 .../org/apache/pulsar/client/cli/CmdConsume.java   |  44 ++++++---
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   2 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  46 +++++++---
 .../client/impl/MultiTopicsConsumerImpl.java       | 102 ++++++++++++++++-----
 .../impl/PatternMultiTopicsConsumerImpl.java       |   7 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   7 +-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   6 +-
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  |  13 +--
 .../pulsar/client/impl/ConsumerImplTest.java       |   4 +-
 .../client/impl/MultiTopicsConsumerImplTest.java   |   2 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  57 ++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |   8 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   9 +-
 20 files changed, 326 insertions(+), 81 deletions(-)

commit 23c76241c6fc4abeb5c1bd621efcfe124eeb0a0f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Sep 27 08:34:41 2019 -0700

    fix behavior when getting a key from functions state that doesn't exist (#5272)

 .../apache/pulsar/functions/instance/ContextImpl.java  |  2 +-
 .../functions/instance/state/StateContextImpl.java     | 18 +++++++++++-------
 .../functions/instance/state/StateContextImplTest.java | 12 ++++++++++++
 3 files changed, 24 insertions(+), 8 deletions(-)

commit d62fad04e2e7f2db6b88dd5249c810b05f453cb1
Author: lipenghui <penghui@apache.org>
Date:   Fri Sep 27 15:37:21 2019 +0800

    [Java-Client] Fix producer blocked after send an over size message while batch enabled #5282
    
    Master Issue: #5281
    
    ### Motivation
    
    Fix producer blocked after send an over size message while batch enabled
    
    ### Modifications
    
    Discard the batch message container while cause PulsarClientException.InvalidMessageException
    
    ### Verifying this change
    
    Added a unit test to verify the change

 .../pulsar/broker/service/BatchMessageTest.java    | 32 ++++++++++++++++++++--
 .../client/impl/BatchMessageContainerImpl.java     |  8 ++++--
 .../client/impl/BatchMessageKeyBasedContainer.java | 31 +++++++++++++++++++--
 3 files changed, 64 insertions(+), 7 deletions(-)

commit 8b6a3df1ceb66a80c44949e9278a05d8ef2e64a7
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Sep 27 14:23:50 2019 +0800

    [Issue 5134][docs] Add replicated subscription feature (#5267)
    
    * Add replicated subscription feature
    
    * update as per advice from merlimat
    
    * Update administration-geo.md

 site2/docs/administration-geo.md | 33 +++++++++++++++++++++++++++++++--
 1 file changed, 31 insertions(+), 2 deletions(-)

commit 7f1d5ec48b4f11de5e34a20bf7d2a5aa85e8bc03
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:42:16 2019 +0800

    [Doc] Add *Aerospike sink connector guide* (#5256)
    
    * Add *Aerospike sink connector guide*
    
    * Update
    
    * Update

 site2/docs/io-aerospike-sink.md | 25 +++++++++++++++++++++++++
 site2/docs/io-aerospike.md      | 21 ---------------------
 site2/docs/io-connectors.md     |  2 +-
 3 files changed, 26 insertions(+), 22 deletions(-)

commit 4f037e30f8acdd8ef84287d9e2f375fbead85e21
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:41:00 2019 +0800

    [Doc] Add *Kinesis sink connector guide*  (#5214)
    
    * Add *Kinesis sink connector guide*
    
    * Add *Kinesis sink connector guide*
    
    * Update

 site2/docs/io-connectors.md   |  4 +++-
 site2/docs/io-kinesis-sink.md | 54 +++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-kinesis.md      | 36 -----------------------------
 3 files changed, 57 insertions(+), 37 deletions(-)

commit aa98d029ad00995b2429d3ab93344d728f8c429a
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:40:47 2019 +0800

    [Doc] Add *processing guarantee for connector* (#5224)
    
    * Add *processing guarantee for connector*
    
    * Update
    
    * Update
    
    * Update

 site2/docs/io-overview.md | 97 ++++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 95 insertions(+), 2 deletions(-)

commit dfc04c6f590a2699c28ae77273bcbf7ddd2b2e37
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:40:22 2019 +0800

    [Doc] Add *Flume sink connector guide* (#5238)
    
    * Add *Flume sink connector*
    
    * Update
    
    * Update

 site2/docs/io-cdc.md          | 22 +++++++++----------
 site2/docs/io-flume-sink.md   | 51 +++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-flume-source.md | 44 +++++++++++++++++++++++++++++++------
 site2/website/sidebars.json   |  2 +-
 4 files changed, 99 insertions(+), 20 deletions(-)

commit dcfe04c17886fc54f071f2f573ab03db60df24fd
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:39:59 2019 +0800

    [Doc] Add *File source connector guide* (#5240)
    
    * Add *File source connector guide*
    
    * Update
    
    * add example

 site2/docs/io-connectors.md  |   2 +-
 site2/docs/io-file-source.md | 137 +++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-file.md        |  27 ---------
 3 files changed, 138 insertions(+), 28 deletions(-)

commit c29f6b7598eedcd2747ed8bdaa0b32d1f2378ac9
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:39:35 2019 +0800

    [Doc] Add configs for broker (#5250)
    
    * update
    
    * Update

 site2/docs/reference-configuration.md | 25 +++++++++++++------------
 1 file changed, 13 insertions(+), 12 deletions(-)

commit a55f74b8f0c5f329e0a4a6d631b63ecbb5d0a9b0
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:39:17 2019 +0800

    Add *Twitter Firehose source connector guide* (#5251)

 site2/docs/io-connectors.md     |  2 +-
 site2/docs/io-twitter-source.md | 27 +++++++++++++++++++++++++++
 site2/docs/io-twitter.md        | 24 ------------------------
 3 files changed, 28 insertions(+), 25 deletions(-)

commit 7632e81695c89fe84e6dc2b547db056f89772d67
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:38:48 2019 +0800

    [Doc] Add *Cassandra sink connector guide* (#5257)
    
    * Add *Cassandra sink connector guide*
    
    * Update

 site2/docs/io-cassandra-sink.md | 26 ++++++++++++++++++++++++++
 site2/docs/io-cassandra.md      | 22 ----------------------
 site2/docs/io-connectors.md     |  2 +-
 3 files changed, 27 insertions(+), 23 deletions(-)

commit a20d57d3c04faeabbdddc3c1e1c7c5e4b2da7c3c
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:38:19 2019 +0800

    Add *Rabbit source connector guide* (#5255)

 site2/docs/io-rabbitmq-source.md | 77 ++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-rabbitmq.md        | 54 ----------------------------
 2 files changed, 77 insertions(+), 54 deletions(-)

commit 0fac91c218bd1bdcce851bdd77111d8a2f4e0c12
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:36:13 2019 +0800

    [Doc] Add *InfluxDB sink connector guide* (#5273)
    
    * Add *InfluxDB sink connector guide*
    
    * update

 site2/docs/io-connectors.md    |  2 +-
 site2/docs/io-influxdb-sink.md | 61 ++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-influxdb.md      | 25 -----------------
 3 files changed, 62 insertions(+), 26 deletions(-)

commit ae384fd8dde84193b440fe752b72171b330054a4
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Sep 27 13:35:38 2019 +0800

    Add *JDBC sink connector guide* (#5275)

 site2/docs/io-connectors.md |  2 +-
 site2/docs/io-jdbc-sink.md  | 56 +++++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-jdbc.md       | 23 -------------------
 3 files changed, 57 insertions(+), 24 deletions(-)

commit 27bfd0945ee7506e7ab52148fc141d44a9d1505a
Author: lipenghui <penghui@apache.org>
Date:   Fri Sep 27 03:52:30 2019 +0800

    trim topic name (#5268)

 .../java/org/apache/pulsar/client/impl/ConsumerBuilderImpl.java     | 6 ++++--
 .../java/org/apache/pulsar/client/impl/ProducerBuilderImpl.java     | 2 +-
 .../main/java/org/apache/pulsar/client/impl/ReaderBuilderImpl.java  | 3 ++-
 3 files changed, 7 insertions(+), 4 deletions(-)

commit 416a042753528c62808506bb3fa5011382210303
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Sep 26 12:36:38 2019 -0700

    Reduce resources for integration tests (#5280)
    
    Fix minor issues

 .gitignore                                                |  1 +
 .../cli/{HealthcheckTest.java => HealthCheckTest.java}    | 15 ++++++++++-----
 .../tests/integration/containers/PulsarContainer.java     |  1 +
 .../tests/integration/functions/PulsarFunctionsTest.java  |  8 ++++++--
 .../integration/functions/PulsarFunctionsTestBase.java    |  2 +-
 .../integration/io/DebeziumPostgreSqlSourceTester.java    |  4 ++--
 .../pulsar/tests/integration/io/KafkaSourceTester.java    |  2 +-
 .../tests/integration/topologies/PulsarCluster.java       | 14 +++++++-------
 .../tests/integration/topologies/PulsarClusterSpec.java   |  2 +-
 .../tests/integration/upgrade/PulsarZKDowngradeTest.java  |  2 +-
 tests/integration/src/test/resources/pulsar-cli.xml       |  2 +-
 11 files changed, 32 insertions(+), 21 deletions(-)

commit 461d26d5b5fde8d84245d8aa2be64c65137284c3
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 20:06:13 2019 +0800

    [doc] Improve Pulsar Administration load-balance (#5265)
    
    * Update administration-load-balance.md
    
    * Update administration-load-balance.md
    
    * Update administration-load-balance.md
    
    * Update administration-load-balance.md

 site2/docs/administration-load-balance.md | 119 +++++++++++-------------------
 1 file changed, 43 insertions(+), 76 deletions(-)

commit 61c0139405afeb0a990efa6e9320a5f96a51f33b
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 14:14:54 2019 +0800

    [doc] Improve Pulsar Administration Upgrade  (#5237)
    
    * Update administration-upgrade.md
    
    * Update administration-upgrade.md

 site2/docs/administration-upgrade.md | 42 +++++++++++++++++-------------------
 1 file changed, 20 insertions(+), 22 deletions(-)

commit 9f52a384bf3a743e602b7f61d73219da795510e2
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 14:14:02 2019 +0800

    [doc] Improve Pulsar Administration Pulsar proxy (#5236)
    
    * Update administration-proxy.md
    
    * Update administration-proxy.md

 site2/docs/administration-proxy.md | 42 +++++++++++++++++++-------------------
 1 file changed, 21 insertions(+), 21 deletions(-)

commit 3301593f24a9fe4741fb54465decb2cb29c8a506
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 14:13:30 2019 +0800

    [doc] Improve Pulsar Administration Pulsar Statistics (#5225)
    
    * Update administration-stats.md
    
    * Update administration-stats.md
    
    * Update administration-stats.md

 site2/docs/administration-stats.md | 94 +++++++++++++++++++-------------------
 1 file changed, 47 insertions(+), 47 deletions(-)

commit 634d64f9e629b4740800a641b1c0b9cdd7f63187
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 14:13:09 2019 +0800

    [doc] Improve Pulsar Administration Pulsar dashboard (#5221)
    
    * Update administration-dashboard.md
    
    * Update administration-dashboard.md

 site2/docs/administration-dashboard.md | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 9252118a6043e576d57529d1aed4908760e86d6f
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 14:12:49 2019 +0800

    Update administration-geo.md (#5219)

 site2/docs/administration-geo.md | 58 ++++++++++++++++++++--------------------
 1 file changed, 29 insertions(+), 29 deletions(-)

commit 9d5236777ee44e666aefcbcdc118cfc51f93a826
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 26 14:11:23 2019 +0800

    Update administration-zk-bk.md (#5213)

 site2/docs/administration-zk-bk.md | 120 +++++++++++++++++--------------------
 1 file changed, 56 insertions(+), 64 deletions(-)

commit 806eab54c5089c9e4dcc0365a800694111e060d2
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 25 21:01:59 2019 -0700

    Removed managed-ledger-shaded artifact (#4200)
    
    * Removed managed-ledger-shaded artifact
    
    * Fixed dep artifact renaming error

 distribution/offloaders/pom.xml                    |   2 +-
 managed-ledger-shaded/pom.xml                      | 295 ---------------------
 managed-ledger/pom.xml                             |   2 +-
 pom.xml                                            |   1 -
 pulsar-broker-auth-athenz/pom.xml                  |   2 +-
 pulsar-broker-auth-sasl/pom.xml                    |   2 +-
 pulsar-broker/pom.xml                              |   6 +-
 .../pulsar-client-kafka-tests/pom.xml              |   2 +-
 .../pulsar-client-kafka-tests_0_8/pom.xml          |   6 +-
 .../pulsar-client-kafka-tests_0_9/pom.xml          |   2 +-
 .../pulsar-client-kafka_0_8/pom.xml                |  24 +-
 pulsar-client-tools-test/pom.xml                   |   2 +-
 pulsar-discovery-service/pom.xml                   |   4 +-
 pulsar-io/debezium/core/pom.xml                    |   2 +-
 pulsar-io/kafka-connect-adaptor/pom.xml            |   2 +-
 pulsar-proxy/pom.xml                               |   2 +-
 pulsar-sql/presto-pulsar/pom.xml                   |   4 +-
 pulsar-testclient/pom.xml                          |   2 +-
 pulsar-websocket/pom.xml                           |   2 +-
 pulsar-zookeeper-utils/pom.xml                     |   6 +-
 tests/integration/pom.xml                          |   2 +-
 tests/pulsar-storm-test/pom.xml                    |   2 +-
 tiered-storage/file-system/pom.xml                 |   4 +-
 tiered-storage/jcloud/pom.xml                      |   4 +-
 24 files changed, 43 insertions(+), 339 deletions(-)

commit d43044117feffbe720295417ad7afadd0315ea98
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Thu Sep 26 00:31:46 2019 +0900

    [Issue #5234][pulsar-client-cpp] Fix memory leak caused by deadline_timer holding object reference (#5246)
    
    * Fix memory leak caused by deadline_timer holding object reference
    
    * Add ConnectionPool destructor
    
    * Do not reset executor_ in ClientConnection::close()
    
    * Make ConnectionPool have shared_ptr instead of weak_ptr to ClientConnection
    
    * Revert PoolMap type
    
    * Remove lock.unlock() from ~ConnectionPool()

 pulsar-client-cpp/lib/ClientConnection.cc |  3 +++
 pulsar-client-cpp/lib/ConnectionPool.cc   | 13 +++++++++++++
 pulsar-client-cpp/lib/ConnectionPool.h    |  2 ++
 pulsar-client-cpp/lib/ProducerImpl.cc     | 17 +++++++++++++----
 pulsar-client-cpp/lib/ProducerImpl.h      |  2 ++
 5 files changed, 33 insertions(+), 4 deletions(-)

commit ee42cf403349154483d66f60a2c6ae8dd8518280
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Sep 24 13:48:37 2019 -0700

    Fix client backoff (#5261)
    
    * fix client backoff
    
    * fix tests
    
    * cleaning up

 .../apache/pulsar/client/impl/RawReaderImpl.java   |  5 ++-
 .../org/apache/pulsar/client/impl/Backoff.java     | 32 +++--------------
 .../apache/pulsar/client/impl/BackoffBuilder.java  | 16 ++-------
 .../client/impl/BinaryProtoLookupService.java      |  2 --
 .../pulsar/client/impl/ClientBuilderImpl.java      |  2 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 42 ++++++----------------
 .../client/impl/MultiTopicsConsumerImpl.java       | 15 ++++----
 .../apache/pulsar/client/impl/ProducerImpl.java    |  6 ++--
 .../pulsar/client/impl/PulsarClientImpl.java       |  5 ++-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  5 +--
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  |  2 +-
 .../client/impl/conf/ClientConfigurationData.java  |  4 +--
 .../pulsar/client/impl/ConsumerImplTest.java       | 23 ++++++------
 .../java/org/apache/pulsar/storm/PulsarSpout.java  |  4 +--
 14 files changed, 49 insertions(+), 114 deletions(-)

commit b2bf4a71888d6ef0abb6ef68fdb566e7ae6e0f01
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Sep 25 00:41:42 2019 +0800

    Add *Netty source connector guide* (#5253)

 site2/docs/io-connectors.md   |   4 +-
 site2/docs/io-netty-source.md | 204 ++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-netty.md        | 147 ------------------------------
 3 files changed, 206 insertions(+), 149 deletions(-)

commit 16f30b411720448da4d4ec5cf9c76694c42bc036
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Sep 25 00:40:59 2019 +0800

    Add *HDFS3 sink connector guide* (#5239)

 site2/docs/io-hdfs3-sink.md | 53 +++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 53 insertions(+)

commit 6741bfe9e22971a1f4355b8a1908b42f1931901c
Author: Chris Bartholomew <c_bartholomew@yahoo.com>
Date:   Tue Sep 24 11:17:59 2019 -0500

    Broker fails to start with function worker enabled and broker client using TLS (#5151)
    
    * Fixing function worker running with broker when using TLS
    
    * Get function worker TLS config from function_worker.yml

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarBrokerStarter.java | 2 +-
 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 2ad58c4e3033db0c03f5dc5b265eef2425e65101
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Sep 24 08:40:37 2019 -0700

    Bug in Message Deduplication that may cause incorrect client/broker interaction (#5243)
    
    * Bug in Message Deduplication that may cause incorrect behavior
    
    * add tests
    
    * fix error message

 .../service/persistent/MessageDeduplication.java   |  41 +++++-
 .../broker/service/persistent/PersistentTopic.java |  16 ++-
 .../service/persistent/MessageDuplicationTest.java | 146 +++++++++++++++++++++
 3 files changed, 192 insertions(+), 11 deletions(-)

commit c728bd5722bfc385948c109caadfeee43d0cb3b2
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sun Sep 22 08:33:02 2019 +0800

    [Doc] Add *Kafka sink connector guide* (#5210)
    
    Fix https://github.com/apache/pulsar/issues/5015

 site2/docs/io-kafka-sink.md | 66 +++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 66 insertions(+)

commit 3af595150e0cb02e58533f575c7c2e95258be4a1
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sat Sep 21 12:52:22 2019 +0800

    [Doc] Add *Kafka source connector guide* (#5203)
    
    * Add *Kafka source connector guide*
    
    * Update
    
    * Update

 site2/docs/io-connectors.md   |   4 +-
 site2/docs/io-kafka-source.md | 170 ++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-kafka.md        |  44 -----------
 3 files changed, 172 insertions(+), 46 deletions(-)

commit 0bc952d0c65304929bc81ba8ec0c42a0c91e04d5
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 19 13:05:44 2019 -0700

    Fixed flaky tests in ReplicatorRateLimiterTest (#5207)

 .../pulsar/broker/service/ReplicatorRateLimiterTest.java       | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit eefe061c1ce4e378a4a1669a4c2a0027a4a1bf54
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Fri Sep 20 05:05:29 2019 +0900

    Fix error message when deleting topic failed (#5228)

 .../java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7e6396214f0d95581f1ae3b011cafd7611a14a0a
Author: Yuri Mizushima <equanz324@gmail.com>
Date:   Thu Sep 19 21:43:37 2019 +0900

    [Doc] Add Node.js Client Docs (#5212)
    
    ## Motivation
    Currently, There is no official document for [Node.js client](https://github.com/apache/pulsar-client-node).
    We want to find information about Node.js client from Official docs.
    
    ## Modifications
    Add Node.js client docs.
    
    ## Result
    We can find information about Node.js client.

 site2/docs/client-libraries-node.md       | 401 ++++++++++++++++++++++++++++++
 site2/docs/security-tls-authentication.md |  19 ++
 site2/docs/security-tls-transport.md      |  15 +-
 site2/website/sidebars.json               |   1 +
 4 files changed, 435 insertions(+), 1 deletion(-)

commit ac13009c5990d99fc935f7b83ad10d4c79772990
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Thu Sep 19 20:25:52 2019 +0800

    Modify the schema decode method can decode ByteBuf (#5123)

 .../pulsar/client/api/schema/SchemaReader.java     | 25 ++++++++-
 .../pulsar/client/impl/schema/AbstractSchema.java  | 64 ++++++++++++++++++++++
 .../pulsar/client/impl/schema/BooleanSchema.java   | 12 +++-
 .../pulsar/client/impl/schema/ByteBufSchema.java   | 12 +++-
 .../client/impl/schema/ByteBufferSchema.java       | 18 +++++-
 .../pulsar/client/impl/schema/ByteSchema.java      | 20 ++++++-
 .../pulsar/client/impl/schema/BytesSchema.java     | 16 +++++-
 .../pulsar/client/impl/schema/DateSchema.java      | 14 ++++-
 .../pulsar/client/impl/schema/DoubleSchema.java    | 27 ++++++++-
 .../pulsar/client/impl/schema/FloatSchema.java     | 26 ++++++++-
 .../pulsar/client/impl/schema/IntSchema.java       | 27 ++++++++-
 .../pulsar/client/impl/schema/LongSchema.java      | 26 ++++++++-
 .../pulsar/client/impl/schema/ShortSchema.java     | 26 ++++++++-
 .../pulsar/client/impl/schema/StringSchema.java    | 29 +++++++++-
 .../pulsar/client/impl/schema/StructSchema.java    | 22 +++++++-
 .../pulsar/client/impl/schema/TimeSchema.java      | 14 ++++-
 .../pulsar/client/impl/schema/TimestampSchema.java | 14 ++++-
 .../impl/schema/generic/GenericAvroReader.java     | 30 +++++++++-
 .../impl/schema/generic/GenericJsonReader.java     | 27 ++++++++-
 .../client/impl/schema/reader/AvroReader.java      | 32 ++++++++++-
 .../client/impl/schema/reader/JsonReader.java      | 24 +++++++-
 .../client/impl/schema/reader/ProtobufReader.java  | 26 ++++++++-
 .../pulsar/client/impl/schema/AvroSchemaTest.java  | 26 +++++++++
 .../client/impl/schema/BooleanSchemaTest.java      | 15 ++++-
 .../pulsar/client/impl/schema/BytesSchemaTest.java |  7 +++
 .../pulsar/client/impl/schema/DateSchemaTest.java  | 17 +++++-
 .../client/impl/schema/DoubleSchemaTest.java       | 13 ++++-
 .../pulsar/client/impl/schema/FloatSchemaTest.java | 17 +++++-
 .../pulsar/client/impl/schema/IntSchemaTest.java   | 15 ++++-
 .../pulsar/client/impl/schema/JSONSchemaTest.java  | 24 ++++++++
 .../pulsar/client/impl/schema/LongSchemaTest.java  | 17 +++++-
 .../client/impl/schema/PrimitiveSchemaTest.java    |  7 ++-
 .../client/impl/schema/ProtobufSchemaTest.java     | 16 ++++++
 .../pulsar/client/impl/schema/ShortSchemaTest.java | 15 ++++-
 .../client/impl/schema/StringSchemaTest.java       | 23 ++++++++
 .../pulsar/client/impl/schema/TimeSchemaTest.java  | 10 +++-
 .../client/impl/schema/TimestampSchemaTest.java    | 12 +++-
 37 files changed, 708 insertions(+), 57 deletions(-)

commit a4587d202cae48de5de3a9c59f397fb36ce7b2ad
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 19 20:23:45 2019 +0800

    [doc] Improve Pulsar deployment bare metal multi cluster (#5135)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Security document (deploy-bare-metal-multi-cluster section): http://pulsar.apache.org/docs/en/next/deploy-bare-metal-multi-cluster/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/deploy-bare-metal-multi-cluster.md | 185 ++++++++++++--------------
 1 file changed, 83 insertions(+), 102 deletions(-)

commit 0014f6ec64e08df74597628352cb4ce1b32fb9da
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 19 20:22:47 2019 +0800

    [Issue 5050][Docs] Adjust the content structure of the security chapter  (#5201)
    
    Fix #5050
    
    Duplicate with #5166
    
    ### Motivation
    
    add the corresponded reference content of 'JSON Web Token Authentication' link in the Security chapter of Pulsar document and adjust the directory structure of this chapter to make it more readable.
    
    ### Modifications
    
    Merge and rewrite the original two file security-token-client.md and security-token-admin.md into a new security-jwt.md which links to the list item "JSON Web Token Authentication" in the file security-overview.md; adjust the related content in security-overview and unify the sidebar title into a similar format as much as possible.

 site2/docs/security-jwt.md          | 240 ++++++++++++++++++++++++++++++++++++
 site2/docs/security-overview.md     |  21 ++--
 site2/docs/security-token-admin.md  | 152 -----------------------
 site2/docs/security-token-client.md | 122 ------------------
 site2/website/sidebars.json         |   3 +-
 5 files changed, 248 insertions(+), 290 deletions(-)

commit 0bc9dabd76420387c60600cf281fa6aeb5be7a16
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Sep 19 00:30:10 2019 +0800

    [Doc] Update *Debezium Connector Guide* (#5197)

 site2/docs/io-cdc-debezium.md | 370 ++++++++++++++++++++++++------------------
 1 file changed, 209 insertions(+), 161 deletions(-)

commit af1d0eadbd5082c95380d4f81f70c5d51b013385
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Sep 19 00:29:11 2019 +0800

    [Doc] Add configuration of Flume source connector (#5199)
    
    1. Currently, Pulsar does not have any explanations for Flume source and sink connectors. This PR adds configuration of Flume source connector.
    
    2. Fix https://github.com/apache/pulsar/issues/5015.

 site2/docs/io-flume-source.md | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)

commit 751563473852706d93edcbb5eb89bf3f69fc98a1
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 17 21:02:51 2019 -0700

    Ensure consumer background tasks are cancelled after subscribe failures (#5204)
    
    ### Motivation
    
    Some of the background consumer tasks are being started in the `ConsumerImpl` constructor though these are not being cancelled if the consumer creation fails, leaving active refs to these objects.

 .../apache/pulsar/client/impl/ConsumerImpl.java    | 27 +++++++++++-----------
 .../PersistentAcknowledgmentsGroupingTracker.java  |  2 +-
 2 files changed, 15 insertions(+), 14 deletions(-)

commit 871a1e028febc45742842754a801073a47d71698
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 17 17:30:50 2019 -0700

    Ensure getting list of topics for namespace is handled asynchronously (#5188)
    
    * Ensure getting list of topics for namespace is handled asynchrounously
    
    * Fixed mocked zk deadlock
    
    * Test fixes
    
    * Fixed mutex unlocking in mock-zookeeper create method
    
    * Fixed caching of empty values
    
    * Do async call in background
    
    * Fixed merge conflicts
    
    * Fixed broken import from shaded class

 .../java/org/apache/zookeeper/MockZooKeeper.java   |  81 ++++++-----
 .../org/apache/pulsar/broker/PulsarService.java    |   3 +-
 .../apache/pulsar/broker/admin/AdminResource.java  |   1 +
 .../pulsar/broker/admin/impl/NamespacesBase.java   |   6 +-
 .../broker/admin/impl/PersistentTopicsBase.java    |   3 +-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  20 ++-
 .../broker/admin/v1/NonPersistentTopics.java       |   1 +
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  32 ++--
 .../broker/admin/v2/NonPersistentTopics.java       |   1 +
 .../pulsar/broker/namespace/NamespaceService.java  |  60 ++++----
 .../apache/pulsar/broker/service/ServerCnx.java    |  36 ++---
 .../client/impl/PatternTopicsConsumerImplTest.java |   4 +-
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |   2 +-
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |   2 +-
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    | 161 +++++++++++++--------
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java   |  43 ++++--
 .../pulsar/zookeeper/ZookeeperCacheTest.java       |  23 +--
 17 files changed, 276 insertions(+), 203 deletions(-)

commit f3d37d0bf9f01011e0e1ccc306e61c8202da2073
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Tue Sep 17 22:02:41 2019 +0800

    [Doc] Update *Develop Connectors Guide* (#5181)

 site2/docs/io-develop.md | 278 ++++++++++++++++++++++++++---------------------
 1 file changed, 156 insertions(+), 122 deletions(-)

commit 547c4218124a6055a468152304d539d587071e2d
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Tue Sep 17 09:01:12 2019 -0500

    Add more config for auto-topic-creation (#4963)
    
    Master Issue:  #4926
    
    ### Motivation
    
    
    Curently the partitioned-topic and non-partitioned topic is a little confuse for users. in PR #3450 we add config for auto-topic-creation.
    We could leverage this config to provide some more config for auto-topic-creation.
    
    ### Modifications
    
    - Add `allowAutoTopicCreationType` and `allowAutoTopicCreationNumPartitions` to configuration.
    - Users can use both configurations when they decide to create a topic automatically.
    - Add test.
    - Update doc.

 conf/broker.conf                                   |   6 ++
 conf/standalone.conf                               |   9 ++
 .../apache/pulsar/broker/ServiceConfiguration.java |  13 ++-
 .../apache/pulsar/broker/admin/AdminResource.java  | 116 +++++++++++++++++++-
 .../pulsar/broker/admin/impl/BrokersBase.java      |   7 ++
 .../broker/admin/impl/PersistentTopicsBase.java    |  52 +++++----
 .../broker/admin/v1/NonPersistentTopics.java       |  18 +++-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |   5 +-
 .../broker/admin/v2/NonPersistentTopics.java       |  19 +++-
 .../pulsar/broker/admin/v2/PersistentTopics.java   |   6 +-
 .../pulsar/broker/admin/PersistentTopicsTest.java  |   6 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   1 +
 .../broker/service/BacklogQuotaManagerTest.java    |   1 +
 .../broker/service/BrokerBkEnsemblesTests.java     |   1 +
 .../broker/service/BrokerBookieIsolationTest.java  |   4 +
 .../BrokerServiceAutoTopicCreationTest.java        | 120 +++++++++++++++++++++
 .../pulsar/broker/service/ReplicatorTestBase.java  |   3 +
 .../pulsar/client/api/NonPersistentTopicTest.java  |   3 +
 .../client/api/SimpleProducerConsumerTest.java     |   4 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     |   4 +-
 .../worker/PulsarFunctionE2ESecurityTest.java      |   3 +-
 .../worker/PulsarFunctionLocalRunTest.java         |   3 +-
 .../worker/PulsarFunctionPublishTest.java          |   3 +-
 .../functions/worker/PulsarFunctionStateTest.java  |   3 +-
 .../worker/PulsarWorkerAssignmentTest.java         |   2 +-
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |   2 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   3 +-
 .../configurations/pulsar_broker_test.conf         |   3 +
 pulsar-client-cpp/test-conf/standalone-ssl.conf    |   9 ++
 pulsar-client-cpp/test-conf/standalone.conf        |   9 ++
 pulsar-client-cpp/tests/standalone.conf            |   9 ++
 .../pulsar/client/impl/HttpLookupService.java      |   3 +-
 .../pulsar/functions/worker/WorkerService.java     |   3 +
 site2/docs/reference-configuration.md              |   2 +
 .../pulsar/tests/integration/cli/CLITest.java      |   6 ++
 .../integration/functions/PulsarFunctionsTest.java |  27 ++++-
 36 files changed, 442 insertions(+), 46 deletions(-)

commit 6df8d400e9a0b2977f858b5ecfb9f4f9a838d0f8
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Tue Sep 17 22:00:14 2019 +0800

    [doc] Improve Pulsar deployment bare metal (#5111)
    
    Motivation
    
    Improve the language and the overall descriptive style of the Pulsar Security document (deploy-bare-metal section): http://pulsar.apache.org/docs/en/next/deploy-bare-metal/
    
    Modifications
    
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/deploy-bare-metal.md | 203 ++++++++++++++++++++--------------------
 1 file changed, 101 insertions(+), 102 deletions(-)

commit c8ddbdd113d1b67d2983eadd2cce2bf5f57c13fd
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Sep 17 21:59:22 2019 +0800

    [doc] Improve Pulsar multi-cluster deployment (#5167)
    
    ### Motivation
    
    Minor improvement of `deploy-bare-metal-multi-cluster.md`.

 site2/docs/deploy-bare-metal-multi-cluster.md | 72 +++++++++++++++++----------
 1 file changed, 46 insertions(+), 26 deletions(-)

commit 627e6f8c2d7a64911517247f15db4e48e3ad89ae
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Tue Sep 17 21:58:47 2019 +0800

    [Doc] Update Canal source connector guide (#5173)
    
    1. I've updated this guide based on `CanalSourceConfig.java` and `canal-mysql-source-config.yaml`.
    
    2. Fix https://github.com/apache/pulsar/issues/5015

 site2/docs/io-cdc-canal.md | 360 ++++++++++++++++++++++++---------------------
 1 file changed, 195 insertions(+), 165 deletions(-)

commit 26df3e7846ee4fa517f84ca38a6923250617d176
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Tue Sep 17 21:58:12 2019 +0800

    [Doc] Update *Overview of Connector* (#5183)
    
    Fix https://github.com/apache/pulsar/issues/5015

 site2/docs/io-overview.md | 48 ++++++++++++++++++++++++-----------------------
 1 file changed, 25 insertions(+), 23 deletions(-)

commit 94d691185d4a5c4606fc2e3d96376186e57a83f0
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Tue Sep 17 21:57:39 2019 +0800

    [Doc] Update *CDC connector guide* (#5198)
    
    Fix https://github.com/apache/pulsar/issues/5015#event-2577499721

 site2/docs/io-cdc.md | 29 ++++++++++++++++++++---------
 1 file changed, 20 insertions(+), 9 deletions(-)

commit f844507ad871d557e043ac20bb891fd0f9f86ff6
Author: BlackJohnny <BlackJohnny@users.noreply.github.com>
Date:   Tue Sep 17 06:51:39 2019 +0300

    Added missing enum value KeyShared on python wrapper (#5196)

 pulsar-client-cpp/python/src/enums.cc | 1 +
 1 file changed, 1 insertion(+)

commit b9e7bf3a828fd6f7f9d3a1eaaaebc1ca107b15f6
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Tue Sep 17 11:04:01 2019 +0900

    Make some member variables of Dispatcher volatile (#5193)

 .../broker/service/AbstractDispatcherMultipleConsumers.java       | 2 +-
 .../service/persistent/PersistentDispatcherMultipleConsumers.java | 8 ++++----
 .../persistent/PersistentDispatcherSingleActiveConsumer.java      | 4 ++--
 3 files changed, 7 insertions(+), 7 deletions(-)

commit 499069ea736ec99e532fb52819b7c8bd56c0348f
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Tue Sep 17 08:25:52 2019 +0900

    [pulsar-broker] Fix bug that message delivery stops after resetting cursor for failover subscription (#5185)
    
    ### Motivation
    
    Resetting the cursor for a subscription in Failover mode may cause message delivery to stop. This can be reproduced with the following procedure:
    
    1. Connect multiple consumers to a subscription in Failover mode
    1. Reset the subscription cursor to a past position
    1. Close some consumers
    1. The remaining consumers may not receive new messages from the topic
    
    At this time, the active consumer is already closed one:
    
    ```js
    "subscriptions" : {
      "sub1" : {
        "msgRateOut" : 0.0,
        "msgThroughputOut" : 0.0,
        "msgRateRedeliver" : 0.0,
        "msgBacklog" : 57604,
        "blockedSubscriptionOnUnackedMsgs" : false,
        "unackedMessages" : 0,
        "type" : "Failover",
        "activeConsumerName" : "04b6c", // This consumer is already closed!
        "msgRateExpired" : 0.0,
        "consumers" : [ {
          "msgRateOut" : 0.0,
          "msgThroughputOut" : 0.0,
          "msgRateRedeliver" : 0.0,
          "consumerName" : "06317b",
          "availablePermits" : 564,
          "unackedMessages" : 0,
          "blockedConsumerOnUnackedMsgs" : false,
          "metadata" : { },
          "connectedSince" : "2019-09-11T18:56:25.413+09:00",
          "clientVersion" : "2.3.2",
          "address" : "/xxx.xxx.xxx.xxx:36968"
        }, {
          "msgRateOut" : 0.0,
          "msgThroughputOut" : 0.0,
          "msgRateRedeliver" : 0.0,
          "consumerName" : "37edc",
          "availablePermits" : 1000,
          "unackedMessages" : 0,
          "blockedConsumerOnUnackedMsgs" : false,
          "metadata" : { },
          "connectedSince" : "2019-09-11T18:56:27.77+09:00",
          "clientVersion" : "2.3.2",
          "address" : "/xxx.xxx.xxx.xxx:38392"
        }, {
          "msgRateOut" : 0.0,
          "msgThroughputOut" : 0.0,
          "msgRateRedeliver" : 0.0,
          "consumerName" : "822f0",
          "availablePermits" : 1000,
          "unackedMessages" : 0,
          "blockedConsumerOnUnackedMsgs" : false,
          "metadata" : { },
          "connectedSince" : "2019-09-11T18:56:27.769+09:00",
          "clientVersion" : "2.3.2",
          "address" : "/xxx.xxx.xxx.xxx:38380"
        }, {
          "msgRateOut" : 0.0,
          "msgThroughputOut" : 0.0,
          "msgRateRedeliver" : 0.0,
          "consumerName" : "b91282",
          "availablePermits" : 1000,
          "unackedMessages" : 0,
          "blockedConsumerOnUnackedMsgs" : false,
          "metadata" : { },
          "connectedSince" : "2019-09-11T18:56:25.413+09:00",
          "clientVersion" : "2.3.2",
          "address" : "/xxx.xxx.xxx.xxx:38408"
        } ]
      }
    },
    ```
    
    This is because `AbstractDispatcherSingleActiveConsumer#closeFuture` is not null, so `pickAndScheduleActiveConsumer()` is not called and the active consumer does not change.
    https://github.com/apache/pulsar/blob/8c3445ad6746df93fef80d2c661374cdab00bc38/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/AbstractDispatcherSingleActiveConsumer.java#L181-L184
    
    `closeFuture` becomes non-null when `disconnectAllConsumers()` is called. And once a value is assigned, it will never return to null.
    https://github.com/apache/pulsar/blob/8c3445ad6746df93fef80d2c661374cdab00bc38/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/AbstractDispatcherSingleActiveConsumer.java#L217-L218
    
    `disconnectAllConsumers()` is called when unloading or deleting a topic, as well as when resetting the cursor.
    
    ### Modifications
    
    Added `resetCloseFuture()` method to the Dispatcher classes to return `closeFuture` to null when resetting cursor is completed.

 .../broker/service/AbstractBaseDispatcher.java     |  4 ++
 .../AbstractDispatcherSingleActiveConsumer.java    |  7 +++
 .../apache/pulsar/broker/service/Dispatcher.java   |  2 +
 .../NonPersistentDispatcherMultipleConsumers.java  |  6 ++
 .../PersistentDispatcherMultipleConsumers.java     |  6 ++
 .../service/persistent/PersistentSubscription.java |  5 ++
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 67 ++++++++++++++++++++++
 7 files changed, 97 insertions(+)

commit 716daff074cd84cf20f38c79ee96f0b651f2550c
Author: Sergii Zhevzhyk <vzhikserg@users.noreply.github.com>
Date:   Mon Sep 16 12:56:03 2019 +0200

    Add checkstyle validation and fix style violations in the pulsar client api module (#5115)
    
    ### Modifications
    
    The following changes were made in this pull request:
    
    * Configured the checkstyle plugin
    * Fixed reported style violations
    
    This pull request has only cosmetic changes in the pulsar client api module and shouldn't introduce any change in the business logic.

 pulsar-client-api/pom.xml                          |  24 ++
 .../apache/pulsar/client/api/Authentication.java   |   7 +-
 .../client/api/AuthenticationDataProvider.java     |   6 +-
 .../pulsar/client/api/AuthenticationFactory.java   |   8 +-
 .../pulsar/client/api/BatchMessageContainer.java   |   4 +-
 .../apache/pulsar/client/api/BatcherBuilder.java   |  17 +-
 .../apache/pulsar/client/api/ClientBuilder.java    | 104 +++----
 .../apache/pulsar/client/api/CompressionType.java  |  10 +-
 .../org/apache/pulsar/client/api/Consumer.java     | 120 ++++----
 .../apache/pulsar/client/api/ConsumerBuilder.java  | 166 +++++-----
 .../client/api/ConsumerCryptoFailureAction.java    |  12 +-
 .../pulsar/client/api/ConsumerInterceptor.java     |  22 +-
 .../apache/pulsar/client/api/ConsumerStats.java    |   2 +-
 .../apache/pulsar/client/api/CryptoKeyReader.java  |   7 +-
 .../api/EncodedAuthenticationParameterSupport.java |   3 +
 .../apache/pulsar/client/api/HashingScheme.java    |   2 +-
 .../java/org/apache/pulsar/client/api/Message.java |  46 ++-
 .../org/apache/pulsar/client/api/MessageId.java    |  38 ++-
 .../apache/pulsar/client/api/MessageListener.java  |  10 +-
 .../pulsar/client/api/MessageRoutingMode.java      |  21 +-
 .../org/apache/pulsar/client/api/Producer.java     |  52 ++--
 .../apache/pulsar/client/api/ProducerBuilder.java  | 183 ++++++-----
 .../client/api/ProducerCryptoFailureAction.java    |   6 +-
 .../pulsar/client/api/ProducerInterceptor.java     |  28 +-
 .../apache/pulsar/client/api/ProducerStats.java    |   2 +-
 .../org/apache/pulsar/client/api/PulsarClient.java |  98 +++---
 .../pulsar/client/api/PulsarClientException.java   | 341 ++++++++++++++++++++-
 .../java/org/apache/pulsar/client/api/Reader.java  |  55 ++--
 .../apache/pulsar/client/api/ReaderBuilder.java    |  54 ++--
 .../apache/pulsar/client/api/ReaderListener.java   |  14 +-
 .../pulsar/client/api/RegexSubscriptionMode.java   |   6 +-
 .../java/org/apache/pulsar/client/api/Schema.java  |  57 ++--
 .../client/api/SchemaSerializationException.java   |  18 ++
 .../pulsar/client/api/ServiceUrlProvider.java      |  14 +-
 .../client/api/SubscriptionInitialPosition.java    |  11 +-
 .../apache/pulsar/client/api/SubscriptionType.java |  29 +-
 .../pulsar/client/api/TypedMessageBuilder.java     | 153 +++++----
 .../org/apache/pulsar/client/api/schema/Field.java |   2 +-
 .../client/api/schema/FieldSchemaBuilder.java      |  16 +-
 .../pulsar/client/api/schema/SchemaDefinition.java |  29 +-
 .../client/api/schema/SchemaDefinitionBuilder.java |  12 +-
 .../client/api/schema/SchemaInfoProvider.java      |   2 +-
 .../pulsar/client/api/schema/SchemaReader.java     |   5 +-
 .../pulsar/client/api/schema/SchemaWriter.java     |   2 +-
 .../pulsar/client/api/schema/package-info.java     |  22 ++
 .../client/internal/DefaultImplementation.java     |  64 ++--
 .../pulsar/client/internal/package-info.java       |  22 ++
 .../org/apache/pulsar/common/api/AuthData.java     |  11 +-
 .../pulsar/common/api/EncryptionContext.java       |   6 +
 .../org/apache/pulsar/common/api/package-info.java |  22 ++
 .../org/apache/pulsar/common/schema/KeyValue.java  |   2 +-
 .../pulsar/common/schema/KeyValueEncodingType.java |  11 +-
 .../apache/pulsar/common/schema/SchemaInfo.java    |   9 +-
 .../common/schema/SchemaInfoWithVersion.java       |   3 +
 .../apache/pulsar/common/schema/SchemaType.java    |  23 +-
 .../apache/pulsar/common/schema/package-info.java  |  22 ++
 56 files changed, 1273 insertions(+), 762 deletions(-)

commit 61ba4e746f414fd43c301bbaa824d61f51096244
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Sep 16 03:55:19 2019 -0700

    [bookkeeper] allow configuring region aware placement related settings (#5100)
    
    *Motivation*
    
    We introduced settings to allow user configuring whether to enable rack-aware or region-aware
    placement policies. However the settings for region-aware placement policy is not configurable.
    
    This pull request enables configuring region-aware placement related settings.

 .../pulsar/broker/BookKeeperClientFactoryImpl.java |  44 +++++-
 .../broker/BookKeeperClientFactoryImplTest.java    | 150 +++++++++++++++++++++
 2 files changed, 187 insertions(+), 7 deletions(-)

commit 711501409223a0ba13e9b4e1387556533c80a623
Author: Raman Gupta <rocketraman@gmail.com>
Date:   Mon Sep 16 06:55:00 2019 -0400

    [Issue 5142][docs] Remove non-partitioned topic info from partitioned topic docs (#5143)
    
    Fixes #5142
    
    ### Motivation
    
    Docs are confusing.
    
    ### Modifications
    
    Edited out the incorrect section in the docs. Moved section into its documentation page, with additional related docs.

 site2/docs/admin-api-non-partitioned-topics.md | 97 ++++++++++++++++++++++++++
 site2/docs/admin-api-partitioned-topics.md     | 37 ----------
 site2/website/sidebars.json                    |  1 +
 3 files changed, 98 insertions(+), 37 deletions(-)

commit b392776e12aeacbc5a086b04a715587cc617f92b
Author: tuteng <eguangning@gmail.com>
Date:   Mon Sep 16 18:53:10 2019 +0800

    Fix javadoc (#5192)
    
    Fixes https://github.com/apache/pulsar/issues/4979
    
    Master Issue: https://github.com/apache/pulsar/issues/4979
    
    ### Motivation
    
    This tool script https://github.com/apache/pulsar/blob/master/site2/tools/javadoc-gen.sh throws a lot of exceptions when it is running, resulting in many interface documents not being generated correctly. I will try to replace it with mvn javadoc:javadoc
    
    ### Modifications
    
    * Replace `javadoc` use `mvn javadoc:javadoc`

 site2/tools/javadoc-gen.sh | 60 +++++++++++++---------------------------------
 1 file changed, 16 insertions(+), 44 deletions(-)

commit 8f75f5849ca1ce9ff2bb68662bc2ca64fbffde70
Author: vicaya <vicaya@users.noreply.github.com>
Date:   Sun Sep 15 13:41:32 2019 -0700

    skip-all is clear-backlog after topics unification (#5194)
    
    Resolves #5060

 site2/docs/reference-pulsar-admin.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 412c8fdb5ea61593017c395a7c8e291c922d6bf5
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Sun Sep 15 21:31:05 2019 +0900

    Fix bug that fails to search namespace bundle due to NPE (#5191)
    
    Fixes #5176
    
    ### Motivation
    
    As mentioned in #5176, NPE may occur in the load manager and fail to search for namespace bundles. This is because multiple threads may update a map named `brokerToNamespaceToBundleRange` at the same time.
    
    ### Modifications
    
    - Changed `brokerToNamespaceToBundleRange` to ConcurrentOpenHashMap instead of HashMap which is not thread safe.
    - Fixed `LoadManagerShared.removeMostServicingBrokersForNamespace()` logic so that NPE does not occur.

 .../broker/loadbalance/impl/LoadManagerShared.java | 66 ++++++++---------
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 18 +++--
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 15 ++--
 .../AntiAffinityNamespaceGroupTest.java            | 17 +++--
 .../loadbalance/impl/LoadManagerSharedTest.java    | 86 ++++++++++++++++++++++
 5 files changed, 151 insertions(+), 51 deletions(-)

commit a43a9339da886cc51c57465770dd2c71b83358d4
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sun Sep 15 14:02:21 2019 +0800

    Move Connector Admin CLI to Connector Guide (#5184)
    
    Fix https://github.com/apache/pulsar/issues/5015

 site2/website/sidebars.json | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit bbdf14bd66305758ba5731cef55f4d2547f009cc
Author: tuteng <eguangning@gmail.com>
Date:   Sat Sep 14 22:30:00 2019 +0800

    Fix tenant typo from pubilc to public (#5190)
    
    Master Issue: #5189
    
    Motivation
    Currently, the tenant name for the new version of the document is incorrectly written, resulting in that the tenant cannot be found.
    
    Modifications
    Fix tenant name from pubilc to public

 site2/docs/io-cdc-debezium.md                                 | 2 +-
 site2/website/versioned_docs/version-2.4.1/io-cdc-debezium.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit c377865cd5698b89c0870fcc30d30a4bc7191470
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Sep 13 23:56:22 2019 +0800

    [doc] Improve Pulsar Security Encryption (#5091)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Security document (security-encryption section): http://pulsar.apache.org/docs/en/next/security-encryption/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-encryption.md | 60 +++++++++++++++++++++------------------
 1 file changed, 33 insertions(+), 27 deletions(-)

commit b8ded331ff6571929d73955ab004d2f9427a6fca
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Sep 13 23:34:40 2019 +0800

    [doc] Improve Pulsar Deployment Kubernetes (#5102)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Security document (deploy-Kubernetes section): http://pulsar.apache.org/docs/en/next/deploy-kubernetes/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/deploy-kubernetes.md | 109 +++++++++++++++++++---------------------
 1 file changed, 52 insertions(+), 57 deletions(-)

commit 8bfca9ad0b2cbd3dbc70012e1f4fa683bfddc170
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Sep 13 23:23:05 2019 +0800

    [doc] Improve Pulsar Security Extending (#5092)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Security document (security-extending section): http://pulsar.apache.org/docs/en/next/security-extending/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-extending.md | 41 ++++++++++++++--------------------------
 1 file changed, 14 insertions(+), 27 deletions(-)

commit ca63ee69ca441933e4bccdf5c55ca345713c1b83
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Sep 13 08:21:52 2019 -0700

    PIP-41 (part-1): Introduce Protocol Handler API (#5130)
    
    *Motivation*
    
    This is the first pull request for implementing PIP-41.
    
    PIP-41: https://github.com/apache/pulsar/wiki/PIP-41%3A-Pluggable-Protocol-Handler
    
    *Modification*
    
    - Introduce the protocol handler API
    - Introduce a new field `protocols` in LoadReport
    - Add util classes to search and load protocol handlers
    - Include the protocol handlers in broker's lifecycle
    - Add settings to configure what protocol handlers to load

 .../apache/pulsar/broker/ServiceConfiguration.java |  16 ++
 .../org/apache/pulsar/broker/PulsarService.java    |  32 +++-
 .../pulsar/broker/loadbalance/LoadManager.java     |   6 +-
 .../pulsar/broker/loadbalance/NoopLoadManager.java |   1 +
 .../loadbalance/impl/ModularLoadManagerImpl.java   |   4 +
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   2 +
 .../pulsar/broker/protocol/ProtocolHandler.java    |  97 ++++++++++++
 .../broker/protocol/ProtocolHandlerDefinition.java |  46 ++++++
 .../protocol/ProtocolHandlerDefinitions.java       |  35 +++++
 .../broker/protocol/ProtocolHandlerMetadata.java   |  42 ++++++
 .../broker/protocol/ProtocolHandlerUtils.java      | 156 +++++++++++++++++++
 .../protocol/ProtocolHandlerWithClassLoader.java   |  83 +++++++++++
 .../pulsar/broker/protocol/ProtocolHandlers.java   | 148 ++++++++++++++++++
 .../pulsar/broker/protocol/package-info.java       |  22 +++
 .../pulsar/broker/service/BrokerService.java       |  49 +++++-
 .../broker/protocol/MockProtocolHandler.java       |  67 +++++++++
 .../broker/protocol/ProtocolHandlerUtilsTest.java  | 155 +++++++++++++++++++
 .../ProtocolHandlerWithClassLoaderTest.java        |  70 +++++++++
 .../broker/protocol/ProtocolHandlersTest.java      | 166 +++++++++++++++++++++
 .../policies/data/loadbalancer/LoadReport.java     |  17 +++
 .../data/loadbalancer/LocalBrokerData.java         |  20 +++
 .../data/loadbalancer/ServiceLookupData.java       |  19 +++
 22 files changed, 1244 insertions(+), 9 deletions(-)

commit c04945e7c6f1daf356846c95a6b7f3ae363adf11
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Sep 12 22:31:54 2019 -0700

    Add option to customize splitter character (#5187)

 .../org/apache/pulsar/client/cli/CmdProduce.java   | 34 +++++++++++++------
 .../org/apache/pulsar/client/cli/NoSplitter.java   | 39 ++++++++++++++++++++++
 2 files changed, 63 insertions(+), 10 deletions(-)

commit 48f41c0e496dd8182ca99d7efd7acadb36500f4c
Author: Alex Mault <AlJaMa@users.noreply.github.com>
Date:   Thu Sep 12 14:34:26 2019 -0600

    Add Rust Client Library (#5156)

 site2/docs/getting-started-clients.md | 1 +
 1 file changed, 1 insertion(+)

commit b687fed530bc61aae12d3335b7e6ec4f68506ca3
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Fri Sep 13 02:39:03 2019 +0900

    [pulsar-broker] Close RateLimiter instance (#5155)
    
    * Close RateLimiter instance
    
    * Restore AbstractDispatcherSingleActiveConsumer#close()
    
    * Fix NonPersistentSubscription#delete()

 .../nonpersistent/NonPersistentSubscription.java   | 26 +++++++++---
 .../PersistentDispatcherMultipleConsumers.java     |  5 +++
 .../PersistentDispatcherSingleActiveConsumer.java  | 10 +++++
 .../service/persistent/PersistentReplicator.java   | 29 +++++++++++++
 .../service/persistent/PersistentSubscription.java | 22 ++++++++--
 .../broker/service/persistent/PersistentTopic.java | 25 ++++++++----
 .../client/api/MessageDispatchThrottlingTest.java  | 46 +++++++++++++++++++++
 .../SubscriptionMessageDispatchThrottlingTest.java | 47 ++++++++++++++++++++++
 8 files changed, 193 insertions(+), 17 deletions(-)

commit 7861a78b9fdbb17275b0e4fd910d6a150f88496b
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Sep 12 09:00:09 2019 -0700

    Change logging for debezium key value pairs (#5172)
    
    * Make naming consistent for Debezium postgreSql
    
    * Change logging for debezium key value pairs

 ...ainer.java => DebeziumPostgreSqlContainer.java} |  4 ++--
 .../integration/functions/PulsarFunctionsTest.java | 14 +++++++-------
 .../integration/io/DebeziumMySqlSourceTester.java  |  6 +++---
 ...er.java => DebeziumPostgreSqlSourceTester.java} | 22 +++++++++++-----------
 4 files changed, 23 insertions(+), 23 deletions(-)

commit 81ccffc8048f521613c670debcf54cb2a0b4e046
Author: Like <ke.like@outlook.com>
Date:   Thu Sep 12 23:59:18 2019 +0800

    Fix exception type check order bug (#5174)

 .../java/org/apache/pulsar/client/api/PulsarClientException.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 9d4cd1dc384af373db97466b6d99460f956940df
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Sep 12 18:24:31 2019 +0800

    Update sidebars.json file for 2.4.1 release (#5169)

 .../versioned_sidebars/version-2.4.1-sidebars.json      | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

commit b9e27c694e3fc4b372e79b4ec1abe626a01ed83c
Author: dengziming <dengziming1993@gmail.com>
Date:   Thu Sep 12 18:12:39 2019 +0800

    Fix few typos in the java docs (#5178)
    
    Signed-off-by: dengziming <dengziming@growingio.com>

 dashboard/django/collector.py                                           | 2 +-
 docker/pulsar-standalone/django/collector.py                            | 2 +-
 .../apache/pulsar/broker/authentication/AuthenticationProviderTls.java  | 2 +-
 site2/docs/io-hdfs.md                                                   | 2 +-
 site2/website/versioned_docs/version-2.3.1/io-hdfs.md                   | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

commit 9b375c26cf22422daa434824528d210fcc3bda56
Author: Like <ke.like@outlook.com>
Date:   Thu Sep 12 12:01:20 2019 +0800

    Fix method comment for class Topics (#5106)

 .../main/java/org/apache/pulsar/client/admin/Topics.java  | 15 ++++++---------
 1 file changed, 6 insertions(+), 9 deletions(-)

commit bd39e6c1a0c0c46cbdac3e65f90562932adb301d
Author: tuteng <eguangning@gmail.com>
Date:   Thu Sep 12 11:59:19 2019 +0800

    [doc]Add brokerClient authentication configuration (#5153)
    
    * Add brokerClient authentication configuration
    
    * Add authz tls auth for multi verison
    
    * Update configuration

 site2/docs/security-athenz.md                                    | 4 ++++
 site2/docs/security-tls-authentication.md                        | 9 +++++++++
 site2/docs/security-token-admin.md                               | 9 +++++++++
 .../versioned_docs/version-2.1.0-incubating/security-athenz.md   | 4 ++++
 .../version-2.1.0-incubating/security-tls-authentication.md      | 9 +++++++++
 .../versioned_docs/version-2.2.1/security-tls-authentication.md  | 9 +++++++++
 .../website/versioned_docs/version-2.2.1/security-token-admin.md | 9 +++++++++
 .../website/versioned_docs/version-2.3.1/security-token-admin.md | 9 +++++++++
 .../versioned_docs/version-2.4.0/security-tls-authentication.md  | 9 +++++++++
 .../website/versioned_docs/version-2.4.0/security-token-admin.md | 9 +++++++++
 site2/website/versioned_docs/version-2.4.1/security-athenz.md    | 4 ++++
 .../versioned_docs/version-2.4.1/security-tls-authentication.md  | 9 +++++++++
 12 files changed, 93 insertions(+)

commit 3ddbc90ea97b8735bbd162cefbe45dba819354f0
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Sep 12 11:58:47 2019 +0800

    [Doc] Add reader configuration description for Java client (#5163)
    
    * Add reader configuration description for Java client
    
    * Update

 site2/docs/client-libraries-java.md | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit 0611b993dbd121358eed109b6f327ed67b69974b
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 12 11:58:21 2019 +0800

    [doc] Improve Pulsar Deployment monitoring (#5164)
    
    * Update deploy-monitoring.md
    
    * Update deploy-monitoring.md
    
    * Update deploy-monitoring.md

 site2/docs/deploy-monitoring.md | 46 +++++++++++++++++------------------------
 1 file changed, 19 insertions(+), 27 deletions(-)

commit 0778784f996eb9e09c597c37d98b22e11bcd2e4f
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Sep 12 11:57:50 2019 +0800

    [doc] Improve Pulsar Deployment DCOS (#5140)
    
    * Update deploy-dcos.md
    
    * Update deploy-dcos.md

 site2/docs/deploy-dcos.md | 38 +++++++++++++++++++-------------------
 1 file changed, 19 insertions(+), 19 deletions(-)

commit 60d2bfa389815b1769b36a0158059bfc3372a9a0
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Sep 11 20:45:42 2019 -0700

    Add ping util to Docker file (#5171)

 docker/pulsar/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6b1921aef3a7d0be6e1d63fcc32f37333ad569de
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 11 14:19:27 2019 -0700

    Fixed spark receiver to account for all the consumer config options (#5152)

 .../pulsar/spark/SparkStreamingPulsarReceiver.java | 22 ++++------
 .../spark/SparkStreamingPulsarReceiverTest.java    | 50 +++++++++++++++++++++-
 2 files changed, 57 insertions(+), 15 deletions(-)

commit a02dba37b6178f7117d577c1ef26784c05f06689
Author: Like <ke.like@outlook.com>
Date:   Wed Sep 11 15:50:32 2019 +0800

    Remove method testValidateFunctionsConfigs which was abandoned (#5146)

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 50 ----------------------
 1 file changed, 50 deletions(-)

commit 7ef1b31d46bc76f41e2d21480fab4942f135a256
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Sep 11 15:50:03 2019 +0800

    [Doc] Add Built-in Connector (#5168)
    
    1. Currently, Pulsar has 12 source connectors and 14 sink connectors.
    I've added the list and will add configuration and example for each (especially for the yellow-highlighted parts).
    
    ![image](https://user-images.githubusercontent.com/50226895/64601212-17b6a100-d3ef-11e9-9a96-8b3553746e14.png)
    
    2. I've deleted the io-managing.md because the contents of it have been transferred [here](https://pulsar.apache.org/docs/en/next/io-use/).
    
    3. Fix https://github.com/apache/pulsar/issues/5015

 site2/docs/io-connectors.md |  91 ++++++++++++++++++-------
 site2/docs/io-managing.md   | 161 --------------------------------------------
 site2/website/sidebars.json |   5 +-
 3 files changed, 67 insertions(+), 190 deletions(-)

commit f43526cf0c56de57d2868ed0c5fb77c24dd2fa72
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Sep 10 17:19:46 2019 -0700

    Fix Postgres debezium test (#5162)
    
    Remove meteadata tables for cdc test

 .../pulsar/tests/integration/io/DebeziumPostgresqlSourceTester.java      | 1 +
 1 file changed, 1 insertion(+)

commit 9c9d2101d20fe86186b74ade461fcf45ed35f5ab
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Sep 11 00:09:11 2019 +0800

    Add producer configuration description for Java client (#5154)

 site2/docs/client-libraries-java.md | 38 ++++++++++++++++++++++++++++---------
 1 file changed, 29 insertions(+), 9 deletions(-)

commit 505e08a76425c6e49ff5bc691f8ca7587184a2bf
Author: vicaya <vicaya@users.noreply.github.com>
Date:   Mon Sep 9 19:17:27 2019 -0700

    Capitalize L in SQL (#5125)

 site2/docs/sql-deployment-configurations.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 61c75aff1f08078403f4505241de944951c3a87f
Author: Like <ke.like@outlook.com>
Date:   Tue Sep 10 06:54:58 2019 +0800

    Fix quote in README.md (#5149)

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ae3e89a3f0346d663e067db8834b7528a1128385
Author: Guillaume Rosauro <3407583+willome@users.noreply.github.com>
Date:   Mon Sep 9 20:55:52 2019 +0200

    Add Debezium Postgresql integration test (#4668)

 .../containers/DebeziumPostgresqlContainer.java    |  54 ++++++++++
 .../integration/functions/PulsarFunctionsTest.java |  72 +++++++++++--
 .../io/DebeziumPostgresqlSourceTester.java         | 115 +++++++++++++++++++++
 3 files changed, 232 insertions(+), 9 deletions(-)

commit 7cdd354b0b3ff31a287fa0c44ad013de4ac83faa
Author: Like <ke.like@outlook.com>
Date:   Mon Sep 9 11:15:36 2019 +0800

    Fix typo in method getMessageDropRate (#5150)
    
    Change ```getMesssageDropRate``` to ```getMessageDropRate```.

 .../pulsar/broker/service/nonpersistent/NonPersistentDispatcher.java  | 2 +-
 .../nonpersistent/NonPersistentDispatcherMultipleConsumers.java       | 2 +-
 .../nonpersistent/NonPersistentDispatcherSingleActiveConsumer.java    | 2 +-
 .../broker/service/nonpersistent/NonPersistentSubscription.java       | 2 +-
 .../pulsar/broker/service/nonpersistent/NonPersistentTopic.java       | 4 ++--
 5 files changed, 6 insertions(+), 6 deletions(-)

commit c50abe8fbf1a519f52ce4d21bce917678d30ff1c
Author: Like <ke.like@outlook.com>
Date:   Mon Sep 9 03:04:39 2019 +0800

    Throw an error if the key was not specified for querying state (#5145)

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 23 ++++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  5 ++++-
 2 files changed, 27 insertions(+), 1 deletion(-)

commit 44dcc5bef2f506597438116d2a95524c7bfc89bf
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sat Sep 7 05:45:09 2019 +0800

    [Doc] Add consumer configuration description for Java client (#5122)

 site2/docs/client-libraries-java.md | 38 ++++++++++++++++++++++++++++++++-----
 1 file changed, 33 insertions(+), 5 deletions(-)

commit dc7d01efc6cf2df5631bc509758f2212bede35ce
Author: lipenghui <penghui@apache.org>
Date:   Sat Sep 7 02:46:18 2019 +0800

    Trim deleted entries after recover cursor. (#4987)
    
    * Trim deleted entries after recover cursor.
    
    * Fix errors
    
    * Add managed cursor unit tests.
    
    * Fix tests and handle cursor reset.
    
    * fix unit tests
    
    * Fix tests
    
    * Fix check style

 .../apache/bookkeeper/mledger/ManagedCursor.java   | 14 +++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 13 ++++-
 .../mledger/impl/ManagedCursorContainerTest.java   | 11 ++++
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 59 ++++++++++++++++++++++
 .../apache/pulsar/broker/service/Dispatcher.java   |  4 ++
 .../PersistentDispatcherMultipleConsumers.java     | 25 +++++++++
 .../service/persistent/PersistentSubscription.java |  3 ++
 .../ConcurrentOpenLongPairRangeSet.java            | 14 +++++
 .../common/util/collections/LongPairRangeSet.java  | 19 +++++++
 .../ConcurrentOpenLongPairRangeSetTest.java        | 23 +++++++++
 10 files changed, 184 insertions(+), 1 deletion(-)

commit 00fc2e8ed90645453115dff733094fef31c2379e
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Sat Sep 7 01:49:16 2019 +0900

    Fix deadlock when resetting cursor (#5139)

 .../broker/service/persistent/PersistentSubscription.java    | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit 696732a1bf81a61a2f90a63f6805b3a088dc02d8
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Sep 6 08:38:06 2019 -0700

    Add procps to docker too enable ps command (#5132)

 docker/pulsar/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0f40adc26b44d9924f2b4daebc30e58e19609ef5
Author: Rikuo Takahama <mas.null19@gmail.com>
Date:   Sat Sep 7 00:36:07 2019 +0900

    Make client keepalive interval configurable on pulsar-client-kafka (#5131)

 .../apache/pulsar/client/kafka/compat/PulsarClientKafkaConfig.java | 7 +++++++
 site2/docs/adaptors-kafka.md                                       | 1 +
 2 files changed, 8 insertions(+)

commit f6af69696bd09f39d83ec9b46eb40a5e8a1f2ff7
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Sep 6 13:44:49 2019 +0800

    [doc] Improve Pulsar Security-token-admin (#5052)
    
    * Update security-token-admin.md
    
    * Update security-token-admin.md
    
    * Update security-token-admin.md
    
    * Update security-token-admin.md
    
    * Update security-token-admin.md

 site2/docs/security-token-admin.md | 93 ++++++++++++++++----------------------
 1 file changed, 39 insertions(+), 54 deletions(-)

commit 3a696d270339a82544b4d8f751ee242570d29cbe
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Sep 6 13:44:20 2019 +0800

    Update Pulsar Functions in 2.4.1 release (#5133)
    
    Fixes #4554
    
    ### Motivation
    Adopt new structure for Pulsar Functions in 2.4.1 release.
    
    ### Modifications
    Adopt changes in #5118 to the `version-2.4.1` folder.

 .../versioned_docs/version-2.4.1/functions-api.md  | 721 ---------------------
 .../versioned_docs/version-2.4.1/functions-cli.md  | 238 +++----
 .../version-2.4.1/functions-debug.md               |   4 +-
 .../version-2.4.1/functions-deploy.md              |  14 +-
 .../version-2.4.1/functions-develop.md             |  46 +-
 .../version-2.4.1/functions-overview-new.md        | 190 ------
 .../version-2.4.1/functions-overview.md            | 409 ++----------
 .../version-2.4.1/functions-runtime.md             |   3 +-
 .../version-2.4.1/functions-worker.md              | 243 +++++++
 9 files changed, 447 insertions(+), 1421 deletions(-)

commit 1302c40ab008547eaab3c09244a302a55ad31bd6
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Sep 6 13:43:38 2019 +0800

    Update getting-started-standalone.md (#5124)

 site2/docs/getting-started-standalone.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c6100186b5ba267c9a3af638eb76652d953a60b3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Sep 5 21:41:17 2019 -0700

    Fix: windowed functions were broken when we changed java function instance to use classloaders (#5117)
    
    * Fix: window functions were broken when we changed java function instance to use classloaders
    
    * fix unit test

 .../functions/instance/JavaInstanceRunnable.java   |  14 +-
 .../integration/functions/PulsarFunctionsTest.java | 141 +++++++++++++++++++++
 2 files changed, 152 insertions(+), 3 deletions(-)

commit 1b47930e3e9653ad6fed1c6047ffddb5d20f2c6d
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Sep 6 09:40:41 2019 +0800

    [docs] Adopt new Pulsar Functions doc (#5118)
    
    * Adopt new Pulsar Functions
    
    * Fix link issues
    
    * adjust structure name, add Go example
    
    * update sidebars.json file

 site2/docs/functions-api.md          | 720 -----------------------------------
 site2/docs/functions-cli.md          | 238 ++++++------
 site2/docs/functions-debug.md        |   4 +-
 site2/docs/functions-debugging.md    | 451 ----------------------
 site2/docs/functions-deploy.md       |  14 +-
 site2/docs/functions-deploying.md    | 228 -----------
 site2/docs/functions-develop.md      |  46 ++-
 site2/docs/functions-guarantees.md   |  41 --
 site2/docs/functions-metrics.md      |  43 ---
 site2/docs/functions-overview-new.md | 189 ---------
 site2/docs/functions-overview.md     | 409 ++------------------
 site2/docs/functions-quickstart.md   | 389 -------------------
 site2/docs/functions-runtime.md      |   3 +-
 site2/docs/functions-state.md        | 118 ------
 site2/docs/functions-worker.md       |  14 +-
 site2/website/sidebars.json          |  17 +-
 16 files changed, 213 insertions(+), 2711 deletions(-)

commit b15daac9398a9e3e227c21a47ad532ddd6b31c08
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Sep 6 09:15:42 2019 +0800

    Add the client usage when using multi-hosts. (#5121)

 site2/docs/deploy-bare-metal.md | 20 ++++++++++++++++++--
 1 file changed, 18 insertions(+), 2 deletions(-)

commit fbb906f124cb4ddb42c15eef924f498298a65092
Author: tuteng <eguangning@gmail.com>
Date:   Fri Sep 6 09:14:46 2019 +0800

    [website]Fix rest api (#5107)
    
    ### Motivation
    Currently, there are some problems with the display of rest API for function, source, and sink. 2.4.1 does not generate a new swagger file.
    
    ### Modifications
    * Create directory master
    * Generate swagger json file for 2.4.1
    * Fix swagger function, source and sink display

 site2/website/static/js/getSwaggerByVersion.js     |   31 +-
 site2/website/static/swagger/2.4.1/swagger.json    | 9741 ++++++++++++++++++++
 .../static/swagger/2.4.1/swaggerfunctions.json     | 1496 +++
 .../website/static/swagger/2.4.1/swaggersink.json  |  935 ++
 .../static/swagger/2.4.1/swaggersource.json        |  886 ++
 src/gen-swagger.sh                                 |    3 +-
 6 files changed, 13090 insertions(+), 2 deletions(-)

commit 79ef292c943d08ed7133890f9b33232e9669d529
Author: Like <ke.like@outlook.com>
Date:   Fri Sep 6 05:50:32 2019 +0800

    Convert latency to millisecond in producer stats (#5096)
    
    * Convert latency to millisecond in producer stats
    
    * Format header

 .../client/impl/ProducerStatsRecorderImpl.java     |  2 +-
 .../client/impl/ProducerStatsRecorderImplTest.java | 57 ++++++++++++++++++++++
 2 files changed, 58 insertions(+), 1 deletion(-)

commit b6f89c38e59aa6c80276f1f2bd958c7c3e998e1b
Author: lsy180829 <42792704+lsy180829@users.noreply.github.com>
Date:   Fri Sep 6 05:48:47 2019 +0800

    Fix wrong reference in kubernetes deployment README.md (#5110)
    
    ### Motivation
    
    Fixes #5098
    
    ### Modifications
    
    Modify the relative path in README.md (pulsar/deployment/kubernetes/README.md)

 deployment/kubernetes/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5fa40cb284f2250991464135069ea6e980774c3f
Author: lipenghui <penghui@apache.org>
Date:   Fri Sep 6 02:47:23 2019 +0800

    Fix storage size always 0 without subscription. (#5108)
    
    ### Motivation
    
    Fixes [issue-182](https://github.com/streamnative/pulsar-manager/issues/182)

 .../broker/service/persistent/PersistentTopic.java       |  3 ++-
 .../pulsar/broker/service/BacklogQuotaManagerTest.java   |  8 ++++----
 .../apache/pulsar/broker/service/BrokerServiceTest.java  | 16 ++++++++++++++++
 .../apache/pulsar/common/policies/data/TopicStats.java   |  5 +++++
 4 files changed, 27 insertions(+), 5 deletions(-)

commit 1dacb630c73ba5eb0c05da564d58df497f4f7793
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Sep 5 10:19:30 2019 -0700

    Update supported  python osx version docs (#5020)

 site2/docs/client-libraries-python.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c14da293485f84eb8d9dba4bd6ab94e0dbf88d95
Author: Jia Zhai <zhaijia@apache.org>
Date:   Thu Sep 5 21:16:18 2019 +0800

    add mission version update (#5113)
    
    when release 2.4.1 leaked update latest version of website, this is to fix the error

 site2/website/release-notes.md | 2 --
 site2/website/releases.json    | 1 +
 2 files changed, 1 insertion(+), 2 deletions(-)

commit b19628394629c9b04bfc3a8f7e066bb4bad018e2
Author: lipenghui <penghui@apache.org>
Date:   Thu Sep 5 16:06:54 2019 +0800

    Improve response of Rest API for create schema. (#5103)
    
    Fixes #5094
    ### Motivation
    
    Currently, can't get some detail messages about incompatible while use REST API to create a new schema. This PR let users to get the detail messages.
    
    ### Future more
    Use pulsar-admin or pulsar-client also can get the detail messages about incompatible. This PR only handle the REST way.

 .../pulsar/broker/admin/v2/SchemasResource.java    |   3 +-
 .../schema/AvroSchemaBasedCompatibilityCheck.java  |  14 +--
 .../schema/DefaultSchemaRegistryService.java       |   5 +
 .../schema/JsonSchemaCompatibilityCheck.java       |  23 ++--
 .../schema/KeyValueSchemaCompatibilityCheck.java   |  24 ++--
 .../service/schema/SchemaCompatibilityCheck.java   |  38 ++++--
 .../broker/service/schema/SchemaRegistry.java      |   3 +
 .../service/schema/SchemaRegistryServiceImpl.java  | 138 ++++++++++++---------
 .../exceptions/IncompatibleSchemaException.java    |   4 +
 .../service/schema/exceptions/SchemaException.java |   4 +
 ...hemaRegistryServiceWithSchemaDataValidator.java |  14 ++-
 11 files changed, 171 insertions(+), 99 deletions(-)

commit 53fb0554e8411a0b65701936864e6d91666a4ef1
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Thu Sep 5 00:53:49 2019 -0700

    Pulsar-IO: Added Kinesis Source Connector (#3784)

 .../io/kinesis/AbstractKinesisConnector.java       | 116 ++++++++++++++++
 .../pulsar/io/kinesis/BaseKinesisConfig.java       |  68 ++++++++++
 .../apache/pulsar/io/kinesis/KinesisRecord.java    |  81 ++++++++++++
 .../pulsar/io/kinesis/KinesisRecordProcessor.java  | 115 ++++++++++++++++
 .../io/kinesis/KinesisRecordProcessorFactory.java  |  42 ++++++
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |  87 +-----------
 .../pulsar/io/kinesis/KinesisSinkConfig.java       |  48 +------
 .../apache/pulsar/io/kinesis/KinesisSource.java    | 110 +++++++++++++++
 .../pulsar/io/kinesis/KinesisSourceConfig.java     | 121 +++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |   3 +-
 .../pulsar/io/kinesis/KinesisSinkConfigTests.java  |  71 ++++++++++
 .../io/kinesis/KinesisSourceConfigTests.java       | 147 +++++++++++++++++++++
 .../kinesis/src/test/resources/sinkConfig.yaml     |  27 ++++
 .../kinesis/src/test/resources/sourceConfig.yaml   |  32 +++++
 14 files changed, 941 insertions(+), 127 deletions(-)

commit 16c15edf4ffcbe7281165b6161e5a7a2433b07bb
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Wed Sep 4 12:38:18 2019 +0800

    [doc] Improve Pulsar deployment AWS (#5093)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Deployment document (deploy-aws section): http://pulsar.apache.org/docs/en/next/deploy-aws/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/deploy-aws.md | 83 +++++++++++++++++++++++-------------------------
 1 file changed, 40 insertions(+), 43 deletions(-)

commit 52124970a5eed47553b73696bbfcd556b516431f
Author: Jia Zhai <zhaijia@apache.org>
Date:   Wed Sep 4 07:56:00 2019 +0800

    update website for 2.4.1 release (#5080)
    
    Update website for 2.4.1 release

 .../admin-api-non-persistent-topics.md             |  264 +++
 .../version-2.4.1/admin-api-overview.md            |   89 +
 .../version-2.4.1/admin-api-partitioned-topics.md  |  377 ++++
 .../version-2.4.1/administration-dashboard.md      |   60 +
 .../version-2.4.1/administration-upgrade.md        |  153 ++
 .../version-2.4.1/client-libraries-java.md         |  708 +++++++
 .../version-2.4.1/concepts-messaging.md            |  415 ++++
 .../version-2.4.1/concepts-tiered-storage.md       |   18 +
 .../version-2.4.1/cookbooks-compaction.md          |  127 ++
 .../versioned_docs/version-2.4.1/functions-api.md  |  721 +++++++
 .../versioned_docs/version-2.4.1/functions-cli.md  |  196 ++
 .../version-2.4.1/functions-debug.md               |  448 +++++
 .../version-2.4.1/functions-deploy.md              |  211 ++
 .../version-2.4.1/functions-develop.md             |  617 ++++++
 .../version-2.4.1/functions-overview-new.md        |  190 ++
 .../version-2.4.1/functions-overview.md            |  513 +++++
 .../version-2.4.1/functions-runtime.md             |  143 ++
 .../version-2.4.1/getting-started-standalone.md    |  226 +++
 .../versioned_docs/version-2.4.1/io-cdc-canal.md   |  175 ++
 .../version-2.4.1/io-cdc-debezium.md               |  261 +++
 .../versioned_docs/version-2.4.1/io-connectors.md  |   31 +
 .../versioned_docs/version-2.4.1/io-debug.md       |  329 ++++
 .../versioned_docs/version-2.4.1/io-develop.md     |  196 ++
 .../versioned_docs/version-2.4.1/io-jdbc.md        |   24 +
 .../versioned_docs/version-2.4.1/io-netty.md       |  148 ++
 .../website/versioned_docs/version-2.4.1/io-use.md | 1505 ++++++++++++++
 .../version-2.4.1/reference-configuration.md       |  496 +++++
 .../version-2.4.1/reference-connector-admin.md     |  601 ++++++
 .../version-2.4.1/reference-metrics.md             |  244 +++
 .../version-2.4.1/reference-pulsar-admin.md        | 2079 ++++++++++++++++++++
 .../schema-evolution-compatibility.md              |  784 ++++++++
 .../version-2.4.1/schema-get-started.md            |   91 +
 .../versioned_docs/version-2.4.1/schema-manage.md  |  786 ++++++++
 .../version-2.4.1/schema-understand.md             |  576 ++++++
 .../version-2.4.1/security-athenz.md               |   89 +
 .../version-2.4.1/security-authorization.md        |  100 +
 .../version-2.4.1/security-kerberos.md             |  391 ++++
 .../version-2.4.1/security-overview.md             |   38 +
 .../version-2.4.1/security-tls-authentication.md   |  147 ++
 .../version-2.4.1/security-tls-transport.md        |  230 +++
 .../version-2.4.1/security-token-client.md         |  123 ++
 .../versioned_sidebars/version-2.4.1-sidebars.json |  154 ++
 site2/website/versions.json                        |    1 +
 43 files changed, 15075 insertions(+)

commit d0bde6899a1d80eb6630c0a32d0cf5e634e4fe7a
Author: tuteng <eguangning@gmail.com>
Date:   Tue Sep 3 23:45:59 2019 +0800

    [website]The website cannot get the swagger version file (#5076)
    
    ### Motivation
    
    After multiple versions of rest API are currently supported, a prefix is added to the route of the online environment when it is displayed. resulting in the js file not being available.
    
    ![image](https://user-images.githubusercontent.com/1907867/63989496-18a82280-cb13-11e9-84e7-be2baaf0c889.png)
    
    
    ### Modifications
    
    * Change js file search to a relative path
    
    ### Verifying this change
    
    Click http://pulsar.apache.org/admin-rest-api/js/getSwaggerByVersion.js 404 not found
    Click http://pulsar.apache.org/admin-rest-api/../js/getSwaggerByVersion.js OK

 site2/.gitignore                                   |    2 +-
 site2/website/pages/en/admin-rest-api.js           |    2 +-
 site2/website/pages/en/functions-rest-api.js       |    2 +-
 site2/website/pages/en/sink-rest-api.js            |    2 +-
 site2/website/pages/en/source-rest-api.js          |    2 +-
 site2/website/static/swagger/2.3.0/swagger.json    | 8191 +++++++++++++++++
 .../static/swagger/2.3.0/swaggerfunctions.json     | 3431 +++++++
 .../website/static/swagger/2.3.0/swaggersink.json  | 3038 ++++++
 .../static/swagger/2.3.0/swaggersource.json        | 3038 ++++++
 site2/website/static/swagger/2.3.1/swagger.json    | 8191 +++++++++++++++++
 .../static/swagger/2.3.1/swaggerfunctions.json     | 3431 +++++++
 .../website/static/swagger/2.3.1/swaggersink.json  | 3038 ++++++
 .../static/swagger/2.3.1/swaggersource.json        | 3038 ++++++
 site2/website/static/swagger/2.3.2/swagger.json    | 8191 +++++++++++++++++
 .../static/swagger/2.3.2/swaggerfunctions.json     | 3431 +++++++
 .../website/static/swagger/2.3.2/swaggersink.json  | 3038 ++++++
 .../static/swagger/2.3.2/swaggersource.json        | 3038 ++++++
 site2/website/static/swagger/2.4.0/swagger.json    | 9698 ++++++++++++++++++++
 .../static/swagger/2.4.0/swaggerfunctions.json     | 1496 +++
 .../website/static/swagger/2.4.0/swaggersink.json  |  926 ++
 .../static/swagger/2.4.0/swaggersource.json        |  860 ++
 21 files changed, 66079 insertions(+), 5 deletions(-)

commit 801b1f73b0432108bab3551acd673abcf746bd24
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Tue Sep 3 16:53:38 2019 +0800

    [doc] Improve Pulsar security authorization (#5070)
    
    * Update security-authorization.md
    
    * Update security-authorization.md
    
    * Update security-authorization.md

 site2/docs/security-authorization.md | 46 ++++++++++++++++++------------------
 1 file changed, 23 insertions(+), 23 deletions(-)

commit 12e46c63cdcf96b6c405b84061af8d200b91cead
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Sep 3 14:05:42 2019 +0800

    add notes (#5078)
    
    release notes for 2.4.1

 site2/website/release-notes.md | 95 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 95 insertions(+)

commit aaca33bbbf15a34692fe280660fa407b63a5d5c5
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Tue Sep 3 13:49:03 2019 +0800

    remove misleading comment in handleSend (#5097)
    
    public message does not only mean to persist message now, non-persistent topic has same publish path.

 .../src/main/java/org/apache/pulsar/broker/service/ServerCnx.java       | 2 --
 1 file changed, 2 deletions(-)

commit 2d244d51a9e84a65b2f73403111036d39118d8be
Author: Guchman <frankiensteinmusic@gmail.com>
Date:   Tue Sep 3 07:18:05 2019 +0300

    Update concepts-messaging.md (#5058)
    
    It was unclear.
    "Consumers" looks like chain of persistent-topic-A -> function -> non-persistent-topic-B -> function -> persistent-topic-C will be zero loss on restart of brokers, but unfortunately it's seems not to be true:)

 site2/docs/concepts-messaging.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2ed7d6e66aab676210def079751f979c68d5e8f9
Author: tuteng <eguangning@gmail.com>
Date:   Tue Sep 3 11:56:15 2019 +0800

    [doc]Add document for debug connector (#5041)
    
    Fixes #3624
    
    Master Issue: #3624
    
    ### Motivation
    
    If the current user encounters problems when using the connector, there is not a reasonable debugging process. This document attempts to provide a debugging process for the connector.
    
    ### Modifications
    
    * Add debugging document for the connector.

 site2/docs/io-debug.md      | 328 ++++++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json |   5 +-
 2 files changed, 331 insertions(+), 2 deletions(-)

commit b8aa2c9e6e6e9e76a1b724c8e23b6c6965a0d1aa
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Tue Sep 3 02:31:49 2019 +0800

    [doc] Improve Pulsar Security Kerberos (#5069)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Security document ( Security-kerberos section): http://pulsar.apache.org/docs/en/next/security-kerberos/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-kerberos.md | 107 +++++++++++++++++++---------------------
 1 file changed, 51 insertions(+), 56 deletions(-)

commit 0917f8ef6dfd914a4188f2d5996292d926acba3f
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Tue Sep 3 02:30:56 2019 +0800

    [Doc] Add *How to Use Pulsar Connectors* Guide (#5071)

 site2/docs/io-use.md        | 1504 +++++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json |    5 +-
 2 files changed, 1507 insertions(+), 2 deletions(-)

commit 695eedc8932400a8d605b1d4fb5fe3996737b43c
Author: Nicolas Ha <nha@users.noreply.github.com>
Date:   Mon Sep 2 06:33:11 2019 +0100

    feat: add turtlequeue to users (#5090)

 site2/website/data/users.js | 5 +++++
 1 file changed, 5 insertions(+)

commit 26991230ed428e01626e5295535b276f676c7df3
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Sep 1 21:24:10 2019 -0700

    [docs] Removed Java only warning for compacted read flag (#5085)
    
    ### Motivation
    
    Removed Java only warning for compacted read flag

 site2/docs/cookbooks-compaction.md | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

commit 1565e4e3a6626c8839c3004a1b54c5033f430c90
Author: tuteng <eguangning@gmail.com>
Date:   Sun Sep 1 20:07:27 2019 +0800

    Add document for pulsar IO netty (#5077)

 site2/docs/io-netty.md | 127 +++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 127 insertions(+)

commit f1eae9c0dfee2069ab2d4c17a45e5f89eac26ee7
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sun Sep 1 14:14:03 2019 +0800

    [Doc] Add configuration description for Java client (#5087)

 site2/docs/client-libraries-java.md | 30 ++++++++++++++++++++++++++++--
 1 file changed, 28 insertions(+), 2 deletions(-)

commit 4cd25ee0bd06e3883d7e80f155285f8adedf374f
Author: Sijie Guo <sijie@apache.org>
Date:   Sat Aug 31 18:25:57 2019 -0700

    [admin] DeleteBookieRack should remove the rack info from zookeeper (#5084)
    
    *Motivation*
    
    Currently deleteBookieRackInfo doesn't actually remove rack info from zookeeper.
    So if a broker restarts, you still can get the *deleted* bookie rack info.
    
    *Modification*
    
    - Fix the deleteBbookieInfo logic to update rack configuration in zookeeper
    - Remove a group from the map if the group is empty

 .../org/apache/pulsar/broker/admin/v2/Bookies.java |  23 +++--
 .../apache/pulsar/broker/admin/BookiesApiTest.java | 115 +++++++++++++++++++++
 .../policies/data/BookiesRackConfiguration.java    |  20 ++--
 3 files changed, 143 insertions(+), 15 deletions(-)

commit c9933750aaebeb668a1dd91a315f55dddef9ad84
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Aug 30 21:26:03 2019 -0700

    [bookkeeper] Don't return DEFAULT_RACK if ZkBookieRackAffinityMapping can't resolve network location (#5067)
    
    *Motivation*
    
    Different placement policy has different default rack information. For example, the default rack for `RackAware`
    is `/default-rack` and the default rack for `RegionAware` is `/default-region/default-rack`. If we return the
    wrong default rack, it can potentially cause inconsistent network locations inserted to the network topology and
    causing the following errors.
    
    ```
    15:36:30.083 [BookKeeperClientScheduler-OrderedScheduler-0-0] ERROR org.apache.bookkeeper.net.NetworkTopologyImpl - Error: can't add leaf node <Bookie:1.1.1.2:3181> at depth 2 to topology:
    Number of racks: 1
    Expected number of leaves:1
    /sh/rack1/1.1.1.1:3181
    
    15:36:30.083 [BookKeeperClientScheduler-OrderedScheduler-0-0] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Unexpected exception while handling joining bookie 1.1.1.2:3181
    org.apache.bookkeeper.net.NetworkTopologyImpl$InvalidTopologyException: Invalid network topology. You cannot have a rack and a non-rack node at the same level of the network topology.
    ```

 .../zookeeper/ZkBookieRackAffinityMapping.java      | 10 ++++++----
 .../zookeeper/ZkBookieRackAffinityMappingTest.java  | 21 ++++++++++-----------
 2 files changed, 16 insertions(+), 15 deletions(-)

commit 5b266b464215489e38b35ecbd26d0d8b57ed21c8
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 30 21:23:49 2019 -0700

    Avoid unnecessary allocations of PositionImpl (#5082)
    
    ### Motivation
    
    The PositionImpl class is used as immutable so there's no need to make defensive copies of it

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java     | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

commit 26fe6b066943b8b43be85072dbb82db0147f3cc4
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Sat Aug 31 05:22:54 2019 +0800

    [doc] Improve Pulsar security-tls-authentication (#5038)
    
    ###Motivation
    
    Improve the language and the overall descriptive style of the Pulsar Security document (TLS Authentication section): http://pulsar.apache.org/docs/en/next/security-tls-authentication/
    
    ###Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-tls-authentication.md | 42 +++++++++++++++----------------
 1 file changed, 20 insertions(+), 22 deletions(-)

commit 3cbfa10e14e138dc55d31d65878d0319518977f3
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 30 11:43:46 2019 -0700

    Use "info" as the default root logger level (#5079)

 bin/pulsar       | 2 +-
 conf/log4j2.yaml | 3 +--
 2 files changed, 2 insertions(+), 3 deletions(-)

commit d9c0a1054310e9428007d016895d4174b0d20f89
Author: Sergii Zhevzhyk <vzhikserg@users.noreply.github.com>
Date:   Fri Aug 30 16:10:21 2019 +0200

    Add checkstyle validation and fix style violations in the common module (#4989)
    
    * Add checkstyle validation and fix style violations.
    
    * Add the first batch of javadoc comments.
    
    * Add javadoc comments in the pulsar common module
    
    * Substitute the suppression warnings with javadoc comments in the pulsar common module

 pulsar-common/pom.xml                              |  20 ++++
 .../client/api/url/DataURLStreamHandler.java       |   6 ++
 .../api/url/PulsarURLStreamHandlerFactory.java     |   4 +
 .../java/org/apache/pulsar/client/api/url/URL.java |   3 +
 .../apache/pulsar/client/api/url/package-info.java |  22 +++++
 .../common/allocator/PulsarByteBufAllocator.java   |   3 +
 .../pulsar/common/allocator/package-info.java      |  22 +++++
 .../pulsar/common/api/raw/MessageParser.java       |  20 ++--
 .../apache/pulsar/common/api/raw/RawMessage.java   |  18 ++--
 .../apache/pulsar/common/api/raw/RawMessageId.java |   3 +
 .../common/api/raw/ReferenceCountedObject.java     |   5 +
 .../apache/pulsar/common/api/raw/package-info.java |  22 +++++
 .../common/compression/CompressionCodec.java       |   9 +-
 .../common/compression/CompressionCodecLZ4.java    |   8 +-
 .../common/compression/CompressionCodecNone.java   |   6 +-
 .../compression/CompressionCodecProvider.java      |   9 ++
 .../common/compression/CompressionCodecSnappy.java |   7 +-
 .../common/compression/CompressionCodecZLib.java   |   2 +-
 .../common/compression/CompressionCodecZstd.java   |   2 +-
 .../pulsar/common/compression/package-info.java    |  22 +++++
 .../common/conf/InternalConfigurationData.java     |   3 +
 .../apache/pulsar/common/conf/package-info.java    |  22 +++++
 .../pulsar/common/functions/ConsumerConfig.java    |   9 +-
 .../pulsar/common/functions/FunctionConfig.java    |  25 ++++-
 .../pulsar/common/functions/FunctionState.java     |  15 ++-
 .../apache/pulsar/common/functions/Resources.java  |  18 +++-
 .../pulsar/common/functions/UpdateOptions.java     |   4 +-
 .../org/apache/pulsar/common/functions/Utils.java  |  15 +--
 .../pulsar/common/functions/WindowConfig.java      |   8 +-
 .../apache/pulsar/common/functions/WorkerInfo.java |   5 +-
 .../pulsar/common/functions/package-info.java      |  22 +++++
 .../pulsar/common/io/ConnectorDefinition.java      |  15 +--
 .../org/apache/pulsar/common/io/SinkConfig.java    |  15 ++-
 .../org/apache/pulsar/common/io/SourceConfig.java  |  17 +++-
 .../org/apache/pulsar/common/io/package-info.java  |  22 +++++
 .../pulsar/common/lookup/data/LookupData.java      |  23 +++--
 .../pulsar/common/lookup/data/package-info.java    |  22 +++++
 .../org/apache/pulsar/common/naming/Constants.java |   3 +
 .../org/apache/pulsar/common/naming/Metadata.java  |   3 +
 .../apache/pulsar/common/naming/NamespaceName.java |  12 ++-
 .../apache/pulsar/common/naming/ServiceUnitId.java |  13 ++-
 .../apache/pulsar/common/naming/TopicDomain.java   |   3 +
 .../org/apache/pulsar/common/naming/TopicName.java |  48 ++++-----
 .../apache/pulsar/common/naming/package-info.java  |  22 +++++
 .../org/apache/pulsar/common/nar/FileUtils.java    |  10 +-
 .../apache/pulsar/common/nar/NarClassLoader.java   |   8 +-
 .../org/apache/pulsar/common/nar/NarUnpacker.java  |   5 +-
 .../org/apache/pulsar/common/nar/package-info.java |  22 +++++
 .../org/apache/pulsar/common/net/package-info.java |  22 +++++
 .../common/partition/PartitionedTopicMetadata.java |   3 +
 .../pulsar/common/partition/package-info.java      |  22 +++++
 .../pulsar/common/policies/AutoFailoverPolicy.java |   7 +-
 .../common/policies/NamespaceIsolationPolicy.java  |  23 +++--
 .../pulsar/common/policies/data/AuthAction.java    |   8 +-
 .../pulsar/common/policies/data/AuthPolicies.java  |   9 +-
 .../policies/data/AutoFailoverPolicyData.java      |   8 +-
 .../policies/data/AutoFailoverPolicyType.java      |   7 +-
 .../pulsar/common/policies/data/BacklogQuota.java  |  21 ++--
 .../policies/data/BookieAffinityGroupData.java     |   3 +
 .../pulsar/common/policies/data/BookieInfo.java    |   3 +
 .../policies/data/BookiesRackConfiguration.java    |   5 +-
 .../common/policies/data/BrokerAssignment.java     |   3 +
 .../data/BrokerNamespaceIsolationData.java         |   6 +-
 .../pulsar/common/policies/data/BrokerStatus.java  |   3 +
 .../pulsar/common/policies/data/BundlesData.java   |   6 +-
 .../pulsar/common/policies/data/ClusterData.java   |   6 +-
 .../pulsar/common/policies/data/ConsumerStats.java |  31 +++---
 .../pulsar/common/policies/data/DispatchRate.java  |   6 +-
 .../pulsar/common/policies/data/ErrorData.java     |   3 +
 .../common/policies/data/ExceptionInformation.java |   3 +
 .../pulsar/common/policies/data/FailureDomain.java |   3 +
 .../pulsar/common/policies/data/FunctionStats.java | 110 ++++++++++++---------
 .../common/policies/data/FunctionStatus.java       |  14 ++-
 .../pulsar/common/policies/data/LocalPolicies.java |   3 +
 .../policies/data/NamespaceIsolationData.java      |   7 +-
 .../policies/data/NamespaceOwnershipStatus.java    |   6 ++
 .../policies/data/NonPersistentPublisherStats.java |   3 +-
 .../data/NonPersistentReplicatorStats.java         |   5 +-
 .../data/NonPersistentSubscriptionStats.java       |   5 +-
 .../policies/data/NonPersistentTopicStats.java     |  18 ++--
 .../data/PartitionedTopicInternalStats.java        |   7 +-
 .../policies/data/PartitionedTopicStats.java       |   7 +-
 .../common/policies/data/PersistencePolicies.java  |   6 +-
 .../policies/data/PersistentOfflineTopicStats.java |  29 +++---
 .../data/PersistentTopicInternalStats.java         |  12 ++-
 .../common/policies/data/PersistentTopicStats.java |   2 +-
 .../pulsar/common/policies/data/Policies.java      |  28 +++++-
 .../common/policies/data/PublisherStats.java       |  25 ++---
 .../common/policies/data/ReplicatorStats.java      |  27 ++---
 .../pulsar/common/policies/data/ResourceQuota.java |  54 +++++-----
 .../common/policies/data/RetentionPolicies.java    |   1 +
 .../SchemaAutoUpdateCompatibilityStrategy.java     |   2 +-
 .../pulsar/common/policies/data/SinkStatus.java    |  14 ++-
 .../pulsar/common/policies/data/SourceStatus.java  |  14 ++-
 .../pulsar/common/policies/data/SubscribeRate.java |   3 +
 .../common/policies/data/SubscriptionAuthMode.java |   6 +-
 .../common/policies/data/SubscriptionStats.java    |  29 +++---
 .../pulsar/common/policies/data/TenantInfo.java    |   7 +-
 .../pulsar/common/policies/data/TopicStats.java    |  28 +++---
 .../policies/data/WorkerFunctionInstanceStats.java |   8 +-
 .../pulsar/common/policies/data/package-info.java  |  22 +++++
 .../policies/impl/AutoFailoverPolicyFactory.java   |   3 +
 .../common/policies/impl/MinAvailablePolicy.java   |   9 +-
 .../policies/impl/NamespaceIsolationPolicies.java  |  39 ++++----
 .../impl/NamespaceIsolationPolicyImpl.java         |  25 ++---
 .../pulsar/common/policies/impl/package-info.java  |  22 +++++
 .../pulsar/common/policies/package-info.java       |  22 +++++
 .../apache/pulsar/common/protocol/ByteBufPair.java |   8 +-
 .../pulsar/common/protocol/CommandUtils.java       |   6 +-
 .../apache/pulsar/common/protocol/Commands.java    |  50 ++++++----
 .../org/apache/pulsar/common/protocol/Markers.java |  11 +--
 .../pulsar/common/protocol/PulsarDecoder.java      |   7 +-
 .../pulsar/common/protocol/PulsarHandler.java      |   9 +-
 .../pulsar/common/protocol/package-info.java       |  22 +++++
 .../common/protocol/schema/BytesSchemaVersion.java |  22 +++--
 .../protocol/schema/DeleteSchemaResponse.java      |   3 +
 .../common/protocol/schema/EmptyVersion.java       |   3 +
 .../schema/GetAllVersionsSchemaResponse.java       |   6 +-
 .../common/protocol/schema/GetSchemaResponse.java  |   3 +
 .../protocol/schema/IsCompatibilityResponse.java   |   3 +
 .../common/protocol/schema/LatestVersion.java      |   3 +
 .../protocol/schema/LongSchemaVersionResponse.java |   3 +
 .../common/protocol/schema/PostSchemaPayload.java  |   3 +
 .../common/protocol/schema/PostSchemaResponse.java |   3 +
 .../pulsar/common/protocol/schema/SchemaData.java  |   5 +-
 .../common/protocol/schema/SchemaInfoUtil.java     |   7 +-
 .../common/protocol/schema/SchemaVersion.java      |   3 +
 .../common/protocol/schema/package-info.java       |  22 +++++
 .../common/sasl/JAASCredentialsContainer.java      |  10 +-
 .../apache/pulsar/common/sasl/KerberosName.java    |  51 +++++-----
 .../pulsar/common/sasl/TGTRefreshThread.java       |   5 +-
 .../apache/pulsar/common/sasl/package-info.java    |  22 +++++
 .../apache/pulsar/common/stats/AllocatorStats.java |  15 +++
 .../common/stats/JvmDefaultGCMetricsLogger.java    |   9 +-
 .../pulsar/common/stats/JvmG1GCMetricsLogger.java  |   3 +
 .../pulsar/common/stats/JvmGCMetricsLogger.java    |   6 +-
 .../org/apache/pulsar/common/stats/JvmMetrics.java |  12 +--
 .../org/apache/pulsar/common/stats/Metrics.java    |  19 ++--
 .../apache/pulsar/common/stats/package-info.java   |  22 +++++
 .../common/util/ClientSslContextRefresher.java     |   5 +-
 .../apache/pulsar/common/util/DateFormatter.java   |   2 +-
 .../common/util/DefaultSslContextBuilder.java      |   1 +
 .../org/apache/pulsar/common/util/FieldParser.java |  56 +++++------
 .../common/util/FileModifiedTimeUpdater.java       |   7 +-
 .../org/apache/pulsar/common/util/FutureUtil.java  |   5 +-
 .../java/org/apache/pulsar/common/util/Hash.java   |   7 +-
 .../apache/pulsar/common/util/KeyStoreHolder.java  |   5 +
 .../apache/pulsar/common/util/Murmur3_32Hash.java  |   7 +-
 .../util/NamespaceBundleStatsComparator.java       |   1 -
 .../pulsar/common/util/NettySslContextBuilder.java |  10 +-
 .../apache/pulsar/common/util/NumberFormat.java    |   3 +
 .../pulsar/common/util/ObjectMapperFactory.java    |   1 +
 .../org/apache/pulsar/common/util/RateLimiter.java |  50 ++++------
 .../pulsar/common/util/RelativeTimeUtil.java       |   5 +-
 .../apache/pulsar/common/util/SecurityUtility.java |  28 +++---
 .../common/util/SslContextAutoRefreshBuilder.java  |   8 +-
 .../common/util/collections/ConcurrentBitSet.java  |   3 +
 .../util/collections/ConcurrentLongHashMap.java    |  20 ++--
 .../util/collections/ConcurrentLongPairSet.java    |  44 +++++----
 .../util/collections/ConcurrentOpenHashMap.java    |  17 ++--
 .../util/collections/ConcurrentOpenHashSet.java    |  19 ++--
 .../ConcurrentOpenLongPairRangeSet.java            |  21 ++--
 .../collections/ConcurrentSortedLongPairSet.java   |   9 +-
 .../collections/GrowableArrayBlockingQueue.java    |   7 +-
 .../collections/GrowablePriorityLongPairQueue.java |  39 ++++----
 .../common/util/collections/LongPairRangeSet.java  |  76 ++++++++------
 .../common/util/collections/LongPairSet.java       |  34 +++----
 .../util/collections/TripleLongPriorityQueue.java  |  26 ++---
 .../common/util/collections/package-info.java      |  22 +++++
 .../pulsar/common/util/netty/EventLoopUtil.java    |   6 +-
 .../pulsar/common/util/netty/package-info.java     |  22 +++++
 .../apache/pulsar/common/util/package-info.java    |  22 +++++
 .../util/protobuf/ByteBufCodedInputStream.java     |   5 +-
 .../util/protobuf/ByteBufCodedOutputStream.java    |   5 +-
 .../pulsar/common/util/protobuf/package-info.java  |  22 +++++
 .../policies/data/loadbalancer/BrokerUsage.java    |  14 +--
 .../policies/data/loadbalancer/JSONWritable.java   |   7 +-
 .../policies/data/loadbalancer/JvmUsage.java       |   2 +-
 .../data/loadbalancer/LoadManagerReport.java       |  43 ++++----
 .../policies/data/loadbalancer/LoadReport.java     |  13 ++-
 .../data/loadbalancer/LoadReportDeserializer.java  |   9 +-
 .../data/loadbalancer/LocalBrokerData.java         |  12 +--
 .../data/loadbalancer/NamespaceBundleStats.java    |  18 ++--
 .../policies/data/loadbalancer/NamespaceUsage.java |  28 +++---
 .../data/loadbalancer/ResourceUnitRanking.java     |  53 +++++-----
 .../policies/data/loadbalancer/ResourceUsage.java  |   5 +-
 .../data/loadbalancer/ServiceLookupData.java       |  12 ++-
 .../data/loadbalancer/SystemResourceUsage.java     |   4 +-
 .../policies/data/loadbalancer/package-info.java   |  22 +++++
 189 files changed, 1820 insertions(+), 873 deletions(-)

commit 73b8669b3601603e5d02bc6cc90a6ce96779c18f
Author: rshermanTHG <48561471+rshermanTHG@users.noreply.github.com>
Date:   Fri Aug 30 15:08:36 2019 +0100

    Remove duplicate data from views screen (#5074)

 dashboard/django/stats/views.py | 36 ++++++++++++++----------------------
 1 file changed, 14 insertions(+), 22 deletions(-)

commit bc766130c3add0e9ba2e3f1e4c4c59cefb1e15ea
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Fri Aug 30 11:00:05 2019 +0800

    Fix : ConsumerStatsTest.testAsyncCallOnPartitionedTopic is flaky (#5066)
    
    fix #4894
    
    ### Motivation
    
    Due to the concurrent execution of the program, when checking whether the BrokerConsumerStats's cache is in effect, there is no guarantee that the cache time will not be exceeded.
    
    ### Modifications
    
    - Check the cache in an inexact way.
    - Increase waiting time

 pulsar-client-cpp/tests/ConsumerStatsTest.cc | 28 +++++++++++++++++-----------
 1 file changed, 17 insertions(+), 11 deletions(-)

commit e78beaaf4815509dc906838aaf4057a6c1445d0b
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Aug 30 05:47:27 2019 +0800

    [doc] Improve Pulsar Security-athenz (#5053)
    
    ### Motivation
    Improve the language and the overall descriptive style of the Pulsar Security document ( Security-athenz section): http://pulsar.apache.org/docs/en/next/security-athenz/
    
    ### Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-athenz.md | 30 +++++++++++++++---------------
 1 file changed, 15 insertions(+), 15 deletions(-)

commit e231d22e5b04266348b5146c869a0b019a71725a
Author: Rui Fu <freeznet@users.noreply.github.com>
Date:   Fri Aug 30 05:43:50 2019 +0800

    [k8s] convert to valid pod name part with k8s function runtime (#4996)
    
    ### Motivation
    
    k8s runtime use tenant, namespace, functionName to create k8s pod name, but functionName might not meet the k8s pod name rule. `"[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*"`, which will cause pod create failed.
    
    ### Modifications
    
    This PR create a new function called `toValidPodName` which convert a string to valid pod name part, including convert to lower case and replace all non-char part to "-".

 .../functions/runtime/KubernetesRuntime.java       | 17 +++-
 .../functions/runtime/KubernetesRuntimeTest.java   | 97 ++++++++++++++++++++++
 2 files changed, 112 insertions(+), 2 deletions(-)

commit 783c4ad86877386a39c1c556cb6c42ae9e90f547
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Fri Aug 30 05:43:05 2019 +0800

    [doc] Improve Pulsar security-tls-transport (#5027)
    
    ## Motivation
    Improve the language and the overall descriptive style of the Transport Encryption using TLS document of Security chapter.
    
    ## Modifications
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-tls-transport.md | 92 ++++++++++++++++++------------------
 1 file changed, 47 insertions(+), 45 deletions(-)

commit d8db529dd0ca2edca8c23dd3f62ea46ad0f6f40b
Author: Steven Le Roux <steven@le-roux.info>
Date:   Thu Aug 29 21:01:34 2019 +0200

    [website] add OVH in Pulsar users (#5072)

 site2/website/data/users.js | 5 +++++
 1 file changed, 5 insertions(+)

commit 6a67ae094b5ecfa1a4602b8f7baff9a838b44e23
Author: double-bin <33393994+double-bin@users.noreply.github.com>
Date:   Fri Aug 30 01:06:41 2019 +0800

    modify BatcherBuilder interface and it's subs to implement java.io.Serializable (#5068)

 .../src/main/java/org/apache/pulsar/client/api/BatcherBuilder.java    | 4 +++-
 .../java/org/apache/pulsar/client/impl/DefaultBatcherBuilder.java     | 2 ++
 .../java/org/apache/pulsar/client/impl/KeyBasedBatcherBuilder.java    | 2 ++
 3 files changed, 7 insertions(+), 1 deletion(-)

commit f7aad577f73a5dbe3ff30b39b024bf1f8082cca6
Author: tuteng <eguangning@gmail.com>
Date:   Fri Aug 30 01:01:20 2019 +0800

    [website]Support multi version for swagger (#5032)
    
    * Support multi version for admin rest api
    
    * Support multi for functions, source and sinks rest api
    
    * Default version is master
    
    * generate swagger file for multi version
    
    * Generate swagger json for multi api
    
    * Add comment for copy file
    
    * Generate swagger file only to master

 site2/website/pages/en/admin-rest-api.js       |  5 ++---
 site2/website/pages/en/functions-rest-api.js   |  3 +--
 site2/website/pages/en/sink-rest-api.js        |  3 +--
 site2/website/pages/en/source-rest-api.js      |  3 +--
 site2/website/static/js/custom.js              | 15 +++++++++++----
 site2/website/static/js/getSwaggerByVersion.js | 24 ++++++++++++++++++++++++
 src/gen-swagger.sh                             |  9 +++++----
 7 files changed, 45 insertions(+), 17 deletions(-)

commit a4cfcd7868da02ee5782cc5496149af08c0c3afa
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Fri Aug 30 00:17:03 2019 +0800

    add different cache flags for size() and toString() (#5040)

 .../collections/ConcurrentOpenLongPairRangeSet.java  | 20 ++++++++++++--------
 .../ConcurrentOpenLongPairRangeSetTest.java          | 12 ++++++++++++
 2 files changed, 24 insertions(+), 8 deletions(-)

commit 83365ebd536af3b3575026a06d0b83cd506898d3
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 28 21:27:25 2019 -0700

    [website] Added more companies using Pulsar (#5063)
    
    * [website] Added more companies using Pulsar
    
    * Added 2 more companies and front page show case

 site2/website/data/users.js     | 43 +++++++++++++++++++++++++++++++++++++----
 site2/website/pages/en/index.js | 37 +++++++++++++++++++++++++++++++++++
 2 files changed, 76 insertions(+), 4 deletions(-)

commit b696d9002e1f9663c6f14efeb24fda869e2a328c
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Thu Aug 29 02:04:48 2019 +0800

    [doc] Improve Pulsar Security Overview (#5014)
    
    ### Motivation
    
    Improve the language and the overall descriptive style of the Pulsar Security Overview document part.
    
    ### Modifications
    
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-overview.md | 20 ++++++++------------
 1 file changed, 8 insertions(+), 12 deletions(-)

commit 8b0d726cc70d76eff326b90cc77f0a8d362c5c08
Author: Monica-zy <44013755+Monica-zy@users.noreply.github.com>
Date:   Wed Aug 28 13:30:21 2019 +0800

    [doc] Improve Pulsar Security-token-client (#5039)
    
    *Motivation*
    Improve the language and the overall descriptive style of the Pulsar Security document (security-token-client section): http://pulsar.apache.org/docs/en/next/security-token-client/
    
    *Modifications*
    Adjust the tone, personal pronouns, voice also some typo errors of some sentences in the document.

 site2/docs/security-token-client.md | 19 ++++++++-----------
 1 file changed, 8 insertions(+), 11 deletions(-)

commit 7e1c143b2871dbf4795f281b246152d0d2b4010a
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Wed Aug 28 13:29:37 2019 +0800

    [admin] extract schema support no null (#5048)
    
    ### Motivation
    
    admin schemas extract schema with always-allow-null by default which should be optional.
    
    ### Modifications
    
    * provide a option to disable always-allow-null;
    * provide a option to dry run and not apply to registry.

 .../org/apache/pulsar/admin/cli/CmdSchemas.java    | 31 +++++++++++++++++-----
 .../pulsar/admin/cli/utils/SchemaExtractor.java    | 11 +++++---
 2 files changed, 32 insertions(+), 10 deletions(-)

commit 9ed91ebde898aa5136c5a0c90009545876768d67
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Aug 27 19:12:05 2019 -0700

    Fix Port Manager (#5024)

 .../src/test/java/org/apache/bookkeeper/test/PortManager.java     | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit c32b4024d380169196ffcd8bee7ac8437d28345c
Author: Kezhu Wang <kezhuw@gmail.com>
Date:   Wed Aug 28 08:40:27 2019 +0800

    Fixes not owned bundles got selected when broker overloading (#5002)
    
    * Adds test to ensure only owned bundles got selected when broker overloading
    
    * Fixes not owned bundles got selected when broker overloading
    
    * fixup: bind ownerless bundle to another broker in testing code (2b9a2b071713cf9c0b321cde7f1272256091a809)

 .../apache/pulsar/broker/loadbalance/impl/OverloadShedder.java   | 4 +++-
 .../pulsar/broker/loadbalance/impl/OverloadShedderTest.java      | 9 +++++++++
 2 files changed, 12 insertions(+), 1 deletion(-)

commit 35f759070eb280aa54dee253c1a7b5d9863b807d
Author: lipenghui <penghui@apache.org>
Date:   Wed Aug 28 08:10:03 2019 +0800

    Reduce char[] creation on jvm heap. (#5055)
    
    ### Motivation
    
    Use MoreObjects at toString() method will resulting in the creation of a large number of chars []:
    ![image](https://user-images.githubusercontent.com/12592133/63762972-61cf5b00-c8f6-11e9-8d5f-12b2f949b601.png)
    
    Here is source of large number of calls to this method:
    
    https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/AbstractBaseDispatcher.java#L77
    
    https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/nonpersistent/NonPersistentDispatcherSingleActiveConsumer.java#L70
    
    https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/nonpersistent/NonPersistentDispatcherMultipleConsumers.java#L205
    
    https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/nonpersistent/NonPersistentStickyKeyDispatcherMultipleConsumers.java#L92
    
    So this PR reduce the char[] creation on jvm heap while call subscription.toString().
    
    ### Modifications
    
    Change implementation of subscription.toString()

 .../broker/service/nonpersistent/NonPersistentSubscription.java    | 7 ++++---
 .../pulsar/broker/service/persistent/PersistentSubscription.java   | 7 ++++---
 2 files changed, 8 insertions(+), 6 deletions(-)

commit 588b166db9a0fa13d7046bf26066dbbe6c96b468
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Wed Aug 28 07:31:55 2019 +0800

    [schema] support uploading key/value schema using Pulsar admin (#5000)
    
    ### Motivation
    To fix #4840

 .../pulsar/broker/admin/v2/SchemasResource.java    | 76 ++++++++++++----------
 .../pulsar/broker/admin/AdminApiSchemaTest.java    | 10 +++
 .../pulsar/client/admin/internal/SchemasImpl.java  | 12 +++-
 3 files changed, 60 insertions(+), 38 deletions(-)

commit 41430ce01e3c6128c20591f62608d5bb1d442e26
Author: tuteng <eguangning@gmail.com>
Date:   Wed Aug 28 06:57:58 2019 +0800

    [Pulsar IO]Support reload Source and Sink for Pulsar IO (#5008)
    
    Fixes: https://github.com/apache/pulsar/issues/4904
    
    Master Issue: https://github.com/apache/pulsar/issues/4904
    
    ### Motivation
    
    At present, pulsar can only load the built-in connector when starting the service, but some users want to automatically load the feature of the connector, which is very useful when adding, updating and deleting the built-in connector.
    
    ### Modifications
    
    * Add reload rest API for source and sink
    
    ### Verifying this change
    
    I haven't found an automated integration testing method for this API. If there is a better method, please let me know.
    
    I just verified it in the following way:
    ```
    ./bin/pulsar-admin sources available-sources
    mv pulsar-io-debezium-mysql-2.4.0.nar ./connectors
    ./bin/pulsar-admin sources reload
    ./bin/pulsar-admin sources available-sources
    
    ./bin/pulsar-admin sinks available-sinks
    mv pulsar-io-jdbc-2.4.0.nar ./connectors
    ./bin/pulsar-admin sinks reload
    ./bin/pulsar-admin sinks available-sinks
    ```

 .../apache/pulsar/broker/admin/impl/SinksBase.java | 15 ++++++++++++++
 .../pulsar/broker/admin/impl/SourcesBase.java      | 15 ++++++++++++++
 .../java/org/apache/pulsar/client/admin/Sinks.java |  8 ++++++++
 .../org/apache/pulsar/client/admin/Sources.java    |  9 +++++++++
 .../pulsar/client/admin/internal/SinksImpl.java    | 10 ++++++++++
 .../pulsar/client/admin/internal/SourcesImpl.java  | 10 ++++++++++
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 10 ++++++++++
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 10 ++++++++++
 .../pulsar/functions/worker/ConnectorsManager.java |  6 +++++-
 .../functions/worker/rest/api/ComponentImpl.java   | 17 ++++++++++++++++
 site2/docs/reference-connector-admin.md            | 23 ++++++++++++++++++++++
 11 files changed, 132 insertions(+), 1 deletion(-)

commit 147c3c8d29b9e1feda5f976c0d00503750538551
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Wed Aug 28 06:57:04 2019 +0800

    Add compatibility check for primitive schema types (#5051)
    
    ### Motivation
    To fix #4831

 .../service/schema/SchemaRegistryServiceImpl.java  |  6 ++-
 .../tests/integration/schema/SchemaTest.java       | 61 ++++++++++++++++++++++
 2 files changed, 66 insertions(+), 1 deletion(-)

commit d22e0143513c61fe7584deef2eeba913189153c1
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 27 08:43:06 2019 -0700

    Reload zk cache asynchronously (#5049)

 .../apache/pulsar/zookeeper/ZooKeeperDataCache.java   | 19 ++++++++++---------
 1 file changed, 10 insertions(+), 9 deletions(-)

commit 40d6248e380c2ece65d90897675be205090aa115
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Aug 27 08:42:15 2019 -0700

    Fix pulsar sink and source state (#5046)

 .../pulsar/functions/instance/ContextImpl.java     |  16 +-
 .../functions/instance/JavaInstanceRunnable.java   |   6 +-
 .../pulsar/functions/instance/ContextImplTest.java |  25 +-
 tests/docker-images/java-test-functions/pom.xml    |   7 +
 .../pulsar/tests/integration/io/TestStateSink.java |  51 ++++
 .../tests/integration/io/TestStateSource.java      |  54 +++++
 .../integration/functions/PulsarStateTest.java     | 257 ++++++++++++++++++++-
 7 files changed, 387 insertions(+), 29 deletions(-)

commit 4ba8b6dccce6f947693c36ca035b7f5e92d207ce
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 27 08:40:53 2019 -0700

    [pulsar-broker] add broker-bookie mTLS support (#5042)
    
    * [pulsar-broker] add broker-bookie mTLS support
    
    * add default values

 conf/broker.conf                                   | 28 ++++++++++++++++++++
 conf/standalone.conf                               | 29 +++++++++++++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java | 30 ++++++++++++++++++++++
 .../pulsar/broker/BookKeeperClientFactoryImpl.java | 12 +++++++++
 4 files changed, 99 insertions(+)

commit c56ad9d3018eb00210ec3340e7078db3922b2985
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Aug 27 08:40:24 2019 -0700

    Change method name to avoid being run as test (#5044)

 .../apache/pulsar/websocket/proxy/ProxyAuthenticationTest.java    | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 99289f82315ac20a3f867bb519bc2967000ca097
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Aug 27 23:38:51 2019 +0800

    add more powered-by company (#5054)

 site2/website/data/users.js          | 55 +++++++++++++++++++++++++++++++++++-
 site2/website/pages/en/powered-by.js | 53 +++++++++++++++++++---------------
 site2/website/static/css/custom.css  | 12 ++++++++
 3 files changed, 97 insertions(+), 23 deletions(-)

commit 0af35274553d5fb25a165c0d3162a0d10b8264f1
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Tue Aug 27 02:13:14 2019 +0800

    Add Connector Admin CLI guide (#5028)
    
    * Remove connector related contents from Pulsar admin CLI guide
    * Add an independent guide: Connector Admin CLI

 site2/docs/reference-connector-admin.md | 577 ++++++++++++++++++++++++++++++++
 site2/docs/reference-pulsar-admin.md    | 503 +---------------------------
 site2/website/sidebars.json             |   1 +
 3 files changed, 583 insertions(+), 498 deletions(-)

commit 0b1e3b379aff4de55b86b0d2570d2db1b35eb346
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Aug 26 09:28:48 2019 -0700

    [pulsar-perf] Introduce number of threads in perf producer program (#5036)
    
    *Motivation*
    
    Allow spinning up multiple threads for running the perf-producer.
    
    *Modifications*
    
    - Introduce a new option for configuring multiple threads
    - Each thread has one separate pulsar client

 .../pulsar/testclient/PerformanceProducer.java     | 358 ++++++++++++---------
 1 file changed, 201 insertions(+), 157 deletions(-)

commit dc7ce39f59d62bab29907d416c0c55fd8cfe3ada
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Tue Aug 27 00:25:29 2019 +0800

    [pulsar-client-cpp] cmake isolate auto gen srcs (#5013)

 pulsar-client-cpp/.gitignore           |  7 +++----
 pulsar-client-cpp/CMakeLists.txt       |  4 ++++
 pulsar-client-cpp/lib/CMakeLists.txt   | 17 ++++++++++++-----
 pulsar-client-cpp/tests/CMakeLists.txt |  2 +-
 4 files changed, 20 insertions(+), 10 deletions(-)

commit 8d32b588e2ccba31fbd41e7d508400de20a71405
Author: Chris Bartholomew <chris.bartholomew@kafkaesque.io>
Date:   Mon Aug 26 02:36:01 2019 -0400

    Adding back Prometheus TYPE definitions; fixed duplicate TYPE errors; fixed format issue in metricWithRemoteCluster; added test for Prometheus types (#4183)
    
    Fixes #3112
    
    ### Motivation
    
    In this pull request, I set out to fix #3112, which is caused by duplicate TYPE statements in the metrics output which leads to parsing of Prometheus metrics to fail in recent versions of Prometheus. Because of this, Prometheus will report the broker target as down.
    
    Since I started looking at this, the type definitions have been removed (#4136) from topics metric output. I think these types are useful in Prometheus and have added them back in.
    
    While testing this fix in my geo-replicated setup, I found a format in error (missing quote and comma) in the TopicStats.metricWithRemoteCluster method. This pull request includes a fix for that issue.
    
    I have also added a new test to PrometheusMetricsTest.java that fails without these changes but passed with them.
    
    ### Modifications
    
    I added a static HashMap to TopicStats to keep track of the TYPEs that have been output. All writing of the TYPE for topics and namespaces is done with the TopicStats.metricType method. I modified that method to update the HashMap and only print the TYPE out for the first occurrence of the metric name.  I also added a method reset the HashMap, which gets called in NamespaceStatsAggregator.generate.
    
    ### Verifying this change
    
    This change added tests and can be verified as follows:
      - Added testDuplicateMetricTypeDefinitions which checks for:
           - duplicate TYPE definitions in the Prometheus output
           - validates that no TYPE definition appears after the first metric sample
           - ensures that all metrics have a defined type
    
    I execute the test twice to make sure the resetting of the HashMap of the already seen metric type definitions works correctly. This test passes for me reliably (both occurrences).
    
    I have confirmed using promtool that the metrics output will now parse without error using versions 2.7.1 and 2.9.2 (which is the latest). There are many warnings around missing HELP definitions and metrics using reserved suffixes (ex. _count), but no errors.
    
    In addition, I have patched 2.3.1 with this fix and am currently running it in my cluster. Prometheus (2.7.1) successfully parses the metrics and I am able to see namespace and topic-level metrics.

 .../stats/prometheus/NamespaceStatsAggregator.java |  5 ++
 .../pulsar/broker/stats/prometheus/TopicStats.java | 23 +++++
 .../pulsar/broker/stats/PrometheusMetricsTest.java | 97 ++++++++++++++++++++++
 3 files changed, 125 insertions(+)

commit bf9489093639facb8f86e37a87b47bb82bcde5ce
Author: Jia Zhai <zhaijia@apache.org>
Date:   Mon Aug 26 14:34:13 2019 +0800

    Add support in cpp client for 1 partitioned topic (#5016)
    
    ### Motivation
    
    IN PR #4883, we support 1 partitioned topic producer/consumer in java client. this is for Cpp client support.
    
    ### Modifications
    - change cpp client
    - add unit test
    
    ### Verifying this change
    New added Ut Passed

 pulsar-client-cpp/lib/ClientImpl.cc              |  8 +--
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc | 16 +++---
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 69 ++++++++++++++++++++++++
 3 files changed, 82 insertions(+), 11 deletions(-)

commit 4fa87a4822c550cd81a5d8d646452157d1f481d5
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Mon Aug 26 12:16:34 2019 +0800

    [dashboard] fix admin path (#5030)
    
    access v1/v2 admin api by namespace name pattern

 dashboard/django/stats/urls.py  |   6 +--
 dashboard/django/stats/views.py | 102 +++++++++++++++++++++++++++++++---------
 2 files changed, 83 insertions(+), 25 deletions(-)

commit ff418717dd30f001cbd579c4fa1038a96fa894bb
Author: Chris Bartholomew <chris.bartholomew@kafkaesque.io>
Date:   Sun Aug 25 21:47:19 2019 -0400

    Clarification in DLQ documentation (#5029)
    
    Clarification in DLQ documentation.

 site2/docs/concepts-messaging.md | 25 +++++++++++++++++++++++--
 1 file changed, 23 insertions(+), 2 deletions(-)

commit 6ef39edebb55bc79aeba0c213b6c9d2b3f47eb42
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Mon Aug 26 06:13:32 2019 +0800

    [doc] Pulsar Functions: CLI (#4968)
    
    * add functions-configure
    
    * Update some typos
    
    * Update functions-configure
    
    * rename functions-cli
    
    * Update file name and sidebar
    
    * Update a typo

 site2/docs/functions-cli.md | 195 ++++++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json |   1 +
 2 files changed, 196 insertions(+)

commit a3609ef0947a0d2c3fe7c2ad3a8f9cda7d4ebd62
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Mon Aug 26 06:13:05 2019 +0800

    Consumer subscribe with AutoConsumeSchema will throw npe  (#4960)
    
    ### Motivation
    To fix #4838

 .../org/apache/pulsar/client/impl/MessageImpl.java |   2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  11 +-
 .../client/impl/schema/AutoConsumeSchema.java      |  53 +++++++--
 .../tests/integration/schema/SchemaTest.java       | 121 ++++++++++++++-------
 .../pulsar/tests/integration/schema/Schemas.java   |   6 +
 5 files changed, 141 insertions(+), 52 deletions(-)

commit dd5b4d08ead655dd4917944779bff1702f48f52c
Author: tuteng <eguangning@gmail.com>
Date:   Mon Aug 26 06:10:01 2019 +0800

    [docker]Fix the problem of missing dependencies less (#5034)
    
    Fixes https://github.com/apache/pulsar/issues/4957
    
    Master Issue: https://github.com/apache/pulsar/issues/4957
    
    ### Motivation
    
    Currently, when packaging the docker image, the dependency less is lost, resulting in the following exception being thrown when presto SQL is running
    ```
    Cannot run program "less": error=2, No such file or directory
    ```
    
    ### Modifications
    
    * Add dependency less

 docker/pulsar/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d3f30fcf242df3088700ff4ef25c3557933c9a55
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Mon Aug 26 06:09:14 2019 +0800

    [dashboard] fix format single message raw bytes (#5031)
    
    `format_single_message` method only receive bytes data

 dashboard/django/stats/views.py | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)

commit 6b6bc529cfe890aa4dfa8d9a67e2d8f00a46643e
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Aug 25 08:44:35 2019 -0700

    Added powered-by page (#5018)
    
    * Added powered-by page
    
    * Renamed to Yahoo! JAPAN
    
    * Added Kafkaesque

 site2/website/core/Footer.js         |   2 +
 site2/website/data/users.js          | 132 +++++++++++++++++++++++++++++++++++
 site2/website/pages/en/powered-by.js |  51 ++++++++++++++
 site2/website/static/css/custom.css  |  39 ++++++++++-
 4 files changed, 221 insertions(+), 3 deletions(-)

commit c3cb5ebb5b122593d5903923f506738fd6b2cbef
Author: tuteng <eguangning@gmail.com>
Date:   Sat Aug 24 00:15:28 2019 +0800

    ### Motivation (#4991)
    
    Fixes https://github.com/apache/pulsar/issues/4990
    
    Master Issue: https://github.com/apache/pulsar/issues/4990
    
    ### Motivation
    [pjax-api](https://github.com/falsandtru/pjax-api) conflicts with [scrollSpy](https://github.com/facebook/docusaurus/blob/e486d3d1b0e0a397f242368357fbedbe767104c7/packages/docusaurus-1.x/lib/static/js/scrollSpy.js). Cause that cache headingsCache used by variable findHeadings to not be update correctly.
    
    Modifications
    * Delete file pjax-api.min.js
    
    ### Verifying this change
    
    Run ok locally

 site2/website/core/Footer.js            | 16 ----------------
 site2/website/static/js/pjax-api.min.js |  4 ----
 2 files changed, 20 deletions(-)

commit 40fbf5d625412f7c71feea66000a9d756f81048d
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Sat Aug 24 00:15:10 2019 +0800

    support parse batch entry payload (#4992)

 dashboard/Dockerfile                               |   6 +-
 .../django/stats/templates/stats/messages.html     |  35 +++++--
 dashboard/django/stats/views.py                    | 114 +++++++++++++++++----
 dashboard/django/utils/__init__.py                 |  19 ++++
 dashboard/django/utils/import_utils.py             |  27 +++++
 dashboard/requirements.txt                         |   8 ++
 pulsar-client-cpp/include/pulsar/Message.h         |   3 +
 pulsar-client-cpp/include/pulsar/MessageBatch.h    |  49 +++++++++
 pulsar-client-cpp/include/pulsar/MessageId.h       |  10 +-
 pulsar-client-cpp/lib/Commands.h                   |   5 +-
 pulsar-client-cpp/lib/Message.cc                   |   2 +
 pulsar-client-cpp/lib/MessageBatch.cc              |  57 +++++++++++
 pulsar-client-cpp/python/pulsar/__init__.py        |  42 ++++++++
 pulsar-client-cpp/python/src/message.cc            |  17 +++
 pulsar-client-cpp/python/src/utils.h               |   1 +
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  61 ++++++++---
 16 files changed, 402 insertions(+), 54 deletions(-)

commit 687406eb68ba164d342173938ebada6f4644e1e5
Author: Guillaume Braibant <guillaume.braibant@outlook.com>
Date:   Fri Aug 23 18:14:40 2019 +0200

    Admin pod should use broker service to discover broker pods (#4995)
    
    ### Motivation
    
    Add enhancement proposed in #4978
    
    ### Changes
    
    deployment/kubernetes/generic/original/admin.yaml :
    
    - Use broker service to discover broker pods instead of using proxy service to do so.
    
    deployment/kubernetes/generic/k8s-1-9-and-above/admin.yaml :
    
    - Use broker service to discover broker pods instead of using proxy service to do so
    
    ### Testing coverage
    
    Changes have been tested on a fresh Digital Ocean managed Kubernetes cluster. A producer and a consumer were created as described in the "Experimenting with your cluster" section of the documentation (cf. https://pulsar.apache.org/docs/en/deploy-kubernetes).

 deployment/kubernetes/generic/k8s-1-9-and-above/admin.yaml | 4 ++--
 deployment/kubernetes/generic/original/admin.yaml          | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 958dcfee764285f12044d2b626960968569c7302
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Fri Aug 23 07:44:35 2019 +0800

    Modify rest api post schema compatibility strategy (#4950)
    
    ### Motivation
    To fix #4821

 .../apache/pulsar/broker/admin/AdminResource.java  | 31 ++++++++++
 .../pulsar/broker/admin/v2/SchemasResource.java    | 66 ++++++++++++++--------
 .../pulsar/broker/admin/AdminApiSchemaTest.java    | 42 ++++++++++++++
 3 files changed, 115 insertions(+), 24 deletions(-)

commit ee158d9fe558457fa4ad3ff057b15ebecc1871a7
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Fri Aug 23 02:00:19 2019 +0900

    Upgrade jackson-databind (#5011)

 distribution/server/src/assemble/LICENSE.bin.txt | 16 ++++++++--------
 pom.xml                                          |  5 +++--
 pulsar-sql/pom.xml                               |  2 +-
 pulsar-sql/presto-distribution/LICENSE           |  2 +-
 pulsar-sql/presto-distribution/pom.xml           |  2 +-
 5 files changed, 14 insertions(+), 13 deletions(-)

commit 27a9f628780a15e2e06b7dac28cb3f72c94b1e51
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Aug 22 11:34:28 2019 -0500

    Need to reinitialize certain components for externally managed runtimes when moving functions (#5007)

 .../functions/runtime/KubernetesRuntime.java       | 24 +++++++++++++++-------
 .../apache/pulsar/functions/runtime/Runtime.java   |  4 ++++
 .../functions/worker/FunctionRuntimeManager.java   |  7 ++-----
 .../worker/FunctionRuntimeManagerTest.java         |  5 ++++-
 4 files changed, 27 insertions(+), 13 deletions(-)

commit 4cf35167f3e267304c014d936bf34b588a8e78b4
Author: Rui Fu <freeznet@users.noreply.github.com>
Date:   Thu Aug 22 04:44:47 2019 +0800

    fix docker image not have cpp client installed (#4986)

 docker/pulsar/Dockerfile                      |  5 +++++
 docker/pulsar/pom.xml                         | 28 +++++++++++++++++++++++++++
 pulsar-client-cpp/pkg/deb/docker-build-deb.sh |  2 +-
 3 files changed, 34 insertions(+), 1 deletion(-)

commit e8b4eddf0acf59b49d82f8bb62acdab9cb08027a
Author: tuteng <eguangning@gmail.com>
Date:   Thu Aug 22 04:44:12 2019 +0800

    ### Motivation (#4999)
    
    In the official download address of the connector, the connector of Flume, Solr and Redis was not generated correctly.
    
    ### Modifications
    * Add configuration to io.xml for generate connectors

 distribution/io/src/assemble/io.xml | 3 +++
 1 file changed, 3 insertions(+)

commit 56310678100674d8697168dafb1a732d0a314c60
Author: Sijie Guo <sijie@apache.org>
Date:   Wed Aug 21 10:11:19 2019 +0800

    [doc] Add a documentation page for metrics reference (#4910)
    
    *Motivation*
    
    Add a documentation page for metrics reference

 site2/docs/reference-metrics.md | 243 ++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json     |   3 +-
 2 files changed, 245 insertions(+), 1 deletion(-)

commit bd8abcc7ba020be3dbfd85bc0c6e9363138bca93
Author: Guillaume Braibant <guillaume.braibant@outlook.com>
Date:   Tue Aug 20 15:37:11 2019 +0200

    Fix pull request 4700 (#4951)
    
    ### Purpose
    
    Fixes pull request #4700
    
    ### Motivation
    
    The updated API (using v1/apps for Workload API objects like DaemonSet, StatefulSet, and Deployment) introduced in #4700 requires a LabelSelector object for each Deployment, DaemonSet, and SatetfulSet object. The #4700 does not include those LabelSelector objects. This causes  the rejection of the K8S generic deployment scripts by the K8S API validator.
    
    ### Changes
    
    _deployment/kubernetes/generic/k8s-1-9-and-above/bookie.yml :_
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the DaemonSet:spec object
    
    _deployment/kubernetes/generic/k8s-1-9-and-above/broker.yml :_
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the Deployment:spec object .
    
    _deployment/kubernetes/generic/k8s-1-9-and-above/monitoring.yml :_
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the Deployment:spec object for Prometheus.
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the Deployment:spec object for Grafana.
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the Deployment:spec object for the Pulsar Dashboard.
    
    _deployment/kubernetes/generic/k8s-1-9-and-above/proxy.yml :_
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the Deployment:spec object.
    
    _deployment/kubernetes/generic/k8s-1-9-and-above/proxy.yml :_
    
    - Add a LabelSelector object matching pods labels (required by API)
     to the StatefulSet:spec object.
    
    - Changing StatefulSet:spec:template:metadata:labels:cluster from 'us-central' to 'local'. All other scripts assume cluster is 'local' and not 'us-central'.
    
    ### Testing coverage
    
    - All scripts have been succefully applied to a fresh Minikube cluster without rejection
    - Cluster experiment (through admin pod) with a production rate of 100 has been done
    - Monitoring has NOT been tested (deployed but not functionally tested)

 .../kubernetes/generic/k8s-1-9-and-above/bookie.yaml      |  5 +++++
 .../kubernetes/generic/k8s-1-9-and-above/broker.yaml      |  5 +++++
 .../kubernetes/generic/k8s-1-9-and-above/monitoring.yaml  | 15 +++++++++++++++
 .../kubernetes/generic/k8s-1-9-and-above/proxy.yaml       |  5 +++++
 .../kubernetes/generic/k8s-1-9-and-above/zookeeper.yaml   |  8 +++++++-
 5 files changed, 37 insertions(+), 1 deletion(-)

commit aa775721af8e6c78ef3c3f61e7b76620f5970078
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Aug 20 12:02:55 2019 +0800

    [transaction] Add transaction coordinator client (#4953)
    
    *Motivation*
    
    Add the interface of transaction coordinator client. So that it can be used
    by coordinator for committing transactions on topics and subscriptions.
    
    NOTE: this PR is only introducing the interface. The implementation will come
    in subsequent pull requests

 .../transaction/TransactionCoordinatorClient.java  | 80 ++++++++++++++++++++++
 .../TransactionCoordinatorClientImpl.java          | 59 ++++++++++++++++
 .../client/impl/transaction/package-info.java      | 22 ++++++
 3 files changed, 161 insertions(+)

commit 385a0368c3b878c49b8e907395eedf180f6e9d3c
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Tue Aug 20 12:00:54 2019 +0800

    [pulsar-client-cpp] fix snappy compressor compile error (#4972)
    
    Fixes #4720
    ### Motivation
    
    for now, the snappy compressor can not be compiled successfully,
    which raise undeclared identifier and no matching function errors.
    
    ### Modifications
    
    fix compile errors, use snappy c++ apis.

 pulsar-client-cpp/docker-build.sh                  |  2 +-
 pulsar-client-cpp/docker-lib-check.sh              | 23 +++++++++++++
 pulsar-client-cpp/docker-tests.sh                  |  2 +-
 pulsar-client-cpp/lib/CompressionCodecSnappy.cc    | 35 +++++++-------------
 pulsar-client-cpp/lib/CompressionCodecSnappy.h     |  2 +-
 .../tests/CompressionCodecSnappyTest.cc            | 38 ++++++++++++++++++++++
 6 files changed, 76 insertions(+), 26 deletions(-)

commit d49e61e0907c30d71184da4eb769c9761456a80f
Author: tuteng <eguangning@gmail.com>
Date:   Mon Aug 19 19:25:19 2019 +0800

    Add default loader for latest pyyaml (#4974)
    
    Fixes https://github.com/apache/pulsar/issues/4956
    
    
    Master Issue: https://github.com/apache/pulsar/issues/4956
    
    ### Motivation
    
    In the latest version of pyyaml, using load will issue a warning and explain some reasons here https://github.com/yaml/pyyaml/wiki/PyYAML-yaml.load(input)-Deprecation.
    
    ### Modifications
    
    * Use yaml.FullLoader as default loader

 docker/pulsar/scripts/gen-yml-from-env.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 676fd71a7c00b1e016dccc22878bf08e42449da6
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Aug 19 17:41:42 2019 +0800

    Fix the getSchema logic in pulsar proxy (#4975)
    
    *Motivation*
    
    The getSchema logic in Pulsar proxy handler doesn't handle the case that
    the request doesn't have schema version.
    
    *Modification*
    
    - Fix the logic to handle the case that a GetSchema request doesn't have schema version.
    - Forward the GetSchemaResponse back to the client
    
    *Tests*
    
    The GetSchema tests in ProxyTest was disabled by mistake. Turn it on.

 .../org/apache/pulsar/client/impl/ClientCnx.java   | 38 +++++++++++++---------
 .../apache/pulsar/common/protocol/Commands.java    | 15 ++++++++-
 .../pulsar/proxy/server/LookupProxyHandler.java    | 26 ++++++++-------
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  4 +--
 4 files changed, 53 insertions(+), 30 deletions(-)

commit 41bc407e1642aec3805d0f077694edd835b3ea1c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Aug 18 14:10:59 2019 -0700

    Fix: NPE while cleaning up namespace node (#4965)

 .../java/org/apache/pulsar/broker/namespace/ServiceUnitZkUtils.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 33441ea0d13322f3d444de8781e8c4c655e6a61e
Author: marcusalmeida <marcusmage@gmail.com>
Date:   Sun Aug 18 14:01:34 2019 -0300

    fixing python function example custom_object_function.py (#4946)

 pulsar-functions/python-examples/custom_object_function.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 1691cc822606a4f5815175888e746dbdbcccb6e2
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Aug 19 01:00:47 2019 +0800

    [Transaction] Introduce Transaction Client API (#4952)
    
    *Motivation*
    
    Introduce the transaction API to setup the skeleton on implementing
    the transactional client.
    
    Also add an example to show how to use the transaction API.
    
    *Modifications*
    
    - Add TransactionBuilder and Transaction
    - Add `newTransaction` to client
    - Add `newMessage(Transaction)` method to producer
    - Add `acknowledgeAsyc(MessageId, Transaction)` method to consumer
    
    NOTE: these methods are only exposed to the implementation classes (ProducerImpl, ProducerImpl, and ConsumerImpl).
    Will only add them to the interfaces when the features are completed.

 .../apache/pulsar/client/impl/RawReaderImpl.java   |   2 +-
 .../org/apache/pulsar/client/api/package-info.java |  22 ++++
 .../pulsar/client/api/transaction/Transaction.java |  42 +++++++
 .../client/api/transaction/TransactionBuilder.java |  50 ++++++++
 .../client/api/transaction/package-info.java       |  22 ++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  51 +++++++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  12 +-
 .../client/impl/MultiTopicsConsumerImpl.java       |   7 +-
 .../apache/pulsar/client/impl/ProducerBase.java    |  18 +++
 .../pulsar/client/impl/PulsarClientImpl.java       |  13 +++
 .../client/impl/TypedMessageBuilderImpl.java       |  42 ++++++-
 .../impl/transaction/TransactionBuilderImpl.java   |  55 +++++++++
 .../client/impl/transaction/TransactionImpl.java   | 129 +++++++++++++++++++++
 .../pulsar/client/examples/TransactionExample.java |  98 ++++++++++++++++
 14 files changed, 550 insertions(+), 13 deletions(-)

commit 2c2150014708e6bd2522ee4525f36195d911acae
Author: Rui Fu <freeznet@users.noreply.github.com>
Date:   Sun Aug 18 20:36:00 2019 +0800

    prevent fd leakage when WorkerUtils.downloadFromBookkeeper (#4970)
    
    Fixes #4969
    
    ### Motivation
    
    close `FileOutputStream` after `WorkerUtils.downloadFromBookkeeper`

 .../java/org/apache/pulsar/functions/worker/FunctionActioner.java   | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 93d95c74890b69ef79dce280d4e407f3fc9cdfb8
Author: Jia Zhai <zhaijia@apache.org>
Date:   Sun Aug 18 15:39:37 2019 +0800

    expose getLastMessageId method in ConsumerImpl (#4911)
    
    Fixes #4909
    ### Motivation
    
    It would be good to expose method `getLastMessageId` in `ConsumerImpl` to a public method.
    eg. some times user would like to know the lag messages; or only consume messages before current time.
    
    ### Modifications
    
    - expose method `getLastMessageId` in consumer api.
    - add unit test.
    
    ### Verifying this change
    Ut passed

 .../pulsar/client/impl/TopicsConsumerImplTest.java | 101 +++++++++-
 .../pulsar/client/impl/v1/ConsumerV1Impl.java      |   7 +
 .../org/apache/pulsar/client/api/Consumer.java     |  14 ++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  29 ++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   3 +-
 .../pulsar/client/impl/MultiMessageIdImpl.java     | 111 +++++++++++
 .../client/impl/MultiTopicsConsumerImpl.java       |  32 +++
 .../pulsar/client/impl/MessageIdCompareToTest.java | 221 +++++++++++++++++++++
 .../pulsar/PulsarConsumerSourceTests.java          |  10 +
 9 files changed, 517 insertions(+), 11 deletions(-)

commit 1c3b6f2f3071a01d257366af2ed6f97a64493c0e
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Sun Aug 18 13:06:34 2019 +0800

    [dashboard] integrate peek into messages page (#4966)
    
    ### Motivation
    
    messages page with full list would be under huge load if there are massive messages in backlog.
    
    ### Modifications
    
    - render messages with a prompt and input to choose which message to peek instead of full backlog message list, and render message peeked within messages page.
    - distinguish admin v1/v2 path from namespace.

 dashboard/django/stats/models.py                   |  6 ++
 dashboard/django/stats/static/stats/additional.css | 54 +++++++++++++++
 .../django/stats/templates/stats/messages.html     | 43 +++++++++++-
 dashboard/django/stats/templates/stats/peek.html   | 25 -------
 dashboard/django/stats/urls.py                     |  1 -
 dashboard/django/stats/views.py                    | 81 +++++++++++++---------
 6 files changed, 147 insertions(+), 63 deletions(-)

commit f859da9e0e290c49c080f046d34d9a64334d8c68
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Fri Aug 16 20:44:30 2019 +0800

    Add schema admin api  get schema info with schema version (#4877)
    
    ### Motivation
    
    To fix #4854 and support get keyValueSchema

 .../pulsar/broker/admin/v2/SchemasResource.java    | 12 +++-
 .../pulsar/broker/admin/AdminApiSchemaTest.java    | 26 ++++++++
 .../org/apache/pulsar/client/admin/Schemas.java    | 10 ++++
 .../pulsar/client/admin/internal/SchemasImpl.java  | 35 ++++++++++-
 .../client/internal/DefaultImplementation.java     | 40 +++++++++++++
 .../common/schema/SchemaInfoWithVersion.java       | 43 ++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdSchemas.java    |  7 +--
 .../pulsar/client/impl/schema/SchemaUtils.java     | 69 +++++++++++++++++++++-
 .../client/impl/schema/KeyValueSchemaInfoTest.java | 18 +++++-
 .../pulsar/client/impl/schema/SchemaTestUtils.java | 11 ++++
 10 files changed, 262 insertions(+), 9 deletions(-)

commit 0367f5f0a236b26cfec74b272ca44a4c77eceda1
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Fri Aug 16 10:46:42 2019 +0800

    Fix StructSchema reader cache loading logic
    
    ### Motivation
    StructSchema LoadingCache for cache reader, but key is byte[], it will compare with the address's  hashcode. So every decode will generate a new reader so we should change the type of the key for LoadingCache

 .../java/org/apache/pulsar/client/impl/schema/AvroSchema.java |  9 +++++----
 .../java/org/apache/pulsar/client/impl/schema/JSONSchema.java |  3 ++-
 .../org/apache/pulsar/client/impl/schema/ProtobufSchema.java  |  3 ++-
 .../org/apache/pulsar/client/impl/schema/StructSchema.java    | 11 ++++++-----
 .../pulsar/client/impl/schema/generic/GenericAvroSchema.java  | 11 ++++++-----
 .../pulsar/client/impl/schema/generic/GenericJsonSchema.java  | 11 ++++++-----
 6 files changed, 27 insertions(+), 21 deletions(-)

commit 900d81ae701b3199a86b3a026eb120747da23987
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Aug 15 09:33:25 2019 +0800

    [Doc] Add Notes for *Create Topic*
    
    Fix #4897

 site2/docs/admin-api-non-persistent-topics.md | 10 ++++++++++
 site2/docs/admin-api-partitioned-topics.md    | 20 ++++++++++++++++++++
 site2/docs/reference-pulsar-admin.md          | 20 ++++++++++++++++++++
 3 files changed, 50 insertions(+)

commit c5ba52983fee994de61984aae7d1757e9b738caf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Aug 14 07:04:20 2019 -0700

    [pulsar-broker] Fix expiry monitor to continue on non-recoverable error (#4818)
    
    ### Motivation
    
    In #1046, we have added a flag (`autoSkipNonRecoverableData`) and mechanism to recover cursor if ledger data is deleted. However, expiery-monitor doesn't use that flag and it gets stuck when it finds non-recoverable ml-error while cleaning up expired message.
    
    ### Modification
    Expiry-monitor can skip non-recoverable managed-ledger exception (eg: data/ledger doesn't exist anymore) when `autoSkipNonRecoverableData` flag is enabled.

 .../apache/bookkeeper/mledger/AsyncCallbacks.java  |  3 +-
 .../apache/bookkeeper/mledger/ManagedCursor.java   |  7 ++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 15 +++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  4 +
 .../bookkeeper/mledger/impl/OpFindNewest.java      |  5 +-
 .../mledger/impl/ManagedCursorContainerTest.java   |  7 ++
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  4 +-
 .../persistent/PersistentMessageExpiryMonitor.java | 14 +++-
 .../persistent/PersistentMessageFinder.java        |  7 +-
 .../service/persistent/PersistentSubscription.java |  3 +-
 .../service/PersistentMessageFinderTest.java       | 89 +++++++++++++++++++---
 11 files changed, 136 insertions(+), 22 deletions(-)

commit 4a9f2f74d31f2eb3007a76ecb76d964f9e13c22f
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Aug 14 21:55:40 2019 +0800

    [Doc] Update Schema Guide (#4934)
    
    1. Add descriptions.
    
    2. Delete the following files because their contents are already in the new Schema Guide.
    
    
    - concepts-schema-registry.md (contents are moved [here1](https://pulsar.apache.org/docs/en/next/schema-get-started/) and [here2](https://pulsar.apache.org/docs/en/next/schema-understand/#schema-version))
    - developing-schema.md (contents are moved [here](https://pulsar.apache.org/docs/en/next/schema-manage/))
    - admin-api-schemas.md (contents are moved [here](https://pulsar.apache.org/docs/en/next/schema-manage/))

 site2/docs/admin-api-schemas.md              | 98 ----------------------------
 site2/docs/concepts-schema-registry.md       | 81 -----------------------
 site2/docs/developing-schema.md              | 57 ----------------
 site2/docs/schema-evolution-compatibility.md |  4 ++
 site2/docs/schema-get-started.md             |  2 +
 site2/docs/schema-manage.md                  |  2 +-
 site2/docs/schema-understand.md              | 11 ++--
 7 files changed, 13 insertions(+), 242 deletions(-)

commit 05a3cd8b81639348045f2ef5aca2e3e3a58ff5b0
Author:  <ranxiaolong716@gmail.com>
Date:   Wed Aug 14 21:14:28 2019 +0800

    [site2] Fix swagger of SourceBase and SinkBase display problem (#4939)
    
    * [site2] Fix swagger of SourceBase and SinkBase display problem
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../apache/pulsar/broker/admin/impl/SinksBase.java | 239 ++++++++++-----------
 .../pulsar/broker/admin/impl/SourcesBase.java      | 195 +++++++++--------
 2 files changed, 216 insertions(+), 218 deletions(-)

commit 88e6b2bc5707cd426bede75db43f96f405197375
Author: Masahiro Sakamoto <massakam@yahoo-corp.jp>
Date:   Wed Aug 14 16:30:18 2019 +0900

    Do not log stack trace with warn log in websocket proxy (#4945)

 .../src/main/java/org/apache/pulsar/websocket/ProducerHandler.java  | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit a8b57c97c058862bce1c5b9d3435768d2071f09b
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Wed Aug 14 09:25:50 2019 +0800

    [dashboard] fix peek parse message error (#4918)
    
    Fixes #4917
    
    ### Motivation
    
    dashboard peek message api raise exception when format response cause treat all message as a JSON string
    
    ### Modifications
    
    * format as JSON only if message is a JSON,
    * otherwise if message is printable, return the original message,
    * otherwise print hex like command with --hex option.

 dashboard/Dockerfile                             |  2 +-
 dashboard/django/stats/templates/stats/peek.html |  5 ++-
 dashboard/django/stats/views.py                  | 47 ++++++++++++++++++++++--
 3 files changed, 49 insertions(+), 5 deletions(-)

commit be7b24f9f8aa67b2235e523485249aef8d2a611a
Author: Addison Higham <addisonj@gmail.com>
Date:   Sun Aug 11 20:01:53 2019 -0600

    Add option to disable authentication for proxy /metrics (#4921)
    
    This commit adds a new option optionally disable authentication for the
    `/metrics` endpoint in the pulsar-proxy.
    
    Currently, authentication is required for the metrics endpoint when
    authentication is enabled, which makes monitoring more difficult.
    However, rather than just disable it completely and allow for metrics to
    be exposed to any unknown user, this makes it opt in.
    
    It could be argued that it should default to false, but as it is likely
    that the proxy is the only component potentially exposed to the public internet, we
    default to not exposing data.
    
    Fixes #4920

 .../java/org/apache/pulsar/proxy/server/ProxyConfiguration.java     | 6 ++++++
 .../java/org/apache/pulsar/proxy/server/ProxyServiceStarter.java    | 3 ++-
 .../src/main/java/org/apache/pulsar/proxy/server/WebServer.java     | 6 +++++-
 site2/docs/reference-configuration.md                               | 1 +
 4 files changed, 14 insertions(+), 2 deletions(-)

commit 02f9fd3e055f404501e41413ec1081331ff945c3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Aug 11 18:41:19 2019 -0700

    [pulsar-client] Fix broken replication msg to specific cluster (#4930)

 .../pulsar/broker/service/ReplicatorTest.java      | 39 ++++++++++++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |  3 ++
 2 files changed, 42 insertions(+)

commit bdfefc72e51c71d88822e727a1bb324ae42c4683
Author: Luo Tian <lt@basecity.com>
Date:   Sun Aug 11 10:15:20 2019 +0800

    [site2] fix Function classname importing (#4924)
    
    ### Motivation
    
    The code snippets in functions documentation are wrong: `Function` class of java native is from package `java.util.function` instead of `java.util`.
    
    ### Modifications
    
    in 2 markdown file, corrected 2 java source snippets.

 site2/docs/functions-api.md      | 12 ++++++------
 site2/docs/functions-overview.md |  2 +-
 2 files changed, 7 insertions(+), 7 deletions(-)

commit a3ecbcb7243ea3ffd257130dd06dff6286c8614a
Author: hapihu <zhatianhu@gmail.com>
Date:   Sat Aug 10 17:15:29 2019 +0800

    Update concepts-messaging.md (#4835)
    
    The name in the text description does not match the name in the diagram.
    
    
    https://pulsar.apache.org/docs/en/next/concepts-messaging/#failover
    The figure pulsar-failover-subscriptions.png contains only Consumer-B-0 and Consumer-B-1;
    
    
    https://pulsar.apache.org/docs/en/next/concepts-messaging/#shared
    The figure pulsar-shared-subscriptions.png contains only Consumer-C-1, Consumer-C-2 and Consumer-C-3.

 site2/docs/concepts-messaging.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 648f0c827c9173d42a9f35e2c1da8d171fbe5dd2
Author: Heiss <52699794+Heiss@users.noreply.github.com>
Date:   Sat Aug 10 11:14:51 2019 +0200

    requests should respect no_proxy env variable (#4867)
    
    If you want to specify a no_proxy variable in your dockerfile or docker-compose.yml, then this little fix respects the variable in get-requests. Otherwise the proxies could break your docker namespace lookup.

 dashboard/django/collector.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2069f761753940ed6a1faca8999af70036f20fd6
Author: lipenghui <penghui@apache.org>
Date:   Sat Aug 10 17:14:19 2019 +0800

    [pulsar-sql] Handle schema not found (#4890)
    
    * Handle get schema 404 in pulsar sql(table meta and get splits)
    
    * Fix unit test.
    
    * add defaultSchema()
    
    * use Schema.BYTES.getSchemaInfo()
    
    * add unit test
    
    * rebase and fix unit tests

 .../apache/pulsar/sql/presto/PulsarMetadata.java   | 14 ++++++------
 .../pulsar/sql/presto/PulsarSchemaHandlers.java    |  5 +++++
 .../pulsar/sql/presto/PulsarSplitManager.java      | 10 +++++----
 .../pulsar/sql/presto/TestPulsarConnector.java     | 14 ++++++++++--
 .../pulsar/sql/presto/TestPulsarMetadata.java      |  6 +++---
 .../pulsar/sql/presto/TestPulsarSplitManager.java  | 25 +++++++++++++++++++++-
 6 files changed, 57 insertions(+), 17 deletions(-)

commit b3ae47c6e2ac2fdb831a1735f6ab1218d2dda566
Author:  <ranxiaolong716@gmail.com>
Date:   Sat Aug 10 17:13:49 2019 +0800

    Fix swagger of FunctionBase display problem (#4901)
    
    * Fix swagger of FunctionBase display problem
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 358 ++++++++++-----------
 1 file changed, 179 insertions(+), 179 deletions(-)

commit 2ea530e73835c789acf57663b465fe94a6007534
Author: huangdx0726 <localhost80@foxmail.com>
Date:   Sat Aug 10 17:13:09 2019 +0800

    Update admin-api-overview.md (#4922)
    
    Fixes #4914
    
    ### Motivation
       1.Go to 'http://pulsar.apache.org/docs/en/admin-api-overview'
       2.Scroll down to 'Java admin client' and click ClientConfiguration link
       3.404 not found error is displayed "The requested URL /api/admin/org/apache/pulsar/client/admin/ClientConfiguration was not found on this server."
       4.the examples can't work.
    
    ### Modifications
    1.The link to ClientConfiguration  changed to PulsarAdminBuilder.
    2.The example changed to
    ```
    String url = "http://localhost:8080";
    // Pass auth-plugin class fully-qualified name if Pulsar-security enabled
    String authPluginClassName = "com.org.MyAuthPluginClass";
    // Pass auth-param if auth-plugin class requires it
    String authParams = "param1=value1";
    boolean useTls = false;
    boolean tlsAllowInsecureConnection = false;
    String tlsTrustCertsFilePath = null;
    PulsarAdmin admin = PulsarAdmin.builder()
    .authentication(authPluginClassName,authParams)
    .serviceHttpUrl(url)
    .tlsTrustCertsFilePath(tlsTrustCertsFilePath)
    .allowTlsInsecureConnection(tlsAllowInsecureConnection)
    .build();
    ```

 site2/docs/admin-api-overview.md | 40 ++++++++++++++++++----------------------
 1 file changed, 18 insertions(+), 22 deletions(-)

commit 1ad632d691959f2d657bac8303edd500e8e75703
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Sat Aug 10 11:36:27 2019 +0800

    [Transaction][Buffer] move the transaction buffer code to the broker module (#4919)
    
    
    *Motivation*
    
    Currently, all transaction buffer code in the transaction module. A transaction buffer inherits `PersistentTopic`, it depends on the pulsar-broker module. When we need to create a transaction buffer at the pulsar-broker, the pulsar-broker depends on the transaction module. So it will cause cyclic reference.
    
    *Modifications*
    
    - move the code under transaction buffer module to the broker module

 .../transaction/buffer/TransactionBuffer.java      |  12 +--
 .../buffer/TransactionBufferProvider.java          |   2 +-
 .../buffer/TransactionBufferReader.java            |   4 +-
 .../transaction/buffer/TransactionCursor.java      |   2 +-
 .../transaction/buffer/TransactionEntry.java       |   2 +-
 .../transaction/buffer/TransactionMeta.java        |   2 +-
 .../exceptions/EndOfTransactionException.java      |   2 +-
 .../NoTxnsCommittedAtLedgerException.java          |   2 +-
 .../exceptions/TransactionBufferException.java     |   2 +-
 .../exceptions/TransactionNotFoundException.java   |   2 +-
 .../exceptions/TransactionNotSealedException.java  |   2 +-
 .../exceptions/TransactionSealedException.java     |   2 +-
 .../exceptions/UnexpectedTxnStatusException.java   |   2 +-
 .../buffer/exceptions/package-info.java            |   2 +-
 .../buffer/impl/InMemTransactionBuffer.java        |  16 ++--
 .../impl/InMemTransactionBufferProvider.java       |   6 +-
 .../buffer/impl/InMemTransactionBufferReader.java  |  16 ++--
 .../buffer/impl/PersistentTransactionBuffer.java   |  12 +--
 .../impl/PersistentTransactionBufferReader.java    |  10 +-
 .../buffer/impl/TransactionCursorImpl.java         |  10 +-
 .../buffer/impl/TransactionEntryImpl.java          |   8 +-
 .../buffer/impl/TransactionMetaImpl.java           |  10 +-
 .../transaction/buffer/impl/package-info.java      |   2 +-
 .../broker}/transaction/buffer/package-info.java   |   2 +-
 .../buffer}/InMemTransactionBufferReaderTest.java  |   6 +-
 .../buffer}/PersistentTransactionBufferTest.java   |  30 +++---
 .../transaction/buffer}/TransactionBufferTest.java |  14 +--
 .../buffer}/TransactionEntryImplTest.java          |   3 +-
 pulsar-transaction/buffer/pom.xml                  | 101 ---------------------
 pulsar-transaction/pom.xml                         |   1 -
 30 files changed, 87 insertions(+), 200 deletions(-)

commit 18d21acd6885db53417cbad6a18a93082da59cb2
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Sat Aug 10 10:08:19 2019 +0800

    [doc] dashboard docker relative clarity (#4915)
    
    Fixes #4913
    
    ### Motivation
    
    The original document may mislead users into thinking that there is no any ready-made docker image and building one from scratch.

 site2/docs/administration-dashboard.md | 17 ++++++++---------
 1 file changed, 8 insertions(+), 9 deletions(-)

commit 5adc522e992d64ff564a187a4d08a5a408bed8de
Author: lipenghui <penghui@apache.org>
Date:   Sat Aug 10 08:55:49 2019 +0800

    [pulsar-sql] Make partition as internal column (#4888)
    
    Fixes #4785
    
    ### Motivation
    
    1. Stop return partition name in table list, just return the partitioned topic name in table list. This will avoid huge tables while user create large number of partition.
    2. Make partition as internal column, provide users with the ability to get which partition data in and filtration based on partition. For example:
    ```
    SELECT * FROM "my-table" WHERE "__partition__" = 0;
    SELECT * FROM "my-table" WHERE "__partition__" in (2,3);
    SELECT * FROM "my-table" WHERE "__partition__" < 1;
    ```
    ### Modifications
    
    1. Add "__partition__" internal column.
    2. Add domain handle for "__partition__".
    
    ### Verifying this change
    
    Added new unit test to verify this change
    
    ### Does this pull request potentially affect one of the following parts:
    
    *If `yes` was chosen, please highlight the changes*
    
      - Dependencies (does it add or upgrade a dependency): (no)
      - The public API: (yes)
      - The schema: (no)
      - The default values of configurations: (no)
      - The wire protocol: ( no)
      - The rest endpoints: (no)
      - The admin cli options: (no)
      - Anything that affects deployment: (no)
    
    ### Documentation
    
      - Does this pull request introduce a new feature? (yes)

 .../pulsar/sql/presto/PulsarInternalColumn.java    | 22 +++++-
 .../apache/pulsar/sql/presto/PulsarMetadata.java   |  7 +-
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  9 ++-
 .../pulsar/sql/presto/PulsarSplitManager.java      | 86 +++++++++++++++------
 .../pulsar/sql/presto/TestPulsarConnector.java     | 14 +++-
 .../pulsar/sql/presto/TestPulsarMetadata.java      | 14 +++-
 .../pulsar/sql/presto/TestPulsarSplitManager.java  | 90 ++++++++++++++++++++++
 7 files changed, 209 insertions(+), 33 deletions(-)

commit 8058775c3c8a83afecf38787d1d951c378182009
Author: Easyfan Zheng <zheng.easyfan@gmail.com>
Date:   Thu Aug 8 08:21:01 2019 +0800

    Merge Request for #4809: provide a convenient method for C++ client producer batch container (#4885)
    
    provide a convenient method for C++ client producer batch container https://github.com/apache/pulsar/issues/4809
    
    Formally the container element must be used like the following way:
    `MessageContainerList::iterator iter = messagesContainerListPtr->begin();`
    `iter->sendCallback_(r, iter->message_);`
    There are totally 3 reference operation steps inside:
    
    1. Reference an exact element of MessageContainer explicitly from outside by iteration operator;
    2. Reference the `sendCallback_` function pointer of said MessageContainer element explicitly from outside;
    3. Reference the `message_` member of said MessageContainer element explicitly from outside;
    
    Besides,  there is only one incoming variable say `Result r` is given from outside;
    
    In an ideal design, a user of `MessageContainer` should not have to know exactly the existence of `MessageContainer::sendCallback_` or `MessageContainer::message_`, what they exactly are, either how to use them.  Organize those stuff in a right way, should be the responsibility of struct `MessageContainer` itself.
    
    So a reasonable convenient invoking method should be like:
    `MessageContainerList::iterator iter = messagesContainerListPtr->begin();`
    `iter->callBack(r);`
    
    And said `MessageContainer::callBack` function shall be implemented like below:
    `void callBack(const pulsar::Result& r) { sendCallback_(r, message_); }`
    
    Obviously, said convenient method is also an efficient one.
    
    Moreover, use a more efficient iteration method while going through the MessageContainerList;
    From some benchmark test result in my local environment, such "for iteration based a fixed-length", will be 5 times faster than the STL::iterator operator way.
    
    Refer to the change on BatchMessageContainer.cc, please.

 pulsar-client-cpp/lib/BatchMessageContainer.cc | 7 +++----
 pulsar-client-cpp/lib/BatchMessageContainer.h  | 1 +
 2 files changed, 4 insertions(+), 4 deletions(-)

commit c1f8293b1c8f7bac64e4140308ea2972f213aebc
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Thu Aug 8 08:20:22 2019 +0800

    Update pulsar-client-cpp README.mc (#4881)
    
    ---
    
    *Motivation*
    
    There is a error when execute cmake on pulsar-client-cpp
    
    CMake Error at CMakeLists.txt:151 (MESSAGE):
      Could not find Boost Python library

 pulsar-client-cpp/README.md | 1 +
 1 file changed, 1 insertion(+)

commit 32337fcc9677d891fa8939f6f7185d598acebd95
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Aug 7 10:23:25 2019 +0800

    [Doc] Add *Manage Schema* Section (#4845)
    
    Structure of Schema Chapter: https://github.com/apache/pulsar/issues/4789

 site2/docs/assets/schema-autoupdate-consumer.png | Bin 0 -> 86897 bytes
 site2/docs/assets/schema-autoupdate-producer.png | Bin 0 -> 116544 bytes
 site2/docs/schema-manage.md                      | 785 +++++++++++++++++++++++
 site2/website/sidebars.json                      |   5 +-
 4 files changed, 789 insertions(+), 1 deletion(-)

commit 7b185dbef65fbacf0b0b22e8411905aefec51479
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 6 09:53:56 2019 -0700

    Add support of pulsar-kafka-adapter for kafka-0.8 api (#4797)
    
    * Add support pulsar-kafka-adapter for kafka-0.8 api
    
    clean up pulsar-kafka adapter
    
    add tests
    
    add low level consumer
    
    add simple consumer
    
    corrected pulsar-client-kafka_0_8
    
    fix the module name
    
    add batch and partitioned-topic support
    
    fix headers
    
    add getOffset api support
    
    added pulsarOffset request/response
    
     clean up
    
    * add pulsar-kafka integration test
    
    * use earliestTime offset
    
    * add default serializer/de

 pulsar-client-kafka-compat/pom.xml                 |   3 +
 .../pulsar-client-kafka-shaded_0_8/pom.xml         | 433 +++++++++++++++++++++
 .../pulsar-client-kafka-tests_0_8/pom.xml          |  77 ++++
 .../compat/examples/HighLevelConsumerExample.java  | 121 ++++++
 .../compat/examples/LowLevelConsumerExample.java   | 146 +++++++
 .../kafka/compat/examples/ProducerExample.java     | 131 +++++++
 .../client/kafka/compat/examples/utils/Tweet.java  |  67 ++++
 .../pulsar-client-kafka/pom.xml                    |   5 +
 .../pulsar-client-kafka_0_8/pom.xml                | 120 ++++++
 .../kafka/clients/consumer/ConsumerConnector.java  | 230 +++++++++++
 .../kafka/clients/consumer/ConsumerIterator.java   | 143 +++++++
 .../clients/consumer/PulsarConsumerConfig.java     |  28 ++
 .../clients/consumer/PulsarKafkaConsumer.java      |  30 ++
 .../kafka/clients/consumer/PulsarKafkaStream.java  |  68 ++++
 .../clients/consumer/PulsarMessageAndMetadata.java |  92 +++++
 .../clients/producer/PulsarClientKafkaConfig.java  | 169 ++++++++
 .../clients/producer/PulsarKafkaProducer.java      | 303 ++++++++++++++
 .../consumer/PulsarByteBufferMessageSet.java       |  93 +++++
 .../simple/consumer/PulsarFetchResponse.java       |  47 +++
 .../simple/consumer/PulsarKafkaSimpleConsumer.java | 354 +++++++++++++++++
 .../clients/simple/consumer/PulsarMessage.java     |  41 ++
 .../simple/consumer/PulsarMsgAndOffset.java        |  40 ++
 .../simple/consumer/PulsarOffsetCommitRequest.java |  61 +++
 .../consumer/PulsarOffsetCommitResponse.java       |  43 ++
 .../simple/consumer/PulsarOffsetFetchRequest.java  |  36 ++
 .../simple/consumer/PulsarOffsetFetchResponse.java |  40 ++
 .../consumer/PulsarOffsetMetadataAndError.java     |  44 +++
 .../simple/consumer/PulsarOffsetRequest.java       |  40 ++
 .../simple/consumer/PulsarOffsetResponse.java      |  52 +++
 .../simple/consumer/PulsarPartitionMetadata.java   |  51 +++
 .../simple/consumer/PulsarTopicMetadata.java       |  42 ++
 .../consumer/PulsarTopicMetadataResponse.java      |  71 ++++
 .../clients/consumer/PulsarKafkaConsumerTest.java  |  75 ++++
 .../clients/producer/PulsarKafkaProducerTest.java  | 124 ++++++
 .../kafka/test/KafkaProducerConsumerTest.java      | 247 ++++++++++++
 .../test/KafkaProducerSimpleConsumerTest.java      | 256 ++++++++++++
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   5 +
 .../pulsar/client/impl/ProducerBuilderImpl.java    |   5 +
 .../pulsar/client/impl/TopicMessageIdImpl.java     |   2 +-
 39 files changed, 3934 insertions(+), 1 deletion(-)

commit 19e129d0c8dfd37569d6ccf844abeb33f6a49a97
Author:  <rxl@apache.org>
Date:   Tue Aug 6 21:45:30 2019 +0800

    Fix pulsar admin functions description information (#4846)
    
    * Fix pulsar admin functions description information
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 84 +++++++++++-----------
 1 file changed, 42 insertions(+), 42 deletions(-)

commit 128287e35eab6c3ceb951074dac711dd1d8e829d
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Aug 6 20:17:20 2019 +0800

    produce/consume with 1 partitioned topic (#4883)
    
    Motivation
    In PR #4764, we allow to create partitioned topic with 1 partition, But in Pulsar Client, user still not able to do it.
    This fix try to make sure user could create consumer/producer for 1 partitioned topic .
    
    Modifications
    - old and new added unit test passed.

 .../client/api/SimpleProducerConsumerTest.java     | 80 ++++++++++++++++++++++
 .../client/impl/MultiTopicsConsumerImpl.java       |  2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  8 +--
 3 files changed, 85 insertions(+), 5 deletions(-)

commit 822d8ecacce9ac368250a863c35f238d5f40fda1
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Tue Aug 6 11:32:16 2019 +0800

    [Transactoin] Add default handler to handle transaction related commands (#4891)
    
    ---
    
    *Motivation*
    
    Add default handler to handle transaction related commands.

 .../pulsar/common/protocol/PulsarDecoder.java      | 134 +++++++++++++++++++++
 1 file changed, 134 insertions(+)

commit f6ed0377fb47705a2a339bfcc72e8a519b266fb0
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Tue Aug 6 11:10:43 2019 +0800

    Add support of pulsar-kafka-adapter for kafka-0.9 api (#4886)
    
    Fixes #4791
    
    **Motivation**
    
    Currently the Pulsar Kafka wrapper is using Kafka 0.10.x version. However, there are users who use legacy-kafka version in their system and willing to move to pulsar. This PR provides pulsar-kafka adapter for kafka-api-version 0.9.X. So, this adapter can help users in their migration process from kafka-0.9 to pulsar.

 pulsar-client-kafka-compat/pom.xml                 |   3 +
 .../pulsar-client-kafka-shaded_0_9/pom.xml         | 271 ++++++++++
 .../kafka/compat/examples/ProducerAvroExample.java |   1 +
 .../kafka/compat/examples/ProducerExample.java     |   1 +
 .../pulsar-client-kafka-tests_0_9/pom.xml          |  70 +++
 .../kafka/compat/examples/ConsumerAvroExample.java |  75 +++
 .../kafka/compat/examples/ConsumerExample.java     |  60 +++
 .../kafka/compat/examples/ProducerAvroExample.java |  69 +++
 .../kafka/compat/examples/ProducerExample.java     |  52 ++
 .../client/kafka/compat/examples/utils/Bar.java    |  30 ++
 .../client/kafka/compat/examples/utils/Foo.java    |  35 ++
 .../clients/consumer/PulsarKafkaConsumer.java      |   2 +-
 .../clients/producer/PulsarKafkaProducer.java      |   2 +-
 .../pulsar-client-kafka_0_9/pom.xml                |  71 +++
 .../clients/consumer/PulsarKafkaConsumer.java      | 597 +++++++++++++++++++++
 .../clients/producer/PulsarKafkaProducer.java      | 330 ++++++++++++
 .../client/kafka/compat/KafkaMessageRouter.java    |  44 ++
 .../kafka/compat/PulsarClientKafkaConfig.java      | 117 ++++
 .../kafka/compat/PulsarConsumerKafkaConfig.java    |  72 +++
 .../client/kafka/compat/PulsarKafkaSchema.java     |  77 +++
 .../kafka/compat/PulsarProducerKafkaConfig.java    |  65 +++
 .../clients/producer/PulsarKafkaProducerTest.java  | 192 +++++++
 .../apache/pulsar/client/util}/MessageIdUtils.java |   2 +-
 23 files changed, 2235 insertions(+), 3 deletions(-)

commit c7b2cb37ff0c7e852086f7eb9e3e8d5b58fbede6
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Aug 4 23:47:22 2019 -0700

    Allow resource overcommitting when running functions in Kubernetes (#4829)
    
    ### Motivation
    
    Currently, when running Pulsar Functions, Sources, and Sinks in Kubernetes. The resources requests and resource limits are set to the same values.  While this is ok and everything will run as it should, actual resource utilization in the cluster might be low.   To increase actual resource utilization, we need to be able to overcommit a certain amount in our clusters

 conf/functions_worker.yml                          |  6 +++
 .../functions/runtime/KubernetesRuntime.java       | 32 ++++++++++---
 .../runtime/KubernetesRuntimeFactory.java          |  8 ++++
 .../runtime/KubernetesRuntimeFactoryTest.java      |  2 +
 .../functions/runtime/KubernetesRuntimeTest.java   | 52 +++++++++++++++++++---
 .../pulsar/functions/utils/FunctionCommon.java     |  5 +++
 .../functions/worker/FunctionRuntimeManager.java   |  2 +
 .../pulsar/functions/worker/WorkerConfig.java      | 12 +++++
 8 files changed, 107 insertions(+), 12 deletions(-)

commit f6fee1c6b7976c439215876b6d892591d198a26b
Author: Sergii Zhevzhyk <vzhikserg@users.noreply.github.com>
Date:   Mon Aug 5 08:46:37 2019 +0200

    Enforce checkstyle in the pulsar sql module (#4882)
    
    ### Modifications
    
    The checksyle plugin was added to the pulsar sql module to enforce the defined style. All violations were fixed:
    
    - Ordering of imports.
    - Formatting of the code.
    - Absent Javadoc comments.
    - Other small issues.

 pulsar-sql/pom.xml                                 |  22 ++
 .../pulsar/sql/presto/AvroSchemaHandler.java       |  15 +-
 .../pulsar/sql/presto/JSONSchemaHandler.java       |  14 +-
 .../pulsar/sql/presto/PulsarColumnHandle.java      |  62 ++++--
 .../pulsar/sql/presto/PulsarColumnMetadata.java    |  41 ++--
 .../apache/pulsar/sql/presto/PulsarConnector.java  |  12 +-
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  35 ++--
 .../pulsar/sql/presto/PulsarConnectorConfig.java   |  32 +--
 .../pulsar/sql/presto/PulsarConnectorFactory.java  |  10 +-
 .../pulsar/sql/presto/PulsarConnectorId.java       |  11 +-
 .../sql/presto/PulsarConnectorMetricsTracker.java  | 229 +++++++++++----------
 .../pulsar/sql/presto/PulsarConnectorModule.java   |  18 +-
 .../pulsar/sql/presto/PulsarConnectorUtils.java    |  13 +-
 .../pulsar/sql/presto/PulsarHandleResolver.java    |  17 +-
 .../pulsar/sql/presto/PulsarInternalColumn.java    |  41 +++-
 .../apache/pulsar/sql/presto/PulsarMetadata.java   |  64 +++---
 .../org/apache/pulsar/sql/presto/PulsarPlugin.java |   6 +-
 .../sql/presto/PulsarPrimitiveSchemaHandler.java   |   4 +-
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  37 ++--
 .../apache/pulsar/sql/presto/PulsarRecordSet.java  |   8 +-
 .../pulsar/sql/presto/PulsarRecordSetProvider.java |  11 +-
 .../org/apache/pulsar/sql/presto/PulsarSplit.java  |  38 ++--
 .../pulsar/sql/presto/PulsarSplitManager.java      |  42 ++--
 .../pulsar/sql/presto/PulsarTableHandle.java       |  12 +-
 .../pulsar/sql/presto/PulsarTableLayoutHandle.java |  24 +--
 .../pulsar/sql/presto/PulsarTopicDescription.java  |   9 +-
 .../pulsar/sql/presto/PulsarTransactionHandle.java |   3 +
 .../apache/pulsar/sql/presto/SchemaHandler.java    |   3 +
 .../org/apache/pulsar/sql/presto/package-info.java |  22 ++
 29 files changed, 499 insertions(+), 356 deletions(-)

commit ce681dfd706cd47057f24ad57e13e9f60f6ff14f
Author: Easyfan Zheng <zheng.easyfan@gmail.com>
Date:   Mon Aug 5 14:45:44 2019 +0800

    Merge Request for #4871: change unittest code for support LLVM. (#4878)
    
     MacOS clang/llvm compiler imcompatible code in Unit test case BasicEndToEndTest.cc #4871

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 5bf319e46f70350cc162210c1583e608be581b4e
Author: Kezhu Wang <kezhuw@gmail.com>
Date:   Mon Aug 5 14:44:43 2019 +0800

    Fix concurrent access of `uninitializedCursors` in `ManagedLedgerImpl.asyncOpenCursor` (#4837)
    
    ### Motivation
    Fix concurrent access of `uninitializedCursors` in `ManagedLedgerImpl.asyncOpenCursor`.
    
    ### Modifications
    * Adds test to expose concurrent access of `uninitializedCursors` in `ManagedLedgerImpl.asyncOpenCursor`.
    * Fixes concurrent access of `uninitializedCursors` in `ManagedLedgerImpl.asyncOpenCursor`.

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  4 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 86 ++++++++++++++++++++++
 2 files changed, 88 insertions(+), 2 deletions(-)

commit bb1108e8e1e6c1727887336d8a12695156042cc3
Author: Guillaume Braibant <guillaume.braibant@outlook.com>
Date:   Mon Aug 5 08:43:08 2019 +0200

    Update kubernetes deployment apis k8s post 1.9 (#4700)
    
    **Motivation**
    
    Fixes #4698 and #4699
    
    **List of changes**
    
    1. Two new folders under pulsar/deployment/kubernetes/generic :
    - original : contains the original scripts (pre Kubernetes 1.9)
    - k8s-1-9-and-above : contains the new scripts with APIs ipdated (Kubernetes 1.9 and above)
    
    2. bookie.yaml :
    - Migrate DaemonSet api version from extensions/v1beta1 to apps/v1
    - Declare the bookie service before the DaemonSet object for bookies
    
    3. broker.yaml
    - Migrate Deployment api version from apps/v1beta1 to apps/v1
    - Declare the bookie service before the Deployment object for brokers
    
    4. monitoring.yaml :
    - Migrate all Deployment api version from apps/v1beta1 to apps/v1
    - Declare each service before the Deployment object the service is bound to
    
    5. zookeeper.yaml :
    - Migrate StatefulSet api version from apps/v1beta1 to apps/v1
    - Declare the service before the StatefulSet object for zookeeper
    
    6. proxy.yaml
    - Migrate Deployment api version from apps/v1beta1 to apps/v1
    - Declare the bookie service before the Deployment object for proxy.

 .../generic/{ => k8s-1-9-and-above}/admin.yaml     |   0
 .../generic/k8s-1-9-and-above/bookie.yaml          | 129 ++++++++++++++
 .../generic/k8s-1-9-and-above/broker.yaml          | 103 +++++++++++
 .../{ => k8s-1-9-and-above}/cluster-metadata.yaml  |   0
 .../generic/k8s-1-9-and-above/monitoring.yaml      | 192 +++++++++++++++++++++
 .../generic/k8s-1-9-and-above/proxy.yaml           |  87 ++++++++++
 .../generic/k8s-1-9-and-above/zookeeper.yaml       | 143 +++++++++++++++
 deployment/kubernetes/generic/original/admin.yaml  |  44 +++++
 .../kubernetes/generic/{ => original}/bookie.yaml  |   0
 .../kubernetes/generic/{ => original}/broker.yaml  |   0
 .../generic/original/cluster-metadata.yaml         |  42 +++++
 .../generic/{ => original}/monitoring.yaml         |   0
 .../kubernetes/generic/{ => original}/proxy.yaml   |   0
 .../generic/{ => original}/zookeeper.yaml          |   0
 14 files changed, 740 insertions(+)

commit 822531c072cb608161cef5e9c459ccc5103c9bc0
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Mon Aug 5 14:42:14 2019 +0800

    [Doc] Add *Understand Schema* Section (#4786)
    
    * Add *Understand Schema* Section
    
    * Update
    
    * Update
    
    * Update
    
    * update
    
    * Update
    
    * Update
    
    * Update
    
    * Update
    
    * Update
    
    * update

 site2/docs/assets/schema-consumer.png | Bin 0 -> 56594 bytes
 site2/docs/assets/schema-producer.png | Bin 0 -> 56467 bytes
 site2/docs/schema-understand.md       | 574 ++++++++++++++++++++++++++++++++++
 3 files changed, 574 insertions(+)

commit b90b4ea1d1397e3707e6f51151492feff5a75ba6
Author: Easyfan Zheng <zheng.easyfan@gmail.com>
Date:   Mon Aug 5 14:41:42 2019 +0800

    Merge Request for #4808: TYPO in C++ client producer method for processing failure case, and add corresponding unit test case. (#4873)
    
    Definitely, this is a typo. This method is dealing with the Failed Message with the GIVEN result, but not a CERTAIN result.
    
    Contribution Checklist
    #4808 : TYPO in C++ client producer method for processing failure case
    Add c++ client producer failure message unit test case.
    
    UT passed:
    
    BatchMessageTest

 pulsar-client-cpp/include/pulsar/Producer.h |  3 +++
 pulsar-client-cpp/lib/Producer.cc           |  7 ++++++
 pulsar-client-cpp/lib/ProducerImpl.cc       |  2 +-
 pulsar-client-cpp/lib/ProducerImpl.h        |  4 ++++
 pulsar-client-cpp/tests/BatchMessageTest.cc | 34 +++++++++++++++++++++++++++++
 pulsar-client-cpp/tests/PulsarFriend.h      |  4 ++++
 6 files changed, 53 insertions(+), 1 deletion(-)

commit 5ff464b58acf4a96cbee4e68e3889021b5574ceb
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Sun Aug 4 23:41:06 2019 -0700

    Added Pulsar in Action book (#4781)

 site2/website/data/resources.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 59a70db404ac26cedbf5eef67b8592d755c6ae09
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Mon Aug 5 14:40:05 2019 +0800

    [Transaction][buffer] Add new commands for the transaction (#4866)
    
    *Motivation*
    
    Add new commands for the transaction.
    
    *Modifications*
    
    - Add new property for `CommandSend`
    - Add new command `CommandEndTxnOnPartition`

 pulsar-client-cpp/lib/Commands.cc                  |    39 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 10032 ++++++++++++++++++-
 .../apache/pulsar/common/protocol/Commands.java    |   342 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   907 +-
 4 files changed, 10639 insertions(+), 681 deletions(-)

commit 2b52ccb24d607019d71a759bd8c7206c8f64c49f
Author: Robert Moucha <robert.moucha@gooddata.com>
Date:   Mon Aug 5 08:39:24 2019 +0200

    Fix typo in helm chart (#4875)
    
    ### Motivation
    Incorrect value is being used in Pulsar Helm template `autorecovery-deployment.yaml`
    
    ### Modifications
    Proper variable name set.
    
    ### Verifying this change
    Fixed variable name is already set in `values.yaml` and `values-mini.yaml`.
    This change is a trivial rework / code cleanup without any test coverage.
    
    ### Documentation
    None needed.

 .../kubernetes/helm/pulsar/templates/autorecovery-deployment.yaml       | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 710b4b1f804582830331d2ec37a1d1356a351144
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Aug 2 21:02:24 2019 +0800

    Improve kerberos documents (#4771)
    
    * improve doc for kerberos
    
    * add more info
    
    * also update 2.4.0 doc
    
    * updated following comments
    
    * change following comments

 .../apache/pulsar/broker/ServiceConfiguration.java |  4 +-
 site2/docs/security-kerberos.md                    | 99 +++++++++++++++++++---
 .../version-2.4.0/security-kerberos.md             | 98 ++++++++++++++++++---
 3 files changed, 171 insertions(+), 30 deletions(-)

commit 46bfb2c21b9f96866238c79b886458dcde6685c8
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Fri Aug 2 21:01:45 2019 +0800

    Fix : The frist position in managedLedger is ahead of the last (#4853)
    
    Fixes #4852
    
    Bug:
    
    After create an empty ledger by sub/unsub and trim ledgers, the first position in managedLedger is ahead of the last when create a consumer without reopen the managed ledger.
    
    Reason
    
    Last position will be update when opening managedLedger.
    Because when creating an empty Ledger without reopening managedLedger, the last position is not be updated. Since the ledger pointed of the last position has been deleted, the first position point to the new ledger.
    
    Fix:
    
    The first position should fall back to last position.

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 10 +++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 27 ++++++++++++++++++++++
 2 files changed, 36 insertions(+), 1 deletion(-)

commit 9c68f19670676f50f4f1fd5019aa1ca89cdb09c6
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Fri Aug 2 21:01:12 2019 +0800

    [Doc] Add contents for *Get Started (Schema)* (#4859)

 site2/docs/schema-get-started.md | 32 +++++++++++++++++++++++++++++---
 1 file changed, 29 insertions(+), 3 deletions(-)

commit e7195ebf5c0bcc7a3dda1446e78f2284e27d74bf
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Fri Aug 2 20:55:22 2019 +0800

    [Transaction][buffer] Add basic operation of transaction (#4738)
    
    
    
    *Modifications*
    
    Add primary operation of transaction. Keep all actions persistently.
    
    Describe the modifications you've done.
    
    - add commit operation
    - add abort operation
    - add openreader operation

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |   2 +-
 .../mledger/impl/ReadOnlyManagedLedgerImpl.java    |   2 +-
 .../broker/service/persistent/PersistentTopic.java |   2 +-
 pulsar-transaction/buffer/pom.xml                  |  44 ++
 .../transaction/buffer/TransactionBuffer.java      |  14 +-
 .../transaction/buffer/TransactionCursor.java      |  73 ++
 .../pulsar/transaction/buffer/TransactionMeta.java |  58 ++
 .../NoTxnsCommittedAtLedgerException.java          |  31 +
 .../buffer/impl/InMemTransactionBuffer.java        |  50 +-
 .../buffer/impl/PersistentTransactionBuffer.java   | 268 ++++++++
 .../impl/PersistentTransactionBufferReader.java    | 134 ++++
 .../buffer/impl/TransactionCursorImpl.java         | 126 ++++
 .../buffer/impl/TransactionMetaImpl.java           | 163 +++++
 .../impl/PersistentTransactionBufferTest.java      | 732 +++++++++++++++++++++
 .../buffer/impl/TransactionBufferTest.java         |   2 +-
 15 files changed, 1687 insertions(+), 14 deletions(-)

commit 3ae0e61bc6a51246c57fc2931daed3faf7a720ea
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Fri Aug 2 14:20:02 2019 +0800

    fix github pull request template comment typo (#4865)

 .github/PULL_REQUEST_TEMPLATE.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d8356d8c898e42b75e6ba90f4ab3773c6d2386e1
Author: Yi Tang <ssnailtang@gmail.com>
Date:   Fri Aug 2 12:10:05 2019 +0800

    [pulsar-io-jdbc] not set action as insert (#4862)
    
    ### Motivation
    
    jdbc sink treat all record as INSERT before #4358 , now it requires an indispensable action property which seems to be a break change, and we can deal records without any action property as INSERT.
    
    ### Modifications
    
    treat action not set as INSERT action like before.

 .../apache/pulsar/io/jdbc/JdbcAbstractSink.java    | 35 ++++++++++-----
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    | 51 +++++++++++++++-------
 2 files changed, 58 insertions(+), 28 deletions(-)

commit 434c3956e9da86704f49b52e05bd15c143d89624
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Aug 1 22:54:36 2019 +0800

    [docs] Add functions-deploy guide for Pulsar Functions (new) (#4820)
    
    Fixes #4554
    
    ### Motivation
    Add a new deploy tutorial for new Pulsar Functions structure.
    
    ### Modifications
    Based on the original functions-deploying file, re-adjust the structure and language of functions-deploy.

 site2/docs/functions-deploy.md | 210 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 210 insertions(+)

commit 4acb8380944545140b2c48ac8e448cb25815b30f
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu Aug 1 22:53:26 2019 +0800

    [Doc] Add Schema Evolution and Compatibility section (#4841)
    
    Structure of Schema Chapter: https://github.com/apache/pulsar/issues/4789

 site2/docs/schema-evolution-compatibility.md | 779 +++++++++++++++++++++++++++
 1 file changed, 779 insertions(+)

commit 00ce7815f4c3428215abedb0608b7acfa2c35bd5
Author: lipenghui <penghui@apache.org>
Date:   Thu Aug 1 14:40:08 2019 +0800

    Catch throwable in interceptors of consumer and producer. (#4860)

 .../apache/pulsar/client/api/InterceptorsTest.java | 101 +++++++++++++++++++++
 .../pulsar/client/impl/ConsumerInterceptors.java   |  12 +--
 .../pulsar/client/impl/ProducerInterceptors.java   |   6 +-
 3 files changed, 110 insertions(+), 9 deletions(-)

commit 8c163eb2321fb2fba62d7c85dd5d03bc75c1af7a
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Aug 1 13:40:50 2019 +0800

    [docs] Add thread/process modes in Configure Functions runtime (#4828)
    
    * add thread/process modes
    
    * update the differences between thread and process modes
    
    * update
    
    * update

 site2/docs/functions-overview.md | 2 +-
 site2/docs/functions-runtime.md  | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

commit 97e5eccf4b4f809ea4e74dcd29e340ed1479d211
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Aug 1 12:34:45 2019 +0800

    [docs] Refine description of two examples in "Functions API" doc (#4827)
    
    * Update examples, thread/process modes
    
    * remove process and thread modes
    
    * update

 site2/docs/functions-api.md | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 6c9b8efebb7ddd6b31084450b702f808db8e6e5d
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Aug 1 09:57:06 2019 +0800

    [docs]Refine Pulsar Functions overview and structure (#4598)
    
    * Refine functions overview and structure
    
    * keep old files and structure, add new ones
    
    * Update
    
    * add a note at the beginning
    
    * create new files for the new structure
    
    * remove two examples
    
    * will create new PR for each of those files
    
    * Update overview
    
    * remove thread/process modes differences

 site2/docs/functions-overview-new.md | 189 +++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json          |  13 +++
 2 files changed, 202 insertions(+)

commit 77f637099836731501d2447e5c2a81edcce2802e
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Thu Aug 1 08:52:21 2019 +0800

    Fix : retention size policy bug (#4825)
    
    the 0 size limit can't means "infinite" size quota

 .../apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java   |  2 +-
 .../bookkeeper/mledger/impl/OffloadLedgerDeleteTest.java    |  2 ++
 .../bookkeeper/mledger/impl/OffloadPrefixReadTest.java      |  1 +
 .../apache/bookkeeper/mledger/impl/OffloadPrefixTest.java   | 13 +++++++++++++
 .../apache/bookkeeper/mledger/impl/ReadOnlyCursorTest.java  | 10 ++++++++--
 5 files changed, 25 insertions(+), 3 deletions(-)

commit 8d19575358c5fbf6d777ff922e8d205bd3254a49
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Wed Jul 31 00:47:17 2019 +0800

    Add the schema admin api (#4800)
    
    ### Motivation
    Continue the issues of #4782
    
    ### Verifying this change
    Add the tests for it

 .../pulsar/broker/admin/v2/SchemasResource.java    | 193 ++++++++++++++++++++-
 .../schema/DefaultSchemaRegistryService.java       |  10 ++
 .../broker/service/schema/SchemaRegistry.java      |   4 +
 .../service/schema/SchemaRegistryService.java      |   1 +
 .../service/schema/SchemaRegistryServiceImpl.java  |  16 +-
 ...hemaRegistryServiceWithSchemaDataValidator.java |  10 ++
 .../broker/service/schema/SchemaServiceTest.java   |  35 ++++
 .../org/apache/pulsar/client/admin/Schemas.java    |  50 ++++++
 .../pulsar/client/admin/internal/SchemasImpl.java  | 102 ++++++++++-
 .../schema/GetAllVersionsSchemaResponse.java       |  34 ++++
 .../protocol/schema/IsCompatibilityResponse.java   |  34 ++++
 .../protocol/schema/LongSchemaVersionResponse.java |  32 ++++
 12 files changed, 506 insertions(+), 15 deletions(-)

commit 3a06c97a10cc4dcf42b62f41a6add0d6ffa01ca4
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Tue Jul 30 22:48:13 2019 +0800

    [Transaction][buffer] Add data ledger position in txn commit marker (#4826)
    
    * [Transaction][buffer] Add data ledger position in txn commit marker
    ---
    
    *Motivation*
    
    Add the data ledger position into the commit marker of the transaction log.
    
    *Modifications*
    
    Create a new TxnCommitMarker in the proto.

 .../pulsar/common/api/proto/PulsarMarkers.java     | 363 +++++++++++++++++++++
 .../org/apache/pulsar/common/protocol/Markers.java |  37 ++-
 pulsar-common/src/main/proto/PulsarMarkers.proto   |   6 +
 .../apache/pulsar/common/protocol/MarkersTest.java |  10 +-
 4 files changed, 409 insertions(+), 7 deletions(-)

commit dd7cc890bc1a950f4200c55bcbbee657c44b0e28
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Jul 30 22:41:06 2019 +0800

     [schema] KeyValue schema support using AUTO_CONSUME as key/value schema (#4839)
    
    *Motivation*
    
    Currently KeyValue schema doesn't support using AUTO_CONSUME.
    
    This PR is to add this support.
    
    This PR is based on #4836
    
    *Changes*
    
    - refactor a bit on Schema interface to support fetching schema info for both AutoConsumeSchema and KeyValueSchema before subscribing
    - add AUTO_CONSUME support to KeyValueSchema
    - add tests

 .../apache/pulsar/client/api/SimpleSchemaTest.java | 134 +++++++++++++++
 .../java/org/apache/pulsar/client/api/Schema.java  |  22 +++
 .../pulsar/client/impl/PulsarClientImpl.java       |  26 ++-
 .../client/impl/schema/AutoConsumeSchema.java      |  35 +++-
 .../pulsar/client/impl/schema/KeyValueSchema.java  | 126 +++++++++------
 .../client/impl/schema/KeyValueSchemaInfo.java     |  39 ++++-
 .../impl/schema/generic/GenericAvroSchema.java     |   4 +-
 .../impl/schema/generic/GenericSchemaImplTest.java | 179 ++++++++++++++-------
 8 files changed, 425 insertions(+), 140 deletions(-)

commit 3c9136b25d8941470a6744943ab762d250e97691
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jul 30 07:09:30 2019 -0700

    Fix: check function implements correct interface (#4844)

 .../functions/utils/FunctionConfigUtils.java       | 14 +++++++++++
 .../rest/api/v3/FunctionApiV3ResourceTest.java     | 29 ++++++++++++++++++++++
 2 files changed, 43 insertions(+)

commit b0793a178b8b5d2d1e82316b224c6dc3c27c6664
Author: vzhikserg <vzhikserg@users.noreply.github.com>
Date:   Mon Jul 29 11:05:57 2019 +0200

    Perform Checkstyle analysis in the pulsar-flink module (#4832)
    
    * Add maven plugin for style checking. Fix some style violations.
    
    * Fix issues shown by the style checker in the pulsar-flink module

 pulsar-flink/pom.xml                               | 19 +++++++++
 .../connectors/pulsar/BasePulsarOutputFormat.java  | 22 ++++++-----
 .../connectors/pulsar/PulsarAvroOutputFormat.java  |  4 +-
 .../connectors/pulsar/PulsarCsvOutputFormat.java   |  3 +-
 .../connectors/pulsar/PulsarJsonOutputFormat.java  |  3 +-
 .../connectors/pulsar/PulsarOutputFormat.java      |  3 +-
 .../batch/connectors/pulsar/package-info.java      | 22 +++++++++++
 .../serialization/AvroSerializationSchema.java     |  7 ++--
 .../serialization/CsvSerializationSchema.java      |  7 ++--
 .../pulsar/serialization/package-info.java         | 22 +++++++++++
 .../connectors/pulsar/FlinkPulsarProducer.java     | 25 ++++++------
 .../connectors/pulsar/PulsarConsumerSource.java    | 21 +++++-----
 .../connectors/pulsar/PulsarSourceBuilder.java     | 46 ++++++++++++----------
 .../connectors/pulsar/PulsarTableSink.java         | 12 +++---
 .../streaming/connectors/pulsar/package-info.java  | 22 +++++++++++
 .../pulsar/partitioner/PulsarKeyExtractor.java     |  4 +-
 .../pulsar/partitioner/package-info.java           | 22 +++++++++++
 17 files changed, 190 insertions(+), 74 deletions(-)

commit 91c4254cae3be91774220c9fea145d3e433b6a01
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Jul 29 10:24:32 2019 +0800

    Improve SchemaInfoProvider to fetch schema info asynchronously (#4836)
    
    *Motivation*
    
    Currently fetching schema information is done synchronously.
    It is called in netty callback threads and will potentially block
    async operations.
    
    *Modifications*
    
    Make most of the operations asynchronously in SchemaInfoProvider.

 .../client/api/schema/SchemaInfoProvider.java      |   5 +-
 .../client/impl/MultiTopicsConsumerImpl.java       |  18 +--
 .../pulsar/client/impl/PulsarClientImpl.java       |  58 ++++----
 .../pulsar/client/impl/schema/AvroSchema.java      |   2 +-
 .../pulsar/client/impl/schema/KeyValueSchema.java  |  31 +++--
 .../pulsar/client/impl/schema/StructSchema.java    |  21 +++
 .../impl/schema/generic/GenericAvroSchema.java     |   2 +-
 .../impl/schema/generic/GenericJsonSchema.java     |   2 +-
 .../generic/MultiVersionSchemaInfoProvider.java    |  58 ++++----
 .../apache/pulsar/client/impl/MessageImplTest.java |  13 +-
 .../schema/SupportVersioningAvroSchemaTest.java    |   3 +-
 .../SupportVersioningKeyValueSchemaTest.java       |   5 +-
 .../impl/schema/generic/GenericAvroSchemaTest.java |   3 +-
 .../impl/schema/generic/GenericSchemaImplTest.java |   5 +-
 .../MultiVersionSchemaInfoProviderTest.java        |   4 +-
 .../common/protocol/schema/BytesSchemaVersion.java | 147 ++++++++++++++++++++-
 16 files changed, 279 insertions(+), 98 deletions(-)

commit bfe7275110f2f0624a5e22867ec69fc77f6a67d7
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Sat Jul 27 11:27:19 2019 +0800

    [docs] Update the upgrade guide (#4792)
    
    ### Motivation
    The original PR https://github.com/apache/pulsar/pull/4770 is merged before I could give some feedback, so I just create a new pull request.
    
    ### Modifications
    1. Refine the structure, remove some unnecessary info currently. Thus it is displayed to users as a complete guide.
    2. Refine the language part, make it clear and concise.
    3. Though "upgrade ZooKeeper" is optional, could we add information for it? So users can decide whether they want to upgrade ZooKeeper. When they upgrade ZooKeeper, they know how to upgrade.

 site2/docs/administration-upgrade.md | 236 +++++++++++++++--------------------
 1 file changed, 103 insertions(+), 133 deletions(-)

commit 1dcac8cc8413493c32bba0184e9598db1e515b39
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Sat Jul 27 11:12:23 2019 +0800

    Fix : default retention policy in configuration do nothing (#4810)
    
    fix #4755
    Retention policy is used in Ledger GC and Topic GC.
    Default retention policy is not uploaded to zookeeper, but it is getted from zookeeper when it is used.
    So, if zookeeper doesn't have retention policy, we should load it from default config file.
    In Ledger GC configuration, it's OK.
    https://github.com/apache/pulsar/blob/075f28b71c8fd9259ce8e136dbb81c0629c3f271/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/BrokerService.java#L739-L742
    But in Topic GC, do nothing.

 .../broker/service/persistent/PersistentTopic.java | 44 +++++++++----------
 .../broker/service/PersistentTopicE2ETest.java     | 50 ++++++++++++++++++++--
 2 files changed, 69 insertions(+), 25 deletions(-)

commit b2c503a7156002e66ef601f118208fc72ff105be
Author: Grant Wu <grantwwu@gmail.com>
Date:   Fri Jul 26 23:10:29 2019 -0400

    Fix typos (#4798)
    
    s/is/it/

 site2/docs/concepts-tiered-storage.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 66360c13bd22f28d4cf5fe32fb79902d4f83517c
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Jul 26 17:47:47 2019 +0800

    [docs] Add functions-develop file for Pulsar Functions(new) (#4725)
    
    * Add develop part
    
    * Add new site2/docs/functions-develop.md for new structure
    
    * Adopt advice from Jerry
    
    * Update Python and Go examples
    
    * remove some tabs for Go
    
    * add Go example in logger section
    
    * remove Encryptiion at the end
    
    * restructure Example in SerDe section

 site2/docs/functions-develop.md | 616 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 616 insertions(+)

commit abe27e638ffa4976d6746b278bf987f810ed711a
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jul 26 13:25:06 2019 +0900

    Topic loading in rest-api should time out in zooKeeperOperationTimeoutSeconds (#4805)

 .../java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e1547e120d9d16fd18a24907f1861e6ce3e956b4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 25 21:24:39 2019 -0700

    Fix: Bug when function package jar/py/go and runtime is not set (#4814)
    
    ### Modifications
    
    When submitting a function via REST interface, if user doesn't provide the function package or function runtime as part of function config, the function will get submitted and deployed to run but the typeClassName for the source will not be set causing a weird error in the function instance code

 .../functions/utils/FunctionConfigUtils.java       |  4 +++-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     | 25 ++++++++++++++++++++++
 2 files changed, 28 insertions(+), 1 deletion(-)

commit 19b883b7e86e61ba071e230e7f5c6617089dff59
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 25 21:23:15 2019 -0700

    Fix: Messages don't get acked if there is not sink topic (#4815)
    
    ### Motivation
    
    A message doesn't get automatically ACKed if there is the output topic is not set

 .../main/java/org/apache/pulsar/functions/sink/PulsarSinkDisable.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f88ea9df9cdac2efb3511ff82a69593f08d69e3a
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 25 18:44:53 2019 -0700

    Reuse ManagedLedgerFactory instances across SQL queries (#4813)

 .../apache/pulsar/sql/presto/PulsarConnector.java  |  5 --
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  5 +-
 .../pulsar/sql/presto/PulsarSplitManager.java      | 89 ++++++++--------------
 .../pulsar/sql/presto/TestPulsarConnector.java     |  3 +-
 4 files changed, 36 insertions(+), 66 deletions(-)

commit 88c854473346507563305d6b65d7a094f7531964
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Jul 26 00:14:43 2019 +0800

    upgrade git_commit_id_plugin to 3.0 (#4801)

 pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit fb6895db195f08aa82f75dad93b1b9c0b1b15a88
Author: vzhikserg <vzhikserg@users.noreply.github.com>
Date:   Thu Jul 25 18:14:02 2019 +0200

    Test cleanup and simplification (#4799)
    
    * Simplified assert statements in the tests. Switch to usage of static imports in tests. (Part 1)
    
    * Simplify assert statements in the tests and use the appropriate assert statements. Switch to usage of static imports in tests. Remove unused imports (Part 2)

 .../mledger/impl/EntryCacheManagerTest.java        |   9 +-
 .../mledger/impl/ManagedCursorConcurrencyTest.java |  14 +-
 .../mledger/impl/ManagedCursorContainerTest.java   |  12 +-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  60 +++---
 .../mledger/impl/ManagedLedgerErrorsTest.java      |   9 +-
 .../impl/ManagedLedgerSingleBookieTest.java        |   6 +-
 .../mledger/impl/ManagedLedgerTerminationTest.java |  10 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  63 +++---
 .../mledger/impl/NonDurableCursorTest.java         |  25 ++-
 .../mledger/impl/OffloadLedgerDeleteTest.java      |   1 -
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 232 +++++++++++----------
 .../bookkeeper/mledger/impl/PositionTest.java      |   8 +-
 .../bookkeeper/mledger/util/RangeCacheTest.java    |  21 +-
 .../authentication/SaslAuthenticateTest.java       |  20 +-
 .../org/apache/pulsar/PulsarBrokerStarterTest.java | 126 +++++------
 .../broker/admin/AdminApiGetLastMessageIdTest.java |   6 -
 .../admin/AdminApiSchemaValidationEnforced.java    |  42 ++--
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   5 +-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  11 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  12 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |   8 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |   5 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |   5 +-
 .../pulsar/broker/auth/AuthorizationTest.java      | 154 +++++++-------
 .../delayed/InMemoryDeliveryTrackerTest.java       |  19 +-
 .../AntiAffinityNamespaceGroupTest.java            |   2 -
 .../broker/loadbalance/LoadBalancerTest.java       |  15 +-
 .../loadbalance/ModularLoadManagerImplTest.java    |   1 -
 .../loadbalance/SimpleLoadManagerImplTest.java     |  14 +-
 .../broker/lookup/http/HttpTopicLookupv2Test.java  |   1 -
 .../broker/namespace/NamespaceServiceTest.java     |  14 +-
 .../broker/namespace/OwnershipCacheTest.java       |  22 +-
 .../broker/service/BacklogQuotaManagerTest.java    |  42 ++--
 .../broker/service/BrokerBookieIsolationTest.java  |   1 -
 .../service/BrokerServiceThrottlingTest.java       |   2 -
 .../pulsar/broker/service/PeerReplicatorTest.java  |   3 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |  35 ++--
 .../service/PersistentMessageFinderTest.java       |  10 +-
 .../service/PersistentTopicConcurrentTest.java     |  13 +-
 .../broker/service/PersistentTopicE2ETest.java     |   6 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   5 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   4 +-
 .../pulsar/broker/service/ResendRequestTest.java   |   7 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   5 +-
 .../service/persistent/DelayedDeliveryTest.java    |   5 +-
 .../persistent/PersistentSubscriptionTest.java     |   2 +-
 .../stats/BookieClientsStatsGeneratorTest.java     |   4 +-
 .../pulsar/broker/stats/PrometheusMetricsTest.java |   5 +-
 .../zookeeper/ZooKeeperClientAspectJTest.java      |   3 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |   6 +-
 .../apache/pulsar/client/api/ClientErrorsTest.java |   2 +-
 .../api/PartitionedProducerConsumerTest.java       |   4 +-
 .../client/api/SimpleProducerConsumerStatTest.java |   3 +-
 .../client/api/SimpleProducerConsumerTest.java     |   8 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     |  13 +-
 .../client/impl/BrokerClientIntegrationTest.java   |  45 ++--
 .../pulsar/client/impl/MessageRedeliveryTest.java  |   2 -
 .../client/impl/PatternTopicsConsumerImplTest.java |   8 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |   8 +-
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |   7 +-
 .../pulsar/common/naming/NamespaceBundleTest.java  |  23 +-
 .../pulsar/common/naming/NamespaceBundlesTest.java |  10 +-
 .../worker/PulsarFunctionE2ESecurityTest.java      |   2 -
 .../worker/PulsarFunctionLocalRunTest.java         |  13 +-
 .../worker/PulsarFunctionPublishTest.java          |   2 -
 .../functions/worker/PulsarFunctionStateTest.java  |  42 +---
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |   1 -
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   5 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |  28 +--
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  90 ++++----
 .../proxy/ProxyPublishConsumeTlsTest.java          |   2 -
 .../client/impl/auth/AuthenticationAthenzTest.java |   7 +-
 .../apache/pulsar/client/api/ConsumerIdTest.java   |  20 +-
 .../org/apache/pulsar/client/impl/BackoffTest.java |   4 +-
 .../pulsar/client/impl/BatchMessageIdImplTest.java |  40 ++--
 .../apache/pulsar/client/impl/BuildersTest.java    |  24 +--
 .../client/impl/ClientInitializationTest.java      |   3 +-
 .../pulsar/client/impl/ConnectionTimeoutTest.java  |   2 -
 .../pulsar/client/impl/MessageIdCompareToTest.java |  25 +--
 .../client/impl/TypedMessageBuilderImplTest.java   |   6 +-
 .../impl/conf/ConfigurationDataUtilsTest.java      |   8 +-
 .../client/impl/schema/DefaultSchemasTest.java     |   4 +-
 .../client/impl/schema/DoubleSchemaTest.java       |   2 -
 .../common/compression/CompressorCodecTest.java    |   4 +-
 .../pulsar/common/naming/NamespaceNameTest.java    |  12 +-
 .../apache/pulsar/common/naming/TopicNameTest.java |   9 +-
 .../policies/data/AutoFailoverPolicyDataTest.java  |  12 +-
 .../common/policies/data/ClusterDataTest.java      |  21 +-
 .../common/policies/data/ConsumerStatsTest.java    |  40 ++--
 .../common/policies/data/LocalPolicesTest.java     |  11 +-
 .../policies/data/NamespaceIsolationDataTest.java  |  13 +-
 .../policies/data/PersistencePoliciesTest.java     |   9 +-
 .../common/policies/data/PoliciesDataTest.java     |  14 +-
 .../common/policies/data/PublisherStatsTest.java   |  58 +++---
 .../common/policies/data/RetentionPolicesTest.java |  13 +-
 .../policies/impl/MinAvailablePolicyTest.java      |  12 +-
 .../impl/NamespaceIsolationPoliciesTest.java       |  29 +--
 .../impl/NamespaceIsolationPolicyImplTest.java     |  40 ++--
 .../apache/pulsar/common/util/RateLimiterTest.java |  12 +-
 .../collections/ConcurrentLongHashMapTest.java     |  12 +-
 .../collections/ConcurrentLongPairSetTest.java     |   8 +-
 .../collections/ConcurrentOpenHashMapTest.java     |  18 +-
 .../collections/ConcurrentOpenHashSetTest.java     |   6 +-
 .../ConcurrentOpenLongPairRangeSetTest.java        |   5 +-
 .../ConcurrentSortedLongPairSetTest.java           |   6 +-
 .../GrowableArrayBlockingQueueTest.java            |  12 +-
 .../GrowablePriorityLongPairQueueTest.java         |   7 +-
 .../collections/TripleLongPriorityQueueTest.java   |   7 +-
 .../service/web/ZookeeperCacheLoaderTest.java      |   1 -
 .../serialization/AvroSerializationSchemaTest.java |   5 +-
 .../pulsar/PulsarConsumerSourceTests.java          |  41 ++--
 .../pulsar/functions/sink/PulsarSinkTest.java      |  10 +-
 .../pulsar/functions/source/PulsarSourceTest.java  |   7 +-
 .../windowing/WindowFunctionExecutorTest.java      |   1 -
 .../runtime/KubernetesRuntimeFactoryTest.java      |   2 -
 .../ClearTextSecretsProviderTest.java              |  13 +-
 .../EnvironmentBasedSecretsProviderTest.java       |  11 +-
 .../pulsar/functions/utils/ReflectionsTest.java    |   5 +-
 .../functions/worker/FunctionActionerTest.java     |  11 +-
 .../worker/FunctionRuntimeManagerTest.java         | 154 +++++---------
 .../functions/worker/MembershipManagerTest.java    |  15 +-
 .../worker/rest/api/FunctionsImplTest.java         |  26 +--
 .../apache/pulsar/io/common/IOConfigUtilsTest.java |   1 -
 .../node/TestAbstractConfigurationProvider.java    |  83 ++++----
 .../apache/pulsar/io/jdbc/JdbcAbstractSink.java    |   1 -
 .../io/kafka/connect/KafkaConnectSourceTest.java   |   8 +-
 .../org/apache/pulsar/io/kinesis/UtilsTest.java    |  45 ++--
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |   1 -
 .../pulsar/sql/presto/PulsarRecordCursor.java      |   2 -
 .../LocalZooKeeperConnectionServiceTest.java       |  21 +-
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |   3 +-
 .../tests/integration/cli/AdminMultiHostTest.java  |   1 -
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   | 101 ++++-----
 .../impl/FileSystemManagedLedgerOffloaderTest.java |  30 +--
 134 files changed, 1262 insertions(+), 1300 deletions(-)

commit 87c02a9f8e36bae853d68543e17d93d70a2cbef6
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jul 26 01:12:26 2019 +0900

    [Issue #4756][broker] Process requests asynchronously on some REST APIs (3) (#4795)
    
    * Process requests asynchronously on some REST APIs (3)
    
    * Add async rest handler to API for expiring message on single topic subscription

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  10 +-
 .../broker/admin/impl/PersistentTopicsBase.java    | 682 +++++++++++++++------
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 125 ++--
 .../pulsar/broker/admin/v2/PersistentTopics.java   |  90 ++-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |   2 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |   8 +-
 .../pulsar/broker/admin/PersistentTopicsTest.java  | 126 +++-
 7 files changed, 743 insertions(+), 300 deletions(-)

commit 075f28b71c8fd9259ce8e136dbb81c0629c3f271
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jul 24 11:23:59 2019 -0700

    add basic authentication capabilities to Pulsar SQL (#4779)

 conf/presto/catalog/pulsar.properties              |  20 +++-
 .../pulsar/sql/presto/PulsarConnectorConfig.java   | 113 +++++++++++++++++----
 .../apache/pulsar/sql/presto/PulsarMetadata.java   |  17 +++-
 .../pulsar/sql/presto/PulsarSplitManager.java      |  16 ++-
 4 files changed, 144 insertions(+), 22 deletions(-)

commit ecd73575d2631a7dc3deab4b85bac3bae4655cf6
Author: Sijie Guo <sijie@apache.org>
Date:   Wed Jul 24 14:54:11 2019 +0800

    Add a few recent presentations to the resources page (#4783)
    
    *Motivation*
    
    Add a few recent presentations to the resources page. They cover different topics:
    
    - 2.4.0 release
    - use case
    - serverless
    - spark + pulsar
    - flink + pulsar

 site2/website/data/resources.js | 40 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)

commit 84a72578196ff9bfbfd3f7ea876dcd45756dc6b2
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Jul 24 10:09:25 2019 +0800

    [Doc] Add Schema Chapter and Get Started Section (#4759)
    
    Add an independent Chapter for Pulsar Schema.
    
    This is the first sectionGet started.

 site2/docs/schema-get-started.md | 62 ++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json      |  3 ++
 2 files changed, 65 insertions(+)

commit 1ab35b01bcf931eb3b65a5660eca62a9ac4ceb1d
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Wed Jul 24 09:53:07 2019 +0800

    Pulsar SQL supports pulsar's primitive schema (#4728)
    
    ### Motivation
    Continue the PR of #4151

 .../apache/pulsar/common/schema/SchemaType.java    |  42 ++++++
 .../apache/pulsar/sql/presto/PulsarMetadata.java   |  97 +++++++++++-
 .../sql/presto/PulsarPrimitiveSchemaHandler.java   |  65 +++++++++
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  23 +--
 .../pulsar/sql/presto/PulsarSchemaHandlers.java    |  53 +++++++
 .../org/apache/pulsar/sql/presto/PulsarSplit.java  |  17 ++-
 .../pulsar/sql/presto/PulsarSplitManager.java      |   3 +-
 .../pulsar/sql/presto/TestPulsarConnector.java     |   2 +-
 .../pulsar/sql/presto/TestPulsarMetadata.java      |   4 +
 .../presto/TestPulsarPrimitiveSchemaHandler.java   | 162 +++++++++++++++++++++
 10 files changed, 442 insertions(+), 26 deletions(-)

commit 0362944f6f7d610dd5b54d3724958e0bb9cb7abc
Author: Xiaobing Fang <bingxf@qq.com>
Date:   Wed Jul 24 09:51:38 2019 +0800

    FixPulsarKafkaProducer is not thread safe (#4745)
    
    fix #4707

 .../clients/producer/PulsarKafkaProducer.java      |  4 +-
 .../kafka/PulsarKafkaProducerThreadSafeTest.java   | 61 ++++++++++++++++++++++
 2 files changed, 64 insertions(+), 1 deletion(-)

commit e8a95e5ba57107c1e08a2610b7c55361a09f812b
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Wed Jul 24 09:50:27 2019 +0800

    [Transaction][Buffer]Add new marker to show which message belongs to transaction (#4776)
    
    * [Transaction][Buffer]Add new marker to show which message belongs to transaction
    ---
    
    *Motivation*
    
    Add new message type in the transaction including data and commit and abort maker in the transaction log.
    
    *Modifications*
    
    Add two new types of transaction messages.
    TXN_COMMIT is the commit marker of the transaction.
    TXN_ABORT is the abort marker of the transaction.

 .../apache/pulsar/common/api/proto/PulsarApi.java  | 114 +++++++++++++++++++++
 .../pulsar/common/api/proto/PulsarMarkers.java     |   6 ++
 .../org/apache/pulsar/common/protocol/Markers.java |  45 ++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   4 +
 pulsar-common/src/main/proto/PulsarMarkers.proto   |   2 +
 .../apache/pulsar/common/protocol/MarkersTest.java |  33 ++++++
 6 files changed, 204 insertions(+)

commit 2cc34afc0320e66a996b9517d6729a495563fc54
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Jul 23 14:40:48 2019 +0900

    Process requests asynchronously on some REST APIs (2) (#4778)
    
    Master Issue: #4756
    
    ### Motivation
    
    This is a continuation of https://github.com/apache/pulsar/pull/4765.
    
    ### Modifications
    
    Added async rest handlers to the following APIs:
    ```
    DELETE /admin/namespaces/{tenant}/{cluster}/{namespace}
    PUT    /admin/namespaces/{tenant}/{cluster}/{namespace}/unload
    POST   /admin/namespaces/{tenant}/{cluster}/{namespace}/clearBacklog
    POST   /admin/namespaces/{tenant}/{cluster}/{namespace}/clearBacklog/{subscription}
    POST   /admin/namespaces/{tenant}/{cluster}/{namespace}/unsubscribe/{subscription}
    
    DELETE /admin/v2/namespaces/{tenant}/{namespace}
    PUT    /admin/v2/namespaces/{tenant}/{namespace}/unload
    POST   /admin/v2/namespaces/{tenant}/{namespace}/clearBacklog
    POST   /admin/v2/namespaces/{tenant}/{namespace}/clearBacklog/{subscription}
    POST   /admin/v2/namespaces/{tenant}/{namespace}/unsubscribe/{subscription}
    ```

 .../pulsar/broker/admin/impl/NamespacesBase.java   | 260 +++++++++++++--------
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  73 ++++--
 .../broker/admin/v1/NonPersistentTopics.java       |   4 +
 .../pulsar/broker/admin/v1/PersistentTopics.java   |   9 +-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  72 ++++--
 .../broker/admin/v2/NonPersistentTopics.java       |   4 +
 .../pulsar/broker/admin/v2/PersistentTopics.java   |   9 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  10 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java | 139 ++++++-----
 .../org/apache/pulsar/client/admin/Namespaces.java |  62 ++++-
 .../client/admin/internal/NamespacesImpl.java      |  94 ++++++--
 11 files changed, 511 insertions(+), 225 deletions(-)

commit 8e1d00ffabf3cf75ec69c504334934a3b4caa4af
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 22 15:03:26 2019 -0700

    Added more blog posts in the resources page (#4774)
    
    * Added more blog posts in the resources page
    
    * Added 2 more posts

 site2/website/data/resources.js | 169 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 169 insertions(+)

commit 6ddd51ff45999bd7daa238073e9bcfd87d1df16a
Author: lipenghui <penghui@apache.org>
Date:   Mon Jul 22 22:59:43 2019 +0800

    Add options to rewrite namespace delimiter for pulsar sql. (#4749)
    
    ### Motivation
    
    Fix #4732
    
    ### Modifications
    
    Add options to rewrite the namespace delimiter, disable by default
    
    Enable rewrite namespace delimiter can work well with superset:
    <img width="1279" alt="superset" src="https://user-images.githubusercontent.com/12592133/61385412-f0f35700-a8e4-11e9-87b2-a31b62128b58.png">
    
    
    ### Does this pull request potentially affect one of the following parts:
    
    *If `yes` was chosen, please highlight the changes*
    
      - Dependencies (does it add or upgrade a dependency): (no)
      - The public API: (no)
      - The schema: (no)
      - The default values of configurations: (no)
      - The wire protocol: (no)
      - The rest endpoints: (no)
      - The admin cli options: (no)
      - Anything that affects deployment: (no)
    
    ### Documentation
    
      - Does this pull request introduce a new feature? (no)

 conf/presto/catalog/pulsar.properties              |  7 +-
 .../apache/pulsar/common/naming/NamedEntity.java   |  2 +-
 .../pulsar/sql/presto/PulsarConnectorConfig.java   | 33 +++++++++
 .../pulsar/sql/presto/PulsarConnectorFactory.java  |  4 +-
 .../pulsar/sql/presto/PulsarConnectorUtils.java    | 14 ++++
 .../apache/pulsar/sql/presto/PulsarMetadata.java   | 27 +++++---
 .../pulsar/sql/presto/PulsarSplitManager.java      | 11 +--
 .../pulsar/sql/presto/TestPulsarConnector.java     | 18 +++++
 .../sql/presto/TestPulsarConnectorConfig.java      | 52 ++++++++++++++
 .../pulsar/sql/presto/TestPulsarMetadata.java      | 81 +++++++++++++---------
 .../pulsar/sql/presto/TestPulsarSplitManager.java  | 23 +++---
 11 files changed, 210 insertions(+), 62 deletions(-)

commit f7328a0413eee619e02f6dba6113d50d9bdcdd9b
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Jul 22 08:56:45 2019 +0800

     Add Upgrade Guide to Apache Pulsar (#4770)
    
    * Add Upgrade Guide to Apache Pulsar
    
    *Changes*
    
    Add a general upgrade guide to apache pulsar.
    
    * Update the upgrade guide

 site/_data/sidebar.yaml              |   2 +
 site2/docs/administration-upgrade.md | 182 +++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json          |   3 +-
 3 files changed, 186 insertions(+), 1 deletion(-)

commit 86a3bc5f80f35c4cf5630628ff684a947bf78246
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Mon Jul 22 01:40:18 2019 +0100

    Update README documentation (#4773)

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3c8a44e017c792de164547c536c14e277a5a0141
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Mon Jul 22 00:29:01 2019 +0100

    [Pulsar-Client] Add Producer Builder API Numeric Properties Validations (#4539)
    
    * [Pulsar-Client] Add Producer Numeric Properties Validation
    
    * Aligned deprecated and new Producer API validations
    
    * Deprecated and new Producer API validations are being aligned
    
    * batchingMaxMessages C++ API is being aligned with Java API
    
    * batchingMaxMessages Java API Validation is being aligned with C++ API
    
    * Review comments are addressed
    
    * Fix broken UTs

 .../client/api/v1/V1_ProducerConsumerTest.java     | 14 +++++----
 .../pulsar/client/impl/TopicFromMessageTest.java   | 20 ++++++------
 .../pulsar/client/api/ProducerConfiguration.java   | 10 ++----
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  7 ++---
 .../impl/conf/ProducerConfigurationData.java       | 36 +++++++++++++++++++++-
 .../client/impl/ProducerBuilderImplTest.java       | 28 +++++++++++++++++
 6 files changed, 86 insertions(+), 29 deletions(-)

commit 84364ddc10394f7361083a3505b34f0dc5710316
Author: vzhikserg <vzhikserg@users.noreply.github.com>
Date:   Mon Jul 22 01:28:29 2019 +0200

    Convert anonymous classes to lambda (#4703)
    
    * Convert anonymous functions to lambda
    
    * Replacing lambda with anonymous implementation, because lambda cannot be mocked

 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 52 +++++++---------------
 .../bookkeeper/mledger/util/CallbackMutexTest.java | 15 +++----
 .../java/org/apache/zookeeper/MockZooKeeper.java   |  6 +--
 .../broker/loadbalance/LeaderElectionService.java  | 20 +++------
 .../pulsar/broker/service/BrokerService.java       |  7 +--
 .../client/api/SimpleProducerConsumerTest.java     | 33 +++++---------
 .../worker/PulsarFunctionLocalRunTest.java         |  6 +--
 .../worker/PulsarFunctionPublishTest.java          | 12 +----
 .../functions/worker/PulsarFunctionStateTest.java  | 12 +----
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 32 +++----------
 .../apache/pulsar/common/nar/NarClassLoader.java   |  9 ++--
 .../org/apache/pulsar/common/util/RateLimiter.java |  7 +--
 .../collections/ConcurrentLongHashMapTest.java     |  6 +--
 .../instance/stats/ComponentStatsManager.java      | 13 +++---
 .../pulsar/functions/instance/ContextImplTest.java |  7 +--
 .../pulsar/io/canal/CanalAbstractSource.java       | 17 +------
 .../PollingZooKeeperConfigurationProvider.java     |  7 +--
 .../pulsar/io/flume/source/AbstractSource.java     | 17 +------
 .../pulsar/io/hdfs2/AbstractHdfsConnector.java     |  7 +--
 .../pulsar/io/hdfs3/AbstractHdfsConnector.java     |  7 +--
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    | 18 +++-----
 .../apache/pulsar/sql/presto/PulsarMetadata.java   | 52 +++++++++-------------
 .../pulsar/testclient/PerformanceConsumer.java     | 10 ++---
 .../pulsar/testclient/PerformanceProducer.java     | 10 ++---
 .../broker/zookeeper/aspectj/ClientCnxnAspect.java |  7 +--
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    | 16 ++-----
 .../tests/integration/cli/AdminMultiHostTest.java  | 13 +++---
 .../spark/SparkStreamingPulsarReceiverTest.java    |  6 +--
 28 files changed, 120 insertions(+), 304 deletions(-)

commit 8a3b3af614545b53afb5d8ff07e4492515112eb4
Author: Rui Fu <freeznet@users.noreply.github.com>
Date:   Mon Jul 22 00:12:32 2019 +0800

    [go function] fix: go function should parse conf content first (#4746)
    
    ### Motivation
    
    `pulsar-function-go/conf` package apply `instance-conf-path` with default value `HOME_PATH+github.com/apache/pulsar/pulsar-function-go/conf/conf.yaml`, once function deployed, the running node may not have the yaml conf file exist, then go function will panic with `not found conf file` error.
    
    This PR changed the logic of config parsing, parse `confContent` first, then parse `confFilePath` if `confContent` empty.

 pulsar-function-go/conf/conf.go | 22 ++++++++++++++++------
 1 file changed, 16 insertions(+), 6 deletions(-)

commit f13af487699dcb36b7458ff4872a771837feefc6
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jul 21 01:51:05 2019 -0700

    Allow to configure ack-timeout tick time (#4760)
    
    ### Motivation
    
    After the changes in #3118, there has a been a sharp increase of memory utilization for the UnackedMessageTracker due to the time buckets being created.
    
    This is especially true when the acktimeout is set to a larger value (eg: 1h) where 3600 time-buckets are being created. This lead to use 20MB per partition even when no message is tracked.
    
    Allowing to configure the tick time so that application can tune it based on needs.
    
    Additionally, fixed the logic that keeps creating hash maps and throwing them away at each tick time iteration, since that creates a lot of garbage and doesn't take care of the fact that the hash maps are expanding based on the required capacity (so next time they are already of the "right" size).
    
    On a final note: the current default of 1sec seems very wasteful. Something like 10s should be more appropriate as default.

 .../apache/pulsar/client/api/ConsumerBuilder.java  | 25 ++++++++++++++----
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  9 +++++++
 .../pulsar/client/impl/UnAckedMessageTracker.java  | 30 ++++++++++++++--------
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  2 +-
 .../pulsar/sql/presto/PulsarSplitManager.java      |  2 +-
 5 files changed, 51 insertions(+), 17 deletions(-)

commit 5cff1691fd4c4900befd8ad4e21bec1023a0c936
Author: Sijie Guo <sijie@apache.org>
Date:   Sun Jul 21 14:22:31 2019 +0800

    [test] add getters and setters to PulsarService & BrokerService (#4709)
    
    *Motivation*
    
    When using PulsarService or BrokerService for testing, it might require accessing
    the components in PulsarService and BrokerService. This change is adding setters
    and getters to access the components in PulsarService & BrokerService

 .../org/apache/pulsar/broker/PulsarService.java    | 58 ++++++----------------
 .../pulsar/broker/service/BrokerService.java       | 18 ++++---
 2 files changed, 25 insertions(+), 51 deletions(-)

commit 8c3445ad6746df93fef80d2c661374cdab00bc38
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Jul 20 23:21:22 2019 -0700

    Fix: Add kubernetes namespace to function instance url (#4701)
    
    ### Motivation
    
    
    Currently, if the kubernetes namespace set to deploy functions in is different than the one in which brokers/workers reside, get status and stats doesn't work because the url for instances does not specify the namespace.

 .../org/apache/pulsar/functions/runtime/KubernetesRuntime.java    | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit e7c81096dc0699bd6cdc0cb4756f37e9c0e6f04f
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jul 20 23:20:46 2019 -0700

    Removed specialization of CopyOnWriteArrayList class (#4710)
    
    ### Motivation
    
    Switched back to use the regular `java.util.concurrent.CopyOnWriteArrayList` instead of the class extending it since we don't really have any advantage in accessing the underlying array of objects.
    
    The reflection being used to get that field is giving errors on Java 12.

 .../AbstractDispatcherMultipleConsumers.java       |  13 ++-
 .../AbstractDispatcherSingleActiveConsumer.java    |   6 +-
 .../apache/pulsar/broker/service/Dispatcher.java   |   3 +-
 .../nonpersistent/NonPersistentDispatcher.java     |  13 +--
 .../NonPersistentDispatcherMultipleConsumers.java  |   4 +-
 .../nonpersistent/NonPersistentSubscription.java   |   8 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  10 +-
 .../PersistentDispatcherMultipleConsumers.java     |   2 +-
 .../service/persistent/PersistentSubscription.java |  14 +--
 .../broker/service/persistent/PersistentTopic.java |   9 +-
 .../apache/pulsar/utils/CopyOnWriteArrayList.java  | 124 ---------------------
 .../apache/pulsar/utils/StatsOutputStreamTest.java |  81 +-------------
 12 files changed, 40 insertions(+), 247 deletions(-)

commit 1852dc3803eb58a2894100f417e8c1dbb321dab1
Author: tuteng <eguangning@gmail.com>
Date:   Sun Jul 21 14:19:11 2019 +0800

    Fix document of debezium (#4713)
    
    ### Motivation
    
    There are some typos in the document content of about debezium, which affect users' use, so fix it.
    
    ### Modifications
    
    Fix typos in document of debezium. And format content

 site2/website/versioned_docs/version-2.4.0/io-cdc-debezium.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit d7b3af00f5eb461b7383bdc1af314f763c54463d
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Sun Jul 21 06:18:54 2019 +0000

    Increasing Dashboard consumerName field to 256 varchar (#4716)
    
    * Changed remove-backlog-quotas to remove-backlog-quota
    
    * Changed remove-backlog-quotas to remove-backlog-quota
    
    * Increased the consumerName field to varchar(256)
    
    Signed-off-by: Yuvaraj Loganathan <uvaraj6@gmail.com>

 dashboard/django/stats/models.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1087dad7c4eb0b99bf50b0d1bebb385064e7ddd4
Author: Brandon <brandonJY@users.noreply.github.com>
Date:   Sun Jul 21 14:18:27 2019 +0800

    [docs] add memory requirement and config tips for standalone mode (#4717)
    
    * add memory requirement and config tips for standalone mode
    
    In the current standalone get start doc, there is no mentioning or link for the memory usage of the pulsar.
    User with limited free memory may encounter issue to start the Pulsar.
    Adding the tips on how to change the default required heap memory.

 site2/docs/getting-started-standalone.md | 3 +++
 1 file changed, 3 insertions(+)

commit b897f5e1e334696a57084d827de563199f89160b
Author: Brandon <brandonJY@users.noreply.github.com>
Date:   Sun Jul 21 14:17:53 2019 +0800

    [docs] add security warning on standalone doc (#4719)
    
    * [docs] add security warning on standalone doc
    
    Add a fair warning on standalone get start document.  Since by default configure, Pulsar can be accessed from remote server without any authentication, encryption, authentication.  So a fair warning to the user is critical to avoid any unexpected security risks.

 site2/docs/getting-started-standalone.md | 2 ++
 1 file changed, 2 insertions(+)

commit 26fc4efe5175398068d50d16cea61560ff7b8a0c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Jul 20 23:17:17 2019 -0700

    fix: add anonymous role to proxy configuration (#4733)

 .../java/org/apache/pulsar/proxy/server/ProxyConfiguration.java     | 6 ++++++
 1 file changed, 6 insertions(+)

commit bf58c8ebdecaeb2d982df069265d2e263b6f4e3d
Author: Rui Fu <freeznet@users.noreply.github.com>
Date:   Sun Jul 21 14:16:42 2019 +0800

    set go function executable when download to local (#4743)
    
    ### Motivation
    
    Currently golang function needs to be compiled before deploy to pulsar, so the executable permission is required when function package is downloaded to local node from bookkeeper. This PR is intent to make golang function package executable after download from bookkeeper, to make sure the function is ok to run.

 .../java/org/apache/pulsar/functions/worker/FunctionActioner.java    | 5 +++++
 1 file changed, 5 insertions(+)

commit 5162393c7eb48862bc4bdc82ed05a0f20963f274
Author: Jia Zhai <zhaijia@apache.org>
Date:   Sun Jul 21 14:15:53 2019 +0800

    Allow to create partitioned topic with 1 partition (#4764)
    
    **Motivation**
    when create partitioned topic, there is a check that `numPartitions > 1`, if numPartitions==1, it will fail.
    Some user may want to create partitioned topic with only 1 topic at the start time, and during using it, could update to more topics later.
    
    **Modification**
    change check of `numPartitions > 1` to `numPartitions > 0`
    
    expect all existing ut passed.

 .../apache/pulsar/broker/admin/impl/PersistentTopicsBase.java  |  8 ++++----
 .../org/apache/pulsar/broker/admin/v1/NonPersistentTopics.java |  4 ++--
 .../org/apache/pulsar/broker/admin/v2/NonPersistentTopics.java |  4 ++--
 .../org/apache/pulsar/broker/admin/v2/PersistentTopics.java    |  2 +-
 .../pulsar/client/admin/internal/NonPersistentTopicsImpl.java  |  2 +-
 .../org/apache/pulsar/client/admin/internal/TopicsImpl.java    | 10 +++++-----
 6 files changed, 15 insertions(+), 15 deletions(-)

commit af6d4dab90ceeb148d301df6723c257ebe5b8111
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Sun Jul 21 10:49:55 2019 +0800

    [docs] Add functions-debug file for Pulsar Functions(new) (#4729)
    
    * add functions-debug file for new structure
    
    * update a few typos

 site2/docs/functions-debug.md | 447 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 447 insertions(+)

commit d8f61553dab65bb8a76f130ff48a7efc3710df2d
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sat Jul 20 09:25:24 2019 +0900

    Introduce strand to C++ client for exclusive control (#4750)

 pulsar-client-cpp/lib/ClientConnection.cc | 58 ++++++++++++++++++++++++++-----
 pulsar-client-cpp/lib/ClientConnection.h  | 21 +++++++++--
 2 files changed, 68 insertions(+), 11 deletions(-)

commit 849b6c57c32435e3eb77b2e852159470ec27c6f2
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sat Jul 20 09:25:11 2019 +0900

    Process requests asynchronously on some REST APIs (1) (#4765)

 .../broker/admin/v1/NonPersistentTopics.java       | 67 +++++++++++++---------
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 18 +++---
 .../broker/admin/v2/NonPersistentTopics.java       | 62 +++++++++++---------
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 11 +++-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  6 +-
 5 files changed, 96 insertions(+), 68 deletions(-)

commit 6ec2e16b6bd68ad51e2841277164a53fcfb1260b
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Sat Jul 20 00:52:07 2019 +0800

    Add deleted schema judgment when adding schema  (#4731)
    
    ### Motivation
    to fix #4724
    
    ### Verifying this change
    Add the tests for it

 .../service/schema/BookkeeperSchemaStorage.java    |  24 +++--
 .../service/schema/SchemaRegistryServiceImpl.java  | 101 ++++++++++++++-------
 .../broker/service/schema/SchemaStorage.java       |   2 +-
 .../broker/service/schema/SchemaServiceTest.java   |  17 ++++
 4 files changed, 102 insertions(+), 42 deletions(-)

commit 81ab4eed382aa9641b24164723798db85cb1e28f
Author: tuteng <eguangning@gmail.com>
Date:   Fri Jul 19 23:57:25 2019 +0800

    [doc][download]Fix download link not found in document (#4714)
    
    * Fix download link not found in document
    
    * Update sorted

 site2/website/data/connectors.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 9605aede8aa1e14783d480a2fc6a55fe8ceaa67a
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Fri Jul 19 22:58:03 2019 +0900

    add timeout to internal rest api (#4762)

 .../admin/internal/NonPersistentTopicsImpl.java    | 30 ++++++++++++----
 .../pulsar/client/admin/internal/TopicsImpl.java   | 40 ++++++++++++++++------
 2 files changed, 53 insertions(+), 17 deletions(-)

commit 8b197c6bcb42dd26ed449cfe04b8b12495f3d98e
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Fri Jul 19 18:22:23 2019 +0800

    Get schema info with topic partition (#4751)

 .../java/org/apache/pulsar/broker/admin/v2/SchemasResource.java    | 7 ++++++-
 .../java/org/apache/pulsar/broker/admin/AdminApiSchemaTest.java    | 6 ++++++
 2 files changed, 12 insertions(+), 1 deletion(-)

commit af8ea71a0d87d6db4432353cb250e87f77d8ebb9
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jul 19 16:14:09 2019 +0900

    Fix C++ log level names in Log4cxxLogger (#4735)
    
    ### Motivation
    
    If trying to build master C++ code with the `USE_LOG4CXX` flag turned ON, compilation errors occur:
    ```
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc: In static member function static log4cxx::LevelPtr pulsar::Log4CxxLogger::getLevel(pulsar::Logger::Level):
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:53:18: error: DEBUG was not declared in this scope
                 case DEBUG:
                      ^
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:55:18: error: INFO was not declared in this scope
                 case INFO:
                      ^
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:57:18: error: WARN was not declared in this scope
                 case WARN:
                      ^
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:59:18: error: ERROR was not declared in this scope
                 case ERROR:
                      ^
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:52:16: error: enumeration value LEVEL_DEBUG not handled in switch [-Werror=switch]
             switch (level) {
                    ^
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:52:16: error: enumeration value LEVEL_INFO not handled in switch [-Werror=switch]
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:52:16: error: enumeration value LEVEL_WARN not handled in switch [-Werror=switch]
    /tmp/pulsar/pulsar-client-cpp/lib/Log4cxxLogger.cc:52:16: error: enumeration value LEVEL_ERROR not handled in switch [-Werror=switch]
    cc1plus: some warnings being treated as errors
    make[2]: *** [lib/CMakeFiles/pulsarStatic.dir/Log4cxxLogger.cc.o] Error 1
    make[2]: *** Waiting for unfinished jobs....
    ```
    
    This is because the enum values renamed in https://github.com/apache/pulsar/pull/4664 are still used in `Log4cxxLogger.cc`.
    
    ### Modifications
    
    Fixed the enum values used in `Log4cxxLogger.cc` by adding the prefix `LEVEL_`.

 pulsar-client-cpp/lib/Log4cxxLogger.cc | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit cc5f25bf1a97609ad065908b9a60866c382ee2e0
Author:  <ranxiaolong716@gmail.com>
Date:   Fri Jul 19 09:51:39 2019 +0800

    [issue 4589] Fix redelivered message logic of partition topic (#4653)
    
    Fixes #4589
    
    Motivation
    When using Partition-topic, the logic of redeliver messages will not be triggered when the time of ackTimeout arrives.
    
    This is because the unAckedMessageTrackerPtr_->add(msg.getMessageId()) is not call in the listener handling of partitioned topic in cpp code

 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc |  1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 51 +++++++++++++++++++
 pulsar-client-go/pulsar/c_consumer.go            |  2 +-
 pulsar-client-go/pulsar/c_error.go               |  2 +-
 pulsar-client-go/pulsar/consumer_test.go         | 62 ++++++++++++++++++++++++
 5 files changed, 116 insertions(+), 2 deletions(-)

commit 6f5416eea0e7010c26091d9cbe72122b1fd94268
Author: lipenghui <penghui@apache.org>
Date:   Fri Jul 19 09:13:14 2019 +0800

    Change type of publish_time to timestamp (#4757)
    
    Fixes #4734
    
    ### Motivation
    
    "publish_time" is Pulsar SQL internal column, as Pulsar only stores timestamps, it doesnt store the timezone information. Use timestamp as "publish_time" type is more correct way in Pulsar SQL.
    
    ### Modifications
    
    Change type of publish_time to timestamp.
    
    ### Verifying this change
    
    predicate of publish_time is pushdown
    
    Use `__publish_time__` to trim messages:
    ```
    SELECT COUNT(*)
    FROM "sql-test-1"
    WHERE "__publish_time__" >= TIMESTAMP '2019-07-18 17:26:50.119'
    AND  "__publish_time__" < TIMESTAMP '2019-07-18 17:26:51.119';
    ```
    ![image](https://user-images.githubusercontent.com/12592133/61447301-43835080-a983-11e9-814b-bc2b378f02b9.png)
    
    Without `__publish_time__` predicate:
    ```
    SELECT COUNT(*)
    FROM "sql-test-1";
    ```
    ![image](https://user-images.githubusercontent.com/12592133/61447427-82190b00-a983-11e9-8d3f-3bf2a4798047.png)

 .../apache/pulsar/sql/presto/PulsarInternalColumn.java   |  3 +--
 .../org/apache/pulsar/sql/presto/PulsarSplitManager.java | 16 +++++++++++-----
 .../apache/pulsar/sql/presto/TestPulsarSplitManager.java | 14 +++++---------
 3 files changed, 17 insertions(+), 16 deletions(-)

commit f5b20cd3f08513fb82d93a22b2019753ae698e44
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Fri Jul 19 09:05:31 2019 +0800

    Remove fixed server type check in kerberos client (#4758)
    
    ## Motivation
    
    Currently, In Pulsar Kerberos authentication, The server type part of pulsar node principle is hard coded as "broker" and "proxy". The expected principle for pulsar nodes would be like "broker/brokera.host.name@your.com" or "proxy/proxyb.host.name@your.com".
    
    But some times, user may want to re-use existing principle like "u-service/host.name@some.com", to test and play around, then "u-service" will not match service type of "broker" or "proxy", and the authentication will be rejected.
    This change is to remove the check of "broker" or "proxy" service type check.
    
    ## Modifaction
    
    Remove the check of "broker" or "proxy" service type check.

 .../java/org/apache/pulsar/client/impl/auth/PulsarSaslClient.java  | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit bbac857cfa8aef9788b35e987c16b016a4d59c32
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 18 16:01:29 2019 -0700

    Remove failed stale producer from the connection (#4741)
    
    remove failed consumer from cnx
    
    fix test

 .../java/org/apache/pulsar/broker/service/ServerCnx.java   |  5 +++--
 .../org/apache/pulsar/broker/service/ServerCnxTest.java    | 14 +++++---------
 2 files changed, 8 insertions(+), 11 deletions(-)

commit ac10b006cf59308ae1a0bf8307ddcb2f5745cc11
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 18 11:59:33 2019 -0700

    Fix: predicate pushdown for Pulsar SQL NPE (#4744)
    
    * Fix: predicate pushdown for Pulsar SQL NPE
    
    * fix unit test

 .../bookkeeper/mledger/impl/OpFindNewest.java      |  2 +-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  7 +-
 .../service/PersistentMessageFinderTest.java       |  2 +-
 tests/integration/pom.xml                          |  7 ++
 .../containers/PrestoWorkerContainer.java          |  5 ++
 .../tests/integration/presto/TestBasicPresto.java  | 92 +++++++++++++++++++++-
 6 files changed, 109 insertions(+), 6 deletions(-)

commit 23dd38f3108a0456cedb56452ac39aaa57a2ae81
Author:  <ranxiaolong716@gmail.com>
Date:   Fri Jul 19 00:36:31 2019 +0800

    Fix the problem that the log folder in pulsa-function-go is ignored by (#4736)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-function-go/conf/conf.go      |   2 +-
 pulsar-function-go/logutil/log.go    | 180 +++++++++++++++++++++++++++++++++++
 pulsar-function-go/pf/function.go    |   2 +-
 pulsar-function-go/pf/instance.go    |   2 +-
 pulsar-function-go/pf/logAppender.go |   2 +-
 5 files changed, 184 insertions(+), 4 deletions(-)

commit 0a59b4cea511060c1aecb85752b425ae0e37e610
Author: tuteng <eguangning@gmail.com>
Date:   Thu Jul 18 18:59:04 2019 +0800

    [Integeration-test]Fix integration-test failed when execute pip3 install pulsar_client (#4754)
    
    * ### Motivation
    When installing the pulsar-client-2.5.0 using the image openjdk:8-jdk-slim, for debian 10 systems, python3.7 will be installed when apt-get install python3 is executed. When installing the client using pip3, the following exception will be thrown
    ```
    cat /etc/issue
    Debian GNU/Linux 10 \n \l
    
    root@40fdedf3f3c3:/# python3
    Python 3.7.3 (default, Apr  3 2019, 05:39:12)
    [GCC 8.3.0] on linux
    Type "help", "copyright", "credits" or "license" for more information.
    >>>
    
    root@40fdedf3f3c3:/# pip3 install pulsar_client-2.5.0-cp35-cp35m-manylinux1_x86_64.whl
    ERROR: pulsar_client-2.5.0-cp35-cp35m-manylinux1_x86_64.whl is not a supported wheel on this platform.
    ```
    
    ### Modifications
    
    Install Use pip3.5 instead of pip3.
    
    * Deleute no used tools
    
    * Fix Docker command

 docker/pulsar/Dockerfile                          | 10 ++++++++--
 docker/pulsar/scripts/install-pulsar-client-35.sh |  2 +-
 2 files changed, 9 insertions(+), 3 deletions(-)

commit 6ff1bbae0fe230eb72d62574d7685a745f884416
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jul 12 21:58:44 2019 -0700

     Use classloaders to load Java functions (#4685)
    
    * Use classloading to load use code for functions

 bin/pulsar                                         |   2 +
 distribution/server/pom.xml                        |   6 -
 distribution/server/src/assemble/bin.xml           |   2 +
 .../pulsar/client/internal/ReflectionUtils.java    |  10 +-
 .../functions/instance/JavaInstanceRunnable.java   | 102 ++++--
 .../apache/pulsar/functions/sink/PulsarSink.java   |   9 +-
 .../pulsar/functions/source/PulsarSource.java      |   7 +-
 .../pulsar/functions/sink/PulsarSinkTest.java      |  18 +-
 .../pulsar/functions/source/PulsarSourceTest.java  |   8 +-
 .../org/apache/pulsar/functions/LocalRunner.java   |   4 +-
 pulsar-functions/runtime-all/pom.xml               | 370 ++-------------------
 .../functions/instance/JavaInstanceMain.java       | 150 +++++++++
 .../src/main/resources/java_instance_log4j2.xml    | 130 ++++++++
 .../main/resources/kubernetes_instance_log4j2.xml  |  60 ++++
 ...aInstanceMain.java => JavaInstanceStarter.java} |  79 ++---
 .../functions/runtime/KubernetesRuntime.java       |   2 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |   2 +-
 .../pulsar/functions/runtime/RuntimeUtils.java     |  19 +-
 .../functions/runtime/ThreadRuntimeFactory.java    |  34 +-
 .../src/main/resources/java_instance_log4j2.yml    | 111 -------
 .../main/resources/kubernetes_instance_log4j2.yml  |  53 ---
 .../functions/runtime/KubernetesRuntimeTest.java   |  13 +-
 .../functions/runtime/ProcessRuntimeTest.java      |  13 +-
 .../utils/functioncache/FunctionCacheEntry.java    |  18 +-
 .../functioncache/FunctionCacheManagerImpl.java    |   9 +-
 .../functions/worker/FunctionRuntimeManager.java   |   2 +-
 .../functions/worker/SchedulerManagerTest.java     |  18 +-
 27 files changed, 605 insertions(+), 646 deletions(-)

commit d2164ebfe8e34e3f22d5181d90d01a3c39e0d859
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Jul 12 13:59:38 2019 -0700

    [build] `docker/publish.sh` doesn't work for pulsar-all and pulsar-standalone images (#4705)
    
    *Motivation*
    
    pulsar-all and pulsar-standalone dont tag correct as pulsar image.
    so it fails `docker/publish.sh`
    
    *Modifications*
    
    Tag no-repo for both latest and the release version for both pulsar-all and pulsar-standalone
    
    *Verify this change*
    
    After patching this change, `docker/publish.sh` works as expected.

 docker/pulsar-all/pom.xml        | 20 ++++++++++++++++++++
 docker/pulsar-standalone/pom.xml | 20 ++++++++++++++++++++
 2 files changed, 40 insertions(+)

commit 22a80207373a55149ad5677ccaf7b0216ea0b349
Author: Like <ke.like@outlook.com>
Date:   Wed Jul 10 15:16:35 2019 +0800

    [Doc] Fix FAQ broken link (#4640)
    
    The PIP for message deduplication is unaccessable and should PIP-6.

 faq.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 108780c79cc9ec71f4ff8ee3a7231766ef545894
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 9 23:17:07 2019 -0700

    Upgrade to Mockito 2.x (#4671)
    
    Upgrading to Mockito 2.28 and PowerMock 2.0. This a pre-step to be able to run CI with Java 11 / 12

 buildtools/pom.xml                                 |    9 +-
 distribution/server/src/assemble/LICENSE.bin.txt   |    4 +-
 .../bookkeeper/client/PulsarMockReadHandle.java    |    6 +-
 .../bookkeeper/mledger/impl/EntryCacheTest.java    |   15 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |    6 +-
 .../mledger/impl/OffloadPrefixReadTest.java        |   22 +-
 pom.xml                                            |   21 +-
 .../pulsar/broker/admin/AdminApiOffloadTest.java   |   22 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |  253 +----
 .../broker/auth/AuthenticationServiceTest.java     |    2 +-
 .../broker/cache/ResourceQuotaCacheTest.java       |    2 +-
 .../delayed/InMemoryDeliveryTrackerTest.java       |    8 +-
 .../broker/namespace/NamespaceServiceTest.java     |    2 +-
 .../broker/namespace/OwnershipCacheTest.java       |    5 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |    6 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   21 +-
 .../service/PersistentTopicConcurrentTest.java     |    2 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   55 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   12 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   44 +-
 .../persistent/PersistentSubscriptionTest.java     |   62 +-
 ...ReplicatedSubscriptionsSnapshotBuilderTest.java |    4 +-
 ...RegistryServiceWithSchemaDataValidatorTest.java |    6 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |    2 +-
 .../client/api/SimpleProducerConsumerTest.java     |    2 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     |    2 +-
 .../client/impl/BrokerClientIntegrationTest.java   |   16 +-
 .../pulsar/common/naming/NamespaceBundleTest.java  |    2 +-
 .../pulsar/common/naming/NamespaceBundlesTest.java |    4 +-
 .../apache/pulsar/compaction/CompactionTest.java   |    2 +-
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |    2 +-
 .../clients/producer/PulsarKafkaProducerTest.java  |   61 +-
 .../KafkaProducerInterceptorWrapperTest.java       |    2 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |    6 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   36 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |    4 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |    9 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |    5 +
 .../pulsar/client/api/MessageRouterTest.java       |    2 +-
 .../apache/pulsar/client/impl/ClientCnxTest.java   |    6 +-
 .../apache/pulsar/client/impl/MessageImplTest.java |    2 +-
 .../client/impl/ProducerBuilderImplTest.java       |    6 +-
 .../schema/SupportVersioningAvroSchemaTest.java    |    2 +-
 .../SupportVersioningKeyValueSchemaTest.java       |    2 +-
 .../impl/schema/generic/GenericAvroSchemaTest.java |    4 +-
 .../impl/schema/generic/GenericSchemaImplTest.java |    2 +-
 .../MultiVersionSchemaInfoProviderTest.java        |    9 +-
 .../apache/pulsar/client/util/ObjectCacheTest.java |    3 +-
 .../apache/pulsar/common/naming/TopicNameTest.java |    2 +
 .../pulsar/common/protocol/ByteBufPairTest.java    |    2 +-
 .../pulsar/common/protocol/PulsarDecoderTest.java  |    2 +-
 .../connectors/pulsar/PulsarAvroTableSinkTest.java |   10 +-
 .../pulsar/PulsarConsumerSourceTests.java          |    6 +-
 .../connectors/pulsar/PulsarJsonTableSinkTest.java |   11 +-
 .../pulsar/functions/source/PulsarSource.java      |    2 +-
 .../pulsar/functions/instance/ContextImplTest.java |   35 +-
 .../instance/JavaInstanceRunnableProcessTest.java  | 1012 --------------------
 .../instance/state/StateContextImplTest.java       |    6 +-
 .../pulsar/functions/sink/PulsarSinkTest.java      |   95 +-
 .../pulsar/functions/source/PulsarSourceTest.java  |   39 +-
 .../windowing/WindowFunctionExecutorTest.java      |   22 +-
 .../KubernetesSecretsTokenAuthProviderTest.java    |   20 +-
 .../EnvironmentBasedSecretsProviderTest.java       |    6 +-
 .../apache/pulsar/functions/utils/ActionsTest.java |    2 +-
 .../worker/ClusterServiceCoordinatorTest.java      |    4 +-
 .../functions/worker/FunctionActionerTest.java     |    3 +-
 .../worker/FunctionMetaDataManagerTest.java        |  147 ++-
 .../worker/FunctionMetaDataTopicTailerTest.java    |    4 +-
 .../worker/FunctionRuntimeManagerTest.java         |  108 +--
 .../functions/worker/MembershipManagerTest.java    |   27 +-
 .../functions/worker/SchedulerManagerTest.java     |    8 +-
 .../functions/worker/dlog/DLInputStreamTest.java   |    6 +-
 .../functions/worker/dlog/DLOutputStreamTest.java  |    2 +-
 .../worker/executor/MockExecutorController.java    |   20 +-
 .../worker/request/ServiceRequestManagerTest.java  |    2 +-
 .../worker/rest/api/FunctionsImplTest.java         |    6 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   57 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |   56 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |   16 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   56 +-
 .../pulsar/io/file/FileConsumerThreadTests.java    |    2 +-
 .../pulsar/io/file/FileListingThreadTests.java     |    2 +-
 .../pulsar/io/file/ProcessedFileThreadTests.java   |    2 +-
 .../io/influxdb/InfluxDBGenericRecordSinkTest.java |    6 +-
 .../org/apache/pulsar/io/mongodb/MongoSink.java    |   39 +-
 .../apache/pulsar/io/mongodb/MongoSinkTest.java    |   40 +-
 .../pulsar/log4j2/appender/PulsarAppender.java     |    1 +
 .../pulsar/log4j2/appender/PulsarAppenderTest.java |   29 +-
 pulsar-sql/presto-distribution/LICENSE             |    3 +-
 pulsar-sql/presto-distribution/pom.xml             |    7 +
 .../pulsar/sql/presto/TestPulsarConnector.java     |    6 +-
 .../pulsar/sql/presto/TestPulsarMetadata.java      |    2 +-
 .../pulsar/sql/presto/TestPulsarSplitManager.java  |    6 +-
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   31 +-
 tiered-storage/jcloud/pom.xml                      |    5 +
 .../jcloud/BlobStoreBackedInputStreamTest.java     |    8 +-
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  |    6 +-
 .../impl/BlockAwareSegmentInputStreamTest.java     |    6 +-
 98 files changed, 755 insertions(+), 2022 deletions(-)

commit 363b6bae6867d2810d01719a86f6f60060c7226b
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 9 09:59:10 2019 -0700

    Added delayed messages in Prometheus when using namespace-level metrics aggregation (#4691)

 .../pulsar/broker/stats/prometheus/AggregatedNamespaceStats.java     | 3 +++
 .../pulsar/broker/stats/prometheus/NamespaceStatsAggregator.java     | 5 +++++
 2 files changed, 8 insertions(+)

commit a0ec11acf40a316420d15f3b79b5fe0eedf70392
Author: lipenghui <penghui@apache.org>
Date:   Wed Jul 10 00:01:57 2019 +0800

    Add allowAutoTopicCreation to broker.conf and reference configuration. (#4694)

 conf/broker.conf                      | 3 +++
 site2/docs/reference-configuration.md | 1 +
 2 files changed, 4 insertions(+)

commit b291272dae14f7897282d980bdef11d2174cae5d
Author: Fred Eisele <phreed@users.noreply.github.com>
Date:   Tue Jul 9 10:53:46 2019 -0500

    [] [site2/docs] python api reader interface example correction to documentation (#4690)
    
    * update master with correction to documentation for python reader
    
    * Update site/docs/latest/clients/Python.md
    
    Co-Authored-By: Matteo Merli <mmerli@apache.org>

 site/docs/latest/clients/Python.md                                      | 2 +-
 site2/docs/client-libraries-python.md                                   | 2 +-
 .../versioned_docs/version-2.1.0-incubating/client-libraries-python.md  | 2 +-
 .../versioned_docs/version-2.1.1-incubating/client-libraries-python.md  | 2 +-
 site2/website/versioned_docs/version-2.2.0/client-libraries-python.md   | 2 +-
 site2/website/versioned_docs/version-2.3.0/client-libraries-python.md   | 2 +-
 site2/website/versioned_docs/version-2.3.1/client-libraries-python.md   | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)

commit d1013524dbdcf4775df5a5dc7da347b44fcd309b
Author: lipenghui <penghui@apache.org>
Date:   Tue Jul 9 23:52:56 2019 +0800

    Blog of 2.4.0 release (#4677)
    
    * 2.4.0 release blog.
    
    * fix comments.
    
    * fix comments.
    
    * fix comments.

 .../website/blog/2019-07-05-Apache-Pulsar-2-4-0.md | 121 +++++++++++++++++++++
 1 file changed, 121 insertions(+)

commit d77980d2a63236b132cfc6ca7f596de9fb0e7569
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jul 8 21:07:20 2019 +0200

    Don't consider deleted schema when checking compatibility (#4669)
    
    feca5bb changed topic delete logic to delete the schema when the
    topic is deleted (though this only seems to be enabled for idle topic
    GC). This exposed a bug in compatibility checking whereby if the a
    subscription tries to attach to the topic, even if using the same
    schema as had been used previously, a compatibility exception will be
    thrown.
    
    This is because the topic still appears to have a schema, even though
    there is no actual schema data, just a tombstone. I've changed the logic
    to return no schema if the schema read back is a tombstone.
    
    The issue doesn't affect producers because the check was already
    correct there.
    
    I've also updated the check for transitive compatibility to remove the
    prefix of schemas before the deleted schema. Previously this was
    throwing an NPE on the broker as it couldn't decode the deleted
    schema.
    
    This issue was discovered by failures in the healthcheck. The check
    period (5 minutes) was longer than the GC period (60 seconds). I would
    expect it to hit quite often in other scenarios also.

 .../service/schema/SchemaRegistryServiceImpl.java  | 42 +++++++---
 .../broker/service/schema/SchemaServiceTest.java   |  5 +-
 .../pulsar/client/impl/SchemaDeleteTest.java       | 97 ++++++++++++++++++++++
 3 files changed, 130 insertions(+), 14 deletions(-)

commit c15c867c176be64fb2074ee7d40612cf510b9b42
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 8 10:12:17 2019 -0700

    Fixed the default port for https and http in admin client (#4623)
    
    * Fixed the default port for https and http in admin client
    
    * Fixed test expectation
    
    * Removed space added by mistake

 .../src/main/java/org/apache/pulsar/common/net/ServiceURI.java        | 4 ++--
 .../src/test/java/org/apache/pulsar/common/net/ServiceURITest.java    | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit c421ca6e5b0c99f7728c8651ad9a81005bfd176e
Author: vzhikserg <vzhikserg@users.noreply.github.com>
Date:   Mon Jul 8 18:16:05 2019 +0200

    Cleanup tests in the presto module (#4683)
    
    * Add static import statements for Assert to simplify the test in the presto module
    
    * Use the preferred way of the schema's creation. The predicates and functions were converted to lambda

 .../pulsar/sql/presto/TestPulsarConnector.java     | 102 +++++++-----------
 .../pulsar/sql/presto/TestPulsarMetadata.java      | 108 +++++++++----------
 .../pulsar/sql/presto/TestPulsarRecordCursor.java  |  45 ++++----
 .../pulsar/sql/presto/TestPulsarSplitManager.java  | 115 ++++++++++-----------
 4 files changed, 169 insertions(+), 201 deletions(-)

commit 817549a03e724701373ebf4f6db38b58d77438e0
Author: vzhikserg <vzhikserg@users.noreply.github.com>
Date:   Mon Jul 8 17:08:56 2019 +0200

    Cleanup in the pulsar-log4j-appender project (#4681)

 .../org/apache/pulsar/log4j2/appender/PulsarManager.java  |  4 ++--
 .../apache/pulsar/log4j2/appender/PulsarAppenderTest.java | 15 +++++----------
 .../appender/builder/ConfigurationAssemblerTest.java      |  8 ++++----
 .../log4j2/appender/builder/ConfigurationBuilderTest.java |  2 +-
 .../appender/builder/CustomConfigurationFactory.java      |  2 --
 5 files changed, 12 insertions(+), 19 deletions(-)

commit 00ab609a3020dd8085a1c853a1ba3f1f008c010b
Author: tuteng <eguangning@gmail.com>
Date:   Mon Jul 8 12:11:16 2019 +0800

    Upgrade docusaurus to 1.11.1 (#4682)
    
    Fixes https://github.com/apache/pulsar/issues/4606
    
    Master Issue: https://github.com/apache/pulsar/issues/4606
    
    ### Motivation
    
    Refine the framework and implement language-specific code tabs
    
    ### Modifications
    
    Upgrade the docusaurus version to 1.11.1 for support code tab

 site2/website/package.json | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 218798fcec6261504a137f477086b0928e1afcf0
Author: Guillaume Rosauro <3407583+willome@users.noreply.github.com>
Date:   Mon Jul 8 06:10:17 2019 +0200

    Update Debezium version to 0.9.5.Final (#4673)
    
    Update Debezium version to 0.9.5.Final

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7d2141b92d28117bee05499caca4c7a27839d025
Author: tuteng <eguangning@gmail.com>
Date:   Mon Jul 8 00:04:11 2019 +0800

    [pulsar-io][jdbc sink]Support delete and update event for JDBC Sink (#4358)
    
    ### Motivation
    
    Currently our JDBC Sink not support deletion and update events.
    Support for delete and update events.
    
    ### Modifications
    
    Support for delete and update events.
    Add some document for JDBC Sink. https://github.com/apache/pulsar/issues/4073
    
    ### Verifying this change
    
    local Unit Test pass.
    Integration test pass

 .../apache/pulsar/io/jdbc/JdbcAbstractSink.java    |  75 +++++---
 .../apache/pulsar/io/jdbc/JdbcAutoSchemaSink.java  |  21 ++-
 .../org/apache/pulsar/io/jdbc/JdbcSinkConfig.java  |  14 +-
 .../java/org/apache/pulsar/io/jdbc/JdbcUtils.java  | 100 ++++++++++-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    | 191 ++++++++++++++++-----
 .../org/apache/pulsar/io/jdbc/JdbcUtilsTest.java   |  36 +++-
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-jdbc.md                              |  23 +++
 .../integration/functions/PulsarFunctionsTest.java | 119 +++++++++++--
 .../tests/integration/io/JdbcSinkTester.java       |  12 +-
 10 files changed, 495 insertions(+), 97 deletions(-)

commit 99d3c11ec551dccbf85fbb77e268e1a97f3a806c
Author: tuteng <eguangning@gmail.com>
Date:   Mon Jul 8 00:02:26 2019 +0800

    Support Pulsar schema for pulsar kafka client wrapper (#4534)
    
    Fixes https://github.com/apache/pulsar/issues/4228
    
    Master Issue: https://github.com/apache/pulsar/issues/4228
    
    ### Motivation
    
    Use Pulsar schema in pulsar kafka client.
    
    ### Modifications
    
    Support schema of pulsar for pulsar kafka client
    
    ### Verifying this change
    
    Add Unit test

 .../kafka/compat/examples/ConsumerAvroExample.java |  75 ++++++
 .../kafka/compat/examples/ProducerAvroExample.java |  68 +++++
 .../client/kafka/compat/examples/utils/Bar.java    |  30 +++
 .../client/kafka/compat/examples/utils/Foo.java    |  35 +++
 .../clients/consumer/PulsarKafkaConsumer.java      | 108 ++++----
 .../clients/producer/PulsarKafkaProducer.java      |  83 +++---
 .../compat/KafkaProducerInterceptorWrapper.java    |  51 ++--
 .../client/kafka/compat/PulsarKafkaSchema.java     |  77 ++++++
 .../clients/producer/PulsarKafkaProducerTest.java  |  91 ++++++-
 .../KafkaProducerInterceptorWrapperTest.java       |   8 +-
 tests/pulsar-kafka-compat-client-test/pom.xml      |   5 +
 .../integration/compat/kafka/KafkaApiTest.java     | 277 +++++++++++++++++++++
 12 files changed, 804 insertions(+), 104 deletions(-)

commit 1b64a6e1f2560c807731103ae56d39a5abc52be9
Author: lipenghui <penghui@apache.org>
Date:   Sat Jul 6 06:38:54 2019 +0800

    Add pulsar-io-influxdb to distribution. (#4678)

 distribution/io/src/assemble/io.xml | 1 +
 site2/website/data/connectors.js    | 6 ++++++
 2 files changed, 7 insertions(+)

commit da4e932352d12feaba33ec83f3fb68730a78297b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 4 22:30:22 2019 -0700

    Renamed C++ logger enum names to avoid conflicts with compiler macros (#4664)
    
    ### Motivation
    
    Fixes #4655
    
    Some compiler will have defined a macro for `DEBUG` and it will clash with the enum value name. Adding prefix to avoid the macro replacement.

 pulsar-client-cpp/include/pulsar/Logger.h        |  8 ++--
 pulsar-client-cpp/lib/LogUtils.h                 | 52 ++++++++++++------------
 pulsar-client-cpp/lib/MessageCrypto.cc           | 14 +++----
 pulsar-client-cpp/lib/SimpleLoggerImpl.cc        | 10 ++---
 pulsar-client-cpp/lib/c/c_ClientConfiguration.cc |  2 +-
 5 files changed, 43 insertions(+), 43 deletions(-)

commit 3a3bf1f6d5edea00b893085b422bb7837bdd634b
Author: lipenghui <penghui@apache.org>
Date:   Fri Jul 5 13:01:37 2019 +0800

    2.4.0 release notes
    
    Added release notes for 2.4.0 release

 site2/website/release-notes.md | 133 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 133 insertions(+)

commit 270af329cc31ef4f24243acd6c6983a6006d20ac
Author: Guillaume Rosauro <3407583+willome@users.noreply.github.com>
Date:   Fri Jul 5 07:00:35 2019 +0200

    [doc] [Issue #4661] fix broken links on 'Develop connectors' page (#4674)

 site2/docs/io-develop.md | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 0217fb0e1e0302dfa3a22582ee229d5bb72e40ea
Author: lipenghui <penghui@apache.org>
Date:   Fri Jul 5 12:52:10 2019 +0800

    Doc release 2.4.0 (#4666)
    
    ### Motivation
    
    Release 2.4.0 doc

 site2/website/releases.json                        |    1 +
 .../versioned_docs/version-2.4.0/adaptors-kafka.md |  263 ++
 .../version-2.4.0/admin-api-overview.md            |   93 +
 .../version-2.4.0/administration-zk-bk.md          |  330 +++
 .../version-2.4.0/client-libraries-go.md           |  473 ++++
 .../version-2.4.0/client-libraries-java.md         |  666 +++++
 .../version-2.4.0/concepts-messaging.md            |  394 +++
 .../version-2.4.0/concepts-tiered-storage.md       |   18 +
 .../version-2.4.0/cookbooks-compaction.md          |  132 +
 .../version-2.4.0/cookbooks-tiered-storage.md      |  235 ++
 .../version-2.4.0/deploy-bare-metal.md             |  446 ++++
 .../version-2.4.0/developing-binary-protocol.md    |  553 +++++
 .../versioned_docs/version-2.4.0/developing-cpp.md |  101 +
 .../versioned_docs/version-2.4.0/functions-api.md  |  721 ++++++
 .../version-2.4.0/functions-debugging.md           |  452 ++++
 .../version-2.4.0/functions-overview.md            |  513 ++++
 .../version-2.4.0/functions-quickstart.md          |  390 +++
 .../version-2.4.0/functions-runtime.md             |  139 ++
 .../version-2.4.0/functions-worker.md              |  242 ++
 .../version-2.4.0/getting-started-standalone.md    |  221 ++
 .../versioned_docs/version-2.4.0/io-cdc-canal.md   |  175 ++
 .../version-2.4.0/io-cdc-debezium.md               |  261 ++
 .../versioned_docs/version-2.4.0/io-managing.md    |  162 ++
 .../versioned_docs/version-2.4.0/io-quickstart.md  |  746 ++++++
 .../version-2.4.0/reference-cli-tools.md           |  699 ++++++
 .../version-2.4.0/reference-configuration.md       |  494 ++++
 .../version-2.4.0/reference-pulsar-admin.md        | 2552 ++++++++++++++++++++
 .../version-2.4.0/security-kerberos.md             |  325 +++
 .../version-2.4.0/security-tls-authentication.md   |  149 ++
 .../version-2.4.0/security-token-admin.md          |  159 ++
 .../version-2.4.0/sql-getting-started.md           |  143 ++
 .../versioned_sidebars/version-2.4.0-sidebars.json |  129 +
 site2/website/versions.json                        |    1 +
 33 files changed, 12378 insertions(+)

commit d6c06ffa909e1a179b28e5ac80d178efcbd7ba41
Author: vzhikserg <vzhikserg@users.noreply.github.com>
Date:   Thu Jul 4 17:07:34 2019 +0200

    [doc] Add code samples for Protobuf and Avro schemas in java documentation (#4670)
    
    * Add code samples for Protobuf and Avro schemas in java
    
    * Update the code snippets for JSON, Protobuf, and Avro schemas with the preferred form.

 site2/docs/client-libraries-java.md | 22 +++++++++++++++++++---
 1 file changed, 19 insertions(+), 3 deletions(-)

commit e8025d50c5d2cf0a632ad1573308b676d0607923
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jul 3 14:31:23 2019 -0700

    fix issue when submitting NAR via file url (#4577)
    
    * fix issue when submitting NAR via file url
    
    * fix unit tests
    
    * add more specific errors
    
    * fix test

 .../worker/PulsarFunctionLocalRunTest.java         |  21 ++-
 .../org/apache/pulsar/functions/LocalRunner.java   |   1 -
 .../pulsar/functions/utils/SinkConfigUtils.java    | 145 +++++++++++++--------
 .../pulsar/functions/utils/SourceConfigUtils.java  | 122 ++++++++++-------
 .../functions/worker/rest/api/FunctionsImpl.java   |   1 -
 .../functions/worker/rest/api/SinksImpl.java       |   1 -
 .../functions/worker/rest/api/SourcesImpl.java     |   1 -
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |  17 ++-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   5 +-
 9 files changed, 192 insertions(+), 122 deletions(-)

commit 2f6861579c0bfc370abd9ecf5409c683eaa96ee7
Author: Easyfan Zheng <zheng.easyfan@gmail.com>
Date:   Thu Jul 4 03:16:56 2019 +0800

    C++ client producer sendAsync() method will be blocked forever, if enough batched messages sent timeout. (#4569) (#4657)

 pulsar-client-cpp/lib/ProducerImpl.cc | 8 ++++++++
 1 file changed, 8 insertions(+)

commit b367206ef32e34ca666388d8f517328ad9f6b28b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 3 10:58:32 2019 -0700

    [pulsar-broker] avoid retrying deleting namespace when topic is already deleted/fenced (#4665)

 .../apache/pulsar/broker/service/persistent/PersistentTopic.java   | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 7afdf6b077ca41ce55dbfec683c5a263a361f6b3
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Thu Jul 4 01:58:15 2019 +0800

    A modified version (#4667)

 tiered-storage/file-system/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 977b1a8523598be8442f19cc1eb1b893f3e49e70
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Jul 3 10:46:29 2019 +0900

    Add perPartition parameter to partitioned-stats API (#4639)
    
    ### Motivation
    
    Currently, the partitioned-stats API response includes stats for each partition. However, if the number of partitions and clients is large, the size of the response will be very large. In such cases, it is useful to have a query parameter to get a response that does not include stats for each partition.
    
    ```sh
    $ curl -s http://localhost:8080/admin/persistent/sample/standalone/ns1/pt1/partitioned-stats | jq .
    
    {
      "msgRateIn": 0,
      "msgThroughputIn": 0,
      "msgRateOut": 0,
      "msgThroughputOut": 0,
      "averageMsgSize": 0,
      "storageSize": 0,
      "publishers": [],
      "subscriptions": {
        "sub1": {
          "msgRateOut": 0,
          "msgThroughputOut": 0,
          "msgRateRedeliver": 0,
          "msgBacklog": 0,
          "blockedSubscriptionOnUnackedMsgs": false,
          "msgDelayed": 0,
          "unackedMessages": 0,
          "msgRateExpired": 0,
          "consumers": [],
          "isReplicated": false
        }
      },
      "replication": {},
      "metadata": {
        "partitions": 2
      },
      "partitions": {
        "persistent://sample/standalone/ns1/pt1-partition-1": {
          "msgRateIn": 0,
          "msgThroughputIn": 0,
          "msgRateOut": 0,
          "msgThroughputOut": 0,
          "averageMsgSize": 0,
          "storageSize": 0,
          "publishers": [],
          "subscriptions": {
            "sub1": {
              "msgRateOut": 0,
              "msgThroughputOut": 0,
              "msgRateRedeliver": 0,
              "msgBacklog": 0,
              "blockedSubscriptionOnUnackedMsgs": false,
              "msgDelayed": 0,
              "unackedMessages": 0,
              "msgRateExpired": 0,
              "consumers": [],
              "isReplicated": false
            }
          },
          "replication": {},
          "deduplicationStatus": "Disabled"
        },
        "persistent://sample/standalone/ns1/pt1-partition-0": {
          "msgRateIn": 0,
          "msgThroughputIn": 0,
          "msgRateOut": 0,
          "msgThroughputOut": 0,
          "averageMsgSize": 0,
          "storageSize": 0,
          "publishers": [],
          "subscriptions": {
            "sub1": {
              "msgRateOut": 0,
              "msgThroughputOut": 0,
              "msgRateRedeliver": 0,
              "msgBacklog": 0,
              "blockedSubscriptionOnUnackedMsgs": false,
              "msgDelayed": 0,
              "unackedMessages": 0,
              "msgRateExpired": 0,
              "consumers": [],
              "isReplicated": false
            }
          },
          "replication": {},
          "deduplicationStatus": "Disabled"
        }
      }
    }
    ```
    
    ### Modifications
    
    Added query parameter named `perPartition` to the partitioned-stats API. The default value is true.

 .../apache/pulsar/broker/admin/impl/PersistentTopicsBase.java    | 9 ++++++---
 .../java/org/apache/pulsar/broker/admin/v1/PersistentTopics.java | 3 ++-
 .../java/org/apache/pulsar/broker/admin/v2/PersistentTopics.java | 4 +++-
 .../java/org/apache/pulsar/client/admin/internal/TopicsImpl.java | 1 +
 4 files changed, 12 insertions(+), 5 deletions(-)

commit b306552ff0756f0b555c125286cc4b8ed4b11c1e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 2 18:45:01 2019 -0700

    [pulsar-broker] fix NPE at managed-ledger when fetch reader internal-stats (#4615)
    
    ### Motivation
    
    Broker throws NPE when pulsar-admin tries to fetch stats-internal for topic with reader.
    
    ```
    Caused by: java.lang.NullPointerException
            at org.apache.bookkeeper.mledger.impl.ManagedCursorImpl.getProperties(ManagedCursorImpl.java:234) ~[classes/:?]
            at org.apache.pulsar.broker.service.persistent.PersistentTopic.lambda$getInternalStats$48(PersistentTopic.java:1461) ~[classes/:?]
            at java.lang.Iterable.forEach(Iterable.java:75) ~[?:1.8.0_92]
            at org.apache.pulsar.broker.service.persistent.PersistentTopic.getInternalStats(PersistentTopic.java:1446) ~[classes/:?]
            at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalGetInternalStats(PersistentTopicsBase.java:621) ~[classes/:?]
            at org.apache.pulsar.broker.admin.v2.PersistentTopics.getInternalStats(PersistentTopics.java:430) ~[classes/:?]
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_92]
    ```

 .../main/java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0e807f15c357476059383c80870abd9b8a59826c
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Wed Jul 3 09:41:05 2019 +0800

    File system offload (#4403)
    
    Fixes #3216
    Implementation of offload to HDFS
    
    ### Motivation
    Implementation of offload to HDFS
    
    ### Verifying this change
    Add the test for this

 conf/broker.conf                                   |   6 +
 conf/filesystem_offload_core_site.xml              |  48 +++
 .../offloaders/src/assemble/offloaders.xml         |   6 +
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |   4 +-
 pom.xml                                            |   3 +
 .../tests/integration/offload/TestBaseOffload.java | 298 +++++++++++++++++++
 .../integration/offload/TestFileSystemOffload.java |  57 ++++
 .../tests/integration/offload/TestS3Offload.java   | 288 ++----------------
 .../suites/PulsarTieredStorageTestSuite.java       |  21 +-
 tests/integration/src/test/resources/pulsar.xml    |   3 +-
 .../test/resources/tiered-file-system-suite.xml    |  28 ++
 .../test/resources/tiered-filesystem-storage.xml   |  28 ++
 ...iered-storage.xml => tiered-jcloud-storage.xml} |   4 +-
 ...e-suite.xml => tiered-storage-jcloud-suite.xml} |   2 +-
 tiered-storage/file-system/pom.xml                 |  95 ++++++
 .../filesystem/FileSystemConfigurationData.java    |  68 +++++
 .../FileSystemLedgerOffloaderFactory.java          |  40 +++
 .../impl/FileStoreBackedReadHandleImpl.java        | 239 +++++++++++++++
 .../impl/FileSystemManagedLedgerOffloader.java     | 331 +++++++++++++++++++++
 .../META-INF/services/pulsar-offloader.yaml        |  22 ++
 .../offload/filesystem/FileStoreTestBase.java      |  64 ++++
 .../impl/FileSystemManagedLedgerOffloaderTest.java | 157 ++++++++++
 tiered-storage/pom.xml                             |   1 +
 23 files changed, 1528 insertions(+), 285 deletions(-)

commit eea53b7b04f1883e0b4ff8d880731a8ee0c1c92d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 2 14:38:07 2019 -0700

    Fixed C++ client lookup over HTTP on standalone (#4625)

 pulsar-client-cpp/lib/HTTPLookupService.cc | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit d107f67662f2c7dcd0d4023095ec5bfc21eecfa4
Author: lipenghui <penghui@apache.org>
Date:   Wed Jul 3 02:46:50 2019 +0800

    Allows consumer retrieve the sequence id that the producer set. (#4645)
    
    * Allows consumer retrieve the sequence id that the producer set.
    
    * fix comments.

 .../pulsar/broker/service/BatchMessageTest.java    | 64 ++++++++++++++++++++++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  4 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 +++++++++++++++++++
 .../apache/pulsar/common/protocol/Commands.java    |  4 ++
 pulsar-common/src/main/proto/PulsarApi.proto       |  2 +
 5 files changed, 131 insertions(+)

commit fc9c376fd85b4a9c3963335d4377f5c49bbacc79
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 2 11:00:10 2019 -0700

    Fixed managed ledger admin tool to work with Python3 (#4624)

 bin/pulsar-managed-ledger-admin | 36 ++++++++++++++++++------------------
 1 file changed, 18 insertions(+), 18 deletions(-)

commit 20cf73932c91f773df5cd5dbeadd176216d60e4c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jul 2 10:58:32 2019 -0700

     Improve and add authorization to function download and upload (#4644)
    
    * Improve and add authorization to function download and upload
    
    * cleaning up
    
    * fix bug

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  25 ++++-
 .../apache/pulsar/broker/admin/v2/Functions.java   |   4 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  15 +++
 .../client/admin/internal/FunctionsImpl.java       |   9 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  17 ++-
 .../functions/runtime/KubernetesRuntime.java       |  23 +++-
 .../functions/worker/rest/api/ComponentImpl.java   | 122 +++++++++++++++++----
 .../functions/worker/rest/api/FunctionsImplV2.java |   6 +-
 .../worker/rest/api/v2/FunctionsApiV2Resource.java |   8 +-
 .../worker/rest/api/v3/FunctionsApiV3Resource.java |  22 +++-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |   8 +-
 11 files changed, 211 insertions(+), 48 deletions(-)

commit deb6492b579a062c3b6d8b0e611461d8c26f87d9
Author: Guillaume Rosauro <3407583+willome@users.noreply.github.com>
Date:   Tue Jul 2 17:51:39 2019 +0200

    Issue #4638 : Update Kafka connect-api to version 2.3.0 (#4650)
    
    * Issue #4638: Update Kafka connect-api to version 2.3.0
    
    * remove 'block.on.buffer.full' property (already removed from kafka)

 pom.xml                                            |  2 +-
 .../clients/consumer/PulsarKafkaConsumer.java      | 66 ++++++++++++++++++++++
 .../clients/producer/PulsarKafkaProducer.java      | 58 +++++++++++--------
 .../compat/KafkaProducerInterceptorWrapper.java    |  6 +-
 .../io/kafka/connect/KafkaConnectSource.java       |  5 +-
 .../kafka/connect/PulsarIOSourceTaskContext.java   | 11 +++-
 .../io/kafka/connect/KafkaConnectSourceTest.java   |  1 +
 site2/docs/adaptors-kafka.md                       |  1 -
 8 files changed, 119 insertions(+), 31 deletions(-)

commit bbaf2d9eadbf678fd22e1541cc583b2607499714
Author: lipenghui <penghui@apache.org>
Date:   Tue Jul 2 06:20:09 2019 +0800

    fix cause deadlock while use subscribeAsync demo in java client doc. (#4649)

 site2/docs/client-libraries-java.md | 18 ++++++++----------
 1 file changed, 8 insertions(+), 10 deletions(-)

commit cc022f1691d23eebecd9fdfc3a2437d26dbbc208
Author: rshermanTHG <48561471+rshermanTHG@users.noreply.github.com>
Date:   Sun Jun 30 12:59:29 2019 +0100

    Dashboard filter out old namespace data from home screen (#4597)
    
    ### Motivation
    
    Duplicate namespace information was being shown in the home page e.g. Number of namespaces in a tenant.
    
    ### Modifications
    
    On the home screen filter to include data only from namespaces with the current timestamp.

 dashboard/django/stats/views.py | 1 +
 1 file changed, 1 insertion(+)

commit f272df9211b2d8acf77284ed3e00f6a68b173358
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Jun 30 04:58:35 2019 -0700

    [pulsar-broker] fix deadlock on get-status rest-api call (#4616)
    
    ### Motivation
    
    due to some issue if broker fails to complete topic-loading then getting stats of that topic blocks web-thread.
    
    ```
    "pulsar-web-30-13" #242 prio=5 os_prio=0 tid=0x00002b0b3c001000 nid=0x2540 waiting on condition [0x00002b0aa7d0a000]
       java.lang.Thread.State: WAITING (parking)
            at sun.misc.Unsafe.park(Native Method)
            - parking to wait for  <0x000000072560a180> (a java.util.concurrent.CompletableFuture$Signaller)
            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
            at java.util.concurrent.CompletableFuture$Signaller.block(CompletableFuture.java:1693)
            at java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3323)
            at java.util.concurrent.CompletableFuture.waitingGet(CompletableFuture.java:1729)
            at java.util.concurrent.CompletableFuture.join(CompletableFuture.java:1934)
            at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.getTopicReference(PersistentTopicsBase.java:1253)
            at org.apache.pulsar.broker.admin.impl.PersistentTopicsBase.internalGetStats(PersistentTopicsBase.java:592)
            at org.apache.pulsar.broker.admin.v1.PersistentTopics.getStats(PersistentTopics.java:240)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
    ```

 .../pulsar/broker/admin/impl/PersistentTopicsBase.java       | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

commit c0a57d0eb618dce1d85590a9b360af0c08e4a94c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Jun 29 11:02:19 2019 -0700

    Add authorization to function worker REST endpoints (#4628)

 .../org/apache/pulsar/broker/admin/v2/Worker.java  |  8 +--
 .../functions/worker/rest/api/ComponentImpl.java   | 26 +++++-----
 .../functions/worker/rest/api/FunctionsImpl.java   |  6 +--
 .../functions/worker/rest/api/SinksImpl.java       |  6 +--
 .../functions/worker/rest/api/SourcesImpl.java     |  6 +--
 .../functions/worker/rest/api/WorkerImpl.java      | 60 ++++++++++++----------
 .../worker/rest/api/v2/WorkerApiV2Resource.java    |  8 +--
 7 files changed, 64 insertions(+), 56 deletions(-)

commit 7a24136cedf28559acf0e2b08eed594c4f3264eb
Author: Like <ke.like@outlook.com>
Date:   Sat Jun 29 23:19:03 2019 +0800

    Remove redundant parameter totalMessages (#4583)
    
    Remove redundant parameter ```totalMessages``` for publish method.

 .../main/java/org/apache/pulsar/client/cli/CmdProduce.java    | 11 ++++-------
 1 file changed, 4 insertions(+), 7 deletions(-)

commit 5de6e6ba9b566754f099fd1bd96809ed75ac1543
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Sat Jun 29 23:16:28 2019 +0800

    [Client] Consumer for a single partition of a PartitionedTopic should be set with correct partitionIndex (#4591)
    
    This PR fixes #4586 by getting `partitionIndex` from topic name.

 .../apache/pulsar/client/impl/RawReaderImpl.java   |  1 +
 .../api/PartitionedProducerConsumerTest.java       | 72 +++++++++++++++++++++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 18 +++---
 .../client/impl/MultiTopicsConsumerImpl.java       |  6 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  3 +-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  2 +-
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  |  8 +--
 .../pulsar/client/impl/ConsumerImplTest.java       |  2 +-
 8 files changed, 91 insertions(+), 21 deletions(-)

commit fd5d5c2f6d755086b3d3081925f2bf86b92db9c0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 28 17:06:50 2019 -0700

    [pulsar-broker] make replication mtls configuration dynamic (#4609)

 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java   | 3 +++
 1 file changed, 3 insertions(+)

commit 20d24996e44e52f864ae3461b7a52f6abb1f0498
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 28 11:51:37 2019 -0700

    [pulsar-broker] add Delete dynamic config api (#4614)

 .../pulsar/broker/admin/impl/BrokersBase.java      | 42 ++++++++++++++++++++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  8 +++++
 .../org/apache/pulsar/client/admin/Brokers.java    | 10 ++++++
 .../pulsar/client/admin/internal/BrokersImpl.java  |  9 +++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  3 ++
 .../org/apache/pulsar/admin/cli/CmdBrokers.java    | 12 +++++++
 6 files changed, 84 insertions(+)

commit ed7cdca549ffc56a2ed833181a69bd483cbf06c9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jun 28 11:49:46 2019 -0700

     Adding null check for function/source/sink configs (#4627)
    
    * Adding null check for function/source/sink configs
    
    * adding more checks
    
    * fix tests

 .../functions/worker/rest/api/ComponentImpl.java   |  8 ++---
 .../functions/worker/rest/api/FunctionsImpl.java   | 10 ++++--
 .../functions/worker/rest/api/SinksImpl.java       | 10 ++++--
 .../functions/worker/rest/api/SourcesImpl.java     | 10 ++++--
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 10 +++---
 .../rest/api/v3/FunctionApiV3ResourceTest.java     | 38 +++++++++++++++++++---
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  | 37 ++++++++++++++++++---
 .../rest/api/v3/SourceApiV3ResourceTest.java       | 37 ++++++++++++++++++---
 8 files changed, 130 insertions(+), 30 deletions(-)

commit ce8f60a3f786f66e8ca18acd48bb9db3245ec8bd
Author: rshermanTHG <48561471+rshermanTHG@users.noreply.github.com>
Date:   Fri Jun 28 19:29:18 2019 +0100

    Count distinct bundles (#4637)

 dashboard/django/stats/views.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 362be2a901dcc8f70f94970fe05decdead1b4457
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jun 28 10:22:09 2019 -0700

    fix get partitioned topics for non-persistent topics (#4613)

 .../apache/pulsar/broker/admin/AdminResource.java  |  2 +-
 .../pulsar/broker/admin/PersistentTopicsTest.java  | 41 +++++++++++++++++++++-
 2 files changed, 41 insertions(+), 2 deletions(-)

commit 5a10c4ace49feb7978e2c3f4cb45aa2be7408a67
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jun 28 10:21:44 2019 -0700

    add RuntimeUtils test (#4579)

 .../pulsar/functions/runtime/RuntimeUtilsTest.java | 46 ++++++++++++++++++++++
 1 file changed, 46 insertions(+)

commit 8bff6183477ab7ba28978acc6b253505d5cacc40
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 27 10:48:53 2019 -0700

    [pulsar-admin] update dynamic config with escape char (#4611)

 .../java/org/apache/pulsar/broker/ServiceConfiguration.java   |  1 +
 .../java/org/apache/pulsar/broker/admin/AdminApiTest.java     | 11 +++++++++++
 .../org/apache/pulsar/client/admin/internal/BrokersImpl.java  |  4 +++-
 3 files changed, 15 insertions(+), 1 deletion(-)

commit aeb4c3d61fa151f9c99cfa89a096cded080986fa
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Jun 28 01:47:32 2019 +0800

    Issue #4602: SchemaInfo properties are lost when registering schema using admin api (#4617)
    
    * Issue #4602: SchemaInfo properties are lost when registering schema using admin api
    
    *Motivation*
    
    The properties are not uploaded when using admin api.
    
    *Modifications*
    
    Add the missing `properties`
    
    *Verify this change*
    
    Add unit test to cover this change
    
    * Change protected method to public method

 .../pulsar/broker/admin/v2/SchemasResource.java    |   1 +
 .../pulsar/broker/admin/AdminApiSchemaTest.java    | 125 +++++++++++++++++++++
 2 files changed, 126 insertions(+)

commit 22f1d7d1bea3a0f8746694be824081ed06ef9912
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Thu Jun 27 10:40:41 2019 -0700

    Update logic for picking active consumer for failover subscription on non-partitioned topic. (#4604)
    
    Instead of sorting the consumers based on priority level and consumer name then pick a active consumer, which could cause subscription getting into a flaky state, where the "active" consumer joins and leaves, no consumer is actually elected as "active" and consuming the messages.
    Fix logic to always pick the first consumer in the consumer list without sorting consumers. So consumers will be picked as acive consumer based on the order of their subscription.

 .../AbstractDispatcherSingleActiveConsumer.java    | 55 ++++++++++--------
 .../service/persistent/PersistentSubscription.java |  5 +-
 .../PersistentDispatcherFailoverConsumerTest.java  | 65 ++++++++++++++++++++-
 .../broker/service/PersistentFailoverE2ETest.java  | 66 +---------------------
 4 files changed, 101 insertions(+), 90 deletions(-)

commit 9db3a786bb97e6743457226972bca06d16800a94
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Thu Jun 27 18:57:42 2019 +0800

    should not serialize batchBuilder (#4620)

 .../org/apache/pulsar/client/impl/conf/ProducerConfigurationData.java  | 1 +
 .../org/apache/pulsar/client/impl/conf/ConfigurationDataUtilsTest.java | 3 ++-
 2 files changed, 3 insertions(+), 1 deletion(-)

commit 93b7b9303f78c2f6e335e0c27d0ea7a01ac975da
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Jun 27 12:32:14 2019 +0800

    Update for admin part (#4605)

 site2/docs/functions-runtime.md | 15 +++++++--------
 site2/docs/functions-worker.md  |  3 ++-
 2 files changed, 9 insertions(+), 9 deletions(-)

commit e359005c14481fb6da9baf2018247051cbb74289
Author: lsroudi <lsroudi@gmail.com>
Date:   Wed Jun 26 17:14:42 2019 +0200

    install vbguest plugin (#4600)
    
    ### Motivation
    *This change solve the problem related to vagrant up.* as described bellow:
    
    
      ```
    mount -t vboxsf -o uid=1000,gid=1000 pulsar /pulsar
    The error output from the command was:
    mount: unknown filesystem type 'vboxsf
      ```
    ### Modifications
    i suggest to fix this issue by installing the vbguest, when i perform the solution as described i still had the same error, the install of vbguest solve the issue

 dev/README.md | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

commit a155daa9e3012bedc53daa7b086253c84e538c28
Author: lipenghui <penghui@apache.org>
Date:   Wed Jun 26 17:57:06 2019 +0800

    Exclude go module configs check in apache-rat. (#4603)
    
    Exclude go module configs check in apache-rat.

 distribution/server/src/assemble/src.xml | 1 +
 pom.xml                                  | 6 ++++++
 2 files changed, 7 insertions(+)

commit a1a3f3aff5f99f5aea2b1b6fd75ddd150506cfe3
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed Jun 26 17:55:35 2019 +0800

    [Doc] Add two methods (log topic & CLI) for debugging functions (#4587)

 site2/docs/functions-debugging.md | 327 +++++++++++++++++++++++++++++++++++++-
 1 file changed, 326 insertions(+), 1 deletion(-)

commit 553f0fde697239ee72798f09371d0f283df7f6e9
Author: lipenghui <penghui@apache.org>
Date:   Wed Jun 26 11:35:00 2019 +0800

    Reduce unnecessary track message calls. (#4595)

 .../pulsar/client/api/ConsumerRedeliveryTest.java  | 54 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 43 ++++++-----------
 .../client/impl/MultiTopicsConsumerImpl.java       |  2 +-
 3 files changed, 70 insertions(+), 29 deletions(-)

commit 946b9af3f04d52632e6988677639716d53d5b34f
Author: lipenghui <penghui@apache.org>
Date:   Wed Jun 26 09:29:21 2019 +0800

    Add missed pulsar-client-go and pulsar-function-go to src package. (#4596)

 distribution/server/src/assemble/src.xml | 2 ++
 1 file changed, 2 insertions(+)

commit 0cf0a09ec034dac60e300b4d0af8abfca8267689
Author: lipenghui <penghui@apache.org>
Date:   Wed Jun 26 03:37:45 2019 +0800

    [conf]minorCompactionInterval should be greater than gcWaitTime (#4592)
    
    * minorCompactionInterval should be greater than gcWaitTime
    
    * Add majorCompactionInterval check.

 conf/bookkeeper.conf | 2 ++
 1 file changed, 2 insertions(+)

commit ff03aad9833b3c70c94457d51d689307ca0d5075
Author:  <ranxiaolong716@gmail.com>
Date:   Tue Jun 25 20:53:10 2019 +0800

    make pulsar_consumer_configuration_set_schema_info public

 pulsar-client-cpp/include/pulsar/c/consumer_configuration.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 0d0226e65cdc6c1d70e8a7bbdfb40bd890e7473e
Author: Grant Wu <grantwwu@gmail.com>
Date:   Tue Jun 25 07:59:45 2019 -0400

    Remove extraneous } (#4588)

 site2/docs/developing-binary-protocol.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5fa6c3611bc65a744433c4b824bd997085337d98
Author: lipenghui <penghui@apache.org>
Date:   Tue Jun 25 19:59:01 2019 +0800

    Bumped version to 2.5.0-SNAPSHOT (#4581)

 buildtools/pom.xml                                            | 2 +-
 dashboard/pom.xml                                             | 2 +-
 distribution/io/pom.xml                                       | 2 +-
 distribution/offloaders/pom.xml                               | 2 +-
 distribution/pom.xml                                          | 2 +-
 distribution/server/pom.xml                                   | 2 +-
 docker/grafana/pom.xml                                        | 2 +-
 docker/pom.xml                                                | 2 +-
 docker/pulsar-all/pom.xml                                     | 2 +-
 docker/pulsar-standalone/pom.xml                              | 2 +-
 docker/pulsar/pom.xml                                         | 2 +-
 examples/flink/pom.xml                                        | 2 +-
 examples/pom.xml                                              | 2 +-
 examples/spark/pom.xml                                        | 2 +-
 jclouds-shaded/pom.xml                                        | 2 +-
 managed-ledger-shaded/pom.xml                                 | 2 +-
 managed-ledger/pom.xml                                        | 2 +-
 pom.xml                                                       | 2 +-
 protobuf-shaded/pom.xml                                       | 4 ++--
 pulsar-broker-auth-athenz/pom.xml                             | 2 +-
 pulsar-broker-auth-sasl/pom.xml                               | 2 +-
 pulsar-broker-common/pom.xml                                  | 2 +-
 pulsar-broker-shaded/pom.xml                                  | 2 +-
 pulsar-broker/pom.xml                                         | 2 +-
 pulsar-client-1x-base/pom.xml                                 | 2 +-
 pulsar-client-1x-base/pulsar-client-1x/pom.xml                | 2 +-
 pulsar-client-1x-base/pulsar-client-2x-shaded/pom.xml         | 2 +-
 pulsar-client-admin-shaded/pom.xml                            | 2 +-
 pulsar-client-admin/pom.xml                                   | 2 +-
 pulsar-client-all/pom.xml                                     | 2 +-
 pulsar-client-api/pom.xml                                     | 2 +-
 pulsar-client-auth-athenz/pom.xml                             | 2 +-
 pulsar-client-auth-sasl/pom.xml                               | 2 +-
 pulsar-client-kafka-compat/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml  | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml        | 2 +-
 pulsar-client-shaded/pom.xml                                  | 2 +-
 pulsar-client-tools-test/pom.xml                              | 2 +-
 pulsar-client-tools/pom.xml                                   | 2 +-
 pulsar-client/pom.xml                                         | 2 +-
 pulsar-common/pom.xml                                         | 2 +-
 pulsar-discovery-service/pom.xml                              | 2 +-
 pulsar-flink/pom.xml                                          | 2 +-
 pulsar-functions/api-java/pom.xml                             | 2 +-
 pulsar-functions/instance/pom.xml                             | 2 +-
 pulsar-functions/java-examples/pom.xml                        | 2 +-
 pulsar-functions/localrun-shaded/pom.xml                      | 2 +-
 pulsar-functions/localrun/pom.xml                             | 2 +-
 pulsar-functions/pom.xml                                      | 2 +-
 pulsar-functions/proto/pom.xml                                | 2 +-
 pulsar-functions/runtime-all/pom.xml                          | 2 +-
 pulsar-functions/runtime/pom.xml                              | 2 +-
 pulsar-functions/secrets/pom.xml                              | 2 +-
 pulsar-functions/utils/pom.xml                                | 2 +-
 pulsar-functions/worker/pom.xml                               | 2 +-
 pulsar-io/aerospike/pom.xml                                   | 2 +-
 pulsar-io/canal/pom.xml                                       | 2 +-
 pulsar-io/cassandra/pom.xml                                   | 2 +-
 pulsar-io/common/pom.xml                                      | 2 +-
 pulsar-io/core/pom.xml                                        | 2 +-
 pulsar-io/data-generator/pom.xml                              | 2 +-
 pulsar-io/debezium/core/pom.xml                               | 2 +-
 pulsar-io/debezium/mysql/pom.xml                              | 2 +-
 pulsar-io/debezium/pom.xml                                    | 2 +-
 pulsar-io/debezium/postgres/pom.xml                           | 2 +-
 pulsar-io/docs/pom.xml                                        | 2 +-
 pulsar-io/elastic-search/pom.xml                              | 2 +-
 pulsar-io/file/pom.xml                                        | 2 +-
 pulsar-io/flume/pom.xml                                       | 2 +-
 pulsar-io/hbase/pom.xml                                       | 2 +-
 pulsar-io/hdfs2/pom.xml                                       | 2 +-
 pulsar-io/hdfs3/pom.xml                                       | 2 +-
 pulsar-io/influxdb/pom.xml                                    | 2 +-
 pulsar-io/jdbc/pom.xml                                        | 2 +-
 pulsar-io/kafka-connect-adaptor/pom.xml                       | 2 +-
 pulsar-io/kafka/pom.xml                                       | 2 +-
 pulsar-io/kinesis/pom.xml                                     | 2 +-
 pulsar-io/mongo/pom.xml                                       | 2 +-
 pulsar-io/netty/pom.xml                                       | 2 +-
 pulsar-io/pom.xml                                             | 2 +-
 pulsar-io/rabbitmq/pom.xml                                    | 2 +-
 pulsar-io/redis/pom.xml                                       | 2 +-
 pulsar-io/solr/pom.xml                                        | 2 +-
 pulsar-io/twitter/pom.xml                                     | 2 +-
 pulsar-log4j2-appender/pom.xml                                | 2 +-
 pulsar-proxy/pom.xml                                          | 2 +-
 pulsar-spark/pom.xml                                          | 2 +-
 pulsar-sql/pom.xml                                            | 2 +-
 pulsar-sql/presto-distribution/pom.xml                        | 2 +-
 pulsar-sql/presto-pulsar-plugin/pom.xml                       | 2 +-
 pulsar-sql/presto-pulsar/pom.xml                              | 2 +-
 pulsar-storm/pom.xml                                          | 2 +-
 pulsar-testclient/pom.xml                                     | 2 +-
 pulsar-transaction/buffer/pom.xml                             | 2 +-
 pulsar-transaction/common/pom.xml                             | 2 +-
 pulsar-transaction/coordinator/pom.xml                        | 2 +-
 pulsar-transaction/pom.xml                                    | 2 +-
 pulsar-websocket/pom.xml                                      | 2 +-
 pulsar-zookeeper-utils/pom.xml                                | 2 +-
 pulsar-zookeeper/pom.xml                                      | 2 +-
 tests/bc_2_0_0/pom.xml                                        | 2 +-
 tests/bc_2_0_1/pom.xml                                        | 2 +-
 tests/docker-images/java-test-functions/pom.xml               | 2 +-
 tests/docker-images/latest-version-image/pom.xml              | 2 +-
 tests/docker-images/pom.xml                                   | 2 +-
 tests/integration/pom.xml                                     | 2 +-
 tests/pom.xml                                                 | 2 +-
 tests/pulsar-kafka-compat-client-test/pom.xml                 | 2 +-
 tests/pulsar-spark-test/pom.xml                               | 2 +-
 tests/pulsar-storm-test/pom.xml                               | 2 +-
 tiered-storage/jcloud/pom.xml                                 | 2 +-
 tiered-storage/pom.xml                                        | 2 +-
 113 files changed, 114 insertions(+), 114 deletions(-)

commit 7397b960d992321fc52f85739d180c7080c632b1
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Jun 25 09:35:54 2019 +0800

    [client] Provide a clock for generating publish timestamp for producers (#4562)
    
    *Motivation*
    
    Currently producers uses `System.currentTimeMillis()` as publish timestamp by default.
    However at some use cases, producers would like to a different way for generating publish timestamp.
    E.g. in a database use case, a producer might be use HLC (Hybrid Logic Clock) as publish timestamp;
    in integration tests, it might require the producer to use a deterministic way to generate publish timestamp.
    
    *Changes*
    
    This PR introduces a `clock` in building the client. This allows applications to override the system clock
    with its own implementation.
    
    *Verify the change*
    
    Add unit test to test customized clock in both batch and non-batch cases.

 .../client/api/SimpleProducerConsumerTest.java     | 140 +++++++++++++++++++++
 .../apache/pulsar/client/api/ClientBuilder.java    |  17 +++
 .../pulsar/client/impl/ClientBuilderImpl.java      |   7 ++
 .../apache/pulsar/client/impl/ProducerImpl.java    |   2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  17 ++-
 .../client/impl/conf/ClientConfigurationData.java  |   5 +-
 6 files changed, 183 insertions(+), 5 deletions(-)

commit eee5767caf1e5c2aa82e576dd880ce7b377fb737
Author: tuteng <eguangning@gmail.com>
Date:   Tue Jun 25 09:34:53 2019 +0800

    [docs]Improve document of non-persistent topic (#4538)
    
    ### Motivation
    
    Improve the documentation for Non-Persistent Topic
    
    ### Modifications
    
    * Improve error codes and error messages
    * Description Information of Improvement Parameters

 .../broker/admin/v2/NonPersistentTopics.java       | 129 +++++++++++++++++----
 1 file changed, 105 insertions(+), 24 deletions(-)

commit 156682a7609ba416552160ee5cbf5fe774ade1a7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 24 18:16:12 2019 -0700

    [managed-ledger] close bk-client factory gracefully (#4580)
    
    ### Motivation
    User can create tools on bookkeeper using ManagedLedger factory which provides [constructor](https://github.com/apache/pulsar/blob/master/managed-ledger/src/main/java/org/apache/bookkeeper/mledger/impl/ManagedLedgerFactoryImpl.java#L121) to create ml-factory using self-managed bookkeeper (it's not used by broker).
    So, in case of self-managed bk-client, ML-Factory couldn't shutdown it gracefully and we see issue: #4573
    
    ### Modification
    - ML-Factory creates `DefaultBkFactory` to create self-managed bk-client and shutdowns same bk-client while closing the resource.

 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 33 ++++++++++++++--------
 1 file changed, 21 insertions(+), 12 deletions(-)

commit 95df092832a3633a81fd719a5c096919141cc4f9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Jun 23 20:01:37 2019 -0700

    Refactoring Function Component implementation (#4541)
    
    * Refactoring Function Component implementation
    
    * cleaning up

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  15 +-
 .../apache/pulsar/broker/admin/impl/SinksBase.java |  21 +-
 .../pulsar/broker/admin/impl/SourcesBase.java      |  20 +-
 .../functions/worker/rest/api/ComponentImpl.java   | 485 +--------------------
 .../functions/worker/rest/api/FunctionsImpl.java   | 394 ++++++++++++++++-
 .../functions/worker/rest/api/FunctionsImplV2.java |  19 +-
 .../functions/worker/rest/api/SinksImpl.java       | 403 ++++++++++++++++-
 .../functions/worker/rest/api/SourcesImpl.java     | 401 ++++++++++++++++-
 .../worker/rest/api/v3/FunctionsApiV3Resource.java |   8 +-
 .../worker/rest/api/v3/SinksApiV3Resource.java     |  21 +-
 .../worker/rest/api/v3/SourcesApiV3Resource.java   |  21 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  14 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |  28 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |  24 +-
 14 files changed, 1290 insertions(+), 584 deletions(-)

commit d53d336b6739a6aff8296b34ffd98f113b559769
Author: lipenghui <penghui@apache.org>
Date:   Sat Jun 22 09:51:39 2019 +0800

    Fix apache-rat check.
    
    Fix license header check error by apache-rat.

 pom.xml                                             |  2 +-
 .../python/pkg/osx/osx-10.14/Vagrantfile            | 21 +++++++++++++++++++++
 pulsar-function-go/README.md                        |  0
 3 files changed, 22 insertions(+), 1 deletion(-)

commit a68801eda027aaeab05771022d21fe13216c2fe7
Author: FuqiaoWang <425256284@qq.com>
Date:   Sat Jun 22 07:47:26 2019 +0800

    Update AbstractWebSocketHandler.java (#4575)

 .../java/org/apache/pulsar/websocket/AbstractWebSocketHandler.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 14a4f6b209e890b3895001966e29c1e06c518604
Author: Jia Zhai <zhaijia@apache.org>
Date:   Sat Jun 22 01:52:52 2019 +0800

    duplicate dependency in pom (#4576)

 pulsar-common/pom.xml | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit 6c13f189423892b1c670e2a4791f16895ea23c4a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jun 20 19:46:17 2019 -0700

    [schema] Introduce schema data validator (#4360)
    
    *Motivation*
    
    Currently the schema data is only validated in compatibility checker. If the schema data is uploaded from admin api, there is no validation if the schema is the first version.
    
    *Changes*
    
    Add schema data validator to validate the schema data before storing it in schema storage.

 .../pulsar/broker/admin/v2/SchemasResource.java    |  88 ++++++-----
 .../broker/service/BrokerServiceException.java     |  22 ++-
 .../org/apache/pulsar/broker/service/Consumer.java |   2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   8 +-
 .../schema/KeyValueSchemaCompatibilityCheck.java   |   2 +-
 .../service/schema/SchemaRegistryService.java      |   4 +-
 .../service/schema/SchemaRegistryServiceImpl.java  |   1 +
 .../IncompatibleSchemaException.java               |  10 +-
 .../exceptions/InvalidSchemaDataException.java     |  35 +++++
 .../service/schema/exceptions/SchemaException.java |  37 +++++
 .../validator/PrimitiveSchemaDataValidator.java    |  45 ++++++
 .../schema/validator/SchemaDataValidator.java      |  87 +++++++++++
 ...hemaRegistryServiceWithSchemaDataValidator.java |  98 +++++++++++++
 .../validator/StringSchemaDataValidator.java       |  53 +++++++
 .../validator/StructSchemaDataValidator.java       |  77 ++++++++++
 .../schema/validator/SchemaDataValidatorTest.java  | 133 +++++++++++++++++
 ...RegistryServiceWithSchemaDataValidatorTest.java | 163 +++++++++++++++++++++
 .../api/SimpleTypedProducerConsumerTest.java       |  68 +++------
 .../org/apache/pulsar/client/admin/Schemas.java    |   9 ++
 .../pulsar/client/admin/internal/SchemasImpl.java  |  52 +++++--
 20 files changed, 874 insertions(+), 120 deletions(-)

commit e814a7ff8fbfc1fa55dfc8b82b9aed093e8bc1bb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jun 20 16:13:56 2019 -0700

    fix updating function/source/sink runtimeFlags and specifying mutiple flags (#4572)

 .../apache/pulsar/functions/runtime/RuntimeUtils.java    | 15 +++++++++++++--
 .../pulsar/functions/utils/FunctionConfigUtils.java      |  3 +++
 .../apache/pulsar/functions/utils/SinkConfigUtils.java   |  3 +++
 .../apache/pulsar/functions/utils/SourceConfigUtils.java |  3 +++
 .../pulsar/functions/utils/FunctionConfigUtilsTest.java  | 16 ++++++++++++++++
 .../pulsar/functions/utils/SinkConfigUtilsTest.java      | 15 +++++++++++++++
 .../pulsar/functions/utils/SourceConfigUtilsTest.java    | 15 +++++++++++++++
 7 files changed, 68 insertions(+), 2 deletions(-)

commit 201a61e40428bcc857e79ee585e25ec583afd080
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Jun 21 05:49:02 2019 +0800

    [docs] Add technical writing style for Pulsar docs to the site2/readme.md file (#4565)
    
    ### Motivation
    When writing Pulsar docs, we can adopt a consistent writing styles, whoever the author is.
    Here I introduce [Google Developer Documentation Style Guide](https://developers.google.com/style/) for Pulsar technical docs. The style guide generally conforms to with most popular technical writing styles, such as *IBM style guides*, *Microsoft style guide*, *The Chicago Manual of Style*, and so on.
    In addition, *Google Developer Documentation Style Guide* is open to all, and the link is easy to share among all participants.
    
    ### Modifications
    1. Restructure the content of the site2/reademe file: website, doc, and translation.
    2. Introduce *Google Developer Documentation Style Guide* in **Contribute to documentation**.

 site2/README.md | 79 +++++++++++++++++++++++++--------------------------------
 1 file changed, 34 insertions(+), 45 deletions(-)

commit 4dfcf11cd12af3e78cb1d7243f39d932f2c01e99
Author: willome <g.rosauro@gmail.com>
Date:   Thu Jun 20 23:47:27 2019 +0200

    add missing debezium-postgres connector in distribution (#4567)
    
    ### Motivation
    - debezium-postgres connector is missing in distribution (build)
    
    ### Modifications
    - assemby updated

 distribution/io/src/assemble/io.xml | 1 +
 1 file changed, 1 insertion(+)

commit aec968a117311fd2d09a956a0a957bf9c8f21741
Author: lipenghui <penghui@apache.org>
Date:   Fri Jun 21 05:38:54 2019 +0800

    Add subscription modes for java client doc. (#4533)
    
    ### Motivation
    
    Add document for java client to describe how to use each subscription modes and the difference between each subscription modes.
    
    ### Modifications
    
    Add subscription modes section for java client doc.
    
    ### Does this pull request potentially affect one of the following parts:
    
    *If `yes` was chosen, please highlight the changes*
    
      - Dependencies (does it add or upgrade a dependency): (no)
      - The public API: (no)
      - The schema: (no)
      - The default values of configurations: (no)
      - The wire protocol: (no)
      - The rest endpoints: (no)
      - The admin cli options: (no)
      - Anything that affects deployment: (no)
    
    ### Documentation
    
      - Does this pull request introduce a new feature? (no)

 site2/docs/client-libraries-java.md | 181 ++++++++++++++++++++++++++++++++++++
 1 file changed, 181 insertions(+)

commit 4c3cac854a2b60d700f6e1b59ee700b97c0c4b84
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Jun 20 23:33:08 2019 +0800

    Replace the functions worker's hard-coded brokerUrls. (#4566)

 .../src/main/java/org/apache/pulsar/PulsarBrokerStarter.java     | 9 ++++-----
 .../src/main/java/org/apache/pulsar/PulsarStandalone.java        | 9 ++++-----
 2 files changed, 8 insertions(+), 10 deletions(-)

commit 37476bb7cfd6245193a14f7d2d78feae33396616
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Jun 20 23:31:35 2019 +0800

    Remove redundant command usage when authentication exception. (#4568)

 .../src/main/java/org/apache/pulsar/client/cli/PulsarClientTool.java     | 1 -
 1 file changed, 1 deletion(-)

commit 22db5b64a5540b4d8f01f9e9bfffc1a084e46eb0
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Jun 20 23:30:53 2019 +0800

    [issue:4537] Fix doc error of producer options (#4571)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 site2/docs/client-libraries-go.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ebde4dcb5d15a95741cf9e2328e0b80781378293
Author: yuliangwan <ps_yqx@163.com>
Date:   Thu Jun 20 23:30:04 2019 +0800

    Correct errorthe number of {} is different to arguments count. (#4570)

 .../src/main/java/org/apache/pulsar/broker/web/PulsarWebResource.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e643c5e4968484b06f64e216cb110a733b1aa5db
Author: rshermanTHG <48561471+rshermanTHG@users.noreply.github.com>
Date:   Thu Jun 20 11:18:02 2019 +0100

    Update message backlog figures in the database when clearing/deleting subscriptions. Keeping the UI up to date pending the next collector run. (#4559)
    
    Motivation
    When a subscription's backlog is cleared or the subscription is deleted the UI doesn't reflect the change in the backlog until the next run of the collector. This change updates the database with the new backlog count at the subscription and topic level.
    
    Modifications
    If the deletion of a subscription has a 204 response reduce the topic's message backlog count by the amount on the subscription.
    If the clearing of a subscription has a 204 response reduce the topic's message backlog count by the amount on the subscription and reduce the subscriptions backlog count to 0.

 dashboard/django/stats/models.py |  2 +-
 dashboard/django/stats/views.py  | 32 +++++++++++++++++++++++++-------
 2 files changed, 26 insertions(+), 8 deletions(-)

commit 82d9e7160734f0e3b666085b00946e655d4eccf8
Author: Sijie Guo <sijie@apache.org>
Date:   Wed Jun 19 22:30:40 2019 -0700

    [schema] key/value schema enhancement (#4548)
    
    *Motivation*
    
    - The code for encoding and decoding key/value schema is spreading over multiple places.
    - Make code changes to prepare supporting key/value schema in AUTO consumers
    - Make schema tools display key/value schema in a pretty format
    
    *Modifications*
    
    - Move the common logic of encoding and decoding key/value schema to a common class KeyValueSchemaInfo
    - Expose the common class in DefaultImplementation so that it can be available for public usage
    - Fix the display problem on displaying key/value schema
    
    *Verify this change*
    
    - Add bunch of the unit tests for key/value schemas

 .../schema/KeyValueSchemaCompatibilityCheck.java   |  57 +----
 .../KeyValueSchemaCompatibilityCheckTest.java      |   8 -
 .../pulsar/client/api/schema/SchemaWriter.java     |   4 +
 .../client/internal/DefaultImplementation.java     |  91 ++++++-
 .../pulsar/client/internal/ReflectionUtils.java    |  10 +
 .../org/apache/pulsar/common/schema/KeyValue.java  |  85 +++++++
 .../apache/pulsar/common/schema/SchemaInfo.java    |  11 +
 .../org/apache/pulsar/admin/cli/CmdSchemas.java    |  24 +-
 .../pulsar/client/impl/schema/KeyValueSchema.java  | 102 ++------
 .../client/impl/schema/KeyValueSchemaInfo.java     | 221 ++++++++++++++++
 .../pulsar/client/impl/schema/SchemaUtils.java     | 157 ++++++++++++
 .../client/impl/schema/KeyValueSchemaInfoTest.java | 210 ++++++++++++++++
 .../pulsar/client/impl/schema/SchemaInfoTest.java  | 279 +++++++++++++++++++++
 .../apache/pulsar/common/schema/KeyValueTest.java  | 122 +++++++++
 .../pulsar/common/protocol/schema/SchemaData.java  |  30 +++
 .../pulsar/tests/integration/cli/CLITest.java      |   2 +-
 16 files changed, 1247 insertions(+), 166 deletions(-)

commit 4c38c9a9a6f1528613332f83804abb47d1d2dc2f
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Jun 20 04:51:12 2019 +0800

    [Docs] Update site2/docs/functions-overview.md (#4507)
    
    ### Motivation
    Improve doc on Pulsar Functions.
    
    ### Modifications
    1. Add an example of Pulsar Function for Go.
    2. Add Pulsar Functions SDK: Go.
    3. Add an example of Go function logging.
    4. Refine a section title from "Parallelism" as "Run instances in parallel"
    5. Refine some typos.
    
    ### Documentation
    
      - Does this pull request introduce a new feature? (yes )
      - If yes, how is the feature documented? ( docs)

 site2/docs/functions-overview.md | 218 +++++++++++++++++++++++++--------------
 1 file changed, 139 insertions(+), 79 deletions(-)

commit b45736ad0738116c9c3cae27ed18f1342b55139e
Author: lipenghui <penghui@apache.org>
Date:   Thu Jun 20 04:47:48 2019 +0800

    Introduce batch message container framework and support key based batching container (#4435)
    
    ### Motivation
    
    Introduce batch message container framework to support multiple ways to do message batch.
    Currently, pulsar support a most basic batch message container, use the batch message container framework can quickly implement other types batch message container, even users can customize their own batch message container.
    
    Add a new batch message container named BatchMessageKeyBasedContainer to support batching message in key_shared subscription mode.

 .../pulsar/broker/service/BatchMessageTest.java    | 163 ++++++++++++----
 .../client/api/KeySharedSubscriptionTest.java      | 167 ++++++----------
 .../pulsar/client/api/BatchMessageContainer.java   |  64 ++++++
 .../apache/pulsar/client/api/BatcherBuilder.java   |  56 ++++++
 .../apache/pulsar/client/api/ProducerBuilder.java  |  12 +-
 .../client/internal/DefaultImplementation.java     |  13 ++
 .../client/impl/AbstractBatchMessageContainer.java |  87 +++++++++
 .../client/impl/BatchMessageContainerBase.java     |  68 +++++++
 ...ntainer.java => BatchMessageContainerImpl.java} | 143 +++++++-------
 .../client/impl/BatchMessageKeyBasedContainer.java | 217 +++++++++++++++++++++
 .../pulsar/client/impl/DefaultBatcherBuilder.java  |  30 +++
 .../pulsar/client/impl/KeyBasedBatcherBuilder.java |  30 +++
 .../pulsar/client/impl/ProducerBuilderImpl.java    |   8 +
 .../apache/pulsar/client/impl/ProducerImpl.java    | 123 +++++-------
 .../impl/conf/ProducerConfigurationData.java       |   3 +-
 .../impl/conf/ConfigurationDataUtilsTest.java      |   1 +
 .../apache/pulsar/common/protocol/Commands.java    |   3 +
 .../java/org/apache/pulsar/storm/PulsarBolt.java   |   1 +
 18 files changed, 914 insertions(+), 275 deletions(-)

commit 34f1a58b3b9f4c60d837701cecb2fac67a04a634
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Jun 19 11:11:28 2019 +0800

    [Issue 4422] Support pulsar scripts to work with bookkeeper (#4555)
    
    Support pulsar scripts to work with bookkeeper

 bin/pulsar         | 2 ++
 conf/pulsar_env.sh | 5 +++++
 2 files changed, 7 insertions(+)

commit 2e9452363fd53ece33bddde43c5655bd63d09d8a
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Wed Jun 19 10:44:48 2019 +0800

    Introduce multi host in pulsar doc (#4546)
    
    Pulsar already have been supported multi host. Introduce them in Pulsar document.

 site2/docs/admin-api-overview.md    | 20 ++++++++++++++++++++
 site2/docs/client-libraries-java.md | 12 ++++++++++++
 site2/docs/deploy-bare-metal.md     |  2 ++
 3 files changed, 34 insertions(+)

commit d1545bda987e676c8b95aea86436146453573e72
Author: Daniel Andersson <d.andersson92@gmail.com>
Date:   Tue Jun 18 19:34:24 2019 +0200

    [Doc] Fixed a typo in Cookbook / Topic compaction (#4544)
    
    ## Motivation
    Improving the quality of the documentation.

 site2/docs/cookbooks-compaction.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 628bdd73eb32bf8579a969625319eb328f4a8459
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Tue Jun 18 22:47:37 2019 +0800

    [hotfix][minor]Remove tenant/namespace/name from sources and functions REST endpoints (#4553)
    
    `Tenant`, `namespace` and `sourceName` already appear in `PathParam` and shouldn't be a part of `sourceConfigJson`.

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 38 ++++++++--------------
 .../pulsar/broker/admin/impl/SourcesBase.java      | 12 -------
 2 files changed, 14 insertions(+), 36 deletions(-)

commit 5f5b6096f83bdae37427c6483bfd7cd6cc58a5cd
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Jun 18 07:22:42 2019 -0700

    [tests] Scope the dependencies for spark and storm tests to test scope (#4556)
    
    *Motivation*
    
    In gitsha b7a5677324a79708fd288fee6e8852f16a08ab6c , it introduced a provided dependency for pulsar-storm-test, which it will fail release process. Since it will attempt to transfer the pom file for  `com.twitter:carbonite:pom:1.5.0` which is a dependency comes from storm-server.
    
    *Changes*
    
    Make all the dependencies scoped at test scope for two test modules. So maven release will not attempt to release them.

 tests/pulsar-spark-test/pom.xml | 18 +++++++++++-------
 tests/pulsar-storm-test/pom.xml |  8 +++++++-
 2 files changed, 18 insertions(+), 8 deletions(-)

commit 4c352f0371445a1e696f7a096357675f701d6cba
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Jun 18 02:36:44 2019 -0700

    [pulsar-kafka] Fix KafkaProducerInterceptorWrapper handles LongSerializer (#4549)
    
    *Motivation*
    
    KafkaProducerInterceptorWrapper uses a LongDeserializer for retrieve deserializer
    
    *Modifications*
    
    Fix the bug
    
    *Verify this change*
    
    Add unit test to cover the convertion

 .../compat/KafkaProducerInterceptorWrapper.java    |  5 +-
 .../KafkaProducerInterceptorWrapperTest.java       | 66 +++++++++++++++++++---
 2 files changed, 60 insertions(+), 11 deletions(-)

commit 571b68464e25e8e71d3d278f58ba3a3df0c67a5b
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 18 01:55:43 2019 -0700

    Do not strip ExecutionException from the stack trace (#4493)
    
    * Do not strip ExecutionException from the stack trace

 .../pulsar/client/api/PulsarClientException.java   | 85 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerBase.java    | 48 ++----------
 .../pulsar/client/impl/ConsumerBuilderImpl.java    | 13 +---
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 19 ++---
 .../client/impl/MultiTopicsConsumerImpl.java       | 22 ++----
 .../apache/pulsar/client/impl/ProducerBase.java    | 37 ++--------
 .../pulsar/client/impl/ProducerBuilderImpl.java    | 13 +---
 .../pulsar/client/impl/PulsarClientImpl.java       | 15 +---
 .../pulsar/client/impl/ReaderBuilderImpl.java      | 13 +---
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  |  5 +-
 .../client/impl/auth/AuthenticationBasic.java      |  2 +-
 .../pulsar/functions/instance/ContextImpl.java     | 12 +--
 12 files changed, 130 insertions(+), 154 deletions(-)

commit 2f53fb6f9350643e47f5abeb433d7fea72d0832b
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue Jun 18 15:47:29 2019 +0800

    [docs] Update site2/docs/functions-quickstart.md (#4529)
    
    ### Motivation
    While add "Write and run a Go function" section, improve doc on Pulsar Functions: quick start throughout.
    
    ### Modifications
    
    1. Add a section of "Write and run a Go function".
    2. Update the the first-person pronoun as the second-person pronoun.
    3. Correct the usage of "Pulsar Functions" and "a Pulsar function". For the usage discussion, see #4507 .
    4. Change the future tense into present tense.
    5. Refine part of structure (heading level).
    6. Refine sentences to be more clear and concise.
    7. Refine some typos.
    
    ### Documentation
    
      - Does this pull request introduce a new feature? (yes)
      - If yes, how is the feature documented? ( docs)

 site2/docs/functions-quickstart.md | 181 ++++++++++++++++++++++++-------------
 1 file changed, 117 insertions(+), 64 deletions(-)

commit f349ef392ea825e68310a1cadc8b9297bb887b59
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Jun 18 15:05:31 2019 +0800

    Fix build error of pulsar c++ client. (#4552)

 site2/docs/developing-cpp.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e9425c52784e9def4b74c8b0fac6c52751f7f28b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 17 18:26:01 2019 -0700

    [pulsar-broker] Make non-tls web/broker-service optional (#3501)

 .../apache/pulsar/broker/ServiceConfiguration.java |  1 +
 .../PulsarConfigurationLoaderTest.java             |  4 +-
 .../broker/MessagingServiceShutdownHook.java       |  4 +-
 .../org/apache/pulsar/broker/PulsarService.java    | 30 ++++++++++++--
 .../apache/pulsar/broker/admin/AdminResource.java  |  2 +-
 .../broker/loadbalance/LeaderElectionService.java  |  8 ++--
 .../broker/loadbalance/ModularLoadManager.java     |  8 ++++
 .../pulsar/broker/loadbalance/NoopLoadManager.java |  4 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 23 ++++++++---
 .../impl/ModularLoadManagerWrapper.java            | 12 +++++-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 46 +++++++++++++---------
 .../pulsar/broker/namespace/NamespaceService.java  | 10 ++---
 .../pulsar/broker/namespace/OwnershipCache.java    |  6 +--
 .../pulsar/broker/web/PulsarWebResource.java       |  2 +-
 .../org/apache/pulsar/broker/web/WebService.java   |  2 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java | 18 ++++-----
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |  2 +-
 .../AntiAffinityNamespaceGroupTest.java            |  2 +-
 .../broker/namespace/NamespaceServiceTest.java     |  4 +-
 .../broker/namespace/OwnershipCacheTest.java       |  4 +-
 .../broker/service/AdvertisedAddressTest.java      |  8 ++--
 .../pulsar/broker/service/PeerReplicatorTest.java  |  2 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  | 12 +++---
 .../apache/pulsar/broker/web/WebServiceTest.java   |  2 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java | 10 ++---
 .../pulsar/client/api/NonPersistentTopicTest.java  | 12 +++---
 .../pulsar/client/api/ServiceUrlProviderTest.java  | 24 +++++------
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  2 +-
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    |  2 +-
 29 files changed, 163 insertions(+), 103 deletions(-)

commit e66ba275df7a608a7cd61c91248dd543b1e1edbb
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Mon Jun 17 12:40:33 2019 -0700

    [transaction][acknowledge] Introduce in-memory PENDING_ACK state in acknowledgement path (#4265)
    
    Master Issue: #2664
    
    Motivation:
    Add acknowledgeMessage, commit, abort for transaction in PersistentSubscription.
    
    Changes:
    Will put message in Pending_ACK status when acknowledgeMessage is called with TxnID.
    No real status class introduced, only added collection to hold messages in Pending_ACK status.
    Current PR only keep Pending_ACK state in memory, in subsequent PR will also persistent these pending acks so we can recover from broker failure.
    
    Add commitTxn to put message to Deleted status.
    Add abortTxn to put message to Pending status.
    
    For normal acknowledgeMessage and redeliverUnacknowledgedMessages, will check to see if
    message if message is in Pending_ACK first. If true, will **ignore** those acks/redeliverys.
    
    Add unit test.

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   6 +
 pulsar-broker/pom.xml                              |   6 +
 .../service/persistent/PersistentSubscription.java | 338 ++++++++++++++++++++-
 .../broker/service/PersistentTopicE2ETest.java     |  27 +-
 .../persistent/PersistentSubscriptionTest.java     | 284 +++++++++++++++++
 pulsar-transaction/common/pom.xml                  |   2 +-
 .../exception/TransactionConflictException.java    |  32 ++
 .../transaction/common/exception/package-info.java |  22 ++
 .../pulsar/transaction/impl/common/TxnID.java      |   4 +
 pulsar-transaction/pom.xml                         |   2 +-
 10 files changed, 706 insertions(+), 17 deletions(-)

commit 9eb7cc63771486902fc84356f22357422a8ac04d
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Jun 17 12:38:18 2019 -0700

    [schema] record charset in properties for string schema (#4542)
    
    ### Motivation
    
    Make sure we record charset in the properties. So that we know which charset to be used for encoding and decoding strings.
    
    ### Modifications
    
    Add charset to the properties

 .../pulsar/client/impl/schema/StringSchema.java    |  34 +++++-
 .../client/impl/schema/StringSchemaTest.java       | 122 +++++++++++++++++++++
 2 files changed, 152 insertions(+), 4 deletions(-)

commit d2546f0c38e378ddf668a27330d7f9c5412a04b7
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Tue Jun 18 03:35:02 2019 +0800

    [REST API Doc]Sink API refinement (#4520)
    
    * revisit documentation for pulsar admin api
    
    * format
    
    * update json body
    
    * sinkConfig as doc base

 .../apache/pulsar/broker/admin/impl/SinksBase.java | 294 ++++++++++++++++-----
 pulsar-common/pom.xml                              |   5 +
 .../pulsar/common/functions/UpdateOptions.java     |   6 +
 3 files changed, 246 insertions(+), 59 deletions(-)

commit 4f2bac0767819937d83833780fe7cb309b7d2a08
Author:  <ranxiaolong716@gmail.com>
Date:   Mon Jun 17 19:03:11 2019 +0800

    [improve doc] Update source rest api doc (#4521)
    
    * [improve doc] Update source rest api doc
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../pulsar/broker/admin/impl/SourcesBase.java      | 346 ++++++++++++++++-----
 1 file changed, 264 insertions(+), 82 deletions(-)

commit 7be1ee1fdb59421ac858b38840d3baf8c9073a5c
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jun 16 17:09:08 2019 -0700

    Replicated subscriptions - Advance remote cursor when local consumers moves ahead (#4396)
    
    ### Motivation
    
    This is the 4th and last (implementation) change for pip-33.
    
    It includes reading and caching the last N snapshots and sending the updates to the other clusters.
    
    Previous PRs:
     1. #4299
     2. #4340
     3. #4354

 conf/broker.conf                                   |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   7 +-
 .../broker/service/AbstractBaseDispatcher.java     |  27 ++++-
 .../apache/pulsar/broker/service/Subscription.java |   5 +
 .../service/persistent/PersistentSubscription.java |  40 ++++++--
 .../broker/service/persistent/PersistentTopic.java |   4 +
 .../ReplicatedSubscriptionSnapshotCache.java       |  92 +++++++++++++++++
 .../ReplicatedSubscriptionsController.java         |  63 +++++++++++-
 .../ReplicatedSubscriptionSnapshotCacheTest.java   | 114 +++++++++++++++++++++
 .../org/apache/pulsar/common/protocol/Markers.java |   8 +-
 10 files changed, 350 insertions(+), 13 deletions(-)

commit 1c51adc7114ab7aaf1c54e6e022920ed59f56cfa
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Sat Jun 15 00:26:59 2019 -0300

    Feature - reset cursor on Reader to current position (#4331)
    
    * Feature - reset cursor on Reader to current position
    
    *Motivation*
    
    There are some cases in which is it useful to be able to include current
    position of message when reset of cursor was made.
    
    This was reported by a `vvy` on slack, no issue has been created to track this.
    
    *Modifications*
    
      - Add startMessageIdInclusive() to support include current position of
        reset on ReaderBuilder.
      - Add resetIncludeHead field for Reader and Consumer Configuration Data
      - Fix position of cursor for non durable consumer.
      - Improve discard if statement for batch enable mode.
      - Add discard if statement for batch disable mode.
      - Improve test case for latest Reader seek.
      - Add test case to assert the start of specific message id at the expected
        position with data provider scenarios:
          A. Batch enable and start inclusive enable.
          B. Batch enable and start inclusive disable.
          C. Batch disable and start inclusive enable.
          D. Batch disable and start inclusive disable.

 .../broker/service/persistent/PersistentTopic.java |   9 +-
 .../apache/pulsar/client/api/TopicReaderTest.java  | 126 +++++++++++++++++----
 .../apache/pulsar/client/api/ReaderBuilder.java    |  14 +++
 pulsar-client-cpp/python/pulsar_test.py            |  13 ++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  45 ++++++--
 .../pulsar/client/impl/ReaderBuilderImpl.java      |   6 +
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   5 +
 .../impl/conf/ConsumerConfigurationData.java       |   2 +
 .../client/impl/conf/ReaderConfigurationData.java  |   1 +
 9 files changed, 181 insertions(+), 40 deletions(-)

commit 288b0e3bbe0742484a1d28d9d989cfb1045c65bf
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jun 14 20:00:25 2019 -0500

    add docs on how to debug Pulsar Functions (#4485)
    
    * add docs on how to debug Pulsar Functions
    
    * adding to sidebar
    
    * Apply suggestions from code review
    
    Co-Authored-By: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
    
    * addressing comments and rewording
    
    * adding comma
    
    * addressing comments
    
    * fixing minor issue

 site2/docs/functions-debugging.md | 126 ++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json       |   3 +-
 2 files changed, 128 insertions(+), 1 deletion(-)

commit f90fab280c931d457877de87c12b7d59074f6f6c
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Sat Jun 15 08:12:10 2019 +0800

    Make GenericAvroRecord public (#4532)

 .../apache/pulsar/client/impl/schema/generic/GenericAvroRecord.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit d2d432ce3833445fc71b4c0fca55b71663de38e8
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sat Jun 15 08:05:09 2019 +0800

    [Doc] Fix schema layout (#4531)

 site2/docs/io-quickstart.md | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit f452e6f817b5a613ded49a20ab2549fd5e34718c
Author: hello zepp <jingtianyy@qq.com>
Date:   Sat Jun 15 08:03:53 2019 +0800

    NPE in UnAckedMessageTrackerDisabled#size (#4535) (#4536)

 .../PerMessageUnAcknowledgedRedeliveryTest.java    | 43 ++++++++++++++++++++++
 .../pulsar/client/impl/UnAckedMessageTracker.java  |  5 +++
 2 files changed, 48 insertions(+)

commit 0fd988d32f64ba7a8fde5f74ba18056af35d302c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 14 17:03:07 2019 -0700

    [pulsar-broker] disable publish timeout by default (#4434)
    
    * [pulsar-broker] disable publish timeout by default
    
    * fix scheduling

 conf/broker.conf                                                      | 4 ++--
 conf/standalone.conf                                                  | 4 ++--
 .../java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java    | 3 +++
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java  | 4 ++--
 4 files changed, 9 insertions(+), 6 deletions(-)

commit d72b986d311d8b528619f4a4dcddf757b3975dde
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 14 10:44:51 2019 -0700

    [pulsar-ml] handle race condition between timeout-task and add-call complete (#4455)
    
    * [pulsar-ml] handle race condition between timeout-task and add-call complete
    
    * rename variable with simple name

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  8 ++--
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java | 54 +++++++++++-----------
 2 files changed, 32 insertions(+), 30 deletions(-)

commit 2285f0d65de293a41cb964b8045871e4a530b529
Author: lipenghui <codelipenghui@gmail.com>
Date:   Sat Jun 15 01:36:17 2019 +0800

    Fix NPE of ProducerInterceptors (#4517)
    
    * Fix ProducerInterceptors NPE issue.
    
    * Add UT test for ProducerInterceptors while interceptor cause exceptions.

 .../apache/pulsar/client/api/InterceptorsTest.java | 28 ++++++++++++++++++++++
 .../pulsar/client/impl/ProducerInterceptors.java   |  4 ++--
 2 files changed, 30 insertions(+), 2 deletions(-)

commit 04e5fee6e5490ba40c102edfa0377f76993f3ca3
Author: Addison Higham <addisonj@gmail.com>
Date:   Fri Jun 14 09:45:55 2019 -0600

    [pulsar-broker] Add support for other algorithms in token auth (#4528)
    
    Before this patch, all keys are read as RSA, which meant that only RSA
    compatible JWT signing algorithms could be used, specifically, this
    limited the use of ECDSA family of JWT keys.
    
    This changes this by changing the signature we use to parse keys to also
    take a SignatureAlgorithm and also adds a new config option
    `tokenPublicAlg` which can be used to signify what algorithm the
    broker/proxy should use when reading public keys. However, these all
    default to RS256, which, should indicate to decode as RSA (even if
    another RS/PS algoritm is used).
    
    This also adds some new options to the Token CLI tool for those commands
    that weren't respecting the algorithm, but these are defaulted to RS256
    as well.

 .../AuthenticationProviderToken.java               | 26 +++++++++-
 .../authentication/utils/AuthTokenUtils.java       | 20 ++++++--
 .../AuthenticationProviderTokenTest.java           | 60 ++++++++++++++++++++--
 .../pulsar/utils/auth/tokens/TokensCliUtils.java   | 11 +++-
 site2/docs/reference-configuration.md              |  2 +
 site2/docs/security-token-admin.md                 |  6 +--
 6 files changed, 110 insertions(+), 15 deletions(-)

commit 6636c7927b7601dae78bc6253d423bbcb7128f7d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 14 03:50:38 2019 -0700

    [pulsar-broker] add cli/admin api to delete bookie-affinity group (#4471)
    
    ### Motivation
    
    This PR is on top of #4458. It adds support to delete bookie-affinity group using cli/admin api.

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  4 ++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  | 14 +++-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  | 16 ++++-
 .../broker/service/BrokerBookieIsolationTest.java  | 81 +++++++++++++++++++++-
 .../org/apache/pulsar/client/admin/Namespaces.java |  7 ++
 .../client/admin/internal/NamespacesImpl.java      | 11 +++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  3 +
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 15 +++-
 8 files changed, 146 insertions(+), 5 deletions(-)

commit 26e69ee0b56003fa215421050d1a2ce72aca65c6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 14 03:44:41 2019 -0700

    [pulsar-client] fix pulsar-client-shade fails with async-http client request (#4513)
    
    ### Motivation
    
    Right now, pulsar-client-shaded artifact is broken for http-lookup because with recent async-http-client version: https://github.com/AsyncHttpClient/async-http-client/issues/1546
    > custom ahc.properties must be in org.asynchttpclient.config package, not at classpath root.
    
    
    Now, pulsar-client-shaded doesn't have `ahc.properties` into `org.asynchttpclient.config` and because of that async-http-client init fails with below exception
    ```
    Exception in thread "main" java.lang.NumberFormatException: null
      at java.lang.Integer.parseInt(Integer.java:542)
      at java.lang.Integer.parseInt(Integer.java:615)
      at org.apache.pulsar.shade.org.asynchttpclient.config.AsyncHttpClientConfigHelper$Config.getInt(AsyncHttpClientConfigHelper.java:85)
      at org.apache.pulsar.shade.org.asynchttpclient.config.AsyncHttpClientConfigDefaults.defaultMaxRedirects(AsyncHttpClientConfigDefaults.java:68)
      at org.apache.pulsar.shade.org.asynchttpclient.DefaultAsyncHttpClientConfig$Builder.<init>(DefaultAsyncHttpClientConfig.java:599)
      at org.apache.pulsar.client.impl.HttpClient.<init>(HttpClient.java:75)
      at org.apache.pulsar.client.impl.HttpClient.<init>(HttpClient.java:60)
      at org.apache.pulsar.client.impl.HttpLookupService.<init>(HttpLookupService.java:47)
      at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:97)
      at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:110)
      at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:84)
      at org.apache.pulsar.client.api.PulsarClient.create(PulsarClient.java:58)
      at org.apache.pulsar.client.api.PulsarClient.create(PulsarClient.java:43)
      at client_java.client_java.PulsarV2Example2.publishAndSubscribeOnCMSV2(PulsarV2Example2.java:31)
      at client_java.client_java.PulsarV2Example2.main(PulsarV2Example2.java:24)
    ```

 pulsar-client-shaded/pom.xml | 9 +++++++++
 1 file changed, 9 insertions(+)

commit e19e5ba2f059383c7ac2b4ffca75e251b94f5b1e
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Jun 14 09:28:47 2019 +0800

    [Issue 4480] Support setting zk chroot path when initialize cluster metadata (#4502)
    
    Fixes #4480
    Modifications
    Create the zookeeper chroot path at first if it doesn't exist.
    
    * Support setting zk chroot path when initialize cluster metadata.
    
    * Add a unit test for initZk

 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 36 +++++++++++++++++-----
 .../zookeeper/ZooKeeperClientAspectJTest.java      | 26 ++++++++++++++++
 2 files changed, 54 insertions(+), 8 deletions(-)

commit d99e95c2a65ecb43df06bd742ecf0ff5e05d3afe
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Jun 14 09:21:29 2019 +0800

    Disable sticky read by default (#4526)
    
    *Motivation*
    
    2.3.x releases turn on StickyRead by default.
    But StickyRead causes a lot of ArrayIndexOutOfBoundException.
    
    See: apache/bookkeeper#1970 and apache/pulsar#3715
    
    *Modifications*
    
    Disable sticy read by default until the bug is fixed and a new bookkeeper version is released.

 conf/broker.conf | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 2fb8cfe13130b87cb011c1e37ac5b8dfd5605acb
Author: lan <liangyuanpengem@163.com>
Date:   Fri Jun 14 08:10:54 2019 +0800

    optimizer ssl hint for cpp (#4505)
    
    * optimizer ssl hint for cpp
    
    * format cpp code

 pulsar-client-cpp/lib/ClientConnection.cc | 3 +++
 1 file changed, 3 insertions(+)

commit f33be02aef139af5e03ebe955288d9e445575935
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Jun 14 08:10:27 2019 +0800

     Expose `Replicated From` info in Message (#4524)
    
    * expose replicated info in message
    
    * add negative test case

 .../java/org/apache/pulsar/client/api/Message.java | 17 +++++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  2 +
 .../pulsar/client/impl/TopicMessageImpl.java       | 10 +++
 .../org/apache/pulsar/client/impl/MessageTest.java | 83 ++++++++++++++++++++++
 4 files changed, 112 insertions(+)

commit 46a068be5de3f062b2344a393846a761e4777f1a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 13 02:17:50 2019 -0700

    [pulsar-admin] add read-timeout to blocked admin-request (#4484)
    
    * [pulsar-admin] add read-timeout to blocked admin-request
    
    * fix: pass readTimeout from broker + consistent naming

 .../org/apache/pulsar/broker/PulsarService.java    |  6 ++-
 .../apache/pulsar/client/admin/PulsarAdmin.java    | 33 +++++++-------
 .../pulsar/client/admin/PulsarAdminException.java  |  5 +++
 .../pulsar/client/admin/internal/BaseResource.java |  4 +-
 .../pulsar/client/admin/internal/BookiesImpl.java  |  4 +-
 .../client/admin/internal/BrokerStatsImpl.java     |  4 +-
 .../pulsar/client/admin/internal/BrokersImpl.java  |  4 +-
 .../pulsar/client/admin/internal/ClustersImpl.java |  4 +-
 .../client/admin/internal/ComponentResource.java   |  4 +-
 .../client/admin/internal/FunctionsImpl.java       |  4 +-
 .../pulsar/client/admin/internal/LookupImpl.java   |  4 +-
 .../client/admin/internal/NamespacesImpl.java      |  4 +-
 .../admin/internal/NonPersistentTopicsImpl.java    |  4 +-
 .../client/admin/internal/ResourceQuotasImpl.java  |  4 +-
 .../pulsar/client/admin/internal/SchemasImpl.java  |  4 +-
 .../pulsar/client/admin/internal/SinksImpl.java    |  4 +-
 .../pulsar/client/admin/internal/SourcesImpl.java  |  4 +-
 .../pulsar/client/admin/internal/TenantsImpl.java  |  4 +-
 .../pulsar/client/admin/internal/TopicsImpl.java   | 50 ++++++++++++++++------
 .../pulsar/client/admin/internal/WorkerImpl.java   |  4 +-
 20 files changed, 97 insertions(+), 61 deletions(-)

commit 150961e28bd5ac540d25caf8b8e9e24109e2fb64
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Jun 13 16:04:40 2019 +0800

    [issue:1964] fix build error of apachepulsar/pulsar-build:centos-7 (#4518)
    
    add related dependencies `libstdc++` in docker file

 pulsar-client-cpp/pkg/rpm/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a764f8820a7fd7e137be044e8d0373beb4da7dd5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 12 22:31:20 2019 -0700

    [pulsar-admin] remove duplicate shaded ahc.properties file in client and admin (#4514)
    
    removing file from one of the location pulsar-client-admin and adding the symlink from pulsar-client module.

 .../org/asynchttpclient/config/ahc.properties      | 74 +---------------------
 1 file changed, 1 insertion(+), 73 deletions(-)

commit 5a9dbab613d2262948f67f2f02c1c1d74608c4fb
Author: wpl <1269223860@qq.com>
Date:   Thu Jun 13 10:26:12 2019 +0800

    fix issue 4347 [ClientAPI]ReaderBuilder.loadConf() not working (#4382)

 .../pulsar/client/impl/ReaderBuilderImpl.java      |  2 ++
 .../client/impl/conf/ReaderConfigurationData.java  |  3 +++
 .../apache/pulsar/client/impl/BuildersTest.java    | 28 ++++++++++++++++++++++
 3 files changed, 33 insertions(+)

commit ce7e44f6bfce5bf36374187c3fe39dd2ebb32b0e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 12 08:57:50 2019 -0700

    [pulsar-client] add async-http-client properties to shaded client (#4512)

 pulsar-client/src/main/resources/ahc.properties | 2 ++
 1 file changed, 2 insertions(+)

commit d27175819681635222450748ab25be4ec2eaa788
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Jun 13 00:56:42 2019 +0900

    Make it possible to compile binary statically linked with log4cxx (#4519)

 pulsar-client-cpp/CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a96cb803c99e3542d63c5f3e9d4178f98ba48654
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Jun 12 10:18:20 2019 +0900

    C++ client build fails when USE_LOG4CXX is ON (#4511)
    
    ### Motivation
    
    When I set `USE_LOG4CXX` to ON, C++ client build fails with the following error:
    ```
    /tmp/apache-pulsar-2.3.2/pulsar-client-cpp/lib/ClientImpl.cc: In constructor pulsar::ClientImpl::ClientImpl(const string&, const pulsar::ClientConfiguration&, bool):
    /tmp/apache-pulsar-2.3.2/pulsar-client-cpp/lib/ClientImpl.cc:103:17: error: Log4CxxLoggerFactory has not been declared
                     Log4CxxLoggerFactory::create(clientConfiguration_.getLogConfFilePath()));
    ```
    
    This is because the header file `Log4CxxLogger.h` is not included in `ClientImpl.cc`.
    
    ### Modifications
    
    Fixed `ClientImpl.cc` to include `Log4CxxLogger.h` only when `USE_LOG4CXX` is ON.

 pulsar-client-cpp/lib/ClientImpl.cc | 3 +++
 1 file changed, 3 insertions(+)

commit a19522130c4e6c848b6d80ae28a0d016fab8210c
Author: tuteng <eguangning@gmail.com>
Date:   Wed Jun 12 03:02:13 2019 +0800

    [document][swagger]Update topics rest api document (#4367)
    
    * Update topics rest api document
    
    * Update response status code
    Format params content
    
    * Update message and value

 .../pulsar/broker/admin/v2/PersistentTopics.java   | 713 ++++++++++++++++-----
 1 file changed, 554 insertions(+), 159 deletions(-)

commit a52e9af9ddfeb90c129a77969c60f6da38281e9d
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Jun 12 02:15:07 2019 +0800

    Add function worker client auth config in cluster. (#4499)

 .../src/main/java/org/apache/pulsar/PulsarBrokerStarter.java   | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit acbf0c8449d62cd52f30191dd546a2beaeb134e4
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Tue Jun 11 10:25:49 2019 -0700

    Update readme for setting up protobuf 2.6.0 on mac. (#4492)
    
    * Update readme for setting up protobuf 2.6.0 on mac.
    Update port for standalone.conf used for spin up server for testing.
    
    * No longer require protobuf 2.6 specificly, so update the instruction to accommodate that.
    Also leave tests/standalone.conf as original state.

 pulsar-client-cpp/README.md | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit d3b177fce849598e6346187ae91ead08305f81f0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jun 11 10:08:11 2019 +0800

    [rest] improve clusters rest endpoint by documenting the endpoints with more swagger annotations (#4374)
    
    
    
    Co-Authored-By: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
    Co-Authored-By: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>

 .../pulsar/broker/admin/impl/ClustersBase.java     | 466 +++++++++++++++++----
 pulsar-client-admin-shaded/pom.xml                 |   5 +
 pulsar-client-shaded/pom.xml                       |   5 +
 pulsar-common/pom.xml                              |  13 +-
 .../policies/data/AutoFailoverPolicyData.java      |  26 ++
 .../policies/data/AutoFailoverPolicyType.java      |   6 +
 .../data/BrokerNamespaceIsolationData.java         |  15 +
 .../pulsar/common/policies/data/ClusterData.java   |  30 ++
 .../pulsar/common/policies/data/FailureDomain.java |  11 +
 .../policies/data/NamespaceIsolationData.java      |  29 ++
 pulsar-functions/runtime-all/pom.xml               |   4 +
 11 files changed, 519 insertions(+), 91 deletions(-)

commit 6c7190803d407c0d1183566b20edf03031c99e26
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 10 10:03:22 2019 -0700

    [pulsar-storm] add option to pass consumerConfiguration to PulsarSpout (#4494)

 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 43 +++++++++++++++++-----
 .../pulsar/storm/PulsarSpoutConfiguration.java     | 14 -------
 2 files changed, 33 insertions(+), 24 deletions(-)

commit 245e8d9e4430f29887f419ebfaccca1b9eac553e
Author: Graud Dug de Bernonville <geraudster@gmail.com>
Date:   Mon Jun 10 07:33:09 2019 +0200

    [pulsar-io-elastic-search] NumberOfReplicas can be 0 (#4328)
    
    Motivation
    Replicating shards in Elasticsearch is not mandatory, so we should have a way to set numberOfReplicas to 0 in sink configuration.
    
    Modifications
    Change condition on indexNumberOfReplicas to accept 0 value
    Update error message

 .../pulsar/io/elasticsearch/ElasticSearchConfig.java      |  6 +++---
 .../pulsar/io/elasticsearch/ElasticSearchConfigTests.java | 15 ++++++++++++++-
 2 files changed, 17 insertions(+), 4 deletions(-)

commit af88a360df72b5fde221fe183ecbc9e13a4c578d
Author: hapihu <zhatianhu@gmail.com>
Date:   Mon Jun 10 09:53:46 2019 +0800

    Fix issue for incorrect log parameters (#4409)
    
    Fix issue for incorrect log parameters
    * When calling Logger's method, set the appropriate parameters
    * Fix #4408.

 .../java/org/apache/pulsar/broker/admin/v1/NonPersistentTopics.java   | 2 +-
 .../src/main/java/org/apache/pulsar/broker/service/ServerCnx.java     | 2 +-
 .../java/org/apache/pulsar/client/impl/MultiTopicsConsumerImpl.java   | 4 ++--
 .../src/main/java/org/apache/pulsar/common/naming/NamespaceName.java  | 2 +-
 4 files changed, 5 insertions(+), 5 deletions(-)

commit ef3514c65c7509a32561297ae6e9f17551c1ee52
Author: rshermanTHG <48561471+rshermanTHG@users.noreply.github.com>
Date:   Mon Jun 10 02:38:16 2019 +0100

    Add delete and peek functionality to dashboard (#4468)
    
    ### Motivation
    
    
    Add some administration functionality to the dashboard.
    
    1. Ability to peek at the contents of messages in a subscriptions backlog
    2. Able to clear the backlog in a subscription
    3. Able to delete subscriptions that have no consumers
    4. Able to delete a namespace that has no topics
    
    ### Modifications
    
    All modifications are to the dashboard module only.
    
    - Added a new page that lists messages in the backlog as a link. When this link is clicked on the message pops up in a modal dialog
    - Added a deleted flag to several models and added this flag to the appropriate filters. (when an object is deleted this will keep the dashboard reflective of the state of the brokers until the next collector run).
    - Added functionality to delete a subscription if there are no consumers. Marks the subscription as deleted in the database. If this leaves a topic with no subscriptions then the topic is also marked in the database as deleted.
    - Added functionality to delete a namespace if there are no topics for that namespace. Marks the namespace as deleted in the database.

 dashboard/django/collector.py                      | 18 +++-
 dashboard/django/dashboard/settings.py             |  2 +
 .../migrations/0002_support_deleted_objects.py     | 53 ++++++++++++
 dashboard/django/stats/models.py                   | 14 +++-
 dashboard/django/stats/static/stats/additional.css | 59 +++++++++++++
 dashboard/django/stats/templates/stats/base.html   |  6 +-
 .../django/stats/templates/stats/messages.html     | 51 ++++++++++++
 .../django/stats/templates/stats/namespace.html    |  7 +-
 dashboard/django/stats/templates/stats/peek.html   | 22 +++++
 dashboard/django/stats/templates/stats/topic.html  | 21 ++++-
 .../django/stats/templatetags/stats_extras.py      |  4 +
 dashboard/django/stats/urls.py                     |  5 ++
 dashboard/django/stats/views.py                    | 97 +++++++++++++++++++---
 13 files changed, 340 insertions(+), 19 deletions(-)

commit 84d2d1e443d427d3a730c0addc67c8e58fc56593
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Jun 9 12:47:21 2019 -0700

    [pulsar-broker] Fix race condition of read-timeout task in ML (#4437)
    
    * [pulsar-broker] Fix race condition of read-timeout task in ML
    
    * fix atomic recycling
    
    * fix test
    
    * add method for reOpCount

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 110 +++++++++++----------
 1 file changed, 60 insertions(+), 50 deletions(-)

commit fbb3c18ce14f9a852c2e0538e1d2e9487a611e99
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Jun 9 11:07:55 2019 -0700

    [pulsar-storm] pulsar-bolt: add option to pass producer-configuration (#4495)

 .../java/org/apache/pulsar/storm/PulsarBolt.java   | 24 +++++++++++++++++-----
 1 file changed, 19 insertions(+), 5 deletions(-)

commit 144d8add8e0da2b4a9063ceb7cbc96884aa870eb
Author: Sylvere Richard <sylvere.richard@gmail.com>
Date:   Sun Jun 9 04:19:34 2019 +0200

    Fixes a typo in the sidebar section Admin API / Permissions (#4496)

 site2/docs/admin-api-permissions.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 91c7813b79e788771083956a7c236dc47fde5737
Author: Kim Christian Gaarder <kim.christian.gaarder@gmail.com>
Date:   Sat Jun 8 08:57:20 2019 +0200

    Removed pulsar-client-api from shaded jar. (#4491)

 pulsar-client-all/pom.xml | 1 -
 1 file changed, 1 deletion(-)

commit ed836e284bba8bc584a5f90366c81bad58f82f69
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 6 15:27:47 2019 -0700

    [pulsar-broker] support secondary bookie isolation group at namespace (#4458)
    
    * [pulsar-broker] support secondary bookie isolation group at namespace
    
    * Fix: get correct available-primary bookie count | cli optional
    
    * fix test

 .../apache/pulsar/broker/ServiceConfiguration.java |   6 -
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |   2 -
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  13 +-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |   7 +-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |   7 +-
 .../pulsar/broker/service/BrokerService.java       |   6 +-
 .../broker/service/BrokerBookieIsolationTest.java  | 160 +++++++++++++++++++--
 .../org/apache/pulsar/client/admin/Namespaces.java |  24 +++-
 .../client/admin/internal/NamespacesImpl.java      |  11 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   7 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  13 +-
 .../policies/data/BookieAffinityGroupData.java     |  56 ++++++++
 .../pulsar/common/policies/data/LocalPolicies.java |   6 +-
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |  24 ++--
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |   2 -
 15 files changed, 281 insertions(+), 63 deletions(-)

commit dfdfdb4efa46662e7ec8cb027fdfe854d45caec5
Author: Kim Christian Gaarder <kim.christian.gaarder@gmail.com>
Date:   Thu Jun 6 22:18:29 2019 +0200

    Include pulsar-client-api in shaded client artifacts (#4445)
    
    * o.a.p.c.api -> o.a.p.c.protocol
    
    Classes in pulsar-common module were moved to avoid jpms split-package
    conflict between the pulsar-client-api and pulsar-common modules.
    
    * o.a.p.c.schema -> o.a.p.c.protocol.schema
    
    Classes in pulsar-common module were moved to avoid jpms split-package
    conflict between the pulsar-client-api and pulsar-common modules.

 .../apache/bookkeeper/mledger/impl/ManagedLedgerTest.java |  2 +-
 .../org/apache/pulsar/broker/ServiceConfiguration.java    |  2 +-
 .../main/java/org/apache/pulsar/PulsarBrokerStarter.java  |  2 +-
 .../apache/pulsar/broker/BookKeeperClientFactoryImpl.java |  2 +-
 .../pulsar/broker/admin/impl/PersistentTopicsBase.java    |  2 +-
 .../apache/pulsar/broker/admin/v2/SchemasResource.java    | 12 ++++++------
 .../org/apache/pulsar/broker/lookup/TopicLookupBase.java  |  4 ++--
 .../pulsar/broker/service/AbstractBaseDispatcher.java     |  4 ++--
 .../service/AbstractDispatcherMultipleConsumers.java      |  2 +-
 .../org/apache/pulsar/broker/service/AbstractTopic.java   |  4 ++--
 .../java/org/apache/pulsar/broker/service/Consumer.java   |  4 +---
 .../java/org/apache/pulsar/broker/service/Producer.java   |  8 ++++----
 .../pulsar/broker/service/PulsarChannelInitializer.java   |  5 ++---
 .../java/org/apache/pulsar/broker/service/ServerCnx.java  | 15 +++++++--------
 .../main/java/org/apache/pulsar/broker/service/Topic.java |  4 ++--
 .../NonPersistentDispatcherMultipleConsumers.java         |  2 +-
 .../NonPersistentDispatcherSingleActiveConsumer.java      |  2 +-
 ...NonPersistentStickyKeyDispatcherMultipleConsumers.java |  2 +-
 .../broker/service/nonpersistent/NonPersistentTopic.java  |  2 +-
 .../broker/service/persistent/MessageDeduplication.java   |  2 +-
 .../broker/service/persistent/PersistentReplicator.java   |  2 --
 .../pulsar/broker/service/persistent/PersistentTopic.java |  2 +-
 .../persistent/ReplicatedSubscriptionsController.java     |  2 +-
 .../ReplicatedSubscriptionsSnapshotBuilder.java           |  2 +-
 .../service/schema/AvroSchemaBasedCompatibilityCheck.java |  2 +-
 .../broker/service/schema/BookkeeperSchemaStorage.java    |  3 +--
 .../service/schema/DefaultSchemaRegistryService.java      |  4 ++--
 .../service/schema/JsonSchemaCompatibilityCheck.java      |  2 +-
 .../service/schema/KeyValueSchemaCompatibilityCheck.java  |  5 +----
 .../pulsar/broker/service/schema/LongSchemaVersion.java   |  2 +-
 .../broker/service/schema/SchemaCompatibilityCheck.java   |  2 +-
 .../pulsar/broker/service/schema/SchemaRegistry.java      |  4 ++--
 .../broker/service/schema/SchemaRegistryServiceImpl.java  |  4 ++--
 .../pulsar/broker/service/schema/SchemaStorage.java       |  2 +-
 .../apache/pulsar/broker/service/schema/StoredSchema.java |  2 +-
 .../java/org/apache/pulsar/client/api/RawMessage.java     |  1 -
 .../org/apache/pulsar/client/impl/RawBatchConverter.java  |  2 +-
 .../org/apache/pulsar/compaction/TwoPhaseCompactor.java   |  6 +-----
 .../broker/admin/AdminApiSchemaValidationEnforced.java    |  2 +-
 .../pulsar/broker/service/NonPersistentTopicE2ETest.java  |  2 +-
 .../broker/service/PersistentMessageFinderTest.java       |  2 +-
 .../pulsar/broker/service/PersistentTopicE2ETest.java     |  2 +-
 .../apache/pulsar/broker/service/PersistentTopicTest.java |  2 +-
 .../org/apache/pulsar/broker/service/ReplicatorTest.java  |  8 +-------
 .../org/apache/pulsar/broker/service/ServerCnxTest.java   |  8 ++++----
 .../pulsar/broker/service/persistent/ChecksumTest.java    |  2 +-
 .../ReplicatedSubscriptionsSnapshotBuilderTest.java       |  4 ++--
 .../service/schema/AvroSchemaCompatibilityCheckTest.java  |  5 -----
 .../service/schema/BaseAvroSchemaCompatibilityTest.java   |  2 +-
 .../service/schema/JsonSchemaCompatibilityCheckTest.java  |  2 +-
 .../schema/KeyValueSchemaCompatibilityCheckTest.java      |  3 +--
 .../pulsar/broker/service/schema/SchemaServiceTest.java   |  4 ++--
 .../pulsar/broker/service/utils/ClientChannelHelper.java  |  2 +-
 .../org/apache/pulsar/client/api/ClientErrorsTest.java    |  5 ++---
 .../org/apache/pulsar/client/api/MockBrokerService.java   |  6 +++---
 .../pulsar/client/api/SimpleProducerConsumerTest.java     |  3 +--
 .../client/api/SimpleTypedProducerConsumerTest.java       |  2 +-
 .../pulsar/client/api/v1/V1_ProducerConsumerTest.java     |  4 +---
 .../pulsar/client/impl/BrokerClientIntegrationTest.java   |  2 +-
 .../pulsar/client/impl/CompactedOutBatchMessageTest.java  |  2 +-
 .../java/org/apache/pulsar/client/impl/MessageIdTest.java |  6 +++---
 .../org/apache/pulsar/client/impl/MessageParserTest.java  |  2 +-
 .../java/org/apache/pulsar/client/impl/RawReaderTest.java |  2 +-
 .../java/org/apache/pulsar/compaction/CompactorTest.java  |  2 +-
 .../main/java/org/apache/pulsar/client/admin/Schemas.java |  2 +-
 .../apache/pulsar/client/admin/internal/SchemasImpl.java  |  6 +++---
 .../apache/pulsar/client/admin/internal/TopicsImpl.java   |  2 +-
 .../main/java/org/apache/pulsar/admin/cli/CmdSchemas.java |  2 +-
 .../apache/pulsar/client/impl/BatchMessageContainer.java  |  2 +-
 .../pulsar/client/impl/BinaryProtoLookupService.java      |  4 ++--
 .../java/org/apache/pulsar/client/impl/ClientCnx.java     |  6 +++---
 .../java/org/apache/pulsar/client/impl/ConsumerImpl.java  |  6 +++---
 .../org/apache/pulsar/client/impl/HttpLookupService.java  |  4 ++--
 .../java/org/apache/pulsar/client/impl/MessageImpl.java   |  2 +-
 .../impl/PersistentAcknowledgmentsGroupingTracker.java    |  2 +-
 .../java/org/apache/pulsar/client/impl/ProducerImpl.java  | 10 +++++-----
 .../pulsar/client/impl/PulsarChannelInitializer.java      |  4 ++--
 .../org/apache/pulsar/client/impl/schema/SchemaUtils.java |  1 -
 .../java/org/apache/pulsar/client/impl/ClientCnxTest.java |  2 +-
 .../org/apache/pulsar/common/api/raw/MessageParser.java   |  7 +++----
 .../pulsar/common/{api => protocol}/ByteBufPair.java      |  2 +-
 .../pulsar/common/{api => protocol}/CommandUtils.java     |  2 +-
 .../apache/pulsar/common/{api => protocol}/Commands.java  |  5 +++--
 .../apache/pulsar/common/{api => protocol}/Markers.java   |  4 ++--
 .../pulsar/common/{api => protocol}/PulsarDecoder.java    |  2 +-
 .../pulsar/common/{api => protocol}/PulsarHandler.java    |  2 +-
 .../common/{ => protocol}/schema/BytesSchemaVersion.java  |  2 +-
 .../{ => protocol}/schema/DeleteSchemaResponse.java       |  2 +-
 .../pulsar/common/{ => protocol}/schema/EmptyVersion.java |  2 +-
 .../common/{ => protocol}/schema/GetSchemaResponse.java   |  3 ++-
 .../common/{ => protocol}/schema/LatestVersion.java       |  2 +-
 .../common/{ => protocol}/schema/PostSchemaPayload.java   |  2 +-
 .../common/{ => protocol}/schema/PostSchemaResponse.java  |  2 +-
 .../pulsar/common/{ => protocol}/schema/SchemaData.java   |  3 ++-
 .../common/{ => protocol}/schema/SchemaInfoUtil.java      |  5 +++--
 .../common/{ => protocol}/schema/SchemaVersion.java       |  2 +-
 .../apache/pulsar/common/compression/CommandsTest.java    |  6 +++---
 .../pulsar/common/{api => protocol}/ByteBufPairTest.java  |  2 +-
 .../common/{api => protocol}/CommandUtilsTests.java       |  2 +-
 .../pulsar/common/{api => protocol}/MarkersTest.java      |  2 +-
 .../common/{api => protocol}/PulsarDecoderTest.java       |  2 +-
 .../apache/pulsar/discovery/service/ServerConnection.java |  5 ++---
 .../discovery/service/ServiceChannelInitializer.java      |  2 +-
 .../pulsar/discovery/service/DiscoveryServiceTest.java    |  2 +-
 .../apache/pulsar/proxy/server/DirectProxyHandler.java    |  4 ++--
 .../apache/pulsar/proxy/server/LookupProxyHandler.java    |  4 ++--
 .../org/apache/pulsar/proxy/server/ProxyClientCnx.java    |  2 +-
 .../org/apache/pulsar/proxy/server/ProxyConnection.java   |  5 ++---
 .../pulsar/proxy/server/ServiceChannelInitializer.java    |  2 +-
 .../apache/pulsar/sql/presto/PulsarConnectorConfig.java   |  2 +-
 .../org/apache/pulsar/sql/presto/TestPulsarConnector.java |  4 ++--
 111 files changed, 168 insertions(+), 199 deletions(-)

commit c2fdf0810428e6ea55bb14e85985c28bb5e5dba4
Author: Jia Zhai <zhaijia@yeah.net>
Date:   Fri Jun 7 04:17:53 2019 +0800

    Issue 4469: add function worker client auth config in standalone (#4473)
    
    * add worker client auth config in standalone
    
    * add more other conf passingly
    
    * add configs

 .../src/main/java/org/apache/pulsar/PulsarStandalone.java    | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

commit 304843ffd0390e9b29b6f35a76d8f4903612de45
Author: hapihu <w.gh123@qq.com>
Date:   Thu Jun 6 23:48:40 2019 +0800

    Update concepts-messaging.md (#4483)
    
    * Update concepts-messaging.md
    
    Since the  #1089the interface 'org.apache.pulsar.client.api.PulsarClient' has supported builder for consumer and producer.
    And,int the #3272, some deprecated client API have been removed including 'public static PulsarClient create(String serviceUrl)','Consumer<byte[]> subscribe(String topic, String subscription)' and 'Producer<byte[]> createProducer(String topic)'.
    
    So, I modified the example with the current version of the interface.
    
    * Apply suggestions from code review
    
    Specify message schema
    
    Co-Authored-By: Matteo Merli <mmerli@apache.org>

 site2/docs/concepts-messaging.md | 23 ++++++++++++++++++-----
 1 file changed, 18 insertions(+), 5 deletions(-)

commit 3db648e074aeb158e886962b1221096cb8540135
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Jun 6 23:48:05 2019 +0800

    [Improve DOC] Update functions rest api doc (#4368)
    
    * [Improve DOC] Update functions rest api doc
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * adjust output format
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 368 +++++++++++++++++----
 1 file changed, 307 insertions(+), 61 deletions(-)

commit 17d2b4213ed401bc6dad14f4f76ef8ce270b0461
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Thu Jun 6 21:17:00 2019 +0530

    [Issue 4379] [Java Client] Build auth from class and params in PulsarClientImpl (#4381)
    
    * Flink client to accept all pulsar client conf
    
    In this patch, we provide handles for flink connecotr to accept ClientConfigurationData, ProducerConfigurationData, ConsumerConfigurationData so flink client can:
    1. accept all params of client, producer and consumer
    2. Keep pace with pulsar-client
    
    * Flink client to accept all pulsar client conf
    
    Added test cases
    
    * Removing commented code
    
    * flink: construct auth when building pulsarsource
    
    * fixed failing tests
    
    * removed unused import
    
    * Added builder defaults for lombok builder
    Set Auth from class and params (if set) in PulsarClientImpl.java
    
    * Remove @BUilder.default from attributes where no defaults exist
    
    * Added tests for ClientConfiguration Data builders
    
    * cosmetic changes in code
    
    Co-Authored-By: Sijie Guo <guosijie@gmail.com>
    
    * fixing typo
    
    * Removed test, not true anymore
    
    * Removed lombok builders
    
    * fixed the failing tests
    
    * Because the authentication field is transient, it is not serialized. On desirialization then its null and desirialization crashes with NPE

 .../pulsar/client/impl/PulsarClientImpl.java       | 11 +++
 .../client/impl/conf/ClientConfigurationData.java  | 15 ++--
 .../impl/conf/ConsumerConfigurationData.java       |  1 -
 .../impl/conf/ProducerConfigurationData.java       |  1 -
 .../client/impl/auth/AuthenticationTokenTest.java  | 30 ++++++++
 .../impl/conf/ConfigurationDataUtilsTest.java      | 18 +++++
 .../connectors/pulsar/PulsarSourceBuilder.java     |  2 +-
 .../pulsar/PulsarAvroOutputFormatTest.java         | 50 ++++++-------
 .../pulsar/PulsarCsvOutputFormatTest.java          | 50 ++++++-------
 .../pulsar/PulsarJsonOutputFormatTest.java         | 50 ++++++-------
 .../connectors/pulsar/PulsarOutputFormatTest.java  | 61 +++++++---------
 .../connectors/pulsar/PulsarAvroTableSinkTest.java | 11 ++-
 .../connectors/pulsar/PulsarJsonTableSinkTest.java | 10 ++-
 .../connectors/pulsar/PulsarSourceBuilderTest.java | 84 ++++++++++------------
 14 files changed, 204 insertions(+), 190 deletions(-)

commit 1473bda6329fcae97f476c351a84df7990b66b6e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 6 08:45:31 2019 -0700

    [pulsar-admin] change partitioned topic stats on async rest api (#4487)

 .../broker/admin/impl/PersistentTopicsBase.java    | 98 ++++++++++++++--------
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 25 ++++--
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 24 ++++--
 3 files changed, 101 insertions(+), 46 deletions(-)

commit 630914901477357af9a47d687a0b43a7a7b7fa37
Author: lipenghui <penghui@apache.org>
Date:   Thu Jun 6 17:05:37 2019 +0800

    Key_Shared subscription on non-persistent topic (#4462)
    
    * Support Key_Shared subscription on non-persistent topic.
    
    * fix review comments.

 .../AbstractDispatcherMultipleConsumers.java       |  26 ++
 .../NonPersistentDispatcherMultipleConsumers.java  |   4 +-
 ...istentStickyKeyDispatcherMultipleConsumers.java | 102 +++++++
 .../nonpersistent/NonPersistentSubscription.java   |   5 +
 ...istentStickyKeyDispatcherMultipleConsumers.java |  22 --
 .../NonPersistentKeySharedSubscriptionTest.java    | 335 +++++++++++++++++++++
 6 files changed, 470 insertions(+), 24 deletions(-)

commit c540e28d98ba511b196111d73962956c80e6ffbe
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Jun 6 14:59:39 2019 +0800

    Improve perf producer to publish non-empty buffer and multi-lines payload. (#4479)
    
    ### Motivation
    
    Fixes #4478
    
    ### Modifications
    
    Generate alphabetic bytes buffer and add a parameter `--payload-delimiter` to select different lines randomly from a file.

 .../pulsar/testclient/PerformanceProducer.java     | 38 +++++++++++++++++++---
 site2/docs/reference-cli-tools.md                  |  3 +-
 2 files changed, 36 insertions(+), 5 deletions(-)

commit b7a5677324a79708fd288fee6e8852f16a08ab6c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 5 23:58:47 2019 -0700

    [pulsar-storm] Upgrade storm version to 2.0.0 (#4486)
    
    ### Motivation
    [Storm-2.0](http://storm.apache.org/2019/05/30/storm200-released.html) has been released now and it has performance improvements. So, upgrading storm version in pulsar-storm so, user can use upgraded pulsar-storm in their topology.

 pom.xml                                                 |  2 +-
 pulsar-storm/pom.xml                                    |  2 +-
 tests/pulsar-storm-test/pom.xml                         | 17 +++++++++++++++++
 .../org/apache/pulsar/storm/MockOutputCollector.java    |  5 +++++
 .../apache/pulsar/storm/MockSpoutOutputCollector.java   |  5 +++++
 .../org/apache/pulsar/storm/example/StormExample.java   |  2 +-
 6 files changed, 30 insertions(+), 3 deletions(-)

commit d92442009c540a02e76182118eca410f8126e9da
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Jun 6 13:44:21 2019 +0800

    [issues 4464] Fix batch logic and add test case (#4475)
    
    * [issues 4464] Fix batch logic and add test case
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * resolve conflicts
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/c_producer.go    |  4 +--
 pulsar-client-go/pulsar/producer_test.go | 52 ++++++++++++++++++++++++++++++++
 2 files changed, 53 insertions(+), 3 deletions(-)

commit 2c3f783f013b173bd68b11333b7cc41a55b33b61
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Jun 6 11:04:33 2019 +0800

    Support key-shared subscribe mode for go client (#4465)
    
    * Support key-shared subscribe mode for go client
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/consumer.go      |  4 ++
 pulsar-client-go/pulsar/consumer_test.go | 69 ++++++++++++++++++++++++++++++++
 2 files changed, 73 insertions(+)

commit 05ec310daaca60d16e20b10019ab732f12b10bfa
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Thu Jun 6 03:46:43 2019 +0530

    [Issue 4441][client]Deduce ClientConfigurationData.isUseTls from protocol (#4451)
    
    * Deduce tls from protocol in service url
    
    * fixed failing test
    
    * fixed NPE
    
    Co-Authored-By: Matteo Merli <mmerli@apache.org>

 .../pulsar/client/impl/conf/ClientConfigurationData.java       | 10 ++++++++++
 .../test/java/org/apache/pulsar/client/impl/BuildersTest.java  |  2 +-
 2 files changed, 11 insertions(+), 1 deletion(-)

commit 49e51db04b7a5a0cf701f870c6ea58a4655ecd07
Author: Jia Zhai <zhaijia@apache.org>
Date:   Thu Jun 6 04:44:18 2019 +0800

    rest: add swagger doc for tenants (#4421)
    
    * add swagger doc for tenants
    
    * fix lincense issue
    
    * update following matteo's comments

 .../pulsar/broker/admin/impl/TenantsBase.java      | 22 +++++++++++++++++-----
 pulsar-common/pom.xml                              | 19 ++++++++++++-------
 .../pulsar/common/policies/data/TenantInfo.java    | 11 +++++++++++
 pulsar-sql/presto-distribution/LICENSE             |  2 ++
 4 files changed, 42 insertions(+), 12 deletions(-)

commit 0d16b905d42d66c0a19361b7c46ab62140673d5a
Author:  <ranxiaolong716@gmail.com>
Date:   Thu Jun 6 00:24:38 2019 +0800

    [issues 4476] Fix MessageID output order error (#4477)
    
    * [issues 4476] Fix MessageID output order error
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add comments of msgID output
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-cpp/lib/MessageId.cc       |  2 +-
 pulsar-client-go/pulsar/producer_test.go | 54 ++++++++++++++++++++++++++++++++
 2 files changed, 55 insertions(+), 1 deletion(-)

commit f56d30ddf40ef9eec172db1c0f78cc2143151bdb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 4 23:22:23 2019 -0700

    Function localrun improved (#4453)
    
    * fix localrun and add tests
    
    * minor fix
    
    * Improving localrun for functions
    
    * improving impl and adding tests
    
    * add missing modules

 bin/function-localrunner                           |   2 +-
 distribution/server/pom.xml                        |  13 +
 pulsar-broker/pom.xml                              |   7 +
 .../worker/PulsarFunctionLocalRunTest.java         | 719 +++++++++++++++++++++
 pulsar-functions/localrun-shaded/pom.xml           | 374 +++++++++++
 pulsar-functions/localrun/pom.xml                  |  73 +++
 .../org/apache/pulsar/functions/LocalRunner.java   | 466 +++++++++++++
 pulsar-functions/pom.xml                           |   2 +
 .../pulsar/functions/runtime/LocalRunner.java      | 283 --------
 9 files changed, 1655 insertions(+), 284 deletions(-)

commit ef834ae8e60f0707ba10b2852d2e56a46d30a13f
Author: tuteng <eguangning@gmail.com>
Date:   Wed Jun 5 14:03:29 2019 +0800

    [issue #4074][pulsar-io]Update document of PostgreSQL for debezium (#4376)
    
    Fixes #4074
    
    Master Issue: #4074
    
    ### Motivation
    There is currently a lack of documentation on PostgreSQL. Therefore, some useful documents about PostgreSQL are added.
    
    ### Modifications
    Update document of PostgreSQL for debezium

 site2/docs/io-cdc-debezium.md | 250 +++++++++++++++++++++++++++++++-----------
 1 file changed, 186 insertions(+), 64 deletions(-)

commit e7162732a9806f6702ca0610ffead7e8cedc958f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 4 22:52:53 2019 -0700

    [pulsar-common] support map in config parser (#4418)
    
    * [pulsar-common] support map in config parser
    
    * fix error

 .../org/apache/pulsar/common/util/FieldParser.java | 16 ++++++
 .../apache/pulsar/common/util/FieldParserTest.java | 59 ++++++++++++++++++++++
 2 files changed, 75 insertions(+)

commit 4692b9267456371d8c7e60c736748850b5523d86
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 4 22:38:31 2019 -0700

    [pulsar-ml] pass ctx for EntryCacheDisabled (#4450)

 .../main/java/org/apache/bookkeeper/mledger/impl/EntryCacheManager.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit cbe670bad864da5646dc3717398137eb350758a8
Author: hapihu <zhatianhu@gmail.com>
Date:   Wed Jun 5 08:43:59 2019 +0800

    Update functions-overview.md (#4470)
    
    In the current version, the interface 'org.apache.pulsar.functions.api.Context' does not have method 'getName()'.
    On the contrary, the interface has the method 'getFunctionName()'.
    So i change 'context.getName()' to 'context.getFunctionName()'.

 site2/docs/functions-overview.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit afc4de4967eef265f49b47c2109c9b036f883741
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 4 15:30:49 2019 -0700

    Use versioned path for reference docs (#4420)

 pulsar-client-cpp/Doxyfile       |  2 +-
 site2/tools/build-site.sh        | 38 ++++++++++++++++++++++++++++++++++++++
 site2/tools/docker-build-site.sh |  2 +-
 site2/tools/doxygen-doc-gen.sh   |  5 ++---
 site2/tools/generate-api-docs.sh | 10 ++++++++++
 site2/tools/javadoc-gen.sh       |  7 ++++---
 site2/tools/python-doc-gen.sh    |  6 ++++--
 7 files changed, 60 insertions(+), 10 deletions(-)

commit 39551bb7518bd7196d9f94adf2b5ebf20c139bf0
Author: Like <ke.like@outlook.com>
Date:   Wed Jun 5 02:46:57 2019 +0800

    Fix log format for module pulsar-client (#4436)
    
    Fix log format for module pulsar-client.
    
    Part of #4304

 .../java/org/apache/pulsar/client/impl/PartitionedProducerImpl.java     | 2 +-
 .../java/org/apache/pulsar/client/impl/ProducerStatsRecorderImpl.java   | 2 +-
 .../java/org/apache/pulsar/client/impl/PulsarServiceNameResolver.java   | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit fc59074e9a563a7952ae9fd18e8a2e8bbb1e72a9
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Jun 5 02:43:59 2019 +0800

    Update administration-zk-bk to add the way to start bookie in foreground. (#4424)
    
    ### Motivation
    
    Update administration-zk-bk to add the way to start bookie in foreground
    
    ### Modifications
    
    Add `bookkeeper` to start a bookie.

 site2/docs/administration-zk-bk.md | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit db3a056abbf3e841e4dee79067db516a5bc64195
Author: Jia Zhai <zhaijia@apache.org>
Date:   Wed Jun 5 02:42:41 2019 +0800

    Issue 4456: add sasl-client jar into server distribution (#4457)
    
    Fixes #4456
    
    ### Motivation
    sometimes, user may use sasl client directly, e.g. use cli command bin/pulsar-client, and if sasl-client not included in, it may meet error of `class not found`

 distribution/server/pom.xml     |  6 ++++++
 site2/docs/security-kerberos.md | 12 +++++++++++-
 2 files changed, 17 insertions(+), 1 deletion(-)

commit ec8961f2971b22b9ca43e6d1177eb38319b09567
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 4 07:21:03 2019 -0700

    fix minor issue when cleaning up subscriptions for functions (#4461)

 .../main/java/org/apache/pulsar/functions/worker/FunctionActioner.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4db4d532fb6d27f64243a652c715c1660b994102
Author:  <ranxiaolong716@gmail.com>
Date:   Tue Jun 4 22:17:33 2019 +0800

    Add log info for key-shared subscribe mode (#4463)
    
    * Add log info for key-shared subscribe mode
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../main/java/org/apache/pulsar/broker/service/ServerCnx.java    | 9 +++++----
 .../PersistentStickyKeyDispatcherMultipleConsumers.java          | 7 +++++++
 2 files changed, 12 insertions(+), 4 deletions(-)

commit d0dffd6bf0da06dc1c0d29f36c7ffde2055503aa
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Tue Jun 4 22:16:29 2019 +0800

    get boolean schema from schemaInfo (#4459)

 .../java/org/apache/pulsar/client/impl/schema/AutoConsumeSchema.java    | 2 ++
 1 file changed, 2 insertions(+)

commit d2f6f62ba9aa4443357f566d255693ea66382827
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Jun 4 22:15:32 2019 +0800

    Print the exception message when authentication failed to create. (#4460)

 .../src/main/java/org/apache/pulsar/client/cli/PulsarClientTool.java     | 1 +
 1 file changed, 1 insertion(+)

commit 07845c5b463b35824f7b4bcab526e90e53489cdb
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 3 20:57:09 2019 -0700

    Fixed compilation with Boost 1.70 (#4454)
    
    * Fixed compilation with Boost 1.70
    
    * Fixed formatting

 pulsar-client-cpp/lib/ExecutorService.cc | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit 0851c75a5b1f3bda4fd7943bbd568888079c9383
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jun 3 17:39:48 2019 -0700

    Added api for putting state via cli/rest (#4311)
    
    * Added api for putting state via cli/rest
    
    * Addressed comments
    
    * More comments
    
    * Took feedback into account

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 20 +++++
 .../functions/worker/PulsarFunctionStateTest.java  | 13 +++
 .../org/apache/pulsar/client/admin/Functions.java  | 27 ++++++
 .../client/admin/internal/FunctionsImpl.java       | 17 ++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 28 ++++++-
 .../pulsar/common/functions/FunctionState.java     |  1 +
 .../python-examples/wordcount_function.py          |  1 +
 .../functions/worker/rest/api/ComponentImpl.java   | 98 ++++++++++++++++++++--
 .../worker/rest/api/v3/FunctionsApiV3Resource.java | 11 +++
 9 files changed, 208 insertions(+), 8 deletions(-)

commit a758b65224bdca9db897678fa06332fd1e833acb
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 3 16:11:11 2019 -0700

    [pulsar-broker] fix ConcurrentModificationException while load-report serialization (#4452)

 .../org/apache/pulsar/policies/data/loadbalancer/LocalBrokerData.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 870a2814b514187a81743d80061a129ba4018cf3
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Mon Jun 3 23:06:01 2019 +0100

    [Pulsar-Client] Add Consumer Numeric Properties Validation (#4446)

 README.md                                          | 15 ++++++++++-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  6 ++++-
 .../client/impl/ConsumerBuilderImplTest.java       | 29 ++++++++++++++++++++++
 .../version-2.1.0-incubating/io-rabbitmq.md        |  4 +--
 4 files changed, 50 insertions(+), 4 deletions(-)

commit d7cef10a411ace5c00597cd2ef961c1c3df3baa3
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Tue Jun 4 00:35:42 2019 +0800

    Update argument description of web service (#4390)
    
    * Update argument description of web service
    
    * Fix http status 500 description

 .../pulsar/broker/admin/impl/BrokersBase.java      | 46 ++++++++++++++--------
 1 file changed, 30 insertions(+), 16 deletions(-)

commit 176c901ace25c1039815ec7e81b80a1f27d2340c
Author: Addison Higham <addisonj@gmail.com>
Date:   Mon Jun 3 10:34:22 2019 -0600

    [tiered-storage] Add support for AWS instance and role creds (#4433)
    
    * Add support for AWS instance and role creds
    
    This commit makes changes to the tiered storage support for S3
    to allow for support of ec2 metadata instance credentials as well as
    additional config options for assuming a role to get credentials.
    
    This works by changing the way we provide credentials to use the
    funtional `Supplier` interface and for using the AWS specific
    `SessionCredentials` object for when we detect that the
    `CredentialProvider` is providing credentials that have a session token.
    
    * [tiered_storage] Tweak s3 credential handling to check on boot
    
    This changes the s3 handling slightly, instead of falling back to static
    credentials, we instead now fail if no s3 credentials can be found and
    change the unit tests to start a broker with s3 credentials.
    
    With the new Supplier API, we now fetch credentials on every request.
    Because of this, the failure and subsequent try/catch is costly and the
    integration tests were using this, which caused them to be significantly
    slower.
    
    Instead, we just check to see if we can fetch creds, and if we can't
    consider it an error condition to exit the app as it is unlikely in a
    production scenario to not have some credentials.
    
    * fix s3 test for missing creds

 site2/docs/cookbooks-tiered-storage.md             | 28 ++++++--
 site2/docs/reference-configuration.md              | 12 ++--
 .../integration/topologies/PulsarCluster.java      |  3 +
 tiered-storage/jcloud/pom.xml                      |  4 ++
 .../jcloud/TieredStorageConfigurationData.java     | 24 +++++++
 .../impl/BlobStoreManagedLedgerOffloader.java      | 57 ++++++++++------
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  | 77 +++++++++++++++++++++-
 7 files changed, 172 insertions(+), 33 deletions(-)

commit 116e88c8c3c75219d477a6dd4792a6bf47a8c911
Author: lipenghui <penghui@apache.org>
Date:   Tue Jun 4 00:33:09 2019 +0800

    Remove redundant readMoreEntries call in PersistentDispatcherMultipleConsumers and PersistentStickyKeyDispatcherMultipleConsumers (#4442)

 .../service/persistent/PersistentDispatcherMultipleConsumers.java       | 2 +-
 .../persistent/PersistentStickyKeyDispatcherMultipleConsumers.java      | 1 -
 2 files changed, 1 insertion(+), 2 deletions(-)

commit aa16934d764ce44e68b520bff4a4c78d76bcd322
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jun 2 19:17:10 2019 -0700

    Fixed checking for Optional value in topic close (#4439)
    
    The Optional.get() is throwing exception when the value is not present.

 .../org/apache/pulsar/broker/service/persistent/PersistentTopic.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2b70dafb9784baa9fc11f5bcb99898b1ed1483bb
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jun 2 19:12:57 2019 -0700

    Use unique name for PeerReplicatorTest (#4440)
    
    Motivation
    The PeerReplicatorTest.testPeerClusterInReplicationClusterListChange test sometime fails with :
    expected [false] but found [true]
    The retry then fails because the namespace already exists. Using a unique name will give the retry a clean state.

 .../java/org/apache/pulsar/broker/service/PeerReplicatorTest.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit db94c4f178e3d0ade4469b98bfc0634b46cc4c65
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Mon Jun 3 01:27:54 2019 +0800

    Update pulsar kerberos and cli document. (#4425)

 site2/docs/reference-cli-tools.md |  8 ++++----
 site2/docs/security-kerberos.md   | 24 ++++++++++++++++++------
 2 files changed, 22 insertions(+), 10 deletions(-)

commit 5f2dfc1fd73a937f505a25a74fa9edd6a5a0e324
Author: Like <ke.like@outlook.com>
Date:   Mon Jun 3 01:16:43 2019 +0800

    Add base class for PersistentTopic and NonPersistentTopic (#4438)
    
    * Add base class for PersistentTopic and NonPersistentTopic
    
    * Fix test

 .../broker/admin/impl/PersistentTopicsBase.java    |  10 +-
 .../pulsar/broker/service/AbstractTopic.java       | 203 +++++++++++++++++++++
 .../nonpersistent/NonPersistentReplicator.java     |   2 +-
 .../service/nonpersistent/NonPersistentTopic.java  | 161 +---------------
 .../PersistentDispatcherSingleActiveConsumer.java  |   2 +-
 .../service/persistent/PersistentReplicator.java   |   2 +-
 .../broker/service/persistent/PersistentTopic.java | 176 ++----------------
 .../broker/admin/AdminApiSchemaAutoUpdateTest.java |   6 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   2 +-
 9 files changed, 232 insertions(+), 332 deletions(-)

commit 4faccf19fa11ec71021503f84f6a227ec9acf9e8
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Jun 1 22:35:24 2019 -0700

    add support for loading sink/source secrets in inherited fields (#4430)

 .../org/apache/pulsar/io/common/IOConfigUtils.java | 19 ++++-
 .../apache/pulsar/io/common/IOConfigUtilsTest.java | 82 ++++++++++++++++++++--
 2 files changed, 94 insertions(+), 7 deletions(-)

commit 2e5bc205cfbb8a92d18f28f45051aa31aa4da7fc
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jun 1 07:37:24 2019 -0700

    Fixed intermittent test failure in PersistentFailoverE2ETest.testSimpleConsumerEventsWithPartition (#4431)

 .../broker/service/PersistentFailoverE2ETest.java  | 22 ++++++++++------------
 1 file changed, 10 insertions(+), 12 deletions(-)

commit 8c881ecc09b0652219a0d891f64e0e54ac9dcbfd
Author: lipenghui <penghui@apache.org>
Date:   Sat Jun 1 21:18:39 2019 +0800

    [doc] Improve tls authentication documentation. (#4317)

 site2/docs/security-tls-authentication.md | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 5ac44fe06852aa6dc445725efd5abffd81aa6d75
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri May 31 23:34:54 2019 -0700

    [pulsar-broker] tenant based bookie isolation (#3933)
    
    fix tests
    
    add admin cli
    
    fix test

 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  45 ++++
 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 101 ++++++-
 .../pulsar/broker/BookKeeperClientFactory.java     |   8 +-
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |  63 ++++-
 .../pulsar/broker/ManagedLedgerClientFactory.java  |  59 +++-
 .../org/apache/pulsar/broker/PulsarService.java    |   4 +
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  92 +++++++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  24 ++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  24 ++
 .../pulsar/broker/service/BrokerService.java       |  16 ++
 .../service/schema/BookkeeperSchemaStorage.java    |   4 +-
 .../apache/pulsar/compaction/CompactorTool.java    |   3 +-
 .../broker/MockedBookKeeperClientFactory.java      |   7 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   7 +-
 .../broker/service/BrokerBookieIsolationTest.java  | 300 +++++++++++++++++++++
 .../pulsar/compaction/CompactedTopicTest.java      |   5 +-
 .../apache/pulsar/compaction/CompactionTest.java   |   3 +-
 .../apache/pulsar/compaction/CompactorTest.java    |   5 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |   4 +
 .../client/admin/internal/NamespacesImpl.java      |  22 ++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   6 +
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  32 +++
 .../pulsar/common/policies/data/LocalPolicies.java |   6 +-
 .../zookeeper/ZkBookieRackAffinityMapping.java     |   2 +
 24 files changed, 797 insertions(+), 45 deletions(-)

commit 2a5b772e229692302c051f2de8928a007ad7713b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 31 19:45:14 2019 -0700

    Fixed NPE when closing batch during a reconnection (#4427)

 .../src/main/java/org/apache/pulsar/client/impl/ProducerImpl.java      | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit c73c71eb7e681b79845dde11b7cee7a5cb3aa79d
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 31 16:00:43 2019 -0700

    Upgrade version of maven-surefire-plugin (#4429)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 360a09c0750081a48233d91b89520c1a8def5420
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri May 31 16:00:23 2019 -0700

    Update release notes for v2.3.2 release (#4416)
    
    * Update release notes for v2.3.2 release
    
    * update release notes with links

 site2/website/release-notes.md | 46 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 46 insertions(+)

commit cff5627b4d691f81aa0d1ddcb80037ee6a747fe0
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 31 13:28:57 2019 -0700

    Increase timeout for replicator tests setup (#4428)

 .../org/apache/pulsar/broker/service/PeerReplicatorTest.java   | 10 +++++-----
 .../apache/pulsar/broker/service/ReplicatorGlobalNSTest.java   |  6 +++---
 .../pulsar/broker/service/ReplicatorRateLimiterTest.java       |  4 ++--
 .../java/org/apache/pulsar/broker/service/ReplicatorTest.java  |  4 ++--
 .../org/apache/pulsar/broker/service/ReplicatorTlsTest.java    |  4 ++--
 5 files changed, 14 insertions(+), 14 deletions(-)

commit 8385b6b547946a46a5cc77219124e6142a883b09
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri May 31 10:50:54 2019 -0700

    [pulsar-broker] Fix deadlock on skip messages (#4411)

 .../java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 38503b2d32444c7065f4b78018ec08cf59dd4157
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 31 09:14:13 2019 -0700

    Use a static instance of hostname verifier in ClientCnx (#4415)

 .../src/main/java/org/apache/pulsar/client/impl/ClientCnx.java      | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit c75668665919b6bfc6716a139bafdd16b7533ad4
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri May 31 17:49:58 2019 +0200

    Don't request redelivery of dead letter messages (#4426)
    
    If we send a message to the dead letter topic, we shouldn't also
    request that the same message be redelivered.
    
    The process to send to DLQ does do an acknowledge(), but acknowledge
    is async and not guaranteed, so it can race with the redelivery
    request.

 .../apache/pulsar/client/impl/ConsumerImpl.java    | 22 ++++++++++++----------
 1 file changed, 12 insertions(+), 10 deletions(-)

commit 0ff23b47bc1158dac03e6dbb3e1b335027ec577f
Author:  <ranxiaolong716@gmail.com>
Date:   Fri May 31 23:49:39 2019 +0800

    Support max message size for cpp and go client (#4348)
    
    * support max message size for cpp and go client
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * format cpp code
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix maxMessageSize logic
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix ci error
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-cpp/lib/BatchMessageContainer.cc |  2 +-
 pulsar-client-cpp/lib/ClientConnection.cc      |  9 +++++++++
 pulsar-client-cpp/lib/ClientConnection.h       |  3 +++
 pulsar-client-cpp/lib/Commands.h               |  2 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc          | 16 +++++++++++-----
 pulsar-client-cpp/lib/ProducerImpl.cc          |  7 ++++---
 pulsar-client-cpp/lib/ProducerImpl.h           |  2 ++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc   |  8 ++++----
 pulsar-client-go/go.mod                        |  1 -
 pulsar-client-go/go.sum                        |  2 --
 10 files changed, 35 insertions(+), 17 deletions(-)

commit 9db06a2c1e27dc61104ac97802a2bc07c2bf9dad
Author: lipenghui <penghui@apache.org>
Date:   Fri May 31 23:48:28 2019 +0800

    FIX Key_Shared dispatch ordering of message redelivery. (#4406)

 .../org/apache/bookkeeper/mledger/ManagedCursor.java  | 19 ++++++++++++++++++-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java    | 12 ++++++++++++
 .../mledger/impl/ManagedCursorContainerTest.java      |  5 +++++
 .../PersistentDispatcherMultipleConsumers.java        |  9 ++++++---
 ...ersistentStickyKeyDispatcherMultipleConsumers.java |  7 +++++++
 .../pulsar/client/api/KeySharedSubscriptionTest.java  |  9 +++++++++
 6 files changed, 57 insertions(+), 4 deletions(-)

commit 4464dbb2bc6efdcc8fda806dce74f30640c3153e
Author: lipenghui <penghui@apache.org>
Date:   Fri May 31 23:45:21 2019 +0800

    Fix remove pending acks in Key_Shared subscription (#4407)
    
    * Fix remove pending acks in key_shared subscription.
    
    * Fix stats in key_shared subscription.
    
    * Add subscription utils to check isCumulativeAckMode or isIndividualAckMode.
    
    * Use Subscription.isIndividualAckMode check in subscription stats

 .../main/java/org/apache/pulsar/broker/service/Consumer.java |  8 ++++----
 .../java/org/apache/pulsar/broker/service/ServerCnx.java     |  2 +-
 .../org/apache/pulsar/broker/service/StreamingStats.java     |  2 +-
 .../java/org/apache/pulsar/broker/service/Subscription.java  |  9 +++++++++
 .../broker/service/persistent/PersistentSubscription.java    |  2 +-
 .../pulsar/broker/service/persistent/PersistentTopic.java    |  2 +-
 .../apache/pulsar/client/api/KeySharedSubscriptionTest.java  | 12 +++---------
 7 files changed, 20 insertions(+), 17 deletions(-)

commit ab7085f3c043725e4e24a46ffd42b27c66ea5ea0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri May 31 08:35:52 2019 -0700

    [pulsar-broker] add topic-name in log on topic unloading failure (#4412)

 .../java/org/apache/pulsar/broker/service/BrokerService.java     | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

commit 7de6c24422fdb0a50675bb806dd8584cc1465666
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri May 31 08:35:00 2019 -0700

    Version docs for 2.3.2 release (#4417)

 site2/website/releases.json                        |    1 +
 .../versioned_docs/version-2.3.2/adaptors-spark.md |   77 +
 .../version-2.3.2/admin-api-namespaces.md          |  759 ++++++
 .../version-2.3.2/administration-geo.md            |  129 +
 .../version-2.3.2/concepts-clients.md              |   80 +
 .../version-2.3.2/concepts-messaging.md            |  381 +++
 .../version-2.3.2/deploy-bare-metal.md             |  444 ++++
 .../version-2.3.2/functions-guarantees.md          |   42 +
 .../version-2.3.2/functions-worker.md              |  241 ++
 .../version-2.3.2/getting-started-clients.md       |   57 +
 .../version-2.3.2/getting-started-docker.md        |  171 ++
 .../version-2.3.2/getting-started-standalone.md    |  221 ++
 .../versioned_docs/version-2.3.2/io-connectors.md  |   30 +
 .../versioned_docs/version-2.3.2/io-redis.md       |   28 +
 .../version-2.3.2/reference-cli-tools.md           |  698 ++++++
 .../version-2.3.2/reference-configuration.md       |  490 ++++
 .../version-2.3.2/reference-pulsar-admin.md        | 2552 ++++++++++++++++++++
 .../version-2.3.2/security-kerberos.md             |  284 +++
 .../version-2.3.2/security-overview.md             |   42 +
 .../versioned_sidebars/version-2.3.2-sidebars.json |  127 +
 site2/website/versions.json                        |    1 +
 21 files changed, 6855 insertions(+)

commit 8e4b130667ca4659a696fe4dee3aca454f99f06a
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 31 06:08:45 2019 -0700

    Removed joda-time test dependency from pulsar-client (#4404)

 pulsar-client/pom.xml | 5 -----
 1 file changed, 5 deletions(-)

commit 39f94ccc228d313fd3306b3a0b35fe17de2562d4
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 30 18:39:16 2019 -0700

    Cancel timeout tasks when the connection fails to get established (#4414)

 .../src/main/java/org/apache/pulsar/client/impl/ClientCnx.java     | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit cb7ec46cb9c6d888f4d6665c3c076b84d20ca24b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu May 30 14:00:57 2019 -0700

    [pulsar-admin] fix NPE on admin creation (#4410)

 .../src/main/java/org/apache/pulsar/client/admin/PulsarAdmin.java    | 5 +++++
 1 file changed, 5 insertions(+)

commit 3cbf3c32f24326d09006c8c2898dd8797f17ab65
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 30 11:54:40 2019 -0700

    fix localrun and add tests (#4401)
    
    * fix localrun and add tests
    
    * minor fix

 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |  30 ++--
 .../integration/containers/ChaosContainer.java     |   6 +
 .../integration/functions/PulsarFunctionsTest.java | 155 +++++++++++++++++++--
 .../functions/utils/CommandGenerator.java          |  40 +++++-
 .../tests/integration/suites/PulsarTestSuite.java  |  12 ++
 .../tests/integration/utils/DockerUtils.java       |  89 +++++++-----
 6 files changed, 267 insertions(+), 65 deletions(-)

commit e3f4841805777386688e45bfcad3ab3b7204792b
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Thu May 30 19:31:41 2019 +0800

    Update pulsar kerberos document (#4385)
    
    
    Currently, kerberos document is lack of some description when using client to connect brokers with kerberos.
    
    * Update pulsar kerberos document
    
    * Update doc
    
    * Fix doc

 site2/docs/security-kerberos.md | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit e3ece349d060b7ce0fd40e37e3a6d197036274c9
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 29 16:20:49 2019 -0700

    Initialize TLS context only when attempting connection (#4399)
    
    * Initialize TLS context only when attempting connection
    
    * Fixed eviction time check

 .../client/impl/PulsarChannelInitializer.java      | 53 +++++++++++-------
 .../org/apache/pulsar/client/util/ObjectCache.java | 54 ++++++++++++++++++
 .../client/impl/ClientInitializationTest.java      | 45 +++++++++++++++
 .../apache/pulsar/client/util/ObjectCacheTest.java | 64 ++++++++++++++++++++++
 4 files changed, 195 insertions(+), 21 deletions(-)

commit 347d4ab7ad6a74585a6a41cf98cda10904b41c00
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 29 15:52:25 2019 -0700

    fix dependency issue with pulsar-io-common (#4398)

 pulsar-io/common/pom.xml                                             | 5 ++---
 .../src/main/java/org/apache/pulsar/io/common/IOConfigUtils.java     | 4 ++--
 2 files changed, 4 insertions(+), 5 deletions(-)

commit 819916ded9f167317f7e9c9e0488f272f87fa895
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Thu May 30 04:15:08 2019 +0800

    [Doc] Adjust the structure of *Get Started*  (#4392)
    
    To show the following information on the right navigation panel:
    
    * Install builtin connectors (optional)
    * Install tiered storage offloaders (optional)

 site2/docs/getting-started-standalone.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 4d1b2ffeefba7844f7ff8b94bc1f984f27f4944d
Author: Like <ke.like@outlook.com>
Date:   Thu May 30 04:09:30 2019 +0800

    Add missed serialization schema argument for PulsarOutputFormat constructor (#4373)
    
    The constructor of PulsarOutputFormat expects a serializationSchema passed in otherwise it's member serializationSchema will be assigned by itself.

 .../batch/connectors/pulsar/PulsarOutputFormat.java   |  4 +++-
 .../connectors/pulsar/PulsarOutputFormatTest.java     | 19 +++++++++++++++----
 2 files changed, 18 insertions(+), 5 deletions(-)

commit ba24d73b5f77c42f832cd9d2720dc0aba388f909
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 29 10:54:38 2019 -0700

    Delayed message delivery implementation (#4062)
    
    * Delayed message delivery implementation
    
    * Fixed compilation
    
    * Allow to configure the delayed tracker implementation
    
    * Use int64 for timestamp
    
    * Address comments
    
    * More tests for TripleLongPriorityQueue
    
    * Removing useless sync block that causes deadlock with consumer close
    
    * Fixed merge conflict
    
    * Avoid new list when passing entries to consumer
    
    * Fixed test. Since entries are evicted from cache, they might be resent in diff order
    
    * Fixed context message builder
    
    * Fixed triggering writePromise when last entry was nullified
    
    * Moved entries filtering from consumer to dispatcher
    
    * Added Javadocs
    
    * Reduced synchronized scope to minimum

 conf/broker.conf                                   |  12 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  10 +
 .../org/apache/pulsar/broker/PulsarService.java    |  11 +-
 .../broker/delayed/DelayedDeliveryTracker.java     |  67 ++++++
 .../delayed/DelayedDeliveryTrackerFactory.java     |  55 +++++
 .../delayed/DelayedDeliveryTrackerLoader.java      |  47 +++++
 .../delayed/InMemoryDelayedDeliveryTracker.java    | 193 ++++++++++++++++++
 .../InMemoryDelayedDeliveryTrackerFactory.java     |  55 +++++
 .../broker/service/AbstractBaseDispatcher.java     |   8 +-
 .../pulsar/broker/service/BrokerService.java       |  12 ++
 .../apache/pulsar/broker/service/Dispatcher.java   |  13 ++
 .../apache/pulsar/broker/service/Subscription.java |   4 +
 .../PersistentDispatcherMultipleConsumers.java     |  99 +++++++--
 ...istentStickyKeyDispatcherMultipleConsumers.java |   4 +-
 .../service/persistent/PersistentSubscription.java |  17 +-
 .../stats/prometheus/AggregatedNamespaceStats.java |   1 +
 .../prometheus/AggregatedSubscriptionStats.java    |   2 +
 .../stats/prometheus/NamespaceStatsAggregator.java |   1 +
 .../pulsar/broker/stats/prometheus/TopicStats.java |   1 +
 .../delayed/InMemoryDeliveryTrackerTest.java       | 156 ++++++++++++++
 .../broker/service/PersistentTopicE2ETest.java     |   2 +-
 .../service/persistent/DelayedDeliveryTest.java    | 210 +++++++++++++++++++
 .../pulsar/client/api/TypedMessageBuilder.java     |  35 ++++
 .../apache/pulsar/client/impl/ProducerImpl.java    |   7 +-
 .../client/impl/TypedMessageBuilderImpl.java       |  16 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  69 ++++++-
 .../common/policies/data/SubscriptionStats.java    |   3 +
 .../util/collections/TripleLongPriorityQueue.java  | 225 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   4 +
 .../collections/TripleLongPriorityQueueTest.java   | 137 +++++++++++++
 .../pulsar/functions/instance/ContextImpl.java     |  12 ++
 .../pulsar/testclient/PerformanceProducer.java     |  31 ++-
 32 files changed, 1471 insertions(+), 48 deletions(-)

commit 59705a8ac6cc40c7950c83c42d94bb93a82638ac
Author: Kim Christian Gaarder <kim.christian.gaarder@gmail.com>
Date:   Wed May 29 18:07:37 2019 +0200

    Use same activation dependency in pulsar-client-admin and pulsar-client (#4256)
    
    * Use same activation dependency in pulsar-client-admin and pulsar-client
    
    * Broker now resolve to same activation dependency as client
    
    * Remove no-longer used activation entries from distribution license
    
    * exclude conflicting activation dependency and update license
    
    * com.sun.activation as only activation dependency in all pulsar modules
    
    * Removed activation-1.1.1.jar reference from presto LICENSE

 distribution/server/src/assemble/LICENSE.bin.txt |  2 --
 pom.xml                                          |  6 +++---
 pulsar-broker/pom.xml                            | 10 ++++++++--
 pulsar-client-admin/pom.xml                      | 24 +++++++++++++++---------
 pulsar-discovery-service/pom.xml                 |  4 ++--
 pulsar-proxy/pom.xml                             | 18 +++++++++---------
 pulsar-sql/presto-distribution/LICENSE           |  3 ---
 pulsar-sql/presto-distribution/pom.xml           |  4 ++++
 8 files changed, 41 insertions(+), 30 deletions(-)

commit dc0f398af1188e40cdaa10944ff33a96c4198dde
Author: tuteng <eguangning@gmail.com>
Date:   Wed May 29 23:50:09 2019 +0800

    [issue 4389][pulsar-client-cpp]Fix rpm package failed (#4393)
    
    * Fix rpm package failed
    
    * Add option BUILD_PYTHON_WRAPPER=OFF for disable build python

 pulsar-client-cpp/pkg/rpm/SPECS/pulsar-client.spec | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 84abb6ca728f579fdb19c1999031e05262cb43f8
Author: lipenghui <penghui@apache.org>
Date:   Wed May 29 23:49:36 2019 +0800

    Disable backlog quota check by default. (#4320)
    
    * [broker-conf] Change broker level backlog quota retention policy to consumer_backlog_eviction.
    
    * disable backlog quota check by default.
    
    * Fix unit tests.
    
    * SET default backlogQuotaDefaultLimitGB=-1
    
    * ADD disable backlog quota check for checkQuotas().

 conf/broker.conf                                                     | 4 ++--
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java | 5 +++--
 .../java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java     | 3 +++
 .../main/java/org/apache/pulsar/broker/service/BrokerService.java    | 3 +++
 4 files changed, 11 insertions(+), 4 deletions(-)

commit ad707397fb58689eab1191868ac52ef0995381a9
Author: Yijie Shen <henry.yijieshen@gmail.com>
Date:   Wed May 29 23:47:53 2019 +0800

    InterruptedException as cause in pulsar-client-admin (#4402)

 .../admin/internal/NonPersistentTopicsImpl.java    | 14 ++++----
 .../pulsar/client/admin/internal/TopicsImpl.java   | 42 +++++++++++-----------
 2 files changed, 28 insertions(+), 28 deletions(-)

commit 3b33c668e194421aed23873c26e9b7e8bcbd9d9f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 29 08:31:47 2019 -0700

    Configure static PulsarByteBufAllocator to handle OOM errors (#4196)
    
    * Configure static PulsarByteBufAllocator to handle OOM errors
    
    * Always specify `pulsar.allocator.exit_on_oom` when starting pulsar services
    
    * Reverted metrics back
    
    * Fixed compression tests
    
    * Explicitely set the underlying allocator to netty default
    
    * Fixed shading

 conf/pulsar_env.sh                                 |  2 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  5 +-
 pom.xml                                            | 11 ++-
 .../org/apache/pulsar/PulsarBrokerStarter.java     |  8 +-
 .../pulsar/broker/BookKeeperClientFactoryImpl.java | 10 ++-
 .../broker/admin/impl/PersistentTopicsBase.java    |  6 +-
 .../pulsar/broker/service/BrokerService.java       |  7 +-
 .../pulsar/client/impl/RawBatchConverter.java      |  5 +-
 .../apache/pulsar/client/impl/RawMessageImpl.java  | 10 +--
 .../service/PersistentMessageFinderTest.java       | 10 +--
 pulsar-client-admin-shaded/pom.xml                 |  5 ++
 pulsar-client-all/pom.xml                          |  5 ++
 .../pulsar-client-kafka-shaded/pom.xml             |  5 ++
 pulsar-client-shaded/pom.xml                       |  5 ++
 .../pulsar/client/impl/BatchMessageContainer.java  | 13 ++--
 .../apache/pulsar/client/impl/ConnectionPool.java  | 28 +++----
 .../apache/pulsar/client/impl/MessageCrypto.java   |  6 +-
 pulsar-common/pom.xml                              |  5 ++
 .../common/allocator/PulsarByteBufAllocator.java   | 91 ++++++++++++++++++++++
 .../org/apache/pulsar/common/api/Commands.java     | 10 +--
 .../common/compression/CompressionCodecLZ4.java    | 11 ++-
 .../common/compression/CompressionCodecZLib.java   | 11 +--
 .../common/compression/CompressionCodecZstd.java   |  7 +-
 .../org/apache/pulsar/common/stats/JvmMetrics.java | 23 +++---
 .../apache/pulsar/common/api/ByteBufPairTest.java  | 10 +--
 .../pulsar/common/compression/CommandsTest.java    | 14 ++--
 .../common/compression/CompressorCodecTest.java    | 12 +--
 .../pulsar/discovery/service/DiscoveryService.java | 25 +++---
 .../pulsar/proxy/server/DirectProxyHandler.java    | 39 +++++-----
 .../apache/pulsar/proxy/server/ProxyService.java   |  6 +-
 .../pulsar/testclient/ManagedLedgerWriter.java     |  5 +-
 .../apache/pulsar/websocket/stats/JvmMetrics.java  | 18 -----
 .../impl/BlobStoreBackedInputStreamImpl.java       |  4 +-
 .../jcloud/impl/BlobStoreBackedReadHandleImpl.java |  6 +-
 .../impl/BlockAwareSegmentInputStreamImpl.java     |  9 ++-
 .../offload/jcloud/impl/DataBlockHeaderImpl.java   |  6 +-
 .../offload/jcloud/impl/OffloadIndexBlockImpl.java |  8 +-
 37 files changed, 290 insertions(+), 171 deletions(-)

commit 9ba125996f21acdd8f50a51bcd40a7a6eb0a6583
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 28 18:29:44 2019 -0700

    Fix C++ consumer unsubscribe when regex doesn't match (#4362)
    
    * Fix C++ consumer unsubscribe when regex doesn't match
    
    * Fixed formatting

 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc |  6 ++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 18 ++++++++++++++++++
 2 files changed, 24 insertions(+)

commit 834ca6af60a97ea17f90614c7db6a5b45ed2ad31
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 28 14:15:01 2019 -0700

    Replicated subscriptions - Create snapshots (#4354)
    
    * Replicated subscriptions - Create snapshots
    
    * Added clock and unit tests for snapshot builder

 conf/broker.conf                                   |   9 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  15 ++
 .../apache/pulsar/broker/service/Replicator.java   |   2 +
 .../nonpersistent/NonPersistentReplicator.java     |   6 +
 .../service/persistent/PersistentReplicator.java   |  46 ++++-
 .../broker/service/persistent/PersistentTopic.java |  58 +++++-
 .../ReplicatedSubscriptionsController.java         | 201 ++++++++++++++++++
 .../ReplicatedSubscriptionsSnapshotBuilder.java    | 137 +++++++++++++
 ...ReplicatedSubscriptionsSnapshotBuilderTest.java | 228 +++++++++++++++++++++
 .../org/apache/pulsar/common/api/Commands.java     |   8 +
 10 files changed, 703 insertions(+), 7 deletions(-)

commit 46cffb9af6b3275572c66420b121c6d613b64f9f
Author: Like <ke.like@outlook.com>
Date:   Wed May 29 04:52:22 2019 +0800

    Remove query parameter authoritative for partitions API (#4269)
    
    * Remove query parameter authoritative for partitions API
    
    * Fix tests
    
    * Fix test failure
    
    * Fix test

 .../org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java    | 2 +-
 .../java/org/apache/pulsar/broker/admin/v1/NonPersistentTopics.java  | 2 +-
 .../java/org/apache/pulsar/broker/admin/v1/PersistentTopics.java     | 4 ++--
 .../java/org/apache/pulsar/broker/admin/v2/NonPersistentTopics.java  | 4 +---
 .../java/org/apache/pulsar/broker/admin/v2/PersistentTopics.java     | 5 ++---
 .../src/test/java/org/apache/pulsar/broker/admin/AdminTest.java      | 2 +-
 .../java/org/apache/pulsar/broker/admin/PersistentTopicsTest.java    | 2 +-
 7 files changed, 9 insertions(+), 12 deletions(-)

commit 330b75e63ff1523ec06ef47083f654812b10e0a5
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue May 28 13:51:48 2019 -0700

    update sinks and sources documentation (#4388)

 site/docs/latest/io/quickstart.md    | 12 ++++----
 site2/docs/io-cdc-canal.md           |  2 +-
 site2/docs/io-cdc-debezium.md        |  2 +-
 site2/docs/io-managing.md            | 20 ++++++-------
 site2/docs/io-quickstart.md          | 42 +++++++++++++--------------
 site2/docs/reference-pulsar-admin.md | 56 ++++++++++++++++++------------------
 site2/docs/sql-getting-started.md    |  2 +-
 7 files changed, 68 insertions(+), 68 deletions(-)

commit 6f4ed39bdbf23eb6ab816d631f2a266022764353
Author: Like <ke.like@outlook.com>
Date:   Wed May 29 02:59:22 2019 +0800

    Avoid to create map object for Flume source (#4369)

 .../org/apache/pulsar/io/flume/sink/AbstractSink.java   | 11 ++++-------
 .../org/apache/pulsar/io/flume/sink/SourceOfFlume.java  | 17 ++++-------------
 2 files changed, 8 insertions(+), 20 deletions(-)

commit dc0463cdf63eec0c9e2773926c6f362b27b02b42
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed May 29 02:50:25 2019 +0800

    Added support for Snappy compression for Python/Go (#4319)
    
    * Added support for Snappy compression for Python/Go.
    
    * Fix python test
    
    * Fix python test
    
    * just rm python test

 pulsar-client-cpp/python/pulsar/__init__.py |  4 +++-
 pulsar-client-cpp/python/src/enums.cc       |  1 +
 pulsar-client-go/pulsar/producer.go         |  5 +++++
 pulsar-client-go/pulsar/producer_test.go    | 29 +++++++++++++++++++++++++++++
 site2/docs/client-libraries-go.md           |  2 +-
 5 files changed, 39 insertions(+), 2 deletions(-)

commit 28c5503d7089ada198c271fc41664ee3d546f667
Author: Lay <1048940898@qq.com>
Date:   Wed May 29 02:48:36 2019 +0800

    resolve a null pointer ex (#4378)
    
    * resolve a nullPointer ex
    
    *  renaming sinks and sources api to be consistent with the rest of Pulsar (#4363)
    
    * Rename sources and sinks CLI to be consistent with rest of Pulsar
    
    * renaming sinks and sources api to be consistent with the rest of Pulsar
    
    * use new interfaces in cmd
    
    * Fix install pip (#4387)
    
    ### Motivation
    There is a problem with the current installation of pip when running the integration tests.
    Therefore, install pip using the officially recommended method.
    
    ### Modifications
    
    Modify the pip installation method, refer to https://pip.pypa.io/en/stable/installing/

 .../src/main/java/org/apache/pulsar/client/impl/MessageImpl.java        | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e5873ef26259c1d4e0e0b61ae4a6548b503f9718
Author: Sijie Guo <sijie@apache.org>
Date:   Wed May 29 02:32:16 2019 +0800

    Use at least 8 threads in Jetty thread pool in pulsar proxy (#4375)
    
    fixes #4359
    
    same as #3776
    
    Use at least 8 threads to avoid having Jetty go into threads starving and
    having the possibility of getting into a deadlock where a Jetty thread is
    waiting for another HTTP call to complete in same thread.

 .../main/java/org/apache/pulsar/proxy/server/ProxyConfiguration.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8ab6b1bf34e0e5653e68a53e47c2942a47675c24
Author:  <ranxiaolong716@gmail.com>
Date:   Tue May 28 20:11:19 2019 +0800

    [cpp client]support key shared for cpp client (#4366)
    
    support key shared for cpp client

 pulsar-client-cpp/include/pulsar/ConsumerType.h     |  8 +++++++-
 pulsar-client-cpp/include/pulsar/Message.h          | 15 +++++++++++++++
 pulsar-client-cpp/include/pulsar/MessageBuilder.h   |  8 +++++++-
 .../include/pulsar/c/consumer_configuration.h       |  8 +++++++-
 pulsar-client-cpp/include/pulsar/c/message.h        | 15 ++++++++++++++-
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.cc    |  2 ++
 pulsar-client-cpp/lib/ConsumerImpl.cc               |  3 +++
 pulsar-client-cpp/lib/Message.cc                    | 14 ++++++++++++++
 pulsar-client-cpp/lib/MessageBuilder.cc             |  6 ++++++
 pulsar-client-cpp/lib/MessageImpl.cc                |  6 ++++++
 pulsar-client-cpp/lib/MessageImpl.h                 |  4 ++++
 pulsar-client-cpp/lib/c/c_Message.cc                | 10 ++++++++++
 .../tests/ConsumerConfigurationTest.cc              | 21 +++++++++++++++++++++
 13 files changed, 116 insertions(+), 4 deletions(-)

commit 7a2109427c174207ec3f7f2060ce30bf7e0a2990
Author: lipenghui <penghui@apache.org>
Date:   Tue May 28 20:09:49 2019 +0800

    Fix bug of Key_Shared Ordering (#4372)
    
    Fix bug of Key_Shared ordering and add check for order by key, key distribution, message redelivery in Key_Shared subscription mode.

 .../HashRangeStickyKeyConsumerSelector.java        |   6 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   2 +-
 .../broker/service/StickyKeyConsumerSelector.java  |   1 -
 .../PersistentDispatcherMultipleConsumers.java     |   1 -
 ...istentStickyKeyDispatcherMultipleConsumers.java |  38 +-
 .../client/api/KeySharedSubscriptionTest.java      | 455 ++++++++++-----------
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   3 +-
 7 files changed, 252 insertions(+), 254 deletions(-)

commit e359fa490eaa6cd18f1343e78a626a042e72a3d8
Author: tuteng <eguangning@gmail.com>
Date:   Tue May 28 16:28:34 2019 +0800

    Fix install pip (#4387)
    
    ### Motivation
    There is a problem with the current installation of pip when running the integration tests.
    Therefore, install pip using the officially recommended method.
    
    ### Modifications
    
    Modify the pip installation method, refer to https://pip.pypa.io/en/stable/installing/

 docker/pulsar/Dockerfile | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit aa40ad6ddeb4208d439df2c9080fc73b1e6ffa3b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun May 26 21:48:16 2019 -0700

     renaming sinks and sources api to be consistent with the rest of Pulsar (#4363)
    
    * Rename sources and sinks CLI to be consistent with rest of Pulsar
    
    * renaming sinks and sources api to be consistent with the rest of Pulsar
    
    * use new interfaces in cmd

 pulsar-broker/pom.xml                              |   4 +-
 .../admin/impl/{SinkBase.java => SinksBase.java}   |  10 +-
 .../impl/{SourceBase.java => SourcesBase.java}     |  12 +-
 .../org/apache/pulsar/broker/admin/v3/Sink.java    |   8 +-
 .../org/apache/pulsar/broker/admin/v3/Sinks.java   |  34 ++
 .../org/apache/pulsar/broker/admin/v3/Source.java  |   8 +-
 .../org/apache/pulsar/broker/admin/v3/Sources.java |  34 ++
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  38 ++-
 .../java/org/apache/pulsar/client/admin/Sink.java  | 329 +------------------
 .../java/org/apache/pulsar/client/admin/Sinks.java | 350 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Source.java     | 330 +------------------
 .../org/apache/pulsar/client/admin/Sources.java    | 350 +++++++++++++++++++++
 .../internal/{SinkImpl.java => SinksImpl.java}     |   5 +-
 .../internal/{SourceImpl.java => SourcesImpl.java} |   5 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  36 +--
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  36 +--
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |  29 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |   8 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   8 +-
 .../pulsar/functions/worker/rest/Resources.java    |  12 +-
 .../rest/api/{SinkImpl.java => SinksImpl.java}     |   4 +-
 .../rest/api/{SourceImpl.java => SourcesImpl.java} |   4 +-
 ...V2Resource.java => FunctionsApiV2Resource.java} |   4 +-
 ...V3Resource.java => FunctionsApiV3Resource.java} |   4 +-
 .../worker/rest/api/v3/SinkApiV3Resource.java      | 224 +------------
 .../worker/rest/api/v3/SinksApiV3Resource.java     | 241 ++++++++++++++
 .../worker/rest/api/v3/SourceApiV3Resource.java    | 228 +-------------
 .../worker/rest/api/v3/SourcesApiV3Resource.java   | 257 +++++++++++++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   2 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |   5 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |   8 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   8 +-
 32 files changed, 1448 insertions(+), 1187 deletions(-)

commit e17506d3ea2088b221d33dfd0ac9666d2ae4313a
Author: Like <ke.like@outlook.com>
Date:   Sun May 26 20:18:04 2019 +0800

    Clean up deprecated Zookeeper client (#4306)
    
    The Zookeeper client related classes are already deprecated and not used any more. We can clean up now.

 .../bookkeeper/zookeeper/BkZooKeeperClient.java    | 1365 --------------------
 .../apache/bookkeeper/zookeeper/BkZooWorker.java   |  162 ---
 .../util/BkReadOnlyZookeeperClientFactoryImpl.java |   74 --
 3 files changed, 1601 deletions(-)

commit a22af90629654416aa2023ccafa411ff2bfc527d
Author: Graud Dug de Bernonville <geraudster@gmail.com>
Date:   Sun May 26 14:16:51 2019 +0200

    [pulsar-io-elastic-search] Change default document type for compliance with ES 7.x (#4322)
    
    ### Motivation
    
    When running Elasticsearch sink on ES 7.0.1, message indexation fails with the following error :
    
    ```
    - Encountered exception in sink write:
    org.elasticsearch.ElasticsearchStatusException: Elasticsearch exception [type=illegal_argument_exception, reason=Rejecting mapping update to [geoloc-pulsar] as the final mapping would have more than 1 type: [_doc, doc]]
    ```
    
    According to https://www.elastic.co/guide/en/elasticsearch/reference/6.3/removal-of-types.html#_schedule_for_removal_of_mapping_types, the recommended document type to use is `_doc`.
    
    ### Modifications
    
    Replace document type `doc` with recommended value `_doc`.

 .../main/java/org/apache/pulsar/io/elasticsearch/ElasticSearchSink.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f9ab535b0c3da37f3918aad7f565cac2353ce852
Author: Like <ke.like@outlook.com>
Date:   Sun May 26 18:10:19 2019 +0800

    Remove redundant SuppressWarnings (#4371)

 .../main/java/org/apache/pulsar/functions/instance/ContextImpl.java    | 3 ---
 1 file changed, 3 deletions(-)

commit 7924846211e7796f4b17529353380e2e85664bf4
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Sun May 26 17:24:16 2019 +0800

    [Doc] Add *Connect Pulsar to MySQL* (#4338)
    
    Fix #4073

 site2/docs/functions-api.md        |   4 +-
 site2/docs/functions-quickstart.md |   4 +-
 site2/docs/io-quickstart.md        | 570 ++++++++++++++++++++++++++++++-------
 site2/docs/sql-getting-started.md  |   4 +-
 site2/website/sidebars.json        |   2 +-
 5 files changed, 473 insertions(+), 111 deletions(-)

commit ddb100a6e0dc81f5c5db6624c855d93851e51b5a
Author: se7enkings <se7enkings@users.noreply.github.com>
Date:   Sun May 26 16:23:35 2019 +0800

    fix cluster_url which may be set as a list (#4349)
    
    If the service_url is set to http://{server-1}:8080,{server-2}:8080,{server-3}:8080 when initialize-cluster-metadata, the cluster_url will be "{server-1}:8080,{server-2}:8080,{server-3}:8080".
    And the string "{server-1}:8080,{server-2}:8080,{server-3}:8080" isn't a standard url.
    
    * fix culster_url which may be set as a list
    
    * use random to select service_url

 dashboard/django/collector.py | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit feca5bbb8b672fc84281ff1905b4ac010c0c405f
Author: Like <ke.like@outlook.com>
Date:   Sun May 26 10:17:09 2019 +0800

    Delete schema when deleting inactive topic (#4262)
    
    Currently, we ignore the schema defined for a topic even the topic has been deleted as it's not active any more, this PR will delete the related schema as well when deleting an inactive topic. And also, remove a Subscription for NonPersistentTopic if unsubscribe called.

 .../org/apache/pulsar/broker/service/Topic.java    |   5 +
 .../service/nonpersistent/NonPersistentTopic.java  |  45 ++++---
 .../broker/service/persistent/PersistentTopic.java |  38 ++++--
 .../broker/service/NonPersistentTopicE2ETest.java  | 133 +++++++++++++++++++++
 .../broker/service/PersistentTopicE2ETest.java     |  83 +++++++++++++
 5 files changed, 281 insertions(+), 23 deletions(-)

commit f8349e2235a340a1ee9a416a07a4d2648dfe4f52
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 24 17:37:43 2019 -0700

    Expose state to sources and sinks (#4364)
    
    * Expose state to sources and sinks
    
    * Fix unittest
    
    * Fix unittest

 .../apache/pulsar/io/common/IOConfigUtilsTest.java | 79 ++++++++++++++++++++++
 .../org/apache/pulsar/io/core/SinkContext.java     | 69 +++++++++++++++++++
 .../org/apache/pulsar/io/core/SourceContext.java   | 70 +++++++++++++++++++
 .../io/kafka/sink/KafkaAbstractSinkTest.java       | 42 ++++++++++++
 .../io/kafka/source/KafkaAbstractSourceTest.java   | 42 ++++++++++++
 5 files changed, 302 insertions(+)

commit 7cadc93c94c3d08ed6e3544d7812398f40152ee7
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri May 24 16:34:00 2019 -0700

    shade additional dependencies in java-instance.jar (#4356)
    
    * shade more dependencies in java-instance.jar
    
    * shade additional

 pulsar-functions/runtime-all/pom.xml | 262 +++++++++++++++++++++++++++++------
 1 file changed, 219 insertions(+), 43 deletions(-)

commit 5d688eec2596a784254e0580e865fbf287963915
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 24 16:06:03 2019 -0700

    Fixed the display of schema information (#4318)
    
    * Fixed the display of schema information
    
    * Fixed test
    
    * Took feedback into account
    
    * Use SchemaInfo.getSchemaDefinition to get information about schema
    
    * Reverted the rest api changes
    
    * Fixed integration test

 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  1 -
 .../org/apache/pulsar/admin/cli/CmdSchemas.java    | 28 ++++++++++++++++++++--
 .../pulsar/tests/integration/cli/CLITest.java      |  2 +-
 3 files changed, 27 insertions(+), 4 deletions(-)

commit 27eb5cac48a52c69966a68e8391ba3d4b9e3f98f
Author: hapihu <w.gh123@qq.com>
Date:   Sat May 25 05:27:48 2019 +0800

    [pulsar-broker] When calling Logger's method, set the appropriate parameters.(#4350) (#4351)

 .../main/java/org/apache/pulsar/broker/admin/impl/ClustersBase.java | 2 +-
 .../java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java    | 6 +++---
 .../main/java/org/apache/pulsar/broker/loadbalance/LoadManager.java | 2 +-
 3 files changed, 5 insertions(+), 5 deletions(-)

commit 71f3928722fc702f2f8699c68dd7262d53d0a630
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Fri May 24 13:48:06 2019 -0300

    Bugfix - release and recycle on discarded messages (#4342)
    
    Don't leak resources when a message is being discarded.
    
    *Modifications*
    
      - Fix missing release() and recycle() for discarded message on
        receiveIndividualMessagesFromBatch method.
      - Fix argument missing of debug logging {}-placeholder.
      - Fix unnecessary variable reference `payload` on messageReceived().

 .../java/org/apache/pulsar/client/impl/ConsumerImpl.java   | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

commit b16132870d6695a2ef07427003679a2431b704af
Author: lipenghui <penghui@apache.org>
Date:   Fri May 24 21:58:04 2019 +0800

    Add messaging integration tests for different subscriptions. (#4352)
    
    * Add messaging integration tests.
    
    * Add messaging integration tests.
    
    * remove unused consumer from consumer range map.
    
    * put all messages to pendingAcks before write messages to ctx.
    
    * check entry != null

 .../org/apache/pulsar/broker/service/Consumer.java |  17 +-
 .../HashRangeStickyKeyConsumerSelector.java        |  12 +-
 .../HashRangeStickyKeyConsumerSelectorTest.java    |  16 +-
 .../tests/integration/messaging/MessagingBase.java | 164 +++++++
 .../messaging/NonPersistentTopicMessagingTest.java |  66 +++
 .../messaging/PersistentTopicMessagingTest.java    |  66 +++
 .../integration/messaging/TopicMessagingBase.java  | 491 +++++++++++++++++++++
 .../integration/topologies/PulsarCluster.java      |   6 +
 8 files changed, 831 insertions(+), 7 deletions(-)

commit 009bc292e487089f8f86b654de6718f899f1a8fd
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 23 23:54:49 2019 -0700

    merge windowing code back into function instance (#4332)

 pulsar-functions/instance/pom.xml                  |  6 --
 .../windowing/DefaultEvictionContext.java          |  0
 .../apache/pulsar/functions/windowing/Event.java   |  0
 .../pulsar/functions/windowing/EventImpl.java      |  0
 .../functions/windowing/EvictionContext.java       |  0
 .../pulsar/functions/windowing/EvictionPolicy.java |  0
 .../functions/windowing/TimestampExtractor.java    |  0
 .../pulsar/functions/windowing/TriggerHandler.java |  0
 .../pulsar/functions/windowing/TriggerPolicy.java  |  0
 .../pulsar/functions/windowing/WaterMarkEvent.java |  0
 .../windowing/WaterMarkEventGenerator.java         |  0
 .../apache/pulsar/functions/windowing/Window.java  |  0
 .../functions/windowing/WindowContextImpl.java     |  0
 .../windowing/WindowFunctionExecutor.java          |  0
 .../pulsar/functions/windowing/WindowImpl.java     |  0
 .../windowing/WindowLifecycleListener.java         |  0
 .../pulsar/functions/windowing/WindowManager.java  |  0
 .../pulsar/functions/windowing/WindowUtils.java    |  0
 .../windowing/evictors/CountEvictionPolicy.java    |  0
 .../windowing/evictors/TimeEvictionPolicy.java     |  0
 .../evictors/WatermarkCountEvictionPolicy.java     |  0
 .../evictors/WatermarkTimeEvictionPolicy.java      |  0
 .../windowing/triggers/CountTriggerPolicy.java     |  0
 .../windowing/triggers/TimeTriggerPolicy.java      |  0
 .../triggers/WatermarkCountTriggerPolicy.java      |  0
 .../triggers/WatermarkTimeTriggerPolicy.java       |  0
 .../windowing/WaterMarkEventGeneratorTest.java     |  0
 .../windowing/WindowFunctionExecutorTest.java      |  0
 .../functions/windowing/WindowManagerTest.java     |  0
 pulsar-functions/pom.xml                           |  1 -
 pulsar-functions/windowing/pom.xml                 | 65 ----------------------
 31 files changed, 72 deletions(-)

commit a81d23413f85566fe4e90fd53861d64df63a0f6e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri May 24 14:30:35 2019 +0800

    [transaction][buffer] add interfaces for transaction buffer and an in-memory implementation (#4165)
    
    Master Issue: #2664
    
    *Motivation*
    
    Setup the project structure for developing transaction buffer.
    
    *Changes*
    
    - setup the project structure
    - introduce common classes: `TxnID`, `TxnStatus`
    - introduce `TransactionBuffer` for broker to store and manage entries for transactions
    - enable checkstyle for `pulsar-transaction`
    
    *NOTES*
    
    All the changes are isolated into `pulsar-transaction` module. Hence it will not block any other changes or releases.

 pulsar-transaction/buffer/pom.xml                  |  57 ++++
 .../transaction/buffer/TransactionBuffer.java      | 131 ++++++++++
 .../buffer/TransactionBufferProvider.java          |  62 +++++
 .../buffer/TransactionBufferReader.java            |  51 ++++
 .../transaction/buffer/TransactionEntry.java       |  72 +++++
 .../pulsar/transaction/buffer/TransactionMeta.java |  52 ++++
 .../exceptions/EndOfTransactionException.java      |  31 +++
 .../exceptions/TransactionBufferException.java     |  39 +++
 .../exceptions/TransactionNotFoundException.java   |  31 +++
 .../exceptions/TransactionNotSealedException.java  |  31 +++
 .../exceptions/TransactionSealedException.java     |  33 +++
 .../exceptions/UnexpectedTxnStatusException.java   |  37 +++
 .../buffer/exceptions/package-info.java            |  22 ++
 .../buffer/impl/InMemTransactionBuffer.java        | 291 +++++++++++++++++++++
 .../impl/InMemTransactionBufferProvider.java       |  33 +++
 .../buffer/impl/InMemTransactionBufferReader.java  |  97 +++++++
 .../buffer/impl/TransactionEntryImpl.java          |  79 ++++++
 .../transaction/buffer/impl/package-info.java      |  22 ++
 .../pulsar/transaction/buffer/package-info.java    |  22 ++
 .../impl/InMemTransactionBufferReaderTest.java     | 152 +++++++++++
 .../buffer/impl/TransactionBufferTest.java         | 280 ++++++++++++++++++++
 .../buffer/impl/TransactionEntryImplTest.java      |  49 ++++
 pulsar-transaction/common/pom.xml                  |   2 +-
 pulsar-transaction/pom.xml                         |   1 +
 24 files changed, 1676 insertions(+), 1 deletion(-)

commit 92f0cee05cdaabf4975ff1ea82c6f8740634f0dc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 23 22:23:10 2019 -0700

    add get message method in Record interface (#4341)

 .../src/main/java/org/apache/pulsar/functions/api/Record.java       | 6 ++++++
 .../main/java/org/apache/pulsar/functions/source/PulsarRecord.java  | 5 +++++
 2 files changed, 11 insertions(+)

commit d6c281355d0d6a99ac4a42aa5317b6a690c8a1f7
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 23 11:20:24 2019 -0700

    Replicated subscriptions - Markers protobuf (#4340)
    
    * Replicated subscriptions - Markers protobuf
    
    * Added license check exclusions for generated code

 pom.xml                                            |    3 +-
 .../broker/service/AbstractBaseDispatcher.java     |    5 +-
 .../org/apache/pulsar/broker/service/Consumer.java |    2 +
 pulsar-common/generate_protobuf.sh                 |    1 +
 pulsar-common/generate_protobuf_docker.sh          |    2 +-
 .../java/org/apache/pulsar/common/api/Markers.java |  251 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  |   71 +-
 .../pulsar/common/api/proto/PulsarMarkers.java     | 2988 ++++++++++++++++++++
 .../pulsar/common/api/raw/MessageParser.java       |    5 +
 pulsar-common/src/main/proto/PulsarApi.proto       |    6 +-
 pulsar-common/src/main/proto/PulsarMarkers.proto   |   80 +
 .../org/apache/pulsar/common/api/MarkersTest.java  |  118 +
 12 files changed, 3520 insertions(+), 12 deletions(-)

commit f82441018ac21a81f2bbbf8a11e5d29c22a3197b
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Thu May 23 17:39:57 2019 +0800

    `rereplicationEntryBatchSize` should be smaller than `maxPendingReadR (#4314)
    
    Fixes #4213

 conf/bookkeeper.conf                                                 | 2 +-
 .../src/main/java/org/apache/pulsar/PulsarBrokerStarter.java         | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 4f9eecca4d28985c7fe6c18a158254675f1a9f31
Author: Lars Levie <larslevie@gmail.com>
Date:   Wed May 22 23:58:04 2019 -0500

    [docs] Mention GCS when going over Tiered Storage in docs (#4343)
    
    * Mention GCS when going over Tiered Storage
    
    * Minor re-wording

 site2/docs/concepts-tiered-storage.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e50c829f7cfc8f631066c42292da649553cc10ce
Author: lipenghui <penghui@apache.org>
Date:   Thu May 23 12:02:22 2019 +0800

    [broker] fix bug of can't dispatch messages to other consumers while a consume crash. (#4335)
    
    Describe the bug
    Use key_shared subscription, while a consumer crash, message cannot be dispatched correctly.
    
    To Reproduce
    
    start consumer1
    start consumer2
    start consumer3
    send message
    close consumer1
    close consumer2
    Expected behavior
    Messages can also be received in full.
    
    Actual behavior
    Unable to receive part of messages that the range originally responsible for consumer2.

 .../HashRangeStickyKeyConsumerSelector.java        |  7 +-
 .../client/api/KeySharedSubscriptionTest.java      | 94 ++++++++++++++++++++++
 2 files changed, 98 insertions(+), 3 deletions(-)

commit cb34e6a51af58225ab7b62a6afec916768654f24
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 22 11:24:56 2019 -0700

    Moved entries filtering from consumer to dispatcher (#4329)
    
    * Moved entries filtering from consumer to dispatcher
    
    * Optimize when all messages were filtered out
    
    * Fixed pending adds adding and re-added check for older consumers
    
    * Fixed reusing of thread local from different thread
    
    * Pass the redelivery tracker to consumer.sendMessages()

 .../broker/service/AbstractBaseDispatcher.java     |  96 +++++++++++
 .../AbstractDispatcherMultipleConsumers.java       |  11 +-
 .../AbstractDispatcherSingleActiveConsumer.java    |   5 +-
 .../org/apache/pulsar/broker/service/Consumer.java | 185 +++++----------------
 .../pulsar/broker/service/EntryBatchSizes.java     |  58 +++++++
 .../pulsar/broker/service/SendMessageInfo.java     |  47 ++++++
 .../NonPersistentDispatcherMultipleConsumers.java  |  16 +-
 ...onPersistentDispatcherSingleActiveConsumer.java |  16 +-
 .../PersistentDispatcherMultipleConsumers.java     |  32 ++--
 .../PersistentDispatcherSingleActiveConsumer.java  |  73 ++++----
 ...istentStickyKeyDispatcherMultipleConsumers.java |  37 +++--
 .../service/persistent/PersistentSubscription.java |   8 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |  12 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   4 +-
 .../org/apache/pulsar/common/api/Commands.java     |  32 ++++
 15 files changed, 407 insertions(+), 225 deletions(-)

commit bf06ef3ebeccfe758a3db1724bac62dd99a060de
Author: Sijie Guo <sijie@apache.org>
Date:   Thu May 23 00:23:37 2019 +0800

    [schema] AutoConsume should use the schema associated with messages as both writer and reader schema (#4325)
    
    * [schema] AutoConsume should use the schema associated with messages for both writer and reader schema
    
    *Motivation*
    
    AutoConsume should use the schema associated with the messages for decoding the schemas.
    
    *Modifications*
    
    - provide a flag enable or disable using the provided schema as the reader schema
    - for AUTO_CONSUME schema, disable usnig the provided schema as the reader schema. so it can use the right
      schema version for decoding messages into right generic records
    - provide a few util methods for displaying schema data
    
    * Handle 64 bytes schema version
    
    * Addressed review comments

 .../apache/pulsar/common/schema/SchemaInfo.java    |  18 +++
 .../pulsar/client/impl/PulsarClientImpl.java       |  11 +-
 .../pulsar/client/impl/schema/AvroSchema.java      |   9 +-
 .../pulsar/client/impl/schema/JSONSchema.java      |   1 -
 .../pulsar/client/impl/schema/ProtobufSchema.java  |   4 +-
 .../pulsar/client/impl/schema/SchemaUtils.java     |  22 +++-
 .../pulsar/client/impl/schema/StructSchema.java    |   6 +
 .../impl/schema/generic/GenericAvroSchema.java     |  23 +++-
 .../impl/schema/generic/GenericJsonSchema.java     |  29 ++++-
 .../impl/schema/generic/GenericSchemaImpl.java     |  17 ++-
 .../integration/cli/SchemaUpdateStrategyTest.java  | 140 ++++++++++++++++++---
 11 files changed, 245 insertions(+), 35 deletions(-)

commit 527995b5d42bf5c544bc1670b2801a2510d3c17e
Author:  <ranxiaolong716@gmail.com>
Date:   Wed May 22 23:44:31 2019 +0800

    replace CreateTypedProducer() with CreateProducerWithSchema() (#4336)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/schema_test.go | 24 ++++++++++++------------
 1 file changed, 12 insertions(+), 12 deletions(-)

commit dea890ab3dce29ba16499006ba1d44eef991d096
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed May 22 17:49:20 2019 +0800

    [docs] Documentation on configuring functions runtime (#4263)
    
    * [docs] Documentation on configuring functions runtime
    
    * Improve the documentation and add the page to sidebar

 site2/docs/functions-runtime.md | 139 ++++++++++++++++++++++++++++++++++++++++
 site2/website/sidebars.json     |   3 +-
 2 files changed, 141 insertions(+), 1 deletion(-)

commit 0ad64b1925f3364a102e6ef6ebdb0c8c615fa49e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed May 22 11:25:53 2019 +0800

    [schema] Schema version is 8 bytes long (#4327)
    
    *Motivation*
    
    The schema version is actually only 8 bytes long but we allocated 64 bytes for it.
    
    *Modification*
    
    Allocate 8 bytes for schema version.

 .../pulsar/broker/admin/v2/SchemasResource.java    |  2 +-
 .../service/schema/BookkeeperSchemaStorage.java    |  6 ++++++
 .../broker/service/schema/LongSchemaVersion.java   |  2 +-
 .../schema/BookkeeperSchemaStorageTest.java        | 25 +++++++++++++++++++++-
 4 files changed, 32 insertions(+), 3 deletions(-)

commit a98c846243760a780748d15209c12c5471f1ae77
Author: tuteng <eguangning@gmail.com>
Date:   Wed May 22 09:56:51 2019 +0800

    [pulsar-broker]Support key value schema compatibility checker (#4192)
    
    Motivation
    The key/value types can be AVRO or JSON. Both AVRO and JSON supports schema evolution. We should add a key/value schema compatibility checker to allow schema evolution in broker side.
    
    Modifications
    Add KeyValueSchemaCompatibilityCheck class
    Add Unit Test
    
    Verifying this change
    Unit Test Pass

 .../schema/KeyValueSchemaCompatibilityCheck.java   | 130 ++++++
 .../service/schema/SchemaRegistryService.java      |   2 +
 .../KeyValueSchemaCompatibilityCheckTest.java      | 500 +++++++++++++++++++++
 .../integration/functions/PulsarFunctionsTest.java |   4 +-
 .../integration/io/DebeziumMySqlSourceTester.java  |  11 +-
 5 files changed, 643 insertions(+), 4 deletions(-)

commit 0d700a9d436d6c10804dfa90dd3620696b84b8da
Author: tuteng <eguangning@gmail.com>
Date:   Wed May 22 08:12:43 2019 +0800

    [issue 4074][pulsar-io]debezium document udpate (#4296)
    
    Fixes #4074
    
    Master Issue: #4074
    
    ### Motivation
    
    After move it out of Kafka-connect-source, debezium connector documentation need some update.
    Update debezium mysql connector.
    
    ### Modifications
    
    Move kafka-connect-adaptor to debezium-mysql

 site2/docs/io-cdc-debezium.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 5556f1b7e01040bd78c7e7736383812eb12217ad
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue May 21 11:09:43 2019 -0700

    [pulsar-broker] Cache unack-messageId into openRangeSet (#3819)
    
    * [pulsar-common] add open Concurrent LongPair RangeSet
    
    * add open-range set methods
    
    * [pulsar-broker] Cache unack-messageId into openRangeSet
    
    * add forEach
    
    * use forEach of the range
    
    * add forEach with consumer
    
    * add Recyclable Position converter
    
    * Removed unused imports after merge
    
    * address comments

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  15 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 200 ++++++++++++-------
 .../bookkeeper/mledger/impl/PositionImpl.java      |   8 +-
 .../mledger/impl/PositionImplRecyclable.java       |  50 +++++
 .../mledger/impl/ManagedCursorConcurrencyTest.java |  14 +-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 132 ++++++++----
 .../mledger/impl/ManagedLedgerFactoryTest.java     |  10 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |   6 +-
 .../pulsar/broker/service/BrokerService.java       |   2 +
 .../pulsar/client/impl/MessageRedeliveryTest.java  | 221 +++++++++++++++++++++
 12 files changed, 544 insertions(+), 120 deletions(-)

commit 1bb9a118e7be5fc7aba6fd37c2e78959fbb161fc
Author: Jia Zhai <zhaijia@apache.org>
Date:   Wed May 22 01:33:29 2019 +0800

    add kerveros into server distribution (#4316)

 distribution/server/pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit b564670d3a1b9b7eebe72484def1108d03f4f6f0
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Wed May 22 01:20:10 2019 +0800

    Add setting param in broker.conf (#4326)

 conf/broker.conf | 3 +++
 1 file changed, 3 insertions(+)

commit f0a33c4630c8d0cfeef0b7829c9b43fec3eb5997
Author: Like <ke.like@outlook.com>
Date:   Tue May 21 22:31:58 2019 +0800

    [pulsar-io] Remove unused annotation (#4303)
    
    * Remove unused annotation
    
    * Use try-resource management

 .../java/org/apache/pulsar/io/file/utils/GZipFiles.java    |  3 +--
 .../java/org/apache/pulsar/io/file/utils/ZipFiles.java     | 14 ++------------
 2 files changed, 3 insertions(+), 14 deletions(-)

commit 4d9351d2ffa4d5031e9db7194639cd286bef94da
Author: wpl <1269223860@qq.com>
Date:   Tue May 21 21:34:07 2019 +0800

    [ISSUE #4101] Fix Javadoc for ClientBuilder.keepAliveInterval
    
    Fixes #4101
    
    ### Motivation
    
    fix issue
    
    ### Modifications
    
    fix keepAliveInterval method java doc

 .../java/org/apache/pulsar/client/api/ClientBuilder.java     | 12 ++++++------
 .../org/apache/pulsar/client/impl/ClientBuilderImpl.java     |  4 ++--
 2 files changed, 8 insertions(+), 8 deletions(-)

commit 25c4dae3f479ea5478126f5fb7f66fe70e813658
Author: lipenghui <penghui@apache.org>
Date:   Tue May 21 21:32:01 2019 +0800

    [doc] Update acknowledgement and dead letter topic documentation. (#4315)
    
    Fixes #4119
    
    ### Motivation
    
    Catch up documentation of dead letter topic.

 site2/docs/concepts-messaging.md | 47 +++++++++++++++++++++++++++++++++++++---
 1 file changed, 44 insertions(+), 3 deletions(-)

commit b868bcd55642099cd64cacd17af01902ff212ce0
Author: wpl <1269223860@qq.com>
Date:   Tue May 21 19:08:29 2019 +0800

    [pulsar-io] hbase sink use BooleanSchema encode Boolean data (#4258)
    
    ### Motivation
    
    1. use pulsar client BooleanSchema encode Boolean data
    2. remove unused code.
    
    ### Modifications
    
    1. Use  BooleanSchema.encode() replace Bytes.toBytes()
    2. remove  unused code, eg:  required = false,

 .../java/org/apache/pulsar/io/hbase/HbaseAbstractConfig.java | 12 ++++--------
 .../apache/pulsar/io/hbase/sink/HbaseGenericRecordSink.java  |  4 ++--
 .../org/apache/pulsar/io/hbase/sink/HbaseSinkConfig.java     |  5 +----
 3 files changed, 7 insertions(+), 14 deletions(-)

commit 706a18e56b52468b1b48832115959983a3fffbe0
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue May 21 08:00:01 2019 +0800

    [pulsar-common] Support Snappy compression for Java (#4259)
    
    * Support Snappy compression for java.
    
    * Some minor fix to pass unit tests
    
    * Format the cpp code
    
    * Added support for c++ client
    
    * Format the cpp code

 build/docker/Dockerfile                            |  2 +-
 pom.xml                                            |  7 ++
 .../apache/pulsar/client/api/CompressionType.java  |  3 +
 .../apache/pulsar/client/api/ProducerBuilder.java  |  2 +
 pulsar-client-cpp/CMakeLists.txt                   | 14 ++++
 pulsar-client-cpp/docker/Dockerfile                |  8 +++
 pulsar-client-cpp/include/pulsar/CompressionType.h |  1 +
 .../include/pulsar/ProducerConfiguration.h         |  2 +
 pulsar-client-cpp/lib/CompressionCodec.cc          |  8 +++
 pulsar-client-cpp/lib/CompressionCodec.h           |  2 +
 pulsar-client-cpp/lib/CompressionCodecSnappy.cc    | 79 ++++++++++++++++++++++
 pulsar-client-cpp/lib/CompressionCodecSnappy.h     | 31 +++++++++
 pulsar-common/pom.xml                              |  5 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  3 +
 .../compression/CompressionCodecProvider.java      |  5 ++
 .../common/compression/CompressionCodecSnappy.java | 66 ++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  1 +
 .../common/compression/CompressorCodecTest.java    |  4 +-
 site2/docs/concepts-messaging.md                   |  1 +
 site2/docs/reference-cli-tools.md                  |  2 +-
 20 files changed, 241 insertions(+), 5 deletions(-)

commit 407c4452e904c111f0a02d1c970ac1ef9de834fc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon May 20 13:22:23 2019 -0700

    [pulsar-storm] support reader for pulsar-spout (#4236)
    
    * [pulsar-storm] pulsar-spout can use reader to read message without durable subscription
    
    * fix test

 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 132 +++++++++++++++++----
 .../pulsar/storm/PulsarSpoutConfiguration.java     |  32 +++++
 .../apache/pulsar/storm/PulsarSpoutConsumer.java   |  58 +++++++++
 .../apache/pulsar/storm/SharedPulsarClient.java    |  21 ++++
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |  67 ++++++++++-
 5 files changed, 289 insertions(+), 21 deletions(-)

commit 0c8e15fb13461bbe6042695e23f5ac73be7c2997
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon May 20 10:45:24 2019 -0700

    [pulsar-function] Fix NPE and log error when java-instance jar path not set (#4090)
    
    * [pulsar-function] Fix NPE and log error when java-instance jar path not set
    
    * fix tests
    
    * fix test

 .../functions/worker/PulsarFunctionE2ESecurityTest.java      |  7 +++++--
 .../pulsar/functions/worker/PulsarFunctionPublishTest.java   |  4 +++-
 .../pulsar/functions/worker/PulsarFunctionStateTest.java     |  4 +++-
 .../java/org/apache/pulsar/io/PulsarFunctionE2ETest.java     |  6 ++++--
 .../functions/utils/functioncache/FunctionCacheEntry.java    | 12 +++++++++++-
 5 files changed, 26 insertions(+), 7 deletions(-)

commit 93d3c5ef52ec65fcec5bd92c872726ae827aacbf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon May 20 10:45:04 2019 -0700

    [pulsar-common] add option that field can be empty (#3543)
    
    Revert "[pulsar-common] add option that field can be empty"
    
    This reverts commit e1e62bbaf0448867d9ab6af1efb23a46e4de947a.
    
    set optional param
    
    fix tests
    
    fix configs
    
    fix test
    
    fix test

 .../ProxySaslAuthenticationTest.java               |  5 +-
 .../apache/pulsar/broker/ServiceConfiguration.java | 18 +++----
 .../PulsarConfigurationLoaderTest.java             | 16 ++++--
 .../apache/pulsar/broker/SLAMonitoringTest.java    |  7 +--
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  4 +-
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   | 26 ++++-----
 .../broker/admin/BrokerAdminClientTlsAuthTest.java | 22 ++++----
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  4 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  7 ++-
 .../AntiAffinityNamespaceGroupTest.java            |  9 ++--
 .../broker/loadbalance/LoadBalancerTest.java       | 61 ++++++++++++----------
 .../loadbalance/ModularLoadManagerImplTest.java    | 42 ++++++++-------
 .../loadbalance/SimpleLoadManagerImplTest.java     |  8 +--
 .../broker/service/AdvertisedAddressTest.java      |  6 ++-
 .../broker/service/BacklogQuotaManagerTest.java    |  5 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |  5 +-
 .../pulsar/broker/service/BrokerServiceTest.java   | 16 +++---
 .../pulsar/broker/service/MaxMessageSizeTest.java  |  6 ++-
 .../pulsar/broker/service/ReplicatorTestBase.java  | 25 ++++-----
 .../apache/pulsar/broker/web/WebServiceTest.java   |  5 +-
 .../api/AuthenticatedProducerConsumerTest.java     |  5 +-
 .../AuthenticationTlsHostnameVerificationTest.java |  9 ++--
 .../pulsar/client/api/BrokerServiceLookupTest.java | 50 +++++++++---------
 .../pulsar/client/api/NonPersistentTopicTest.java  | 13 ++---
 .../pulsar/client/api/ServiceUrlProviderTest.java  | 12 +++--
 .../pulsar/client/api/TlsProducerConsumerBase.java |  5 +-
 .../service/web/DiscoveryServiceWebTest.java       |  3 +-
 .../worker/PulsarFunctionE2ESecurityTest.java      |  4 +-
 .../worker/PulsarFunctionPublishTest.java          |  8 +--
 .../functions/worker/PulsarFunctionStateTest.java  |  8 +--
 .../worker/PulsarWorkerAssignmentTest.java         |  4 +-
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |  8 +--
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  8 +--
 .../websocket/proxy/ProxyAuthenticationTest.java   |  3 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |  3 +-
 .../websocket/proxy/ProxyConfigurationTest.java    |  4 +-
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  3 +-
 .../proxy/ProxyPublishConsumeTlsTest.java          |  5 +-
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    |  3 +-
 .../proxy/v1/V1_ProxyAuthenticationTest.java       |  3 +-
 .../org/apache/pulsar/common/util/FieldParser.java | 59 ++++++++++++++++++---
 .../discovery/service/server/ServiceConfig.java    | 24 ++++-----
 .../discovery/service/BaseDiscoveryTestSetup.java  |  5 +-
 .../service/web/DiscoveryServiceWebTest.java       |  7 +--
 .../pulsar/proxy/server/ProxyConfiguration.java    | 16 +++---
 .../proxy/server/AuthedAdminProxyHandlerTest.java  | 14 ++---
 .../ProxyAuthenticatedProducerConsumerTest.java    | 13 ++---
 .../proxy/server/ProxyAuthenticationTest.java      |  5 +-
 .../server/ProxyConnectionThrottlingTest.java      |  4 +-
 .../proxy/server/ProxyForwardAuthDataTest.java     |  5 +-
 .../proxy/server/ProxyLookupThrottlingTest.java    |  4 +-
 .../pulsar/proxy/server/ProxyParserTest.java       |  2 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |  5 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  3 +-
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |  9 ++--
 .../server/ProxyWithAuthorizationNegTest.java      | 13 ++---
 .../proxy/server/ProxyWithAuthorizationTest.java   | 21 ++++----
 .../server/ProxyWithoutServiceDiscoveryTest.java   | 13 ++---
 .../SuperUserAuthedAdminProxyHandlerTest.java      | 14 ++---
 .../server/UnauthedAdminProxyHandlerTest.java      |  5 +-
 .../service/WebSocketProxyConfiguration.java       | 12 ++---
 61 files changed, 412 insertions(+), 299 deletions(-)

commit 6e51237538cd5011abbbdfbe7fe9c7c21b63fbe2
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon May 20 10:16:15 2019 -0700

    Replicated subscriptions - Configuration and client changes (#4299)
    
    * Replicated subscriptions - Configuration and client changes
    
    * Added missing header
    
    * Fixed mocked methods for tests
    
    * Fixed typo

 .../broker/admin/impl/PersistentTopicsBase.java    |   4 +-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |   6 +-
 .../pulsar/broker/admin/v2/PersistentTopics.java   |   8 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   6 +-
 .../apache/pulsar/broker/service/Subscription.java |   2 +
 .../org/apache/pulsar/broker/service/Topic.java    |   6 +-
 .../nonpersistent/NonPersistentSubscription.java   |   5 +
 .../service/nonpersistent/NonPersistentTopic.java  |   9 +-
 .../service/persistent/CompactorSubscription.java  |   2 +-
 .../service/persistent/PersistentSubscription.java |  63 ++++++++++-
 .../broker/service/persistent/PersistentTopic.java |  37 ++++---
 .../pulsar/broker/admin/PersistentTopicsTest.java  |   4 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   4 +-
 .../service/PersistentTopicConcurrentTest.java     |  12 ++-
 .../pulsar/broker/service/PersistentTopicTest.java |  61 +++++++----
 .../pulsar/broker/service/ServerCnxTest.java       |  22 ++++
 .../ReplicatedSubscriptionConfigTest.java          | 120 +++++++++++++++++++++
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   6 ++
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   6 ++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   4 +-
 .../impl/conf/ConsumerConfigurationData.java       |   2 +
 .../org/apache/pulsar/common/api/Commands.java     |   7 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  57 ++++++++++
 .../common/policies/data/SubscriptionStats.java    |   6 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   5 +
 .../pulsar/testclient/PerformanceConsumer.java     |   6 +-
 26 files changed, 403 insertions(+), 67 deletions(-)

commit 66fc48efb3ee97d560d632befc62beb4c96c4799
Author: lipenghui <penghui@apache.org>
Date:   Mon May 20 16:55:39 2019 +0800

    [schema] Support compatibility check over all existing schemas. (#4214)
    
    Fixes #4170
    
    ### Motivation
    
    Currently the schema compatibility check is only done with the latest schema. That's probably not enough especially we now support schema versions for Struct schema. We need to the ability for check the compatibility with all existing schema version.
    
    ### Modifications
    
    Add `FORWARD_TRANSITIVE`, `BACKWARD_TRANSITIVE` and `FULL_TRANSITIVE` compatibility strategy.
    
    ### Verifying this change
    
    This change is already covered by existing tests, such as SchemaServiceTest, BaseAvroSchemaCompatibilityTest

 .../service/nonpersistent/NonPersistentTopic.java  |  2 +-
 .../broker/service/persistent/PersistentTopic.java |  2 +-
 .../schema/AvroSchemaBasedCompatibilityCheck.java  | 54 +++++++++-------
 .../service/schema/BookkeeperSchemaStorage.java    | 29 +++++++++
 .../schema/DefaultSchemaRegistryService.java       | 17 +++--
 .../service/schema/SchemaCompatibilityCheck.java   | 23 ++++---
 .../schema/SchemaCompatibilityStrategy.java        | 49 +++++++++++----
 .../broker/service/schema/SchemaRegistry.java      |  6 +-
 .../service/schema/SchemaRegistryServiceImpl.java  | 60 +++++++++++++-----
 .../broker/service/schema/SchemaStorage.java       |  3 +
 .../schema/BaseAvroSchemaCompatibilityTest.java    | 47 ++++++++++++++
 .../broker/service/schema/SchemaServiceTest.java   | 73 +++++++++++++++++++++-
 .../SchemaAutoUpdateCompatibilityStrategy.java     | 19 +++++-
 13 files changed, 315 insertions(+), 69 deletions(-)

commit 08761069e1e95fab216cad2de85d947da911ae9e
Author:  <ranxiaolong716@gmail.com>
Date:   Mon May 20 12:47:32 2019 +0800

    fix functions default value of processing guarantees (#4310)
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 site2/docs/functions-guarantees.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 25bcf4d4b8313df7d44d1de93dce8b5e5189bcb5
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun May 19 21:47:01 2019 -0700

    Print cli args error for standalone (#4308)

 .../src/main/java/org/apache/pulsar/PulsarStandaloneStarter.java         | 1 +
 1 file changed, 1 insertion(+)

commit 84d02ac4ad42497c052d627e834c5e07c0e3449a
Author: Jia Zhai <zhaijia@apache.org>
Date:   Mon May 20 10:58:57 2019 +0800

    Add rate limit support for Replicator between clusters (#4273)
    
    Currently the rate limit between replication clusters is not able to control.
    In Geo-replication, once a cluster is offline, and after a long time, if it comes back, it may get a lot of messages from other clusters, and may use all of the network bandwidth.
    This PR tries to provided a way to control the rate limit between cluster replications. Add rate limit support for Replicator between clusters.
    
    changes:
    - change DispatchRateLimiter.java to support 3 kind type: Topic, subscription, replicator.
    - add  DispatchRateLimiter support in PersistentReplicator.
    - add test and docs

 conf/broker.conf                                   |  10 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  16 +-
 .../apache/pulsar/broker/admin/AdminResource.java  |   6 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  60 +++-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |   4 +-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  30 +-
 .../pulsar/broker/service/BrokerService.java       |  30 +-
 .../apache/pulsar/broker/service/Replicator.java   |  12 +-
 .../service/persistent/DispatchRateLimiter.java    | 160 ++++++----
 .../PersistentDispatcherMultipleConsumers.java     |   7 +-
 .../PersistentDispatcherSingleActiveConsumer.java  |   7 +-
 .../service/persistent/PersistentReplicator.java   |  80 ++++-
 .../broker/service/persistent/PersistentTopic.java |  20 +-
 .../org/apache/pulsar/broker/ConfigHelper.java     |  12 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   2 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |   2 +-
 .../broker/service/ReplicatorRateLimiterTest.java  | 325 +++++++++++++++++++++
 .../pulsar/broker/service/ServerCnxTest.java       |  10 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |  24 +-
 .../client/admin/internal/NamespacesImpl.java      |  26 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  50 +++-
 .../pulsar/common/policies/data/Policies.java      |  14 +-
 site2/docs/admin-api-namespaces.md                 | 118 +++++++-
 23 files changed, 910 insertions(+), 115 deletions(-)

commit cacb16abfdf84c1347536301e456bf1f43bc9bac
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun May 19 19:58:09 2019 -0700

    Fixed record latency before recycling in broker-side producer handler (#4309)
    
    ### Motivation
    
    In #4290 the latency was collected after the context object is triggered in a separate thread. By the time we try to use the producer object it might have been already recycled.

 .../src/main/java/org/apache/pulsar/broker/service/Producer.java        | 2 +-
 .../org/apache/pulsar/broker/service/persistent/PersistentTopic.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 58986a854db545a2042b98d2a7fd59ab93bc7d53
Author: tuteng <eguangning@gmail.com>
Date:   Mon May 20 10:57:08 2019 +0800

    [issue#4155][pulsar-clients]Support key value schema versioning (#4211)
    
    Fixes #4155
    
    Master Issue: #4155
    
    ### Motivation
    
    Similar to AVRO and JSON schema, we need to support schema versioning for key/value schema.
    
    ### Modifications
    
    Support key value schema versioning.
    
    ### Verifying this change
    
    unit test pass

 .../org/apache/pulsar/client/impl/MessageImpl.java |  42 +++-
 .../pulsar/client/impl/schema/KeyValueSchema.java  | 125 +++++++++-
 .../apache/pulsar/client/impl/MessageImplTest.java | 266 ++++++++++++++++++++-
 .../client/impl/schema/KeyValueSchemaTest.java     |  10 +-
 .../SupportVersioningKeyValueSchemaTest.java       | 166 +++++++++++++
 5 files changed, 581 insertions(+), 28 deletions(-)

commit 6485ccf75d96f282c2c61e1dd87b85e42de64102
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Sun May 19 00:26:02 2019 -0300

    Feature / interceptor for ack timeout (#4300)
    
    *Motivation*
    
    Provide proper interceptor for messages being redelivered due to ack timeout.
    
    *Modifications*
    
      - Add test case for onAckTimeoutSend interceptor.
      - Add onAckTimeoutSend() method in ConsumerInterceptor interface.
      - Add handler for onAckTimeoutSend() interceptor in ConsumerBase.
      - Add method call to onAckTimeoutSend() in UnAckedMessageTracker.

 .../apache/pulsar/client/api/InterceptorsTest.java | 93 +++++++++++++++++++++-
 .../pulsar/client/api/ConsumerInterceptor.java     | 11 +++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  6 ++
 .../pulsar/client/impl/ConsumerInterceptors.java   | 21 +++++
 .../pulsar/client/impl/UnAckedMessageTracker.java  |  1 +
 5 files changed, 131 insertions(+), 1 deletion(-)

commit 4d75f1f129c1771eea60dfee5f4655979121e311
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat May 18 17:24:35 2019 -0700

    [pulsar-function] fix backward compatibility with 2.2 auth not working (#4241)
    
    * [pulsar-function] fix backward compatibility with 2.2 auth not working
    
    * Fix test
    
    * remove authentication from upload and download api

 .../apache/pulsar/broker/admin/v2/Functions.java   | 23 ++++++------
 .../functions/worker/rest/api/FunctionsImplV2.java | 42 +++++++++++-----------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 27 +++++++-------
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 12 +++----
 .../rest/api/v3/FunctionApiV3ResourceTest.java     | 13 +++++--
 5 files changed, 65 insertions(+), 52 deletions(-)

commit c509f86ba3aa719ff404ff6d97450472ddf5445b
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat May 18 15:37:18 2019 -0700

    Use multi-stage build for Docker images (#4184)
    
    * Use multi-stage build for Docker images
    
    * Fixed building pulsar-all image
    
    * docker args should go after FROM
    
    * Fixed pulsar-standalone Dockerfile
    
    * Install procps for pkill in test image

 docker/pulsar-all/Dockerfile                       | 11 ++++++----
 docker/pulsar-standalone/Dockerfile                | 11 +++++++---
 docker/pulsar/Dockerfile                           | 25 ++++++++++++++++++----
 .../docker-images/latest-version-image/Dockerfile  |  2 +-
 4 files changed, 37 insertions(+), 12 deletions(-)

commit 840b2100d16be4ce3d0f76035b5f1245fd543d7f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat May 18 10:20:59 2019 -0700

    [pulsar-broker] fix msg-drop metrics for non-persistent topic (#4298)

 .../nonpersistent/NonPersistentDispatcherMultipleConsumers.java       | 2 +-
 .../nonpersistent/NonPersistentDispatcherSingleActiveConsumer.java    | 4 ++--
 .../broker/service/nonpersistent/NonPersistentSubscription.java       | 2 +-
 .../pulsar/broker/service/nonpersistent/NonPersistentTopic.java       | 4 ++--
 4 files changed, 6 insertions(+), 6 deletions(-)

commit 3c3efdc55122f0ff52a766a8b227a02c8b1ac7da
Author: Like <ke.like@outlook.com>
Date:   Sun May 19 00:50:01 2019 +0800

    Add operation to message of BkException (#4305)
    
    * Add operation to message of BkException
    
    * Add test

 .../service/schema/BookkeeperSchemaStorage.java    |  3 +-
 .../schema/BookkeeperSchemaStorageTest.java        | 44 ++++++++++++++++++++++
 2 files changed, 46 insertions(+), 1 deletion(-)

commit 91d4495e5f7b5765286e9150639f995f133f0803
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat May 18 07:52:47 2019 -0700

    [pulsar-broker] add support of secondary bookie-isolation-group (#4261)
    
    * [pulsar-broker] add support of secondary bookie-isolation-group
    
    * fix docs
    
    * add negative test
    
    * Fix tests

 conf/broker.conf                                   |  8 ++
 conf/standalone.conf                               |  8 ++
 .../apache/pulsar/broker/ServiceConfiguration.java | 12 +++
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |  4 +
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   | 42 ++++++++--
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java | 98 ++++++++++++++++++++++
 site2/docs/reference-configuration.md              |  2 +
 7 files changed, 167 insertions(+), 7 deletions(-)

commit 78e794a98068ebb2bc1f5760a3f8bbedb69c1f02
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat May 18 07:43:28 2019 -0700

    [pulsar-broker]Fix: race condition while deleting global topic (#4173)

 .../pulsar/broker/service/persistent/PersistentTopic.java  | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

commit 364ed5e91b0170e5f40a36e12be5e5e520377a2f
Author: lipenghui <penghui@apache.org>
Date:   Sat May 18 22:41:38 2019 +0800

    [schema] Fix joda dependency issue. (#4207)
    
    * [schema] Fix joda dependency issue.
    
    * [schema] Add binary license of joda-time.
    
    * [schema] Make joda-time dependency optional.
    
    * [schema] Change log level to debug for logical type init.
    
    * [schema] fix joda-time license in presto distribution
    
    * [schema] fix joda-time license in presto distribution

 distribution/server/src/assemble/LICENSE.bin.txt   |  3 +-
 pom.xml                                            |  5 ++
 pulsar-client/pom.xml                              |  7 ++-
 .../pulsar/client/impl/schema/AvroSchema.java      | 43 ++++++++-------
 pulsar-sql/presto-distribution/LICENSE             |  1 +
 tests/integration/pom.xml                          |  6 +++
 .../tests/integration/schema/SchemaTest.java       | 61 ++++++++++++++++++++++
 .../pulsar/tests/integration/schema/Schemas.java   | 30 +++++++++++
 8 files changed, 136 insertions(+), 20 deletions(-)

commit db9f7896762e7d655f12507f6d0ccdd94ca414a5
Author: Sijie Guo <sijie@apache.org>
Date:   Sat May 18 05:38:10 2019 -0700

    [Doc] Documentation about deploying and configuring pulsar functions-worker (#4229)

 site2/docs/assets/functions-worker-corun-proxy.png | Bin 0 -> 12928 bytes
 site2/docs/assets/functions-worker-corun.png       | Bin 0 -> 11286 bytes
 .../assets/functions-worker-separated-proxy.png    | Bin 0 -> 24788 bytes
 site2/docs/assets/functions-worker-separated.png   | Bin 0 -> 21649 bytes
 site2/docs/deploy-bare-metal.md                    |   4 +-
 site2/docs/functions-worker.md                     | 240 +++++++++++++++++++++
 site2/website/sidebars.json                        |   3 +-
 7 files changed, 245 insertions(+), 2 deletions(-)

commit 353ca73b11124f3df58934f4f496d370545d8a05
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Sat May 18 17:57:04 2019 +0530

    [Issue 4283][flink] construct auth when building pulsar source (#4284)
    
    Fixes #4283
    
    ### Motivation
    
    pulsar flink connector now uses ClientConfigData to instantiate pulsar client. Pulsar client composes Authentication which can not be serialized. In an environment with Auth there is no way to set auth in pulsar client.
    
    ### Modifications
    
    Keep auth params away from persistence and serialization. Construct auth when building pulsar source

 .../client/impl/conf/ClientConfigurationData.java   | 20 ++++++++++++--------
 .../connectors/pulsar/FlinkPulsarProducer.java      |  1 -
 .../connectors/pulsar/PulsarSourceBuilder.java      | 21 ++++++++++++++++++++-
 .../connectors/pulsar/PulsarSourceBuilderTest.java  | 19 ++++++++++---------
 4 files changed, 42 insertions(+), 19 deletions(-)

commit ce685dc3b359674941f02f81185651645012e80a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri May 17 23:56:22 2019 -0700

    [pulsar-common] add open Concurrent LongPair RangeSet (#3818)
    
    * [pulsar-common] add open Concurrent LongPair RangeSet
    
    * add open-range set methods
    
    * add forEach
    
    * add forEach with consumer
    
    * Fix stamp-lock usage
    
    * Move ConcurrentBitSet to separate class

 .../common/util/collections/ConcurrentBitSet.java  | 160 +++++++++
 .../ConcurrentOpenLongPairRangeSet.java            | 370 ++++++++++++++++++++
 .../common/util/collections/LongPairRangeSet.java  | 254 ++++++++++++++
 .../ConcurrentOpenLongPairRangeSetTest.java        | 384 +++++++++++++++++++++
 4 files changed, 1168 insertions(+)

commit a207645d919f322b6ecf5f3f652b4029bfad187c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri May 17 23:54:51 2019 -0700

    [pulsar-broker] add valid-readPosition check before setting readPosition at cursor (#3881)
    
    * [pulsar-broker] add valid-readPosition check before setting readPosition at cursor
    
    * fix test

 .../java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java  | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 831476b9bcf62af3d56c5245e83611b2842bfaca
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 17 18:04:04 2019 -0700

    In Java we replace all "-" with "_" for state table namespace. (#4301)
    
    We need to do the same for python functions

 pulsar-functions/instance/src/main/python/python_instance.py | 1 +
 1 file changed, 1 insertion(+)

commit 1b304a94ca51002b293c1ebc4988288df3c69943
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 17 17:16:50 2019 -0700

    By default, auto configure the size of Bookie read/write cache (#4297)
    
    * By default, auto configure the size of Bookie read/write cache
    
    * Updated ref docs

 conf/bookkeeper.conf                  | 13 ++++++++-----
 conf/standalone.conf                  | 13 ++++++++-----
 site2/docs/reference-configuration.md |  6 +++---
 3 files changed, 19 insertions(+), 13 deletions(-)

commit 3ea6edc628461512c809026261a916de8b7cd0f9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 17 10:02:47 2019 -0700

    Misc fixes for state querying via pulsar admin (#4293)

 .../java/org/apache/pulsar/broker/admin/impl/FunctionsBase.java   | 2 +-
 .../org/apache/pulsar/client/admin/internal/FunctionsImpl.java    | 3 +--
 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 2 +-
 .../java/org/apache/pulsar/common/functions/FunctionState.java    | 8 ++++++--
 .../apache/pulsar/functions/worker/rest/api/ComponentImpl.java    | 4 ++++
 5 files changed, 13 insertions(+), 6 deletions(-)

commit bb2d7fc69af0bd72e56f5db04e9931a4e2d4adaa
Author: tuteng <eguangning@gmail.com>
Date:   Sat May 18 01:00:47 2019 +0800

    Add double quotation marks for metrics with remote_cluster (#4295)

 .../main/java/org/apache/pulsar/broker/stats/prometheus/TopicStats.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ed7bb78e946877f9ab4dfb656b8e6d837621442c
Author: penny <674057218@qq.com>
Date:   Fri May 17 17:24:09 2019 +0800

    typo in word validation (#4292)
    
    
    ### Motivation
    
    typo in word validation

 .../main/java/org/apache/pulsar/broker/lookup/TopicLookupBase.java  | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 4eaff7a97a6c62dcf55f06067a75ea3fffaf7d2c
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri May 17 13:57:09 2019 +0800

    [Issue 3475][pulsar-client] Add cluster checking before operating tenants with it (#3476)
    
    * Add cluster checking before operating tenants with it.
    
    * Check on server side and add a unit test for this part of changes
    
    * Fix some unit tests to pass this change
    
    * Fix some unit tests to pass this change
    
    * Fix NPE when TenantInfo is null
    
    * Fix a unit test to pass this change

 .../pulsar/broker/admin/impl/TenantsBase.java      | 31 +++++++++++++++++--
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 35 ++++++++++++++++++++--
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   |  5 ++++
 .../broker/admin/BrokerAdminClientTlsAuthTest.java | 33 ++++----------------
 .../pulsar/broker/admin/PersistentTopicsTest.java  |  1 +
 .../api/AuthenticatedProducerConsumerTest.java     |  6 ++++
 .../AuthenticationTlsHostnameVerificationTest.java |  3 ++
 .../api/AuthorizationProducerConsumerTest.java     |  7 +++++
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  3 ++
 .../proxy/server/AuthedAdminProxyHandlerTest.java  |  3 ++
 .../server/ProxyWithAuthorizationNegTest.java      |  3 ++
 .../proxy/server/ProxyWithAuthorizationTest.java   |  9 ++++++
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  3 ++
 .../SuperUserAuthedAdminProxyHandlerTest.java      |  3 ++
 14 files changed, 114 insertions(+), 31 deletions(-)

commit e32b45ae8468809d33cd84823cc2e0f06f57abe7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu May 16 22:56:21 2019 -0700

    [pulsar-broker] add broker-add-latency metrics (#4290)

 .../org/apache/pulsar/broker/service/Producer.java | 11 ++++-
 .../org/apache/pulsar/broker/service/Topic.java    |  7 ++++
 .../service/nonpersistent/NonPersistentTopic.java  | 13 +++++-
 .../broker/service/persistent/PersistentTopic.java | 16 ++++++-
 .../apache/pulsar/broker/stats/NamespaceStats.java | 42 ++++++++++++++++++-
 .../client/api/SimpleProducerConsumerStatTest.java | 49 ++++++++++++++++++++++
 .../pulsar/common/policies/data/TopicStats.java    |  3 +-
 7 files changed, 135 insertions(+), 6 deletions(-)

commit ea23cdff87bc18b3486a970e4d047210aabfe844
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 16 22:55:31 2019 -0700

    Don't create new instances of user classes during validation (#4281)
    
    * Don't create new instances of user classes during validation
    
    * fixing tests
    
    * uncomment functions

 .../pulsar/functions/utils/FunctionCommon.java     | 61 +++++++---------------
 .../functions/utils/FunctionConfigUtils.java       | 17 +++++-
 .../pulsar/functions/utils/SinkConfigUtils.java    | 14 ++++-
 .../pulsar/functions/utils/SourceConfigUtils.java  | 14 ++++-
 .../pulsar/functions/utils/ValidatorUtils.java     | 14 +++--
 .../pulsar/functions/utils/io/ConnectorUtils.java  |  8 +--
 .../pulsar/functions/worker/FunctionActioner.java  |  6 +--
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  2 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  6 +--
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  | 26 +++++++--
 .../rest/api/v3/SourceApiV3ResourceTest.java       | 26 ++++++++-
 11 files changed, 127 insertions(+), 67 deletions(-)

commit 39004c83d5583237f34f75cd078c557421f0560a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 16 20:39:22 2019 -0700

    add getting secrets utils method for sinks (#4291)

 .../org/apache/pulsar/io/common/IOConfigUtils.java | 12 +++-
 .../apache/pulsar/io/common/IOConfigUtilsTest.java | 84 ++++++++++++++++++++--
 2 files changed, 91 insertions(+), 5 deletions(-)

commit f51385e1ca2f91a16b2df8934c47ee27df2b17ae
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 16 20:37:58 2019 -0700

    Fix website build with required Python dependency (#4287)

 site2/tools/python-doc-gen.sh | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 7995b538cdd61e7bf42c24963d5f839bd8f8c097
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 16 20:16:22 2019 -0700

    Upgrade to BookKeeper 4.9.2 (#4288)

 distribution/server/src/assemble/LICENSE.bin.txt | 56 ++++++++++++------------
 pom.xml                                          |  2 +-
 pulsar-client-cpp/python/setup.py                |  2 +-
 pulsar-sql/presto-distribution/LICENSE           | 22 +++++-----
 4 files changed, 41 insertions(+), 41 deletions(-)

commit 26e357ffb716acafab32ce198c6f68b2552182da
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 16 20:10:33 2019 -0700

    Fix the current broken publish method (#4289)
    
    * Fix the current broken publish method
    
    * Added for properties

 pulsar-client-cpp/python/pulsar/functions/context.py     | 13 +------------
 pulsar-functions/instance/src/main/python/contextimpl.py | 11 +++++++----
 2 files changed, 8 insertions(+), 16 deletions(-)

commit 333ef9836bed96f20dfa1e09418c4bf975819ddb
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 16 12:56:21 2019 -0700

    Fixed flaky test testActiveSubscriptionWithCache (#4282)

 .../java/org/apache/pulsar/broker/service/PersistentTopicE2ETest.java   | 2 --
 1 file changed, 2 deletions(-)

commit c81efee00d1bdb9766d08199251d40f7551f48f4
Author: Alexandre DUVAL <alexandre.duval@clever-cloud.com>
Date:   Wed May 15 23:22:04 2019 +0200

    [Issue 4251][Schemas] add schema parsing verification before update (#4252)
    
    * add schema parsing verification before update
    
    * use @Slf4j
    
    * replace Boolean object to its primitive boolean

 .../schema/AvroSchemaBasedCompatibilityCheck.java  | 29 ++++++++++++++++------
 .../service/schema/SchemaCompatibilityCheck.java   | 12 +++++++++
 .../service/schema/SchemaRegistryServiceImpl.java  | 16 ++++++++----
 3 files changed, 45 insertions(+), 12 deletions(-)

commit b0aa7314ff1a927f07da7640b0142e33ab17849d
Author: cckellogg <cckellogg@gmail.com>
Date:   Wed May 15 14:21:49 2019 -0700

    add anonymousUserRole to proxy config (#4254)

 conf/proxy.conf | 3 +++
 1 file changed, 3 insertions(+)

commit da1cd78d82c3d24b38805b7c34d3852d9ec73b63
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Thu May 16 05:21:29 2019 +0800

    [WIP] PIP-36: Support set message size in broker.conf (#4247)
    
    * Support set message size
    ---
    
    *Motivation*
    
    Currently Pulsar only support 5MB size of messages.But there are many cases will use more than 5MB message
    to transfer.
    https://github.com/apache/pulsar/wiki/PIP-36%3A-Max-Message-Size
    
    *Modifications*
    
    - Add message size in protocol
    - Automaticlly adjust client message size by server
    
    * Use `maxMessageSize` to set `nettyFrameSize` in bookie client
    ---
    
    *Motivation*
    
    When broker specify a `maxMessageSize` bookie should accept this value as `nettyFrameSize`
    
    *Modifications*
    
    - Use `cnx().getMaxMessageSize`
    - Discovery service only redirect so use the constant value `5 * 1024 * 1024` as message size
    - Put `MAX_METADATA_SIZE` as constant value in `InternalConfigurationData`
    
    * Use `Commands` to store message setting
    ---
    
    *Modifications*
    
    - use `Commands` to store default `MAX_MESSAGE_SIZE` and `MESSAGE_SIZE_FRAME_PADDING`
    - replace `LengthFieldBasedFrameDecoder` when has set message size
    - replace `PulsarDecoder.MaxMessageSize`
    
    * Fix some error
    
    * Fix license header
    
    * Add test and make `ClientCnx.maxMessageSize` static
    ---
    
    *Motivation*
    
    - Even if the cnx can't use, `maxMessageSize` should be used at compare message size. So it should as a static variable
    
    * fix code style
    
    * Fix license header

 .../apache/pulsar/broker/ServiceConfiguration.java |   8 ++
 .../org/apache/pulsar/PulsarBrokerStarter.java     |   8 ++
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |   3 +
 .../broker/service/PulsarChannelInitializer.java   |   8 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   4 +-
 .../pulsar/broker/service/MaxMessageSizeTest.java  | 154 +++++++++++++++++++++
 .../client/api/SimpleProducerConsumerTest.java     |  14 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     |   5 +-
 .../pulsar/client/impl/MessageParserTest.java      |   5 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  16 ++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   5 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  16 +--
 .../client/impl/PulsarChannelInitializer.java      |   9 +-
 .../org/apache/pulsar/common/api/Commands.java     |  14 +-
 .../apache/pulsar/common/api/PulsarDecoder.java    |   5 -
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  57 ++++++++
 .../pulsar/common/api/raw/MessageParser.java       |   8 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 .../pulsar/discovery/service/ServerConnection.java |   1 +
 .../service/ServiceChannelInitializer.java         |   6 +-
 .../pulsar/proxy/server/DirectProxyHandler.java    |  46 +++++-
 .../pulsar/proxy/server/ParserProxyHandler.java    |   9 +-
 .../proxy/server/ServiceChannelInitializer.java    |   6 +-
 .../pulsar/sql/presto/PulsarConnectorConfig.java   |  12 ++
 .../pulsar/sql/presto/PulsarRecordCursor.java      |   3 +-
 25 files changed, 369 insertions(+), 54 deletions(-)

commit e77d0b1fcfc439a7f82fbdfb4c207258d7258abc
Author: Like <ke.like@outlook.com>
Date:   Thu May 16 05:20:55 2019 +0800

    Validate admin operation on topic with authoritative parameter (#4270)

 .../java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ac8e4e38e8d5b811ed871711117393553c9687f4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 15 05:02:31 2019 -0700

    fix bug with source local run (#4278)

 .../src/main/java/org/apache/pulsar/functions/runtime/LocalRunner.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2c09ff2f8e519b96a34eda391b450133b68cd5aa
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed May 15 03:05:37 2019 -0700

    [pulsar-storm] add more metrics to troubleshoot spout throughput (#4280)
    
    ### Motivation
    
    Many time user sees lower throughput in pulsar-spout even though standalone consumer can consume such msgRate easily. It would be hard to debug user's topology without enough information so, adding two metrics which can impact spout throughput.
    - number of message filed: spout sleeps when it sees failed message so, it's important to have visibility of that count
    - number of times spout-thread not found the message in queue: spout topology internally sleeps if it doesn't see any emitted tuple in collector after triggering `nextTuple()` api.
    
    This metrics gives more visibility about consumer throughput.

 .../src/main/java/org/apache/pulsar/storm/PulsarSpout.java    | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit 6c37145d6fdb5a1fdbfaa34db29df002127af187
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed May 15 17:27:42 2019 +0800

    Edit *Getting started* for clarity (#4246)
    
    * Edit *Getting started* for clarity

 site2/docs/getting-started-clients.md    |  10 +-
 site2/docs/getting-started-docker.md     |  58 ++++++-----
 site2/docs/getting-started-standalone.md | 161 ++++++++++++++-----------------
 3 files changed, 110 insertions(+), 119 deletions(-)

commit e1728d0c8787293ffac398de54165838d54741b6
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 15 00:38:52 2019 -0700

    Add helper method to for IO connectors to use function secrets (#4222)
    
    * pulsar-io connectors use secrets
    
    * remove unnecessary files
    
    * fix pom
    
    * add license headers

 pulsar-io/common/pom.xml                           |  49 ++++++++
 .../org/apache/pulsar/io/common/IOConfigUtils.java |  60 +++++++++
 .../apache/pulsar/io/common/IOConfigUtilsTest.java | 139 +++++++++++++++++++++
 pulsar-io/pom.xml                                  |   1 +
 pulsar-io/twitter/pom.xml                          |   5 +
 .../apache/pulsar/io/twitter/TwitterFireHose.java  |   3 +-
 6 files changed, 256 insertions(+), 1 deletion(-)

commit 9dbc8dd5129945fd17a3babff41210ef93443eec
Author: Sijie Guo <sijie@apache.org>
Date:   Wed May 15 00:19:51 2019 -0700

    [deploy] Provide a flag to choose the container factory to use to run functions (#4255)
    
    * Improve gen-yml-from-env.py script to provide a flag to choose which container factory to use
    
    *Motivation*
    
    Currently the default function running mode is `Process`. It is hardly able to configure running
    functions in k8s.
    
    Provide a flag in `gen-yml-from-env.py` so that people can choose which container factory to use.
    
    * addressed review comments

 docker/pulsar/scripts/gen-yml-from-env.py | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 1146893dee31187fa00f8326bc003281a1be2a9c
Author: Kim Christian Gaarder <kim.christian.gaarder@gmail.com>
Date:   Wed May 15 09:19:35 2019 +0200

    Added pulsar-client-api to shaded jar (#4257)

 pulsar-client-all/pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit 815c8fa2facbdf17797e78828428e12ce35babb4
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue May 14 23:44:39 2019 -0700

    [pulsar-storm] allow option to configure queue size of pulsar-spout-consumer (#4239)

 .../src/main/java/org/apache/pulsar/storm/PulsarSpout.java |  1 +
 .../org/apache/pulsar/storm/PulsarSpoutConfiguration.java  | 14 ++++++++++++++
 2 files changed, 15 insertions(+)

commit b0cb4af684c16859cb581c020f819fb9d4e585a8
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed May 15 14:42:04 2019 +0800

    Add the path of the *website* folder for clarity (#4268)

 site2/README.md | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit ad4c9f3608cb228bbb59bade7e4e12ccd14e2fb3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue May 14 23:29:45 2019 -0700

    Added an explicit field in the function details for componenttype (#4250)
    
    * Added an explicit field in the function details for componenttype
    
    * Fixed unittests
    
    * Updated the defn of python pb file
    
    * Added licence
    
    * Took feedback into account
    
    * Added unittest

 .../pulsar/functions/instance/ContextImpl.java     |   6 +-
 .../pulsar/functions/instance/InstanceUtils.java   |  19 +-
 .../functions/instance/JavaInstanceRunnable.java   |   3 +-
 .../instance/stats/ComponentStatsManager.java      |   5 +-
 .../instance/src/main/python/Function_pb2.py       | 366 +++++++++++++--------
 .../pulsar/functions/instance/ContextImplTest.java |   5 +-
 .../functions/instance/InstanceUtilsTest.java      |  77 +++++
 .../proto/src/main/proto/Function.proto            |   7 +
 .../functions/runtime/KubernetesRuntime.java       |   3 +-
 ...{ComponentType.java => ComponentTypeUtils.java} |  27 +-
 .../functions/utils/FunctionConfigUtils.java       |   2 +
 .../pulsar/functions/utils/SinkConfigUtils.java    |   2 +
 .../pulsar/functions/utils/SourceConfigUtils.java  |   2 +
 .../functions/worker/rest/api/ComponentImpl.java   | 237 +++++++------
 .../functions/worker/rest/api/FunctionsImpl.java   |   3 +-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |  14 +-
 .../functions/worker/rest/api/SourceImpl.java      |  14 +-
 .../worker/rest/api/FunctionsImplTest.java         |   5 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   3 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  13 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |   9 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   9 +-
 22 files changed, 500 insertions(+), 331 deletions(-)

commit 6b2eaa8ac81e1e4113f1b23b89b3cb1a09d1de68
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 14 21:02:44 2019 -0700

    With multi-host HTTP client, stop after trying all the addresses (#4272)
    
    * With multi-host HTTP client, stop after trying all the addresses
    
    * Also fixed the name resolver to not use random each time

 .../client/admin/internal/http/AsyncHttpConnector.java    | 15 ++++++++++++++-
 .../pulsar/client/impl/PulsarServiceNameResolver.java     |  6 +++++-
 2 files changed, 19 insertions(+), 2 deletions(-)

commit 248391dcd8d84fdc33457be176c3e46bbcb325bd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon May 13 18:12:00 2019 -0700

    [pulsar-admin-tool] support json auth-param for tls-authentication (#4124)

 .../pulsar/admin/cli/PulsarAdminToolTest.java      | 57 ++++++++++++++++++++++
 .../pulsar/client/impl/auth/AuthenticationTls.java | 23 ++++++++-
 2 files changed, 79 insertions(+), 1 deletion(-)

commit db66df2dd835d736ea3556e7585747ed8b665835
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri May 10 00:39:28 2019 +0800

    Support performance tool to print aggregated throughput. (#4245)

 .../pulsar/testclient/PerformanceConsumer.java      | 20 ++++++++++++++++++++
 .../pulsar/testclient/PerformanceProducer.java      | 21 +++++++++++++++++++++
 2 files changed, 41 insertions(+)

commit 61034d07a28d5a4214f3c50b3a27b16f1706f057
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri May 10 00:38:34 2019 +0800

    [Doc] Add site2/website/versioned_docs/version-2.3.1/getting-started-docker.md (#4227)
    
    * add site2/website/versioned_docs/version-2.3.1/getting-started-docker.md
    
    * Update as per advice from murong00

 .../version-2.3.1/getting-started-docker.md        | 165 +++++++++++++++++++++
 1 file changed, 165 insertions(+)

commit 345e9ab1b4716f37739eab58f7d5adeada1cd53d
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 9 18:37:59 2019 +0200

    Add flag to allow TLS hostname validation to be disabled in python (#4217)
    
    * Add flag to allow TLS hostname validation to be disabled in python
    
    * Update default to false

 pulsar-client-cpp/lib/HTTPLookupService.cc  | 5 ++++-
 pulsar-client-cpp/lib/HTTPLookupService.h   | 1 +
 pulsar-client-cpp/python/pulsar/__init__.py | 9 ++++++++-
 3 files changed, 13 insertions(+), 2 deletions(-)

commit 4ddd4b7c3e74751457062f79342778ef7b525e0b
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu May 9 09:37:35 2019 -0700

    Add python3 kazoo in Dockerimage (#4230)

 docker/pulsar/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5d6b6dca8b4f0183c2856c6ec4a977e148e2c246
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Thu May 9 21:52:38 2019 +0800

    Support multi-host for pulsar-admin (#4018)
    
    *Motivation*
    
    Sometimes the user might have many pulsar brokers but doesn't user load balancer or DNS. So we need support multi-host for pulsar-admin.
    
    *Modifications*
    
    Use `PulsarServiceNameResolver` to resolve it.

 .../admin/internal/http/AsyncHttpConnector.java    | 132 ++++++++++++++-------
 .../client/impl/PulsarServiceNameResolver.java     |   2 +-
 .../client/impl/conf/ClientConfigurationData.java  |   1 +
 .../tests/integration/cli/AdminMultiHostTest.java  |  96 +++++++++++++++
 .../integration/containers/BrokerContainer.java    |   2 +-
 .../integration/topologies/PulsarCluster.java      |  15 +++
 .../integration/src/test/resources/pulsar-cli.xml  |   1 +
 7 files changed, 204 insertions(+), 45 deletions(-)

commit 6f6cc93a07f32b1550b9609cc48280593b7a6929
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu May 9 21:36:24 2019 +0900

    Fix top page title (#4242)
    
    ### Motivation
    
    
    * Currently, the top page title of http://pulsar.apache.org/ is `Apache Pulsar  `
    
    ### Modifications
    
    * Add `disableTitleTagline: true` in siteConfig and the title is changed from `Apache Pulsar  ` to `Apache Pulsar` .

 site2/website/siteConfig.js | 1 +
 1 file changed, 1 insertion(+)

commit 8c59fd358137f31da0744beabd6aabed0a514208
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Thu May 9 14:01:38 2019 +0530

    [issue 3954] [flink] Use (client/consumer/producer) pojo to pass config to pulsar client (#4232)
    
    * Flink client to accept all pulsar client conf
    
    In this patch, we provide handles for flink connecotr to accept ClientConfigurationData, ProducerConfigurationData, ConsumerConfigurationData so flink client can:
    1. accept all params of client, producer and consumer
    2. Keep pace with pulsar-client
    
    * Flink client to accept all pulsar client conf
    
    Added test cases
    
    * Removing commented code

 .../client/impl/conf/ClientConfigurationData.java  |   6 ++
 .../impl/conf/ConsumerConfigurationData.java       |   6 ++
 .../impl/conf/ProducerConfigurationData.java       |   6 ++
 .../connectors/pulsar/BasePulsarOutputFormat.java  |  49 +++++++---
 .../connectors/pulsar/PulsarAvroOutputFormat.java  |   7 ++
 .../connectors/pulsar/PulsarCsvOutputFormat.java   |   7 ++
 .../connectors/pulsar/PulsarJsonOutputFormat.java  |   7 ++
 .../connectors/pulsar/PulsarOutputFormat.java      |   8 ++
 .../connectors/pulsar/FlinkPulsarProducer.java     |  66 +++++--------
 .../connectors/pulsar/PulsarAvroTableSink.java     |  44 +++++++--
 .../connectors/pulsar/PulsarConsumerSource.java    |  57 +++--------
 .../connectors/pulsar/PulsarJsonTableSink.java     |  14 ++-
 .../connectors/pulsar/PulsarSourceBuilder.java     |  78 ++++++++++-----
 .../connectors/pulsar/PulsarTableSink.java         |  29 ++++--
 .../pulsar/PulsarAvroOutputFormatTest.java         |  69 +++++++++++++
 .../pulsar/PulsarCsvOutputFormatTest.java          |  69 +++++++++++++
 .../pulsar/PulsarJsonOutputFormatTest.java         |  69 +++++++++++++
 .../connectors/pulsar/PulsarOutputFormatTest.java  |  69 +++++++++++++
 .../connectors/pulsar/PulsarAvroTableSinkTest.java |  12 ++-
 .../connectors/pulsar/PulsarJsonTableSinkTest.java |   7 +-
 .../connectors/pulsar/PulsarSourceBuilderTest.java | 107 +++++++++++++++++++++
 21 files changed, 642 insertions(+), 144 deletions(-)

commit 5a2b10bbb2c96b472bd2ebf4ebbb1eb7c88926e6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed May 8 19:59:55 2019 -0700

    Allow configurble Request timeout for pulsar cli (#4235)

 .../org/apache/pulsar/client/admin/PulsarAdmin.java     | 17 +++++++++++++----
 .../apache/pulsar/client/admin/PulsarAdminBuilder.java  |  8 ++++++++
 .../client/admin/internal/PulsarAdminBuilderImpl.java   | 12 +++++++++++-
 .../client/admin/internal/http/AsyncHttpConnector.java  |  6 +++++-
 .../admin/internal/http/AsyncHttpConnectorProvider.java |  4 ++--
 5 files changed, 39 insertions(+), 8 deletions(-)

commit 05c99a688f5931800ff445eeda7e80be3b3a8c8c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed May 8 18:36:56 2019 -0700

    [pulsar-storm] provide auto-unsubscribe option in pulsar-spout (#4238)

 .../src/main/java/org/apache/pulsar/storm/PulsarSpout.java |  5 +++++
 .../org/apache/pulsar/storm/PulsarSpoutConfiguration.java  | 14 ++++++++++++++
 2 files changed, 19 insertions(+)

commit 78502a3cfae0d789cea667c4829830487517b7ea
Author: tuteng <eguangning@gmail.com>
Date:   Wed May 8 20:03:04 2019 +0800

    [pulsar-clients] Support nested struct for GenericRecord (#4177)
    
    ### Motivation
    
    Currently, GenericRecordBuilder only supports primitive types, e.g. int, long, string. But it doesnt support struct type.
    
    ### Modifications
    
    Support nested struct for GenericRecordBuilder, for example AVRO
    
    ### Verifying this change
    
    Unit Test Pass

 .../client/api/schema/RecordSchemaBuilder.java     |   9 +
 .../client/impl/schema/FieldSchemaBuilderImpl.java |  17 ++
 .../impl/schema/RecordSchemaBuilderImpl.java       |   8 +
 .../impl/schema/generic/AvroRecordBuilderImpl.java |  29 +-
 .../client/impl/schema/SchemaBuilderTest.java      | 292 ++++++++++++++++++++-
 5 files changed, 346 insertions(+), 9 deletions(-)

commit 95f07f819ca8980fbf4b8a4136ba5ea5cfb5e597
Author: Samuel <foreversunyao@yahoo.com>
Date:   Wed May 8 18:30:23 2019 +0800

    pip28-v2 add unit test (#3915)
    
    ### Motivation
    
    https://github.com/apache/pulsar/wiki/PIP-28%3A-Pulsar-Proxy-Gateway-Improvement
    
    
    ### Modifications
    
    added a new handler **ParserProxyHandler.java** to parse requests independently and output

 .../pulsar/proxy/server/DirectProxyHandler.java    |  26 ++-
 .../pulsar/proxy/server/ParserProxyHandler.java    | 179 +++++++++++++++
 .../pulsar/proxy/server/ProxyConfiguration.java    |  16 ++
 .../apache/pulsar/proxy/server/ProxyService.java   |   7 +
 .../pulsar/proxy/server/ProxyParserTest.java       | 254 +++++++++++++++++++++
 5 files changed, 479 insertions(+), 3 deletions(-)

commit 3f4c57102f21beeb1dd49dc8f71a06d4e7b45487
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue May 7 16:20:15 2019 -0700

    [pulsar-function] fix broken backward compatibility with v1-namespace while registering function (#4224)

 .../pulsar/functions/worker/rest/api/ComponentImpl.java      | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit 0899b22df0eccd315e03282bca2e99f74395b20c
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed May 8 07:20:04 2019 +0800

    Update command-line tools doc for v2.3.1. (#4226)

 .../version-2.3.1/reference-cli-tools.md           | 117 +++++++++++++++++++--
 1 file changed, 109 insertions(+), 8 deletions(-)

commit d14b2c0d786ccf8e4a81b75d013176a929b12bc7
Author: Anonymitaet <50226895+Anonymitaet@users.noreply.github.com>
Date:   Wed May 8 05:11:43 2019 +0800

    Edit *Run Pulsar Locally* for clarity (#4220)
    
    *  Add explanations for `pulsar-daemon start standalone`.
    
    *  Apply the **Title Case** rule for all headings.
    
    * Change gerunds to base verbs in headings.
    The gerund is commonly used as a heading since it is suggestive and softer, while the heading plays a significant role in the search result, and using the imperative (base verb) means the heading of the topic match closely to the questions entered by users. For example, users type search keywords like "run pulsar manually" instead of "running pulsar manually".

 site2/docs/getting-started-standalone.md | 34 +++++++++++++++++---------------
 1 file changed, 18 insertions(+), 16 deletions(-)

commit 277bceef0366a2ef17ff6e30f62f77af0872fbca
Author: Sijie Guo <sijie@apache.org>
Date:   Tue May 7 13:03:12 2019 +0800

    [transaction][coordinator] add the interfaces for transaction metadata store and an in-memory implementation (#4161)
    
    * [transaction][coordinator] add the interfaces for transaction metadata store and an in-memory implementation
    
    Master Issue: #2664
    
    *Motivation*
    
    Setup the project structure for developing transaction coordinator.
    
    *Changes*
    
    - setup the project structure
    - introduce common classes: `TxnID`, `TxnStatus`
    - introduce `TransactionMetadataStore` for TC to store and manage the transaction status
    - enable checkstyle for `pulsar-transaction`
    
    *NOTES*
    
    All the changes are isolated into `pulsar-transaction` module. Hence it will not block any other changes or releases.

 pom.xml                                            |   3 +
 pulsar-transaction/common/pom.xml                  |  72 ++++++
 .../pulsar/transaction/impl/common/TxnID.java      |  48 ++++
 .../pulsar/transaction/impl/common/TxnStatus.java  |  65 ++++++
 .../transaction/impl/common/package-info.java      |  22 ++
 .../transaction/impl/common/TxnStatusTest.java     | 118 ++++++++++
 pulsar-transaction/coordinator/pom.xml             |  46 ++++
 .../coordinator/TransactionCoordinatorID.java      |  36 +++
 .../coordinator/TransactionMetadataStore.java      |  96 ++++++++
 .../TransactionMetadataStoreProvider.java          |  64 ++++++
 .../pulsar/transaction/coordinator/TxnMeta.java    |  95 ++++++++
 .../exceptions/CoordinatorException.java           |  38 ++++
 .../exceptions/InvalidTxnStatusException.java      |  44 ++++
 .../exceptions/TransactionNotFoundException.java   |  39 ++++
 .../coordinator/exceptions/package-info.java       |  22 ++
 .../impl/InMemTransactionMetadataStore.java        | 114 ++++++++++
 .../InMemTransactionMetadataStoreProvider.java     |  38 ++++
 .../transaction/coordinator/impl/TxnMetaImpl.java  | 150 +++++++++++++
 .../transaction/coordinator/impl/package-info.java |  22 ++
 .../transaction/coordinator/package-info.java      |  22 ++
 .../TransactionMetadataStoreProviderTest.java      | 245 +++++++++++++++++++++
 pulsar-transaction/pom.xml                         |  62 ++++++
 22 files changed, 1461 insertions(+)

commit c53e134b74c62760c8a3cde175a550d60379a301
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue May 7 13:00:45 2019 +0800

    update site2/docs/getting-started-clients.md (#4205)
    
    ### Motivation
    Refine some typos when reading the document.
    
    ### Modifications
    Refine sentences to be more clear and concise.

 site2/docs/getting-started-clients.md | 21 ++++++++++-----------
 1 file changed, 10 insertions(+), 11 deletions(-)

commit 0ae032d85df70eec247287e801267713ef31851a
Author: Edward Xie <waterscar@gmail.com>
Date:   Tue May 7 10:17:27 2019 +0800

    Update ingress port from server to 80 (#4204)

 deployment/kubernetes/helm/pulsar/values.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3ce9984c7702cf66a0444bb18d9982ef40cb0859
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 7 04:13:21 2019 +0200

    Use certifi cert collection for TLS in python client (#4216)
    
    The python library is built using a statically linked pulsar
    library. Since it is statically linked, the paths for the default
    certificates are hard coded and likely wrong on most platforms the
    python client runs on.
    
    This patch changes the python library to pull a set of certs from
    certifi, which is then uses as the trust store if the no trust cert is
    specified. For C++, if the trust cert is unspecified, SSL defaults are
    used. This should work fine for C++ if a shared library is being used.

 pulsar-client-cpp/lib/ClientConnection.cc   | 16 ++++++++++------
 pulsar-client-cpp/python/pulsar/__init__.py |  6 +++++-
 pulsar-client-cpp/python/setup.py           |  1 +
 3 files changed, 16 insertions(+), 7 deletions(-)

commit eff287496bfb37cb9335294d7415b1842a78bca1
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 7 00:38:26 2019 +0200

    C++ connection should fail fast if the TLS handshake fails (#4218)

 pulsar-client-cpp/lib/ClientConnection.cc | 6 ++++++
 1 file changed, 6 insertions(+)

commit 575bb1d2d1b1cb62532ea15258468f9207c70d2f
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 7 00:37:46 2019 +0200

    Fix segfault in c++ producer (#4219)
    
    The sendTimer_ may not be initialized if connection doesn't come up
    correctly.

 pulsar-client-cpp/lib/ProducerImpl.cc | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 08fcc215e833594f6c96df4de34ce7d96d92286d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 6 10:24:09 2019 -0700

    Allow users to update auth data during function update (#4198)
    
    * allow users to update auth data during function update

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   6 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |   6 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |   6 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  43 ++++++++
 .../java/org/apache/pulsar/client/admin/Sink.java  |  42 ++++++++
 .../org/apache/pulsar/client/admin/Source.java     |  42 ++++++++
 .../client/admin/internal/FunctionsImpl.java       |  31 +++++-
 .../pulsar/client/admin/internal/SinkImpl.java     |  33 +++++-
 .../pulsar/client/admin/internal/SourceImpl.java   |  33 +++++-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  43 +++++++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  11 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  11 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  10 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  12 ++-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |  12 ++-
 .../pulsar/common/functions/UpdateOptions.java     |  29 ++++++
 .../auth/ClearTextFunctionTokenAuthProvider.java   |  22 +++-
 .../functions/auth/FunctionAuthProvider.java       |   9 +-
 .../pulsar/functions/auth/FunctionAuthUtils.java   |   9 +-
 .../auth/KubernetesFunctionAuthProvider.java       |   4 +-
 .../auth/KubernetesSecretsTokenAuthProvider.java   | 116 +++++++++++++++++++--
 .../functions/auth/NoOpFunctionAuthProvider.java   |  10 +-
 .../functions/runtime/KubernetesRuntime.java       |   8 +-
 .../runtime/KubernetesRuntimeFactory.java          |   6 +-
 .../functions/runtime/ProcessRuntimeFactory.java   |   6 +-
 .../ClearTextFunctionTokenAuthProviderTest.java    |   2 +-
 .../KubernetesSecretsTokenAuthProviderTest.java    |  50 ++++++++-
 .../pulsar/functions/worker/FunctionActioner.java  |   7 +-
 .../functions/worker/rest/api/ComponentImpl.java   |  76 ++++++++++----
 .../functions/worker/rest/api/FunctionsImplV2.java |   2 +-
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |   6 +-
 .../worker/rest/api/v3/SinkApiV3Resource.java      |   6 +-
 .../worker/rest/api/v3/SourceApiV3Resource.java    |   6 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |   6 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |   6 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   6 +-
 36 files changed, 636 insertions(+), 97 deletions(-)

commit 42c3bf94920f1d177a2403e06650500509f94aaa
Author:  <ranxiaolong716@gmail.com>
Date:   Mon May 6 09:13:18 2019 +0800

    [go function] support localrun and cluster mode for go function (#4174)
    
    ### Motivation
    
    Master Issue: #3767
    
    support  local-run and cluster mode for go function.
    
    in go function, we can use:
    
    ```
    ./bin/pulsar-admin functions localrun/create
    --go /Users/wolf4j/github.com/apache/pulsar/pulsar-function-go/examples/outputFunc.go
    --inputs persistent://public/default/my-topic
    --output persistent://public/default/test
    --tenant public
    --namespace default
    --name pulsarfunction
    --classname hellopulsar
    --log-topic logtopic
    ```
    
    Different from `--jar` or `--py`, `--go` uploads a complete executable file(including: instance file + user code file)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  29 +++-
 .../pulsar/common/functions/FunctionConfig.java    |   4 +-
 pulsar-function-go/conf/conf.go                    | 105 +++++++-----
 pulsar-function-go/examples/test/consumer.go       |   2 +-
 pulsar-function-go/examples/test/producer.go       |   2 +-
 pulsar-function-go/pf/instance.go                  |   5 +-
 .../functions/instance/go/GoInstanceConfig.java    |  66 ++++++++
 pulsar-functions/runtime/pom.xml                   |  10 ++
 .../functions/runtime/KubernetesRuntime.java       |   2 +
 .../runtime/KubernetesRuntimeFactory.java          |   4 +-
 .../pulsar/functions/runtime/LocalRunner.java      |  22 ++-
 .../pulsar/functions/runtime/ProcessRuntime.java   |   4 +-
 .../functions/runtime/ProcessRuntimeFactory.java   |   4 +-
 .../pulsar/functions/runtime/RuntimeUtils.java     | 181 ++++++++++++++++++---
 .../DefaultSecretsProviderConfigurator.java        |   2 +
 .../KubernetesSecretsProviderConfigurator.java     |   2 +
 .../functions/utils/FunctionConfigUtils.java       |  40 ++++-
 .../pulsar/functions/worker/FunctionActioner.java  |   2 +
 18 files changed, 394 insertions(+), 92 deletions(-)

commit 93f4d41a52b1add45290f2f834777fd76cb56a87
Author: wpl <1269223860@qq.com>
Date:   Sun May 5 23:29:28 2019 +0800

    [pulsar-doc] fix client-libraries-cp download url error (#4208)

 site2/docs/client-libraries-cpp.md                                 | 4 ++--
 site2/website/scripts/replace.js                                   | 2 +-
 site2/website/versioned_docs/version-2.3.1/client-libraries-cpp.md | 4 ++--
 3 files changed, 5 insertions(+), 5 deletions(-)

commit 96bf9f6156db388e2ad762ed6f471d1f8be3c8a2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat May 4 16:56:22 2019 -0700

    Check for existance of schemaInfo before accessing it (#4203)

 .../src/main/java/org/apache/pulsar/client/impl/MessageImpl.java        | 2 +-
 .../java/org/apache/pulsar/client/impl/TypedMessageBuilderImpl.java     | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 65fe863f84a0446f369e3b5a44f9851c1f53c23d
Author:  <ranxiaolong716@gmail.com>
Date:   Sun May 5 07:49:03 2019 +0800

    [issue#4042] improve java functions API (#4093)
    
    Master Issue: #4042
    
    Fixes #4042
    
    Motivation
    
    improve java functions API, when you need to publish the fields in the TypedMessageBuilder, there is no need to add a new publish method, just modify the interface in the TypedMessageBuilder.

 .../worker/PulsarFunctionPublishTest.java          |   2 +-
 pulsar-functions/api-java/pom.xml                  |   6 +
 .../org/apache/pulsar/functions/api/Context.java   |  31 ++-
 .../pulsar/functions/instance/ContextImpl.java     | 228 ++++++++++++++-------
 .../pulsar/functions/instance/ContextImplTest.java |   2 +-
 .../functions/api/examples/PublishFunction.java    |   9 +-
 ...geConf.java => TypedMessageBuilderPublish.java} |  19 +-
 .../api/examples/UserPublishFunction.java          |  10 +-
 ...ge_conf.py => typed_message_builder_publish.py} |   2 +-
 .../windowing/WindowFunctionExecutor.java          |   2 +-
 .../windowing/WindowFunctionExecutorTest.java      |   8 +
 .../functions/PulsarFunctionsTestBase.java         |   7 +-
 12 files changed, 221 insertions(+), 105 deletions(-)

commit e9619fa597bcb099da79ff9857a854bca86a63db
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 3 10:09:40 2019 -0700

    Avoid payload copy when inserting into managed ledger cache (#4197)

 conf/broker.conf                                   |  3 ++
 conf/standalone.conf                               |  3 ++
 .../mledger/ManagedLedgerFactoryConfig.java        |  5 +++
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    | 45 +++++++++++++++-------
 .../bookkeeper/mledger/impl/EntryCacheManager.java |  2 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  2 +
 .../pulsar/broker/ManagedLedgerClientFactory.java  |  1 +
 site2/docs/reference-configuration.md              |  1 +
 8 files changed, 47 insertions(+), 15 deletions(-)

commit 0dac8d1bda91e5a6855e8de1192fa0ed5ad4733f
Author: lipenghui <codelipenghui@gmail.com>
Date:   Fri May 3 12:24:43 2019 +0800

    Fix issue #4182 (#4187)
    
    Fixes #4182
    
    ### Modifications
    
    Set supportSchemaVersioning to true by default in GenericAvroSchema
    
    ### Verifying this change
    
    Add unit test for support schema versioning in GenericAvroSchema

 .../impl/schema/generic/GenericAvroSchema.java     |  4 ++
 .../schema/SupportVersioningAvroSchemaTest.java    |  2 +
 .../impl/schema/generic/GenericAvroSchemaTest.java | 80 ++++++++++++++++++++++
 3 files changed, 86 insertions(+)

commit 0920e6ae03e26b343f14677cde1196cad88e5cb3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 2 12:30:04 2019 -0700

    provide better error handling logic for when a tenant doesn't exist (#4188)

 .../apache/pulsar/functions/worker/rest/api/ComponentImpl.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit f5c7b22f7d2224e28a81daed6b96c117007e2821
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 2 07:56:55 2019 -0700

    Allow to configure the managed ledger cache eviction frequency (#4066)
    
    * Allow to configure the managed ledger cache eviction frequency
    
    * Fixed test
    
    * Simplified the cache eviction to make it predictable at the configured frequency
    
    * Address comments
    
    * Apply eviction on slowest active reader by preference
    
    * Re-introduced backlogged subscriptions test
    
    * Addressed comments
    
    * Use config option
    
    * Fixed active/inactive logic and read position
    
    * Use dedicated thread for cache evictions
    
    * Added config options in docs
    
    * Fixed tests
    
    * Added time triggered eviction test
    
    * Fixed flaky test
    
    * Fixed tests

 conf/broker.conf                                   |  10 ++
 conf/standalone.conf                               |  10 ++
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  16 +--
 .../mledger/ManagedLedgerFactoryConfig.java        |  17 ++-
 .../apache/bookkeeper/mledger/impl/EntryCache.java |   4 +-
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  21 ++--
 .../bookkeeper/mledger/impl/EntryCacheManager.java |   4 +
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |  11 ++
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |  58 ++++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 131 ++++++++-------------
 .../apache/bookkeeper/mledger/util/RangeCache.java |  43 ++++++-
 .../mledger/impl/EntryCacheManagerTest.java        |  51 +++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  89 +++++++-------
 .../bookkeeper/mledger/util/RangeCacheTest.java    |  23 +++-
 .../apache/pulsar/broker/ServiceConfiguration.java |  10 ++
 .../pulsar/broker/ManagedLedgerClientFactory.java  |   3 +
 .../broker/service/persistent/PersistentTopic.java |   3 +
 .../pulsar/client/api/ConsumerRedeliveryTest.java  |   5 +-
 .../client/api/SimpleProducerConsumerTest.java     |  21 +---
 .../client/api/v1/V1_ProducerConsumerTest.java     |  90 --------------
 site2/docs/reference-configuration.md              |   3 +
 21 files changed, 352 insertions(+), 271 deletions(-)

commit 97bc7e07aedf6bde55882ad7974ff57cb18530c3
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed May 1 21:22:38 2019 -0700

     Use pip2 command for installation (#4191)

 docker/pulsar/scripts/install-pulsar-client-27.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 78dbd9b064d61374c1348ec1531da5929c8edb3d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 1 19:23:02 2019 -0700

    function worker should inherit super users from brokers (#4189)

 .../src/main/java/org/apache/pulsar/PulsarBrokerStarter.java          | 4 ++++
 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java   | 3 +++
 2 files changed, 7 insertions(+)

commit 10b881168b9aeea3ce0369f74fba0eeab7f61a4e
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 1 18:58:10 2019 -0700

    Avoid potentially blocking method during topic ownership check (#4190)

 .../org/apache/pulsar/broker/namespace/NamespaceService.java | 12 +++++++++++-
 .../apache/pulsar/common/naming/NamespaceBundleFactory.java  |  4 ++++
 2 files changed, 15 insertions(+), 1 deletion(-)

commit 30674ddcd04278def71bc49c491d3154301d7582
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 1 11:08:30 2019 -0700

    Allow to configure Postgres in pulsar dashboard with a docker volume (#4123)

 dashboard/Dockerfile               | 12 +++---------
 dashboard/conf/postgresql.conf     |  2 +-
 dashboard/conf/supervisor-app.conf | 20 --------------------
 dashboard/init-postgres.sh         | 32 ++++++++++++++++++++++++++++++++
 dashboard/start.sh                 | 27 +++++++++++++++++++++++++++
 5 files changed, 63 insertions(+), 30 deletions(-)

commit e5b691b77fa70f529e5bb0c8ae668478a6ca4d1b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 1 10:54:08 2019 -0700

    Fix: Function auth should ignore exception because it might be anonymous user (#4185)
    
    * ignore exception because of anonymous user
    
    * fix function authorization bug involving a tenant with no admin
    
    * cleaning up comments
    
    * add tests
    
    * adding tests

 .../worker/PulsarFunctionE2ESecurityTest.java      | 259 +++++++++++++++++++++
 .../auth/KubernetesSecretsTokenAuthProvider.java   |   3 +-
 2 files changed, 261 insertions(+), 1 deletion(-)

commit b9e3b935f8e1a6a49520e76719752f94b98f19ac
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed May 1 09:20:45 2019 -0700

    Update and cleanup test dependencies (#4148)
    
    Update testng ver
    Update testcontainers ver
    Remove arquillian references
    Remove jmockit references

 dev/README.md |  2 +-
 pom.xml       | 12 ++----------
 2 files changed, 3 insertions(+), 11 deletions(-)

commit 2bc10e74493d4688d13b66f8a74fdc82c8637590
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 1 01:56:58 2019 -0700

    fix function authorization bug involving a tenant with no admin (#4186)
    
    * fix function authorization bug involving a tenant with no admin
    
    * cleaning up comments

 .../worker/PulsarFunctionE2ESecurityTest.java      | 18 +++++
 .../functions/worker/rest/api/ComponentImpl.java   | 10 ++-
 .../worker/rest/api/FunctionsImplTest.java         | 90 ++++++++++++++++++++++
 3 files changed, 114 insertions(+), 4 deletions(-)

commit 4b3fb0c1cd4c2c66f078e2f1274300ce3341f67b
Author: Yoann Ciabaud <yciabaud@users.noreply.github.com>
Date:   Tue Apr 30 21:41:38 2019 +0200

    Handle subrecords in complex types (#4050)

 pulsar-client-cpp/python/pulsar/schema/definition.py | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 2e6391168dc1835a109689b2af1db15b89244e27
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 30 12:37:28 2019 -0700

    Added backlog and offloaded size in Prometheus stats (#4150)

 .../java/org/apache/bookkeeper/mledger/ManagedLedger.java  |  5 +++++
 .../apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java  | 14 +++++++++++++-
 .../broker/stats/prometheus/AggregatedNamespaceStats.java  |  6 ++++++
 .../broker/stats/prometheus/NamespaceStatsAggregator.java  | 12 +++++++++---
 .../apache/pulsar/broker/stats/prometheus/TopicStats.java  | 11 +++++++++++
 5 files changed, 44 insertions(+), 4 deletions(-)

commit 436e4ba2f24fc80fc870656bfa635d4a37872b6d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Apr 30 11:08:55 2019 -0700

    WorkerService should inherit authentication configs from broker when running as part of the broker (#4172)

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarBrokerStarter.java | 3 +++
 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java    | 3 +++
 2 files changed, 6 insertions(+)

commit 7f21501e4477e472d1c474956f52147a698cb535
Author: tuteng <eguangning@gmail.com>
Date:   Wed May 1 00:33:34 2019 +0800

    [pulsar-clients]Store key part of a KeyValue schema into pulsar message keys (#4117)
    
    ### Motivation
    
    The current implementation of KeyValue schema stores key and value together as part of message payload. Ideally the key should be stored as part of message key.
    
    It can be done by introducing a property in KeyValue schema to indicate whether store key in payload or as message key.
    
    ### Modifications
    
    * Add keyIsStoredToMessage for encode and decode of KeyValueSchema
    
    ### Verifying this change
    Unit test pass

 .../java/org/apache/pulsar/client/api/Schema.java  |   8 +
 .../client/internal/DefaultImplementation.java     |   9 +
 .../pulsar/common/schema/KeyValueEncodingType.java |  29 +++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  10 +
 .../client/impl/TypedMessageBuilderImpl.java       |  27 +++
 .../pulsar/client/impl/schema/KeyValueSchema.java  |  59 +++++-
 .../apache/pulsar/client/impl/MessageImplTest.java |  88 +++++++-
 .../client/impl/TypedMessageBuilderImplTest.java   | 229 +++++++++++++++++++++
 .../client/impl/schema/KeyValueSchemaTest.java     |  95 +++++++++
 9 files changed, 540 insertions(+), 14 deletions(-)

commit 3fd9168049103165729b4735e123801dd6b8895a
Author: Marc Enriquez <marc@nwd.mx>
Date:   Tue Apr 30 11:21:11 2019 +0200

    WS support for eventtime (#4154)
    
    ### Motivation
    Websockets producer API lacks the message property `eventTime`, even when the client message supports it. This PR introduces support for WS producers to be able to optionally provide such property.
    
    ### Modifications
    The change impacts 2 packages:
    1. `pulsar-common`: within the utilities that this package provides, there's the `DateFormatter` which is used by the WS consumer API to format both the `eventTime` an the `publishTime`. The method `parse(String datetime)` is added to do the reverse process of `format(long timestamp)`. The method was added to this class as it's very close to it's functionality and depends on a private property that already contains proper timezone management.
    2. `pulsar-websocket`: the `eventTime` property is added to `ProducerMessage` class for adequate mapping as a string. If the property is not null when processing the message (`ProducerHandler.onWebSocketText()`) and the parsing fails, a `FailedToDeserializeFromJSON` error is returned (I didn't want to introduce a new type of error); if parsing is successful, the provided `eventTime` is converted to milliseconds and passed to the builder.

 .../java/org/apache/pulsar/common/util/DateFormatter.java   | 12 ++++++++++++
 .../java/org/apache/pulsar/websocket/ProducerHandler.java   | 13 +++++++++++++
 .../org/apache/pulsar/websocket/data/ProducerMessage.java   |  1 +
 3 files changed, 26 insertions(+)

commit 2df13fbb2b351ececbd94471b111352492389d2e
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Apr 30 10:20:14 2019 +0800

    Issue #3654: add documentation for kerberos authentication (#4134)
    
    Fixes #3654
    
    Master Issue: #3491
    
    ### Motivation
    
    add documentation for kerberos authentication

 site2/docs/security-kerberos.md | 283 ++++++++++++++++++++++++++++++++++++++++
 site2/docs/security-overview.md |   2 +
 site2/website/sidebars.json     |   1 +
 3 files changed, 286 insertions(+)

commit b62b341e8265c9859caf04605d8a526d3206d67c
Author: tuteng <eguangning@gmail.com>
Date:   Tue Apr 30 10:18:57 2019 +0800

    [Issue#2734][pulsar-brokers]Add namespace level enforcement on schema validation (#4157)
    
    Fixes #2734
    Master Issue: #2734
    
    ### Motivation
    In 2.2 we have a broker-level setting on enforcing schema validation. in 2.3, we need to add the enforcement to namespace level and eventually get rid of broker-level settings.
    
    ### Modifications
    
    * Add command line arguments for namespace
    * Add rest api interface for namespace
    * Add schema_validation_enforced to class Policies
    * Add unit test
    
    ### Verifying this change
    
    Unit test pass

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  17 ++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  32 ++++
 .../apache/pulsar/broker/service/ServerCnx.java    |   3 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   2 +
 .../service/nonpersistent/NonPersistentTopic.java  |   7 +
 .../broker/service/persistent/PersistentTopic.java |  10 ++
 .../admin/AdminApiSchemaValidationEnforced.java    | 185 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  32 ++++
 .../client/admin/internal/NamespacesImpl.java      |  24 +++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  38 +++++
 .../pulsar/common/policies/data/Policies.java      |  11 +-
 11 files changed, 357 insertions(+), 4 deletions(-)

commit 5c2d5853a86131e8665b3db32de9cff070382bfb
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Apr 29 11:07:19 2019 -0700

    Update bookkeeper ver to 4.9.1 (#4149)
    
    * Update bookkeeper ver to 4.9.1
    
    * Update license files

 distribution/server/src/assemble/LICENSE.bin.txt | 52 ++++++++++++------------
 pom.xml                                          |  2 +-
 pulsar-sql/presto-distribution/LICENSE           | 22 +++++-----
 3 files changed, 38 insertions(+), 38 deletions(-)

commit 1e5b3dd98eba136a68a99bf8106d3258cb1f283d
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Mon Apr 29 15:06:14 2019 -0300

    Revert dup consumer and related code (#4142)
    
    * Revert "[cpp client] implement reference count for close() (#3863)"
    
    This reverts commit ee98e8b28ce1397c056757fe73115d21320ed883.
    
    * Revert Prevent dup consumers and refCount for cpp client
    
    Revert "[cpp client] Bugfix prevent dup consumer for same topic subscription"
    Revert "[Issue #3226][cpp client] Prevent dup consumers on same client cnx"
    
    This reverts commit fff02e2aa2064412dbae18b973eb2bb2abab25d8.
    This reverts commit 762e0ab9a52e2665a106766c211d45474adc833b.
    
    * Revert "Feature - implement reference count for ConsumerImpl (#3795)"
    
    This reverts commit ff4db8db12be2eb79d910e2b286306298f71320e.
    
    * Revert Prevent dup consumers and refCount for java client
    
    Revert "Prevent dup consumers on same client cnx with shared subscription"
    Revert "[java client] Bugfix prevent dup consumers for same topic subscribe"
    
    This reverts commit 231db030b9529737237721059b2a5b3044d4cab1.
    This reverts commit fb5dcd9a58524686f2f6208d41a1e82b5bbb8111.

 .../client/api/SimpleProducerConsumerTest.java     | 112 ---------------------
 pulsar-client-cpp/lib/ClientImpl.cc                |  13 ---
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  12 ---
 pulsar-client-cpp/lib/ConsumerImpl.h               |   3 -
 pulsar-client-cpp/lib/ConsumerImplBase.h           |   1 -
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  82 ---------------
 .../apache/pulsar/client/impl/ConsumerBase.java    |   9 --
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   4 -
 .../pulsar/client/impl/PulsarClientImpl.java       |  19 ----
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   7 +-
 10 files changed, 1 insertion(+), 261 deletions(-)

commit 8561e02c70772ff34bbbedb78b1f0b55776fe512
Author: wpl <1269223860@qq.com>
Date:   Mon Apr 29 04:57:35 2019 -0500

    [pulsar-spark] upgrade SparkStreamingPulsarReceiver.java use pulsar-client and add spark example (#4143)
    
    ### Motivation
    
    upgrade SparkStreamingPulsarReceiver.java use pulsar-client and add spark example
    
    ### Modifications
    
    1. upgrade  SparkStreamingPulsarReceiver.java use pulsar-client, remove pulsar-client-1x pom
    2. add  simple spark example

 examples/pom.xml                                   |   1 +
 examples/spark/pom.xml                             | 131 +++++++++++++++++++++
 .../example/ProducerSparkReceiverData.java         |  54 +++++++++
 .../spark/streaming/receiver/example/README.md     | 107 +++++++++++++++++
 .../SparkStreamingPulsarReceiverExample.java       |  90 ++++++++++++++
 pom.xml                                            |   4 +
 pulsar-spark/pom.xml                               |  14 ++-
 .../pulsar/spark/SparkStreamingPulsarReceiver.java |  89 ++++++++------
 site/docs/latest/adaptors/PulsarSpark.md           |  30 +++--
 site2/docs/adaptors-spark.md                       |  30 +++--
 .../spark/SparkStreamingPulsarReceiverTest.java    |  56 +++++----
 .../SparkStreamingPulsarReceiverExample.java       |  68 -----------
 12 files changed, 526 insertions(+), 148 deletions(-)

commit d85b0c93ceb4aa868108b6b16027d304fd873747
Author: kuangye <732184166@qq.com>
Date:   Mon Apr 29 14:01:11 2019 +0800

    [Issue#4159][pulsar-testclient] Added ['-p','--max-outstanding-across-partitions'] parameter to the producer performance benchmark (#4160)
    
    Fixes: #4159
    
    Master Issue: #4159
    
    **Modifications**
    
    * Added ['-p','--max-multiPartition-outstanding'] parameter to the producer performance benchmark

 .../main/java/org/apache/pulsar/testclient/PerformanceProducer.java | 6 +++++-
 site2/docs/reference-cli-tools.md                                   | 3 +++
 2 files changed, 8 insertions(+), 1 deletion(-)

commit d5ff0828d222775d0562a1b5d589e3f231a1716f
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Sun Apr 28 12:04:45 2019 +0800

    Add the multi version schema support (#3876)
    
    ### Motivation
    
    Fix #3742
    
    In order to decode the message correctly by AVRO schema, we need to know the schema what the message is.
    
    ### Modification
    
    - Introduced Schema Reader and Schema Writer for StructSchema.
       - Reader is used to decode message
       - Writer is used to encode message
    - The implementations of StructSchema, provides their schema reader and writer implementations.
    - Introduced a schema reader cache for caching the readers for different schema versions.

 .../java/org/apache/pulsar/client/api/Schema.java  |  18 +++-
 .../pulsar/client/api/schema/GenericSchema.java    |   2 +-
 .../pulsar/client/api/schema/SchemaDefinition.java |   7 ++
 .../client/api/schema/SchemaDefinitionBuilder.java |  15 ++-
 .../client/api/schema/SchemaInfoProvider.java      |  50 ++++++++++
 .../pulsar/client/api/schema/SchemaReader.java     |  18 ++--
 .../pulsar/client/api/schema/SchemaWriter.java     |  30 ++++++
 .../client/internal/DefaultImplementation.java     |   8 +-
 .../apache/pulsar/common/schema/SchemaInfo.java    |   2 +
 .../org/apache/pulsar/client/impl/MessageImpl.java |   7 +-
 .../client/impl/MultiTopicsConsumerImpl.java       |   7 ++
 .../pulsar/client/impl/PulsarClientImpl.java       |  94 ++++++++++++-------
 .../client/impl/schema/AutoConsumeSchema.java      |  11 +++
 .../pulsar/client/impl/schema/AvroSchema.java      |  85 ++++++-----------
 .../pulsar/client/impl/schema/JSONSchema.java      |  46 +++------
 .../pulsar/client/impl/schema/ProtobufSchema.java  |  87 +++++++++--------
 .../impl/schema/SchemaDefinitionBuilderImpl.java   |  12 ++-
 .../client/impl/schema/SchemaDefinitionImpl.java   |  19 ++--
 .../pulsar/client/impl/schema/StructSchema.java    | 104 +++++++++++++++++----
 .../impl/schema/generic/GenericAvroReader.java     |  79 ++++++++++++++++
 .../impl/schema/generic/GenericAvroSchema.java     |  64 ++++---------
 .../impl/schema/generic/GenericAvroWriter.java     |  55 +++++++++++
 .../impl/schema/generic/GenericJsonReader.java     |  59 ++++++++++++
 .../impl/schema/generic/GenericJsonSchema.java     |  43 ++++-----
 .../impl/schema/generic/GenericJsonWriter.java     |  44 +++++++++
 .../impl/schema/generic/GenericSchemaImpl.java     |  32 ++-----
 .../schema/generic/MultiVersionGenericSchema.java  |  62 ------------
 ...er.java => MultiVersionSchemaInfoProvider.java} |  45 +++++----
 .../client/impl/schema/reader/AvroReader.java      |  58 ++++++++++++
 .../client/impl/schema/reader/JsonReader.java      |  44 +++++++++
 .../client/impl/schema/reader/ProtobufReader.java  |  42 +++++++++
 .../client/impl/schema/writer/AvroWriter.java      |  53 +++++++++++
 .../client/impl/schema/writer/JsonWriter.java      |  42 +++++++++
 .../client/impl/schema/writer/ProtobufWriter.java  |  29 ++++++
 .../client/impl/schema/ProtobufSchemaTest.java     |  21 ++---
 .../client/impl/schema/SchemaBuilderTest.java      |   2 +-
 .../pulsar/client/impl/schema/SchemaTestUtils.java |  12 +++
 .../schema/SupportVersioningAvroSchemaTest.java    |  66 +++++++++++++
 .../impl/schema/generic/GenericAvroReaderTest.java |  86 +++++++++++++++++
 .../impl/schema/generic/GenericSchemaImplTest.java |  64 +++++++++++--
 .../generic/MultiVersionGenericSchemaTest.java     |  90 ------------------
 ...ava => MultiVersionSchemaInfoProviderTest.java} |  13 ++-
 .../io/hbase/sink/HbaseGenericRecordSinkTest.java  |  18 +++-
 .../io/influxdb/InfluxDBGenericRecordSinkTest.java |  14 ++-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    |  21 +++--
 .../pulsar/io/solr/SolrGenericRecordSinkTest.java  |  17 +++-
 .../tests/integration/schema/SchemaTest.java       |  56 ++++++++++-
 .../pulsar/tests/integration/schema/Schemas.java   |  18 ++++
 48 files changed, 1337 insertions(+), 534 deletions(-)

commit d1d5aba085490ce26f0c19873b87381677596258
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Apr 27 09:00:09 2019 -0700

    Added missing unittests for primitive schema types (#4147)
    
    * Added schema information and unittests for primitive schema types
    
    * Fixed unittest
    
    * For primitive types just check for schema type instead of the schema metadata
    
    * Address feedback
    
    * Revert changes to the schemas and only keep unittests

 .../client/impl/schema/BooleanSchemaTest.java      | 65 ++++++++++++++++++
 .../pulsar/client/impl/schema/DateSchemaTest.java  | 75 +++++++++++++++++++++
 .../client/impl/schema/DoubleSchemaTest.java       | 59 +++++++++++++++++
 .../pulsar/client/impl/schema/FloatSchemaTest.java | 53 +++++++++++++++
 .../pulsar/client/impl/schema/IntSchemaTest.java   | 69 +++++++++++++++++++
 .../pulsar/client/impl/schema/LongSchemaTest.java  | 77 ++++++++++++++++++++++
 .../pulsar/client/impl/schema/ShortSchemaTest.java | 65 ++++++++++++++++++
 .../pulsar/client/impl/schema/TimeSchemaTest.java  | 75 +++++++++++++++++++++
 .../client/impl/schema/TimestampSchemaTest.java    | 75 +++++++++++++++++++++
 9 files changed, 613 insertions(+)

commit d69a7ba8ffd593bb86027d69035b29125769877c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Apr 27 13:17:08 2019 +0800

    [website] Add instructions on how to download translated docs (#4133)
    
    * [website] Add instructions on how to download translated docs
    
    * Adopt Jennifer's changes
    
    * Update the README with more instructions

 site2/README.md | 49 ++++++++++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 48 insertions(+), 1 deletion(-)

commit e4c4bf1880af2f0d535a91ca94c0a82648404616
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 26 19:03:08 2019 -0700

    Fixed error deleted a named non-durable cursor (#4144)

 .../apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java  | 14 +++++++++-----
 .../bookkeeper/mledger/impl/NonDurableCursorTest.java      | 11 +++++++++++
 2 files changed, 20 insertions(+), 5 deletions(-)

commit 479f067b9dc58c828560feec0f0061b50a20ef1e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Apr 26 15:56:36 2019 -0700

    [pulsar-broker] clean up producer/consumer result from connection-cache (#4145)

 .../main/java/org/apache/pulsar/broker/service/ServerCnx.java  | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit 07de52d35f04e0bda71d6cdf79ded591cd9040aa
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Apr 26 14:05:43 2019 -0700

    [pulsar-broker] minor fix for removing atomic-updater at managed-ledger (#4146)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java     | 18 ++++++++----------
 1 file changed, 8 insertions(+), 10 deletions(-)

commit fbdf0383492277fbb0589a5485e2171d1f3c3568
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Apr 26 09:08:17 2019 -0700

    [pulsar-broker]Fix: client-producer can't connect due to failed producer-future on cnx (#4138)

 .../java/org/apache/pulsar/broker/service/ServerCnx.java    | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

commit 7674a8f16379f757dcded66b1ce3665ad57f65bd
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 26 09:07:47 2019 -0700

    Removing # TYPE comment from topic metrics in Prometheus (#4136)

 .../broker/stats/prometheus/NamespaceStatsAggregator.java      |  4 ----
 .../org/apache/pulsar/broker/stats/prometheus/TopicStats.java  | 10 ----------
 2 files changed, 14 deletions(-)

commit a669776c428934e29cfc21f8003d5f586dd30693
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Sat Apr 27 00:07:37 2019 +0800

    Update site2/website/pages/en/versions.js (#4132)

 site2/website/pages/en/versions.js | 7 -------
 1 file changed, 7 deletions(-)

commit 4b378a289170403bbead97a68623a12b11576039
Author: lipenghui <penghui@apache.org>
Date:   Fri Apr 26 23:38:17 2019 +0800

    [pulsar-flink] Add subscription initial position (#4129)
    
    ### Motivation
    
    Allow user to specify the initial position for consumer source builder.
    
    ### Modifications
    
    Add initial position for PulsarConsumerSource.

 .../streaming/connectors/pulsar/PulsarConsumerSource.java  |  5 +++++
 .../streaming/connectors/pulsar/PulsarSourceBuilder.java   | 14 ++++++++++++++
 .../connectors/pulsar/PulsarSourceBuilderTest.java         |  7 +++++++
 3 files changed, 26 insertions(+)

commit b3596c41d5930337ca15d05020916c0b5710c6bc
Author: Nick Rivera <heronr@users.noreply.github.com>
Date:   Thu Apr 25 20:39:37 2019 -0700

    [Issue 2461][pulsar-client-cpp] Modified CMake files and source to enable compilation on Windows (#4071)
    
    Fixes #2461
    
    ### Motivation
    
    
    My motivation was to be able to use the pulsar cpp client on Windows systems.
    
    ### Modifications
    
    There are a number of modifications I needed to make to enable Windows compilation
    * Extensive rework of multiple CMakeLists.txt files
    * The creation of a PULSAR_PUBLIC define to define symbol visibility in lieue of #pragma GCC visibility push(default). This is because Windows requires specifying __declspec(dllexport) and __declspec(import) explicitly and does not have a #pragma GCC visibility push(default) analogue.
    * all calls to usleep or sleep have been replaced with calls to boost::this_thread::sleep()
    
    
    
    ### Verifying this change
    
    This change is a trivial rework / code cleanup without any test coverage. However, it does introduce a new platform to test on. It is likely that CI checks will have to be created.

 pulsar-client-cpp/CMakeLists.txt                   | 117 ++++++++++++---------
 pulsar-client-cpp/README.md                        |  31 ++++++
 .../cmake_modules/FindClangTools.cmake             |  11 +-
 pulsar-client-cpp/examples/CMakeLists.txt          |   4 +-
 pulsar-client-cpp/include/pulsar/Authentication.h  |  17 ++-
 .../include/pulsar/BrokerConsumerStats.h           |   8 +-
 pulsar-client-cpp/include/pulsar/Client.h          |   7 +-
 .../include/pulsar/ClientConfiguration.h           |   7 +-
 pulsar-client-cpp/include/pulsar/CompressionType.h |   3 +-
 pulsar-client-cpp/include/pulsar/Consumer.h        |   6 +-
 .../include/pulsar/ConsumerConfiguration.h         |   7 +-
 .../include/pulsar/ConsumerCryptoFailureAction.h   |   4 -
 pulsar-client-cpp/include/pulsar/ConsumerType.h    |   3 +-
 pulsar-client-cpp/include/pulsar/CryptoKeyReader.h |   7 +-
 .../include/pulsar/DeprecatedException.h           |   7 +-
 .../include/pulsar/EncryptionKeyInfo.h             |   7 +-
 pulsar-client-cpp/include/pulsar/InitialPosition.h |   3 +-
 pulsar-client-cpp/include/pulsar/Logger.h          |   9 +-
 pulsar-client-cpp/include/pulsar/Message.h         |  10 +-
 pulsar-client-cpp/include/pulsar/MessageBuilder.h  |   7 +-
 pulsar-client-cpp/include/pulsar/MessageId.h       |  10 +-
 .../include/pulsar/MessageRoutingPolicy.h          |   7 +-
 pulsar-client-cpp/include/pulsar/Producer.h        |   7 +-
 .../include/pulsar/ProducerConfiguration.h         |   8 +-
 .../include/pulsar/ProducerCryptoFailureAction.h   |   4 -
 pulsar-client-cpp/include/pulsar/Reader.h          |   7 +-
 .../include/pulsar/ReaderConfiguration.h           |   7 +-
 pulsar-client-cpp/include/pulsar/Result.h          |   9 +-
 pulsar-client-cpp/include/pulsar/Schema.h          |  11 +-
 pulsar-client-cpp/include/pulsar/TopicMetadata.h   |   6 +-
 .../include/pulsar/c/authentication.h              |  24 ++---
 pulsar-client-cpp/include/pulsar/c/client.h        |  93 ++++++++--------
 .../include/pulsar/c/client_configuration.h        |  74 +++++++------
 pulsar-client-cpp/include/pulsar/c/consumer.h      |  81 +++++++-------
 .../include/pulsar/c/consumer_configuration.h      |  65 ++++++------
 pulsar-client-cpp/include/pulsar/c/message.h       |  49 +++++----
 pulsar-client-cpp/include/pulsar/c/message_id.h    |  17 ++-
 .../include/pulsar/c/message_router.h              |   7 +-
 pulsar-client-cpp/include/pulsar/c/producer.h      |  29 +++--
 .../include/pulsar/c/producer_configuration.h      | 108 ++++++++++---------
 pulsar-client-cpp/include/pulsar/c/reader.h        |  22 ++--
 .../include/pulsar/c/reader_configuration.h        |  43 ++++----
 pulsar-client-cpp/include/pulsar/c/result.h        |   8 +-
 pulsar-client-cpp/include/pulsar/c/string_list.h   |  16 ++-
 pulsar-client-cpp/include/pulsar/c/string_map.h    |  20 ++--
 pulsar-client-cpp/include/pulsar/defines.h         |  44 ++++++++
 pulsar-client-cpp/lib/Backoff.cc                   |   8 +-
 pulsar-client-cpp/lib/Backoff.h                    |  10 +-
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |   7 +-
 pulsar-client-cpp/lib/BoostHash.h                  |   6 +-
 pulsar-client-cpp/lib/BrokerConsumerStats.cc       |   5 +-
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.h    |   7 +-
 pulsar-client-cpp/lib/CMakeLists.txt               |  87 +++++++++++----
 pulsar-client-cpp/lib/ClientConnection.h           |   3 +-
 pulsar-client-cpp/lib/CompressionCodec.h           |  12 +--
 pulsar-client-cpp/lib/CompressionCodecZLib.h       |   6 +-
 pulsar-client-cpp/lib/ConnectionPool.h             |   5 +-
 pulsar-client-cpp/lib/EncryptionKeyInfoImpl.h      |   7 +-
 pulsar-client-cpp/lib/ExecutorService.h            |   9 +-
 pulsar-client-cpp/lib/Future.h                     |   4 -
 pulsar-client-cpp/lib/JavaStringHash.h             |   6 +-
 pulsar-client-cpp/lib/Latch.h                      |   7 +-
 pulsar-client-cpp/lib/Log4CxxLogger.h              |   7 +-
 pulsar-client-cpp/lib/LogUtils.h                   |  10 +-
 pulsar-client-cpp/lib/Message.cc                   |   8 +-
 pulsar-client-cpp/lib/MessageId.cc                 |  26 ++---
 .../lib/MultiTopicsBrokerConsumerStatsImpl.h       |   6 +-
 pulsar-client-cpp/lib/Murmur3_32Hash.h             |   5 +-
 pulsar-client-cpp/lib/NamespaceName.h              |   5 +-
 pulsar-client-cpp/lib/ObjectPool.h                 |   2 +-
 .../lib/PartitionedBrokerConsumerStatsImpl.h       |   5 +-
 pulsar-client-cpp/lib/Result.cc                    |   7 +-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |   5 +-
 pulsar-client-cpp/lib/Schema.cc                    |  11 +-
 .../lib/SinglePartitionMessageRouter.h             |   5 +-
 pulsar-client-cpp/lib/TopicMetadataImpl.h          |   5 +-
 pulsar-client-cpp/lib/TopicName.h                  |   7 +-
 pulsar-client-cpp/lib/Url.cc                       |   2 +-
 pulsar-client-cpp/lib/Url.h                        |   7 +-
 pulsar-client-cpp/lib/auth/AuthAthenz.cc           |   1 -
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc     |   4 +
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.h      |   6 +-
 pulsar-client-cpp/lib/c/c_MessageId.cc             |   8 ++
 pulsar-client-cpp/lib/checksum/ChecksumProvider.h  |  13 +--
 pulsar-client-cpp/lib/checksum/crc32c_sw.cc        |   4 -
 pulsar-client-cpp/perf/CMakeLists.txt              |   2 +-
 pulsar-client-cpp/perf/PerfProducer.cc             |   4 +-
 pulsar-client-cpp/python/CMakeLists.txt            |   8 +-
 pulsar-client-cpp/python/src/enums.cc              |  30 +++---
 pulsar-client-cpp/tests/BackoffTest.cc             |   3 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  43 ++++----
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  11 +-
 pulsar-client-cpp/tests/CMakeLists.txt             |  11 +-
 pulsar-client-cpp/tests/ClientDeduplicationTest.cc |   3 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |   9 +-
 95 files changed, 787 insertions(+), 736 deletions(-)

commit f1f6b0cb0cc22172cd90c33399621f1e484bdb55
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Apr 26 11:23:29 2019 +0800

    update site2/docs/concepts-overview.md file (#4114)
    
    ### Motivation
    Refine some typos when reading the document.
    
    ### Modifications
    1. Refine some sentences to be a little more smooth.
    2. Avoid using s to show the possessive form of inanimate objects.
    3. Add periods for all lists. It is to keep styles consistent.

 site2/docs/getting-started-standalone.md | 91 ++++++++++++++++----------------
 1 file changed, 45 insertions(+), 46 deletions(-)

commit c1b84428374fcf4b0eedc3305437a85635c8e12b
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Apr 26 11:22:49 2019 +0800

    [Doc] Update the site2/README.md file (#4130)
    
    ### Motivation
    We've applied GSoD project for Pulsar docs, and more contributors might read this file, I some typos when reading the document.
    
    ### Modifications
    1. Delete the redundant link and information on versioning for Line 169.
    2. Refine some sentences to be a little more smooth.
    3. Improve notes in the `Running the site locally` section.

 site2/README.md | 98 ++++++++++++++++++++++++++++-----------------------------
 1 file changed, 48 insertions(+), 50 deletions(-)

commit 5f0242e6a9009a5fc7603632bfcfb2b00e1bbc4e
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Apr 25 20:17:01 2019 -0700

    Update Scala plugin enforce java source and target version (#4113)
    
    This updates the scala compiler plugin and also add java source and target properties to successfully start compilation and packaging with openjdk11.

 examples/flink/pom.xml | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 28fc66a889619e7c2d9bf135ae739bc44c619bbf
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Apr 26 11:15:50 2019 +0800

    Add sensitive annotations for Solr/RabbitMQ connector. (#4115)
    
    ### Motivation
    
    Add sensitive annotations for Solr/RabbitMQ connector.
    
    ### Modifications
    
    Add sensitive annotations for username/passwd fields.

 .../main/java/org/apache/pulsar/io/rabbitmq/RabbitMQAbstractConfig.java | 2 ++
 .../solr/src/main/java/org/apache/pulsar/io/solr/SolrSinkConfig.java    | 2 ++
 2 files changed, 4 insertions(+)

commit ceaa253b0740880cf27e2a3e4a5f18de8df8e18f
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Apr 26 11:15:21 2019 +0800

    [Doc] Update the site2/docs/getting-started-docker.md file (#4121)
    
    ### Motivation
    Refine the command and some typos when reading the document.
    
    ### Modifications
    1. In `Starting Pulsar inside Docker` section, refine the command from `{{site.current_version}}` to `{{pulsar:version}}`.
    2. Refine some sentences to be a little more smooth.

 site2/docs/getting-started-docker.md | 47 +++++++++++++++++-------------------
 1 file changed, 22 insertions(+), 25 deletions(-)

commit 54db80432508862b22b07a020eb8f185836b73e5
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 25 14:09:32 2019 -0700

    Less verbose error message for lookup failure (#4135)

 .../apache/pulsar/client/impl/BinaryProtoLookupService.java    | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 508fe22c2e44c4d9aef5e8a7fa9f914b96ed16db
Author: lipenghui <codelipenghui@gmail.com>
Date:   Thu Apr 25 21:42:26 2019 +0800

    PIP-34 Add flag to enable or disable Key_Shared subscription. (#4120)
    
    ### Motivation
    
    Add a broker level flag to enable or disable Key_Shared subscription, disabled by default.
    
    ### Modifications
    
    Add a flag named `subscriptionRedeliveryTrackerEnabled`
    Add documentation to describe Key_Shared subscription is a beta feature.

 conf/broker.conf                                       |  3 +++
 .../org/apache/pulsar/broker/ServiceConfiguration.java |  7 +++++++
 .../broker/service/persistent/PersistentTopic.java     |  8 ++++++++
 .../pulsar/client/api/KeySharedSubscriptionTest.java   | 18 +++++++++++++++---
 site2/docs/concepts-messaging.md                       |  2 ++
 5 files changed, 35 insertions(+), 3 deletions(-)

commit 2777b0e4bd6d1a70b1343b2834c2630e6a7e1e5d
Author: Jia Zhai <zhaijia@apache.org>
Date:   Thu Apr 25 21:28:40 2019 +0800

    Issue #3653: Kerberos authentication for web resource support (#4097)
    
    Fixes #3653
    
    Master Issue: #3491
    
    ** Motivation
    Add kerberos support for web resource support.
    This mainly include 2 parts:
    
    - the HttpClient that works for HttpLookup.
    - the BaseResource that works for admin rest end point.
    
    *** Modifications
    For kerberos authentication, there need several back/forth requests to do the negotiation between client and server.
    This change add a method authenticationStage in AuthenticationSasl, and a method authenticateHttpRequest in AuthenticationProviderSasl to do the mutual negotiation.
    And a saslRoleToken is cached in AuthenticationSasl once the authentication get success.
    When do the sasl authentication, it will first use saslRoleToken cache, and if sever check this token failed, do real sasl authentication.
    Changed unit test SaslAuthenticateTest, which enable sasl authentication in admin and also use http lookup to verify the change.

 conf/broker.conf                                   |   5 -
 .../authentication/AuthenticationProviderSasl.java | 185 ++++++++++++++++-
 .../broker/authentication/PulsarSaslServer.java    |  12 --
 .../SaslAuthenticationDataSource.java              |   6 -
 .../authentication/SaslAuthenticationState.java    |  15 +-
 .../broker/authentication/SaslRoleToken.java       | 228 +++++++++++++++++++++
 .../broker/authentication/SaslRoleTokenSigner.java | 107 ++++++++++
 .../ProxySaslAuthenticationTest.java               |  27 ++-
 .../authentication/SaslAuthenticateTest.java       |  91 +++++++-
 .../authentication/SaslServerTokenSignerTest.java  | 111 ++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  10 -
 .../authentication/AuthenticationProvider.java     |  10 +
 .../broker/authentication/AuthenticationState.java |  11 +-
 .../pulsar/broker/web/AuthenticationFilter.java    |  48 ++++-
 .../apache/pulsar/broker/service/ServerCnx.java    |   7 -
 .../pulsar/broker/web/PulsarWebResource.java       |  24 +--
 .../org/apache/pulsar/broker/web/WebService.java   |   5 +-
 .../pulsar/client/admin/internal/BaseResource.java |  56 ++++-
 .../client/admin/internal/ComponentResource.java   |  31 ++-
 .../client/admin/internal/FunctionsImpl.java       |   8 +-
 .../pulsar/client/admin/internal/SinkImpl.java     |   4 +-
 .../pulsar/client/admin/internal/SourceImpl.java   |   4 +-
 .../apache/pulsar/client/api/Authentication.java   |  26 ++-
 .../client/api/AuthenticationDataProvider.java     |   2 +-
 pulsar-client-auth-sasl/pom.xml                    |   5 +
 .../client/impl/auth/AuthenticationSasl.java       | 214 ++++++++++++++++++-
 .../impl/auth/SaslAuthenticationDataProvider.java  |  19 ++
 .../org/apache/pulsar/client/impl/HttpClient.java  | 116 ++++++-----
 .../apache/pulsar/common/sasl/SaslConstants.java   |  26 +++
 .../apache/pulsar/websocket/WebSocketService.java  |   5 +-
 .../websocket/admin/WebSocketWebResource.java      |   2 +-
 31 files changed, 1242 insertions(+), 178 deletions(-)

commit c642e5d951fe696e3a9187829f3ae0a413769dd6
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Apr 25 13:37:09 2019 +0800

    [pulsar-io] [doc] Add docs for Redis sink (#4046)
    
    ### Motivation
    
    Add docs for Redis sink.
    
    ### Modifications
    
    Add `io-redis.md`.

 site2/docs/io-connectors.md |  1 +
 site2/docs/io-redis.md      | 27 +++++++++++++++++++++++++++
 2 files changed, 28 insertions(+)

commit 824a6541d1d5644e57686d14a31745f3e3df3e30
Author: tuteng <eguangning@gmail.com>
Date:   Thu Apr 25 13:36:14 2019 +0800

    [pulsar-clients]Save name, type, properties for KeyValueSchema (#4108)
    
    
    ### Motivation
    
    The current keySchemaInfo and valueSchenamaInfo of KeyValueSchemahas no saved name, type and properties.
    
    ### Modifications
    
    Save name, type, properties for keySchemaInfo and valueSchemaInfo of KeyValueSchema
    
    ### Verifying this change
    
    Test pass

 .../pulsar/client/impl/schema/KeyValueSchema.java  | 19 ++++++++++++--
 .../client/impl/schema/KeyValueSchemaTest.java     | 29 ++++++++++++++++++++++
 2 files changed, 46 insertions(+), 2 deletions(-)

commit 49b37726bd09bbe02f91ac223f3ab4910b5a3f30
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Apr 25 13:33:38 2019 +0800

    Update command-line tools doc to catch up the work. (#4116)
    
    ### Motivation
    
    Catch up the command-line tools doc.
    
    ### Modifications
    
    Add some missing subcommands and other updates.

 site2/docs/reference-cli-tools.md | 112 +++++++++++++++++++++++++++++++++++---
 1 file changed, 105 insertions(+), 7 deletions(-)

commit 25662b428e30f06385386e7f840e45fac13e7f4e
Author: Grant Wu <grantwwu@gmail.com>
Date:   Thu Apr 25 08:14:34 2019 +0300

    Clarify initial subscription positioning (#4126)

 site2/docs/concepts-clients.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4e84d5bdb9c74876150f67edb6eb05167f8ed943
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 24 21:44:50 2019 -0700

    Function use negative acknowledge (#4103)
    
    * Functions use neg ack
    
    * add neg ack for python functions
    
    * adding tests
    
    * refactoring maven project
    
    * remove unnecessary edit
    
    * fix pom due to maven bug

 .../instance/stats/FunctionStatsManager.java       |   3 -
 .../functions/instance/stats/SinkStatsManager.java |   3 -
 .../instance/stats/SourceStatsManager.java         |   3 -
 .../pulsar/functions/source/PulsarSource.java      |   1 +
 .../instance/src/main/python/function_stats.py     |   8 +-
 .../instance/src/main/python/python_instance.py    |   6 +
 tests/docker-images/java-test-functions/pom.xml    |  81 ++++++++++
 .../integration/functions/ExceptionFunction.java   |  35 ++++
 .../docker-images/latest-version-image/Dockerfile  |   2 +
 tests/docker-images/latest-version-image/pom.xml   |  30 ++++
 .../python-examples/exception_function.py          |  29 ++++
 tests/docker-images/pom.xml                        |   1 +
 .../integration/functions/PulsarFunctionsTest.java | 176 +++++++++++++++++++++
 .../functions/PulsarFunctionsTestBase.java         |   7 +-
 .../functions/utils/CommandGenerator.java          |   2 +-
 15 files changed, 371 insertions(+), 16 deletions(-)

commit 95730510d03aa60bf33baa41fedc80ec6cc60e02
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Wed Apr 24 17:38:26 2019 -0300

    Improve tests for ReaderImpl and ManagedLedgerImpl (#4122)
    
    - Improve timing tests replacing *before* and *after* class annotation instead
        of per method in TopicReaderTest. In this case there isn't any real need to
        setup the entire test environment for each test.
      - Improve tests from latest changes in Reader in order to use
        testMessageOrderAndDuplicates method.
      - Prevents non-durable cursor being built with null cursor name.
      - Add tests to assert cache on non-durable cursor implementation.
      - Fix missed close() method from TopicReaderTest.

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  5 ++-
 .../mledger/impl/NonDurableCursorTest.java         | 46 ++++++++++++++++++++++
 .../apache/pulsar/client/api/TopicReaderTest.java  | 42 ++++++++++++++------
 3 files changed, 80 insertions(+), 13 deletions(-)

commit 1c7b12d379cf36183d60919dcaff75e4d6cf63f2
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Apr 24 12:37:25 2019 +0800

    [Issue 4106] [pulsar-testclient] Improve usage hints for pulsar-perf subcommands (#4107)
    
    * Improve usage hints for pulsar-perf subcommands.
    
    * Change word prop to tenant

 .../proxy/socket/client/PerformanceClient.java     |  6 +++---
 .../apache/pulsar/testclient/BrokerMonitor.java    | 24 ++++++++++++++--------
 .../pulsar/testclient/LoadSimulationClient.java    |  4 +++-
 .../testclient/LoadSimulationController.java       |  8 ++++++--
 .../pulsar/testclient/ManagedLedgerWriter.java     |  4 ++--
 .../pulsar/testclient/PerformanceConsumer.java     |  2 +-
 .../pulsar/testclient/PerformanceProducer.java     |  2 +-
 .../pulsar/testclient/PerformanceReader.java       |  2 +-
 8 files changed, 33 insertions(+), 19 deletions(-)

commit 5e96a9c99a46e4c52a339ba681157f9a3c4b2096
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Apr 23 21:37:03 2019 -0700

    [pulsar-broker] schedule one add/read timeout task per ml/topic (#4111)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 160 ++++++++++++---------
 .../bookkeeper/mledger/impl/OpReadEntry.java       |   3 -
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  32 +++--
 3 files changed, 116 insertions(+), 79 deletions(-)

commit ccea6245bc08358e1ccccb55aa4cd20c7c8b534d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 23 10:41:24 2019 -0700

    Reduce number of hashmap sections for ledger handles cache (#4102)

 .../java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit c70438c63d4a12015763d2b93f65b3cd14a9635f
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Tue Apr 23 14:40:17 2019 -0300

    Feature - support seek() on Reader (#4031)
    
    
    *Motivation*
    
     fix #3976
    
    According to what was discussed in pull #3983 it would be an acceptable solution
    to add seek() command to Reader in order to reset a non durable cursor after
    Reader instance was build.
    
    *Modifications*
    
      - Bugfix reset() by timestamp on a non-durable consumer, previously the
        cached cursor was not present, therefore the state set by reset() was missed
        resulting in a reset() at the beginning of the cursor instead of a reset()
        at the expected position.
      - Copy seek() commands to Reader interface from Consumer interface.
      - Fix inconsistency with lastDequeuedMessage field after seek() command was
        performed successfully.
      - Fix consumer discarding messages on receive (after seek() command) due to
        messages being present on acknowledge grouping tacker.

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  17 ++-
 .../apache/pulsar/client/api/TopicReaderTest.java  | 122 +++++++++++++++++++++
 .../java/org/apache/pulsar/client/api/Reader.java  |  59 ++++++++++
 .../impl/AcknowledgmentsGroupingTracker.java       |   1 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   6 +
 ...NonPersistentAcknowledgmentGroupingTracker.java |   5 +
 .../PersistentAcknowledgmentsGroupingTracker.java  |   7 ++
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  29 +++--
 8 files changed, 237 insertions(+), 9 deletions(-)

commit bd7b0cfe6860b91fde3fa7e4c0fdf6a870191e46
Author: cckellogg <cckellogg@gmail.com>
Date:   Tue Apr 23 08:25:22 2019 -0700

    Only set pular envs if not already set in the environment. (#4105)

 bin/pulsar         | 2 +-
 conf/pulsar_env.sh | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 3f779a401ab72d39150d3df4958660b58ac0e59c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 22 22:01:14 2019 -0700

    Reduce memory used in ClientCnx for pending lookups (#4104)
    
    ### Motivation
    
    Currently, each `ClientCnx` has a blocking queue for the max number of pending lookup requests. By default that ends up using an array of 45K objects. When a single process handles many connections (eg: broker or proxy), that will end up using 200K per connection just for this.
    
    ### Modifications
    
    Instead of using the fixed array size, use semaphore and a `ConcurrentLinkedQueue`
    
    * Reduce memory used in ClientCnx for pending lookups
    
    * Fixed semaphore size

 .../org/apache/pulsar/client/impl/ClientCnx.java   | 41 ++++++++++++----------
 1 file changed, 23 insertions(+), 18 deletions(-)

commit d5036eaefcba42e6c9d159ffb14bee597d13380f
Author:  <rxl5555555@qq.com>
Date:   Tue Apr 23 12:59:33 2019 +0800

    [go schema] support go schema for pulsar-client-go (#3904)
    
    
    Signed-off-by: xiaolong.ran ranxiaolong716@gmail.com
    
    Master Issue: #3855
    
    Motivation
    support go schema for pulsar-client-go

 pulsar-client-cpp/include/pulsar/Schema.h          |  52 +--
 .../include/pulsar/c/consumer_configuration.h      |   5 +
 .../include/pulsar/c/producer_configuration.h      |  23 +
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc |   8 +
 pulsar-client-cpp/lib/c/c_ProducerConfiguration.cc |   7 +
 pulsar-client-go/go.mod                            |   7 +
 pulsar-client-go/go.sum                            |  15 +
 pulsar-client-go/pulsar/c_client.go                |  74 ++-
 pulsar-client-go/pulsar/c_consumer.go              |  60 ++-
 pulsar-client-go/pulsar/c_message.go               |  11 +-
 pulsar-client-go/pulsar/c_producer.go              |  77 +++-
 pulsar-client-go/pulsar/c_reader.go                |  13 +-
 pulsar-client-go/pulsar/client.go                  |   8 +-
 pulsar-client-go/pulsar/consumer.go                |   4 +
 pulsar-client-go/pulsar/consumer_test.go           |   7 +-
 pulsar-client-go/pulsar/message.go                 |   6 +
 pulsar-client-go/pulsar/pb/build.sh                |  23 +
 pulsar-client-go/pulsar/pb/hello.pb.go             | 100 ++++
 pulsar-client-go/pulsar/pb/hello.proto             |  25 +
 pulsar-client-go/pulsar/primitiveSerDe.go          | 318 +++++++++++++
 pulsar-client-go/pulsar/primitiveSerDe_test.go     | 145 ++++++
 pulsar-client-go/pulsar/producer.go                |   2 +
 pulsar-client-go/pulsar/producer_test.go           |   3 +-
 pulsar-client-go/pulsar/reader.go                  |   2 +
 pulsar-client-go/pulsar/reader_test.go             |   2 +-
 pulsar-client-go/pulsar/schema.go                  | 504 +++++++++++++++++++++
 pulsar-client-go/pulsar/schemaDef_test.go          |  58 +++
 pulsar-client-go/pulsar/schema_test.go             | 436 ++++++++++++++++++
 .../pulsar/{util_test.go => testhelps.go}          |   0
 29 files changed, 1935 insertions(+), 60 deletions(-)

commit 897340632fc1b5bfd2eee28d0da2278c7bb44169
Author: Nick Rivera <heronr@users.noreply.github.com>
Date:   Mon Apr 22 16:57:17 2019 -0700

    Protect against double joining the worker thread in (#4084)
    
    ExecutorService::close() because joining is not re-entrant on Windows

 pulsar-client-cpp/lib/ExecutorService.cc | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 789075013b404780a62c89b2acfea343680d73b3
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Mon Apr 22 18:54:07 2019 -0300

    Feature / Interceptor for negative ack redelivery (#3962)
    
    * Feature / Interceptor for negative ack redelivery
    
    *Motivation*
    
    In some scenarios is it helpful to be able to set interceptor for redeliveries
    being happening due to negative acknowledge.
    
    *Modifications*
    
      - Add onNegativeAcksSend() method in ConsumerInterceptor interface.
      - Add handler for onNegativeAcksSend() interceptor in ConsumerBase.
      - Favor forEach on ConsumerInterceptor instead of classic for loop by index.
      - Optimization for each by index to avoid compute size() every iteration.
      - Add call method to onNegativeAckRedelivery() from NegativeAcksTracker.
    
    * Add test case for onNegativeAcksSend interceptor

 .../apache/pulsar/client/api/InterceptorsTest.java | 88 ++++++++++++++++++++++
 .../pulsar/client/api/ConsumerInterceptor.java     | 13 ++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  6 ++
 .../pulsar/client/impl/ConsumerInterceptors.java   | 30 +++++++-
 .../pulsar/client/impl/NegativeAcksTracker.java    |  1 +
 5 files changed, 134 insertions(+), 4 deletions(-)

commit 981983ffc5c98d14068322e4ab64762272c73d77
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 22 14:53:42 2019 -0700

    Ensure Pulsar HTTP proxy carries over Authorization header after 307 redirects (#4059)
    
    * Ensure Pulsar HTTP proxy carries over Authorization header after 307 redirects
    
    * Fixed typo in comment

 .../pulsar/proxy/server/AdminProxyHandler.java     | 33 ++++++++++++++++++++--
 .../token/PulsarTokenAuthenticationBaseSuite.java  |  6 ++++
 2 files changed, 37 insertions(+), 2 deletions(-)

commit 2373ca36fa0d84103c0feed357da1fbb52119d05
Author: lipenghui <penghui@apache.org>
Date:   Mon Apr 22 15:57:19 2019 +0800

    PIP-34 Key_Shared subscription core implementation. (#4079)
    
    ## Motivation
    This is a core implementation for PIP-34 and there is a task tracker ISSUE-4077 for this PIP
    
    ## Modifications
    Add a new subscription type named Key_Shared
    Add PersistentStickyKeyDispatcherMultipleConsumers to handle the message dispatch
    Add a simple hash range based consumer selector
    Verifying this change
    Add new unit tests to verifying the hash range selector and Key_Shared mode message consume.
    
    
    * PIP-34 Key_Shared subscription core implementation.
    * PIP-34 Add more unit test.
    1.test redelivery with Key_Shared subscription
    2.test none key dispatch with Key_Shared subscription
    3.test ordering key dispatch with Key_Shared subscription
    * PIP-34 Fix alignment issue of Pulsar.proto
    * PIP-34 Fix TODO: format
    * PIP-34 Fix hash and ordering key issues
    * PIP-34 documentation for Key_Shared subscription
    * PIP-34 Fix cpp test issue.
    * PIP-34 Fix cpp format issue.

 .../broker/service/BrokerServiceException.java     |   9 +
 .../org/apache/pulsar/broker/service/Consumer.java |   2 +-
 .../HashRangeStickyKeyConsumerSelector.java        | 149 ++++++++++
 .../broker/service/StickyKeyConsumerSelector.java  |  45 +++
 .../PersistentDispatcherMultipleConsumers.java     |  32 +-
 ...istentStickyKeyDispatcherMultipleConsumers.java | 159 ++++++++++
 .../service/persistent/PersistentSubscription.java |   5 +
 .../HashRangeStickyKeyConsumerSelectorTest.java    | 141 +++++++++
 .../client/api/KeySharedSubscriptionTest.java      | 330 +++++++++++++++++++++
 .../java/org/apache/pulsar/client/api/Message.java |  15 +
 .../apache/pulsar/client/api/SubscriptionType.java |  11 +-
 .../pulsar/client/api/TypedMessageBuilder.java     |   9 +
 pulsar-client-cpp/include/pulsar/Result.h          |   4 +-
 pulsar-client-cpp/lib/ClientConnection.cc          |   3 +
 pulsar-client-cpp/lib/Result.cc                    |   3 +
 .../apache/pulsar/client/impl/ConsumerBase.java    |   3 +
 .../java/org/apache/pulsar/client/impl/Hash.java   |   3 +-
 .../apache/pulsar/client/impl/JavaStringHash.java  |   8 +
 .../org/apache/pulsar/client/impl/MessageImpl.java |  12 +
 .../apache/pulsar/client/impl/Murmur3_32Hash.java  |  67 +----
 .../pulsar/client/impl/TopicMessageImpl.java       |  10 +
 .../client/impl/TypedMessageBuilderImpl.java       |   7 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 126 ++++++++
 .../java/org/apache/pulsar/common/util/Hash.java   |  29 ++
 .../apache/pulsar/common/util/Murmur3_32Hash.java  | 101 +++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  13 +-
 .../assets/pulsar-key-shared-subscriptions.png     | Bin 0 -> 124310 bytes
 site2/docs/assets/pulsar-subscription-modes.png    | Bin 66178 -> 220423 bytes
 site2/docs/concepts-messaging.md                   |  23 +-
 29 files changed, 1229 insertions(+), 90 deletions(-)

commit 1026b07327b26fc416b2735668ad84a625345adb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Apr 21 21:18:57 2019 -0700

     deprecate and relocate connector related endpoints in functions REST API (#4087)
    
    * deprecate and relocate connector related endpoints in functions REST API
    
    * cleaning up
    
    * cleaning up

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  4 ++++
 .../org/apache/pulsar/broker/admin/v2/Worker.java  | 18 ++++++++++++++++
 .../org/apache/pulsar/client/admin/Functions.java  |  9 ++++++++
 .../pulsar/functions/worker/rest/RestUtils.java    |  6 ++++++
 .../functions/worker/rest/api/ComponentImpl.java   |  7 +------
 .../pulsar/functions/worker/rest/api/SinkImpl.java |  2 ++
 .../functions/worker/rest/api/SourceImpl.java      |  2 ++
 .../functions/worker/rest/api/WorkerImpl.java      | 24 ++++++++++++++--------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  4 ++++
 .../worker/rest/api/v2/WorkerApiV2Resource.java    | 12 +++++++++++
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |  4 ++++
 11 files changed, 77 insertions(+), 15 deletions(-)

commit f81a7114805eb05ec8d42902c0e541bc8a452566
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Apr 21 19:25:59 2019 -0700

    [pulsar-function] support bookie authentication from function-worker (#4088)
    
    ### Motivation
    Function worker uses bookie and zookeeper to store function's executable. However, function doesn't support authentication while connecting to bookie so, dbLog initialize fails when bookie requires auth&auth.
    
    ### Modification
    Add bk-client authentication param to worker-config.

 conf/functions_worker.yml                                 | 10 ++++++++++
 .../terraform-ansible/templates/functions_worker.yml      |  9 +++++++++
 .../org/apache/pulsar/functions/worker/WorkerConfig.java  | 15 +++++++++++++++
 .../org/apache/pulsar/functions/worker/WorkerUtils.java   |  8 ++++++++
 4 files changed, 42 insertions(+)

commit 8b1c33814d2741df95fa16515e4f3cf5f6086d57
Author: Ever <ieverx@outlook.com>
Date:   Sun Apr 21 22:09:21 2019 +0800

    Make generate_protobuf_docker.sh usable on windows (#4020)
    
    ### Motivation
    
    On windows, `generate_protobuf_docker.sh` cannot work well, because a ':' is contained in windows path.  Just make it work.
    
    ### Modifications
    
    change generate_protobuf_docker.sh

 pulsar-common/generate_protobuf_docker.sh | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 1e097cbced91789d8515744cb20d1fecc17b3b41
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Sun Apr 21 22:06:34 2019 +0800

    [pulsar-proxy]Add the LookupProxyHandler handle getSchema request and test (#4083)
    
    ### Motivation
    In order to support #3742 #3876.
    Now, proxy handle ProxyLookupRequests don't support GetSchema.
    
    ### Modifications
    Add the getSchema method implementation in ProxyConnection
    
    ### Verifying this change
    Add new a test in ProxyTest testGetSchema()
    
    ### Dependencies (does it add or upgrade a dependency): (yes / no)
    The public API: (no)
    The schema: (no)
    The default values of configurations: (no)
    The wire protocol: (no)
    The rest endpoints: (yes)
    The admin cli options: (no)
    Anything that affects deployment: (no)
    ### Documentation
    Does this pull request introduce a new feature? (no)
    If yes, how is the feature documented? (no)
    If a feature is not documented yet in this PR, please create a followup issue for adding the documentation

 .../pulsar/proxy/server/LookupProxyHandler.java    | 125 ++++++++++++++++-----
 .../pulsar/proxy/server/ProxyConnection.java       |   7 ++
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  44 ++++++++
 3 files changed, 151 insertions(+), 25 deletions(-)

commit 7b2bf95cbd87515adb679323b05276ae6a335362
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 20 17:44:21 2019 -0700

    For functions metrics in prometheus also remove TYPE (#4081)

 .../instance/stats/PrometheusTextFormat.java        | 21 ---------------------
 1 file changed, 21 deletions(-)

commit 84a414183bfd5b378e9bd0116767bc57136da755
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Apr 20 13:20:22 2019 -0700

    Fix: set receive queue size for sinks (#4091)
    
    * fix setting recieve queue size for sinks
    
    * fix setting recieve queue size for sinks

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 102 ++++++++++++---------
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   1 -
 .../pulsar/functions/utils/SinkConfigUtils.java    |  21 +++--
 .../functions/utils/SinkConfigUtilsTest.java       |   2 +-
 4 files changed, 75 insertions(+), 51 deletions(-)

commit c3e8a33ab3b7139bd18503082e763bb39a534b06
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Apr 20 10:14:24 2019 -0700

    Optimizing performance for Pulsar function archive download (#4082)
    
    * Optimizing performance for download
    
    * fixing update and create
    
    * fix upload
    
    * remove commented out code
    
    * remove blank lines
    
    * fix error messages
    
    * fix for sources and sinks
    
    * fix getting exception
    
    * fix auth headers
    
    * cleaning up
    
    * fix print messages

 .../apache/pulsar/client/admin/PulsarAdmin.java    |  23 +++-
 .../pulsar/client/admin/PulsarAdminException.java  |  20 +++-
 .../pulsar/client/admin/internal/BaseResource.java |   4 +-
 .../client/admin/internal/ComponentResource.java   |  47 ++++++++
 .../client/admin/internal/FunctionsImpl.java       | 126 +++++++++++++++------
 .../pulsar/client/admin/internal/SinkImpl.java     |  44 ++++---
 .../pulsar/client/admin/internal/SourceImpl.java   |  44 ++++---
 .../admin/internal/http/AsyncHttpConnector.java    |  14 ++-
 .../internal/http/AsyncHttpConnectorProvider.java  |   5 +
 9 files changed, 242 insertions(+), 85 deletions(-)

commit e5fbb8974f11bee0805853c294f988cc3f72864d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Apr 19 22:31:23 2019 -0700

     allow users to update output topics for functions and sources (#4092)
    
    * allow users to update output topics for functions and sources

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 90 ++++++++++++++++------
 .../functions/utils/FunctionConfigUtils.java       |  6 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  4 +-
 .../functions/utils/FunctionConfigUtilsTest.java   |  7 --
 .../functions/utils/SourceConfigUtilsTest.java     |  7 --
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 39 ++++------
 .../rest/api/v3/FunctionApiV3ResourceTest.java     | 39 ++++------
 .../rest/api/v3/SourceApiV3ResourceTest.java       | 35 ++++-----
 8 files changed, 120 insertions(+), 107 deletions(-)

commit 1a4095e703f9b1116ad3c7def438d74900ee1085
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Apr 18 12:58:02 2019 -0700

    [pulsar-function] fix worker-stats broken admin-api (#4068)

 .../org/apache/pulsar/functions/worker/rest/Resources.java   | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

commit 6a2db62f20853a4441d7d6c79a20524e6b8b6342
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 17 23:11:38 2019 -0700

    Fix: Exception when switch cluster from auth enabled to auth disabled (#4069)
    
    * fix bug in source and sink cli update
    
    * fix import
    
    * fix logic
    
    * fix bug in auth when spec is not null but auth is turned off
    
    * clean up debug
    
    * cleanup

 .../main/java/org/apache/pulsar/PulsarStandaloneStarter.java |  8 +++++++-
 .../apache/pulsar/functions/runtime/KubernetesRuntime.java   |  9 ++++++---
 .../pulsar/functions/runtime/KubernetesRuntimeFactory.java   | 10 +++++++---
 .../org/apache/pulsar/functions/runtime/LocalRunner.java     |  2 +-
 .../pulsar/functions/runtime/ProcessRuntimeFactory.java      |  7 +++++--
 .../functions/runtime/KubernetesRuntimeFactoryTest.java      |  2 +-
 .../pulsar/functions/runtime/KubernetesRuntimeTest.java      |  2 +-
 .../apache/pulsar/functions/runtime/ProcessRuntimeTest.java  |  2 +-
 .../org/apache/pulsar/functions/worker/FunctionActioner.java | 12 +++++++-----
 .../pulsar/functions/worker/FunctionRuntimeManager.java      |  6 ++++--
 10 files changed, 40 insertions(+), 20 deletions(-)

commit b50e0eba8387ca0a3c5b7f7cd05f20e48c6c6f45
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 17 22:31:54 2019 -0700

    improve data-generator source performance (#4058)
    
    ### Motivation
    
    Only initialize factory once in the beginning

 .../org/apache/pulsar/io/datagenerator/DataGeneratorSource.java     | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit d25dc2f764fb8243436e1d0bbec9b0a413258f3a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 17 22:29:04 2019 -0700

    Fixed regex for Pulsar version correction (#4065)
    
    ### Motivation
    
    There's a method that is correcting the version to make sure it complies with SemVer (eg: has 1.2.3 format and not just 1.2). The regex is not correct and it ends up changing the version into `2.4.0.0-SNAPSHOT` instead of leaving the correct `2.4.0-SNAPSHOT`.

 .../src/main/java-templates/org/apache/pulsar/PulsarVersion.java  | 8 +++++---
 .../test/java/org/apache/pulsar/AddMissingPatchVersionTest.java   | 3 +++
 2 files changed, 8 insertions(+), 3 deletions(-)

commit a8cd98cd87dde7fa17ea38ff212eebd14fc95835
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 17 17:42:38 2019 -0700

    Fix update cli source sink (#4061)
    
    * fix bug in source and sink cli update
    
    * fix import
    
    * fix logic
    
    * fix tests

 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  7 +++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  8 ++++-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  | 39 ++++++++++++++++++++--
 .../apache/pulsar/admin/cli/TestCmdSources.java    | 36 ++++++++++++++++++++
 .../pulsar/common/functions/FunctionConfig.java    |  2 +-
 .../org/apache/pulsar/common/io/SinkConfig.java    |  2 +-
 .../functions/utils/FunctionConfigUtils.java       |  9 +++++
 .../pulsar/functions/utils/SinkConfigUtils.java    |  9 +++++
 8 files changed, 105 insertions(+), 7 deletions(-)

commit eacd1082421c8e463b05f7f0b95e092b0fb5310b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 17 17:15:27 2019 -0700

    Fix connectors nested configs (#4067)
    
    * fix update connectors with nested configs
    
    * clean up logging

 .../apache/pulsar/functions/utils/SinkConfigUtils.java  | 14 ++++++++++++--
 .../pulsar/functions/utils/SourceConfigUtils.java       | 17 +++++++++++++++--
 .../pulsar/functions/utils/SinkConfigUtilsTest.java     | 10 +++++++++-
 .../pulsar/functions/utils/SourceConfigUtilsTest.java   | 10 +++++++++-
 4 files changed, 45 insertions(+), 6 deletions(-)

commit bc24013d7f09a9a1ff9aa6e7d81ea24ede400ef5
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Apr 18 07:09:50 2019 +0900

    [client] Set actual topic name to partitioned consumer (#4064)
    
    * Set actual topic name to partitioned consumer
    
    * Change dummy topic name prefix

 .../client/api/PartitionedProducerConsumerTest.java |  1 +
 .../client/impl/PatternTopicsConsumerImplTest.java  |  1 +
 .../pulsar/client/impl/TopicsConsumerImplTest.java  |  1 +
 .../pulsar/client/impl/MultiTopicsConsumerImpl.java | 21 ++++++++++++++++-----
 4 files changed, 19 insertions(+), 5 deletions(-)

commit 090d11af3655ecaecd3d458c39989ed8229055c4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Apr 16 17:32:56 2019 -0700

    ack records in datagenerator print sink (#4052)

 .../java/org/apache/pulsar/io/datagenerator/DataGeneratorPrintSink.java  | 1 +
 1 file changed, 1 insertion(+)

commit 12a5001cbbb205ba7811317eeb02f40912e45b56
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Apr 17 08:31:33 2019 +0900

    Upgrade athenz libraries (#4056)

 pom.xml                                            |  2 +-
 .../client/impl/auth/AuthenticationAthenz.java     | 10 +++++++++
 .../client/impl/auth/AuthenticationAthenzTest.java | 24 ++++++++++++++++++++++
 3 files changed, 35 insertions(+), 1 deletion(-)

commit ccf4581e91e1c8b60488f1fd0c8f114032c3c950
Author:  <rxl5555555@qq.com>
Date:   Tue Apr 16 16:35:15 2019 +0800

    [go function]support log topic for go function (#4008)
    
    ### Motivation
    
    support log topic for go function, user-friendly debugging.
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-function-go/conf/conf.yaml    |  2 +-
 pulsar-function-go/go.mod            |  4 +-
 pulsar-function-go/go.sum            |  4 +-
 pulsar-function-go/pf/context.go     |  1 +
 pulsar-function-go/pf/instance.go    | 46 ++++++++++++++++++-
 pulsar-function-go/pf/logAppender.go | 87 ++++++++++++++++++++++++++++++++++++
 6 files changed, 136 insertions(+), 8 deletions(-)

commit d72079d0ffe73c975bd92344d21646882c2a7c16
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Apr 16 16:22:24 2019 +0800

    [Issue 4047] Catch up docs for functions/sink/source in Admin CLI (#4048)
    
    ### Motivation
    
    Fixes #4047
    
    ### Modifications
    
    Add the missing doc for functions/sink/source and some minor updates.

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   6 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   2 +-
 site2/docs/reference-pulsar-admin.md               | 614 +++++++++++++++------
 3 files changed, 458 insertions(+), 164 deletions(-)

commit 76aacd3c3477342d9cb6709098cd4a2724b78f77
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Apr 15 17:01:09 2019 -0700

    Add tiered storage support for Pulsar SQL (#4045)
    
    * Adding offloader support for sql
    
    * cleaning up
    
    * cleaning up imports
    
    * cleaning up configs
    
    * fix imports
    
    * fix behavior when offloader not configured and fix license
    
    * fix unit test

 conf/presto/catalog/pulsar.properties              |  18 ++++
 .../apache/bookkeeper/mledger/LedgerOffloader.java |   4 +
 .../mledger/impl/ReadOnlyCursorImpl.java           |   5 +
 .../bookkeeper/mledger/offload/OffloaderUtils.java |   7 +-
 .../org/apache/pulsar/broker/PulsarService.java    |   9 +-
 .../apache/pulsar/common/nar/NarClassLoader.java   |  16 +++-
 pulsar-sql/presto-distribution/LICENSE             |  73 ++++++++++++++-
 pulsar-sql/presto-pulsar/pom.xml                   | 104 ++++++++++++++++-----
 .../pulsar/sql/presto/AvroSchemaHandler.java       |   8 +-
 .../pulsar/sql/presto/JSONSchemaHandler.java       |   4 +-
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  93 ++++++++++++++++--
 .../pulsar/sql/presto/PulsarConnectorConfig.java   |  52 ++++++++++-
 .../sql/presto/PulsarConnectorMetricsTracker.java  |  10 +-
 .../pulsar/sql/presto/PulsarConnectorUtils.java    |  10 ++
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  46 ++++++---
 .../pulsar/sql/presto/PulsarSplitManager.java      |  14 ++-
 .../apache/pulsar/sql/presto/SchemaHandler.java    |   2 +-
 .../pulsar/sql/presto/TestPulsarConnector.java     |  36 ++++---
 .../pulsar/sql/presto/TestPulsarMetadata.java      |   4 +-
 19 files changed, 418 insertions(+), 97 deletions(-)

commit cb9dcce3f441f4454985c71e504a4737c6723a26
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue Apr 16 02:15:45 2019 +0800

    [Issue 3989][Doc] Update Geo Replication docs (#4016)
    
    * Update administration-geo file
    
    * update as per advice

 site2/docs/administration-geo.md | 60 +++++++++++++++++++++-------------------
 1 file changed, 31 insertions(+), 29 deletions(-)

commit cd695cd9f99ddc0926494c4f35e35934572f18ea
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 15 11:07:46 2019 -0700

    For functions metrics, avoid having HELP (#4029)

 .../instance/stats/ComponentStatsManager.java      |   2 +-
 .../instance/stats/PrometheusTextFormat.java       | 103 +++++++++++++++++++++
 2 files changed, 104 insertions(+), 1 deletion(-)

commit 039ccf90f5844b8bbd0236b85e3ef4abfc220455
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Apr 14 20:37:19 2019 -0700

    Added release notes for 2.3.1 (#4035)

 site2/website/release-notes.md | 30 ++++++++++++++++++++++++++++++
 1 file changed, 30 insertions(+)

commit 3d8c2ef2780382f77956fd5f84346819b6f9baf3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Apr 13 12:57:31 2019 -0700

    shading everything in jcloud (#4037)
    
    ### Motivation
    
    Shade all transitive dependencies in module jcloud-shaded.  This is needed to get offloaders working nicely with presto and pulsar in the pulsar presto plugin.  I will have a subsequent PR for that.
    
    Not sure why we don't shade all transitive dependencies for jcloud anyways like we do for other modules.

 jclouds-shaded/pom.xml | 38 +++++++++++++++++++++++++++++++++++++-
 tiered-storage/pom.xml |  3 +--
 2 files changed, 38 insertions(+), 3 deletions(-)

commit 6544be5ee3bed1e110d63731e075d4e4cf3f9c90
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 13 12:02:11 2019 -0700

    Improved MacOS Python build (#4039)
    
    ### Motivation
    
    Fixed the Python wheels build on MacOS using vagrant.
     * Use images with pre-installed XCode and dependencies
     * Unified Py 2 and 3 in a single VM

 .gitignore                                         |  6 +-
 pulsar-client-cpp/python/pkg/osx/build.sh.template | 61 --------------------
 .../python/pkg/osx/generate-all-wheel.sh           | 56 +++++++++---------
 .../python/pkg/osx/osx-10.11-python2.7/Vagrantfile | 28 ---------
 .../pkg/osx/osx-10.11-python2.7/build.sh.template  |  1 -
 .../osx/osx-10.11-python2.7/generate-wheel-file.sh | 32 -----------
 .../python/pkg/osx/osx-10.11-python3.6/Vagrantfile | 28 ---------
 .../pkg/osx/osx-10.11-python3.6/build.sh.template  |  1 -
 .../osx/osx-10.11-python3.6/generate-wheel-file.sh | 32 -----------
 .../python/pkg/osx/osx-10.12-python2.7/Vagrantfile | 28 ---------
 .../pkg/osx/osx-10.12-python2.7/build.sh.template  |  1 -
 .../osx/osx-10.12-python2.7/generate-wheel-file.sh | 32 -----------
 .../python/pkg/osx/osx-10.12-python3.6/Vagrantfile | 28 ---------
 .../pkg/osx/osx-10.12-python3.6/build.sh.template  |  1 -
 .../osx/osx-10.12-python3.6/generate-wheel-file.sh | 32 -----------
 .../{osx-10.13-python2.7 => osx-10.12}/Vagrantfile |  6 +-
 .../pkg/osx/osx-10.13-python2.7/build.sh.template  |  1 -
 .../osx/osx-10.13-python2.7/generate-wheel-file.sh | 32 -----------
 .../pkg/osx/osx-10.13-python3.6/build.sh.template  |  1 -
 .../osx/osx-10.13-python3.6/generate-wheel-file.sh | 32 -----------
 .../{osx-10.13-python3.6 => osx-10.13}/Vagrantfile |  7 ++-
 .../python/pkg/osx/osx-10.14/Vagrantfile           |  9 +++
 pulsar-client-cpp/python/pkg/osx/vagrant-build.sh  | 67 ++++++++++++++++++++++
 23 files changed, 113 insertions(+), 409 deletions(-)

commit 4322a66bb9161492c2d03eac8eaee4dec3a837f1
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 13 11:49:30 2019 -0700

    Website docs for 2.3.1 (#4040)

 site2/website/releases.json                        |    1 +
 .../versioned_docs/version-2.3.1/adaptors-kafka.md |  264 +++
 .../admin-api-non-persistent-topics.md             |  254 +++
 .../version-2.3.1/administration-dashboard.md      |   61 +
 .../version-2.3.1/administration-load-balance.md   |  215 ++
 .../version-2.3.1/client-libraries-cpp.md          |  182 ++
 .../version-2.3.1/client-libraries-go.md           |  473 ++++
 .../version-2.3.1/client-libraries-java.md         |  475 ++++
 .../version-2.3.1/client-libraries-python.md       |  249 +++
 .../version-2.3.1/concepts-messaging.md            |  326 +++
 .../version-2.3.1/concepts-overview.md             |   32 +
 .../deploy-bare-metal-multi-cluster.md             |  425 ++++
 .../version-2.3.1/deploy-bare-metal.md             |  442 ++++
 .../version-2.3.1/functions-overview.md            |  453 ++++
 .../version-2.3.1/getting-started-standalone.md    |  235 ++
 .../versioned_docs/version-2.3.1/io-connectors.md  |   29 +
 .../versioned_docs/version-2.3.1/io-develop.md     |  196 ++
 .../version-2.3.1/io-elasticsearch.md              |   22 +
 .../versioned_docs/version-2.3.1/io-file.md        |   28 +
 .../versioned_docs/version-2.3.1/io-hdfs.md        |   27 +
 .../versioned_docs/version-2.3.1/io-influxdb.md    |   26 +
 .../versioned_docs/version-2.3.1/io-mongo.md       |   21 +
 .../versioned_docs/version-2.3.1/io-rabbitmq.md    |   55 +
 .../versioned_docs/version-2.3.1/io-solr.md        |   22 +
 .../version-2.3.1/reference-cli-tools.md           |  597 ++++++
 .../version-2.3.1/reference-configuration.md       |  484 +++++
 .../version-2.3.1/reference-pulsar-admin.md        | 2258 ++++++++++++++++++++
 .../version-2.3.1/reference-terminology.md         |  167 ++
 .../version-2.3.1/security-token-admin.md          |  159 ++
 .../version-2.3.1/sql-getting-started.md           |  143 ++
 .../versioned_sidebars/version-2.3.1-sidebars.json |  125 ++
 site2/website/versions.json                        |    1 +
 32 files changed, 8447 insertions(+)

commit b06b845ff012422adeb7f54af867f9aef362208b
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Sat Apr 13 23:05:02 2019 +0800

    Provide the description of functions command for better usage. (#4032)

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit c855c9c7205f4153c07417a7dfb836bef97ac375
Author: Yong Zhang <zhangyong1025.zy@gmail.com>
Date:   Sat Apr 13 22:25:11 2019 +0800

    Fix exit when qureystate and specify watch (#4033)
    
    * Fix exit when qureystate and specify watched
    ---
    
    *Motivation*
    
    It's shouldn't exit when querystate and specify watched. When watched specify, it
    watch all changes.
    
    *Modifications*
    
    Add `catch` for watch, When server return NOT_FOUND and user was watched it still watch
    all changes.
    
    * Remove unused imports
    
    * Fix output type

 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

commit 23b1418f719ba21a164ebca9a86d52e3dca300cb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Apr 13 00:10:52 2019 -0700

    Set key for message when using function publish (#4005)
    
    * Allow to configure TypedMessageBuilder through a Map conf object
    
    * Use constants for message confs
    
    * Reverted previous change
    
    * Use Long instead of Number
    
    * Set key for message when using function publish
    
    * fix unit test
    
    * fix python test
    
    * improving impl
    
    * improving implementation
    
    * add tests and examples
    
    * fix bug
    
    * fix bug
    
    * fixing comments
    
    * fix example
    
    * addressing comments
    
    * fix function

 .../worker/PulsarFunctionPublishTest.java          | 385 +++++++++++++++++++++
 .../python/pulsar/functions/context.py             |  30 +-
 .../org/apache/pulsar/functions/api/Context.java   |  47 ++-
 .../pulsar/functions/instance/ContextImpl.java     |  19 +-
 .../instance/src/main/python/contextimpl.py        |  14 +-
 .../pulsar/functions/instance/ContextImplTest.java |  18 +
 .../src/test/python/test_python_instance.py        |   1 +
 .../examples/PublishFunctionWithMessageConf.java   |  52 +++
 .../publish_function_with_message_conf.py          |  38 ++
 .../integration/functions/PulsarFunctionsTest.java | 160 ++++++++-
 .../functions/PulsarFunctionsTestBase.java         |   8 +
 11 files changed, 743 insertions(+), 29 deletions(-)

commit de6bc1177a251066c7b148c3fa98a21c27f51417
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 12 23:03:45 2019 -0700

    Add labels to function statefulsets and services (#4038)
    
    * Add labels to function statefulsets and services. Also upgraded the kubernetes client version to the latest
    
    * Fix unittests
    
    * Reverted back the kubernertes library upgrade since shading was causing issues

 .../java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java     | 2 ++
 1 file changed, 2 insertions(+)

commit 6983359a4aaf37f61a18d6b0449de85c4eb4e19d
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Sat Apr 13 02:51:35 2019 +0800

    Add steps to build Pulsar function to docs. (#4034)

 site2/docs/functions-overview.md | 11 ++++++-----
 site2/docs/io-develop.md         | 14 +++++++-------
 2 files changed, 13 insertions(+), 12 deletions(-)

commit 34b3b50683d1ce2abea6c655229516081112f796
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Apr 12 09:35:46 2019 -0700

    fix errors in sql doc (#4030)

 site2/docs/sql-getting-started.md                                 | 2 +-
 site2/website/versioned_docs/version-2.2.0/sql-getting-started.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit c92d4e0551a783a2626aff8628fa2958dfd40fe7
Author: Yoann Ciabaud <yciabaud@users.noreply.github.com>
Date:   Fri Apr 12 02:09:21 2019 +0200

    Handle subrecords in JsonSchema encoding (#4023)

 pulsar-client-cpp/python/pulsar/schema/schema.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9d6de6780650561ac12cd3859d86a00afc84be03
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 11 11:42:16 2019 -0700

    Fix the swagger files generated by removing troublesome class (#4024)

 .../pulsar/broker/admin/impl/FunctionsBase.java    |    3 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |    3 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |    3 +-
 site2/.gitignore                                   |    1 +
 site2/tools/python-doc-gen.sh                      |    2 +
 site2/website/static/swagger/swagger.json          | 7841 --------------------
 6 files changed, 6 insertions(+), 7847 deletions(-)

commit b7108e818316a91d9b2b761af450faa1b99887d1
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Apr 11 20:32:24 2019 +0200

    Fix Python functions state which is completely broken (#4027)
    
    When a python functions instance is started with state enabled, it
    crashes because the state client cannot connect to the state
    endpoints. This is because the state client is *never* given the state
    endpoints, so there's no way it ever could connect.

 pulsar-functions/instance/src/main/python/state_context.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 5a008bdd4443db9aef0e8bd346771231541863b5
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Fri Apr 12 01:16:00 2019 +0800

    update site2/docs/concepts-overview.md file (#4026)

 site2/docs/concepts-overview.md | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

commit 1d142cb3215d7dc50f38392ad114f6a10b1b955f
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Apr 11 22:23:01 2019 +0800

    [pulsar-io] Add a Pulsar IO connector for InfluxDB sink (#4017)
    
    * Add a Pulsar IO connector for InfluxDB sink.
    
    * Add sensitive

 pulsar-io/influxdb/pom.xml                         |  76 ++++++++++
 .../pulsar/io/influxdb/InfluxDBAbstractSink.java   | 156 ++++++++++++++++++++
 .../apache/pulsar/io/influxdb/InfluxDBBuilder.java |  25 ++++
 .../pulsar/io/influxdb/InfluxDBBuilderImpl.java    |  59 ++++++++
 .../io/influxdb/InfluxDBGenericRecordSink.java     | 114 +++++++++++++++
 .../pulsar/io/influxdb/InfluxDBSinkConfig.java     | 133 +++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 .../io/influxdb/InfluxDBGenericRecordSinkTest.java | 157 +++++++++++++++++++++
 .../pulsar/io/influxdb/InfluxDBSinkConfigTest.java | 148 +++++++++++++++++++
 .../influxdb/src/test/resources/sinkConfig.yaml    |  29 ++++
 pulsar-io/pom.xml                                  |   1 +
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-influxdb.md                          |  25 ++++
 13 files changed, 946 insertions(+)

commit b191035c2f1e1860e0202aca6f908e4376690c0b
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Apr 11 18:44:31 2019 +0800

    [Issue #3726] Modify the usage of Connector CLI for better guidance (#3745)
    
    * Modify the usage of Connector CLI for better guidance
    
    * Add the missing io-quickstart of version 2.3.0
    
    * Add the original_id

 site2/docs/io-quickstart.md                        | 110 +++---
 .../versioned_docs/version-2.3.0/io-quickstart.md  | 389 +++++++++++++++++++++
 2 files changed, 442 insertions(+), 57 deletions(-)

commit 61e9e1b75f0ff0d38744c6afa90091936b7410d0
Author: tuteng <eguangning@gmail.com>
Date:   Thu Apr 11 14:08:23 2019 +0800

    [Issue 3987][pulsar-broker]Handle config is null when create tenant (#4019)
    
    Fixes #3987
    
    ### Motivation
    
    Config will not appear null when create tenant use pulsar-admin create foo3, but use the following command, config is null.
    ```
    curl -X PUT http://localhost:8080/admin/v2/tenants/foo3
    ```
    
    ### Modifications
    
    Handle config is null when create tenant use curl.
    
    ### Verifying this change
    Test pass
    ```
    curl -X PUT http://localhost:8080/admin/v2/tenants/foo3
    curl -X GET http://localhost:8080/admin/v2/tenants/foo3
    {"adminRoles":[],"allowedClusters":[]}
    ```

 .../main/java/org/apache/pulsar/broker/admin/impl/TenantsBase.java | 3 +++
 .../src/test/java/org/apache/pulsar/broker/admin/AdminTest.java    | 7 +++++++
 2 files changed, 10 insertions(+)

commit 9c0937b85da38d25d6b0dbbcc2a58b0178dbf09f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 10 22:17:16 2019 -0700

    Allow to configure TypedMessageBuilder through a Map conf object (#4015)
    
    * Allow to configure TypedMessageBuilder through a Map conf object
    
    * Use constants for message confs
    
    * Reverted previous change
    
    * Use Long instead of Number

 .../api/SimpleTypedProducerConsumerTest.java       | 80 ++++++++++++++++++++++
 .../pulsar/client/api/TypedMessageBuilder.java     | 42 ++++++++++++
 .../client/impl/TypedMessageBuilderImpl.java       | 27 ++++++++
 .../apache/pulsar/client/util/TypeCheckUtil.java   | 33 +++++++++
 4 files changed, 182 insertions(+)

commit 374248374e512118c935bfa43c8c58e424c8f241
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 10 13:48:36 2019 -0700

    Fix querystate key not found and add tests for function state (#4014)
    
    * fix return code when querying function state for a key that doesn't exist
    
    * add tests
    
    * fix formatting

 .../functions/worker/PulsarFunctionStateTest.java  | 407 +++++++++++++++++++++
 .../functions/worker/rest/api/ComponentImpl.java   |   2 +
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |  10 +-
 3 files changed, 418 insertions(+), 1 deletion(-)

commit fb4eaf9db3ddcf884f581a46d5c9425f793993ff
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Apr 11 00:06:32 2019 +0800

    [Doc] Update "load distribution" as "load balance" (#3958)
    
    ### Motivation
    The orignal text is "load distribution". Load balance is more accurate than load distribution, and while correcting the english term, it also makes translation into Chinese easier.
    
    ### Modifications
    Refine the term "load distribution" as "load balance".

 ...ration-load-distribution.md => administration-load-balance.md} | 8 ++++----
 site2/website/sidebars.json                                       | 2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 357284aabe8f868ed7810f9b5a2c702de0a07df6
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Apr 10 15:14:50 2019 +0800

    Specify the RabbitMQSink type as Bytes by default. (#4007)

 .../org/apache/pulsar/io/rabbitmq/RabbitMQSink.java  | 20 +++-----------------
 .../pulsar/io/rabbitmq/sink/RabbitMQSinkTest.java    | 13 +++++++------
 2 files changed, 10 insertions(+), 23 deletions(-)

commit bc6472d43d3fee4f45c20c7b361625e16f6d5bc6
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Apr 9 16:18:56 2019 -0700

    Add bookkeeper client version constraint (#4013)
    
    We require a certain version of bookkeeper client to operate python function state correctly.

 pulsar-client-cpp/python/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 99e7ab80021ace29f9a3291d323260bbb9c0aeaa
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Wed Apr 10 04:47:33 2019 +0530

    [#3944][dashboard]Dashboard authentication support for JWT token (#3945)

 dashboard/Dockerfile                   |   2 +-
 dashboard/conf/supervisor-app.conf     |  70 ++++++++-
 dashboard/django/collector.py          | 249 ++++++++++++++++++---------------
 dashboard/django/dashboard/settings.py |  39 +++---
 dashboard/django/stats/views.py        |   5 +-
 docker/pulsar-standalone/Dockerfile    |   2 +-
 site2/docs/administration-dashboard.md |  14 +-
 7 files changed, 239 insertions(+), 142 deletions(-)

commit 73595c944328b16760afd2182503862d0655f58c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Apr 9 23:07:53 2019 +0800

    Closing FunctionAssignmentTailer should handle ConsumerAlreadyClosedException (#3747)
    
    *Motivation*
    
    Currently when FunctionAssignmentTailer throws RuntimeException when received
    exception when tailing the assignment topic. Exception can be thrown when closing
    the reader.
    
    The runtime exception is the root cause why PulsarWorkerAssignmentTest timeouts
    during shutting down.
    
    *Modifications*
    
    Handle AlreadyClosedException differently

 .../org/apache/pulsar/common/util/FutureUtil.java  |  9 ++++++
 .../functions/worker/FunctionAssignmentTailer.java | 37 ++++++++++++++++------
 2 files changed, 37 insertions(+), 9 deletions(-)

commit 66a1b1b61a23fecbfbc158556434e04bd8f1c7fc
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Apr 9 22:56:38 2019 +0800

    Issue 3655: Kerberos authentication for proxy (#3997)
    
    Fixes #3655
    
    Master Issue: #3491
    
    ### Motivation
    add support of Kerberos authentication for proxy
    
    ### Modifications
    add support of Kerberos authentication for proxy ;
    add unit test.
    
    ### Verifying this change
    Ut passed

 pulsar-broker-auth-sasl/pom.xml                    |   7 +
 .../authentication/AuthenticationProviderSasl.java |   7 +-
 .../ProxySaslAuthenticationTest.java               | 289 +++++++++++++++++++++
 .../authentication/SaslAuthenticateTest.java       |   2 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |   4 +-
 .../client/impl/auth/AuthenticationSasl.java       |   8 +-
 .../pulsar/client/impl/auth/PulsarSaslClient.java  |   7 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   4 +-
 .../org/apache/pulsar/common/api/Commands.java     |   5 +-
 .../apache/pulsar/common/sasl/SaslConstants.java   |  13 +-
 .../pulsar/proxy/server/DirectProxyHandler.java    |  47 +++-
 .../apache/pulsar/proxy/server/ProxyClientCnx.java |  25 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    |  26 +-
 .../pulsar/proxy/server/ProxyConnection.java       | 232 +++++++++++------
 14 files changed, 558 insertions(+), 118 deletions(-)

commit f229d3b34c6d6d26ee3ddf32bdc0e5f568d92bfd
Author:  <rxl5555555@qq.com>
Date:   Tue Apr 9 16:09:46 2019 +0800

    [issue #3767] support go function for pulsar (#3854)
    
    Master Issue: #3767
    
    ### Motivation
    
    At present, go function only supports the simplest function. Input and output only allow []byte. For details, refer to: [PIP32](https://github.com/apache/pulsar/wiki/PIP-32%3A-Go-Function-API%2C-Instance-and-LocalRun)

 pulsar-function-go/README.md                       |    0
 pulsar-function-go/conf/conf.go                    |  109 +++
 pulsar-function-go/conf/conf.yaml                  |   57 ++
 pulsar-function-go/examples/contextFunc.go         |   38 +
 pulsar-function-go/examples/hello.go               |   34 +
 pulsar-function-go/examples/inputFunc.go           |   36 +
 pulsar-function-go/examples/outputFunc.go          |   35 +
 pulsar-function-go/examples/test/consumer.go       |   61 ++
 pulsar-function-go/examples/test/producer.go       |   57 ++
 pulsar-function-go/go.mod                          |   11 +
 pulsar-function-go/go.sum                          |   36 +
 pulsar-function-go/pb/Function.pb.go               | 1025 ++++++++++++++++++++
 pulsar-function-go/pb/InstanceCommunication.pb.go  |  648 +++++++++++++
 pulsar-function-go/pb/Request.pb.go                |  153 +++
 pulsar-function-go/pb/doc.go                       |   34 +
 pulsar-function-go/pb/generate.sh                  |   81 ++
 pulsar-function-go/pf/context.go                   |   98 ++
 pulsar-function-go/pf/context_test.go              |   45 +
 pulsar-function-go/pf/function.go                  |  172 ++++
 pulsar-function-go/pf/function_test.go             |  182 ++++
 pulsar-function-go/pf/instance.go                  |  275 ++++++
 pulsar-function-go/pf/instanceConf.go              |  104 ++
 pulsar-function-go/pf/instanceConf_test.go         |   32 +
 pulsar-function-go/pf/util.go                      |   41 +
 pulsar-function-go/pf/util_test.go                 |   52 +
 .../proto/src/main/proto/Function.proto            |   21 +-
 26 files changed, 3427 insertions(+), 10 deletions(-)

commit 12de91fb231c3e609137de60bbdbc29c5c2f2e13
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Apr 8 19:09:46 2019 -0700

    [pulsar-storm] Fix NPE while emitting next tuple (#3991)
    
    ### Motivation
    
    [PulsarSpout] removes messages from [pendingMessageRetries](https://github.com/apache/pulsar/blob/master/pulsar-storm/src/main/java/org/apache/pulsar/storm/PulsarSpout.java#L126) but it doesn't remove from the `failedMessages` queue because of that PulsarSpout throws NPE while [emitting next tuple](https://github.com/apache/pulsar/blob/master/pulsar-storm/src/main/java/org/apache/pulsar/storm/PulsarSpout.java#L181)
    
    ````
    stack-trace with old pulsar-storm lib: 1.20
    2019-04-05 18:49:58.240 b.s.util CmsSpout_[1 1] [INFO] Async loop Stacktrace is: {} java.lang.NullPointerException
        at org.apache.pulsar.storm.PulsarSpout.emitNextAvailableTuple(PulsarSpout.java:176)
        at org.apache.pulsar.storm.PulsarSpout.nextTuple(PulsarSpout.java:160)
        at backtype.storm.daemon.executor$fn__7365$fn__7380$fn__7411.invoke(executor.clj:577)
        at backtype.storm.util$async_loop$fn__551.invoke(util.clj:491)
        at clojure.lang.AFn.run(AFn.java:22)
        at java.lang.Thread.run(Thread.java:748)
    ```

 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 54 +++++++++----
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   | 88 ++++++++++++++++++++++
 2 files changed, 127 insertions(+), 15 deletions(-)

commit 372575a9877bf50e8f55a9568ef6c07fcae86644
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Mon Apr 8 23:01:19 2019 -0300

    [issue #3975] Bugfix NPE on non durable consumer (#3988)
    
    *Motivation*
    
    Trying to fix #3975
    
    When a reset of a cursor is performed with some timestamp on a non-durable
    consumer the message finder will fail with null pointer exception due to
    `cursor.getName()` being null.
    
    *Modifications*
    
      - Add method overloading for `newNonDurableCursor()` with subscription name.
      - Fix method getNonDurableSubscription to call `newNonDurableCursor()` with
        proper subscription name
      - Add test to assert issue.

 .../apache/bookkeeper/mledger/ManagedLedger.java   |  1 +
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 10 ++++++++
 .../broker/service/persistent/PersistentTopic.java |  2 +-
 .../apache/pulsar/client/api/TopicReaderTest.java  | 28 +++++++++++++++++++++-
 4 files changed, 39 insertions(+), 2 deletions(-)

commit 6bce00bd177cc6c1d78dcbcf6cc3355d09456c6b
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 8 18:22:00 2019 -0700

    Fixed issue in backoff builder configuration (#3984)
    
    ### Motivation
    
    In #3848 there was a mismatch of the values when converting from constructor to builder. The values for `setMandatoryStop()` and `setMax()` were inverted.
    
    That makes a client to keep reconnecting every 100 millis, instead of doing the expected backoff.

 .../org/apache/pulsar/client/impl/Backoff.java     | 28 ++++++++++------------
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 20 ++++++++--------
 .../apache/pulsar/client/impl/ProducerImpl.java    |  8 +++----
 3 files changed, 26 insertions(+), 30 deletions(-)

commit 14a5ee0e764cb7d76dfce8ab7ab81e827e38a9a5
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Apr 8 15:49:28 2019 -0700

    Don't pass any auth parameters when authentication is disabled (#3999)
    
    * Don't pass any auth parameters when authentication is disabled
    
    * fix bug
    
    * add defensive programming

 .../auth/KubernetesSecretsTokenAuthProvider.java   |  10 ++
 .../functions/worker/FunctionRuntimeManager.java   |  18 ++--
 .../pulsar/functions/worker/MembershipManager.java |  23 +----
 .../org/apache/pulsar/functions/worker/Worker.java |   3 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   5 +-
 .../pulsar/functions/worker/WorkerService.java     | 109 ++++++++++-----------
 .../pulsar/functions/worker/WorkerUtils.java       |  54 +++++++++-
 .../functions/worker/MembershipManagerTest.java    |  21 ++--
 8 files changed, 151 insertions(+), 92 deletions(-)

commit 247a60866dcdd1fa5e2865bebb4409bdb1ffa3e5
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 8 14:39:05 2019 -0700

    Fixed concurrent modification exception on function worker stop (#4006)

 .../pulsar/functions/worker/FunctionRuntimeManager.java    | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

commit c9f444e0bab476ade119c935454573b456b52abf
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Apr 9 06:21:02 2019 +0900

    Fix deadlock during GC of non-persistent topic (#4003)

 .../broker/service/nonpersistent/NonPersistentTopic.java       | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 8365808ae66eafc2bc15c2dfdd4c1e98315c09ec
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Apr 8 20:10:02 2019 +0800

    Provide a mechanism to disable uploading distribution packages (#3977)
    
    *Motivation*
    
    Currently all the distribution packages are very large. We should provide a way to skip uploading distribution packages.

 distribution/pom.xml | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit de24ad7e2fb754fba1b1979df5cc9f40b2209c5a
Author: Cristian <me@cristian.io>
Date:   Mon Apr 8 05:09:31 2019 -0700

    [Kubernetes] Added ingress resource to dashboard (#3996)
    
    Allows to opt-in for an ingress on top of the dashboard service.
    
    This is very important in production-grade deployments where
    you want to expose the Pulsar dashboard through an easy to remember URL.

 .../helm/pulsar/templates/dashboard-ingress.yaml   | 51 ++++++++++++++++++++++
 deployment/kubernetes/helm/pulsar/values-mini.yaml |  2 +
 deployment/kubernetes/helm/pulsar/values.yaml      |  8 ++++
 3 files changed, 61 insertions(+)

commit c706d45c56b90eb4631e3cf0c0b23b3101291436
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Apr 7 23:54:56 2019 -0700

    improving getting version and git SHA (#3990)
    
    * improving getting version and git SHA
    
    * remove import

 pom.xml                                            |  2 -
 .../org/apache/pulsar/broker/PulsarService.java    | 16 +++---
 .../resources/pulsar-broker-version.properties     | 20 -------
 pulsar-client/pom.xml                              | 13 -----
 .../org/apache/pulsar/PulsarVersion.java           | 25 ---------
 pulsar-common/pom.xml                              | 18 +++++++
 .../org/apache/pulsar/PulsarVersion.java           | 61 ++++------------------
 .../apache/pulsar}/AddMissingPatchVersionTest.java | 22 ++++----
 8 files changed, 48 insertions(+), 129 deletions(-)

commit 5a7b1779e41a07b7e8a03d70aceb07b17f4bcfae
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Apr 7 23:54:23 2019 -0700

    fix bug when updating function running in effectively-once (#3994)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java     | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 23926ad5ee60db744a8dcd21dff4ab991acfac2b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Apr 7 23:06:39 2019 -0700

    fix: bug when function auth is not enabled (#3980)
    
    * fix bug when function auth is not enabled
    
    * add comment and tests
    
    * fix bug
    
    * improving tests

 .../pulsar/functions/worker/FunctionActioner.java  | 29 +++++++----
 .../functions/worker/FunctionActionerTest.java     | 59 ++++++++++++++++++++++
 2 files changed, 79 insertions(+), 9 deletions(-)

commit 43442e7a98352d49b5306d5c121cab9a43416984
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Apr 7 23:06:07 2019 -0700

    Improve error handling for triggering function when input data does not conform with input topic schema (#3995)

 .../org/apache/pulsar/functions/worker/rest/api/ComponentImpl.java     | 3 +++
 1 file changed, 3 insertions(+)

commit b41a0203d311e4c034628b6d28c8f914871636bd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Apr 7 22:23:51 2019 -0700

    [pulsar-broker] add producer/consumer id in error-logging (#3961)
    
    ### Motivation
    
    Log Producer/Consumer Id when broker logs "Producer/consumer is already connected" to help in debugging when client is keep failing to create producer and broker is keep logging  the same error.

 .../java/org/apache/pulsar/broker/service/ServerCnx.java | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit acb13526db148a850d433057140eae7ca4afacb5
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Apr 7 21:49:10 2019 -0700

    Fix integration tests by pinning the version of python package (#4000)

 docker/pulsar-standalone/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0b92463ff612c55256408cc7b2eed73ffefd2739
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Apr 4 12:48:22 2019 -0700

    Cleanup temporary files created by functions (#3969)
    
    * Cleanup temporary files and refactor code

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   4 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |   4 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |   4 +-
 .../apache/pulsar/broker/admin/v2/Functions.java   |  10 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  54 ++
 .../pulsar/functions/runtime/LocalRunner.java      |  10 +-
 .../pulsar/functions/utils/FunctionCommon.java     |  52 +-
 .../functions/utils/FunctionConfigUtils.java       |  16 +-
 .../pulsar/functions/utils/SinkConfigUtils.java    |  10 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  10 +-
 .../pulsar/functions/utils/ValidatorUtils.java     |  80 +++
 .../pulsar/functions/worker/FunctionActioner.java  |  21 +-
 .../pulsar/functions/worker/WorkerUtils.java       |  35 ++
 .../functions/worker/rest/api/ComponentImpl.java   | 661 ++++++++-------------
 .../functions/worker/rest/api/FunctionsImplV2.java |  42 +-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |   3 +-
 .../functions/worker/rest/api/SourceImpl.java      |   3 +-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  10 +-
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |   4 +-
 .../worker/rest/api/v3/SinkApiV3Resource.java      |   4 +-
 .../worker/rest/api/v3/SourceApiV3Resource.java    |   4 +-
 .../worker/rest/api/FunctionsImplTest.java         |  20 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 206 ++++---
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  66 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |  87 ++-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |  99 +--
 26 files changed, 846 insertions(+), 673 deletions(-)

commit 13f870c3bafedb7f73449a2a5b25f07b4f6667e9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 4 11:26:16 2019 -0700

    Add Async State manipulation methods (#3978)
    
    * Add Async State manipulation methods
    
    * Fix build
    
    * Fixed unittest

 .../org/apache/pulsar/functions/api/Context.java   | 34 ++++++++++++++++++
 .../pulsar/functions/instance/ContextImpl.java     | 33 +++++++++++++++---
 .../functions/instance/state/StateContext.java     |  9 ++---
 .../functions/instance/state/StateContextImpl.java | 40 ++++++++++++----------
 .../pulsar/functions/instance/ContextImplTest.java | 14 ++++----
 .../instance/state/StateContextImplTest.java       |  8 ++---
 6 files changed, 101 insertions(+), 37 deletions(-)

commit 83ea1e3357f54c4d3eb44e3fd34faa2f11a48291
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 4 13:11:45 2019 -0500

    Fixed issue with Authorization header missing after client gets redirected (#3869)
    
    * Fixed issue with Authorization header missing after client gets redirected
    
    * Use AsyncHttpClient instead
    
    * Fixed merge issue
    
    * Convert headers after body to not break multipart encoding
    
    * Fixed tests
    
    * Added missing property file for AsyncHttpClient in the shaded jar
    
    * Moved ahc.properties into org.asynchttpclient.config
    
    * One value was missing from properties file
    
    * Also add default file for non-shaded scenario
    
    * Another missing AHC config key
    
    * Print topic load exception
    
    * Removed constraint on unit tests executor

 .../pulsar/broker/service/BrokerService.java       |  12 +-
 .../broker/auth/SameThreadOrderedSafeExecutor.java |   2 +-
 pulsar-client-admin-shaded/pom.xml                 |   6 +
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  68 ++-----
 .../admin/internal/http/AsyncHttpConnector.java    | 201 +++++++++++++++++++++
 .../internal/http/AsyncHttpConnectorProvider.java  |  40 ++++
 .../asynchttpclient/config/ahc-default.properties  |  73 ++++++++
 .../org/asynchttpclient/config/ahc.properties      |  73 ++++++++
 .../token/PulsarTokenAuthenticationBaseSuite.java  |  48 ++++-
 9 files changed, 460 insertions(+), 63 deletions(-)

commit 108c525510239d21d4d618f8e16d87910fdccce7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 4 09:10:09 2019 -0700

    Fix the logic of checking of variables (#3979)

 .../org/apache/pulsar/functions/runtime/KubernetesRuntime.java | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit b7903fae328b9b16318675eb2f2cb300ac6cadb1
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Apr 4 23:51:33 2019 +0800

    [Issue 3966] [pulsar-io] Specify the RedisSink type as Bytes by default (#3972)
    
    * Specify the RedisSink type as Bytes by default.
    
    * Some minor fix

 .../org/apache/pulsar/io/redis/sink/RedisSink.java | 29 +++------
 .../apache/pulsar/io/redis/sink/RedisSinkTest.java | 72 +++++++++-------------
 2 files changed, 36 insertions(+), 65 deletions(-)

commit b51e435a7dc4d4961c0eec469f1c42150480b08e
Author: Like <like_0903@163.com>
Date:   Wed Apr 3 10:28:53 2019 +0800

    Remove deprecated PersistentTopics in favor of Topics (#3943)
    
    The PersistentTopics was been deprecated in 2.0, which can be replaced with Topics completely. Remove it in favor of topics.

 .../broker/admin/impl/PersistentTopicsBase.java    |  4 ++--
 .../pulsar/broker/admin/AdminApiOffloadTest.java   | 18 +++++++++---------
 .../broker/admin/BrokerAdminClientTlsAuthTest.java |  2 +-
 .../broker/service/ReplicatorGlobalNSTest.java     |  2 +-
 .../pulsar/client/admin/PersistentTopics.java      | 22 ----------------------
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  9 ---------
 .../pulsar/client/admin/internal/TopicsImpl.java   |  4 +---
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  5 ++---
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 10 +++++-----
 9 files changed, 21 insertions(+), 55 deletions(-)

commit 1e8b3d3e74bf657e399ea49e4a43be1c54afe016
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Apr 3 05:43:59 2019 +0800

    Add a Pulsar IO connector for RabbitMQ sink. (#3967)
    
    ### Motivation
    
    Provides a builtin RabbitMQ Sink Connector, in order to persist pulsar messages to a RabbitMQ queue.
    
    ### Modifications
    
    Add a RabbitMQ Sink and some unit tests.
    
    ### Verifying this change
    
    This change can be verified as follows:
    
    * deploy the RabbitMQ sink connector with configuration file containing the following fields:
    
    ```
    configs:
        host: "localhost"
        port: "5672"
        virtualHost: "/"
        username: "quest"
        password: "quest"
        queueName: "test_queue"
        connectionName: "test_connection"
        exchangeName: "test_exchange"
        routingKey: "test_routing"
    ```
    * deploy an RabbitMQ cluster and create the above elements
    * send messages in the topic with specified schema declared when deploying the connector
    * use `rabbitmqadmin` or `rabbitmqctl` to query messages in the specified queue

 pulsar-io/rabbitmq/pom.xml                         |  16 +++
 .../apache/pulsar/io/rabbitmq/RabbitMQSink.java    | 112 ++++++++++++++++
 .../pulsar/io/rabbitmq/RabbitMQSinkConfig.java     |  75 +++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |   3 +-
 .../io/rabbitmq/sink/RabbitMQSinkConfigTest.java   | 142 +++++++++++++++++++++
 .../pulsar/io/rabbitmq/sink/RabbitMQSinkTest.java  | 101 +++++++++++++++
 .../rabbitmq/src/test/resources/sinkConfig.yaml    |  36 ++++++
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-rabbitmq.md                          |  24 ++++
 9 files changed, 509 insertions(+), 1 deletion(-)

commit b26f0ba4b84560acce368103781a60b4d6b8bf4a
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Apr 3 05:31:45 2019 +0800

    Fix the path of redis-io yaml. (#3965)

 .../src/main/resources/{resources => }/META-INF/services/pulsar-io.yaml   | 0
 1 file changed, 0 insertions(+), 0 deletions(-)

commit bdfc09867325a271dc40a3aa87dcefb905769f06
Author: Richard Yu <yohan.richard.yu@gmail.com>
Date:   Tue Apr 2 09:41:04 2019 -0700

    [Issue-2122] [pulsar-client] Adding configuration for backoff strategy (#3848)
    
    
    Fixes #2122
    
    ### Motivation
    
    Current backoff strategy is set by default and is too aggressive. What we should do is allow it to be configurable by the user.
    
    ### Documentation
    
      - Does this pull request introduce a new feature? (yes)
      - If yes, how is the feature documented? (not sure)

 .../apache/pulsar/client/impl/RawReaderImpl.java   |  4 +-
 .../apache/pulsar/client/api/ClientBuilder.java    | 22 ++++++
 .../org/apache/pulsar/client/impl/Backoff.java     | 54 ++++++++++++---
 .../apache/pulsar/client/impl/BackoffBuilder.java  | 81 ++++++++++++++++++++++
 .../client/impl/BinaryProtoLookupService.java      | 10 ++-
 .../pulsar/client/impl/ClientBuilderImpl.java      | 12 ++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 46 +++++++++---
 .../client/impl/MultiTopicsConsumerImpl.java       | 11 ++-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  9 ++-
 .../pulsar/client/impl/PulsarClientImpl.java       |  3 +-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  4 +-
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  | 10 ++-
 .../client/impl/conf/ClientConfigurationData.java  |  3 +
 .../pulsar/client/impl/ConsumerImplTest.java       | 16 ++++-
 .../java/org/apache/pulsar/storm/PulsarSpout.java  |  5 +-
 15 files changed, 257 insertions(+), 33 deletions(-)

commit 8adff85d8fece38428f28c1288c0ebb7dde3a744
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Tue Apr 2 21:32:01 2019 +0530

    issue#3939 : Allow client authentication from pulsar-flink package (#3949)
    
    Problem:
    ========
    pulsar-flink module (aka flink connector) internally uses pulsar-client. Though the pulsar client allows setting tokens in the client builder, the flink connector does not provide a way to pass authentication token to the pulsar client it uses internally.
    
    Solution:
    ========
    Accept authetication information as an input in pulsar-flink module. Pass this authentication information to pulsar-client.

 .../example/FlinkPulsarBatchAvroSinkExample.java   |  3 +-
 .../example/FlinkPulsarBatchCsvSinkExample.java    |  3 +-
 .../example/FlinkPulsarBatchJsonSinkExample.java   |  3 +-
 .../example/FlinkPulsarBatchSinkExample.java       |  3 +-
 .../example/PulsarConsumerSourceWordCount.java     |  2 +
 ...lsarConsumerSourceWordCountToAvroTableSink.java |  3 +-
 ...lsarConsumerSourceWordCountToJsonTableSink.java |  3 +-
 .../FlinkPulsarBatchAvroSinkScalaExample.scala     |  3 +-
 .../FlinkPulsarBatchCsvSinkScalaExample.scala      |  3 +-
 .../FlinkPulsarBatchJsonSinkScalaExample.scala     |  3 +-
 .../example/FlinkPulsarBatchSinkScalaExample.scala |  3 +-
 .../connectors/pulsar/BasePulsarOutputFormat.java  | 17 +++---
 .../connectors/pulsar/PulsarAvroOutputFormat.java  |  5 +-
 .../connectors/pulsar/PulsarCsvOutputFormat.java   |  5 +-
 .../connectors/pulsar/PulsarJsonOutputFormat.java  |  5 +-
 .../connectors/pulsar/PulsarOutputFormat.java      |  5 +-
 .../connectors/pulsar/FlinkPulsarProducer.java     | 14 ++++-
 .../connectors/pulsar/PulsarAvroTableSink.java     |  8 ++-
 .../connectors/pulsar/PulsarConsumerSource.java    |  4 ++
 .../connectors/pulsar/PulsarJsonTableSink.java     |  7 ++-
 .../connectors/pulsar/PulsarSourceBuilder.java     | 61 ++++++++++++++++++++++
 .../connectors/pulsar/PulsarTableSink.java         |  5 ++
 .../pulsar/PulsarAvroOutputFormatTest.java         | 11 ++--
 .../pulsar/PulsarCsvOutputFormatTest.java          | 11 ++--
 .../pulsar/PulsarJsonOutputFormatTest.java         | 11 ++--
 .../connectors/pulsar/PulsarOutputFormatTest.java  | 15 +++---
 .../connectors/pulsar/PulsarAvroTableSinkTest.java |  6 ++-
 .../connectors/pulsar/PulsarJsonTableSinkTest.java |  6 ++-
 28 files changed, 174 insertions(+), 54 deletions(-)

commit 7b683760ac3fac7e2a3075a7f2b28724b881d21f
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 2 08:54:05 2019 -0700

    Fixed reader reading from a partition (#3960)

 .../org/apache/pulsar/client/impl/ReaderTest.java   | 21 +++++++++++++++++++++
 .../org/apache/pulsar/client/impl/ConsumerImpl.java |  6 ++++--
 2 files changed, 25 insertions(+), 2 deletions(-)

commit 2e934529d940bdd1b271ea0913249d787fc78ec4
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Apr 2 12:21:48 2019 +0800

    [Issue 3851] [pulsar-broker] Support to start broker use the port initialized in cluster metadata (#3853)
    
    ### Motivation
    
    Fixes #3851
    
    ### Modifications
    
    Override the port of service urls in brokerConfig by the config initialized in cluster metadata.

 site2/docs/deploy-bare-metal-multi-cluster.md | 14 +++++++++++++-
 site2/docs/deploy-bare-metal.md               | 13 +++++++++++--
 2 files changed, 24 insertions(+), 3 deletions(-)

commit 4101168fbf5689af0eac37e1fc03195778f544d5
Author: Cristian <me@cristian.io>
Date:   Mon Apr 1 21:15:44 2019 -0700

    [Flink] Allow to customize PulsarProducer (#3955)
    
    This is an improvement over #3894.
    
    Because of how Flink instantiates functions, instead of passing a
    custom `PulsarProducer` client we need to pass an object that is
    serializable. The current implementation will default to always
    call `createProducer()` because `producer` is `transient`, so it will
    always be null when Flink creates new instances of the sink.

 .../connectors/pulsar/FlinkPulsarProducer.java     | 23 +++++++++++++++-------
 1 file changed, 16 insertions(+), 7 deletions(-)

commit 181c3418bfa426ad0e57cb674760e6ab642040ba
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Tue Apr 2 12:15:19 2019 +0800

    [Doc] Refine language issues (#3959)
    
    ### Motivation
    The description of "Assignment granularity" is not quite clear, i'm trying to make it easy to understand.
    
    ### Modifications
    1. Refine the description of "Assignment granularity".
    2. Refine some language issues.

 site2/docs/administration-load-distribution.md | 21 +++++++++------------
 1 file changed, 9 insertions(+), 12 deletions(-)

commit 2782dcf36124b3544ffc013697cd637e2fd7ad1c
Author: Like <like_0903@163.com>
Date:   Tue Apr 2 01:49:34 2019 +0800

    Update connector download URL (#3793)
    
    Closes #3777

 site2/docs/deploy-bare-metal.md                       | 19 +++++--------------
 site2/docs/getting-started-standalone.md              | 19 +++++--------------
 site2/website/scripts/replace.js                      |  2 ++
 .../versioned_docs/version-2.3.0/deploy-bare-metal.md | 19 +++++--------------
 .../version-2.3.0/getting-started-standalone.md       | 19 +++++--------------
 5 files changed, 22 insertions(+), 56 deletions(-)

commit 6f70043183e2c3e7259ba515266a97caa711b321
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Apr 1 11:52:36 2019 -0500

    Refactor and consolidate Utils classes (#3952)
    
    * Consolidating utils classes
    
    * further refactoring
    
    * adding missing class
    
    * add license header

 .../org/apache/pulsar/broker/PulsarService.java    |   4 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 100 +++++++--------
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |   4 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   4 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |   4 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   3 +-
 .../pulsar/functions/instance/ContextImpl.java     |  11 +-
 .../pulsar/functions/instance/InstanceUtils.java   |  16 +--
 .../functions/instance/JavaInstanceRunnable.java   |  20 ++-
 .../apache/pulsar/functions/instance/Utils.java    |  57 ---------
 .../instance/stats/ComponentStatsManager.java      |   4 +-
 .../pulsar/functions/source/PulsarRecord.java      |   4 +-
 .../pulsar/functions/instance/ContextImplTest.java |   5 +-
 .../pulsar/functions/instance/UtilsTest.java       |  55 ---------
 .../auth/KubernetesSecretsTokenAuthProvider.java   |   4 +-
 .../functions/runtime/KubernetesRuntime.java       |  14 +--
 .../pulsar/functions/runtime/LocalRunner.java      |   4 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |   6 +-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |   4 +-
 .../pulsar/functions/runtime/RuntimeUtils.java     |   9 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |   4 +-
 .../functions/runtime/KubernetesRuntimeTest.java   |   4 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   4 +-
 .../{package-info.java => ComponentType.java}      |  21 +++-
 .../utils/{Utils.java => FunctionCommon.java}      |  89 +++++++++++---
 .../functions/utils/FunctionConfigUtils.java       |  18 +--
 .../functions/utils/FunctionDetailsUtils.java      |  71 -----------
 .../apache/pulsar/functions/utils/Reflections.java |   6 +-
 .../pulsar/functions/utils/SinkConfigUtils.java    |  12 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  12 +-
 .../apache/pulsar/functions/utils/StateUtils.java  |  40 ------
 .../pulsar/functions/utils/ValidatorUtils.java     |   6 +-
 .../utils/functioncache/package-info.java          |  23 ----
 .../{UtilsTest.java => FunctionCommonTest.java}    |  52 +++++++-
 .../pulsar/functions/worker/FunctionActioner.java  |  42 +++++--
 .../functions/worker/FunctionRuntimeManager.java   |  25 ++--
 .../pulsar/functions/worker/MembershipManager.java |  13 +-
 .../pulsar/functions/worker/SchedulerManager.java  |   9 +-
 .../org/apache/pulsar/functions/worker/Worker.java |   4 +-
 .../pulsar/functions/worker/WorkerService.java     |  15 +--
 .../worker/{Utils.java => WorkerUtils.java}        |  48 +++-----
 .../functions/worker/rest/api/ComponentImpl.java   |  39 +++---
 .../functions/worker/rest/api/FunctionsImpl.java   |   4 +-
 .../functions/worker/rest/api/FunctionsImplV2.java |   7 +-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |   4 +-
 .../functions/worker/rest/api/SourceImpl.java      |   4 +-
 .../functions/worker/rest/api/WorkerImpl.java      |   9 +-
 .../worker/FunctionRuntimeManagerTest.java         |  10 +-
 .../functions/worker/SchedulerManagerTest.java     |  36 +++---
 .../apache/pulsar/functions/worker/UtilsTest.java  |  43 -------
 .../worker/request/ServiceRequestManagerTest.java  |   4 +-
 .../worker/rest/api/FunctionsImplTest.java         |   8 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  92 +++++++-------
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  94 +++++++--------
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  | 134 +++++++++++----------
 .../rest/api/v3/SourceApiV3ResourceTest.java       | 134 +++++++++++----------
 56 files changed, 639 insertions(+), 833 deletions(-)

commit 08a4e80be797a57e24128f8cd1f1358224ba487e
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Mon Apr 1 22:08:24 2019 +0530

    Added information about generate key location for jwt.  (#3927)
    
    * Added information about generate key location for jwt. Added information about generating base64 encoded key.
    
    * Fixed for 2.2.1 version

 site2/docs/security-token-admin.md                                 | 6 ++++++
 site2/website/versioned_docs/version-2.2.1/security-token-admin.md | 7 ++++++-
 2 files changed, 12 insertions(+), 1 deletion(-)

commit ef6d8d88de1e9fd320afb5da8d7e22c3f0a21922
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Apr 2 00:38:04 2019 +0800

    [Issue 3884] [pulsar-io] Add a Pulsar IO connector for Solr sink (#3885)
    
    * Add a Pulsar IO connector for Solr sink.
    
    * Remove empty lines and add a test scope in pom
    
    * Add license header in pom

 pulsar-io/pom.xml                                  |   1 +
 pulsar-io/solr/pom.xml                             |  86 +++++++++++
 .../apache/pulsar/io/solr/SolrAbstractSink.java    | 131 ++++++++++++++++
 .../pulsar/io/solr/SolrGenericRecordSink.java      |  53 +++++++
 .../org/apache/pulsar/io/solr/SolrSinkConfig.java  | 104 +++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 .../pulsar/io/solr/SolrGenericRecordSinkTest.java  | 109 +++++++++++++
 .../org/apache/pulsar/io/solr/SolrServerUtil.java  |  91 +++++++++++
 .../apache/pulsar/io/solr/SolrSinkConfigTest.java  | 168 +++++++++++++++++++++
 pulsar-io/solr/src/test/resources/sinkConfig.yaml  |  27 ++++
 pulsar-io/solr/src/test/resources/solr.xml         |  38 +++++
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-solr.md                              |  21 +++
 13 files changed, 852 insertions(+)

commit b2aae9c3571f3bc9516a42a794c75d44e6d16e9f
Author: tuteng <eguangning@gmail.com>
Date:   Tue Apr 2 00:36:10 2019 +0800

    [Issue 3837][pulsar-client-tools]Delete schema when deleting a topic (#3941)
    
    Fixes: #3837
    
    ### Motivation
    
    
    * Providing an option to delete schema when deleting a topic.
    
    ### Modifications
    
    * Add deleteSchema parameter for delete and delete-partitioned-topic
    
    ### Verifying this change
    
    Test pass

 .../org/apache/pulsar/admin/cli/PulsarAdminToolTest.java   | 10 ++++++++--
 .../main/java/org/apache/pulsar/admin/cli/CmdTopics.java   | 14 ++++++++++++++
 2 files changed, 22 insertions(+), 2 deletions(-)

commit 205a79bf27050f36d74360ca1f1ca770f9769d6e
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Apr 2 00:35:34 2019 +0800

    Some minor improvement of RabbitMQ IO Source. (#3937)
    
    ### Motivation
    
    This PR try to add some specific config for RabbitMQ IO Source to support setting `basicQos` and `ack`.
    
    ### Modifications
    
    * Add an abstract `RabbitMQAbstractConfig` and `RabbitMQSourceConfig` inherits from it.
    * Add some unit tests.

 pulsar-io/rabbitmq/pom.xml                         |  12 ++
 .../pulsar/io/rabbitmq/RabbitMQAbstractConfig.java | 141 ++++++++++++++++++
 .../apache/pulsar/io/rabbitmq/RabbitMQSource.java  |  32 ++--
 ...bbitMQConfig.java => RabbitMQSourceConfig.java} |  55 +++----
 .../pulsar/io/rabbitmq/RabbitMQBrokerManager.java  |  68 +++++++++
 .../rabbitmq/source/RabbitMQSourceConfigTest.java  | 165 +++++++++++++++++++++
 .../io/rabbitmq/source/RabbitMQSourceTest.java     |  69 +++++++++
 pulsar-io/rabbitmq/src/test/resources/qpid.json    |  37 +++++
 .../rabbitmq/src/test/resources/sourceConfig.yaml  |  36 +++++
 site2/docs/io-rabbitmq.md                          |  17 ++-
 10 files changed, 590 insertions(+), 42 deletions(-)

commit b38cf57ded361459b09c7c4d49e639d3d1038088
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Apr 2 01:35:00 2019 +0900

    Make dependency from client side auth plugins to pulsar-client-original optional (#3957)

 pulsar-client-auth-athenz/pom.xml | 11 +++++++++++
 pulsar-client-auth-sasl/pom.xml   | 16 ++++++++++++++++
 2 files changed, 27 insertions(+)

commit daa0a1897330a53eae1ef2b2dd5d3908e68387cf
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Mon Apr 1 21:37:35 2019 +0530

    Throw error explicitly on param value not in range (#3950)

 .../apache/flink/streaming/connectors/pulsar/PulsarSourceBuilder.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e36ae702ea051913a723a7206e0bad7ae7e1949e
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Mon Apr 1 04:14:55 2019 -0300

    Bugfix an unload non-existent topic (#3946)
    
    *Motivation*
    
    Fixes #3935
    
    When an unload operation is being made to an non-existent topic a null pointer
    exception is thrown due to bad handling exception on general catch clause.
    
    *Modifications*
    
      - Refactor getTopicReference() for a simplified version.
      - Simplify exception thrown when partitioned topics was not found.
      - Fix NPE when unload operation is being made with a non-existent topic.
      - Add test in order to assert unload on normal situation.
      - Add test to assert npe from unload with non existent topic.

 .../broker/admin/impl/PersistentTopicsBase.java    | 41 +++++++++++-----------
 .../pulsar/broker/admin/PersistentTopicsTest.java  | 18 ++++++++++
 2 files changed, 39 insertions(+), 20 deletions(-)

commit b6c509a561402b7e2acf64829e2b964a9197b5ea
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Mar 30 11:04:13 2019 -0700

    By default use `journalFormatVersionToWrite=5` for Bookie journal (#3890)
    
    * By default use `journalFormatVersionToWrite=5` for Bookie journal
    
    * Also set fileInfoFormatVersionToWrite=0

 conf/bookkeeper.conf | 29 +++++++++++++++++++++--------
 1 file changed, 21 insertions(+), 8 deletions(-)

commit cf48435e0170768bd42278c2609694c8498d46a7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Mar 30 07:37:01 2019 -0700

    [pulsar-broker] zk-isolation placement policy should be able to identify overlapped bookies (#3919)

 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   | 13 ++++++
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java | 54 ++++++++++++++++++++++
 2 files changed, 67 insertions(+)

commit 129b95d02ab768d7d31c16e4efedd246fe441322
Author: forjingma <forjingma@dingtalk.com>
Date:   Sat Mar 30 11:10:09 2019 +0800

    Fix Flink Example broken for dependency problems #3951
    
    Signed-off-by: forjingma <forjingma@dingtalk.com>
    
    ## Motivation
    In pulsar 2.3 Flink example is broken. User will encountere java.lang.NoClassDefFoundError when running PulsarConsumerSourceWordCount example.
    
    ## Modifications
    The fix is add bouncycastle into shaded fat jar.
    
    ## Verifying this change
    Verified by flink-1.6.1 and pulsar-2.3.0.

 examples/flink/pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit 86438dbdeef7605528120dcfe83e5fd60b16efd0
Author: Like <like_0903@163.com>
Date:   Sat Mar 30 07:57:22 2019 +0800

    Remove the exception which will never be thrown (#3942)

 .../main/java/org/apache/pulsar/client/cli/PulsarClientTool.java | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

commit 50fb65d8075f78f4a295f4192d75007cfcea830c
Author: penghui <codelipenghui@gmail.com>
Date:   Sat Mar 30 05:45:45 2019 +0800

    Fix comments of schema compatibility strategy. (#3923)
    
    ### Motivation
    
    Fix comments of schema compatibility strategy.
    
    ### Modifications
    
    Change comment of SchemaCompatibilityStrategy.BACKWARD and SchemaCompatibilityStrategy.FORWARD

 .../pulsar/broker/service/schema/SchemaCompatibilityStrategy.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 5ea423150ba4d879207a22899cdd6e8154e6382f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Mar 29 16:41:31 2019 -0500

    fix submit function via url (#3934)
    
    * fix submit function via url
    
    * cleaning up
    
    * add test
    
    * make method private
    
    * add additional tests
    
    * cleaning up
    
    * improving tests

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 119 +++++++++++++++++++--
 .../org/apache/pulsar/functions/utils/Utils.java   |  44 ++------
 2 files changed, 119 insertions(+), 44 deletions(-)

commit 4150f472860b907e6c6a47039f110fbec496a684
Author: Jia Zhai <zhaijia@apache.org>
Date:   Sat Mar 30 05:39:20 2019 +0800

    [Pulsar IO]: Add a source connector for debezium postgres (#3924)
    
    This PR try to add a source connector for debezium postgres.
    
    changes:
    - add debezium postges project;
    - add DebeziumSource, and make mysql and postgres both inherit from it.

 pom.xml                                            |   2 +-
 .../apache/pulsar/io/debezium/DebeziumSource.java  | 103 +++++++++++++++++++++
 .../io/debezium/mysql/DebeziumMysqlSource.java     |  82 +---------------
 pulsar-io/debezium/pom.xml                         |   1 +
 pulsar-io/debezium/postgres/pom.xml                |  58 ++++++++++++
 .../debezium/postgres/DebeziumPostgresSource.java  |  37 ++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++++
 .../resources/debezium-postgres-source-config.yaml |  41 ++++++++
 8 files changed, 267 insertions(+), 79 deletions(-)

commit c463a04a7ecfbfde4a1ea6384874a7c26dafc0fa
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sat Mar 30 05:02:14 2019 +0900

    Upgrade third party libraries with security vulnerabilities (#3938)
    
    * Upgrade jackson version to 2.9.8
    
    * Upgrade commons-collections version to 1.10

 distribution/server/src/assemble/LICENSE.bin.txt | 23 ++++++++++-------------
 pom.xml                                          |  4 ++--
 pulsar-broker/pom.xml                            |  5 +++++
 pulsar-sql/pom.xml                               |  2 +-
 pulsar-sql/presto-distribution/LICENSE           |  3 +--
 pulsar-sql/presto-distribution/pom.xml           |  4 ++--
 6 files changed, 21 insertions(+), 20 deletions(-)

commit 534bddc7a887bc62cd0f7f563f34207b6f4be197
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 29 10:22:53 2019 -0700

    Fixed manual offloading when the last ledger is empty (#3913)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 13 +++++--
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 43 ++++++++++++++++++++++
 .../broker/service/persistent/PersistentTopic.java | 15 +++++---
 3 files changed, 62 insertions(+), 9 deletions(-)

commit 7e7175db004a9f724d788ecace4beb76ff482c95
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Mar 29 09:11:40 2019 -0700

    [schema] store schema type correctly in schema registry (#3940)
    
    *Motivation*
    
    Fixes #3925
    
    We have 3 places of defining schema type enums. We kept adding
    new schema type in pulsar-common. However we don't update the schema type
    in wire protocol and schema storage.
    
    This causes `SchemaType.NONE` is stored in SchemaRegistry.
    It fails debeizum connector on restarting.
    
    *Modifications*
    
    Make sure all 3 places have consistent schema type definitions.
    Record the correct schema type.

 .../apache/pulsar/broker/service/ServerCnx.java    |  19 +---
 .../service/schema/SchemaRegistryServiceImpl.java  |  33 ++----
 .../src/main/proto/SchemaRegistryFormat.proto      |  11 ++
 .../apache/pulsar/common/schema/SchemaType.java    | 121 +++++++++++++++------
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |   3 +-
 .../client/impl/schema/AutoConsumeSchema.java      |   8 ++
 .../org/apache/pulsar/common/api/Commands.java     |  37 ++-----
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  33 ++++++
 .../apache/pulsar/common/schema/SchemaData.java    |   2 +
 pulsar-common/src/main/proto/PulsarApi.proto       |  11 ++
 .../pulsar/functions/source/TopicSchema.java       |  18 ++-
 12 files changed, 187 insertions(+), 111 deletions(-)

commit 08c97f703a5bf1de2330c4c6ae00a2fe170ed692
Author: Laurent Chriqui <40354867+laurent-chriqui@users.noreply.github.com>
Date:   Fri Mar 29 17:08:42 2019 +0100

    [Issue 3926][functions] Add delete counter in python functions state_context (#3930)
    
    * add delete_counter in python functions state_context
    
    * Update contextimpl.py
    
    Matched the name of the stub method to the one in ContextImpl

 pulsar-client-cpp/python/pulsar/functions/context.py       | 5 +++++
 pulsar-functions/instance/src/main/python/contextimpl.py   | 3 +++
 pulsar-functions/instance/src/main/python/state_context.py | 7 +++++--
 3 files changed, 13 insertions(+), 2 deletions(-)

commit 07030e3af46f0f22805a1f51869501bee37bbe1b
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Mar 29 12:39:54 2019 +0800

    [Issue 3867] Provide the description of sink/source command for better usage (#3868)
    
    ### Motivation
    
    Fixes #3867
    
    ### Modifications
    
    Add the usage of chosen subcommand when `processArguments` failed.

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java    | 10 +++++++++-
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java  | 10 +++++++++-
 2 files changed, 18 insertions(+), 2 deletions(-)

commit f3095d8697ccbe62e4676f94e671047a82bebe40
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 28 21:22:37 2019 -0700

    Classloader choice for validating Source/Sink (#3865)
    
    * Try both regular classloader as well as nar class loader for validating source/sinks
    
    * Fixed test
    
    * Fix unittest
    
    * Added more comments to the code
    
    * rename variables
    
    * Wait for the create to succeed before updating. Otherwise there might be some reamnant producers

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  8 +++
 .../pulsar/functions/utils/SinkConfigUtils.java    | 34 +++++++++--
 .../pulsar/functions/utils/SourceConfigUtils.java  | 32 ++++++++--
 .../functions/worker/rest/api/ComponentImpl.java   |  3 +
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |  2 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |  2 +-
 .../integration/functions/PulsarFunctionsTest.java | 68 ++++++++++++++++++++++
 7 files changed, 137 insertions(+), 12 deletions(-)

commit 5740699b834439651dc57c87edac2a3002202921
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 28 16:23:30 2019 -0700

    Cleanup logic in JavaInstanceRunnable close method (#3932)
    
    * Cleanup logic in JavaInstanceRunnable close method
    
    * Added comments

 .../functions/instance/JavaInstanceRunnable.java   | 25 ++++++++++++++++------
 1 file changed, 18 insertions(+), 7 deletions(-)

commit c11c48f9aa7075f1b1130a7249821587fef197b3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Mar 28 15:50:46 2019 -0700

    clean-up unnecessary public from interface (#3921)

 .../src/main/java/org/apache/pulsar/client/admin/Namespaces.java  | 8 ++++----
 .../src/main/java/org/apache/pulsar/client/admin/Topics.java      | 8 ++++----
 2 files changed, 8 insertions(+), 8 deletions(-)

commit 0487804c6ba39f227c1f2e7d293700dcc3dcf646
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Thu Mar 28 13:33:58 2019 -0700

    Support Kafka's ConsumerConfig.INTERCEPTOR_CLASSES_CONFIG in PulsarKafkaConsumer. (#3911)
    
    * Support Kafka's ConsumerConfig.INTERCEPTOR_CLASSES_CONFIG in PulsarKafkaConsumer.
    Apply onConsume in poll() before returning the ConsumerRecords,
    apply onCommit in doCommitOffsets() before committing all offsets.
    
    Also apply doc to reflect support for ConsumerConfig.INTERCEPTOR_CLASSES_CONFIG.
    
    * Update error message for applying onConsume and onCommit for interceptors to include the specific interceptor name.

 .../clients/consumer/PulsarKafkaConsumer.java      | 46 +++++++++++++++++++++-
 site2/docs/adaptors-kafka.md                       |  1 +
 2 files changed, 46 insertions(+), 1 deletion(-)

commit ee395ca597beee9a0d844fd305d68b8400c947d5
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Mar 29 04:33:17 2019 +0800

    Fix source/sink creation to use JSON config values. (#3922)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java            | 2 +-
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java          | 3 +--
 .../src/test/java/org/apache/pulsar/admin/cli/TestCmdSinks.java        | 2 +-
 .../src/test/java/org/apache/pulsar/admin/cli/TestCmdSources.java      | 2 +-
 4 files changed, 4 insertions(+), 5 deletions(-)

commit 012b818bf4d6c0ea7d3b5cc4ea79d9ed5e14ac48
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Mar 28 13:25:26 2019 -0700

    [pulsar-broker] Fix: Deserialization failing for ZkIsolatedBookieEnsemblePlacementPolicy (#3918)

 .../ZkIsolatedBookieEnsemblePlacementPolicy.java        | 17 +++++++----------
 1 file changed, 7 insertions(+), 10 deletions(-)

commit 4a739e5def56551bb873f08d7f1d54cc97d827bb
Author: wpl <1269223860@qq.com>
Date:   Thu Mar 28 15:24:36 2019 -0500

    fix jcloud shaded in IDEA (#3912)

 tiered-storage/jcloud/pom.xml | 2 +-
 tiered-storage/pom.xml        | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 625649fb0a1de2cfc39b889dec411e412aefca73
Author: Steve M. Kim <chairmanK@gmail.com>
Date:   Thu Mar 28 15:23:23 2019 -0500

    Include java-xmlbuilder in tiered-storage-jcloud NAR (#3928) (#3929)
    
    In the POM file for tiered-storage-jcloud, the dependency on
    com.jamesmurty.utils/java-xmlbuilder was marked with test scope, but in
    fact this dependency is needed during normal use. This commit changes
    the POM file so that the java-xmlbuilder dependency is packaged in the
    NAR file.

 tiered-storage/jcloud/pom.xml | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)

commit 70cc68229de6c3e6620b60a20f2f4faa4b93ce6a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 28 09:32:17 2019 -0700

    Using Auto Consume consumer on a topic that doesn't have a schema doesn't work (#3909)

 .../tests/integration/functions/PulsarFunctionsTest.java    | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

commit 14d1eaa73e1479e403042da87ad34c7a35a304e2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Mar 28 11:26:12 2019 -0500

    [ISSUE 3763] - Implementing Function authorization (#3874)
    
    * Implementing Function Authorization

 conf/functions_worker.yml                          |  13 +-
 .../authorization/AuthorizationProvider.java       |  10 +
 .../broker/authorization/AuthorizationService.java |   6 +-
 .../authorization/PulsarAuthorizationProvider.java |  42 ++
 .../org/apache/pulsar/PulsarBrokerStarter.java     |   6 +
 .../java/org/apache/pulsar/PulsarStandalone.java   |   7 +
 .../org/apache/pulsar/broker/PulsarService.java    |  10 +-
 .../pulsar/broker/admin/impl/FunctionsBase.java    |  32 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |  22 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |  22 +-
 .../api/AuthorizationProducerConsumerTest.java     |   5 +
 .../worker/PulsarFunctionE2ESecurityTest.java      | 516 +++++++++++++++++++++
 .../worker/PulsarWorkerAssignmentTest.java         |   4 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   4 +
 .../pulsar/common/policies/data/AuthAction.java    |   3 +
 .../org/apache/pulsar/functions/worker/Worker.java |  68 ++-
 .../pulsar/functions/worker/WorkerConfig.java      |  22 +
 .../pulsar/functions/worker/WorkerService.java     |  19 +-
 .../functions/worker/rest/api/ComponentImpl.java   | 269 +++++++++--
 .../functions/worker/rest/api/FunctionsImpl.java   |  13 +-
 .../functions/worker/rest/api/FunctionsImplV2.java |  24 +-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |  13 +-
 .../functions/worker/rest/api/SourceImpl.java      |  12 +-
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |  30 +-
 .../worker/rest/api/v3/SinkApiV3Resource.java      |  22 +-
 .../worker/rest/api/v3/SourceApiV3Resource.java    |  22 +-
 .../worker/rest/api/FunctionsImplTest.java         |   2 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  20 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |  16 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |  16 +-
 30 files changed, 1091 insertions(+), 179 deletions(-)

commit bda6a9cc8edb0aef7d969ce618fcfe212bdb425a
Author: wpl <1269223860@qq.com>
Date:   Thu Mar 28 01:59:25 2019 -0500

    [pulsar-client] add Date/Time/Timestamp schema (#3856)
    
    Fixes #3831

 .gitignore                                         |  1 +
 .../java/org/apache/pulsar/client/api/Schema.java  | 18 ++++++
 .../client/internal/DefaultImplementation.java     | 21 +++++++
 .../apache/pulsar/common/schema/SchemaType.java    | 18 ++++++
 pulsar-client/pom.xml                              | 17 ++++++
 .../pulsar/client/impl/schema/DateSchema.java      | 65 ++++++++++++++++++++++
 .../client/impl/schema/FieldSchemaBuilderImpl.java | 11 ++++
 .../pulsar/client/impl/schema/TimeSchema.java      | 65 ++++++++++++++++++++++
 .../pulsar/client/impl/schema/TimestampSchema.java | 65 ++++++++++++++++++++++
 .../pulsar/client/impl/schema/AvroSchemaTest.java  | 45 ++++++++++++++-
 .../client/impl/schema/PrimitiveSchemaTest.java    | 12 ++++
 .../src/test/resources/avro/NasaMission.avsc       | 11 ++++
 12 files changed, 348 insertions(+), 1 deletion(-)

commit 19dd255526272f3310a7f9f4cd53d25eecd442e9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Mar 27 23:56:17 2019 -0700

    Misc Function fixes:- (#3907)
    
    1) Collect input topics from the function details spec
    2) Catch all errors during source/sink close since its user code

 .../java/org/apache/pulsar/functions/instance/ContextImpl.java |  7 ++-----
 .../apache/pulsar/functions/instance/JavaInstanceRunnable.java | 10 +++-------
 .../org/apache/pulsar/functions/instance/ContextImplTest.java  |  1 -
 3 files changed, 5 insertions(+), 13 deletions(-)

commit a4a53c7047d87d6e54cf3b2e3d66c7058c1cd21b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Mar 27 23:54:14 2019 -0700

    Fix: unloading namespace logging (#3920)
    
    ### Motivation
    Fix: unloading namespace logging

 .../main/java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7c25029a1fbb3059e8d83bfe4e7ceb7f8d88b52b
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Mar 28 10:52:52 2019 +0800

    [Doc]Fix typo and language issues in the adapter-kafka.md file (#3897)
    
    Motivation
    Fix typo and language issues in the adapter-kafka.md file. I'm trying to make it clear, concise and logical.
    
    Modifications
    Refine typos;
    Refine from the language perspective, make it easy to read and understand;
    Refine some answers, make it clear and correct;

 site2/docs/adaptors-kafka.md | 73 ++++++++++++++++++++++----------------------
 1 file changed, 36 insertions(+), 37 deletions(-)

commit 82166d0239da3af9c4add7c126fec211d58b4faa
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Mar 27 14:32:43 2019 -0700

    [pulsar-broker] fix ClassCastException at ZkIsolatedBookieEnsemblePlacementPolicy (#3917)

 .../main/java/org/apache/pulsar/broker/BookKeeperClientFactoryImpl.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9b032a1e69ad7648f8ccfd73f21f1b03222f438a
Author: Jennifer Huang <47805623+Jennifer88huang@users.noreply.github.com>
Date:   Thu Mar 28 04:57:50 2019 +0800

    Update admin-api-non-persistent-topics.md (#3914)
    
    ### Motivation
    The original topic name structure is incorrect. I correct the topic name structure.
    
    ### Modifications
    Refine topic name structure as "non-persistent://tenant/namespace/topic".

 site2/docs/admin-api-non-persistent-topics.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ee7b6a44b0f9866a2e66c7b2f848b74804044c07
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Wed Mar 27 12:47:02 2019 -0300

    [issue #3895] Bugfix for non partitioned topic create (#3910)
    
    **Motivation**
    
    Provide a different approach from #3902 trying to fix #3895.
    
    **Modifications**
    
      - Add unit test in order to exploit issue.
      - Do proper validations for non topic create.
      - Add missing validateTopicName() method on create non partitioned topic.

 .../pulsar/broker/admin/impl/PersistentTopicsBase.java     | 14 ++++++++------
 .../apache/pulsar/broker/admin/v2/PersistentTopics.java    |  1 +
 .../apache/pulsar/broker/admin/PersistentTopicsTest.java   | 10 ++++++++++
 3 files changed, 19 insertions(+), 6 deletions(-)

commit ee98e8b28ce1397c056757fe73115d21320ed883
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Wed Mar 27 02:33:46 2019 -0300

    [cpp client] implement reference count for close() (#3863)
    
    Add reference count feature to keep track of reused instances of a consumer
    instance, for more details please see commit ff4db8d.
    
    *Modifications*
    
      - Add refCount instance variable on ConsumerImpl.
      - Use new safeDecrRefCount() on consumer close() in order to know whether
        effective close call should occur or not.
      - Increment reference count when a previous built consumer instance is being
        used by caller.
    
    *Future considerations*
    
    Thereafter when feature preventing duplicated consumer is made for
    PartitionedConsumer, MultiTopicsConsumer and PatternMultiTopicsConsumer,
    incrRefCount() member could be turned into a pure virtual method.

 pulsar-client-cpp/lib/ClientImpl.cc          |  1 +
 pulsar-client-cpp/lib/ConsumerImpl.cc        | 16 ++++++++++++++--
 pulsar-client-cpp/lib/ConsumerImpl.h         |  3 +++
 pulsar-client-cpp/lib/ConsumerImplBase.h     |  1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc |  4 ++++
 5 files changed, 23 insertions(+), 2 deletions(-)

commit fa80feb562b97b655808b8c2879606de8eb14ea7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 26 22:18:11 2019 -0700

    [schema] Batch message should propagate the schema version from single message (#3870)
    
    *Motivation*
    
    Schema version is set on single message's header. But it isn't propagated to
    the batch message's header. So when the consumer receives the message batch,
    it doesn't contain the schema version.
    
    *Modifications*
    
    When intializing a message batch, propagate the schema version from single message to batch message header.
    
    *Verify this change*
    
    Verified with an integration test. Need to write some unit tests for it.

 .../apache/pulsar/client/api/SimpleSchemaTest.java | 31 ++++++++++++++++++++++
 .../org/apache/pulsar/common/api/Commands.java     |  3 +++
 2 files changed, 34 insertions(+)

commit 971c98187bd449b0032d621fc59b9643e9c3010f
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Wed Mar 27 13:15:03 2019 +0800

    Logical type use (#3900)
    
    ## Motivation
    
    To compromise avros bug for avro filed logical type
    https://issues.apache.org/jira/browse/AVRO-1891
    
    ## Modifications
    add some initialize class
    
    ## Verifying this change
    Add logical type test in AvroSchemaTest

 pom.xml                                            |  1 +
 pulsar-client/pom.xml                              |  6 +++
 .../pulsar/client/impl/schema/AvroSchema.java      | 29 ++++++++++++++
 .../pulsar/client/impl/schema/AvroSchemaTest.java  | 46 ++++++++++++++++++++++
 4 files changed, 82 insertions(+)

commit b42c1e555b0091de93f65ea9903058e314eb84d3
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Tue Mar 26 10:49:57 2019 -0700

    Support Kafka's ConsumerConfig.MAX_POLL_RECORDS_CONFIG to config max number of message will return in a single poll. (#3887)
    
    Also update doc to reflect that we already supporting earlist and latest strategy for ConsumerConfig.AUTO_OFFSET_RESET_CONFIG.

 .../apache/kafka/clients/consumer/PulsarKafkaConsumer.java  | 13 ++++++++++---
 site2/docs/adaptors-kafka.md                                |  4 ++--
 2 files changed, 12 insertions(+), 5 deletions(-)

commit 52659ae7680db4f9d2bdc6468dcc3b135a915be5
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Mar 27 01:22:52 2019 +0800

    [Issue 3896] [pulsar-io] Fix NPE in ElasticSearchSink (#3899)
    
    * Fix NPE in ElasticSearchSink.
    
    * Init by an empty string

 .../main/java/org/apache/pulsar/io/elasticsearch/ElasticSearchSink.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit fd8aa4fadb0702758e9086411689e4dbe67115b6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Mar 25 20:53:19 2019 -0700

    [pulsar-broker] Add support of default ttl for namespace (#3898)

 conf/broker.conf                                   |  3 ++
 conf/standalone.conf                               |  3 ++
 .../apache/pulsar/broker/ServiceConfiguration.java |  8 +++-
 .../broker/service/persistent/PersistentTopic.java |  9 +++--
 .../pulsar/client/impl/TopicsConsumerImplTest.java | 45 ++++++++++++++++++++++
 site2/docs/reference-configuration.md              |  1 +
 6 files changed, 65 insertions(+), 4 deletions(-)

commit 8db0f86666a5641ebd34db231326aaf4d843baf5
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Mar 25 20:39:09 2019 -0700

    Added sensitive annotations (#3866)

 .../main/java/org/apache/pulsar/io/canal/CanalSourceConfig.java    | 2 ++
 .../main/java/org/apache/pulsar/io/core/annotations/FieldDoc.java  | 7 +++++++
 .../org/apache/pulsar/io/elasticsearch/ElasticSearchConfig.java    | 2 ++
 .../src/main/java/org/apache/pulsar/io/jdbc/JdbcSinkConfig.java    | 2 ++
 .../main/java/org/apache/pulsar/io/redis/RedisAbstractConfig.java  | 1 +
 .../java/org/apache/pulsar/io/twitter/TwitterFireHoseConfig.java   | 4 ++++
 6 files changed, 18 insertions(+)

commit 41d5af75250855bd851026f94807efa9dc55abe7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Mar 25 19:05:31 2019 -0700

    Add ability to specify runtime flags in functions/sources/sinks (#3872)

 .../java/org/apache/pulsar/common/functions/FunctionConfig.java   | 4 ++++
 .../src/main/java/org/apache/pulsar/common/io/SinkConfig.java     | 3 +++
 .../src/main/java/org/apache/pulsar/common/io/SourceConfig.java   | 2 ++
 pulsar-functions/proto/src/main/proto/Function.proto              | 1 +
 .../java/org/apache/pulsar/functions/runtime/RuntimeUtils.java    | 6 ++++++
 .../org/apache/pulsar/functions/utils/FunctionConfigUtils.java    | 8 ++++++++
 .../java/org/apache/pulsar/functions/utils/SinkConfigUtils.java   | 8 ++++++++
 .../java/org/apache/pulsar/functions/utils/SourceConfigUtils.java | 8 ++++++++
 .../apache/pulsar/functions/utils/FunctionConfigUtilsTest.java    | 1 +
 .../org/apache/pulsar/functions/utils/SinkConfigUtilsTest.java    | 1 +
 .../org/apache/pulsar/functions/utils/SourceConfigUtilsTest.java  | 1 +
 11 files changed, 43 insertions(+)

commit 1921bd98f20991248892717bbcfc102545e7c49c
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 24 21:19:54 2019 -0700

    Refactored ReplicatorTest to be more easily debuggable (#3892)

 .../pulsar/broker/service/ReplicatorTest.java      | 429 ++++------
 .../pulsar/broker/service/ReplicatorTestBase.java  |  71 +-
 .../broker/service/v1/V1_ReplicatorTest.java       | 937 ---------------------
 .../broker/service/v1/V1_ReplicatorTestBase.java   | 377 ---------
 4 files changed, 207 insertions(+), 1607 deletions(-)

commit ef4c0a93c4b04268d9e3ef93718af62769a772ca
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 24 20:32:28 2019 -0700

    Use minimal number of threads in BK instance used for tests (#3889)
    
    ### Motivation
    
    There are several tests that are using the LocalBookkeeperEnsemble to spin up "real" bookies. We should use a small amount of threads rather than the default.

 .../java/org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java   | 6 ++++++
 1 file changed, 6 insertions(+)

commit 19fd91c484bf40cf8677cd529d155f3210fd59d4
Author: Cristian <me@cristian.io>
Date:   Sun Mar 24 20:28:38 2019 -0700

    [flink] Allow to specify a custom Pulsar producer (#3894)
    
    This is necessary in pretty much any non-trivial use-case. The ability
    to control the settings of the Pulsar producer is paramount to
    building real-life applications

 .../streaming/connectors/pulsar/FlinkPulsarProducer.java   | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

commit f93650fced6595c46d97a2022d37a862985f4f11
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 24 12:33:41 2019 -0700

    Fixed reading from file with newlines (#3864)

 .../client/impl/auth/AuthenticationToken.java      |  2 +-
 .../client/impl/auth/AuthenticationTokenTest.java  | 28 ++++++++++++++++++++++
 2 files changed, 29 insertions(+), 1 deletion(-)

commit 044daf8d61328265640a5b3e5008fc04fac73efa
Author: Cristian <me@cristian.io>
Date:   Sun Mar 24 09:18:44 2019 -0700

    Fix typos (#3893)

 deployment/kubernetes/helm/pulsar/values.yaml | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 5653df8b396d1876e09bf002bf02e55f97a62415
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 24 09:17:04 2019 -0700

    Encode client version into Java source file instead of pulsar-client-version.properties (#3880)

 pulsar-client/pom.xml                              | 13 +++++++++
 .../org/apache/pulsar/PulsarVersion.java           | 25 +++++++++++++++++
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  7 ++---
 .../org/apache/pulsar/client/impl/HttpClient.java  | 32 ++--------------------
 .../resources/pulsar-client-version.properties     | 20 --------------
 .../apache/pulsar/proxy/server/ProxyClientCnx.java | 10 +++----
 6 files changed, 48 insertions(+), 59 deletions(-)

commit 16e3b128b65a633188ea03f5a3438dc6fef16ac9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Mar 24 11:16:47 2019 -0500

    fix: ack timeout in  pulsar cpp client when subscribing to regex topic (#3879)
    
    * fix bug involving ack timeout in  pulsar cpp client when subscribing to regex topic
    
    * remove newline
    
    * fix indent
    
    * add test
    
    * addressing comments
    
    * fix formatting
    
    * fix formatting

 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc |  1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 50 +++++++++++++++++++++++-
 2 files changed, 50 insertions(+), 1 deletion(-)

commit dfc0e0e9c521a212f11cdf8b3384005008c9c605
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Mar 23 22:54:39 2019 -0500

    fix: NPE when stats manager not initialized (#3891)
    
    * fix: NPE when stats manager not initialized
    
    * remove unnecessary imports
    
    * add test

 .../functions/instance/JavaInstanceRunnable.java   |  65 +++---
 .../instance/JavaInstanceRunnableTest.java         |  18 +-
 .../worker/rest/api/FunctionsImplTest.java         | 230 +++++++++++++++++++++
 3 files changed, 279 insertions(+), 34 deletions(-)

commit e4fc42da737f5d62bb4d19e2d306a1d7101ba9bf
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Mar 23 17:21:11 2019 -0700

    Namespace service should not use static variable maps (#3888)

 .../java/org/apache/pulsar/broker/namespace/NamespaceService.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 39504593420e2585719987f4654e0229efecd971
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 22 16:00:33 2019 -0700

    Enable generation of swagger definitions for functions/sources/sinks (#3871)
    
    * Enable generation of swagger definitions for functions/sources/sinks
    
    * Added more changes to make it backwards compatible
    
    * Add logic to server functions rest api
    
    * Deleted swagger file since its supposed to be generated.
    Also added some missing python packages for building
    
    * Added back deleted file
    
    * Fix comments
    
    * Seperated out sources and sinks
    
    * More changes to collapse all rest apis into one dropdown

 pulsar-broker/pom.xml                              | 54 +++++++++++++++++++++-
 .../apache/pulsar/broker/admin/v2/Functions.java   |  2 +-
 .../apache/pulsar/broker/admin/v3/Functions.java   |  2 +-
 .../org/apache/pulsar/broker/admin/v3/Sink.java    |  2 +-
 .../org/apache/pulsar/broker/admin/v3/Source.java  |  2 +-
 pulsar-client-cpp/docker/Dockerfile                |  3 ++
 site2/tools/python-doc-gen.sh                      |  9 +++-
 site2/website/pages/en/admin-rest-api.js           |  2 +-
 site2/website/pages/en/functions-rest-api.js       | 22 +++++++++
 site2/website/pages/en/sink-rest-api.js            | 22 +++++++++
 site2/website/pages/en/source-rest-api.js          | 22 +++++++++
 site2/website/siteConfig.js                        | 11 ++++-
 site2/website/static/css/custom.css                |  4 ++
 site2/website/static/js/custom.js                  | 29 ++++++++++++
 src/gen-swagger.sh                                 |  2 +-
 15 files changed, 179 insertions(+), 9 deletions(-)

commit f03971cb5b4f9f00195b9b5bf7191d2d7115034a
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Thu Mar 21 01:19:16 2019 +0530

    Update README.md (#3841)
    
    Intellij needs the lombok plugin to generate the code (getter, setter, data etc) used in this project.

 README.md | 2 ++
 1 file changed, 2 insertions(+)

commit f1c893d0a9f796ca848ee08470e0e768fb4381be
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Mar 19 20:27:52 2019 -0700

    Create ManagedCursor with initial properties (#3857)

 .../apache/bookkeeper/mledger/ManagedLedger.java   | 37 ++++++++++++++++++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 10 +++---
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 21 +++++++++---
 .../mledger/impl/ManagedCursorPropertiesTest.java  | 25 +++++++++++++++
 4 files changed, 84 insertions(+), 9 deletions(-)

commit e77a165dd2c0f29268b079c5f9a213f3994ea3a8
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Tue Mar 19 20:27:30 2019 -0700

    Add a wrapper around Kafka's ProducerInterceptor to support Kafka's ProducerConfig.INTERCEPTOR_CLASSES_CONFIG. #1090 (#3843)
    
    **Motivatio**
    Add a wrapper around Kafka's `org.apache.kafka.clients.producer.ProducerInterceptor` to support Kafka's ProducerConfig.INTERCEPTOR_CLASSES_CONFIG. #1090
    
    The wrapper will try to delegate all call to underlying instance of Kafka's `org.apache.kafka.clients.producer.ProducerInterceptor`  it holds.
    
    When `PulsarKafkaProducer` convert a Kafka's `ProducerRecord` to Pulsar's `Message`, the schema(fixed to type of Schema<byte[]>), key, value, eventTimestamp and partitionID is set.
    When doing the delegation, we'll do
    Pulsar`Message` -> Kafka's `ProducerRecord` -> invoke underlying Kafka's `org.apache.kafka.clients.producer.ProducerInterceptor#onSend`  -> Pulsar`Message`
    It'll try to preserve all the information. Verified through unit test.
    For `org.apache.kafka.clients.producer.ProducerInterceptor#onSendAcknowledgement` it'll call `org.apache.kafka.clients.producer.ProducerInterceptor#onAcknowledgement` only partitionID, eventTimestamp, key byte lenth, value byte length will be pass in.

 .../clients/producer/PulsarKafkaProducer.java      |  32 ++-
 .../compat/KafkaProducerInterceptorWrapper.java    | 254 +++++++++++++++++++++
 .../clients/producer/PulsarKafkaProducerTest.java  |  86 ++++++-
 .../KafkaProducerInterceptorWrapperTest.java       | 102 +++++++++
 site2/docs/adaptors-kafka.md                       |   2 +-
 5 files changed, 472 insertions(+), 4 deletions(-)

commit c180bbcd3212424c6e37f58394e5c61bf8e37abb
Author: Malcolm Taylor <malcolm@semmle.com>
Date:   Wed Mar 20 01:36:35 2019 +0000

    fix some LGTM alerts (#3531)
    
    ### Motivation
    
    LGTM has raised some alerts during analysis of apache/pulsar (https://lgtm.com/projects/g/apache/pulsar/alerts/?mode=tree).
    
    ### Modifications
    
    - Fixed 1 `Array index out of bounds` error in AbstractMetrics
    - Fixed 3 cases of `Hashed value without hashCode definition` in NamespaceService
    - Fixed 1 `Reference equality test of boxed types` in Policies
    - Fixed 1 `Wrong NaN comparison` in ProducerStatsRecorderImpl
    - Fixed 16 cases of `Inconsistent equals and hashCode` where equals had been overridden but hashCode was not

 .../apache/pulsar/broker/loadbalance/LeaderBroker.java |  5 +++++
 .../pulsar/broker/stats/metrics/AbstractMetrics.java   |  2 +-
 .../apache/pulsar/common/naming/NamespaceBundle.java   |  7 +++++++
 .../apache/pulsar/common/naming/NamespaceBundles.java  |  5 +++++
 .../pulsar/client/impl/ProducerStatsRecorderImpl.java  |  2 +-
 .../apache/pulsar/client/impl/TopicMessageIdImpl.java  |  5 +++++
 .../pulsar/common/policies/data/AuthPolicies.java      |  6 ++++++
 .../common/policies/data/AutoFailoverPolicyData.java   |  5 +++++
 .../policies/data/BrokerNamespaceIsolationData.java    |  5 +++++
 .../pulsar/common/policies/data/BundlesData.java       |  5 +++++
 .../pulsar/common/policies/data/FailureDomain.java     |  5 +++++
 .../pulsar/common/policies/data/LocalPolicies.java     |  5 +++++
 .../common/policies/data/NamespaceIsolationData.java   |  6 ++++++
 .../common/policies/data/PersistencePolicies.java      |  7 +++++++
 .../apache/pulsar/common/policies/data/Policies.java   | 18 +++++++++++++++++-
 .../pulsar/common/policies/data/ResourceQuota.java     |  6 ++++++
 .../common/policies/impl/MinAvailablePolicy.java       |  5 +++++
 .../policies/impl/NamespaceIsolationPolicyImpl.java    |  6 ++++++
 18 files changed, 102 insertions(+), 3 deletions(-)

commit 9ab80c8180d09e034d779444c4fb62b874d9720f
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Mar 20 09:34:12 2019 +0800

    Fix read batching message by pulsar reader (#3830)
    
    ### Motivation
    
    Fix bug of reader.hasMessageAvailable().
    
    ```java
    while (reader.hasMessageAvailable()) {
            Message msg = reader.readNext();
        // Do something
    }
    ```
    
    If lastDequeuedMessage with a batchMessageId, reader.hasMessageAvailable() will return false after read first message of batchMessage, because compared message id is a MessageIdImpl(lastMessageIdInBroker)
    
    ### Modifications
    
    Add batching message check.
    
    ### Verifying this change
    
    - [x] This change added tests and can be verified as follows:
    - *Added UT tests for read batch message and non-batch message*

 .../org/apache/pulsar/client/impl/ReaderTest.java  | 115 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  20 ++--
 2 files changed, 129 insertions(+), 6 deletions(-)

commit 83c448c339f9ea8daef6ee867d30de803741d139
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Wed Mar 20 00:43:30 2019 +0530

    [issue 3839][doc] Document default of schema-autoupdate-strategy : FULL (#3842)
    
    The documentation was missing default value for the cli property *schema-autoupdate-strategy compatibilty*
    
    Added the missing documentation

 site2/docs/reference-pulsar-admin.md                                 | 2 +-
 site2/website/versioned_docs/version-2.3.0/reference-pulsar-admin.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit a057a1430a186b6c874b9605a0c525daf3846900
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Mar 19 11:05:27 2019 -0700

    [pulsar-broker] Fix deadlock: add zk-operation timeout for blocking call on zk-cache (#3633)
    
    fix: compilation
    
    fix test
    
    fix test

 conf/broker.conf                                    |  3 +++
 conf/standalone.conf                                |  3 +++
 .../apache/pulsar/broker/ServiceConfiguration.java  |  5 +++++
 .../broker/authorization/AuthorizationService.java  | 17 ++++++++++-------
 .../pulsar/broker/BookKeeperClientFactoryImpl.java  |  4 ++--
 .../org/apache/pulsar/broker/PulsarService.java     |  6 ++++--
 .../pulsar/broker/namespace/NamespaceService.java   | 17 ++++++++++-------
 .../service/persistent/DispatchRateLimiter.java     |  3 +--
 .../service/persistent/SubscribeRateLimiter.java    |  1 -
 .../apache/pulsar/broker/web/PulsarWebResource.java |  6 +++---
 .../pulsar/broker/cache/ResourceQuotaCacheTest.java |  2 +-
 .../pulsar/broker/namespace/OwnershipCacheTest.java |  2 +-
 .../PersistentDispatcherFailoverConsumerTest.java   |  5 +++++
 .../pulsar/broker/service/PersistentTopicTest.java  |  5 +++++
 .../apache/pulsar/broker/service/ServerCnxTest.java |  4 ++++
 .../discovery/service/BrokerDiscoveryProvider.java  |  2 ++
 .../discovery/service/web/ZookeeperCacheLoader.java |  4 +++-
 .../proxy/server/BrokerDiscoveryProvider.java       |  2 ++
 .../proxy/server/util/ZookeeperCacheLoader.java     |  4 +++-
 .../apache/pulsar/websocket/WebSocketService.java   |  5 +++--
 .../pulsar/zookeeper/GlobalZooKeeperCache.java      |  5 +++--
 .../pulsar/zookeeper/LocalZooKeeperCache.java       |  4 ++--
 .../zookeeper/ZkBookieRackAffinityMapping.java      |  3 ++-
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java    |  3 ++-
 .../org/apache/pulsar/zookeeper/ZooKeeperCache.java | 21 +++++++++++++--------
 .../apache/pulsar/zookeeper/ZooKeeperDataCache.java |  7 ++++---
 .../zookeeper/ZkBookieRackAffinityMappingTest.java  |  6 +++---
 ...ZkIsolatedBookieEnsemblePlacementPolicyTest.java |  6 +++---
 .../apache/pulsar/zookeeper/ZookeeperCacheTest.java | 16 ++++++++--------
 29 files changed, 110 insertions(+), 61 deletions(-)

commit b50760ca42d97ca16e7fd33329e5f74e0775d926
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Mar 19 11:42:11 2019 -0600

    Implementing authentication for Pulsar Functions (#3735)
    
    * Implementing authentication for Pulsar Functions
    
    * delete unnecessary changes
    
    * cleaning up
    
    * improving implementation
    
    * fixing tests
    
    * cleaning up
    
    * add no op implementation
    
    * cleaning up unnecessary changes
    
    * refactoring based on comments
    
    * adding comments
    
    * change data from string type to bytes
    
    * add proto file
    
    * addressing comments
    
    * up merging
    
    * refactoring get token code
    
    * cleaning up
    
    * fix bugs and add tests
    
    * add tests
    
    * remove service account creation
    
    * cleanup unused imports
    
    * add field for auth provider
    
    * adding comments

 .../AuthenticationProviderToken.java               |   4 +-
 .../pulsar/broker/admin/impl/FunctionsBase.java    |   2 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |   2 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |   2 +-
 .../pulsar/functions/instance/InstanceConfig.java  |   2 +
 .../proto/src/main/proto/Function.proto            |  15 ++
 pulsar-functions/runtime/pom.xml                   |   6 +
 .../auth/ClearTextFunctionTokenAuthProvider.java   |  55 +++++
 .../pulsar/functions/auth/FunctionAuthData.java    |  41 ++++
 .../functions/auth/FunctionAuthProvider.java       |  59 +++++
 .../pulsar/functions/auth/FunctionAuthUtils.java   |  28 +++
 .../auth/KubernetesFunctionAuthProvider.java       |  35 +++
 .../auth/KubernetesSecretsTokenAuthProvider.java   | 248 +++++++++++++++++++++
 .../functions/auth/NoOpFunctionAuthProvider.java   |  43 ++++
 .../functions/runtime/KubernetesRuntime.java       |  83 +++++--
 .../runtime/KubernetesRuntimeFactory.java          |  35 ++-
 .../functions/runtime/ProcessRuntimeFactory.java   |   8 +
 .../apache/pulsar/functions/runtime/Runtime.java   |   4 +
 .../pulsar/functions/runtime/RuntimeFactory.java   |   7 +
 .../ClearTextFunctionTokenAuthProviderTest.java    |  63 ++++++
 .../KubernetesSecretsTokenAuthProviderTest.java    | 107 +++++++++
 .../runtime/KubernetesRuntimeFactoryTest.java      |   2 -
 .../pulsar/functions/worker/FunctionActioner.java  |  60 +++--
 .../functions/worker/rest/FunctionApiResource.java |   5 +
 .../functions/worker/rest/api/ComponentImpl.java   |  40 +++-
 .../functions/worker/rest/api/FunctionsImplV2.java |   2 +-
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |   2 +-
 .../worker/rest/api/v3/SinkApiV3Resource.java      |   4 +-
 .../worker/rest/api/v3/SourceApiV3Resource.java    |   2 +-
 .../worker/FunctionRuntimeManagerTest.java         |  15 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |   8 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |   6 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   6 +-
 33 files changed, 921 insertions(+), 80 deletions(-)

commit 4fe7ab4f4fea4c50dfea70bf323a9db5358012e0
Author: Jia Zhai <zhaijia@apache.org>
Date:   Wed Mar 20 01:41:46 2019 +0800

    update partition doc (#3846)

 site2/docs/admin-api-partitioned-topics.md         |   5 +-
 .../version-2.3.0/admin-api-partitioned-topics.md  | 357 +++++++++++++++++++++
 2 files changed, 358 insertions(+), 4 deletions(-)

commit eefb5a8352a54ce9f0e6f93fba8f05d57f4077eb
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Mar 20 01:37:57 2019 +0800

    [Issue 3806] Fix NPE while call PartitionedProducerImpl.getStats() (#3829)
    
    * Fix NPE while call PartitionedProducerImpl.getStats().
    
    * Add unit tests and fix NPE while call MultiTopicsConsumerImpl.getStats()

 .../client/impl/ConsumerStatsRecorderImpl.java     | 20 +++----
 .../client/impl/ProducerStatsRecorderImpl.java     | 18 +++---
 .../client/impl/MultiTopicsConsumerImplTest.java   | 65 ++++++++++++++++++++++
 .../client/impl/PartitionedProducerImplTest.java   | 37 +++++++++++-
 4 files changed, 120 insertions(+), 20 deletions(-)

commit 9bc0d268608bce7957dbc9a3207c90ccae697c39
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Mar 19 10:37:29 2019 -0700

    [pulsar-client-tools] Add support for websocket produce/consume command (#3835)
    
    * [pulsar-client-tools] Add support for websocket produce/consume command
    
    * remove comments

 pulsar-client-tools/pom.xml                        |   5 +
 .../org/apache/pulsar/client/cli/CmdConsume.java   | 189 ++++++++++++++++++++-
 .../org/apache/pulsar/client/cli/CmdProduce.java   | 188 +++++++++++++++++++-
 .../apache/pulsar/client/cli/PulsarClientTool.java |  10 +-
 4 files changed, 380 insertions(+), 12 deletions(-)

commit f1be6bda03151cca37db6b2f4286928fe3ace31e
Author: se7enkings <se7enkings@users.noreply.github.com>
Date:   Wed Mar 20 01:37:01 2019 +0800

    Fix the loop of consumer poll, so the consumer can cache more than one record in signal poll. (#3852)

 .../java/org/apache/kafka/clients/consumer/PulsarKafkaConsumer.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e29bfd08d012cc1a9d88a6b812f973bdb9374816
Author: Shivji Kumar Jha <shiv4289@gmail.com>
Date:   Tue Mar 19 21:20:13 2019 +0530

    issue#3838 : Allow incompatible schemas to co-exist on a topic, allow set-schema-autoupdate-strategy = none (#3840)
    
    ## Problem:
    
    Fixes #3838 : The set-schema-autoupdate-strategy policy currently allows disabling schema update (--disabled) and one of --compatibility(FULL, BACKWARD, FORWARD). There is no way to currently allow multiple schemas for a topic.
    
    ## Solution:
    It would be useful to allow --compatibility so the schemas can be added without checking with the previous schemas. This allows for extra flexibility for instance having multiple objects on a topic, supports use cases like a simple event bus etc.
    
    ### Modifications
    
    This change added tests and can be verified as follows:
    
      - *Added test cases under SchemaUpdateStrategyTest*

 .../service/schema/AlwaysSchemaValidator.java      | 34 +++++++++++++
 .../schema/AvroSchemaBasedCompatibilityCheck.java  |  2 +
 .../schema/SchemaCompatibilityStrategy.java        |  7 +++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  2 +
 .../SchemaAutoUpdateCompatibilityStrategy.java     |  8 +++-
 site2/docs/reference-pulsar-admin.md               |  2 +-
 .../integration/cli/SchemaUpdateStrategyTest.java  | 55 +++++++++++++++++++++-
 7 files changed, 107 insertions(+), 3 deletions(-)

commit 614a98d01a3d3e3f8cad76b758f6d3364f5c62ce
Author: Le Labourier Marc <marc.lelabourier@gmail.com>
Date:   Tue Mar 19 16:31:08 2019 +0100

    [Issue #3712][python-client] exposing InitialPosition management in the ConsumerConfiguration. (#3714)
    
    ### Motivation
    PR #3567 introduced the SubscriptionInitialPosition option in ConsumerConfiguration in the CPP client but did not exposed any methods to be able to do it with the Python client.
    
    This PR aims to expose the code introduced in the previous PR to allows Python user to choose the initial position of the consumer in python.
    
    ### Modifications
    
    - Implemented a boost object to expose InitialPosition Enum.
    - Added to boost ConsumerConfiguration object the getter/setter of the InitialPosition attribute.
    - Added a initial_position parameter to Client.subscribe in order to modify the ConsumerConfiguration instance created.
    
    ### Verifying this change
    
    This change is a trivial rework / code cleanup without any test coverage.

 pulsar-client-cpp/python/pulsar/__init__.py | 11 ++++++++--
 pulsar-client-cpp/python/pulsar_test.py     | 34 ++++++++++++++++++++++++++++-
 pulsar-client-cpp/python/src/config.cc      |  2 ++
 pulsar-client-cpp/python/src/enums.cc       |  4 ++++
 4 files changed, 48 insertions(+), 3 deletions(-)

commit 1a1c557b27bdc4e48fcd4a2da6f71e0d78873697
Author: congbo <39078850+congbobo184@users.noreply.github.com>
Date:   Tue Mar 19 23:25:34 2019 +0800

    revise the schema default type not null (#3752)
    
    ### Motivation
    Fix #3741
    
    ### Modifications
    Support define not not allow null field in schema
    
    ### Verifying this change
    Add not allow null field schema verify
    
    Does this pull request potentially affect one of the following parts:
    If yes was chosen, please highlight the changes
    
    Dependencies (does it add or upgrade a dependency): (no)
    The public API: (no)
    The schema: (yes)
    The default values of configurations: (no)
    The wire protocol: (no)
    The rest endpoints: (no)
    The admin cli options: (no)
    Anything that affects deployment: (no)

 .../broker/service/schema/ClientGetSchemaTest.java |   8 +
 .../schema/JsonSchemaCompatibilityCheckTest.java   |   5 +-
 .../api/SimpleTypedProducerConsumerTest.java       |  28 ++--
 .../java/org/apache/pulsar/client/api/Schema.java  |  49 +++---
 .../pulsar/client/api/schema/SchemaDefinition.java |  64 ++++++++
 .../client/api/schema/SchemaDefinitionBuilder.java |  81 ++++++++++
 .../client/internal/DefaultImplementation.java     |  37 ++---
 .../pulsar/client/impl/schema/AvroSchema.java      |  34 ++---
 .../pulsar/client/impl/schema/JSONSchema.java      |  36 ++---
 .../impl/schema/SchemaDefinitionBuilderImpl.java   |  95 ++++++++++++
 .../client/impl/schema/SchemaDefinitionImpl.java   |  98 ++++++++++++
 .../pulsar/client/impl/schema/StructSchema.java    |  10 +-
 .../pulsar/client/impl/schema/AvroSchemaTest.java  |  79 ++++++++--
 .../pulsar/client/impl/schema/JSONSchemaTest.java  | 167 +++++++++++++++++++--
 .../client/impl/schema/KeyValueSchemaTest.java     | 164 +++++++++++++++++---
 .../client/impl/schema/SchemaBuilderTest.java      |   7 +
 .../pulsar/client/impl/schema/SchemaTestUtils.java |  40 +++--
 .../impl/schema/generic/GenericSchemaImplTest.java |   4 +-
 .../MultiVersionGenericSchemaProviderTest.java     |   4 +-
 .../tutorial/SampleAsyncProducerWithSchema.java    |   4 +-
 .../client/tutorial/SampleConsumerWithSchema.java  |   4 +-
 .../pulsar/functions/source/TopicSchema.java       |   5 +-
 .../io/hbase/sink/HbaseGenericRecordSinkTest.java  |   3 +-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    |   3 +-
 .../pulsar/sql/presto/TestPulsarConnector.java     |  27 ++--
 .../tests/integration/io/JdbcSinkTester.java       |   3 +-
 26 files changed, 868 insertions(+), 191 deletions(-)

commit 6e0c11e58f20333a24118cd30ad2c7f69a8b423b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Mar 19 08:24:15 2019 -0700

    copy logs from presto server container on teardown in integration tests (#3859)

 .../containers/PrestoWorkerContainer.java          | 14 ++++++++
 .../tests/integration/presto/TestBasicPresto.java  | 39 +++++++++++-----------
 2 files changed, 34 insertions(+), 19 deletions(-)

commit 7064285c31df1a0352d2d4af84801c312b18c1f7
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Mar 19 23:22:16 2019 +0800

    kerberos: authentication between client and broker (#3821)
    
    Fixes #3652
    
    **Motivation**
    Currently both Zookeeper and BookKeeper could be secured by using Kerberos, It would be good to support Kerberos in Pulsar Broker and Client.
    This is the sub-task for issue in #3491 to support Kerberos in Pulsar Broker and Client.
    Will add proxy and web resource support in following prs.
    The Kerberos authentication is similar to that in Zookeeper and BookKeeper, which leverage SASL and GSSAPI, so reused some of the code there.
    PR #3658 is the first version of PR before #3677 .
    
    **Changes**
    provide both client and broker side support for authentication api;
    add unit test.

 conf/broker.conf                                   |  18 +-
 pom.xml                                            |   3 +
 pulsar-broker-auth-sasl/pom.xml                    | 102 +++++
 .../authentication/AuthenticationProviderSasl.java | 113 ++++++
 .../broker/authentication/PulsarSaslServer.java    | 203 ++++++++++
 .../SaslAuthenticationDataSource.java              |  62 +++
 .../authentication/SaslAuthenticationState.java    |  66 ++++
 .../pulsar/broker/authentication/MiniKdc.java      | 347 +++++++++++++++++
 .../authentication/SaslAuthenticateTest.java       | 220 +++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  34 +-
 .../authentication/AuthenticationDataSource.java   |   6 +-
 .../authentication/AuthenticationProvider.java     |   2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  14 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  13 +-
 .../org/apache/pulsar/broker/web/WebService.java   |   5 +-
 .../client/api/AuthenticationDataProvider.java     |   9 +-
 pulsar-client-auth-sasl/pom.xml                    |  45 +++
 .../client/impl/auth/AuthenticationSasl.java       | 138 +++++++
 .../pulsar/client/impl/auth/PulsarSaslClient.java  | 153 ++++++++
 .../impl/auth/SaslAuthenticationDataProvider.java  |  57 +++
 .../common/sasl/JAASCredentialsContainer.java      | 107 +++++
 .../apache/pulsar/common/sasl/KerberosName.java    | 433 +++++++++++++++++++++
 .../apache/pulsar/common/sasl/SaslConstants.java   |  96 +++++
 .../pulsar/common/sasl/TGTRefreshThread.java       | 274 +++++++++++++
 .../apache/pulsar/websocket/WebSocketService.java  |   5 +-
 .../websocket/admin/WebSocketWebResource.java      |   2 +-
 26 files changed, 2506 insertions(+), 21 deletions(-)

commit 8997375ef6a0b6c6286478b495c0ca785ae41710
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 19 23:19:05 2019 +0800

    Issue #3211: Fix NPE when creating schema after deleting a schema (#3836)
    
    Fixes #3211
    Fixes #2786
    
    *Motivation*
    
    When a schema is deleted, the schema is not removed directly.
    You can still fetch the latest schema but its state is marked as `deleted`.
    
    So when we apply schema compatibility check, we should ignore deleted schema.
    
    *Modifications*
    
    Ignore deleted schema when doing schema compatibility check

 .../service/schema/SchemaRegistryServiceImpl.java  |  15 ++-
 .../tests/integration/schema/SchemaTest.java       | 110 +++++++++++++++++++++
 .../pulsar/tests/integration/schema/Schemas.java   |  79 +++++++++++++++
 3 files changed, 200 insertions(+), 4 deletions(-)

commit 05dc8c88aba193d64002ff8cc229c01790fcef72
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Mar 19 07:42:22 2019 -0700

    [pulsar-client] Fix pulsar-cpp crash on lookup timeout (#3862)

 pulsar-client-cpp/lib/ClientConnection.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8fc4f3c1288e709993ff411931794313e885047b
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Mar 19 21:10:15 2019 +0800

    hide kafka-connecter details for easy use debezium connector (#3825)
    
    currently we explored too much internal config for debezium connector, this PR is to hide some details and make the config easier.
    expected pass integration tests.

 distribution/io/src/assemble/io.xml                |   1 +
 pulsar-io/debezium/core/pom.xml                    | 104 +++++++++++++++++++
 .../pulsar/io/debezium/PulsarDatabaseHistory.java  |   0
 .../io/debezium/PulsarDatabaseHistoryTest.java     |   0
 pulsar-io/debezium/mysql/pom.xml                   |  59 +++++++++++
 .../io/debezium/mysql/DebeziumMysqlSource.java     | 110 +++++++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++++
 .../resources/debezium-mysql-source-config.yaml    |  20 +---
 pulsar-io/debezium/pom.xml                         |  75 +-------------
 pulsar-io/kafka-connect-adaptor/pom.xml            |   6 --
 .../io/kafka/connect/KafkaConnectSource.java       |   7 +-
 .../io/kafka/connect/PulsarKafkaWorkerConfig.java  |  14 ++-
 .../containers/DebeziumMySQLContainer.java         |   2 +-
 .../integration/functions/PulsarFunctionsTest.java |   7 +-
 .../integration/io/DebeziumMySqlSourceTester.java  |  28 +++---
 15 files changed, 343 insertions(+), 112 deletions(-)

commit 7b2ccd197443c8654d0d5b83bbeb5c1eda82276c
Author: Jia Zhai <zhaijia@apache.org>
Date:   Tue Mar 19 21:08:59 2019 +0800

    fix s3 spport for s3 api (#3845)

 .../offload/jcloud/impl/BlobStoreManagedLedgerOffloader.java  |  6 +++---
 .../jcloud/impl/BlobStoreManagedLedgerOffloaderTest.java      | 11 +++++++++++
 2 files changed, 14 insertions(+), 3 deletions(-)

commit aace3e59a8ccbd9a9395daa61226ef68249d28d9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 19 21:08:32 2019 +0800

    Fix set-project-version.sh (#3847)
    
    *Motivation*
    
    The script doesn't update the parent version for protobuf-shaded module
    
    *Modifications*
    
    use `versions:update-parent` to update parent version

 src/set-project-version.sh | 3 +++
 1 file changed, 3 insertions(+)

commit be97a4c66312c3a0e6b7d1b115dddffa68ad4ec8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 19 21:08:05 2019 +0800

    [stats] Expose namespace topics count when exposing topic level metrics (#3849)
    
    *Motivation*
    
    Topics count is a namespace level metric. Currently if `exposeTopicLevelMetricsInPrometheus=true`
    we don't expose `pulsar_topics_count`. However `pulsar_topics_count` is a very useful metric for
    monitoring the healthy of the cluster.
    
    *Modifications*
    
    if `exposeTopicLevelMetricsInPrometheus=true`, we expose namespace level metrics that are not
    exposed at topic level. e.g. `pulsar_topics_count`.

 .../broker/stats/prometheus/NamespaceStatsAggregator.java     | 11 +++++++++++
 1 file changed, 11 insertions(+)

commit 77e4619895bbbcd553d4c83b11b9b2e41eabfb04
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 19 19:05:03 2019 +0800

    Use `PULSAR_PREFIX_` for appending new keys (#3858)
    
    *Motivation*
    
    Currently integration tests are broken due to #3827
    
    `PULSAR_` is used almost everywhere in our scripts. If we are using
    `PULSAR_` for appending new keys, then we are potentially appending
    a wrong key into the config file.
    
    Currently this happens on presto. We are appending `PULSAR_ROOT_LOGGER`
    into presto's config file and cause presto fail to load the config.
    
    *Modifications*
    
    Use `PULSAR_PREFIX_` instead of `PULSAR_`

 docker/pulsar/scripts/apply-config-from-env.py                         | 3 +--
 .../org/apache/pulsar/tests/integration/topologies/PulsarCluster.java  | 2 ++
 tests/scripts/pre-integ-tests.sh                                       | 1 +
 3 files changed, 4 insertions(+), 2 deletions(-)

commit da2bb660461345f11446635298c2fdd35955ac32
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 15 22:07:11 2019 -0700

    Expand add env functionality to add variables if not present (#3827)
    
    * Add config variables if absent
    
    * Took feedback into account

 docker/pulsar/scripts/apply-config-from-env.py | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit ce13251caf8649f74e3f5196784eec24c062046c
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 15 18:28:47 2019 -0700

    Use correct number of messages in batch for publish rate stats during replication (#3834)

 .../main/java/org/apache/pulsar/client/impl/ProducerImpl.java  | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit fdaa9e3728e463bc67f5e946833d1dac392412e2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 15 15:05:53 2019 -0700

    Fix topic name logic for partitioned topics (#3693)
    
    * Since partitioned topics have a -partition-<partitionid> affixed to the topic name,
    when doing explicit acking, check for the case to determine the right topic name
    
    * added unittests

 .../instance/src/main/python/contextimpl.py        | 21 +++++++++++++++------
 .../src/scripts/run_python_instance_tests.sh       |  3 ++-
 .../src/test/python/test_python_instance.py        | 22 +++++++++++++++++++++-
 3 files changed, 38 insertions(+), 8 deletions(-)

commit fff02e2aa2064412dbae18b973eb2bb2abab25d8
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Fri Mar 15 03:58:10 2019 -0300

    [cpp client] Bugfix prevent dup consumer for same topic subscription (#3748)
    
    Same fix as #3746 but for cpp client.
    
      - Filter consumers for the same topic name.
      - Add test to verify that same subscription names with different topics are
        allowed to be different consumers subscription instead of reused.

 pulsar-client-cpp/lib/ClientImpl.cc          |  3 ++-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 32 +++++++++++++++++++++++++++-
 2 files changed, 33 insertions(+), 2 deletions(-)

commit 03830f9e4ba8e5ff04b0617fed70e2b55ba6a6f7
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Mar 15 14:57:49 2019 +0800

    version not match in protobuf-shaded/pom.xml (#3824)
    
    change
    `<version>2.3.0-SNAPSHOT</version>`
    into
    `<version>2.4.0-SNAPSHOT</version>`

 protobuf-shaded/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d47ade850927c41d8612105cf8e900d17b116658
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 14 13:19:54 2019 -0700

    Negative acks implementation for Python client (#3816)
    
    * Negative acks implementation for Python client
    
    * Fixed doc formatting

 pulsar-client-cpp/python/pulsar/__init__.py | 37 ++++++++++++++++++++++++++---
 pulsar-client-cpp/python/pulsar_test.py     | 30 +++++++++++++++++++++++
 pulsar-client-cpp/python/src/config.cc      |  2 ++
 pulsar-client-cpp/python/src/consumer.cc    | 10 ++++++++
 4 files changed, 76 insertions(+), 3 deletions(-)

commit b69bac9277851497cecb035dbea0b40f68136b89
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 14 11:25:46 2019 -0700

    Maintain the cursor properties on cursor.delete() (#3815)
    
    * Maintain the cursor properties on cursor.delete()
    
    * Fixed non durable test

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 10 ++++---
 .../mledger/impl/ManagedCursorPropertiesTest.java  | 34 ++++++++++++++++++++++
 2 files changed, 40 insertions(+), 4 deletions(-)

commit 9bd4f492673c989f4903236d08d139cb4227a26f
Author: Tevic <tevic.tt@gmail.com>
Date:   Fri Mar 15 01:57:39 2019 +0800

    fix message_id_serialize to empty slice (#3801)
    
    * fix message_id_serialize to empty slice
    
    * test for serialize and deserialize

 pulsar-client-cpp/lib/c/c_MessageId.cc   |  1 +
 pulsar-client-go/pulsar/consumer_test.go | 11 +++++++++--
 2 files changed, 10 insertions(+), 2 deletions(-)

commit 85e577dbce23d53e7c8473724a5f63303976f8f4
Author: Kai <klevy@toasttab.com>
Date:   Thu Mar 14 13:30:12 2019 -0400

    Implement configurable token auth claim (#3826)

 conf/broker.conf                                   |  3 ++
 conf/proxy.conf                                    |  2 +
 conf/standalone.conf                               |  3 ++
 .../AuthenticationProviderToken.java               | 16 ++++++-
 .../AuthenticationProviderTokenTest.java           | 51 ++++++++++++++++++++++
 site2/docs/reference-configuration.md              |  2 +
 6 files changed, 76 insertions(+), 1 deletion(-)

commit c83631bf3dc330e3561c8da2764d249d3a63711c
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 14 10:05:05 2019 -0700

    Negative acks implementation for Go client (#3817)

 pulsar-client-go/pulsar/c_consumer.go    | 15 +++++++
 pulsar-client-go/pulsar/consumer.go      | 22 +++++++++++
 pulsar-client-go/pulsar/consumer_test.go | 67 ++++++++++++++++++++++++++++++++
 3 files changed, 104 insertions(+)

commit 4b3fed9bd43f0df18bacf947bc9c073841dec2c5
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 14 10:04:08 2019 -0700

    In Java allow messages that compress to <5mb to be sent with batching enabled (#3718)
    
    * In Java allow messages that compress to <5mb to be sent with batching enabled
    
    * Test is not anymore accurate since behavior changed and we're already testing in ProducerConsumerTest

 .../client/api/SimpleProducerConsumerTest.java     | 27 +++++---
 .../client/api/v1/V1_ProducerConsumerTest.java     | 75 ----------------------
 .../pulsar/client/impl/BatchMessageContainer.java  |  2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    | 40 +++++++-----
 4 files changed, 45 insertions(+), 99 deletions(-)

commit da68b23cbaf1f618549fb01a3aae17e687eacbd2
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Mar 14 15:52:49 2019 +0800

    Support passing schema definition for JSON and AVRO schemas (#3766)
    
    * Support passing schema definition for JSON and AVRO schemas
    
    *Motivation*
    
    Currently AVRO and Schema generated schemas from POJO directly.
    Sometime people would like to use pre-generated/defined schemas,
    so allow passing in schema definitions would clear the confusions
    on parsing schemas from POJO.
    
    *Modifications*
    
    - Abstract a common base class `StructSchema` for AVRO/PROTOBUF/JSON
    - Standarize on using avro schema for defining schema (we already did that. this change only makes it clearer)
    - Add methods to pass schema definition for JSON and AVRO schemas
    
    *NOTES*
    
    We don't support passing schema definition for PROTOBUF. since we only supported generated messages as POJO
    class for protobuf schema, and we generate schema definition from the generated messages. it doesn't make sense
    to pass in a different schema definition.
    
    * Add missing license header

 .../java/org/apache/pulsar/client/api/Schema.java  | 37 +++++++++++
 .../client/internal/DefaultImplementation.java     | 14 ++++
 .../pulsar/client/impl/schema/AvroSchema.java      | 43 ++++++-------
 .../pulsar/client/impl/schema/JSONSchema.java      | 51 ++++++++-------
 .../pulsar/client/impl/schema/ProtobufSchema.java  | 31 ++++-----
 .../pulsar/client/impl/schema/StructSchema.java    | 74 ++++++++++++++++++++++
 .../pulsar/client/impl/schema/AvroSchemaTest.java  | 74 ++++++++++++++++++++++
 7 files changed, 263 insertions(+), 61 deletions(-)

commit 2d44850ae8721f92432a6cb36ce6f2e482303045
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 13 16:50:53 2019 -0700

    Negative acks in C++ client (#3750)
    
    * Negative acks in C++ client
    
    * Fixed formatting
    
    * Fixed api docs

 pulsar-client-cpp/include/pulsar/Consumer.h        |  64 +++++++++++++
 .../include/pulsar/ConsumerConfiguration.h         |  21 ++++
 pulsar-client-cpp/include/pulsar/MessageId.h       |   2 +-
 pulsar-client-cpp/include/pulsar/c/consumer.h      |  28 ++++++
 .../include/pulsar/c/consumer_configuration.h      |  24 +++++
 pulsar-client-cpp/lib/Commands.cc                  |   8 +-
 pulsar-client-cpp/lib/Commands.h                   |   5 +-
 pulsar-client-cpp/lib/Consumer.cc                  |   9 ++
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |   8 ++
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |   4 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  16 +++-
 pulsar-client-cpp/lib/ConsumerImpl.h               |   7 ++
 pulsar-client-cpp/lib/ConsumerImplBase.h           |   3 +
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   |   9 ++
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h    |   2 +
 pulsar-client-cpp/lib/NegativeAcksTracker.cc       |  98 +++++++++++++++++++
 pulsar-client-cpp/lib/NegativeAcksTracker.h        |  62 ++++++++++++
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |   6 ++
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |   2 +
 pulsar-client-cpp/lib/c/c_Consumer.cc              |   8 ++
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc |   9 ++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 106 +++++++++++++++++----
 22 files changed, 475 insertions(+), 26 deletions(-)

commit 0158439987fbb4d5d83307a61294e329892f9543
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Wed Mar 13 16:26:46 2019 -0300

    Fix some minor typos (#3814)
    
    Just fix some minor typos I've encountered so far.

 .../pulsar/client/api/SimpleProducerConsumerTest.java    |  4 ++--
 .../apache/pulsar/client/impl/NegativeAcksTracker.java   |  2 +-
 .../impl/PersistentAcknowledgmentsGroupingTracker.java   | 16 ++++++++--------
 .../java/org/apache/pulsar/client/impl/ProducerImpl.java |  4 ++--
 4 files changed, 13 insertions(+), 13 deletions(-)

commit d77efcb668418a1c991c893334a6f188127cb0a8
Author: Kev Jackson <foamdino@gmail.com>
Date:   Wed Mar 13 16:10:33 2019 +0000

    update mvn plugins (#3812)

 pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 09e3ed8aa15579d2fb265ce039b8f8bdb5b9f59f
Author: Jia Zhai <zhaijia@apache.org>
Date:   Wed Mar 13 10:14:17 2019 +0800

    PIP-30: interface for mutual authentication (#3677)
    
    This is to implement the mutual auth api discussed in "PIP-30: change authentication provider API to support mutual authentication"
    Mainly provide 2 new command CommandAuthResponse and  CommandAuthChallenge in proto, to support it.

 .../authentication/AuthenticationDataSource.java   |   28 +-
 .../authentication/AuthenticationProvider.java     |   23 +-
 .../authentication/AuthenticationService.java      |   13 +
 .../broker/authentication/AuthenticationState.java |   53 +
 .../OneStageAuthenticationState.java               |   68 +
 .../apache/pulsar/broker/service/ServerCnx.java    |  160 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   27 +-
 .../client/api/MutualAuthenticationTest.java       |  240 +++
 .../apache/pulsar/client/api/Authentication.java   |   20 +-
 .../client/api/AuthenticationDataProvider.java     |   32 +-
 .../org/apache/pulsar/common/api/AuthData.java     |   34 +
 pulsar-client-cpp/lib/Commands.cc                  |    6 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   61 +-
 .../org/apache/pulsar/common/api/Commands.java     |   82 +
 .../apache/pulsar/common/api/PulsarDecoder.java    |   22 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 1590 ++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   26 +
 17 files changed, 2411 insertions(+), 74 deletions(-)

commit 0ce297c5ffd6430b047728a779a0896d6b5fb7d9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Mar 13 07:17:32 2019 +0800

    Issue #3803: Make ManagedLedger read batch size configurable (#3808)
    
    *Motivation*
    
    Fixes #3803
    
    Hardcoding is a very bad practice. It means we have no way to alter system behavior
    when production issues occur.
    
    *Modifications*
    
    introduce a few read batch related settings to make them configurable

 conf/broker.conf                                   | 11 ++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java | 25 ++++++++++++++++++++++
 .../PersistentDispatcherMultipleConsumers.java     | 15 ++++++-------
 .../PersistentDispatcherSingleActiveConsumer.java  |  9 ++++----
 .../service/persistent/PersistentReplicator.java   | 13 +++++------
 5 files changed, 54 insertions(+), 19 deletions(-)

commit c5e3baafdadd26790358a80d5cf375726a186409
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Mar 12 19:17:58 2019 +0800

    [pulsar-io] Add a Pulsar IO connector for Redis sink (#3700)
    
    ### Motivation
    
    This PR provides a built-in Redis sink Connector, in order to cache messages in Redis [key-value] pairs. This will effectively make Redis a caching system, which other applications can access to get the latest value.
    
    ### Modifications
    
    Add a new sub-module in the `pulsar-io` module.
    
    ### Verifying this change
    
    This change can be verified as follows:
    
    * deploy the redis sink connector with configuration file containing the following fields:
    
    ```
    configs:
        redisHosts: "localhost:6379"
        redisPassword: "redis@123"
        redisDatabase: "1"
        clientMode: "Standalone"
        operationTimeout: "3000"
        batchSize: "100"
    ```
    * start a redis instance with auth
    * send messages with `NotNull` key/value in the topic declared when deploying the connector
    * check in Redis if the message's key-value pairs have been stored in above database
    
    ### Documentation
    ```
    # Submit a Redis Sink
    $ bin/pulsar-admin sink create --tenant public --namespace default --name redis-test-sink --sink-type redis --sink-config-file examples/redis-sink.yaml --inputs test_redis
    
    # List Sink
    $ bin/pulsar-admin sink list --tenant public --namespace default
    
    # Get Sink Info
    $ bin/pulsar-admin sink get --tenant public --namespace default --name redis-test-sink
    
    # Get Sink Status
    $ bin/pulsar-admin sink status --tenant public --namespace default --name redis-test-sink
    
    # Delete the Redis Sink
    $ bin/pulsar-admin sink delete --tenant public --namespace default --name redis-test-sink
    ```

 pulsar-io/pom.xml                                  |   1 +
 pulsar-io/redis/pom.xml                            | 100 ++++++++++++
 .../pulsar/io/redis/RedisAbstractConfig.java       | 124 +++++++++++++++
 .../org/apache/pulsar/io/redis/RedisSession.java   | 140 +++++++++++++++++
 .../org/apache/pulsar/io/redis/sink/RedisSink.java | 173 +++++++++++++++++++++
 .../pulsar/io/redis/sink/RedisSinkConfig.java      |  84 ++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  21 +++
 .../apache/pulsar/io/redis/EmbeddedRedisUtils.java |  63 ++++++++
 .../pulsar/io/redis/sink/RedisSinkConfigTest.java  | 149 ++++++++++++++++++
 .../apache/pulsar/io/redis/sink/RedisSinkTest.java | 118 ++++++++++++++
 pulsar-io/redis/src/test/resources/sinkConfig.yaml |  29 ++++
 11 files changed, 1002 insertions(+)

commit ff4db8db12be2eb79d910e2b286306298f71320e
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Tue Mar 12 01:43:36 2019 -0300

    Feature - implement reference count for ConsumerImpl (#3795)
    
    * Feature - implement reference count for ConsumerImpl
    
    Add reference count for ConsumerImpl in order to track reused instances of a
    consumer instance returned by `subscribe()` method call.
    Having the reference of subscribed consumer instances offers the ability to not
    close a consumer until the last corresponding `close()` is being called.
    
    Modifications:
    
      - Add field on ConsumerBase to track references of consumer instances
        subscribed by the user.
      - Add checks on ConsumerImpl to know whether close() action should be
        performed regarding of reference count being zero value.
      - Increment reference count when a previous built consumer instance is being
        used by caller.
    
    Future considerations:
    
    When optimization #3312 is going to be made for other consumers implementation
    aside from ConsumerImpl it should add refCount checks on close() method call.
    
    * Add tests for reference count on ConsumerImpl
    
      - Add test to verify ConsumerImpl reference count on close() method.
      - Fix test from dup consumers feature with refcount.

 .../client/api/SimpleProducerConsumerTest.java     | 27 ++++++++++++++++++++--
 .../apache/pulsar/client/impl/ConsumerBase.java    | 10 +++++++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  4 ++++
 .../pulsar/client/impl/PulsarClientImpl.java       |  1 +
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |  5 ++++
 5 files changed, 44 insertions(+), 3 deletions(-)

commit 117321d7df0d508daa795cccd1adeda7e350ff9d
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Mon Mar 11 03:16:58 2019 -0700

    Support Kafka's ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG. (#3797)
    
    **Motivation**
    
    Support Kafka's ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG  #1090
    
    Previously `ProducerBuilder.sendTimeout` was set by parsing Kafka's `ProducerConfig.MAX_BLOCK_MS_CONFIG`.
    According to Kafka's [document](https://kafka.apache.org/20/documentation.html) it's for
    
    > Controlling how long KafkaProducer.send() and KafkaProducer.partitionsFor() will block either because the buffer is full or metadata unavailable.
    
    But `ProducerBuilder.sendTimeout`  is for
    
    > If a message is not acknowledged by the server before the sendTimeout expires, an error will be reported.
    
    And Kafka's `ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG`, according to the document is for:
    > Controlling the maximum amount of time the client will wait for the response of a request.
    
    Which I think would be better fit purpose of Pulsar's `ProducerBuilder.sendTimeout`.

 .../apache/kafka/clients/producer/PulsarKafkaProducer.java   |  4 ++--
 .../kafka/clients/producer/PulsarKafkaProducerTest.java      | 12 +++++++++++-
 site2/docs/adaptors-kafka.md                                 |  2 +-
 3 files changed, 14 insertions(+), 4 deletions(-)

commit e283940d00f25784b248a9d04b2baea4983b03b5
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Mon Mar 11 01:26:25 2019 -0700

    Fixed admin-api-non-persistent-topics documentation (#3781)
    
    Fixes #3780
    
    
    ### Motivation
    
    Update the documentation to more accurately reflect the condition of the queue when the availablePermits value is negative. The current documentation indicates that condition means the consumer is ready to receive more messages, when, in fact, it is NOT.
    
    ### Modifications
    
    Updated the http://pulsar.apache.org/docs/en/admin-api-non-persistent-topics.html#get-stats page

 site2/docs/admin-api-non-persistent-topics.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7d97043d76174ecedf4060afbc49bf2ec4fc2ebd
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 11 13:10:23 2019 +0800

    Add `SkipCopyPythonClients` for building pulsar docker image (#3798)
    
    *Motivation*
    
    Currently we use `skipBuildPythonClients` for controlling both building
    python clients and copying python clients. So we have to disable or enable
    all together.
    
    This introduces a problem for building pulsar docker image
    in a kubernetes environment (either docker-in-docker or docker-out-of-docker).
    
    An alternative approach for building pulsar docker image in a k8s environment
    will be:
    
    - build python client for py27 using `apachepulsar/pulsar-build:manylinux-cp27-cp27mu`
      in a container
    - build python client for py35 using `apachepulsar/pulsar-build:manylinux-cp35-cp35m`
      in a container
    - build pulsar docker image
    
    This requires we separating building python clients from copying python clients.
    
    *Modifications*
    
    - introduce a new property `skipCopyPythonClients` to skip copying python clients
    - `skipBuildPythonClients` is only used for skipping building python clients
    
    So the above build process can be done by specifying `-DskipCopyPythonClients`

 docker/pulsar/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a48f1d1cead4dc9c2683aee2f7536f809b610b94
Author: lsy180829 <42792704+lsy180829@users.noreply.github.com>
Date:   Mon Mar 11 13:09:32 2019 +0800

    Pulsar standalone does not read zk port form conf/standalone.conf (#3790)
    
    ### Motivation
    Fixes #3788
    
    ### Modifications
    Add codes make it read zk port from standalone.conf. And it follow the Priority: args > conf > default

 .../org/apache/pulsar/PulsarStandaloneStarter.java  | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

commit 5fe446eb28256df3d68f99c6e4c804c5bf76cac4
Author: Like <like_0903@163.com>
Date:   Mon Mar 11 09:23:25 2019 +0800

    Fix codebase url (#3794)
    
    Closes #3755

 site2/docs/getting-started-standalone.md                                | 2 +-
 .../website/versioned_docs/version-2.3.0/getting-started-standalone.md  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit b46e3e3789eaa008b79af56521fe55f93763f46f
Author: Like <like_0903@163.com>
Date:   Mon Mar 11 09:20:03 2019 +0800

    Fix broken reference (#3796)
    
    Fix broken @inject link and ```reader-interface``` reference in http://pulsar.apache.org/docs/en/client-libraries-java/

 site2/docs/client-libraries-java.md | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 0b419df242750808dccfdfd9e34a3aef15194875
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Mar 9 07:24:41 2019 -0800

    [pulsar-webscoket] avoid creating temp list of metrics on every-metrics generator (#3792)
    
    * [pulsar-webscoket] avoid creating temp list of metrics on every-metrics generator
    
    * fix non-sync getMetrics

 .../main/java/org/apache/pulsar/websocket/stats/ProxyStats.java   | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 41b286dc0cc7b6ca3aa24acfccd53dfed547c0c5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Mar 9 11:53:56 2019 +0800

    [python client] set protobuf version to be larger than 3.6.0 (#3737)
    
    *Motivation*
    
    Fixes #3686

 pulsar-client-cpp/python/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4f03548c5ec468ecb7f63a64990bf17639c33c70
Author: wpl <1269223860@qq.com>
Date:   Sat Mar 9 09:46:43 2019 +0800

    [pulsar-functions] fix words error and remove not use import java class (#3791)
    
    ### Motivation
       when I study and read this module code , I fix some error like:
    1. words error, such as JaveInstance -> JavaInstance, Recieved -> Received,  Unknwon -> Unknown, alterted -> alterted, Updare -> Update, etc.
    2. remove not use import java class.
    3. duplicated code in this  java class I extract method.
    4. javadoc  styles are consistent (not required)
    
    ### Modifications
    
    minor fix up in pulsar-functions module

 .../org/apache/pulsar/functions/api/Context.java   | 52 +++++++++++++-------
 .../org/apache/pulsar/functions/api/Function.java  |  1 +
 .../org/apache/pulsar/functions/api/Record.java    | 12 ++---
 .../apache/pulsar/functions/api/WindowContext.java | 49 ++++++++++++-------
 .../pulsar/functions/api/WindowFunction.java       |  1 +
 .../pulsar/functions/api/utils/JavaSerDeTest.java  |  1 -
 .../pulsar/functions/instance/ContextImpl.java     |  3 +-
 .../functions/instance/FunctionResultRouter.java   |  2 +-
 .../pulsar/functions/instance/InstanceConfig.java  |  2 +-
 .../pulsar/functions/instance/JavaInstance.java    |  1 -
 .../functions/instance/JavaInstanceRunnable.java   |  3 +-
 .../pulsar/functions/instance/LogAppender.java     |  1 -
 .../instance/stats/ComponentStatsManager.java      |  1 -
 .../instance/stats/FunctionStatsManager.java       | 15 +++---
 .../functions/instance/stats/SinkStatsManager.java | 15 +++---
 .../instance/stats/SourceStatsManager.java         | 15 +++---
 .../pulsar/functions/source/PulsarSource.java      |  3 --
 .../pulsar/functions/source/TopicSchema.java       |  2 +-
 .../pulsar/functions/sink/PulsarSinkTest.java      | 57 +++++++++-------------
 .../pulsar/functions/source/PulsarSourceTest.java  | 20 +-------
 .../functions/api/examples/ByteBufferSerDe.java    |  2 +-
 .../api/examples/CommaWindowFunction.java          |  2 +-
 .../api/examples/ConfigBasedAppendFunction.java    |  2 +-
 .../functions/api/examples/CustomBaseSerde.java    |  2 +-
 .../api/examples/CustomBaseToBaseFunction.java     |  2 +-
 .../api/examples/CustomBaseToDerivedFunction.java  |  2 +-
 .../functions/api/examples/CustomDerivedSerde.java |  2 +-
 .../examples/CustomDerivedToDerivedFunction.java   |  2 +-
 .../api/examples/CustomObjectFunction.java         |  2 +-
 .../api/examples/ExclamationFunction.java          |  2 +-
 .../api/examples/HostAppenderFunction.java         |  2 +-
 .../api/examples/InstanceIdAppenderFunction.java   |  2 +-
 .../api/examples/IntegerAdditionFunction.java      |  2 +-
 .../functions/api/examples/LoggingFunction.java    |  2 +-
 .../functions/api/examples/PublishFunction.java    |  2 +-
 .../functions/api/examples/UserConfigFunction.java |  2 +-
 .../api/examples/UserPublishFunction.java          |  2 +-
 .../api/examples/WindowDurationFunction.java       |  2 +-
 .../pulsar/functions/api/examples/pojo/Tick.java   |  2 +-
 .../functions/api/examples/serde/CustomObject.java |  2 +-
 .../api/examples/serde/CustomObjectSerde.java      |  2 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  4 +-
 .../functions/runtime/KubernetesRuntime.java       |  6 +--
 .../pulsar/functions/runtime/LocalRunner.java      |  1 -
 .../pulsar/functions/runtime/ProcessRuntime.java   |  2 +-
 .../functions/runtime/ProcessRuntimeFactory.java   |  2 +-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  6 +--
 .../pulsar/functions/runtime/RuntimeUtils.java     |  4 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |  2 +-
 .../secretsprovider/ClearTextSecretsProvider.java  |  5 +-
 .../EnvironmentBasedSecretsProvider.java           |  3 +-
 .../functions/secretsprovider/SecretsProvider.java |  8 +--
 .../DefaultSecretsProviderConfigurator.java        |  2 +-
 .../KubernetesSecretsProviderConfigurator.java     |  2 +-
 .../SecretsProviderConfigurator.java               | 16 +++---
 .../EnvironmentBasedSecretsProviderTest.java       |  5 --
 .../functions/utils/FunctionConfigUtils.java       |  2 +-
 .../apache/pulsar/functions/utils/Reflections.java | 14 ++++--
 .../pulsar/functions/utils/SinkConfigUtils.java    |  3 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  2 +-
 .../org/apache/pulsar/functions/utils/Utils.java   |  3 +-
 .../functions/utils/FunctionConfigUtilsTest.java   |  2 +-
 .../pulsar/functions/utils/ReflectionsTest.java    |  2 +-
 .../functions/utils/SinkConfigUtilsTest.java       |  2 +-
 .../functions/utils/SourceConfigUtilsTest.java     |  2 +-
 .../apache/pulsar/functions/windowing/Event.java   |  4 +-
 .../functions/windowing/EvictionContext.java       |  6 +--
 .../pulsar/functions/windowing/EvictionPolicy.java |  9 ++--
 .../windowing/WaterMarkEventGenerator.java         |  3 +-
 .../pulsar/functions/windowing/WindowManager.java  |  5 +-
 .../windowing/evictors/TimeEvictionPolicy.java     |  2 +-
 .../functions/worker/FunctionAssignmentTailer.java |  1 -
 .../functions/worker/FunctionRuntimeManager.java   |  2 +-
 .../org/apache/pulsar/functions/worker/Worker.java |  2 -
 .../pulsar/functions/worker/WorkerConfig.java      |  4 +-
 .../pulsar/functions/worker/WorkerService.java     |  3 +-
 .../functions/worker/dlog/DLInputStream.java       |  5 +-
 .../functions/worker/rest/FunctionApiResource.java |  1 -
 .../pulsar/functions/worker/rest/WorkerServer.java |  1 -
 .../functions/worker/rest/api/ComponentImpl.java   |  2 -
 .../functions/worker/rest/api/FunctionsImpl.java   | 28 +++++------
 .../pulsar/functions/worker/rest/api/SinkImpl.java | 28 +++++------
 .../worker/rest/api/v3/SourceApiV3Resource.java    |  1 -
 .../worker/scheduler/RoundRobinScheduler.java      |  6 +--
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  1 -
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  1 -
 86 files changed, 253 insertions(+), 260 deletions(-)

commit 18e3ab18372078600d57130194da46091c26de9c
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Fri Mar 8 17:34:25 2019 -0800

    Add support for Kafka's ProducerConfig.CONNECTIONS_MAX_IDLE_MS_CONFIG (#1090) (#3753)
    
    Add support for Kafka's ProducerConfig.CONNECTIONS_MAX_IDLE_MS_CONFIG in PulsarKafkaProducer by utilizing pulsar's ClientBuilder.keepAliveInterval

 .../clients/producer/PulsarKafkaProducer.java      |  21 ++++-
 .../clients/producer/PulsarKafkaProducerTest.java  | 103 +++++++++++++++++++++
 site2/docs/adaptors-kafka.md                       |   2 +-
 3 files changed, 121 insertions(+), 5 deletions(-)

commit 85afd6e49912996e594047193811826031134f9a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Mar 9 00:33:39 2019 +0800

    NullPointerException at using BytesSchema.of() (#3754)
    
    Fixes #3734
    
    *Motivation*
    
    Exception occurred when using `BytesSchema.of()`
    
    ```
    Exception in thread "main" java.lang.ExceptionInInitializerError
            at org.apache.pulsar.examples.simple.ProducerExample.main(ProducerExample.java:32)
    Caused by: java.lang.RuntimeException: java.lang.reflect.InvocationTargetException
            at org.apache.pulsar.client.internal.ReflectionUtils.catchExceptions(ReflectionUtils.java:36)
            at org.apache.pulsar.client.internal.DefaultImplementation.newKeyValueSchema(DefaultImplementation.java:158)
            at org.apache.pulsar.client.api.Schema.<clinit>(Schema.java:123)
            ... 1 more
    Caused by: java.lang.reflect.InvocationTargetException
            at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
            at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
            at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
            at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
            at org.apache.pulsar.client.internal.DefaultImplementation.lambda$newKeyValueSchema$16(DefaultImplementation.java:160)
            at org.apache.pulsar.client.internal.ReflectionUtils.catchExceptions(ReflectionUtils.java:34)
            ... 3 more
    Caused by: java.lang.NullPointerException
            at org.apache.pulsar.client.impl.schema.KeyValueSchema.<init>(KeyValueSchema.java:68)
            ... 9 more
    ```
    
    The problem introduced because the weird class loading and reflection sequence.
    
    When accessing `BytesSchema`, `BytesSchema` will try to initialize `Schema`. When initializing Schema, it will attempts
    to initialize `KV_BYTES` using reflection, and initializing KV_BYTES requires `BytesSchema`. Hence it causes KV_BYTES not being
    initialized correctly.
    
    The change is to avoid this recursive class loading.

 .../java/org/apache/pulsar/client/api/Schema.java  |  4 +-
 .../client/internal/DefaultImplementation.java     | 10 ++++-
 .../pulsar/client/impl/schema/KeyValueSchema.java  | 16 ++++++-
 .../pulsar/client/impl/schema/BytesSchemaTest.java | 52 ++++++++++++++++++++++
 .../client/impl/schema/KeyValueSchemaTest.java     |  4 +-
 .../pulsar/functions/source/TopicSchema.java       |  2 +-
 6 files changed, 80 insertions(+), 8 deletions(-)

commit adc4c1da340fe1ac285b1c91a211f48b90b7031e
Author: wpl <1269223860@qq.com>
Date:   Fri Mar 8 19:08:22 2019 +0800

    fix elasticsearch in pom Consistent with other IOs (#3696)
    
    ### Motivation
    
    fix elasticsearch in pom Consistent with other IOs
    
    ### Modifications
    
    pom.xml add elasticsearch.version propertie

 pom.xml                          | 6 ++++++
 pulsar-io/elastic-search/pom.xml | 2 --
 tests/integration/pom.xml        | 1 -
 3 files changed, 6 insertions(+), 3 deletions(-)

commit 4ce8b32f8425c7af559acf766038048655199444
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Mar 8 03:06:56 2019 -0800

    [pulsar-broker] Optimize redelivery message reading (#3732)
    
    ### Motivation
    It address #3731.
    
    ### Modification
    - Introduce `ConcurrentSortedLongPairSet` that helps broker to avoid random read across multiple managed-ledgers. It still uses `ConcurrentLongPairSet` to avoid object allocation for message-ids.
    - introduce `<T> Set<T> items(int numberOfItems, BiFunction<Long, Long, T> longPairConverter)` method  in `LongPairSet` to avoid creating temporary [LongPair](https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentDispatcherMultipleConsumers.java#L291) objects.
    - this change will not impact to normal usecase where topic doesn't have backlog and doesn't have many active managed-ledgers.
    
    ### Note
    I have done performance testing on `GrowablePriorityLongPairQueue` which I had introduced sometime back but its insert/remove is super slow and CPU intensive so, we can't use it in this scenario.

 .../PersistentDispatcherMultipleConsumers.java     |  16 +-
 .../pulsar/client/api/ConsumerRedeliveryTest.java  | 125 +++++++++++
 .../util/collections/ConcurrentLongPairSet.java    |  21 +-
 .../collections/ConcurrentSortedLongPairSet.java   | 206 +++++++++++++++++
 .../common/util/collections/LongPairSet.java       | 144 ++++++++++++
 .../ConcurrentSortedLongPairSetTest.java           | 244 +++++++++++++++++++++
 .../GrowablePriorityLongPairQueueTest.java         |   4 +-
 7 files changed, 743 insertions(+), 17 deletions(-)

commit d89c8d605991cae56bb057e3347c63bb65ad027b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 8 03:06:00 2019 -0800

    Make Python consumers acks async (#3782)
    
    ### Motivation
    
    Fixes #3779
    
    The behavior of acknowledgment has always been to throw exception if consumer is not connected.
    
    In reality it doesn't make much sense to bubble back exception to user in this case because:
     * There's no ack on the ack anyway
     * The only reason for ack to fail is if consumer is disconnected
     * If consumer is disconnected, messages are going to be replayed in any case
     * Therefore, there's no action to do when acking while disconnected
    
    This is already the case in the Java and Go clients (additionally Java client performs client side grouping of acks based on time).
    
    Changing the Python client behavior to be the same.

 pulsar-client-cpp/python/src/consumer.cc | 28 ++++------------------------
 1 file changed, 4 insertions(+), 24 deletions(-)

commit a337e0482e4f20a3b2b0ff21cf614741ce295777
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 8 03:05:35 2019 -0800

    Set the dedup cursor as "inactive" after recovery (#3612)

 .../apache/bookkeeper/mledger/ManagedCursor.java   |  6 ++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 12 +++++++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 12 ++++++------
 .../mledger/impl/ManagedCursorContainerTest.java   |  4 ++++
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 15 +++++++++++++++
 .../broker/admin/impl/PersistentTopicsBase.java    |  6 ++++--
 .../service/persistent/CompactorSubscription.java  |  3 +++
 .../service/persistent/MessageDeduplication.java   | 22 +---------------------
 8 files changed, 50 insertions(+), 30 deletions(-)

commit c5f4a69a22614fde98ea457aa17475af2b392cb1
Author: Andrey <Cjkjvfnby@gmail.com>
Date:   Fri Mar 8 13:21:55 2019 +0300

    Update concepts-messaging.md (#3789)
    
    ### Motivation
    
    Documentation is inconsistency after the third compression was added.
    
    ### Modifications
    
    Update documentation text.
    
    ### Verifying this change
    
    This change is a trivial rework / code cleanup without any test coverage.

 site2/docs/concepts-messaging.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ded732ca2ee2fd8285f79e97992cdde64948c88a
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 8 01:57:38 2019 -0800

    Fixed increasing consumer permits after ack dedup operation (#3787)

 .../client/impl/ConsumerDedupPermitsUpdate.java    | 124 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |   7 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  27 +++--
 3 files changed, 139 insertions(+), 19 deletions(-)

commit 32a244d951dc57d3b3ea65865ec0bbc7bd1bbba2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Mar 7 21:42:50 2019 -0800

    Handle replication-cluster list change for peer-cluster when zk-watch not received (#3426)
    
    fix test

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  26 +++--
 .../pulsar/broker/namespace/NamespaceService.java  |  22 ++++
 .../pulsar/broker/service/BrokerService.java       |  42 ++++++++
 .../pulsar/broker/service/PeerReplicatorTest.java  | 112 ++++++++++++++++++---
 4 files changed, 180 insertions(+), 22 deletions(-)

commit 8ea53f27dc2f9b6efb5519d0708e249b68685944
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 7 20:41:15 2019 -0800

    Report direct memory used in Proxy to prometheus (#3721)

 .../pulsar/proxy/server/ProxyServiceStarter.java    | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)

commit 44c8fd552e1b005d8d531a2f9fb7200682794c46
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 7 20:38:31 2019 -0800

    Fixes for Go client unit test (#3759)
    
    * Fixes for Go client unit test
    
    * Update pulsar-client-go/pulsar/consumer_test.go
    
    Co-Authored-By: merlimat <mmerli@apache.org>

 pulsar-client-go/pulsar/c_message.go     |  2 +-
 pulsar-client-go/pulsar/client_test.go   |  2 +-
 pulsar-client-go/pulsar/consumer_test.go | 18 ++++++++++++------
 pulsar-client-go/pulsar/producer_test.go |  1 -
 pulsar-client-go/pulsar/reader_test.go   |  8 +++++---
 5 files changed, 19 insertions(+), 12 deletions(-)

commit 925879be0691c4daf5cd49c55cfb2b6113e1d31c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Mar 7 20:38:10 2019 -0800

    fix: function config cleanupSubscription update bug (#3771)
    
    * fix: function config cleanupSubscription update bug
    
    * add and fix unit tests

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 76 +++++++++++++++++++++-
 .../functions/utils/FunctionConfigUtils.java       |  4 ++
 .../functions/utils/FunctionConfigUtilsTest.java   | 28 +++++++-
 3 files changed, 106 insertions(+), 2 deletions(-)

commit 0e48029b4501ac2c5d6cfabc8665f9ba03ff79eb
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Mar 8 10:12:27 2019 +0800

     [schema] Introduce GenericRecordBuilder and the avro implementation (#3690)
    
    *Motivation*
    
    In order to introduce `GenericRecordBuilder`, we need to know the fields in a `GenericSchema`.
    Otherwise, there is no way for us to build a GenericRecord.
    
    *Modifications*
    
    This proposal refactors current generic schema by introducing a `GenericSchema`. This generic schema
    provides interfaces to retrieve the fields of a `GenericRecordSchema`.
    
    *Additionally*
    
    This proposal adding the primitive schemas into `Schema` class. So people can program primitive schemas
    using Schema interface rather than specific implementations.

 .../client/api/schema/GenericRecordBuilder.java    |  67 +++++++++++
 .../pulsar/client/api/schema/GenericSchema.java    |   7 ++
 .../impl/schema/generic/AvroRecordBuilderImpl.java | 124 +++++++++++++++++++++
 .../impl/schema/generic/GenericAvroSchema.java     |   5 +
 .../impl/schema/generic/GenericJsonSchema.java     |   6 +
 .../client/impl/schema/SchemaBuilderTest.java      |  79 +++++++++++++
 6 files changed, 288 insertions(+)

commit 593db1c5e609697c7ea4063387d397dfe6375675
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 7 17:09:37 2019 -0800

    Fixed Reader.HasNext() in Go client (#3764)
    
    * Fixed Reader.HasNext() in Go client
    
    * Fixed formatting
    
    * Removed commented code

 pulsar-client-cpp/lib/ConsumerImpl.cc  |  8 +++----
 pulsar-client-cpp/lib/ConsumerImpl.h   |  8 +++----
 pulsar-client-cpp/lib/Reader.cc        |  6 +----
 pulsar-client-go/pulsar/reader_test.go | 44 ++++++++++++++++++++++++++++++++++
 4 files changed, 52 insertions(+), 14 deletions(-)

commit 1da21612d48f68db39905842feeaed202f45b684
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 7 15:11:10 2019 -0800

    Added support for "negative acks" in Java client (#3703)
    
    * Added support for "negative acks" in Java client
    
    * Fixed redelivery delay to be >= than configured
    
    * Fixed redelivery after timeout
    
    * Fixed timeout interval calculation
    
    * Removed the 1.1 nonsense
    
    * Fixed test cleanup
    
    * Avoid failure when passing empty set of msg ids

 .../pulsar/client/impl/NegativeAcksTest.java       | 155 +++++++++++++++++++++
 .../org/apache/pulsar/client/api/Consumer.java     |  51 +++++++
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  15 ++
 .../apache/pulsar/client/impl/ConsumerBase.java    |   5 +
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   8 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  17 ++-
 .../client/impl/MultiTopicsConsumerImpl.java       |  13 ++
 .../pulsar/client/impl/NegativeAcksTracker.java    |  93 +++++++++++++
 .../impl/conf/ConsumerConfigurationData.java       |   2 +
 .../pulsar/PulsarConsumerSourceTests.java          |   8 ++
 10 files changed, 365 insertions(+), 2 deletions(-)

commit 40adc2a2ecada3bb56df89fb8fc9d8400ce3319d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Mar 7 15:10:47 2019 -0800

    Fix intermittent test: BrokerServiceLookupTest.testModularLoadManager (#3760)
    
    * Fix intermittent test: BrokerServiceLookupTest.testModularLoadManagerSplitBundle
    
    * fix test
    
    * remove timeout from shutdown

 .../pulsar/client/api/BrokerServiceLookupTest.java | 25 +++++++++++++---------
 .../worker/PulsarWorkerAssignmentTest.java         |  6 +++---
 2 files changed, 18 insertions(+), 13 deletions(-)

commit 1cf88cfcdd9d490220a1e0c87e1e55158a3b6e7d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 7 10:37:20 2019 -0800

    Expose Secrets in Source/SinkContext (#3717)
    
    * Expose Secrets in Source/SinkContext
    
    * Fix unittest

 .../core/src/main/java/org/apache/pulsar/io/core/SinkContext.java  | 7 +++++++
 .../src/main/java/org/apache/pulsar/io/core/SourceContext.java     | 7 +++++++
 .../org/apache/pulsar/io/kafka/sink/KafkaAbstractSinkTest.java     | 3 +++
 .../org/apache/pulsar/io/kafka/source/KafkaAbstractSourceTest.java | 3 +++
 4 files changed, 20 insertions(+)

commit f7874cd90f42f1dac27391502dc1567a8d7b1e82
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 7 09:25:39 2019 -0800

    Allow users to update everything in inputspecs except for isregexpattern (#3770)
    
    * Allow users to update everything in inputspecs except for isregexpattern
    
    * Added more tests and fixed a bug caught by them

 .../pulsar/functions/utils/FunctionConfigUtils.java   |  5 +++--
 .../pulsar/functions/utils/SinkConfigUtils.java       |  5 +++--
 .../functions/utils/FunctionConfigUtilsTest.java      | 19 +++++++++++++++++++
 .../pulsar/functions/utils/SinkConfigUtilsTest.java   | 19 +++++++++++++++++++
 4 files changed, 44 insertions(+), 4 deletions(-)

commit fb5dcd9a58524686f2f6208d41a1e82b5bbb8111
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Thu Mar 7 14:22:59 2019 -0300

    [java client] Bugfix prevent dup consumers for same topic subscribe (#3746)
    
    Fixes #3743 issue.
    
    Return previous instance of a consumer in the subscription processed should only
    be considered with the scope of the same topic.
    
    Modifications:
    
      - Remove optimization of duplicated consumers for multi topics subscribe and
        pattern topics subscribe, this should be handled with a different approach.
      - Filter consumers for the same topic name.
      - Filter consumers which are connected to broker, this is not necessary to fix
        this issue but is a good thing to do.
      - Add test that verifies that same subscription will allow different consumers
        instance for different topics.

 .../client/api/SimpleProducerConsumerTest.java     | 51 +++++++++++++++++++++-
 .../pulsar/client/impl/PulsarClientImpl.java       | 13 ++----
 2 files changed, 53 insertions(+), 11 deletions(-)

commit 3d9b47e3b7e1dc741183c6588ef7b886950b9523
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Mar 7 21:47:45 2019 +0800

    Add several instructions for IO Connectors. (#3739)

 site2/docs/io-connectors.md    |  4 ++++
 site2/docs/io-elasticsearch.md | 21 +++++++++++++++++++++
 site2/docs/io-file.md          | 27 +++++++++++++++++++++++++++
 site2/docs/io-hdfs.md          | 26 ++++++++++++++++++++++++++
 site2/docs/io-mongo.md         | 20 ++++++++++++++++++++
 5 files changed, 98 insertions(+)

commit 7a9f7f338ef7ca2d77a6fe5951afd1eacbd04207
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 7 05:42:52 2019 -0800

    Use at least 8 threads in Jetty thread pool (#3776)
    
    ### Motivation
    
    Use at least 8 threads to avoid having Jetty go into threads starving and
    having the possibility of getting into a deadlock where a Jetty thread is
    waiting for another HTTP call to complete in same thread.
    
    This solve the issues of requests timing out when the broker is making REST
    calls to itself. Such examples are when running in standalone mode and
    creating a function.

 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit c13242f6cad19602c046cdee8351e060a3d231e6
Author: bilahepan <YTgaotianci@gmail.com>
Date:   Thu Mar 7 07:30:38 2019 -0600

    fix document description bugs (#3740)

 site/docs/latest/cookbooks/RetentionExpiry.md                         | 4 ++--
 site/docs/latest/getting-started/LocalCluster.md                      | 2 +-
 site/ja/advanced/RetentionExpiry.md                                   | 4 ++--
 site2/docs/getting-started-standalone.md                              | 2 +-
 .../version-2.1.0-incubating/cookbooks-retention-expiry.md            | 4 ++--
 .../version-2.1.0-incubating/getting-started-standalone.md            | 2 +-
 .../version-2.1.1-incubating/getting-started-standalone.md            | 2 +-
 .../versioned_docs/version-2.2.0/getting-started-standalone.md        | 2 +-
 .../versioned_docs/version-2.2.1/getting-started-standalone.md        | 2 +-
 .../versioned_docs/version-2.3.0/getting-started-standalone.md        | 2 +-
 10 files changed, 13 insertions(+), 13 deletions(-)

commit fd05219a3593fdb69e2efd71bed3e5895be91ea8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Mar 6 23:31:40 2019 -0800

    Retry creation of assignment topic a few times before giving up (#3722)
    
    * Retry creation of assignment topic a few times before giving up
    
    * Use Action based retry mechanism
    
    * Fix build
    
    * Catch interrupted exception
    
    * Fix unittest
    
    * Added header

 .../functions/runtime/KubernetesRuntime.java       |  87 ++++++-------
 .../pulsar/functions/runtime/RuntimeUtils.java     | 105 ----------------
 .../org/apache/pulsar/functions/utils/Actions.java | 139 +++++++++++++++++++++
 .../pulsar/functions/utils/ActionsTest.java}       |  70 ++++++-----
 .../pulsar/functions/worker/FunctionActioner.java  |  14 +--
 .../pulsar/functions/worker/SchedulerManager.java  |  71 ++++++-----
 6 files changed, 264 insertions(+), 222 deletions(-)

commit 17b531bd18b2e00714d0b2e4bc8d6cfdc2dc1647
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 6 19:58:47 2019 -0800

    Updated consumer example to use negative acks (#3761)

 site2/docs/client-libraries-go.md     | 16 +++++++++++++---
 site2/docs/client-libraries-java.md   | 19 +++++++++++++------
 site2/docs/client-libraries-python.md | 18 ++++++++++++++----
 site2/docs/reference-terminology.md   |  7 ++++++-
 4 files changed, 46 insertions(+), 14 deletions(-)

commit 69faeaf80a70947fca18e36d47cdf7540560d637
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 6 14:39:26 2019 -0800

    On shutdown, kill the function instance thread after interrupt attempt (#3749)

 .../org/apache/pulsar/functions/runtime/ThreadRuntime.java | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

commit a66275741237e59b76efe7d5339f25a3a89f2fb1
Author: penghui <codelipenghui@gmail.com>
Date:   Thu Mar 7 00:46:53 2019 +0800

    Multi version generic schema provider (#3756)
    
    * Add multi version generic schema provider.
    
    * fix log output and refactor get schema in lookup service.

 .../client/impl/BinaryProtoLookupService.java      | 11 ++-
 .../pulsar/client/impl/HttpLookupService.java      | 18 ++++-
 .../apache/pulsar/client/impl/LookupService.java   | 15 ++++
 .../generic/MultiVersionGenericSchemaProvider.java | 87 ++++++++++++++++++++++
 .../MultiVersionGenericSchemaProviderTest.java     | 67 +++++++++++++++++
 .../pulsar/common/schema/BytesSchemaVersion.java   | 40 ++++++++++
 6 files changed, 234 insertions(+), 4 deletions(-)

commit 77332b0a5456b6f397dc92093756777276d98da4
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Wed Mar 6 12:37:21 2019 +0530

    [docs] Fixed typo remove-backlog-quotas to remove-backlog-quota in docs (#3757)

 site2/docs/cookbooks-retention-expiry.md                              | 4 ++--
 .../versioned_docs/version-2.3.0/cookbooks-retention-expiry.md        | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit c39e7d196d80d1b1cecfbc8a15808698d1741089
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Mar 5 11:50:17 2019 -0800

    Broker considers fail-over consumer priority-level (#2954)
    
    add java doc
    
    fix partitioned-topic distribution

 .../AbstractDispatcherSingleActiveConsumer.java    | 29 +++++--
 .../client/api/SimpleProducerConsumerTest.java     | 93 ++++++++++++++++++++++
 .../apache/pulsar/client/api/ConsumerBuilder.java  | 20 +++++
 3 files changed, 137 insertions(+), 5 deletions(-)

commit 33f1c5528902884e8289f1c3f061ecbdec42d6d0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Mar 5 09:24:31 2019 -0800

    fix function termination cleanup (#3751)
    
    * fix function termination cleanup
    
    * cleaning up

 .../pulsar/functions/utils/FunctionInstanceId.java | 50 ++++++++++++++++++++++
 .../org/apache/pulsar/functions/utils/Utils.java   |  1 -
 .../functions/worker/FunctionRuntimeManager.java   | 19 +++++++-
 3 files changed, 67 insertions(+), 3 deletions(-)

commit 07cebb17f5df0bc3de70acacc5981271396129a9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Mar 4 22:12:56 2019 -0800

    On publish failures, log error and count them as sys exceptions (#3704)
    
    * On publish failures, log error and count them as sys exceptions
    
    * Took feedback

 .../org/apache/pulsar/functions/instance/ContextImpl.java   | 13 +++++++++++--
 .../pulsar/functions/instance/JavaInstanceRunnable.java     |  2 +-
 .../apache/pulsar/functions/instance/ContextImplTest.java   |  2 +-
 3 files changed, 13 insertions(+), 4 deletions(-)

commit 9dc3df6139ca7d2dbee4bef4c4450416b5c5279d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Mar 4 15:46:20 2019 -0800

    Adjust the serving threads to have a minimum of  threads (#3698)

 conf/broker.conf                                                       | 2 +-
 conf/proxy.conf                                                        | 2 +-
 conf/standalone.conf                                                   | 3 +++
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java   | 2 +-
 .../main/java/org/apache/pulsar/proxy/server/ProxyConfiguration.java   | 2 +-
 .../apache/pulsar/websocket/service/WebSocketProxyConfiguration.java   | 2 +-
 6 files changed, 8 insertions(+), 5 deletions(-)

commit ffa2a688fdec9e4f2a9344434cee3ed03af79201
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Mar 4 14:47:49 2019 -0800

    Avoid debug noise by consumer ack-tracker (#2953)

 .../impl/PersistentAcknowledgmentsGroupingTracker.java  | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)

commit d847c3530018d5228de3e420c8be99ec8b7043cb
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Tue Mar 5 00:58:36 2019 +0530

    Exposing getSchemaVersion in the client by making it public. (#3744)
    
    * Exposing getSchemaVersion in the client by making it public.
    
    * Implemented getSchemaVersion in TopicMessageImpl.java
    
    * Changed the release version

 .../src/main/java/org/apache/pulsar/client/api/Message.java        | 7 +++++++
 .../src/main/java/org/apache/pulsar/client/impl/MessageImpl.java   | 3 ++-
 .../main/java/org/apache/pulsar/client/impl/TopicMessageImpl.java  | 5 +++++
 3 files changed, 14 insertions(+), 1 deletion(-)

commit e06a894c1a99719861c7bb55806d2e22c2203b9b
Author: snow4young <zero.xu@bytedance.com>
Date:   Tue Mar 5 03:28:16 2019 +0800

    add cli client consumer for standalone (#3697)

 .../version-2.3.0/getting-started-standalone.md           | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit d84b687c78973b2fdceb89f2a7f5fc07e40eaa9b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 5 03:27:58 2019 +0800

    Update README.md with IDE setup for lombok (#3711)

 README.md | 28 ++++++++++++++++++++++++++++
 1 file changed, 28 insertions(+)

commit 37a2fda6c9512076ffa79dcc897d8bd9fe88d288
Author: tuteng <eguangning@gmail.com>
Date:   Mon Mar 4 17:17:22 2019 +0800

    [Issue 3275][pulsar-io]Support source and sink of flume (#3597)
    
    * Support TLS authentication and authorization in standalone mode
    
    * Compile success
    To do: test channel, sink and source of flume
    
    * Add conf file
    
    * Add sink and source folder
    Move file to folder
    Add source
    Compile success
    To do -> test source
    
    * test flume source paas
    
    * Add config file and test case
    
    * Add test and update pom.xml
    To do add test of source and sink
    
    * Add unit tests
    
    * Add test case and test pass
    To do test source
    
    * Add license
    Add test source of pulsar
    
    * Handle if blockingQueue is null
    
    * Move LOG to log
    
    * Format code
    
    * Add sinkClass in pulsar-io.yaml
    
    * Add comment
    
    * Default is false
    
    * Modify pom file of flume
    
    * Format pom.xml file
    
    * Move pom version to 2.4.0-SNAPSHOT

 pulsar-io/flume/pom.xml                            | 116 +++++
 .../org/apache/pulsar/io/flume/FlumeConfig.java    |  77 +++
 .../org/apache/pulsar/io/flume/FlumeConnector.java | 124 +++++
 .../flume/node/AbstractConfigurationProvider.java  | 559 +++++++++++++++++++++
 .../AbstractZooKeeperConfigurationProvider.java    | 104 ++++
 .../apache/pulsar/io/flume/node/Application.java   | 238 +++++++++
 .../io/flume/node/ConfigurationProvider.java       |  23 +
 .../io/flume/node/EnvVarResolverProperties.java    |  61 +++
 .../io/flume/node/MaterializedConfiguration.java   |  46 ++
 ...PollingPropertiesFileConfigurationProvider.java | 161 ++++++
 .../PollingZooKeeperConfigurationProvider.java     | 135 +++++
 .../node/PropertiesFileConfigurationProvider.java  | 217 ++++++++
 .../node/SimpleMaterializedConfiguration.java      |  78 +++
 .../node/StaticZooKeeperConfigurationProvider.java |  55 ++
 .../apache/pulsar/io/flume/sink/AbstractSink.java  |  83 +++
 .../apache/pulsar/io/flume/sink/SourceOfFlume.java | 118 +++++
 .../apache/pulsar/io/flume/sink/StringSink.java    |  30 ++
 .../io/flume/source/AbstractSinkOfFlume.java       |  33 ++
 .../pulsar/io/flume/source/AbstractSource.java     | 143 ++++++
 .../apache/pulsar/io/flume/source/SinkOfFlume.java | 123 +++++
 .../pulsar/io/flume/source/StringSource.java       |  28 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +
 .../src/main/resources/flume/flume-io-sink.yaml    |  25 +
 .../src/main/resources/flume/flume-io-source.yaml  |  25 +
 pulsar-io/flume/src/main/resources/flume/sink.conf |  41 ++
 .../flume/src/main/resources/flume/source.conf     |  41 ++
 .../apache/pulsar/io/flume/AbstractFlumeTests.java |  24 +
 .../node/TestAbstractConfigurationProvider.java    | 370 ++++++++++++++
 ...TestAbstractZooKeeperConfigurationProvider.java | 131 +++++
 .../pulsar/io/flume/node/TestApplication.java      | 198 ++++++++
 .../flume/node/TestEnvVarResolverProperties.java   |  70 +++
 ...PollingPropertiesFileConfigurationProvider.java | 101 ++++
 .../TestPollingZooKeeperConfigurationProvider.java |  95 ++++
 .../TestPropertiesFileConfigurationProvider.java   | 106 ++++
 .../TestStaticZooKeeperConfigurationProvider.java  |  44 ++
 .../pulsar/io/flume/sink/StringSinkTests.java      | 136 +++++
 .../pulsar/io/flume/source/StringSourceTests.java  | 106 ++++
 .../resources/flume-conf-with-envvars.properties   |  36 ++
 .../flume/src/test/resources/flume-conf.properties | 115 +++++
 .../src/test/resources/flume-conf.properties.2786  |  35 ++
 pulsar-io/flume/src/test/resources/flume/sink.conf |  41 ++
 .../flume/src/test/resources/flume/source.conf     |  41 ++
 .../flume/src/test/resources/log4j.properties      |  26 +
 pulsar-io/pom.xml                                  |   1 +
 44 files changed, 4382 insertions(+)

commit 548c726b8e7f0e163b1132c9ada6ba83d6bec572
Author: Richard Yu <yohan.richard.yu@gmail.com>
Date:   Sun Mar 3 17:18:50 2019 -0800

    [Issue #3436][pulsar-broker] Creating REST Endpoint for non-partitioned topic creation (#3625)
    
    We are adding a REST endpoint which allows the admin to create non-partitioned topics
    through PersistentTopics.

 .../broker/admin/impl/PersistentTopicsBase.java    | 12 ++++++++++
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 16 +++++++++++++
 .../pulsar/broker/admin/PersistentTopicsTest.java  |  5 +++-
 .../org/apache/pulsar/client/admin/Topics.java     | 19 +++++++++++++++
 .../pulsar/client/admin/internal/TopicsImpl.java   | 19 +++++++++++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  3 +++
 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 14 +++++++++++
 site2/docs/admin-api-partitioned-topics.md         | 27 ++++++++++++++++++++++
 site2/docs/reference-pulsar-admin.md               | 10 +++++++-
 9 files changed, 123 insertions(+), 2 deletions(-)

commit 65daec1019f8e759648683f2afa198c7f111bb07
Author: wpl <1269223860@qq.com>
Date:   Sun Mar 3 23:52:19 2019 +0800

    fix Jenkins pulsar-website-build error 571 (#3691)
    
    ### Motivation
    
    Jenkins pulsar-website-build error 571 error info:
    ```java
    Error: No 'original_id' field found in /pulsar/site2/website/versioned_docs/version-2.3.0/io-cdc-canal.md. Perhaps you forgot to add it when importing prior versions of your docs?
        at /pulsar/site2/website/node_modules/docusaurus/lib/server/versionFallback.js:64:11
        at Array.forEach (<anonymous>)
        at Object.forEach (/pulsar/site2/website/node_modules/docusaurus/lib/server/versionFallback.js:52:7)
        at Module._compile (internal/modules/cjs/loader.js:688:30)
        at Module._compile (/pulsar/site2/website/node_modules/pirates/lib/index.js:99:24)
        at Module._extensions..js (internal/modules/cjs/loader.js:699:10)
        at Object.newLoader [as .js] (/pulsar/site2/website/node_modules/pirates/lib/index.js:104:7)
        at Module.load (internal/modules/cjs/loader.js:598:32)
        at tryModuleLoad (internal/modules/cjs/loader.js:537:12)
        at Function.Module._load (internal/modules/cjs/loader.js:529:3)
    error Command failed with exit code 1.
    ```
    
    ### Modifications
    
    io-cdc doc add original_id content.

 site2/website/versioned_docs/version-2.3.0/io-cdc-canal.md    | 3 ++-
 site2/website/versioned_docs/version-2.3.0/io-cdc-debezium.md | 3 ++-
 site2/website/versioned_docs/version-2.3.0/io-cdc.md          | 3 ++-
 3 files changed, 6 insertions(+), 3 deletions(-)

commit 5fd5730f8da7dff3b094c0943fc959ca1d6aea85
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Mar 2 15:09:36 2019 +0800

    [logging] make root log level configurable (#3661)
    
    *Motivation*
    
    Currently there is no way to configurable pulsar broker logging to debug level,
    unless modify log4j2.yaml directly
    
    *Modifications*
    
    Introduce `pulsar.log.root.level` for configuring root log level.
    Make it configurable by `PULSAR_LOG_ROOT_LEVEL`

 bin/pulsar       | 1 +
 conf/log4j2.yaml | 4 +++-
 2 files changed, 4 insertions(+), 1 deletion(-)

commit bc8b380e584a4d91a80c7afb72d5525bf845176f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 1 22:22:11 2019 -0800

    Fail the source record if the write fails (#3706)

 .../apache/pulsar/functions/sink/PulsarSink.java   | 26 ++++++++++++----------
 1 file changed, 14 insertions(+), 12 deletions(-)

commit 40aecc1b33e3cc59151aee84bbef2983641b4039
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Mar 1 20:18:58 2019 -0800

    Fix Test localhost resolution errors (#3730)

 .../org/apache/pulsar/broker/PulsarService.java    | 15 +++--
 .../broker/auth/MockedPulsarServiceBaseTest.java   | 16 +++--
 .../broker/loadbalance/LoadBalancerTest.java       | 70 +++++++++++-----------
 .../loadbalance/ModularLoadManagerImplTest.java    | 60 +++++++++----------
 .../pulsar/client/impl/TopicFromMessageTest.java   |  5 --
 .../worker/PulsarWorkerAssignmentTest.java         |  7 +--
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |  2 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 13 ++--
 .../stats/client/PulsarBrokerStatsClientTest.java  | 22 ++++---
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |  2 +-
 10 files changed, 97 insertions(+), 115 deletions(-)

commit bb9a4fb044df85385c3490649a226a897d513df2
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Sat Mar 2 09:53:34 2019 +0900

    fix pulsar_message_set_replication_clusters (#3729)

 pulsar-client-cpp/include/pulsar/c/message.h | 4 ++--
 pulsar-client-cpp/lib/c/c_Message.cc         | 8 ++++----
 pulsar-client-go/pulsar/c_message.go         | 2 +-
 3 files changed, 7 insertions(+), 7 deletions(-)

commit 7c7c3fb4219cba906858312e576a4193ad485af6
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Mar 1 15:22:10 2019 -0800

    Use python 3.5 runtime and pulsar client (#3723)
    
    * Use python 3.5 runtime and pulsar client
    
    * Fix PulsarWorkerAssignmentTest
    
    * Test Fixes
    
    * Adjust test timeout

 docker/pulsar/Dockerfile                           |  8 +--
 docker/pulsar/pom.xml                              |  6 +-
 ...ar-client-37.sh => install-pulsar-client-35.sh} |  2 +-
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   | 28 +++-----
 .../broker/service/ReplicatorGlobalNSTest.java     | 15 ++--
 .../pulsar/broker/service/ReplicatorTestBase.java  |  4 +-
 .../broker/service/v1/V1_ReplicatorTest.java       |  6 +-
 .../worker/PulsarWorkerAssignmentTest.java         | 81 +++++++++++-----------
 8 files changed, 69 insertions(+), 81 deletions(-)

commit 01422476248d23741ff74f68e9cbd48ddf097108
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Mar 1 15:09:13 2019 -0800

    Revert "Remove broker mode to handle persistent/non-persistent topics separately (#3348)" (#3713)
    
    This reverts commit 77d4c28d59604cb6ec589d3620ab1770e0523c87.

 conf/broker.conf                                   |   6 +
 conf/standalone.conf                               |   6 +
 deployment/terraform-ansible/templates/broker.conf |   6 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  12 ++
 .../broker/loadbalance/impl/LoadManagerShared.java |  34 ++++-
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  43 ++++--
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  27 +++-
 .../pulsar/broker/service/BrokerService.java       |  16 +++
 .../loadbalance/ModularLoadManagerImplTest.java    |  24 +++-
 .../pulsar/client/api/NonPersistentTopicTest.java  | 151 +++++++++++++++++++++
 .../data/loadbalancer/LoadManagerReport.java       |   4 +
 .../policies/data/loadbalancer/LoadReport.java     |  18 +++
 .../data/loadbalancer/LocalBrokerData.java         |  20 +++
 site/_data/config/broker.yaml                      |   6 +
 .../explanations/ja/non-persistent-topics.md       |  15 +-
 .../latest/cookbooks/non-persistent-messaging.md   |   8 ++
 .../getting-started/ConceptsAndArchitecture.md     |   2 +-
 site2/docs/concepts-messaging.md                   |   2 +-
 site2/docs/cookbooks-non-persistent.md             |   7 +
 site2/docs/reference-configuration.md              |   2 +
 20 files changed, 384 insertions(+), 25 deletions(-)

commit ccfb94970bd26d7e9b4f3c819bba258f148773e4
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 28 21:53:04 2019 -0800

    When the loadmanager leader is not available, fall through regular least loaded selection (#3688)
    
    * When the loadmanager leader is not available, fall through regular least loaded selection
    
    * Handle exceptions coming from mock zk in tests

 .../broker/loadbalance/LeaderElectionService.java       | 17 +++++++++++++++++
 .../pulsar/broker/namespace/NamespaceService.java       | 11 ++++++++---
 2 files changed, 25 insertions(+), 3 deletions(-)

commit 1f376e10362df30af35580f072e83d57757013d2
Author:  <rxl5555555@qq.com>
Date:   Thu Feb 28 22:48:37 2019 +0800

    add reset cousor to a specific publish time (#3622)
    
    Signed-off-by: xiaolong.ran ranxiaolong716@gmail.com
    
    Fixes #3446 #3565
    
    Motivation
    Reset the subscription associated with this consumer to a specific publish time.

 .../apache/pulsar/broker/service/ServerCnx.java    | 24 +++++++--
 .../apache/pulsar/client/impl/RawReaderImpl.java   |  6 +++
 .../broker/service/SubscriptionSeekTest.java       | 55 +++++++++++++++++++++
 .../org/apache/pulsar/client/api/Consumer.java     | 23 +++++++++
 .../pulsar/client/impl/v1/ConsumerV1Impl.java      |  8 +++
 .../org/apache/pulsar/client/api/Consumer.java     | 23 +++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 39 +++++++++++++++
 .../client/impl/MultiTopicsConsumerImpl.java       | 16 ++++++
 .../org/apache/pulsar/common/api/Commands.java     | 15 ++++++
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 ++++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  1 +
 .../pulsar/PulsarConsumerSourceTests.java          | 10 ++++
 12 files changed, 273 insertions(+), 4 deletions(-)

commit f4d566248c56e5b4cfb1f74f74d3a35bdebf0e61
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Feb 28 22:35:17 2019 +0800

    [schema] Introduce `GenericSchema` interface (#3683)
    
    *Motivation*
    
    In order to introduce `GenericRecordBuilder`, we need to know the fields in a `GenericSchema`.
    Otherwise, there is no way for us to build a GenericRecord.
    
    *Modifications*
    
    This proposal refactors current generic schema by introducing a `GenericSchema`. This generic schema
    provides interfaces to retrieve the fields of a `GenericRecordSchema`.
    
    *Additionally*
    
    This proposal adding the primitive schemas into `Schema` class. So people can program primitive schemas
    using Schema interface rather than specific implementations.

 .../java/org/apache/pulsar/client/api/Schema.java  | 53 ++++++++++++++++++
 .../pulsar/client/api/schema/GenericSchema.java    | 36 +++++++++++++
 .../client/internal/DefaultImplementation.java     | 63 ++++++++++++++++++++++
 .../pulsar/client/impl/PulsarClientImpl.java       |  6 +--
 .../client/impl/schema/AutoConsumeSchema.java      |  4 +-
 .../impl/schema/generic/GenericAvroSchema.java     |  2 +-
 .../impl/schema/generic/GenericJsonSchema.java     |  2 +-
 .../{GenericSchema.java => GenericSchemaImpl.java} | 12 +++--
 .../client/impl/schema/PrimitiveSchemaTest.java    | 41 ++++++++------
 ...cSchemaTest.java => GenericSchemaImplTest.java} | 10 ++--
 .../io/hbase/sink/HbaseGenericRecordSinkTest.java  |  4 +-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    |  4 +-
 12 files changed, 203 insertions(+), 34 deletions(-)

commit 8c181cdb072f39c899c2480d552b7c1b470a6d4e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Feb 27 21:33:58 2019 -0800

    [pulsar-admin-cli] add tls-trust-cert-path option to cli input (#3709)

 .../main/java/org/apache/pulsar/admin/cli/PulsarAdminTool.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 1dd7207596ead40882251db39b86a9d4552d9b99
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Feb 28 11:02:58 2019 +0800

    [schema] clean up the implementations of schema bc check (#3665)
    
    *Motivation*
    
    There are a lot of duplications in schema bc check implementations.
    
    *Modifications*
    
    Removed duplicated code.

 .../schema/AvroSchemaBasedCompatibilityCheck.java  | 69 ++++++++++++++++++++++
 .../schema/AvroSchemaCompatibilityCheck.java       | 51 ++--------------
 .../schema/JsonSchemaCompatibilityCheck.java       | 51 +++-------------
 .../schema/ProtobufSchemaCompatibilityCheck.java   |  3 +
 4 files changed, 85 insertions(+), 89 deletions(-)

commit 77d4c28d59604cb6ec589d3620ab1770e0523c87
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Feb 26 11:05:51 2019 -0800

    Remove broker mode to handle persistent/non-persistent topics separately (#3348)
    
    * Remove broker mode to handle persistent/non-persistent topics separately
    
    * fix unused imports

 conf/broker.conf                                   |   6 -
 conf/standalone.conf                               |   6 -
 deployment/terraform-ansible/templates/broker.conf |   6 -
 .../apache/pulsar/broker/ServiceConfiguration.java |  12 --
 .../broker/loadbalance/impl/LoadManagerShared.java |  34 +----
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  43 ++----
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  27 +---
 .../pulsar/broker/service/BrokerService.java       |  16 ---
 .../loadbalance/ModularLoadManagerImplTest.java    |  24 +---
 .../pulsar/client/api/NonPersistentTopicTest.java  | 151 ---------------------
 .../data/loadbalancer/LoadManagerReport.java       |   4 -
 .../policies/data/loadbalancer/LoadReport.java     |  18 ---
 .../data/loadbalancer/LocalBrokerData.java         |  20 ---
 site/_data/config/broker.yaml                      |   6 -
 .../explanations/ja/non-persistent-topics.md       |  15 +-
 .../latest/cookbooks/non-persistent-messaging.md   |   8 --
 .../getting-started/ConceptsAndArchitecture.md     |   2 +-
 site2/docs/concepts-messaging.md                   |   2 +-
 site2/docs/cookbooks-non-persistent.md             |   7 -
 site2/docs/reference-configuration.md              |   2 -
 20 files changed, 25 insertions(+), 384 deletions(-)

commit 3ac67de0a2d023f372be27fc04055196ed224996
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Feb 26 11:04:34 2019 -0800

    [pulsar-broker] fix: npe while acking message (#3687)

 .../src/main/java/org/apache/pulsar/broker/service/Consumer.java   | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 878362c2f08055dedf11477fd434ad83b98a4faf
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 26 10:57:55 2019 -0800

    Simplified the workflow of functionruntime manager (#3551)
    
    * Simplified the workflow of functionruntime manager
    
    * Fix unittest
    
    * Took feedback into account
    
    * added missing imports

 .../pulsar/functions/worker/FunctionAction.java    |  40 -----
 .../pulsar/functions/worker/FunctionActioner.java  | 147 ++++++-----------
 .../functions/worker/FunctionRuntimeManager.java   | 125 +++++----------
 .../functions/worker/FunctionActionerTest.java     |  27 ++--
 .../worker/FunctionRuntimeManagerTest.java         | 173 ++++++++++++---------
 5 files changed, 199 insertions(+), 313 deletions(-)

commit d46474b266a46494214cfd8bb3e58cef41350068
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 26 20:03:22 2019 +0800

    [schema] Introduce schema builder to build schema. (#3682)
    
    *Motivation*
    
    Currently we are supporting POJO based schema in java clients.
    POJO schema is only useful when the POJO is predefined. However
    in applications like a CDC pipeline, POJO is no predefined, there
    is no other way to define a schema.
    
    Since we are using avro schema for schema management, this PR
    is proposing a simple schema builder wrapper on avro schema builder.
    
    *Modifications*
    
    Introduce schema builder to build a record schema.
    
    *NOTES*
    
    Currently we only support primitives in defining fields in a record schema in this PR.
    We will add nested types in future PRs.

 .../java/org/apache/pulsar/client/api/Schema.java  |   1 +
 .../client/api/schema/FieldSchemaBuilder.java      |  86 ++++++++++
 .../client/api/schema/RecordSchemaBuilder.java     |  61 +++++++
 .../pulsar/client/api/schema/SchemaBuilder.java    |  38 +++++
 .../client/internal/DefaultImplementation.java     |   7 +
 .../client/impl/schema/FieldSchemaBuilderImpl.java | 176 +++++++++++++++++++++
 .../impl/schema/RecordSchemaBuilderImpl.java       | 124 +++++++++++++++
 .../pulsar/client/impl/schema/SchemaUtils.java     | 152 ++++++++++++++++++
 .../client/impl/schema/SchemaBuilderTest.java      | 117 ++++++++++++++
 9 files changed, 762 insertions(+)

commit 3c36705f233c73cef96572eba3a2f3ec69fc5bea
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 26 20:02:34 2019 +0800

    [schema] Introduce multi version generic record schema (#3670)
    
    *Motivation*
    
    Currently AUTO_CONSUME only supports decoding records from latest schema.
    All the schema versions are lost. It makes AUTO_CONSUME less useful in some use cases,
    such as CDC. Because there is no way for the applications to know which version of schema
    that a message is using.
    
    In order to support multi-version schema, we need to propagate schema version from
    message header through schema#decode method to the decoded record.
    
    *Modifications*
    
    - Introduce a new decode method `decode(byte[] data, byte[] schemaVersion)`. This allows the implementation
      to leverage the schema version.
    - Introduce a method `supportSchemaVersioning` to tell which decode methods to use. Because most of the schema
      implementations such as primitive schemas and POJO based schema doesn't make any sense to use schema version.
    - Introduce a SchemaProvider which returns a specific schema instance for a given schema version
    - Implement a MultiVersionGenericRecordSchema which decode the messages based on schema version. All the records
      decoded by this schema will have schema version and its corresponding schema definitions.
    
    *NOTES
    
    This implementation only introduce the mechanism. But it doesn't wire the multi-version schema
    with auto_consume schema. There will be a subsequent pull request on implementing a schema provider
    that fetches and caches schemas from brokers.

 .../java/org/apache/pulsar/client/api/Schema.java  | 36 ++++++++-
 .../pulsar/client/api/schema/GenericRecord.java    |  7 ++
 .../org/apache/pulsar/client/impl/MessageImpl.java | 16 +++-
 .../client/impl/schema/AutoConsumeSchema.java      |  4 +-
 .../client/impl/schema/AutoProduceBytesSchema.java |  4 +-
 .../impl/schema/generic/GenericAvroRecord.java     | 16 ++--
 .../impl/schema/generic/GenericAvroSchema.java     |  4 +-
 .../impl/schema/generic/GenericJsonRecord.java     | 16 ++--
 .../impl/schema/generic/GenericJsonSchema.java     |  4 +-
 .../schema/generic/MultiVersionGenericSchema.java  | 62 +++++++++++++++
 .../client/impl/schema/generic/SchemaProvider.java | 36 +++++++++
 .../schema/generic/VersionedGenericRecord.java     | 49 ++++++++++++
 .../generic/MultiVersionGenericSchemaTest.java     | 90 ++++++++++++++++++++++
 13 files changed, 312 insertions(+), 32 deletions(-)

commit 0aa249a662f833126e54692eee986b768892d410
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 25 23:58:08 2019 -0800

    Added a flush method for python producer (#3685)

 pulsar-client-cpp/python/pulsar/__init__.py |  9 +++++++++
 pulsar-client-cpp/python/src/producer.cc    | 12 ++++++++++++
 pulsar-client-cpp/python/test_producer.py   |  1 +
 3 files changed, 22 insertions(+)

commit 397ef3322e8b082817ecb70351d4923e414daf9f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Feb 25 18:21:32 2019 -0800

    fix: non-batched messages cause sql query to fail (#3684)

 .../org/apache/pulsar/common/api/raw/MessageParser.java     |  2 +-
 .../pulsar/tests/integration/presto/TestBasicPresto.java    | 13 +++++++++++--
 2 files changed, 12 insertions(+), 3 deletions(-)

commit 915a4d030b32d2c4db31c0b4bd99bd6a2fd762b5
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Feb 25 15:04:53 2019 -0800

    package windowing code with function instance (#3638)

 pulsar-functions/instance/pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit fe7311c637181cf6545e73fee066d9a2840b0a59
Author: Like <like_0903@163.com>
Date:   Tue Feb 26 00:23:01 2019 +0800

    Replace Junit with testng (#3675)
    
    Closes #3663

 .../pulsar/client/api/DeadLetterTopicTest.java     |  4 +--
 .../apache/pulsar/client/api/InterceptorsTest.java |  2 +-
 .../pulsar/PulsarAvroOutputFormatTest.java         | 13 +++----
 .../pulsar/PulsarCsvOutputFormatTest.java          | 12 +++----
 .../pulsar/PulsarJsonOutputFormatTest.java         | 12 +++----
 .../connectors/pulsar/PulsarOutputFormatTest.java  | 16 ++++-----
 .../serialization/AvroSerializationSchemaTest.java |  4 +--
 .../serialization/CsvSerializationSchemaTest.java  |  4 +--
 .../serialization/JsonSerializationSchemaTest.java |  6 ++--
 .../connectors/pulsar/PulsarAvroTableSinkTest.java | 14 ++++----
 .../pulsar/PulsarConsumerSourceTests.java          | 13 ++++---
 .../connectors/pulsar/PulsarJsonTableSinkTest.java | 10 +++---
 .../connectors/pulsar/PulsarSourceBuilderTest.java | 32 ++++++++---------
 .../pulsar/functions/instance/ContextImplTest.java | 40 ++++++++++++----------
 .../instance/state/StateContextImplTest.java       | 19 +++++-----
 .../pulsar/functions/runtime/RuntimeUtilsTest.java |  8 ++---
 .../io/debezium/PulsarDatabaseHistoryTest.java     |  2 +-
 pulsar-io/netty/pom.xml                            |  6 ++--
 .../pulsar/io/netty/NettySourceConfigTest.java     | 10 +++---
 .../http/NettyHttpChannelInitializerTest.java      |  6 ++--
 .../netty/server/NettyChannelInitializerTest.java  |  6 ++--
 .../pulsar/io/netty/server/NettyServerTest.java    | 21 ++++++------
 .../pulsar/tests/integration/cli/CLITest.java      |  1 -
 .../integration/functions/PulsarStateTest.java     |  4 +--
 .../tests/integration/io/CassandraSinkTester.java  |  4 +--
 25 files changed, 137 insertions(+), 132 deletions(-)

commit ebc70de4fbe3cac732d8d56e824c44d78526253a
Author: Jia Zhai <zhaijia@apache.org>
Date:   Mon Feb 25 00:03:36 2019 +0800

    fix license exclude for local license check (#3674)

 pom.xml | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

commit 03b06a661ddc6932ad4de6c80a0157ae3681d576
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Feb 23 19:09:29 2019 -0800

    report sys errors when failed to produce successfully (#3668)
    
    * report sys errors when failed to produce sucessfully
    
    * enhancing error message
    
    * adding metrics to context publish
    
    * enhancing error logging and adding java error handling
    
    * fixing tests
    
    * cleaning up
    
    * addressing comments and fix bug
    
    * cleaning up
    
    * fix bug
    
    * fix test
    
    * check is none
    
    * fix unit test
    
    * cleaning up

 .../functions/instance/JavaInstanceRunnable.java   |  2 +-
 .../instance/stats/ComponentStatsManager.java      |  6 +-
 .../instance/stats/FunctionStatsManager.java       |  8 +--
 .../functions/instance/stats/SinkStatsManager.java |  6 +-
 .../instance/stats/SourceStatsManager.java         |  6 +-
 .../apache/pulsar/functions/sink/PulsarSink.java   | 48 ++++++++++++---
 .../instance/src/main/python/contextimpl.py        | 19 +++++-
 .../instance/src/main/python/python_instance.py    | 17 ++++--
 .../pulsar/functions/sink/PulsarSinkTest.java      | 71 ++++++++++++----------
 .../src/test/python/test_python_instance.py        | 19 +++++-
 10 files changed, 134 insertions(+), 68 deletions(-)

commit 2a3566408b5e3039987ae70a54ba91a23074d7ed
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 23 17:28:45 2019 -0800

    In C++ allow messages that compress to <5mb to be sent with batching enabled (#3673)
    
    * In C++ allow messages that compress to <5mb to be sent with batching enabled
    
    * Fixed related test

 pulsar-client-cpp/lib/BatchMessageContainer.cc |  8 +++++
 pulsar-client-cpp/lib/ProducerImpl.cc          | 13 ++++----
 pulsar-client-cpp/tests/BasicEndToEndTest.cc   | 43 +++++++++++++++++++++++++-
 3 files changed, 57 insertions(+), 7 deletions(-)

commit 69936e6176d21c6be992c082cebf5264570acdf1
Author: Like <like_0903@163.com>
Date:   Sun Feb 24 01:39:04 2019 +0800

    Increase receive timeout to 2000 (#3676)

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5dc333caef6830350638274fa9d34903f377998e
Author: tuteng <eguangning@gmail.com>
Date:   Sat Feb 23 11:54:12 2019 +0800

    [pulsar-io]Add document for canal (#3664)

 site2/docs/io-cdc-canal.md                         | 174 +++++++++++++++++++++
 site2/docs/io-cdc-debezium.md                      | 138 ++++++++++++++++
 site2/docs/io-cdc.md                               | 140 +----------------
 .../versioned_docs/version-2.3.0/io-cdc-canal.md   | 174 +++++++++++++++++++++
 .../version-2.3.0/io-cdc-debezium.md               | 138 ++++++++++++++++
 .../website/versioned_docs/version-2.3.0/io-cdc.md |  16 ++
 .../versioned_docs/version-2.3.0/io-connectors.md  |   2 +-
 7 files changed, 646 insertions(+), 136 deletions(-)

commit 04d03233ca64c73188d09c577d2abe8032a9d2cd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Feb 22 14:13:40 2019 -0800

    [pulsar-broker] redelivery tracker use open hashmap (#3585)
    
    * [pulsar-broker] redelivery tracker use open hashmap
    
    * fix redel count

 .../broker/service/InMemoryRedeliveryTracker.java  | 25 ++++++++++++++--------
 .../pulsar/broker/service/RedeliveryTracker.java   |  4 ++--
 .../broker/service/RedeliveryTrackerDisabled.java  |  4 ++--
 3 files changed, 20 insertions(+), 13 deletions(-)

commit 24d20aab45f894cb620f19f24c1d97270ca4bac9
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 22 11:49:47 2019 -0800

    When linking statically a the Python wrapper on Macos, also include libicu (#3647)

 pulsar-client-cpp/python/CMakeLists.txt | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit d3643a072c6dfd444974e0f8b864fc053cfdb4f8
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Feb 22 11:47:05 2019 -0800

    [pulsar-broker] auto refresh new tls certs for jetty webserver (#3645)
    
    * [pulsar-broker] auto refresh new tls certs for jetty webserver
    
    * Fix: function worker
    
    * revert expired test

 conf/broker.conf                                   |   3 +
 conf/discovery.conf                                |   2 +
 conf/functions_worker.yml                          |   2 +
 conf/proxy.conf                                    |   3 +
 conf/websocket.conf                                |   2 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   4 +-
 .../broker/service/PulsarChannelInitializer.java   |   8 +-
 .../org/apache/pulsar/broker/web/WebService.java   |   6 +-
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   |   2 +-
 .../common/util/DefaultSslContextBuilder.java      |  51 +++++++++
 .../pulsar/common/util/NettySslContextBuilder.java |  53 ++++++++++
 .../apache/pulsar/common/util/SecurityUtility.java |  40 +++++++-
 .../common/util/ServerSslContextRefresher.java     |  87 ----------------
 .../common/util/SslContextAutoRefreshBuilder.java  | 114 +++++++++++++++++++++
 .../service/ServiceChannelInitializer.java         |   9 +-
 .../discovery/service/server/ServerManager.java    |   6 +-
 .../discovery/service/server/ServiceConfig.java    |  12 +--
 .../pulsar/functions/worker/WorkerConfig.java      |   5 +
 .../pulsar/functions/worker/rest/WorkerServer.java |   6 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    |   4 +-
 .../proxy/server/ServiceChannelInitializer.java    |   9 +-
 .../org/apache/pulsar/proxy/server/WebServer.java  |   6 +-
 .../pulsar/websocket/service/ProxyServer.java      |   6 +-
 .../service/WebSocketProxyConfiguration.java       |  10 ++
 24 files changed, 324 insertions(+), 126 deletions(-)

commit 493023a53ae12ea584e1724facc70d53da4f5a16
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Feb 22 10:34:11 2019 -0800

    fix context publish signature (#3669)

 pulsar-client-cpp/python/pulsar/functions/context.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c0ffa16affba42197ec167ae87967884cdbac5ce
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Sat Feb 23 01:18:06 2019 +0800

    [Issue 3409] Support '--help' option of Pulsar command-line tools (#3410)
    
    * Support '--help' option of Pulsar command-line tools.
    
    * Fix a indentation
    
    * Fix a minor bug

 bin/bookkeeper    |  2 +-
 bin/pulsar        |  2 +-
 bin/pulsar-daemon | 13 ++++++++++---
 bin/pulsar-perf   |  6 +++---
 4 files changed, 15 insertions(+), 8 deletions(-)

commit 4376c6599379d771dc17983a3a8bf98e0cb66028
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Feb 23 01:06:19 2019 +0800

    PIP-29: One package for both pulsar client and pulsar admin (#3662)
    
    *Motivation*
    
    Currently we are shipping pulsar-client and pulsar-client-admin separately. Both pulsar-client and pulsar-client-admin are shaded packages. But they shaded the dependencies independently.
    
    It is quite common to see applications using both pulsar-client and pulsar-client-admin. These applications will have redundant shaded classes existed in both pulsar-client and pulsar-client-admin. Sometime it also causes troubles when we introduced new dependencies but forget to update shading rules.
    
    *Modifications*
    
    This proposal is proposing introduced a new module called pulsar-client-all. It will include both pulsar-client and pulsar-client-admin and shade the dependencies only one time. This would reduce the size of dependencies for applications using both pulsar-client and pulsar-client-admin.

 pom.xml                   |   1 +
 pulsar-client-all/pom.xml | 358 ++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 359 insertions(+)

commit d0edfe47877a052e4082ca79062e1be443f1c854
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Feb 22 23:29:47 2019 +0800

    improvement doc of `--auth-params` in `pulsar-client` cli (#3605)
    
    ### Motivation
    
    User report documentation is not very clear for pulsar-client command `--auth-params` parameter.
    for org.apache.pulsar.client.impl.auth.AuthenticationBasic, it is in Json format
    
    
    ### Modifications
    
    fix doc

 .../src/main/java/org/apache/pulsar/admin/cli/PulsarAdminTool.java | 6 +++++-
 .../main/java/org/apache/pulsar/client/cli/PulsarClientTool.java   | 6 +++++-
 .../org/apache/pulsar/proxy/socket/client/PerformanceClient.java   | 7 +++++--
 .../java/org/apache/pulsar/testclient/PerformanceConsumer.java     | 7 +++++--
 .../java/org/apache/pulsar/testclient/PerformanceProducer.java     | 7 +++++--
 .../main/java/org/apache/pulsar/testclient/PerformanceReader.java  | 7 +++++--
 site2/docs/reference-cli-tools.md                                  | 2 +-
 .../versioned_docs/version-2.1.0-incubating/reference-cli-tools.md | 2 +-
 8 files changed, 32 insertions(+), 12 deletions(-)

commit e9ba7ac4423a74551877265f799f6a35b406400a
Author: feiyuyitiao <songfuyu_1997@163.com>
Date:   Fri Feb 22 23:29:00 2019 +0800

    Update collector.py (#3657)
    
    update stats url path from '/admin/...' to '/admin/v2/...'

 docker/pulsar-standalone/django/collector.py | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 16bb6ce71d21356839d2e14c2de6aeb9bc6d6d57
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 22 23:27:59 2019 +0800

    [schema] use UTF_8 for storing schema information (#3666)
    
    *Motivation*
    
    Currently we don't specify charset. It will be causing troubles when client
    and broker are using different system charsets.
    
    *Modifications*
    
    Use UTF_8 for the schema information for AVRO/PROTOBUF/JSON

 .../main/java/org/apache/pulsar/client/impl/schema/AvroSchema.java    | 4 +++-
 .../main/java/org/apache/pulsar/client/impl/schema/JSONSchema.java    | 4 +++-
 .../java/org/apache/pulsar/client/impl/schema/ProtobufSchema.java     | 4 +++-
 3 files changed, 9 insertions(+), 3 deletions(-)

commit bd62dab661e5339e3440aea273d76606e5146fdb
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 22 16:36:49 2019 +0800

    [distribution] remove pulsar-io-debezium nar package (#3656)
    
    *Motivation*
    
    Fixes #3651
    
    `pulsar-io-debezium` is a normal module but not a connector package.
    it was added as a connector package by mistake at #3601. This would
    cause failing to load connectors during broker starts up.
    
    *Changes*
    
    - remove nar plugin from `pulsar-io-debezium`
    - remove `pulsar-io-debezium` from distribution
    - add `pulsar-io-kafka-connect-adaptor` in the website

 distribution/io/src/assemble/io.xml |  1 -
 pulsar-io/debezium/pom.xml          | 10 ----------
 site2/website/data/connectors.js    |  6 ++++++
 3 files changed, 6 insertions(+), 11 deletions(-)

commit 40b374d3e3009808aed2060c293d78e051ba5a9d
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Feb 22 17:28:42 2019 +0900

    Fixed conversion of unix timestamp to golang time (#3659)

 pulsar-client-go/pulsar/c_message.go     | 7 +++----
 pulsar-client-go/pulsar/consumer_test.go | 4 ++++
 2 files changed, 7 insertions(+), 4 deletions(-)

commit 51273512574a5be69a4285a566c87cdf8f0472bb
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 21 21:18:41 2019 -0800

    Apply docs fix in #3641 also to 2.3 site (#3649)

 .../website/versioned_docs/version-2.3.0/client-libraries-cpp.md  | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit 1bf7224d737d4b82a859125d499d21a1c0d4a35a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 21 15:57:24 2019 -0800

    propagate default resource values in Pulsar Functions (#3636)
    
    * propagate default resource values in Pulsar Functions
    
    * fix unit tests

 .../apache/pulsar/common/functions/Resources.java  | 20 +++++++++++++++++++
 .../functions/utils/FunctionConfigUtils.java       | 23 ++++++++++------------
 .../pulsar/functions/utils/SinkConfigUtils.java    | 22 +++++++++------------
 .../pulsar/functions/utils/SourceConfigUtils.java  | 21 ++++++++------------
 .../functions/utils/FunctionConfigUtilsTest.java   |  6 ++++++
 .../functions/utils/SourceConfigUtilsTest.java     |  3 +++
 6 files changed, 56 insertions(+), 39 deletions(-)

commit 9d97f1d10986cc5d807df2e724a86e37761b3e2f
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 21 15:56:30 2019 -0800

    Moved release notes link at top of download page (#3648)

 site2/website/pages/en/download.js | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

commit 411d88d232060c3d4c8093d94ce5fdcfb34476d6
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Feb 22 02:20:14 2019 +0800

    Expose Get/SetSubscriptionDispatchRate subcommands in CmdNamespaces. (#3646)

 .../pulsar/admin/cli/PulsarAdminToolTest.java      | 46 ++++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  5 ++-
 site2/docs/reference-pulsar-admin.md               | 25 ++++++++++++
 3 files changed, 75 insertions(+), 1 deletion(-)

commit 40979a43c09a270ba12bec5b38e8596451f07d4c
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 21 10:10:33 2019 -0800

    Added short blog post for 2.3.0 release (#3644)
    
    * Added short blog post for 2.3.0 release
    
    * Added mention of Debezium cdc
    
    * Fixed typos and broken sentences

 .../website/blog/2019-02-20-Apache-Pulsar-2-3-0.md | 147 +++++++++++++++++++++
 1 file changed, 147 insertions(+)

commit 64ddbbb446e1dae088f496a327e82d26b823f30e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 21 08:50:19 2019 -0800

    2.3.0 release notes (#3637)
    
    * 2.3.0 release notes
    
    * Update site2/website/release-notes.md
    
    Co-Authored-By: merlimat <mmerli@apache.org>
    
    * Update site2/website/release-notes.md
    
    Co-Authored-By: merlimat <mmerli@apache.org>
    
    * Update site2/website/release-notes.md
    
    Co-Authored-By: merlimat <mmerli@apache.org>
    
    * Added Schema.KeyValue and Flink adaptor changes

 site2/website/release-notes.md | 124 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 124 insertions(+)

commit 616167b6ad8a004408f78b28dee1ec1fd4211959
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 21 00:31:28 2019 -0800

    Fixed typo on the site build command line args (#3642)

 site2/tools/docker-build-site.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5e7483f0348f9c4253d8429505d6f023867f91d9
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 21 00:05:34 2019 -0800

    Added note on how to install `libpulsar` with brew on MacOS (#3641)

 site2/docs/client-libraries-cpp.md | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

commit 5e4283e912e545cecac8c521bc32ce39f837056f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 20 22:12:48 2019 -0800

    Added link to get individual connectors on download page (#3635)

 site2/docs/io-quickstart.md        | 35 ++++++---------
 site2/website/data/connectors.js   | 92 ++++++++++++++++++++++++++++++++++++++
 site2/website/pages/en/download.js | 70 +++++++++++++++++++++++++++++
 3 files changed, 176 insertions(+), 21 deletions(-)

commit 6e54f89345af6afa62f604436f9dd05bf6d73955
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 20 21:32:15 2019 -0800

    Fixed the building of javadoc/doxygen/pydoc on site2 build (#3639)

 pulsar-client-cpp/Doxyfile                       |  2 +-
 site2/tools/docker-build-site.sh                 |  2 +-
 {site/scripts => site2/tools}/doxygen-doc-gen.sh |  7 ++++--
 site2/tools/generate-api-docs.sh                 | 31 ++++++++++++++++++++++++
 {site/scripts => site2/tools}/javadoc-gen.sh     |  9 ++++---
 {site/scripts => site2/tools}/publish-website.sh |  0
 {site/scripts => site2/tools}/python-doc-gen.sh  |  2 +-
 7 files changed, 44 insertions(+), 9 deletions(-)

commit c31ccd1a0f532cb68da36ca41695f09dd348b3d6
Author: cckellogg <cckellogg@gmail.com>
Date:   Wed Feb 20 14:32:34 2019 -0800

    Fix stackoverflow issue with java function window context. (#3621)
    
    * Fix stackoverflow issue with java function window context.
    
    * Remove unused import.
    
    * Fix more recursive calls.
    
    * Fix interface to match function context interface.

 .../main/java/org/apache/pulsar/functions/api/WindowContext.java | 7 ++++---
 .../org/apache/pulsar/functions/windowing/WindowContextImpl.java | 9 +++++----
 2 files changed, 9 insertions(+), 7 deletions(-)

commit 12053577d4cd9b8a2cb4c583c24e638749b78f97
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 20 13:56:45 2019 -0800

    Website for 2.3.0 (#3634)

 site2/website/releases.json                        |    1 +
 .../versioned_docs/version-2.3.0/adaptors-kafka.md |  264 +++
 .../versioned_docs/version-2.3.0/adaptors-storm.md |   91 +
 .../version-2.3.0/admin-api-namespaces.md          |  643 ++++++
 .../version-2.3.0/administration-proxy.md          |  104 +
 .../version-2.3.0/administration-zk-bk.md          |  324 +++
 .../version-2.3.0/client-libraries-cpp.md          |  184 ++
 .../version-2.3.0/client-libraries-go.md           |  463 ++++
 .../version-2.3.0/client-libraries-python.md       |  239 +++
 .../version-2.3.0/concepts-messaging.md            |  326 +++
 .../version-2.3.0/concepts-overview.md             |   32 +
 .../version-2.3.0/cookbooks-bookkeepermetadata.md  |   21 +
 .../version-2.3.0/cookbooks-retention-expiry.md    |  285 +++
 .../version-2.3.0/deploy-bare-metal.md             |  442 ++++
 .../version-2.3.0/deploy-monitoring.md             |   98 +
 .../version-2.3.0/functions-deploying.md           |  229 ++
 .../version-2.3.0/functions-quickstart.md          |  337 +++
 .../version-2.3.0/getting-started-standalone.md    |  244 +++
 .../versioned_docs/version-2.3.0/io-connectors.md  |   22 +
 .../versioned_docs/version-2.3.0/io-hbase.md       |   28 +
 .../versioned_docs/version-2.3.0/io-kafka.md       |   45 +
 .../versioned_docs/version-2.3.0/io-netty.md       |   21 +
 .../version-2.3.0/reference-cli-tools.md           |  597 ++++++
 .../version-2.3.0/reference-configuration.md       |  481 +++++
 .../version-2.3.0/reference-pulsar-admin.md        | 2225 ++++++++++++++++++++
 .../version-2.3.0/reference-terminology.md         |  162 ++
 .../version-2.3.0/security-authorization.md        |  100 +
 .../versioned_docs/version-2.3.0/sql-overview.md   |   25 +
 .../versioned_sidebars/version-2.3.0-sidebars.json |  125 ++
 site2/website/versions.json                        |    1 +
 30 files changed, 8159 insertions(+)

commit 2d3d81a094af74e08baa34a6ef657d6cc4200725
Author: Grant Wu <grantwwu@gmail.com>
Date:   Wed Feb 20 15:15:23 2019 -0500

    Clarify apt install instructions (#3632)

 site2/docs/client-libraries-cpp.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4de22cdb83a667a3029114cf763108f7a3238331
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Feb 20 09:48:50 2019 -0800

    Pulsar Startup Script fixes to provide custom conf files for bookie shell and configuration store. (#3627)

 bin/pulsar    | 1 -
 conf/bkenv.sh | 2 +-
 2 files changed, 1 insertion(+), 2 deletions(-)

commit d1fefadb374713e229594ab9874487a5fa0c9572
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Feb 20 09:27:56 2019 -0800

    Support graceful shutdown Kubernetes (#3628)
    
    * allow for graceful shutdown when running functions in kubernetes
    
    * cleaning up
    
    * fix unit tests

 .../pulsar/functions/runtime/JavaInstanceMain.java |  6 +-
 .../functions/runtime/KubernetesRuntime.java       | 53 ++++++++------
 .../pulsar/functions/runtime/ProcessRuntime.java   |  6 +-
 .../pulsar/functions/runtime/RuntimeUtils.java     | 83 ++++++++++++++++------
 .../functions/runtime/KubernetesRuntimeTest.java   | 30 ++++----
 5 files changed, 110 insertions(+), 68 deletions(-)

commit 2fd283e9e0a583bc8631b77af44df6f21480eaf1
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Feb 20 09:24:35 2019 -0800

    set functions config to me uniform (#3629)

 .../org/apache/pulsar/functions/instance/ContextImpl.java   | 13 +++++++++++++
 .../java/org/apache/pulsar/functions/sink/PulsarSink.java   |  2 +-
 2 files changed, 14 insertions(+), 1 deletion(-)

commit ce2d21c0d41418ebd97282b6b38ed07c6ba2a341
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 20 06:31:54 2019 -0800

    Remove duplicated `pushd` in stage-release.sh (#3607)

 src/stage-release.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5db6bced5f3771e9fe445ef262bd1b106e2ab5f2
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 20 06:31:36 2019 -0800

    Link wwrapper with pytho libs on MacOS (#3626)

 pulsar-client-cpp/python/CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 26c462625483ef0e0fa3c74bca6e84a3f569115b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 20 04:05:25 2019 -0800

    Refactored handling of zero-queue consumer into separate subclass (#3615)
    
    ### Motivation
    
    Simplified `ConsumerImpl` code by factoring out a bunch of if/else statements into a specialized subclass implementation.

 .../apache/pulsar/client/impl/ConsumerImpl.java    | 220 ++++++---------------
 .../client/impl/MultiTopicsConsumerImpl.java       |  16 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   5 +-
 .../pulsar/client/impl/ZeroQueueConsumerImpl.java  | 187 ++++++++++++++++++
 .../pulsar/client/impl/ConsumerImplTest.java       |   5 +-
 5 files changed, 266 insertions(+), 167 deletions(-)

commit 8bd06d2801482b0b0864f16ca3ef79dd2e08abff
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Feb 20 20:04:49 2019 +0800

    Minor improvement of CmdNamespaces and add the missing subcommands in Pulsar Admin CLI md (#3620)
    
    ### Motivation
    
    Pulsar Admin CLI doc minor improvement of `namespaces`.
    
    ### Modifications
    
    Some minor changes in `CmdNamespaces` and add descriptions for the missing subcommands in `pulsar-admin namespaces` CLI md.

 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  23 +-
 site2/docs/reference-pulsar-admin.md               | 380 ++++++++++++++++++---
 2 files changed, 348 insertions(+), 55 deletions(-)

commit 2e1e1abbcd8a347d857f8b36acf52c44d0f711d6
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 19 18:42:50 2019 -0800

    Use default queue size in function producer (#3619)
    
    * Use default queue size in function producer
    
    * Fixed queue size

 pulsar-functions/instance/src/main/python/contextimpl.py     | 5 ++---
 pulsar-functions/instance/src/main/python/python_instance.py | 4 ++--
 2 files changed, 4 insertions(+), 5 deletions(-)

commit 84c68c335c22910dc7c604169a69b37d56cf841b
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Feb 19 14:01:31 2019 +0800

    [Issue 3590] [broker] Support to get broker server runtime configuration (#3606)
    
    * Support to get broker server runtime configuration.
    
    * Add super-user check and sort the list result
    
    * Return a Map instead of List

 .../pulsar/broker/admin/impl/BrokersBase.java      |  9 ++++++++
 .../pulsar/broker/service/BrokerService.java       | 25 ++++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Brokers.java    |  8 +++++++
 .../pulsar/client/admin/internal/BrokersImpl.java  | 10 +++++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  9 ++++++++
 .../org/apache/pulsar/admin/cli/CmdBrokers.java    | 10 +++++++++
 site2/docs/reference-pulsar-admin.md               |  9 ++++++++
 7 files changed, 80 insertions(+)

commit 57daf4e0646b901ee98fca5513ca54326734ac1b
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 18 19:41:56 2019 -0800

    Fixed C++ batch acks tracker to evict message from sendList array (#3618)
    
    * Fixed C++ batch acks tracker to evict message from sendList array
    
    * Fixed formatting

 pulsar-client-cpp/lib/BatchAcknowledgementTracker.cc | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

commit a0f7661dd32222beccb0185549bad3f5923b7cb8
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Mon Feb 18 14:53:14 2019 -0800

    Refresh Certs every X minutes (#3568)

 .../apache/pulsar/broker/ServiceConfiguration.java |  5 ++
 .../broker/service/PulsarChannelInitializer.java   | 28 +++----
 .../client/impl/auth/AuthenticationDataTls.java    | 37 +++++++--
 .../pulsar/client/impl/auth/AuthenticationTls.java |  2 +-
 .../common/util/ClientSslContextRefresher.java     | 68 +++++++++++++++++
 .../common/util/FileModifiedTimeUpdater.java       | 65 ++++++++++++++++
 .../common/util/ServerSslContextRefresher.java     | 87 ++++++++++++++++++++++
 .../common/util/FileModifiedTimeUpdaterTest.java   | 68 +++++++++++++++++
 .../pulsar/discovery/service/DiscoveryService.java | 20 +++--
 .../service/ServiceChannelInitializer.java         | 26 ++++---
 .../discovery/service/server/ServiceConfig.java    | 10 +++
 .../discovery/service/DiscoveryServiceTest.java    |  5 --
 .../pulsar/proxy/server/ProxyConfiguration.java    | 11 ++-
 .../proxy/server/ServiceChannelInitializer.java    | 48 ++++++------
 14 files changed, 404 insertions(+), 76 deletions(-)

commit 384fca322dfad123b6bb6a09c0328fc83219484f
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 18 07:06:15 2019 -0800

    Define the maven phase for generating protobuf code (#3609)

 managed-ledger/pom.xml         | 2 +-
 pulsar-broker/pom.xml          | 1 +
 pulsar-client/pom.xml          | 1 +
 pulsar-functions/proto/pom.xml | 1 +
 4 files changed, 4 insertions(+), 1 deletion(-)

commit bca09b0d8609e5aba7584f566f113feb1e77b4fb
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Feb 17 08:48:09 2019 -0800

    Added ability to specify consumer queue size for function input topics (#3608)
    
    * Added ability to specify consumer queue size for function input topics
    
    * fix and update PR

 .../pulsar/common/functions/ConsumerConfig.java    |   1 +
 .../functions/instance/JavaInstanceRunnable.java   |   3 +
 .../pulsar/functions/source/PulsarSource.java      |   6 +-
 .../instance/src/main/python/Function_pb2.py       | 180 ++++++++++++++++++---
 .../instance/src/main/python/python_instance.py    |  25 +--
 .../proto/src/main/proto/Function.proto            |   4 +
 .../functions/utils/FunctionConfigUtils.java       |  17 ++
 7 files changed, 201 insertions(+), 35 deletions(-)

commit a378ac29d3212277b63981f6bbd71cf82f7f2dbb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Feb 16 23:03:42 2019 -0800

    fix bug in kubenetes runtime (#3617)

 .../java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f25939fdc86b1100f34b352c72636316b2945056
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Feb 16 17:52:36 2019 -0800

    adding memory padding to memory limits set in Kubernetes (#3616)
    
    * adding memory padding to memory limits set in kubernetes
    
    * cleaning up

 conf/functions_worker.yml                          |  2 +
 .../functions/runtime/KubernetesRuntime.java       | 17 ++++-
 .../runtime/KubernetesRuntimeFactory.java          |  6 +-
 .../runtime/KubernetesRuntimeFactoryTest.java      |  3 +-
 .../functions/runtime/KubernetesRuntimeTest.java   | 77 ++++++++++++++++++----
 .../functions/worker/FunctionRuntimeManager.java   |  1 +
 .../pulsar/functions/worker/WorkerConfig.java      |  5 ++
 7 files changed, 93 insertions(+), 18 deletions(-)

commit 924f49513cc6990d02495d5cdb976dd55e784c82
Author: Richard Yu <yohan.richard.yu@gmail.com>
Date:   Sat Feb 16 01:09:07 2019 -0800

    Adding configuration to disable auto-topic creation (#3450)
    
    Master Issue: #3436

 .../org/apache/pulsar/broker/ServiceConfiguration.java     |  6 +++++-
 .../main/java/org/apache/pulsar/broker/PulsarService.java  |  1 +
 .../pulsar/broker/admin/impl/PersistentTopicsBase.java     | 12 ++++++++++--
 .../org/apache/pulsar/broker/service/BrokerService.java    |  9 +++++----
 .../apache/pulsar/broker/admin/PersistentTopicsTest.java   | 14 +++++++++++++-
 5 files changed, 34 insertions(+), 8 deletions(-)

commit e183abae252c74679fa820901d00c22731ebde8a
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Feb 15 16:39:59 2019 -0800

    CPP Client - changing min cmake to 3.4 and adding flag for ccache (#3610)

 pulsar-client-cpp/CMakeLists.txt | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 8a714ad26da8f51c4fe2f8fcb35f463585247934
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Feb 15 15:45:57 2019 -0800

    fix: add retry and wait for kubernetes creation/deletion (#3603)
    
    * fix: add retry and wait for kubernetes creation/deletion
    
    * cleaning up
    
    * adding retry logic for cleaning up subscriptions
    
    * adjust number of retries
    
    * correcting namespace

 .../functions/runtime/KubernetesRuntime.java       | 419 ++++++++++++++++-----
 .../pulsar/functions/runtime/RuntimeUtils.java     | 114 +++++-
 .../pulsar/functions/runtime/RuntimeUtilsTest.java | 162 ++++++++
 .../pulsar/functions/worker/FunctionActioner.java  | 134 ++++---
 4 files changed, 694 insertions(+), 135 deletions(-)

commit 53ba1a41d05642437efce414d11969345906d35f
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 15 12:16:36 2019 -0800

    Bumped version to 2.4.0-SNAPSHOT (#3604)

 buildtools/pom.xml                                            | 2 +-
 dashboard/pom.xml                                             | 2 +-
 distribution/io/pom.xml                                       | 2 +-
 distribution/offloaders/pom.xml                               | 2 +-
 distribution/pom.xml                                          | 2 +-
 distribution/server/pom.xml                                   | 2 +-
 docker/grafana/pom.xml                                        | 2 +-
 docker/pom.xml                                                | 2 +-
 docker/pulsar-all/pom.xml                                     | 2 +-
 docker/pulsar-standalone/pom.xml                              | 2 +-
 docker/pulsar/pom.xml                                         | 2 +-
 examples/flink/pom.xml                                        | 2 +-
 examples/pom.xml                                              | 2 +-
 jclouds-shaded/pom.xml                                        | 2 +-
 managed-ledger-shaded/pom.xml                                 | 2 +-
 managed-ledger/pom.xml                                        | 2 +-
 pom.xml                                                       | 2 +-
 protobuf-shaded/pom.xml                                       | 2 +-
 pulsar-broker-auth-athenz/pom.xml                             | 2 +-
 pulsar-broker-common/pom.xml                                  | 2 +-
 pulsar-broker-shaded/pom.xml                                  | 2 +-
 pulsar-broker/pom.xml                                         | 2 +-
 pulsar-client-1x-base/pom.xml                                 | 2 +-
 pulsar-client-1x-base/pulsar-client-1x/pom.xml                | 2 +-
 pulsar-client-1x-base/pulsar-client-2x-shaded/pom.xml         | 2 +-
 pulsar-client-admin-shaded/pom.xml                            | 2 +-
 pulsar-client-admin/pom.xml                                   | 2 +-
 pulsar-client-api/pom.xml                                     | 2 +-
 pulsar-client-auth-athenz/pom.xml                             | 2 +-
 pulsar-client-kafka-compat/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml  | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml        | 2 +-
 pulsar-client-shaded/pom.xml                                  | 2 +-
 pulsar-client-tools-test/pom.xml                              | 2 +-
 pulsar-client-tools/pom.xml                                   | 2 +-
 pulsar-client/pom.xml                                         | 2 +-
 pulsar-common/pom.xml                                         | 2 +-
 pulsar-discovery-service/pom.xml                              | 2 +-
 pulsar-flink/pom.xml                                          | 2 +-
 pulsar-functions/api-java/pom.xml                             | 2 +-
 pulsar-functions/instance/pom.xml                             | 2 +-
 pulsar-functions/java-examples/pom.xml                        | 2 +-
 pulsar-functions/pom.xml                                      | 2 +-
 pulsar-functions/proto/pom.xml                                | 2 +-
 pulsar-functions/runtime-all/pom.xml                          | 2 +-
 pulsar-functions/runtime/pom.xml                              | 2 +-
 pulsar-functions/secrets/pom.xml                              | 2 +-
 pulsar-functions/utils/pom.xml                                | 2 +-
 pulsar-functions/windowing/pom.xml                            | 2 +-
 pulsar-functions/worker/pom.xml                               | 2 +-
 pulsar-io/aerospike/pom.xml                                   | 2 +-
 pulsar-io/canal/pom.xml                                       | 2 +-
 pulsar-io/cassandra/pom.xml                                   | 2 +-
 pulsar-io/core/pom.xml                                        | 2 +-
 pulsar-io/data-generator/pom.xml                              | 2 +-
 pulsar-io/debezium/pom.xml                                    | 2 +-
 pulsar-io/docs/pom.xml                                        | 2 +-
 pulsar-io/elastic-search/pom.xml                              | 2 +-
 pulsar-io/file/pom.xml                                        | 2 +-
 pulsar-io/hbase/pom.xml                                       | 2 +-
 pulsar-io/hdfs2/pom.xml                                       | 2 +-
 pulsar-io/hdfs3/pom.xml                                       | 2 +-
 pulsar-io/jdbc/pom.xml                                        | 2 +-
 pulsar-io/kafka-connect-adaptor/pom.xml                       | 2 +-
 pulsar-io/kafka/pom.xml                                       | 2 +-
 pulsar-io/kinesis/pom.xml                                     | 2 +-
 pulsar-io/mongo/pom.xml                                       | 2 +-
 pulsar-io/netty/pom.xml                                       | 2 +-
 pulsar-io/pom.xml                                             | 2 +-
 pulsar-io/rabbitmq/pom.xml                                    | 2 +-
 pulsar-io/twitter/pom.xml                                     | 2 +-
 pulsar-log4j2-appender/pom.xml                                | 2 +-
 pulsar-proxy/pom.xml                                          | 2 +-
 pulsar-spark/pom.xml                                          | 2 +-
 pulsar-sql/pom.xml                                            | 2 +-
 pulsar-sql/presto-distribution/pom.xml                        | 2 +-
 pulsar-sql/presto-pulsar-plugin/pom.xml                       | 2 +-
 pulsar-sql/presto-pulsar/pom.xml                              | 2 +-
 pulsar-storm/pom.xml                                          | 2 +-
 pulsar-testclient/pom.xml                                     | 2 +-
 pulsar-websocket/pom.xml                                      | 2 +-
 pulsar-zookeeper-utils/pom.xml                                | 2 +-
 pulsar-zookeeper/pom.xml                                      | 2 +-
 tests/bc_2_0_0/pom.xml                                        | 2 +-
 tests/bc_2_0_1/pom.xml                                        | 2 +-
 tests/docker-images/latest-version-image/pom.xml              | 2 +-
 tests/docker-images/pom.xml                                   | 2 +-
 tests/integration/pom.xml                                     | 2 +-
 tests/pom.xml                                                 | 2 +-
 tests/pulsar-kafka-compat-client-test/pom.xml                 | 2 +-
 tests/pulsar-spark-test/pom.xml                               | 2 +-
 tests/pulsar-storm-test/pom.xml                               | 2 +-
 tiered-storage/jcloud/pom.xml                                 | 2 +-
 tiered-storage/pom.xml                                        | 2 +-
 95 files changed, 95 insertions(+), 95 deletions(-)

commit 3ea2c77737dad164c6f944597112ae9f492bfe1e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 14 21:14:42 2019 -0800

    Fixed RAT check to exclude Avro generated files (#3598)
    
    ### Motivation
    
    Fixes the Apache RAT check to exclude the auto-generated files from Avro compiler and Avro JSON schema definitions.

 pom.xml                                                |  7 +++++++
 .../main/resources/META-INF/services/pulsar-io.yaml    | 18 ++++++++++++++++++
 2 files changed, 25 insertions(+)

commit cf4452577122a040893cf5f3fb10caf7a9a087be
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 14 21:13:58 2019 -0800

    Fixed CMake lookup of boost Python for Py 3.4, 3.5 and 3.6 (#3599)
    
    ### Motivation
    
    Building Python wheels is failing in the updated Docker image for Python 3.4, 3.5 and 3.6. Fixing it here by explicitly including the library defined variables.

 pulsar-client-cpp/python/CMakeLists.txt | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 0a6fa4b18cd34a455bbe0b69f70888bd466a6d65
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 14 14:27:06 2019 -0800

    Distribute Pulsar IO connectors individually (#3601)

 distribution/io/pom.xml             |  3 +-
 distribution/io/src/assemble/io.xml | 98 ++++++++++---------------------------
 docker/pulsar-all/Dockerfile        |  5 +-
 docker/pulsar-all/pom.xml           | 31 +++++++-----
 src/stage-release.sh                |  7 +--
 5 files changed, 52 insertions(+), 92 deletions(-)

commit 6fba72cc66aedfb3cdab11a76fff7994052569bf
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Feb 14 22:08:34 2019 +0800

    Add several missing subcommands in Pulsar Admin CLI md. (#3596)

 site2/docs/reference-pulsar-admin.md | 132 ++++++++++++++++++++++++++++++++++-
 1 file changed, 131 insertions(+), 1 deletion(-)

commit e395efc9129fac9c4bcacd37594735ca5414233f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 13 21:36:57 2019 -0800

    Fixed deadlock by triggering asyncCreateFullPathOptimistic() callback in different thread (#3591)

 .../bookkeeper/mledger/impl/MetaStoreImplZookeeper.java   | 15 +++++++++------
 .../mledger/impl/MetaStoreImplZookeeperTest.java          | 15 +++++++++------
 2 files changed, 18 insertions(+), 12 deletions(-)

commit 01f0d350121581f21121d7e01b11118dc7021968
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 13 20:03:01 2019 -0800

    Fixed getting message properties map in Python client (#3595)

 pulsar-client-cpp/python/pulsar_test.py | 25 +++++++++++++++++++++++++
 pulsar-client-cpp/python/src/message.cc | 10 +++++++++-
 2 files changed, 34 insertions(+), 1 deletion(-)

commit cecf8e77f66d0ceddf726f09f4b56de2fdf1147a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 13 18:28:52 2019 -0800

    Fixed race condition in C++ test testTlsDetectPulsarSslWithHostNameValidation (#3593)
    
    ### Motivation
    
    Fixed flaky test in `AuthPluginTest.testTlsDetectPulsarSslWithHostNameValidation`. The failure
    was due to the fact that test is creating a producer asynchronously but not waiting for the
    future to be completed.

 pulsar-client-cpp/tests/AuthPluginTest.cc | 26 ++++++++++----------------
 1 file changed, 10 insertions(+), 16 deletions(-)

commit c79fd728cf27417ca117ca220dd07dc4319d4c46
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 13 17:55:59 2019 -0800

    Improved Javadocs on Java client API (#3592)

 .../pulsar/client/api/AuthenticationFactory.java   |  12 +-
 .../apache/pulsar/client/api/ClientBuilder.java    | 161 ++++++++------
 .../apache/pulsar/client/api/CompressionType.java  |   3 +
 .../org/apache/pulsar/client/api/Consumer.java     |  17 +-
 .../apache/pulsar/client/api/ConsumerBuilder.java  | 151 ++++++++++---
 .../client/api/ConsumerCryptoFailureAction.java    |  23 +-
 .../pulsar/client/api/ConsumerEventListener.java   |  10 +
 .../pulsar/client/api/ConsumerInterceptor.java     |   2 -
 .../apache/pulsar/client/api/CryptoKeyReader.java  |   3 +
 .../apache/pulsar/client/api/DeadLetterPolicy.java |  11 +
 .../pulsar/client/api/EncryptionKeyInfo.java       |  16 +-
 .../apache/pulsar/client/api/HashingScheme.java    |   2 +-
 .../java/org/apache/pulsar/client/api/Message.java |  19 +-
 .../org/apache/pulsar/client/api/MessageId.java    |  31 ++-
 .../apache/pulsar/client/api/MessageRouter.java    |   7 +
 .../org/apache/pulsar/client/api/Producer.java     |  14 +-
 .../apache/pulsar/client/api/ProducerBuilder.java  | 239 ++++++++++++++-------
 .../client/api/ProducerCryptoFailureAction.java    |  14 +-
 .../org/apache/pulsar/client/api/PulsarClient.java | 155 ++++++++++---
 .../java/org/apache/pulsar/client/api/Reader.java  |  50 ++++-
 .../apache/pulsar/client/api/ReaderBuilder.java    |  78 ++++---
 .../apache/pulsar/client/api/ReaderListener.java   |   6 +-
 .../pulsar/client/api/RegexSubscriptionMode.java   |   9 +
 .../java/org/apache/pulsar/client/api/Schema.java  |  39 ++++
 .../pulsar/client/api/ServiceUrlProvider.java      |   6 +-
 .../client/api/SubscriptionInitialPosition.java    |   5 +-
 .../apache/pulsar/client/api/SubscriptionType.java |  12 +-
 .../pulsar/client/api/TypedMessageBuilder.java     |  30 ++-
 28 files changed, 829 insertions(+), 296 deletions(-)

commit 48e4a0b52a576dfa8474ed5c6ff467797326f1c7
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 13 17:55:42 2019 -0800

    If no clusters are specified, the namespace should by default use current cluster (#3571)
    
    * If no clusters are specified, the namespace should by default use current cluster
    
    * Don't apply to v1 local namespaces
    
    * It's better to use the isV2() check instead of isGlobal()

 .../org/apache/pulsar/broker/admin/impl/NamespacesBase.java  | 10 ++++++++--
 .../java/org/apache/pulsar/broker/admin/AdminApiTest2.java   | 12 ++++++++++++
 2 files changed, 20 insertions(+), 2 deletions(-)

commit 14a596288c6d372236b46b418b8df25238410ad3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Feb 13 10:47:52 2019 -0800

    [pulsar-broker] provide option to disable redelivery-tracker to reduce in memory positionImpl footprint and gc improvement (#3584)
    
    * [pulsar-broker] provide option to disable redelivery-tracker to reduce in memory positionImpl footprint and gc improvement
    
    * change config name

 conf/broker.conf                                                   | 3 +++
 conf/standalone.conf                                               | 3 +++
 .../main/java/org/apache/pulsar/broker/ServiceConfiguration.java   | 7 +++++++
 .../service/persistent/PersistentDispatcherMultipleConsumers.java  | 7 +++++--
 site2/docs/reference-configuration.md                              | 1 +
 5 files changed, 19 insertions(+), 2 deletions(-)

commit 200d175a02638086c850c732b6bd0f285aff7f42
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Thu Feb 14 01:58:28 2019 +0800

    Add resource close in CmdBrokerStats and some minor fixes. (#3589)

 .../apache/pulsar/admin/cli/CmdBrokerStats.java    | 83 +++++++++++-----------
 site2/docs/reference-pulsar-admin.md               | 19 ++---
 2 files changed, 49 insertions(+), 53 deletions(-)

commit 43380523c5269c152f61b2aa8f7b70281c770d1d
Author: Enrico Olivelli <eolivelli@gmail.com>
Date:   Wed Feb 13 15:52:11 2019 +0100

    [Issue 3458: Tag Pulsar ledgers in order to distinguish from other leggers in the same Bookkeeper cluster (#3525)
    
    Fixes #3458
    
    ### Motivation
    
    See #3458
    
    ### Modifications
    
    Add a new LedgerMetadataUtils class which holds the logic for building "metadata" to be attached to
    
    ### Verifying this change
    
    This change is a trivial rework / code cleanup without any test coverage.

 .../mledger/impl/LedgerMetadataUtils.java          | 104 +++++++++++++++++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   5 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  20 ++--
 .../service/schema/BookkeeperSchemaStorage.java    |  17 ++--
 .../pulsar/compaction/TwoPhaseCompactor.java       |   8 +-
 site2/docs/cookbooks-bookkeepermetadata.md         |  20 ++++
 site2/website/sidebars.json                        |   3 +-
 7 files changed, 157 insertions(+), 20 deletions(-)

commit 2ed8fea94e3565ebe2ffc999412377cf920354c5
Author:  <rxl5555555@qq.com>
Date:   Wed Feb 13 21:26:43 2019 +0800

    [go client] add SubscriptionInitPos option in ConsumerOptions (#3588)
    
    * [go client] add SubscriptionInitPos option in ConsumerOptions
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add comment for SubscriptionInitPos option
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/c_consumer.go    |  4 +++
 pulsar-client-go/pulsar/consumer.go      | 14 ++++++++++
 pulsar-client-go/pulsar/consumer_test.go | 48 +++++++++++++++++++++++++++++++-
 3 files changed, 65 insertions(+), 1 deletion(-)

commit c7987d529ffc5db2ebad71964905def15eabf985
Author: Vincent Xie <vinceshieh@gmail.com>
Date:   Wed Feb 13 21:17:49 2019 +0800

    Fix broken links in spark adaptor documentations (#3587)
    
    Signed-off-by: VinceShieh <vinceshieh@gmail.com>

 site/docs/latest/adaptors/PulsarSpark.md                                | 2 +-
 site/ja/adaptors/PulsarSpark.md                                         | 2 +-
 site2/docs/adaptors-spark.md                                            | 2 +-
 site2/website/versioned_docs/version-2.1.0-incubating/adaptors-spark.md | 2 +-
 site2/website/versioned_docs/version-2.2.0/adaptors-spark.md            | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

commit 5ca75ef41e4c61d6a2dd36e29117c7be15069327
Author:  <rxl5555555@qq.com>
Date:   Wed Feb 13 13:39:18 2019 +0800

    [go client] add validation host name for ClientOptions (#3580)
    
    * [go client] add validation hostName for ClientOptions
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * [go client] add validation hostName for ClientOptions
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * rename ValidationHostName to TLSValidateHostname
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../include/pulsar/c/client_configuration.h        |  2 +-
 pulsar-client-go/pulsar/c_client.go                |  4 ++++
 pulsar-client-go/pulsar/client.go                  |  3 +++
 pulsar-client-go/pulsar/client_test.go             | 26 ++++++++++++++++++++++
 pulsar-client-go/pulsar/producer_test.go           |  1 -
 5 files changed, 34 insertions(+), 2 deletions(-)

commit f0fba94f85b1ba9785c3a6448c89af497177ad6b
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 12 20:28:10 2019 -0800

    Use python xml to parse pom for version instead of xmllint (#3562)

 docker/get-version.sh                  |  4 +---
 pulsar-client-cpp/lib/CMakeLists.txt   |  2 +-
 pulsar-client-cpp/pkg/deb/build-deb.sh |  2 +-
 pulsar-client-cpp/pkg/rpm/build-rpm.sh |  2 +-
 pulsar-client-cpp/python/setup.py      | 15 +++++++--------
 src/get-project-version.py             | 29 +++++++++++++++++++++++++++++
 src/stage-release.sh                   |  4 ++--
 7 files changed, 42 insertions(+), 16 deletions(-)

commit 06e911d4054daabca84556b80976b7e6ffa4c815
Author: Bruno Bonnin <bbonnin@gmail.com>
Date:   Wed Feb 13 02:56:20 2019 +0100

    Add a Pulsar IO MongoDB (#3561)
    
    ### Motivation
    
    Provides a builtin MongoDB Connector, in order to ease the storage of JSON formated message in MongoDB. It's a sink connector.
    
    
    ### Modifications
    
    Add a new sub-module in the `pulsar-io`module.
    
    ### Verifying this change
    
    This change added tests and can be verified as follows:
    * deploy the connector with configuration file containing the following fields:
    ```
    configs:
      mongoUri: mongodb://hostname:port
      database: pulsar
      collection: messages
    ```
    * start a mongodb instance
    * send messages in the topic declared when deploying the connector
    * check in MongoDB if the messages have been stored in the collection `messages`

 pulsar-io/mongo/pom.xml                            |  82 +++++++++
 .../org/apache/pulsar/io/mongodb/MongoConfig.java  | 109 ++++++++++++
 .../org/apache/pulsar/io/mongodb/MongoSink.java    | 182 +++++++++++++++++++
 .../org/apache/pulsar/io/mongodb/package-info.java |  19 ++
 .../resources/META-INF/services/pulsar-io.yaml     |   3 +
 .../apache/pulsar/io/mongodb/MongoConfigTest.java  |  87 +++++++++
 .../apache/pulsar/io/mongodb/MongoSinkTest.java    | 198 +++++++++++++++++++++
 .../org/apache/pulsar/io/mongodb/TestHelper.java   |  55 ++++++
 .../mongo/src/test/resources/mongoSinkConfig.yaml  |  26 +++
 pulsar-io/pom.xml                                  |   1 +
 10 files changed, 762 insertions(+)

commit 3aeafc185603a76515de1a904068806dd872a740
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 12 15:56:56 2019 -0800

    Consolidated all windowing code into its own module (#3583)
    
    * moved all windowing related code into its own submodule.
    
    * added pom

 pulsar-functions/pom.xml                           |  1 +
 pulsar-functions/windowing/pom.xml                 | 65 ++++++++++++++++++++++
 .../windowing/DefaultEvictionContext.java          |  0
 .../apache/pulsar/functions/windowing/Event.java   |  0
 .../pulsar/functions/windowing/EventImpl.java      |  0
 .../functions/windowing/EvictionContext.java       |  0
 .../pulsar/functions/windowing/EvictionPolicy.java |  0
 .../functions/windowing/TimestampExtractor.java    |  0
 .../pulsar/functions/windowing/TriggerHandler.java |  0
 .../pulsar/functions/windowing/TriggerPolicy.java  |  0
 .../pulsar/functions/windowing/WaterMarkEvent.java |  0
 .../windowing/WaterMarkEventGenerator.java         |  0
 .../apache/pulsar/functions/windowing/Window.java  |  0
 .../functions/windowing/WindowContextImpl.java     |  0
 .../windowing/WindowFunctionExecutor.java          |  0
 .../pulsar/functions/windowing/WindowImpl.java     |  0
 .../windowing/WindowLifecycleListener.java         |  0
 .../pulsar/functions/windowing/WindowManager.java  |  0
 .../pulsar/functions/windowing/WindowUtils.java    |  0
 .../windowing/evictors/CountEvictionPolicy.java    |  0
 .../windowing/evictors/TimeEvictionPolicy.java     |  0
 .../evictors/WatermarkCountEvictionPolicy.java     |  0
 .../evictors/WatermarkTimeEvictionPolicy.java      |  0
 .../windowing/triggers/CountTriggerPolicy.java     |  0
 .../windowing/triggers/TimeTriggerPolicy.java      |  0
 .../triggers/WatermarkCountTriggerPolicy.java      |  0
 .../triggers/WatermarkTimeTriggerPolicy.java       |  0
 .../windowing/WaterMarkEventGeneratorTest.java     |  0
 .../windowing/WindowFunctionExecutorTest.java      |  0
 .../functions/windowing/WindowManagerTest.java     |  0
 30 files changed, 66 insertions(+)

commit 285d16ebe00bfdb5d131b57134d76e5181849164
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 12 15:50:06 2019 -0800

    Fixed C++ client hostname verification (#3582)

 pulsar-client-cpp/lib/ClientConnection.cc |  8 ++++++++
 pulsar-client-cpp/lib/ConnectionPool.cc   | 24 ------------------------
 2 files changed, 8 insertions(+), 24 deletions(-)

commit c000ad46bf60abe9c665bdd45d0ba878307b49d1
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Wed Feb 13 07:07:07 2019 +0800

    Support CLI pulsar-admin subcommands for concise description. (#3579)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdBase.java             | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit d0a3d5f328cee22501b90389977a39d3a71f99cb
Author:  <rxl5555555@qq.com>
Date:   Wed Feb 13 04:43:57 2019 +0800

    [cpp-client] add SubscriptionInitialPosition option in ConsumerConfiguration  #3494 (#3567)
    
    * [cpp-client] add multi topic for consumer #3494
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * use initial_position instead to multi-topics
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 .../include/pulsar/ConsumerConfiguration.h         |  4 ++
 pulsar-client-cpp/include/pulsar/InitialPosition.h | 31 +++++++++++++
 .../include/pulsar/c/consumer_configuration.h      | 19 ++++++++
 pulsar-client-cpp/lib/Commands.cc                  |  4 +-
 pulsar-client-cpp/lib/Commands.h                   |  3 +-
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |  8 ++++
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |  2 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              | 17 ++++++--
 pulsar-client-cpp/lib/ConsumerImpl.h               |  1 +
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc | 11 +++++
 .../tests/ConsumerConfigurationTest.cc             | 51 +++++++++++++++++++++-
 11 files changed, 145 insertions(+), 6 deletions(-)

commit ae239069bfb5dcb976087b8f80b05bc6e757313c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Feb 11 18:50:53 2019 -0800

    [pulsar-broker]Fix: Topic loaded by multiple brokers (#3574)

 .../java/org/apache/pulsar/broker/service/BrokerService.java  |  2 +-
 .../broker/service/nonpersistent/NonPersistentTopic.java      |  9 +++++++++
 .../pulsar/broker/service/persistent/PersistentTopic.java     | 11 ++++++++++-
 3 files changed, 20 insertions(+), 2 deletions(-)

commit 37224b332f62bc8dfd6de3272aa6a28e7462bf2c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 11 18:50:30 2019 -0800

    Add configuration to enabled BK sticky reads (#3569)

 conf/broker.conf                                                     | 5 +++++
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java | 5 +++++
 .../java/org/apache/pulsar/broker/BookKeeperClientFactoryImpl.java   | 1 +
 .../main/java/org/apache/pulsar/sql/presto/PulsarConnectorCache.java | 1 +
 .../main/java/org/apache/pulsar/sql/presto/PulsarSplitManager.java   | 1 +
 site2/docs/reference-configuration.md                                | 1 +
 6 files changed, 14 insertions(+)

commit 4ec98d83a37f518fcb97ffb2f1e69c6296d01e1c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 11 16:28:37 2019 -0800

    Auto-configure managed ledger cache size based on JVM available mem (#3573)

 conf/broker.conf                                          |  4 ++--
 conf/standalone.conf                                      |  4 ++--
 .../org/apache/pulsar/broker/ServiceConfiguration.java    | 15 +++++++++------
 .../configuration/PulsarConfigurationLoaderTest.java      |  4 ++++
 site2/docs/reference-configuration.md                     |  2 +-
 5 files changed, 18 insertions(+), 11 deletions(-)

commit f825b549977fb14539a19623453ef00b37914c20
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 11 09:10:23 2019 -0800

    Added docs for using schema in Python client lib (#3511)
    
    * Added docs for using schema in Python client lib
    
    * Added info on required fields

 site2/docs/client-libraries-python.md | 148 +++++++++++++++++++++++++++++++++-
 1 file changed, 146 insertions(+), 2 deletions(-)

commit 986ea8b6eaa7b16bda5d5f89db25a2aa5bf47a12
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Mon Feb 11 17:57:28 2019 +0800

    Add a unit test for KafkaAbstractSink. (#3564)
    
    ### Motivation
    Add a unit test for KafkaAbstractSink to check valid configs.
    
    ### Modifications
    Add KafkaAbstractSinkTest.

 .../io/kafka/sink/KafkaAbstractSinkTest.java       | 168 +++++++++++++++++++++
 .../kafka/src/test/resources/kafkaSinkConfig.yaml  |  30 ++++
 2 files changed, 198 insertions(+)

commit 21b8c9d598f72247daae11eccead26146c39660b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Feb 11 17:53:46 2019 +0800

    [functions][state] Python state support (#2714)
    
    *Motivation*
    
    Add state support in python functions
    
    *Changes*
    
    - Bump bookkeeper version, so the table service has the changes to support python functions
    - Add state to python function

 .../python/pulsar/functions/context.py             |  20 ++
 pulsar-client-cpp/python/setup.py                  |   6 +-
 .../instance/src/main/python/contextimpl.py        |  15 +-
 .../instance/src/main/python/python_instance.py    |  30 ++-
 .../src/main/python/python_instance_main.py        |  12 +-
 .../instance/src/main/python/state_context.py      | 156 +++++++++++++
 .../src/test/python/test_python_instance.py        |   2 +-
 .../python-examples/wordcount_function.py          |  34 +++
 .../pulsar/functions/runtime/RuntimeUtils.java     |   3 +-
 .../functions/runtime/KubernetesRuntimeTest.java   |   3 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   6 +-
 .../integration/functions/PulsarStateTest.java     | 246 +++++++++++++++++++++
 .../topologies/PulsarStandaloneTestBase.java       |   3 +-
 13 files changed, 522 insertions(+), 14 deletions(-)

commit bfcc7c7e7ae57b651e8b21fee54e3e7cd529826c
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Feb 10 19:46:28 2019 -0800

    Link to protobuf-lite library in C++ client (#3563)

 pulsar-client-cpp/CMakeLists.txt | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 894146af259de25390906c0ae34e89451d55306a
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Feb 10 19:45:36 2019 -0800

    In PulsarKafkaProducer use flush() from pulsar API (#3549)

 .../clients/producer/PulsarKafkaProducer.java      | 23 ++++++----------------
 1 file changed, 6 insertions(+), 17 deletions(-)

commit 1b44aaa78743f8dce68ffe31c25619123c9a5a5f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Feb 10 21:33:49 2019 +0800

    [bookkeeper] bump bookkeeper version to 4.9.0 (#2906)
    
    *Motivation*
    
    This change was part of #2714. Moving it out as a separate change to make reviews easier.
    
    *Changes*
    
    Bump bookkeeper version to 4.9.0

 distribution/server/src/assemble/LICENSE.bin.txt   | 83 ++++++++++++----------
 distribution/server/src/assemble/NOTICE.bin.txt    | 15 ++++
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |  7 +-
 .../bookkeeper/client/PulsarMockBookKeeper.java    |  7 +-
 .../bookkeeper/client/PulsarMockLedgerHandle.java  | 29 +++++++-
 .../mledger/impl/ManagedLedgerBkTest.java          |  6 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  1 -
 .../mledger/impl/OffloadPrefixReadTest.java        | 25 ++++++-
 .../bookkeeper/test/BookKeeperClusterTestCase.java | 10 ++-
 pom.xml                                            | 62 +++++++++++++---
 .../org/apache/pulsar/PulsarBrokerStarter.java     |  2 +-
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |  3 +
 .../pulsar/compaction/TwoPhaseCompactor.java       |  3 +-
 .../broker/auth/SameThreadOrderedSafeExecutor.java | 11 ++-
 .../pulsar/compaction/CompactedTopicTest.java      |  1 -
 pulsar-functions/instance/pom.xml                  | 12 ++++
 pulsar-functions/runtime-all/pom.xml               | 10 +++
 pulsar-functions/runtime/pom.xml                   |  5 --
 pulsar-zookeeper-utils/pom.xml                     | 12 ++++
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |  6 +-
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java | 22 +++---
 src/check-binary-license                           |  3 +
 .../offload/jcloud/impl/OffloadIndexBlockImpl.java | 22 +++++-
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  |  6 --
 .../offload/jcloud/impl/OffloadIndexTest.java      | 31 ++------
 25 files changed, 274 insertions(+), 120 deletions(-)

commit 00c71e27d75c4e43548c98104e5630f88ef7a923
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Feb 9 23:10:23 2019 -0800

    [pulsar-broker][replicator] add remote cluster name in producer name (#3553)
    
    * [pulsar-broker][replicator] add remote cluster name in producer name
    
    * add padding between remote and local cluster-names
    
    * broker-producer can parse remote-cluster name in producer-name

 .../main/java/org/apache/pulsar/broker/service/AbstractReplicator.java | 1 +
 .../src/main/java/org/apache/pulsar/broker/service/Producer.java       | 3 ++-
 2 files changed, 3 insertions(+), 1 deletion(-)

commit f11e99454644df97d0aa869256204c0b60508396
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Feb 10 00:33:23 2019 +0800

    Remove two unused shaded modules (#3559)
    
    *Motivation*
    
    There are a few shaded modules introduced when functions was introduced.
    They are not needed anymore. We should remove them.
    
    *Modifications*
    
    Remote those unused modules.

 pulsar-functions/pom.xml                |   2 -
 pulsar-functions/proto-shaded/pom.xml   |  86 ----------------
 pulsar-functions/runtime-shaded/pom.xml | 176 --------------------------------
 3 files changed, 264 deletions(-)

commit f22bbeafec45290cc15ad2935e9ebd32d119b8af
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sun Feb 10 01:06:06 2019 +0900

    Create SSL context in constructor of ChannelInitializer (#3550)
    
    * Create SSL context in constructor of ChannelInitializer
    
    * Set TLS ports only in tests that need to enable TLS

 .../broker/service/PulsarChannelInitializer.java   | 23 +++----
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  2 +
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   |  2 +
 .../broker/admin/BrokerAdminClientTlsAuthTest.java |  2 +
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  2 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  2 -
 .../pulsar/broker/service/BrokerServiceTest.java   |  8 +++
 .../api/AuthenticatedProducerConsumerTest.java     |  2 +
 .../AuthenticationTlsHostnameVerificationTest.java |  4 ++
 .../pulsar/client/api/BrokerServiceLookupTest.java | 14 ++--
 .../pulsar/client/api/ServiceUrlProviderTest.java  |  2 -
 .../pulsar/client/api/TlsProducerConsumerBase.java |  2 +
 .../apache/pulsar/client/impl/ConnectionPool.java  | 49 ++++----------
 .../client/impl/PulsarChannelInitializer.java      | 74 ++++++++++++++++++++++
 .../service/ServiceChannelInitializer.java         | 26 ++++----
 pulsar-proxy/pom.xml                               |  5 ++
 .../pulsar/proxy/server/DirectProxyHandler.java    | 20 ++----
 .../pulsar/proxy/server/ProxyConnection.java       |  9 +--
 .../pulsar/proxy/server/ProxyConnectionPool.java   |  5 +-
 .../proxy/server/ServiceChannelInitializer.java    | 55 ++++++++++++----
 .../proxy/server/AuthedAdminProxyHandlerTest.java  |  2 +
 .../ProxyAuthenticatedProducerConsumerTest.java    |  2 +
 .../server/ProxyWithAuthorizationNegTest.java      |  2 +
 .../proxy/server/ProxyWithAuthorizationTest.java   | 10 ++-
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  2 +
 .../SuperUserAuthedAdminProxyHandlerTest.java      |  2 +
 26 files changed, 219 insertions(+), 109 deletions(-)

commit 18312dae238811ed271710253c1899124957f211
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 9 04:06:55 2019 -0800

    Replace JsonCPP lib with boost::property_tree (#3528)
    
    ### Motivation
    
    Remove compile and link dependency on JsonCPP. Instead use boost::property_tree with JSON parser. This will not require a link time dependency.

 pulsar-client-cpp/CMakeLists.txt               | 17 -------
 pulsar-client-cpp/lib/HTTPLookupService.cc     | 65 +++++++++++++++++---------
 pulsar-client-cpp/lib/HTTPLookupService.h      | 10 +---
 pulsar-client-cpp/lib/auth/AuthAthenz.cc       | 24 ++++++----
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 21 +++++----
 5 files changed, 71 insertions(+), 66 deletions(-)

commit 9140e3f8667c003a1e780e37bd2bb55db4692e55
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Feb 9 15:40:05 2019 +0800

    [tests] Allow configure integration test suite file using system property (#3558)
    
    *Motivation*
    
    Sometimes users would like to only execute a set of test suite in command line.
    
    *Modifications*
    
    Make the suite file name configurable in the pom file.
    So people can run a specific test suite using
    ```
    mvn -pl tests/integration -DredirectTestOutputToFile=false -DintegrationTestSuiteFile=pulsar-thread-suite.xml clean test -PintegrationTests
    ```
    
    Also categorize the tests info a few test suites. This would allow us break down
    the integration test job into multiple smaller test jobs.

 tests/integration/pom.xml                          |  6 ++++-
 .../src/test/resources/pulsar-cli-suite.xml        | 28 ++++++++++++++++++++
 .../integration/src/test/resources/pulsar-cli.xml  | 30 ++++++++++++++++++++++
 .../src/test/resources/pulsar-process-suite.xml    | 28 ++++++++++++++++++++
 .../src/test/resources/pulsar-process.xml          |  8 ++----
 .../src/test/resources/pulsar-sql-suite.xml        | 28 ++++++++++++++++++++
 .../integration/src/test/resources/pulsar-sql.xml  | 28 ++++++++++++++++++++
 .../src/test/resources/pulsar-thread-suite.xml     | 28 ++++++++++++++++++++
 tests/integration/src/test/resources/pulsar.xml    |  2 ++
 .../src/test/resources/tiered-storage-suite.xml    | 28 ++++++++++++++++++++
 10 files changed, 207 insertions(+), 7 deletions(-)

commit 634994e0f1db8701db48e9db7c120c5b61f9d7ce
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Feb 8 23:38:59 2019 -0800

    Add minimum amount of resources to run setting for functions (#3536)
    
    ### Motivation
    
    Some runtime might require a minimum about of resources to run a function instance.  Currently functions don't support the check to determine if the resources requested is greater the the minimum required.
    
    ### Modification
    
    Add a worker config to set the minimum amount of resource a function must request

 conf/functions_worker.yml                          |  8 +++
 .../runtime/KubernetesRuntimeFactory.java          | 34 +++++++++++
 .../runtime/KubernetesRuntimeFactoryTest.java      | 68 +++++++++++++++++++---
 .../functions/runtime/KubernetesRuntimeTest.java   |  2 +-
 .../functions/worker/FunctionRuntimeManager.java   |  1 +
 .../pulsar/functions/worker/WorkerConfig.java      |  7 ++-
 6 files changed, 110 insertions(+), 10 deletions(-)

commit b9fb91ed7f031407109c1ab0d84fc4d4a5643f2f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Feb 8 23:38:27 2019 -0800

    [pulsar-broker] cursor: safe guard to avoid cursor-znode after cursor is closed (#3556)
    
    ### Motivation
    
    Sometimes while shutting down the broker, unknown uncompleted callback tries to update `managed-cursor` even if managed-cursor is closed and because of that topic which is already loaded by new broker sees below exception while updating managed-cursor-metadata and cursor is not able to update mark-delete position until it unloaded again.
    ```
    09:22:02.641 [BookKeeperClientWorker-OrderedExecutor-8-0] INFO  org.apache.bookkeeper.mledger.impl.MetaStoreImplZookeeper - [sample/global/ns1/persistent/TopicBadVersion] [pulsar.repl.us-east] Updating cursor info ledgerId=234567890 mark-delete=12345678900:5306
    00:00:05.642 [bookkeeper-ml-workers-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.mledger.impl.ManagedCursorImpl - [sample/global/ns1/persistent/TopicBadVersion] Failed to update consumer pulsar.repl.us-east
    org.apache.bookkeeper.mledger.ManagedLedgerException$BadVersionException: org.apache.zookeeper.KeeperException$BadVersionException: KeeperErrorCode = BadVersion
    Caused by: org.apache.zookeeper.KeeperException$BadVersionException: KeeperErrorCode = BadVersion
            at org.apache.zookeeper.KeeperException.create(KeeperException.java:118) ~[pulsar-broker-2.2.5-.jar:2.2.5-]
            at org.apache.bookkeeper.mledger.impl.MetaStoreImplZookeeper.lambda$null$103(MetaStoreImplZookeeper.java:287) ~[managed-ledger-original-2.2.5-.jar:2.2.5-]
            at org.apache.bookkeeper.mledger.util.SafeRun$1.safeRun(SafeRun.java:32) [managed-ledger-original-2.2.5-.jar:2.2.5-]
            at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [bookkeeper-common-4.7.2.jar:4.7.2]
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_131]
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_131]
            at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.22.Final.jar:4.1.22.Final]
    ```
    
    It seems it always happens for replicator-cursor and not sure exact step to reproduce but it might happen when bookies might be in unstable state (not sure about the root cause). one of the example:
    
    Behavior:
    broker-1 unloads the topic by `09:21:59.451` and broker-2 loads the same topic at `09:22:00.135`. But broker-1 has log of updating metadata-znode at `09:22:05.207`. So, broker-2 fails to update cursor-metadata with exception `BadVersionException`
    ```
    Previous-broker: broker-1
    09:21:58.855 [shutdown-thread-49-1] INFO  org.apache.pulsar.broker.namespace.OwnedBundle - Disabling ownership: sample/global/ns1/0x2aaaaaa8_0x35555552
    :
    :
    09:21:59.668 [shutdown-thread-49-1] INFO  org.apache.pulsar.broker.namespace.OwnedBundle - Unloading sample/global/ns1/0x2aaaaaa8_0x35555552 namespace-bundle with 345 topics completed in 812.0 ms
    :
    09:21:58.930 [shutdown-thread-49-1] INFO  org.apache.pulsar.broker.service.BrokerService - [persistent://sample/global/ns1/TopicBadVersion] Unloading topic
    :
    09:21:59.451 [bookkeeper-ml-workers-OrderedExecutor-14-0] INFO  org.apache.bookkeeper.mledger.impl.ManagedCursorImpl - [sample/global/ns1/persistent/TopicBadVersion][pulsar.repl.us-east] Closed cursor at md-position=12345678900:5306
    09:21:59.451 [bookkeeper-ml-workers-OrderedExecutor-14-0] INFO  org.apache.pulsar.broker.service.persistent.PersistentTopic - [persistent://sample/global/ns1/TopicBadVersion] Topic closed
    :
    09:22:05.207 [BookKeeperClientWorker-OrderedExecutor-2-0] WARN  org.apache.bookkeeper.mledger.impl.ManagedCursorImpl - [sample/global/ns1/persistent/TopicBadVersion] Error updating cursor pulsar.repl.us-east position 12345678900:5306 in meta-ledger 14451380450: BookKeeper client is closed
    09:22:05.207 [BookKeeperClientWorker-OrderedExecutor-2-0] INFO  org.apache.bookkeeper.mledger.impl.MetaStoreImplZookeeper - [sample/global/ns1/persistent/TopicBadVersion] [pulsar.repl.us-east] Updating cursor info ledgerId=-1 mark-delete=12345678900:5306
    ```
    
    ```
    Current-broker: broker-2
    09:22:00.135 [pulsar-ordered-OrderedExecutor-7-0] INFO  org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl - Opening managed ledger sample/global/ns1/persistent/TopicBadVersion
    ```
    
    ### Modification
    
    It happens when someone tries to update cursor metadata by calling `persistPositionMetaStore(..)` so, it should have safe guard and should not update metadata if cursor is already closed.
    
    ### Result
    It avoids any unexpected behavior while updating cursor-metadata in closed cursor state.

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 30 ++++++++++++++++------
 1 file changed, 22 insertions(+), 8 deletions(-)

commit a1a20a8836d5f54aecde2969d62295d78013eb36
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 8 23:37:53 2019 -0800

    Added integration test for Python and Java schema compatibility (#3557)
    
    ### Motivation
    
    Added integration test to validate that a Java client with schema can interoperate with a Python client with equivalent schema declaration.

 .../docker-images/latest-version-image/Dockerfile  |   2 +
 .../python-examples/consumer_schema.py             |  49 ++++++++
 .../python-examples/producer_schema.py             |  45 ++++++++
 .../tests/integration/python/PythonSchemaTest.java | 123 +++++++++++++++++++++
 4 files changed, 219 insertions(+)

commit 27aa393bf5ddc197b610b574c50f13a3bcb8d4d4
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 8 23:36:15 2019 -0800

    Fixed BrokerClientIntegrationTest.testUnsupportedBatchMessageConsumer (#3545)
    
    ### Motivation
    
    Fixes #3538. The second consumer was being created with `Exclusive` type and was actually failing to connect.

 .../client/impl/BrokerClientIntegrationTest.java   | 29 +++++++++++++++-------
 1 file changed, 20 insertions(+), 9 deletions(-)

commit 1943cd028ff4832cd23e6bd8ddbe0d875c9232a5
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 8 20:50:31 2019 -0800

    Improved SimpleProducerConsumerTest to avoid receive timeout (#3517)
    
    * Improved SimpleProducerConsumerTest to avoid receive timeout
    
    * Use testDupConsumersOnSharedModeNotThrowsExcOnUnsubscribe to avoid interference with other tests running in parallel

 .../pulsar/client/api/SimpleProducerConsumerTest.java  | 18 +++++++++++-------
 1 file changed, 11 insertions(+), 7 deletions(-)

commit 9ce635a5332c95876864462731e94d48a123c1c6
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 8 18:06:39 2019 -0800

    In Python schema, allow to declare required fields (#3526)

 .../python/pulsar/schema/definition.py             | 19 +++--
 pulsar-client-cpp/python/schema_test.py            | 84 ++++++++++++++--------
 2 files changed, 70 insertions(+), 33 deletions(-)

commit 98a7d6a4c1c98f059844d955805d9dbdcf15408e
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 8 17:49:36 2019 -0800

    CPP Client - Only require linking with Boost program_options for CLI tools (#3546)

 pulsar-client-cpp/CMakeLists.txt      | 1 -
 pulsar-client-cpp/perf/CMakeLists.txt | 6 ++++--
 2 files changed, 4 insertions(+), 3 deletions(-)

commit c40bb08f7e00b6e9dca2ca5f1a0a321113aab9a7
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 8 11:01:22 2019 -0800

    In functions log topic appender, don't set producer name (#3544)

 .../java/org/apache/pulsar/functions/instance/LogAppender.java | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit b424fad2b58bf98007689435d174ee6b36952938
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 8 15:57:48 2019 +0800

     [bookie] enable bookie http server (#3062)
    
    
    *Motivation*
    
    Currently bookie http server is disabled by default. Setting the http server port
    to 8000 and include a vertx http server implementation to prepare enabling http server
    on bookie.
    
    *Modifications*
    
    Currently bookkeeper only provides two http server bindings, one is vertx, the other one
    is finagle server binding. both are netty based http server. so technically it doesn't
    introduce additional dependencies. However if people prefers a jetty implementation,
    I can add a jetty binding in bookkeeper.

 conf/bookkeeper.conf                             | 10 ++++++++++
 distribution/server/pom.xml                      | 13 +++++++++++++
 distribution/server/src/assemble/LICENSE.bin.txt |  5 +++++
 3 files changed, 28 insertions(+)

commit 8c7fe8c23868da5778fdfd4b7817b875fbc0386b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 7 21:26:21 2019 -0800

    fix a couple race conditions (#3547)

 .../main/java/org/apache/pulsar/functions/runtime/RuntimeSpawner.java | 2 +-
 .../org/apache/pulsar/functions/worker/FunctionRuntimeManager.java    | 4 +++-
 2 files changed, 4 insertions(+), 2 deletions(-)

commit 4e9505a512e5e52ac5ae941e503f8854e5030f33
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Feb 8 13:25:55 2019 +0800

    Modify CmdProduce to avoid closing resource manually. (#3472)

 .../main/java/org/apache/pulsar/client/cli/CmdProduce.java    | 11 +++--------
 1 file changed, 3 insertions(+), 8 deletions(-)

commit c448aaaed567f961a0e12693f6375b806a45fbc5
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 21:25:28 2019 -0800

    Added suppport for Kafka partitioner and explicit setting of partition on record (#3462)
    
    * Added suppport for Kafka partitioner and explicit setting of partition on record
    
    * Addressed comments
    
    * Use StandardCharsets and fixed alignment
    
    * Fixed initialization of custom partitioner
    
    * Feed realistic cluster metadata for Kafka partitioner implementation

 .../clients/producer/PulsarKafkaProducer.java      |  44 ++++++-
 .../client/kafka/compat/KafkaMessageRouter.java    |  44 +++++++
 site2/docs/adaptors-kafka.md                       |   7 +-
 .../integration/compat/kafka/KafkaApiTest.java     | 128 +++++++++++++++++++++
 4 files changed, 215 insertions(+), 8 deletions(-)

commit d9e1370a56f595e5613f6899220b05f8b695f928
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 7 18:02:21 2019 -0800

    fix: get list connectors return status (#3532)

 .../org/apache/pulsar/functions/worker/rest/api/ComponentImpl.java    | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 2bc5c5b748acd7bc23df130db9d42195276404ba
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 7 14:40:55 2019 -0800

    For integration tests, copy function logs out of container on shutdown for debugging purposes (#3529)

 .../tests/integration/containers/WorkerContainer.java      | 14 ++++++++++++++
 .../apache/pulsar/tests/integration/utils/DockerUtils.java |  5 ++++-
 2 files changed, 18 insertions(+), 1 deletion(-)

commit 3b1dd8cfaa22ecf24eeaac2c6da026e0747cbcfd
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 14:22:59 2019 -0800

    Build static lib with bundled dependencies (#3488)
    
    * Build static lib with bundled dependencies
    
    * Added gitignore entry
    
    * Fixed target_link_libraries when not linking statically
    
    * Fixed linking on python wrapper

 pulsar-client-cpp/.gitignore                       |  3 ++
 pulsar-client-cpp/build-support/merge_archives.sh  | 50 ++++++++++++++++++++++
 .../docker/build-wheel-file-within-docker.sh       |  2 +-
 pulsar-client-cpp/lib/CMakeLists.txt               | 39 +++++++++++++----
 pulsar-client-cpp/pkg/deb/build-deb.sh             |  1 -
 pulsar-client-cpp/python/CMakeLists.txt            |  4 +-
 6 files changed, 86 insertions(+), 13 deletions(-)

commit 7ef26ddd1a7f5ea1f7ef33268a515d882d774550
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 14:22:45 2019 -0800

    Upgrade AsyncHTTP client to 2.7.0 (#3509)
    
    * Upgrade AsyncHTTP client to 2.7.0
    
    * Fixed license files

 distribution/server/src/assemble/LICENSE.bin.txt | 7 ++++---
 pom.xml                                          | 2 +-
 pulsar-sql/presto-distribution/LICENSE           | 1 +
 3 files changed, 6 insertions(+), 4 deletions(-)

commit 1e531e0c5dd24db9f85f7e97bb49ed7ad93bf617
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 14:22:28 2019 -0800

    Use synchronized when accessing consumers identity map (#3540)

 .../java/org/apache/pulsar/client/impl/PulsarClientImpl.java | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

commit 3a5df1ae71a29873fdd91295763342b90f9bc224
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Feb 8 04:51:47 2019 +0800

    Issue 3230:  auto update topic partitions extend for consumer and producer (#3513)
    
    * consumer auto subscribe
    
    * producer update for partiton extends
    
    * change following Matteo's comments
    
    * enable by default

 .../api/PartitionedProducerConsumerTest.java       | 112 ++++++++++
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  88 ++++++++
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   9 +
 .../apache/pulsar/client/api/ProducerBuilder.java  |   9 +
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   7 +-
 .../client/impl/MultiTopicsConsumerImpl.java       | 237 ++++++++++++++++-----
 .../client/impl/PartitionedProducerImpl.java       | 126 ++++++++++-
 .../client/impl/PartitionsChangedListener.java     |  33 +++
 .../impl/PatternMultiTopicsConsumerImpl.java       |   2 +-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |   5 +
 .../impl/conf/ConsumerConfigurationData.java       |   2 +
 .../impl/conf/ProducerConfigurationData.java       |   2 +
 12 files changed, 578 insertions(+), 54 deletions(-)

commit b833bce4d7d97be0db1849c7b401a11813967898
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 7 10:47:32 2019 -0800

    Cleaned up the code to not return Response objects (#3520)

 .../functions/worker/FunctionRuntimeManager.java   | 33 +++++++++++++---------
 1 file changed, 19 insertions(+), 14 deletions(-)

commit a5b17f56936935dcd6a2cbaf5864b4e83bef548c
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 10:47:08 2019 -0800

    Removed usages of boost::filesystem (#3527)

 pulsar-client-cpp/CMakeLists.txt          |  3 +--
 pulsar-client-cpp/lib/ClientConnection.cc | 14 ++++++++------
 pulsar-client-cpp/perf/PerfConsumer.cc    |  5 ++---
 pulsar-client-cpp/perf/PerfProducer.cc    |  5 ++---
 4 files changed, 13 insertions(+), 14 deletions(-)

commit c55bd95ed4aed2789e0b1567a34541d96023ef24
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 7 09:08:16 2019 -0800

    fix: RuntimeInfo doesn't get set when transferring ownership of function from another worker to this worker (#3523)
    
    * fix: RuntimeInfo doesn't get set when transferring ownership of function from another worker to this worker
    
    * fix and add test
    
    * fix bug and adding tests
    
    * fixing kubernetes runtime
    
    * add debugging message

 .../functions/runtime/KubernetesRuntime.java       |  18 +--
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  11 +-
 .../pulsar/functions/worker/FunctionActioner.java  |  91 +++++++-----
 .../functions/worker/FunctionRuntimeManager.java   |  53 +++++--
 .../worker/FunctionRuntimeManagerTest.java         | 161 ++++++++++++++++++++-
 5 files changed, 269 insertions(+), 65 deletions(-)

commit d59a6ed57660e246bdab4367387a127560552da1
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 08:47:30 2019 -0800

    Use testDupConsumersOnSharedModeNotThrowsExcOnUnsubscribe to avoid interference with other tests running in parallel (#3521)
    
    * Use testDupConsumersOnSharedModeNotThrowsExcOnUnsubscribe to avoid interference with other tests running in parallel
    
    * Fixed formatting

 pulsar-client-cpp/lib/ClientImpl.cc          | 5 +++--
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 3 ++-
 2 files changed, 5 insertions(+), 3 deletions(-)

commit dd3e7df43eaf712443781afb7071f8520d30736c
Author: k2la <mzq6mft9zz@gmail.com>
Date:   Thu Feb 7 18:43:30 2019 +0900

    fix command name in help (#3530)

 .../java/org/apache/pulsar/admin/cli/CmdNamespaceIsolationPolicy.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ec923ccde7b8f58b24f62b82bdd7af6ea97d9187
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 7 00:10:58 2019 -0800

    Revert "Replaces boost::regex with std::regex (#3512)" (#3534)
    
    This reverts commit 8fcc7ca5e5d3615b60a082699bb100907044cf79.

 pulsar-client-cpp/CMakeLists.txt               |  3 ++-
 pulsar-client-cpp/lib/NamedEntity.cc           |  5 ++---
 pulsar-client-cpp/lib/NamedEntity.h            |  5 ++++-
 pulsar-client-cpp/lib/Url.cc                   | 10 ++++------
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 16 +++++++---------
 pulsar-client-cpp/tests/ZTSClientTest.cc       |  2 +-
 6 files changed, 20 insertions(+), 21 deletions(-)

commit 6c8f4d1fc825a9ac8e431e97b611cd4d6f68385e
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Feb 5 00:53:05 2019 +0800

    [Issue 3431] Support Kafka-IO to pass extra configs (#3432)
    
    * Support Kafka-IO to pass extra configs.
    
    * Add a setting in the connector config file and a unit test for this part of changes
    
    * Remove unused import
    
    * A minor change and a unit test for this part of changes
    
    * add missing io-kafka.md

 .../apache/pulsar/io/kafka/KafkaAbstractSink.java  |  3 +++
 .../pulsar/io/kafka/KafkaAbstractSource.java       |  3 +++
 .../apache/pulsar/io/kafka/KafkaSinkConfig.java    |  6 +++++
 .../apache/pulsar/io/kafka/KafkaSourceConfig.java  |  6 +++++
 .../io/kafka/source/KafkaAbstractSourceTest.java   | 29 +++++++++++++++++++++
 .../src/test/resources/kafkaSourceConfig.yaml      | 30 ++++++++++++++++++++++
 site2/docs/io-kafka.md                             |  2 ++
 7 files changed, 79 insertions(+)

commit a7f6e8b6d581610279e3b114fceb71d5811eaf2f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Feb 4 08:52:33 2019 -0800

    [pulsar-broker] Fix TLS : loading PKCS8Key key file for replication in pulsar-broker (#3483)

 pulsar-client/pom.xml                                                | 5 -----
 pulsar-common/pom.xml                                                | 5 +++++
 .../src/main/java/org/apache/pulsar/common/util/SecurityUtility.java | 5 +++++
 3 files changed, 10 insertions(+), 5 deletions(-)

commit 2cca8ce83667fccde428db536a1446eef2203f8e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Feb 4 08:52:18 2019 -0800

    [pulsar-broker] Avoid creating unnecessary dispatch-rate-limit objects (#3479)
    
    * Avoid creating unnecessary dispatch-rate-limit objects
    
    * remove isntanceof check

 .../pulsar/broker/service/BrokerService.java       | 16 ++----
 .../apache/pulsar/broker/service/Dispatcher.java   | 10 +++-
 .../org/apache/pulsar/broker/service/Topic.java    | 12 ++++-
 .../service/persistent/DispatchRateLimiter.java    | 46 +++++++++++++++--
 .../PersistentDispatcherMultipleConsumers.java     | 47 +++++++++---------
 .../PersistentDispatcherSingleActiveConsumer.java  | 52 ++++++++++----------
 .../broker/service/persistent/PersistentTopic.java | 57 ++++++++++++++++------
 .../service/persistent/SubscribeRateLimiter.java   | 41 +++++++++++-----
 .../client/api/MessageDispatchThrottlingTest.java  | 38 +++++++--------
 .../SubscriptionMessageDispatchThrottlingTest.java | 28 +++++------
 10 files changed, 218 insertions(+), 129 deletions(-)

commit 31243ee49f750e0b10cef3b8605d10545b43e459
Author: David Phillips <david@acz.org>
Date:   Mon Feb 4 08:52:02 2019 -0800

    Update link to Presto website (#3498)
    
    This is the new home for the Presto project under the Presto Software Foundation.

 site2/docs/sql-overview.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e1ed181896ae88a79d3484b0be2a2b72035bded8
Author: Ganesh Subramanian <subramanian.ganesh@gmail.com>
Date:   Mon Feb 4 22:21:43 2019 +0530

    Make PulsarStandalone.start() public to be called in Embedded mode (#3516)

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8fcc7ca5e5d3615b60a082699bb100907044cf79
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 4 06:38:38 2019 -0800

    Replaces boost::regex with std::regex (#3512)
    
    * Replaces boost::regex with std::regex
    
    * Fixed regex syntax to be ecmascript compatible

 pulsar-client-cpp/CMakeLists.txt               |  7 +------
 pulsar-client-cpp/lib/NamedEntity.cc           |  5 +++--
 pulsar-client-cpp/lib/NamedEntity.h            |  5 +----
 pulsar-client-cpp/lib/Url.cc                   | 10 ++++++----
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 16 +++++++++-------
 pulsar-client-cpp/tests/ZTSClientTest.cc       |  2 +-
 6 files changed, 21 insertions(+), 24 deletions(-)

commit eadf722dc6d5298a0b9cbcb48248bd79801a6d11
Author: tuteng <eguangning@gmail.com>
Date:   Mon Feb 4 15:02:41 2019 +0800

    Remove the judgment of the localrun mode (#3447) (#3456)
    
    ### Motivation
    
    Admin client need to be built in both localrun mode and non-localrun mode.
    Initialization Admin client is required in class CmdTopics.
    example:
    ```
    topics = admin.topics();
    ```
    More information: https://github.com/apache/pulsar/issues/3447
    
    ### Modifications
    
    Remove the judgement of localrun mode
    
    
    ### Verifying this change
    Test ok

 .../main/java/org/apache/pulsar/admin/cli/PulsarAdminTool.java    | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 93e9720c7001133eac1eaf84b7cd6c8f170b9e06
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Feb 3 13:31:31 2019 -0800

    Debug log: include ledgerId for dispatched message (#3465)

 .../src/main/java/org/apache/pulsar/broker/service/Consumer.java      | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a4359d293736bc52d4d3038c3d5aef086c070c69
Author: Like <like_0903@163.com>
Date:   Mon Feb 4 01:11:19 2019 +0800

    Add document for uploading namespace API (#3445)

 site2/docs/admin-api-namespaces.md | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)

commit ee2a2aa265c5d6d032d0e3cc2d9d9427502c54a4
Author: Like <like_0903@163.com>
Date:   Mon Feb 4 00:12:37 2019 +0800

    Clean up duplicate section in doc (#3442)

 site2/docs/admin-api-namespaces.md | 6 ------
 1 file changed, 6 deletions(-)

commit c07042460b251f31a83a77451d40399ebc592a1a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Feb 2 23:07:01 2019 -0800

    allow function state storage url to configurable in standalone deployment (#3508)
    
    * allow function state storage url to configurable in standalone deployment
    
    * adding additional logic

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit a12b2b94a7505273deba9f1b0a2b82702d42a9d0
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 2 07:45:58 2019 -0800

    Replaced boost::array with std::array (#3507)

 pulsar-client-cpp/lib/ClientConnection.cc        | 1 -
 pulsar-client-cpp/lib/SharedBuffer.h             | 6 +++---
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.cc | 4 +++-
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h  | 1 -
 4 files changed, 6 insertions(+), 6 deletions(-)

commit a98184c77d61f33f1e2bcb377ec6017a64239414
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sat Feb 2 06:38:37 2019 -0800

    Add BC Testing for client (#3466)
    
    For client version 2.0.0
    and 2.0.1

 tests/bc_2_0_0/pom.xml                             | 130 +++++++++++++++++++++
 .../pulsar/tests/integration/PulsarContainer.java  |  53 +++++++++
 .../apache/pulsar/tests/integration/SmokeTest.java |  77 ++++++++++++
 tests/bc_2_0_0/src/test/resources/pulsar.xml       |  30 +++++
 tests/bc_2_0_1/pom.xml                             | 130 +++++++++++++++++++++
 .../pulsar/tests/integration/PulsarContainer.java  |  53 +++++++++
 .../apache/pulsar/tests/integration/SmokeTest.java |  77 ++++++++++++
 tests/bc_2_0_1/src/test/resources/pulsar.xml       |  30 +++++
 tests/pom.xml                                      |   2 +
 9 files changed, 582 insertions(+)

commit dba219036c1552863f2c1cb272c94333149d8ac3
Author: Like <like_0903@163.com>
Date:   Sat Feb 2 22:37:07 2019 +0800

    Use try-resource to auto close opened resource (#3492)

 .../apache/pulsar/client/admin/internal/TopicsImpl.java  | 16 +++++-----------
 .../org/apache/pulsar/admin/cli/PulsarAdminTool.java     |  7 +------
 .../org/apache/pulsar/client/cli/PulsarClientTool.java   |  8 +-------
 3 files changed, 7 insertions(+), 24 deletions(-)

commit 30be35a1b782528d00855efb2aaf751d7d2b8275
Author: Like <like_0903@163.com>
Date:   Sat Feb 2 22:36:51 2019 +0800

    Fix document section reference (#3499)

 site2/docs/administration-zk-bk.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 2b03106b3085178e4593b919bc91163108c33a2b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 1 19:06:56 2019 -0800

    Re-enable running Python tests in CI PR validation (#3424)
    
    * Re-enable running Python tests in CI PR validation
    
    * Fixed python test topic name
    
    * Copy both test scripts into /tmp
    
    * Fixed tests with schema changes
    
    * Use isinstance for py2 compat
    
    * Clear multi-topics consumer queue to avoid thread deadlock
    
    * Ensure fields list is sorted by name

 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc     |  1 +
 pulsar-client-cpp/python/pulsar/__init__.py          | 14 +++++++++++---
 pulsar-client-cpp/python/pulsar/schema/definition.py |  4 ++--
 pulsar-client-cpp/python/pulsar_test.py              | 12 ++++++++++--
 pulsar-client-cpp/run-unit-tests.sh                  |  3 +--
 5 files changed, 25 insertions(+), 9 deletions(-)

commit 17f2aabf1a4f5fe9f09e6e93b201e700f591189d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Feb 1 16:04:05 2019 -0800

    Add support for pluggable jvm-metrics (#3428)
    
    * Add support for pluggable jvm-metrics
    
    * auto detect gc metrics impl

 conf/broker.conf                                   |   3 +
 conf/functions_worker.yml                          |   2 +
 conf/standalone.conf                               |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   5 +
 .../pulsar/broker/stats/MetricsGenerator.java      |   3 +-
 .../common/stats/JvmDefaultGCMetricsLogger.java    | 106 ++++++++++++++++++
 .../pulsar/common/stats/JvmG1GCMetricsLogger.java  |  91 ++++++++++++++++
 .../pulsar/common/stats/JvmGCMetricsLogger.java    |  40 +++++++
 .../org/apache/pulsar/common/stats/JvmMetrics.java | 121 +++++++++------------
 .../pulsar/functions/worker/MetricsGenerator.java  |   4 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  19 ++--
 .../pulsar/functions/worker/WorkerService.java     |   2 +-
 12 files changed, 317 insertions(+), 82 deletions(-)

commit d258b1fa14939df72a645a88689cc56f2c7d0d31
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Feb 1 10:54:40 2019 -0800

    CPP Client - Adding LOG4CXX_USE_DYNAMIC_LIBS to CMake. (#3503)

 pulsar-client-cpp/CMakeLists.txt | 26 +++++++++++++++-----------
 1 file changed, 15 insertions(+), 11 deletions(-)

commit 5551f5e0286d3b99750efed3920c5c87c7f71867
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Feb 1 10:30:09 2019 -0800

    Functions of externally managed runtimes shouldn't need to restart when changing assignments (#3502)
    
    * Externally managed runtimes shouldn't need to restart when changing worker assignment
    
    * cleaning up
    
    * fix tests and refactor
    
    * cleaning up
    
    * fix bug

 .../functions/worker/FunctionRuntimeManager.java   | 56 +++++++++++++----
 .../worker/FunctionRuntimeManagerTest.java         | 72 ++++++++++++++++++++--
 2 files changed, 113 insertions(+), 15 deletions(-)

commit dd5d05197a9352aba392ae30e7c60e05fc52be0b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 1 08:51:51 2019 -0800

    Replaced boost::bind with std::bind (#3484)
    
    * Replaced boost::bind with std::bind
    
    * Fixed merging with master
    
    * std::bind doesn't work with overloaded functions
    
    * Go back to asio thread to executor service
    
    * Use proper ref-count increase for WaitForCallback utility

 pulsar-client-cpp/examples/SampleAsyncProducer.cc  |  5 +-
 pulsar-client-cpp/examples/SampleProducer.cc       |  2 -
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |  5 +-
 pulsar-client-cpp/lib/BatchMessageContainer.h      |  1 -
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  |  1 -
 pulsar-client-cpp/lib/ClientConnection.cc          | 94 +++++++++++-----------
 pulsar-client-cpp/lib/ClientImpl.cc                |  8 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              | 13 ++-
 pulsar-client-cpp/lib/ExecutorService.cc           | 12 +--
 pulsar-client-cpp/lib/ExecutorService.h            |  1 +
 pulsar-client-cpp/lib/HTTPLookupService.h          |  1 -
 pulsar-client-cpp/lib/HandlerBase.cc               |  1 -
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   |  4 +-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  4 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  1 -
 .../lib/PatternMultiTopicsConsumerImpl.cc          | 11 +--
 pulsar-client-cpp/lib/ProducerImpl.cc              | 17 ++--
 .../lib/UnAckedMessageTrackerEnabled.cc            | 19 +++--
 .../lib/UnAckedMessageTrackerEnabled.h             |  1 -
 .../lib/UnAckedMessageTrackerInterface.h           |  1 -
 pulsar-client-cpp/lib/Utils.h                      | 12 +--
 pulsar-client-cpp/lib/auth/AuthAthenz.cc           |  4 +-
 pulsar-client-cpp/lib/auth/AuthToken.cc            | 10 +--
 pulsar-client-cpp/lib/c/c_Authentication.cc        |  2 +-
 pulsar-client-cpp/lib/c/c_Client.cc                | 30 ++++---
 pulsar-client-cpp/lib/c/c_Consumer.cc              | 23 +++---
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc |  4 +-
 pulsar-client-cpp/lib/c/c_Producer.cc              |  9 +--
 pulsar-client-cpp/lib/c/c_Reader.cc                |  2 +-
 pulsar-client-cpp/lib/c/c_ReaderConfiguration.cc   |  3 +-
 pulsar-client-cpp/lib/c/c_structs.h                |  2 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.cc   |  8 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.h    |  1 -
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.cc   |  6 +-
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h    |  1 -
 pulsar-client-cpp/perf/PerfConsumer.cc             |  4 +-
 pulsar-client-cpp/perf/PerfProducer.cc             |  7 +-
 pulsar-client-cpp/python/src/producer.cc           |  5 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 68 ++++++++++------
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       | 19 +++--
 pulsar-client-cpp/tests/ZeroQueueSizeTest.cc       |  5 +-
 41 files changed, 222 insertions(+), 205 deletions(-)

commit 0781cf47a81d3de7a6ec64243afd9d1a7815a092
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Feb 1 04:25:53 2019 -0800

    Add host name verification for C/C++ (#2475)
    
    This adds ssl host name verification as an optional client configuration for the C/C++ client library
    This brings it to parity with the java client

 .../include/pulsar/ClientConfiguration.h           |  3 ++
 .../include/pulsar/c/client_configuration.h        |  5 +++
 pulsar-client-cpp/lib/ClientConfiguration.cc       |  7 ++++
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    |  4 +-
 pulsar-client-cpp/lib/ConnectionPool.cc            | 34 +++++++++++++++++
 pulsar-client-cpp/lib/LogUtils.h                   |  2 +-
 pulsar-client-cpp/lib/c/c_ClientConfiguration.cc   |  9 +++++
 pulsar-client-cpp/python/src/config.cc             |  1 +
 pulsar-client-cpp/tests/AuthPluginTest.cc          | 44 ++++++++++++++++++++++
 9 files changed, 107 insertions(+), 2 deletions(-)

commit 3791dfef4d5b880e97fe32d926235ad6214f42ed
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 31 20:00:32 2019 -0700

    allow users to set the image pull policy for kubernetes runtime (#3496)

 .../apache/pulsar/functions/runtime/KubernetesRuntime.java    |  4 ++++
 .../pulsar/functions/runtime/KubernetesRuntimeFactory.java    |  8 ++++++++
 .../functions/runtime/KubernetesRuntimeFactoryTest.java       |  1 +
 .../pulsar/functions/runtime/KubernetesRuntimeTest.java       |  1 +
 .../pulsar/functions/worker/FunctionRuntimeManager.java       |  1 +
 .../java/org/apache/pulsar/functions/worker/WorkerConfig.java | 11 ++++++++---
 6 files changed, 23 insertions(+), 3 deletions(-)

commit 020a1d57e122582a5ad8bd043f278e4a92d4ffc1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 31 16:47:39 2019 -0800

    Fixed the behavior of Function start/stop (#3477)
    
    * Added a state in the function metadata about what the state of the instances should be
    
    * Have start api for sources/sinks
    
    * Add missing pieces
    
    * more checks while handling request
    
    * Fixed bugs
    
    * Added unittests
    
    * Added unittest
    
    * Fix the all instances side logic

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  31 +++++
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |  31 +++++
 .../pulsar/broker/admin/impl/SourceBase.java       |  29 +++++
 .../org/apache/pulsar/client/admin/Functions.java  |  34 +++++
 .../java/org/apache/pulsar/client/admin/Sink.java  |  34 +++++
 .../org/apache/pulsar/client/admin/Source.java     |  34 +++++
 .../client/admin/internal/FunctionsImpl.java       |  21 ++++
 .../pulsar/client/admin/internal/SinkImpl.java     |  21 ++++
 .../pulsar/client/admin/internal/SourceImpl.java   |  21 ++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  29 +++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  33 ++++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  28 ++++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  28 ++++-
 .../proto/src/main/proto/Function.proto            |   5 +
 .../functions/worker/FunctionMetaDataManager.java  |  59 +++++++++
 .../functions/worker/FunctionRuntimeManager.java   |  56 ++++++---
 .../functions/worker/rest/api/ComponentImpl.java   | 139 +++++++++++++++++----
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |  31 +++++
 .../worker/rest/api/v3/SinkApiV3Resource.java      |  27 ++++
 .../worker/rest/api/v3/SourceApiV3Resource.java    |  27 ++++
 .../worker/FunctionMetaDataManagerTest.java        |  62 +++++++++
 .../worker/FunctionRuntimeManagerTest.java         |  53 ++++++++
 22 files changed, 781 insertions(+), 52 deletions(-)

commit 4151413805219e0aadaa57f6265f22c77bd57f01
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jan 31 16:18:23 2019 -0800

    Add Connect and Read timeout to pulsar admin (#2957)

 .../apache/pulsar/client/admin/PulsarAdmin.java    | 55 ++++++++++++++++------
 .../pulsar/client/admin/PulsarAdminBuilder.java    | 18 +++++++
 .../admin/internal/PulsarAdminBuilderImpl.java     | 26 ++++++++--
 3 files changed, 81 insertions(+), 18 deletions(-)

commit 98712008cb83c0157fc2c59e6e85eb1542312883
Author: wpl <1269223860@qq.com>
Date:   Fri Feb 1 07:56:06 2019 +0800

    Issue #3290 Pulsar IO connector for Hbase sink (#3368)
    
    Supporting the ability to write data to HBase sink #3290

 distribution/io/src/assemble/io.xml                |   6 +
 pom.xml                                            |   1 +
 pulsar-io/hbase/pom.xml                            |  95 ++++++++++
 .../pulsar/io/hbase/HbaseAbstractConfig.java       |  81 ++++++++
 .../pulsar/io/hbase/sink/HbaseAbstractSink.java    | 204 +++++++++++++++++++++
 .../io/hbase/sink/HbaseGenericRecordSink.java      |  89 +++++++++
 .../pulsar/io/hbase/sink/HbaseSinkConfig.java      |  99 ++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 .../org/apache/pulsar/io/hbase/TableUtils.java     |  52 ++++++
 .../io/hbase/sink/HbaseGenericRecordSinkTest.java  | 172 +++++++++++++++++
 .../pulsar/io/hbase/sink/HbaseSinkConfigTest.java  | 155 ++++++++++++++++
 .../hbase/src/test/resources/hbase/hbase-site.xml  |  42 +++++
 pulsar-io/hbase/src/test/resources/sinkConfig.yaml |  29 +++
 pulsar-io/pom.xml                                  |   1 +
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-hbase.md                             |  27 +++
 16 files changed, 1076 insertions(+)

commit 7d9d879bedec749f0cb8836267e5fb1ec2d6fa52
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 31 13:11:29 2019 -0800

    When cursor recovery encounters empty cursor ledger, fallback to latest snapshot (#3487)
    
    * When cursor recovery encounters empty cursor ledger, fallback to latest snapshot
    
    * Remove post-decrement comparison

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 11 +++++++-
 .../bookkeeper/client/PulsarMockBookKeeper.java    | 15 +++++++++++
 .../bookkeeper/client/PulsarMockLedgerHandle.java  |  6 ++++-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 31 ++++++++++++++++++++++
 4 files changed, 61 insertions(+), 2 deletions(-)

commit 7eed36d89d403e08b12e80aeb80c5779d84f6a9a
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 31 13:03:53 2019 -0800

    Upgrade BouncyCastle to 1.60 (#3495)

 distribution/server/src/assemble/LICENSE.bin.txt |  6 +++---
 pom.xml                                          | 12 +++++++++---
 pulsar-sql/presto-distribution/LICENSE           |  4 ++--
 3 files changed, 14 insertions(+), 8 deletions(-)

commit ebc381be0ead4e0ffff7b99f793f08ec1ff0671e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 31 08:50:04 2019 -0800

    Fixed watch-znode script to work in Py2 (#3470)

 docker/pulsar/scripts/watch-znode.py | 25 ++++++++++++++-----------
 1 file changed, 14 insertions(+), 11 deletions(-)

commit 991778474273e9fa150e367bf0e788748559a1a3
Author:  <rxl5555555@qq.com>
Date:   Thu Jan 31 22:47:36 2019 +0800

    [go-client] support consumer seek (#3478)
    
    * [go-client] support consumer seek
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add unit test for consumer seek
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/c_consumer.go    | 24 ++++++++++
 pulsar-client-go/pulsar/c_go_pulsar.h    |  6 +++
 pulsar-client-go/pulsar/consumer.go      |  7 +++
 pulsar-client-go/pulsar/consumer_test.go | 75 +++++++++++++++++++++++++++++---
 4 files changed, 106 insertions(+), 6 deletions(-)

commit 2f1aae1bc9a54fc9507e87fa6e0bcedbf5793467
Author: Tommy Li <tommyzli@gmail.com>
Date:   Thu Jan 31 03:37:40 2019 -0800

    [docs] Fix broken link in the dashboard's readme (#3489)

 dashboard/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit abd482df6f5f163230bbadb20239b5a3b58aaa06
Author: Ambud <ambud@users.noreply.github.com>
Date:   Wed Jan 30 16:47:20 2019 -0800

    Document how to change Bookkeeper Zk root config (#3459)
    
    ### Motivation
    Using ```zkServers=zk1:2181/myroot``` current is resulting in Bookie start failure. This PR documents the correct way to configure zookeeper root for Bookkeeper when using Pulsar.
    
    ### Modifications
    
    - Adding doc line to https://pulsar.apache.org/docs/en/administration-zk-bk/

 site2/docs/administration-zk-bk.md | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 1d14680c8bcdae4159afc230b12c22545f855a58
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 30 13:08:47 2019 -0800

    Replace boost::mutex and boost::thread with std::mutex and std::thread (#3461)
    
    * Replace boost::mutex and boost::thread with std::mutex and std::thread
    
    * Added missing mutex header
    
    * Added missing vector header
    
    * Removed extra tab
    
    * Added missing <atomic> include
    
    * Missing <memory> includes

 pulsar-client-cpp/CMakeLists.txt                   |  2 +-
 pulsar-client-cpp/lib/Authentication.cc            | 14 +++---
 .../lib/BatchAcknowledgementTracker.h              |  6 +--
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |  4 +-
 pulsar-client-cpp/lib/BlockingQueue.h              | 17 +++----
 pulsar-client-cpp/lib/ClientConnection.h           |  6 +--
 pulsar-client-cpp/lib/ClientImpl.cc                |  5 +-
 pulsar-client-cpp/lib/ClientImpl.h                 |  4 +-
 pulsar-client-cpp/lib/Commands.cc                  | 17 +++----
 pulsar-client-cpp/lib/CompressionCodecZLib.h       |  1 -
 pulsar-client-cpp/lib/ConnectionPool.cc            |  2 +-
 pulsar-client-cpp/lib/ConnectionPool.h             |  4 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  6 +--
 pulsar-client-cpp/lib/ConsumerImpl.h               |  4 +-
 pulsar-client-cpp/lib/ExecutorService.h            |  6 +--
 pulsar-client-cpp/lib/Future.h                     | 11 +++--
 pulsar-client-cpp/lib/HandlerBase.h                |  6 +--
 pulsar-client-cpp/lib/Latch.cc                     | 13 -----
 pulsar-client-cpp/lib/Latch.h                      | 24 +++++++---
 pulsar-client-cpp/lib/LogUtils.h                   |  4 +-
 pulsar-client-cpp/lib/LookupDataResult.h           |  3 ++
 pulsar-client-cpp/lib/LookupService.h              |  2 +
 pulsar-client-cpp/lib/MessageCrypto.h              |  6 +--
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   |  4 +-
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h    |  6 +--
 pulsar-client-cpp/lib/ObjectPool.h                 | 16 +++----
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  4 +-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |  6 +--
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |  6 +--
 pulsar-client-cpp/lib/ProducerImpl.h               |  4 +-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |  6 +--
 pulsar-client-cpp/lib/TopicName.cc                 |  4 +-
 pulsar-client-cpp/lib/TopicName.h                  |  4 +-
 .../lib/UnAckedMessageTrackerEnabled.cc            | 12 ++---
 .../lib/UnAckedMessageTrackerEnabled.h             |  5 +-
 .../lib/UnAckedMessageTrackerInterface.h           |  3 --
 pulsar-client-cpp/lib/UnboundedBlockingQueue.h     | 16 +++----
 pulsar-client-cpp/lib/Utils.h                      |  3 ++
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc     |  8 ++--
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.h      |  2 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.h    |  2 +-
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h    |  7 +--
 pulsar-client-cpp/perf/PerfConsumer.cc             |  7 +--
 pulsar-client-cpp/perf/PerfProducer.cc             | 55 ++++++++++++----------
 pulsar-client-cpp/perf/RateLimiter.h               |  6 +--
 pulsar-client-cpp/tests/AuthPluginTest.cc          |  6 +--
 pulsar-client-cpp/tests/AuthTokenTest.cc           |  1 -
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 12 ++---
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  1 -
 pulsar-client-cpp/tests/BlockingQueueTest.cc       | 17 +++----
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |  4 +-
 pulsar-client-cpp/tests/LatchTest.cc               | 42 ++++++++---------
 pulsar-client-cpp/tests/ZeroQueueSizeTest.cc       |  2 +-
 53 files changed, 221 insertions(+), 217 deletions(-)

commit 86a9f434f50b2008de4b68ad736e389c905a947e
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 30 06:41:01 2019 -0800

    Support defining and validating schema on Python client (#3391)
    
    * Support defining and validating schema on Python client
    
    * Added missing license headers
    
    * Fixed metaclass declaration to work for py2 and py3
    
    * More python2 compat fixes
    
    * Added missing pip dependency on fastavro

 pulsar-client-cpp/python/CMakeLists.txt            |   2 +-
 pulsar-client-cpp/python/pulsar/__init__.py        |  77 +++-
 pulsar-client-cpp/python/pulsar/schema/__init__.py |  24 ++
 .../python/pulsar/schema/definition.py             | 206 +++++++++++
 pulsar-client-cpp/python/pulsar/schema/schema.py   | 104 ++++++
 pulsar-client-cpp/python/pulsar_test.py            |   2 +
 pulsar-client-cpp/python/schema_test.py            | 395 +++++++++++++++++++++
 pulsar-client-cpp/python/setup.py                  |  30 +-
 pulsar-client-cpp/python/src/config.cc             |   6 +
 pulsar-client-cpp/python/src/enums.cc              |  18 +
 pulsar-client-cpp/python/src/pulsar.cc             |   2 +
 pulsar-client-cpp/python/src/schema.cc             |  30 ++
 12 files changed, 877 insertions(+), 19 deletions(-)

commit a1826afd7afcce35809751cffaf7378323f6727a
Author:  <rxl5555555@qq.com>
Date:   Wed Jan 30 16:57:19 2019 +0800

    use iota for go-client (#3474)
    
    ### Motivation
    
    use iota to replace the original way
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/consumer.go |  6 +++---
 pulsar-client-go/pulsar/producer.go | 20 ++++++++++----------
 2 files changed, 13 insertions(+), 13 deletions(-)

commit cc3eb7f44b8ac884e83d9f0f127c216edd897d9d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 29 19:13:03 2019 -0800

    Use randomized names for kafka container in integration tests (#3412)
    
    * Use randomized names for kafka container in integration testss
    
    * Revert change in KafkaSourceTester
    
    * One more fix for source container names
    
    * Use different name for different tests

 .../integration/functions/PulsarFunctionsTest.java    |  3 ++-
 .../pulsar/tests/integration/io/KafkaSinkTester.java  | 19 ++++++++++---------
 .../tests/integration/io/KafkaSourceTester.java       |  8 ++++----
 3 files changed, 16 insertions(+), 14 deletions(-)

commit 8d3534ce356ca118af73470375ec21058c726153
Author: Enrico Olivelli <eolivelli@gmail.com>
Date:   Wed Jan 30 02:24:56 2019 +0100

    Issue 3457: Do not set HierarchicalLedgerManagerFactory explicitly (#3473)
    
    - Do not set HierarchicalLedgerManagerFactory explicitly, this way BookKeeper will auto detect the LedgerManagerFactory from the existing cluster
    - The default in BookKeeper 4.7+ is still HierarchicalLedgerManagerFactory
    
    Signed-off-by: Enrico Olivelli <eolivelli@apache.org>

 conf/bookkeeper.conf                                                    | 2 +-
 deployment/terraform-ansible/templates/bookkeeper.conf                  | 2 +-
 .../src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java     | 1 -
 .../main/java/org/apache/pulsar/broker/BookKeeperClientFactoryImpl.java | 2 --
 .../src/main/java/org/apache/pulsar/testclient/ManagedLedgerWriter.java | 2 --
 .../main/java/org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 2 --
 6 files changed, 2 insertions(+), 9 deletions(-)

commit bdd601969fdb16a4936a6cb4cf5e5f8a781ed616
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 29 14:48:49 2019 -0800

    Add a component tag for every pulsar function (#3468)
    
    * Add a component tag for every pulsar function
    
    * Took feedback into account

 .../pulsar/functions/runtime/KubernetesRuntime.java   | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

commit 0fe9e89ef43d6115066fad783e5da4353a2ccfa6
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Tue Jan 29 12:44:00 2019 -0300

    Fix thread safety violation on ConsumerImpl (#3467)
    
    Using analysing tools on pulsar-client reported the following fixed thread
    safety issues:
    
      - Fix `startMessageId`, `lastDequeuedMessage` and `lastMessageIdInBroker`
        fields reads are performed without synchronization and potentially races
        with write method, turned them into volatile.
      - Fields `possibleSendToDeadLetterTopicMessages`, `deadLetterPolicy` and
        `msgCrypto` can be turned into final to prevent being modified after
        construction.

 .../org/apache/pulsar/client/impl/ConsumerImpl.java  | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

commit 14d478d28247e76e1988fc40b5d77bc5404452ed
Author:  <rxl5555555@qq.com>
Date:   Tue Jan 29 23:43:34 2019 +0800

    [go-client] support produce flush (#3469)
    
    * [go-clint]add producer.GetLastSequenceID in Go client
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments and use LastSequenceID instead of GetLastSequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix consumer and producer test error
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * [pulsar-client-go]provide setSequenceID interface
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add test case for setSequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * rename ID -> SequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * support issue #3417
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix some issues about log and go mod
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * support produce flush[issue#3388]
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add produce flush
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * make format for cpp-client
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-cpp/include/pulsar/c/producer.h |  6 ++++
 pulsar-client-cpp/lib/c/c_Producer.cc         |  8 +++++
 pulsar-client-go/pulsar/c_go_pulsar.h         |  6 ++++
 pulsar-client-go/pulsar/c_producer.go         | 25 +++++++++++++
 pulsar-client-go/pulsar/producer.go           |  4 +++
 pulsar-client-go/pulsar/producer_test.go      | 51 +++++++++++++++++++++++++++
 pulsar-client-go/pulsar/reader_test.go        |  2 +-
 7 files changed, 101 insertions(+), 1 deletion(-)

commit 252ba221cc3fe17ec18be8b3f080ed0da0844d50
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Jan 29 12:45:04 2019 +0800

    Some minor fixes in Kafka-IO and Client-Cli. (#3418)

 .../org/apache/pulsar/client/cli/CmdProduce.java   |  2 +-
 .../apache/pulsar/io/kafka/KafkaSinkConfig.java    |  4 +--
 site2/docs/io-kafka.md                             | 27 +++++++++----------
 site2/docs/reference-cli-tools.md                  | 30 ++++++++++++++--------
 4 files changed, 36 insertions(+), 27 deletions(-)

commit 8b746402a94f0a57f53eedbb174fcaff33edca1d
Author:  <rxl5555555@qq.com>
Date:   Tue Jan 29 12:42:51 2019 +0800

    [go-client] integrated `logrus`, `testify` and `go mod` for pulsar-client-go (#3443)
    
    * [go-clint]add producer.GetLastSequenceID in Go client
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments and use LastSequenceID instead of GetLastSequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix consumer and producer test error
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * [pulsar-client-go]provide setSequenceID interface
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add test case for setSequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * rename ID -> SequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * support issue #3417
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix some issues about log and go mod
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/.gitignore                        |  11 +
 .../consumer-listener/consumer-listener.go         |   2 +-
 pulsar-client-go/examples/consumer/consumer.go     |   2 +-
 pulsar-client-go/examples/producer/producer.go     |   3 +-
 pulsar-client-go/examples/reader/reader.go         |   2 +-
 pulsar-client-go/go.mod                            |   9 +
 pulsar-client-go/go.sum                            |  26 +++
 pulsar-client-go/logutil/log.go                    | 222 +++++++++++++++++++++
 pulsar-client-go/pulsar/c_client.go                |  13 +-
 pulsar-client-go/pulsar/client.go                  |   8 +-
 pulsar-client-go/pulsar/client_test.go             |  31 +--
 pulsar-client-go/pulsar/consumer_test.go           | 103 +++++-----
 pulsar-client-go/pulsar/logger.go                  |  47 -----
 pulsar-client-go/pulsar/producer_test.go           |  53 ++---
 pulsar-client-go/pulsar/reader_test.go             |  71 ++++---
 pulsar-client-go/pulsar/util_test.go               |  29 +--
 16 files changed, 419 insertions(+), 213 deletions(-)

commit 7e1c8047d0f9f1e2f170b9c88084369a7056828e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jan 28 20:42:31 2019 -0800

    Keep function-worker web-server thread configurable (#3464)

 conf/functions_worker.yml                                            | 2 ++
 .../main/java/org/apache/pulsar/functions/worker/WorkerConfig.java   | 5 +++++
 .../java/org/apache/pulsar/functions/worker/rest/WorkerServer.java   | 2 +-
 3 files changed, 8 insertions(+), 1 deletion(-)

commit b051a5cca77aef0cda2436f4447830897bddfb26
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 28 14:59:43 2019 -0800

    Added ZStd in Docker images used for building RPM/Deb packages (#3438)

 pulsar-client-cpp/pkg/deb/Dockerfile | 8 ++++++++
 pulsar-client-cpp/pkg/rpm/Dockerfile | 8 ++++++++
 2 files changed, 16 insertions(+)

commit e8bb6de4121800dd7a19ae68030c413b0a5f3251
Author: wpl <1269223860@qq.com>
Date:   Tue Jan 29 04:03:54 2019 +0800

     [pulsar-client] add BooleanSchema (#3415)

 .../apache/pulsar/common/schema/SchemaType.java    |  6 ++
 .../pulsar/client/impl/schema/BooleanSchema.java   | 70 ++++++++++++++++++++++
 .../client/impl/schema/PrimitiveSchemaTest.java    |  2 +
 3 files changed, 78 insertions(+)

commit 9c6b06e2284b0c3b3d0b9fb9c8839327ca101754
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 28 10:26:52 2019 -0800

    Replaced boost::lexical_cast with std::to_string (#3460)

 pulsar-client-cpp/lib/ClientConnection.cc          |   2 +-
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc     |   7 +-
 pulsar-client-cpp/perf/PerfConsumer.cc             |   4 +-
 pulsar-client-cpp/perf/PerfProducer.cc             |   2 +-
 pulsar-client-cpp/tests/AuthPluginTest.cc          |  15 +-
 pulsar-client-cpp/tests/AuthTokenTest.cc           |  25 ++--
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 151 ++++++++-------------
 pulsar-client-cpp/tests/BatchMessageTest.cc        | 143 +++++++++----------
 pulsar-client-cpp/tests/ClientDeduplicationTest.cc |  15 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |  23 ++--
 pulsar-client-cpp/tests/ReaderTest.cc              |  45 +++---
 11 files changed, 183 insertions(+), 249 deletions(-)

commit 3875220aa4045fec0c83e997a3894b06e54a4c7f
Author: Like <like_0903@163.com>
Date:   Tue Jan 29 00:51:01 2019 +0800

    Fix REST API document link (#3444)
    
    * Fix REST API document link
    
    * Fix unload namespace bundle URL

 site2/docs/admin-api-namespaces.md | 36 ++++++++++++++++++------------------
 1 file changed, 18 insertions(+), 18 deletions(-)

commit 95d02d55300ed1a1b52adcc0d4bd2f317d695b7b
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jan 27 22:17:31 2019 -0800

    Removed remaining import and usages of boost::shared_ptr (#3449)
    
    * Removed remaining import and usages of boost::shared_ptr
    
    * Fixed formatting
    
    * Fixed more imports

 pulsar-client-cpp/lib/Authentication.cc                    | 1 -
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc          | 1 -
 pulsar-client-cpp/lib/ClientConnection.cc                  | 2 --
 pulsar-client-cpp/lib/ClientConnection.h                   | 1 -
 pulsar-client-cpp/lib/ClientImpl.h                         | 1 -
 pulsar-client-cpp/lib/CompressionCodec.h                   | 2 --
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h          | 1 -
 pulsar-client-cpp/lib/ConsumerImpl.h                       | 2 --
 pulsar-client-cpp/lib/EncryptionKeyInfoImpl.h              | 1 -
 pulsar-client-cpp/lib/ExecutorService.cc                   | 2 +-
 pulsar-client-cpp/lib/ExecutorService.h                    | 4 ++--
 pulsar-client-cpp/lib/Future.h                             | 2 --
 pulsar-client-cpp/lib/HandlerBase.h                        | 2 +-
 pulsar-client-cpp/lib/Latch.cc                             | 2 --
 pulsar-client-cpp/lib/Latch.h                              | 2 +-
 pulsar-client-cpp/lib/Message.cc                           | 3 ---
 pulsar-client-cpp/lib/MessageBuilder.cc                    | 2 +-
 pulsar-client-cpp/lib/MessageId.cc                         | 2 +-
 pulsar-client-cpp/lib/MessageImpl.h                        | 2 --
 pulsar-client-cpp/lib/MessageRouterBase.h                  | 5 ++---
 pulsar-client-cpp/lib/MultiTopicsBrokerConsumerStatsImpl.h | 3 +--
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h            | 3 +--
 pulsar-client-cpp/lib/NamespaceName.cc                     | 2 +-
 pulsar-client-cpp/lib/NamespaceName.h                      | 2 +-
 pulsar-client-cpp/lib/PartitionedBrokerConsumerStatsImpl.h | 3 +--
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h            | 3 +--
 pulsar-client-cpp/lib/PartitionedProducerImpl.h            | 5 ++---
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h          | 2 +-
 pulsar-client-cpp/lib/ReaderConfigurationImpl.h            | 1 -
 pulsar-client-cpp/lib/ReaderImpl.h                         | 2 --
 pulsar-client-cpp/lib/Schema.cc                            | 3 +--
 pulsar-client-cpp/lib/ServiceUnitId.h                      | 3 ---
 pulsar-client-cpp/lib/SharedBuffer.h                       | 2 --
 pulsar-client-cpp/lib/TopicName.cc                         | 4 ++--
 pulsar-client-cpp/lib/TopicName.h                          | 1 -
 pulsar-client-cpp/lib/UnAckedMessageTrackerInterface.h     | 2 +-
 pulsar-client-cpp/lib/auth/AuthAthenz.cc                   | 3 +--
 pulsar-client-cpp/lib/auth/AuthAthenz.h                    | 2 +-
 pulsar-client-cpp/lib/c/c_structs.h                        | 4 ++--
 pulsar-client-cpp/perf/PerfProducer.cc                     | 7 +++----
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc         | 2 --
 41 files changed, 29 insertions(+), 70 deletions(-)

commit ee2541577e6a56d6592769a44686113d14670ca2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Jan 27 22:09:09 2019 -0600

    Exposing more methods in Sink/Source Context (#3397)
    
    * Exposing more methods in Sink/Source Context
    
    * remove test code
    
    * update comments
    
    * remove extra space
    
    * addressing comments
    
    * removing unused imports
    
    * fix tests

 .../pulsar/functions/instance/ContextImpl.java     | 10 ++++++
 .../org/apache/pulsar/io/core/SinkContext.java     | 40 ++++++++++++++++++++--
 .../org/apache/pulsar/io/core/SourceContext.java   | 38 ++++++++++++++++++--
 .../io/kafka/source/KafkaAbstractSourceTest.java   | 26 ++++++++++++++
 4 files changed, 108 insertions(+), 6 deletions(-)

commit 2391503c4c3ef978f6d676c0e03718c075a1e19b
Author: Like <like_0903@163.com>
Date:   Mon Jan 28 10:56:23 2019 +0800

    Fix incomplete documentation in cookbooks-retention-expiry (#3451)

 site2/docs/cookbooks-retention-expiry.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0446075447013c26b60654ada75c65b1c4e33278
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sun Jan 27 18:38:27 2019 -0800

    Add set python version script (#3427)

 docker/pulsar/Dockerfile                           |  1 +
 docker/pulsar/scripts/set_python_version.sh        | 32 ++++++++++++++++++++++
 .../docker-images/latest-version-image/Dockerfile  |  1 +
 .../latest-version-image/scripts/run-bookie.sh     |  2 ++
 .../latest-version-image/scripts/run-broker.sh     |  2 ++
 .../scripts/run-functions-worker.sh                |  2 ++
 .../latest-version-image/scripts/run-global-zk.sh  |  2 ++
 .../latest-version-image/scripts/run-local-zk.sh   |  2 ++
 .../scripts/run-presto-worker.sh                   |  2 ++
 .../latest-version-image/scripts/run-proxy.sh      |  3 +-
 .../latest-version-image/scripts/run-standalone.sh | 23 ++++++++++++++++
 11 files changed, 71 insertions(+), 1 deletion(-)

commit 39e0f32b19f2882ea97fc5982252605de6772d1d
Author: Marvin Cai <cai19930303@gmail.com>
Date:   Sun Jan 27 18:38:13 2019 -0800

    Update command usage for pulsar-perf cli command (#2895) (#3452)

 site/_data/cli/pulsar-perf.yaml | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 32e7f337a6c0a889ace58890996d53179123d813
Author: Samuel <foreversunyao@yahoo.com>
Date:   Mon Jan 28 01:18:15 2019 +0800

    UncaughtExceptionLogsNOTWork (#3434)

 .../src/main/java/org/apache/pulsar/PulsarBrokerStarter.java  |  7 ++++++-
 .../discovery/service/server/DiscoveryServiceStarter.java     | 10 +++++++---
 .../org/apache/pulsar/proxy/server/ProxyServiceStarter.java   | 11 ++++++++---
 3 files changed, 21 insertions(+), 7 deletions(-)

commit eda414d6739deebb413c5a25c4acbd6135f418d6
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Sun Jan 27 09:17:26 2019 -0800

    CPP Client - initialize flushedPartitions_ correctly and fix make test rerunnable (#3441)

commit 231db030b9529737237721059b2a5b3044d4cab1
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Sun Jan 27 05:24:53 2019 -0300

    Prevent dup consumers on same client cnx with shared subscription (#3312)
    
    * Prevent dup consumers on same client cnx with shared subscription
    
    Providing help trying to fix issue #3226. Bug description:
    
    When a client attempts to setup more than one consumer subscription on shared
    mode with the same subscription name, due to the validation at broker level of
    `consumerList.size() == 1` on canUnsubscribe() method, broker will throw an
    exception at the moment the client tries to unsubscribe the consumer.
    
    In order to prevent this, the proposed solution (probably not the best one) is
    to detect when the user is trying to setup an already subscribed consumer and
    return this exact same consumer instance.
    
    I believe that is quite strange to have two or more consumers with shared mode
    on the same connection for the same subscription, this might be due to the user
    confusing about consumer shared mode or behaviour, another good solution to
    prevent this from happening might be just throwing an invalid configuration
    exception.
    
    * Adapt tests for bugfix introduced in commit 44e1a23
    
    * Add test case exploiting issue 3326 described in commit 44e1a23

 .../broker/auth/MockedPulsarServiceBaseTest.java   |   9 +-
 .../broker/service/PersistentQueueE2ETest.java     |  34 +++---
 .../broker/service/PersistentTopicE2ETest.java     |   6 +
 .../pulsar/broker/service/ResendRequestTest.java   |  29 +++--
 .../pulsar/client/api/DeadLetterTopicTest.java     |  14 ++-
 .../client/api/DispatcherBlockConsumerTest.java    |   8 +-
 .../api/PartitionedProducerConsumerTest.java       |  14 +++
 .../client/api/SimpleProducerConsumerTest.java     | 132 +++++++++++++++++----
 .../client/api/v1/V1_ProducerConsumerTest.java     |  77 ++++++++----
 .../client/impl/BrokerClientIntegrationTest.java   |   6 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  32 +++--
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   4 +-
 12 files changed, 272 insertions(+), 93 deletions(-)

commit 762e0ab9a52e2665a106766c211d45474adc833b
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Sun Jan 27 00:40:03 2019 -0300

    [Issue #3226][cpp client] Prevent dup consumers on same client cnx (#3403)
    
    Prevent same consumer subscription over the same client connection for cpp
    client. For more details please see explanation on commit 44e1a23.
    
    ### Motivation
    
    Fix #3226 for cpp client.
    
    ### Modifications
    
    Add check for `ClientImpl.cc` to know whether new shared consumer subscribe is already present
    on consumers vector or not.
    
    For further explanation please see #3312
    
    ### Verifying this change
    
    This change added tests and can be verified as follows:
    
      - Add unit test asserting if duplicated consumers are allowed for shared
        subscription.
      - Add test preventing broker metadata error by closing a duplicate consumer
        over the same connection.

 pulsar-client-cpp/lib/ClientImpl.cc          | 10 ++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 47 ++++++++++++++++++++++++++++
 2 files changed, 57 insertions(+)

commit ca690ad6f0ac0102eada79d0a36e0c2a0dc6cf42
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Sat Jan 26 02:04:12 2019 -0800

    CPP Client - Removing boost dependencies from interface. (#3374)
    
    ### Motivation
    
    Want to remove boost dependencies from CPP Client interface.
    
    ### Modifications
    
    Changed boost smart pointers and functions to std.
    
    ### Result
    
    No change in the code logic.

 pulsar-client-cpp/include/pulsar/Authentication.h  |  11 +--
 .../include/pulsar/BrokerConsumerStats.h           |  12 +--
 pulsar-client-cpp/include/pulsar/Client.h          |  14 +--
 .../include/pulsar/ClientConfiguration.h           |   2 +-
 pulsar-client-cpp/include/pulsar/Consumer.h        |   3 +-
 .../include/pulsar/ConsumerConfiguration.h         |  12 +--
 pulsar-client-cpp/include/pulsar/CryptoKeyReader.h |   2 +-
 .../include/pulsar/EncryptionKeyInfo.h             |   4 +-
 pulsar-client-cpp/include/pulsar/Logger.h          |   4 +-
 pulsar-client-cpp/include/pulsar/Message.h         |   4 +-
 pulsar-client-cpp/include/pulsar/MessageBuilder.h  |   2 +-
 pulsar-client-cpp/include/pulsar/MessageId.h       |   4 +-
 .../include/pulsar/MessageRoutingPolicy.h          |   4 +-
 pulsar-client-cpp/include/pulsar/Producer.h        |   6 +-
 .../include/pulsar/ProducerConfiguration.h         |   8 +-
 pulsar-client-cpp/include/pulsar/Reader.h          |   4 +-
 .../include/pulsar/ReaderConfiguration.h           |  10 +-
 pulsar-client-cpp/include/pulsar/Schema.h          |   4 +-
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |   5 +-
 pulsar-client-cpp/lib/BatchMessageContainer.h      |   2 +-
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  |  44 ++++-----
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |   2 +-
 pulsar-client-cpp/lib/BrokerConsumerStats.cc       |   4 +-
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.h    |   2 +-
 .../lib/BrokerConsumerStatsImplBase.h              |   3 +-
 pulsar-client-cpp/lib/Client.cc                    |  11 +--
 pulsar-client-cpp/lib/ClientConfiguration.cc       |   2 +-
 pulsar-client-cpp/lib/ClientConnection.cc          |  10 +-
 pulsar-client-cpp/lib/ClientConnection.h           |  26 +++---
 pulsar-client-cpp/lib/ClientImpl.cc                |  87 ++++++++++--------
 pulsar-client-cpp/lib/ClientImpl.h                 |  15 ++-
 pulsar-client-cpp/lib/Commands.h                   |   2 +-
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |   2 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  62 +++++++------
 pulsar-client-cpp/lib/ConsumerImpl.h               |   9 +-
 pulsar-client-cpp/lib/ConsumerImplBase.h           |   3 +-
 pulsar-client-cpp/lib/ExecutorService.cc           |  14 +--
 pulsar-client-cpp/lib/ExecutorService.h            |  16 ++--
 pulsar-client-cpp/lib/Future.h                     |  16 ++--
 pulsar-client-cpp/lib/HTTPLookupService.cc         |  26 +++---
 pulsar-client-cpp/lib/HTTPLookupService.h          |   2 +-
 pulsar-client-cpp/lib/HandlerBase.cc               |   5 +-
 pulsar-client-cpp/lib/HandlerBase.h                |   4 +-
 pulsar-client-cpp/lib/Latch.cc                     |   2 +-
 pulsar-client-cpp/lib/Latch.h                      |   4 +-
 pulsar-client-cpp/lib/LookupDataResult.h           |   4 +-
 pulsar-client-cpp/lib/LookupService.h              |   6 +-
 pulsar-client-cpp/lib/Message.cc                   |   4 +-
 pulsar-client-cpp/lib/MessageBuilder.cc            |   2 +-
 pulsar-client-cpp/lib/MessageId.cc                 |   4 +-
 .../lib/MultiTopicsBrokerConsumerStatsImpl.h       |   4 +-
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   | 101 +++++++++++----------
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h    |  17 ++--
 pulsar-client-cpp/lib/NamespaceName.cc             |  20 ++--
 pulsar-client-cpp/lib/NamespaceName.h              |  11 +--
 pulsar-client-cpp/lib/ObjectPool.h                 |   7 +-
 .../lib/PartitionedBrokerConsumerStatsImpl.h       |   4 +-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  39 ++++----
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |   6 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  27 +++---
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |   4 +-
 .../lib/PatternMultiTopicsConsumerImpl.cc          |  12 +--
 .../lib/PatternMultiTopicsConsumerImpl.h           |   6 +-
 pulsar-client-cpp/lib/ProducerConfiguration.cc     |   2 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              |  42 +++++----
 pulsar-client-cpp/lib/ProducerImpl.h               |  10 +-
 pulsar-client-cpp/lib/ProducerImplBase.h           |   3 +-
 pulsar-client-cpp/lib/ReaderConfiguration.cc       |   2 +-
 pulsar-client-cpp/lib/ReaderImpl.cc                |  11 ++-
 pulsar-client-cpp/lib/ReaderImpl.h                 |   6 +-
 pulsar-client-cpp/lib/Schema.cc                    |   4 +-
 pulsar-client-cpp/lib/SharedBuffer.h               |   4 +-
 pulsar-client-cpp/lib/TopicName.cc                 |   8 +-
 pulsar-client-cpp/lib/TopicName.h                  |   6 +-
 .../lib/UnAckedMessageTrackerInterface.h           |   2 +-
 pulsar-client-cpp/lib/c/c_ProducerConfiguration.cc |   2 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsBase.h    |   2 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.h    |   2 +-
 pulsar-client-cpp/lib/stats/ProducerStatsBase.h    |   2 +-
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h    |   2 +-
 pulsar-client-cpp/perf/PerfConsumer.cc             |   2 +-
 pulsar-client-cpp/perf/PerfProducer.cc             |   2 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  16 +++-
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |   8 +-
 pulsar-client-cpp/tests/CMakeLists.txt             |   1 +
 pulsar-client-cpp/tests/NamespaceNameTest.cc       |   8 +-
 pulsar-client-cpp/tests/PulsarFriend.h             |   4 +-
 pulsar-client-cpp/tests/TopicNameTest.cc           |  34 +++----
 88 files changed, 489 insertions(+), 464 deletions(-)

commit 1914b25e3aa64c854b39f270842027dcce47b2df
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Jan 25 13:03:53 2019 -0800

    Fix Python packaging docs (#3437)

 site2/docs/functions-quickstart.md | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 8eb4ae290b55d529f466806d2948466ededa2505
Author:  <rxl5555555@qq.com>
Date:   Sat Jan 26 02:54:37 2019 +0800

    [pulsar-client-go]add producer.LastSequenceID and message SequenceID  in Go client (#3416)
    
    * [go-clint]add producer.GetLastSequenceID in Go client
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix comments and use LastSequenceID instead of GetLastSequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * fix consumer and producer test error
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * [pulsar-client-go]provide setSequenceID interface
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * add test case for setSequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>
    
    * rename ID -> SequenceID
    
    Signed-off-by: xiaolong.ran <ranxiaolong716@gmail.com>

 pulsar-client-go/pulsar/c_message.go     |  6 +++++-
 pulsar-client-go/pulsar/c_producer.go    |  8 ++++++--
 pulsar-client-go/pulsar/consumer_test.go | 11 +++++++----
 pulsar-client-go/pulsar/message.go       |  3 +++
 pulsar-client-go/pulsar/producer.go      | 10 +++++++++-
 pulsar-client-go/pulsar/producer_test.go |  9 +++++++--
 6 files changed, 37 insertions(+), 10 deletions(-)

commit 26c1f3d6e2728f0f9ba76c99060c7627003b4d07
Author: Like <like_0903@163.com>
Date:   Sat Jan 26 00:52:48 2019 +0800

    Use equals to check if two strings are equal (#3429)

 .../src/main/java/org/apache/pulsar/admin/cli/PulsarAdminTool.java   | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

commit 6c69edfef74b52a0a0b59cab5be688d0064bce23
Author: wpl <1269223860@qq.com>
Date:   Sat Jan 26 00:52:13 2019 +0800

    fix cp: target '/pulsar/generated-site/content' is not a directory (#3433)

 site2/tools/docker-build-site.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5657797e1ef75b882e85759bd3a5f52b70584d3f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jan 25 01:08:53 2019 -0600

     refactor AuthorizationProvider interface to allow custom logic for determining super user (#3383)
    
    * refactor AuthorizationProvider interface to allow custom logic for determining super user
    
    * remove redundant super user checks
    
    * addressing comments
    
    * simplifying code
    
    * cleaning up code
    
    * making API backwards compatible
    
    * fixing tests

 .../authorization/AuthorizationProvider.java       | 13 ++++-
 .../broker/authorization/AuthorizationService.java | 38 +++++++++++----
 .../authorization/PulsarAuthorizationProvider.java | 21 ++------
 .../pulsar/broker/web/PulsarWebResource.java       | 56 ++++++++++++++++------
 .../pulsar/broker/service/ServerCnxTest.java       |  6 +--
 .../api/AuthorizationProducerConsumerTest.java     |  9 ++++
 6 files changed, 98 insertions(+), 45 deletions(-)

commit 32559577eec1feffe57aeb6c2ca3595920b8c023
Author: wpl <1269223860@qq.com>
Date:   Fri Jan 25 13:52:26 2019 +0800

    Use topics in public/default namespaces for kafka ProducerExample and ConsumerExample (#3401)
    
    Update ProducerExample and ConsumerExample to use topics in public/default namespace.

 .../org/apache/pulsar/client/kafka/compat/examples/ConsumerExample.java | 2 +-
 .../org/apache/pulsar/client/kafka/compat/examples/ProducerExample.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 14390dad7d6dbbc9097efd062429238630905bbc
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 24 16:39:24 2019 -0800

    Cancel timeout timer in ClientCnx (#3422)

 .../src/main/java/org/apache/pulsar/client/impl/ClientCnx.java    | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 9184c34b103e874502426d2b7d42779326b28b46
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 24 15:40:02 2019 -0600

    Fix: Bug in function triggering (#3406)
    
    * fix function trigger
    
    * simplifying code

 .../java/org/apache/pulsar/functions/source/PulsarSource.java | 11 +----------
 .../pulsar/functions/worker/rest/api/ComponentImpl.java       |  9 ++++++---
 2 files changed, 7 insertions(+), 13 deletions(-)

commit fdbdb9692e50e265962f10a5cfe4a5aad4a3eea0
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Fri Jan 25 05:15:25 2019 +0800

    Use ConsumerConfig instead of ProducerConfig in PulsarKafkaConsumer (#3394)

 .../java/org/apache/kafka/clients/consumer/PulsarKafkaConsumer.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 9a1bd81e694e2a4242775405ee0ae235de3aeaba
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 24 10:10:05 2019 -0800

    Added support for ZSTD compression (#3159)
    
    * Added support for ZSTD compression
    
    * Fixed C++ formatting
    
    * Added warning in javadoc
    
    * Fixed comment format
    
    * Fixed exception include
    
    * Fixed exception mistake
    
    * Added ztsd to presto license file

 build/docker/Dockerfile                            |  2 +-
 distribution/server/licenses/LICENSE-zstd-jni.txt  | 26 ++++++++
 distribution/server/src/assemble/LICENSE.bin.txt   |  1 +
 pom.xml                                            |  7 ++
 .../apache/pulsar/client/api/CompressionType.java  |  5 +-
 .../apache/pulsar/client/api/ProducerBuilder.java  |  8 ++-
 pulsar-client-cpp/CMakeLists.txt                   | 16 +++++
 pulsar-client-cpp/docker/Dockerfile                |  8 +++
 pulsar-client-cpp/include/pulsar/CompressionType.h |  3 +-
 .../include/pulsar/ProducerConfiguration.h         | 13 ++++
 pulsar-client-cpp/lib/CompressionCodec.cc          |  8 +++
 pulsar-client-cpp/lib/CompressionCodec.h           |  2 +
 pulsar-client-cpp/lib/CompressionCodecZstd.cc      | 69 +++++++++++++++++++
 pulsar-client-cpp/lib/CompressionCodecZstd.h       | 31 +++++++++
 pulsar-client-cpp/python/pulsar/__init__.py        |  4 +-
 pulsar-client-cpp/python/pulsar_test.py            | 26 +++++++-
 pulsar-client-cpp/python/src/enums.cc              |  1 +
 pulsar-client-go/pulsar/producer.go                |  5 ++
 pulsar-client-go/pulsar/producer_test.go           | 30 +++++++++
 pulsar-common/pom.xml                              |  5 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  3 +
 .../compression/CompressionCodecProvider.java      |  5 ++
 .../common/compression/CompressionCodecZstd.java   | 77 ++++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  1 +
 .../common/compression/CompressorCodecTest.java    |  2 +-
 pulsar-sql/presto-distribution/LICENSE             |  2 +
 site2/docs/client-libraries-go.md                  |  2 +-
 site2/docs/concepts-messaging.md                   |  1 +
 site2/docs/reference-cli-tools.md                  |  3 +-
 29 files changed, 353 insertions(+), 13 deletions(-)

commit 0ec897f7348bc5c7262b2dcce6e6b5f9a5343b0f
Author: Jia Zhai <zhaijia@apache.org>
Date:   Fri Jan 25 00:38:00 2019 +0800

    Issue #3332: fix httplookup issue for get ns/topics in cpp (#3407)
    
    * fix httplookup issue for get ns/topics
    
    * change following comments

 pulsar-client-cpp/lib/HTTPLookupService.cc   |  9 ++-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 95 ++++++++++++++++++++++++++++
 2 files changed, 101 insertions(+), 3 deletions(-)

commit 358d4e75d73314a380202ab0302ede84567215ab
Author: Like <like_0903@163.com>
Date:   Thu Jan 24 09:01:32 2019 +0800

    Add a running flag for Kafka source connector (#3310)
    
    ### Motivation
    
    Currently, if we pass an invalid source configuration to instantiate ```KafkaConsumer``` we will get no log even there is an exception thrown. And after ```close()``` called, the background thread may still alive unless we caught an ```InterruptedException``` if ```kafkaSourceConfig.isAutoCommitEnabled()``` returns ```false```. So I would like to add a flag to indicate if the connector is stopped.

 .../pulsar/io/kafka/KafkaAbstractSource.java       |  34 +++---
 .../io/kafka/source/KafkaAbstractSourceTest.java   | 118 +++++++++++++++++++++
 2 files changed, 138 insertions(+), 14 deletions(-)

commit 55f98545863267fa415f3c8495aea18b91f8f77a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 23 12:25:26 2019 -0800

    Fix race condition: broker not scheduling read for active consumer (#3411)

 .../service/persistent/PersistentDispatcherSingleActiveConsumer.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 02cddfd8386860045378a16afa33820622f0759f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jan 21 14:51:17 2019 -0800

    [cpp-client] add support of receiveAsync API (#3389)
    
    ### Motivation
    
    In many cases, client requires receiveAsync() api in Consumer. This api is already available into java-client but doesn't exist into CPP-client.
    
    ### Modification
    
    Add support for receiveAsync() api in cpp-client consumer.
    
    This PR is rebased and reopened from #577

 pulsar-client-cpp/include/pulsar/Consumer.h        |  13 +
 .../include/pulsar/ConsumerConfiguration.h         |   1 +
 pulsar-client-cpp/lib/Consumer.cc                  |   9 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  87 +++++-
 pulsar-client-cpp/lib/ConsumerImpl.h               |   5 +
 pulsar-client-cpp/lib/ConsumerImplBase.h           |   1 +
 pulsar-client-cpp/lib/HandlerBase.h                |   1 +
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   |  56 +++-
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h    |   5 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  58 +++-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |   5 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 316 ++++++++++++++++++++-
 12 files changed, 532 insertions(+), 25 deletions(-)

commit b9370c3615b1c16bfb9aaa94f6b5f466f2ef81a3
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Mon Jan 21 23:14:42 2019 +0800

    Support to set subscriptionTopicsMode via properties. (#3395)

 .../client/kafka/compat/PulsarConsumerKafkaConfig.java     | 14 ++++++++++++++
 site2/docs/adaptors-kafka.md                               |  1 +
 2 files changed, 15 insertions(+)

commit 7460e5ad235981f1c633a8ed780991c15e7eb81f
Author: wpl <1269223860@qq.com>
Date:   Mon Jan 21 23:09:59 2019 +0800

    Issue #3375 Websocket example not working (#3393)
    
    * Fix #3375 Websocket example not working
    
    * Fix #3375 Websocket example not working
    
    * Fix Websocket example not working

 site/docs/latest/clients/WebSocket.md              |  6 +++---
 site/ja/clients/WebSocket.md                       | 23 +++++++++++++++++-----
 site2/docs/client-libraries-websocket.md           |  6 +++---
 .../client-libraries-websocket.md                  |  6 +++---
 .../version-2.2.0/client-libraries-websocket.md    |  6 +++---
 .../version-2.2.1/client-libraries-websocket.md    |  6 +++---
 6 files changed, 33 insertions(+), 20 deletions(-)

commit da232c27d47a22f088bf0ffd04615c214fa34b40
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Mon Jan 21 16:39:58 2019 +0800

    Add acks group time of consumer property in Kafka Wrapper doc. (#3392)
    
    ### Motivation
    
    Kafka Wrapper doc minor improvement.
    
    ### Modifications
    
    Add acks group time of consumer property in Kafka Wrapper.

 site2/docs/adaptors-kafka.md | 1 +
 1 file changed, 1 insertion(+)

commit 547883e1c01aa4c7bb375d457f5a582379f4bd75
Author: Like <like_0903@163.com>
Date:   Sun Jan 20 11:12:47 2019 +0800

    Remove global-zookeeper in documentation (#3307)
    
    ### Motivation
    
    Replace all ```global zookeeper``` with  ```configuration store``` in all documents.
    
    Relates to #3338
    Closes #3305

 site/_data/config/broker.yaml                        |  4 ++--
 site/_data/config/discovery.yaml                     |  4 ++--
 site/_data/config/standalone.yaml                    |  4 ++--
 site/_data/config/websocket.yaml                     |  2 +-
 site/_data/popovers-ja.yaml                          |  6 +++---
 site/_includes/explanations/deploying-zk.md          | 12 ++++++------
 site/_includes/explanations/ja/cluster-admin.md      |  4 ++--
 site/_includes/explanations/ja/deploying-zk.md       | 20 ++++++++++----------
 .../explanations/ja/service-discovery-setup.md       |  6 +++---
 site/docs/latest/admin-api/clusters.md               |  4 ++--
 site/docs/latest/admin/Proxy.md                      |  2 +-
 site/docs/latest/admin/ZooKeeperBookKeeper.md        |  8 ++++----
 site/docs/latest/clients/WebSocket.md                |  4 ++--
 site/docs/latest/deployment/Kubernetes.md            |  2 +-
 site/docs/latest/deployment/Monitoring.md            |  4 ++--
 site/docs/latest/deployment/instance.md              |  2 +-
 site/docs/latest/getting-started/LocalCluster.md     |  2 +-
 site/ja/admin/ZooKeeperBookKeeper.md                 |  8 ++++----
 site/ja/clients/WebSocket.md                         |  4 ++--
 site/ja/deployment/InstanceSetup.md                  | 14 +++++++-------
 site/ja/deployment/Kubernetes.md                     |  2 +-
 site/ja/getting-started/ConceptsAndArchitecture.md   |  6 +++---
 site/ja/getting-started/LocalCluster.md              |  2 +-
 site/ja/reference/Configuration.md                   |  6 +++---
 site2/docs/admin-api-clusters.md                     |  4 ++--
 site2/docs/administration-zk-bk.md                   | 18 +++++++++---------
 site2/docs/client-libraries-websocket.md             |  4 ++--
 site2/docs/deploy-bare-metal-multi-cluster.md        | 14 +++++++-------
 site2/docs/deploy-kubernetes.md                      |  2 +-
 site2/docs/deploy-monitoring.md                      |  4 ++--
 site2/docs/getting-started-standalone.md             |  2 +-
 site2/docs/reference-configuration.md                |  8 ++++----
 site2/docs/reference-terminology.md                  |  2 +-
 .../version-2.1.0-incubating/admin-api-clusters.md   |  4 ++--
 .../version-2.1.0-incubating/administration-proxy.md |  2 +-
 .../version-2.1.0-incubating/administration-zk-bk.md | 18 +++++++++---------
 .../client-libraries-websocket.md                    |  4 ++--
 .../deploy-bare-metal-multi-cluster.md               | 14 +++++++-------
 .../version-2.1.0-incubating/deploy-kubernetes.md    |  2 +-
 .../version-2.1.0-incubating/deploy-monitoring.md    |  4 ++--
 .../getting-started-standalone.md                    |  2 +-
 .../reference-configuration.md                       |  8 ++++----
 .../version-2.1.1-incubating/administration-proxy.md |  2 +-
 .../getting-started-standalone.md                    |  2 +-
 .../reference-configuration.md                       |  8 ++++----
 .../version-2.2.0/client-libraries-websocket.md      |  4 ++--
 .../version-2.2.0/deploy-bare-metal-multi-cluster.md | 14 +++++++-------
 .../version-2.2.0/getting-started-standalone.md      |  2 +-
 .../version-2.2.0/reference-configuration.md         |  8 ++++----
 .../version-2.2.1/client-libraries-websocket.md      |  4 ++--
 .../version-2.2.1/getting-started-standalone.md      |  2 +-
 .../version-2.2.1/reference-configuration.md         |  8 ++++----
 52 files changed, 151 insertions(+), 151 deletions(-)

commit c8b274a223b7bfdcbefd21748c81affa8b178eaa
Author: Samuel <foreversunyao@yahoo.com>
Date:   Sun Jan 20 11:11:52 2019 +0800

    create_topic_with_check_namespaces_cluster (#3365)
    
    ### Motivation
    
    add check namespaces already have the cluster assigned when create topic.
    
    **the old way**:
    creating topic will not check  if namespaces have broker cluster assigned, but after you created topic successfully , and ran **./pulsar-admin topics list tenant/namespace**, it will prompt **Namespace does not have any clusters configured : local_cluster=** and show nothing.
    
    **the good way**:
    check the namespace has already assigned to broker cluster when you are trying to create the topic.
    
    ### Modifications
    
    NonPersistentTopics.java and PersistentTopics.java for admin v2 interface

 .../apache/pulsar/broker/admin/AdminResource.java  | 13 +++++++++++
 .../broker/admin/v2/NonPersistentTopics.java       |  5 ++++-
 .../pulsar/broker/admin/v2/PersistentTopics.java   |  4 +++-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 25 ++++++++++++++++++++++
 4 files changed, 45 insertions(+), 2 deletions(-)

commit d94866a89dc2217fc64fd4f6f8504dc5b8e5a1c4
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Sun Jan 20 11:10:04 2019 +0800

    Support CLI pulsar-client for concise description. (#3381)
    
    ### Motivation
    Fixes [#3364](https://github.com/apache/pulsar/issues/3364)
    
    ### Modifications
    
    Print corresponding usage according to the parsed command.

 .../src/main/java/org/apache/pulsar/client/cli/PulsarClientTool.java   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 9be59964ca10b237d67b7d767caf7a2c01a8629f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Jan 19 19:09:11 2019 -0800

    [cpp-build] add argument to cpp incremental build (#3385)
    
    ### Motivation
    
    Provide a way to build pulsar-cpp client with incremental build option to avoid building it entirely and save build time.
    
    ### Modifications
    
     avoid cleaning build cache files.
    
    
    ### Result
    User can perform incremental build by `./docker-build.sh skip-clean`

 pulsar-client-cpp/docker-build.sh | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit f669d7d254383489d4d23c123b2410026b076457
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Sun Jan 20 11:08:29 2019 +0800

    Amend several typos in Kafka Wrapper doc. (#3387)
    
    ### Motivation
    Kafka Wrapper doc minor improvement.
    
    ### Modifications
    Amend several typos in Kafka Wrapper.

 site2/docs/adaptors-kafka.md | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 550bccb881134a9d4e69a359e6fb0273fb77e47c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jan 18 09:52:36 2019 -0800

    fix get topic name for input message (#3384)

 pulsar-functions/instance/src/main/python/python_instance.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 484efa2b7861c6d0c6d04012ed4f2b0148c2402b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jan 18 09:15:29 2019 -0800

    [cpp-build] support run specific cpp-test using docker build script (#3386)

 pulsar-client-cpp/docker-tests.sh   | 23 +++++++++++++++++++++--
 pulsar-client-cpp/run-unit-tests.sh |  9 +++++++--
 2 files changed, 28 insertions(+), 4 deletions(-)

commit d1b8f94ec477cf6e262550a88952954b83558219
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Thu Jan 17 07:08:58 2019 -0800

    Java Client - Prevent printing authentication data in INFO logs. (#3377)
    
    ### Motivation
    
    Currently, we print auth data in info logs - roleToken, private key info etc.
    
    ### Modifications
    
    Print ClientConfiguration without authentication field.
    
    ### Result
    
    We will no longer print sensitive info.

 .../java/org/apache/pulsar/client/impl/ConsumerStatsRecorderImpl.java   | 2 +-
 .../java/org/apache/pulsar/client/impl/ProducerStatsRecorderImpl.java   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 757c3f925ce5c216a733d3a7150e844a320c1e2b
Author: wpl <1269223860@qq.com>
Date:   Thu Jan 17 15:36:47 2019 +0800

    Issue #3373: RemotelyClosedException when running SampleProducer
    
    *Motivation*
    
    Fixes #3373
    
    The service url in SampleProducer is wrong.
    
    *Modification*
    
    Fix the service url in SampleProducer and SampleConsumer.

 .../src/test/java/org/apache/pulsar/client/tutorial/SampleConsumer.java | 2 +-
 .../src/test/java/org/apache/pulsar/client/tutorial/SampleProducer.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 9e5d9dee7db83ba79b206f4c5241cad9838f755d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 17 15:35:08 2019 +0800

    [dev] PIP 27: Add checklist in github pull request template (#3252)
    
    *Motivation*
    
    With the increase of contributions, more and more features are
    added pretty quickly. However these features are not documented.
    And there is no checklist for contributors to check when
    contributing a feature.
    
    *Changes*
    
    This PIP is proposing to improve the github pull request template
    by adding a checklist for contributors to check. It also help
    improve the review process.

 .github/PULL_REQUEST_TEMPLATE.md | 72 +++++++++++++++++++++++++++++++++++++---
 1 file changed, 67 insertions(+), 5 deletions(-)

commit 8e4b27d6d73d18a9ef4b124f7b66e8d468ead691
Author: penghui <codelipenghui@gmail.com>
Date:   Thu Jan 17 08:40:40 2019 +0800

    Fix bug consumer stop consume(issue-3131) (#3358)
    
    Motivation
    Fix #3131
    When dispatcher is blocked and consumer blocked by un-ack messages, if consumer redelivery count < permitsReceivedWhileConsumerBlocked will cause dispatcher never send a message to the consumer again.
    
    Modifications
    Use permitsReceivedWhileConsumerBlocked to release dispatcher permits control.
    
    Result
    UT Passed.

 .../src/main/java/org/apache/pulsar/broker/service/Consumer.java      | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit 934d80d4e24c54eaa6bac59bd99bfc8d352db661
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 16 16:40:01 2019 -0800

    Fixed links to RPM/Deb package signature files (#3371)
    
    Motivation
    Fixes #3370 . The links should point to ASF dist server as the source of truth for package signatures.

 site2/docs/client-libraries-cpp.md | 10 +++++-----
 site2/website/scripts/replace.js   | 29 +++++++++++++++++++++++++++++
 2 files changed, 34 insertions(+), 5 deletions(-)

commit a704afd1946c5648f06b12031320359d5aef623d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jan 15 07:16:41 2019 -0800

    Support Add-entry timeout at broker to avoid stuck topics (#3347)
    
    ### Motivation
    
    Recently and in past, we have seen few instances where bookie crashes when it goes out of memory and kernel panics and broker doesn't complete add-entry callback because of that topics get stuck on pending-writes.
    
    ```
    2010-01-01T00:18:19+0000 2010-01-01 00:18:19,594 21907 report_stuck:556 WARNING persistent://prop1/global/prod-rt-mxt/extractions-partition-0 is stuck (broker1.us-west1.com): waiting for write
    2010-01-01T00:18:22+0000 2010-01-01 00:18:22,654 21907 report_stuck:556 WARNING persistent://prop1/global/mbr-events/27_bf1 is stuck (broker1.us-west1.com): waiting for write
    2010-01-01T00:19:10+0000 2010-01-01 00:19:10,790 21907 report_stuck:556 WARNING persistent://prop1/global/mbr-events/30_bf1 is stuck (broker1.us-west1.com): waiting for write
    2010-01-01T00:19:14+0000 2010-01-01 00:19:14,692 21907 report_stuck:556 WARNING persistent://prop1/global/mbr-events/35_gq2 is stuck (broker1.us-west1.com): waiting for write
    2010-01-01T00:19:15+0000 2010-01-01 00:19:15,809 21907 report_stuck:556 WARNING persistent://prop1/global/jedi-events/batchevents-partition-35 is stuck (broker1.us-west1.com): waiting for write
    2010-01-01T00:19:25+0000 2010-01-01 00:19:25,127 21907 report_stuck:556 WARNING persistent://prop1/global/jedi-events/mailevents-partition-24 is stuck (broker1.us-west1.com): waiting for write
    ```
    
    internal-stats
    ```
    {
      "entriesAddedCounter" : 66066317,
      "numberOfEntries" : 14129359,
      "totalSize" : 145505085493,
      "currentLedgerEntries" : 238938,
      "currentLedgerSize" : 3715327400,
      "lastLedgerCreatedTimestamp" : "2018-11-27 00:03:03.125+0000",
      "waitingCursorsCount" : 0,
      "pendingAddEntriesCount" : 252514,
      "lastConfirmedEntry" : "489781963:26121",
      "state" : "ClosingLedger",
      "ledgers" : [ {
        "ledgerId" : 489765238,
        "entries" : 559855,
        "size" : 6928710817
      }, {
    ...
    ```
    
    ### Modifications
    
    Add support of write timeout which can be disable by configuring timeout=0.
    
    ### Result
    
    topic will not stuck in pending write in case add-entry callback doesn't completes.

 conf/broker.conf                                   |  3 +
 conf/standalone.conf                               |  3 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    | 16 ++++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 30 ++++++++
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java | 67 +++++++++++++++---
 .../bookkeeper/client/PulsarMockLedgerHandle.java  |  2 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 82 ++++++++++++++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  9 ++-
 .../pulsar/broker/service/BrokerService.java       |  1 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  7 ++
 .../client/impl/BrokerClientIntegrationTest.java   | 76 +++++++++++++++++++-
 site/_data/config/broker.yaml                      |  3 +
 12 files changed, 282 insertions(+), 17 deletions(-)

commit 47389910c92c6e45d71fa2ddb67a342f8351235e
Author: Ezequiel Lovelle <ezequiellovelle@gmail.com>
Date:   Tue Jan 15 12:15:55 2019 -0300

    Bug fixes/Improvement for notify pending receive method (#3337)
    
    ### Motivation
    
    Prevent 2 bugs and refactoring for method [notifyPendingReceivedCallback()](https://github.com/apache/pulsar/blob/master/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java#L912)
    
    ### Modifications
    
      - Bugfix interceptor missed event when prefetch messages is disabled by
        consumer `ReceiverQueueSize == 0`.
      - Bugfix when message is null and no exception is present. Previously to this
        commit testing if message was null was made by `checkNotNull()` method leaving
        consumed future without completion resulting in a hanged future.
      - Refactor to favour simplicity and readability for control flow.
      - Add unit tests exploiting bug fixes.
    
    ### Result
    
    Bug fixes and more maintainable code.

 .../apache/pulsar/client/impl/ConsumerImpl.java    |  57 ++++++---
 .../pulsar/client/impl/ConsumerImplTest.java       | 136 +++++++++++++++++++++
 2 files changed, 173 insertions(+), 20 deletions(-)

commit 49a271f0be2b6a0e2a0776f3876c604b629f459c
Author: Fangbin Sun <sunfangbin@gmail.com>
Date:   Tue Jan 15 23:06:39 2019 +0800

    Add a consumer example in deploy-bare-metal doc for a new beginner. (#3372)
    
    ### Motivation
    
    It is better to add a consumer example in deploying a pulsar cluster for new beginners.
    
    ### Modifications
    
    Amend a typo in pulsar-client producer example and add a consumer example.

 site2/docs/deploy-bare-metal.md | 19 +++++++++++++++++--
 1 file changed, 17 insertions(+), 2 deletions(-)

commit 63a0491ec86a4123062eb2835d6f385bf79e2552
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 14 09:55:02 2019 -0800

    Enable stats to be recovered by Kubernetes runtime (#3363)

 .../pulsar/functions/runtime/JavaInstanceMain.java |  2 +-
 .../functions/runtime/KubernetesRuntime.java       | 26 +++++++++++++++++--
 .../pulsar/functions/runtime/ProcessRuntime.java   |  2 +-
 .../apache/pulsar/functions/runtime/Runtime.java   |  2 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |  2 +-
 .../functions/worker/FunctionRuntimeManager.java   |  2 +-
 .../org/apache/pulsar/functions/worker/Utils.java  | 17 +++---------
 .../functions/worker/rest/api/WorkerImpl.java      | 30 ++++++++++++++++------
 8 files changed, 55 insertions(+), 28 deletions(-)

commit bf2a9c7b84f1c749bfabdc21a2926b017caa61ad
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 14 09:54:49 2019 -0800

    Add Windowfunction interface to functions api (#3324)
    
    * Added WindowFunction interface and implementation
    
    * Fixed logic
    
    * Update comments
    
    * Took feedback into account

 .../pulsar/functions/api}/WindowContext.java       |  2 +-
 .../pulsar/functions/api/WindowFunction.java       | 34 ++++++++++++
 .../functions/windowing/WindowContextImpl.java     |  1 +
 .../windowing/WindowFunctionExecutor.java          | 64 ++++++++++++----------
 .../windowing/WindowFunctionExecutorTest.java      | 27 +++++----
 ...{WindowFunction.java => AddWindowFunction.java} |  2 +-
 .../api/examples/ContextWindowFunction.java        | 41 ++++++++++++++
 .../resources/example-window-function-config.yaml  |  2 +-
 .../org/apache/pulsar/functions/utils/Utils.java   | 34 ++++++++----
 9 files changed, 153 insertions(+), 54 deletions(-)

commit 034f6ba04e9c48abec1517668cb4fa46efdf02bc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jan 14 09:54:23 2019 -0800

     Cleanup consumer subscriptions and fix graceful shutdown for functions/sinks (#3299)
    
    * Cleanup consumer subscriptions and fix graceful shutdown for functions
    
    * cleaning up
    
    * removing testing files
    
    * add unit tests
    
    * adding integration testing
    
    * refactoring
    
    * refactoring and adding tests
    
    * cleaning up

 .../worker/PulsarWorkerAssignmentTest.java         |   2 +
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 168 ++++++++++++++++++++-
 .../pulsar/common/functions/FunctionConfig.java    |   2 +
 .../org/apache/pulsar/common/io/SinkConfig.java    |   3 +-
 .../pulsar/functions/instance/InstanceUtils.java   |  12 ++
 .../functions/instance/JavaInstanceRunnable.java   |   4 +-
 .../functions/source/PulsarSourceConfig.java       |   1 +
 .../instance/src/main/python/Function_pb2.py       |  47 +++---
 .../instance/src/main/python/function_stats.py     |   2 +-
 .../instance/src/main/python/python_instance.py    |  22 ++-
 .../src/main/python/python_instance_main.py        |   4 +-
 pulsar-functions/instance/src/main/python/util.py  |   4 +-
 .../proto/src/main/proto/Function.proto            |   1 +
 .../pulsar/functions/runtime/ProcessRuntime.java   |  29 +++-
 .../pulsar/functions/runtime/ThreadRuntime.java    |   2 +
 .../functions/utils/FunctionConfigUtils.java       |   5 +
 .../pulsar/functions/utils/SinkConfigUtils.java    |   6 +
 .../pulsar/functions/worker/FunctionAction.java    |   3 +-
 .../pulsar/functions/worker/FunctionActioner.java  |  85 +++++++++--
 .../functions/worker/FunctionRuntimeManager.java   |  34 ++++-
 .../pulsar/functions/worker/WorkerService.java     |   8 +-
 .../functions/worker/FunctionActionerTest.java     |   5 +-
 .../worker/FunctionRuntimeManagerTest.java         |  25 +--
 .../functions/worker/MembershipManagerTest.java    |  32 ++--
 .../integration/functions/PulsarFunctionsTest.java |  20 +++
 25 files changed, 439 insertions(+), 87 deletions(-)

commit c793ad68a3b3bf6d094924e7c0ee7f3f4eba1f7d
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sun Jan 13 22:21:32 2019 -0800

    Add doc entry for packaging python dependencies. (#3321)
    
    This is document entry for instructions to package python dependencies for functions.

 site2/docs/functions-quickstart.md | 72 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 72 insertions(+)

commit 13d6c62ed507d6b912a8fd69882fa799f6df71fd
Author: Hans Meyer <hansifer@users.noreply.github.com>
Date:   Sun Jan 13 22:07:38 2019 -0700

    fix type warn -> warm (#3366)

 site2/docs/concepts-overview.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 221e5c72ec8e72b8f4e39c38c6a75790dec1217f
Author: wpl <1269223860@qq.com>
Date:   Sun Jan 13 09:26:36 2019 +0800

    issues #3264 fix partitioned-stats reporting errors not match (#3339)
    
    fixes #3264

 .../org/apache/pulsar/broker/admin/AdminResource.java     |  9 +++++++++
 .../pulsar/broker/admin/impl/PersistentTopicsBase.java    | 14 +++++++++++++-
 .../java/org/apache/pulsar/broker/admin/AdminApiTest.java | 15 ++++++---------
 3 files changed, 28 insertions(+), 10 deletions(-)

commit 272725a9ca4d0334df54aff4b751105949d2c253
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Jan 13 10:17:16 2019 +0900

    [client] Issue 3218: Support specifying multiple hosts in pulsar service url and web url (#3249)
    
    *Motivation*
    
    Sometimes people doesn't have DNS for brokers. It might be good for people to specify a list of brokers as bootstrap brokers.
    
    *Changes*
    
    This PR introduce `ServiceURI` and `ServiceNameResolver` for supporting specifying multiple hosts in pulsar service url and
    web url.
    
    Master Issue: #3218

 .../pulsar/client/api/ServiceUrlProviderTest.java  |  26 ++-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |   6 +-
 .../client/impl/BinaryProtoLookupService.java      |  27 +--
 .../org/apache/pulsar/client/impl/HttpClient.java  |  23 +-
 .../pulsar/client/impl/HttpLookupService.java      |   2 +-
 .../client/impl/PulsarServiceNameResolver.java     | 104 +++++++++
 .../pulsar/client/impl/ServiceNameResolver.java    |  65 ++++++
 .../client/impl/PulsarServiceNameResolverTest.java | 132 ++++++++++++
 .../org/apache/pulsar/common/net/ServiceURI.java   | 205 ++++++++++++++++++
 .../apache/pulsar/common/net/ServiceURITest.java   | 233 +++++++++++++++++++++
 10 files changed, 785 insertions(+), 38 deletions(-)

commit 617712e2913c8f53873e60631905b7d14ccd947b
Author: tuteng <eguangning@gmail.com>
Date:   Sat Jan 12 10:41:38 2019 +0800

    Support TLS authentication and authorization in standalone mode (#3360)

 .../src/main/java/org/apache/pulsar/PulsarStandalone.java    | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

commit 1484711d69fc25e50a8ff0a0aa7d6ee1180c1fd0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jan 11 18:24:53 2019 -0800

    fix dep to make build compatible with jdk11 (#3357)

 pulsar-sql/presto-distribution/pom.xml | 4 ++++
 1 file changed, 4 insertions(+)

commit 7ec205ad5733bbbc9d99da16ed4721221bb5b315
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Fri Jan 11 13:27:36 2019 -0800

    Added HTTP Support (#3336)
    
    * Added HTTP Support
    
    * Updated documentation and removed duplicate code
    
    * Added unit test for NettyHttpChannelInitializer

 .../org/apache/pulsar/io/netty/NettySource.java    |   7 +-
 .../apache/pulsar/io/netty/NettySourceConfig.java  |  19 ++-
 .../io/netty/http/NettyHttpChannelInitializer.java |  48 +++++++
 .../io/netty/http/NettyHttpServerHandler.java      | 144 +++++++++++++++++++++
 .../apache/pulsar/io/netty/http/package-info.java  |  19 +++
 .../org/apache/pulsar/io/netty/package-info.java   |  19 +++
 .../io/netty/server/NettyChannelInitializer.java   |   2 +-
 .../apache/pulsar/io/netty/server/NettyServer.java |  70 ++++++----
 .../pulsar/io/netty/server/NettyServerHandler.java |  13 +-
 .../pulsar/io/netty/server/package-info.java       |  19 +++
 .../http/NettyHttpChannelInitializerTest.java      |  45 +++++++
 site2/docs/io-connectors.md                        |   2 +-
 site2/docs/io-netty.md                             |   4 +-
 13 files changed, 368 insertions(+), 43 deletions(-)

commit 210d828419f8247e6999051c66ee99be544a6221
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Fri Jan 11 10:29:36 2019 -0800

    Added filtering to Twitter Firehose Connector (#3298)

 pulsar-io/twitter/pom.xml                          |  12 +++
 .../apache/pulsar/io/twitter/TwitterFireHose.java  | 109 +++++++-------------
 .../pulsar/io/twitter/TwitterFireHoseConfig.java   |  88 +++++++++++++++--
 .../pulsar/io/twitter/{ => data}/TweetData.java    |  24 ++++-
 .../pulsar/io/twitter/data/TwitterRecord.java      |  66 +++++++++++++
 .../pulsar/io/twitter/data/package-info.java       |  19 ++++
 .../twitter/endpoint/SampleStatusesEndpoint.java   |  42 ++++++++
 .../pulsar/io/twitter/endpoint/package-info.java   |  19 ++++
 .../org/apache/pulsar/io/twitter/package-info.java |  19 ++++
 .../io/twitter/TwitterFireHoseConfigTests.java     | 110 +++++++++++++++++++++
 .../twitter/src/test/resources/sourceConfig.yaml   |  23 +++++
 11 files changed, 443 insertions(+), 88 deletions(-)

commit b14aca85f4a8d0dee431b16211cfd3b707da8b5c
Author: Seb Ospina <kraige@gmail.com>
Date:   Fri Jan 11 19:28:39 2019 +0100

    Minor typo (cd instead of cp) (#3301)
    
    Additionally, since it's a directory, adding `-r` to cp.

 site2/docs/getting-started-standalone.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit aa2036309c4804c08976675ecdf7f2abcf0ddd0e
Author: Vincent Xie <vinceshieh@gmail.com>
Date:   Sat Jan 12 02:28:22 2019 +0800

    Fix title and content mismatch issue in cookbooks-partitioned.md (#3349) (#3353)
    
    * Fix title and content mismatch issue in cookbooks-partitioned.md (#3349)
    
    Signed-off-by: Vincent Xie <vinceshieh@gmail.com>
    
    * Update site2/docs/cookbooks-partitioned.md
    
    Co-Authored-By: VinceShieh <vinceshieh@gmail.com>

 site2/docs/cookbooks-partitioned.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit aa3fd10c87f6b2cc0a3d57dd67b4e205bb49a0d0
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jan 11 19:27:54 2019 +0100

    Integration test and documentation for Proxy w/o ZK (#3352)
    
    Adds an integration test which creates a proxy which connects to the
    brokers using broker URLs rather than service discovery.
    
    Adds documentation for configuring the proxy in this way.
    
    Issue: #2405

 site2/docs/administration-proxy.md                 | 49 +++++++++++++++++++---
 site2/docs/security-authorization.md               |  4 +-
 .../pulsar/tests/integration/proxy/TestProxy.java  | 42 +++++++++++++++----
 .../integration/topologies/PulsarClusterSpec.java  |  2 +
 4 files changed, 83 insertions(+), 14 deletions(-)

commit ef94cb70df08d7e9f16c6415116e729bb6d756ab
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jan 11 10:25:24 2019 -0800

    Pass schema info to C++ client (#3354)
    
    * Pass schema info to C++ client
    
    * Comments

 pulsar-client-cpp/include/pulsar/Client.h          |   1 +
 .../include/pulsar/ConsumerConfiguration.h         |  16 +++
 pulsar-client-cpp/include/pulsar/Producer.h        |  10 ++
 .../include/pulsar/ProducerConfiguration.h         |  21 +++
 .../include/pulsar/ReaderConfiguration.h           |  16 +++
 pulsar-client-cpp/include/pulsar/Schema.h          | 160 +++++++++++++++++++++
 pulsar-client-cpp/lib/ClientConnection.cc          |  11 +-
 pulsar-client-cpp/lib/ClientConnection.h           |   7 +-
 pulsar-client-cpp/lib/Commands.cc                  |  61 +++++++-
 pulsar-client-cpp/lib/Commands.h                   |   7 +-
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |   7 +
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |   4 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   6 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |   6 +
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |   2 +
 pulsar-client-cpp/lib/Producer.cc                  |   2 +
 pulsar-client-cpp/lib/ProducerConfiguration.cc     |   7 +
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |   4 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              |  13 +-
 pulsar-client-cpp/lib/ProducerImpl.h               |   3 +
 pulsar-client-cpp/lib/ProducerImplBase.h           |   1 +
 pulsar-client-cpp/lib/ReaderConfiguration.cc       |   7 +
 pulsar-client-cpp/lib/ReaderConfigurationImpl.h    |   4 +-
 pulsar-client-cpp/lib/ReaderImpl.cc                |   1 +
 pulsar-client-cpp/lib/Schema.cc                    | 103 +++++++++++++
 pulsar-client-cpp/tests/SchemaTest.cc              |  69 +++++++++
 26 files changed, 529 insertions(+), 20 deletions(-)

commit 4b8bd04f3571f4c6dc40d0b1a1e79975d9ad5408
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jan 10 17:29:55 2019 -0800

    Add BC Testing sample smoke test (#3355)

 .../PulsarStandaloneTestSuite2_2.java              | 43 ++++++++++++++++++++++
 .../backwardscompatibility/SmokeTest2_2.java       | 31 ++++++++++++++++
 .../integration/containers/PulsarContainer.java    | 24 +++++++++++-
 .../containers/StandaloneContainer.java            | 11 ++++++
 .../tests/integration/standalone/SmokeTest.java    |  1 -
 .../suites/PulsarStandaloneTestSuite.java          |  4 +-
 .../integration/topologies/PulsarCluster.java      |  6 +--
 .../integration/topologies/PulsarClusterSpec.java  | 14 +++++--
 .../topologies/PulsarStandaloneTestBase.java       |  4 +-
 9 files changed, 125 insertions(+), 13 deletions(-)

commit 69ab1f55f31e7e57d383f0727d9fd26c4249d7a5
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jan 10 17:06:47 2019 -0800

    Make scripts run on python2 and python3 (#3356)

 docker/pulsar/scripts/apply-config-from-env.py |  4 ++--
 docker/pulsar/scripts/gen-yml-from-env.py      |  2 +-
 docker/pulsar/scripts/watch-znode.py           | 24 ++++++++++++------------
 3 files changed, 15 insertions(+), 15 deletions(-)

commit 46f00fe067e3b5ecd5416a01c59de41b6f456f30
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jan 10 18:15:01 2019 +0100

    Docker compose configuration with TLS (#3342)
    
    Change adds a docker compose recipe with a zk node, 2 bookies, a
    pulsar broker and a proxy node. The proxy and the broker are both
    configured to use TLS authentication.
    
    The certs/keys to use to connect are those in
    tests/certificate-authority/client-keys. Admin is the super user.

 tests/compose/tls/docker-compose.yml               | 120 +++++++++++++++++++++
 .../docker-images/latest-version-image/Dockerfile  |   6 +-
 .../latest-version-image/ssl/proxy.cert.pem        |  26 +++++
 .../latest-version-image/ssl/proxy.key-pk8.pem     |  28 +++++
 .../latest-version-image/ssl/superproxy.cert.pem   |  26 +++++
 .../ssl/superproxy.key-pk8.pem                     |  28 +++++
 .../latest-version-image/ssl/user1.cert.pem        |  26 +++++
 .../latest-version-image/ssl/user1.key-pk8.pem     |  28 +++++
 8 files changed, 287 insertions(+), 1 deletion(-)

commit e9a5e61f06db9780669b39a96c5c29428334a0fe
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 10 06:46:39 2019 -0800

    Propagate specific Schema error to client (#3345)
    
    * Propagate specific Schema error to client
    
    * Handling new enums in C++
    
    * Fixed formatting

 .../org/apache/pulsar/broker/service/BrokerServiceException.java   | 3 +++
 .../src/main/java/org/apache/pulsar/broker/service/ServerCnx.java  | 7 ++++---
 .../test/java/org/apache/pulsar/client/api/SimpleSchemaTest.java   | 5 +++--
 .../java/org/apache/pulsar/client/api/PulsarClientException.java   | 6 ++++++
 pulsar-client-cpp/include/pulsar/Result.h                          | 2 ++
 pulsar-client-cpp/lib/ClientConnection.cc                          | 3 +++
 pulsar-client-cpp/lib/Result.cc                                    | 3 +++
 .../src/main/java/org/apache/pulsar/client/impl/ClientCnx.java     | 6 ++++--
 .../main/java/org/apache/pulsar/common/api/proto/PulsarApi.java    | 3 +++
 pulsar-common/src/main/proto/PulsarApi.proto                       | 2 ++
 10 files changed, 33 insertions(+), 7 deletions(-)

commit fa455730f81570ccc38a22807da416fa463a57c8
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 9 20:26:30 2019 -0800

    Export Message.Topic() in Go wrapper (#3346)

 pulsar-client-cpp/include/pulsar/Message.h   | 2 +-
 pulsar-client-cpp/include/pulsar/c/message.h | 2 ++
 pulsar-client-cpp/lib/Commands.cc            | 3 ++-
 pulsar-client-cpp/lib/ConsumerImpl.cc        | 2 +-
 pulsar-client-cpp/lib/Message.cc             | 3 ++-
 pulsar-client-cpp/lib/c/c_Message.cc         | 4 ++++
 pulsar-client-go/pulsar/c_message.go         | 4 ++++
 pulsar-client-go/pulsar/consumer_test.go     | 1 +
 pulsar-client-go/pulsar/message.go           | 3 +++
 9 files changed, 20 insertions(+), 4 deletions(-)

commit 99f05b5c6acca8dc73fe02a73bde2ca343349cd2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 9 17:14:20 2019 -0800

    add read-timeout option to async managed-ledger read (#3019)

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  22 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   4 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 481 ++++++++++++++-------
 .../bookkeeper/mledger/impl/OpReadEntry.java       |   4 +
 .../mledger/impl/ReadOnlyManagedLedgerImpl.java    |   2 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  76 ++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  10 +-
 .../pulsar/broker/service/BrokerService.java       |   1 +
 site/_data/config/broker.yaml                      |   6 +
 site/_data/config/standalone.yaml                  |   4 +
 12 files changed, 455 insertions(+), 161 deletions(-)

commit 06c819ef1f877356be43ec4e42a38104b01c281d
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 9 19:41:24 2019 +0100

    Bump testcontainers version to fix log dumping (#3344)
    
    The previous version was using a version of docker-java which didn't
    handle gzip compression well. So if the docker api returned an
    response that was gzip compressed, it wouldn't be decompressed and
    then log dumping would gzip it again, and then tar zxvf wouldn't
    handle it.
    
    See https://github.com/docker-java/docker-java/issues/1079.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit fc58d71f1c9e58164af3940e87a32d5431f39e8d
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 9 18:41:07 2019 +0100

    Typo in exception message: property -> tenant (#3341)

 .../java/org/apache/pulsar/proxy/server/BrokerDiscoveryProvider.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4f9771a89bd991b2f0a20fcb85ed6196f9b17673
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 9 16:34:57 2019 +0100

    Test for namespace delete with TLS authorization (#3340)
    
    Add a test for deleting namespaces when TLS authorization is
    enabled. This is effectly testing brokerClient* configuration also.
    
    Issue: #2880

 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   | 49 ++++++++++++++++++++++
 .../authentication/tls-http/user1.cert.pem         | 26 ++++++++++++
 .../authentication/tls-http/user1.key-pk8.pem      | 28 +++++++++++++
 3 files changed, 103 insertions(+)

commit 918dc6842d09bc07478adb5fb099aa43f1d40f1b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 9 07:30:17 2019 -0800

    Separate pulsar client API interfaces in different module (#3309)
    
    * Separate pulsar client API interfaces in different module
    
    * Added provided protobuf dep
    
    * Fixed build and tests
    
    * Fixed import name
    
    * Fixed AuthenticationTls class name
    
    * Fixed AutoProduceSchema name

 .../apache/pulsar/broker/service/ServerCnx.java    |   3 +-
 .../client/api/SimpleProducerConsumerTest.java     |   5 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  10 +-
 .../pulsar/client/impl/MessageBuilderTest.java     |  79 ----------
 .../pulsar-client-2x-shaded/pom.xml                |   1 +
 pulsar-client-api/pom.xml                          |   8 +
 .../apache/pulsar/client/api/Authentication.java   |   0
 .../client/api/AuthenticationDataProvider.java     |   0
 .../pulsar/client/api/AuthenticationFactory.java   |  96 ++++++++++++
 .../apache/pulsar/client/api/ClientBuilder.java    |   0
 .../apache/pulsar/client/api/CompressionType.java  |   0
 .../org/apache/pulsar/client/api/Consumer.java     |   0
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  11 +-
 .../client/api/ConsumerCryptoFailureAction.java    |   8 +-
 .../pulsar/client/api/ConsumerEventListener.java   |   0
 .../pulsar/client/api/ConsumerInterceptor.java     |   0
 .../apache/pulsar/client/api/ConsumerStats.java    |   0
 .../apache/pulsar/client/api/CryptoKeyReader.java  |   0
 .../apache/pulsar/client/api/DeadLetterPolicy.java |   0
 .../api/EncodedAuthenticationParameterSupport.java |   0
 .../pulsar/client/api/EncryptionKeyInfo.java       |   0
 .../apache/pulsar/client/api/HashingScheme.java    |   0
 .../java/org/apache/pulsar/client/api/Message.java |   3 +-
 .../org/apache/pulsar/client/api/MessageId.java    |  15 +-
 .../apache/pulsar/client/api/MessageListener.java  |   0
 .../apache/pulsar/client/api/MessageRouter.java    |   0
 .../pulsar/client/api/MessageRoutingMode.java      |   0
 .../org/apache/pulsar/client/api/Producer.java     |   0
 .../apache/pulsar/client/api/ProducerBuilder.java  |   0
 .../client/api/ProducerCryptoFailureAction.java    |   0
 .../pulsar/client/api/ProducerInterceptor.java     |   0
 .../apache/pulsar/client/api/ProducerStats.java    |   0
 .../org/apache/pulsar/client/api/PulsarClient.java |   4 +-
 .../pulsar/client/api/PulsarClientException.java   |   0
 .../java/org/apache/pulsar/client/api/Reader.java  |   0
 .../apache/pulsar/client/api/ReaderBuilder.java    |   0
 .../apache/pulsar/client/api/ReaderListener.java   |   0
 .../pulsar/client/api/RegexSubscriptionMode.java   |  31 ++++
 .../java/org/apache/pulsar/client/api/Schema.java  |  72 ++-------
 .../client/api/SchemaSerializationException.java   |   0
 .../pulsar/client/api/ServiceUrlProvider.java      |   0
 .../client/api/SubscriptionInitialPosition.java    |   0
 .../apache/pulsar/client/api/SubscriptionType.java |   0
 .../apache/pulsar/client/api/TopicMetadata.java    |   0
 .../pulsar/client/api/TypedMessageBuilder.java     |   0
 .../client/internal/DefaultImplementation.java     | 174 +++++++++++++++++++++
 .../pulsar/client/internal/ReflectionUtils.java    |  66 ++++++++
 .../pulsar/common/api/EncryptionContext.java       |   4 +-
 .../org/apache/pulsar/common/schema/KeyValue.java  |   0
 .../apache/pulsar/common/schema/SchemaInfo.java    |  34 ----
 .../apache/pulsar/common/schema/SchemaType.java    |   0
 .../client/impl/auth/AuthenticationAthenz.java     |   2 +-
 .../pulsar/client/api/AuthenticationUtil.java      |  53 -------
 .../AuthenticationUtil.java}                       |  77 +++++----
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   3 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   5 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  13 +-
 .../pulsar/client/impl/HttpLookupService.java      |   3 +-
 .../apache/pulsar/client/impl/MessageIdImpl.java   |   4 +
 .../apache/pulsar/client/impl/ProducerImpl.java    |  25 +--
 .../pulsar/client/impl/PulsarClientImpl.java       |  22 ++-
 .../pulsar/client/impl/auth/AuthenticationTls.java |   2 +-
 .../impl/conf/ConsumerConfigurationData.java       |   4 +-
 .../client/impl/schema/AutoConsumeSchema.java      |  28 ++++
 .../pulsar/client/impl/schema/KeyValueSchema.java  |  19 ++-
 pulsar-common/pom.xml                              |   7 +
 .../compression/CompressionCodecProvider.java      |  47 +++++-
 .../pulsar/common/schema/SchemaInfoUtil.java       |  67 ++++++++
 .../org/apache/pulsar/io/kinesis/UtilsTest.java    |   2 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |   3 +-
 70 files changed, 663 insertions(+), 347 deletions(-)

commit aae3755f6445b582700e75ace0e01c205c87fdfd
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 9 07:30:04 2019 -0800

    add support get getTopicName for CPP/Python clients (#3326)
    
    * add support get getTopicName for CPP/Python clients
    
    * set topic in ConsumerImpl and PartitionedConsumerImpl and add tests
    
    * cleaning up
    
    * clean up spacing

 pulsar-client-cpp/include/pulsar/Message.h       |  5 ++++
 pulsar-client-cpp/include/pulsar/MessageId.h     |  2 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc            |  1 +
 pulsar-client-cpp/lib/Message.cc                 |  7 +++++
 pulsar-client-cpp/lib/MessageImpl.h              |  2 +-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc |  2 ++
 pulsar-client-cpp/python/pulsar/__init__.py      |  6 ++++
 pulsar-client-cpp/python/pulsar_test.py          | 35 +++++++++++++++++++++++-
 pulsar-client-cpp/python/src/message.cc          |  7 +++++
 9 files changed, 64 insertions(+), 3 deletions(-)

commit 1013c750dbfd3773342c71a779796219536b022d
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Jan 9 07:03:54 2019 -0800

    Install python3.7 packages (#3325)
    
    Defautlt is still existing python2.7 installation
    Update scripts to install both pulsar-client
    packages for 2.7 and 3.7

 docker/pulsar-standalone/Dockerfile                |  2 +-
 docker/pulsar/Dockerfile                           | 10 ++++++---
 docker/pulsar/pom.xml                              | 18 +++++++++++++++-
 ...ulsar-client.sh => install-pulsar-client-27.sh} |  2 +-
 docker/pulsar/scripts/install-pulsar-client-37.sh  | 24 ++++++++++++++++++++++
 .../pulsar/functions/runtime/RuntimeUtils.java     |  8 ++++----
 6 files changed, 54 insertions(+), 10 deletions(-)

commit baec02cf3a9275a50f57a1a7077aef1731c8dba6
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Jan 8 17:29:31 2019 -0800

    Java Client - Add Bouncy Castle Provider to AuthenticationTls (#3334)

 .../java/org/apache/pulsar/client/impl/auth/AuthenticationTls.java  | 6 ++++++
 1 file changed, 6 insertions(+)

commit cbd770b7ef3ccb58e0be989328c593db2d5d6ddc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jan 8 15:44:51 2019 -0800

    timeout stuck producer/consumer operation request (#3240)
    
    * timeout stuck producer/consumer operation request
    
    * address comment
    
    * fix tests
    
    * timer task to check timeouts

 .../apache/pulsar/client/api/ClientErrorsTest.java |  4 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 27 +++++++++-
 .../org/apache/pulsar/client/impl/ClientCnx.java   | 58 +++++++++++++++++-----
 3 files changed, 74 insertions(+), 15 deletions(-)

commit 6ef47334f07901370e966f6fab7dbe7b324e0236
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Jan 9 03:28:07 2019 +0900

    Some settings of WebSocket proxy are not effective (#3328)

 conf/websocket.conf                                |  6 +-
 .../websocket/proxy/ProxyConfigurationTest.java    | 73 ++++++++++++++++++++++
 .../service/WebSocketProxyConfiguration.java       | 32 ++++++++--
 3 files changed, 102 insertions(+), 9 deletions(-)

commit ad72b7e40d48a68700ff01b268eb791b0c50950d
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Jan 9 02:27:54 2019 +0800

    Fix consumer stats log error. (#3327)

 .../java/org/apache/pulsar/client/impl/ConsumerStatsRecorderImpl.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit ccfa3894b9924f2c1dfff743b3905df654d6c156
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Tue Jan 8 23:56:00 2019 +0530

    bump mac pulsar c++ client version to 2.2.1 (#3329)

 pulsar-client-cpp/homebrew/libpulsar.rb | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 14cd667cdf0c57924264e2ba59f595ed28ba9195
Author: Grant Wu <grantwwu@gmail.com>
Date:   Mon Jan 7 18:57:11 2019 -0500

    s/paralellism/parallelism (#3323)

 site2/docs/functions-deploying.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7b239ec838f36ef2d61a817f858d0b4711b6c219
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jan 7 14:01:46 2019 -0800

    Clean up and correct properties to producer and consumers created by Functions/Sinks/Sources (#3315)
    
    * clean up and correct properties to producer and consumers created by functions
    
    * fix test
    
    * cleaning up comment
    
    * refactoring

 .../pulsar/functions/instance/ContextImpl.java     | 13 +++++++++++-
 .../pulsar/functions/instance/InstanceUtils.java   | 22 ++++++++++++++++++++
 .../functions/instance/JavaInstanceRunnable.java   | 20 ++++++++++++------
 .../apache/pulsar/functions/sink/PulsarSink.java   | 19 ++++++++---------
 .../pulsar/functions/source/PulsarSource.java      | 13 +++++-------
 .../instance/src/main/python/contextimpl.py        |  7 ++++++-
 .../instance/src/main/python/python_instance.py    | 24 ++++++++++++++++++----
 pulsar-functions/instance/src/main/python/util.py  |  6 ++++++
 .../pulsar/functions/sink/PulsarSinkTest.java      | 18 ++++++++--------
 .../pulsar/functions/source/PulsarSourceTest.java  | 11 +++++-----
 10 files changed, 110 insertions(+), 43 deletions(-)

commit e3b03fbb0b62c90fead2863945460c3b5c7050ea
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Tue Jan 8 00:44:20 2019 +0530

    Fixed export path (#3318)

 pulsar-client-cpp/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 719eab8a039b4533bc0ab13a3ffb530bf261ddb3
Author: legendtkl <taokelu@gmail.com>
Date:   Mon Jan 7 16:46:39 2019 +0800

    Issue 3226: Unclosed consumer after calling closeAsync
    
    Fixes #3226

 .../src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit b79bb9211d739c3e850641000a9cbadf6e785aa7
Author: Ke Li <like_0903@163.com>
Date:   Mon Jan 7 04:52:37 2019 +0800

    Add heartbeat interval for kafka connector (#3308)
    
    ### Motivation
    
    The default value of ```heartbeat.interval.ms``` is 3000 in latest kafka consumer config, which cannot be customized in kafka source config now.  When user set ```sessionTimeoutMs``` to a value less than or equal to 3000, an exception will thrown. So we'd better to provide the ability to support this option.
    
    Closes #3293

 .../main/java/org/apache/pulsar/io/kafka/KafkaAbstractSource.java  | 7 ++++++-
 .../main/java/org/apache/pulsar/io/kafka/KafkaSourceConfig.java    | 6 ++++++
 site2/docs/io-kafka.md                                             | 1 +
 .../org/apache/pulsar/tests/integration/io/KafkaSourceTester.java  | 1 +
 4 files changed, 14 insertions(+), 1 deletion(-)

commit 9e68dda47e96c8d4211390464c9a3ff753b7c5b9
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sun Jan 6 20:46:50 2019 +0000

    [Pulsar-Client] Add minor Schema fixes (#3313)
    
    ### Motivation
    This PR aims to cover some of minor `Schema` fixes.
    
    ### Modifications
    1- `SchemaSerializationException` already extends `RuntimeException` so `RuntimeException` wraps look redundant.
    2- Fixes variable name
    3- Fixes redundant line breaks
    
    ### Test
    1- Adding a new UT for `SchemaSerializationException` case on `JSONSchema.decode()` function

 .../apache/pulsar/client/impl/schema/AutoProduceBytesSchema.java | 1 -
 .../java/org/apache/pulsar/client/impl/schema/JSONSchema.java    | 7 +++----
 .../pulsar/client/impl/schema/generic/GenericJsonSchema.java     | 4 ++--
 .../org/apache/pulsar/client/impl/schema/JSONSchemaTest.java     | 9 ++++++---
 .../main/java/org/apache/pulsar/common/schema/SchemaInfo.java    | 1 -
 5 files changed, 11 insertions(+), 11 deletions(-)

commit 0b9c99c9e349e0096942ee0cc266a5262c89e1f6
Author: Ke Li <like_0903@163.com>
Date:   Mon Jan 7 00:54:39 2019 +0800

    Use auto resource management to avoid closing resource manually (#3311)

 .../pulsar/functions/api/utils/JavaSerDe.java      | 31 +++-------------------
 .../org/apache/pulsar/functions/worker/Utils.java  | 18 ++-----------
 2 files changed, 6 insertions(+), 43 deletions(-)

commit 4a85bb79f3791481920b41ed2d2599dbd559d3a1
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jan 5 11:36:04 2019 -0800

    After #3228, removed usages of deprecated client API (#3272)
    
    * After #3228, removed usages of deprecated client API
    
    * Removed ProducerConfiguration from flink connector
    
    * Use pulsar-client-1x in pulsar-spark
    
    * Fixed log4j adapter
    
    * Fixed flink examples
    
    * Fixed storm integration tests
    
    * Fixed storm example
    
    * Wrapping message listeners in v1 lib wrapper
    
    * Fixed unit tests
    
    * Moved spark receiver test to test-containers to avoid shading issues
    
    * Fixed PulsarAvroTableSinkTest
    
    * Only run spark receiver test in integration tests

 .../example/PulsarConsumerSourceWordCount.java     |    2 -
 ...lsarConsumerSourceWordCountToAvroTableSink.java |    3 +-
 ...lsarConsumerSourceWordCountToJsonTableSink.java |    3 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |    4 +-
 .../broker/service/PersistentTopicE2ETest.java     |   20 +-
 .../pulsar/broker/service/ReplicatorTest.java      |    6 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   16 +-
 .../broker/service/v1/V1_ReplicatorTest.java       |    5 +-
 .../broker/service/v1/V1_ReplicatorTestBase.java   |   12 +-
 .../api/PartitionedProducerConsumerTest.java       |   16 +-
 .../client/api/SimpleProducerConsumerTest.java     |   81 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     | 1005 ++++++++++----------
 .../pulsar/client/impl/ConnectionPoolTest.java     |    6 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |   69 +-
 .../apache/pulsar/compaction/CompactionTest.java   |  313 +++---
 .../apache/pulsar/compaction/CompactorTest.java    |   72 +-
 .../pulsar/client/api/ConsumerConfiguration.java   |   20 +-
 .../apache/pulsar/client/api/MessageListener.java  |   54 ++
 .../pulsar/client/api/ReaderConfiguration.java     |   21 +-
 .../apache/pulsar/client/api/ReaderListener.java   |   52 +
 .../pulsar-client-2x-shaded/pom.xml                |    2 +
 .../apache/pulsar/client/admin/PulsarAdmin.java    |   50 +-
 .../pulsar/client/api/ClientConfiguration.java     |  390 --------
 .../pulsar/client/api/ConsumerConfiguration.java   |  370 -------
 .../apache/pulsar/client/api/MessageBuilder.java   |  158 ---
 .../org/apache/pulsar/client/api/Producer.java     |   47 -
 .../pulsar/client/api/ProducerConfiguration.java   |  483 ----------
 .../org/apache/pulsar/client/api/PulsarClient.java |  211 ----
 .../pulsar/client/api/ReaderConfiguration.java     |  163 ----
 .../pulsar/client/impl/MessageBuilderImpl.java     |  125 ---
 .../apache/pulsar/client/impl/ProducerBase.java    |    2 -
 .../pulsar/client/impl/PulsarClientImpl.java       |  150 ---
 .../client/impl/TypedMessageBuilderImpl.java       |   12 +-
 .../connectors/pulsar/FlinkPulsarProducer.java     |   43 +-
 .../connectors/pulsar/PulsarAvroTableSink.java     |   19 +-
 .../connectors/pulsar/PulsarJsonTableSink.java     |    5 +-
 .../connectors/pulsar/PulsarTableSink.java         |   17 +-
 .../connectors/pulsar/PulsarAvroTableSinkTest.java |    4 +-
 .../connectors/pulsar/PulsarJsonTableSinkTest.java |    5 +-
 .../pulsar/log4j2/appender/PulsarManager.java      |   27 +-
 .../pulsar/log4j2/appender/PulsarAppenderTest.java |   64 +-
 pulsar-spark/pom.xml                               |    2 +-
 .../java/org/apache/pulsar/storm/PulsarBolt.java   |   42 +-
 .../java/org/apache/pulsar/storm/PulsarSpout.java  |   28 +-
 .../pulsar/storm/PulsarSpoutConfiguration.java     |   12 +
 .../apache/pulsar/storm/TupleToMessageMapper.java  |   26 +-
 .../pulsar/testclient/LoadSimulationClient.java    |   78 +-
 site2/docs/adaptors-storm.md                       |   22 +-
 site2/docs/security-authorization.md               |   35 +-
 .../integration/compaction/TestCompaction.java     |    2 +-
 tests/pulsar-spark-test/pom.xml                    |   80 +-
 .../spark/SparkStreamingPulsarReceiverTest.java    |   67 +-
 .../org/apache/pulsar/storm/PulsarBoltTest.java    |   29 +-
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   39 +-
 .../apache/pulsar/storm/example/StormExample.java  |   37 +-
 55 files changed, 1340 insertions(+), 3286 deletions(-)

commit 8ab80bbcf40712fc2e6586a9e8dc86754e310b2e
Author: Ke Li <like_0903@163.com>
Date:   Sun Jan 6 00:33:09 2019 +0800

    Fix typo in Go client docs (#3306)

 site/docs/latest/clients/go.md                                          | 2 +-
 site2/docs/client-libraries-go.md                                       | 2 +-
 .../versioned_docs/version-2.1.0-incubating/client-libraries-go.md      | 2 +-
 site2/website/versioned_docs/version-2.2.0/client-libraries-go.md       | 2 +-
 site2/website/versioned_docs/version-2.2.1/client-libraries-go.md       | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

commit 21037920be99efdfd24d55d09c38b2b3caf94e14
Author: tuteng <eguangning@gmail.com>
Date:   Sat Jan 5 17:36:10 2019 +0800

    Add logic in the dashboard to handle cases where Bundle,Topic,Subscription,Consumer already exists
    
    ### Motivation
    
    Related Issue : #3226
    
    Add logic in the dashboard to handle cases where Bundle,Topic,Subscription,Consumer already exists
    
    ### Modifications
    
    Update Consumer, Bundle,Subscription,Topic if exist

 dashboard/django/collector.py | 249 ++++++++++++++++++++++++++++--------------
 1 file changed, 167 insertions(+), 82 deletions(-)

commit 1d2257110ed30012096ec5ef783805d0f1f09a78
Author: wpl <1269223860@qq.com>
Date:   Sat Jan 5 17:32:14 2019 +0800

     issue #3276 Pulsar IO connector for udp source (#3295)
    
    ### Motivation
    
    Fixes #3276
    
    ### Result
    
    Pulsar IO connector for udp source

 .../org/apache/pulsar/io/netty/NettySource.java    |  83 ++++++++++
 ...TcpSourceConfig.java => NettySourceConfig.java} |  18 ++-
 .../org/apache/pulsar/io/netty/NettyTcpSource.java |  77 ----------
 .../{tcp => }/server/NettyChannelInitializer.java  |   2 +-
 .../apache/pulsar/io/netty/server/NettyServer.java | 169 +++++++++++++++++++++
 .../NettyServerHandler.java}                       |  18 +--
 .../pulsar/io/netty/tcp/server/NettyTcpServer.java | 123 ---------------
 .../resources/META-INF/services/pulsar-io.yaml     |   6 +-
 ...eConfigTest.java => NettySourceConfigTest.java} |  36 +++--
 .../server/NettyChannelInitializerTest.java        |   6 +-
 .../NettyServerTest.java}                          |  96 +++++++++---
 ...TcpSourceConfig.yaml => nettySourceConfig.yaml} |   3 +-
 ...l => nettySourceConfigWithInvalidProperty.yaml} |   3 +-
 site2/docs/io-connectors.md                        |   2 +-
 site2/docs/{io-tcp.md => io-netty.md}              |   9 +-
 15 files changed, 383 insertions(+), 268 deletions(-)

commit ef82f045257ae839c0208c75b1b31ba0ad6693aa
Author: Richard Yu <yohan.richard.yu@gmail.com>
Date:   Fri Jan 4 19:05:01 2019 -0800

    Adding config auto.offset.reset to PulsarKafkaConsumer (#3273)
    
    * Adding config auto.offset.reset to PulsarKafkaConsumer
    
    * Adding similar behavior to poll
    
    * Update pulsar-client-kafka-compat/pulsar-client-kafka/src/main/java/org/apache/kafka/clients/consumer/PulsarKafkaConsumer.java
    
    Co-Authored-By: ConcurrencyPractitioner <yohan.richard.yu@gmail.com>
    
    * Adding some changes
    
    * Fixing indentation
    
    * Modifying postion method
    
    * Adding entry to compatibility matridx
    
    * Removing enum
    
    * Fixing indentation and policy
    
    * removing indents
    
    * Fixing indent
    
    * Adding log statements
    
    * Modifying seekToEnd behavior
    
    * Adding check
    
    * updating position
    
    * Reverting accidentaldeletion

 .../clients/consumer/PulsarKafkaConsumer.java      | 41 ++++++++++++++++++++--
 site2/docs/adaptors-kafka.md                       |  1 +
 2 files changed, 39 insertions(+), 3 deletions(-)

commit 58c8e87260da30a65b153c8d80b1980ab378f721
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Jan 4 12:38:13 2019 -0800

    CPP Client - Error out Lookup request after operation timeout. (#3300)

 pulsar-client-cpp/lib/ClientConnection.cc | 24 ++++++++++++++++++++----
 pulsar-client-cpp/lib/ClientConnection.h  |  9 ++++++++-
 2 files changed, 28 insertions(+), 5 deletions(-)

commit ffb2250ca3edcad7daa39d6deb7af8fd12a2e48a
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Jan 4 11:29:57 2019 -0800

    CPP Client - Turning switch case warnings into errors. (#3297)

 pulsar-client-cpp/CMakeLists.txt          | 2 +-
 pulsar-client-cpp/include/pulsar/Result.h | 3 ++-
 pulsar-client-cpp/lib/ClientConnection.cc | 6 ++++++
 pulsar-client-cpp/lib/Commands.cc         | 6 ++++++
 pulsar-client-cpp/lib/Result.cc           | 3 +++
 5 files changed, 18 insertions(+), 2 deletions(-)

commit 6b129e0be8b79ee6399a5796a38afbe1188c0a79
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Fri Jan 4 18:13:57 2019 +0800

    Issue #3227: Improve deployment guide on enabling tiered storage (#3281)
    
    ### Motivation
    
    Improve deployment guide on enabling tiered storage, because `offloaders` are packaged in a separated distribution binary.
    
    ### Modifications
    
    change related doc.

 site2/docs/deploy-bare-metal-multi-cluster.md      |  4 ++
 site2/docs/deploy-bare-metal.md                    | 43 +++++++++++++++++++
 site2/docs/getting-started-standalone.md           | 48 +++++++++++++++++++++-
 site2/website/scripts/replace.js                   |  6 +++
 .../deploy-bare-metal-multi-cluster.md             |  4 ++
 .../version-2.2.0/deploy-bare-metal.md             | 43 +++++++++++++++++++
 .../version-2.2.0/getting-started-standalone.md    | 48 +++++++++++++++++++++-
 .../version-2.2.1/deploy-bare-metal.md             | 43 +++++++++++++++++++
 .../version-2.2.1/getting-started-standalone.md    | 48 +++++++++++++++++++++-
 9 files changed, 284 insertions(+), 3 deletions(-)

commit 57e18524632946ed4a154deee43f622fd325ddf7
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Jan 4 02:10:27 2019 -0800

    Default Templates for Bugs and Features (#3296)
    
    As per github community guidelines, creating templates for reporting bugs and feature request.
    
    https://github.com/apache/pulsar/community

 .github/ISSUE_TEMPLATE/bug_report.md      | 30 ++++++++++++++++++++++++++++++
 .github/ISSUE_TEMPLATE/feature_request.md | 20 ++++++++++++++++++++
 2 files changed, 50 insertions(+)

commit c0c2dda9379f2617e1329bfb6e75a0cd41a54523
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Thu Jan 3 15:28:01 2019 -0800

    Pulsar CPP CLient - making log messages more meaningful. (#3285)
    
    ### Motivation
    While debugging we realized that there were log messages in the cpp client which were not of much use since topic names weren't mentioned and closing a Client/Consumer/Producer message was under DEBUG instead of INFO.
    
    ### Modifications
    Added topic names to the relevant messages and changed log level to info for closing a Client/Consumer/Producer message.
    
    ### Result
    Logs make a little more sense.

 pulsar-client-cpp/lib/Client.cc       | 2 +-
 pulsar-client-cpp/lib/ClientImpl.cc   | 8 +++++---
 pulsar-client-cpp/lib/ConsumerImpl.cc | 3 ++-
 pulsar-client-cpp/lib/ProducerImpl.cc | 2 +-
 4 files changed, 9 insertions(+), 6 deletions(-)

commit 49b5590781ddb90cd12e3966593c72d6234ba952
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 3 11:28:18 2019 -0800

    Fixed KEYS URL in download page. (#3282)

 site2/website/pages/en/download.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7bac25e2d3390f0fbf806a9ca7509c6aba970800
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 3 00:48:18 2019 -0800

    Update copyright year in NOTICE files to 2019 (#3283)
    
    ### Motivation
    
    NOTICE files need to be up to date for next release

 NOTICE                                          | 2 +-
 distribution/server/src/assemble/NOTICE.bin.txt | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit a514ec7525c1190adc2614fec012e3c3f4e03928
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 2 23:53:07 2019 -0800

    remove function details from v3 function endpoints (#3271)

 .../java/org/apache/pulsar/broker/admin/impl/FunctionsBase.java     | 6 ++----
 .../pulsar/functions/worker/rest/api/v3/FunctionApiV3Resource.java  | 6 ++----
 2 files changed, 4 insertions(+), 8 deletions(-)

commit 223c0c4a428e6fa4d56df94a96f2d9267d7819f8
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 2 22:27:22 2019 -0800

    output from 'print' statements should be handled correctly in python functions (#3286)

 pulsar-functions/instance/src/main/python/log.py | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)

commit e49b8c50c6ad063af0be2954cb1efe855604029c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 2 17:30:39 2019 -0800

    change 'function' prometheus label for sources, sinks, functions (#3284)

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 98 +++++++++++-----------
 .../instance/stats/ComponentStatsManager.java      |  2 +-
 .../instance/src/main/python/function_stats.py     |  2 +-
 .../functions/runtime/KubernetesRuntime.java       |  2 +-
 4 files changed, 52 insertions(+), 52 deletions(-)

commit 99bd3164d9aea7154e904ac17a8b7f892d123c1c
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Jan 2 23:52:50 2019 +0800

    Issue #3277: left sidebar missing for 2.2.1 website
    
    ### Motivation
    
    Fixes #3277
    
    website of 2.2.1 is missing left sidebar
    
    ### Modifications
    
    change version from 2.2.0 to 2.2.1
    
    ### Result
    
    website fixed.

 .../versioned_sidebars/version-2.2.1-sidebars.json | 174 ++++++++++-----------
 1 file changed, 87 insertions(+), 87 deletions(-)

commit 1c7a7a48fe7f1ee7582184e85cec3f6bfc77161e
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Jan 2 19:10:51 2019 +0800

    Improve documentation for message routing mode (#3263)
    
    Motivation
    User complain that the Routing modes documents is not align with code, and will cause some mis-understanding.
    
    Modifications
    make the documentation align with the code.

 .../pulsar/client/api/MessageRoutingMode.java      |  8 ++++--
 site2/docs/concepts-messaging.md                   | 31 +++++++++++++++++-----
 2 files changed, 30 insertions(+), 9 deletions(-)

commit bbd736ddc2bd38b2df3c667b286b6f15cd31dcff
Author: tuteng <eguangning@gmail.com>
Date:   Wed Jan 2 17:14:24 2019 +0800

    Optimization of binlog to pulsar use canal (#3268)
    
    ### Motivation
    
    Optimization of mysql binlog to pulsar use canal
    
    ### Modifications
    
    Add MessageUtils for parse columns
    Support query of presto sql
    
    ### Result
    
    #### INSERT
    mysql:
    ```
    MariaDB [aaa]> insert into users321(name, extra) values('xxxddxxxmm', 'ddd');
    ```
    python consumer:
    ```
    {u'timestamp': u'2018-12-31 00:31:24', u'message': u'[{"data":null,"database":"","es":1546234283000,"id":58,"isDdl":false,"mysqlType":null,"old":null,"sql":"insert into users321(name, extra) values(\'xxxddxxxmm\', \'ddd\')","sqlType":null,"table":"","ts":1546234284669,"type":"QUERY"},{"data":[{"isKey":"1","isNull":"0","index":"0","mysqlType":"int(11)","columnName":"id","columnValue":"34","updated":"1"},{"isKey":"0","isNull":"0","index":"1","mysqlType":"varchar(50)","columnName":"name","columnValue":"xxxddxxxmm","updated":"1"},{"isKey":"0","isNull":"0","index":"2","mysqlType":"varchar(50)","columnName":"extra","columnValue":"ddd","updated":"1"}],"database":"aaa","es":1546234283000,"id":58,"isDdl":false,"mysqlType":null,"old":null,"sql":"","sqlType":null,"table":"users321","ts":1546234284670,"type":"INSERT"}]', u'id': 58}
    ```
    presto sql:
    ```
    presto> select id, timestamp, message from pulsar."public/default".my_topic_test where id=58;
     id |      timestamp      |
    ----+---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     58 | 2018-12-31 00:31:24 | [{"data":null,"database":"","es":1546234283000,"id":58,"isDdl":false,"mysqlType":null,"old":null,"sql":"insert into users321(name, extra) values('xxxddxxxmm', 'ddd')","sqlType"
    ```

 .../{CanalSource.java => CanalAbstractSource.java} |  47 +++---
 .../apache/pulsar/io/canal/CanalByteSource.java    |  51 +++++++
 .../apache/pulsar/io/canal/CanalStringSource.java  |  75 ++++++++++
 .../org/apache/pulsar/io/canal/MessageUtils.java   | 161 +++++++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |   2 +-
 5 files changed, 309 insertions(+), 27 deletions(-)

commit adc6fc0ebeaca514b38de23373edfc72737ddb38
Author: Ezequiel Lovelle <ezequiellovelle+gh@gmail.com>
Date:   Mon Dec 31 20:02:36 2018 -0300

    Relay on CompletableFuture utils (#3270)
    
    Use static method allOf() from CompletableFuture instead of custom logic to wait
    for each future to complete from a collection.

 .../org/apache/pulsar/common/util/FutureUtil.java  | 30 ++--------------------
 1 file changed, 2 insertions(+), 28 deletions(-)

commit 5cc4dd8b759f1bfd0ed76f88e065aee65ac6f857
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Dec 31 12:15:55 2018 -0800

    add sink and source prometheus stats (#3261)
    
    * add sink and source prometheus stats
    
    * fixing stuff

 distribution/io/src/assemble/io.xml                |   2 +-
 pulsar-broker/pom.xml                              |  10 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 307 +++++++++++++++++++
 .../pulsar/functions/instance/ContextImpl.java     |  32 +-
 .../pulsar/functions/instance/InstanceUtils.java   |  26 ++
 .../functions/instance/JavaInstanceRunnable.java   |  18 +-
 .../instance/stats/ComponentStatsManager.java      | 170 +++++++++++
 .../instance/{ => stats}/FunctionStatsManager.java | 248 ++++-----------
 .../functions/instance/stats/SinkStatsManager.java | 340 +++++++++++++++++++++
 .../instance/stats/SourceStatsManager.java         | 339 ++++++++++++++++++++
 .../pulsar/functions/instance/ContextImplTest.java |   5 +-
 .../org/apache/pulsar/functions/utils/Utils.java   |  17 ++
 .../functions/worker/rest/api/ComponentImpl.java   |  23 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |   3 +-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |   3 +-
 .../functions/worker/rest/api/SourceImpl.java      |   3 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   3 +-
 .../rest/api/v3/FunctionApiV3ResourceTest.java     |  11 +-
 .../worker/rest/api/v3/SinkApiV3ResourceTest.java  |   9 +-
 .../rest/api/v3/SourceApiV3ResourceTest.java       |   9 +-
 .../{data-genenator => data-generator}/pom.xml     |   0
 .../io/datagenerator/DataGeneratorPrintSink.java   |   0
 .../io/datagenerator/DataGeneratorSource.java      |   0
 .../org/apache/pulsar/io/datagenerator/Person.java |   0
 .../resources/META-INF/services/pulsar-io.yaml     |   0
 pulsar-io/pom.xml                                  |   2 +-
 26 files changed, 1337 insertions(+), 243 deletions(-)

commit 469b1777418bc70160950146a72ec1dadf4056a9
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Dec 31 10:58:30 2018 -0800

    Release notes and website update for 2.2.1 (#3269)

 site2/website/release-notes.md                     |  41 +-
 site2/website/releases.json                        |   1 +
 .../version-2.2.1/admin-api-persistent-topics.md   | 623 +++++++++++++++++++++
 .../version-2.2.1/client-libraries-go.md           | 463 +++++++++++++++
 .../version-2.2.1/client-libraries-java.md         | 468 ++++++++++++++++
 .../version-2.2.1/client-libraries-websocket.md    | 444 +++++++++++++++
 .../version-2.2.1/concepts-clients.md              |  80 +++
 .../version-2.2.1/concepts-overview.md             |  32 ++
 .../version-2.2.1/deploy-bare-metal.md             | 384 +++++++++++++
 .../version-2.2.1/functions-overview.md            | 452 +++++++++++++++
 .../version-2.2.1/getting-started-docker.md        | 168 ++++++
 .../version-2.2.1/getting-started-standalone.md    | 198 +++++++
 .../website/versioned_docs/version-2.2.1/io-cdc.md | 147 +++++
 .../versioned_docs/version-2.2.1/io-connectors.md  |  21 +
 .../versioned_docs/version-2.2.1/io-overview.md    |  41 ++
 .../versioned_docs/version-2.2.1/io-rabbitmq.md    |  20 +
 .../website/versioned_docs/version-2.2.1/io-tcp.md |  20 +
 .../version-2.2.1/reference-configuration.md       | 479 ++++++++++++++++
 .../version-2.2.1/security-tls-authentication.md   | 137 +++++
 .../version-2.2.1/security-tls-transport.md        | 228 ++++++++
 .../version-2.2.1/security-token-admin.md          | 153 +++++
 .../version-2.2.1/security-token-client.md         | 126 +++++
 .../versioned_sidebars/version-2.2.1-sidebars.json | 121 ++++
 site2/website/versions.json                        |   1 +
 24 files changed, 4837 insertions(+), 11 deletions(-)

commit ab39aeb05365a1ee128e66c4c9e95922fd316680
Author: wpl <1269223860@qq.com>
Date:   Tue Jan 1 02:31:38 2019 +0800

     [flink-consumer-source] fix flink streaming connector examples to be consistent with batch examples (#3265)
    
    fix flink streaming connector examples to be consistent with batch examples

 .../example/FlinkPulsarBatchAvroSinkExample.java   |   2 +-
 .../batch/connectors/pulsar/example/README.md      |  10 +-
 ...lsarConsumerSourceWordCountToAvroTableSink.java |  19 ++--
 ...lsarConsumerSourceWordCountToJsonTableSink.java |  19 ++--
 .../streaming/connectors/pulsar/example/README.md  | 124 ++++++++++++++++++++-
 .../connectors/pulsar/PulsarAvroTableSink.java     |   5 +-
 6 files changed, 149 insertions(+), 30 deletions(-)

commit f7af5c89690f38b7a06a1632103880824e03dfd4
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Mon Dec 31 03:49:57 2018 +0300

    [Pulsar-Flink] Rename Flink examples sub-module (#3266)
    
    ### Motivation
    This PR aims to rename `flink-consumer-source` submodule as `flink` by supporting naming consistency with other Pulsar modules (e.g: `pulsar-io`)
    Following PR with #3262.
    
    ### Modifications
    Moves Flink examples from `flink-consumer-source` sub-module to `flink`.

 .gitignore                                         |  2 +-
 examples/{flink-consumer-source => flink}/pom.xml  |  6 ++--
 .../example/FlinkPulsarBatchAvroSinkExample.java   |  0
 .../example/FlinkPulsarBatchCsvSinkExample.java    |  0
 .../example/FlinkPulsarBatchJsonSinkExample.java   |  0
 .../example/FlinkPulsarBatchSinkExample.java       |  0
 .../batch/connectors/pulsar/example/README.md      | 32 +++++++++++-----------
 .../example/PulsarConsumerSourceWordCount.java     |  0
 ...lsarConsumerSourceWordCountToAvroTableSink.java |  0
 ...lsarConsumerSourceWordCountToJsonTableSink.java |  0
 .../streaming/connectors/pulsar/example/README.md  |  4 +--
 .../src/main/resources/avro/NasaMission.avsc       |  0
 .../src/main/resources/log4j2.xml                  |  0
 .../FlinkPulsarBatchAvroSinkScalaExample.scala     |  0
 .../FlinkPulsarBatchCsvSinkScalaExample.scala      |  0
 .../FlinkPulsarBatchJsonSinkScalaExample.scala     |  0
 .../example/FlinkPulsarBatchSinkScalaExample.scala |  0
 examples/pom.xml                                   |  2 +-
 18 files changed, 23 insertions(+), 23 deletions(-)

commit 742ee7eec3f150626b4017223429323aab82d61a
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Dec 30 08:47:45 2018 -0800

    Provide separate module with Pulsar v1 client API wrapper (#3228)
    
    * Provide separate module with Pulsar v1 client API wrapper
    
    * Use impl classes rather than API
    
    * Brought back DefaultSchemasTest.testStringSchema

 pom.xml                                            |   1 +
 pulsar-client-1x-base/pom.xml                      |  40 ++
 pulsar-client-1x-base/pulsar-client-1x/pom.xml     |  52 +++
 .../pulsar/client/api/ClientConfiguration.java     | 390 +++++++++++++++++
 .../org/apache/pulsar/client/api/Consumer.java     | 308 +++++++++++++
 .../pulsar/client/api/ConsumerConfiguration.java   | 366 ++++++++++++++++
 .../apache/pulsar/client/api/MessageBuilder.java   | 140 ++++++
 .../org/apache/pulsar/client/api/Producer.java     | 199 +++++++++
 .../pulsar/client/api/ProducerConfiguration.java   | 483 +++++++++++++++++++++
 .../org/apache/pulsar/client/api/PulsarClient.java | 274 ++++++++++++
 .../java/org/apache/pulsar/client/api/Reader.java  |  81 ++++
 .../pulsar/client/api/ReaderConfiguration.java     | 163 +++++++
 .../pulsar/client/impl/MessageBuilderImpl.java     | 116 +++++
 .../pulsar/client/impl/v1/ConsumerV1Impl.java      | 153 +++++++
 .../pulsar/client/impl/v1/ProducerV1Impl.java      |  91 ++++
 .../pulsar/client/impl/v1/PulsarClientV1Impl.java  | 173 ++++++++
 .../apache/pulsar/client/impl/v1/ReaderV1Impl.java |  86 ++++
 .../pulsar/client/impl/MessageBuilderTest.java     |  10 +-
 .../pulsar-client-2x-shaded/pom.xml                |  91 ++++
 .../client/impl/schema/DefaultSchemasTest.java     |  22 +-
 20 files changed, 3217 insertions(+), 22 deletions(-)

commit 140d375e795f26b6176d606030f7bcaa611858f2
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Fri Dec 28 21:25:40 2018 +0000

    [Pulsar-Flink] Refactor Flink Batch Sink Examples (#3262)
    
    ### Motivation
    This PR aims to align Flink Batch Sinks Java and Scala Examples with Streaming ones.
    Following PR with #3190
    
    ### Modifications
    1- Provides a single executable jar by covering all examples. Flink `-c <className>` parameter has been suggested to run each example (e.g: `./bin/flink run -c org.apache.flink.batch.connectors.pulsar.example.FlinkPulsarBatchSinkScalaExample ...`).
    2- Adds user-defined arguments support to examples (e.g: `--service-url pulsar://127.0.0.1:6650 --topic test-topic`) instead of harcoded `service-url`and `topic-name`.
    3- Aligns existing Batch documentation with Streaming documentation.
    4- Combines both Java and Scala Examples documentations via single `README.md`

 examples/flink-consumer-source/pom.xml             |  32 +-
 .../example/FlinkPulsarBatchAvroSinkExample.java   |  24 +-
 .../example/FlinkPulsarBatchCsvSinkExample.java    |  23 +-
 .../example/FlinkPulsarBatchJsonSinkExample.java   |  23 +-
 .../example/FlinkPulsarBatchSinkExample.java       |  23 +-
 .../batch/connectors/pulsar/example/README.md      | 342 ++++++--------------
 .../streaming/connectors/pulsar/example/README.md  |   6 +-
 .../FlinkPulsarBatchAvroSinkScalaExample.scala     |  25 +-
 .../FlinkPulsarBatchCsvSinkScalaExample.scala      |  23 +-
 .../FlinkPulsarBatchJsonSinkScalaExample.scala     |  24 +-
 .../example/FlinkPulsarBatchSinkScalaExample.scala |  22 +-
 .../batch/connectors/pulsar/example/README.md      | 345 ---------------------
 .../connectors/pulsar/BasePulsarOutputFormat.java  |  18 +-
 .../connectors/pulsar/PulsarOutputFormat.java      |   4 +-
 14 files changed, 293 insertions(+), 641 deletions(-)

commit 1fa81ca54f688938c83a0be3c98bebc7589be668
Author: Samuel <foreversunyao@yahoo.com>
Date:   Sat Dec 29 02:15:41 2018 +0800

    catch bad version in persistentopic, make its behavior same as namespace (#3260)
    
    ### Motivation
    
    Fixes #2952
    
    make topic's behavior same as [Namespaces.java](https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java)

 .../broker/admin/impl/PersistentTopicsBase.java    | 22 ++++++++++++++++++++--
 1 file changed, 20 insertions(+), 2 deletions(-)

commit a010166f9e67587a065fbe50657a9c76fb7403a2
Author: penghui <codelipenghui@gmail.com>
Date:   Fri Dec 28 13:43:12 2018 +0800

    Support multi-topic and pattern-topic for PulsarConsumerSource in pulsar (#3256)
    
    ### Motivation
    
    Fixes #3255
    
    Easier to consume multiple topics by PulsarConsumerSource.
    
    ### Modifications
    
    Add multi-topic and pattern-topic set for PulsarConsumerSource.
    
    ### Result
    
    UT passed.

 .../connectors/pulsar/PulsarConsumerSource.java    | 25 +++++--
 .../connectors/pulsar/PulsarSourceBuilder.java     | 79 +++++++++++++++++++---
 .../connectors/pulsar/PulsarSourceBuilderTest.java | 30 +++++++-
 3 files changed, 118 insertions(+), 16 deletions(-)

commit 209c44883ad30b13b1a693a02aff8858c287401e
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Thu Dec 27 09:49:04 2018 -0800

    Added Pulsar IO connector for local files (#2869)
    
    ### Motivation
    
    Added a Pulsar IO connector for consuming files from the local filesystem
    
    ### Modifications
    
    Added a new module to the pulsar-io module that includes the Pulsar file connector and its associated classes & tests
    
    ### Result
    
    After your change, users will be able to consume files from the local filesystem, and have the contents directly published to a Pulsar topic.

 pulsar-io/file/pom.xml                             |  70 ++++++
 .../apache/pulsar/io/file/FileConsumerThread.java  | 108 +++++++++
 .../apache/pulsar/io/file/FileListingThread.java   | 189 +++++++++++++++
 .../java/org/apache/pulsar/io/file/FileRecord.java |  75 ++++++
 .../java/org/apache/pulsar/io/file/FileSource.java |  70 ++++++
 .../apache/pulsar/io/file/FileSourceConfig.java    | 177 ++++++++++++++
 .../apache/pulsar/io/file/ProcessedFileThread.java |  60 +++++
 .../org/apache/pulsar/io/file/package-info.java    |  19 ++
 .../org/apache/pulsar/io/file/utils/GZipFiles.java |  96 ++++++++
 .../org/apache/pulsar/io/file/utils/ZipFiles.java  |  94 ++++++++
 .../apache/pulsar/io/file/utils/package-info.java  |  19 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../apache/pulsar/io/file/AbstractFileTests.java   | 138 +++++++++++
 .../pulsar/io/file/FileConsumerThreadTests.java    | 148 ++++++++++++
 .../pulsar/io/file/FileListingThreadTests.java     | 238 +++++++++++++++++++
 .../pulsar/io/file/FileSourceConfigTests.java      | 121 ++++++++++
 .../pulsar/io/file/ProcessedFileThreadTests.java   | 259 +++++++++++++++++++++
 .../apache/pulsar/io/file/TestFileGenerator.java   |  91 ++++++++
 .../pulsar/io/file/utils/GZipFilesTests.java       |  68 ++++++
 .../apache/pulsar/io/file/utils/ZipFilesTests.java |  68 ++++++
 .../org/apache/pulsar/io/file/mislabelled.gz       |   1 +
 .../org/apache/pulsar/io/file/nonGzipFile.txt      |  20 ++
 .../org/apache/pulsar/io/file/validGzip.gz         | Bin 0 -> 60 bytes
 .../org/apache/pulsar/io/file/validZip.zip         | Bin 0 -> 200 bytes
 pulsar-io/file/src/test/resources/sinkConfig.yaml  |  33 +++
 pulsar-io/pom.xml                                  |   1 +
 26 files changed, 2185 insertions(+)

commit f15afec6eed12a36dec003d1e1c1f83d3e4b1e16
Author: penghui <codelipenghui@gmail.com>
Date:   Fri Dec 28 01:47:27 2018 +0800

    Improve service url and service url provider prompt. (#3257)
    
    ### Motivation
    
    Improve service url and service url provider prompt when user build a pulsar client.
    
    ### Modifications
    
    Add service url and service url provider check when build a pulsar client.
    Add  UT.
    
    ### Result
    
    UT passed

 .../pulsar/client/impl/ClientBuilderImpl.java      | 21 +++++--
 .../pulsar/client/impl/ClientBuilderImplTest.java  | 73 ++++++++++++++++++++++
 2 files changed, 90 insertions(+), 4 deletions(-)

commit e63b658d8d0e5863d9b77658d3b1eb8b374f0de9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Dec 26 17:29:31 2018 -0800

    add backwards compatiblity to 2.2 for function admin API (#3241)
    
    * add backwards compatiblity to 2.2 for function admin API
    
    * add license headers
    
    * renaming
    
    * fix tests
    
    * get integrations tests to pass

 .../org/apache/pulsar/broker/PulsarService.java    |    1 +
 .../apache/pulsar/broker/admin/v1/Functions.java   |    9 +-
 .../apache/pulsar/broker/admin/v2/Functions.java   |  303 +++-
 .../apache/pulsar/broker/admin/v3/Functions.java   |   34 +
 .../pulsar/broker/admin/{v2 => v3}/Sink.java       |    2 +-
 .../pulsar/broker/admin/{v2 => v3}/Source.java     |    2 +-
 .../client/admin/internal/FunctionsImpl.java       |    2 +-
 .../pulsar/client/admin/internal/SinkImpl.java     |    2 +-
 .../pulsar/client/admin/internal/SourceImpl.java   |    2 +-
 .../src/main/proto/InstanceCommunication.proto     |    8 +-
 .../pulsar/functions/worker/rest/Resources.java    |   19 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |   10 +-
 .../functions/worker/rest/api/FunctionsImplV2.java |  210 +++
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  299 ++--
 .../worker/rest/api/v3/FunctionApiV3Resource.java  |  292 ++++
 .../SinkApiV3Resource.java}                        |    6 +-
 .../SourceApiV3Resource.java}                      |    6 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  603 ++++----
 .../rest/api/v3/FunctionApiV3ResourceTest.java     | 1500 ++++++++++++++++++++
 .../SinkApiV3ResourceTest.java}                    |    6 +-
 .../SourceApiV3ResourceTest.java}                  |    6 +-
 21 files changed, 2843 insertions(+), 479 deletions(-)

commit 7a313524aa0f0159b443941b8ba8aa4e9ce83a2b
Author: legendtkl <taokelu@gmail.com>
Date:   Thu Dec 27 01:43:44 2018 +0800

    Document new rest api - getLastMessageId (#3243)
    
    Fixes #3233

 site/docs/latest/admin-api/persistent-topics.md | 18 ++++++++++++++++++
 site2/docs/admin-api-persistent-topics.md       | 18 ++++++++++++++++++
 2 files changed, 36 insertions(+)

commit 94a942384b4d1e07fba4dfb1fe2cc0c06bc0a2ea
Author: legendtkl <taokelu@gmail.com>
Date:   Thu Dec 27 00:14:50 2018 +0800

    cli support for get last message id of a topic (#3251)
    
    This pr is add cli support to get last message id of a topic
    1. add cli support for api: /admin/v2/persistent/{tenant}/{namespace}/{topic}/lastMessageId
    2. the cli command is like: ./pulsar-admin topics last-message-id topic-name
    
    Test Result:
    
    ```bash
      bin ./pulsar-admin topics last-message-id persistent://public/default/my-topic
    {
      "ledgerId" : 10,
      "entryId" : -1,
      "partitionIndex" : -1
    }
      bin ./pulsar-admin topics last-message-id persistent://public/default/my-topi
    Topic not found
    
    Reason: Topic not found
    ```

 .../org/apache/pulsar/client/admin/Topics.java     |  9 ++++++
 .../pulsar/client/admin/internal/TopicsImpl.java   | 32 ++++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 13 +++++++++
 3 files changed, 54 insertions(+)

commit ea6f366997c7a693f926df4d340ff87e9177db1d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Dec 25 21:35:33 2018 -0800

    Fix NPE: namespaceService need leaderElection service (#3238)
    
    ### Motivation
    
    namespace-service uses leaderElectionService so, leaderElectionService should start before namespace-service.
    
    ```
    Caused by: java.lang.NullPointerException
            at org.apache.pulsar.broker.namespace.NamespaceService.searchForCandidateBroker(NamespaceService.java:376) ~[pulsar-broker-2.2.jar]
            ... 9 more
    
    
                    at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1977) ~[?:1.8.0_131]
            at org.apache.pulsar.broker.namespace.NamespaceService.searchForCandidateBroker(NamespaceService.java:395) ~[pulsar-broker-2.2.jar]
            at org.apache.pulsar.broker.namespace.NamespaceService.lambda$22(NamespaceService.java:335) ~[pulsar-broker-2.2.jar]
            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_131]
            at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_131]
            at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_131]
            at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_131]
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_131]
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_131]
            at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [pulsar-functions-metrics-2.2.2-yahoo.jar:?]
            at java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]
    ```

 .../org/apache/pulsar/broker/PulsarService.java    | 70 ++++++++++++----------
 1 file changed, 37 insertions(+), 33 deletions(-)

commit 1e4f7695972c2ccd2f2b9566e5b9eefeec650b5f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Dec 25 21:34:21 2018 -0800

    Clear-out old inbound cnx stats when repl producer disconnects (#3250)
    
    ### Motivation
    
    Right now, when remote replication-producer gets disconnected due to below `ProducerBlockedQuotaExceededError`, broker doesn't cleanup inbound repl-producer stats for the topic and it shows invalid stale inbound cnx stats until new producer gets created successfully.
    
    ```
    20:10:28.628 [pulsar-io-21-2] WARN  org.apache.pulsar.broker.service.AbstractReplicator - [persistent://localsearch/global/ns/t1][east1 -> west1] Failed to create remote producer (org.apache.pulsar.client.api.PulsarClientException$ProducerBlockedQuotaExceededError: Cannot create producer on topic with backlog quota exceeded), retrying in 5
    ```
    
    ### Modifications
    
    Clear-out old stale inbound-repl stats.
    
    ### Result
    
    Broker will not show invalid stale repl-stats.

 .../pulsar/broker/service/persistent/PersistentTopic.java      | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit 7a1a14855b7a08a4dd22c2f97b4bb79de33731b7
Author: wpl <1269223860@qq.com>
Date:   Tue Dec 25 02:07:12 2018 +0800

    [pulsar-flink] add streaming connectors as a Pulsar stream that serializes data in Avro format (#3231)
    
    ### Motivation
    
    add Avro data format flink streaming connectors
    
    
    ### Modifications
    
    add class PulsarAvroTableSink
    
    ### Result
    
    add append-only table sink for serializes data in Avro format.

 .gitignore                                         |   4 +-
 examples/flink-consumer-source/pom.xml             |  12 ++
 .../example/FlinkPulsarBatchAvroSinkExample.java   |   2 +-
 ...lsarConsumerSourceWordCountToAvroTableSink.java | 120 +++++++++++++++
 ...lsarConsumerSourceWordCountToJsonTableSink.java | 133 ++++++++++++++++
 .../src/main/resources/avro/NasaMission.avsc       |  12 +-
 .../FlinkPulsarBatchAvroSinkScalaExample.scala     |   2 +-
 pulsar-flink/pom.xml                               |   4 +
 .../connectors/pulsar/PulsarAvroTableSink.java     | 169 +++++++++++++++++++++
 .../serialization/AvroSerializationSchemaTest.java |   2 +-
 .../connectors/pulsar/PulsarAvroTableSinkTest.java | 106 +++++++++++++
 .../connectors/pulsar/PulsarJsonTableSinkTest.java | 100 ++++++++++++
 .../src/test/resources/avro/NasaMission.avsc       |   2 +-
 13 files changed, 661 insertions(+), 7 deletions(-)

commit a43ae4dee2360d937dd9da37fb197cebe57e9fa8
Author: Enrico Olivelli <eolivelli@gmail.com>
Date:   Mon Dec 24 19:05:34 2018 +0100

    Issue 3247: Build error on linux if userid is an huge number (#3248)
    
    ### Motivation
    
    Fix build error reported in #3247
    
    ### Modifications
    
    Add tarLongFileMode = posix in assembly plugin configurations
    
    ### Result
    
    The build passes on linux with an huge uid

 pulsar-sql/presto-distribution/pom.xml  | 1 +
 pulsar-sql/presto-pulsar-plugin/pom.xml | 1 +
 2 files changed, 2 insertions(+)

commit c3a7d6a89eaf6c7cb1ff226ffc9b7c67bc418bc4
Author: Samuel <foreversunyao@yahoo.com>
Date:   Mon Dec 24 12:40:52 2018 +0800

    document co-run zookeeper and bookie on same machine (#3242)
    
    ### Motivation
    
    Issue: https://github.com/apache/pulsar/issues/3213
    
    ### Modifications
    
    update the readme to highlight this part
    
    ### Result
    
    After your change, what will change.

 site2/docs/deploy-bare-metal.md | 9 +++++++++
 1 file changed, 9 insertions(+)

commit f24a0b191f178369b253642d89f28e5115008142
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Dec 23 14:10:36 2018 -0800

    Fix: Empty exception message in java functions can cause an NPE (#3245)
    
    * Fix: Empty exception message in java functions can cause an NPE
    
    * add additional exception message error null checking

 .../functions/instance/FunctionStatsManager.java   | 34 ++++++++++++----------
 1 file changed, 18 insertions(+), 16 deletions(-)

commit 5dc90b413cbd9d97614dfe7cbca9c32e6e4457fb
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sun Dec 23 16:08:41 2018 +0000

    [Pulsar-Broker-Common] Extend AuthenticationProviderToken UT Coverages (#3244)
    
    * [Pulsar-Broker-Common] Extend AuthenticationProviderToken UT Coverage
    
    * Add UT to simulate invalid Public Key Path case

 .../AuthenticationProviderToken.java               |  4 ++--
 .../AuthenticationProviderTokenTest.java           | 24 ++++++++++++++++++++++
 .../pulsar/utils/auth/tokens/TokensCliUtils.java   |  2 --
 3 files changed, 26 insertions(+), 4 deletions(-)

commit 90f6b9ed550347b1e3bfe07c67833987b27087e7
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Dec 22 19:24:17 2018 -0800

    Fix: NPE in pulsar source close (#3246)

 .../org/apache/pulsar/functions/source/PulsarSource.java   | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

commit db26946520d3fe2c66bc0bc7c87815a8ef3754f4
Author: penghui <codelipenghui@gmail.com>
Date:   Sat Dec 22 22:04:48 2018 +0800

    UnAcked message tracker based on TimePartition (#3118)
    
    ### Motivation
    
    currently un-ack message tracker  redelivery is done in batch, not taking into account the actual arrival time of the message.
    
    Split acktimeout into several time-partition, user can define the tick duration.
    
    ### Modifications
    
    Improve UnAckedMessageTracker use time partitions to maintain un-acked messages, UnAckedMessageTracker main partitions by LinkedList, remove first partition from the LinkedList and process it and add last partition to the LinkedList when timeout. All un-acked messages add into the last partition.
    
    ### Result
    
    UT passed

 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   9 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |   3 +-
 .../pulsar/client/api/ConsumerConfiguration.java   |   8 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   1 -
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  10 +-
 .../client/impl/MultiTopicsConsumerImpl.java       |   6 +-
 .../pulsar/client/impl/UnAckedMessageTracker.java  | 163 ++++++++++++---------
 .../client/impl/UnAckedTopicMessageTracker.java    |  40 +++--
 .../impl/conf/ConsumerConfigurationData.java       |   8 +-
 9 files changed, 148 insertions(+), 100 deletions(-)

commit a901a35e5c6a18e2bccdc4320a8bb86678f83f74
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Dec 22 05:59:53 2018 -0800

    add replication_delay to namespace metrics (#2983)
    
    ### Motivation
    
    Right now, broker metrics provide `replicationDelay` per topic level but we have setup monitoring on namespace metrics `./pulsar-admin  broker-stats monitoring-metrics` and we also need `replicationDelay` at namespace level to get estimate delay from namespace graphs.
    
    ### Modifications
    
    Find out max replication-delay among all the topics of a namespace and use it to namespace-metrics to provide estimate repl-dealy for a namespace.

 .../org/apache/pulsar/broker/service/persistent/PersistentTopic.java  | 4 ++++
 .../src/main/java/org/apache/pulsar/broker/stats/NamespaceStats.java  | 3 +++
 2 files changed, 7 insertions(+)

commit 2607c18d1b27c1df667d62d8343acd1b306c3c8f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Dec 21 16:04:36 2018 -0800

    fix bug involving consumer producer deadlock in functions (#3237)
    
    * fix bug involving consumer producer deadlock in functions
    
    * fix unit test

 .../src/main/java/org/apache/pulsar/functions/sink/PulsarSink.java    | 3 +++
 pulsar-functions/instance/src/main/python/contextimpl.py              | 4 ++--
 pulsar-functions/instance/src/main/python/python_instance.py          | 4 ++++
 .../test/java/org/apache/pulsar/functions/sink/PulsarSinkTest.java    | 4 +++-
 4 files changed, 12 insertions(+), 3 deletions(-)

commit d7526c8a24d1b17dd793cf621561d659bbe0285c
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Fri Dec 21 23:10:00 2018 +0000

    [Pulsar-Broker-Common] Refactor AuthenticationProviderToken (#3239)
    
    * [Pulsar-Broker-Common] Refactor AuthenticationProviderToken
    
    * Update Unit Test name

 .../AuthenticationProviderToken.java               |  61 ++++----
 .../AuthenticationProviderTokenTest.java           | 164 ++++++++++++++++++---
 2 files changed, 177 insertions(+), 48 deletions(-)

commit d9691b71b58159e49300de58d9e8efd87a81673b
Author: wpl <1269223860@qq.com>
Date:   Sat Dec 22 04:55:30 2018 +0800

    [issues 3232] integrate flink-json to pulsar (#3234)
    
    * Implements a batch program on Pulsar topic by writing Flink DataSet as Avro.
    
    * fix up
    
    * remove avro generated
    
    * fix up time-out
    
    * fix up time-out
    
    * fix up
    
    * modify review content code
    
    * modify Tests FAILURE
    
    * run Tests
    
    * run Tests
    
    * fix up pulsar-flink and flink-consumer-source
    
    * fix up pulsar-flink and flink-consumer-source
    
    * add flink streaming table as a Pulsar stream that serializes data in Avro format.
    
    * integrate flink-json to pulsar

 pulsar-flink/pom.xml                               |   6 +
 .../connectors/pulsar/PulsarJsonTableSink.java     |   2 +-
 .../pulsar/serde/JsonRowDeserializationSchema.java | 160 ---------------------
 .../pulsar/serde/JsonRowSerializationSchema.java   |  92 ------------
 4 files changed, 7 insertions(+), 253 deletions(-)

commit f4936763af1c1dab54d031ae355e40d66d3a602e
Author: legendtkl <taokelu@gmail.com>
Date:   Fri Dec 21 13:19:28 2018 +0800

    support GetLastMessageId api (#3196)
    
    issue ticket:  https://github.com/apache/pulsar/issues/3162 (Fixes #3162)
    
    the pr is straightforward, and it exposes the Persistent Topic GetLastMessageId to Rest API: /admin/v2/persistent/{tenant}/{namespace}/{topic}/lastMessageId

 .../broker/admin/impl/PersistentTopicsBase.java    |  17 +++
 .../pulsar/broker/admin/v2/PersistentTopics.java   |  14 ++
 .../broker/admin/AdminApiGetLastMessageIdTest.java | 142 +++++++++++++++++++++
 3 files changed, 173 insertions(+)

commit 867d924e201a7400e29d438bfb191fff8395ce6f
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Dec 20 18:20:18 2018 -0800

    Refactor api commands (#3168)
    
    * Change to RestApi Exception
    
    * Fix Tests
    
    * Fix Tests
    
    * Fix Comments
    
    * Fix Api Annotation Annotation
    
    * Fix getFunctionInfo
    
    * Fix Trigger Function
    
    * Remove Test field
    
    * Change Error Code
    
    * Fix tests
    
    Add Status code Asserts
    
    * Fix Status Code
    
    Rename getStateStoreUnvailableResponse

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  226 ++--
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |  125 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |  118 +-
 .../apache/pulsar/broker/lookup/LookupResult.java  |    2 +-
 .../functions/worker/rest/api/ComponentImpl.java   |  435 +++----
 .../pulsar/functions/worker/rest/api/SinkImpl.java |   33 +
 .../functions/worker/rest/api/SourceImpl.java      |   33 +
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  174 +--
 .../worker/rest/api/v2/SinkApiV2Resource.java      |  117 +-
 .../worker/rest/api/v2/SourceApiV2Resource.java    |   81 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 1272 +++++++++++---------
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  |  898 ++++++++------
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 1167 ++++++++++--------
 13 files changed, 2565 insertions(+), 2116 deletions(-)

commit 6c427377a2dcc0efc2f8cb239d8b9fdd4cc14bd6
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Dec 20 14:53:55 2018 -0800

    optimize py function stats usage (#3229)

 .../instance/src/main/python/contextimpl.py        | 23 ++++---
 .../instance/src/main/python/function_stats.py     | 77 +++++++++++++---------
 2 files changed, 58 insertions(+), 42 deletions(-)

commit 06d37556db75d551f8f284c9ee3635aaded232f1
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Dec 20 11:49:39 2018 -0800

    Configure limited number of threads in Jetty executor (#3207)
    
    * Configure limited number of threads in Jetty executor
    
    * Fixed parenthesis position
    
    * Fixed usage of ExecutorThreadPool
    
    * join() -> stop()
    
    * Another fix for ExecutorThreadPool
    
    * Increased default number of threads since these are also shared with proxy client

 conf/broker.conf                                   |  3 ++
 conf/proxy.conf                                    |  8 ++--
 conf/websocket.conf                                |  5 ++-
 .../apache/pulsar/broker/ServiceConfiguration.java | 13 +++++--
 .../pulsar/broker/web/WebExecutorThreadPool.java   | 44 ++++++++++++++++++++++
 .../org/apache/pulsar/broker/web/WebService.java   | 10 ++---
 .../pulsar/functions/worker/rest/WorkerServer.java | 26 ++++++-------
 .../pulsar/proxy/server/ProxyConfiguration.java    | 15 ++++++--
 .../org/apache/pulsar/proxy/server/WebServer.java  |  7 ++--
 .../pulsar/websocket/service/ProxyServer.java      |  7 ++--
 .../service/WebSocketProxyConfiguration.java       | 18 +++++++--
 11 files changed, 116 insertions(+), 40 deletions(-)

commit 3490e64f0d34d40b48517c7423e81008d62ca132
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Dec 21 02:12:48 2018 +0800

    [doc] Improve documentation of running administration dashboard for a Pulsar standalone installation (#3222)
    
    *Motivation*
    
    When running dashboard in a docker instance, `localhost` is the docker instance not the physical machine.
    
    *Changes*
    
    Improve the documentation to make statement more explicit and clearer

 site2/docs/administration-dashboard.md                                  | 2 +-
 .../versioned_docs/version-2.1.0-incubating/administration-dashboard.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 8c3eb3450a64af0014c77b815635c19ed8f84cc0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Dec 21 00:18:55 2018 +0800

     [conf] Add annotations for documenting function worker configuration settings (#3117)
    
    *Motivation*
    
    This change is adding annotations to function worker configuration for generating function worker configuration file.

 .../pulsar/functions/worker/WorkerConfig.java      | 287 +++++++++++++++++++--
 1 file changed, 268 insertions(+), 19 deletions(-)

commit 9c3f2a77bb352c073d2dc36094b42dc3c9918c3b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Dec 20 18:22:29 2018 +0800

     [conf] Add annotations for documenting broker configuration settings (#3113)
    
    *Motivation*
    
    This change is adding annotations to broker configuration for generating broker configuration file.

 .../apache/pulsar/broker/ServiceConfiguration.java | 1036 +++++++++++++++-----
 .../configuration/PulsarConfigurationLoader.java   |    7 +-
 2 files changed, 784 insertions(+), 259 deletions(-)

commit 71d5a251de868b8b5450f65b86a3a30e51385a2b
Author: ForwardXu <x1q1j1@163.com>
Date:   Thu Dec 20 13:53:33 2018 +0800

    Make pulsar compile on windows (#3221)
    
    Motivation
    To solve make pulsar compile on windows.

 managed-ledger-shaded/pom.xml                      |  2 +-
 pom.xml                                            | 15 ++++
 pulsar-broker-shaded/pom.xml                       |  2 +-
 .../pulsar-client-kafka-shaded/pom.xml             |  2 +-
 pulsar-client-shaded/pom.xml                       |  2 +-
 src/rename-netty-native-libs.cmd                   | 82 ++++++++++++++++++++++
 6 files changed, 101 insertions(+), 4 deletions(-)

commit 85b8bea4cd165c1b91983a1cd256f16fc149fe3a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Dec 19 19:43:28 2018 +0800

    Fix hdfs module dependencies in pulsar-io/docs module (#3215)
    
    *Motivation*
    
    In #2966, pulsar-io-hdfs is changed to two modules `pulsar-io-hdfs2`
    and `pulsar-io-hdfs3`. But the module is not updated in `pulsar-io/docs` module.

 pulsar-io/docs/pom.xml | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 00ae3cf545d25e3ad9d84b31c874f4a1b3beaf81
Author:  <158570986@qq.com>
Date:   Wed Dec 19 19:20:36 2018 +0800

    Provide a flag to ignore Json format error in pulsar flink connector (#3210)
    
    ### Motivation
    
    when using flink and pulsar, a Json format error will cause the flink program to fail
    
    ### Modifications
    
    provide a flag in pulsar flink connector to ignore json format errors

 .../pulsar/serde/JsonRowDeserializationSchema.java | 32 +++++++++++++++++++++-
 1 file changed, 31 insertions(+), 1 deletion(-)

commit 8da04cb883a586c605316cd7d5cf43b1009f037f
Author: wpl <1269223860@qq.com>
Date:   Wed Dec 19 19:19:47 2018 +0800

    fix up pulsar-flink and flink-consumer-source (#3212)
    
    ### Motivation
    
    fix up flink-consumer-source example run error
    
    ### Modifications
    
    modify pom.xml, sl4j and log4j2
    
    ### Result
    
    1. log conflict sl4j and log4j2
    2. flink-consumer-source example use pulsar-flink model class and api, cann't execution
    3. pulsar-flink not use jar but flink-consumer-source use, like flink-scala

 .gitignore                                         |  1 +
 examples/flink-consumer-source/pom.xml             | 33 ++++++++++++++-----
 .../src/main/resources/log4j2.xml                  | 37 ++++++++++++++++++++++
 pulsar-flink/pom.xml                               | 23 ++------------
 4 files changed, 65 insertions(+), 29 deletions(-)

commit 83cf25c9699be808de258e308d0c31efc53deed8
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Dec 18 18:43:59 2018 -0800

    optimize java functions stats code (#3209)
    
    ### Motivation
    
    Optimized the stats collection code for java functions to reduce stats collection foot print both memory and cpu.  Reduced the number of objects allocated by 20% in java functions

 .../functions/instance/FunctionStatsManager.java   | 127 ++++++++++++++-------
 .../functions/instance/JavaInstanceRunnable.java   |   4 +-
 2 files changed, 89 insertions(+), 42 deletions(-)

commit 6bb459ce42d77c7a47bcffa3f9c61a56c29fdb76
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Tue Dec 18 09:49:04 2018 +0000

    [Pulsar-Client] Extends ConsumerBuilder Validations (#3200)
    
    ### Motivation
    This PR aims to extend validations on `ConsumerBuilder` as Public API.
    
    ### Modifications
    1- `ConsumerBuilder` needs to be robust for **null** and **blank** values as Public API.
    2- New UT coverage is added.

 .../client/api/SimpleProducerConsumerTest.java     |   8 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  36 +++-
 .../client/impl/ConsumerBuilderImplTest.java       | 223 +++++++++++++++++++++
 3 files changed, 253 insertions(+), 14 deletions(-)

commit 5493e2fa447a6efac472960d9fa41eff4718c379
Author: wpl <1269223860@qq.com>
Date:   Tue Dec 18 17:48:11 2018 +0800

    [pulsar-flink] Implements a batch program on Pulsar topic by writing Flink DataSet as Avro (#3205)
    
    Implements a batch program on Pulsar topic by writing Flink DataSet as Avro data Type

 .gitignore                                         |  3 +
 examples/flink-consumer-source/pom.xml             | 25 ++++++++
 .../example/FlinkPulsarBatchAvroSinkExample.java   | 74 ++++++++++++++++++++++
 .../batch/connectors/pulsar/example/README.md      | 68 +++++++++++++++++++-
 .../src/main/resources/avro/NasaMission.avsc       | 10 +++
 .../FlinkPulsarBatchAvroSinkScalaExample.scala     | 72 +++++++++++++++++++++
 .../batch/connectors/pulsar/example/README.md      | 68 +++++++++++++++++++-
 pulsar-flink/pom.xml                               | 35 ++++++++++
 .../connectors/pulsar/PulsarAvroOutputFormat.java  | 36 +++++++++++
 .../serialization/AvroSerializationSchema.java     | 61 ++++++++++++++++++
 .../pulsar/PulsarAvroOutputFormatTest.java         | 56 ++++++++++++++++
 .../serialization/AvroSerializationSchemaTest.java | 65 +++++++++++++++++++
 .../src/test/resources/avro/NasaMission.avsc       | 10 +++
 13 files changed, 577 insertions(+), 6 deletions(-)

commit 1414edd322c364152e9d5c47a9dad8b469fe5977
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Dec 17 21:54:10 2018 -0800

    Path prometheus python client due to thread leak (#3206)

 .../src/main/python/prometheus_client_fix.py       | 56 ++++++++++++++++++++++
 .../src/main/python/python_instance_main.py        | 10 +++-
 2 files changed, 64 insertions(+), 2 deletions(-)

commit 5d240670386bcdcc5c48c61494547f49cd7ca115
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Dec 17 17:56:29 2018 -0800

    enable java enums to be queried in sql (#3202)
    
    ### Motivation
    
    Allow enums in POJOs to be visible in sql for querying
    
    Enums in POJOs will be presented as VARCHAR in Presto

 .../apache/pulsar/sql/presto/PulsarMetadata.java   |  9 ++++++++
 .../pulsar/sql/presto/TestPulsarConnector.java     | 25 +++++++++++++++++++++-
 .../pulsar/sql/presto/TestPulsarRecordCursor.java  |  3 +++
 3 files changed, 36 insertions(+), 1 deletion(-)

commit ee53ab6f21299dad0f19ab42caa94a7e9c336167
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Dec 17 09:01:06 2018 -0800

    improve datagenerator source (#3203)
    
    * improve datagenerator source
    
    * cleaning up

 pulsar-io/data-genenator/pom.xml                   |  5 ++
 .../io/datagenerator/DataGeneratorPrintSink.java   | 45 ++++++++++
 .../io/datagenerator/DataGeneratorSource.java      |  4 +-
 .../org/apache/pulsar/io/datagenerator/Person.java | 96 ++++++++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  1 +
 5 files changed, 148 insertions(+), 3 deletions(-)

commit b6c25ed0ea07de571455cca830f3a9879998a803
Author: ForwardXu <x1q1j1@163.com>
Date:   Mon Dec 17 21:12:19 2018 +0800

    Error open RocksDB database in docker for windows (#3201)
    
    ### Motivation
    
    To solve the error open RocksDB database in docker for windows
    
    ### Modifications
    
    ```shell
    $ docker run -it \
      -p 6650:6650 \
      -p 8080:8080 \
      -v "E:/data:/pulsar/data".ToLower() \
      apachepulsar/pulsar:{{site.current_version}} \
      bin/pulsar standalone
    ```
    
    ### Result
    
    Have no effect on.

 site2/docs/getting-started-docker.md                       | 14 +++++++++++++-
 .../version-2.1.0-incubating/getting-started-docker.md     | 14 +++++++++++++-
 2 files changed, 26 insertions(+), 2 deletions(-)

commit 68b5dd5e1f45fcac0eb052ae3426329ae84bda78
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Mon Dec 17 05:03:04 2018 -0800

    Fixes to get the travis build running again (#3204)
    
    Travis build was broken for some time now, made some fixes to get it working again.

 .travis.yml                            | 15 ++++++++++-----
 pulsar-client-cpp/tests/CMakeLists.txt |  3 ++-
 pulsar-client-cpp/travis-build.sh      | 14 +++++++-------
 3 files changed, 19 insertions(+), 13 deletions(-)

commit da07af98fd3b84e000250c9904dd6c29e31a6512
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Dec 16 14:53:46 2018 -0800

    Get information_schema for pulsar connector to work (#3195)
    
    * Get information_schema for pulsar connector to work
    
    * fix unit test

 .../pulsar/sql/presto/PulsarConnectorConfig.java   | 10 ++--
 .../pulsar/sql/presto/PulsarConnectorUtils.java    |  9 +---
 .../apache/pulsar/sql/presto/PulsarMetadata.java   | 60 +++++++++++++++-------
 .../pulsar/sql/presto/TestPulsarMetadata.java      | 12 ++---
 4 files changed, 52 insertions(+), 39 deletions(-)

commit e2408efb46c327bc2df77bda167e233a734f7319
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Dec 16 08:10:02 2018 -0800

    Use direct memory instead of Heap to determine a broker is "overloaded" in memory usage (#3199)

 .../pulsar/broker/loadbalance/impl/SimpleLoadManagerImpl.java     | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 41e8e66b3e5db880b85fe0fe66327bbeb48a5fc7
Author: ForwardXu <x1q1j1@163.com>
Date:   Sun Dec 16 16:24:02 2018 +0800

    Error open RocksDB database in docker for windows (#3198)
    
    ### Motivation
    
    To solve the error open RocksDB database in docker for windows
    
    ### Modifications
    
    ```shell
    $ docker run -it \
      -p 6650:6650 \
      -p 8080:8080 \
      -v "E:/data:/pulsar/data".ToLower() \
      apachepulsar/pulsar:{{site.current_version}} \
      bin/pulsar standalone
    ```
    
    ### Result
    
    Have no effect on.

 site/docs/latest/getting-started/docker.md | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 2ccf7ff2a6c16f1b16342aa4529d5197195bad9d
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Sat Dec 15 17:37:35 2018 -0800

    Broke Pulsar-IO::HDFS into 3.x and 2.x versions (#2966)
    
    ### Motivation
    
    A user was attempting to use the existing HDFS connector to connect to a 2.x version of HDFS, but the current connector only supported 3.x version of HDFS.
    
    ### Modifications
    
    To address this issue, we renamed the current HDFS connector to HDFS3, and created a new 2.x compatible connector named HDFS2.
    
    The code in both of these are nearly identical with 2 notable exceptions. First and foremost, they both use different versions of the Hadoop-client library. And secondly, the HDFS2 version creates the FSDataOutputStream object directly, whereas the HDFS3 version leverages the FSDataOutputStreamBuilder class for this purpose, as it is the preferred method going forward.
    
    ### Result
    
    There will be be support for connecting to both 2.x and 3.x version of HDFS. However, there MAY BE some library conflicts in the released jar due to the different versions of the same library in the different modules. Hopefully the NAR packaging will address this.

 pulsar-io/hdfs2/pom.xml                            |  74 ++++++
 .../pulsar/io/hdfs2}/AbstractHdfsConfig.java       |   2 +-
 .../pulsar/io/hdfs2}/AbstractHdfsConnector.java    |   4 +-
 .../org/apache/pulsar/io/hdfs2}/Compression.java   |   2 +-
 .../org/apache/pulsar/io/hdfs2}/HdfsResources.java |   2 +-
 .../org/apache/pulsar/io/hdfs2}/SecurityUtil.java  |   2 +-
 .../org/apache/pulsar/io/hdfs2}/package-info.java  |   2 +-
 .../pulsar/io/hdfs2/sink/HdfsAbstractSink.java     | 112 +++++++++
 .../pulsar/io/hdfs2}/sink/HdfsSinkConfig.java      |   4 +-
 .../pulsar/io/hdfs2}/sink/HdfsSyncThread.java      |   2 +-
 .../apache/pulsar/io/hdfs2/sink}/package-info.java |   2 +-
 .../sink/seq/HdfsAbstractSequenceFileSink.java     |   4 +-
 .../io/hdfs2}/sink/seq/HdfsSequentialTextSink.java |   2 +-
 .../pulsar/io/hdfs2}/sink/seq/HdfsTextSink.java    |   2 +-
 .../pulsar/io/hdfs2/sink/seq}/package-info.java    |   2 +-
 .../hdfs2}/sink/text/HdfsAbstractTextFileSink.java |   4 +-
 .../pulsar/io/hdfs2}/sink/text/HdfsStringSink.java |   2 +-
 .../pulsar/io/hdfs2/sink/text/package-info.java    |  19 ++
 .../resources/META-INF/services/pulsar-io.yaml     |   6 +-
 .../pulsar/io/hdfs2/sink/AbstractHdfsSinkTest.java | 120 ++++++++++
 .../pulsar/io/hdfs2}/sink/HdfsSinkConfigTests.java |   5 +-
 .../hdfs2}/sink/seq/HdfsSequentialSinkTests.java   |   5 +-
 .../io/hdfs2}/sink/seq/HdfsTextSinkTests.java      |   5 +-
 .../io/hdfs2/sink/text/HdfsStringSinkTests.java    | 104 +++++++++
 .../src/test/resources/hadoop/core-site.xml        |   0
 .../src/test/resources/hadoop/hdfs-site.xml        |   0
 .../src/test/resources/sinkConfig.yaml             |   0
 pulsar-io/{hdfs => hdfs3}/pom.xml                  |   4 +-
 .../apache/pulsar/io/hdfs3/AbstractHdfsConfig.java |  86 +++++++
 .../pulsar/io/hdfs3/AbstractHdfsConnector.java     | 258 +++++++++++++++++++++
 .../org/apache/pulsar/io/hdfs3/Compression.java    |  26 +++
 .../org/apache/pulsar/io/hdfs3/HdfsResources.java  |  51 ++++
 .../org/apache/pulsar/io/hdfs3/SecurityUtil.java   |  91 ++++++++
 .../org/apache/pulsar/io/hdfs3}/package-info.java  |   2 +-
 .../pulsar/io/hdfs3}/sink/HdfsAbstractSink.java    |   6 +-
 .../pulsar/io/hdfs3/sink/HdfsSinkConfig.java       | 108 +++++++++
 .../pulsar/io/hdfs3/sink/HdfsSyncThread.java       |  80 +++++++
 .../apache/pulsar/io/hdfs3/sink/package-info.java  |  19 ++
 .../sink/seq/HdfsAbstractSequenceFileSink.java     |  96 ++++++++
 .../io/hdfs3/sink/seq/HdfsSequentialTextSink.java  |  71 ++++++
 .../pulsar/io/hdfs3/sink/seq/HdfsTextSink.java     |  54 +++++
 .../pulsar/io/hdfs3/sink/seq/package-info.java     |  19 ++
 .../hdfs3/sink/text/HdfsAbstractTextFileSink.java  |  79 +++++++
 .../pulsar/io/hdfs3/sink/text/HdfsStringSink.java  |  34 +++
 .../pulsar/io/hdfs3/sink/text/package-info.java    |  19 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../io/hdfs3}/sink/AbstractHdfsSinkTest.java       |   3 +-
 .../pulsar/io/hdfs3/sink/HdfsSinkConfigTests.java  | 155 +++++++++++++
 .../hdfs3/sink/seq/HdfsSequentialSinkTests.java}   |  82 +++----
 .../io/hdfs3/sink/seq/HdfsTextSinkTests.java       | 105 +++++++++
 .../io/hdfs3/sink/text/HdfsStringSinkTests.java    | 104 +++++++++
 .../hdfs3/src/test/resources/hadoop/core-site.xml  |  32 +++
 .../hdfs3/src/test/resources/hadoop/hdfs-site.xml  |  34 +++
 pulsar-io/hdfs3/src/test/resources/sinkConfig.yaml |  25 ++
 pulsar-io/pom.xml                                  |   3 +-
 55 files changed, 2075 insertions(+), 81 deletions(-)

commit 18b2a20d970e1241e0e78149b30bda4780042cf7
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Sat Dec 15 17:37:02 2018 -0800

    Start Pulsar in TLS Only mode and deprecate tlsEnabled flag. (#2988)
    
    ### Motivation
    Start Pulsar services (broker, proxy, websocket, discovery) in TLS only mode, so that they only listen on TLS ports.
    
    Once TlsPort is set tlsEnabled flag becomes redundant information - hence getting rid of the flag in relevant components.
    
    ### Modifications
    
    a. Changed the Ports to Option<Integer> in the configuration file.
    b. In Websocket Service there was a bug where we used 'tlsEnabled' flag to start listening on a TLS port and to talk to broker in on serviceUrlTls - separated the flag into two (tlsEnabled and brokerClientTlsEnabled) and deprecated tlsEnabled.
    c. Fixed a lot of tests which relied on tlsEnabled flag.
    
    ### Result
    Brokers can now listen to TLS only port.

 .gitignore                                         |  1 +
 conf/broker.conf                                   | 10 +++----
 conf/discovery.conf                                |  6 ++--
 conf/proxy.conf                                    |  6 ++--
 conf/websocket.conf                                |  5 ++--
 .../apache/pulsar/broker/ServiceConfiguration.java | 25 ++++++++++++----
 .../PulsarConfigurationLoaderTest.java             | 10 +++----
 .../org/apache/pulsar/PulsarBrokerStarter.java     | 10 +++----
 .../java/org/apache/pulsar/PulsarStandalone.java   | 10 +++----
 .../broker/MessagingServiceShutdownHook.java       |  2 +-
 .../org/apache/pulsar/broker/PulsarService.java    | 26 +++++++++++------
 .../apache/pulsar/broker/admin/AdminResource.java  |  4 +--
 .../pulsar/broker/loadbalance/NoopLoadManager.java |  2 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  2 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  4 +--
 .../pulsar/broker/namespace/NamespaceService.java  | 21 +++++++++----
 .../pulsar/broker/service/BrokerService.java       | 30 +++++++++----------
 .../pulsar/broker/web/PulsarWebResource.java       |  2 +-
 .../org/apache/pulsar/broker/web/WebService.java   | 17 +++++++----
 .../apache/pulsar/compaction/CompactorTool.java    | 15 ++++++----
 .../apache/pulsar/broker/SLAMonitoringTest.java    |  4 +--
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  1 -
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  2 +-
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   |  1 -
 .../broker/admin/BrokerAdminClientTlsAuthTest.java |  1 -
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  1 -
 .../AntiAffinityNamespaceGroupTest.java            |  2 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  2 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |  2 +-
 .../broker/namespace/OwnershipCacheTest.java       |  3 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |  5 ----
 .../pulsar/broker/service/PersistentTopicTest.java |  4 +--
 .../pulsar/broker/service/ReplicatorTestBase.java  |  2 --
 .../broker/service/v1/V1_ReplicatorTestBase.java   |  2 --
 .../apache/pulsar/broker/web/WebServiceTest.java   |  5 ++--
 .../api/AuthenticatedProducerConsumerTest.java     |  1 -
 .../AuthenticationTlsHostnameVerificationTest.java |  1 -
 .../pulsar/client/api/BrokerServiceLookupTest.java | 18 +++++-------
 .../pulsar/client/api/ServiceUrlProviderTest.java  |  2 ++
 .../pulsar/client/api/TlsProducerConsumerBase.java |  1 -
 .../common/naming/ServiceConfigurationTest.java    |  3 +-
 .../worker/PulsarWorkerAssignmentTest.java         |  4 +--
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |  5 ++--
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  5 ++--
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |  5 ++--
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  2 +-
 .../proxy/ProxyPublishConsumeTlsTest.java          |  2 +-
 .../pulsar/discovery/service/DiscoveryService.java | 34 +++++++++++++++-------
 .../discovery/service/server/ServerManager.java    | 18 +++++-------
 .../discovery/service/server/ServiceConfig.java    | 31 +++++++++++---------
 .../discovery/service/BaseDiscoveryTestSetup.java  |  1 -
 .../service/web/DiscoveryServiceWebTest.java       |  1 -
 .../pulsar/functions/worker/WorkerConfig.java      | 12 ++++++--
 .../pulsar/functions/worker/rest/WorkerServer.java |  2 +-
 .../worker/WorkerApiV2ResourceConfigTest.java      |  4 +--
 .../pulsar/proxy/server/ProxyConfiguration.java    | 33 +++++++++++++++------
 .../apache/pulsar/proxy/server/ProxyService.java   | 30 +++++++++++++------
 .../org/apache/pulsar/proxy/server/WebServer.java  | 15 +++++-----
 .../proxy/server/AuthedAdminProxyHandlerTest.java  |  4 +--
 .../ProxyAuthenticatedProducerConsumerTest.java    |  4 +--
 .../proxy/server/ProxyAuthenticationTest.java      |  1 -
 .../server/ProxyConnectionThrottlingTest.java      |  4 +--
 .../proxy/server/ProxyForwardAuthDataTest.java     |  1 -
 .../proxy/server/ProxyLookupThrottlingTest.java    |  2 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |  1 -
 .../org/apache/pulsar/proxy/server/ProxyTest.java  | 10 +++----
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |  5 ++--
 .../server/ProxyWithAuthorizationNegTest.java      |  4 +--
 .../proxy/server/ProxyWithAuthorizationTest.java   | 11 +++----
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  4 +--
 .../SuperUserAuthedAdminProxyHandlerTest.java      |  4 +--
 .../server/UnauthedAdminProxyHandlerTest.java      |  6 ++--
 .../apache/pulsar/websocket/WebSocketService.java  | 12 ++++----
 .../pulsar/websocket/service/ProxyServer.java      | 17 +++++------
 .../service/WebSocketProxyConfiguration.java       | 25 +++++++++-------
 .../pulsar/websocket/LookupProtocolTest.java       |  6 ++--
 76 files changed, 325 insertions(+), 271 deletions(-)

commit 576609b01319f925a948c0754498edbdf880a86c
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sun Dec 16 01:35:43 2018 +0000

    [Pulsar-IO] Add Netty Tcp Source Support (#3179)
    
    ### Motivation
    Netty is NIO client server framework by supporting asynchronous event-driven communication and custom protocol implementation.
    Ref: https://netty.io/
    
    This PR proposes Pulsar-IO Netty Source Connector by aiming the Tcp clients. It enables an embedded Tcp Server to listen incoming Tcp messages and writes them to user-defined Pulsar topic.
    
    There are also other potential use-cases(Tcp, Http and Udp messages) for this module as follows:
    - Tcp Client (Pulsar-IO Sink): It can listen Pulsar messages and can write to remote Tcp Server.
    - Http Server and Client (Pulsar-IO Source and Sink)
    - Udp Server and Client (Pulsar-IO Source and Sink)
    
    This is following PR with #3095. Module has been rolled to Pulsar-IO in the light of the previous discussion.
    
    ### Modifications
    1- `NettyTcpServer`: Initializes an embedded Tcp Server to listen incoming Tcp Requests
    2- `NettyTcpServerHandler`: Inbound Channel Handler to handle incoming Tcp Requests
    3- `NettyChannelInitializer`: Channel Initializer to support different types of decoders and handlers
    4- `NettyTcpSource`: A push-based Source to listen Tcp messages and write them to user-defined Pulsar topic
    5- `NettyTcpSourceConfig`: To support user-defined config for both Map and Yaml.
    6- UT Coverages

 pulsar-io/netty/pom.xml                            |  86 ++++++++++++++
 .../org/apache/pulsar/io/netty/NettyTcpSource.java |  77 +++++++++++++
 .../pulsar/io/netty/NettyTcpSourceConfig.java      |  74 +++++++++++++
 .../netty/tcp/server/NettyChannelInitializer.java  |  43 +++++++
 .../pulsar/io/netty/tcp/server/NettyTcpServer.java | 123 +++++++++++++++++++++
 .../io/netty/tcp/server/NettyTcpServerHandler.java |  62 +++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++++
 .../pulsar/io/netty/NettyTcpSourceConfigTest.java  |  82 ++++++++++++++
 .../tcp/server/NettyChannelInitializerTest.java    |  45 ++++++++
 .../io/netty/tcp/server/NettyTcpServerTest.java    | 123 +++++++++++++++++++++
 .../src/test/resources/nettyTcpSourceConfig.yaml   |  24 ++++
 .../nettyTcpSourceConfigWithInvalidProperty.yaml   |  24 ++++
 pulsar-io/pom.xml                                  |   1 +
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-tcp.md                               |  19 ++++
 15 files changed, 806 insertions(+)

commit 60df0a989dc541ee05b1484a859d72ba7c0c499b
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sun Dec 16 01:34:04 2018 +0000

    [Pulsar-Client] Extends ProducerBuilder Validations (#3193)
    
    ### Motivation
    This PR aims to extend validations on `ProducerBuilder`.
    
    ### Modifications
    1- `ProducerBuilder` needs to be robust for null and blank values as Public API.
          (e.g: When `topicName` is passed as blank, it comes as `persistent://public/default/    `)
    2- UT coverage is added.

 .../pulsar/client/impl/ProducerBuilderImpl.java    |  26 +--
 .../client/impl/ProducerBuilderImplTest.java       | 178 +++++++++++++++++++++
 2 files changed, 195 insertions(+), 9 deletions(-)

commit baca8f09732f6465c448e1983acece16c714de0b
Author: Richard Yu <yohan.richard.yu@gmail.com>
Date:   Sat Dec 15 09:03:38 2018 -0800

    Upgrade caffiene dependency in pom.xml (#3192)
    
    * Exception Handling for Null Pointer Exception in BrokerService
    
    * Update pulsar-broker/src/main/java/org/apache/pulsar/broker/service/BrokerService.java
    
    Co-Authored-By: ConcurrencyPractitioner <yohan.richard.yu@gmail.com>
    
    * Fixing error
    
    * Moving condition to Line 430
    
    * Upgrading pom.xml caffeine dependency
    
    * Removing unneccesary change
    
    * Updating binary.

 distribution/server/src/assemble/LICENSE.bin.txt | 2 +-
 pom.xml                                          | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit d6e5c95f3c888843b58432f1a39020b83f690d0c
Author: Tenzin Wangdhen <sinzin91@gmail.com>
Date:   Sat Dec 15 09:03:24 2018 -0800

    Add monitoring.yaml for EKS (#3194)

 deployment/kubernetes/aws/monitoring.yaml | 267 ++++++++++++++++++++++++++++++
 1 file changed, 267 insertions(+)

commit a3fbd2ecb8d072fd7f2321c01801dfdb33943e66
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sat Dec 15 01:45:41 2018 +0000

    [Pulsar-Flink] Add Batch Sink Scala Examples Documentation (#3190)
    
    ### Motivation
    This PR aims to add new Flink Batch Sink Scala Examples Documentation by explaining how to be used in Scala applications with different format.
    
    ### Modifications
    1- `README.md`
    2- Fix on `io-rabbitmq.md`

 examples/flink-consumer-source/pom.xml             |   2 +-
 .../example/FlinkPulsarBatchCsvSinkExample.java    |   0
 .../example/FlinkPulsarBatchJsonSinkExample.java   |   0
 .../example/FlinkPulsarBatchSinkExample.java       |   0
 .../batch/connectors/pulsar/example/README.md      |  21 ++
 .../example}/PulsarConsumerSourceWordCount.java    |   2 +-
 .../streaming/connectors/pulsar/example}/README.md |   0
 .../FlinkPulsarBatchCsvSinkScalaExample.scala      |   0
 .../FlinkPulsarBatchJsonSinkScalaExample.scala     |   0
 .../example/FlinkPulsarBatchSinkScalaExample.scala |   0
 .../batch/connectors/pulsar/example/README.md      | 283 +++++++++++++++++++++
 pulsar-flink/pom.xml                               |   6 -
 site2/docs/io-rabbitmq.md                          |   4 +-
 13 files changed, 308 insertions(+), 10 deletions(-)

commit 5dd4b6e7bff6647926789fb9d71d91f11c299fdb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Dec 14 14:33:15 2018 -0800

    remove pulsar-client-schema (#3184)
    
    * remove pulsar-client-schema
    
    * shade avro dependencies in pulsar-client-kafka-shaded
    
    * refactor api to separate module
    
    * adding schema back
    
    * cleaning up
    
    * fix license issue
    
    * fixing licenses
    
    * cleaning up
    
    * adding back lombok
    
    * cleaning up

 distribution/server/src/assemble/LICENSE.bin.txt   |   1 +
 examples/flink-consumer-source/pom.xml             |   5 -
 managed-ledger-shaded/pom.xml                      |   4 +-
 pom.xml                                            |   2 +-
 .../broker/admin/AdminApiSchemaAutoUpdateTest.java |   2 -
 .../broker/service/PersistentTopicE2ETest.java     |   1 -
 .../pulsar/broker/service/ReplicatorTest.java      |   1 -
 .../schema/JsonSchemaCompatibilityCheckTest.java   |   3 -
 pulsar-client-admin-shaded/pom.xml                 |   4 +-
 pulsar-client-admin/pom.xml                        |   6 -
 .../org/apache/pulsar/client/admin/Worker.java     |   6 +-
 .../client/admin/internal/FunctionsImpl.java       |   7 -
 .../pulsar/client/admin/internal/TopicsImpl.java   |   5 -
 pulsar-client-api/pom.xml                          |  35 ++++
 .../org/apache/pulsar/client/api/schema/Field.java |   2 +-
 .../pulsar/client/api/schema/GenericRecord.java    |   0
 .../pulsar-client-kafka-shaded/pom.xml             |  47 ++++-
 .../clients/producer/PulsarKafkaProducer.java      |   1 -
 pulsar-client-schema/pom.xml                       | 197 ---------------------
 pulsar-client-shaded/pom.xml                       |  85 ++++++++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 -
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   2 -
 .../org/apache/pulsar/admin/cli/CmdSources.java    |   2 -
 pulsar-client/pom.xml                              |  67 +++++--
 .../java/org/apache/pulsar/client/api/Schema.java  |   0
 .../client/api/SchemaSerializationException.java   |   0
 .../apache/pulsar/client/impl/ProducerImpl.java    |   1 -
 .../client/impl/schema/AutoConsumeSchema.java      |   0
 .../client/impl/schema/AutoProduceBytesSchema.java |   0
 .../pulsar/client/impl/schema/AvroSchema.java      |   0
 .../pulsar/client/impl/schema/ByteBufSchema.java   |   0
 .../client/impl/schema/ByteBufferSchema.java       |   0
 .../pulsar/client/impl/schema/ByteSchema.java      |   0
 .../pulsar/client/impl/schema/BytesSchema.java     |   0
 .../pulsar/client/impl/schema/DoubleSchema.java    |   0
 .../pulsar/client/impl/schema/FloatSchema.java     |   0
 .../pulsar/client/impl/schema/IntSchema.java       |   0
 .../pulsar/client/impl/schema/JSONSchema.java      |   0
 .../pulsar/client/impl/schema/KeyValueSchema.java  |   0
 .../pulsar/client/impl/schema/LongSchema.java      |   0
 .../pulsar/client/impl/schema/ProtobufSchema.java  |   0
 .../pulsar/client/impl/schema/ShortSchema.java     |   0
 .../pulsar/client/impl/schema/StringSchema.java    |   0
 .../impl/schema/generic/GenericAvroRecord.java     |   0
 .../impl/schema/generic/GenericAvroSchema.java     |   0
 .../impl/schema/generic/GenericJsonRecord.java     |   0
 .../impl/schema/generic/GenericJsonSchema.java     |   0
 .../client/impl/schema/generic/GenericSchema.java  |   0
 .../pulsar/client/impl}/schema/AvroSchemaTest.java |  11 +-
 .../{ => impl}/schema/DefaultSchemasTest.java      |   3 +-
 .../pulsar/client/impl}/schema/JSONSchemaTest.java |  16 +-
 .../client/impl}/schema/KeyValueSchemaTest.java    |   8 +-
 .../client/impl}/schema/PrimitiveSchemaTest.java   |   2 +-
 .../client/impl}/schema/ProtobufSchemaTest.java    |   2 +-
 .../client/impl}/schema/SchemaTestUtils.java       |   4 +-
 .../impl/schema/generic/GenericSchemaTest.java     |   4 +-
 .../src/test/proto/Test.proto                      |   0
 pulsar-functions/api-java/pom.xml                  |   6 -
 .../pulsar/functions/instance/ContextImpl.java     |   1 -
 .../pulsar/functions/instance/ContextImplTest.java |   1 -
 pulsar-functions/java-examples/pom.xml             |   5 +
 pulsar-functions/utils/pom.xml                     |   6 +
 .../pulsar/functions/utils/ValidatorUtils.java     |  13 --
 .../io/kafka/connect/KafkaConnectSourceTest.java   |   2 -
 .../proxy/server/ProxyAuthenticationTest.java      |  12 --
 pulsar-sql/presto-distribution/LICENSE             |   2 +-
 site/scripts/javadoc-gen.sh                        |   3 +-
 src/check-binary-license                           |   2 +-
 tests/integration/pom.xml                          |   6 -
 .../pulsar/tests/integration/cli/CLITest.java      |   1 -
 .../integration/functions/PulsarFunctionsTest.java |   1 -
 71 files changed, 269 insertions(+), 330 deletions(-)

commit 23a6622dd57aac1a02cedb26bdfcc8ef19564886
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Dec 13 21:17:34 2018 -0800

    Cleaning up and improving worker endpoints (#3191)

 .../org/apache/pulsar/broker/admin/v2/Worker.java  | 53 ++++++++-------
 .../apache/pulsar/broker/admin/v2/WorkerStats.java | 33 +++++++---
 .../org/apache/pulsar/client/admin/Worker.java     |  6 +-
 .../pulsar/client/admin/internal/WorkerImpl.java   | 76 +++++++++++-----------
 .../org/apache/pulsar/admin/cli/CliCommand.java    |  8 +++
 .../apache/pulsar/admin/cli/CmdFunctionWorker.java | 69 +++-----------------
 .../policies/data/WorkerFunctionInstanceStats.java | 29 +++++++++
 .../functions/worker/rest/api/WorkerImpl.java      | 65 +++++++-----------
 .../worker/rest/api/v2/WorkerApiV2Resource.java    | 69 ++++++++++++--------
 .../rest/api/v2/WorkerStatsApiV2Resource.java      | 34 +++++++---
 10 files changed, 228 insertions(+), 214 deletions(-)

commit 018fb04c8703d33b314565c190923b3e9be6df6e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Dec 13 14:09:06 2018 -0800

    Allow the option to disable Python wrapper compilation (#3188)

 pulsar-client-cpp/CMakeLists.txt | 73 +++++++++++++++++++++-------------------
 1 file changed, 39 insertions(+), 34 deletions(-)

commit 355b754e2cd3d1a054c786757c1affb117561ce8
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Dec 13 09:51:05 2018 -0800

    Always return the backlog quota for a namespace in rest response (#3164)
    
    * Always return the backlog storage quota for a namespace in rest response.
    
    * Attach other defaults if not set to namespace policies.
    
    * Fix unit tests.
    
    * Fix broken test.

 .../apache/pulsar/broker/admin/AdminResource.java  | 72 +++++++++++++++++++++-
 .../org/apache/pulsar/broker/ConfigHelper.java     | 67 ++++++++++++++++++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 22 ++++---
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    | 22 ++++---
 .../broker/service/BacklogQuotaManagerTest.java    | 28 ++++++---
 .../pulsar/common/policies/data/Policies.java      |  7 +++
 6 files changed, 194 insertions(+), 24 deletions(-)

commit 5e41f70d45b309ad55b238a320689faf48d99b14
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Dec 13 09:35:24 2018 -0800

    Share the batch metadata object across all messages in batch (#3156)

 .../pulsar/common/api/raw/MessageParser.java       | 22 +++++-----
 .../pulsar/common/api/raw/RawMessageImpl.java      | 26 +++++++-----
 .../common/api/raw/ReferenceCountedObject.java     | 49 ++++++++++++++++++++++
 3 files changed, 76 insertions(+), 21 deletions(-)

commit eb3ac3f2463d3a94c4efdb6dfd8b0827c8582d81
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Dec 14 00:26:18 2018 +0900

    Enable specifying allowed offset when verifying athenz role token (#3187)
    
    ### Motivation
    
    We are using Athenz for client authentication. Occasionally, the following error occurs and client authentication fails.
    
    > [pulsar-web-28-7] ERROR com.yahoo.athenz.auth.token.Token - Token:validate: token=v=Z1;d=xxx;r=xxx;p=xxx;a=xxx;t=1544027514;e=1544034714;k=0;i=xxx.xxx.xxx.xxx : has future timestamp=1544027514 : current time=1544027513 : allowed offset=0
    
    This means that the timestamp included in the authentication token is more future than the server time. Since the difference between them is only 1 second, I think that the time of either server or client is slightly off.
    
    This error can be avoided by increasing the value of `allowed offset`. Currently, this value is set to 0 in Pulsar, but the default value in Athenz ZMS seems to be 300 seconds.
    https://github.com/yahoo/athenz/blob/93fe62c17f3ab4556c71c5136c1646df4a874a5f/servers/zms/conf/zms.properties#L277-L280
    
    ### Modifications
    
    * Changed the default value of `allowed offset` from 0 to 30 (I think 300 seconds is too long)
    * Enabled specifying `allowed offset` using system property
    
    ### Result
    
    Even if the time of the server or client is slightly off, the authentication will succeed.

 .../AuthenticationProviderAthenz.java              | 23 ++++++++++++++-
 .../AuthenticationProviderAthenzTest.java          | 33 ++++++++++++++++++++--
 2 files changed, 52 insertions(+), 4 deletions(-)

commit 6df595a341a884404242b8d6dcf0d686e71907ee
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Dec 13 06:15:34 2018 -0800

    Fix Spellings and Code Cleanup (#3181)
    
    * Fix Spellings and Code Cleanup
    
    * Fix Code comments
    
    * Remove Tenant check
    
    * Fix test cases

 .../pulsar/broker/admin/impl/BrokerStatsBase.java  |   2 +-
 .../pulsar/broker/admin/impl/BrokersBase.java      |   2 +-
 .../pulsar/broker/admin/impl/ClustersBase.java     |   4 +-
 .../broker/admin/impl/ResourceQuotasBase.java      |   4 +-
 .../apache/pulsar/broker/admin/v2/BrokerStats.java |   2 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   2 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |   2 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   4 +-
 .../functions/worker/rest/api/ComponentImpl.java   | 246 ++++++++++++++-------
 .../functions/worker/rest/api/FunctionsImpl.java   |  22 +-
 .../worker/rest/api/FunctionsMetricsResource.java  |   3 +-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |  33 ++-
 .../functions/worker/rest/api/SourceImpl.java      |  28 ++-
 .../functions/worker/rest/api/WorkerImpl.java      |  25 ++-
 14 files changed, 246 insertions(+), 133 deletions(-)

commit e0792d6ef8b6b775a873d534aca8543fe3128ba5
Author: Tenzin Wangdhen <sinzin91@gmail.com>
Date:   Wed Dec 12 21:02:50 2018 -0800

    FIX: EKS load balancer selector should be proxy (#3174)

 deployment/kubernetes/aws/proxy.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 24cc4bbb0a0b488ef23ede3ba5e914b96d188a5a
Author: Christophe Bornet <cbornet@hotmail.com>
Date:   Thu Dec 13 05:37:25 2018 +0100

    Add bookkeeperClientRegionawarePolicyEnabled and bookkeeperClientReor (#3171)
    
    ## Motivation
    Fix #3119. This allows to configure region-aware policy and read-reordering so that brokers first read on bookies of their own region.
    
    ## Modifications
    1. Added parameters:
    ```
    // Enable region-aware bookie selection policy. BK will chose bookies from
    // different regions and racks when forming a new bookie ensemble
    // If enabled, the value of bookkeeperClientRackawarePolicyEnabled is ignored
    bookkeeperClientRegionawarePolicyEnabled=false
    
    // Enable/disable reordering read sequence on reading entries.
    bookkeeperClientReorderReadSequenceEnabled=false
    ```
    
    2. Fixed bug in ZkBookieRackAffinityMapping: the value set to racksWithHost by deserialize() was overriden by the affectation in setConf(). The fix just moves the hostname workaround in setConf().
    
    ## Result
    Users can enable bookkeeperClientRegionawarePolicyEnabled and bookkeeperClientReorderReadSequenceEnabled to make brokers read on bookies of their own region

 conf/broker.conf                                   |  8 ++++
 conf/standalone.conf                               |  8 ++++
 deployment/terraform-ansible/templates/broker.conf |  8 ++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  5 +++
 .../pulsar/broker/BookKeeperClientFactoryImpl.java | 10 ++++-
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |  4 ++
 .../configurations/pulsar_broker_test.conf         |  2 +
 pulsar-client-cpp/test-conf/standalone-ssl.conf    |  8 ++++
 pulsar-client-cpp/test-conf/standalone.conf        |  8 ++++
 pulsar-client-cpp/tests/authentication.conf        |  8 ++++
 pulsar-client-cpp/tests/standalone.conf            |  8 ++++
 .../zookeeper/ZkBookieRackAffinityMapping.java     | 48 +++++++++++-----------
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |  6 +--
 site/_data/config/broker.yaml                      |  6 +++
 site/_data/config/standalone.yaml                  |  6 +++
 site2/docs/reference-configuration.md              |  4 ++
 16 files changed, 118 insertions(+), 29 deletions(-)

commit bd8eb97ab0e26d53d96dd6d4be5d80332d514ac3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 12 20:26:47 2018 -0800

    Cleanup Pulsar IO depdencies (#3182)
    
    Motivation
    Pulsar IO Core does not have any dependencies on logging or protobuf stuff.

 pulsar-io/core/pom.xml | 18 ------------------
 1 file changed, 18 deletions(-)

commit c44294d180e870362b7b3e44e32c5dc86f640542
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Dec 12 18:59:32 2018 -0800

    cleaning up pom for pulsar-client-schema (#3175)
    
    * cleaning up pom for pulsar-client-schema
    
    * fix license issue

 pulsar-client-schema/pom.xml           | 150 +++------------------------------
 pulsar-sql/presto-distribution/LICENSE |   1 -
 2 files changed, 11 insertions(+), 140 deletions(-)

commit 1c8305d4ec6b9dd004c6a5da4a0ee1259c9e6b9e
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Dec 12 17:49:47 2018 -0800

    Check if log folder exists (#3165)
    
    * Check if log folder exists
    
    * Switch to Files.createDirectories

 .../apache/pulsar/functions/runtime/ProcessRuntime.java | 17 ++++++++---------
 1 file changed, 8 insertions(+), 9 deletions(-)

commit 4f2feb0a9e054935e72535ebaf166203e1c3f079
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 12 17:19:04 2018 -0800

    Sources/Sinks can be launched using fat jars as well (#3166)
    
    * First attempt to make source/sink accept jars
    
    * Stashed changes
    
    * Added jar capability to sources
    
    * Added sink support for jars
    
    * Fix bug
    
    * Fix unittest
    
    * Fixed unittest
    
    * Fixed unittest

 .../pulsar/functions/runtime/LocalRunner.java      | 12 ++--
 .../pulsar/functions/utils/SinkConfigUtils.java    | 74 +++++++++++----------
 .../pulsar/functions/utils/SourceConfigUtils.java  | 77 ++++++++++++----------
 .../org/apache/pulsar/functions/utils/Utils.java   | 17 ++++-
 .../functions/utils/SinkConfigUtilsTest.java       |  2 +-
 .../functions/utils/SourceConfigUtilsTest.java     |  2 +-
 .../functions/worker/rest/api/ComponentImpl.java   | 12 ++--
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 16 ++---
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 16 ++---
 9 files changed, 125 insertions(+), 103 deletions(-)

commit 9cdb7fc341b6a0e59eba08484f0319bbcf074f98
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Dec 12 16:35:28 2018 -0800

    Cleaning up io deps (#3176)
    
    * removing unnecessary pulsar-io-core from poms
    
    * removing more unnecessary io stuff

 managed-ledger-shaded/pom.xml      | 7 -------
 pulsar-client-admin-shaded/pom.xml | 7 -------
 pulsar-client-schema/pom.xml       | 6 ------
 pulsar-client-shaded/pom.xml       | 7 -------
 pulsar-client/pom.xml              | 6 ------
 5 files changed, 33 deletions(-)

commit e10e0964aca567ffd3268e445b8f552d57730b86
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Dec 12 13:43:09 2018 -0800

    Use regular ThreadLocal instead of the netty one (#3170)

 .../org/apache/pulsar/client/impl/schema/AvroSchema.java |  5 ++---
 .../org/apache/pulsar/client/impl/schema/JSONSchema.java | 16 ++++++----------
 2 files changed, 8 insertions(+), 13 deletions(-)

commit 7bda5b60f8bf27af155b2a490dcf7ed926e86029
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Dec 13 04:15:25 2018 +0900

    Modify producer handler of WebSocket to send ack to client asynchronously (#3172)

 .../org/apache/pulsar/websocket/ProducerHandler.java     | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

commit 04df219af4b050f038cc6f81727b44a09b1a4083
Author: Tenzin Wangdhen <sinzin91@gmail.com>
Date:   Wed Dec 12 10:41:39 2018 -0800

    add eks broker proxy (#3167)

 deployment/kubernetes/aws/proxy.yaml | 85 ++++++++++++++++++++++++++++++++++++
 1 file changed, 85 insertions(+)

commit 0bfbfb2950e06c0aa7084f097596facaa5b1f066
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Thu Dec 13 02:40:46 2018 +0800

    make conf file sync with code (#3169)

 conf/broker.conf                                   | 28 ++++++++-
 conf/proxy.conf                                    | 68 +++++++++++++++-------
 .../apache/pulsar/broker/ServiceConfiguration.java |  4 +-
 3 files changed, 76 insertions(+), 24 deletions(-)

commit 7eca99e4875655ec7596921a6370d41061fe73a8
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Dec 11 23:08:17 2018 -0800

    Use jackson for serialization and deserialization of json since its faster than gson (#3163)
    
    * Use jackson for serialization and deserialization of json since its faster than gson
    
    * fix shading issue
    
    * fix bug

 .../pulsar/client/impl/schema/JSONSchema.java      | 35 ++++++++++++++--------
 1 file changed, 23 insertions(+), 12 deletions(-)

commit c029b957a21f10db28b2c8bf37b631bf01dca6f8
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Dec 11 14:32:59 2018 -0800

    improve avro schema deserialization by reusing binary decoder (#3158)
    
    * improve avro schema deserialization by reusing binary decoder
    
    * change class variable to be private
    
    * fix shading issue

 pulsar-client-schema/pom.xml                                 | 10 ----------
 .../org/apache/pulsar/client/impl/schema/AvroSchema.java     | 12 +++++++++++-
 .../java/org/apache/pulsar/sql/presto/AvroSchemaHandler.java |  2 +-
 3 files changed, 12 insertions(+), 12 deletions(-)

commit b60f9f664ac6324ced1b67b9ab32145ce908c312
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Dec 12 05:07:32 2018 +0800

    [bookkeeper] bump bookkeeper version to 4.7.3 (#3129)
    
    * [bookkeeper] bump bookkeeper version to 4.7.3
    
    *Motivation*
    
    There are bunch of fixes in 4.7.3 regarding dns cache, ledger storage flushes.
    4.7.3 is a minor release of 4.7.2, so it is safe to upgrade and included in 2.2.1 release
    
    * Fix compilation issue
    
    * update license

 distribution/server/src/assemble/LICENSE.bin.txt   | 44 +++++++++++-----------
 pom.xml                                            |  2 +-
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |  5 +--
 3 files changed, 25 insertions(+), 26 deletions(-)

commit 1260bf32c51a53c32a4b524407fd2689240611ab
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Dec 11 08:08:37 2018 +0800

    a simple debezium integration test (#3154)
    
    ### Motivation
    
    create a simple debezium integration test.
    In this test, it start a Debezium MySQL Container based on "debezium/example-mysql:0.8", then use debezium source connector to binlog from MySQL, and store the debezium output into Pulsar.
    It verify the consumer readout message number is as expected.
    
    ### Modifications
    
     create a simple debezium integration test.
    
    ### Result
    
    this test passed.

 .../containers/DebeziumMySQLContainer.java         |  56 +++++++++++
 .../integration/functions/PulsarFunctionsTest.java |  67 ++++++++++++-
 .../integration/io/DebeziumMySqlSourceTester.java  | 107 +++++++++++++++++++++
 3 files changed, 229 insertions(+), 1 deletion(-)

commit 8c7ff2ba7abb57a0a9e502bfd051c24c02835749
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 10 11:48:44 2018 -0800

    Introduce Source and Sink exceptions in Status (#3142)
    
    * Introduce Source and Sink exceptions in Status
    
    * Added the counter at the right place

 .../pulsar/common/policies/data/SinkStatus.java    |   6 +
 .../pulsar/common/policies/data/SourceStatus.java  |   6 +
 .../functions/instance/FunctionStatsManager.java   | 127 +++++++++++++++++++++
 .../functions/instance/JavaInstanceRunnable.java   |   2 +
 .../src/main/proto/InstanceCommunication.proto     |   4 +
 .../functions/worker/rest/api/FunctionsImpl.java   |  18 ++-
 .../pulsar/functions/worker/rest/api/SinkImpl.java |  28 ++++-
 .../functions/worker/rest/api/SourceImpl.java      |  28 ++++-
 8 files changed, 210 insertions(+), 9 deletions(-)

commit bddfa2a5a233f17b93cb756b289b40d587321e4c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Dec 10 11:09:12 2018 -0800

    Use raw message when manually parsing messages from topic storage (#3146)
    
    * Use raw message when manually parsing messages from topic storage
    
    * Added missing headers
    
    * Fixed copy to byte[]

 .../pulsar/client/impl/MessageParserTest.java      |  30 ++---
 .../pulsar/common/api/raw}/MessageParser.java      |  71 ++++-------
 .../apache/pulsar/common/api/raw/RawMessage.java   | 104 +++++++++++++++
 .../apache/pulsar/common/api/raw/RawMessageId.java |  23 ++++
 .../pulsar/common/api/raw/RawMessageIdImpl.java    |  39 ++++++
 .../pulsar/common/api/raw/RawMessageImpl.java      | 139 +++++++++++++++++++++
 .../pulsar/sql/presto/AvroSchemaHandler.java       |  19 ++-
 .../pulsar/sql/presto/JSONSchemaHandler.java       |  33 ++++-
 .../pulsar/sql/presto/PulsarInternalColumn.java    |  20 +--
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  70 ++++++-----
 .../org/apache/pulsar/sql/presto/PulsarSplit.java  |   9 +-
 .../apache/pulsar/sql/presto/SchemaHandler.java    |   4 +-
 12 files changed, 447 insertions(+), 114 deletions(-)

commit a60fb3f602025991257f5967967adbef6867d624
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 11 01:21:50 2018 +0800

    [website][doc] Update the deployment documentation on how to deploy Pulsar to one node (#3152)
    
    *Motivation*
    
    Sometimes, people might try out Pulsar by using one machine and expand to multiple nodes
    later. The steps to deploy Pulsar to one node is same as deploying to multiple nodes.
    However there are some places required attentions. This PR is to update the deployment doc
    with instructions on how to deploy Pulsar to one node

 site2/docs/deploy-bare-metal.md | 20 +++++++++++++++++++-
 1 file changed, 19 insertions(+), 1 deletion(-)

commit 29d4139b327477696b5a3b5dcdd7bd8a023b0921
Author: Samuel <foreversunyao@yahoo.com>
Date:   Tue Dec 11 01:21:12 2018 +0800

    add_proxy_daemon_command (#3151)

 bin/pulsar-daemon | 4 ++++
 1 file changed, 4 insertions(+)

commit 20fbb5d7aee9f05afd55d02b37ef74acf22cae42
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Dec 9 22:54:44 2018 -0800

    In managed ledger ReadOnlyCursor, optimize for when there's a new ledger created (#3148)
    
    ### Motivation
    
    In managed ledger, the check `Cursor.hasMoreEntries()` is very cheap when the last ledger has at least some entries (eg: just longs comparison). If it's empty, we need to do a more expensive check that involve looking at the ledgers list to make sure the answer is always correct.
    
    When creating a read-only cursor, we get a snapshot of the current state. If the topic was left with a new ledger created and no entry into that, the `hasMoreEntries()` will be always expensive.
    
    To avoid that, if the last ledger is empty, initialize the last written position on the last entry of previous ledger.

 .../mledger/impl/ReadOnlyManagedLedgerImpl.java         | 17 +++++++++++++++--
 1 file changed, 15 insertions(+), 2 deletions(-)

commit f2f7ba96b21ea4e2457bef2b9c8f15e1157ed4f8
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Mon Dec 10 06:51:54 2018 +0000

    [Message Routing] Support default MessageRouter initialization as RoundRobinPartition (#3150)
    
    ### Motivation
    This PR aims to initialize **default** `MessageRouter` as `RoundRobinPartition` instead of `SinglePartition` by aligning `MessageRoutingMode` default settings under `ProducerBuilderImpl.setMessageRoutingMode`. In general, current implementation does not cause any problem due to `RoundRobin` coming as default and `MessageRoutingMode` is type-safe. However, it is useful for alignment both consistency of set/get logics.
    
    Following PR with #3126
    
    ### Modifications
    1- Patch is applied at `RoundRobinPartitionMessageRouterImpl`
    2- New UTs are added by creating `PartitionedProducerImplTest`
    3- Javadoc fix

 .../client/impl/PartitionedProducerImpl.java       |  28 ++---
 .../pulsar/client/impl/PulsarClientImpl.java       |   2 +-
 .../client/impl/PartitionedProducerImplTest.java   | 114 +++++++++++++++++++++
 3 files changed, 129 insertions(+), 15 deletions(-)

commit 49cf5e25c36d599728f44d30d2b26c2bd44d9f68
Author: legendtkl <taokelu@gmail.com>
Date:   Sun Dec 9 15:09:17 2018 +0800

    fix rpmVersoin (#3149)

 site2/website/scripts/replace.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d2ffa798f6485f60dc45850fd8e3d2049a97f094
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Dec 8 21:53:44 2018 -0800

    Update pulsar.properties (#3147)
    
    Use IPv4 ZK address to avoid initial connection to IPv6

 conf/presto/catalog/pulsar.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b2ddf7e7744be5b128dade293a05497c89bf5377
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sat Dec 8 23:03:31 2018 +0000

    [Pulsar Broker] CleanUp and Javadocs fix (#3145)

 .../src/main/java/org/apache/pulsar/PulsarStandalone.java   |  2 +-
 .../main/java/org/apache/pulsar/broker/PulsarService.java   |  2 +-
 .../apache/pulsar/broker/loadbalance/LoadCalculator.java    |  6 ++----
 .../broker/loadbalance/impl/SimpleLoadCalculatorImpl.java   |  8 +-------
 .../broker/service/nonpersistent/NonPersistentTopic.java    | 13 -------------
 .../org/apache/pulsar/client/impl/RawBatchConverter.java    |  6 +-----
 .../org/apache/pulsar/common/naming/NamespaceBundle.java    |  2 +-
 .../broker/loadbalance/SimpleLoadManagerImplTest.java       |  2 +-
 .../org/apache/pulsar/client/impl/TopicMessageIdImpl.java   |  3 ---
 .../discovery/service/web/DiscoveryServiceServlet.java      |  2 +-
 .../org/apache/pulsar/zookeeper/ZooKeeperServerAspect.java  |  2 +-
 11 files changed, 10 insertions(+), 38 deletions(-)

commit 5b6f6794ff6b1dff3b0ea87be6969d947960b8dc
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sat Dec 8 22:06:23 2018 +0000

    [Message Routing] Set CustomPartition implicitly when messageRouter is set (#3126)
    
    ### Motivation
    This PR proposes some refactoring and fixes on message routing logic.
    
    ### Modifications
    - `getMessageRouter` logic is refactored on`PartitionedProducerImpl`.
    - If `messageRouter` is set through `ProducerBuilderImpl`, `messageRoutingMode` needs to be set as `MessageRoutingMode.CustomPartition` implicitly. Default is `MessageRoutingMode.RoundRobinPartition`
    - Javadoc is fixed
    - Custom Message Router Documentation is fixed
    - UT coverage is added (`ProducerBuilderImplTest` and `PartitionedProducerConsumerTest`)

 .../api/PartitionedProducerConsumerTest.java       |  59 ++++++++-
 .../pulsar/client/api/MessageRoutingMode.java      |   2 +-
 .../client/impl/PartitionedProducerImpl.java       |   8 +-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  21 +++-
 .../impl/conf/ProducerConfigurationData.java       |   2 +-
 .../client/impl/ProducerBuilderImplTest.java       | 136 +++++++++++++++++++++
 site2/docs/cookbooks-partitioned.md                |  18 +--
 .../cookbooks-partitioned.md                       |  18 +--
 8 files changed, 238 insertions(+), 26 deletions(-)

commit b804de72bcbeca2cc7f73c8673ab94f9ebcfb691
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Dec 8 14:05:02 2018 -0800

    Recycle objects when parsing single message metadata (#3143)
    
    ### Motivation
    
    Reduce objects created when parsing the messages inside a batch.

 .../java/org/apache/pulsar/common/api/Commands.java     | 17 ++++++++---------
 1 file changed, 8 insertions(+), 9 deletions(-)

commit 3f0e5417905ed3de0afd572e8ae3a1286a117c16
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Dec 8 14:04:39 2018 -0800

     optimizing json deserialization in sql (#3144)
    
    ### Motivation
    
    Use Dsl json for  json deserialization is much faster

 pulsar-sql/presto-distribution/LICENSE             |  2 +
 pulsar-sql/presto-pulsar/pom.xml                   |  8 +++
 .../pulsar/sql/presto/JSONSchemaHandler.java       | 57 +++++++++-------------
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  2 +-
 4 files changed, 33 insertions(+), 36 deletions(-)

commit 32d6334d10e578ea1adff93139ca8efca4afe277
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Dec 7 13:41:45 2018 -0800

    more optimizations for sql (#3139)
    
    * more optimizations for sql
    
    * cleaning up
    
    * adding jctools dependency
    
    * add jctools to license

 pulsar-sql/presto-distribution/LICENSE             |   2 +
 pulsar-sql/presto-pulsar/pom.xml                   |   7 +
 .../pulsar/sql/presto/PulsarRecordCursor.java      | 166 ++++++++++++---------
 3 files changed, 106 insertions(+), 69 deletions(-)

commit 77e58096af7dfee59a6853b926eef05555a30851
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Dec 7 13:14:10 2018 -0800

    fix CompressionCodecLZ4 (#3141)

 .../apache/pulsar/common/compression/CompressionCodecLZ4.java  | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit 65be5c2501b9e1f824d1cd0f337aab7df82e4155
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Dec 7 10:39:41 2018 -0800

    Make Source/Sink status Source/Sink specific (#3137)
    
    * Make Source/Sink status Source/Sink specific
    
    * Fix unittest

 .../pulsar/common/policies/data/SinkStatus.java      | 17 ++++++++++++++---
 .../pulsar/common/policies/data/SourceStatus.java    | 18 +++++++++++++++---
 .../pulsar/functions/worker/rest/api/SinkImpl.java   |  5 +++--
 .../pulsar/functions/worker/rest/api/SourceImpl.java |  5 +++--
 .../integration/functions/PulsarFunctionsTest.java   | 20 +++++++++++---------
 5 files changed, 46 insertions(+), 19 deletions(-)

commit 64b1b80d5885ec4e7a3b53ebf3bb5dbde28631cd
Author: penghui <codelipenghui@gmail.com>
Date:   Fri Dec 7 12:12:23 2018 +0800

    Improve  user prompts on get topic reference (#3111)
    
    Motivation
    Create a partitioned topic, before client use this topic or create a subscription on this topic, when get stats of internal topic, will get Topic not found error. But actually partitioned topic is already created,
    internal topic have not been generated yet.
    
    Modifications
    Add following check:
    
    getTopicReference() on a partitioned internal topic and partitioned topic is not exist will get Partitioned Topic not found
    getTopicReference() on a partitioned internal topic, partitioned topic is exist but internal topics not exist will get Internal topics have not been generated yet
    
    * Separate topic not found exception and topic owner not found exception(issue-3042)
    * Add partitioned topic check(issue-3042)
    * Use getPartitionedTopicMetadata(issue-3042)
    * Add PersistentTopicsTest UT (issue-3042)

 .../broker/admin/impl/PersistentTopicsBase.java    |  13 ++-
 .../pulsar/broker/admin/PersistentTopicsTest.java  | 118 +++++++++++++++++++++
 2 files changed, 130 insertions(+), 1 deletion(-)

commit 736d82dcb26d38bb83830f8f737699531bdebae8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 6 18:37:06 2018 -0800

    Enhanced Pulsar Message API as well as functions context to get more details about messages (#3136)

 pulsar-client-cpp/python/pulsar/__init__.py        | 25 +++++++++++++++++-----
 .../python/pulsar/functions/context.py             | 15 +++++++++++++
 pulsar-client-cpp/python/pulsar_test.py            |  1 +
 .../instance/src/main/python/contextimpl.py        | 17 +++++++++++----
 .../instance/src/main/python/python_instance.py    |  2 +-
 5 files changed, 50 insertions(+), 10 deletions(-)

commit 44f8386bb1bcbab35962e46c162adbc64cd7116c
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Dec 6 16:59:49 2018 -0800

    Use BK v2 protocol from Presto connector (#3135)

 .../main/java/org/apache/pulsar/sql/presto/PulsarConnectorCache.java  | 2 ++
 .../main/java/org/apache/pulsar/sql/presto/PulsarSplitManager.java    | 4 +++-
 2 files changed, 5 insertions(+), 1 deletion(-)

commit 2c0cf59a4f3c4106fa884e26e2d1b09c55d7ac4d
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Dec 6 13:59:11 2018 -0800

    Force to load LZ4 JNI wrapper (#3134)
    
    ### Motivation
    
    In newer `lz4-java` JNI wrapper, the JNI library is not automatically loaded (or attempted to be loaded): calling explicitly so that we use the more performant C library instead of the Java based fallback code.

 .../org/apache/pulsar/common/compression/CompressionCodecLZ4.java    | 5 +++++
 1 file changed, 5 insertions(+)

commit d76dfe2e42a196f8d306982ff33bf627caff8245
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 6 12:27:38 2018 -0800

    Cleanup Exception thrown during error (#3133)
    
    * Cleanup Exception thrown during error
    
    * Added more validation

 .../pulsar/client/admin/internal/BaseResource.java  | 14 ++++++++++++++
 .../pulsar/client/admin/internal/FunctionsImpl.java | 17 ++++++++---------
 .../pulsar/client/admin/internal/SinkImpl.java      | 21 +++++----------------
 .../pulsar/client/admin/internal/SourceImpl.java    | 20 +++++---------------
 .../pulsar/client/admin/internal/TopicsImpl.java    |  8 +-------
 .../org/apache/pulsar/admin/cli/CmdSources.java     |  3 +++
 6 files changed, 36 insertions(+), 47 deletions(-)

commit e8fac570126f8e4afa2abb97993b62e7a0817872
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Dec 6 10:50:18 2018 -0800

    Fix calendar link (#3120)

 site2/website/pages/en/events.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 499ffd7405f2e0d22327d6b03e285d0fdbea94bf
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 6 07:28:45 2018 -0800

    Ensure that the input topic exists before doing trigger (#3130)

 .../org/apache/pulsar/functions/worker/rest/api/ComponentImpl.java  | 6 ++++++
 1 file changed, 6 insertions(+)

commit eab17ad6edf6da83f207de2f80eb497600698a04
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Dec 5 23:11:39 2018 -0800

    Few optimizations for pulsar sql (#3128)
    
    * optimizing pulsar sql
    
    * optimizing
    
    * cleaning up

 .../pulsar/sql/presto/AvroSchemaHandler.java       | 12 ++-
 .../sql/presto/PulsarConnectorMetricsTracker.java  | 93 +++++++++++++++-------
 2 files changed, 74 insertions(+), 31 deletions(-)

commit 322f2c61429cfa815cc8c93947bc43dda9f4abe1
Author: Grant Wu <grantwwu@gmail.com>
Date:   Tue Dec 4 20:04:38 2018 -0500

    Correct instances of 'availble' found (#3124)

 pulsar-client-cpp/python/pulsar/__init__.py                           | 2 +-
 .../KubernetesSecretsProviderConfigurator.java                        | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

commit e5a9ec3a7c43a2b521c63018aaf99197a8c32162
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 4 16:31:46 2018 -0800

    Fixed Kubernetes runtime bug (#3123)

 .../java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java  | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit 032df08ffbec1239da009302a0b5dae76f86110f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Dec 4 16:31:04 2018 -0800

    ignore unknown properties in worker config (#3125)

 .../src/main/java/org/apache/pulsar/functions/worker/WorkerConfig.java  | 2 ++
 1 file changed, 2 insertions(+)

commit 45b6d73ca3c2735ba3df2dbee4bbf70da6eaca5d
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Dec 4 10:38:09 2018 -0800

    Add log dir creation in ProcessRuntime (#3114)

 .../pulsar/functions/runtime/ProcessRuntime.java    | 21 +++++++++++++++++++++
 .../pulsar/functions/runtime/RuntimeUtils.java      | 12 ++++++++----
 2 files changed, 29 insertions(+), 4 deletions(-)

commit c60cf47b9928feca31eef294df2fd0228469c8ca
Author: Richard Yu <yohan.richard.yu@gmail.com>
Date:   Mon Dec 3 17:59:01 2018 -0800

    Exception Handling for Null Pointer Exception in BrokerService (#3108)
    
    ### Motivation
    In a unit test under pulsar-broker, I have found that some NullPointerExceptions were thrown, although the tests had passed. I decided it will be best if we minimized the number of such exceptions as they are usually not intentionally thrown.
    
    ### Result
    The NullPointerException will no longer occur.

 .../src/main/java/org/apache/pulsar/broker/service/BrokerService.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit dedeb33a3637621b4a99211d5e7070cd080566ea
Author: chrismiller <chris@redyeti.net>
Date:   Tue Dec 4 01:48:12 2018 +0000

    JSONSchema fails to serialise fields on objects that are nested in a collection (#2969)
    
    * JSONSchema doesn't serialise fields of objects that are in nested collections
    
    * fix json schema
    
    * Fix a couple of typos

 .../pulsar/client/impl/schema/JSONSchema.java      | 20 +------------
 .../pulsar/client/schema/JSONSchemaTest.java       | 34 ++++++++++++++++++++--
 .../pulsar/client/schema/SchemaTestUtils.java      | 18 ++++++++++++
 .../connectors/pulsar/FlinkPulsarProducer.java     |  4 +--
 .../connectors/pulsar/PulsarProduceMode.java       |  2 +-
 5 files changed, 54 insertions(+), 24 deletions(-)

commit ded9086237ef6f8cf5d17676a2056bb7ff2daad3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Dec 3 17:47:13 2018 -0800

    Consolidate timer threads in functions (#3109)
    
    * Use instanceCache schedulerExecutorService for timer
    
    * fixing process runtime
    
    * addressing comments

 .../functions/instance/FunctionStatsManager.java   |  5 ++-
 .../pulsar/functions/instance/InstanceCache.java   | 13 +++++--
 .../functions/instance/JavaInstanceRunnable.java   |  2 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java | 28 +++++++--------
 .../pulsar/functions/runtime/ProcessRuntime.java   | 27 +++++++-------
 .../pulsar/functions/runtime/RuntimeSpawner.java   | 41 +++++++++++-----------
 6 files changed, 61 insertions(+), 55 deletions(-)

commit 8ea5c142ea4f1bc6d39c22baf4ba352afa39b07c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Dec 3 16:21:49 2018 -0800

    [conf] Add annotations for documenting proxy configuration settings (#3106)
    
    * [conf] Add annotations for documenting proxy configuration settings
    
    *Motivation*
    
    It is non-trivial to keep configuration in-sync between code and configuration file.
    The change is introducing documentation related annotations. So the annotations can be used
    for generating proxy configuration file.

 .../pulsar/common/configuration/Category.java      |  33 +++
 .../pulsar/common/configuration/FieldContext.java  |  32 ++-
 .../common/configuration/PropertiesContext.java    |  33 +++
 .../common/configuration/PropertyContext.java      |  40 +++
 .../pulsar/proxy/server/ProxyConfiguration.java    | 276 +++++++++++++++++----
 5 files changed, 361 insertions(+), 53 deletions(-)

commit 02df3d2bbf6c4dc893aa1ea0f04221e8d50c72a4
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Dec 3 14:17:50 2018 -0800

    Allow subscribers to access subscription admin-api (#2981)
    
    * Allow subscribers to access subscription admin-api
    
    * add sub-authorization check on canConsume
    
    * make per-sub optional
    
    * fix: allowe super-admin to consume

 .../authorization/AuthorizationProvider.java       |  23 ++++
 .../broker/authorization/AuthorizationService.java |  35 ++++++
 .../authorization/PulsarAuthorizationProvider.java |  81 ++++++++++++++
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  45 ++++++++
 .../broker/admin/impl/PersistentTopicsBase.java    |  46 ++++++--
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  25 +++++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  26 +++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   2 +-
 .../api/AuthorizationProducerConsumerTest.java     | 120 ++++++++++++++++++++-
 .../org/apache/pulsar/client/admin/Namespaces.java |  18 ++++
 .../client/admin/internal/NamespacesImpl.java      |  24 +++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  42 +++++++-
 .../pulsar/common/policies/data/AuthPolicies.java  |   5 +-
 13 files changed, 476 insertions(+), 16 deletions(-)

commit 66a68d58172ce06930ec84a9b0e41944a2c8e5b6
Author: Christophe Bornet <cbornet@hotmail.com>
Date:   Mon Dec 3 23:11:38 2018 +0100

    Add pull-mode on Websockets (#3058)
    
    * Add pull-mode on Websockets
    
    Fix #3052
    
    * Add WebSocket pull-mode test
    
    * Add doc on WebSocket pull mode

 .../websocket/proxy/ProxyPublishConsumeTest.java   | 60 ++++++++++++++++++++++
 .../websocket/proxy/SimpleConsumerSocket.java      |  7 +++
 .../apache/pulsar/websocket/ConsumerHandler.java   | 55 +++++++++++++-------
 .../{ConsumerAck.java => ConsumerCommand.java}     | 11 ++--
 site2/docs/client-libraries-websocket.md           | 32 ++++++++++++
 5 files changed, 138 insertions(+), 27 deletions(-)

commit 5d06b1e128b6747952a855d02c8a2936d2a35cce
Author: penghui <codelipenghui@gmail.com>
Date:   Tue Dec 4 03:47:33 2018 +0800

    Change un-ack messages start tracking behavior (#3079)
    
    ### Motivation
    #### Expected behavior
    
    User process the same message many times but failed, if user set a dead letter policy, when message process times exceed the max redelivery count in dead letter policy, message will send to the dead letter topic.
    
    #### Actual behavior
    
    When a consumer subscribe a topic, but wait a while then start receive messages, but messages already send to dead letter topic.
    
    #### Steps to reproduce
    
    Here is the code to reproduce
    
    ```java
    public class RedeliveryIssue {
    
        public static void main(String[] args) throws PulsarClientException, InterruptedException {
    
            final String topic = "my-topic";
    
            PulsarClient client = PulsarClient.builder()
                    .serviceUrl("pulsar://localhost:6650")
                    .build();
    
            Consumer<byte[]> consumer = client.newConsumer()
                    .topic(topic)
                    .subscriptionType(SubscriptionType.Shared)
                    .subscriptionName(UUID.randomUUID().toString())
                    .ackTimeout(3, TimeUnit.SECONDS)
                    .deadLetterPolicy(DeadLetterPolicy.builder().maxRedeliverCount(2).build())
                    .subscribe();
    
            Producer<byte[]> producer = client.newProducer()
                    .topic(topic)
                    .create();
    
            producer.send(("a message").getBytes());
    
            // wait a while, message will send to dead letter topic
            Thread.sleep(10000L);
    
            do {
                // can't receive message
                Message<byte[]> msg = consumer.receive();
                System.out.println(new String(msg.getValue()));
            } while (true);
        }
    }
    ```
    
    #### System configuration
    **Pulsar version**: 2.2.0
    
    ### Modifications
    
    Remove un-ack message tracking on message received.
    Add un-ack message tracking on consumer call receive
    
    ### Result
    
    UT passed

 .../pulsar/client/api/DeadLetterTopicTest.java     | 29 ++++++++++++++++++++++
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |  6 +++--
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 20 +++++++++++++--
 3 files changed, 51 insertions(+), 4 deletions(-)

commit 8cd900c83506a7cf41588f03c3aa00e3edd61294
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Dec 3 11:46:45 2018 -0800

    report function exceptions via prometheus (#3107)
    
    ### Motivation
    
    Allow exceptions in functions to be reported via prometheus
    
    example output:
    ```
    # TYPE pulsar_function_user_exception gauge
    pulsar_function_user_exception{cluster="standalone",error="error val: 0",fqfn="public/default/py-test",function="py-test",instance_id="0",namespace="public/default",tenant="public",ts="1543786615954"} 1.0
    pulsar_function_user_exception{tenant="public",namespace="public/default",function="test",instance_id="0",cluster="standalone",fqfn="public/default/test",error="error val: 5c53460e-03cf-4368-88d4-f23aeb3adf84",ts="1543787031371",} 1.0
    ```

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 66 ++++++++++++++--------
 pulsar-client-cpp/python/setup.py                  |  5 +-
 .../functions/instance/FunctionStatsManager.java   | 56 +++++++++++++++++-
 .../pulsar/functions/instance/InstanceCache.java   |  2 +-
 .../functions/instance/JavaInstanceRunnable.java   |  7 +--
 .../instance/src/main/python/function_stats.py     | 54 ++++++++++++++----
 .../instance/src/main/python/python_instance.py    |  9 +--
 7 files changed, 154 insertions(+), 45 deletions(-)

commit dd4e59ff419f1998d7d198eb9216f427f0ea766e
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Dec 4 03:44:28 2018 +0800

    revert #2590 (#3110)
    
    ### Motivation
    
    In PR #2590, we made a wrong change, to make redelivery happened more early.
    This PR Try to revert change of commit 0ab2325fa33231f1c69782e081483012467dfca.
    
    
    ### Modifications
    
     revert #2590
    
    ### Result
    
    Worked as before 2590, Ut pass.

 .../client/api/SimpleProducerConsumerStatTest.java |  1 +
 .../client/api/SimpleProducerConsumerTest.java     | 47 ------------------
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    | 58 +++++++++++++++-------
 .../pulsar/client/impl/UnAckedMessageTracker.java  |  2 +-
 4 files changed, 43 insertions(+), 65 deletions(-)

commit d4794bd5e100a946780ff562bf45ef44a7dc5281
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Dec 2 20:06:26 2018 -0800

     fixing and refactoring function status (#3102)
    
    * fixing and refactoring function status
    
    * further refactoring
    
    * cleaning up

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   5 +-
 .../functions/worker/FunctionRuntimeManager.java   | 261 +++----------------
 .../{FunctionsImplBase.java => ComponentImpl.java} | 279 +++++++++++++--------
 .../functions/worker/rest/api/FunctionsImpl.java   | 212 +++++++++++++++-
 .../pulsar/functions/worker/rest/api/SinkImpl.java | 220 +++++++++++++---
 .../functions/worker/rest/api/SourceImpl.java      | 211 +++++++++++++---
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  10 +-
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  |  11 +-
 .../rest/api/v2/SourceApiV2ResourceTest.java       |  11 +-
 .../integration/functions/PulsarFunctionsTest.java |   7 +
 10 files changed, 796 insertions(+), 431 deletions(-)

commit c7440f9d48524ec324f6198ce1116880e06b3f38
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Dec 2 12:15:13 2018 -0800

    add default impl for getKey() (#3105)

 .../src/main/java/org/apache/pulsar/functions/api/Record.java         | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 7ed15d0dc84e830e7fe829d682693496bb272f89
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Dec 1 04:38:30 2018 -0800

    [conf] clean up proxy configuration to use lombok setter and getter (#3103)

 .../pulsar/proxy/server/ProxyConfiguration.java    | 306 +--------------------
 .../pulsar/proxy/server/ProxyConnection.java       |   4 +-
 .../proxy/server/ServiceChannelInitializer.java    |   2 +-
 .../org/apache/pulsar/proxy/server/WebServer.java  |   4 +-
 4 files changed, 9 insertions(+), 307 deletions(-)

commit 86abab93b60fd1b8cd7d1e4f2459265c0d0269e8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Dec 1 02:00:41 2018 -0800

    [build] generate connector yaml config only when building a release (#3100)

 distribution/io/pom.xml | 96 ++++++++++++++++++++++++++++---------------------
 1 file changed, 56 insertions(+), 40 deletions(-)

commit a62633b218f58d1b9cdba8524258920edd403208
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Nov 30 21:50:37 2018 -0800

    [conf] Clean up ServiceConfiguration to use lombok getter and setter (#3101)
    
    *Motivation*
    
    Each time we add a new setting, we need to add one setter and one getter method.
    This change is to remove those setters and getters, to use lombok @Setter and @Getter.
    It will make life easier.

 .../apache/pulsar/broker/ServiceConfiguration.java | 1292 +-------------------
 .../authorization/PulsarAuthorizationProvider.java |    2 +-
 .../org/apache/pulsar/broker/PulsarService.java    |    2 +-
 .../broker/service/PulsarChannelInitializer.java   |    2 +-
 .../apache/pulsar/broker/service/PulsarStats.java  |    2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |    3 +-
 .../org/apache/pulsar/broker/web/WebService.java   |    2 +-
 7 files changed, 25 insertions(+), 1280 deletions(-)

commit 62ecf4def4d78367bd4cf4422f5e6a41169bc97f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Nov 30 14:43:27 2018 -0800

    [website] Fix apache pulsar events calendar (#3099)
    
    *Motivation*
    
    Fix apache pulsar events calendar link

 site2/website/pages/en/events.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 015e2e5174a1e38167deb47411e598c73d424a19
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Nov 30 12:09:10 2018 -0800

    Improve and correct status for function, sources, sinks (#3088)
    
    * Improve and correct status for function, sources, sinks
    
    * cleaning up unused protobuf
    
    * cleaning up
    
    * fixing unit tests
    
    * change getstatus -> status
    
    * fix integration tests
    
    * fix integration tests for sources and sinks

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   60 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |   61 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |   64 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   16 +-
 .../org/apache/pulsar/client/admin/Functions.java  |    7 +-
 .../java/org/apache/pulsar/client/admin/Sink.java  |    7 +-
 .../org/apache/pulsar/client/admin/Source.java     |    7 +-
 .../client/admin/internal/FunctionsImpl.java       |   17 +-
 .../pulsar/client/admin/internal/SinkImpl.java     |   18 +-
 .../pulsar/client/admin/internal/SourceImpl.java   |   17 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   14 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   14 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |   14 +-
 .../common/policies/data/ExceptionInformation.java |   27 +
 .../common/policies/data/FunctionStatus.java       |   77 +
 .../pulsar/common/policies/data/SinkStatus.java    |   67 +
 .../pulsar/common/policies/data/SourceStatus.java  |   67 +
 .../src/main/python/InstanceCommunication_pb2.py   |  152 +-
 .../src/main/proto/InstanceCommunication.proto     |   13 +-
 .../functions/worker/FunctionRuntimeManager.java   |  146 +-
 .../functions/worker/rest/FunctionApiResource.java |    5 -
 .../functions/worker/rest/api/FunctionsImpl.java   | 1568 +------------------
 .../worker/rest/api/FunctionsImplBase.java         | 1594 ++++++++++++++++++++
 .../pulsar/functions/worker/rest/api/SinkImpl.java |   80 +
 .../functions/worker/rest/api/SourceImpl.java      |   79 +
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |   74 +-
 .../worker/rest/api/v2/SinkApiV2Resource.java      |   72 +-
 .../worker/rest/api/v2/SourceApiV2Resource.java    |   71 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   38 +-
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  |   44 +-
 .../rest/api/v2/SourceApiV2ResourceTest.java       |   40 +-
 .../integration/functions/PulsarFunctionsTest.java |  110 +-
 32 files changed, 2556 insertions(+), 2084 deletions(-)

commit 3b3457e2253b9201c1fdd6826b52df12b17ef217
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Nov 30 01:33:19 2018 -0800

    Redeliver messages that can't be decrypted. (#3097)

 .../client/api/SimpleProducerConsumerTest.java     | 133 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  66 +++++-----
 2 files changed, 170 insertions(+), 29 deletions(-)

commit 0871a285476ee3c5e228df2763969837029c8f15
Author: Yifan Zhang <freqyifan@gmail.com>
Date:   Fri Nov 30 07:39:47 2018 +0300

    Option to not to use rbac in helm deployment (#3082)
    
    * option to not to use rbac
    
    * default value to match previous settings

 deployment/kubernetes/helm/pulsar/templates/prometheus-deployment.yaml | 2 ++
 deployment/kubernetes/helm/pulsar/templates/prometheus-rbac.yaml       | 2 ++
 deployment/kubernetes/helm/pulsar/values-mini.yaml                     | 2 ++
 deployment/kubernetes/helm/pulsar/values.yaml                          | 2 ++
 4 files changed, 8 insertions(+)

commit e23523325d80c086eba0bcf0a97dde4af59b35a4
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Nov 29 17:16:21 2018 -0800

    Fixed protobuf-shaded/pom.xml with correct version (#3096)

 protobuf-shaded/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 25958bac6f2d286d075bab327f719169edd8cde4
Author: Franois Laignel <fengalin@free.fr>
Date:   Fri Nov 30 01:42:32 2018 +0100

    Python Client: fix `Consumer.unsubscribe` (#3093)
    
    * Python Client: fix `Consumer.unsubscribe`
    
    Fix a typo in `self._consumer.unsubscribe`
    
    * Python Client: test `Consumer.unsubscribe`

 pulsar-client-cpp/python/pulsar/__init__.py | 2 +-
 pulsar-client-cpp/python/pulsar_test.py     | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

commit 0ddaa2f92c72cc3c1a19fcb90a6412eb0a3799de
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Nov 30 02:35:20 2018 +0900

    Fix process of calculating msgBacklog included in stats (#3092)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  2 +-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 31 ++++++++++++++++++++++
 2 files changed, 32 insertions(+), 1 deletion(-)

commit d18c07be18e442b9fc34f994adecf654208bd265
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 28 21:53:08 2018 -0800

    Fixed C++ CMake dependency and enabled parallel build (#3084)
    
    * Fixed C++ CMake dependency and enabled parallel build
    
    * Fixed also for examples

 pulsar-client-cpp/docker-build.sh         |  2 +-
 pulsar-client-cpp/examples/CMakeLists.txt | 20 ++++++++++----------
 pulsar-client-cpp/tests/CMakeLists.txt    |  2 +-
 3 files changed, 12 insertions(+), 12 deletions(-)

commit 9195d0702ff28a3fe8cf22e546cb74b03606d258
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Nov 29 14:29:36 2018 +0900

    Add pulsar-build:manylinux-cp37-cp37m to pushed docker images (#3091)
    
    When we run `pulsar-client-cpp/docker/create-images.sh`, the following six docker images are created.
    ```
    pulsar-build:manylinux-cp27-cp27mu
    pulsar-build:manylinux-cp27-cp27m
    pulsar-build:manylinux-cp34-cp34m
    pulsar-build:manylinux-cp35-cp35m
    pulsar-build:manylinux-cp36-cp36m
    pulsar-build:manylinux-cp37-cp37m
    ```
    These images are pushed to Docker Hub when `pulsar-client-cpp/docker/push-images.sh` is executed. But `pulsar-build:manylinux-cp37-cp37m` not included in the target.
    
    https://github.com/apache/pulsar/blob/7bbcc72f5a2690da701c299856ff0d2b62eed5d9/pulsar-client-cpp/docker/create-images.sh#L26-L33
    https://github.com/apache/pulsar/blob/7bbcc72f5a2690da701c299856ff0d2b62eed5d9/pulsar-client-cpp/docker/push-images.sh#L28-L34

 pulsar-client-cpp/docker/push-images.sh | 1 +
 1 file changed, 1 insertion(+)

commit a2fd1244499e9bcfbc42ad9b1fcead9df99a0027
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 28 21:28:32 2018 -0800

    Removed AspectJ build plugin from pulsar-broker (#3085)
    
    ### Motivation
    
    In #3023 I had moved AspectJ to `pulsar-zookeeper-utils` module. Now the build plugin is not needed anymore in `pulsar-broker`.

 pulsar-broker/pom.xml | 35 -----------------------------------
 1 file changed, 35 deletions(-)

commit f9ea60e4a95a96f7c94bf2b33f1d17ea566a398c
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 28 21:27:43 2018 -0800

    PIP-25: Added token authentication docs (#3089)
    
    ### Motivation
    
    Added client and admin documentation token based authentication.

 site2/docs/security-token-admin.md  | 152 ++++++++++++++++++++++++++++++++++++
 site2/docs/security-token-client.md | 125 +++++++++++++++++++++++++++++
 site2/website/sidebars.json         |   2 +
 3 files changed, 279 insertions(+)

commit 019ae66658201faca134b611ac8cfc3dcdf63d43
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 28 20:42:43 2018 -0800

    PIP-25: C++ / Python / Go implementation for token authentication (#3067)
    
    * PIP-25: C++ implementation for token authentication
    
    * PIP-25: C and Go implementation for token authentication
    
    * PIP-25: Python implementation
    
    * Addressed comments
    
    * Added missing <sstream> include
    
    * Fixed argument name that was changed earlier
    
    * Fixed secret key path

 pulsar-client-cpp/include/pulsar/Authentication.h  |  38 ++++
 .../include/pulsar/c/authentication.h              |   6 +
 pulsar-client-cpp/lib/Authentication.cc            |   7 +
 pulsar-client-cpp/lib/auth/AuthToken.cc            | 117 ++++++++++++
 pulsar-client-cpp/lib/auth/AuthToken.h             |  46 +++++
 pulsar-client-cpp/lib/c/c_Authentication.cc        |  22 +++
 pulsar-client-cpp/pulsar-test-service-start.sh     |  13 ++
 pulsar-client-cpp/python/pulsar/__init__.py        |  18 ++
 pulsar-client-cpp/python/pulsar_test.py            |  41 +++-
 pulsar-client-cpp/python/src/authentication.cc     |  57 ++++++
 pulsar-client-cpp/test-conf/standalone-ssl.conf    |   4 +-
 pulsar-client-cpp/tests/AuthTokenTest.cc           | 206 +++++++++++++++++++++
 pulsar-client-go/pulsar/c_client.go                |  31 ++++
 pulsar-client-go/pulsar/c_go_pulsar.h              |   6 +
 pulsar-client-go/pulsar/client.go                  |  10 +
 pulsar-client-go/pulsar/client_test.go             |  71 +++++++
 16 files changed, 691 insertions(+), 2 deletions(-)

commit 5c2b13e3e3520453eacf852d0142081581d3d94c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Nov 28 14:52:15 2018 -0800

    Set not just resource requests but also limits (#3043)

 .../main/java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java | 1 +
 1 file changed, 1 insertion(+)

commit 5858df0d22fcbcf6c52110d05d8c2875bd9ae80c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Nov 28 14:51:28 2018 -0800

    Issue #2582: Schema javadoc missing from client api docs (#3086)
    
    *Motivation*
    
    Fixes #2582
    
    Schema javadoc is missing from client api docs

 site/Makefile               | 2 +-
 site/scripts/javadoc-gen.sh | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

commit aaf199663ab7debf674d8de71c76bc126b627e88
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Nov 28 13:06:52 2018 -0800

    QueryState now spits out FunctionState (#3076)
    
    ### Motivation
    Instead of spitting some unformatted stuff, made querystate print out a proper json object.

 .../org/apache/pulsar/client/admin/Functions.java  |  4 +--
 .../client/admin/internal/FunctionsImpl.java       | 13 ++++----
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  6 ++--
 .../pulsar/common/functions/FunctionState.java     | 35 ++++++++++++++++++++++
 .../functions/worker/rest/api/FunctionsImpl.java   | 10 +++----
 5 files changed, 51 insertions(+), 17 deletions(-)

commit a99f733224bf25aced7302f506b67b0fd5043c73
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 28 12:42:05 2018 -0800

    PIP-25: Token based authentication (#2888)
    
    * PIP-25: Token based authentication
    
    * Addressed comments
    
    * Use Authorization header
    
    * Update to support env: data: and file: as sources for keys and tokens
    
    * Fixed cli description
    
    * Updated broker.conf
    
    * Improved consistency in reading keys and CLI tools
    
    * Fixed check for http headers
    
    * Accept rel time with no specified unit
    
    * Fixed reading data: URL
    
    * Addressed comments
    
    * Added integration tests
    
    * Addressed comments
    
    * Added CLI command to validate token against key
    
    * Fixed integration tests
    
    * Removed env:
    
    * Fixed rel time parsing

 bin/pulsar                                         |   3 +
 conf/broker.conf                                   |  16 +
 conf/proxy.conf                                    |  16 +
 distribution/server/src/assemble/LICENSE.bin.txt   |   5 +-
 pom.xml                                            |  17 ++
 pulsar-broker-common/pom.xml                       |  15 +
 .../AuthenticationProviderToken.java               | 126 ++++++++
 .../authentication/utils/AuthTokenUtils.java       | 106 +++++++
 .../AuthenticationProviderTokenTest.java           | 287 ++++++++++++++++++
 .../pulsar/utils/auth/tokens/TokensCliUtils.java   | 324 +++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CliCommand.java    |  25 --
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  15 +-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  12 +-
 .../org/apache/pulsar/admin/cli/CmdTopics.java     |   5 +-
 .../apache/pulsar/client/api/Authentication.java   |   3 +
 .../pulsar/client/api/AuthenticationFactory.java   |  35 +++
 .../client/impl/auth/AuthenticationDataToken.java  |  65 +++++
 .../pulsar/client/impl/auth/AuthenticationTls.java |   8 +
 .../client/impl/auth/AuthenticationToken.java      | 100 +++++++
 .../client/impl/auth/AuthenticationTokenTest.java  | 104 +++++++
 .../client/api/url/DataURLStreamHandler.java       |  24 +-
 .../api/url/PulsarURLStreamHandlerFactory.java     |   2 +-
 .../java/org/apache/pulsar/client/api/url/URL.java |   6 +-
 .../pulsar/common/util/RelativeTimeUtil.java       |  64 ++++
 .../pulsar/common/util/RelativeTimeUtilTest.java   |  63 ++++
 site2/docs/reference-configuration.md              |  12 +-
 .../token/PulsarTokenAuthenticationBaseSuite.java  | 204 +++++++++++++
 .../auth/token/TokenAuthWithPublicPrivateKeys.java |  90 ++++++
 .../auth/token/TokenAuthWithSymmetricKeys.java     |  73 +++++
 .../docker/ContainerExecResultBytes.java           |  33 +++
 .../integration/topologies/PulsarCluster.java      |   4 +
 .../tests/integration/utils/DockerUtils.java       |  91 +++++-
 32 files changed, 1891 insertions(+), 62 deletions(-)

commit 2df55405ede20bdcfa3d2a50a2e3266c48fb54fe
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Nov 28 19:57:09 2018 +0100

    Don't overwrite integration tests longs if container restarted (#3080)
    
    In the arquillian tests, processes were restarted using supervisorctl,
    which preserved the contents of the filesystem. This was changed in
    the testcontainers change to restart the whole container, which
    obliterates the filesystem.
    
    When a container is stopped, the logs are copied to the target
    directory. In the case of multiple restarts the logs from the later
    restarts were overwriting the logs from earlier restarts so the older
    logs were lost.
    
    This PR adds a check to ensure that we don't overwrite old logs and
    appends a number to the log if a old log exists.

 .../apache/pulsar/tests/integration/utils/DockerUtils.java | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit f74b939fc8824ce829c9d4e3336f28f6deb097c5
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Nov 28 19:01:30 2018 +0100

    Disable retry on integration tests (#3081)
    
    In the original arquillian tests, retry was disabled because tests are
    run against a cluster that's brought up at class level, so any retry
    would be against a dirty environment. This seems to have been
    accidently changed when moving to testcontainers, thought the same
    condition holds true.
    
    This patch disabled the retries. These are new tests. They shouldn't
    be flaking.

 tests/integration/pom.xml | 4 ++++
 1 file changed, 4 insertions(+)

commit 4358a98cd8790c549e415dbafc8cc943661b5713
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Nov 28 17:05:04 2018 +0100

    Extra logging for offloaders (#2733)
    
    Some extra logging for offloader loading and initialization which
    would have been useful when debugging #2697.

 .../java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java     | 2 ++
 .../java/org/apache/bookkeeper/mledger/offload/OffloaderUtils.java     | 3 ++-
 .../src/main/java/org/apache/pulsar/broker/PulsarService.java          | 1 +
 3 files changed, 5 insertions(+), 1 deletion(-)

commit 65592ad2ae9b3f460ef7af95c78f02dbd0f1c5e1
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Nov 28 22:45:59 2018 +0800

    cache StorageClient (#3078)

 .../functions/worker/rest/api/FunctionsImpl.java   | 62 ++++++++++++----------
 1 file changed, 34 insertions(+), 28 deletions(-)

commit 35f84ebe81f0e4fb0dd5cb28500c257b42ef9d86
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 27 22:47:23 2018 -0800

    Fixed wordcount example to actually extract words from sentence (#3075)

 .../org/apache/pulsar/functions/api/examples/WordCountFunction.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit e5de682406cf2227c3e6822b757c0e8ecf9bcd65
Author: Grant Wu <grantwwu@gmail.com>
Date:   Tue Nov 27 23:10:37 2018 -0500

    Delete extraneous punctuation (#3072)

 site2/docs/client-libraries-java.md | 1 -
 1 file changed, 1 deletion(-)

commit b413c19aa205d38e57ebc1509099d57bb72fb844
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Wed Nov 28 01:46:11 2018 +0000

    [Pulsar-Flink] Add Scala Examples (#3071)
    
    * [Pulsar-Flink] Add Scala Examples
    
    * Line break is added for input text.
    
    * Adding ASF Header.
    
    * Fix License format

 pulsar-flink/pom.xml                               |  6 ++
 .../example/FlinkPulsarBatchSinkExample.java       | 10 +++
 .../FlinkPulsarBatchCsvSinkScalaExample.scala      | 78 ++++++++++++++++++++
 .../FlinkPulsarBatchJsonSinkScalaExample.scala     | 81 +++++++++++++++++++++
 .../example/FlinkPulsarBatchSinkScalaExample.scala | 85 ++++++++++++++++++++++
 5 files changed, 260 insertions(+)

commit 8d241022724fff411f6841ff84b970f01d5dbd18
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Nov 27 14:49:01 2018 -0800

    prometheus metrics for functions served via brokers or function instances should match (#3066)
    
    * prometheus metrics for functions served via brokers or instances themselves should match
    
    * add additional testing

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 248 +++++++++++++++++++--
 .../functions/instance/FunctionStatsManager.java   |  15 ++
 .../functions/instance/JavaInstanceRunnable.java   |   7 +-
 .../functions/runtime/KubernetesRuntime.java       |   7 +
 .../pulsar/functions/runtime/ProcessRuntime.java   |  10 +-
 .../apache/pulsar/functions/runtime/Runtime.java   |   2 +
 .../pulsar/functions/runtime/RuntimeUtils.java     |  21 ++
 .../pulsar/functions/runtime/ThreadRuntime.java    |   6 +
 .../functions/worker/FunctionsStatsGenerator.java  |  43 +---
 .../worker/FunctionStatsGeneratorTest.java         | 220 ------------------
 10 files changed, 294 insertions(+), 285 deletions(-)

commit 7719b8ede5bb8d0e63ae51e22bb47d7b59c8b02d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 27 10:51:29 2018 -0800

    Make sure to properly count number of processed messages in python (#3060)
    
    * Make sure to properly count number of processed messages in python
    
    * Removed total processed
    
    * Fixed build
    
    * Fixed buil
    
    * Address feedback
    
    * Fixed unittest
    
    * Removed unused value
    
    * Added licence headers
    
    * Removed unnecessary changes
    
    * Fix integration tests
    
    * Added numReceived as part of function status
    
    * Unnecessary change revert
    
    * Enhance test

 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  4 +-
 .../functions/instance/FunctionStatsManager.java   | 32 ---------
 .../functions/instance/JavaInstanceRunnable.java   |  6 +-
 .../instance/src/main/python/Function_pb2.py       |  1 -
 .../src/main/python/InstanceCommunication_pb2.py   | 78 +++++++++-------------
 .../instance/src/main/python/function_stats.py     | 28 ++------
 .../instance/src/main/python/python_instance.py    | 13 +---
 .../src/main/proto/InstanceCommunication.proto     | 10 +--
 .../functions/worker/FunctionsStatsGenerator.java  |  1 -
 .../worker/FunctionStatsGeneratorTest.java         | 10 +--
 .../integration/functions/PulsarFunctionsTest.java |  7 +-
 11 files changed, 54 insertions(+), 136 deletions(-)

commit 08ef448c1c7e70db345092c2b56662c7b6f888fe
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Nov 27 10:08:32 2018 -0800

    [doc] Generate connector yaml files for connectors (#3065)
    
    *Motivation*
    
    Include the example yaml files in the io distribution package

 distribution/io/pom.xml                            |  1 +
 .../org/apache/pulsar/io/canal/CanalSource.java    |  9 +++-
 .../apache/pulsar/io/canal/CanalSourceConfig.java  | 41 +++++++++++++++-
 .../pulsar/io/cassandra/CassandraSinkConfig.java   | 21 +++++++++
 .../pulsar/io/cassandra/CassandraStringSink.java   |  7 +++
 pulsar-io/docs/pom.xml                             | 45 ++++++++++++++++++
 .../io/elasticsearch/ElasticSearchConfig.java      | 31 +++++++++++++
 .../pulsar/io/elasticsearch/ElasticSearchSink.java |  8 ++++
 .../apache/pulsar/io/jdbc/JdbcAutoSchemaSink.java  |  8 ++++
 .../org/apache/pulsar/io/jdbc/JdbcSinkConfig.java  | 31 +++++++++++++
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |  8 ++++
 .../pulsar/io/kinesis/KinesisSinkConfig.java       | 54 +++++++++++++++++++++-
 .../apache/pulsar/io/rabbitmq/RabbitMQConfig.java  | 16 +++++++
 .../apache/pulsar/io/rabbitmq/RabbitMQSource.java  |  7 +++
 .../apache/pulsar/io/twitter/TwitterFireHose.java  |  8 ++++
 .../pulsar/io/twitter/TwitterFireHoseConfig.java   | 44 +++++++++++++++++-
 16 files changed, 334 insertions(+), 5 deletions(-)

commit 78e8a2a410747ef6f9a121453cbea449f68cdb71
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Nov 26 18:31:31 2018 -0800

    Check for nullness of SchemaInfo (#3064)
    
    ### Motivation
    
    Functions using CustomSerde depend on SerdeSchema which returns a null SchemaInfo. The ConsumerImpl needs to check if its null before accessing it.

 .../src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java       | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5438659ae6b8b911ed1c85b0645c92229a85b472
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Tue Nov 27 02:30:30 2018 +0000

    [Pulsar-Flink] Extends Validations (#3063)
    
    ### Motivation
    This PR aims to extend validations on Flink Connector.
    
    ### Modifications
    1- `FlinkPulsarProducer` constructor needs to be robust for **blank** values.
    2- `PulsarSourceBuilder` needs to be robust for **blank** values.
    3- `totalMessageCount` variable looks redundant so can be removed on `PulsarConsumerSource`
    4- `PulsarSourceBuilder` UT coverage is added.
    
    ### Test Coverage
    New UT coverage is added.

 .../connectors/pulsar/FlinkPulsarProducer.java     |   8 +-
 .../connectors/pulsar/PulsarConsumerSource.java    |   3 -
 .../connectors/pulsar/PulsarSourceBuilder.java     |  16 ++--
 .../connectors/pulsar/PulsarSourceBuilderTest.java | 104 +++++++++++++++++++++
 4 files changed, 119 insertions(+), 12 deletions(-)

commit ff76bd7ee65dc78aab3745977070a88fd82a51ca
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Nov 26 19:06:07 2018 +0100

    Documentation for TLS protocol version and ciphers (#3057)
    
    PR #1225 added the ability to configure the TLS protocol version and
    cipher on the server side, but this was never added to the
    documentation. This patch fixes that omission.
    
    Issue: #2402

 site2/docs/reference-configuration.md |  5 ++++-
 site2/docs/security-tls-transport.md  | 17 +++++++++++++++++
 2 files changed, 21 insertions(+), 1 deletion(-)

commit 0b57b3c864c55f72c5bd8c197dbb594f3e79e92a
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Nov 26 10:05:36 2018 -0800

    Move maven-dependency-plugin in distribution/server/pom.xml (#3053)
    
    * Move maven-dependency-plugin in distribution/server/pom.xml
    
    Motivation
    
    maven-dependency-plugin is used to generate a classpath.txt
    file with the list of jars for runtime. This is only used
    by `bin/pulsar` command and it picks up the dependencies of
    the distribution-server module.
    
    There's no need to generate this classpath.txt file for
    every module.
    
    * Fixed pom

 distribution/server/pom.xml | 45 +++++++++++++++++++++++++++++++++++++++++++++
 pom.xml                     | 41 -----------------------------------------
 2 files changed, 45 insertions(+), 41 deletions(-)

commit b721ae3bcacc0d93c259d6f59465a0c0b0d402e0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Nov 26 09:45:10 2018 -0500

     Correcting metrics and adding tests (#3050)
    
    * Correcting metrics and adding tests
    
    * remove commmented out code
    
    * remove space
    
    * fix integration test
    
    * improving impl
    
    * fix ObjectMapper

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  3 +
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 66 +++++++++++++++-
 .../pulsar/common/policies/data/FunctionStats.java | 64 +++++++++++-----
 .../pulsar/functions/runtime/JavaInstanceMain.java | 10 ---
 .../org/apache/pulsar/functions/worker/Utils.java  |  6 +-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  3 +
 .../integration/functions/PulsarFunctionsTest.java | 88 ++++++++++++++++++++++
 7 files changed, 207 insertions(+), 33 deletions(-)

commit fe2c8ee4d37e2a45dfb528592915746827416e18
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Sun Nov 25 19:42:58 2018 +0000

    [Pulsar-Flink] Add Batch Json Sink Support (#3046)
    
    ### Motivation
    This PR aims to add Flink - Pulsar Batch Json Sink Support. If user works with Flink DataSet API and would like to write the DataSets to Pulsar in Json format, this sink can help.
    
    Ref: [Flink Batch Sink API](https://ci.apache.org/projects/flink/flink-docs-stable/dev/batch/#data-sinks)
    
    ### Modifications
    Please find the change-set as follows:
    
    **1-** Defines `PulsarJsonOutputFormat` to write Flink Batch `DataSets` into Pulsar by providing ready `JsonSerializationSchema`.
    **2-** UT Coverages
    **3-** `FlinkPulsarBatchJsonSinkExample` to show how to be used by users.
    **4-** `README.md `documentation

 .../connectors/pulsar/PulsarCsvOutputFormat.java   |   1 -
 .../connectors/pulsar/PulsarJsonOutputFormat.java  |  34 +++++
 .../connectors/pulsar/PulsarOutputFormat.java      |   1 -
 .../serialization/CsvSerializationSchema.java      |   8 +-
 .../serialization/JsonSerializationSchema.java     |  41 ++++++
 .../pulsar/PulsarJsonOutputFormatTest.java         |  56 ++++++++
 .../example/FlinkPulsarBatchCsvSinkExample.java    |  48 ++++---
 .../example/FlinkPulsarBatchJsonSinkExample.java   | 108 +++++++++++++++
 .../batch/connectors/pulsar/example/README.md      | 152 +++++++++++++++++----
 .../serialization/JsonSerializationSchemaTest.java |  94 +++++++++++++
 10 files changed, 490 insertions(+), 53 deletions(-)

commit 1b421ed3854fcb2682ecddc295c7ba6859c3947f
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sun Nov 25 11:42:36 2018 -0800

    Add configs for broker stats update frequency (#3047)
    
    This allows to configure the initial delay and update frequency for broker stats. This is useful for dev and test clusters.
    
    Fixes #687

 .../org/apache/pulsar/broker/ServiceConfiguration.java | 18 ++++++++++++++++++
 .../apache/pulsar/broker/service/BrokerService.java    |  9 ++++++---
 2 files changed, 24 insertions(+), 3 deletions(-)

commit 9f8997761da7ca4ce2e3b2abde2998069de2c35f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Nov 25 11:42:00 2018 -0800

    [state] make setting and opening state table more robust (#3029)

 .../functions/instance/JavaInstanceRunnable.java   | 37 ++++++++++++++++++++--
 1 file changed, 35 insertions(+), 2 deletions(-)

commit 2c8f0810a3c55e8db884f1d04b533f606c9e8409
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Nov 25 11:41:26 2018 -0800

    [io][docs] introduce annotations for generating connector yaml config files (#2936)
    
    
    *Motivation*
    
    Currently all io connectors lack example yaml files. Manually write those files is error-prone.
    We need a programmable way that automatically generate example connector yaml files.
    
    *Changes*
    
    - introduce annotations for documenting connector yaml files.
    - provide a generator to generate yaml files
    - provide a shell script to run generator
    - when building io package, generate yaml configs

 distribution/io/pom.xml                            |  45 ++++++
 distribution/io/src/assemble/io.xml                |   6 +
 pom.xml                                            |   8 +
 .../pulsar/io/core/annotations/Connector.java      |  61 ++++++++
 .../pulsar/io/core/annotations/FieldDoc.java       |  54 +++++++
 .../apache/pulsar/io/core/annotations/IOType.java  |  36 +++++
 pulsar-io/docs/pom.xml                             |  57 +++++++
 .../pulsar/io/docs/ConnectorDocGenerator.java      | 173 +++++++++++++++++++++
 .../apache/pulsar/io/kafka/KafkaAbstractSink.java  |  24 +--
 .../pulsar/io/kafka/KafkaAbstractSource.java       |  29 ++--
 .../org/apache/pulsar/io/kafka/KafkaBytesSink.java |   8 +
 .../apache/pulsar/io/kafka/KafkaBytesSource.java   |   8 +
 .../apache/pulsar/io/kafka/KafkaSinkConfig.java    |  41 ++++-
 .../apache/pulsar/io/kafka/KafkaSourceConfig.java  |  51 +++++-
 pulsar-io/pom.xml                                  |   1 +
 src/pulsar-io-gen                                  | 138 ++++++++++++++++
 16 files changed, 712 insertions(+), 28 deletions(-)

commit c2c9f33e6b18b342e7453831171e3415704c3b0b
Author: tuteng <eguangning@gmail.com>
Date:   Mon Nov 26 03:40:44 2018 +0800

    support mysql binlog sync to pulsar by canal (#2998)
    
    ### Motivation
    
    support alibaba canal
    https://github.com/alibaba/canal/wiki
    
    ### Modifications
    
    Integrated canal client
    
    ### Result
    
    support binlog sync to pulsar
    use python pulsar-client to consume
    
    ```
    import pulsar
    
    client = pulsar.Client('pulsar://localhost:6650')
    consumer = client.subscribe('my-topic',
                                subscription_name='my-sub')
    
    while True:
        msg = consumer.receive()
        print("Received message: '%s'" % msg.data())
        consumer.acknowledge(msg)
    
    client.close()
    ```
    
    ```
    output:
    Received message: '[{"data":null,"database":"testdb","es":1542446501000,"id":44,"isDdl":true,"mysqlType":null,"old":null,"sql":"CREATE TABLE `users320` (   `id` int(11) NOT NULL AUTO_INCREMENT,   `name` varchar(50) DEFAULT NULL,   `extra` varchar(50) DEFAULT NULL,   PRIMARY KEY (`id`),   KEY `ix_users_name` (`name`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8","sqlType":null,"table":"users320","ts":1542446501114,"type":"CREATE"}]'
    ```

 pulsar-io/canal/pom.xml                            |  72 ++++++++
 .../org/apache/pulsar/io/canal/CanalSource.java    | 189 +++++++++++++++++++++
 .../apache/pulsar/io/canal/CanalSourceConfig.java  |  59 +++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 .../main/resources/canal-mysql-source-config.yaml  |  28 +++
 pulsar-io/pom.xml                                  |   1 +
 6 files changed, 371 insertions(+)

commit 716a6b46fb18929a1f85851377098891e84ee114
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 25 11:25:37 2018 -0800

    Fixes for Java 11 (#3006)
    
    * [java-11] Compilation fixes
    
    * Runtime fixes
    
    * Fix dependencies for discovery service
    
    * Fixed json mapper provider in new jersey
    
    * Fixed license files
    
    * Added hk2 dep to proxy
    
    * Added hk2 deps to pulsar-client-admin as well
    
    * added missing jar in license file
    
    * More license fixes

 distribution/server/licenses/LICENSE-Lombok.txt    | 19 ------
 distribution/server/pom.xml                        |  6 ++
 distribution/server/src/assemble/LICENSE.bin.txt   | 70 ++++++++++++----------
 distribution/server/src/assemble/bin.xml           |  2 +
 pom.xml                                            | 60 +++++++++++++++++--
 .../pulsar/broker/web/JsonMapperProvider.java      | 36 +++++++++++
 pulsar-broker/pom.xml                              | 18 +++++-
 .../org/apache/pulsar/broker/web/WebService.java   | 14 ++---
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  9 +--
 .../worker/PulsarWorkerAssignmentTest.java         |  9 ++-
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |  7 +--
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    | 23 ++++---
 pulsar-client-admin/pom.xml                        | 15 +++++
 .../org/apache/pulsar/client/admin/Topics.java     |  1 -
 .../pulsar/common/policies/data/TenantInfo.java    |  3 -
 .../org/apache/pulsar/common/stats/JvmMetrics.java | 42 ++++++++-----
 .../org/apache/pulsar/common/stats/Metrics.java    |  3 +-
 pulsar-discovery-service/pom.xml                   | 15 +++++
 pulsar-functions/pom.xml                           | 20 -------
 pulsar-functions/proto/pom.xml                     | 11 ++++
 .../runtime/src/test/resources/log4j2.yml          | 37 ------------
 .../worker/src/test/resources/log4j2.yml           | 37 ------------
 pulsar-proxy/pom.xml                               | 15 +++++
 .../org/apache/pulsar/proxy/server/WebServer.java  |  5 +-
 pulsar-sql/presto-distribution/LICENSE             | 10 +++-
 .../pulsar/websocket/service/ProxyServer.java      |  7 +--
 pulsar-zookeeper-utils/pom.xml                     |  3 +-
 pulsar-zookeeper/pom.xml                           |  4 +-
 28 files changed, 282 insertions(+), 219 deletions(-)

commit 9d2c001b87a8439ce235e5acf75790e48451fae8
Author: penghui <codelipenghui@gmail.com>
Date:   Sun Nov 25 23:39:56 2018 +0800

    Expose Redelivery Count By Message Properties(issue-3030) (#3033)
    
    * Expose Redelivery Count By Message Properties(issue-3030)
    
    * Add getRedeliveryCount in Message interface(issue-3030)
    
    * Change redeliveryCount to final.

 .../api/ExposeMessageRedeliveryCountTest.java      | 117 +++++++++++++++++++++
 .../java/org/apache/pulsar/client/api/Message.java |  12 +++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   4 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |  21 ++++
 .../pulsar/client/impl/TopicMessageImpl.java       |   5 +
 5 files changed, 157 insertions(+), 2 deletions(-)

commit 7bbcc72f5a2690da701c299856ff0d2b62eed5d9
Author: massakam <massakam@yahoo-corp.jp>
Date:   Mon Nov 26 00:37:04 2018 +0900

    Update libcurl version included in docker images (#3035)
    
    * Update libcurl version included in docker images
    
    * Drop python 3.3 support

 pulsar-client-cpp/docker/Dockerfile       | 8 ++++----
 pulsar-client-cpp/docker/build-wheels.sh  | 1 -
 pulsar-client-cpp/docker/create-images.sh | 1 -
 pulsar-client-cpp/docker/push-images.sh   | 1 -
 pulsar-client-cpp/pkg/deb/Dockerfile      | 8 ++++----
 pulsar-client-cpp/pkg/rpm/Dockerfile      | 8 ++++----
 6 files changed, 12 insertions(+), 15 deletions(-)

commit c94247971765febc594cd60aa762f248624c2bc8
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Sun Nov 25 13:23:31 2018 +0800

    Issue #2751: Add check to fix NPE (#3034)
    
    Motivation
    We may meet NPE like this:
    ```
    java.lang.NullPointerException: null
    at org.apache.pulsar.common.api.proto.PulsarApi$KeyValue$Builder.setValue(PulsarApi.java:1923) ~[org.apache.pulsar-pulsar-common-2.1.1-incubating.jar:2.1.1-incubating]
    ```
    This is related to protobuf, it does not support null-able field directly.
    protocolbuffers/protobuf#1606
    
    In this fix we try to avoid this by add checking before this method is called.

 .../java/org/apache/pulsar/client/impl/TypedMessageBuilderImpl.java  | 5 +++++
 .../src/main/java/org/apache/pulsar/websocket/ProducerHandler.java   | 4 ++++
 2 files changed, 9 insertions(+)

commit b4168a7016e4150680398f5d4a85ae664e470fc9
Author: Cristian <me@cristian.io>
Date:   Sat Nov 24 20:52:47 2018 -0800

    Typo in Auth TLS docs (#3049)

 site2/docs/security-tls-authentication.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 396c232660fa20bcac9bf7a7b2516ccbb24fe6a5
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Nov 24 20:24:27 2018 -0800

    Update dockerfile-maven plugin (#3040)
    
    Motivation
    dockerfile-maven 1.3.7 has issues connecting to newer Docker daemons. Latest version works fine.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 66718814fdc78704ac6117f79228bcfb18889c07
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Nov 24 20:23:54 2018 -0800

    [website] Add cdc connector doc to sidebar (#3045)
    
    Add cdc connector doc to sidebar

 site2/docs/io-cdc.md        | 4 ++--
 site2/docs/io-overview.md   | 2 +-
 site2/website/sidebars.json | 3 ++-
 3 files changed, 5 insertions(+), 4 deletions(-)

commit 469ce55427287cbe17455184a608c9bebe059c40
Author: legendtkl <taokelu@gmail.com>
Date:   Sun Nov 25 12:23:06 2018 +0800

    Documentation: impove the doc 'Deploying and managing Pulsar Functions' (#3048)
    
    when follow the doc Deploying and managing Pulsar Functions to do python udf function create and deploy, we will encounter an exception as follow.
    ```
    $ bin/pulsar-admin functions trigger --tenant public --namespace default --name myfunc --trigger-value "hello world"
    HTTP 408 Request Timeout
    ```
    The root cause is the python environment is not ready. To be specific, we should install pulsar python client before do python udf function creating and deploy.
    
    Maybe we should point it out clearly in the doc as following, and that is what the PR is doing.
    
    If you're going to deploy and trigger python user-defined functions, you should install [the pulsar python client](http://pulsar.apache.org/docs/en/client-libraries-python/) first.

 site/docs/latest/functions/deployment.md                                | 2 ++
 site2/docs/functions-deploying.md                                       | 2 ++
 .../versioned_docs/version-2.1.0-incubating/functions-deploying.md      | 2 ++
 .../versioned_docs/version-2.1.1-incubating/functions-deploying.md      | 2 ++
 site2/website/versioned_docs/version-2.2.0/functions-deploying.md       | 2 ++
 5 files changed, 10 insertions(+)

commit 9dddd64a2488971133a4954a22093736eba79fa6
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Nov 24 18:48:58 2018 -0800

    Use topic unload instead of broker restarts in TestS3Offload (#3036)
    
    ### Motivation
    
    Topic unload is a lighter way to clean up all the broker state for a topic compared to restarting the broker, though it achieves the same result.

 .../tests/integration/offload/TestS3Offload.java   | 64 +++++++++++-----------
 1 file changed, 31 insertions(+), 33 deletions(-)

commit 182ac654f2bf16e5a7602ebf1431d71d8066bbb4
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Thu Nov 22 19:32:45 2018 +0000

    [Pulsar-Flink] Add Batch Csv Sink Support (#3039)
    
    ### Motivation
    This PR aims to add Flink - Pulsar Batch Csv Sink Support. If user works with Flink DataSet API and would like to write the DataSets to Pulsar in Csv format, this sink can help.
    
    This is also similar approach what Flink currently offers:
    ```
    DataSet<Tuple3<String, Integer, Double>> values = // [...]
    values.writeAsCsv(filepath) // writing Datasets to FileSystem
    ```
    Ref: [Flink Batch Sink API](https://ci.apache.org/projects/flink/flink-docs-stable/dev/batch/#data-sinks)
    
    ### Modifications
    Please find the change-set as follows:
    
    **1-** Defines `PulsarCsvOutputFormat` to write Flink Batch `DataSets` into Pulsar by providing ready `CsvSerializationSchema`.
    **2-** Abstracts current implementation to support both `PulsarOutputFormat` (which supports for user-defined serialization schema) and `PulsarCsvOutputFormat`
    **3-** UT Coverages
    **4-** `FlinkPulsarBatchCsvSinkExample` to show how to be used by users.
    **5-** `README.md `documentation

 pulsar-flink/pom.xml                               |   7 ++
 .../connectors/pulsar/BasePulsarOutputFormat.java  | 109 +++++++++++++++++++++
 .../connectors/pulsar/PulsarCsvOutputFormat.java   |  37 +++++++
 .../connectors/pulsar/PulsarOutputFormat.java      |  83 +---------------
 .../serialization/CsvSerializationSchema.java      |  58 +++++++++++
 .../pulsar/PulsarCsvOutputFormatTest.java          |  56 +++++++++++
 .../connectors/pulsar/PulsarOutputFormatTest.java  |  76 +++++++++++++-
 .../example/FlinkPulsarBatchCsvSinkExample.java    |  78 +++++++++++++++
 .../batch/connectors/pulsar/example/README.md      |  79 +++++++++++++--
 .../serialization/CsvSerializationSchemaTest.java  |  53 ++++++++++
 10 files changed, 546 insertions(+), 90 deletions(-)

commit 36f7ac369d9ed6193928a7cad3cd6d762d91d981
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Nov 22 08:42:53 2018 -0800

    Disable ZK & BK fsync calls in integration tests (#3037)
    
    * Disable ZK & BK fsync calls in integration tests
    
    * Added warning in zk conf file

 conf/zookeeper.conf                                                 | 6 ++++++
 .../apache/pulsar/tests/integration/topologies/PulsarCluster.java   | 4 ++++
 2 files changed, 10 insertions(+)

commit 4253de718cd1b1519a896995278cb9976ee2c0df
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Thu Nov 22 20:05:24 2018 +0800

    Issue #2657: change function cli getstate to use REST endpoint (#2943)
    
    # Motivation
    change StateGetter to use REST endpoint
    
    # Modifications
    change StateGetter to use REST endpoint
    change related unit test
    
    # Result
    unit tests pass.

 distribution/server/src/assemble/LICENSE.bin.txt   |  7 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 95 ++++++++--------------
 pulsar-client-tools/pom.xml                        |  6 --
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 68 ++--------------
 4 files changed, 46 insertions(+), 130 deletions(-)

commit 26b91bba871e6f416ba477eafe668ec70363f242
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 21 19:47:43 2018 -0800

    Moved broker aspectj to zk-utils (#3023)

 .../pulsar/broker/zookeeper/aspectj/ClientCnxnAspect.java  |  0
 .../src/main/resources/META-INF/aop.xml                    | 14 +++++++++-----
 2 files changed, 9 insertions(+), 5 deletions(-)

commit a77b7605c072c37045266bdeb313429d738870e9
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 21 17:48:21 2018 -0800

    Fixed lookup of boost_python with boost-1.68 (#3041)

 pulsar-client-cpp/CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0a7e133d3ca7cbb15e88c1dd906738c8ba586558
Author: penghui <codelipenghui@gmail.com>
Date:   Thu Nov 22 09:35:01 2018 +0800

    Add default ackTimeout(30s) for dead letter policy (#3014)
    
    Fix issue #2987
    ### Motivation
    
    In version 2.2.0, support DeadLetterTopic feature. This feature based on message redelivery. So ack timeout is necessary.
    
    ### Modifications
    
    Set ackTimeout(30s) when enable the dead letter policy but not set the ackTimeout;

 .../main/java/org/apache/pulsar/client/api/ConsumerBuilder.java  | 2 ++
 .../java/org/apache/pulsar/client/impl/ConsumerBuilderImpl.java  | 9 ++++++++-
 2 files changed, 10 insertions(+), 1 deletion(-)

commit ac978462413a32a9b533c250a424cb52be110059
Author: Byron Ruth <b@devel.io>
Date:   Wed Nov 21 16:51:21 2018 -0500

    Add bookkeeper service and other fixes (#3026)
    
    * Add bookkeeper service and other fixes
    
    - Add the topologyKey for the pod affinity for bookies
    - Fixed a misspelling in the name of the ledgers disk
    - Fixed the selector in the proxy service to select proxy pods
    
    Signed-off-by: Byron Ruth <b@devel.io>
    
    * Update bookkeeper service comment to note DNS
    
    Signed-off-by: Byron Ruth <b@devel.io>

 .../google-kubernetes-engine/bookie.yaml           | 32 +++++++++++++++++++---
 .../kubernetes/google-kubernetes-engine/proxy.yaml |  2 +-
 2 files changed, 29 insertions(+), 5 deletions(-)

commit 4e10472999b8545f90232f21ab5764fe33f301af
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Nov 21 11:50:48 2018 -0800

    [state] use closeAsync to close state storage client (#3028)

 .../org/apache/pulsar/functions/instance/JavaInstanceRunnable.java  | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 859c914a7a3f3ddb9f89c62eba3c048039bd852a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Nov 21 11:08:09 2018 -0800

     adding windowed metrics for functions (#3021)
    
    * adding windowed metrics for functions
    
    * adding license headers and cleaning up
    
    * remove unnecessary import
    
    * add RestException
    
    * fixing bugs and refactoring code
    
    * fix bug in instanceCache
    
    * fix bug
    
    * add test for stats and fix minor bug

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   4 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  97 ++++++++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   5 +-
 .../pulsar/common/policies/data/FunctionStats.java |  30 ++-
 .../functions/instance/FunctionStatsManager.java   | 239 +++++++++++++++++++--
 .../pulsar/functions/instance/InstanceCache.java   |  51 +++++
 .../functions/instance/JavaInstanceRunnable.java   |  89 +++++---
 .../src/main/python/InstanceCommunication_pb2.py   |  80 +++++--
 .../instance/src/main/python/function_stats.py     | 132 +++++++++++-
 .../instance/src/main/python/python_instance.py    |  83 ++++---
 pulsar-functions/instance/src/main/python/util.py  |  19 ++
 .../src/main/proto/InstanceCommunication.proto     |  12 ++
 .../pulsar/functions/runtime/RuntimeSpawner.java   |   2 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |  46 ++--
 .../functions/runtime/ThreadRuntimeFactory.java    |   4 +
 .../org/apache/pulsar/functions/utils/Utils.java   |  13 ++
 .../functions/worker/FunctionRuntimeManager.java   |  27 ++-
 .../pulsar/functions/worker/MembershipManager.java |   4 +-
 .../pulsar/functions/worker/SchedulerManager.java  |   5 +-
 .../org/apache/pulsar/functions/worker/Utils.java  |  20 +-
 .../functions/worker/rest/RestException.java       |  78 +++++++
 .../functions/worker/rest/api/FunctionsImpl.java   |  46 ++--
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  12 +-
 .../worker/FunctionRuntimeManagerTest.java         |   7 +-
 .../worker/FunctionStatsGeneratorTest.java         |   1 +
 .../functions/worker/SchedulerManagerTest.java     |  33 +--
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  10 +-
 27 files changed, 925 insertions(+), 224 deletions(-)

commit aaf224bb7235b2ed99645c13c170ac0d20d2ec9a
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Nov 21 16:18:02 2018 +0800

    add debezium source documentation (#2976)
    
    * add debezium source documentation
    
    * change following Sanjeev's comments

 site2/docs/io-cdc.md        | 146 ++++++++++++++++++++++++++++++++++++++++++++
 site2/docs/io-connectors.md |   1 +
 site2/docs/io-overview.md   |   1 +
 3 files changed, 148 insertions(+)

commit fae43a90095261163eb3a1c2c8c90a006edf74dc
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Nov 20 23:39:10 2018 -0800

    Fix C++ tests after merge (#3027)
    
    Motivation
    There was a conflict between #3003 and #3020 that made C++ tests to fail after merging because of the namespaces changes.
    
    * Fix C++ tests after merge
    * Fix topic name comparison
    * Increase tests timeout from 2 to 5min

 .../src/main/java/org/apache/pulsar/tests/AnnotationListener.java   | 3 ++-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc                        | 6 +++---
 2 files changed, 5 insertions(+), 4 deletions(-)

commit 8e7e33517fede7271c7738582d3d0e115f9182e3
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Nov 21 15:12:55 2018 +0900

    Enable SSL of LibCurl linked to C++ library (#3024)
    
    * Enable SSL of LibCurl linked to C++ library
    
    * Update openssl versions
    
    * Update openssl to 1.1.0j

 pulsar-client-cpp/CMakeLists.txt     |  2 +-
 pulsar-client-cpp/docker/Dockerfile  | 28 ++++++++++++++++++----------
 pulsar-client-cpp/pkg/deb/Dockerfile | 25 +++++++++++++------------
 pulsar-client-cpp/pkg/rpm/Dockerfile | 25 ++++++++++++-------------
 4 files changed, 44 insertions(+), 36 deletions(-)

commit 1b0589bbe47211fc52430d757fa32a0cb784bcf5
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 20 22:09:34 2018 -0500

    Update Function Semantics (#2985)
    
    * Make update functions better
    
    * Compiled
    
    * more checks
    
    * bug fix
    
    * Added tests
    
    * Tests pass
    
    * Fixed tests
    
    * Fixed tests
    
    * Added tests
    
    * Added unittests
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Timeout fix
    
    * Fixed unittest
    
    * Fix unittest
    
    * Addressed feedback

 .../worker/PulsarWorkerAssignmentTest.java         |  10 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   7 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  42 ++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  32 ++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  20 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |   3 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   2 +-
 .../pulsar/common/functions/ConsumerConfig.java    |   6 +-
 .../pulsar/common/functions/FunctionConfig.java    |  12 +-
 .../apache/pulsar/common/functions/Resources.java  |   1 +
 .../pulsar/common/functions/WindowConfig.java      |   5 +-
 .../org/apache/pulsar/common/io/SinkConfig.java    |  13 +-
 .../org/apache/pulsar/common/io/SourceConfig.java  |   9 +-
 .../functions/utils/FunctionConfigUtils.java       | 112 +++++++-
 .../functions/utils/ResourceConfigUtils.java       |  18 ++
 .../pulsar/functions/utils/SinkConfigUtils.java    | 101 ++++++-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  44 ++++
 .../functions/utils/FunctionConfigUtilsTest.java   | 291 +++++++++++++++++++++
 .../functions/utils/SinkConfigUtilsTest.java       | 207 +++++++++++++++
 .../functions/utils/SourceConfigUtilsTest.java     | 166 ++++++++++++
 .../org/apache/pulsar/functions/worker/Utils.java  |  10 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 111 +++++++-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 139 +++++++---
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 175 +++++++++++--
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 171 +++++++++---
 25 files changed, 1541 insertions(+), 166 deletions(-)

commit 7efce9845d2b5847e18ae7f51cae887f9a4d0668
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Nov 20 12:11:17 2018 -0800

    Ensure broker is fully boostrapped before load manager register itself (#2935)
    
    ### Motivation
    
    In some cases the broker can immediately gets assigned traffic before it's fully boostrapped.
    
    This happens because the load manager is registering the broker in ZK before some of the initialization steps are completed.
    
    This results in NPE, like :
    
    ```
    Caused by: java.lang.NullPointerException
            at org.apache.pulsar.broker.service.persistent.PersistentTopic.hasSchema(PersistentTopic.java:1815) ~[org.apache.pulsar-pulsar-broker-2.2.0-streamlio-22.jar:2.2.0-streamlio-22]
            at org.apache.pulsar.broker.service.ServerCnx.lambda$25(ServerCnx.java:836) ~[org.apache.pulsar-pulsar-broker-2.2.0-streamlio-22.jar:2.2.0-streamlio-22]
            at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:656) ~[?:1.8.0_181]
    ```
    
    ### Modifications
    
     * Register the broker in ZK only after the full start sequence has been done. This will ensure other brokers will not discover this broker before it's ready.
     * Expose the "is ready" state in the VipStatus -- This will be used to make sure the load balancer will not direct any lookup request to the broker before it's ready.

 .../pulsar/common/configuration/VipStatus.java     | 10 ++++++++--
 .../org/apache/pulsar/broker/PulsarService.java    | 22 ++++++++++++++++------
 2 files changed, 24 insertions(+), 8 deletions(-)

commit 3008a4bd87b246eebbe1c7d187e19ffef86ccdbc
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Nov 21 04:10:01 2018 +0800

    Fix-2876 Limit the client reconnect behavior (#2977)
    
    ### Motivation
    This PR want to fix issue #2876
    Client reconnect too much and load data from bookie to cause the high network bandwidth usage.
    Add mechanisms to limit the subscribe per consumer to avoid high network bandwidth usage.
    By default, the limit mechanisms is close. Can enable by broker.conf and namespaces policy.
    
    ### Modifications
    
    Add mechanisms to limit consumer subscribe times in a period.
    
    ### Result
    
    If enable the Subscribe Rate Limiter, broker will refuse a consumer subscribe which subscribe times is over more than max subscribe times in a period.

 conf/broker.conf                                   |   9 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  25 ++
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  50 ++++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  22 ++
 .../apache/pulsar/broker/service/ServerCnx.java    |   4 +
 .../broker/service/persistent/PersistentTopic.java |  20 ++
 .../service/persistent/SubscribeRateLimiter.java   | 283 +++++++++++++++++++++
 .../apache/pulsar/broker/admin/NamespacesTest.java |  49 ++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  23 +-
 .../client/admin/internal/NamespacesImpl.java      |  23 ++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  39 +++
 .../pulsar/common/policies/data/Policies.java      |   3 +
 .../pulsar/common/policies/data/SubscribeRate.java |  59 +++++
 13 files changed, 608 insertions(+), 1 deletion(-)

commit f8594e09b2e96729c396628440cb2d566db44a21
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Nov 20 09:57:05 2018 -0800

    Refactored C++ tests (#3003)
    
    * Refactored C++ tests
    
    * Refactored python tests
    
    * Fixed format
    
    * Mount maven repo from outside docker
    
    * Fixed running test inside docker
    
    * Wait to ensure change in dedup state is picked up
    
    * Fixed ClientDeduplicationTest
    
    * Fixed formatting

 bin/pulsar-perf                                    |   2 +-
 pulsar-client-cpp/pulsar-test-service-start.sh     |  98 +++++++++
 pulsar-client-cpp/pulsar-test-service-stop.sh      |  26 +++
 pulsar-client-cpp/python/pulsar_test.py            | 218 +++++++++++----------
 pulsar-client-cpp/run-unit-tests.sh                |  45 +----
 pulsar-client-cpp/test-conf/client-ssl.conf        |  11 +-
 pulsar-client-cpp/test-conf/standalone-ssl.conf    |  20 +-
 pulsar-client-cpp/tests/AuthPluginTest.cc          |  92 +++++----
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 176 +++++++++--------
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  23 ++-
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |  28 ++-
 pulsar-client-cpp/tests/ClientDeduplicationTest.cc |  34 ++--
 pulsar-client-cpp/tests/ClientTest.cc              |   2 +-
 .../tests/ConsumerConfigurationTest.cc             |  16 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |  14 +-
 pulsar-client-cpp/tests/ReaderTest.cc              |  19 +-
 pulsar-client-cpp/tests/ZeroQueueSizeTest.cc       |   6 +-
 .../pulsar/testclient/PerformanceConsumer.java     |   9 -
 .../pulsar/testclient/PerformanceProducer.java     |   9 -
 19 files changed, 480 insertions(+), 368 deletions(-)

commit 4f1b53c88638589a66c52c6320fd1ed6dddd77be
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Nov 20 08:52:33 2018 -0800

    [state][standalone] When running with more than one function instance, Function instances will crash because of table service throws INTERNAL_SERVER_ERROR (#3017)
    
    *Motivation*
    
    When running with more than one function instance, Function instances will crash because of table service throws INTERNAL_SERVER_ERROR
    
    ```
    org.apache.pulsar.functions.runtime.shaded.org.apache.bookkeeper.clients.exceptions.ClientException: fail to access its root range : code = INTERNAL_SERVER_ERROR
            at org.apache.pulsar.functions.runtime.shaded.org.apache.bookkeeper.clients.impl.internal.ProtocolInternalUtils.createRootRangeException(ProtocolInternalUtils.java:105) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.org.apache.bookkeeper.clients.impl.internal.RootRangeClientImpl.processCreateNamespaceResponse(RootRangeClientImpl.java:129) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.org.apache.bookkeeper.clients.impl.internal.RootRangeClientImpl.lambda$createNamespace$4(RootRangeClientImpl.java:118) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.org.apache.bookkeeper.clients.utils.RpcUtils$1.onSuccess(RpcUtils.java:78) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.com.google.common.util.concurrent.Futures$4.run(Futures.java:1135) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.com.google.common.util.concurrent.MoreExecutors$DirectExecutor.execute(MoreExecutors.java:399) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.com.google.common.util.concurrent.AbstractFuture.executeListener(AbstractFuture.java:902) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.com.google.common.util.concurrent.AbstractFuture.complete(AbstractFuture.java:813) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.com.google.common.util.concurrent.AbstractFuture.set(AbstractFuture.java:655) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.stub.ClientCalls$GrpcFuture.set(ClientCalls.java:487) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.stub.ClientCalls$UnaryStreamToFuture.onClose(ClientCalls.java:465) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.CensusStatsModule$StatsClientInterceptor$1$1.onClose(CensusStatsModule.java:684) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.CensusTracingModule$TracingClientInterceptor$1$1.onClose(CensusTracingModule.java:391) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:471) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:63) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.close(ClientCallImpl.java:553) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.access$600(ClientCallImpl.java:474) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:591) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at org.apache.pulsar.functions.runtime.shaded.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) ~[java-instance.jar:2.3.0-SNAPSHOT]
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_144]
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_144]
    
    ```
    
    in current version of bk, `INTERNAL_SEVER_ERROR` was thrown a client attempts to create a table while the table already exists. In a newer version, the client handles that better.
    
    *Changes*
    
    A temp fix before upgrading BK to 4.9 is to handle creating state tables in a more reliable way.

 .../functions/instance/JavaInstanceRunnable.java   | 56 ++++++++++++++--------
 1 file changed, 37 insertions(+), 19 deletions(-)

commit a8023df1b1040929518427d4593bec3981d42c13
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Nov 20 08:52:14 2018 -0800

    [proxy] Use ProxyServlet instead of AsyncProxyServlet (#3022)
    
    *Motivation*
    
    java.lang.IllegalStateException is thrown sometime when pulsar-admin connects through a pulsar proxy.
    
    ```
    06:10:42.202 [pulsar-external-web-60] WARN  org.eclipse.jetty.io.SelectorManager - Exception while notifying connection HttpConnectionOverHTTP@3781919f::SocketChannelEndPoint@3946791f{prod-broker-2.prod-broker.default.svc.cluster.local/192.168.228.141:8080<->/192.168.122.159:41496,OPEN,fill=FI,flush=-,to=1/30000}{io=1/1,kio=1,kro=8}->HttpConnectionOverHTTP@3781919f(l:/192.168.122.159:41496 <-> r:prod-broker-2.prod-broker.default.svc.cluster.local/192.168.228.141:8080,closed=false)=>HttpChannelOverHTTP@3d79faef(exchange=HttpExchange@787b7324 req=PENDING/null@null res=PENDING/null@null)[send=HttpSenderOverHTTP@43cd18dd(req=BEGIN,snd=SENDING,failure=null)[HttpGenerator@49490f3a{s=START}],recv=HttpReceiverOverHTTP@3b153a7e(rsp=IDLE,failure=null)[HttpParser{s=START,0 of -1}]]
    java.lang.IllegalStateException: The same org.eclipse.jetty.client.AsyncContentProvider instance cannot be used in multiple requests
        at org.eclipse.jetty.client.util.DeferredContentProvider.setListener(DeferredContentProvider.java:117) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpSender.send(HttpSender.java:207) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.http.HttpChannelOverHTTP.send(HttpChannelOverHTTP.java:85) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpChannel.send(HttpChannel.java:128) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpConnection.send(HttpConnection.java:201) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.http.HttpConnectionOverHTTP$Delegate.send(HttpConnectionOverHTTP.java:253) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.http.HttpConnectionOverHTTP.send(HttpConnectionOverHTTP.java:122) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.http.HttpDestinationOverHTTP.send(HttpDestinationOverHTTP.java:38) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpDestination.process(HttpDestination.java:347) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpDestination.process(HttpDestination.java:305) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpDestination.send(HttpDestination.java:295) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.HttpDestination.succeeded(HttpDestination.java:229) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.AbstractConnectionPool.proceed(AbstractConnectionPool.java:154) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.AbstractConnectionPool$1.succeeded(AbstractConnectionPool.java:132) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.AbstractConnectionPool$1.succeeded(AbstractConnectionPool.java:124) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.util.Promise$Wrapper.succeeded(Promise.java:130) ~[org.eclipse.jetty-jetty-util-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.client.http.HttpConnectionOverHTTP.onOpen(HttpConnectionOverHTTP.java:130) ~[org.eclipse.jetty-jetty-client-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.io.SelectorManager.connectionOpened(SelectorManager.java:324) [org.eclipse.jetty-jetty-io-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.io.ManagedSelector.createEndPoint(ManagedSelector.java:254) [org.eclipse.jetty-jetty-io-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.io.ManagedSelector.access$1800(ManagedSelector.java:61) [org.eclipse.jetty-jetty-io-9.4.12.v20180830.jar:9.4.12.v20180830]
        at org.eclipse.jetty.io.ManagedSelector$CreateEndPoint.run(ManagedSelector.java:886) [org.eclipse.jetty-jetty-io-9.4.12.v20180830.jar:9.4.12.v20180830]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_181]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_181]
        at java.lang.Thread.run(Thread.java:748) [?:1.8.0_181]
    ```
    
    The race condition happens somewhere in setting listener. However I have no idea how the race condition
    happens. so change to use ProxyServlet to avoid this race condition.
    
    *Changes*
    
    Change AsyncProxyServlet to ProxyServlet

 .../main/java/org/apache/pulsar/proxy/server/AdminProxyHandler.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit b982b5dc9b631b28b017c257174211e7058361ab
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Nov 20 16:11:06 2018 +0800

    add producer flush method in cpp client (#3020)
    
    ### Motivation
    
    We already have flush() method in java api: http://pulsar.apache.org/api/client/org/apache/pulsar/client/api/Producer.html#flush--
    It is better to provide a same method for cpp client.
    
    ### Modifications
    
    Add related methods in cpp client.
    Add related tests.
    
    ### Result
    
    Cpp unit tests pass.

 pulsar-client-cpp/include/pulsar/Producer.h      |  15 ++
 pulsar-client-cpp/lib/BatchMessageContainer.cc   |  22 ++-
 pulsar-client-cpp/lib/BatchMessageContainer.h    |   4 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc |  33 ++++
 pulsar-client-cpp/lib/PartitionedProducerImpl.h  |   5 +
 pulsar-client-cpp/lib/Producer.cc                |  18 +++
 pulsar-client-cpp/lib/ProducerImpl.cc            |  41 ++++-
 pulsar-client-cpp/lib/ProducerImpl.h             |   4 +
 pulsar-client-cpp/lib/ProducerImplBase.h         |   1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 189 +++++++++++++++++++++++
 10 files changed, 320 insertions(+), 12 deletions(-)

commit 5fde6f32b038327163ebf7babc556b72f337a1a1
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Nov 19 23:04:48 2018 -0800

    Prevent race condition while calculating unack-msg offset stats (#3015)
    
    * Prevent race condition while calculating unack-msg offset stats
    
    * local var

 .../org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java     | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 31345dedd8ab24fb314d2902703d521cd4406153
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Nov 19 23:04:27 2018 -0800

    Set version for exec-maven-plugin in pom (#3018)

 pom.xml | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 76d0c71e7dbb2ad0ad92c1a661f23dce6c232faa
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Nov 19 17:17:14 2018 -0800

    Publish pulsar-standalone image along with other images (#3016)
    
    *Motivation*
    
    `pulsar-standalone` was introduced in 2.2.0 release. However the release script was not
    updated to publish this image.
    
    *Change*
    
    add `pulsar-standalone` image to the release script

 docker/publish.sh | 4 ++++
 1 file changed, 4 insertions(+)

commit dadac4c3d0688aef4c4698af797b67de1f7b8436
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Mon Nov 19 12:35:14 2018 -0800

    Fix logic to validate admin calls from proxy (validateOriginalPrincipal) (#2986)

 .../org/apache/pulsar/broker/web/PulsarWebResource.java    | 14 +++++---------
 .../apache/pulsar/broker/admin/AdminApiTlsAuthTest.java    |  8 ++++----
 2 files changed, 9 insertions(+), 13 deletions(-)

commit 7f49b56c5b41bf28232639fb3dab09a650dca526
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Nov 19 11:12:22 2018 -0800

    Remove the original zip when update netty lib name (#3008)

 src/rename-netty-native-libs.sh | 1 +
 1 file changed, 1 insertion(+)

commit d80eee6e31657c2bd0b7506c51a6def9764a24a9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Nov 19 00:26:20 2018 -0800

    Fix creating certificate authority doc (#3001)
    
    *Motivation*
    
    wget a github link is downloading an html page, not the actual content.
    if we want to fetch the actual content, we should use the githubusercontent link.
    
    *Changes*
    
    Change the github link to githubusercontent link.

 site2/docs/security-tls-transport.md                                    | 2 +-
 .../versioned_docs/version-2.1.0-incubating/security-tls-transport.md   | 2 +-
 site2/website/versioned_docs/version-2.2.0/security-tls-transport.md    | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 5e446a67fcacf340d352eeafdce15a78fb971f19
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 18 23:46:04 2018 -0800

    Use AbstractCASReferenceCounted to ensure entry.retain() is valid (#2995)

 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |   6 +-
 .../mledger/util/AbstractCASReferenceCounted.java  | 116 +++++++++++++++++++++
 pom.xml                                            |   4 +
 3 files changed, 124 insertions(+), 2 deletions(-)

commit feb848c27c98c4c42718ceeb584691e3b494abfe
Author: legendtkl <taokelu@gmail.com>
Date:   Mon Nov 19 13:25:01 2018 +0800

    fix typo (#3010)

 site2/docs/deploy-bare-metal.md                                         | 2 +-
 .../versioned_docs/version-2.1.0-incubating/deploy-bare-metal.md        | 2 +-
 .../versioned_docs/version-2.1.1-incubating/deploy-bare-metal.md        | 2 +-
 site2/website/versioned_docs/version-2.2.0/deploy-bare-metal.md         | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit dafec7d464b71d41178bb20e895c7fbd61028ee2
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 18 21:24:47 2018 -0800

    Removed AspectJ runtime agent loader (#3007)
    
    * Removed AspectJ runtime agent loader
    
    * Fixed jar path when using archive

 bin/pulsar                                         | 16 +++++++++-----
 .../server/licenses/LICENSE-EA-Agent-Loader.txt    | 25 ----------------------
 distribution/server/src/assemble/LICENSE.bin.txt   |  2 --
 pom.xml                                            |  6 ------
 pulsar-broker-shaded/pom.xml                       |  1 -
 pulsar-broker/pom.xml                              |  5 -----
 .../org/apache/pulsar/PulsarBrokerStarter.java     |  7 ++----
 .../java/org/apache/pulsar/PulsarStandalone.java   | 20 ++++++-----------
 pulsar-zookeeper/pom.xml                           |  5 -----
 .../apache/pulsar/zookeeper/ZooKeeperStarter.java  |  6 ------
 10 files changed, 20 insertions(+), 73 deletions(-)

commit c83b5ad4f1784a5a4d057bae88ba23947c6cbad2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Nov 18 18:45:10 2018 -0800

    moving pulsar-spark tests into its own module (#3002)

commit a22842ea34ceffaf53b67df8ce60486f9975fa71
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Nov 18 18:44:15 2018 -0800

     Fix bug for not setting resources (#3005)
    
    * Fix bug for not setting resources
    
    * remove log

 .../functions/utils/FunctionConfigUtils.java       |  1 +
 .../functions/utils/FunctionConfigUtilsTest.java   | 61 ++++++++++++++++++++++
 2 files changed, 62 insertions(+)

commit ab8e2687be12a9f6462615d3d1805969d81acdbf
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 18 16:49:03 2018 -0800

    Enforce timeout on all integration tests (#3011)
    
    ### Motivation
    
    There are integration tests that are in occasions never finishing. Eg.: https://builds.apache.org/job/pulsar_precommit_integrationtests/4929/
    
    We need to enforce a timeout on all the tests so we know which one is failing (and get a stack trace for where it was stuck at).

 tests/integration/pom.xml                                         | 2 +-
 .../pulsar/tests/integration/compaction/TestCompaction.java       | 8 ++++----
 2 files changed, 5 insertions(+), 5 deletions(-)

commit d48737190850d88eca3012040535d0fa879d48b2
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 18 15:35:18 2018 -0800

    Use std::call_once instead of pthread_once (#3004)
    
    * Use boost::once instead of pthread_once
    
    * Used std::call_once

 pulsar-client-cpp/lib/c/c_MessageId.cc      | 8 ++++----
 pulsar-client-cpp/lib/checksum/crc32c_sw.cc | 8 ++++----
 2 files changed, 8 insertions(+), 8 deletions(-)

commit 2d1db63eb2b7498dbc74e0704bde5ac13dd99655
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 17 09:30:11 2018 -0800

    Infer paralellism as well (#2999)
    
    * Infer paralellism as well
    
    * Fixed unittests

 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  | 22 ----------------------
 .../apache/pulsar/admin/cli/TestCmdSources.java    | 19 -------------------
 .../org/apache/pulsar/common/functions/Utils.java  |  6 ++++++
 3 files changed, 6 insertions(+), 41 deletions(-)

commit 23c5505d904a5a74184f68a0b4deb5cf9851195d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Nov 16 21:28:42 2018 -0800

     cleaning up and improving function metrics (#2994)
    
    * removing metrics module from functions
    
    * removing other references ot Prometheus metrics server
    
    * removing references to pulsar-functions-metrics
    
    * fix unit tests
    
    * revert test change
    
    * cleaning up and improving function metrics
    
    * slight refactoring
    
    * fix unittest
    
    * moving pulsar-spark tests into its own module

 distribution/server/src/assemble/bin.xml           |   5 -
 .../pulsar/broker/admin/impl/FunctionsBase.java    |  37 ++-
 .../apache/pulsar/broker/admin/v2/WorkerStats.java |   2 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  34 +++
 .../client/admin/internal/FunctionsImpl.java       |  63 +++--
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  22 ++
 .../pulsar/common/policies/data/FunctionStats.java | 138 +++++++++
 .../pulsar/functions/instance/ContextImpl.java     |  88 ++----
 ...unctionStats.java => FunctionStatsManager.java} |  35 +--
 .../pulsar/functions/instance/JavaInstance.java    |   6 +-
 .../functions/instance/JavaInstanceRunnable.java   |  45 ++-
 .../src/main/python/InstanceCommunication_pb2.py   | 197 ++++++-------
 .../instance/src/main/python/contextimpl.py        |  35 +--
 .../instance/src/main/python/function_stats.py     |  31 ++-
 .../instance/src/main/python/python_instance.py    |  70 +++--
 pulsar-functions/metrics/pom.xml                   |  88 ------
 .../pulsar/functions/metrics/MetricsSink.java      |  62 -----
 .../functions/metrics/PrometheusMetricsServer.java | 137 ---------
 .../pulsar/functions/metrics/package-info.java     |  22 --
 .../functions/metrics/sink/AbstractWebSink.java    | 139 ---------
 .../pulsar/functions/metrics/sink/FileSink.java    | 127 ---------
 .../functions/metrics/sink/PrometheusSink.java     | 182 ------------
 .../resources/prometheus_metricsserver_log4j2.yml  |  29 --
 .../functions/metrics/sink/FileSinkTest.java       | 116 --------
 .../metrics/sink/PrometheusSinkTests.java          | 139 ---------
 pulsar-functions/pom.xml                           |   1 -
 .../src/main/proto/InstanceCommunication.proto     |  40 ++-
 pulsar-functions/runtime-shaded/pom.xml            |   1 -
 pulsar-functions/runtime/pom.xml                   |   6 -
 .../functions/runtime/KubernetesRuntime.java       |   3 -
 .../runtime/KubernetesRuntimeFactory.java          |   3 -
 pulsar-functions/worker-shaded/pom.xml             |   1 -
 .../functions/worker/FunctionRuntimeManager.java   | 310 +++++++++++++++------
 .../functions/worker/FunctionsStatsGenerator.java  |  43 ++-
 .../org/apache/pulsar/functions/worker/Utils.java  |  60 +++-
 .../functions/worker/rest/api/FunctionsImpl.java   | 203 ++++++++++----
 .../functions/worker/rest/api/WorkerImpl.java      |  68 ++---
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  37 ++-
 .../rest/api/v2/WorkerStatsApiV2Resource.java      |   4 +-
 .../worker/FunctionRuntimeManagerTest.java         |  26 --
 .../worker/FunctionStatsGeneratorTest.java         |  50 ++--
 pulsar-spark/pom.xml                               |  29 --
 tests/pom.xml                                      |   1 +
 tests/pulsar-spark-test/pom.xml                    |  81 ++++++
 .../spark/SparkStreamingPulsarReceiverTest.java    |   0
 .../SparkStreamingPulsarReceiverExample.java       |   0
 46 files changed, 1150 insertions(+), 1666 deletions(-)

commit 784044b980dfe3e47fc768d9df8c381e67d2e639
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Nov 16 15:03:20 2018 -0800

    moving pulsar storm tests under tests (#3000)

 pulsar-storm/pom.xml                               | 32 -------
 tests/pom.xml                                      |  1 +
 tests/pulsar-storm-test/pom.xml                    | 97 ++++++++++++++++++++++
 .../apache/pulsar/storm/MockOutputCollector.java   |  0
 .../pulsar/storm/MockSpoutOutputCollector.java     |  0
 .../org/apache/pulsar/storm/PulsarBoltTest.java    |  0
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |  0
 .../java/org/apache/pulsar/storm/TestUtil.java     |  0
 .../apache/pulsar/storm/example/StormExample.java  |  0
 9 files changed, 98 insertions(+), 32 deletions(-)

commit efa040fd1fa3a65e317d97ac5b2029ad75677e64
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Nov 16 22:37:39 2018 +0100

    Add connection timeout client configuration option (#2852)
    
    Allows the client to specify how long to wait for brokers to respond.

 .../apache/pulsar/client/api/ClientBuilder.java    | 10 ++++
 .../pulsar/client/api/ClientConfiguration.java     | 21 ++++++++
 .../pulsar/client/impl/ClientBuilderImpl.java      |  6 +++
 .../apache/pulsar/client/impl/ConnectionPool.java  |  2 +-
 .../client/impl/conf/ClientConfigurationData.java  |  3 +-
 .../pulsar/client/impl/ConnectionTimeoutTest.java  | 59 ++++++++++++++++++++++
 6 files changed, 99 insertions(+), 2 deletions(-)

commit aefbaacb9e29adaec593b895e625bb87d902f7b8
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Fri Nov 16 21:28:46 2018 +0000

    Add Flink - Pulsar Batch Sink Support (#2979)
    
    ### Motivation
    
    This PR aims to bring Flink - Pulsar `Batch Sink` Support. If user works with Flink `DataSet` API and would like to write these `DataSets` to Pulsar, this sink can help.
    
    *Ref:* [Flink Batch Sink API](https://ci.apache.org/projects/flink/flink-docs-stable/dev/batch/#data-sinks)
    
    ### Modifications
    
    Please find the change-set as follows:
    - Defines `PulsarOutputFormat` to write Flink Batch `DataSets` into Pulsar.
    - UT Coverage
    - `FlinkPulsarBatchSinkExample` to show how to use and to be used by users.
    - `README.md` documentation
    - Minor `javadoc` fix

 .../connectors/pulsar/PulsarOutputFormat.java      | 111 +++++++++++++++++++++
 .../connectors/pulsar/FlinkPulsarProducer.java     |   2 +-
 .../connectors/pulsar/PulsarOutputFormatTest.java  |  57 +++++++++++
 .../example/FlinkPulsarBatchSinkExample.java       | 102 +++++++++++++++++++
 .../batch/connectors/pulsar/example/README.md      | 106 ++++++++++++++++++++
 .../java/org/apache/pulsar/io/core/PushSource.java |   2 +-
 6 files changed, 378 insertions(+), 2 deletions(-)

commit 2c8c288a9b5754e6fb551c538c993e4717adf7eb
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Nov 16 00:01:44 2018 -0800

    Handle unknown runtime exception while reading entries (#2993)
    
    * Handle unknown runtime exception while reading entries
    
    * make asyncReadEntry0 private

 .../bookkeeper/mledger/impl/EntryCacheImpl.java    | 30 +++++++++++++++++++++-
 1 file changed, 29 insertions(+), 1 deletion(-)

commit 579e0dc74039c081301662e5fd55209c1a4abe5c
Author: Samuel <foreversunyao@yahoo.com>
Date:   Fri Nov 16 02:06:54 2018 +0800

    add go client link to document (#2991)

 site2/docs/client-libraries-websocket.md | 2 +-
 site2/docs/concepts-clients.md           | 2 +-
 site2/docs/concepts-overview.md          | 2 +-
 site2/docs/getting-started-docker.md     | 2 +-
 site2/docs/getting-started-standalone.md | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

commit 585c55b3efdf0729f7682b90ab5800e52d473dc9
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 14 17:51:00 2018 -0800

    Introduce `Client.getPartitionsForTopic()` (#2972)
    
    * Java Implementation
    
    * C++ Implementation
    
    * C Implementation
    
    * Python implementation
    
    * Go Implementation
    
    * Fixed cpp format
    
    * Fixed cpp test
    
    * Fixed formatting after merge

 .../api/PartitionedProducerConsumerTest.java       | 23 +++++++++
 pulsar-client-cpp/CMakeLists.txt                   |  4 ++
 pulsar-client-cpp/include/pulsar/Client.h          | 33 ++++++++++++
 pulsar-client-cpp/include/pulsar/c/client.h        | 10 ++++
 pulsar-client-cpp/include/pulsar/c/string_list.h   | 43 ++++++++++++++++
 pulsar-client-cpp/lib/Client.cc                    | 12 +++++
 pulsar-client-cpp/lib/ClientImpl.cc                | 41 +++++++++++++++
 pulsar-client-cpp/lib/ClientImpl.h                 |  5 ++
 pulsar-client-cpp/lib/c/cStringList.cc             | 34 ++++++++++++
 pulsar-client-cpp/lib/c/c_Client.cc                | 39 ++++++++++++++
 pulsar-client-cpp/lib/c/c_structs.h                |  4 ++
 pulsar-client-cpp/python/pulsar/__init__.py        | 15 ++++++
 pulsar-client-cpp/python/pulsar_test.py            | 17 ++++++
 pulsar-client-cpp/python/src/client.cc             | 19 +++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 28 ++++++++++
 pulsar-client-go/pulsar/c_client.go                | 60 ++++++++++++++++++++--
 pulsar-client-go/pulsar/c_go_pulsar.h              |  8 +++
 pulsar-client-go/pulsar/client.go                  | 10 ++++
 pulsar-client-go/pulsar/client_test.go             | 56 ++++++++++++++++++++
 .../org/apache/pulsar/client/api/PulsarClient.java | 17 ++++++
 .../pulsar/client/impl/PulsarClientImpl.java       | 18 +++++++
 21 files changed, 493 insertions(+), 3 deletions(-)

commit 2e49a1a3397063cb6fba8259b1bff9be60ad2582
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Nov 14 22:09:44 2018 +0800

    default enable cpp client producer batch (#2949)
    
    Motivation
    In Cpp client producer batching is disabled by default, This is not align with java client, and use default value will cause benchmark has a low result.
    
    Modifications
    default enable cpp producer batch

 pulsar-client-cpp/lib/ProducerConfigurationImpl.h | 2 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc      | 5 ++++-
 pulsar-client-cpp/tests/ReaderTest.cc             | 8 +++++---
 3 files changed, 10 insertions(+), 5 deletions(-)

commit 424034b5393bbf6440ac1c301febb98b64299fe6
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Nov 14 13:24:22 2018 +0800

    add triggerFlush to immediately flush batch messages in producer::send (#2980)

 pulsar-client-cpp/lib/PartitionedProducerImpl.cc |   7 +
 pulsar-client-cpp/lib/PartitionedProducerImpl.h  |   2 +
 pulsar-client-cpp/lib/Producer.cc                |   5 +
 pulsar-client-cpp/lib/ProducerImpl.cc            |   7 +
 pulsar-client-cpp/lib/ProducerImpl.h             |   4 +-
 pulsar-client-cpp/lib/ProducerImplBase.h         |   1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 202 +++++++++++++++++++++++
 pulsar-client-cpp/tests/BatchMessageTest.cc      |   5 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc     |   1 +
 9 files changed, 232 insertions(+), 2 deletions(-)

commit 562cb364ad5a56e2e3dd6c6950070357d513bf28
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Nov 13 14:06:33 2018 -0800

    reverting jackson version bump for sql (#2978)
    
    * reverting jackson version bump for sql
    
    * changing databind to be 2.8.11.1
    
    * fix license file

 pulsar-sql/pom.xml                                 |  7 ++++--
 pulsar-sql/presto-distribution/LICENSE             | 26 +++++++++++-----------
 pulsar-sql/presto-distribution/pom.xml             |  7 ++++--
 .../tests/integration/presto/TestBasicPresto.java  |  8 +++++++
 4 files changed, 31 insertions(+), 17 deletions(-)

commit 9ecfb7da4a2b5bbf9e3d1dbd10753149f3c0826f
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Nov 14 00:36:36 2018 +0900

    Fix NPE caused by the race condition (#2973)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 22 ++++++++++++----------
 1 file changed, 12 insertions(+), 10 deletions(-)

commit 915411b3c90153b9ef1949a9f49da88eae62a08d
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Nov 13 13:40:40 2018 +0800

    fix NPE for debezium-mysql-source-config.yaml (#2975)
    
    Add missing configs

 .../src/main/resources/debezium-mysql-source-config.yaml                | 2 ++
 1 file changed, 2 insertions(+)

commit 7c19bd220a82daeb5ff3f76b0387ed434fab66b2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Nov 12 14:49:58 2018 -0800

    move exclamation.zip location (#2974)

 tests/docker-images/latest-version-image/Dockerfile |   3 ++-
 .../python-examples/exclamation.zip                 | Bin 39311 -> 39124 bytes
 2 files changed, 2 insertions(+), 1 deletion(-)

commit e8cce5ca75316886f79a5e47ffd204aff3803a4b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 10 10:00:45 2018 -0800

    Ignore the current class while going over variables (#2970)
    
    * Ignore the current class while going over variables
    
    * Took feedback into account
    
    * More feedback

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java         | 2 +-
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java             | 1 +
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java           | 1 +
 3 files changed, 3 insertions(+), 1 deletion(-)

commit c1c699f6b544c20548d021c4bd3d786bec2505d8
Author: David Tinker <david.tinker@gmail.com>
Date:   Sat Nov 10 19:47:04 2018 +0200

    Added pause and resume to Java client Consumer (#2961)
    
    * Added pause and resume to Java client Consumer
    
    * Lambda
    
    Co-Authored-By: davidtinker <david.tinker@gmail.com>
    
    * Lambda
    
    Co-Authored-By: davidtinker <david.tinker@gmail.com>
    
    * Added note on receive to pause javadoc
    
    * Added tests for Java Consumer pause and resume
    
    * Got rid of extra blank lines

 .../api/PartitionedProducerConsumerTest.java       | 54 ++++++++++++++++++++++
 .../client/api/SimpleProducerConsumerTest.java     | 47 +++++++++++++++++++
 .../org/apache/pulsar/client/api/Consumer.java     | 11 +++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 17 ++++++-
 .../client/impl/MultiTopicsConsumerImpl.java       | 10 ++++
 .../pulsar/PulsarConsumerSourceTests.java          |  8 ++++
 6 files changed, 146 insertions(+), 1 deletion(-)

commit 2abb1725f07c2bb45ba5c7152b27eff9bed7a640
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Nov 9 18:52:16 2018 -0800

    Don't use default values within the config. (#2971)
    
    * Don't use default values within the config.
    
    * Fixed unittests

 .../worker/PulsarWorkerAssignmentTest.java         |  2 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  2 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |  2 +-
 .../pulsar/common/functions/FunctionConfig.java    |  8 +++----
 .../org/apache/pulsar/common/io/SinkConfig.java    |  2 +-
 .../org/apache/pulsar/common/io/SourceConfig.java  |  2 +-
 .../functions/utils/FunctionConfigUtils.java       | 28 ++++++++++++++--------
 .../pulsar/functions/utils/SinkConfigUtils.java    |  8 +++++--
 .../pulsar/functions/utils/SourceConfigUtils.java  |  8 +++++--
 .../functions/utils/FunctionConfigUtilsTest.java   |  2 ++
 .../functions/utils/SinkConfigUtilsTest.java       |  1 +
 .../functions/utils/SourceConfigUtilsTest.java     |  1 +
 12 files changed, 43 insertions(+), 23 deletions(-)

commit 91a04889b3364174857e79aecc49a9ef16e88259
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Sat Nov 10 10:27:18 2018 +0900

    Fix Get Function Cluster in Master Docs (#2960)
    
    ### Motivation
    
    About #2948 , fix path in master docs.
    
    ### Modifications
    Change `curl -s http://localhost:8080/admin/v2/functions/cluster` to `curl -s http://localhost:8080/admin/v2/worker/cluster`

 site2/docs/io-quickstart.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c704aaa727bee1d91019e50e841cc30977f17ebc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Nov 9 17:26:32 2018 -0800

    improve python function packaging (#2965)
    
    ### Motivation
    
    Current python function package of a zip file requires a requirements.txt to be present. It also requires all your dependencies to be explicitly mentioned in requirements.txt.  This is cumbersome and unwieldy especially if the user built a wheel file locally and want to include it as a dependency.
    
    Going forward, python instance should just install all wheel files in the deps folder and not rely on requirements.txt for a list of dependencies.  Users can just drop their wheel files in the deps folder and then their are good to go.  I think this is what AWS lambda also does for their python packaging

 .../instance/src/main/python/python_instance_main.py | 20 +++++++++++++-------
 1 file changed, 13 insertions(+), 7 deletions(-)

commit 34ab4230c125b5b9f32f476fbbcfc9f952e5f6b5
Author: Christophe Bornet <cbornet@hotmail.com>
Date:   Fri Nov 9 20:10:59 2018 +0100

    Websocket dead letter topic (PIP22) (#2968)
    
    * Add support for dead letter policy in the websocket proxy
    
    * Add doc for websocket dead letter topic params

 .../apache/pulsar/websocket/ConsumerHandler.java    | 21 +++++++++++++++++----
 site2/docs/client-libraries-websocket.md            |  2 ++
 2 files changed, 19 insertions(+), 4 deletions(-)

commit 037c15376c7bb3195ecdf94e8c507f2ae0c34a0f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Nov 9 08:19:54 2018 -0800

    Add partitioned-topic stats internal admin-api (#2958)
    
    * Add partitioned-topic stats internal admin-api
    
    * add class

 .../broker/admin/impl/PersistentTopicsBase.java    | 28 +++++++++++++
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 15 +++++++
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 13 ++++++
 .../org/apache/pulsar/client/admin/Topics.java     | 21 ++++++++++
 .../pulsar/client/admin/internal/TopicsImpl.java   | 35 ++++++++++++++++
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 14 +++++++
 .../data/PartitionedTopicInternalStats.java        | 49 ++++++++++++++++++++++
 7 files changed, 175 insertions(+)

commit f9dc3e4518a294128fdc8f84887cf152a6bc40dc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Nov 8 16:45:07 2018 -0800

    Derive np topic worker threads based on system config (#2956)

 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 900e747908cfc916f9ff8ea5ff24041133c4ac99
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Nov 8 12:16:07 2018 -0800

    Expose metrics via http port in function instance (#2930)
    
    * fix bugs in python metrics
    
    * instance expose metrics
    
    * remove commented out code
    
    * fix unit tests
    
    * remove commented out code
    
    * fixing test
    
    * fix python instance test
    
    * removing old code
    
    * fix bug
    
    * refactoring java metrics
    
    * refactoring python metrics
    
    * cleaning up code
    
    * removing unneccessary code
    
    * improving metrics format
    
    * fixing test
    
    * fix bugs and revising format
    
    * fix bug
    
    * fix for python3
    
    * change user defined metric to summary
    
    * renaming labels
    
    * change back python

 .../pulsar/functions/instance/ContextImpl.java     |  73 +++++++++----
 .../pulsar/functions/instance/FunctionStats.java   |  58 ++++++++---
 .../pulsar/functions/instance/InstanceConfig.java  |   1 +
 .../functions/instance/JavaInstanceRunnable.java   |  56 ++++++----
 .../instance/src/main/python/contextimpl.py        |  42 +++++---
 .../instance/src/main/python/function_stats.py     |  75 ++++++++++++++
 .../instance/src/main/python/python_instance.py    | 115 ++++++++-------------
 .../src/main/python/python_instance_main.py        |   8 +-
 .../pulsar/functions/instance/ContextImplTest.java |   3 +-
 .../instance/JavaInstanceRunnableTest.java         |   2 +-
 .../src/test/python/test_python_instance.py        |   2 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  34 +++++-
 .../functions/runtime/KubernetesRuntime.java       |  79 ++------------
 .../pulsar/functions/runtime/LocalRunner.java      |   1 +
 .../pulsar/functions/runtime/ProcessRuntime.java   |   4 +-
 .../pulsar/functions/runtime/RuntimeUtils.java     |   9 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |  15 ++-
 .../functions/runtime/ThreadRuntimeFactory.java    |  12 ++-
 .../functions/runtime/KubernetesRuntimeTest.java   |  22 ++--
 .../functions/runtime/ProcessRuntimeTest.java      |  21 ++--
 .../pulsar/functions/worker/FunctionActioner.java  |   1 +
 .../functions/worker/FunctionRuntimeManager.java   |   4 +-
 .../functions/worker/FunctionsStatsGenerator.java  |   8 +-
 .../worker/FunctionStatsGeneratorTest.java         |  20 ++--
 .../functions/worker/SchedulerManagerTest.java     |  22 ++--
 25 files changed, 417 insertions(+), 270 deletions(-)

commit b708b49638833a663c1e8ea43ba8e91af56eb93a
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Nov 8 10:09:44 2018 -0800

    Fixed race condition in schema initialization in partitioned topics (#2959)
    
    * Fixed race condition in schema initialization in partitioned topics
    
    * Removed lombok log
    
    * Fixed tests

 .../service/schema/BookkeeperSchemaStorage.java    | 244 ++++++++++++++-------
 .../schema/PartitionedTopicsSchemaTest.java        |   4 +-
 .../client/impl/PartitionedProducerImpl.java       |   4 +-
 3 files changed, 173 insertions(+), 79 deletions(-)

commit 7756231afe18d6d2389a79e9a6d1f96b9a4085b7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Nov 7 16:26:20 2018 -0800

    Fix zk latency metrics collector (#2916)

 .../pulsar/broker/zookeeper/aspectj/ClientCnxnAspect.java     | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

commit 43da26dba171c731f4abb243885400e2641d3caa
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Nov 7 14:48:23 2018 -0800

    Remove conflicting log4j2 policies (#2955)

 conf/log4j2.yaml | 4 ----
 1 file changed, 4 deletions(-)

commit 988b55d7fb4b1a11a46f9da0c4482413f72c4125
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Nov 7 14:32:36 2018 -0800

    Make Log a logger instead of Logger Adapter (#2944)
    
    * Make Log a logger instead of Logger Adapter
    
    * Corrected the log

 pulsar-functions/instance/src/main/python/log.py | 34 +-----------------------
 1 file changed, 1 insertion(+), 33 deletions(-)

commit ec170b0270896b4dd834116b86e9786fa15eb81b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Nov 7 13:41:48 2018 -0800

    Check for presence of namespace/tenant before creating function (#2947)
    
    * Check for presence of namespace/tenant before creating function
    
    * Fixed namespace semantics

 .../apache/pulsar/io/PulsarFunctionTlsTest.java    | 11 +++---
 .../functions/worker/rest/api/FunctionsImpl.java   | 40 ++++++++++++++++++++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 39 ++++++++++++++++++++-
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 37 ++++++++++++++++++++
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 37 ++++++++++++++++++++
 5 files changed, 159 insertions(+), 5 deletions(-)

commit 6fd7406a4de061235ac718bb199f5e2f36fb2cc9
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 7 13:34:12 2018 -0800

    Remove guava usage in pulsar-storm (#2898)

 pulsar-storm/pom.xml                               | 34 ---------------------
 .../java/org/apache/pulsar/storm/PulsarBolt.java   | 19 ++++++------
 .../pulsar/storm/PulsarBoltConfiguration.java      |  4 +--
 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 35 +++++++++++-----------
 .../pulsar/storm/PulsarSpoutConfiguration.java     |  5 ++--
 .../apache/pulsar/storm/SharedPulsarClient.java    |  5 ++--
 6 files changed, 32 insertions(+), 70 deletions(-)

commit 810b95f5501decba161a05f73b36796bb7c0860f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Nov 7 09:34:23 2018 -0800

    Make sure that the returned object is string for conversion purposes (#2946)

 pulsar-functions/python-examples/config_based_append_function.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 144ee74eeb72d5636d57017839ee01b6f4f4cbd7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 6 21:09:10 2018 -0800

    Make sure to create client before doing admission check (#2945)
    
    * Make sure to create client before doing admission check
    
    * Added unittest

 .../runtime/KubernetesRuntimeFactory.java          |   5 +
 .../runtime/KubernetesRuntimeFactoryTest.java      | 172 +++++++++++++++++++++
 2 files changed, 177 insertions(+)

commit e0c34301319bd79b7bee2751795384c434830f55
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Wed Nov 7 12:51:56 2018 +0900

    fix api path (#2948)

 site2/website/versioned_docs/version-2.2.0/io-quickstart.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit da0cc00e07001d3aab7dcc940812b1c4df67b642
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 6 09:11:17 2018 -0800

    Made Window Context up to date with Context (#2932)
    
    * Made Window Context up to date with Context
    
    * Added state interfaces as well

 .../pulsar/functions/windowing/WindowContext.java  | 105 ++++++++++++++++++---
 .../functions/windowing/WindowContextImpl.java     |  69 ++++++++++++--
 2 files changed, 153 insertions(+), 21 deletions(-)

commit be0fe3537751b7360b78bffe821a1f32f477a986
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 6 00:27:23 2018 -0800

    Handle case where function produces some output but no output topic given (#2941)

 pulsar-functions/instance/src/main/python/python_instance.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 76b46a5b5880f70eed51889752e268033675cd56
Author: legendtkl <taokelu@gmail.com>
Date:   Tue Nov 6 16:26:42 2018 +0800

    fix go-client demo code (#2934)
    
    ### Motivation
    
    fix
    ### Modifications
    
    add lost package to import
    
    ### Result
    
    fix

 site2/docs/client-libraries-go.md | 1 +
 1 file changed, 1 insertion(+)

commit fab36a1f70ef1010c92da60039fea255993af837
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Nov 6 00:26:06 2018 -0800

    Fix the conversion process of windowing functions (#2940)

 .../functions/utils/FunctionConfigUtils.java       |  4 +++-
 .../functions/utils/FunctionConfigUtilsTest.java   | 28 ++++++++++++++++++++++
 2 files changed, 31 insertions(+), 1 deletion(-)

commit 4fb60ee36972f46c570864f1ecd01a373fcf7c7b
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Nov 6 07:58:19 2018 +0100

    Add healthcheck HTTP endpoint (#2883)
    
    * Add healthcheck HTTP endpoint
    
    Triggering the endpoint causes a client to try to produce and consume
    messages on the local broker.
    
    * Async
    
    * Add Suite to suite list (this is super cumbersome and will result in integration tests not being run)
    
    also, disable the one test that depends on admin client timeouts
    
    * typo
    
    * Move timeout to outside read loop

 .../pulsar/broker/admin/impl/BrokersBase.java      | 101 ++++++++++++++++++
 .../org/apache/pulsar/client/admin/Brokers.java    |   7 ++
 .../pulsar/client/admin/internal/BrokersImpl.java  |  11 ++
 .../org/apache/pulsar/admin/cli/CmdBrokers.java    |  14 ++-
 .../tests/integration/cli/HealthcheckTest.java     | 115 +++++++++++++++++++++
 .../integration/topologies/PulsarCluster.java      |  24 +++++
 .../src/test/resources/pulsar-process.xml          |   3 +-
 7 files changed, 273 insertions(+), 2 deletions(-)

commit bc1d94ce7909736c71bc11568a1e5ab2277a97b2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Nov 5 22:54:21 2018 -0800

    When killing process make sure to use the force mode (#2938)

 .../main/java/org/apache/pulsar/functions/runtime/ProcessRuntime.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d1c531acdcbe0bc01f470ff67b6c1c41f767adfa
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Nov 5 21:28:12 2018 -0800

    Infer missing arguments before starting localrun (#2937)

 .../main/java/org/apache/pulsar/functions/runtime/LocalRunner.java    | 4 ++++
 1 file changed, 4 insertions(+)

commit 74b6af276da351608c6359dd499381b6ba36362c
Author: legendtkl <taokelu@gmail.com>
Date:   Tue Nov 6 09:24:25 2018 +0800

    fix go client demo (#2931)

 .../versioned_docs/version-2.1.0-incubating/client-libraries-go.md       | 1 +
 site2/website/versioned_docs/version-2.2.0/client-libraries-go.md        | 1 +
 2 files changed, 2 insertions(+)

commit 33ab2e070d964084097b5242b5de6867f843408c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Nov 5 17:08:34 2018 -0800

    Rejigger SecretsProviderConfigurator interface to make checking more generic (#2933)
    
    ### Motivation
    
    A SecretsConfigurator might want to do more checks than just check the secrets. This pr makes the configurator interface more generic

 .../runtime/KubernetesRuntimeFactory.java          | 10 +--
 .../pulsar/functions/runtime/RuntimeUtils.java     | 12 ++--
 .../functions/runtime/KubernetesRuntimeTest.java   | 84 ++++++++++++++--------
 .../functions/runtime/ProcessRuntimeTest.java      |  4 +-
 .../KubernetesSecretsProviderConfigurator.java     | 36 ++++++----
 .../SecretsProviderConfigurator.java               |  4 +-
 .../KubernetesSecretsProviderConfiguratorTest.java | 13 ++--
 7 files changed, 100 insertions(+), 63 deletions(-)

commit 169534de5796ee9e31b79d1c0706f67571f19d5f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Nov 5 10:59:44 2018 -0800

    fix bugs in python metrics (#2928)

 .../instance/src/main/python/python_instance.py      | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

commit e5d79bf54a6c66fd7ce3f1dd4f9f72f13f13e9cf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Nov 5 10:08:54 2018 -0800

    Handle broker shutdown for already deleted load-balancer znode (#2909)

 .../java/org/apache/pulsar/broker/PulsarServerException.java     | 9 +++++++++
 .../pulsar/broker/loadbalance/impl/ModularLoadManagerImpl.java   | 2 ++
 .../java/org/apache/pulsar/broker/service/BrokerService.java     | 8 +++++++-
 3 files changed, 18 insertions(+), 1 deletion(-)

commit 5de1ef7009057f82c4adfc687d360c8c9a15ddd3
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Mon Nov 5 15:12:16 2018 +0800

    change kafkaConnectSource to return KeyValue type record (#2902)
    
    change kafkaConnectSource to return KeyValue type record.

 .../java/org/apache/pulsar/client/api/Schema.java  |   5 +
 .../pulsar/client/impl/schema/KeyValueSchema.java  |   2 +-
 .../pulsar/client/schema/KeyValueSchemaTest.java   |  28 +++
 .../pulsar/functions/source/TopicSchema.java       |   6 +
 .../io/kafka/connect/KafkaConnectSource.java       | 194 +++++++++++++--------
 .../io/kafka/connect/KafkaConnectSourceTest.java   |  50 ++++--
 6 files changed, 193 insertions(+), 92 deletions(-)

commit ee22e0a132955edbbdd3317dde0c4b60b3bb90b8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Nov 4 22:46:00 2018 -0800

    Fix process runtime with extra dependencies and re-enable python integration tests (#2926)
    
    ### Motivation
    
    fix python process with extra dependencies
    
    ```
    java.io.IOException: Cannot run program PYTHONPATH=${PYTHONPATH}:/Users/jerrypeng/workspace/incubator-pulsar/instances/deps: error=2, No such file or directory
        at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048) ~[?:1.8.0_144]
        at org.apache.pulsar.functions.runtime.ProcessRuntime.startProcess(ProcessRuntime.java:291) [pulsar-functions-runtime.jar:2.3.0-SNAPSHOT]
        at org.apache.pulsar.functions.runtime.ProcessRuntime.start(ProcessRuntime.java:124) [pulsar-functions-runtime.jar:2.3.0-SNAPSHOT]
        at org.apache.pulsar.functions.runtime.RuntimeSpawner$1.run(RuntimeSpawner.java:94) [pulsar-functions-runtime.jar:2.3.0-SNAPSHOT]
        at java.util.TimerThread.mainLoop(Timer.java:555) [?:1.8.0_144]
        at java.util.TimerThread.run(Timer.java:505) [?:1.8.0_144]
    Caused by: java.io.IOException: error=2, No such file or directory
        at java.lang.UNIXProcess.forkAndExec(Native Method) ~[?:1.8.0_144]
        at java.lang.UNIXProcess.<init>(UNIXProcess.java:247) ~[?:1.8.0_144]
        at java.lang.ProcessImpl.start(ProcessImpl.java:134) ~[?:1.8.0_144]
        at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029) ~[?:1.8.0_144]
        ... 5 more
    ```
    
    ### Modifications
    
    - set environment variables in process builder for process runtime
    - enable python function integration tests
    - add integration test for python function with extra dependencies
    
    ### Result
    
    python functions test passed and integration test for python function with extra deps is tested.

 .../pulsar/functions/runtime/ProcessRuntime.java   |  14 ++-
 .../functions/runtime/ProcessRuntimeTest.java      |  19 +---
 .../docker-images/latest-version-image/Dockerfile  |   7 ++
 .../python-examples/exclamation_lib.py             |  22 ++++
 .../python-examples/exclamation_with_extra_deps.py |  31 ++++++
 .../integration/functions/PulsarFunctionsTest.java | 112 +++++++++++++++++----
 .../functions/PulsarFunctionsTestBase.java         |  12 ++-
 7 files changed, 180 insertions(+), 37 deletions(-)

commit 6617b3218ce6003dc423f3985bda49964d0826a7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Nov 4 12:06:13 2018 -0800

    Added some basic checks for function/source/sink in cli as well (#2924)
    
    ### Motivation
    
    We recently moved all config validation from client side to server side.
    However in order for the cli to submit its function to the server, users should supply some basic information(like tenant/namespace/name) because the submission path involves them.
    This pr adds back some basic checks back in the client so that we do basic checks for these fields.

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 33 ++++++++++++++----
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 12 +++++++
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  2 ++
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  1 +
 .../org/apache/pulsar/common/functions/Utils.java  | 40 ++++++++++++++++++++++
 .../functions/utils/FunctionConfigUtils.java       | 25 ++------------
 .../pulsar/functions/utils/SinkConfigUtils.java    |  9 -----
 .../pulsar/functions/utils/SourceConfigUtils.java  |  8 -----
 .../functions/worker/rest/api/FunctionsImpl.java   |  4 +--
 9 files changed, 87 insertions(+), 47 deletions(-)

commit 36f767f7a7009f35ae8eb0b4fb31bd28e31ef75e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Nov 4 11:41:19 2018 -0800

    fix bugs in python instance metrics (#2925)
    
    ### Motivation
    
    fixing some bugs in the python instance metrics code

 pulsar-functions/instance/src/main/python/python_instance.py | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 150f2a014f9f630477b7fb0ea7e116323e73774b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Nov 4 01:27:58 2018 -0700

    Allow configuring extra dependencies directory for functions (#2923)
    
    * Allow configuring extra dependencies directory for functions
    
    *Motivation*
    
    Functions offer interfaces (e.g. SecretsProvider) for users to provider their own implementations.
    In order for runtime to load those customize implementation, we should allow users configuring extra dependencies.
    
    *Changes*
    
    Add extra dependencies directory in function worker config to allow user configuring location to load their customized implementations.

 bin/pulsar                                         |   3 +
 conf/functions_worker.yml                          |   5 +
 distribution/server/src/assemble/bin.xml           |   8 ++
 .../functions/runtime/KubernetesRuntime.java       |  53 +++++--
 .../runtime/KubernetesRuntimeFactory.java          |  16 +++
 .../pulsar/functions/runtime/LocalRunner.java      |  11 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |  22 ++-
 .../functions/runtime/ProcessRuntimeFactory.java   |  17 +++
 .../pulsar/functions/runtime/RuntimeUtils.java     |  21 ++-
 .../functions/runtime/KubernetesRuntimeTest.java   | 123 ++++++++++++++--
 .../functions/runtime/ProcessRuntimeTest.java      | 156 +++++++++++++++++++--
 .../functions/worker/FunctionRuntimeManager.java   |   2 +
 .../pulsar/functions/worker/WorkerConfig.java      |   6 +-
 13 files changed, 396 insertions(+), 47 deletions(-)

commit 7351b24c90d774cd5fac79cdfce91cf6407906a6
Author: Alice <WheresAlice@users.noreply.github.com>
Date:   Sun Nov 4 07:40:05 2018 +0000

    Fix typo in consumer code (#2920)
    
    ### Motivation
    
    Fixing a small typo in the example consumer code which stops it from working
    
    ### Modifications
    
    Small fix to resolve an incorrectly named variable in the example consumer client code
    
    ### Result
    
    The example works

 site2/docs/client-libraries-go.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6583d2ceeb57bac60a92a3ab09df7f2cb384377e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Nov 3 22:14:36 2018 -0700

    Refactor function metrics to use prometheus (#2914)
    
    * Beginging to refactor function metrics to use prometheus
    
    * fix unit test
    
    * removing test code
    
    * fix test
    
    * minor refactoring
    
    * addressing comments
    
    * adding python instance
    
    * remove test code
    
    * adding prometheus client as instance dependency
    
    * fix bug
    
    * adding prometheus to license file

 conf/functions_worker.yml                          |   1 -
 distribution/server/src/assemble/LICENSE.bin.txt   |   2 +
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   1 -
 pulsar-client-cpp/python/setup.py                  |   2 +-
 pulsar-functions/instance/pom.xml                  |  20 ++
 .../pulsar/functions/instance/FunctionStats.java   | 207 +++++++----------
 .../functions/instance/JavaInstanceRunnable.java   |  89 ++++----
 .../instance/src/main/python/python_instance.py    | 248 +++++++++------------
 .../pulsar/functions/runtime/JavaInstanceMain.java |   6 +
 .../functions/worker/FunctionRuntimeManager.java   |  21 +-
 .../functions/worker/FunctionsStatsGenerator.java  |  12 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   1 -
 .../pulsar/functions/worker/WorkerService.java     |   6 -
 .../functions/worker/rest/api/WorkerImpl.java      |   4 +-
 .../worker/FunctionStatsGeneratorTest.java         |  21 +-
 15 files changed, 288 insertions(+), 353 deletions(-)

commit edf988de0d57adf6ed6ca5d1899a78de94e0cbfd
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 3 19:16:54 2018 -0700

    Always cover gson generated json with quotes (#2922)
    
    ### Motivation
    
    Kubernetes has troubles viewing arguments with string embedded in them. So cover the secrets_config with quotes

 .../src/main/python/python_instance_main.py        |  5 ++
 .../pulsar/functions/runtime/JavaInstanceMain.java |  6 +++
 .../pulsar/functions/runtime/RuntimeUtils.java     |  2 +-
 .../functions/runtime/KubernetesRuntimeTest.java   | 60 ++++++++++++++++++++--
 .../functions/runtime/ProcessRuntimeTest.java      |  4 +-
 5 files changed, 69 insertions(+), 8 deletions(-)

commit 6b5f737e417fa391d82dda68f01e819e1e93614c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 3 10:50:48 2018 -0700

    Prefer rest path over Function/Source/Sink Config values (#2918)
    
    ### Motivation
    
    When users create/update sink/source/function, they call the rest endpoint that has a tenant/namespace/name components and pass it a Function/Source/SinkConfig. These configs also have tenant/namespace/name parameter that might be different from the rest path.
    This pr gives preference to the rest path by overwriting the config fields.

 .gitignore                                         |  1 +
 .../functions/worker/rest/api/FunctionsImpl.java   | 12 ++++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 32 ++++++++++++++++
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 42 +++++++++++++++++++++
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 43 ++++++++++++++++++++++
 5 files changed, 130 insertions(+)

commit 080107a6ed5ade79685e1e28d8128864d27da879
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 3 10:49:58 2018 -0700

    Enable Presto Test (#2919)
    
    Motivation
    After the recent dependency changes, presto is now functional again in master.

 .../org/apache/pulsar/tests/integration/presto/TestBasicPresto.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7d1464f978bf0d450f86b78b66cd92a69c8ca477
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 3 10:44:08 2018 -0700

    Make print statement python3 friendly (#2921)

 pulsar-functions/instance/src/main/python/python_instance_main.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 8f294c9ff67c36deee1d84d1dbc2dab8aa612bb4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Nov 3 00:24:43 2018 -0700

    Remove functions-util dependency from pulsar-client-admin (#2917)
    
    * Remove functions-util dependency from pulsar-client-admin
    
    * Simplified
    
    * reverted accidental change
    
    * fixed unittest
    
    * Updated license

 .../worker/PulsarWorkerAssignmentTest.java         |  2 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  4 +-
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |  2 +-
 pulsar-client-admin/pom.xml                        |  6 ---
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  1 -
 pulsar-client-tools/pom.xml                        |  7 +++
 .../apache/pulsar/admin/cli/CmdFunctionWorker.java |  4 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  5 ++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 29 +++---------
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 29 +++---------
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  2 +-
 .../org/apache/pulsar/common/functions/Utils.java  | 32 +++++++++++++
 .../pulsar/functions/runtime/LocalRunner.java      | 52 ++++++++++++++++++++--
 .../functions/utils/FunctionConfigUtils.java       |  7 ++-
 .../pulsar/functions/utils/SinkConfigUtils.java    |  4 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  4 +-
 .../org/apache/pulsar/functions/utils/Utils.java   | 19 +-------
 .../pulsar/functions/worker/FunctionActioner.java  |  7 ++-
 .../org/apache/pulsar/functions/worker/Utils.java  |  3 --
 .../functions/worker/rest/api/FunctionsImpl.java   | 10 ++---
 .../functions/worker/FunctionActionerTest.java     |  2 +-
 pulsar-sql/presto-distribution/LICENSE             | 50 +--------------------
 22 files changed, 128 insertions(+), 153 deletions(-)

commit 355ebc55004d37c71e5ff36bcb415f7a7a212970
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Nov 2 18:01:26 2018 -0700

    Add state storage service url as part of internal configuration data (#2908)

 .../main/java/org/apache/pulsar/broker/PulsarService.java | 13 ++++++++++++-
 .../org/apache/pulsar/broker/admin/impl/BrokersBase.java  |  3 ++-
 .../java/org/apache/pulsar/broker/admin/AdminTest.java    |  3 ++-
 .../pulsar/common/conf/InternalConfigurationData.java     | 15 ++++++++++++---
 4 files changed, 28 insertions(+), 6 deletions(-)

commit 4e9971dfffb35f4b40fa0a75f072f6efc993fcf5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Nov 2 17:38:22 2018 -0700

    [state] Initialize bookkeeper table service metadata on initializing pulsar cluster metadata (#2706)
    
    
    *Motivation*
    
    This is the first set of changes to better integration with state storage.
    
    *Changes*
    
    - PulsarClusterMetadataSetup should initialize the metadata for bookkeeper table service
    - Move the common util functions to `StateUtils`
    - Delete state table on deleting functions

 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 17 +++++-
 .../functions/instance/JavaInstanceRunnable.java   | 25 +++++----
 .../apache/pulsar/functions/utils/StateUtils.java  | 40 +++++++++++++++
 .../pulsar/functions/worker/WorkerService.java     | 25 ++++++++-
 .../functions/worker/rest/api/FunctionsImpl.java   | 60 ++++++++++++++++++----
 5 files changed, 146 insertions(+), 21 deletions(-)

commit 468672404409ecf5e2c2206338494de00d3c95b3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Nov 2 17:02:03 2018 -0700

    Removed checked in examples jar and instead added mvn target to copy (#2913)
    
    ### Motivation
    
    Copy the required pulsar-examples jar by adding a maven rule rather than physically checking in.

 pulsar-broker/pom.xml                              |  27 +++++++++++++++++++++
 .../worker/PulsarWorkerAssignmentTest.java         |   4 +--
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |   8 +++---
 .../src/test/resources/pulsar-examples.jar         | Bin 38857 -> 0 bytes
 4 files changed, 33 insertions(+), 6 deletions(-)

commit 35cd182f3fab0663bead931cd0ff6a0d7ce72b33
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Nov 2 16:17:18 2018 -0700

    Added ability to take python zip files that contain all their dependencies (#2915)
    
    * Added ability to take python zip files that contain all their dependencies
    
    * Exit on failure

 .../src/main/python/python_instance_main.py        |  24 +++++++++++++++-
 pulsar-functions/python-examples/exclamation.zip   | Bin 0 -> 39311 bytes
 .../integration/functions/PulsarFunctionsTest.java |  32 ++++++++++++++-------
 .../functions/PulsarFunctionsTestBase.java         |  12 ++++++--
 4 files changed, 55 insertions(+), 13 deletions(-)

commit f36c43f3592ce451176a45076db2487260aaabe2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Nov 2 14:44:12 2018 -0700

    Move all validation/inferring missing args to serverside (#2907)
    
    * Move all validation/inferring missing args to serverside
    
    * Moved tests to serverside
    
    * Fixed all tests
    
    * Moved tests from admin to backend
    
    * remove unused var
    
    * Make it explicitly narclassloader
    
    * Dont copy nar files
    
    * Copy nar files
    
    * Some tests worjing
    
    * Do not mock ConnectorIo
    
    * Fix build
    
    * Some more enhancements to the tests
    
    * Ignore io packages in powermock
    
    * Fixed unittests
    
    * Remove unused stuff
    
    * Move changes from client side to serverside
    
    * More serverside tests
    
    * cleanup
    
    * Fixed unittests

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 257 ---------------------
 pulsar-client-tools/pom.xml                        |  34 +--
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  17 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  26 ---
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  26 ---
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  | 236 +------------------
 .../apache/pulsar/admin/cli/TestCmdSources.java    | 210 +----------------
 .../pulsar/functions/utils/SinkConfigUtils.java    |   8 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |   4 +-
 .../pulsar/functions/utils/io/ConnectorUtils.java  |   3 +-
 pulsar-functions/worker/pom.xml                    |  44 ++++
 .../functions/worker/rest/api/FunctionsImpl.java   |   5 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  96 +++++++-
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 138 ++++++++---
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 161 ++++++++++---
 15 files changed, 390 insertions(+), 875 deletions(-)

commit 08d8e252667fd64f5540f72c1144f4cbea855e05
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Nov 1 16:18:40 2018 -0700

    Rename id to path for better understanding (#2905)

 .../KubernetesSecretsProviderConfigurator.java                          | 2 +-
 .../KubernetesSecretsProviderConfiguratorTest.java                      | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 42c2b0affa32dec1632e7b03e7dd52565f86692b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Nov 1 12:01:02 2018 -0700

    Consolidate all inferMissing logic inside ConfigUtils. (#2904)
    
    * Consolidate all inferMissing logic inside ConfigUtils.
    
    * Removed tests that are already covered in windowconfigutils
    
    * Reverted unneeded change

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  53 +--
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  10 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  10 +-
 .../windowing/WindowFunctionExecutor.java          |   5 -
 .../pulsar/functions/windowing/WindowUtils.java    |  21 --
 .../windowing/WindowFunctionExecutorTest.java      | 375 +--------------------
 .../functions/utils/FunctionConfigUtils.java       |  48 +++
 .../pulsar/functions/utils/SinkConfigUtils.java    |  11 +
 .../pulsar/functions/utils/SourceConfigUtils.java  |  11 +
 .../pulsar/functions/utils/WindowConfigUtils.java  |  23 ++
 10 files changed, 97 insertions(+), 470 deletions(-)

commit cd63c8424051ef87918429dbf750dd89ede770c3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Nov 1 10:57:33 2018 -0700

    Changed secretsproviderconfigurator interface to pass v1podspec (#2903)

 .../pulsar/functions/runtime/KubernetesRuntime.java     |  9 +++++----
 .../pulsar/functions/runtime/ProcessRuntimeTest.java    |  3 ++-
 .../DefaultSecretsProviderConfigurator.java             |  4 ++--
 .../KubernetesSecretsProviderConfigurator.java          | 17 ++++++++++++-----
 .../SecretsProviderConfigurator.java                    |  4 ++--
 5 files changed, 23 insertions(+), 14 deletions(-)

commit 4def78d0ad5c0396955866c8b023d789c1b5d81d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Nov 1 09:06:41 2018 -0700

    Move WorkerInfo to commons (#2899)
    
    * Move WorkerInfo to commons
    
    * add back worker dep

 .../main/java/org/apache/pulsar/broker/admin/impl/FunctionsBase.java  | 3 ---
 .../src/test/java/org/apache/pulsar/io/PulsarFunctionAdminTest.java   | 4 ----
 .../src/main/java/org/apache/pulsar/client/admin/Worker.java          | 2 +-
 .../java/org/apache/pulsar/client/admin/internal/FunctionsImpl.java   | 2 +-
 .../main/java/org/apache/pulsar/client/admin/internal/WorkerImpl.java | 2 +-
 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctionWorker.java  | 2 +-
 .../src/main/java/org/apache/pulsar/common/functions}/WorkerInfo.java | 2 +-
 .../org/apache/pulsar/functions/worker/FunctionRuntimeManager.java    | 1 +
 .../java/org/apache/pulsar/functions/worker/MembershipManager.java    | 1 +
 .../java/org/apache/pulsar/functions/worker/rest/api/WorkerImpl.java  | 1 +
 .../org/apache/pulsar/functions/worker/MembershipManagerTest.java     | 3 +--
 .../java/org/apache/pulsar/functions/worker/SchedulerManagerTest.java | 2 +-
 12 files changed, 10 insertions(+), 15 deletions(-)

commit 40e6213bf8939752fe2c20e7818d133cdae56cd4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 31 18:02:55 2018 -0700

    Remove runtime dependency from pulsar-admin (#2892)
    
    * Move LocalRun inside Functions module. This eliminates function runtime dependency with pulsar-client
    
    * Removed unneeded stuff
    
    * Optimize changes
    
    * Fixed build
    
    * Fixed unittest

 bin/function-localrunner                           |  66 ++++++
 bin/pulsar-admin                                   | 124 +-----------
 bin/pulsar-admin-common.sh                         | 105 ++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 116 ++---------
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  28 ++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  28 ++-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |   2 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   2 +-
 .../pulsar/functions/runtime/LocalRunner.java      | 224 +++++++++++++++++++++
 9 files changed, 452 insertions(+), 243 deletions(-)

commit 37899671c21589a9a84845424f4ca2c404c123dc
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 31 16:46:42 2018 -0700

    Updating libpulsar Homebrew recipe to 2.2.0 (#2896)

 pulsar-client-cpp/homebrew/libpulsar.rb | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)

commit c1baa74ea56480a54d192486677f0f861ad297f1
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 31 16:11:44 2018 -0700

    Use unique test names in PartitionedProducerConsumerTest to avoid individual tests inter-dependencies (#2867)

 .../api/PartitionedProducerConsumerTest.java       | 27 ++++++++++++++--------
 1 file changed, 17 insertions(+), 10 deletions(-)

commit e72ed35cc2b07e2ec39b84a23ae1819d94b152f4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Oct 31 12:53:59 2018 -0700

    Issue #2890: Dependencies for using Pulsar in Storm topologies (#2893)
    
    * Issue #2890: Dependencies for using Pulsar in Storm topologies
    
    *Motivation*
    
    Fixes #2890
    
    The shading plugin used in pulsar-storm is promoting transitive dependencies
    to the dependency-reduced pom, which will mix pulsar-client and pulsar-client-original
    together in the classpath.
    
    *Changes*
    
    - disabled `promoteTransitiveDependencies` in pulsar-storm
    - remove shade plugin from pulsar-flink
    
    * don't exclude original, since pulsar-client pom will reduce the dependencies

 pulsar-flink/pom.xml | 29 -----------------------------
 pulsar-storm/pom.xml |  2 +-
 2 files changed, 1 insertion(+), 30 deletions(-)

commit 2591ccd22faba2c149ccc08b34e84d1d4c78ae96
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Oct 31 09:04:02 2018 +0800

    Add KeyValueSchema to satisfy org.apache.kafka.connect.connector.ConnectRecord (#2885)
    
    Kafka org.apache.kafka.connect.connector.ConnectRecord has both key and value schema.
    Currently we need a KeyValueSchema to achieve it and support debezium.
    There will be another PR to do the convert between KeyValueSchema and org.apache.kafka.connect.data.Schema.

 .../java/org/apache/pulsar/client/api/Schema.java  |  32 ++++++
 .../pulsar/client/impl/schema/KeyValueSchema.java  |  88 +++++++++++++++
 .../pulsar/client/schema/KeyValueSchemaTest.java   | 121 +++++++++++++++++++++
 .../org/apache/pulsar/common/schema/KeyValue.java  |  40 +++++++
 .../apache/pulsar/common/schema/SchemaType.java    |   7 +-
 .../io/kafka/connect/KafkaConnectSourceTest.java   |  14 ---
 6 files changed, 287 insertions(+), 15 deletions(-)

commit 649c6ca4eb83d340edfd4b431e0e4e68099d95f6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Oct 30 17:35:44 2018 -0700

    Hooked up secrets function api with secret function implementations (#2875)
    
    * Hooked up secrets function api with secret function implementations
    
    * Fixed unittest
    
    * Added more docs
    
    * Took feedback into account

 .../python/pulsar/functions/context.py             |  5 ++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  3 +-
 .../org/apache/pulsar/functions/api/Context.java   |  7 +++
 pulsar-functions/instance/pom.xml                  |  6 +++
 .../pulsar/functions/instance/ContextImpl.java     | 24 ++++++++-
 .../functions/instance/JavaInstanceRunnable.java   |  9 +++-
 .../instance/src/main/python/contextimpl.py        | 11 +++-
 .../instance/src/main/python/python_instance.py    |  5 +-
 .../src/main/python/python_instance_main.py        | 19 ++++++-
 .../instance/src/main/python/secretsprovider.py    | 61 +++++++++++++++++++++
 .../pulsar/functions/instance/ContextImplTest.java |  4 +-
 .../instance/JavaInstanceRunnableTest.java         |  2 +-
 .../src/test/python/test_python_instance.py        |  2 +-
 .../src/test/python/test_secretsprovider.py        | 54 +++++++++++++++++++
 pulsar-functions/runtime/pom.xml                   |  6 +++
 .../pulsar/functions/runtime/JavaInstanceMain.java | 35 +++++++++++-
 .../functions/runtime/KubernetesRuntime.java       | 24 ++++++++-
 .../runtime/KubernetesRuntimeFactory.java          | 19 ++++++-
 .../pulsar/functions/runtime/ProcessRuntime.java   | 15 +++++-
 .../functions/runtime/ProcessRuntimeFactory.java   |  7 ++-
 .../pulsar/functions/runtime/RuntimeUtils.java     | 10 ++++
 .../pulsar/functions/runtime/ThreadRuntime.java    |  7 ++-
 .../functions/runtime/ThreadRuntimeFactory.java    | 14 +++--
 .../functions/runtime/KubernetesRuntimeTest.java   | 15 +++---
 .../functions/runtime/ProcessRuntimeTest.java      | 63 ++++++++++++++++++++--
 .../functions/worker/FunctionRuntimeManager.java   | 21 ++++++--
 .../pulsar/functions/worker/WorkerConfig.java      |  8 ++-
 .../functions/worker/SchedulerManagerTest.java     | 21 ++++----
 28 files changed, 426 insertions(+), 51 deletions(-)

commit 0a7c64ba37e196fe666b52549100a261f78001f4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Oct 30 11:18:25 2018 -0700

    [zookeeper] remove hardcoded zookeeper session timeout (#2889)
    
    *Motivation*
    
    If zookeeper hostname resolution takes longer time (e.g. more than 10s).
    both initing cluster and starting broker will fail due to session timeout.
    
    *Changes*
    
    remove hardcoded zookeeper session timeout and make them take settings from configuration or arguments.

 .../java/org/apache/pulsar/PulsarClusterMetadataSetup.java   | 12 ++++++++++--
 .../org/apache/pulsar/zookeeper/GlobalZooKeeperCache.java    |  2 +-
 2 files changed, 11 insertions(+), 3 deletions(-)

commit 95f43851d9244f71d116a591430e238eca38c342
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 30 00:53:02 2018 -0700

    Upgrade jackson version to 2.9.7 (#2884)
    
    * Upgrade jackson version to 2.9.7
    
    * update license
    
    * fix license in presto-distribution
    
    * fix license

 distribution/server/src/assemble/LICENSE.bin.txt | 24 ++++----
 pom.xml                                          |  7 ++-
 pulsar-sql/pom.xml                               | 76 +++++++++++++++++++++++-
 pulsar-sql/presto-distribution/LICENSE           | 30 ++++------
 pulsar-sql/presto-distribution/pom.xml           | 61 ++++++++++++++++++-
 5 files changed, 163 insertions(+), 35 deletions(-)

commit c7e2197a7452729600a76204f1b2b00dabfd5c4b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 29 23:26:03 2018 -0700

    Upgrade commons-collections for Security Vulnerabilities[CVE-2015-7501] (#2886)
    
    * Upgrade commons-collections for Security Vulnerabilities[CVE-2015-7501]
    
    * fix license
    
    * fix license

 distribution/server/src/assemble/LICENSE.bin.txt | 2 +-
 pom.xml                                          | 7 +++++++
 pulsar-sql/presto-distribution/LICENSE           | 2 +-
 3 files changed, 9 insertions(+), 2 deletions(-)

commit aad73005c73975503f04596a082724adb17e389c
Author: Benjamin Huo <huobj@qq.com>
Date:   Tue Oct 30 04:00:00 2018 +0800

    Fix helm lint error for zookeeper-metadata.yaml (#2878)
    
    ### Motivation
    
    The following errors occurs when running :
    
    helm lint pulsar/
    ==> Linting pulsar/
    [INFO] Chart.yaml: icon is recommended
    [ERROR] templates/: render error in "pulsar/templates/zookeeper-metadata.yaml": template: pulsar/templates/zookeeper-metadata.yaml:49:20: executing "pulsar/templates/zookeeper-metadata.yaml" at <.Values.zookeeper_me...>: can't evaluate field resources in type interface {}
    
    ### Modifications
    
    Change  zookeeper_metadata in deployment/kubernetes/helm/pulsar/templates/zookeeper-metadata.yaml to zookeeperMetadata
    
    ### Result
    
    helm lint pulsar/
    ==> Linting pulsar/
    [INFO] Chart.yaml: icon is recommended
    
    1 chart(s) linted, no failures

 deployment/kubernetes/helm/pulsar/templates/zookeeper-metadata.yaml | 4 ++--
 deployment/kubernetes/helm/pulsar/values.yaml                       | 1 +
 2 files changed, 3 insertions(+), 2 deletions(-)

commit f7a91a195cc4715fe3950031241f0b64d2381c1d
Author:  <quiye@users.noreply.github.com>
Date:   Tue Oct 30 01:18:56 2018 +0900

    Fixed python websocket client sample code (#2881)

 site2/docs/client-libraries-websocket.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d13fe5bc287d2bc082da1682703d01dc92140a3b
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Mon Oct 29 14:41:36 2018 +0800

    Debezium: integrate KafkaConnectSource with MySqlConnectorTask (#2791)
    
    ### Motivation
    This change is to integrate KafkaConnectSource with MySqlConnectorTask.
    Steps to run this is like this:
    1, use image in debezium tutorial, start mysql server
    ```docker run -it --rm --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=debezium -e MYSQL_USER=mysqluser -e MYSQL_PASSWORD=mysqlpw debezium/example-mysql:0.8```
    
    2, start pulsar standalone
    ```bin/pulsar standalone  ```
    
    3,  start consume data from connect source target topic, After step 4 is start, it should get data.
    ```bin/pulsar-client consume -s "my-sub-name" kafka-connect-topic -n 0```
    
    4, start source connect, It should produce data into Pulsar topics.
     ```bin/pulsar-admin source localrun --tenant public --namespace default --name kafka  --destination-topic-name  kafka-connect-topic --sourceConfigFile  debezium-mysql-source-config.yaml  --archive connectors/pulsar-io-kafka-connect-adaptor-2.2.0-SNAPSHOT.nar --brokerServiceUrl pulsar://127.0.0.1:6650```

 distribution/io/src/assemble/io.xml                |  6 +++
 pom.xml                                            |  2 +-
 pulsar-io/debezium/pom.xml                         |  8 ++--
 .../pulsar/io/debezium/PulsarDatabaseHistory.java  |  2 +-
 pulsar-io/kafka-connect-adaptor/pom.xml            | 22 ++++++++++
 .../io/kafka/connect/KafkaConnectSource.java       | 27 +++++++++---
 .../resources/META-INF/services/pulsar-io.yaml     | 22 ++++++++++
 .../resources/debezium-mysql-source-config.yaml    | 51 ++++++++++++++++++++++
 .../io/kafka/connect/KafkaConnectSourceTest.java   |  6 +--
 9 files changed, 131 insertions(+), 15 deletions(-)

commit 5fa83b81345a3460464d49d95e47f8d487b773c3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Oct 28 23:38:13 2018 -0700

    Fixing function latency metric arithmetic error (#2868)

 .../main/java/org/apache/pulsar/functions/instance/FunctionStats.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b990e1a97346380f96caa9efc2e70cbc5eeeb360
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Oct 28 17:49:51 2018 -0700

    Fixed ZLib decompression in C++ client (#2854)
    
    * Fixed ZLib decompression in C++ client
    
    * Make symbol visible for unit tests
    
    * Also include namespace into pragma directive
    
    * Also expose symbols for CompressionCodec

 pulsar-client-cpp/lib/CompressionCodec.h       |  5 ++
 pulsar-client-cpp/lib/CompressionCodecZLib.cc  | 47 +++++++++++++++----
 pulsar-client-cpp/lib/CompressionCodecZLib.h   |  6 +++
 pulsar-client-cpp/perf/PerfProducer.cc         | 13 ++++++
 pulsar-client-cpp/tests/ZLibCompressionTest.cc | 65 ++++++++++++++++++++++++++
 5 files changed, 126 insertions(+), 10 deletions(-)

commit 6a511090cb7e2f7ffda28247bba11f02d24af36d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Oct 28 15:16:59 2018 -0700

    Remove metrics from getstatus in python functions (#2873)

 pulsar-functions/instance/src/main/python/python_instance.py | 1 -
 1 file changed, 1 deletion(-)

commit 1aff3c4cdc60ec81b0230289944a97cb1db4d683
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Oct 28 07:59:03 2018 -0700

    Secretprovider interfaces and some default implementations (#2855)
    
    * Added SecretProvider and SecretProviderConfigurator interfaces and some implementations
    
    * Added appropriate documentation
    
    * Added validation logic to config provider configurator
    
    * Added more comments
    
    * Took feedback into account

 .../pulsar/common/functions/FunctionConfig.java    |   3 +-
 .../org/apache/pulsar/common/io/SinkConfig.java    |   3 +-
 .../org/apache/pulsar/common/io/SourceConfig.java  |   3 +-
 pulsar-functions/pom.xml                           |   1 +
 pulsar-functions/secrets/pom.xml                   |  54 ++++++++++
 .../secretsprovider/ClearTextSecretsProvider.java  |  38 +++++++
 .../EnvironmentBasedSecretsProvider.java           |  35 +++++++
 .../functions/secretsprovider/SecretsProvider.java |  40 ++++++++
 .../DefaultSecretsProviderConfigurator.java        |  67 ++++++++++++
 .../KubernetesSecretsProviderConfigurator.java     | 113 +++++++++++++++++++++
 .../SecretsProviderConfigurator.java               |  72 +++++++++++++
 .../ClearTextSecretsProviderTest.java              |  37 +++++++
 .../EnvironmentBasedSecretsProviderTest.java       |  75 ++++++++++++++
 .../KubernetesSecretsProviderConfiguratorTest.java |  62 +++++++++++
 14 files changed, 600 insertions(+), 3 deletions(-)

commit 4c44a8cba032812d475c186405e3bf55d0433bc3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Oct 28 07:57:53 2018 -0700

    Removed metrics from getstatus (#2866)

 .../src/test/java/org/apache/pulsar/io/PulsarFunctionE2ETest.java | 5 ++---
 pulsar-functions/proto/src/main/proto/InstanceCommunication.proto | 2 +-
 .../java/org/apache/pulsar/functions/runtime/ThreadRuntime.java   | 8 +-------
 3 files changed, 4 insertions(+), 11 deletions(-)

commit dc397b09709719087c77390dc6328f3b6d35d944
Author: tuteng <eguangning@gmail.com>
Date:   Sun Oct 28 13:57:37 2018 +0800

    class ActiveBroker don't attribute url, use url of class Broker (#2871)

 dashboard/django/stats/models.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d9e7c926174dba151fcc4a539f83648ba3e78e18
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Oct 27 20:44:12 2018 -0700

    Update WorkerConfig.java (#2870)

 .../main/java/org/apache/pulsar/functions/worker/WorkerConfig.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit fc8873c6b2a14a28cb88003f3196ee3fe3a5d483
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Oct 27 16:23:13 2018 -0700

    Change java function instance logs to flush immediately (#2864)

 pulsar-functions/runtime/src/main/resources/java_instance_log4j2.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6ef687912c58e0765d7bbaa057d743c6ed1f9bec
Author:  <quiye@users.noreply.github.com>
Date:   Sat Oct 27 23:07:18 2018 +0900

    Fixed mail address typo on contact page (#2861)

 site2/website/pages/en/contact.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 5c1b3a79061b4771f43c51d0152b22f28742b75b
Author: legendtkl <taokelu@gmail.com>
Date:   Sat Oct 27 22:06:54 2018 +0800

    fix typo  in architecture docs (#2862)
    
    fix typo in architecture docs

 site/docs/latest/getting-started/ConceptsAndArchitecture.md             | 2 +-
 site2/docs/concepts-architecture-overview.md                            | 2 +-
 .../version-2.1.0-incubating/concepts-architecture-overview.md          | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 91dc135913b2f67eafb4f1f41f3103e42ecaa1db
Author: Yuvaraj L <uvaraj6@gmail.com>
Date:   Sat Oct 27 13:51:55 2018 +0530

    Fixed Typo (#2859)

 site2/docs/functions-overview.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c518247d873bfe07364359e5f63f5fd7f689c0e9
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Sat Oct 27 14:09:27 2018 +0900

    Fix memory issue in cpp ZTSClient (#2814)
    
    ### Modifications
    
    * Use `calloc` instead of `malloc` in order to add Termination character(`\0`).
    * Free memory allocated with `calloc` and `PEM_read_bio_RSAPrivateKey`.

 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 34 +++++++++++++++++++++-----
 1 file changed, 28 insertions(+), 6 deletions(-)

commit 2d208c565e3bd25a1cc12d904f72b91f96ec6cab
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 26 22:07:54 2018 -0700

    Added ability for the kubernetes to poll a configmap to look out for changes (#2856)
    
    ### Motivation
    While running functions worker in kubernetes, it might be hard to update any kind of config of the worker without killing it. This pr allows certain properties of the functions to be stored in a configmap. The KubernetesRuntime Factory will keep an eye for any changes and apply the changes on the fly dramatically simplifying any config updates

 .../runtime/KubernetesRuntimeFactory.java          | 126 +++++++++++++++------
 .../functions/runtime/KubernetesRuntimeTest.java   |   4 +-
 .../functions/worker/FunctionRuntimeManager.java   |   4 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   5 +
 4 files changed, 101 insertions(+), 38 deletions(-)

commit eb747c48e44ae7861771565c8e46f8ed6c8d6e48
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 26 22:06:42 2018 -0700

    Reduce memory reserved for prometheus (#2857)

 .../java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 82b267ba9d59fa677d5b4fdcc48e38de6c59dee9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 26 14:49:44 2018 -0700

    Secrets Frontend (#2853)
    
    * Secrets Frontend
    
    * Do not expose secrets in cli

 .../pulsar/common/functions/FunctionConfig.java    |  5 ++
 .../org/apache/pulsar/common/io/SinkConfig.java    |  5 ++
 .../org/apache/pulsar/common/io/SourceConfig.java  |  5 ++
 .../instance/src/main/python/Function_pb2.py       | 76 ++++++++++++----------
 .../proto/src/main/proto/Function.proto            |  1 +
 .../functions/utils/FunctionConfigUtils.java       | 10 +++
 .../pulsar/functions/utils/SinkConfigUtils.java    |  8 +++
 .../pulsar/functions/utils/SourceConfigUtils.java  |  9 +++
 8 files changed, 85 insertions(+), 34 deletions(-)

commit d79499dbe24fbd8b065489875ba86a47761ec33f
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Sat Oct 27 02:53:09 2018 +0900

    Fix Websocket Consume Messages in Partitioned Topics (#2829)
    
    * fix consume messages in partitioned topics on websocket
    
    * add consumeMessagesInPartitionedTopicTest
    
    * add fromByteArrayWithTopic
    
    * remove public

 .../websocket/proxy/ProxyPublishConsumeTest.java   | 43 +++++++++++++++++++++-
 .../org/apache/pulsar/client/api/MessageId.java    |  5 +++
 .../apache/pulsar/client/impl/MessageIdImpl.java   | 31 ++++++++++++++++
 .../apache/pulsar/websocket/ConsumerHandler.java   |  3 +-
 4 files changed, 80 insertions(+), 2 deletions(-)

commit 1a1cf226a718fbaece393e8e1ed9584b59a8752b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Oct 26 10:14:01 2018 -0700

    adding Python function instance unit test (#2850)
    
    * adding python function instance unittests
    
    * adding license headers

 bin/pulsar                                         |  2 +-
 bin/pulsar-admin                                   |  2 +-
 distribution/server/src/assemble/bin.xml           |  2 +-
 pulsar-client-cpp/run-unit-tests.sh                |  4 ++
 pulsar-functions/instance/pom.xml                  | 31 ++++++++++++
 .../src/scripts/run_python_instance_tests.sh       | 30 +++++++++++
 .../src/test/python/test_python_instance.py        | 58 ++++++++++++++++++++++
 pulsar-functions/runtime/pom.xml                   | 28 -----------
 8 files changed, 126 insertions(+), 31 deletions(-)

commit fa212bc8bb0cbd81729b498b6041cde794be9684
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 26 10:13:39 2018 -0700

    Cleanup Logging for python functions (#2847)
    
    * Cleanup Logging for python functions
    
    * More statements to debug
    
    * More debug statements
    
    * More debug

 .../instance/src/main/python/python_instance.py    |  8 ++---
 .../instance/src/main/python/server.py             |  8 ++---
 pulsar-functions/instance/src/main/python/util.py  | 37 ++++++++++------------
 3 files changed, 24 insertions(+), 29 deletions(-)

commit 138c863af0a43bd3423a7f3fb3846d2cb8dfe472
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 26 02:57:03 2018 -0700

    Use the right field to get the filename (#2851)

 .../org/apache/pulsar/functions/worker/rest/api/FunctionsImpl.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit b8679078dc6632795c4d81cff9caedd316444f17
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 26 02:56:45 2018 -0700

    Make IdentitySerde handle bytes as well (#2848)
    
    * Make IdentitySerde handle bytes as well
    
    * Added more information about type of object passed

 pulsar-client-cpp/python/pulsar/functions/serde.py | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 000cc22277563c208237ea2bb6ae1ca53435d88f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 25 23:35:06 2018 -0700

    Fix: schema init for topic-name with special char (#2836)
    
    * Fix: schema init for topic-name with special char
    
    create namespace before starting test
    
    fix test
    
    * fix child test

 .../broker/service/BrokerBkEnsemblesTests.java     | 32 ++++++++++++++++++++--
 .../pulsar/broker/service/RackAwareTest.java       |  5 ++++
 .../org/apache/pulsar/common/naming/TopicName.java |  2 +-
 3 files changed, 36 insertions(+), 3 deletions(-)

commit 5bdcdc584834714b7c660cbad84d748ec7b98fee
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Oct 26 15:34:52 2018 +0900

    Make proxy advertise protocol version of client to broker (#2845)
    
    * Make proxy advertise protocol version of client to broker
    
    * Revert incorrect change

 .../org/apache/pulsar/client/impl/ClientCnx.java   | 10 +++-
 .../org/apache/pulsar/common/api/Commands.java     |  1 -
 .../pulsar/proxy/server/DirectProxyHandler.java    | 13 +++--
 .../apache/pulsar/proxy/server/ProxyClientCnx.java | 40 ++++++++-------
 .../pulsar/proxy/server/ProxyConnection.java       | 28 ++++++++---
 .../org/apache/pulsar/proxy/server/ProxyTest.java  | 58 ++++++++++++++++++++++
 6 files changed, 117 insertions(+), 33 deletions(-)

commit b797d7b9b416d21cff45e3b8f236edc18ac3a97e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Oct 25 23:34:39 2018 -0700

    fixing/adding sql docs to correct locations (#2849)

 site2/docs/sql-deployment-configurations.md        | 152 ++++++++++++++++++++
 site2/docs/sql-getting-started.md                  | 142 +++++++++++++++++++
 site2/docs/sql-overview.md                         |  24 ++++
 site2/website/sidebars.json                        |   5 +
 .../version-2.2.0/sql-deployment-configurations.md | 153 +++++++++++++++++++++
 .../version-2.2.0/sql-getting-started.md           | 143 +++++++++++++++++++
 .../versioned_docs/version-2.2.0/sql-overview.md   |  25 ++++
 .../versioned_sidebars/version-2.2.0-sidebars.json | 121 ++++++++++++++++
 8 files changed, 765 insertions(+)

commit 519cbe905ef2f53cb51ac0cc136a912c2ef8a18f
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 25 23:06:50 2018 -0700

    Add "dashboard" to list of modules so that pom version gets auto updated (#2838)
    
    * Add "dashboard" to list of modules so that pom version gets auto updated
    
    * Fixed version
    
    * Fixed license exclusion for dashboard

 dashboard/pom.xml | 2 +-
 pom.xml           | 5 +++--
 2 files changed, 4 insertions(+), 3 deletions(-)

commit 3f6612c986549fcf38df8f807488f790e27dc63a
Author: chrismiller <chris@redyeti.net>
Date:   Thu Oct 25 23:31:26 2018 +0100

    Fixed a broken link (#2846)

 site2/website/release-notes.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a9a7f30f0e8887a43b283b4aa22670b8f61ee00a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 25 13:43:04 2018 -0700

    Set function resources properly (#2841)
    
    * Set function resources properly
    
    * Added unittests

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 187 +++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  17 +-
 2 files changed, 203 insertions(+), 1 deletion(-)

commit 1026edcbe0eefefb61acb7a30731efdb6865b1a1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 25 06:46:52 2018 -0700

    Handle builtin/functionpkgurl properly in externally managed schedulers (#2840)
    
    * Handle builtin/functionpkgurl properly in externally managed schedulers
    
    * Correct filename
    
    * Handle giving out the right location for function pacakge
    
    * Reverted changes
    
    * Fixed unittest

 .../org/apache/pulsar/functions/utils/Utils.java   |  19 ++--
 .../pulsar/functions/worker/FunctionActioner.java  |  36 +++----
 .../org/apache/pulsar/functions/worker/Utils.java  |  12 +--
 .../functions/worker/rest/api/FunctionsImpl.java   | 109 ++++++++++++++-------
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  16 +--
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  |  65 ++++++------
 .../rest/api/v2/SourceApiV2ResourceTest.java       |  64 ++++++------
 7 files changed, 180 insertions(+), 141 deletions(-)

commit 30351edf769ebfde6e823971d5ed16b1d054806c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Oct 25 04:55:59 2018 -0700

    fix python functions context publish (#2844)

 pulsar-functions/instance/src/main/python/contextimpl.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6a79a9af325b2574c98b5f88cda5ba67fcf73dd5
Author: penghui <codelipenghui@gmail.com>
Date:   Thu Oct 25 13:48:31 2018 +0800

    Check partitioned topics in namespace when delete the namespace #2822 (#2833)
    
    * Fix issue-2822
    
    * Add UT and replace string to TopicDomain
    
    * Add missing import
    
    * Fix import

 .../apache/pulsar/broker/admin/AdminResource.java  | 25 +++++++++++++++++++++-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  5 ++++-
 .../broker/admin/impl/PersistentTopicsBase.java    | 20 +----------------
 .../apache/pulsar/broker/admin/NamespacesTest.java | 22 +++++++++++--------
 4 files changed, 42 insertions(+), 30 deletions(-)

commit 9c43205dc49ae35b742143eadceefec343bfb743
Author: joefk <22042978+joefk@users.noreply.github.com>
Date:   Wed Oct 24 22:46:04 2018 -0700

    Update release-notes.md (#2843)

 site2/website/release-notes.md | 37 +++++++++++++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)

commit f0e9bee7cf8347e663f149ba7fe746f9bbd00cd9
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Oct 24 18:27:42 2018 -0700

    Adding option to use TLS in broker admin client. (#2831)

 conf/broker.conf                                   |   7 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  19 ++-
 .../org/apache/pulsar/broker/PulsarService.java    |  18 ++-
 .../pulsar/broker/service/BrokerService.java       |   2 +-
 .../broker/admin/BrokerAdminClientTlsAuthTest.java | 164 +++++++++++++++++++++
 .../pulsar/broker/service/ReplicatorTlsTest.java   |   6 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |   3 +-
 7 files changed, 202 insertions(+), 17 deletions(-)

commit 33d89aad5aa749704fcf75133a9a659dd9d5a6d3
Author: Junjie Qian <jqian.unl@gmail.com>
Date:   Wed Oct 24 16:38:07 2018 -0700

    Fix the document format in example/flink-consumer-source (#2839)

 examples/flink-consumer-source/README.md | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

commit 0682f1ccc2c08db436054b1f6aab8b4b59b738d4
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Oct 24 16:23:14 2018 -0700

    Site Update for Pulsar 2.2.0 Release (#2837)

 site2/website/releases.json                        |    1 +
 .../versioned_docs/version-2.2.0/adaptors-kafka.md |  262 +++
 .../versioned_docs/version-2.2.0/adaptors-spark.md |   67 +
 .../versioned_docs/version-2.2.0/adaptors-storm.md |  105 ++
 .../version-2.2.0/client-libraries-cpp.md          |  184 ++
 .../version-2.2.0/client-libraries-go.md           |  462 +++++
 .../version-2.2.0/client-libraries-python.md       |   95 ++
 .../version-2.2.0/client-libraries-websocket.md    |  410 +++++
 .../version-2.2.0/cookbooks-tiered-storage.md      |  221 +++
 .../versioned_docs/version-2.2.0/deploy-aws.md     |  227 +++
 .../deploy-bare-metal-multi-cluster.md             |  409 +++++
 .../version-2.2.0/deploy-bare-metal.md             |  357 ++++
 .../versioned_docs/version-2.2.0/deploy-dcos.md    |  183 ++
 .../version-2.2.0/developing-binary-protocol.md    |  553 ++++++
 .../versioned_docs/version-2.2.0/developing-cpp.md |  101 ++
 .../version-2.2.0/developing-load-manager.md       |  215 +++
 .../version-2.2.0/developing-schema.md             |   58 +
 .../versioned_docs/version-2.2.0/functions-api.md  |  721 ++++++++
 .../version-2.2.0/functions-deploying.md           |  227 +++
 .../version-2.2.0/functions-guarantees.md          |   42 +
 .../version-2.2.0/functions-overview.md            |  452 +++++
 .../version-2.2.0/functions-quickstart.md          |  266 +++
 .../version-2.2.0/getting-started-clients.md       |   58 +
 .../version-2.2.0/getting-started-standalone.md    |  198 +++
 .../versioned_docs/version-2.2.0/io-managing.md    |  162 ++
 .../versioned_docs/version-2.2.0/io-overview.md    |   40 +
 .../versioned_docs/version-2.2.0/io-quickstart.md  |  400 +++++
 .../version-2.2.0/reference-configuration.md       |  468 +++++
 .../version-2.2.0/reference-pulsar-admin.md        | 1799 ++++++++++++++++++++
 .../version-2.2.0/security-extending.md            |  207 +++
 .../version-2.2.0/security-tls-transport.md        |  211 +++
 site2/website/versions.json                        |    1 +
 32 files changed, 9162 insertions(+)

commit db131d2904c43ef11f712935ed7aebaff412cbc1
Author: ybb1798 <ybb1798@hotmail.com>
Date:   Thu Oct 25 06:27:13 2018 +0800

    '#2823' (#2835)

 site2/website/pages/en/download.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 203c8ee2b576704803135ddb18c2699322917c36
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Oct 24 11:14:48 2018 -0500

    Allow Python functions logging to be more configurable (#2832)
    
    * allow python functions logging to be configured using config files
    
    * adding license headers
    
    * fix log file
    
    * changing config file name
    
    * fix unittests

 conf/functions-logging/console_logging_config.ini  | 41 ++++++++++++++++
 conf/functions-logging/logging_config.ini          | 41 ++++++++++++++++
 pulsar-functions/instance/src/main/python/log.py   | 55 +++++++++++-----------
 .../src/main/python/python_instance_main.py        |  4 +-
 .../functions/runtime/KubernetesRuntime.java       | 13 ++++-
 .../pulsar/functions/runtime/ProcessRuntime.java   | 11 ++++-
 .../pulsar/functions/runtime/RuntimeUtils.java     |  7 ++-
 .../functions/runtime/KubernetesRuntimeTest.java   |  5 +-
 .../functions/runtime/ProcessRuntimeTest.java      |  8 ++--
 9 files changed, 144 insertions(+), 41 deletions(-)

commit 4a42a60a7f24439dbd7ba900dacddfd0be7ece1e
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Oct 23 18:54:06 2018 -0700

    Python3 strings are not bytes (#2827)

 pulsar-functions/instance/src/main/python/log.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c1dc39b628fe5c7f2f4e77c261c86be45122176d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 23 17:51:06 2018 -0700

    Support admin-api for subscription-name with wildcard char (#2809)

 .../pulsar/broker/admin/v1/PersistentTopics.java   | 33 +++++++++++-----------
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 33 +++++++++++-----------
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 29 ++++++++++---------
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  4 +--
 4 files changed, 51 insertions(+), 48 deletions(-)

commit 3db8b7392b1be22544117ea336dd46cc85c61ba0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Oct 23 17:28:04 2018 -0700

    Allow the ability to specify which artifactory to download dep from (#2824)
    
    * Allow the ability to specify which artifactory to download dep from
    
    * reverted earlier changes
    
    * Made python dependency repository a config of k8runtime
    
    * Fixed unittest
    
    * Added extra dependency
    
    * Fixed cmd lines

 .../instance/src/main/python/python_instance_main.py        | 11 ++++++++++-
 .../apache/pulsar/functions/runtime/KubernetesRuntime.java  |  5 ++++-
 .../pulsar/functions/runtime/KubernetesRuntimeFactory.java  |  8 ++++++++
 .../org/apache/pulsar/functions/runtime/ProcessRuntime.java |  2 +-
 .../org/apache/pulsar/functions/runtime/RuntimeUtils.java   | 13 ++++++++++++-
 .../pulsar/functions/runtime/KubernetesRuntimeTest.java     |  8 +++++---
 .../pulsar/functions/worker/FunctionRuntimeManager.java     |  2 ++
 .../org/apache/pulsar/functions/worker/WorkerConfig.java    |  2 ++
 8 files changed, 44 insertions(+), 7 deletions(-)

commit 5b3d50ddc6620a6ccb8fb52dd53b50c4f337083a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Oct 23 16:07:19 2018 -0700

    Remove annoying error message. (#2825)

 .../java/org/apache/pulsar/functions/instance/JavaInstanceRunnable.java  | 1 -
 1 file changed, 1 deletion(-)

commit aad9a001f03fe2206a276030953dfc3bd55a81ad
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Oct 23 09:20:33 2018 -0700

    Moved FunctionConfig/SourceConfig/SinkConfig to a more common location (#2818)

 .../pulsar/functions/worker/PulsarWorkerAssignmentTest.java   |  2 +-
 .../test/java/org/apache/pulsar/io/PulsarFunctionE2ETest.java |  3 +--
 .../test/java/org/apache/pulsar/io/PulsarFunctionTlsTest.java |  2 +-
 .../main/java/org/apache/pulsar/client/admin/Functions.java   |  2 +-
 .../src/main/java/org/apache/pulsar/client/admin/Sink.java    |  2 +-
 .../src/main/java/org/apache/pulsar/client/admin/Source.java  |  2 +-
 .../apache/pulsar/client/admin/internal/FunctionsImpl.java    |  2 +-
 .../org/apache/pulsar/client/admin/internal/SinkImpl.java     |  2 +-
 .../org/apache/pulsar/client/admin/internal/SourceImpl.java   |  2 +-
 .../java/org/apache/pulsar/admin/cli/CmdFunctionsTest.java    |  5 +----
 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java   |  5 ++++-
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java   |  7 +++++--
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java |  9 +++++----
 .../test/java/org/apache/pulsar/admin/cli/TestCmdSinks.java   |  3 +++
 .../test/java/org/apache/pulsar/admin/cli/TestCmdSources.java |  3 +++
 .../org/apache/pulsar/common/functions}/ConsumerConfig.java   |  2 +-
 .../org/apache/pulsar/common/functions}/FunctionConfig.java   |  5 ++++-
 .../java/org/apache/pulsar/common/functions}/Resources.java   |  2 +-
 .../org/apache/pulsar/common/functions}/WindowConfig.java     |  2 +-
 .../main/java/org/apache/pulsar/common/io}/SinkConfig.java    |  5 ++++-
 .../main/java/org/apache/pulsar/common/io}/SourceConfig.java  |  4 +++-
 .../pulsar/functions/instance/JavaInstanceRunnable.java       |  4 ++--
 .../java/org/apache/pulsar/functions/sink/PulsarSink.java     |  2 +-
 .../org/apache/pulsar/functions/sink/PulsarSinkConfig.java    |  2 +-
 .../java/org/apache/pulsar/functions/source/PulsarSource.java |  2 +-
 .../apache/pulsar/functions/source/PulsarSourceConfig.java    |  4 ++--
 .../pulsar/functions/windowing/WindowFunctionExecutor.java    |  2 +-
 .../org/apache/pulsar/functions/windowing/WindowUtils.java    |  2 +-
 .../java/org/apache/pulsar/functions/sink/PulsarSinkTest.java |  5 +----
 .../org/apache/pulsar/functions/source/PulsarSourceTest.java  |  6 ++----
 .../functions/windowing/WindowFunctionExecutorTest.java       |  2 +-
 .../apache/pulsar/functions/utils/FunctionConfigUtils.java    |  4 ++++
 .../apache/pulsar/functions/utils/ResourceConfigUtils.java    |  2 ++
 .../org/apache/pulsar/functions/utils/SinkConfigUtils.java    |  4 ++++
 .../org/apache/pulsar/functions/utils/SourceConfigUtils.java  |  2 ++
 .../main/java/org/apache/pulsar/functions/utils/Utils.java    |  2 +-
 .../org/apache/pulsar/functions/utils/WindowConfigUtils.java  |  2 ++
 .../pulsar/functions/utils/FunctionConfigUtilsTest.java       |  2 ++
 .../apache/pulsar/functions/utils/SinkConfigUtilsTest.java    |  3 +++
 .../apache/pulsar/functions/utils/SourceConfigUtilsTest.java  |  2 ++
 .../apache/pulsar/functions/utils/WindowConfigUtilsTest.java  | 11 +----------
 .../pulsar/functions/worker/rest/api/FunctionsImpl.java       |  3 +++
 .../worker/rest/api/v2/FunctionApiV2ResourceTest.java         |  2 +-
 .../functions/worker/rest/api/v2/SinkApiV2ResourceTest.java   |  3 +--
 .../functions/worker/rest/api/v2/SourceApiV2ResourceTest.java |  2 +-
 45 files changed, 86 insertions(+), 60 deletions(-)

commit 0e08b6a0f0206f12785f5e0a7ad8b6693b387857
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Oct 23 15:47:19 2018 +0200

    Add http output buffer configuration to proxy (#2815)
    
    This controls the amount of data the http proxy will buffer before flushing
    to the client. Setting this to something very low facilitates
    streaming usecases with the reverse proxy.

 conf/proxy.conf                                    |   7 ++
 .../pulsar/proxy/server/ProxyConfiguration.java    |  17 +++
 .../org/apache/pulsar/proxy/server/WebServer.java  |   7 +-
 .../pulsar/proxy/server/ProxyIsAHttpProxyTest.java | 131 +++++++++++++++++++++
 4 files changed, 161 insertions(+), 1 deletion(-)

commit f0a81cb7b38d16f0901451a43ac8c2aa569639b7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 22 22:57:55 2018 -0700

    Add a simple log4j configuration for PrometheusMetricsServer (#2819)
    
    * Added a simple log4j configuration for PrometheusMetricsServer
    
    * Fixed compile
    
    * Fix header

 .../resources/prometheus_metricsserver_log4j2.yml  | 29 ++++++++++++++++++++++
 .../functions/runtime/KubernetesRuntime.java       |  1 +
 2 files changed, 30 insertions(+)

commit c7c769654e583082f78482179380ec8cc4246088
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 22 22:57:26 2018 -0700

    Specify default for cpu/ram/disk (#2820)
    
    * Specify default for cpu/ram/disk
    
    * Removed tests that no longer make sense

 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  | 66 ----------------------
 .../apache/pulsar/admin/cli/TestCmdSources.java    | 57 -------------------
 .../apache/pulsar/functions/utils/Resources.java   |  9 ++-
 3 files changed, 6 insertions(+), 126 deletions(-)

commit 75d9fe2eeed76e7e085757e3facf0ee3db54959e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Oct 22 19:07:29 2018 -0500

    Logs should be output to stdout when running functions in Kubernetes (#2817)
    
    * Logs should be ouputted to stdout when running functions in Kubernetes
    
    * fix unittest
    
    * adding space

 .../functions/runtime/KubernetesRuntime.java       |  2 +-
 .../main/resources/kubernetes_instance_log4j2.yml  | 53 ++++++++++++++++++++++
 .../functions/runtime/KubernetesRuntimeTest.java   |  2 +-
 3 files changed, 55 insertions(+), 2 deletions(-)

commit 32d1dafdb4f77bf241c8786d067734a4bebdd4cf
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 22 11:12:40 2018 -0700

    Removed Validation Annotations and do manual Validation (#2813)
    
    * Added Get and List source/sink functionality
    
    * Fixed compile
    
    * Removed test that doesnt make sense any more
    
    * Fixed build
    
    * Fixed logic
    
    * Return error response
    
    * Return response on error
    
    * Fix unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Added get/list sinks tests
    
    * Added get/list tests
    
    * Add more unittests
    
    * Added more unittests
    
    * Added TODO
    
    * Took feedback
    
    * Fix unittest
    
    * Fix unittest
    
    * Fix unittest
    
    * Fixed integration tests
    
    * Fixed integration test
    
    * Added restart/stop functionality to the sources/sinks
    
    * Added getstatus method to sources/sink
    
    * Fix integration tests
    
    * Do Explicit Validation of Configs instead of annotations
    
    * Remove all annotations from config files
    
    * Removed validator related classes
    
    * Removed unused imports
    
    * Fix check logic
    
    * fix compilation
    
    * Fix unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Validator tests should be done elsewhere
    
    * Added unittest
    
    * Fixed unittest

 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |   7 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  57 +-
 .../src/test/resources/dummyexamples.jar           | Bin 0 -> 342 bytes
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  62 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  56 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  60 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  23 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |  27 +-
 .../windowing/WindowFunctionExecutor.java          |   2 -
 .../windowing/WindowFunctionExecutorTest.java      |  26 +-
 .../pulsar/functions/utils/FunctionConfig.java     |  34 -
 .../functions/utils/FunctionConfigUtils.java       | 242 ++++-
 .../apache/pulsar/functions/utils/Reflections.java |  19 +-
 .../Validator.java => ResourceConfigUtils.java}    |  23 +-
 .../apache/pulsar/functions/utils/SinkConfig.java  |  24 -
 .../pulsar/functions/utils/SinkConfigUtils.java    | 111 ++-
 .../pulsar/functions/utils/SourceConfig.java       |  17 -
 .../pulsar/functions/utils/SourceConfigUtils.java  |  57 ++
 .../org/apache/pulsar/functions/utils/Utils.java   | 131 ++-
 .../pulsar/functions/utils/ValidatorUtils.java     | 139 +++
 .../pulsar/functions/utils/WindowConfigUtils.java  |  76 ++
 .../utils/validation/ConfigValidation.java         | 174 ----
 .../validation/ConfigValidationAnnotations.java    | 248 ------
 .../utils/validation/ConfigValidationUtils.java    | 177 ----
 .../functions/utils/validation/ValidatorImpls.java | 975 ---------------------
 .../apache/pulsar/functions/utils/UtilsTest.java   |  64 ++
 .../functions/utils/WindowConfigUtilsTest.java     | 294 +++++++
 .../org/apache/pulsar/functions/worker/Utils.java  |  88 --
 .../functions/worker/rest/api/FunctionsImpl.java   | 127 +--
 .../apache/pulsar/functions/worker/UtilsTest.java  |  37 -
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   4 +-
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  |   2 +-
 .../rest/api/v2/SourceApiV2ResourceTest.java       |   2 +-
 33 files changed, 1249 insertions(+), 2136 deletions(-)

commit b73a967a846e7a748b8d560e36851afcb7a414aa
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Oct 22 13:17:48 2018 +0200

    Bump jetty to v9.4.12 (#2811)
    
    The recent proxy changes (#2801) tickled some issues in jetty's 9.3
    series, where clients can hang if running on machines with a lot of
    cores. This causes some tests to fail CI, while being impossible to
    repro locally (unless you have a 24 core machine lying around).
    
    Jetty reworked a lot of their selector code in 9.4, which appears to
    make the issue go away.

 distribution/server/src/assemble/LICENSE.bin.txt   | 35 +++++++++++-----------
 distribution/server/src/assemble/NOTICE.bin.txt    |  2 +-
 pom.xml                                            |  2 +-
 .../org/apache/pulsar/broker/web/WebService.java   | 28 ++++++++---------
 .../discovery/service/server/ServerManager.java    | 14 ++++-----
 .../pulsar/functions/worker/rest/WorkerServer.java | 20 ++++++-------
 .../org/apache/pulsar/proxy/server/WebServer.java  | 21 +++++++------
 pulsar-sql/presto-distribution/LICENSE             |  2 +-
 .../pulsar/websocket/service/ProxyServer.java      | 14 ++++-----
 9 files changed, 64 insertions(+), 74 deletions(-)

commit f3a027b45f8244d19ac24709edc7f762abb5ce6f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 19 10:00:25 2018 -0700

    Added stop/restart functionality in sources/sinks (#2810)
    
    * Added Get and List source/sink functionality
    
    * Fixed compile
    
    * Removed test that doesnt make sense any more
    
    * Fixed build
    
    * Fixed logic
    
    * Return error response
    
    * Return response on error
    
    * Fix unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Added get/list sinks tests
    
    * Added get/list tests
    
    * Add more unittests
    
    * Added more unittests
    
    * Added TODO
    
    * Took feedback
    
    * Fix unittest
    
    * Fix unittest
    
    * Fix unittest
    
    * Fixed integration tests
    
    * Fixed integration test
    
    * Added restart/stop functionality to the sources/sinks
    
    * Added getstatus method to sources/sink
    
    * Fix integration tests

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  12 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |  12 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |  12 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  69 +++++++++++
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  91 +++++++++++++--
 .../functions/worker/rest/api/FunctionsImpl.java   | 129 +++++++++++++--------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  12 +-
 .../worker/rest/api/v2/SinkApiV2Resource.java      |  12 +-
 .../worker/rest/api/v2/SourceApiV2Resource.java    |  12 +-
 .../integration/functions/PulsarFunctionsTest.java |  39 ++++++-
 10 files changed, 299 insertions(+), 101 deletions(-)

commit 1386e6dfdba16bb1ee0a3c7649cb7daed50a5d8c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 18 21:59:27 2018 -0700

    Source/Sink Endpoint validations (#2807)
    
    * Added Get and List source/sink functionality
    
    * Fixed compile
    
    * Removed test that doesnt make sense any more
    
    * Fixed build
    
    * Fixed logic
    
    * Return error response
    
    * Return response on error
    
    * Fix unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Added get/list sinks tests
    
    * Added get/list tests
    
    * Add more unittests
    
    * Added more unittests
    
    * Added TODO
    
    * Took feedback
    
    * Fix unittest
    
    * Fix unittest
    
    * Fix unittest
    
    * Fixed integration tests
    
    * Fixed integration test

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  10 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  |  10 +-
 .../pulsar/broker/admin/impl/SourceBase.java       |  10 +-
 .../worker/PulsarWorkerAssignmentTest.java         |   2 +-
 .../apache/pulsar/io/PulsarFunctionE2ETest.java    |  30 ---
 .../org/apache/pulsar/client/admin/Functions.java  |   3 +-
 .../java/org/apache/pulsar/client/admin/Sink.java  |   6 +-
 .../org/apache/pulsar/client/admin/Source.java     |   6 +-
 .../client/admin/internal/FunctionsImpl.java       |   8 +-
 .../pulsar/client/admin/internal/SinkImpl.java     |  12 +-
 .../pulsar/client/admin/internal/SourceImpl.java   |  12 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   4 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  86 +++++--
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  84 +++++--
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |   8 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   8 +-
 .../functions/utils/FunctionConfigUtils.java       |  82 +++++++
 .../pulsar/functions/utils/SinkConfigUtils.java    |  57 +++++
 .../pulsar/functions/utils/SourceConfigUtils.java  |  44 +++-
 .../org/apache/pulsar/functions/utils/Utils.java   |  20 ++
 .../functions/utils/FunctionConfigUtilsTest.java   |  61 +++++
 .../functions/utils/SinkConfigUtilsTest.java       |  59 +++++
 .../functions/utils/SourceConfigUtilsTest.java     |  53 +++++
 .../functions/worker/FunctionMetaDataManager.java  |   6 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 252 ++++++++++++---------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  11 +-
 .../worker/rest/api/v2/SinkApiV2Resource.java      |  11 +-
 .../worker/rest/api/v2/SourceApiV2Resource.java    |  11 +-
 .../worker/FunctionMetaDataManagerTest.java        |  23 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  80 +++++--
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 168 ++++++++------
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 143 +++++++-----
 .../integration/functions/PulsarFunctionsTest.java |  16 +-
 33 files changed, 984 insertions(+), 412 deletions(-)

commit 9ae37b20a2d2e505c95ade87e4b2eb79c27466f6
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 18 21:13:53 2018 -0700

    In stage-release.sh, also include offloaders package (#2803)

 src/stage-release.sh | 1 +
 1 file changed, 1 insertion(+)

commit 3d51af1f2ab72f7e877a098c2b602b760a3c185d
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 18 17:20:43 2018 -0700

     Ensure proxy and broker stats are reported to Prometheus (with 0) even when no traffic is present (#2805)
    
    * Ensure proxy and broker stats are reported to Prometheus (with 0) even when no traffic is present
    
    * Fixed unit test

 .../stats/prometheus/NamespaceStatsAggregator.java | 28 +++++++++++++++++
 .../pulsar/broker/stats/PrometheusMetricsTest.java | 18 +++++------
 .../pulsar/proxy/server/DirectProxyHandler.java    | 10 ++----
 .../pulsar/proxy/server/ProxyConnection.java       | 24 +++++----------
 .../apache/pulsar/proxy/server/ProxyService.java   | 36 ++++++++++++++++------
 .../server/ProxyConnectionThrottlingTest.java      |  4 +--
 6 files changed, 75 insertions(+), 45 deletions(-)

commit 4d16522efa2125c93870b6488f946aba783c1f3b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 18 15:38:56 2018 -0700

    Export Jetty stats to Prometheus (#2804)
    
    * Export Jetty stats to Prometheus
    
    * Fixed exception in tests

 distribution/server/src/assemble/LICENSE.bin.txt           | 11 ++++++-----
 pom.xml                                                    |  8 +++++++-
 pulsar-broker/pom.xml                                      |  6 ++++++
 .../main/java/org/apache/pulsar/broker/web/WebService.java | 14 +++++++++++++-
 pulsar-proxy/pom.xml                                       |  5 +++++
 .../java/org/apache/pulsar/proxy/server/WebServer.java     | 13 ++++++++++++-
 pulsar-sql/presto-distribution/LICENSE                     |  9 ++++-----
 7 files changed, 53 insertions(+), 13 deletions(-)

commit 1fe63957d8ed4e2932c8a1df5ada1fc0055c48a7
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 18 15:36:41 2018 -0700

    Added stats for proxy operations and bytes (#2740)
    
    * Added stats for proxy operations and bytes
    
    * Added _binary marker in metrics name

 .../org/apache/pulsar/proxy/server/DirectProxyHandler.java   | 11 +++++++++++
 .../java/org/apache/pulsar/proxy/server/ProxyConnection.java | 12 ++++++++----
 2 files changed, 19 insertions(+), 4 deletions(-)

commit 3bde91d6f8f241ec5d0618e3134b4de2cc54797c
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 18 11:06:31 2018 -0700

    Include replication when reporting topic stats to Prometheus (#2789)

 .../pulsar/broker/stats/prometheus/TopicStats.java | 25 ++++++++++++++++++++++
 1 file changed, 25 insertions(+)

commit 251e36ec09f0e49c506b58c2724e0f882428634e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 18 08:43:29 2018 -0700

    [cpp] Removed required version 5.0 for CLang format (#2790)

 pulsar-client-cpp/CMakeLists.txt | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 8d69ad86f7726e5798b21bc1bf31baf49f88a29f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 17 21:57:28 2018 -0700

    Added log statements to debug PulsarFunctionsTest.testJavaExclamationTopicPatternFunction (#2806)

 .../tests/integration/functions/PulsarFunctionsTest.java | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)

commit 052c3b0dc418d1ec29c3d221023bc7506b672e91
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Oct 18 00:32:18 2018 +0200

    Allow user to configure proxy as reverse HTTP proxy (#2801)
    
    * Allow user to configure proxy as reverse HTTP proxy
    
    Users normally want to expose as few endpoints as possible. This patch
    enables configuring the pulsar proxy as a review http proxy, so that
    it can be used as a single endpoint for all pulsar and even non-pulsar
    HTTP services.
    
    The reverse proxy uses jetty's builtin implementation.
    
    It is configured in proxy.conf, in the form
    
    httpReverseProxy.NAME.path = '/path-on-pulsar-proxy-endpoint'
    httpReverseProxy.NAME.proxyTo = 'http://internal-server/some-app'
    
    where NAME is any user defined string. Multiple paths can be
    configured this way.
    
    * Add jetty logging at info level for tests

 buildtools/src/main/resources/log4j2.xml           |   1 +
 .../configuration/PulsarConfigurationLoader.java   |   9 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    |  75 +++++-
 .../pulsar/proxy/server/ProxyServiceStarter.java   |  34 ++-
 .../org/apache/pulsar/proxy/server/WebServer.java  |  29 +-
 .../pulsar/proxy/server/ProxyIsAHttpProxyTest.java | 299 +++++++++++++++++++++
 6 files changed, 432 insertions(+), 15 deletions(-)

commit a7310ee7e62f9d70d41ebc21bd196cbba259eeb0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 17 11:41:33 2018 -0700

    Function Serverside validation Part 2 (#2752)
    
    * First cut of adding new endpoints for source/sink
    
    * More better check
    
    * Plugged in source/sink
    
    * Made pulsar admin to use Source/Sink endpoints
    
    * Switched cli to use functionConfig instead of function details
    
    * Fix unittests
    
    * Fixed unittest
    
    * Logic correction
    
    * Fix bugs after mergin
    
    * More compile fixes
    
    * Fixed path for sink
    
    * Added source unittests
    
    * Added sink tests
    
    * Fixed unittest
    
    * Have default value for maxRetries
    
    * Fixed unittest
    
    * Added example jar
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Updated license
    
    * Correct the links for sources/sinks
    
    * Strip the builtin://
    
    * Removed unused imports
    
    * Disabling presto integration test for now until we figure out the whole refactor
    
    * Revert accidental yaml file change
    
    * Dont expose to v1 endpoints

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   4 +-
 .../apache/pulsar/broker/admin/impl/SinkBase.java  | 258 ++++++
 .../pulsar/broker/admin/impl/SourceBase.java       | 261 ++++++
 .../org/apache/pulsar/broker/admin/v2/Sink.java    |  34 +
 .../org/apache/pulsar/broker/admin/v2/Source.java  |  34 +
 .../worker/PulsarWorkerAssignmentTest.java         | 107 +--
 ...SinkE2ETest.java => PulsarFunctionE2ETest.java} | 180 ++--
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |  39 +-
 .../src/test/resources/pulsar-examples.jar         | Bin 0 -> 38857 bytes
 pulsar-client-admin/pom.xml                        |   6 +
 .../org/apache/pulsar/client/admin/Functions.java  |  19 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  36 +-
 .../java/org/apache/pulsar/client/admin/Sink.java  | 277 +++++++
 .../org/apache/pulsar/client/admin/Source.java     | 277 +++++++
 .../client/admin/internal/FunctionsImpl.java       |  34 +-
 .../pulsar/client/admin/internal/SinkImpl.java     | 270 ++++++
 .../pulsar/client/admin/internal/SourceImpl.java   | 270 ++++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  23 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   8 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  24 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  24 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  19 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |  14 +-
 .../pulsar/functions/utils/FunctionConfig.java     |   4 +-
 .../pulsar/functions/utils/SinkConfigUtils.java    |   9 +-
 .../pulsar/functions/utils/SourceConfig.java       |   7 +-
 .../pulsar/functions/utils/SourceConfigUtils.java  |  12 +-
 .../pulsar/functions/utils/io/ConnectorUtils.java  |  84 +-
 .../utils/validation/ConfigValidation.java         |   1 -
 .../functions/utils/validation/ValidatorImpls.java |  86 +-
 .../org/apache/pulsar/functions/worker/Utils.java  |  28 +
 .../pulsar/functions/worker/rest/Resources.java    |   4 +
 .../functions/worker/rest/api/FunctionsImpl.java   | 124 ++-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |   4 +-
 .../worker/rest/api/v2/SinkApiV2Resource.java      | 180 ++++
 .../worker/rest/api/v2/SourceApiV2Resource.java    | 180 ++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 108 +--
 .../worker/rest/api/v2/SinkApiV2ResourceTest.java  | 905 ++++++++++++++++++++
 .../rest/api/v2/SourceApiV2ResourceTest.java       | 916 +++++++++++++++++++++
 pulsar-sql/presto-distribution/LICENSE             |  53 +-
 src/check-binary-license                           |   2 +-
 .../tests/integration/presto/TestBasicPresto.java  |   2 +-
 42 files changed, 4395 insertions(+), 532 deletions(-)

commit c8488605d45606ecc8e2e6f50318fee9c3dbfb9a
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Oct 17 17:02:32 2018 +0200

    Document TLS hostname verification option (#2403) (#2794)
    
    Inform the user why it is disabled by default and in which scenarios
    they should enable it.
    
    Master issue: #2403
    
    Fixes #2403

 site2/docs/security-tls-transport.md | 20 +++++++++++++++++---
 1 file changed, 17 insertions(+), 3 deletions(-)

commit 15fbfee9a0dbc266083b1f96b99f882c7f992ce4
Author: Andrea Simonini <andrea.simonini@gmail.com>
Date:   Wed Oct 17 16:41:05 2018 +0200

    [docs] fix missing code quote on class name for Twitter Firehose source (#2800)

 site2/docs/io-overview.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 98758662e607f3f85130ec0c5efc3f3d3cd8f3b4
Author: Zuyu ZHANG <zuyu@users.noreply.github.com>
Date:   Tue Oct 16 19:07:07 2018 -0500

    Updated README to build cpp client. (#2798)

 pulsar-client-cpp/README.md | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 1c4d0faa5e024808176c8ba083c230f991f2971f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 16 10:29:38 2018 -0700

    Fix: deadlock on blocking ml operation (#2745)

 .../main/java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b8423a5efbcb049b94dbdc350dc5d3159d9fdfbf
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Oct 15 11:58:12 2018 +0200

    CLI for setting schema update policy (#2788)
    
    Allows administrator of a namespace to specify how new schemas
    provided by producers are validated. The policies are backward,
    forward, full and disabled. If disabled, the administrator can still
    update the schema via the schemas admin tool.

 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  50 +++
 .../integration/cli/SchemaUpdateStrategyTest.java  | 341 +++++++++++++++++++++
 .../integration/containers/ChaosContainer.java     |   7 +
 3 files changed, 398 insertions(+)

commit f2f5f83a0600c25df32743fcf3c5a6177d96ecc2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 12 15:59:32 2018 -0700

    Uptated example scripts (#2787)

 .../{run-counter-examples.sh => run-counter-function.sh}      | 11 +++++------
 .../{run-publish-example.sh => run-exclamation-function.sh}   |  7 ++++---
 .../{run-examples.sh => run-logtopic-function.sh}             | 10 +++++-----
 .../{run-logging-examples.sh => run-publish-function.sh}      |  9 ++++-----
 pulsar-functions/submit-python-function.sh                    |  8 ++++----
 5 files changed, 22 insertions(+), 23 deletions(-)

commit 966c0545e8743bce756a710fd82c5274c07ff051
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Oct 12 20:39:43 2018 +0200

    Automatic schema update can be disabled through admin interface (#2691)
    
    Currently when a producer connects to a topic with a new schema, if
    that schema is fully compatible with the current schema, the schema
    for the topic is updated to the new schema.
    
    This may not be desirable in some cases.
    
    This patch allows users to set the auto update schema compatibility
    strategy at the namespace level. There are 4 compatibility levels,
    disabled, backward, forward and full.

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  50 ++++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  35 +++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  33 +++
 .../pulsar/broker/admin/v2/SchemasResource.java    |   4 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  13 +-
 .../broker/service/persistent/PersistentTopic.java |  14 +-
 .../schema/AvroSchemaCompatibilityCheck.java       |  23 +-
 .../schema/DefaultSchemaRegistryService.java       |   6 +-
 .../schema/JsonSchemaCompatibilityCheck.java       |  23 +-
 .../service/schema/NeverSchemaValidator.java       |  43 +++
 .../schema/ProtobufSchemaCompatibilityCheck.java   |   8 -
 .../service/schema/SchemaCompatibilityCheck.java   |  11 +-
 .../schema/SchemaCompatibilityStrategy.java        |  37 ++-
 .../broker/service/schema/SchemaRegistry.java      |   6 +-
 .../service/schema/SchemaRegistryServiceImpl.java  |  26 +-
 .../broker/admin/AdminApiSchemaAutoUpdateTest.java | 300 +++++++++++++++++++++
 .../schema/AvroSchemaCompatibilityCheckTest.java   |  13 +-
 .../schema/BaseAvroSchemaCompatibilityTest.java    |  64 +++--
 .../schema/JsonSchemaCompatibilityCheckTest.java   |  18 +-
 .../ProtobufSchemaCompatibilityCheckTest.java      |  14 +-
 .../broker/service/schema/SchemaServiceTest.java   |   3 +-
 .../api/SimpleTypedProducerConsumerTest.java       |  16 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |  41 +++
 .../client/admin/internal/NamespacesImpl.java      |  27 ++
 .../pulsar/common/policies/data/Policies.java      |   9 +-
 .../SchemaAutoUpdateCompatibilityStrategy.java     |  49 ++++
 26 files changed, 755 insertions(+), 131 deletions(-)

commit 7d2a012719109963cdfe592dcb7e3a145bb7b522
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 12 09:11:18 2018 -0700

    Refresh ZK cache based on insertion time rather than access (#2785)

 .../src/main/java/org/apache/pulsar/zookeeper/ZooKeeperCache.java   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit c2977bef98a2189f0aef70a97c76240bfa24a191
Author: Jean-Bernard van Zuylen <jbvanzuylen@primeoservices.org>
Date:   Fri Oct 12 18:11:05 2018 +0200

    Java Client - Threads to inherit daemon status from thread creating the client (#2770)

 .../java/org/apache/pulsar/client/impl/PulsarClientImpl.java   | 10 +++++++---
 .../java/org/apache/pulsar/client/util/ExecutorProvider.java   |  9 ++++-----
 2 files changed, 11 insertions(+), 8 deletions(-)

commit b6a25f034bd8a9c3b30aa4a90eefdd45a0f0ee67
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Oct 12 11:10:51 2018 -0500

    fix: unsafe cast of schema to JSONSchema (#2779)

 .../src/main/java/org/apache/pulsar/client/impl/ProducerImpl.java     | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit a1a1abed57f108a1e4be3c76abe69e61da8fd619
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Oct 12 09:41:41 2018 -0500

    add initialize routine to FunctionRuntimeManager (#2784)

 .../functions/worker/FunctionAssignmentTailer.java |  16 +--
 .../functions/worker/FunctionMetaDataManager.java  |   4 +-
 .../functions/worker/FunctionRuntimeManager.java   | 120 +++++++++++++------
 .../pulsar/functions/worker/WorkerService.java     |   3 +
 .../worker/FunctionRuntimeManagerTest.java         | 132 ++++++++++++++++++++-
 5 files changed, 229 insertions(+), 46 deletions(-)

commit 3a668084f74b9d4467ae22f38502ee1b9e3c76e9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 12 06:03:29 2018 -0700

    Added ability to specify compression while publishing (#2781)

 pulsar-client-cpp/python/pulsar/functions/context.py     |  2 +-
 pulsar-functions/instance/src/main/python/contextimpl.py | 10 +++++++---
 2 files changed, 8 insertions(+), 4 deletions(-)

commit f077f9d9eeba699af113406d986dc44f02769a76
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 11 22:23:08 2018 -0700

    Fixed shading of Netty (#2783)

 managed-ledger-shaded/pom.xml                      | 33 ++++++++++++++++++++++
 pulsar-broker-shaded/pom.xml                       |  4 +--
 pulsar-client-admin-shaded/pom.xml                 |  4 +--
 .../pulsar-client-kafka-shaded/pom.xml             |  1 +
 pulsar-client-schema/pom.xml                       |  4 +--
 pulsar-client-shaded/pom.xml                       |  4 +--
 pulsar-spark/pom.xml                               |  3 --
 pulsar-sql/presto-distribution/LICENSE             | 10 -------
 .../pulsar/sql/presto/TestPulsarConnector.java     | 16 +++++------
 9 files changed, 46 insertions(+), 33 deletions(-)

commit 9bf335793381d21a7d41d8ca5ceaf0e89b54a93d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 11 21:13:22 2018 -0700

    Make Pulsar Docker have very short ttl cache time so that bookie changes etc are reacted to quickly (#2774)

 docker/pulsar/Dockerfile | 1 +
 1 file changed, 1 insertion(+)

commit 592737a201ee848881c5fa84b35c927e7cad75a2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 11 20:07:57 2018 -0700

    For externally managed functions, function worker should not do metrics management (#2775)

 .../org/apache/pulsar/functions/worker/FunctionRuntimeManager.java    | 4 ++++
 1 file changed, 4 insertions(+)

commit 412859d35710b504d1465e35201ab9987cb7b0d1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 11 19:54:18 2018 -0700

    Fix the variable name for getting current topic name (#2776)

 pulsar-functions/instance/src/main/python/contextimpl.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ec516124cf38f12fc98474d8ca9ec0649fb1185a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 11 19:51:34 2018 -0700

    Enhance publish method to allow properties (#2777)

 pulsar-client-cpp/python/pulsar/functions/context.py     | 5 +++--
 pulsar-functions/instance/src/main/python/contextimpl.py | 4 ++--
 2 files changed, 5 insertions(+), 4 deletions(-)

commit 89ccde01617366ae1c5a6950c883b7aacac195e9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 11 18:36:25 2018 -0700

    Metrics Collector Agent for Functions running in Kubernetes (#2773)
    
    ### Motivation
    
    Added an agent to scrape for metrics from the functions container and expose it on a port for prometheus to scrape.

 distribution/server/src/assemble/bin.xml           |   5 +
 pulsar-functions/metrics/pom.xml                   |  38 ++++++
 .../functions/metrics/PrometheusMetricsServer.java | 137 +++++++++++++++++++++
 .../functions/metrics/sink/AbstractWebSink.java    |   6 +-
 .../functions/runtime/KubernetesRuntime.java       |  96 +++++++++++++--
 .../runtime/KubernetesRuntimeFactory.java          |  11 +-
 .../functions/runtime/KubernetesRuntimeTest.java   |   2 +-
 .../functions/worker/FunctionRuntimeManager.java   |   3 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   1 +
 9 files changed, 282 insertions(+), 17 deletions(-)

commit 60a6a7b9da9e395f8938a609d07e666735c93526
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 11 15:17:53 2018 -0700

    Added script to change the project version in 1 command (#2772)

 protobuf-shaded/pom.xml                |  1 +
 pulsar-sql/presto-distribution/pom.xml |  2 +-
 src/set-project-version.sh             | 38 ++++++++++++++++++++++++++++++++++
 3 files changed, 40 insertions(+), 1 deletion(-)

commit fa589ed06289495b25d7f6e3b909b202d0114d73
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Oct 11 08:51:09 2018 -0700

    [website] make sure 2.1.1 documentation reflects to the features in 2.1.1 (#2769)

 .../client-libraries-cpp.md                        |   8 +-
 .../version-2.1.0-incubating/io-quickstart.md      |   2 +-
 .../version-2.1.1-incubating/adaptors-kafka.md     |   2 -
 .../cookbooks-tiered-storage.md                    | 125 ++--------
 .../version-2.1.1-incubating/deploy-bare-metal.md  |   4 +-
 .../version-2.1.1-incubating/functions-api.md      |  65 ++---
 .../functions-deploying.md                         |  20 +-
 .../functions-guarantees.md                        |   4 +-
 .../version-2.1.1-incubating/functions-overview.md |  24 +-
 .../functions-quickstart.md                        |  10 +-
 .../version-2.1.1-incubating/io-managing.md        |  20 +-
 .../version-2.1.1-incubating/io-quickstart.md      |   2 +-
 .../reference-pulsar-admin.md                      | 277 +++++----------------
 .../sql-deployment-configurations.md               | 151 -----------
 .../sql-getting-started.md                         | 143 -----------
 .../version-2.1.1-incubating/sql-overview.md       |  25 --
 .../version-2.1.1-incubating-sidebars.json         | 116 +++++++++
 17 files changed, 270 insertions(+), 728 deletions(-)

commit a51e6d152ebb86a436fcf36d30f59e95962f724a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Oct 11 08:17:36 2018 -0700

    Remove `install_usercode_dependencies` from java instance main (#2768)
    
    `installUserCodeDependencies` is only valid for python instance; and python and java have different behaviors on
    handling command args. so remove it from java instance to avoid confusion and problems

 .../pulsar/functions/runtime/JavaInstanceMain.java      |  3 ---
 .../apache/pulsar/functions/runtime/RuntimeUtils.java   |  9 +++++----
 .../pulsar/functions/runtime/KubernetesRuntimeTest.java | 17 ++++++++++-------
 3 files changed, 15 insertions(+), 14 deletions(-)

commit 04bd8bd26fb75abb4ef426a904a8321b39087989
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Oct 11 08:17:17 2018 -0700

    fix classname flag in python function example (#2766)

 site2/docs/functions-quickstart.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 11a6982c0ee06c8038596e5b83672e3943763747
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 11 03:25:39 2018 -0700

    Fixed link and spacing for python docs (#2763)
    
    ### Motivation
    
    Fixed a broken link and added extra line so the producer docs formatting will not get messed up.

 pulsar-client-cpp/python/pulsar/__init__.py                             | 1 +
 site2/docs/client-libraries-python.md                                   | 2 +-
 .../versioned_docs/version-2.1.0-incubating/client-libraries-python.md  | 2 +-
 .../versioned_docs/version-2.1.1-incubating/client-libraries-python.md  | 2 +-
 4 files changed, 4 insertions(+), 3 deletions(-)

commit 6b15a6bf49d436fdcaa2fdf9105c824f6ddec9ef
Author: joefk <22042978+joefk@users.noreply.github.com>
Date:   Wed Oct 10 17:39:48 2018 -0700

    Bumped version to 2.3.0-SNAPSHOT (#2765)

 buildtools/pom.xml                                            | 2 +-
 distribution/io/pom.xml                                       | 2 +-
 distribution/offloaders/pom.xml                               | 2 +-
 distribution/pom.xml                                          | 2 +-
 distribution/server/pom.xml                                   | 2 +-
 docker/grafana/pom.xml                                        | 2 +-
 docker/pom.xml                                                | 2 +-
 docker/pulsar-all/pom.xml                                     | 2 +-
 docker/pulsar-standalone/pom.xml                              | 2 +-
 docker/pulsar/pom.xml                                         | 2 +-
 examples/flink-consumer-source/pom.xml                        | 2 +-
 examples/pom.xml                                              | 2 +-
 jclouds-shaded/pom.xml                                        | 2 +-
 managed-ledger-shaded/pom.xml                                 | 2 +-
 managed-ledger/pom.xml                                        | 2 +-
 pom.xml                                                       | 2 +-
 pulsar-broker-auth-athenz/pom.xml                             | 2 +-
 pulsar-broker-common/pom.xml                                  | 2 +-
 pulsar-broker-shaded/pom.xml                                  | 2 +-
 pulsar-broker/pom.xml                                         | 2 +-
 pulsar-client-admin-shaded/pom.xml                            | 2 +-
 pulsar-client-admin/pom.xml                                   | 2 +-
 pulsar-client-auth-athenz/pom.xml                             | 2 +-
 pulsar-client-kafka-compat/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml  | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml        | 2 +-
 pulsar-client-schema/pom.xml                                  | 2 +-
 pulsar-client-shaded/pom.xml                                  | 2 +-
 pulsar-client-tools-test/pom.xml                              | 2 +-
 pulsar-client-tools/pom.xml                                   | 2 +-
 pulsar-client/pom.xml                                         | 2 +-
 pulsar-common/pom.xml                                         | 2 +-
 pulsar-discovery-service/pom.xml                              | 2 +-
 pulsar-flink/pom.xml                                          | 2 +-
 pulsar-functions/api-java/pom.xml                             | 2 +-
 pulsar-functions/instance/pom.xml                             | 2 +-
 pulsar-functions/java-examples/pom.xml                        | 2 +-
 pulsar-functions/metrics/pom.xml                              | 2 +-
 pulsar-functions/pom.xml                                      | 2 +-
 pulsar-functions/proto-shaded/pom.xml                         | 2 +-
 pulsar-functions/proto/pom.xml                                | 2 +-
 pulsar-functions/runtime-all/pom.xml                          | 2 +-
 pulsar-functions/runtime-shaded/pom.xml                       | 2 +-
 pulsar-functions/runtime/pom.xml                              | 2 +-
 pulsar-functions/utils/pom.xml                                | 2 +-
 pulsar-functions/worker/pom.xml                               | 2 +-
 pulsar-io/aerospike/pom.xml                                   | 2 +-
 pulsar-io/cassandra/pom.xml                                   | 2 +-
 pulsar-io/core/pom.xml                                        | 2 +-
 pulsar-io/data-genenator/pom.xml                              | 2 +-
 pulsar-io/debezium/pom.xml                                    | 2 +-
 pulsar-io/elastic-search/pom.xml                              | 2 +-
 pulsar-io/hdfs/pom.xml                                        | 2 +-
 pulsar-io/jdbc/pom.xml                                        | 2 +-
 pulsar-io/kafka-connect-adaptor/pom.xml                       | 2 +-
 pulsar-io/kafka/pom.xml                                       | 2 +-
 pulsar-io/kinesis/pom.xml                                     | 2 +-
 pulsar-io/pom.xml                                             | 2 +-
 pulsar-io/rabbitmq/pom.xml                                    | 2 +-
 pulsar-io/twitter/pom.xml                                     | 2 +-
 pulsar-log4j2-appender/pom.xml                                | 2 +-
 pulsar-proxy/pom.xml                                          | 2 +-
 pulsar-spark/pom.xml                                          | 2 +-
 pulsar-sql/pom.xml                                            | 2 +-
 pulsar-sql/presto-pulsar-plugin/pom.xml                       | 2 +-
 pulsar-sql/presto-pulsar/pom.xml                              | 2 +-
 pulsar-storm/pom.xml                                          | 2 +-
 pulsar-testclient/pom.xml                                     | 2 +-
 pulsar-websocket/pom.xml                                      | 2 +-
 pulsar-zookeeper-utils/pom.xml                                | 2 +-
 pulsar-zookeeper/pom.xml                                      | 2 +-
 tests/docker-images/latest-version-image/pom.xml              | 2 +-
 tests/docker-images/pom.xml                                   | 2 +-
 tests/integration/pom.xml                                     | 2 +-
 tests/pom.xml                                                 | 2 +-
 tests/pulsar-kafka-compat-client-test/pom.xml                 | 2 +-
 tiered-storage/jcloud/pom.xml                                 | 2 +-
 tiered-storage/pom.xml                                        | 2 +-
 79 files changed, 79 insertions(+), 79 deletions(-)

commit 591df495f5a247a05e99b6c9f342c58b700e2375
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 10 17:05:15 2018 -0700

    Fix IdentitySerde (#2762)
    
    * Apply bytes only if the output of serializer is string
    
    * Change IdentitySerde
    
    * Fixed deser logic
    
    * Changed the name of IdentitySerDe to StringSerDe to better reflect what it is
    
    * Change doc comments
    
    * Reverted all changes
    
    * Made IdentitySerde mimic Json Schema
    
    * Reverted any changes
    
    * IdentitySerde will only work with primitive types

 pulsar-client-cpp/python/pulsar/functions/serde.py       | 16 +++++++++++++---
 .../instance/src/main/python/python_instance.py          |  2 +-
 2 files changed, 14 insertions(+), 4 deletions(-)

commit 4ed2e336a27a5e987878955d033f1f396fa3b184
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 10 16:45:09 2018 -0700

    Fix Topic Pattern functionality for Python functions (#2760)
    
    * pulsar client no longer has subscribe_pattern interface
    
    * Added integration tests for topic pattern
    
    * Fixed integration test

 .../instance/src/main/python/python_instance.py    |  5 +-
 .../integration/functions/PulsarFunctionsTest.java | 78 +++++++++++++++++++---
 .../functions/utils/CommandGenerator.java          | 22 ++----
 3 files changed, 76 insertions(+), 29 deletions(-)

commit 6e9b6c2a8ffbeae1edabf88486f8432f23c29d74
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Oct 10 11:08:27 2018 -0700

    Issue #2757: Kafka source connector should just transfer bytes (#2761)
    
    *Motivation*
    
    connector is mostly used for transferring bytes from kafka to pulsar.
    since we haven't mapped schema between kafka and pulsar, we should just
    transfer bytes for now.
    
    *Changes*
    
    Add a bytes source and make bytes source as a default setting.
    Keep string source there for BC consideration.

 .../pulsar/io/kafka/KafkaAbstractSource.java       |  6 ++-
 .../apache/pulsar/io/kafka/KafkaBytesSource.java   | 48 ++++++++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  2 +-
 3 files changed, 54 insertions(+), 2 deletions(-)

commit 18c26e07202ed8d234bffd91c4e12163460ea8c9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 10 06:11:00 2018 -0700

    Do not create any producer if the output type of a function is void (#2756)
    
    * Do not create any producer if the output type of a function is void
    
    * Do not write if the record is null
    
    * Revert the check for null

 .../java/org/apache/pulsar/functions/sink/PulsarSink.java    |  6 +++++-
 .../org/apache/pulsar/functions/sink/PulsarSinkTest.java     | 12 +++---------
 2 files changed, 8 insertions(+), 10 deletions(-)

commit 362f7959a610bb62993181388c071d486a50d6cd
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Oct 10 12:26:10 2018 +0800

    change constructor access for ConsumerBuilderImpl (#2759)

 .../main/java/org/apache/pulsar/client/impl/ConsumerBuilderImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6d6155e0f73aaf8d5959bddb73ad1c0f70cc1e26
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Oct 9 22:51:53 2018 -0500

    fix: function update and related tests are broken (#2755)
    
    * fix: function update is broken since assignments of updated functions are not propagated
    
    * remove test code

 .../pulsar/functions/worker/SchedulerManager.java  |  5 +--
 .../functions/worker/SchedulerManagerTest.java     | 37 +++++++++++-----------
 2 files changed, 21 insertions(+), 21 deletions(-)

commit 8d396c347b7c9b275066b885554060d771dd17f6
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 9 18:03:31 2018 -0700

    [c++] Fixed virtual destructors (#2754)

 pulsar-client-cpp/include/pulsar/CryptoKeyReader.h | 2 +-
 pulsar-client-cpp/include/pulsar/Logger.h          | 2 ++
 pulsar-client-cpp/include/pulsar/TopicMetadata.h   | 2 ++
 pulsar-client-cpp/lib/Hash.h                       | 2 ++
 4 files changed, 7 insertions(+), 1 deletion(-)

commit 95f67d09d388734e73029bec0e36f3f599748c1b
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 9 17:55:52 2018 -0700

     [python] MessageId.serialize() should return bytes instead of str  (#2750)
    
    * [python] MessageId.serialize() should return bytes instead of str
    
    * Added msg id comparator functions

 pulsar-client-cpp/python/pulsar/__init__.py | 11 +++++-----
 pulsar-client-cpp/python/pulsar_test.py     |  6 +++++
 pulsar-client-cpp/python/src/message.cc     | 34 +++++++++++++++++++++++++++--
 3 files changed, 44 insertions(+), 7 deletions(-)

commit b22f59c2f24d8d07abd5bc91cdd39fc94cd4699a
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 9 16:41:14 2018 -0700

    Fixed apache-rat validations (#2753)

 distribution/server/src/assemble/src.xml |  4 ++++
 examples/flink-consumer-source/README.md | 21 +++++++++++++++++++++
 pom.xml                                  |  3 ++-
 tests/compose/README.md                  | 21 +++++++++++++++++++++
 4 files changed, 48 insertions(+), 1 deletion(-)

commit 83da460f63ea3a3429cdf6def8d8aa4c3aa52eeb
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 9 12:18:19 2018 -0700

    Avoid shading netty in managed-ledger-shaded (#2741)
    
    * Avoid shading netty in managed-ledger-shaded
    
    * Fixed license file

 managed-ledger-shaded/pom.xml          | 14 +-------------
 pulsar-sql/presto-distribution/LICENSE |  2 ++
 2 files changed, 3 insertions(+), 13 deletions(-)

commit 90aa408b9ddc53629bdc5c0e540cf5335c34399b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 8 22:06:01 2018 -0700

    Fix getstatus logic in kubernetes runtime (#2748)
    
    ### Motivation
    
    When running in k8 environment, all instances of a function are owned by only one function worker. Now if there are multiple workers and the getstatus comes to a worker thats not the owner of the function, it should redirect to the right owner.

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  2 +-
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  2 +-
 .../src/main/proto/InstanceCommunication.proto     |  1 +
 .../functions/worker/FunctionRuntimeManager.java   | 41 ++++++++++++++++++----
 .../functions/worker/rest/api/FunctionsImpl.java   |  8 +++--
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  2 +-
 6 files changed, 45 insertions(+), 11 deletions(-)

commit f71812803f961140a8f26630f40a9b6ff9afe0bb
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 8 12:35:06 2018 -0700

    All grpc calls should have timeouts (#2747)

 .../apache/pulsar/functions/runtime/KubernetesRuntime.java    |  4 +++-
 .../org/apache/pulsar/functions/runtime/ProcessRuntime.java   | 11 ++++++-----
 2 files changed, 9 insertions(+), 6 deletions(-)

commit dd4f71d9572313e26674209cf1ae2d1bc0611f6d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Oct 8 12:24:04 2018 -0700

     [clients][kafka] Fix topic name & race condition on kafka wrapper (#2746)
    
    *Motivation*
    
    Current PulsarKafkaConsumer has following defects:
    
    - topic name is used inconsistently for keeping different mapping. we should always use fully qualified topic name as keys for keeping mappings.
    - seek should clean up offset maps
    - poll logic can potentially pop a message but not deliver it to the client
    
    *Changes*
    
    - Fixes those issues in kafka wrapper
    - Enable kafka integration tests and use standalone test suite
    - Enable kafka client logging

 buildtools/src/main/resources/log4j2.xml           |   1 +
 .../clients/consumer/PulsarKafkaConsumer.java      |  37 +++--
 ...luster-2-bookie-1-broker-unstarted-with-s3.yaml | 164 ---------------------
 tests/integration/pom.xml                          |  11 ++
 .../topologies/PulsarStandaloneTestBase.java       |   1 -
 tests/pom.xml                                      |   1 +
 tests/pulsar-kafka-compat-client-test/pom.xml      | 122 +++++++++++++++
 .../integration/compat/kafka/KafkaApiTest.java     |  83 ++++++-----
 8 files changed, 212 insertions(+), 208 deletions(-)

commit 7e3203d686e8dd81a019c5cb7441501ada556792
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Oct 7 23:05:36 2018 -0700

    fix: NPE when there are assignments for workers not in membership (#2744)
    
    ### Motivation
    
    Fixes #2743
    
    NPE occurs when there are assignments for workers not currently in the membership.  This could happen if the worker crashed before failure detector unassigned the functions assign to it and the scheduler is triggered by other means.
    
    ### Modifications
    
    Filter out the assignments for worker not in membership.

 .../pulsar/functions/worker/SchedulerManager.java  |  21 ++-
 .../functions/worker/SchedulerManagerTest.java     | 144 +++++++++++++++------
 2 files changed, 120 insertions(+), 45 deletions(-)

commit b2d6a80f9f92f24a0048b7f9c7f925b728771540
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Oct 7 20:11:38 2018 -0700

    [functions][python] support both python 2 and 3 (#2742)
    
    *Motivation*
    
    base64 is non compatible between python2 and 3
    
    *Changes*
    
    Provides a python 2/3 compatible method

 .../instance/src/main/python/python_instance.py          | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

commit 0da4e4af407650de874ed6c9de891d98aa540aad
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Oct 7 16:42:18 2018 -0700

    [schema] provide a flag to disable/enable schema validation on broker (#2730)
    
    *Motivation*
    
    We need an upgrade/backward compatibility story for schema enforcement. Especially around:
    
    - `Producers cannot connect without a schema to topics with a schema`
    
    *Changes*
    
    - provide a flag on brokers to enable schema validation (and disabled it by default). this allows a smooth upgrade on brokers,
      otherwise, it will break all non-java producers on topics with schema immediately when upgrade to the new version

 conf/broker.conf                                   |  7 ++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  9 +++++
 .../apache/pulsar/broker/service/ServerCnx.java    |  4 ++-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 31 +++++++++--------
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    | 31 +++++++++--------
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  1 +
 .../pulsar/client/api/BrokerServiceLookupTest.java | 28 +++++++++------
 .../apache/pulsar/client/api/SimpleSchemaTest.java | 40 ++++++++++++++++++++--
 .../java/org/apache/pulsar/client/api/Schema.java  | 16 +++++++++
 .../client/impl/schema/AutoConsumeSchema.java      |  7 ++++
 .../client/impl/schema/AutoProduceBytesSchema.java | 24 ++++++++++---
 .../pulsar/client/impl/schema/ByteSchema.java      | 10 ++++--
 .../pulsar/client/impl/schema/DoubleSchema.java    | 11 ++++--
 .../pulsar/client/impl/schema/FloatSchema.java     | 11 ++++--
 .../pulsar/client/impl/schema/IntSchema.java       | 11 ++++--
 .../pulsar/client/impl/schema/LongSchema.java      | 11 ++++--
 .../pulsar/client/impl/schema/ShortSchema.java     | 11 ++++--
 .../org/apache/pulsar/client/api/PulsarClient.java |  8 ++---
 .../ProxyAuthenticatedProducerConsumerTest.java    |  3 +-
 .../proxy/server/ProxyAuthenticationTest.java      |  7 ++--
 .../server/ProxyConnectionThrottlingTest.java      |  5 +--
 .../proxy/server/ProxyLookupThrottlingTest.java    |  7 ++--
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  9 ++---
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |  5 +--
 .../server/ProxyWithAuthorizationNegTest.java      |  5 +--
 .../proxy/server/ProxyWithAuthorizationTest.java   |  3 +-
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  3 +-
 tests/integration/pom.xml                          |  6 ----
 .../integration/compat/kafka/KafkaApiTest.java     |  1 +
 29 files changed, 228 insertions(+), 97 deletions(-)

commit f8e7dfe1aa4f93c1fb724d705b10f89264583c27
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Oct 6 10:27:52 2018 -0700

    Removed client-admin dependency from function-utils (#2739)

 .../apache/pulsar/functions/instance/Utils.java    | 57 ++++++++++++++++++++++
 .../pulsar/functions/source/PulsarRecord.java      |  2 +-
 .../pulsar/functions/instance}/UtilsTest.java      |  2 +-
 pulsar-functions/utils/pom.xml                     | 14 ++++--
 .../pulsar/functions/utils/FunctionConfig.java     |  2 -
 .../functions/utils/FunctionConfigUtils.java       |  1 -
 .../apache/pulsar/functions/utils/Resources.java   |  3 --
 .../org/apache/pulsar/functions/utils/Utils.java   | 25 ----------
 .../validation/ConfigValidationAnnotations.java    |  2 -
 .../apache/pulsar/io/jdbc/JdbcAbstractSink.java    |  7 ++-
 10 files changed, 72 insertions(+), 43 deletions(-)

commit c3c7f0d219dc0f6ab6f9968ae045c21bb9afbd1a
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 5 20:04:04 2018 -0700

    Collect metrics on number of logs lines printed (#2735)
    
    ### Motivation
    
    Expose metrics in Prometheus regarding the number of log messages printed by each process.
    
    This will add metrics like:
    
    ```
    # TYPE log4j2_appender_total counter
    log4j2_appender_total{cluster="standalone",level="debug"} 0.0
    log4j2_appender_total{cluster="standalone",level="warn"} 1.0
    log4j2_appender_total{cluster="standalone",level="trace"} 0.0
    log4j2_appender_total{cluster="standalone",level="error"} 0.0
    log4j2_appender_total{cluster="standalone",level="fatal"} 0.0
    log4j2_appender_total{cluster="standalone",level="info"} 181.0
    ```

 conf/log4j2.yaml                                 | 14 ++++++++++----
 distribution/server/pom.xml                      |  5 +++++
 distribution/server/src/assemble/LICENSE.bin.txt |  1 +
 pom.xml                                          |  6 ++++++
 4 files changed, 22 insertions(+), 4 deletions(-)

commit 77e2e0b2a1724928324a785a83c8e50b9a55c0f9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 5 18:03:33 2018 -0700

    The log4j should be prefixed by pulsarRootDir (#2737)
    
    * The log4j should be prefixed by pulsarRootDir
    
    * User importlib because use of __import__ is discouraged

 pulsar-functions/instance/src/main/python/util.py                    | 5 +++--
 .../java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java  | 2 +-
 .../org/apache/pulsar/functions/runtime/KubernetesRuntimeTest.java   | 2 +-
 3 files changed, 5 insertions(+), 4 deletions(-)

commit fc0ef9012f8e5d18985c6f897d35b9b55f7b7479
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Oct 5 16:31:51 2018 -0700

    [functions][worker] timeout creating producer for worker (#2738)
    
    
    
    *Motivation*
    
    Sometime when we run worker service as part of broker, some pods can be hanging on creating producers to assignment topics.
    It is unknown whether is it a k8s problem or not. But in general, timeout to fail fast to allow k8s to reschedule the pods.
    
    *Changes*
    
    Add a timeout logic at creating producers.

 .../pulsar/functions/worker/SchedulerManager.java  | 53 ++++++++++++++++------
 .../functions/worker/SchedulerManagerTest.java     | 15 +-----
 2 files changed, 41 insertions(+), 27 deletions(-)

commit d26bea8f19112ce1581b62ea59a2d8a2cc5a4d85
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Oct 5 15:26:08 2018 -0700

    [integration tests] add a smoketest for pulsar standalone (#2732)
    
    *Motivation*
    
    Ideally we should run all integration tests on both cluster mode and standalone
    mode. However the apache ci can't really afford to do so. so we run all the integration
    tests on cluster mode. We only run basic validation and test new features (e.g. state)
    on standalone.
    
    *Changes*
    
    Add PulsarStandalone related test base and suite and a simmple smoke test.
    This would set the framework for integration tests for state

 .../integration/containers/PulsarContainer.java    |  5 +-
 .../containers/StandaloneContainer.java            | 65 +++++++++++++++
 .../tests/integration/semantics/SemanticsTest.java | 33 +-------
 .../tests/integration/standalone/SmokeTest.java    | 32 ++++++++
 .../suites/PulsarStandaloneTestSuite.java          | 43 ++++++++++
 .../topologies/PulsarClusterTestBase.java          | 35 +-------
 .../topologies/PulsarStandaloneTestBase.java       | 83 +++++++++++++++++++
 .../integration/topologies/PulsarTestBase.java     | 93 ++++++++++++++++++++++
 .../src/test/resources/pulsar-standalone.xml       | 28 +++++++
 9 files changed, 352 insertions(+), 65 deletions(-)

commit da833223404e6ea4ce2a13f65e9f74bb0db783a1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Oct 5 10:14:23 2018 -0700

    Added ability a download dependencies in Kubernetes (#2729)
    
    * Add a config to allow user code dependencies to be installed at runtime.
    Enable it only for Kubernetes runtime
    
    * Fix bug
    
    * Fixed indentation issue
    
    * Specify the right cmd line
    
    * Install dep only in the temp dir
    
    * Queue is not in python3. Thus add a try catch block
    
    * Fixed unittest

 pulsar-functions/instance/src/main/python/python_instance.py   |  7 +++++--
 .../instance/src/main/python/python_instance_main.py           |  8 ++++++--
 .../org/apache/pulsar/functions/runtime/JavaInstanceMain.java  |  3 +++
 .../org/apache/pulsar/functions/runtime/KubernetesRuntime.java |  3 ++-
 .../pulsar/functions/runtime/KubernetesRuntimeFactory.java     |  4 ++++
 .../org/apache/pulsar/functions/runtime/ProcessRuntime.java    |  2 +-
 .../java/org/apache/pulsar/functions/runtime/RuntimeUtils.java |  7 ++++++-
 .../apache/pulsar/functions/runtime/KubernetesRuntimeTest.java | 10 +++++-----
 .../apache/pulsar/functions/worker/FunctionRuntimeManager.java |  1 +
 .../java/org/apache/pulsar/functions/worker/WorkerConfig.java  |  1 +
 10 files changed, 34 insertions(+), 12 deletions(-)

commit ea503da4b279d04de13ed676291e1b943f9f973f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Oct 5 09:00:39 2018 -0700

    [function][runtime] NPE at RuntimeSpawner (#2728)
    
    *Motivation*
    
    getFunctionStat call can happen before spanwer starts the runtime
    
    *Changes*
    
    Add null checks and also change the order of closing sequence in RuntimeSpawner

 .../apache/pulsar/functions/runtime/RuntimeSpawner.java | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit 525239b12951cc68bac4a32706e2c3c405b15987
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Oct 5 08:28:50 2018 -0700

    [functions][conf] Update functions_worker yml with all the possible settings (#2721)
    
    *Motivation*
    
    People shouldn't be looking into code to understand how to configure a function worker.
    We should have all the possible settings available in the configuration file.
    
    *Changes*
    
    reorganize the function worker configuration file and add missing fields

 conf/functions_worker.yml | 99 ++++++++++++++++++++++++++++++++++++++++-------
 1 file changed, 85 insertions(+), 14 deletions(-)

commit ab02f4fdb26d5dc19a4cda85ee2fe33f5a774ad3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Oct 5 00:51:26 2018 -0700

     [functions][stats] don't generate function stats at worker service if runtime is k8s (#2724)
    
    *Motivation*
    
    k8s runtime doesn't support generating function stats at worker service right now.
    so skip it for now until that feature is added.
    
    *Changes*
    
    skip function stats for k8s runtime

 .../pulsar/functions/worker/FunctionsStatsGenerator.java  |  6 ++++++
 .../functions/worker/FunctionStatsGeneratorTest.java      | 15 +++++++++++++++
 2 files changed, 21 insertions(+)

commit af589567fc5d479e2e4e205234ee2234e0eccef5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Oct 5 00:48:31 2018 -0700

    local function-worker use localhost broker service url (#2722)
    
    ### Motivation
    
    If pulsar service starts broker and worker in the same process then worker should not use broker-advertised address but use localhost address to connect.

 .../org/apache/pulsar/PulsarBrokerStarter.java     | 13 ++++++------
 .../org/apache/pulsar/broker/PulsarService.java    | 24 ++++++++++++++++++----
 2 files changed, 27 insertions(+), 10 deletions(-)

commit 9b74e9dc734f3c24290b2c81d3f492928fec7484
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Oct 4 23:18:58 2018 -0700

    [functions][stats] NPE in FunctionStatsGenerator when worker service is not ready (#2723)
    
    * [functions][stats] NPE in FunctionStatsGenerator when worker service is not ready
    
    *Motivation*
    
    NullPointerException was thrown when function worker is running as part of broker and metrics collection kicks in
    before worker service completes initialization
    
    *Changes*
    
    Only generate functions when worker service is ready
    
    * Fix FunctionSTatsGeneratorTest

 .../pulsar/functions/worker/FunctionsStatsGenerator.java  |  3 ++-
 .../functions/worker/FunctionStatsGeneratorTest.java      | 15 +++++++++++++++
 2 files changed, 17 insertions(+), 1 deletion(-)

commit 520f9aa955de81fe2df45958db568b03879a2958
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 4 21:42:36 2018 -0700

    Fix download path in Kubernetes (#2727)
    
    * Download the user code into pulsarRootDir
    
    * Apply it everywhere
    
    * Fix unittest

 .../org/apache/pulsar/functions/runtime/KubernetesRuntime.java |  4 ++--
 .../apache/pulsar/functions/runtime/KubernetesRuntimeTest.java | 10 ++++++----
 2 files changed, 8 insertions(+), 6 deletions(-)

commit 79dd772f61bdb78816247bc3ad24a59cdc8f7ac6
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 4 20:28:44 2018 -0700

    Fixed intermittent test failures with "bind error" (#2725)

 .../apache/pulsar/broker/SLAMonitoringTest.java    |  2 +-
 .../AntiAffinityNamespaceGroupTest.java            |  2 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  2 +-
 .../loadbalance/ModularLoadManagerImplTest.java    |  2 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |  2 +-
 .../broker/service/AdvertisedAddressTest.java      |  3 +-
 .../broker/service/BacklogQuotaManagerTest.java    |  9 ++---
 .../broker/service/BrokerBkEnsemblesTests.java     | 10 +++---
 .../pulsar/broker/service/ReplicatorTestBase.java  |  6 ++--
 .../broker/service/v1/V1_ReplicatorTestBase.java   |  6 ++--
 .../pulsar/client/api/NonPersistentTopicTest.java  |  6 ++--
 .../worker/PulsarWorkerAssignmentTest.java         |  2 +-
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |  8 ++---
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |  2 +-
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  2 +-
 pulsar-zookeeper-utils/pom.xml                     |  8 +++++
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 41 ++++++++++++++++++----
 .../zookeeper/LocalBookkeeperEnsembleTest.java     | 16 ++++-----
 18 files changed, 83 insertions(+), 46 deletions(-)

commit c7b911921219f374d11c20ea1e1fb8109e985543
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Oct 4 20:08:52 2018 -0700

    Mock out the settting up k8 client part (#2726)

 .../apache/pulsar/functions/runtime/KubernetesRuntimeFactory.java  | 3 ++-
 .../org/apache/pulsar/functions/runtime/KubernetesRuntimeTest.java | 7 +++++--
 2 files changed, 7 insertions(+), 3 deletions(-)

commit 90c365c1d7940a527eec85b41f69d78a7e3e8c3e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 4 19:02:05 2018 -0700

    Removed shading relocations for Circe-checksum and lz4 libraries (#2191)
    
    * Removed shading relocations for Circe-checksum and lz4 libraries
    
    * Also remove the jni shading in pulsar-broker-shaded
    
    * Removed remaining relocations directives
    
    * Moved Kafka wrapper tests to integration tests
    
    * Do not shade io.netty.buffer.ByteBuf since it's passed between components
    
    * Fixed presto dependencies license file

 distribution/server/src/assemble/LICENSE.bin.txt   |   2 +-
 managed-ledger-shaded/pom.xml                      |  18 +-
 pom.xml                                            |   6 +-
 pulsar-broker-shaded/pom.xml                       |  19 +-
 pulsar-client-admin-shaded/pom.xml                 |  19 +-
 .../pulsar-client-kafka-shaded/pom.xml             |  28 ---
 .../client/kafka/compat/tests/KafkaApiTest.java    | 113 -----------
 .../pulsar-client-kafka/pom.xml                    |  29 +--
 .../kafka/compat/tests/KafkaProducerTest.java      | 119 -----------
 pulsar-client-schema/pom.xml                       |  23 +--
 pulsar-client-shaded/pom.xml                       |  23 +--
 pulsar-common/pom.xml                              |   4 +-
 pulsar-functions/runtime-all/pom.xml               |  10 +-
 pulsar-functions/worker/pom.xml                    |   8 +-
 pulsar-spark/pom.xml                               |   3 +
 pulsar-sql/presto-distribution/LICENSE             |  10 +
 .../pulsar/sql/presto/TestPulsarConnector.java     |   6 +-
 .../pulsar/websocket/service/ProxyServer.java      |  12 +-
 tests/integration/pom.xml                          |   9 +-
 .../integration/compat/kafka/KafkaApiTest.java     | 223 ++++++++++++++++-----
 20 files changed, 239 insertions(+), 445 deletions(-)

commit 828e22df135b17379f12681a4ccad68eaaa0948a
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 4 16:49:11 2018 -0700

    Removed organization affiliations from website (#2715)

 site2/website/data/team.js     | 64 +++++++++++++++++++++++++-----------------
 site2/website/pages/en/team.js | 23 ---------------
 2 files changed, 39 insertions(+), 48 deletions(-)

commit 861f155ce853258174915718faa04e56733e5efa
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Oct 4 12:54:02 2018 -0700

    [tests][integration] Fix errors in integration tests (#2716)
    
    - Tick doesn't implement equals
    - TestBasicPresto doesn't run

 .../pulsar/functions/api/examples/pojo/Tick.java   | 40 +++-----------
 .../tests/integration/presto/TestBasicPresto.java  | 61 ++++++++++------------
 .../integration/topologies/PulsarCluster.java      | 40 ++++++++++++--
 .../src/test/resources/pulsar-process.xml          |  1 +
 4 files changed, 71 insertions(+), 71 deletions(-)

commit bb945d388ebf04fee3583680e5ee86988b131e26
Author: Yuta Mochizuki <41100271+yumochiz@users.noreply.github.com>
Date:   Fri Oct 5 01:59:08 2018 +0900

    Add System Property Option for Athenz (#2707)

 .../authentication/AuthenticationProviderAthenz.java      | 12 ++++++++++--
 .../authentication/AuthenticationProviderAthenzTest.java  | 15 +++++++++++++++
 2 files changed, 25 insertions(+), 2 deletions(-)

commit 24749e16bdb1e3a4f9891713834c2be0792f786f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 4 09:58:56 2018 -0700

    Allow bk-client to support old bk-protocol (#2718)

 conf/broker.conf                                               |  3 +++
 .../java/org/apache/pulsar/broker/ServiceConfiguration.java    | 10 ++++++++++
 .../org/apache/pulsar/broker/BookKeeperClientFactoryImpl.java  |  2 +-
 3 files changed, 14 insertions(+), 1 deletion(-)

commit 3c1ce54342ca13bcf08450f0d174aa6ed4dd21ed
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 4 05:04:55 2018 -0700

    Added missing brokerServiceURL config keys in proxy.conf (#2713)

 conf/proxy.conf | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 12962d0fecae73f71e1ddfeba4d6bbe65232bcca
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Oct 4 10:30:07 2018 +0900

    Fix invalid range error when getting number of entries (#2709)
    
    For a topic with metadata similar to https://github.com/apache/pulsar/pull/2673, IllegalArgumentException may occur in the following line:
    https://github.com/apache/pulsar/blob/b2484d92d5068d4f0699eb9c3d31640cb48f9dd0/managed-ledger/src/main/java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java#L655
    
    This is the broker log when the exception has occurred:
    [invalid_range_error.txt](https://github.com/apache/pulsar/files/2442924/invalid_range_error.txt)
    
    It is because `readPosition` is ahead of `ledger.getLastPosition().getNext()`, so `ManagedCursorImpl#getNumberOfEntries()` should return 0 as the number of entries to read in that case.
    
    I think this issue and https://github.com/apache/pulsar/pull/2673 are the result of that `ledger.getLastPosition()` is no longer the real last of the managed ledger because of https://github.com/apache/pulsar/pull/1550.

 .../org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java  | 10 +++++++++-
 .../org/apache/bookkeeper/mledger/impl/ManagedCursorTest.java  |  1 +
 2 files changed, 10 insertions(+), 1 deletion(-)

commit 9ccaf2c4b8409ae37960cfb9ed16fb60d3924a7f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 3 17:33:55 2018 -0700

    Function Serverside Validation (#2701)
    
    * First cut of the serverside valiation
    
    * Revert unneeded changes
    
    * Do the easier checks first
    
    * Check for null
    
    * Simplify
    
    * Do the actual validation
    
    * Check for null runtime
    
    * Update Test
    
    * Fix build
    
    * Fix build
    
    * misc fixes
    
    * Add explicit check for serde
    
    * Changed for a better condition
    
    * Better serde check
    
    * Fixed some unittests
    
    * Fixed more tests
    
    * Fixed unittest
    
    * Fixed unittests
    
    * Fixed unittest
    
    * Stricter checks

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  10 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 224 ++---------------
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 188 ++------------
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 136 ++---------
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |   4 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    |   4 +-
 .../pulsar/functions/utils/FunctionConfig.java     |   3 +-
 .../functions/utils/FunctionConfigUtils.java       | 199 +++++++++++++++
 .../pulsar/functions/utils/SinkConfigUtils.java    | 181 ++++++++++++++
 .../pulsar/functions/utils/SourceConfigUtils.java  | 136 +++++++++++
 .../org/apache/pulsar/functions/utils/Utils.java   |  13 +-
 .../utils/validation/ConfigValidation.java         |  18 +-
 .../validation/ConfigValidationAnnotations.java    |  11 +
 .../functions/utils/validation/Validator.java      |   2 +-
 .../functions/utils/validation/ValidatorImpls.java | 173 +++++++------
 .../org/apache/pulsar/functions/worker/Utils.java  |  11 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 227 ++++++++++-------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  10 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 271 +++++++++++++--------
 19 files changed, 1014 insertions(+), 807 deletions(-)

commit 474645f7b4771e3316ca183ed0a813dd98a25758
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Oct 3 17:23:17 2018 -0700

     adding metrics to presto pulsar connector (#2631)
    
    * adding metrics to presto pulsar connector
    
    * rename batch size
    
    * adding comments
    
    * refactoring metrics
    
    * modifying bytes read metric
    
    * fixing tests
    
    * deleting tmp file
    
    * adding jars to LICENSE

 conf/presto/catalog/pulsar.properties              |   2 +-
 distribution/server/src/assemble/LICENSE.bin.txt   |   5 +
 managed-ledger/pom.xml                             |  12 +
 pulsar-sql/presto-distribution/LICENSE             |   9 +
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  17 ++
 .../pulsar/sql/presto/PulsarConnectorConfig.java   |  37 ++-
 .../sql/presto/PulsarConnectorMetricsTracker.java  | 321 +++++++++++++++++++++
 .../pulsar/sql/presto/PulsarConnectorUtils.java    |  39 +++
 .../pulsar/sql/presto/PulsarRecordCursor.java      | 111 +++++--
 .../pulsar/sql/presto/TestPulsarConnector.java     |   7 +-
 10 files changed, 529 insertions(+), 31 deletions(-)

commit 606b4de3429708cf2e008e913214a44c408e662b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Oct 3 17:22:44 2018 -0700

    Fix: Brokers redirect Schema REST requests in a loop when bundle doesn't have a leader (#2712)

 .../pulsar/broker/admin/v2/SchemasResource.java       | 19 +++++++++++++------
 1 file changed, 13 insertions(+), 6 deletions(-)

commit 5fd80a027f10695f76dd403560050a28953bfd36
Author: Grant Wu <grantwwu@gmail.com>
Date:   Wed Oct 3 18:27:37 2018 -0400

    Improve Go/macOS C++ client installation documentation (#2711)
    
    * Clarify version match requirements between Go and C++ client librarires
    
    * Document how to see local changes
    
    * Link to docs README
    
    * Move warning out from `go get` paragraph

 README.md                         | 4 ++++
 site2/README.md                   | 2 ++
 site2/docs/client-libraries-go.md | 8 +++-----
 3 files changed, 9 insertions(+), 5 deletions(-)

commit fe04ce8453b4da5dc6be6541cd039989495a7fd7
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 3 14:30:50 2018 -0700

    Avoid NullPointerException in ZK server stats collection (#2710)

 .../java/org/apache/pulsar/zookeeper/ZooKeeperServerAspect.java   | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 1f3732624bf8c398385175a4095fca8a3bcbf829
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Oct 3 12:26:46 2018 -0700

     [schema] introduce AUTO_PRODUCE schema (#2685)
    
    *Motivation*
    
    Currently trigger function is broken due to the schema enforcement we added recently:
    A producer without schema can't produce messages into a topic with schema.
    
    *Changes*
    
    - Rename `AUTO` to `AUTO_CONSUME`
    - Introduce `AUTO_PRODUCE` schema. The schema produces `byte[]`, but it will validate
      the bytes are compatible with the schema associated with the topic before producing.
    - Change trigger function to use `AUTO_PRODUCE` schema.

 .../api/SimpleTypedProducerConsumerTest.java       | 78 +++++++++++++++++++++-
 .../java/org/apache/pulsar/client/api/Schema.java  | 48 ++++++++++++-
 .../{AutoSchema.java => AutoConsumeSchema.java}    |  2 +-
 .../client/impl/schema/AutoProduceBytesSchema.java | 68 +++++++++++++++++++
 .../impl/schema/generic/GenericSchemaTest.java     |  6 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 44 +++++++++---
 .../apache/pulsar/common/schema/SchemaType.java    | 13 +++-
 .../pulsar/functions/source/TopicSchema.java       |  7 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |  9 ++-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    |  8 +--
 10 files changed, 253 insertions(+), 30 deletions(-)

commit 25d52ebd4591cfcaf4005212ce4661c27c1551c1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Oct 3 12:06:15 2018 -0700

    Have the ability to specify custom labels for k8 jobs (#2702)
    
    ### Motivation
    
    This pr will allow functions being deployed as kubernetes jobs have installation defined labels.

 .../java/org/apache/pulsar/functions/runtime/KubernetesRuntime.java | 6 ++++++
 .../apache/pulsar/functions/runtime/KubernetesRuntimeFactory.java   | 6 ++++++
 .../org/apache/pulsar/functions/runtime/KubernetesRuntimeTest.java  | 2 +-
 .../org/apache/pulsar/functions/worker/FunctionRuntimeManager.java  | 1 +
 .../main/java/org/apache/pulsar/functions/worker/WorkerConfig.java  | 2 ++
 5 files changed, 16 insertions(+), 1 deletion(-)

commit 3bdd6ecf04146e035ef9a5e3f2e1a32d15134dd0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Oct 3 11:59:59 2018 -0700

    Fix: apache-rat validation (#2700)

 conf/presto/jvm.config                   | 21 ++++++++++++++++++++-
 distribution/server/src/assemble/src.xml |  1 +
 2 files changed, 21 insertions(+), 1 deletion(-)

commit af85a05ef8c76862e0fccd8261ee4616da073fd2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Oct 3 11:59:46 2018 -0700

    add wagon-ssh plugin to modules not inherit pulsar parent (#2696)

 buildtools/pom.xml                     | 7 +++++++
 pulsar-sql/presto-distribution/pom.xml | 7 +++++++
 2 files changed, 14 insertions(+)

commit 5e9c35c67db5ae2f47a72ebb15c9adbeecca3c90
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 3 11:56:53 2018 -0700

    Do not register each DispatchRateLimiter for policies notifications (#2699)
    
    * Do not register each DispatchRateLimiter for policies notifications
    
    * Fixed updates on per-subscriptions limits
    
    * Fixed testClusterPolicyOverrideConfiguration

 .../apache/pulsar/broker/service/Dispatcher.java   | 10 ++--
 .../service/persistent/DispatchRateLimiter.java    | 58 +++++++++-------------
 .../PersistentDispatcherMultipleConsumers.java     |  5 ++
 .../PersistentDispatcherSingleActiveConsumer.java  |  5 ++
 .../broker/service/persistent/PersistentTopic.java | 10 +++-
 .../SubscriptionMessageDispatchThrottlingTest.java |  9 ++++
 6 files changed, 58 insertions(+), 39 deletions(-)

commit e31c2d8e0885ba9490c7f2b2acdafd26996ded23
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Oct 3 11:15:33 2018 -0700

    [functions][metrics] Update function metrics (#2686)
    
    * Fix stats generator
    
    * Set the response to text/plain
    
    * fix TopicStats and NamespaceStats

 .../stats/prometheus/NamespaceStatsAggregator.java | 25 ++-------------
 .../pulsar/broker/stats/prometheus/TopicStats.java | 36 +++-------------------
 .../functions/worker/FunctionsStatsGenerator.java  | 10 +-----
 .../worker/rest/api/FunctionsMetricsResource.java  |  5 ++-
 4 files changed, 13 insertions(+), 63 deletions(-)

commit 8d075d25e87a0fca1298a8e662e1e22be9423059
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Thu Oct 4 01:46:32 2018 +0800

    add kafka source connect adaptor for debezium (#2705)
    
    ### Motivation
    
    add kafka source connect adaptor for debezium
    This will save data from kafka source connect into Pulsar.
    
    ### Modifications
    
    add class and test
    
    ### Result
    
    ut pass

 pulsar-io/debezium/pom.xml                         |   6 +
 pulsar-io/kafka-connect-adaptor/pom.xml            | 105 ++++++++++
 .../io/kafka/connect/KafkaConnectSource.java       | 213 +++++++++++++++++++++
 .../kafka/connect/PulsarIOSourceTaskContext.java   |  36 ++++
 .../io/kafka/connect}/PulsarKafkaWorkerConfig.java |   2 +-
 .../kafka/connect}/PulsarOffsetBackingStore.java   |   4 +-
 .../io/kafka/connect/KafkaConnectSourceTest.java   | 126 ++++++++++++
 .../connect}/PulsarOffsetBackingStoreTest.java     |   2 +-
 pulsar-io/pom.xml                                  |   1 +
 9 files changed, 491 insertions(+), 4 deletions(-)

commit 6b725feb2ed9b4802343fb884c6bf573eaad5ebf
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Oct 2 22:18:16 2018 -0700

    [tests] create consumers before producing for DeadLetterTopicTest (#2648)
    
    ### Motivation
    
    Create consumers before producing will make sure consumers received all the messages that they expect to receive.

 .../pulsar/client/api/DeadLetterTopicTest.java     | 78 ++++++++++++----------
 1 file changed, 42 insertions(+), 36 deletions(-)

commit 044ba40650a67262fad4936914d3c31602dc552d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 2 15:00:02 2018 -0700

    Avoid scheduling heartbeat function if owner-worker not available (#2613)
    
    * Avoid scheduling heartbeat function if owner-worker not available
    
    * fix: heartbeat function place
    
    * add heartbeat check at scheduler-manager
    
    * create seaparate list for heatbeat functions

 .../pulsar/functions/worker/MembershipManager.java |  5 ++
 .../pulsar/functions/worker/SchedulerManager.java  | 44 ++++++++++---
 .../functions/worker/scheduler/IScheduler.java     | 15 ++++-
 .../worker/scheduler/RoundRobinScheduler.java      | 25 ++------
 .../functions/worker/MembershipManagerTest.java    | 75 ++++++++++++++++++++++
 .../functions/worker/SchedulerManagerTest.java     |  8 +--
 6 files changed, 138 insertions(+), 34 deletions(-)

commit 8191fcfcd9f0df0f83aa683e8ef655962e616f73
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Oct 2 14:48:07 2018 -0700

    Admission checks (#2692)
    
    * Introduce Admission Control to RuntimeFactory
    
    * Add tests for update as well
    
    * Fixed unittest

 .../pulsar/functions/runtime/KubernetesRuntime.java      |  4 ++--
 .../functions/runtime/KubernetesRuntimeFactory.java      |  6 ++++++
 .../apache/pulsar/functions/runtime/RuntimeFactory.java  |  3 +++
 .../pulsar/functions/worker/rest/api/FunctionsImpl.java  | 16 ++++++++++++++++
 .../worker/rest/api/v2/FunctionApiV2ResourceTest.java    | 12 ++++++++----
 5 files changed, 35 insertions(+), 6 deletions(-)

commit f7022df6cc5c443cb56dfe133e81a77ff9b7ad72
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Oct 2 13:49:29 2018 -0700

    Add Presto Sql Test (#2504)
    
    * Add Presto SQL Test
    
    Add Pulsar Presto Container
    
    * Add prest query test
    
    Fix netty dependency

 pom.xml                                            |  11 ++
 .../docker-images/latest-version-image/Dockerfile  |   4 +-
 .../latest-version-image/conf/presto_worker.conf   |  26 +++++
 .../scripts/run-presto-worker.sh                   |  29 +++++
 tests/integration/pom.xml                          |   9 +-
 .../containers/PrestoWorkerContainer.java          |  39 +++++++
 .../pulsar/tests/integration/presto/Stock.java     |  82 +++++++++++++
 .../tests/integration/presto/TestBasicPresto.java  | 127 +++++++++++++++++++++
 .../integration/topologies/PulsarCluster.java      |  76 +++++++++---
 .../integration/topologies/PulsarClusterSpec.java  |   9 ++
 10 files changed, 396 insertions(+), 16 deletions(-)

commit 1bdbad348a032d1bf93c5f514c89e81278219f54
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 2 09:42:47 2018 -0700

    Ensumer Mocked BK client triggers the addEntry callbacks in order (#2694)

 .../test/java/org/apache/bookkeeper/client/PulsarMockLedgerHandle.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 248e3296412f1d5471fc048947e687f2374e8b68
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 1 21:25:54 2018 -0700

    Process mode covers function_details in quotes. We need to remove that (#2693)

 pulsar-functions/instance/src/main/python/python_instance_main.py   | 5 +++++
 .../java/org/apache/pulsar/functions/runtime/JavaInstanceMain.java  | 6 ++++++
 2 files changed, 11 insertions(+)

commit 054a7840c8987dee9008f9a9e49393074a7c763c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Oct 1 20:16:10 2018 -0700

    [function] Fix expected health check interval (#2684)
    
    *Motivation*
    
    Java instance main is expecting health check interval in seconds.
    
    *Changes
    
    Make sure the health check interval is passed in seconds.
    
    *Tests*
    
    It fixes following issue
    
    ```
    14:36:29.528 [FunctionActionerThread] INFO  org.apache.pulsar.functions.runtime.ProcessRuntime - Started process successfully
    Exception in thread "main" java.lang.IllegalArgumentException
            at java.util.concurrent.ScheduledThreadPoolExecutor.scheduleAtFixedRate(ScheduledThreadPoolExecutor.java:565)
            at java.util.concurrent.Executors$DelegatedScheduledExecutorService.scheduleAtFixedRate(Executors.java:735)
            at org.apache.pulsar.functions.runtime.JavaInstanceMain.start(JavaInstanceMain.java:154)
            at org.apache.pulsar.functions.runtime.JavaInstanceMain.main(JavaInstanceMain.java:185)
    ```

 .../main/java/org/apache/pulsar/functions/runtime/RuntimeFactory.java   | 2 ++
 .../main/java/org/apache/pulsar/functions/runtime/RuntimeSpawner.java   | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)

commit ac9fb4c2ce34a9a46466f59dd6e74c432e8829c4
Author: Jean-Bernard van Zuylen <jbvanzuylen@primeoservices.org>
Date:   Tue Oct 2 02:23:50 2018 +0200

    Fixed default value for batchingMaxPublishDelay in javadoc (#2690)

 .../src/main/java/org/apache/pulsar/client/api/ProducerBuilder.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b2484d92d5068d4f0699eb9c3d31640cb48f9dd0
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Oct 2 09:23:25 2018 +0900

    Avoid problem that topic becomes unavailable due to failure of cursor recovery (#2673)
    
    * Avoid problem that topic becomes unavailable due to failure of cursor recovery
    
    * Add unit test

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  7 ++-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 60 ++++++++++++++++++++++
 2 files changed, 66 insertions(+), 1 deletion(-)

commit fd76151613ff9db4337668e3b770b089981d93a5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Oct 1 15:31:49 2018 -0700

    [tests] disabled cassandra connector test and python function test (#2683)
    
    * [tests] disabled cassandra connector test and python function test
    
    These 3 tests are having some weird problems. Disabling them to bring integration tests back to normal.
    Will fix them in the subsequent changes
    
    * pull mysql image
    
    * add empty constructor

 .../java/org/apache/pulsar/functions/api/examples/pojo/Tick.java    | 2 ++
 .../pulsar/tests/integration/functions/PulsarFunctionsTest.java     | 6 +++---
 tests/scripts/pre-integ-tests.sh                                    | 1 +
 3 files changed, 6 insertions(+), 3 deletions(-)

commit d0858065b586344cb7b1b8a5a32e694bc6c004f4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Oct 1 11:48:53 2018 -0700

    Enable Pulsar Functions to be deployed on a kubernetes cluster (#1950)
    
    * Support submitting pulsar functions to kubernetes
    
    * Adjusted pom
    
    * Added helper function
    
    * Added port to instance config
    
    * Made things public
    
    * More fixes
    
    * Made changes to kubernetes controller
    
    * refactored jobname
    
    * Removed resource
    
    * Bumped to 2.1.0
    
    * Fix compilation bug
    
    * Fix compile bugs
    
    * Fixed compile
    
    * Compile fix
    
    * Some remant
    
    * Unnecessary imports
    
    * Added dep
    
    * Default values
    
    * Fix
    
    * Use kubectl proxy stuff
    
    * Corrected the path of pulsar-amin
    
    * Fixed bugs
    
    * No longer required
    
    * Download first
    
    * make shard id work
    
    * Removed using runtime
    
    * Fixed npe
    
    * Corrected command name
    
    * Fixed bugs
    
    * Removed commented sections
    
    * Uncommented some stuff
    
    * Address Jerry's comments
    
    * Change to 2.2
    
    * Use non camel case style for passing arguments
    
    * removed cmdline changes
    
    * Second set of changes
    
    * Next set of canges
    
    * no such module
    
    * Code complete
    
    * Fixed logic wrt packages
    
    * Do not stop externally managed functions upon exit
    
    * Modified to use AppV1 instead of beta
    
    * use lower case
    
    * Unpretty the function details
    
    * If the job exists, don't flag as error
    
    * Give ability to submit from inside a pod
    
    * remove encode/decode
    
    * Escape function details
    
    * Working copy with getstatus and stop. Restart needs some work
    
    * removed unused function
    
    * Fixed bugs
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed unittest
    
    * Fixed tests
    
    * Reverted conf changes
    
    * Minor nit
    
    * Exlcude logback
    
    * Updated comments
    
    * Changed jobname to include namespace/tenant
    
    * Fix unittest
    
    * Updated licenses
    
    * Use 2.0.0 instead of beta1

 conf/functions_worker.yml                          |   2 +
 distribution/server/src/assemble/LICENSE.bin.txt   |  10 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   4 +-
 pulsar-functions/runtime/pom.xml                   |  13 +
 .../pulsar/functions/runtime/JavaInstanceMain.java |   3 +-
 .../functions/runtime/KubernetesRuntime.java       | 551 +++++++++++++++++++++
 .../runtime/KubernetesRuntimeFactory.java          | 155 ++++++
 .../pulsar/functions/runtime/ProcessRuntime.java   | 111 +----
 .../functions/runtime/ProcessRuntimeFactory.java   |   1 +
 .../apache/pulsar/functions/runtime/Runtime.java   |   6 +-
 .../pulsar/functions/runtime/RuntimeFactory.java   |   4 +-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  37 +-
 .../pulsar/functions/runtime/RuntimeUtils.java     | 135 +++++
 .../pulsar/functions/runtime/ThreadRuntime.java    |   2 +-
 .../functions/runtime/ThreadRuntimeFactory.java    |   3 +-
 .../functions/runtime/KubernetesRuntimeTest.java   | 156 ++++++
 .../functions/runtime/ProcessRuntimeTest.java      |  12 +-
 .../pulsar/functions/worker/FunctionActioner.java  |  16 +-
 .../functions/worker/FunctionRuntimeManager.java   | 125 +++--
 .../pulsar/functions/worker/MembershipManager.java |   2 +-
 .../pulsar/functions/worker/SchedulerManager.java  |  23 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  16 +
 .../functions/worker/rest/api/FunctionsImpl.java   |  12 +-
 .../functions/worker/FunctionActionerTest.java     |   2 +-
 .../functions/worker/SchedulerManagerTest.java     |  22 +
 25 files changed, 1245 insertions(+), 178 deletions(-)

commit e7930f3d97cf64292aa507afeca6da824d714c60
Author: penghui <codelipenghui@gmail.com>
Date:   Mon Oct 1 09:03:29 2018 +0800

    Change access to public for method getProducers(). (#2663)
    
    ### Motivation
    
    Need to get stats from producers in PartitionedProducerImpl.
    
    ### Modifications
    
    Change access to public for method getProducers().

 .../java/org/apache/pulsar/client/impl/PartitionedProducerImpl.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f8256e623ea15865abeb0ec2d8dc392371c426de
Author: Ivan Kelly <ivank@apache.org>
Date:   Sun Sep 30 21:06:29 2018 +0200

    Allow user to get topic from consumer message (#2007) (#2135)
    
    When a user receives a message, allow them to get the topic from the
    message itself. This is mostly useful in the case where a single
    consumer is subscribed to multiple topics.
    
    The change also contains a minor cleanup of the constructors in
    MessageImpl.

 .../pulsar/client/api/ProducerConsumerBase.java    |   6 ++
 .../pulsar/client/impl/TopicFromMessageTest.java   | 117 +++++++++++++++++++++
 .../pulsar/client/admin/internal/TopicsImpl.java   |  14 +--
 .../java/org/apache/pulsar/client/api/Message.java |   7 ++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  15 +--
 .../org/apache/pulsar/client/impl/MessageImpl.java |  47 ++++-----
 .../apache/pulsar/client/impl/MessageParser.java   |  14 ++-
 .../pulsar/client/impl/TopicMessageImpl.java       |   6 +-
 .../apache/pulsar/client/impl/MessageImplTest.java |   9 +-
 .../org/apache/pulsar/common/naming/TopicName.java |  11 +-
 .../pulsar/PulsarConsumerSourceTests.java          |   4 +-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    |   2 +-
 12 files changed, 198 insertions(+), 54 deletions(-)

commit 29382dcac23bb4979e48082ff64ce69752cdc257
Author: Liang-Chi Hsieh <viirya@gmail.com>
Date:   Mon Oct 1 03:04:34 2018 +0800

    Fix ConsumerBuilder and PulsarClient document (#2681)
    
    ### Motivation
    
    There are few document error in code. We should fix them.
    
    ### Modifications
    
    Fixes document in `ConsumerBuilder` and `PulsarClient`.

 .../main/java/org/apache/pulsar/client/api/ConsumerBuilder.java   | 7 +------
 .../src/main/java/org/apache/pulsar/client/api/PulsarClient.java  | 8 ++++----
 2 files changed, 5 insertions(+), 10 deletions(-)

commit 671c7bc6eaba0555d18b008e75a02f37ede3677d
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sun Sep 30 12:02:06 2018 -0700

    Add support for schema extraction from a jar (#2578)
    
    Add options to create a schema based on pojo class in a jar.

 .../org/apache/pulsar/admin/cli/CmdSchemas.java    | 45 +++++++++++++
 .../pulsar/admin/cli/utils/SchemaExtractor.java    | 37 ++++++++++
 .../pulsar/functions/api/examples/pojo/Tick.java   | 71 ++++++++++++++++++++
 .../pulsar/tests/integration/cli/CLITest.java      | 78 ++++++++++++++++++++--
 4 files changed, 226 insertions(+), 5 deletions(-)

commit ff6de4a4f754ed7d14d64903f3baf05bdd90d23c
Author: Ivan Kelly <ivank@apache.org>
Date:   Sun Sep 30 20:36:21 2018 +0200

    Clarify and add tests for schema change scenarios (#2669)
    
    A producer with a schema can attach to a topic if
    - the topic does not exist
    - the topic exists but currently has no schema
    - the topic exists and the schema is compatible with the producer
      schema
    
    A consumer with a schema can attach to a topic if
    - the topic does not exist (the schema from the consumer is added to
      the topic)
    - the topic exists and the schema is compatible with the consumer
      schema
    
    A producer without a schema can attach if
    - the topic does not exist
    - the topic exists and has no schema
    
    A consumer without a schema can attach if
    - the topic exists, either with or without a schema

 .../org/apache/pulsar/broker/PulsarService.java    |   2 +-
 .../broker/admin/impl/PersistentTopicsBase.java    |   2 +-
 .../pulsar/broker/service/BrokerService.java       |  40 ++----
 .../apache/pulsar/broker/service/ServerCnx.java    |  41 ++++--
 .../org/apache/pulsar/broker/service/Topic.java    |  19 +++
 .../service/nonpersistent/NonPersistentTopic.java  |  21 +++
 .../broker/service/persistent/PersistentTopic.java |  21 +++
 .../service/schema/SchemaRegistryServiceImpl.java  |  51 +++----
 .../broker/service/BrokerBkEnsemblesTests.java     |   6 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |  10 +-
 .../apache/pulsar/client/api/SimpleSchemaTest.java | 148 +++++++++++++++++++--
 11 files changed, 270 insertions(+), 91 deletions(-)

commit f5d8b9ae7fd2ec177f8c1c98e215ae051f63c45a
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Sep 30 11:35:19 2018 -0700

    Add types comment in Prometheus stats (#2679)
    
    ### Motivation
    
    While metrics types are optional in the Prometheus format (and ignored by Prometheus server), some external tools (eg: DataDog) are failing to ingest the metrics exported by Pulsar broker in Prometheus format.
    
    The reason is that we use a custom exporter and we don't mark the metrics types, such as the Prometheus regular libraries are doing.
    
    ### Modifications
    
     * Ensure metric type is printed, once, before the metric is printed
     * Removed space after comma in labels. While this is parsed correctly by all implementation, the spec doesn't actually allow a space in that position.

 .../stats/prometheus/NamespaceStatsAggregator.java | 30 +++++++++--
 .../prometheus/PrometheusMetricsGenerator.java     | 23 +++++++-
 .../pulsar/broker/stats/prometheus/TopicStats.java | 62 +++++++++++++++++-----
 .../pulsar/broker/stats/PrometheusMetricsTest.java |  2 +-
 .../functions/worker/FunctionsStatsGenerator.java  | 19 ++++++-
 .../worker/FunctionStatsGeneratorTest.java         |  2 +-
 6 files changed, 115 insertions(+), 23 deletions(-)

commit 357c5d14f19df3856ba77c6b284bde80ac945d3c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Sep 29 23:49:04 2018 -0700

    mismatch package for AggregatedNamespaceStatsTest (#2677)

 .../{ => broker}/stats/prometheus/AggregatedNamespaceStatsTest.java       | 0
 1 file changed, 0 insertions(+), 0 deletions(-)

commit 1d7bb1729ede3a2e4a6aaf5ff585f13b378239bf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Sep 29 00:28:36 2018 -0700

    Fix sink-record to get topic name (#2675)

 .../main/java/org/apache/pulsar/functions/instance/SinkRecord.java   | 5 +++++
 1 file changed, 5 insertions(+)

commit f4eaa586f4050c420ed139e80be27f9182cc7178
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Sep 28 15:53:31 2018 -0700

    Fixed typo in docs (#2674)

 site2/docs/concepts-messaging.md                                        | 2 +-
 .../versioned_docs/version-2.1.0-incubating/concepts-messaging.md       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 464e7d136062aacd5db0e062b09dd0528d14a045
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Sep 28 12:19:05 2018 -0700

    Simplify ServiceUrlProvider related APIs (#2671)

 .../pulsar/client/api/ServiceUrlProviderTest.java  |  8 ++---
 .../org/apache/pulsar/client/api/PulsarClient.java | 35 ++++++++--------------
 .../pulsar/client/api/ServiceUrlProvider.java      | 25 ++++++++++------
 .../client/impl/BinaryProtoLookupService.java      |  8 +++--
 .../pulsar/client/impl/ClientBuilderImpl.java      |  2 +-
 .../apache/pulsar/client/impl/ConnectionPool.java  | 20 ++++++++++++-
 .../org/apache/pulsar/client/impl/HttpClient.java  | 18 ++++++-----
 .../pulsar/client/impl/HttpLookupService.java      |  5 ++++
 .../apache/pulsar/client/impl/LookupService.java   |  6 ++++
 .../pulsar/client/impl/PulsarClientImpl.java       | 22 ++++----------
 10 files changed, 86 insertions(+), 63 deletions(-)

commit 2c2e0ddaad1db5a928df45ed2f44a4e40103638a
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 27 23:14:26 2018 -0400

    Fixed HTTP redirects with proxy handler (#2670)

 .../pulsar/proxy/server/AdminProxyHandler.java     | 69 +++++++++++++++++-
 .../pulsar/tests/integration/proxy/TestProxy.java  | 83 ++++++++++++++++++++++
 2 files changed, 149 insertions(+), 3 deletions(-)

commit edd4bedb975cdcb95f1343efcc26cf82af24d422
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Sep 27 15:21:44 2018 -0700

    Python Functions support topic pattern, so removing this check (#2668)

 .../java/org/apache/pulsar/functions/runtime/RuntimeSpawner.java    | 6 ------
 1 file changed, 6 deletions(-)

commit 30f693521269107cf613a2df59967c871c14b519
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Sep 27 08:20:23 2018 +0200

    Allow byte[] keys for messages (#1016) (#2612)
    
    Sometimes it can be useful to send something more complex than a
    string as the key of the message. However, early on Pulsar chose to
    make String the only way to send a key, and this permeates throughout
    the code, so we can't very well change it now.
    
    This patch adds rudamentary byte[] key support. If a user adds a
    byte[] key, the byte[] is base64 encoded and stored in the normal key
    field. We also send a flag to denote that it is base64 encoded, so the
    receiving end knows to decode it correct. There's no schema or
    anything attached to this. Any SerDe has to be handled manually by the
    client.

 .../org/apache/pulsar/client/api/BytesKeyTest.java |  76 ++++++++++++++
 .../java/org/apache/pulsar/client/api/Message.java |  16 ++-
 .../pulsar/client/api/TypedMessageBuilder.java     |   8 ++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  19 ++++
 .../pulsar/client/impl/TopicMessageImpl.java       |  10 ++
 .../client/impl/TypedMessageBuilderImpl.java       |   9 ++
 .../org/apache/pulsar/common/api/Commands.java     |   3 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 114 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   4 +
 9 files changed, 257 insertions(+), 2 deletions(-)

commit e15a606549bd4cccf32f37863934a0b1916fc3cc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Sep 26 10:44:50 2018 -0700

    implement topic routing on a per record basis (#2605)
    
    ### Motivation
    
    There are use cases that the destination topic for a message cannot be determined at source submission time.  This requires the ability for sources to to set which topic a record should be written to.
    
    ### Modifications
    
    1. add an interface Record that allows users to set the destination topic for a record
    2. Refactored the Pulsar sink code to support this

 .../org/apache/pulsar/functions/api/Record.java    |   9 +
 .../functions/instance/JavaInstanceRunnable.java   |  24 +-
 .../pulsar/functions/instance/SinkRecord.java      |   4 +
 .../producers/AbstractOneOuputTopicProducers.java  |  73 ------
 .../MultiConsumersOneOuputTopicProducers.java      |  98 --------
 .../functions/instance/producers/Producers.java    |  55 -----
 .../apache/pulsar/functions/sink/PulsarSink.java   | 207 ++++++++--------
 .../MultiConsumersOneOutputTopicProducersTest.java | 249 --------------------
 .../pulsar/functions/sink/PulsarSinkTest.java      | 260 +++++++++++++++++++++
 9 files changed, 391 insertions(+), 588 deletions(-)

commit fa44e19f2e28922c6bbf609d5d473b911a8de1f5
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 26 13:42:23 2018 -0400

    Fixed links in download page (#2654)
    
    ### Motivation
    
    The existing releases were moved from `incubator/pulsar` to `pulsar` folder in mirrors. There's no need to differentiate between incubator and later releases in terms of paths.

 site2/website/pages/en/download.js | 18 +++---------------
 1 file changed, 3 insertions(+), 15 deletions(-)

commit 3f8ad30b873429ed5feafecd728b73730725430a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 26 13:41:38 2018 -0400

    Fixed flaky test BatchMessageTest.testBatchAndNonBatchCumulativeAcks (#2661)
    
    ### Motivation
    
    Fixed flaky test :
    
    ```
    Skip Message
    
    expected [0] but found [4]
    
    Standard Output
    
    Created annotation listener
    13:24:36.970 [main:org.apache.pulsar.broker.PulsarService@319] INFO  org.apache.pulsar.broker.PulsarService - Starting Pulsar Broker service; version: '2.2.0.0-SNAPSHOT'
    13:24:36.982 [main:org.apache.pulsar.broker.PulsarService@320] INFO  org.apache.pulsar.broker.PulsarService - Git Revision b4b348da6dade88fbf08bc8f49e28f280455d985
    13:24:36.984 [main:org.apache.pulsar.broker.PulsarService@321] INFO  org.apache.pulsar.broker.PulsarService - Built by  <> on asf902.gq1.y
    ...[truncated 42534 chars]...
     position3:28:-1:4 data [B@6507f56b
    13:24:43.543 [TestNG-method=testBatchAndNonBatchCumulativeAcks-1:org.apache.pulsar.broker.service.BatchMessageTest@563] INFO  org.apache.pulsar.broker.service.BatchMessageTest - [bnb-sub-1] got message position3:29:-1 data [B@4ebac723
    13:24:43.543 [TestNG-method=testBatchAndNonBatchCumulativeAcks-1:org.apache.pulsar.broker.service.BatchMessageTest@569] INFO  org.apache.pulsar.broker.service.BatchMessageTest - [bnb-sub-1] did cumulative ack on position3:29:-1
    ```
    
    Core issue is that the acks are by default grouped with 100ms delay. The `Thread.sleep(100)` was not enough to cover for that.
    
    ### Modifications
    
    Removed ack grouping for this test.

 .../org/apache/pulsar/broker/service/BatchMessageTest.java   | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

commit be5e847a18c12453c6a98b93eb1bb3da6eeb70b8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Sep 26 10:11:33 2018 -0700

    [functions] change instance id from string to int and expose number of instances in context (#2411)
    
    * [functions] change instance id from string to int and expose number of instances in context
    
     ### Motivation
    
    When writing a connector reading from a list of sources, it is hard for the connector implementation to decide how
    to distribute the list of sources across the function instances. because there is no way to tell how many function
    instances is running.
    
     ### Changes
    
    - change instance id from string to integer (since the implementation is already assuming instance id is an integer)
    - add getNumInstances in the context
    - expose both interfaces in source and sink connector context
    
    * Fix compilation

 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java    |  2 +-
 .../java/org/apache/pulsar/functions/api/Context.java     |  9 ++++++++-
 .../org/apache/pulsar/functions/instance/ContextImpl.java |  9 +++++++--
 .../apache/pulsar/functions/instance/InstanceConfig.java  | 11 ++++++++++-
 .../pulsar/functions/instance/JavaInstanceRunnable.java   | 15 +++++++--------
 .../apache/pulsar/functions/windowing/WindowContext.java  |  2 +-
 .../pulsar/functions/windowing/WindowContextImpl.java     |  2 +-
 .../apache/pulsar/functions/runtime/JavaInstanceMain.java |  2 +-
 .../apache/pulsar/functions/runtime/ProcessRuntime.java   |  2 +-
 .../apache/pulsar/functions/runtime/RuntimeSpawner.java   |  4 ++--
 .../pulsar/functions/runtime/ProcessRuntimeTest.java      |  2 +-
 .../apache/pulsar/functions/worker/FunctionActioner.java  |  2 +-
 .../main/java/org/apache/pulsar/io/core/SinkContext.java  | 15 +++++++++++++++
 .../java/org/apache/pulsar/io/core/SourceContext.java     | 15 +++++++++++++++
 14 files changed, 71 insertions(+), 21 deletions(-)

commit cb52d519ce53d863a24c1dbf082b1db3e8b62fe8
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Sep 26 22:21:01 2018 +0800

    Access function state by rest endpoint (#2653)
    
    add get function state by rest endpoint

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 21 ++++++
 .../org/apache/pulsar/client/admin/Functions.java  | 40 ++++++++--
 .../client/admin/internal/FunctionsImpl.java       | 17 ++++-
 .../functions/worker/rest/api/FunctionsImpl.java   | 88 +++++++++++++++++++++-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 10 +++
 5 files changed, 169 insertions(+), 7 deletions(-)

commit e809faa9f47f6a39a9d7d611daa320b7edb43b3b
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Sep 26 22:18:26 2018 +0800

    Fix Bug of ConsumerInterceptor on method onAcknowledge() (#2656)
    
    Motivation
    To fix bug for #2655
    
    Modifications
    Add call interceptor logic in markAckForBatchMessage method.
    
    Result
    Consumer acknowledge the batch message will call onAcknowledge() for every messages in batch message.

 .../src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java       | 2 ++
 1 file changed, 2 insertions(+)

commit 3da0c9844dc5b8bf59df42e3a95bc618a1c7cf32
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 25 22:53:27 2018 -0700

    Fix: web-thread stuck on function metadata update (#2634)
    
    ### Motivation
    
    If function metadata-producer gets disconnected  from broker then function-registration admin-api thread gets stuck.
    ```
    sun.misc.Unsafe.park(boolean, long) @bci=0 (Compiled frame; information may be imprecise)
     - java.util.concurrent.locks.LockSupport.park(java.lang.Object) @bci=14, line=175 (Interpreted frame)
     - java.util.concurrent.CompletableFuture$Signaller.block() @bci=19, line=1693 (Interpreted frame)
     - java.util.concurrent.ForkJoinPool.managedBlock(java.util.concurrent.ForkJoinPool$ManagedBlocker) @bci=119, line=3323 (Interpreted frame)
     - java.util.concurrent.CompletableFuture.waitingGet(boolean) @bci=129, line=1729 (Interpreted frame)
     - java.util.concurrent.CompletableFuture.get() @bci=11, line=1895 (Interpreted frame)
     - org.apache.pulsar.functions.worker.rest.api.FunctionsImpl.updateRequest(org.apache.pulsar.functions.proto.Function$FunctionMetaData) @bci=18, line=562 (Interpreted frame)
     - org.apache.pulsar.functions.worker.rest.api.FunctionsImpl.registerFunction(java.lang.String, java.lang.String, java.lang.String, java.io.InputStream, org.glassfish.jersey.media.multipart.FormDataContentDisposition, java.lang.String, java.lang.String, java.lang.String) @bci=461, line=190 (Interpreted frame)
     - org.apache.pulsar.functions.worker.rest.api.v2.FunctionApiV2Resource.registerFunction(java.lang.String, java.lang.String, java.lang.String, java.io.InputStream, org.glassfi
    ```
    
    
    ### Modifications
    
    Complete future on which function-admin-api-thread is waiting if fun-metadata publish fails.
    
    ### Result
    
    function-worker threads will not stuck while registering function-metadata.

 .../pulsar/functions/worker/FunctionMetaDataManager.java       | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit c1ecdab37f3082bbcbae0da9dd6ab39701ecfb73
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 25 11:08:46 2018 -0700

    clear old function failure exception from stats (#2632)
    
    ### Motivation
    
    Right now, if function fails first time and then starts and runs successfully then still function-stats shows old exception in stats which confuses user regarding function current state.
    
    ### Modifications
    
    Hide old exception if function started successfully.

 .../java/org/apache/pulsar/functions/runtime/RuntimeSpawner.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 12e98cd1695f1b6c8a7fa946b149ab479f117133
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 25 13:06:46 2018 -0400

    In ZK 3.4.13 the elapsed time is not anymore based on System.currentTimeMillis() (#2628)
    
    ### Motivation
    
    In ZK dashboard, the latency metrics are showing wrong values (eg: 48 years).
    
    The problem is that we rely on AspectJ to get access to ZK internals and add instrumentation. The "request start" timestamp in ZK 3.4.13 has been changed from using `System.currentTimeMillis()` to `System.nanoTime() / 100000`.
    
    We need to change the timestamp we use for end operation as well.

 .../java/org/apache/pulsar/zookeeper/FinalRequestProcessorAspect.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 828af53b202da06ab8a36f9c4ff5c3765eeb9657
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 25 10:05:43 2018 -0700

    Gracefully shutdown function worker service (#2635)
    
    ### Motivation
    
    Right now, if broker is down when function service starts, it fails to start worker and keeps the process hanging in a failure state. Also, function-worker doesn't close resource on sigterm or while shutting down.
    ```
    
            19:26:56.037 [main] ERROR org.apache.pulsar.functions.worker.Worker - Failed to start worker
    java.lang.RuntimeException: java.lang.RuntimeException: org.apache.pulsar.client.api.PulsarClientException$TimeoutException: 0 lookup request timedout after ms 1
            at org.apache.pulsar.functions.worker.WorkerService.start(WorkerService.java:184) ~[classes/:?]
            at org.apache.pulsar.functions.worker.Worker.doStartImpl(Worker.java:64) ~[classes/:?]
            at org.apache.pulsar.functions.worker.Worker.doStart(Worker.java:52) [classes/:?]
            at com.google.common.util.concurrent.AbstractService.startAsync(AbstractService.java:211) [guava-21.0.jar:?]
            at org.apache.pulsar.functions.worker.FunctionWorkerStarter.main(FunctionWorkerStarter.java:64) [classes/:?]
    ```
    ### Modifications
    
    - shutdown worker if it fails to start
    - gracefully shutdown worker service.

 .../functions/worker/FunctionWorkerStarter.java    | 15 ++++++++++-
 .../org/apache/pulsar/functions/worker/Worker.java | 30 ++++++++--------------
 2 files changed, 25 insertions(+), 20 deletions(-)

commit 93000ed80438199110e5e714f4f32397193ed450
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Sep 25 23:34:21 2018 +0800

    Debezium: kafka connect offset store (#2627)
    
    ### Motivation
    
    This is based on PR #2614, please check and review starting from the 3rd commit
    It mainly want to PulsarOffsetBackingStore.
    
    ### Modifications
    
    add PulsarOffsetBackingStore and test for it.
    
    ### Result
    
    ut pass

 pulsar-io/debezium/pom.xml                         |   6 +
 .../io/debezium/PulsarKafkaWorkerConfig.java       |  63 ++++++
 .../io/debezium/PulsarOffsetBackingStore.java      | 235 +++++++++++++++++++++
 .../io/debezium/PulsarOffsetBackingStoreTest.java  | 152 +++++++++++++
 4 files changed, 456 insertions(+)

commit 96c10dc5d2d55bb9132f25b465e9062855e42285
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 25 10:44:41 2018 -0400

    Removed mentions to incubator-pulsar (#2620)
    
    * Removed mentions to incubator-pulsar
    
    * Removed DISCLAIMER link from offloaders package
    
    * Trigger build

 .test-infra/jenkins/common_job_properties.groovy   | 12 +++---
 .test-infra/jenkins/job_seed.groovy                |  2 +-
 .travis.yml                                        |  6 +--
 DISCLAIMER                                         |  6 ---
 README.md                                          |  8 ++--
 dashboard/README.md                                |  2 +-
 distribution/io/src/assemble/README                |  2 +-
 distribution/io/src/assemble/io.xml                |  5 ---
 distribution/offloaders/src/assemble/README        |  2 +-
 .../offloaders/src/assemble/offloaders.xml         |  5 ---
 distribution/server/src/assemble/README.bin.txt    |  2 +-
 distribution/server/src/assemble/bin.xml           |  5 ---
 distribution/server/src/assemble/src.xml           |  1 -
 examples/flink-consumer-source/README.md           |  4 +-
 faq.md                                             |  4 +-
 pom.xml                                            | 15 ++++---
 .../client/api/SimpleProducerConsumerTest.java     |  2 +-
 pulsar-client-cpp/README.md                        |  2 +-
 pulsar-client-cpp/docs/MainPage.md                 |  4 +-
 pulsar-client-cpp/homebrew/libpulsar.rb            |  2 +-
 pulsar-client-cpp/lib/ClientConnection.cc          |  2 +-
 pulsar-client-cpp/pkg/deb/build-deb.sh             |  7 ++--
 pulsar-client-cpp/pkg/rpm/SPECS/pulsar-client.spec |  5 +--
 pulsar-client-cpp/python/pkg/osx/build.sh.template |  6 +--
 .../osx/osx-10.11-python2.7/generate-wheel-file.sh |  2 +-
 .../osx/osx-10.11-python3.6/generate-wheel-file.sh |  2 +-
 .../osx/osx-10.12-python2.7/generate-wheel-file.sh |  2 +-
 .../osx/osx-10.12-python3.6/generate-wheel-file.sh |  2 +-
 .../osx/osx-10.13-python2.7/generate-wheel-file.sh |  2 +-
 .../osx/osx-10.13-python3.6/generate-wheel-file.sh |  2 +-
 pulsar-client-cpp/python/setup.py                  |  4 +-
 .../consumer-listener/consumer-listener.go         |  2 +-
 pulsar-client-go/examples/consumer/consumer.go     |  4 +-
 pulsar-client-go/examples/producer/producer.go     |  4 +-
 pulsar-client-go/examples/reader/reader.go         |  4 +-
 .../apache/pulsar/admin/cli/utils/IOUtilsTest.java |  4 +-
 pulsar-client/src/main/resources/ahc.properties    |  2 +-
 .../connectors/pulsar/PulsarSourceBuilder.java     |  2 +-
 .../functions/instance/FunctionResultRouter.java   |  2 +-
 .../pulsar/io/hdfs/sink/AbstractHdfsSinkTest.java  |  4 +-
 site2/README.md                                    |  2 +-
 site2/docs/adaptors-kafka.md                       |  2 +-
 site2/docs/adaptors-spark.md                       |  2 +-
 site2/docs/adaptors-storm.md                       |  2 +-
 site2/docs/client-libraries-cpp.md                 |  2 +-
 site2/docs/client-libraries-go.md                  | 16 ++++----
 site2/docs/client-libraries-python.md              |  2 +-
 site2/docs/client-libraries-websocket.md           |  6 +--
 site2/docs/deploy-aws.md                           |  6 +--
 site2/docs/deploy-bare-metal-multi-cluster.md      |  4 +-
 site2/docs/deploy-bare-metal.md                    |  4 +-
 site2/docs/deploy-dcos.md                          |  4 +-
 site2/docs/developing-binary-protocol.md           |  4 +-
 site2/docs/developing-cpp.md                       |  2 +-
 site2/docs/developing-load-manager.md              | 14 +++----
 site2/docs/developing-schema.md                    |  4 +-
 site2/docs/functions-api.md                        | 34 ++++++++--------
 site2/docs/functions-deploying.md                  |  2 +-
 site2/docs/getting-started-clients.md              |  2 +-
 site2/docs/getting-started-standalone.md           |  4 +-
 site2/docs/io-overview.md                          | 14 +++----
 site2/docs/io-quickstart.md                        |  4 +-
 site2/docs/reference-configuration.md              |  2 +-
 site2/docs/security-extending.md                   |  8 ++--
 site2/docs/security-tls-transport.md               |  4 +-
 site2/website/contributing.md                      | 28 ++++++-------
 site2/website/core/Footer.js                       |  4 +-
 site2/website/pages/en/contact.js                  | 26 ++++++------
 site2/website/pages/en/download.js                 | 28 ++++++++-----
 site2/website/pages/en/index.js                    | 11 +-----
 site2/website/scripts/replace.js                   | 46 ++++++++++++++++------
 site2/website/siteConfig.js                        |  1 -
 72 files changed, 222 insertions(+), 227 deletions(-)

commit a4d162448d63b4eea8edcdde0797dce877bba2f2
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 25 04:16:39 2018 -0700

    [tests] Issue 2639: NullPointerException at closing consumer (#2640)
    
    * [tests] Issue 2639: NullPointerException at closing consumer
    
    *Motivation*
    
    Connection can be null when closing consumer.
    
    *Changes*
    
    Check if the connection is null or not during closing.
    
    * Address comments

 .../apache/pulsar/client/impl/ConsumerImpl.java    | 44 +++++++++++++---------
 1 file changed, 26 insertions(+), 18 deletions(-)

commit 6658891eaa49189a431cf4aede0e35453b737ca7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 25 01:43:02 2018 -0700

    [tests] ignore exceptions during shutting down test cases (#2645)

 .../java/org/apache/pulsar/broker/service/BrokerBkEnsemblesTests.java  | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 7e8e8bc4338f76bd7694a486334c537c83294a73
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 25 00:57:43 2018 -0700

    [tests] disable DeadLetterTopicTest#testDeadLetterTopicWithMultiTopic (#2650)
    
    * [tests] disable DeadLetterTopicTest#testDeadLetterTopicWithMultiTopic
    
    * disable PartitionedTopicsSchemaTest

 .../pulsar/broker/service/schema/PartitionedTopicsSchemaTest.java   | 4 +++-
 .../test/java/org/apache/pulsar/client/api/DeadLetterTopicTest.java | 6 +++++-
 2 files changed, 8 insertions(+), 2 deletions(-)

commit 7d81b66957acee20dda1f3f0f7a268d6fc5e5582
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Sep 24 23:09:41 2018 -0700

    Update Cassandra version (#2649)

 pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 69071355ca03fac9e38f7501b37ca93ac19fef7b
Author: Gordeev Boris <gordeevbr@gmail.com>
Date:   Tue Sep 25 09:04:01 2018 +0300

    Allow non-pesistent topics to be retrieved along with persistent ones from the "GetTopicsOfNamespace" method (#2025)
    
    ### Motivation
    
    Please see issue #2009 for a detailed bug report.
    
    In our use case we require using java client with pattern subscription to read from a set of non-persistent topics. Unfortunately, right now this feature doesn't work. After researching the cause for this I have found out that under the hood the client is requesting a list of topics by namespace from the server and then filters them out by pattern and subscribes to them. The method in Pulsar broker NamespaceService class that is responsible for searching for required topics only uses ledgers, thus returning only persistent topics to the client. The goal of this pull request is to provide a solution for that problem.
    
    ### Modifications
    
    This pull request updates `getListOfTopics` method of NamespaceService class to also include active non-pesistent topics from local broker cache inside the `multiLayerTopicsMap` collection of BrokerService in the result.
    
    ### Result
    
    As a result, requesting a list of topics by namespace using the HTTP API or binary API (and thus via the clients) will add non-persistent topics to search result, allowing pattern subscription to be used with non-persistent topics.
    
    ### Considerations
    
    1. Since this method pulls non-persistent topics from local broker cache, this probably means that this solution will only work for Pulsar installations with a single broker. And if there are multiple brokers, results might be inconsistent. Unfortunately I don't really know if non-persistent themselves work in multi-broker setups. I have recently asked on Slack if non-persistent topics are being replicated in any way and @merlimat's response was that they don't. Also it seems to be that some other methods that are working with non-persistent topics are using this very same collection.
    
    2. It seems to me that unit tests have made sure that Java client can work with this setup, but this might still be a breaking change for other clients or if applications working with this API are not expecting non-persistent topics in result.
    
    3. I have made sure that old unit tests inside the `pulsar-broker` subproject are still working and updated some old tests for this particular use case. Are there any more tests that I can add.
    
    Overall, we really need this and I would appreciate if maintainers could share their opinion. Thanks in advance.

 .../org/apache/pulsar/broker/PulsarService.java    |   2 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |   4 +-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  51 +++--
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |   6 +-
 .../pulsar/broker/namespace/NamespaceService.java  | 170 ++++++++++++++---
 .../apache/pulsar/broker/service/ServerCnx.java    |   9 +-
 .../pulsar/broker/web/PulsarWebResource.java       |   2 +-
 .../client/impl/PatternTopicsConsumerImplTest.java | 206 ++++++++++++++++++++-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  10 +
 .../client/impl/BinaryProtoLookupService.java      |  13 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  13 +-
 .../pulsar/client/impl/HttpLookupService.java      |   8 +-
 .../apache/pulsar/client/impl/LookupService.java   |   3 +-
 .../impl/PatternMultiTopicsConsumerImpl.java       |   7 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  16 +-
 .../impl/conf/ConsumerConfigurationData.java       |   5 +-
 .../org/apache/pulsar/common/api/Commands.java     |   5 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 108 +++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   6 +
 .../pulsar/proxy/server/LookupProxyHandler.java    |   8 +-
 20 files changed, 554 insertions(+), 98 deletions(-)

commit 1eb0e670399f9171572dfbeb2c24b87183050bf2
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Sep 24 23:03:17 2018 -0700

    [tests] improve DispatcherBlockConsumerTest#testBrokerSubscriptionRecovery (#2643)
    
    *Motivation*
    
    DispatcherBlockConsumerTest#testBrokerSubscriptionRecovery is flaky.
    
    ```
    Stacktrace
    java.lang.AssertionError: expected [true] but found [false]
            at org.testng.Assert.fail(Assert.java:96)
            at org.testng.Assert.failNotEquals(Assert.java:776)
            at org.testng.Assert.assertTrue(Assert.java:44)
            at org.testng.Assert.assertTrue(Assert.java:54)
            at org.apache.pulsar.client.api.DispatcherBlockConsumerTest.testBrokerSubscriptionRecovery(DispatcherBlockConsumerTest.java:651)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124)
            at org.testng.internal.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:54)
            at org.testng.internal.InvokeMethodRunnable.run(InvokeMethodRunnable.java:44)
            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
            at java.util.concurrent.FutureTask.run(FutureTask.java:266)
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
            at java.lang.Thread.run(Thread.java:748)
    ```
    
    The problem is `Consumer.acknowledge` doesn't guarantee a message is acked, it only guarantees an ack request is sent back to the broker.
    
    *Changes*
    
    Update the validation logic to check `unackMsgs` are redelivered.

 .../org/apache/pulsar/client/api/DispatcherBlockConsumerTest.java   | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 6619679124731ceaf0e5fc7ad011d5c8342ff156
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Sep 25 11:03:21 2018 +0900

    Fix average size of messages included in partitioned stats (#2637)
    
    Stats of partitioned topic is the simple sum of the stats of all the partitions.
    https://github.com/apache/pulsar/blob/24605d328357e89ae107b549a6f0da2ce1683857/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java#L607-L612
    
    So, `averageMsgSize` included in the stats is the sum of `averageMsgSize` of all the partitions. I will fix it to the correct average value.

 .../common/policies/data/PublisherStats.java       |  6 +++-
 .../pulsar/common/policies/data/TopicStats.java    |  7 +++-
 .../policies/data/PersistentTopicStatsTest.java    | 41 +++++++++++++++++++++-
 .../common/policies/data/PublisherStatsTest.java   | 22 ++++++++++++
 4 files changed, 73 insertions(+), 3 deletions(-)

commit 371f1db8598be6b6ce11dfbadf7525e0e71e802f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Sep 24 19:01:26 2018 -0700

    Handle RejectedExecutionException at closing ManagedLedgerClientFactory (#2646)
    
    *Motivation*
    
    Following stack trace is observed in CI.
    
    ```
    Error Message
    java.io.IOException: java.util.concurrent.RejectedExecutionException: Task org.apache.bookkeeper.mledger.util.SafeRun$1@7ec176da rejected from java.util.concurrent.ThreadPoolExecutor@33d2f9d3[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2377]
    Stacktrace
    org.apache.pulsar.broker.PulsarServerException: java.io.IOException: java.util.concurrent.RejectedExecutionException: Task org.apache.bookkeeper.mledger.util.SafeRun$1@7ec176da rejected from java.util.concurrent.ThreadPoolExecutor@33d2f9d3[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2377]
            at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:298)
            at org.apache.pulsar.functions.worker.PulsarWorkerAssignmentTest.shutdown(PulsarWorkerAssignmentTest.java:147)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124)
            at org.testng.internal.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:59)
            at org.testng.internal.Invoker.invokeConfigurationMethod(Invoker.java:451)
            at org.testng.internal.Invoker.invokeConfigurations(Invoker.java:222)
            at org.testng.internal.Invoker.invokeMethod(Invoker.java:634)
            at org.testng.internal.Invoker.retryFailed(Invoker.java:829)
            at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1000)
            at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125)
            at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109)
            at org.testng.TestRunner.privateRun(TestRunner.java:648)
            at org.testng.TestRunner.run(TestRunner.java:505)
            at org.testng.SuiteRunner.runTest(SuiteRunner.java:455)
            at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:450)
            at org.testng.SuiteRunner.privateRun(SuiteRunner.java:415)
            at org.testng.SuiteRunner.run(SuiteRunner.java:364)
            at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
            at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:84)
            at org.testng.TestNG.runSuitesSequentially(TestNG.java:1187)
            at org.testng.TestNG.runSuitesLocally(TestNG.java:1116)
            at org.testng.TestNG.runSuites(TestNG.java:1028)
            at org.testng.TestNG.run(TestNG.java:996)
            at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:135)
            at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:112)
            at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:99)
            at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:146)
            at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:379)
            at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:340)
            at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:125)
            at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:413)
    Caused by: java.io.IOException: java.util.concurrent.RejectedExecutionException: Task org.apache.bookkeeper.mledger.util.SafeRun$1@7ec176da rejected from java.util.concurrent.ThreadPoolExecutor@33d2f9d3[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2377]
            at org.apache.pulsar.broker.ManagedLedgerClientFactory.close(ManagedLedgerClientFactory.java:70)
            at org.apache.pulsar.broker.PulsarService.close(PulsarService.java:225)
            ... 34 more
    Caused by: java.util.concurrent.RejectedExecutionException: Task org.apache.bookkeeper.mledger.util.SafeRun$1@7ec176da rejected from java.util.concurrent.ThreadPoolExecutor@33d2f9d3[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 2377]
            at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
            at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
            at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
            at com.google.common.util.concurrent.ForwardingExecutorService.execute(ForwardingExecutorService.java:99)
            at org.apache.bookkeeper.common.util.BoundedExecutorService.execute(BoundedExecutorService.java:89)
            at org.apache.bookkeeper.common.util.OrderedExecutor.executeOrdered(OrderedExecutor.java:291)
            at org.apache.bookkeeper.mledger.impl.ManagedLedgerImpl.lambda$initializeBookKeeper$2(ManagedLedgerImpl.java:376)
            at org.apache.bookkeeper.client.LedgerCreateOp.createComplete(LedgerCreateOp.java:240)
            at org.apache.bookkeeper.client.LedgerCreateOp.operationComplete(LedgerCreateOp.java:199)
            at org.apache.bookkeeper.client.LedgerCreateOp.operationComplete(LedgerCreateOp.java:59)
            at org.apache.bookkeeper.meta.CleanupLedgerManager.close(CleanupLedgerManager.java:232)
            at org.apache.bookkeeper.client.BookKeeper.close(BookKeeper.java:1467)
            at org.apache.pulsar.broker.ManagedLedgerClientFactory.close(ManagedLedgerClientFactory.java:66)
            ... 35 more
    
    ```
    
    The race condition happens when:
    
    when closing bookkeeper client, it will error outs all pending metadata operations.
    those callbacks of those operations will be triggered, and submitted to the scheduler
    in managed ledger factory. but the managed ledger factory has been shutdown before,
    so `RejectedExecutionException` will be thrown there.
    
    we can safely ignore this exception.
    
    *Changes*
    
    Catch RejectedExecutionException and ignore it

 .../apache/pulsar/broker/ManagedLedgerClientFactory.java | 14 +++++++++++++-
 .../functions/worker/PulsarWorkerAssignmentTest.java     | 16 ++++++++++------
 2 files changed, 23 insertions(+), 7 deletions(-)

commit 1110584dbfc177ee1005afba09da7a45020ad099
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Sep 24 17:46:00 2018 -0700

    Upgrade kinesis version to fix extract binary in memory (#2621)

 pulsar-io/kinesis/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1905133edeea0c45b9812e28022c3820a45d4627
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Sep 24 16:31:57 2018 -0700

    Issue #2638: com.fasterxml.jackson.databind.JsonMappingException: Infinite recursion (#2644)
    
    *Motivation*
    
    Fixes #2638.
    
    ```
    22:58:30.363 [pulsar-client-io-58-1:org.apache.pulsar.client.impl.ProducerStatsRecorderImpl@104] ERROR org.apache.pulsar.client.impl.ProducerStatsRecorderImpl - Failed to dump config info: {}
    com.fasterxml.jackson.databind.JsonMappingException: Infinite recursion (StackOverflowError) (through reference chain: org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]->org.apache.pulsar.client.impl.conf.ClientConfigurationData["serviceUrlProvider"]->org.apache.pulsar.client.api.ServiceUrlProviderTest$AutoChangedServiceUrlProvider["pulsarClient"]->org.apache.pulsar.client.impl.PulsarClientImpl["conf"]-
    ```
    
    The problem is in the TestServiceUrlProvider it includes PulsarClient again, which will cause recursive reference.
    
    *Changes*
    
    Add `@JsonIgnore` to ignore serviceUrlProvider

 .../java/org/apache/pulsar/client/impl/conf/ClientConfigurationData.java | 1 +
 1 file changed, 1 insertion(+)

commit a911890a6ffea72eb7bae81ae97d57c3f1ff3fcb
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Sep 24 15:23:31 2018 -0700

    Guard against NaN for double type metrics (#2618)
    
    * Add sample docker-compose file for standalone
    
    * Add Readme

commit 1f46e756650703e91267e8ad2d5a142d1e9551f6
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Sep 25 05:42:08 2018 +0900

    Fix aggregation process of topic stats (#2619)
    
    When `exposeTopicLevelMetricsInPrometheus` is false, all values of `pulsar_msg_backlog` included in the metrics of prometheus are always 0. This is because there is a mistake in aggregation process of each topic stats.

 .../stats/prometheus/AggregatedNamespaceStats.java |   4 +-
 .../prometheus/AggregatedNamespaceStatsTest.java   | 118 +++++++++++++++++++++
 2 files changed, 120 insertions(+), 2 deletions(-)

commit 5b880426d62c6d57b7a463c6330dc64567db76a9
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Sep 24 13:39:58 2018 -0700

    Add sample docker-compose file with pulsar standalone (#2617)
    
    Add sample compose file for experimentation purposes.

 docker-compose/standalone-dashboard/README.MD      | 45 ++++++++++++++++++++++
 .../standalone-dashboard/docker-compose.yml        | 43 +++++++++++++++++++++
 2 files changed, 88 insertions(+)

commit 6481a4e0722a4f8860090440584b00f2871b8ca6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Sep 24 11:39:58 2018 -0700

    fix NPE while setting stats (#2633)
    
    ### Motivation
    
    It fixes below NPE
    ```
     java.lang.NullPointerException: null
            at org.apache.pulsar.functions.proto.InstanceCommunication$FunctionStatus$Builder.setFailureException(InstanceCommunication.java:2155) ~[classes/:?]
            at org.apache.pulsar.functions.runtime.ThreadRuntime.getFunctionStatus(ThreadRuntime.java:107) ~[classes/:?]
            at org.apache.pulsar.functions.runtime.RuntimeSpawner.getFunctionStatus(RuntimeSpawner.java:107) ~[classes/:?]
            at org.apache.pulsar.functions.worker.FunctionRuntimeManager.getFunctionInstanceStatus(FunctionRuntimeManager.java:260) ~[classes/:?]
            at org.apache.pulsar.functions.worker.FunctionRuntimeManager.getAllFunctionStatus(FunctionRuntimeManager.java:435) ~[classes/:?]
            at org.apache.pulsar.functions.worker.rest.api.FunctionsImpl.getFunctionStatus(FunctionsImpl.java:490) [classes/:?]
            at org.apache.pulsar.functions.worker.rest.api.v2.FunctionApiV2Resource.getFunctionStatus(FunctionApiV2Resource.java:115) [classes/:?]
    ```

 .../main/java/org/apache/pulsar/functions/runtime/ThreadRuntime.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 634726dcaf8d25673868e0db638193fc7a89ab80
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Sep 24 11:38:54 2018 -0700

    Fix: NPE if messageId not present on create-sub admin-api call (#2636)
    
    ### Motivation
    
    Right now, while creating subscription if user doesn't pass message-id then broker doesn't handle it properly which gives NPE and gives internal-server error to user.
    
    ```
    Message: null
    
    Stacktrace:
    
    java.lang.NullPointerException
            at org.apache.pulsar.broker.admin. PersistentTopicsBase.internalCreateSubscription(PersistentTopicsBase.java:885)
            at sun.reflect.GeneratedMethodAccessor199.invoke(Unknown Source)
    ```
    
    ### Modifications
    
    - take earliest-message id while creating subscription if user doesn't provide message-id.

 .../java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java   | 1 +
 1 file changed, 1 insertion(+)

commit 200f97a54cea8d68b4a8506804cfef3ea56e74f1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Sep 24 11:30:29 2018 -0700

    Add support for running python functions with wheel file (#2593)
    
    * Added support for accepting Python Wheel packages
    
    * Preserve filename of the original function submission
    
    * Fix bug
    
    * Fixed bugs
    
    * Fixed bug
    
    * Made process runtime do pip install
    
    * Generated proto generated
    
    * remove unnesessary change
    
    * Redid the work in python
    
    * User pipmain
    
    * Fix indentation error
    
    * pipmain muddles logs so revert to subprocess
    
    * Added licence header
    
    * [build] Fix docker organization parameter
    
    *Motivation*
    
    docker orgnization is missing for building test image. so the build will be failing with `-Pdocker`.
    
    *Changes*
    
    Move the docker organization parameter to root pom file.
    
    * Use virtualenv to isolate wheel installations
    
    * Fix bug
    
    * Updated python generated files
    
    * Reverted using virtualenv, now unzip the wheel file and add it to the path
    
    * Removed unused var
    
    * Removed wheel as a runtime
    
    * Removed unzip dependency

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../instance/src/main/python/Function_pb2.py       | 119 ++++++++++++++++-----
 .../src/main/python/python_instance_main.py        |   8 +-
 pulsar-functions/instance/src/main/python/util.py  |   2 +
 4 files changed, 101 insertions(+), 30 deletions(-)

commit adaae57d45123d3fb49fc5d7e11c08e8be1f6f68
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Mon Sep 24 14:16:02 2018 +0800

    Debezium: add PulsarDatabaseHistory for debezium (#2614)
    
    ### Motivation
    
    add PulsarDatabaseHistory for debezium
    
    ### Modifications
    
    add PulsarDatabaseHistory for debezium and test for it.
    
    ### Result
    
    ut pass

 pom.xml                                            |   3 +-
 pulsar-io/debezium/pom.xml                         | 102 ++++++++
 .../pulsar/io/debezium/PulsarDatabaseHistory.java  | 256 +++++++++++++++++++++
 .../io/debezium/PulsarDatabaseHistoryTest.java     | 222 ++++++++++++++++++
 pulsar-io/pom.xml                                  |   1 +
 5 files changed, 583 insertions(+), 1 deletion(-)

commit 52ffdc4ca7188271e98fe600ba82539c3dac6325
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Sep 22 11:56:06 2018 -0700

    [tests] improve BatchMessageTest#testSimpleBatchProducerConsumer (#2629)
    
    *Motivation*
    
    The batching behavior in BatchMessageTest#testSimpleBatchProducerConsumer is non-deterministic.
    
    *Changes*
    
    Disabled time based and size based batch and explicitly flush messages to ensure tests are running in a deterministic way.

 .../apache/pulsar/broker/service/BatchMessageTest.java  | 17 +++++++++++++----
 1 file changed, 13 insertions(+), 4 deletions(-)

commit 15f45871d930d3eae6792e9d1e93bded88c5df2d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Sep 21 08:45:46 2018 -0700

    [tests] Make BrokerClientIntegrationTest testing behavior deterministic (#2585)
    
    
    [tests] Make BrokerClientIntegrationTest testing behavior deterministic
    
    *Motivation*
    
    The test is flaky.
    
    ```
    2018-09-14\T\17:46:29.848 [ERROR] testUnsupportedBatchMessageConsumer(org.apache.pulsar.client.impl.BrokerClientIntegrationTest)  Time elapsed: 3.161 s  <<< FAILURE!
    java.lang.AssertionError: Received message my-message-5 did not match the expected message my-message-0 expected [my-message-0] but found [my-message-5]
            at org.testng.Assert.fail(Assert.java:96)
            at org.testng.Assert.failNotEquals(Assert.java:776)
            at org.testng.Assert.assertEqualsImpl(Assert.java:137)
            at org.testng.Assert.assertEquals(Assert.java:118)
            at org.apache.pulsar.client.api.ProducerConsumerBase.testMessageOrderAndDuplicates(ProducerConsumerBase.java:51)
            at org.apache.pulsar.client.impl.BrokerClientIntegrationTest.testUnsupportedBatchMessageConsumer(BrokerClientIntegrationTest.java:357)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124)
            at org.testng.internal.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:54)
            at org.testng.internal.InvokeMethodRunnable.run(InvokeMethodRunnable.java:44)
            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
            at java.util.concurrent.FutureTask.run(FutureTask.java:266)
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
            at java.lang.Thread.run(Thread.java:748)
    ```
    
    The problem is due to we used a `time` based batching policy in testing. There is no guarantee how messages can be batched, hence
    the ordering and duplication check can fail on shared subscription
    
    *Changes*
    
    Set batching delay to a very large value and make sure the messages are in one batch.

 .../client/impl/BrokerClientIntegrationTest.java       | 18 ++++++++++--------
 1 file changed, 10 insertions(+), 8 deletions(-)

commit aff681d372a8a8616bb1314dfb6e7594d0e7984f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Sep 20 22:27:20 2018 -0700

    Make use of workerconfig defined health check interval (#2626)

 .../instance/src/main/python/python_instance.py    | 10 ++++---
 .../src/main/python/python_instance_main.py        |  5 +++-
 .../pulsar/functions/runtime/JavaInstanceMain.java | 31 +++++++++++++---------
 .../pulsar/functions/runtime/ProcessRuntime.java   | 10 ++++---
 .../functions/runtime/ProcessRuntimeFactory.java   |  6 +++--
 .../pulsar/functions/runtime/RuntimeFactory.java   |  3 ++-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  3 ++-
 .../functions/runtime/ThreadRuntimeFactory.java    |  3 ++-
 .../functions/runtime/ProcessRuntimeTest.java      | 14 +++++-----
 .../functions/worker/FunctionActionerTest.java     |  2 +-
 10 files changed, 54 insertions(+), 33 deletions(-)

commit c1199d03ef5ce96451e7d2845d1dc0185d1b5e44
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Sep 20 17:22:16 2018 -0700

    [schema] Add ByteBuf schema and fix ByteBuffer schema (#2624)
    
    *Motivation*
    
    ByteBuffer is a variant of `bytes`. so it should be `SchemaType.BYTES`, not `SchemaType.BYTEBUFFER`
    
    *Changes*
    
    - Fix bytebuffer schema type
    - Add bytebuf schema

 .../pulsar/client/impl/schema/ByteBufSchema.java   | 65 ++++++++++++++++++++++
 .../client/impl/schema/ByteBufferSchema.java       |  4 +-
 .../pulsar/client/schema/PrimitiveSchemaTest.java  | 12 ++--
 .../apache/pulsar/common/schema/SchemaType.java    |  5 --
 tests/scripts/pre-integ-tests.sh                   |  2 +-
 5 files changed, 76 insertions(+), 12 deletions(-)

commit 71b53393ffa5f1184cf6ac36c57c752571763f49
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 20 16:15:43 2018 -0700

    Renamed 2.2.0-incubating-SNAPSHOT into 2.2.0-SNAPSHOT in poms (#2625)

 buildtools/pom.xml                                            | 2 +-
 distribution/io/pom.xml                                       | 2 +-
 distribution/offloaders/pom.xml                               | 2 +-
 distribution/pom.xml                                          | 2 +-
 distribution/server/pom.xml                                   | 2 +-
 docker/grafana/pom.xml                                        | 2 +-
 docker/pom.xml                                                | 2 +-
 docker/pulsar-all/pom.xml                                     | 2 +-
 docker/pulsar-standalone/pom.xml                              | 2 +-
 docker/pulsar/pom.xml                                         | 2 +-
 examples/flink-consumer-source/pom.xml                        | 2 +-
 examples/pom.xml                                              | 2 +-
 jclouds-shaded/pom.xml                                        | 2 +-
 managed-ledger-shaded/pom.xml                                 | 2 +-
 managed-ledger/pom.xml                                        | 2 +-
 pom.xml                                                       | 2 +-
 protobuf-shaded/pom.xml                                       | 2 +-
 pulsar-broker-auth-athenz/pom.xml                             | 2 +-
 pulsar-broker-common/pom.xml                                  | 2 +-
 pulsar-broker-shaded/pom.xml                                  | 2 +-
 pulsar-broker/pom.xml                                         | 2 +-
 pulsar-client-admin-shaded/pom.xml                            | 2 +-
 pulsar-client-admin/pom.xml                                   | 2 +-
 pulsar-client-auth-athenz/pom.xml                             | 2 +-
 pulsar-client-kafka-compat/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml  | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml        | 2 +-
 pulsar-client-schema/pom.xml                                  | 2 +-
 pulsar-client-shaded/pom.xml                                  | 2 +-
 pulsar-client-tools-test/pom.xml                              | 2 +-
 pulsar-client-tools/pom.xml                                   | 2 +-
 pulsar-client/pom.xml                                         | 2 +-
 pulsar-common/pom.xml                                         | 2 +-
 pulsar-discovery-service/pom.xml                              | 2 +-
 pulsar-flink/pom.xml                                          | 2 +-
 pulsar-functions/api-java/pom.xml                             | 2 +-
 pulsar-functions/instance/pom.xml                             | 2 +-
 pulsar-functions/java-examples/pom.xml                        | 2 +-
 pulsar-functions/metrics/pom.xml                              | 2 +-
 pulsar-functions/pom.xml                                      | 2 +-
 pulsar-functions/proto-shaded/pom.xml                         | 2 +-
 pulsar-functions/proto/pom.xml                                | 2 +-
 pulsar-functions/runtime-all/pom.xml                          | 2 +-
 pulsar-functions/runtime-shaded/pom.xml                       | 2 +-
 pulsar-functions/runtime/pom.xml                              | 2 +-
 pulsar-functions/utils/pom.xml                                | 2 +-
 pulsar-functions/worker/pom.xml                               | 2 +-
 pulsar-io/aerospike/pom.xml                                   | 2 +-
 pulsar-io/cassandra/pom.xml                                   | 2 +-
 pulsar-io/core/pom.xml                                        | 2 +-
 pulsar-io/data-genenator/pom.xml                              | 2 +-
 pulsar-io/elastic-search/pom.xml                              | 2 +-
 pulsar-io/hdfs/pom.xml                                        | 2 +-
 pulsar-io/jdbc/pom.xml                                        | 2 +-
 pulsar-io/kafka/pom.xml                                       | 2 +-
 pulsar-io/kinesis/pom.xml                                     | 2 +-
 pulsar-io/pom.xml                                             | 2 +-
 pulsar-io/rabbitmq/pom.xml                                    | 2 +-
 pulsar-io/twitter/pom.xml                                     | 2 +-
 pulsar-log4j2-appender/pom.xml                                | 2 +-
 pulsar-proxy/pom.xml                                          | 2 +-
 pulsar-spark/pom.xml                                          | 2 +-
 pulsar-sql/pom.xml                                            | 2 +-
 pulsar-sql/presto-distribution/pom.xml                        | 2 +-
 pulsar-sql/presto-pulsar-plugin/pom.xml                       | 2 +-
 pulsar-sql/presto-pulsar/pom.xml                              | 2 +-
 pulsar-storm/pom.xml                                          | 2 +-
 pulsar-testclient/pom.xml                                     | 2 +-
 pulsar-websocket/pom.xml                                      | 2 +-
 pulsar-zookeeper-utils/pom.xml                                | 2 +-
 pulsar-zookeeper/pom.xml                                      | 2 +-
 tests/docker-images/latest-version-image/pom.xml              | 2 +-
 tests/docker-images/pom.xml                                   | 2 +-
 tests/integration/pom.xml                                     | 2 +-
 tests/pom.xml                                                 | 2 +-
 tiered-storage/jcloud/pom.xml                                 | 2 +-
 tiered-storage/pom.xml                                        | 2 +-
 78 files changed, 78 insertions(+), 78 deletions(-)

commit d6d5562f6c04d194cb9b3501a08c7d23ab2dcf8c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Sep 20 10:33:40 2018 -0700

    [tests] improve PersistentFailoverE2ETest and add more logging to RawReaderTest (#2596)

 .../org/apache/pulsar/broker/service/PersistentFailoverE2ETest.java  | 4 ++--
 .../src/test/java/org/apache/pulsar/client/impl/RawReaderTest.java   | 5 ++++-
 2 files changed, 6 insertions(+), 3 deletions(-)

commit 0ab2325fa33231f1c69782e081483012467dfcab
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Thu Sep 20 15:44:04 2018 +0800

    Issue #2584: unacked message is not redelivered on time (#2590)
    
    ### Motivation
    
    unacked message is not redelivered after setting ackTimeout, but it is actually redelivered after 2*acktimeout.
    
    The main reason is in UnAckedMessageTracker.
    ```
        public void start(PulsarClientImpl client, ConsumerBase<?> consumerBase, long ackTimeoutMillis) {
            this.stop();
            timeout = client.timer().newTimeout(new TimerTask() {
                @Override
                public void run(Timeout t) throws Exception {
                    if (isAckTimeout()) {   < === first timeout, it is false, because oldOpenSet is empty.
                        log.warn("[{}] {} messages have timed-out", consumerBase, oldOpenSet.size());
                        Set<MessageId> messageIds = new HashSet<>();
                        oldOpenSet.forEach(messageIds::add);
                        oldOpenSet.clear();
                        consumerBase.redeliverUnacknowledgedMessages(messageIds);
                    }
                    toggle();    < === toggle after timeout
                    timeout = client.timer().newTimeout(this, ackTimeoutMillis, TimeUnit.MILLISECONDS);
                }
            }, ackTimeoutMillis, TimeUnit.MILLISECONDS);
        }
    ```
    before first timeout, all messageId was added in CurrentSet, not in OldOpenSet, so isAckTimeout() is false, and `redeliverUnacknowledgedMessages` was not called at first timeout.
    
    Related issue: #2584
    
    ### Modifications
    
    - move `toggle()` from behind if clause to before if clause.
    - add ut
    
    ### Result
    
    ut passed

 .../client/api/SimpleProducerConsumerStatTest.java |  1 -
 .../client/api/SimpleProducerConsumerTest.java     | 47 ++++++++++++++++++
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    | 58 +++++++---------------
 .../pulsar/client/impl/UnAckedMessageTracker.java  |  2 +-
 4 files changed, 65 insertions(+), 43 deletions(-)

commit 40ed8e45256518e7b751cc3206624a1ab131f8f6
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 19 21:17:36 2018 -0700

    Prepare website for future releases without '-incubating' suffix (#2610)

 site2/website/pages/en/download.js |  7 ++-----
 site2/website/releases.json        | 16 ++++++++--------
 2 files changed, 10 insertions(+), 13 deletions(-)

commit ab5834b3f4580f601abbd1fa37ce11dfb0683b3f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Sep 19 19:09:57 2018 -0700

    Fixed the null checking of retryDetails field (#2616)

 .../java/org/apache/pulsar/functions/instance/JavaInstanceRunnable.java | 2 +-
 .../src/main/java/org/apache/pulsar/functions/source/PulsarSource.java  | 2 +-
 .../java/org/apache/pulsar/functions/source/PulsarSourceConfig.java     | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit f076974935feeece00d32094c16572ac4f45244c
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Sep 20 09:11:45 2018 +0900

    Shorten the timeout value of C++ ZTS client (#2572)
    
    * Shorten the timeout value of C++ ZTS client
    
    * Set REQUEST_TIMEOUT to 30000ms

 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit d536d6669eb79c7b4235403c43ef5d6cf3b79dcd
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 19 17:03:52 2018 -0700

    Enforce boost-python was found by CMake (#2608)
    
    * Enforce boost-python was found by CMake
    
    * Fix for linux build as well

 pulsar-client-cpp/docker/build-wheels.sh | 1 +
 pulsar-client-cpp/python/CMakeLists.txt  | 9 +++++++++
 2 files changed, 10 insertions(+)

commit 99ad32b68565e8ee25049741336e5f58571b078a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 19 10:14:59 2018 -0700

    [Python] Consolidated duplicated subscribe_*() methods into a single one (#2580)
    
    * [Python] Consolidated duplicated subscribe_*() methods into a single one
    
    * Fixed missing parameter pattern_auto_discovery_period

 pulsar-client-cpp/python/pulsar/__init__.py | 229 +++-------------------------
 pulsar-client-cpp/python/pulsar_test.py     |  26 ++--
 2 files changed, 35 insertions(+), 220 deletions(-)

commit e3572530f904d3cb0b3e80c177dbf33b1f4b2903
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Sep 19 10:06:47 2018 -0700

    Correcting SQL getting started title (#2594)

 .../versioned_docs/version-2.1.1-incubating/sql-getting-started.md    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 82aa2b83359c31f71eae40bb8f068ce703f08b59
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Sep 19 10:01:21 2018 -0700

    Add support for dead letter topics for java functions (#2606)
    
    * Added ability to specify dead letter topic to functions
    
    * Fix bug
    
    * Added an example function that fails on a particular message consistently
    
    * Revert change

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 25 ++++++++++++--
 .../functions/instance/JavaInstanceRunnable.java   |  5 +++
 .../pulsar/functions/source/PulsarSource.java      | 18 +++++-----
 .../functions/source/PulsarSourceConfig.java       |  2 ++
 .../api/examples/ConsistentlyFailingFunction.java  | 38 ++++++++++++++++++++++
 .../proto/src/main/proto/Function.proto            |  6 ++++
 .../pulsar/functions/utils/FunctionConfig.java     |  2 ++
 .../functions/utils/validation/ValidatorImpls.java | 12 +++++++
 8 files changed, 97 insertions(+), 11 deletions(-)

commit ee5afa5007e260891140956d244a865d73368321
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Sep 19 15:44:15 2018 +0800

    Add ServiceUrlProvider and add method forceCloseConnection in PulsarC (#2543)
    
    Support build Pulsar client with serviceUrlProvider method.
    
    ### Motivation
    
    With serviceUrlProvider we can store the pulsar service url in zookeeper or any other config service.
    And we can watch the service url change event then control the pulsar client, such as change pulsar client serviceUrl, force close client connection or re-connect with new service url.
    
    ### Modifications
    
    Add ServiceUrlProvider interface.
    Add forceCloseConnection method in PulsarClient.

 .../pulsar/client/api/ServiceUrlProviderTest.java  | 156 +++++++++++++++++++++
 .../apache/pulsar/client/api/ClientBuilder.java    |   7 +
 .../org/apache/pulsar/client/api/PulsarClient.java |  22 +++
 .../pulsar/client/api/ServiceUrlProvider.java      |  42 ++++++
 .../pulsar/client/impl/ClientBuilderImpl.java      |  20 ++-
 .../apache/pulsar/client/impl/HandlerState.java    |   4 +
 .../apache/pulsar/client/impl/LookupService.java   |   2 +-
 .../client/impl/PartitionedProducerImpl.java       |   4 +
 .../pulsar/client/impl/PulsarClientImpl.java       |  29 +++-
 .../client/impl/conf/ClientConfigurationData.java  |   2 +
 10 files changed, 283 insertions(+), 5 deletions(-)

commit 3f8bd00d961f1f56233c629746c11cbd711bf06e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Sep 18 23:30:39 2018 -0700

    fixing/improving logging for function instance (#2586)
    
    ### Motivation
    logging for java function instance (process mode and localrun) is not working well.  Log files are created at inappropriate locations for logs not captured by the routing appender, functions bookkeeper logs are missing because we are not using the shaded classpath.
    
    The best for logging is just to put all the logs from the java instance log in a single log and not worry about the routing which is only useful when running in threaded mode

 .../pulsar/functions/runtime/JavaInstanceMain.java |  9 ---
 .../pulsar/functions/runtime/ProcessRuntime.java   | 22 +++---
 .../pulsar/functions/runtime/ThreadRuntime.java    |  4 +-
 .../src/main/resources/java_instance_log4j2.yml    | 78 +++-------------------
 .../functions/runtime/ProcessRuntimeTest.java      |  4 +-
 5 files changed, 31 insertions(+), 86 deletions(-)

commit 4fdc21afba77184109757f62679eec4d972dbbc8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 18 21:27:41 2018 -0700

    [tests] remove PersistentQueueE2ETest#testConsumersWithDifferentPermits (#2604)
    
    *Motivation*
    
    There is no ways to gurantee how fast a consumer can consume. so it makes no sense to compare the different permits
    between two consumers.
    
    *Changes*
    
    Remove PersistentQueueE2ETest#testConsumersWithDifferentPermits

commit 8e141752cbbbd038ecc183fd63b72ef19dfb32cc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 18 21:19:05 2018 -0700

    add auto ack and timeout configurable (#2503)
    
    * add auto ack and timeout configurable
    
    * Fix test

 .../java/org/apache/pulsar/admin/cli/CmdSinks.java    | 19 ++++++++++++++++++-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java     |  1 +
 .../org/apache/pulsar/functions/utils/SinkConfig.java |  3 +++
 site2/docs/reference-pulsar-admin.md                  |  4 ++++
 4 files changed, 26 insertions(+), 1 deletion(-)

commit 3097283823d14929bccd8ce1140d12ded1a93afc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Sep 18 20:36:57 2018 -0700

    docs for 2.1.1-incubating release (#2601)
    
    * docs for 2.1.1-incubating release
    
    * removing docs for sql

 site2/website/release-notes.md                     |   17 +
 site2/website/releases.json                        |    1 +
 site2/website/sidebars.json                        |    5 -
 .../version-2.1.1-incubating/adaptors-kafka.md     |  262 +++
 .../administration-proxy.md                        |   67 +
 .../client-libraries-cpp.md                        |  184 ++
 .../client-libraries-python.md                     |   95 ++
 .../cookbooks-tiered-storage.md                    |  221 +++
 .../version-2.1.1-incubating/deploy-bare-metal.md  |  357 ++++
 .../version-2.1.1-incubating/functions-api.md      |  721 ++++++++
 .../functions-deploying.md                         |  227 +++
 .../functions-guarantees.md                        |   42 +
 .../version-2.1.1-incubating/functions-overview.md |  452 +++++
 .../functions-quickstart.md                        |  266 +++
 .../getting-started-clients.md                     |   58 +
 .../getting-started-standalone.md                  |  198 +++
 .../version-2.1.1-incubating/io-managing.md        |  162 ++
 .../version-2.1.1-incubating/io-quickstart.md      |  400 +++++
 .../reference-configuration.md                     |  468 +++++
 .../reference-pulsar-admin.md                      | 1795 ++++++++++++++++++++
 .../sql-deployment-configurations.md               |    3 +-
 .../sql-getting-started.md                         |    3 +-
 .../version-2.1.1-incubating}/sql-overview.md      |    3 +-
 site2/website/versions.json                        |    1 +
 24 files changed, 6000 insertions(+), 8 deletions(-)

commit 701f3ea7e3541f61f064167043de04e8a2db5c0f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Sep 18 20:17:17 2018 -0700

    fix behavior of JSONSchema for derived classes (#2577)
    
    * fix behavior of JSONSchema for derived classes
    
    * adding pom changes
    
    * fix for nested classes
    
    * adding to test
    
    * removing debug log
    
    * improving tests

 pulsar-client-schema/pom.xml                       |  6 ++
 .../pulsar/client/impl/schema/JSONSchema.java      | 41 ++++++++++---
 .../pulsar/client/schema/JSONSchemaTest.java       | 67 ++++++++++++++++++++--
 .../pulsar/client/schema/SchemaTestUtils.java      | 42 +++++++++++---
 4 files changed, 138 insertions(+), 18 deletions(-)

commit 49fc5e508a996cfe59949effbcaf0abfa46028ce
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 18 15:22:12 2018 -0700

    [Function] avoid creating assignment snapshot and publish individual assigment msg (#2549)
    
    Fix: Compaction with last deleted keys not completing compaction
    
    Delete assignment with empty payload

 conf/functions_worker.yml                          |   2 +
 .../pulsar/compaction/TwoPhaseCompactor.java       |   2 +-
 .../apache/pulsar/compaction/CompactionTest.java   |   2 +-
 .../worker/PulsarWorkerAssignmentTest.java         | 370 +++++++++++++++++++++
 .../proto/src/main/proto/Request.proto             |   5 -
 .../functions/worker/FunctionAssignmentTailer.java |  47 ++-
 .../functions/worker/FunctionRuntimeManager.java   | 283 +++++++---------
 .../pulsar/functions/worker/SchedulerManager.java  | 126 ++++---
 .../pulsar/functions/worker/WorkerConfig.java      |   5 +-
 .../pulsar/functions/worker/WorkerService.java     |  15 +-
 .../worker/scheduler/RoundRobinScheduler.java      |  10 +-
 .../worker/FunctionRuntimeManagerTest.java         |  40 +--
 .../functions/worker/MembershipManagerTest.java    |   3 +
 .../functions/worker/SchedulerManagerTest.java     | 298 +++++++++--------
 14 files changed, 791 insertions(+), 417 deletions(-)

commit 7530d64a679a0783122b18058c1148c89c0fee0a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 18 14:50:51 2018 -0700

    [tests] improve connector related integration tests (#2587)
    
    *Motivation*
    
    with more and more connector are added, it becomes expensive to start all external services at the begin.
    
    *Changes*
    
    - refactor the connector testing framework to start external service before methods
    - fix kafka, cassandra and mysql connectors

 distribution/io/src/assemble/io.xml                |   6 +
 .../broker/service/PersistentQueueE2ETest.java     |  60 ----------
 .../functions/instance/JavaInstanceRunnable.java   |   3 +-
 .../pulsar/functions/source/TopicSchema.java       |   3 +
 ...rchAbstractSink.java => ElasticSearchSink.java} |   9 +-
 .../io/elasticsearch/ElasticSearchStringSink.java  |  35 ------
 .../resources/META-INF/services/pulsar-io.yaml     |   4 +-
 .../io/elasticsearch/ElasticSearchSinkTests.java   |   4 +-
 .../apache/pulsar/io/kafka/KafkaAbstractSink.java  |   6 +-
 .../{KafkaStringSink.java => KafkaBytesSink.java}  |  25 ++++-
 .../resources/META-INF/services/pulsar-io.yaml     |   2 +-
 site2/docs/io-quickstart.md                        |   2 +-
 .../version-2.1.0-incubating/io-quickstart.md      |   2 +-
 .../integration/functions/PulsarFunctionsTest.java |  39 +++++--
 .../functions/utils/CommandGenerator.java          |   2 +-
 .../integration/io/CassandraSinkArchiveTester.java | 121 ---------------------
 .../tests/integration/io/CassandraSinkTester.java  |  45 +++++---
 .../integration/io/ElasticSearchSinkTester.java    |  34 +++---
 .../tests/integration/io/HdfsSinkTester.java       |  22 ++--
 .../tests/integration/io/JdbcSinkTester.java       |  38 ++++---
 .../tests/integration/io/KafkaSinkTester.java      |  28 +++--
 .../tests/integration/io/KafkaSourceTester.java    |  12 +-
 .../pulsar/tests/integration/io/SinkTester.java    |  25 ++++-
 .../pulsar/tests/integration/io/SourceTester.java  |   4 +-
 .../tests/integration/suites/PulsarTestSuite.java  |  50 ---------
 .../integration/topologies/PulsarCluster.java      |  17 +++
 26 files changed, 212 insertions(+), 386 deletions(-)

commit fb396bf8313f728f5659286e4d8924bcf37d4832
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 18 14:50:12 2018 -0700

    [build] Fix docker organization parameter (#2597)
    
    *Motivation*
    
    docker orgnization is missing for building test image. so the build will be failing with `-Pdocker`.
    
    *Changes*
    
    Move the docker organization parameter to root pom file.

 docker/pom.xml | 3 ---
 pom.xml        | 1 +
 2 files changed, 1 insertion(+), 3 deletions(-)

commit 8d5061779e7a869e6e5981d2010e671ed0afa322
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 18 03:09:50 2018 -0700

    Fix: Compaction with last deleted keys not completing compaction (#2591)
    
    ### Motivation
    
    Right now, topic-compaction ignores the message-id with empty payload but if the last message in the ledger has empty payload then compactor doesn't complete the compaction because compactor ignores last message and doesn't complete the result-future so, caller never sees complete result.
    
    ### Modifications
    
    - Compactor calculates` from` and `to` position for compacted ledger according to last non-deleted active key.
    - Compactor handles tail deleted keys from the ledger and completes compaction process gracefully.
    
    ### Result
    
    compactor can successfully compact ledger whose last message is also deleted.

 .../pulsar/compaction/TwoPhaseCompactor.java       | 90 +++++++++++++---------
 .../apache/pulsar/compaction/CompactionTest.java   | 56 ++++++++++++++
 2 files changed, 111 insertions(+), 35 deletions(-)

commit c86627948d4abf4b50517338c739f0dea8029849
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 18 03:05:40 2018 -0700

    [java-client] Issue #2384: ConnectionHandler: Log stack trace instead of printing (#2599)
    
    *Motivation*
    
    Fixes #2384.
    
    The pulsar java client is currently very noisy in case of connection loss and it cannot be muted, as the stack trace is printed with .printStackTrace(). Moving this to the logging system will allow developers to configure this behavior.
    
    *Changes*
    
    Remove `printStackTrace`.

 .../src/main/java/org/apache/pulsar/client/impl/ConnectionHandler.java   | 1 -
 1 file changed, 1 deletion(-)

commit 6c07c81bf85eaa6d2a23c026049c57305284876e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 18 02:18:17 2018 -0700

     [tests] Flaky Test ZooKeeperCacheTest#testChildrenCacheZnodeCreatedAfterCache (#2598)
    
    * [tests] Flaky Test ZooKeeperCacheTest#testChildrenCacheZnodeCreatedAfterCache
    
    *Motivation*
    
    The problem is zookeeper watcher notification is non-deterministic. That says if you create N paths in zookeeper, you might receive
    x notification. x is between 1 and N. so the test is written in a very non-deterministic way.
    
    ```
    java.lang.AssertionError: expected [1] but found [2]
            at org.testng.Assert.fail(Assert.java:96)
            at org.testng.Assert.failNotEquals(Assert.java:776)
            at org.testng.Assert.assertEqualsImpl(Assert.java:137)
            at org.testng.Assert.assertEquals(Assert.java:118)
            at org.testng.Assert.assertEquals(Assert.java:652)
            at org.testng.Assert.assertEquals(Assert.java:662)
            at org.apache.pulsar.zookeeper.ZookeeperCacheTest.testChildrenCacheZnodeCreatedAfterCache(ZookeeperCacheTest.java:214)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124)
            at org.testng.internal.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:54)
            at org.testng.internal.InvokeMethodRunnable.run(InvokeMethodRunnable.java:44)
            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
            at java.util.concurrent.FutureTask.run(FutureTask.java:266)
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
            at java.lang.Thread.run(Thread.java:748)
    ```
    
    *Changes*
    
    rewrite the test to make it more robust.

 .../test/java/org/apache/pulsar/zookeeper/ZookeeperCacheTest.java | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit aebfbba2a9f2882944bd1854672f4538a9d27177
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 18 00:43:50 2018 -0700

    [tests] make PersistentQueueE2ETest tolerant failures during deleting topic at cleanup (#2600)
    
    *Motivation*
    
    "Topic has active producers/subscriptions" can be thrown during deleting topic at cleanup.
    This kind of error can be ignored during cleaning up to make the tests more robust.
    
    *Changes*
    
    Make PersistentQueueE2ETest toelrant failures during cleaning up topics.

 .../broker/service/PersistentQueueE2ETest.java     | 23 +++++++++++++++++-----
 1 file changed, 18 insertions(+), 5 deletions(-)

commit 259275ba8df5750e64fa15781dc2a968959ce71f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Sep 17 13:36:50 2018 -0700

    [tests] Fix the synchronization problem at BrokerClientIntegrationTest.testMaxConcurrentTopicLoading (#2595)
    
    *Motivation*
    
    Following exception is observed in one of the CI jobs.
    
    ```
    java.lang.NullPointerException
            at org.apache.pulsar.common.util.FutureUtil.waitForAll(FutureUtil.java:44)
            at org.apache.pulsar.client.impl.BrokerClientIntegrationTest.testMaxConcurrentTopicLoading(BrokerClientIntegrationTest.java:601)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124)
            at org.testng.internal.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:54)
            at org.testng.internal.InvokeMethodRunnable.run(InvokeMethodRunnable.java:44)
            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
            at java.util.concurrent.FutureTask.run(FutureTask.java:266)
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
            at java.lang.Thread.run(Thread.java:748)
    ```
    
    The problem seems to be coming from improper synchronization in the tests.
    
    *Changes*
    
    Fix the synchronization problem in BrokerClientIntegrationTest.testMaxConcurrentTopicLoading

 .../pulsar/client/impl/BrokerClientIntegrationTest.java      | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit a123380327fbe95eef1066c4c456020c19136e07
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Sep 17 01:03:06 2018 -0700

    Preserve filename of the original function submission (#2588)
    
    ### Motivation
    
    When we submit a function, currently we don't note down the original filename that was uploaded from the client. For regular java functions this works fine. For python workers we manage by doing tricks wrt tricks like filename using classnames. However when we add things like wheel support, the filename encodes information that cannot be discarded away.
    This pr preserves that filename

 pulsar-functions/proto/src/main/proto/Function.proto              | 1 +
 .../org/apache/pulsar/functions/utils/FunctionDetailsUtils.java   | 8 +++++++-
 .../java/org/apache/pulsar/functions/worker/FunctionActioner.java | 2 +-
 .../apache/pulsar/functions/worker/rest/api/FunctionsImpl.java    | 6 ++++++
 4 files changed, 15 insertions(+), 2 deletions(-)

commit 5a2d75c11acd8c6014ea1f9551405a6bcb41e4f8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Sep 17 00:51:59 2018 -0700

    [schema] add schemas for primtive types (#2500)
    
    * [schema] add schemas for primtive types
    
    * Fix issues with Schema.BYTES

 .../client/api/SchemaSerializationException.java   |   5 +
 .../client/impl/schema/ByteBufferSchema.java       |  75 +++++++++++++++
 .../pulsar/client/impl/schema/ByteSchema.java      |  66 +++++++++++++
 .../pulsar/client/impl/schema/BytesSchema.java     |  17 +++-
 .../pulsar/client/impl/schema/DoubleSchema.java    |  80 ++++++++++++++++
 .../pulsar/client/impl/schema/FloatSchema.java     |  76 +++++++++++++++
 .../pulsar/client/impl/schema/IntSchema.java       |  75 +++++++++++++++
 .../pulsar/client/impl/schema/LongSchema.java      |  79 ++++++++++++++++
 .../pulsar/client/impl/schema/ShortSchema.java     |  73 +++++++++++++++
 .../pulsar/client/impl/schema/StringSchema.java    |  29 ++++--
 .../pulsar/client/schema/PrimitiveSchemaTest.java  | 102 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  11 ++-
 .../apache/pulsar/client/impl/ProducerImpl.java    |   3 +
 .../apache/pulsar/common/schema/SchemaInfo.java    |   2 +
 .../apache/pulsar/common/schema/SchemaType.java    |  40 ++++++++
 15 files changed, 723 insertions(+), 10 deletions(-)

commit 844f46f156687fad1a08d7e88716fa5ee6937943
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Sep 17 00:26:27 2018 -0700

    Change repository tag for test image (#2571)
    
    This uses the docker.organization property to tag the test image to make it consistent with other pom files

 tests/docker-images/latest-version-image/pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit d5e88c1ec16df557655e42c9f648a2fd3343d759
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Sep 16 21:55:21 2018 -0700

    Add ledger op timeout to avoid topics stuck on ledger-creation (#2535)
    
    * Add ledger op timeout to avoid topics stuck on ledger-creation
    
    * rename to metadataOperationsTimeoutSeconds
    
    * ad service config for managedLedgerMetadataOperationsTimeoutSeconds

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  21 +++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 101 +++++++-------
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 150 ++++++++++++++-------
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  47 ++++++-
 .../apache/pulsar/broker/ServiceConfiguration.java |  10 ++
 .../pulsar/broker/service/BrokerService.java       |   2 +
 8 files changed, 234 insertions(+), 103 deletions(-)

commit 858648eb24aeba9d95a7e83513830afd40cb21fe
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Sep 14 22:33:03 2018 -0700

    Misc fixes (#2579)
    
    This pr does a couple of minor nits
    1. Add a log statement in Sink to make it consistent with the Source.
    2. Added AllArgs/NoArgs constructor for some test related objects

 .../src/main/java/org/apache/pulsar/functions/sink/PulsarSink.java    | 2 ++
 .../org/apache/pulsar/functions/api/examples/CustomBaseObject.java    | 2 ++
 .../org/apache/pulsar/functions/api/examples/CustomDerivedObject.java | 4 ++++
 3 files changed, 8 insertions(+)

commit ec7435565520ee6ac3ed2ce4a0cd13e8de7dbca3
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Sat Sep 15 00:15:13 2018 +0800

    Issue #2574: Timeout message not get redeliver in TopicsConsumer when use message listener
    
    ### Motivation
    
    fix issue #2574 .
    Timeout message not get redeliver in TopicsConsumer when use message listener.
    This is caused by message listener wrongly set in individual sub-ConsumerImpl.
    
    ### Modifications
    
    set message listener to null for individual sub-ConsumerImpl.
    Add a UT
    
    ### Result
    
    UT passed.

 .../pulsar/client/impl/TopicsConsumerImplTest.java | 58 ++++++++++++++++++++++
 .../client/impl/MultiTopicsConsumerImpl.java       |  1 +
 2 files changed, 59 insertions(+)

commit 07d42261eb2d685de6f9a5ab214f4d08944ffb6e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Sep 14 01:10:35 2018 -0700

    [proxy][functions] Issue #2154: proxy should be able to forward rest requests to function workers cluster (#2560)
    
    *Motivation*
    
    Function workers can be deployed as a separate cluster. If so, proxy is not able to forward the functions
    related rest calls to the correct server.
    
    *Changes*
    
    Add two settings in proxy configuration to allow proxy configuring forwarding functions related rest calls
    to function worker cluster.
    
    *Tests*
    
    Verified with changes in integration tests (manually). It is hard to add the integration tests based on
    current integration tests. will add them in a separate PR.

 conf/proxy.conf                                          |  5 +++++
 .../apache/pulsar/proxy/server/AdminProxyHandler.java    | 16 ++++++++++++++--
 .../apache/pulsar/proxy/server/ProxyConfiguration.java   | 12 ++++++++++++
 3 files changed, 31 insertions(+), 2 deletions(-)

commit 95fe84c7b43060102bb08f0dfe85dadb152f4542
Author: penghui <codelipenghui@gmail.com>
Date:   Fri Sep 14 15:37:58 2018 +0800

    PIP-22: Dead Letter Topic (#2508)
    
    ### Motivation
    
    Fixes #189
    
    When consumer got messages from pulsar, It's difficult to ensure every message can be consume success. Pulsar support message redelivery feature by set acknowledge timeout when create a new consumer. This is a good feature guarantee consumer will not lost messages.
    
    But however, some message will redelivery so many times possible, even to the extent that it can be never stop.
    
    So, It's necessary to support a feature to control it by pulsar. Users can use this feature and customize this feature to control the message redelivery behavior. The feature named Dead Letter Topic.
    
    ### Modifications
    
    Consumer can set maximum number of redeliveries by java client.
    Consumer can set the name of Dead Letter Topic by java client, Its not necessary.
    Message exceeding the maximum number of redeliveries should send to Dead Letter Topic and acknowledged automatic.
    
    ### Result
    
    If consumer enable future of dead letter topic. When Message exceeding the maximum number of redeliveries, message will send to the Dead Letter Topic and acknowledged automatic.

 .../org/apache/pulsar/broker/service/Consumer.java |   3 +-
 .../apache/pulsar/broker/service/Dispatcher.java   |   2 +
 .../broker/service/InMemoryRedeliveryTracker.java  |  58 +++++
 .../pulsar/broker/service/RedeliveryTracker.java   |  36 +++
 .../broker/service/RedeliveryTrackerDisabled.java  |  55 +++++
 .../NonPersistentDispatcherMultipleConsumers.java  |   9 +
 ...onPersistentDispatcherSingleActiveConsumer.java |   9 +
 .../PersistentDispatcherMultipleConsumers.java     |  14 +-
 .../PersistentDispatcherSingleActiveConsumer.java  |  11 +
 .../service/persistent/PersistentSubscription.java |   1 +
 .../apache/pulsar/client/impl/RawReaderImpl.java   |   2 +-
 .../pulsar/client/api/DeadLetterTopicTest.java     | 249 +++++++++++++++++++++
 .../client/impl/CompactedOutBatchMessageTest.java  |   2 +-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  24 ++
 .../apache/pulsar/client/api/DeadLetterPolicy.java |  32 +++
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   2 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   7 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 111 ++++++++-
 .../impl/conf/ConsumerConfigurationData.java       |   3 +
 .../org/apache/pulsar/common/api/Commands.java     |   5 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  57 +++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 22 files changed, 680 insertions(+), 13 deletions(-)

commit 7c62ecf4d75ad396066add41246fcb4f92a7c301
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Sep 14 00:59:55 2018 +0200

    ManagedLedger only closes ledger on error if current ledger (#240) (#2573)
    
    If we have a managed ledger, ml and we write 2 entries to it, if both
    entries fail, both will end up calling ManagedLedgerImpl#ledgerClosed
    with the ledger the write failed on as a parameter.
    
    However, depending on timing, the second call to ledgerClosed could
    end up adding a new ledger to the ledger list, even though the current
    ledger is _not_ failing (as the failing ledger was replaced by the
    first call).
    
    This was the cause of a flake in
    ManagedLedgerErrorsTest#recoverLongTimeAfterMultipleWriteErrors as
    reported in (#240). However, it's not possible to get a deterministic
    test for this as the timings need to be very precise. The failing
    addComplete needs to run before first error handling completes, but
    the runnable with ledgerClosed for the second failure needs to run
    after the first error handling completes, but before the write resends
    from the first error handling complete.

 .../java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 95ed9b91af20bcdd396ee34d3ea6cc94a52fea31
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Sep 13 14:50:35 2018 -0700

    Stop all functions gracefully on closing worker-service (#2548)
    
    ### Motivation
    
    Right now, if stopping [WorkerService](https://github.com/apache/incubator-pulsar/blob/master/pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/WorkerService.java#L189) doesn't stop functions and all the threads stayed alive event `WorkerService` is stopped.
    
    ### Modifications
    
    Stop all function resource gracefully while stopping worker service.
    
    ### Result
    
    Function threads will not stay alive while stopping worker-service.

 .../functions/worker/FunctionRuntimeManager.java     | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

commit 6ef7acaf37d57769c4d9dbf7558ef627ce061339
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Sep 13 14:50:01 2018 -0700

     optimizing throughput in Pulsar Presto connector (#2564)
    
    ### Motivation
    
    1. Currently, the presto pulsar connector will read synchronously from bookkeeper when it has run out of entries go process.  Basically, we process a batch of entries and then we read more.  Ideally should be doing reading and processing in parallel to increase throughput.
    
    2. Each split initializes their own ManagedLedgerFactory/Bookkeeper client.  We really just need one bookkeeper client to be shared among threads.
    
    ### Modifications
    1. Rewrote the logic in the Presto Pulsar connector to read async and process in parallel
    
    2. Cache ManagedLedgerFactory to be used across splits
    
    ### Result
    
    I see about 2X throughput improvement on single node as well as cluster (2 brokers, 3 bookies, 4 presto workers including coordinator) on AWS

 conf/presto/catalog/pulsar.properties              |   6 +-
 .../apache/pulsar/sql/presto/PulsarConnector.java  |   5 +
 .../pulsar/sql/presto/PulsarConnectorCache.java    |  64 +++++++
 .../pulsar/sql/presto/PulsarConnectorConfig.java   |  26 ++-
 .../pulsar/sql/presto/PulsarRecordCursor.java      | 201 +++++++++++++++------
 .../pulsar/sql/presto/TestPulsarConnector.java     | 146 ++++++++-------
 .../pulsar/sql/presto/TestPulsarRecordCursor.java  |   1 +
 7 files changed, 326 insertions(+), 123 deletions(-)

commit 0964dadcd3f425a2d4c424d4ab1de1fb7e35ce84
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 13 17:49:36 2018 -0400

    Another fix for website build (#2567)
    
    ### Motivation
    
    Comma is missing in the javascript list.

 site2/website/scripts/replace.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e5a7b532ffbf1d8813fc31403162fe3c17e937f5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Sep 13 11:29:37 2018 -0700

    Fix: get function status with auth enable (#2516)

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  2 +-
 .../client/admin/internal/FunctionsImpl.java       |  5 ++-
 .../functions/worker/FunctionRuntimeManager.java   | 41 ++++++++--------------
 .../functions/worker/rest/api/FunctionsImpl.java   |  6 ++--
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  2 +-
 5 files changed, 23 insertions(+), 33 deletions(-)

commit 73645631849ffce2f144f23d861763fe52a25af9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Sep 12 21:32:39 2018 -0700

    [io] jdbc connector uses Schema.AUTO (#2538)
    
    * [schema] enable Schema.AUTO if functions or connectors are using GenericRecord
    
    * auto schema in jdbc sink
    
    * [io] jdbc connector uses Schema.AUTO

 pulsar-functions/java-examples/pom.xml             |  1 -
 .../apache/pulsar/io/jdbc/JdbcAbstractSink.java    |  3 --
 ...AvroSchemaSink.java => JdbcAutoSchemaSink.java} | 39 +++++-----------------
 .../org/apache/pulsar/io/jdbc/JdbcSinkConfig.java  |  3 --
 .../resources/META-INF/services/pulsar-io.yaml     |  2 +-
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    | 17 ++++++----
 .../integration/functions/PulsarFunctionsTest.java | 21 +++++++++---
 .../tests/integration/io/JdbcSinkTester.java       | 10 +++---
 .../pulsar/tests/integration/io/SinkTester.java    |  5 +++
 9 files changed, 47 insertions(+), 54 deletions(-)

commit a45ea9c74f45d5b3be160d62cd96ab5754e278de
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Sep 12 07:20:30 2018 -0700

    [build] Fix maven deploy failure (#2565)
    
    *Motivation*
    
    Pulsar presto distribution doesn't inherit from apache profile.
    Hence when we run `mvn deploy`, it will fail to deploy the apache repository.
    
    ```
    2018-09-11T23:52:04.260 [ERROR] Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (default-deploy) on project pulsar-presto-distribution: Deployment failed: repository element was not specified in the POM inside distributionManagement element or in -DaltDeploymentRepository=id::layout::url parameter -> [Help 1]
    ```
    
    *Changes*
    
    Make presto distribution pom file inherit from apache profile.

 pulsar-sql/presto-distribution/pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit 5506b54d99a5f85ee8d6b5fcb1e652b83bad3ef1
Author: cckellogg <cckellogg@gmail.com>
Date:   Wed Sep 12 02:45:44 2018 -0700

    Remove property term from dashboard. (#2553)
    
    This updates the html to display the new v2 naming.
    
    ### Motivation
    
    This brings the dashboard up to date with the new v2 naming. Property/properties are now tenant/tenants.

 dashboard/django/stats/templates/stats/base.html | 2 +-
 dashboard/django/stats/templates/stats/home.html | 4 ++--
 dashboard/django/stats/views.py                  | 2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)

commit 71003e20e6606527c2f538ba2059850d9539d878
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Sep 12 01:38:56 2018 -0700

     [documentation][example] Flink Source & Sink Connector (#2561)
    
    ### Motivation
    
    We added flink source connector (#2441) and sink connector (#2434). It would be great to an example to show how to use flink source & sink connector.
    
    ### Modifications
    
    - introduce an `examples` module
    - introduce an `examples/flink-consumer-source` module
    - add a word count example to use flink source and sink connector
    
    ### Result
    
    be able to know how to use flink source & sink connector

 examples/flink-consumer-source/README.md           |  76 +++++++++++++
 examples/flink-consumer-source/pom.xml             |  97 ++++++++++++++++
 .../flink/PulsarConsumerSourceWordCount.java       | 126 +++++++++++++++++++++
 examples/pom.xml                                   |  39 +++++++
 pom.xml                                            |   3 +
 .../connectors/pulsar/FlinkPulsarProducer.java     |  10 +-
 .../connectors/pulsar/PulsarConsumerSource.java    |   1 -
 .../pulsar/partitioner/PulsarKeyExtractor.java     |   4 +-
 8 files changed, 350 insertions(+), 6 deletions(-)

commit 0ce9e1f4ef5f372d8199eedbaa04811b10115dab
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 12 03:11:26 2018 -0400

    Removed sha1 from release signing script (#2563)
    
    ### Motivation
    
    We have removed sha1 links from main download page but we should also remove from the release signing script.

 site2/docs/client-libraries-cpp.md                             | 10 +++++-----
 .../version-2.1.0-incubating/client-libraries-cpp.md           |  6 +++---
 src/sign-release.sh                                            |  3 ---
 3 files changed, 8 insertions(+), 11 deletions(-)

commit bf374fcb6c7501997dc99ace1331153e766ca795
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 12 00:44:20 2018 -0400

    Fixed website build with missing comma in replace.js (#2562)

 site2/website/scripts/replace.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 29a8af559ed0663458ca2f9f1d8c950675c723f9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Sep 11 13:43:40 2018 -0700

    Correcting doc id to be consistent with sidebar (#2558)

 site2/docs/sql-deployment-configurations.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit fc61056ccab29bb068b65d71120364d14503f69f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 11 12:11:41 2018 -0700

    [ecosystem] Flink pulsar source connector (#2555)
    
    *Motivation*
    
    This ports apache/flink#6200 to apache pulsar repo. It adds a pulsar source connector
    which will enable flink jobs to process messages from pulsar topics.
    
    *Changes*
    
    Add a PulsarConsumerSource connector

 .../connectors/pulsar/PulsarConsumerSource.java    | 204 ++++++++
 .../connectors/pulsar/PulsarSourceBase.java        |  31 ++
 .../connectors/pulsar/PulsarSourceBuilder.java     | 118 +++++
 .../pulsar/PulsarConsumerSourceTests.java          | 524 +++++++++++++++++++++
 4 files changed, 877 insertions(+)

commit e098117cbc6396be81c3cc6061b10c2673773912
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 11 11:51:32 2018 -0400

    Fixed download links and resource page (#2557)

 site2/website/data/resources.js    |  6 +++---
 site2/website/pages/en/download.js | 22 +++++++++++-----------
 2 files changed, 14 insertions(+), 14 deletions(-)

commit 24605d328357e89ae107b549a6f0da2ce1683857
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Sep 11 12:43:21 2018 +0900

    Fix status code of REST API to get list of subscriptions of partitioned topic (#2550)

 .../apache/pulsar/broker/admin/impl/PersistentTopicsBase.java  |  6 ++++++
 .../test/java/org/apache/pulsar/broker/admin/AdminApiTest.java | 10 ++++++++++
 2 files changed, 16 insertions(+)

commit 69571f8ef67b99d66c7d405e17870100d0aa5080
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Sep 11 01:31:14 2018 +0200

    Readd MockBookKeeper to Pulsar (#2544)
    
    These mocks were moved out of pulsar to the bookkeeper project a few
    months ago. While it is good to have mocks generally available for
    bookkeeper, if the mock is not in the pulsar code base and we want to
    change the behaviour of the mock for a specific case, we need to wait
    for a bookkeeper release cycle to do so. It's better to have the mock
    in Pulsar, so we can bend it to our needs.

 .../bookkeeper/client/PulsarMockBookKeeper.java    | 284 +++++++++++++++++++++
 .../bookkeeper/client/PulsarMockLedgerHandle.java  | 243 ++++++++++++++++++
 .../bookkeeper/client/PulsarMockReadHandle.java    | 125 +++++++++
 .../mledger/impl/ManagedLedgerErrorsTest.java      |   4 +-
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |   6 +-
 .../broker/MockedBookKeeperClientFactory.java      |  18 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  31 ++-
 .../PersistentDispatcherFailoverConsumerTest.java  |   3 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   3 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   3 +-
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  |   6 +-
 11 files changed, 704 insertions(+), 22 deletions(-)

commit fc2d1d3da7ffb8bb47e30ec49c07cf8d9f735246
Author: cckellogg <cckellogg@gmail.com>
Date:   Mon Sep 10 13:33:29 2018 -0700

    Fix dashboard to work with python3. (#2552)
    
    ### Motivation
    
    Make dashboard work with python 3.

 dashboard/django/collector.py   | 10 +++++-----
 dashboard/django/stats/views.py |  2 +-
 2 files changed, 6 insertions(+), 6 deletions(-)

commit 928c3e1a9e1e1d27b3bf5bf816890d1316c4b5d2
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Mon Sep 10 13:31:49 2018 -0700

    Elastic connector (#2546)
    
    ### Motivation
    
    Added a sink connector that writes JSON documents into ElasticSearch
    
    ### Modifications
    
    Added new pulsar-io module and associated integration tests
    
    ### Result
    
    An ElasticSearch sink connector will be available for use.

 pulsar-io/elastic-search/pom.xml                   |  91 +++++++++++++
 .../elasticsearch/ElasticSearchAbstractSink.java   | 150 +++++++++++++++++++++
 .../io/elasticsearch/ElasticSearchConfig.java      |  88 ++++++++++++
 .../io/elasticsearch/ElasticSearchStringSink.java  |  35 +++++
 .../pulsar/io/elasticsearch/package-info.java      |  19 +++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 .../io/elasticsearch/ElasticSearchConfigTests.java | 125 +++++++++++++++++
 .../io/elasticsearch/ElasticSearchSinkTests.java   | 144 ++++++++++++++++++++
 .../pulsar/io/elasticsearch/data/Profile.java      |  33 +++++
 .../pulsar/io/elasticsearch/data/UserProfile.java  |  35 +++++
 .../src/test/resources/sinkConfig.yaml             |  25 ++++
 pulsar-io/hdfs/pom.xml                             |   1 +
 pulsar-io/pom.xml                                  |   1 +
 tests/integration/pom.xml                          |   7 +
 .../containers/ElasticSearchContainer.java         |  47 +++++++
 .../integration/functions/PulsarFunctionsTest.java |   7 +-
 .../integration/io/ElasticSearchSinkTester.java    |  75 +++++++++++
 .../pulsar/tests/integration/io/SinkTester.java    |   3 +-
 .../tests/integration/suites/PulsarTestSuite.java  |   6 +
 19 files changed, 912 insertions(+), 2 deletions(-)

commit 2812fefb72aa8f7277a8a97d8842b0ad2dc6719b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Sep 10 13:31:19 2018 -0700

    [docker] introduce a pulsar standalone image (#2545)
    
    ## Motivation
    
    `pulsar` and `pulsar-all` are designed for running pulsar components on production.
    although it can be used for running standalone, people still need to run a separate docker container for pulsar dashboard.
    
     ## Changes
    
    introduce a `pulsar-standalone` image to package everything into one image. so people can run launch a pulsar standalone in one line command
    in docker, including dashboard.

 docker/pom.xml                                     |   1 +
 docker/pulsar-standalone/Dockerfile                |  55 ++++
 docker/pulsar-standalone/conf/nginx-app.conf       |  37 +++
 docker/pulsar-standalone/conf/postgresql.conf      |  38 +++
 docker/pulsar-standalone/conf/supervisor-app.conf  |  34 ++
 docker/pulsar-standalone/conf/uwsgi.ini            |  45 +++
 docker/pulsar-standalone/conf/uwsgi_params         |  16 +
 docker/pulsar-standalone/django/collector.py       | 345 +++++++++++++++++++++
 docker/pulsar-standalone/django/collector.sh       |  23 ++
 .../pulsar-standalone/django/dashboard/__init__.py |  19 ++
 .../pulsar-standalone/django/dashboard/settings.py | 181 +++++++++++
 docker/pulsar-standalone/django/dashboard/urls.py  |  45 +++
 docker/pulsar-standalone/django/dashboard/wsgi.py  |  35 +++
 docker/pulsar-standalone/django/manage.py          |  41 +++
 docker/pulsar-standalone/django/stats/__init__.py  |  19 ++
 docker/pulsar-standalone/django/stats/admin.py     |  34 ++
 docker/pulsar-standalone/django/stats/apps.py      |  26 ++
 .../django/stats/migrations/0001_initial.py        | 221 +++++++++++++
 .../django/stats/migrations/__init__.py            |  20 ++
 docker/pulsar-standalone/django/stats/models.py    | 200 ++++++++++++
 .../django/stats/templates/stats/base.html         |  98 ++++++
 .../django/stats/templates/stats/broker.html       |  71 +++++
 .../django/stats/templates/stats/brokers.html      |  90 ++++++
 .../django/stats/templates/stats/clusters.html     | 106 +++++++
 .../django/stats/templates/stats/home.html         |  74 +++++
 .../django/stats/templates/stats/namespace.html    |  96 ++++++
 .../django/stats/templates/stats/property.html     |  72 +++++
 .../django/stats/templates/stats/topic.html        | 197 ++++++++++++
 .../django/stats/templates/stats/topics.html       |  91 ++++++
 .../django/stats/templatetags/__init__.py          |  19 ++
 .../django/stats/templatetags/stats_extras.py      |  64 ++++
 .../django/stats/templatetags/table.py             |  91 ++++++
 docker/pulsar-standalone/django/stats/tests.py     |  22 ++
 docker/pulsar-standalone/django/stats/urls.py      |  37 +++
 docker/pulsar-standalone/django/stats/views.py     | 283 +++++++++++++++++
 docker/pulsar-standalone/pom.xml                   |  81 +++++
 site2/docs/getting-started-standalone.md           |  27 +-
 .../getting-started-standalone.md                  |  14 +-
 38 files changed, 2957 insertions(+), 11 deletions(-)

commit 3e9a445e9ced577c1e494875e9a490c3dee9a5ab
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Sep 9 16:51:03 2018 -0700

    [documentation] Add section about licensing at contribution guide (#2511)

 site2/website/contributing.md | 9 +++++++++
 1 file changed, 9 insertions(+)

commit 1c72ac3fb1d20b4f12300c4d339cb1a383d718ae
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Sep 9 16:50:49 2018 -0700

    Added cmake install for lib and headers (#2529)
    
    ### Motivation
    
    Added `install` target to do local install for C++ client lib

 pulsar-client-cpp/lib/CMakeLists.txt | 4 ++++
 1 file changed, 4 insertions(+)

commit 9ec8a5ee4d4a80c50986cde95093b1eb4af31ef0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Sep 8 12:51:12 2018 -0700

    [schema] enable Schema.AUTO if functions or connectors are using GenericRecord (#2537)
    
    * [schema] enable Schema.AUTO if functions or connectors are using GenericRecord
    
    * add schema-api to functions-api

 pulsar-functions/api-java/pom.xml                  |  6 ++
 .../pulsar/functions/source/PulsarSource.java      |  2 +-
 .../pulsar/functions/source/TopicSchema.java       | 44 +++++--------
 pulsar-functions/java-examples/pom.xml             |  1 +
 .../functions/api/examples/AutoSchemaFunction.java | 33 ++++++++++
 tests/integration/pom.xml                          | 12 ++++
 .../integration/functions/PulsarFunctionsTest.java | 77 +++++++++++++++++++++-
 7 files changed, 143 insertions(+), 32 deletions(-)

commit cd185d1d9bb3319cae3543c561454d40ac54d899
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sun Sep 9 04:50:52 2018 +0900

    Fix status code of REST API to get partitioned topic stats (#2542)

 .../apache/pulsar/broker/admin/impl/PersistentTopicsBase.java |  6 ++++++
 .../java/org/apache/pulsar/broker/admin/AdminApiTest.java     | 11 +++++++++++
 2 files changed, 17 insertions(+)

commit 6451efd6515026288ae8aa1b7118e97904eecf76
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sun Sep 9 04:50:35 2018 +0900

    Enable C++ AuthFactory to parse Athenz params string (#2540)

 pulsar-client-cpp/include/pulsar/Authentication.h |  2 +
 pulsar-client-cpp/lib/Authentication.cc           | 43 +++++++++++------
 pulsar-client-cpp/lib/auth/AuthTls.cc             |  5 ++
 pulsar-client-cpp/tests/AuthPluginTest.cc         | 58 +++++++++++++++++++++++
 4 files changed, 94 insertions(+), 14 deletions(-)

commit 9f6f5c0ccd2d273c2b4a3eaa3c894284ffc384c7
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Sep 7 12:28:05 2018 -0700

    set correct guice version to prevent dependency inject errors in docker container (#2534)
    
    * set correct guice version to prevent dependency inject errors in docker container
    
    * correct guice dependency in license file

 pulsar-sql/presto-distribution/LICENSE | 2 +-
 pulsar-sql/presto-distribution/pom.xml | 8 ++++++++
 2 files changed, 9 insertions(+), 1 deletion(-)

commit 2023b489ade528e622c0f203e5da7d377ec2772a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Sep 7 12:27:33 2018 -0700

    support nested fields in Pulsar presto connector (#2515)
    
    * support nested fields in Pulsar presto connector
    
    * cleaning up
    
    * removing debug messages

 .../org/apache/pulsar/io/twitter/TweetData.java    |   7 -
 .../pulsar/sql/presto/AvroSchemaHandler.java       |  18 +-
 .../pulsar/sql/presto/JSONSchemaHandler.java       |  14 +-
 .../pulsar/sql/presto/PulsarColumnHandle.java      |  81 +--
 .../pulsar/sql/presto/PulsarColumnMetadata.java    |  50 +-
 .../pulsar/sql/presto/PulsarInternalColumn.java    |   4 +-
 .../apache/pulsar/sql/presto/PulsarMetadata.java   |  77 ++-
 .../pulsar/sql/presto/PulsarRecordCursor.java      |   7 -
 .../pulsar/sql/presto/TestPulsarConnector.java     | 625 +++++++++++++++------
 .../pulsar/sql/presto/TestPulsarMetadata.java      |  56 +-
 .../pulsar/sql/presto/TestPulsarRecordCursor.java  |  90 ++-
 11 files changed, 689 insertions(+), 340 deletions(-)

commit 879c730daf781ef27ad1344803ca97ad60cd4b62
Author: Victor <vli02@hotmail.com>
Date:   Fri Sep 7 12:25:23 2018 -0700

    fixed zookeeper name references in helm charts. (#2525)
    
    ### Motivation
    
    zookeeper failed to start because of wrong ZOOKEEPER_SERVERS was set.
    
    ### Modifications
    
    Changed the reference of zookeeper names by how they were created.
    
    ### Result
    
    zookeeper started successfully and broker worked as expected.

 .../kubernetes/helm/pulsar/templates/autorecovery-configmap.yaml      | 2 +-
 deployment/kubernetes/helm/pulsar/templates/bookkeeper-configmap.yaml | 2 +-
 deployment/kubernetes/helm/pulsar/templates/broker-configmap.yaml     | 4 ++--
 deployment/kubernetes/helm/pulsar/templates/proxy-configmap.yaml      | 4 ++--
 .../kubernetes/helm/pulsar/templates/zookeeper-statefulset.yaml       | 2 +-
 5 files changed, 7 insertions(+), 7 deletions(-)

commit 59df98bd5675fa17cc858fa2a0c5cac45475a5f4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Sep 6 20:54:42 2018 -0700

    When WindowConfig is set, automatically default autoAck to false (#2532)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java      | 5 -----
 1 file changed, 5 deletions(-)

commit e4aea8cd04f8052ff91ba50294b25d01d8943d99
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Sep 6 11:15:49 2018 -0700

    Fix validator logic to differentiate between serializer and deserializer (#2523)
    
    * Fix validator logic to differentiate between serializer and deserializer
    
    * Expand to include backend and schema
    
    * Fix buil
    
    * Fix unittest
    
    * Fixed unittest

 .../pulsar/functions/instance/ContextImpl.java     |  4 +-
 .../pulsar/functions/instance/InstanceUtils.java   | 37 +++++++++----
 .../apache/pulsar/functions/sink/PulsarSink.java   |  4 +-
 .../pulsar/functions/source/PulsarSource.java      |  4 +-
 .../pulsar/functions/source/TopicSchema.java       | 18 +++----
 .../pulsar/functions/sink/PulsarSinkTest.java      |  2 +-
 .../pulsar/functions/source/PulsarSourceTest.java  |  2 +-
 .../functions/utils/validation/ValidatorImpls.java | 62 ++++++++++++++--------
 8 files changed, 80 insertions(+), 53 deletions(-)

commit 261eab12789c8c06b64cb7a5688ab0c867d609b1
Author: David Kjerrumgaard <35466513+david-streamlio@users.noreply.github.com>
Date:   Thu Sep 6 11:06:33 2018 -0700

    Added HDFS Sink (#2409)
    
    * Added HDFS Sink
    
    * Fixed issues identified during PR review
    
    * Fixed comment
    
    * Added HDFS Container to externalServices
    
    * Ignoring HdfsSink test for now
    
    * Removed HDFS Container to externalServices
    
    * Fixed ASL licensing
    
    * Fixed compile errors
    
    * Added HDFS to SinkType Enum

 pom.xml                                            |  50 +++-
 pulsar-io/hdfs/pom.xml                             |  69 ++++++
 .../apache/pulsar/io/hdfs/AbstractHdfsConfig.java  |  86 +++++++
 .../pulsar/io/hdfs/AbstractHdfsConnector.java      | 258 +++++++++++++++++++++
 .../org/apache/pulsar/io/hdfs/Compression.java     |  26 +++
 .../org/apache/pulsar/io/hdfs/HdfsResources.java   |  51 ++++
 .../org/apache/pulsar/io/hdfs/SecurityUtil.java    |  91 ++++++++
 .../org/apache/pulsar/io/hdfs/package-info.java    |  19 ++
 .../pulsar/io/hdfs/sink/HdfsAbstractSink.java      | 121 ++++++++++
 .../apache/pulsar/io/hdfs/sink/HdfsSinkConfig.java | 108 +++++++++
 .../apache/pulsar/io/hdfs/sink/HdfsSyncThread.java |  80 +++++++
 .../apache/pulsar/io/hdfs/sink/package-info.java   |  19 ++
 .../sink/seq/HdfsAbstractSequenceFileSink.java     |  96 ++++++++
 .../io/hdfs/sink/seq/HdfsSequentialTextSink.java   |  71 ++++++
 .../pulsar/io/hdfs/sink/seq/HdfsTextSink.java      |  54 +++++
 .../pulsar/io/hdfs/sink/seq/package-info.java      |  19 ++
 .../hdfs/sink/text/HdfsAbstractTextFileSink.java   |  79 +++++++
 .../pulsar/io/hdfs/sink/text/HdfsStringSink.java   |  34 +++
 .../pulsar/io/hdfs/sink/text/package-info.java     |  19 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../pulsar/io/hdfs/sink/AbstractHdfsSinkTest.java  | 119 ++++++++++
 .../pulsar/io/hdfs/sink/HdfsSinkConfigTests.java   | 154 ++++++++++++
 .../io/hdfs/sink/seq/HdfsSequentialSinkTests.java  |  94 ++++++++
 .../pulsar/io/hdfs/sink/seq/HdfsTextSinkTests.java | 104 +++++++++
 .../io/hdfs/sink/text/HdfsStringSinkTests.java     | 103 ++++++++
 .../hdfs/src/test/resources/hadoop/core-site.xml   |  32 +++
 .../hdfs/src/test/resources/hadoop/hdfs-site.xml   |  34 +++
 pulsar-io/hdfs/src/test/resources/sinkConfig.yaml  |  25 ++
 pulsar-io/pom.xml                                  |   1 +
 .../integration/containers/HdfsContainer.java      |  51 ++++
 .../integration/functions/PulsarFunctionsTest.java |   7 +-
 .../tests/integration/io/HdfsSinkTester.java       |  65 ++++++
 .../pulsar/tests/integration/io/SinkTester.java    |   3 +-
 .../tests/integration/suites/PulsarTestSuite.java  |   1 +
 34 files changed, 2157 insertions(+), 8 deletions(-)

commit d734738d439963a5ed0348ab778385f8c4e8d35b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 6 10:58:17 2018 -0700

    Downgrading ZK to stable version 3.4.13 (#2473)
    
    * Downgrading ZK to stable version 3.4.13
    
    * Added integration test for ZK server downgrade
    
    * Fixed ZookeeperClientFactoryImplTest.testZKCreationFailure
    
    * Fixed dependencies version in license file
    
    * Addressed comments
    
    * Fixed jline version in license file
    
    * There are 2 jline jars to count

 distribution/server/licenses/LICENSE-JLine.txt     |  29 +++++
 distribution/server/src/assemble/LICENSE.bin.txt   |  43 +++----
 pom.xml                                            |   8 +-
 pulsar-sql/presto-distribution/LICENSE             |   4 +-
 pulsar-zookeeper-utils/pom.xml                     |  57 +++++++++
 .../pulsar/zookeeper/FileTxnSnapLogWrapper.java    |  60 ----------
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   2 +-
 .../pulsar/zookeeper/SerializeUtilsAspect.java     | 130 +++++++++++++++++++++
 .../zookeeper/ZookeeperBkClientFactoryImpl.java    |   7 +-
 .../zookeeper/ZookeeperClientFactoryImplTest.java  |  12 +-
 .../pulsar/zookeeper/ZooKeeperServerAspect.java    |  16 ---
 .../integration/topologies/PulsarCluster.java      |  10 ++
 .../integration/topologies/PulsarClusterSpec.java  |   8 ++
 .../integration/upgrade/PulsarZKDowngradeTest.java | 115 ++++++++++++++++++
 .../src/test/resources/zk-3.5-test-data/log.1      | Bin 0 -> 20480 bytes
 .../src/test/resources/zk-3.5-test-data/log.85     | Bin 0 -> 1024 bytes
 .../src/test/resources/zk-3.5-test-data/snapshot.0 | Bin 0 -> 424 bytes
 .../test/resources/zk-3.5-test-data/snapshot.84    | Bin 0 -> 10747 bytes
 18 files changed, 394 insertions(+), 107 deletions(-)

commit 6860a90bc685003afef17ab8bfa33e2701c99bfe
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Sep 6 19:56:52 2018 +0200

    Typo in CSR generation docs (#2530) (#2531)
    
    The output file for CSR generation was .cert.pem rather than .csr.pem,
    which causes confusion. It should be .csr.pem

 site2/docs/security-tls-authentication.md                               | 2 +-
 site2/docs/security-tls-transport.md                                    | 2 +-
 .../version-2.1.0-incubating/security-tls-authentication.md             | 2 +-
 .../versioned_docs/version-2.1.0-incubating/security-tls-transport.md   | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit 3ffcf61c45be5d64c1f6ec538cdd38cfe0d07c2b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 6 07:40:24 2018 -0700

    [go] Ensure producer/consumer/reader keep a ref of client instance so it won't be finalized (#2527)

 pulsar-client-go/pulsar/c_consumer.go |  3 ++-
 pulsar-client-go/pulsar/c_producer.go | 12 +++++++-----
 pulsar-client-go/pulsar/c_reader.go   |  3 ++-
 3 files changed, 11 insertions(+), 7 deletions(-)

commit 2ecd03abbbf6128d59d27a9d151ed47cc7ead4c7
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Sep 6 07:39:37 2018 -0700

    Reintroduce Aerospike connector (#2524)

 distribution/io/src/assemble/io.xml                |   8 +
 pom.xml                                            |   1 +
 pulsar-io/aerospike/pom.xml                        |  69 +++++++++
 .../pulsar/io/aerospike/AerospikeAbstractSink.java | 169 +++++++++++++++++++++
 .../pulsar/io/aerospike/AerospikeSinkConfig.java   |  64 ++++++++
 .../pulsar/io/aerospike/AerospikeStringSink.java   |  35 +++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 pulsar-io/pom.xml                                  |   1 +
 site2/docs/deploy-bare-metal.md                    |   1 +
 site2/docs/getting-started-standalone.md           |   1 +
 site2/docs/io-aerospike.md                         |  21 +++
 site2/docs/io-connectors.md                        |   1 +
 site2/docs/io-overview.md                          |   3 +-
 site2/docs/io-quickstart.md                        |   3 +-
 14 files changed, 397 insertions(+), 2 deletions(-)

commit 669196c27d3c2028a112d939774744dae8ab1b88
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Sep 6 01:01:03 2018 -0700

    TopicPatterns are now supported by python functions (#2506)

 .../instance/src/main/python/python_instance.py    | 26 ++++++++++++++--------
 .../src/main/python/python_instance_main.py        |  3 ---
 .../functions/utils/validation/ValidatorImpls.java |  9 --------
 3 files changed, 17 insertions(+), 21 deletions(-)

commit 90a7448041aca5d5189b6a0b641453a50369faad
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Sep 6 01:00:12 2018 -0700

     better way to estimate object size for sql (#2528)
    
    Since we mocked ClassLayout.parseClass() because we need to exclude org.openjdk.jol for license issues. Lets come up with another way to estimate class size

 pulsar-sql/presto-distribution/LICENSE             |  3 +++
 pulsar-sql/presto-distribution/pom.xml             | 14 ++++++++++++
 .../java/org/openjdk/jol/info/ClassLayout.java     | 26 ++++++++++++++++++----
 3 files changed, 39 insertions(+), 4 deletions(-)

commit 6fa95fa291483d28296760503c1150cf1c393d34
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Sep 5 14:41:37 2018 -0700

    [documentation] Add instructions for contributing c++/python code changes (#2513)

 pulsar-client-cpp/docker-format.sh | 44 ++++++++++++++++++++++++++++++++++++++
 site2/website/contributing.md      | 24 +++++++++++++++++++++
 2 files changed, 68 insertions(+)

commit 7a92111fe7824d422d1739abd06d85955b652212
Author: penghui <codelipenghui@gmail.com>
Date:   Thu Sep 6 05:25:30 2018 +0800

    PIP-23: Pulsar Java Client Interceptors. (#2471)
    
    ### Motivation
    
    Support user to add interceptors to producer and consumer.
    
    ### Modifications
    
    Add Consumer interceptors.
    ```java
    Message<T> beforeConsume(Message<T> message);
    void onAcknowledge(MessageId messageId, Throwable cause);
    void onAcknowledgeCumulative(MessageId messageId, Throwable cause);
    ```
    Add Producer interceptors.
    ```java
    Message<T> beforeSend(Message<T> message);
    void onSendAcknowledgement(Message<T> message, MessageId msgId, Throwable cause);
    ```
    ### Result
    Users can using interceptors in multiple scenarios, such as for applications to add
    custom logging or processing.
    
    Master Issue: #2476

 .../apache/pulsar/client/impl/RawReaderImpl.java   |   2 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   7 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   3 +-
 .../broker/service/v1/V1_ReplicatorTest.java       |   3 +-
 .../apache/pulsar/client/api/InterceptorsTest.java | 359 +++++++++++++++++++++
 .../org/apache/pulsar/client/api/Consumer.java     |   6 +
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   8 +
 .../pulsar/client/api/ConsumerInterceptor.java     |  99 ++++++
 .../apache/pulsar/client/api/ProducerBuilder.java  |   8 +
 .../pulsar/client/api/ProducerInterceptor.java     |  92 ++++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  25 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  20 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  40 ++-
 .../pulsar/client/impl/ConsumerInterceptors.java   | 132 ++++++++
 .../org/apache/pulsar/client/impl/MessageImpl.java |   4 +-
 .../client/impl/MultiTopicsConsumerImpl.java       |  12 +-
 .../client/impl/PartitionedProducerImpl.java       |   6 +-
 .../impl/PatternMultiTopicsConsumerImpl.java       |   4 +-
 .../apache/pulsar/client/impl/ProducerBase.java    |  18 +-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  18 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  72 +++--
 .../pulsar/client/impl/ProducerInterceptors.java   | 110 +++++++
 .../pulsar/client/impl/PulsarClientImpl.java       |  45 +--
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   2 +-
 .../pulsar/client/impl/TopicMessageImpl.java       |   4 +
 .../pulsar/functions/instance/ContextImplTest.java |   2 +-
 .../MultiConsumersOneOutputTopicProducersTest.java |  27 +-
 27 files changed, 1033 insertions(+), 95 deletions(-)

commit 7b2bf197ac5b17e4fcfdb9d6aa2a7fadbe713d37
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Sep 5 10:49:26 2018 -0700

    Misc Cleanups (#2512)

 .../apache/pulsar/functions/instance/JavaInstanceRunnable.java | 10 +---------
 pulsar-functions/proto/src/main/proto/Function.proto           |  2 +-
 2 files changed, 2 insertions(+), 10 deletions(-)

commit ec9dfa8e2ec0af29f6a29d1ce5817d245164c533
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 5 10:37:52 2018 -0700

    Delete temp file after submitting function (#2519)

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    |  3 +--
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java    |  3 +--
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java  |  3 +--
 .../main/java/org/apache/pulsar/functions/worker/Utils.java    | 10 +++++++++-
 4 files changed, 12 insertions(+), 7 deletions(-)

commit 2ae20e2f55ccacff1a6201986a5c3f2e7a0ca6bc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 5 10:37:30 2018 -0700

    Log and Return error-message on function-stats failure (#2517)

 .../apache/pulsar/functions/worker/rest/api/FunctionsImpl.java    | 8 ++------
 1 file changed, 2 insertions(+), 6 deletions(-)

commit 10ce8ec603c64581f086497cd8192538ba6cdd12
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 5 10:37:14 2018 -0700

    Add CLI to get function status of a specific instance (#2518)
    
    * Add CLI to get function status of a specific instance
    
    * fix condition and test

 .../org/apache/pulsar/client/admin/Functions.java    | 20 +++++++++++++++++++-
 .../pulsar/client/admin/internal/FunctionsImpl.java  | 20 ++++++++++++++++++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java    | 16 ++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java    |  9 ++++++++-
 site2/docs/reference-pulsar-admin.md                 |  2 +-
 5 files changed, 64 insertions(+), 3 deletions(-)

commit 45d1a99c1e04e28381be07c708f34c53609660de
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Sep 5 10:22:27 2018 -0700

    Use SigKill to kill python process as opposed to sigterm which can be caught (#2514)

 pulsar-functions/instance/src/main/python/python_instance.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6d5811445c150b728a83194b2d3868333d1bfaa3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Sep 5 09:05:40 2018 -0700

    Fix Handling of user defined nar sources/sinks (#2502)
    
    * Fix handling of nar archives
    
    * Adress review comments
    
    * Added a integration test to test archive
    
    * Fixed build
    
    * Fix build
    
    * Fix integratin test

 .../functions/instance/JavaInstanceRunnable.java   |   9 +-
 .../integration/functions/PulsarFunctionsTest.java |  82 +++++++++-----
 .../integration/io/CassandraSinkArchiveTester.java | 121 +++++++++++++++++++++
 .../tests/integration/io/CassandraSinkTester.java  |   2 +-
 .../tests/integration/io/JdbcSinkTester.java       |   2 +-
 .../tests/integration/io/KafkaSinkTester.java      |   2 +-
 .../pulsar/tests/integration/io/SinkTester.java    |  24 +++-
 7 files changed, 202 insertions(+), 40 deletions(-)

commit 8453d73e94f0a22de53a4a003c2084e1573ac855
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 4 15:56:07 2018 -0700

    [schema] implement generic schema/record for Schema.JSON (#2497)
    
     ### Motivation
    
    The `GenericSchema` and `GenericRecord` are used for schema auto detection. Currently it only supports Avro.
    This PR is to support json.
    
     ### Changes
    
    Introduce generic schema and generic record for json schema

 .../pulsar/client/api/schema/GenericRecord.java    |  4 +-
 .../schema/{ => generic}/GenericAvroRecord.java    |  7 +-
 .../schema/{ => generic}/GenericAvroSchema.java    | 33 ++------
 .../impl/schema/generic/GenericJsonRecord.java     | 74 ++++++++++++++++
 .../impl/schema/generic/GenericJsonSchema.java     | 63 ++++++++++++++
 .../client/impl/schema/generic/GenericSchema.java  | 77 +++++++++++++++++
 .../impl/schema/generic/GenericSchemaTest.java     | 99 ++++++++++++++++++++++
 .../pulsar/client/schema/AvroSchemaTest.java       | 93 +-------------------
 .../pulsar/client/schema/JSONSchemaTest.java       | 38 ++-------
 .../pulsar/client/schema/SchemaTestUtils.java      | 61 +++++++++++++
 .../pulsar/client/impl/PulsarClientImpl.java       | 10 +--
 11 files changed, 398 insertions(+), 161 deletions(-)

commit 889b1bfe8c28075d64ee02bd63510de0d01772b9
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Sep 4 23:41:47 2018 +0200

    Handle /managed-ledgers znode existance on cluster init (#2379) (#2510)
    
    ManagedLedger clients may create the /managed-ledger znode on boot, so
    if a broker starts before the metadata is initialized, it could
    potentially block initialization.
    
    This patch changes this by making the existance of /managed-ledger a
    non-error condition.

 .../main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java    | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 79ac46a6ae50e48bed4ccb680d1f7945611f0565
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Wed Sep 5 04:20:42 2018 +0800

    Issue 2313: create a JDBC sink connector (#2440)
    
    ### Motivation
    
    This change is trying to add a basic JDBC sink connector.
    
    ### Modifications
    
    Add the jdbc module to the pulsar-io sub-module.
    Add unit test and integration test for it.
    
    ### Result
    
    ut and integration test pass.
    
    Master Issue: #2442

 distribution/io/src/assemble/io.xml                |   5 +
 pom.xml                                            |   9 +-
 pulsar-io/jdbc/lombok.config                       |  23 +++
 pulsar-io/jdbc/pom.xml                             |  96 ++++++++++
 .../apache/pulsar/io/jdbc/JdbcAbstractSink.java    | 197 +++++++++++++++++++++
 .../apache/pulsar/io/jdbc/JdbcAvroSchemaSink.java  |  92 ++++++++++
 .../org/apache/pulsar/io/jdbc/JdbcSinkConfig.java  |  63 +++++++
 .../java/org/apache/pulsar/io/jdbc/JdbcUtils.java  | 178 +++++++++++++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 .../org/apache/pulsar/io/jdbc/JdbcSinkTest.java    | 135 ++++++++++++++
 .../org/apache/pulsar/io/jdbc/JdbcUtilsTest.java   |  95 ++++++++++
 .../org/apache/pulsar/io/jdbc/SqliteUtils.java     | 111 ++++++++++++
 pulsar-io/pom.xml                                  |   1 +
 tests/integration/pom.xml                          |  21 +++
 .../integration/functions/PulsarFunctionsTest.java |  54 +++++-
 .../functions/PulsarFunctionsTestBase.java         |   2 +-
 .../tests/integration/io/JdbcSinkTester.java       | 137 ++++++++++++++
 .../tests/integration/suites/PulsarTestSuite.java  |  11 ++
 18 files changed, 1245 insertions(+), 7 deletions(-)

commit 8763c746b5b38901d7fbb77e5766f55c563ba25e
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Sep 4 22:18:46 2018 +0200

    Don't initialize /managed-ledgers on client creation (#2379) (#2509)
    
    Normally the /managed-ledgers znode is created by the
    initialize-cluster-metadata command when a cluster is being turned
    up.
    
    However, the ManagedLedger client also creates it on boot. This has
    caused issues in the past, where if a broker is started before
    initialize-cluster-metadata is run, then initialize-cluster-metadata
    fails because it sees the /managed-ledger znode.
    
    This patch removes the automatic creation of this znode from the
    client boot process.

 .../mledger/impl/MetaStoreImplZookeeper.java       | 64 +++++++++++++++++++---
 .../mledger/impl/MetaStoreImplZookeeperTest.java   | 52 ++++++++++++++++++
 .../bookkeeper/test/BookKeeperClusterTestCase.java |  4 ++
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |  4 ++
 4 files changed, 117 insertions(+), 7 deletions(-)

commit 03d1302c91506df1dace73a60689e78ea589505f
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 4 12:34:48 2018 -0700

    Ensure standalone service comes back quickly after ungraceful restarts (#2487)
    
    * Ensure standalone service comes back quickly after ungraceful restarts
    
    * Handle NoNode errors when deleting
    
    * Added NoopLoadManager for standalone mode

 conf/standalone.conf                               |   2 +
 .../pulsar/broker/loadbalance/NoopLoadManager.java | 158 +++++++++++++++++++++
 .../loadbalance/impl/ModularLoadManagerImpl.java   |   3 +-
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |  15 +-
 4 files changed, 176 insertions(+), 2 deletions(-)

commit ad03a07d5f5d93654f1d5afb8694989db5688095
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Sep 4 11:59:03 2018 -0700

    Add pulsar flink sink connector (#2434)
    
    @XiaoZYang introduces a module for a pulsar sink connector for flink. This PR is moving the work from flink repo to pulsar repo, so the flink connector can be released faster along with Pulsar releases.
    
    Original Flink Github Issue: apache/flink#5845
    Jira Issue: https://issues.apache.org/jira/browse/FLINK-9168
    
    Original Author: @XiaoZYang (Zong Yang Xiao)

 pom.xml                                            |   3 +
 pulsar-flink/pom.xml                               | 137 +++++++++
 .../connectors/pulsar/FlinkPulsarProducer.java     | 314 +++++++++++++++++++++
 .../connectors/pulsar/PulsarJsonTableSink.java     |  61 ++++
 .../connectors/pulsar/PulsarProduceMode.java       |  37 +++
 .../connectors/pulsar/PulsarTableSink.java         | 163 +++++++++++
 .../pulsar/partitioner/PulsarKeyExtractor.java     |  36 +++
 .../pulsar/serde/JsonRowDeserializationSchema.java | 130 +++++++++
 .../pulsar/serde/JsonRowSerializationSchema.java   |  92 ++++++
 9 files changed, 973 insertions(+)

commit 8f4f371def2983f64e5dfa8f31e9fe04a2e21462
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 4 11:16:11 2018 -0700

    Allow to configure bookie settings when running in standalone mode (#2480)
    
    ### Motivation
    
    Most bookie configs are set in stone when running Pulsar in standalone mode.
    
    We need to be able to tune these settings to have the Pulsar standalone to adapt for running with small memory settings.

 conf/standalone.conf                               | 79 ++++++++++++++++++++++
 .../java/org/apache/pulsar/PulsarStandalone.java   |  9 ++-
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 20 ++----
 3 files changed, 92 insertions(+), 16 deletions(-)

commit 37f266bb0357fa825f1b3c2e99582526c43bba84
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 4 11:15:24 2018 -0700

    Fix log4j config to not redirect BK logs into separate file (#2482)
    
    ### Motivation
    
    Currently all `org.apache.bookkeeper` messages printed by broker are being routed to a different log file `broker.log.bk`. Removing for now the special config for BK logs.

 conf/log4j2.yaml | 50 --------------------------------------------------
 1 file changed, 50 deletions(-)

commit 4124de11c407e7a5efa8aa2f4b669e22543ee427
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Sep 4 00:17:29 2018 -0700

    [functions] Don't set the state storage url if state is not enabled. (#2488)

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 16f3517b9d02fee072fa07f987bb150eb3efd92f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Sep 2 12:19:36 2018 -0700

    Include pulsar python client dependencies in pulsar image (#2491)

 docker/pulsar/Dockerfile                           |  6 ++-
 docker/pulsar/pom.xml                              | 44 ++++++++++++++++++++++
 .../pulsar}/scripts/install-pulsar-client.sh       |  0
 .../docker-images/latest-version-image/Dockerfile  |  8 +---
 tests/docker-images/latest-version-image/pom.xml   | 44 ----------------------
 5 files changed, 51 insertions(+), 51 deletions(-)

commit 23afb6963623498d7ed315976f0280acac245b4c
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Sun Sep 2 02:00:08 2018 +0900

    Fix typos (#2507)
    
    * Fix typo: mental -> metal
    
    * Fix typo: adnin -> admin

 site/docs/latest/admin-api/tenants.md                                   | 2 +-
 site2/docs/admin-api-schemas.md                                         | 2 +-
 site2/docs/admin-api-tenants.md                                         | 2 +-
 site2/docs/getting-started-standalone.md                                | 2 +-
 .../versioned_docs/version-2.1.0-incubating/admin-api-schemas.md        | 2 +-
 .../versioned_docs/version-2.1.0-incubating/admin-api-tenants.md        | 2 +-
 .../version-2.1.0-incubating/getting-started-standalone.md              | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)

commit 95f2bf8817cdc3b0a32bff153a6f7252f7fc3b3d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Sep 1 09:59:31 2018 -0700

    Fix sql cli (#2505)
    
    * minor fix of sql cli args
    
    * remove debug

 bin/pulsar | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit cfdcdb5c096918187ab52725ba091c401f28b62c
Author: Victor <vli02@hotmail.com>
Date:   Sat Sep 1 00:09:30 2018 -0700

    Fixed the issue 2481 by not to take PULSAR_MEM from env. (#2484)
    
    ### Motivation
    
    Command `./bin/pulsar-admin clusters list` failed with `Error: Could not find or load main class "` in my k8s deployment by using helm charts.
    
    ### Modifications
    
    With helm deployment the env var PULSAR_MEM is quoted with `"`, taking it for `pulsar-admin` will make the exec command to be:
    
    ```exec /docker-java-home/bin/java -cp '/pulsar/conf:::/pulsar/lib/*:' -Dlog4j.configurationFile=log4j2.yaml -Djava.net.preferIPv4Stack=true '"' -Xms1g -Xmx1g '-XX:MaxDirectMemorySize=1g"' -client -Dio.netty.leakDetectionLevel=disabled ... org.apache.pulsar.admin.cli.PulsarAdminTool /pulsar/conf/client.conf clusters list```
    
    The fix is to take out the use of env var PULSAR_MEM in `conf/pulsar_tools_env.sh`.
    
    ### Result
    
    `pulsar-admin` works as expected.
    
    Fixes #2481

 conf/pulsar_tools_env.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 42b598a17b64d76428d48438cfb169cf3a1fcd5d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Sep 1 00:07:12 2018 -0700

    [Schema] Introduce Schema.AUTO to detect schema automatically for consumers and readers (#2494)
    
    ### Motivation
    
    Sometimes consumers and readers don't have the pojo for the message schemas. so we can use `Schema.Auto` to detect
    the schema and reflect the messages into generic records.
    
     ### Changes
    
    - Introduce AutoSchema and `SchemaType.AUTO`
    - fetch schema information first when `AutoSchema` is used

 .../api/SimpleTypedProducerConsumerTest.java       | 95 ++++++++++++++++++++++
 .../java/org/apache/pulsar/client/api/Schema.java  |  6 ++
 .../pulsar/client/impl/schema/AutoSchema.java      | 63 ++++++++++++++
 .../pulsar/client/schema/AvroSchemaTest.java       | 21 ++++-
 .../pulsar/client/impl/PulsarClientImpl.java       | 52 ++++++++++++
 .../apache/pulsar/common/schema/SchemaType.java    |  7 +-
 6 files changed, 242 insertions(+), 2 deletions(-)

commit 143979d15525520edeaededd6b7878b61f5c8bfe
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 31 15:49:09 2018 -0700

    Fix: avoid continuous acking with invalid msgId for cumulative ack (#2498)

 .../pulsar/client/impl/PersistentAcknowledgmentsGroupingTracker.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 34e9fd6a441ccb5a895562c6872a7ce992cb39b9
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Sep 1 00:39:31 2018 +0200

    Copy ByteBufPair buffers when using with SSL (#2401) (#2464)
    
    The netty SSL handler uses a coalescing buffer queue, which modifies
    the buffers used to queue the writes so that SSL_write can be given
    larger chunks, thereby increasing the 'goodput'.
    
    If we pass in a retained duplicate as we have been doing until now,
    then later clients will be passed junk, as SSL will have modified cached
    entry buffers.
    
    This patch introduces a copying ByteBufPair encoder, which is only
    used with SSL connections.

 .../broker/service/PulsarChannelInitializer.java   |  4 +++-
 .../apache/pulsar/client/impl/ConnectionPool.java  |  5 +++--
 .../org/apache/pulsar/common/api/ByteBufPair.java  | 25 +++++++++++++++++++++-
 3 files changed, 30 insertions(+), 4 deletions(-)

commit 79b88cf66eb2a4d337e21ade7f699c7d641b5c9a
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 31 15:39:11 2018 -0700

    Added producer/consumer properties in Go client (#2447)

 pulsar-client-cpp/include/pulsar/ProducerConfiguration.h    |  5 +++--
 pulsar-client-cpp/include/pulsar/c/consumer_configuration.h |  3 +++
 pulsar-client-cpp/include/pulsar/c/producer_configuration.h |  3 +++
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc          |  5 +++++
 pulsar-client-cpp/lib/c/c_ProducerConfiguration.cc          |  5 +++++
 pulsar-client-go/pulsar/c_consumer.go                       | 12 ++++++++++++
 pulsar-client-go/pulsar/c_producer.go                       | 12 ++++++++++++
 pulsar-client-go/pulsar/consumer.go                         |  4 ++++
 pulsar-client-go/pulsar/producer.go                         |  4 ++++
 pulsar-client-go/pulsar/producer_test.go                    |  8 ++++++--
 10 files changed, 57 insertions(+), 4 deletions(-)

commit 630fc0db6d4fb0af43675c8d9f6f8c93fb209552
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 31 15:09:18 2018 -0700

    add sub-name option to function cli (#2492)
    
    * add sub-name option to function cli
    
    * add docs

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 11 +++++++++++
 .../org/apache/pulsar/functions/utils/FunctionConfig.java     |  1 +
 site2/docs/reference-pulsar-admin.md                          |  3 +++
 3 files changed, 15 insertions(+)

commit 581acc67ec68a0b1eaeba6d959d94ca2a55f077f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Aug 31 14:56:06 2018 -0700

    Fix semantics of skip output (#2468)
    
    * Fix semantics of skip output
    
    * Remove skip Output altogether
    
    * Remove doc about skip-output since we have removed it
    
    * Fixed unittest
    
    * Fixed test

 .../java/org/apache/pulsar/admin/cli/CmdFunctionsTest.java     |  6 ++----
 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 10 +---------
 .../java/org/apache/pulsar/functions/utils/FunctionConfig.java |  1 -
 site2/docs/reference-pulsar-admin.md                           |  3 ---
 4 files changed, 3 insertions(+), 17 deletions(-)

commit 18f0741b194ab17df5e33df0cba3ce1d85314d13
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Aug 31 14:55:13 2018 -0700

    Initial SQL documentation and DataGeneratorSource (#2479)
    
    * Initial SQL documentation and DataGeneratorSource
    
    * adding license header
    
    * adding to sidebar
    
    * improving documentation
    
    * adding to sql getting started
    
    * small fix
    
    * adding data generator to connector bin distribution
    
    * improve sql worker cli
    
    * adding data generator to io pom
    
    * modifying launch args

 bin/pulsar                                         |   2 +-
 conf/presto/catalog/pulsar.properties              |   5 +
 distribution/io/src/assemble/io.xml                |   5 +
 pulsar-io/data-genenator/pom.xml                   |  57 ++++++++
 .../io/datagenerator/DataGeneratorSource.java      |  59 ++++++++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 +++
 pulsar-io/pom.xml                                  |   1 +
 site2/docs/assets/pulsar-sql-arch-1.png            | Bin 0 -> 167744 bytes
 site2/docs/assets/pulsar-sql-arch-2.png            | Bin 0 -> 130432 bytes
 site2/docs/sql-deployment-configurations.md        | 150 +++++++++++++++++++++
 site2/docs/sql-getting-started.md                  | 142 +++++++++++++++++++
 site2/docs/sql-overview.md                         |  24 ++++
 site2/website/scripts/replace.js                   |   9 +-
 site2/website/sidebars.json                        |   5 +
 14 files changed, 479 insertions(+), 2 deletions(-)

commit 1263043f81cf469e7d9a524a8d3889edd277f649
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Aug 31 12:21:42 2018 -0700

    Fix Trigger Functinality (#2501)

 .../pulsar/functions/worker/rest/api/FunctionsImpl.java     | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

commit d1134bfd0746618586c6fe1cb67ab6ecb097e6af
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Aug 31 12:12:29 2018 -0700

    Added a no args constructor (#2485)

 .../org/apache/pulsar/functions/api/examples/serde/CustomObject.java | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

commit affbe171739d60bcaa919f3d5ad7816c14e813a6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Aug 31 12:11:37 2018 -0700

    Attach Producer/Consumer property tags so its easier to identify topics being produced/consumed by functions (#2490)

 .../functions/instance/JavaInstanceRunnable.java   |  6 ++++--
 .../producers/AbstractOneOuputTopicProducers.java  | 23 ++++++++++------------
 .../MultiConsumersOneOuputTopicProducers.java      |  7 +++++--
 .../apache/pulsar/functions/sink/PulsarSink.java   | 20 ++++++++++---------
 .../pulsar/functions/source/PulsarSource.java      | 15 +++++++++-----
 .../MultiConsumersOneOutputTopicProducersTest.java |  2 +-
 .../pulsar/functions/sink/PulsarSinkTest.java      | 10 +++++-----
 .../pulsar/functions/source/PulsarSourceTest.java  | 10 +++++-----
 8 files changed, 51 insertions(+), 42 deletions(-)

commit 5fb58d23eb9bf9298b368fac255f428da8209d59
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 31 10:32:44 2018 -0700

    Fix: auto-ack flag always set true (#2496)
    
    make ato-ack default true

 .../java/org/apache/pulsar/admin/cli/CmdFunctionsTest.java   |  2 ++
 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 12 ++++--------
 2 files changed, 6 insertions(+), 8 deletions(-)

commit e71540e27e1c577fff5ccddb4bf7b3fe9a90d248
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Aug 30 23:28:55 2018 -0700

    Clarified project roles in team page (#2470)

 site2/website/pages/en/team.js | 17 +++++++++--------
 1 file changed, 9 insertions(+), 8 deletions(-)

commit c12e9ae0f4cf548186dc8ad64b921c6aa931f837
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Aug 30 23:28:20 2018 -0700

    Added Contributing page on website (#2459)
    
    * Added Contributing page on website
    
    * Fixed mentions to BookKeeper
    
    * Addressed comments
    
    * Added section "Becoming a committer"
    
    * Also added section for PMC member
    
    * Reworded the "become committer" section

 site2/website/contributing.md          | 315 +++++++++++++++++++++++++++++++++
 site2/website/core/Footer.js           |   2 +
 site2/website/pages/en/contributing.js |  35 ++++
 3 files changed, 352 insertions(+)

commit ce74b11b563462d18ae0068cf2d9d9ef0271165a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Aug 30 22:44:21 2018 -0700

    Revert "Fix: Function assignment can support large number of topics (#2438)" (#2474)
    
    This reverts commit b283ebd3e51aa86f6b9f0a6607f430996f0032f7.

 conf/functions_worker.yml                          |  1 -
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  2 -
 .../functions/worker/FunctionAssignmentTailer.java | 70 ++++++----------------
 .../functions/worker/FunctionRuntimeManager.java   | 67 +--------------------
 .../pulsar/functions/worker/MembershipManager.java |  2 -
 .../pulsar/functions/worker/SchedulerManager.java  | 46 ++++----------
 .../org/apache/pulsar/functions/worker/Worker.java | 59 ++++++++----------
 .../pulsar/functions/worker/WorkerConfig.java      |  3 +-
 .../worker/FunctionRuntimeManagerTest.java         | 33 +---------
 .../functions/worker/MembershipManagerTest.java    |  3 +-
 .../functions/worker/SchedulerManagerTest.java     |  8 ---
 11 files changed, 67 insertions(+), 227 deletions(-)

commit 03742b73b3ec0f391840f849041875621b47140f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Aug 30 22:39:59 2018 -0700

    Added the --custom-schema-inputs cli arg to allow custom schema input to functions (#2486)
    
    * Added the --custom-schema-inputs cli arg to allow custom schema input to functions
    
    * Update documentation regarding the same

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 7 +++++++
 site2/docs/reference-pulsar-admin.md                               | 3 +++
 2 files changed, 10 insertions(+)

commit 87fb48feaa1c2dfe31f08833a8a9f889837f6d96
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Aug 29 19:34:30 2018 -0700

    Updated documentation about changed arguments for functions, sources and sinks (#2457)
    
    * Updated documentation about changed arguments for functions, sources and sinks
    
    * Some missing files

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   4 -
 site2/docs/deploy-bare-metal.md                    |   4 +-
 site2/docs/functions-api.md                        |  73 +++---
 site2/docs/functions-deploying.md                  |  20 +-
 site2/docs/functions-guarantees.md                 |   4 +-
 site2/docs/functions-overview.md                   |  24 +-
 site2/docs/functions-quickstart.md                 |  10 +-
 site2/docs/io-managing.md                          |  20 +-
 site2/docs/io-quickstart.md                        |   2 +-
 site2/docs/reference-pulsar-admin.md               | 272 ++++++++++++++++-----
 11 files changed, 295 insertions(+), 140 deletions(-)

commit 9c1503b67eb122d2801fd9a9b5a94e5f7780efc0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 29 00:52:29 2018 -0700

     [tiered storage] Use NAR plugin to package offloaders  (#2393)
    
    
     ### Motivation
    
    Offloader typically involves a new storage system, which usually involves dependencies that
    might be conflicting with the dependencies of Pulsar. We want to package offloader implementations
    as what we did for connectors, so people can decide which offloader to use and only include it.
    People would also become easier to write its offloader if needed.
    
     ### Changes
    
    - Update `tiered-storage/jcloud` to package it using nifi-nar plugin.
    - Add bunch of utils in managed-ledger to locate offloader nar packages and load `LedgerOffloaderFactory` from corresponding NAR package.
    - Add a new distribution module to package offloaders into one distribution, as what we did for connectors.
    - Update pulsar-all image to include offloaders
    
     ### NOTES
    
    This change doesn't get rid of jcloud-shaded. because jcloud is using `ServiceLoad` and Guice injection. It makes
    things very tricky on class loading. Not attempt to address the problem any time soon. We can pin `jcloud-shaded` version
    as what we did for `protobuf-shaded` in next release.

 conf/broker.conf                                   |   3 +
 distribution/offloaders/pom.xml                    |  68 ++++++++++
 distribution/offloaders/src/assemble/README        |  10 ++
 .../offloaders/src/assemble/offloaders.xml         |  54 ++++++++
 distribution/pom.xml                               |   1 +
 distribution/server/src/assemble/LICENSE.bin.txt   |  14 --
 docker/pulsar-all/Dockerfile                       |   4 +
 docker/pulsar-all/pom.xml                          |  21 +++
 .../mledger/offload/OffloaderDefinition.java       |  46 +++++++
 .../bookkeeper/mledger/offload/OffloaderUtils.java | 149 +++++++++++++++++++++
 .../bookkeeper/mledger/offload/Offloaders.java     |  57 ++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  11 ++
 pulsar-broker/pom.xml                              |   6 -
 .../org/apache/pulsar/broker/PulsarService.java    |  20 ++-
 tiered-storage/jcloud/pom.xml                      |  10 +-
 .../impl/BlobStoreManagedLedgerOffloader.java      |   6 +
 .../META-INF/services/pulsar-offloader.yaml        |  22 +++
 17 files changed, 474 insertions(+), 28 deletions(-)

commit 6aaf613e9b94e97041ea0c731b0d9d70d875f755
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Aug 28 16:39:39 2018 -0700

    Fix pulsar sql cli bug (#2469)

 bin/pulsar | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f36f375268ff876f46cff0ed8331b799ff7139b6
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Aug 28 13:53:05 2018 -0700

    Package Presto with Pulsar for SQL integration (#2428)
    
    * packaging presto with pulsar
    
    * cleaning up distribution
    
    * removing commented out lines
    
    * cleaning up comments
    
    * fix bug
    
    * moving pulsar config dir
    
    * adding missing header files
    
    * add dependencies to license
    
    * reorganizing project
    
    * adding new presto distribution
    
    * refactoring build and licenses
    
    * remove commented out code
    
    * addressing comments

 bin/pulsar                                         |  27 ++
 conf/presto/catalog/pulsar.properties              |  24 ++
 conf/presto/config.properties                      |  42 ++
 conf/presto/jvm.config                             |   8 +
 conf/presto/log.properties                         |  23 +
 distribution/server/licenses/LICENSE-golang.txt    |  27 ++
 distribution/server/src/assemble/bin.xml           |   4 +
 pom.xml                                            |   1 +
 pulsar-sql/pom.xml                                 |   1 +
 pulsar-sql/presto-distribution/LICENSE             | 468 +++++++++++++++++++++
 pulsar-sql/presto-distribution/pom.xml             | 145 +++++++
 .../presto-distribution/src/assembly/assembly.xml  |  63 +++
 .../java/org/openjdk/jol/info/ClassLayout.java     |  35 ++
 pulsar-sql/presto-pulsar-plugin/pom.xml            |   9 +-
 .../src/{main => }/assembly/assembly.xml           |   3 +-
 pulsar-sql/presto-pulsar/pom.xml                   |   7 +-
 src/check-binary-license                           |  30 +-
 17 files changed, 907 insertions(+), 10 deletions(-)

commit fa11a3ca5d36ae6c1cc169e32cd0164fd8e47487
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 28 10:41:14 2018 -0700

    Increase default maxConcurrentLookupRequests to 50k (#2380)
    
    ### Motivation
    
    Increasing the default value of `maxConcurrentLookupRequests` from 10K to 50K to increase limit of sustainable lookups before rejecting requests.

 conf/broker.conf                                                      | 3 +--
 conf/proxy.conf                                                       | 2 +-
 conf/standalone.conf                                                  | 2 +-
 deployment/terraform-ansible/templates/broker.conf                    | 2 +-
 deployment/terraform-ansible/templates/proxy.conf                     | 2 +-
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java  | 2 +-
 .../main/java/org/apache/pulsar/proxy/server/ProxyConfiguration.java  | 2 +-
 site2/docs/administration-proxy.md                                    | 2 +-
 site2/docs/reference-configuration.md                                 | 4 ++--
 9 files changed, 10 insertions(+), 11 deletions(-)

commit 6c5f2f63defe077a59003f37e06430d243b769dc
Author: penghui <codelipenghui@gmail.com>
Date:   Wed Aug 29 01:39:54 2018 +0800

    Add backlog quota retention policy to server config. (#2460)
    
    * Add backlog quota retention policy to server config.
    
    * Rename backlogQuotaRetentionPolicy to backlogQuotaDefaultRetentionPolicy
    
    * Change backlogQuotaDefaultRetentionPolicy String to enum.

 conf/broker.conf                                           |  6 ++++++
 .../org/apache/pulsar/broker/ServiceConfiguration.java     | 14 ++++++++++++++
 .../apache/pulsar/broker/service/BacklogQuotaManager.java  |  2 +-
 3 files changed, 21 insertions(+), 1 deletion(-)

commit 50caedc77d28a4cb4bf7c9639157bc3d06e37cf4
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 28 08:25:38 2018 -0700

    Fixed few links in contact and download pages (#2458)
    
    Fixed few links in contact and download pages

 site2/website/core/Footer.js       |  8 ++++----
 site2/website/pages/en/contact.js  |  8 ++++----
 site2/website/pages/en/download.js |  2 +-
 site2/website/pages/en/team.js     | 20 ++++++++++----------
 4 files changed, 19 insertions(+), 19 deletions(-)

commit 8a85384201ca4ee8a0d21f3b7c3df012b3d5074f
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 28 06:42:42 2018 -0700

    Support compaction options in Go client (#2449)
    
    Added the option for ReadCompacted in Go based consumer/reader configuration.

 pulsar-client-go/pulsar/c_consumer.go    |   2 +
 pulsar-client-go/pulsar/c_reader.go      |   2 +
 pulsar-client-go/pulsar/consumer.go      |  12 ++-
 pulsar-client-go/pulsar/consumer_test.go | 141 ++++++++++++++++++++++++++++++-
 pulsar-client-go/pulsar/producer_test.go |   1 -
 pulsar-client-go/pulsar/reader.go        |   9 ++
 pulsar-client-go/pulsar/reader_test.go   |  91 ++++++++++++++++++++
 7 files changed, 255 insertions(+), 3 deletions(-)

commit 83a3377e39cf17c2ebdf4c92f68eac26696356ee
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Aug 28 00:10:52 2018 -0700

    Remove Aerospike Connector (#2456)

 distribution/io/src/assemble/io.xml                |   6 -
 pom.xml                                            |   1 -
 pulsar-io/aerospike/pom.xml                        |  75 ---------
 .../pulsar/io/aerospike/AerospikeAbstractSink.java | 169 ---------------------
 .../pulsar/io/aerospike/AerospikeSinkConfig.java   |  64 --------
 .../pulsar/io/aerospike/AerospikeStringSink.java   |  35 -----
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ---
 pulsar-io/pom.xml                                  |   1 -
 site2/docs/deploy-bare-metal.md                    |   1 -
 site2/docs/getting-started-standalone.md           |   1 -
 site2/docs/io-aerospike.md                         |  21 ---
 site2/docs/io-connectors.md                        |   1 -
 site2/docs/io-overview.md                          |   3 +-
 site2/docs/io-quickstart.md                        |   3 +-
 14 files changed, 2 insertions(+), 401 deletions(-)

commit b283ebd3e51aa86f6b9f0a6607f430996f0032f7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 27 23:56:51 2018 -0700

    Fix: Function assignment can support large number of topics (#2438)

 conf/functions_worker.yml                          |  1 +
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  2 +
 .../functions/worker/FunctionAssignmentTailer.java | 70 ++++++++++++++++------
 .../functions/worker/FunctionRuntimeManager.java   | 67 ++++++++++++++++++++-
 .../pulsar/functions/worker/MembershipManager.java |  2 +
 .../pulsar/functions/worker/SchedulerManager.java  | 46 ++++++++++----
 .../org/apache/pulsar/functions/worker/Worker.java | 59 ++++++++++--------
 .../pulsar/functions/worker/WorkerConfig.java      |  3 +-
 .../worker/FunctionRuntimeManagerTest.java         | 33 +++++++++-
 .../functions/worker/MembershipManagerTest.java    |  3 +-
 .../functions/worker/SchedulerManagerTest.java     |  8 +++
 11 files changed, 227 insertions(+), 67 deletions(-)

commit ecc34a943bb005712ad2492cda6a1d3d8674255f
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 27 23:28:55 2018 -0700

    Fixed cpp multi-topic consumer when topics are not partitioned (#2453)
    
    * Fixed cpp multi-topic consumer when topics are not partitioned
    
    * Fixed formatting

 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc | 27 ++++++++++++++++++------
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 25 +++++++++++++++++-----
 2 files changed, 40 insertions(+), 12 deletions(-)

commit 774cafa25d6340c778c5c281045446086aff96a0
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Aug 28 07:30:42 2018 +0200

    Fix flake in DiscoveryServiceTest (#1081) (#2406)
    
    This test was flaking because it was only waiting for 1 second for
    connection and message exchange to complete, which is not enough time
    when there's heavy load on the machine (simulated with stress-ng).
    
    The fix is to increase the timeout to 10 seconds. I've also cleaned up
    the test to use a CompletableFuture rather than a CountDownLatch so
    tha the test thread can be notified of failures in the handlers.

 .../discovery/service/DiscoveryServiceTest.java    | 77 ++++++++++++----------
 1 file changed, 43 insertions(+), 34 deletions(-)

commit 8da066947b339d1f71025f8d3857bb7e5b9e70a2
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 27 22:26:10 2018 -0700

    Fixed {{pulsar.version}} into {{pulsar:version}} in few pages (#2455)
    
    ### Motivation
    
    In few places in website we're displaying the literal `{{pulsar.version}}` instead of the actual Pulsar version string. The correct variable name is expected to use `:` as separator.

 site2/docs/client-libraries-go.md                            |  2 +-
 site2/docs/deploy-bare-metal.md                              | 12 ++++++------
 site2/docs/getting-started-standalone.md                     | 12 ++++++------
 site2/docs/io-quickstart.md                                  | 12 ++++++------
 .../version-2.1.0-incubating/client-libraries-go.md          |  2 +-
 .../version-2.1.0-incubating/deploy-bare-metal.md            | 12 ++++++------
 .../version-2.1.0-incubating/getting-started-standalone.md   | 12 ++++++------
 .../versioned_docs/version-2.1.0-incubating/io-quickstart.md | 12 ++++++------
 8 files changed, 38 insertions(+), 38 deletions(-)

commit 757222d9d232dbe03293df890609aa85ff63556c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 27 22:21:27 2018 -0700

    [Schema] Provide a generic record interface for representing a typed message (#2452)
    
    * [Schema] Provide a generic record interface for representing a typed message
    
     ### Motivation
    
    In some use cases, the publishers and consumers don't know the type or schema of the messages ahead of time.
    For example, in pulsar io connector, when connecting a topic to a jdbc table, the connector doesn't know
    the tyep of the messages ahead of time; the connector can only fetch schema info from schema registry and
    that is the only information connector knows. It is impossible for mapping the messages to a relational database
    table.
    
    So we need a way to present a generic `Struct` record with fields.
    
     ### Changes
    
    Introduce `Field` and `GenericRecord` to represent `Struct` records deserialized with a schema.
    
     ### NotCovered
    
    This change only introduces the interfaces. It doesn't integrate with the producer and consumer workflow.
    That would be done in subsequent changes if we agree on the interfaces.

 .../org/apache/pulsar/client/api/schema/Field.java |  43 +++++++++
 .../pulsar/client/api/schema/GenericRecord.java    |  51 +++++++++++
 .../pulsar/client/impl/schema/AvroSchema.java      |  17 ++--
 .../client/impl/schema/GenericAvroRecord.java      |  79 ++++++++++++++++
 .../client/impl/schema/GenericAvroSchema.java      | 102 +++++++++++++++++++++
 .../pulsar/client/schema/AvroSchemaTest.java       |  47 +++++++++-
 6 files changed, 329 insertions(+), 10 deletions(-)

commit b234f330ec6600c7ffd2201d4360182a5bd4d0b7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Aug 27 17:42:35 2018 -0700

    Remove schema validator from annotations since it requires slightly more information (#2445)
    
    and is therefore done explitcly

 .../main/java/org/apache/pulsar/functions/utils/FunctionConfig.java    | 3 ---
 .../src/main/java/org/apache/pulsar/functions/utils/SinkConfig.java    | 3 +--
 .../src/main/java/org/apache/pulsar/functions/utils/SourceConfig.java  | 1 -
 3 files changed, 1 insertion(+), 6 deletions(-)

commit 8ba8688ad0c51644f018f8da7aa3cfef8a66c1dd
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 27 16:34:00 2018 -0700

    Add multi-topic and regex consumer in Go client (#2448)

 pulsar-client-cpp/include/pulsar/c/client.h |  10 +++
 pulsar-client-cpp/lib/c/c_Client.cc         |  21 +++++
 pulsar-client-go/pulsar/c_consumer.go       |  38 +++++++--
 pulsar-client-go/pulsar/c_go_pulsar.h       |  13 +++
 pulsar-client-go/pulsar/consumer.go         |  10 ++-
 pulsar-client-go/pulsar/consumer_test.go    | 124 +++++++++++++++++++++++++++-
 6 files changed, 207 insertions(+), 9 deletions(-)

commit 73bc19dc41b6a06bd7051216682cc5d2fc5d5592
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 27 11:41:24 2018 -0700

    Added Reader.HasNext in Go client (#2450)
    
    ### Motivation
    
    Added `Reader.HasNext()` in Go client library

 pulsar-client-go/pulsar/c_reader.go    | 13 +++++++++++++
 pulsar-client-go/pulsar/reader.go      |  3 +++
 pulsar-client-go/pulsar/reader_test.go | 12 ++++++++++--
 3 files changed, 26 insertions(+), 2 deletions(-)

commit 8688b6733177ee4a48d805df18a1d82865cf7320
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Aug 28 02:38:41 2018 +0800

    Issue #2330: change getTopicName in MultiTopicsConsumer (#2346)
    
    * change getTopicName in MultiTopicsConsumer
    
    * change following sijie's comments
    
    * keep both topicName and topicPartitonName in consumer to avoid new string

 .../apache/pulsar/client/impl/ConsumerImpl.java    |  8 +++++++
 .../client/impl/MultiTopicsConsumerImpl.java       |  9 ++++----
 .../pulsar/client/impl/TopicMessageIdImpl.java     | 27 ++++++++++++++++++----
 .../pulsar/client/impl/TopicMessageImpl.java       | 20 ++++++++++++----
 .../client/impl/UnAckedTopicMessageTracker.java    |  4 ++--
 .../pulsar/client/impl/MessageIdCompareToTest.java |  6 ++++-
 .../tests/integration/semantics/SemanticsTest.java |  2 +-
 7 files changed, 60 insertions(+), 16 deletions(-)

commit 9a9378944c8a6c3cd9124c888ad58f67e127ceb0
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Mon Aug 27 17:25:58 2018 +0800

    Issue #2312: add python multi-topics consumer support (#2451)
    
    ### Motivation
    
    app python client support for multi-topics consumer
    
    ### Modifications
    
    add 2 methods in python client
    add unit test

 pulsar-client-cpp/python/pulsar/__init__.py | 205 ++++++++++++++++++++++++++++
 pulsar-client-cpp/python/pulsar_test.py     | 104 ++++++++++++++
 pulsar-client-cpp/python/src/client.cc      |  35 +++++
 pulsar-client-cpp/python/src/config.cc      |   2 +
 4 files changed, 346 insertions(+)

commit a16b64a0615b145f695987464cf281f68175985b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Aug 25 22:33:08 2018 -0700

    Add EventTime interface to Record (#2446)
    
    * Saved copy of work
    
    * revert conf changes
    
    * Prepare for the pr
    
    * Addressed reviewer comments

 .../org/apache/pulsar/functions/api/Record.java    |  9 ++++++++
 .../apache/pulsar/functions/sink/PulsarSink.java   |  7 ++++++
 .../pulsar/functions/source/PulsarRecord.java      |  9 ++++++++
 .../org/apache/pulsar/io/twitter/TweetData.java    |  1 +
 .../apache/pulsar/io/twitter/TwitterFireHose.java  | 27 ++++++++++++++++++++--
 .../pulsar/io/twitter/TwitterFireHoseConfig.java   |  3 +++
 6 files changed, 54 insertions(+), 2 deletions(-)

commit f44d367f1bd0de30b4702c174c4697d591f072fc
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Aug 24 23:28:34 2018 -0700

    Added cli commands to get function cluster related information (#2426)
    
    * Added command line to get cluster/cluster leader/function assignment information.
    Also refactored such kind of meta requests to a seperate endpoint
    
    * Removed left-over debug statements
    
    * Added back /functionsmetrics
    
    * Added /functionsmetrics back to the broker worker
    
    * Removed leftover references of getcluster
    
    * Fix integration tests
    
    * Fixed instantiation of service in worker only mode
    
    * Removed log statement
    
    * Seperated stats calls to a seperate endpoint to mimic broker

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  44 -----
 .../org/apache/pulsar/broker/admin/v2/Worker.java  |  94 ++++++++++
 .../apache/pulsar/broker/admin/v2/WorkerStats.java |  52 +++---
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  |   8 -
 .../org/apache/pulsar/client/admin/Functions.java  |   7 -
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  10 +-
 .../client/admin/{WorkerStats.java => Worker.java} |  26 ++-
 .../{WorkerStatsImpl.java => WorkerImpl.java}      |  54 +++++-
 ...tionWorkerStats.java => CmdFunctionWorker.java} |  71 +++++++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  13 --
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   2 +-
 .../functions/worker/rest/FunctionApiResource.java |   1 -
 .../pulsar/functions/worker/rest/Resources.java    |   5 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |   4 +
 .../functions/worker/rest/api/FunctionsImpl.java   | 134 +-------------
 .../functions/worker/rest/api/WorkerImpl.java      | 199 +++++++++++++++++++++
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  25 ---
 .../worker/rest/api/v2/WorkerApiV2Resource.java    | 108 +++++++++++
 ...kerStats.java => WorkerStatsApiV2Resource.java} |  75 +++++---
 ...est.java => WorkerApiV2ResourceConfigTest.java} |   2 +-
 .../integration/containers/WorkerContainer.java    |   2 +-
 21 files changed, 640 insertions(+), 296 deletions(-)

commit d4b214cc0f5266b0fd38c016af1e611d98bad3ed
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Aug 24 22:40:58 2018 -0700

    fix issue with protocol version not being correct (#2444)

 .../src/main/java/org/apache/pulsar/client/impl/ClientCnx.java         | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 31ebf61d593d798da25024032f55af6969fc272b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 24 15:37:53 2018 -0700

    Added missing committers from "team" page (#2443)

 site2/website/data/team.js | 32 +++++++++++++++++++++++++++++++-
 1 file changed, 31 insertions(+), 1 deletion(-)

commit 30fee6bb2f83e344dd2e86b675671762a9242f26
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 24 12:55:12 2018 -0700

    Standalone bookie should always advertise 'localhost' when running in docker container (#2425)
    
    * Standalone bookie should always advertise 'localhost' when running in docker container
    
    * Fixed advertised address coming from config file

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 29104efedccf2efd5a9f4cec1b1cab9c8a621d48
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Aug 24 11:34:21 2018 -0700

    improve error message handling (#2435)
    
    ### Motivation
    
    Improve error message handling in presto pulsar connector

 .../org/apache/pulsar/sql/presto/PulsarConnectorUtils.java |  4 +++-
 .../java/org/apache/pulsar/sql/presto/PulsarMetadata.java  | 14 ++++++++++----
 .../org/apache/pulsar/sql/presto/PulsarSplitManager.java   | 10 ++++++----
 3 files changed, 19 insertions(+), 9 deletions(-)

commit e9fe7e317576ae6f7a12679f0afc31f2e2782ad6
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Aug 24 10:58:41 2018 -0700

     allow predicates concerning publish time to push down to pulsar (#2414)
    
    * allow predicates concerning publish time to push down to pulsar
    
    * cleaning up

 .../apache/bookkeeper/mledger/ManagedCursor.java   |  18 +-
 .../apache/bookkeeper/mledger/ReadOnlyCursor.java  |  49 +++--
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   7 +-
 .../mledger/impl/ReadOnlyCursorImpl.java           |   7 +-
 .../mledger/impl/ReadOnlyManagedLedgerImpl.java    |  20 ++
 .../mledger/impl/ManagedCursorContainerTest.java   |   5 +
 .../pulsar/sql/presto/PulsarInternalColumn.java    |   6 +-
 .../apache/pulsar/sql/presto/PulsarMetadata.java   |   8 +-
 .../pulsar/sql/presto/PulsarRecordCursor.java      |  12 +-
 .../org/apache/pulsar/sql/presto/PulsarSplit.java  |  13 +-
 .../pulsar/sql/presto/PulsarSplitManager.java      | 202 ++++++++++++++++++---
 .../pulsar/sql/presto/PulsarTableLayoutHandle.java |  39 +++-
 .../pulsar/sql/presto/TestPulsarConnector.java     | 126 +++++++++++--
 .../pulsar/sql/presto/TestPulsarRecordCursor.java  |   2 +-
 .../pulsar/sql/presto/TestPulsarSplitManager.java  | 147 ++++++++++++++-
 15 files changed, 579 insertions(+), 82 deletions(-)

commit 024d2e0ea3b8e7e3b26f5e658b449a0861f3112d
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Fri Aug 24 11:42:55 2018 +0800

    leak assign schema in MessageImpl constructor (#2439)

 .../src/main/java/org/apache/pulsar/client/impl/MessageImpl.java         | 1 +
 1 file changed, 1 insertion(+)

commit 672a167a31c719dab7623770d39666e8d7e7a0fd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 23 18:34:44 2018 -0700

    Race condition function-runtime-manager read old assignments (#2437)

 .../apache/pulsar/client/impl/ConsumerBase.java    |  4 ++++
 .../pulsar/functions/worker/MembershipManager.java | 26 ++++++++++++++++++----
 .../pulsar/functions/worker/WorkerService.java     |  2 +-
 .../functions/worker/MembershipManagerTest.java    | 24 ++++++++++++--------
 4 files changed, 42 insertions(+), 14 deletions(-)

commit 225eeb70ed6e2f88783997a891fec642d1b7baac
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Aug 23 16:28:21 2018 -0700

    Make all cli arguments follow consistent - notation instead of camelcase (#2432)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 11 ++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 87 ++++++++++++++++++----
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 77 +++++++++++++++----
 3 files changed, 145 insertions(+), 30 deletions(-)

commit d6a0ce092fd3f3d09ecfbe81d26b71d7b94b03e2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Aug 23 16:13:10 2018 -0700

    Made Twitter FireHose to emit records containing schema information (#2433)

 .../org/apache/pulsar/io/twitter/TweetData.java    | 121 +++++++++++++++++++++
 .../apache/pulsar/io/twitter/TwitterFireHose.java  |  21 ++--
 2 files changed, 134 insertions(+), 8 deletions(-)

commit 31edf5aa74f3c4005a228ef463df05ecb2cee287
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 23 11:20:15 2018 -0700

    Support heartbeat function for worker (#2424)

 .../pulsar/functions/worker/WorkerConfig.java      |  2 +-
 .../worker/scheduler/RoundRobinScheduler.java      | 17 ++++++-
 .../functions/worker/SchedulerManagerTest.java     | 57 ++++++++++++++++++++++
 3 files changed, 74 insertions(+), 2 deletions(-)

commit 4694e6ee0b2eee26fed2af493ccb21fa39bd8aec
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Aug 22 21:43:31 2018 -0700

    Fix InputTopic Submission for Creating Sink (#2427)
    
    * Fix Spelling mistake in error message
    
    * Fix InputTopic Submission for Creating Sink

 .../org/apache/pulsar/functions/utils/validation/ValidatorImpls.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 001445cdca43e85a6a8e34cf4c41c25de6ec0b83
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Aug 22 17:03:03 2018 -0700

    Fix bug during user publish (#2421)
    
    * Fix bug during user publish
    
    * Added unittest to cover the case of publish using default schema

 .../apache/pulsar/functions/instance/ContextImpl.java |  5 ++++-
 .../apache/pulsar/functions/source/TopicSchema.java   |  2 +-
 .../pulsar/functions/instance/ContextImplTest.java    | 19 ++++++++++++++++---
 3 files changed, 21 insertions(+), 5 deletions(-)

commit cc60027c8dd74469d6e0438ef8df8ea06ada6f2d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Aug 22 10:53:30 2018 -0700

    Fix: authorization while redirecting function admin call (#2416)

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  4 +-
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |  2 +-
 .../functions/worker/FunctionRuntimeManager.java   | 45 ++++++++--------------
 .../pulsar/functions/worker/WorkerConfig.java      |  7 +++-
 .../pulsar/functions/worker/WorkerService.java     | 24 +++++++++---
 .../functions/worker/rest/FunctionApiResource.java |  3 ++
 .../functions/worker/rest/api/FunctionsImpl.java   | 17 ++++----
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  5 ++-
 .../worker/FunctionRuntimeManagerTest.java         | 18 +++++++--
 .../functions/worker/MembershipManagerTest.java    | 19 +++++++--
 10 files changed, 90 insertions(+), 54 deletions(-)

commit ef37890331197ee4f40da9fa787ed5241a55cb6a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 22 10:33:49 2018 -0700

    Allow to configure number of IO and managed ledger threads (#2412)

 conf/broker.conf                                   |  9 +++
 conf/standalone.conf                               |  9 +++
 .../mledger/ManagedLedgerFactoryConfig.java        | 34 +++--------
 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 66 ++++++++++------------
 .../apache/pulsar/broker/ServiceConfiguration.java | 33 +++++++++++
 .../pulsar/broker/ManagedLedgerClientFactory.java  |  2 +
 .../pulsar/broker/service/BrokerService.java       |  2 +-
 .../org/apache/pulsar/common/util/FieldParser.java |  7 ++-
 8 files changed, 100 insertions(+), 62 deletions(-)

commit 834104bba3eab1977114b58f455d735bda2b9fe3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 22 09:32:46 2018 -0700

    [client] add properties to producer for cpp & python client (#2420)
    
    * [client] add properties to producer for cpp & python client
    
     ### Motivation
    
    This is a caught-up change to enable properties for producer as java clients.
    
     ### Changes
    
    Enable properties on producer for both cpp & python client
    
     ### Results
    
    Properties are added as metadata for CommandProducer. However there is no way
    to verify the producer properties. so I didn't add any specific tests, just
    adding properties for both cpp and python clients in the tests, that should
    excerise the corresponding code path.
    
    * Add `properties` to pydoc

 .../include/pulsar/ProducerConfiguration.h         | 34 ++++++++++++++++++++++
 pulsar-client-cpp/lib/Commands.cc                  | 11 ++++++-
 pulsar-client-cpp/lib/Commands.h                   |  3 +-
 pulsar-client-cpp/lib/ProducerConfiguration.cc     | 34 +++++++++++++++++++++-
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |  1 +
 pulsar-client-cpp/lib/ProducerImpl.cc              |  3 +-
 pulsar-client-cpp/python/pulsar/__init__.py        | 11 ++++++-
 pulsar-client-cpp/python/src/config.cc             |  1 +
 pulsar-client-cpp/python/test_producer.py          |  6 +++-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  2 ++
 10 files changed, 100 insertions(+), 6 deletions(-)

commit def32dda9b0f1e3e98eaf24bc09fe70b41c0ce35
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 22 02:41:48 2018 -0700

    [documentation] cherry-pick deploy-kubernetes documentation changes (#2419)
    
    Cherry-pick changes from #2363 to 2.1.0 documentation

 .../version-2.1.0-incubating/deploy-kubernetes.md  | 108 +++++++++++++++++----
 1 file changed, 91 insertions(+), 17 deletions(-)

commit eb897a8060b9ea0eb67adbcb5248dc850590a2c7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 22 02:41:00 2018 -0700

    [client] add properties to consumer for cpp & python client (#2423)
    
    * [client] add properties to consumer for cpp & python client
    
     ### Motivation
    
    This is a caught-up change to enable properties for consumer as java clients.
    
     ### Changes
    
    Enable properties on consumer for both cpp & python client
    
     ### Results
    
    Properties are added as metadata for CommandSubscribe. However there is no way
    to verify the consumer properties. so I didn't add any specific tests, just
    adding properties for both cpp and python clients in the tests, that should
    excerise the corresponding code path.
    
    * remove "make format"

 .../include/pulsar/ConsumerConfiguration.h         | 34 ++++++++++++++++++++++
 pulsar-client-cpp/lib/Commands.cc                  | 12 +++++++-
 pulsar-client-cpp/lib/Commands.h                   |  2 +-
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     | 32 ++++++++++++++++++++
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |  4 ++-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  2 +-
 pulsar-client-cpp/python/pulsar/__init__.py        | 11 ++++++-
 pulsar-client-cpp/python/src/config.cc             |  1 +
 pulsar-client-cpp/python/test_consumer.py          |  6 +++-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  6 +++-
 10 files changed, 103 insertions(+), 7 deletions(-)

commit 6ddc2add9402cdb2ec5b57646ca08812ca00bd51
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Aug 21 20:18:28 2018 -0700

    Improve the documentation about publish function (#2422)

 .../src/main/java/org/apache/pulsar/functions/api/Context.java        | 4 ++--
 .../main/java/org/apache/pulsar/functions/instance/ContextImpl.java   | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 3bd1ad9b999c3a9b307f856f9022049ca2166bad
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Wed Aug 22 07:44:14 2018 +0900

    remove 'to delete' (#2418)
    
    ### Motivation
    
    https://pulsar.incubator.apache.org/docs/en/pulsar-admin/#get-1
    https://pulsar.incubator.apache.org/docs/en/pulsar-admin/#getstatus
    https://pulsar.incubator.apache.org/docs/en/pulsar-admin/#list-2
    
    All `to delete` in description of options of the above URLs are unnecessary.
    
    ### Modifications
    
    Remove `to delete`.

 site2/docs/reference-pulsar-admin.md                     | 16 ++++++++--------
 .../version-2.1.0-incubating/reference-pulsar-admin.md   | 16 ++++++++--------
 2 files changed, 16 insertions(+), 16 deletions(-)

commit 7bff81e385b11469b8d0e76d311af5c314fa16e5
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Aug 21 11:00:12 2018 -0700

    Integrate Functions with Schema (#2397)
    
    * Integrate functions and io with schema registry
    
    * Added missing license headers
    
    * Renamed topicSchema to inputSpecs
    
    * Fixed comments
    
    * Fixed cli arg docs
    
    * Fixed schema arguments
    
    * Fixed errors after merge
    
    * Fixed instance parameters
    
    * Fixed tests and addressed comments
    
    * Fixed PulsarSourceTest after merge
    
    * Took feedback and made changes backwards compatible
    
    * Fixed compilation issues
    
    * Fixed bug
    
    * fixed test compilation
    
    * Fixed bug
    
    * Fixed bug
    
    * Fix pythn instance
    
    * Fixed the way cmdsink populates sinkconfig
    
    * Addressed feedback

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  10 +-
 .../org/apache/pulsar/client/admin/Functions.java  |   4 +-
 .../pulsar/client/impl/schema/StringSchema.java    |   3 +
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   2 -
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 104 +++--
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 116 +++--
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  42 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  90 ++--
 .../apache/pulsar/admin/cli/TestCmdSources.java    |  31 +-
 .../client/impl/MultiTopicsConsumerImpl.java       |   5 +-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  17 +-
 .../apache/pulsar/common/schema/SchemaInfo.java    |  12 +
 .../org/apache/pulsar/functions/api/Context.java   |  20 +-
 .../pulsar/functions/api/utils/DefaultSerDe.java   | 106 -----
 .../functions/api/utils/DefaultSerDeTest.java      | 111 -----
 .../pulsar/functions/instance/ContextImpl.java     | 107 +++--
 .../pulsar/functions/instance/InstanceUtils.java   |  53 ++-
 .../functions/instance/JavaInstanceRunnable.java   |  47 ++-
 .../producers/AbstractOneOuputTopicProducers.java  |  23 +-
 .../MultiConsumersOneOuputTopicProducers.java      |  23 +-
 .../functions/instance/producers/Producers.java    |   4 +-
 .../apache/pulsar/functions/sink/PulsarSink.java   | 155 ++++---
 .../pulsar/functions/sink/PulsarSinkConfig.java    |   3 +-
 .../pulsar/functions/source/PulsarRecord.java      |   9 +-
 .../pulsar/functions/source/PulsarSource.java      | 197 ++++-----
 .../functions/source/PulsarSourceConfig.java       |  25 +-
 .../pulsar/functions/source/SerDeSchema.java       |  52 +++
 .../pulsar/functions/source/TopicSchema.java       | 195 +++++++++
 .../windowing/WindowFunctionExecutor.java          |   4 +-
 .../instance/src/main/python/Function_pb2.py       | 167 ++++++--
 .../instance/src/main/python/python_instance.py    |  14 +
 .../pulsar/functions/instance/ContextImplTest.java |  13 +-
 .../MultiConsumersOneOutputTopicProducersTest.java |  16 +-
 .../pulsar/functions/sink/PulsarSinkTest.java      |  60 +--
 .../pulsar/functions/source/PulsarSourceTest.java  |  86 ++--
 .../windowing/WindowFunctionExecutorTest.java      |  11 +-
 .../functions/api/examples/PublishFunction.java    |   1 -
 .../api/examples/UserPublishFunction.java          |   7 +-
 .../proto/src/main/proto/Function.proto            |  22 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  16 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |   2 +-
 .../functions/runtime/ProcessRuntimeTest.java      |  34 +-
 .../pulsar/functions/utils/ConsumerConfig.java     |  34 ++
 .../pulsar/functions/utils/FunctionConfig.java     |  28 +-
 .../apache/pulsar/functions/utils/SinkConfig.java  |  21 +-
 .../pulsar/functions/utils/SourceConfig.java       |   6 +
 .../functions/utils/validation/ValidatorImpls.java | 470 ++++++++++++---------
 .../pulsar/functions/worker/WorkerService.java     |  10 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   6 +-
 49 files changed, 1545 insertions(+), 1049 deletions(-)

commit 59801695a9808c4c6574b421f90b0d91a9d712ad
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 20 23:21:53 2018 -0700

     [tiered storage] store driver name and driver specific metadata in original ledger metadata (#2398)
    
    
    
     ### Motivation
    
    1) Currently the location of an offloaded ledger isn't stored in the original ledger metadata.
    That means if configuration is changed or modified by mistake. We might potentially cause data loss.
    
    2) The location of an offloaded ledger is needed by Pulsar SQL. so it is very inconvinient to
    have the location information stored in a configuration and the approach is also problematic.
    
     ### Changes
    
    Store `driverName` and driver-specific metadata (e.g. bucket name, region name, endpoint) in the
    original ledger metadata. Change ManagedLedgerImpl to use the driver-specific metadata to read
    the offloaded ledger. If the driver-specific metadata is missed, it will fall back to use the configuration.
    
     ### Tests
    
    This change doesn't change the behavior. Existing unit tests and integration tests already covered the logic.
    
     ### NOTES
    
    Currently the driver name in metadata is not used. We need to use driver name to load different offloader driver
    after #2393 is implemented

 .../apache/bookkeeper/mledger/LedgerOffloader.java |  33 ++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  69 ++++++-
 .../mledger/impl/NullLedgerOffloader.java          |  11 +-
 .../bookkeeper/mledger/offload/OffloadUtils.java   |  91 +++++++++
 managed-ledger/src/main/proto/MLDataFormats.proto  |  11 +
 .../mledger/impl/OffloadPrefixReadTest.java        |  27 ++-
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java |  16 +-
 .../pulsar/broker/admin/AdminApiOffloadTest.java   |   3 +
 tiered-storage/jcloud/pom.xml                      |   2 +
 .../impl/BlobStoreManagedLedgerOffloader.java      | 221 ++++++++++++++++-----
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  |  19 +-
 11 files changed, 419 insertions(+), 84 deletions(-)

commit d804701966d719b132f0bd4a48496dc12aef459e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 20 23:20:40 2018 -0700

     Add admin api to support stop function (#2415)
    
    ### Motivation
    
    We have a usecase where we want to stop the function temporary to avoid draining on that function topics. So, adding an admin api/cli to stop function.
    
    ### Modifications
    
    - add REST/CLI api to stop function.
    
    ### Result
    
    we can stop and then restart function with admin/cli api.

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 25 ++++++++++++++++
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 17 ++++++++++-
 .../org/apache/pulsar/client/admin/Functions.java  | 34 +++++++++++++++++++++
 .../client/admin/internal/FunctionsImpl.java       | 21 +++++++++++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 29 ++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 31 ++++++++++++++++++-
 .../functions/worker/FunctionRuntimeManager.java   | 35 +++++++++++++---------
 .../functions/worker/rest/api/FunctionsImpl.java   | 28 +++++++++++++----
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 31 +++++++++++++++----
 9 files changed, 225 insertions(+), 26 deletions(-)

commit 05f8560184258e921395ecb356b0fd13fe2320ce
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 20 23:20:03 2018 -0700

    [tiered storage] bump jclouds version to 2.1.1 (#2410)
    
    ### Motivation
    
    This is a part of tracking work in #2164. currently we use a snapshot version of jclouds for some jclouds bug fix. This change will remove the snapshot version and use latest release 2.1.1.
    
    ### Modifications
    
    update pom.xml to use 2.1.1
    
    ### Result
    
    tired storage ut should pass

 jclouds-shaded/pom.xml | 11 -----------
 pom.xml                |  7 +++++++
 2 files changed, 7 insertions(+), 11 deletions(-)

commit c5c2a50235b30f101f14b1a82d7d1d2f5278ae16
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 20 18:11:49 2018 -0700

    [functions][integration tests] Ensure function subscription exists before integration tests start producing messages (#2413)
    
    ### Motivation
    
    There is a race condition in functions integration tests, where the producer used for validation can start before
    function runs. So a function might be missing some messages produced by the producer. Hence it will fail the validation.
    
     ### Changes
    
    Ensure function subscription exists before producer starts producing messages to input topic.

 .../tests/integration/functions/PulsarFunctionsTest.java    | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 0bf3494dc2e941e53a495c92310f3847aa11fd09
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 20 13:47:48 2018 -0700

    add slf4j handler to log web-server log (#2408)

 .../apache/pulsar/functions/worker/rest/WorkerServer.java | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

commit 6f692af11d9215256df37619cd7f6f17c6138baa
Author: ssunorz <42366422+ssunorz@users.noreply.github.com>
Date:   Tue Aug 21 02:40:39 2018 +0900

    Make authentication parameters configurable on the pulsar-client-kafka (#2373)
    
    ### Motivation
    
    Make authentication parameters configurable on the pulsar-client-kafka.
    
    ### Modifications
    
    Add authentication parameters to the PulsarClientKafkaConfig.
    
    ### Result
    
    Users can set authentication parameters on the pulsar-client-kafka.

 .../client/kafka/compat/PulsarClientKafkaConfig.java  | 19 +++++++++++++++----
 site2/docs/adaptors-kafka.md                          |  4 +++-
 2 files changed, 18 insertions(+), 5 deletions(-)

commit 271c6ee56a007506020ecf317c88df95e4511714
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 20 10:39:54 2018 -0700

    Fixed initialization order of acknowledgmentsGroupingTracker in ConsumerImpl (#2399)
    
    ### Motivation
    
    With delayed acks enabled (the default), there is a potential race condition that lead to a NPE:
    
    ```
    java.lang.NullPointerException
        at org.apache.pulsar.client.impl.ConsumerImpl.getClientCnx(ConsumerImpl.java:1446)
        at org.apache.pulsar.client.impl.PersistentAcknowledgmentsGroupingTracker.flush(PersistentAcknowledgmentsGroupingTracker.java:154)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
        ...
    ```
    
    The reason is that the delayed ack commit task gets scheduled (eg: in 100ms) and might be executed before the the main thread has finished initializing the `ConsumerImpl` instance.
    
    ### Modifications
    
    Reordered the initialization in `ConsumerImpl` constructor to make sure `connectionHandler` is already set when we create the `PersistentAcknowledgmentsGroupingTracker` instance.

 .../org/apache/pulsar/client/impl/ConsumerImpl.java    | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

commit 90d86c0fe31fd614c9aa9037f900305661ece879
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 17 13:32:10 2018 -0700

    [build] Configure os extension plugin at root pom (#2396)
    
    ### Motivation
    
    os extension plugin is required by managed-ledger as well.
    
     ### Change
    
    move the extension to the root pom file.

 pom.xml                               | 5 +++++
 pulsar-client-schema/pom.xml          | 7 -------
 pulsar-functions/proto-shaded/pom.xml | 7 -------
 pulsar-functions/proto/pom.xml        | 7 -------
 4 files changed, 5 insertions(+), 21 deletions(-)

commit 30e40989ebc21b6fe29cf1c503f34f33de068ac5
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Fri Aug 17 23:49:17 2018 +0800

    Fix some spelling typos (#2385)
    
    * fix some typos
    
    * change Faild to Failed

 .../loadbalance/impl/ModularLoadManagerImpl.java   |  2 +-
 .../org/apache/pulsar/broker/service/Consumer.java |  2 +-
 .../broker/namespace/NamespaceServiceTest.java     | 12 ++++++------
 .../SubscriptionMessageDispatchThrottlingTest.java |  2 +-
 pulsar-client-cpp/perf/PerfProducer.cc             |  2 +-
 pulsar-client-cpp/perf/RateLimiter.h               | 10 +++++-----
 pulsar-client-go/pulsar/client.go                  |  2 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 22 +++++++++++-----------
 .../apache/pulsar/client/api/ClientBuilder.java    |  2 +-
 .../pulsar/client/api/ClientConfiguration.java     |  2 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  4 ++--
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  2 +-
 .../org/apache/pulsar/common/util/RateLimiter.java | 22 +++++++++++-----------
 site2/website/static/js/pjax-api.min.js            |  2 +-
 15 files changed, 45 insertions(+), 45 deletions(-)

commit 2d197b0e7e40106535d91ed6de82dd30241ff256
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 17 08:48:53 2018 -0700

    Issue 2283: Improve error message if authorization is not enabled (#2382)
    
    ### Motivation
    
     Fixes #2283.
    
     If authorizationEnabled is not enabled, authorization service is not set. All the accesses to this authorization service will throw NPE and clients will receive Internal Server Error. The message is meaningless. It is better to return a more meaningful message.
    
     ### Changes
    
     Return `Not implemented` if authorization is not enabled.

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  9 ++++++--
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  3 ++-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  3 ++-
 .../pulsar/client/admin/PulsarAdminException.java  | 18 ++++++++++++----
 .../pulsar/client/admin/internal/BaseResource.java |  5 ++---
 .../pulsar/tests/integration/cli/CLITest.java      | 24 ++++++++++++++++++++++
 6 files changed, 51 insertions(+), 11 deletions(-)

commit 086cbbba0e8854ecbafc55bff9e93cb9a84ce797
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 17 08:47:30 2018 -0700

    Fixed race condition during expansion of concurrent open hash maps (#2387)
    
    ### Motivation
    
    Porting same fix as https://github.com/apache/bookkeeper/pull/1607 to correct issue reported on https://github.com/apache/bookkeeper/issues/1606.
    
    There is a race condition in the concurrent open hash maps implementation. The race happens when the maps gets re-hashed after the expansion and the new arrays are substituting the old ones.
    
    The race itself is that a thread doing a `get()` on the map is first checking the current capacity of the map, uses that to get the bucket and then tries to do optimistic read of the value in that bucket.
    
    This assumes `capacity` update is visible only after the `values` array is already swapped, but that is not always the case in current code.
    
    ### Changes
    
     * Use `volatile` qualifier for `capacity` and `values` arrays to ensure ordering of memory read is respected by compiler
     * In rehashing, update `capacity` after `values` where it was not already the case

 .../util/collections/ConcurrentLongHashMap.java    |  8 +--
 .../util/collections/ConcurrentLongPairSet.java    | 15 +++---
 .../util/collections/ConcurrentOpenHashMap.java    |  6 +--
 .../util/collections/ConcurrentOpenHashSet.java    |  6 +--
 .../collections/ConcurrentLongHashMapTest.java     | 57 ++++++++++++++++++++--
 5 files changed, 72 insertions(+), 20 deletions(-)

commit 544d90a637060cd9a20e8c785b52d1431644fee9
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Aug 17 08:46:32 2018 -0700

    Add HostName appender function example (#2389)

 .../api/examples/HostAppenderFunction.java         | 41 ++++++++++++++++++++++
 1 file changed, 41 insertions(+)

commit 4f43a3f5fe6046cbc034b65c1f625348d310cd11
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 17 08:45:31 2018 -0700

    [documentation] Issue 2386: release notes link of old versions broken (#2388)
    
    ### Motivation
    
    Fixes #2386.
    
    Release notes links of old versions are broken due to an additional "/".
    
     ### Changes
    
    Remove the extra "/"

 site2/website/pages/en/versions.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit a79fc748bd5323b213e2a29600e6df40965b5402
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 17 08:42:15 2018 -0700

    [build] Fix LICENSE.bin.txt (#2395)
    
    ### Motivation
    
    We are adding license-check in CI build. So we need to make sure current build can pass license-check
    
     ### Changes
    
    Update LICENSE.bin.txt
    
     ### Results
    
    The binary package can pass license check

 distribution/server/src/assemble/LICENSE.bin.txt | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

commit 83d33d4a7ff9523be7892324bdc322ed6480ad38
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 17 08:38:17 2018 -0700

    [tiered storage] Provide LedgerOffloaderFactory for creating offloaders (#2392)
    
    * [tiered storage] Provide LedgerOffloaderFactory for creating offloaders
    
     ### Motivation
    
    In order to use NAR for packaging offloaders, we need a factory interface for creating offloaders.
    
     ### Changes
    
    - Provide a ledger offloader factory interface for creating offloaders.
    - Move implemention specific settings to implementation package to be respecting to offloader factory interface
    
    * remove unneeded change

 .../apache/bookkeeper/mledger/LedgerOffloader.java |   2 +-
 .../bookkeeper/mledger/LedgerOffloaderFactory.java |  57 ++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java | 120 +--------------------
 .../org/apache/pulsar/broker/PulsarService.java    |  33 ++----
 .../jcloud/JCloudLedgerOffloaderFactory.java       |  51 +++++++++
 .../jcloud/TieredStorageConfigurationData.java     |  30 +++++-
 6 files changed, 150 insertions(+), 143 deletions(-)

commit e1238acd8150115ce48e1e53eb600106ebe799d2
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 16 22:04:21 2018 -0700

     [tiered storage] repackage the offloader implementation from `org.apache.pulsar.broker.offload` to `org.apache.bookkeeper.mledger.offload.jcloud` (#2391)
    
    ### Motivation
    
    Since #2371 moves offloader implementation to its own module, and it is bascially implementing mledger interfaces.
    So it makes more sense to put the offloader implementation under package `org.apache.bookkeeper.mledger.offload` rather than `org.apache.pulsar.broker.offload`.
    
     ### Changes
    
    Rename the package

 .../org/apache/pulsar/broker/PulsarService.java    |  4 +-
 .../mledger/offload/jcloud}/BackedInputStream.java |  2 +-
 .../jcloud}/BlockAwareSegmentInputStream.java      |  2 +-
 .../mledger/offload/jcloud}/DataBlockHeader.java   |  2 +-
 .../mledger/offload/jcloud}/OffloadIndexBlock.java |  2 +-
 .../offload/jcloud}/OffloadIndexBlockBuilder.java  |  4 +-
 .../mledger/offload/jcloud}/OffloadIndexEntry.java |  2 +-
 .../jcloud}/TieredStorageConfigurationData.java    |  2 +-
 .../impl/BlobStoreBackedInputStreamImpl.java       |  6 +--
 .../impl/BlobStoreBackedReadHandleImpl.java        | 12 +++---
 .../impl/BlobStoreManagedLedgerOffloader.java      | 10 ++---
 .../impl/BlockAwareSegmentInputStreamImpl.java     |  4 +-
 .../offload/jcloud}/impl/DataBlockHeaderImpl.java  |  4 +-
 .../jcloud}/impl/OffloadIndexBlockBuilderImpl.java |  6 +--
 .../jcloud}/impl/OffloadIndexBlockImpl.java        |  6 +--
 .../jcloud}/impl/OffloadIndexEntryImpl.java        |  4 +-
 .../jcloud}/BlobStoreBackedInputStreamTest.java    |  4 +-
 .../mledger/offload/jcloud}/BlobStoreTestBase.java |  2 +-
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  | 44 +++++++++++-----------
 .../impl/BlockAwareSegmentInputStreamTest.java     |  4 +-
 .../offload/jcloud}/impl/DataBlockHeaderTest.java  |  4 +-
 .../offload/jcloud}/impl/OffloadIndexTest.java     |  8 ++--
 22 files changed, 68 insertions(+), 70 deletions(-)

commit 1f67d9fcbabbf6bf213173202df52df17b630a10
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 16 19:17:19 2018 -0700

    Remove connection state assertion in NonPersistentTopicTest#testMsgDropStat(#2390)
    
    
    
     ### Motivation
    
    (This is a worker around to fix master build. The real fix will be done in #2394)
    
    NonPersistentTopicTest keeps failing with following errors: (https://builds.apache.org/job/pulsar_precommit_java8/ws/pulsar-broker/target/surefire-reports/org.apache.pulsar.client.api.NonPersistentTopicTest.txt/*view*/)
    ```
    -------------------------------------------------------------------------------
    Test set: org.apache.pulsar.client.api.NonPersistentTopicTest
    -------------------------------------------------------------------------------
    Tests run: 19, Failures: 1, Errors: 0, Skipped: 1, Time elapsed: 91.727 s <<< FAILURE! - in org.apache.pulsar.client.api.NonPersistentTopicTest
    testMsgDropStat(org.apache.pulsar.client.api.NonPersistentTopicTest)  Time elapsed: 0.918 s  <<< FAILURE!
    java.lang.AssertionError: expected [2018-08-16T19:29:27.772Z] but found [2018-08-16T19:29:27.625Z]
            at org.testng.Assert.fail(Assert.java:96)
            at org.testng.Assert.failNotEquals(Assert.java:776)
            at org.testng.Assert.assertEqualsImpl(Assert.java:137)
            at org.testng.Assert.assertEquals(Assert.java:118)
            at org.testng.Assert.assertEquals(Assert.java:453)
            at org.testng.Assert.assertEquals(Assert.java:463)
            at org.apache.pulsar.client.api.NonPersistentTopicTest.testMsgDropStat(NonPersistentTopicTest.java:818)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
            at java.lang.reflect.Method.invoke(Method.java:498)
            at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:124)
            at org.testng.internal.InvokeMethodRunnable.runOne(InvokeMethodRunnable.java:54)
            at org.testng.internal.InvokeMethodRunnable.run(InvokeMethodRunnable.java:44)
            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
            at java.util.concurrent.FutureTask.run(FutureTask.java:266)
            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
            at java.lang.Thread.run(Thread.java:748)
    
    ```
    
    The problem came from producer reconnects on CI environment:
    
    https://builds.apache.org/job/pulsar_precommit_java8/ws/pulsar-broker/target/surefire-reports/org.apache.pulsar.client.api.NonPersistentTopicTest-output.txt/*view*/
    ```
    19:29:25.980 [pulsar-client-io-198-1:org.apache.pulsar.client.impl.ClientCnx@177] INFO  org.apache.pulsar.client.impl.ClientCnx - [id: 0x0e9cb22c, L:/127.0.0.1:54187 ! R:localhost/127.0.0.1:28701] Disconnected
    19:29:25.981 [pulsar-client-io-198-1:org.apache.pulsar.client.impl.ConnectionHandler@110] INFO  org.apache.pulsar.client.impl.ConnectionHandler - [non-persistent://my-property/my-ns/stats-topic] [test-1-0] Closed connection [id: 0x0e9cb22c, L:/127.0.0.1:54187 ! R:localhost/127.0.0.1:28701] -- Will try again in 0.1 s
    19:29:25.982 [pulsar-client-io-198-1:org.apache.pulsar.client.impl.ConnectionHandler@110] INFO  org.apache.pulsar.client.impl.ConnectionHandler - [non-persistent://my-property/my-ns/stats-topic] [subscriber-1] Closed connection [id: 0x0e9cb22c, L:/127.0.0.1:54187 ! R:localhost/127.0.0.1:28701] -- Will try again in 0.1 s
    19:29:25.982 [pulsar-client-io-198-1:org.apache.pulsar.client.impl.ConnectionHandler@110] INFO  org.apache.pulsar.client.impl.ConnectionHandler - [non-persistent://my-property/my-ns/stats-topic] [subscriber-2] Closed connection [id: 0x0e9cb22c, L:/127.0.0.1:54187 ! R:localhost/127.0.0.1:28701] -- Will try again in 0.1 s
    19:29:26.083 [pulsar-timer-201-1:org.apache.pulsar.client.impl.ConnectionHandler@113] INFO  org.apache.pulsar.client.impl.ConnectionHandler - [non-persistent://my-property/my-ns/stats-topic] [test-1-0] Reconnecting after timeout
    19:29:26.083 [pulsar-timer-201-1:org.apache.pulsar.client.impl.ConnectionHandler@113] INFO  org.apache.pulsar.client.impl.ConnectionHandler - [non-persistent://my-property/my-ns/stats-topic] [subscriber-1] Reconnecting after timeout
    19:29:26.086 [pulsar-timer-201-1:org.apache.pulsar.client.impl.ConnectionHandler@113] INFO  org.apache.pulsar.client.impl.ConnectionHandler - [non-persistent://my-property/my-ns/stats-topic] [subscriber-2] Reconnecting after timeout
    19:29:26.097 [pulsar-client-io-198-1:org.apache.pulsar.client.impl.ConnectionPool@161] INFO  org.apache.pulsar.client.impl.ConnectionPool - [[id: 0x63f7f193, L:/127.0.0.1:54190 - R:localhost/127.0.0.1:28701]] Connected to server
    ```
    
    The assertion is *non-deterministic* and doesn't seem to be really needed. so this change is to remove that assertion.

 .../test/java/org/apache/pulsar/client/api/NonPersistentTopicTest.java  | 2 --
 1 file changed, 2 deletions(-)

commit f6cf48df77a967f9af4075dcf7f17abb7646cdba
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 16 12:54:35 2018 -0700

    [tiered storage] Pulsar standalone hangs when s3 offloader is enabled (#2374)
    
    * [tiered storage] Pulsar standalone hangs when s3 offloader is enabled
    
     ### Motivation
    
     #2371 introduced a regression on starting pulsar standalone with s3 offloader enabled.
    
     ```
    org.apache.pulsar.broker.PulsarServerException: java.util.ServiceConfigurationError: org.jclouds.providers.ProviderMetadata: Provider org.jclouds.aws.s3.AWSS3ProviderMetadata could not be instantiated
            at org.apache.pulsar.broker.PulsarService.createManagedLedgerOffloader(PulsarService.java:684) ~[pulsar-broker.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.broker.PulsarService.start(PulsarService.java:346) [pulsar-broker.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.PulsarStandalone.start(PulsarStandalone.java:289) [pulsar-broker.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.PulsarStandaloneStarter.main(PulsarStandaloneStarter.java:102) [pulsar-broker.jar:2.2.0-incubating-SNAPSHOT]
    Caused by: java.util.ServiceConfigurationError: org.jclouds.providers.ProviderMetadata: Provider org.jclouds.aws.s3.AWSS3ProviderMetadata could not be instantiated
            at java.util.ServiceLoader.fail(ServiceLoader.java:232) ~[?:1.8.0_144]
            at java.util.ServiceLoader.access$100(ServiceLoader.java:185) ~[?:1.8.0_144]
            at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:384) ~[?:1.8.0_144]
            at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:404) ~[?:1.8.0_144]
            at java.util.ServiceLoader$1.next(ServiceLoader.java:480) ~[?:1.8.0_144]
            at com.google.common.collect.ImmutableCollection$Builder.addAll(ImmutableCollection.java:416) ~[guava-21.0.jar:?]
            at com.google.common.collect.ImmutableCollection$ArrayBasedBuilder.addAll(ImmutableCollection.java:500) ~[guava-21.0.jar:?]
            at com.google.common.collect.ImmutableSet$Builder.addAll(ImmutableSet.java:518) ~[guava-21.0.jar:?]
            at org.jclouds.providers.Providers.all(Providers.java:83) ~[jclouds-core-2.2.0-SNAPSHOT.jar:2.2.0-SNAPSHOT]
            at org.jclouds.providers.Providers.withId(Providers.java:99) ~[jclouds-core-2.2.0-SNAPSHOT.jar:2.2.0-SNAPSHOT]
            at org.jclouds.ContextBuilder.newBuilder(ContextBuilder.java:167) ~[jclouds-core-2.2.0-SNAPSHOT.jar:2.2.0-SNAPSHOT]
            at org.apache.pulsar.broker.offload.impl.BlobStoreManagedLedgerOffloader.<init>(BlobStoreManagedLedgerOffloader.java:233) ~[tiered-storage-jcloud.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.broker.offload.impl.BlobStoreManagedLedgerOffloader.create(BlobStoreManagedLedgerOffloader.java:163) ~[tiered-storage-jcloud.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.broker.PulsarService.createManagedLedgerOffloader(PulsarService.java:670) ~[pulsar-broker.jar:2.2.0-incubating-SNAPSHOT]
            ... 3 more
    Caused by: java.lang.NoSuchMethodError: org.jclouds.reflect.Reflection2.typeToken(Ljava/lang/Class;)Lorg/apache/pulsar/shaded/com/google/common/reflect/TypeToken;
            at org.jclouds.aws.s3.AWSS3ApiMetadata$Builder.<init>(AWSS3ApiMetadata.java:63) ~[jclouds-shaded.jar:2.2.0-incubating-SNAPSHOT]
            at org.jclouds.aws.s3.AWSS3ApiMetadata.<init>(AWSS3ApiMetadata.java:43) ~[jclouds-shaded.jar:2.2.0-incubating-SNAPSHOT]
            at org.jclouds.aws.s3.AWSS3ProviderMetadata$Builder.<init>(AWSS3ProviderMetadata.java:106) ~[jclouds-shaded.jar:2.2.0-incubating-SNAPSHOT]
            at org.jclouds.aws.s3.AWSS3ProviderMetadata.builder(AWSS3ProviderMetadata.java:56) ~[jclouds-shaded.jar:2.2.0-incubating-SNAPSHOT]
            at org.jclouds.aws.s3.AWSS3ProviderMetadata.<init>(AWSS3ProviderMetadata.java:65) ~[jclouds-shaded.jar:2.2.0-incubating-SNAPSHOT]
            at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_144]
            at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ~[?:1.8.0_144]
            at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:1.8.0_144]
            at java.lang.reflect.Constructor.newInstance(Constructor.java:423) ~[?:1.8.0_144]
            at java.lang.Class.newInstance(Class.java:442) ~[?:1.8.0_144]
            at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:380) ~[?:1.8.0_144]
            at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:404) ~[?:1.8.0_144]
            at java.util.ServiceLoader$1.next(ServiceLoader.java:480) ~[?:1.8.0_144]
            at com.google.common.collect.ImmutableCollection$Builder.addAll(ImmutableCollection.java:416) ~[guava-21.0.jar:?]
            at com.google.common.collect.ImmutableCollection$ArrayBasedBuilder.addAll(ImmutableCollection.java:500) ~[guava-21.0.jar:?]
            at com.google.common.collect.ImmutableSet$Builder.addAll(ImmutableSet.java:518) ~[guava-21.0.jar:?]
            at org.jclouds.providers.Providers.all(Providers.java:83) ~[jclouds-core-2.2.0-SNAPSHOT.jar:2.2.0-SNAPSHOT]
            at org.jclouds.providers.Providers.withId(Providers.java:99) ~[jclouds-core-2.2.0-SNAPSHOT.jar:2.2.0-SNAPSHOT]
            at org.jclouds.ContextBuilder.newBuilder(ContextBuilder.java:167) ~[jclouds-core-2.2.0-SNAPSHOT.jar:2.2.0-SNAPSHOT]
            at org.apache.pulsar.broker.offload.impl.BlobStoreManagedLedgerOffloader.<init>(BlobStoreManagedLedgerOffloader.java:233) ~[tiered-storage-jcloud.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.broker.offload.impl.BlobStoreManagedLedgerOffloader.create(BlobStoreManagedLedgerOffloader.java:163) ~[tiered-storage-jcloud.jar:2.2.0-incubating-SNAPSHOT]
            at org.apache.pulsar.broker.PulsarService.createManagedLedgerOffloader(PulsarService.java:670) ~[pulsar-broker.jar:2.2.0-incubating-SNAPSHOT]
            ... 3 more
     ```
    
    The problem is unshaded dependencies introduced in the classpath.
    
     ### Changes
    
    - Catch runtime exception on starting up and fail explicityly
    - Exclude transitive dependencies from shaded artifact
    
    * Avoid excluding guice
    
    * Fix classnot found in testing

 .../org/apache/pulsar/broker/PulsarService.java    | 32 +++++-----
 tiered-storage/jcloud/pom.xml                      | 72 ++++++++++++++++++++++
 2 files changed, 90 insertions(+), 14 deletions(-)

commit b0a4018e09f5476934f9bf8b674178b1f6bbd7f7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Aug 16 11:04:03 2018 -0700

    Simplify argument passing in process runtimes (#2383)
    
    ### Motivation
    
    Currently the process runtime goes over each variable inside the functiondetails protobuf and passes them as individual arguments. This is not only complicated, but each new variable addition/deletion results in changes to processruntime. This pr passes the entire proto as a json string which can then be converted back to protobuf in the instances, thereby simplifying this process.

 .../instance/src/main/python/Function_pb2.py       |  79 ++++++++----
 .../src/main/python/InstanceCommunication_pb2.py   | 137 ++++++++++++++++++---
 .../instance/src/main/python/python_instance.py    |   6 +-
 .../src/main/python/python_instance_main.py        |  63 ++--------
 .../pulsar/functions/runtime/JavaInstanceMain.java | 109 +---------------
 .../pulsar/functions/runtime/ProcessRuntime.java   |  93 +-------------
 .../functions/runtime/ProcessRuntimeFactory.java   |   2 +-
 .../pulsar/functions/runtime/RuntimeFactory.java   |   2 +-
 .../functions/runtime/ProcessRuntimeTest.java      |  47 ++-----
 9 files changed, 210 insertions(+), 328 deletions(-)

commit 2bc48129bfb4433182f1b05a9008faef76e387ac
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 16 00:25:49 2018 -0700

    [documentation][deploy] Improve helm deployment script to deploy Pulsar to minikube (#2363)
    
    * [documentation][deploy] Update deployment instructions for deploying to Minikube
    
    * Enable functions workers
    
    * [documentation][deploy] Improve helm deployment script to deploy Pulsar to minikube
    
     ### Changes
    
    - update the helm scripts: bookie/autorecovery/broker pods should wait until metadata is initialized
    - disable `autoRecovery` on bookies since we start `AutoRecovery` in separate pods
    - enable function worker on brokers
    - provide a values file for minikube
    - update documentation for using helm chart to deploy a cluster to minikube
    
    * move the service type definition to values file

 deployment/kubernetes/helm/README.md               |  54 +++
 .../pulsar/templates/autorecovery-deployment.yaml  |   2 +-
 .../pulsar/templates/bookkeeper-configmap.yaml     |   2 +
 .../pulsar/templates/bookkeeper-statefulset.yaml   |   2 +-
 .../helm/pulsar/templates/broker-configmap.yaml    |   2 +
 .../helm/pulsar/templates/broker-deployment.yaml   |   3 +-
 .../pulsar/templates/prometheus-deployment.yaml    |   6 +
 .../helm/pulsar/templates/proxy-deployment.yaml    |   2 +-
 .../helm/pulsar/templates/proxy-service.yaml       |   2 +-
 .../helm/pulsar/templates/zookeeper-metadata.yaml  |   4 +
 deployment/kubernetes/helm/pulsar/values-mini.yaml | 388 +++++++++++++++++++++
 deployment/kubernetes/helm/pulsar/values.yaml      |   9 +-
 site2/docs/deploy-kubernetes.md                    |  35 +-
 13 files changed, 500 insertions(+), 11 deletions(-)

commit 722dac58cf5a15e79acc428b6b9978d0b0d6e85b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 15 11:54:02 2018 -0700

    Avoid double executor on non-persistent topic send operation (#2351)

 .../service/nonpersistent/NonPersistentTopic.java  | 42 ++++++++--------------
 1 file changed, 15 insertions(+), 27 deletions(-)

commit 7416fc0ca18aeefa04a9006fd9da2c61a3322865
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 15 11:50:18 2018 -0700

    Increased default brokerShutdownTimeout to 60 seconds (#2377)
    
    ### Motivation
    
    The default timeout for broker graceful shutdown is set to 3 seconds. This can give little room to do graceful shutdown when the broker is serving a lot of topics.
    
    There is no big downside in increasing the timeout to a much bigger value.

 conf/broker.conf                                                      | 2 +-
 conf/standalone.conf                                                  | 2 +-
 deployment/terraform-ansible/templates/broker.conf                    | 2 +-
 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java  | 2 +-
 site2/docs/reference-configuration.md                                 | 4 ++--
 5 files changed, 6 insertions(+), 6 deletions(-)

commit 8d8b9056ba1cc85b5127344b5510e95e5cefd334
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 15 11:49:49 2018 -0700

    Include Python-3.7 compatible client lib for linux (#2378)
    
    ### Motivation
    
    Adding build file to provide Python-3.7 wheel files for linux.

 pulsar-client-cpp/CMakeLists.txt          |  2 +-
 pulsar-client-cpp/docker/Dockerfile       | 16 ++++++++--------
 pulsar-client-cpp/docker/create-images.sh |  1 +
 pulsar-client-cpp/python/CMakeLists.txt   | 11 +++++++++++
 site2/docs/client-libraries-python.md     |  4 ++--
 5 files changed, 23 insertions(+), 11 deletions(-)

commit c6c7def97b09d9c070d558b75e43bcea5040aa7c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 15 08:56:50 2018 -0700

     [documentation][deploy] Update deployment instructions for deploying pulsar to minikube (#2362)
    
    * [documentation][deploy] Update deployment instructions for deploying to Minikube
    
    * Enable functions workers

 deployment/kubernetes/generic/admin.yaml           | 44 +++++++++++++
 deployment/kubernetes/generic/bookie.yaml          | 50 ++-------------
 deployment/kubernetes/generic/broker.yaml          | 42 ++++--------
 .../kubernetes/generic/cluster-metadata.yaml       | 42 ++++++++++++
 deployment/kubernetes/generic/monitoring.yaml      | 26 ++++----
 deployment/kubernetes/generic/proxy.yaml           | 12 ++--
 deployment/kubernetes/generic/zookeeper.yaml       |  2 +-
 site2/docs/deploy-kubernetes.md                    | 75 ++++++++++++++++++----
 8 files changed, 189 insertions(+), 104 deletions(-)

commit f352203d1a21752ec07eea8c216a3d62fa7cab04
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 14 22:24:07 2018 -0700

    [documentation] Cherry-pick tiered storage documentation to new website (#2364)
    
    ### Motivation
    
    Cherry-pick #2152

 site2/docs/cookbooks-tiered-storage.md | 125 +++++++++++++++++++++++++++------
 1 file changed, 105 insertions(+), 20 deletions(-)

commit ad5fc8384bc38ff79637c7bd316b41e76f7bc27a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 14 15:41:45 2018 -0700

    Kinesis-sink consider topic-name as partition-key if record key empty (#2372)

 .../kinesis/src/main/java/org/apache/pulsar/io/kinesis/KinesisSink.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 76801731f27e0289eef80959d90cd9165aaa99ed
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 14 11:02:24 2018 -0700

    [compaction] make topic compaction works with partitioned topic (#2367)
    
    * [compaction] make topic compaction works with partitioned topic
    
     ### Motivation
    
    Topic compaction doesn't work with partitioned topic.
    
     ### Changes
    
    - make `RawReaderImpl` and `ReaderImpl` return message with partition idx
    - make broker service `Consumer` deliver MessageIdData with partition idx
    - add an integration test to ensure compaction work with partitioned topic

 .../org/apache/pulsar/broker/service/Consumer.java |   9 +-
 .../apache/pulsar/client/impl/RawReaderImpl.java   |  16 ++-
 .../pulsar/compaction/TwoPhaseCompactor.java       |   8 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   2 +-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   4 +-
 .../integration/compaction/TestCompaction.java     | 150 +++++++++++++++++++++
 6 files changed, 177 insertions(+), 12 deletions(-)

commit 1e9ec0e687e2d049d6994d12beac5e0d025d5ada
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 14 11:01:53 2018 -0700

    add more debug logs with function name reference (#2370)
    
    ### Motivation
    
    Right now, at few places, function is not logging function-reference along with exception which makes hard to debug the issue. so, added more function-reference into logs for troubleshooting.

 .../pulsar/functions/runtime/RuntimeSpawner.java    | 15 ++++++++-------
 .../pulsar/functions/worker/FunctionActioner.java   | 21 +++++++++++++++------
 .../functions/worker/FunctionAssignmentTailer.java  |  3 ++-
 .../functions/worker/FunctionMetaDataManager.java   |  4 ++++
 4 files changed, 29 insertions(+), 14 deletions(-)

commit 870e459fac80909bf9ad177b67d329b476c79486
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 14 11:01:15 2018 -0700

    [tiered storage] move offloader implementation to a separate module (#2371)
    
    ### Motivation
    
    We need tiered storage implementation available for Pulsar SQL.
    And we need to use NAR plugin for packaging different offloaders to
    avoid version conflicts.
    
     ### Changes
    
    - Create `tiered-storage` and `tiered-storage/jcloud` modules.
    - Move `org.apache.pulsar.broker.offload` to `tiered-storage/jcloud`.
    - Add `TieredStorageConfigurationData` for all tiered storage related configuration
    
     ### NOTES
    
    This change is mainly for relocating files only.

 pom.xml                                            |  1 +
 pulsar-broker/pom.xml                              | 16 ++---
 .../org/apache/pulsar/broker/PulsarService.java    | 39 +++++++++++-
 tiered-storage/jcloud/pom.xml                      | 58 +++++++++++++++++
 .../pulsar/broker/offload/BackedInputStream.java   |  0
 .../offload/BlockAwareSegmentInputStream.java      |  0
 .../pulsar/broker/offload/DataBlockHeader.java     |  0
 .../pulsar/broker/offload/OffloadIndexBlock.java   |  0
 .../broker/offload/OffloadIndexBlockBuilder.java   |  0
 .../pulsar/broker/offload/OffloadIndexEntry.java   |  0
 .../offload/TieredStorageConfigurationData.java    | 69 ++++++++++++++++++++
 .../impl/BlobStoreBackedInputStreamImpl.java       |  0
 .../impl/BlobStoreBackedReadHandleImpl.java        |  3 +-
 .../impl/BlobStoreManagedLedgerOffloader.java      | 73 ++++++++++++++--------
 .../impl/BlockAwareSegmentInputStreamImpl.java     |  0
 .../broker/offload/impl/DataBlockHeaderImpl.java   |  0
 .../offload/impl/OffloadIndexBlockBuilderImpl.java |  0
 .../broker/offload/impl/OffloadIndexBlockImpl.java |  0
 .../broker/offload/impl/OffloadIndexEntryImpl.java |  0
 .../offload/BlobStoreBackedInputStreamTest.java    |  0
 .../pulsar/broker/offload/BlobStoreTestBase.java   |  0
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  | 52 +++++++++------
 .../impl/BlockAwareSegmentInputStreamTest.java     |  0
 .../broker/offload/impl/DataBlockHeaderTest.java   |  0
 .../broker/offload/impl/OffloadIndexTest.java      |  0
 tiered-storage/pom.xml                             | 38 +++++++++++
 26 files changed, 292 insertions(+), 57 deletions(-)

commit 4810a26e370f3a253fe98222d486433a91f04cd1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Aug 13 23:58:22 2018 -0700

    If --customSerdeInputs is specified, please update the right variable (#2369)
    
    ### Motivation
    
    When we made the switch to get away from camel-case arguments for functions, we moved the camel case arguments as deprecated, so users can still use them but they are hidden. But that change missed to take --customSerdeInputs into account. This fixes that ommision
    
    ### Modifications
    
    Describe the modifications you've done.
    
    ### Result
    
    After your change, what will change.

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java          | 1 +
 1 file changed, 1 insertion(+)

commit d5c7a9b95fcc21def4f1bd3c3458a965408db35f
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Tue Aug 14 15:56:58 2018 +0900

    change 'cd' to 'cp -r' (#2368)
    
    ### Motivation
    
    In https://pulsar.incubator.apache.org/docs/en/io-quickstart/ ,
    `connectors` directory cannot be copied because copy command is wrong.
    
    > // you will find a directory named `apache-pulsar-io-connectors-2.1.0-incubating` in the pulsar directory
    > // then copy the connectors
    >
    > $ cd apache-pulsar-io-connectors-2.1.0-incubating/connectors connectors
    
    ### Modifications
    
    Change `cd` to `cp -r`
    
    ### Result
    
    `connectors` directory can be copied successfully.
    
    ```
    $ cp -r apache-pulsar-io-connectors-2.1.0-incubating/connectors connectors
    $ ls connectors
    pulsar-io-aerospike-2.1.0-incubating.nar  pulsar-io-kinesis-2.1.0-incubating.nar
    pulsar-io-cassandra-2.1.0-incubating.nar  pulsar-io-rabbitmq-2.1.0-incubating.nar
    pulsar-io-kafka-2.1.0-incubating.nar      pulsar-io-twitter-2.1.0-incubating.nar
    ```

 site2/docs/io-quickstart.md                                            | 2 +-
 site2/website/versioned_docs/version-2.1.0-incubating/io-quickstart.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 7bcd8934a0a53ab7a62b3c9d77fbdec94ab497d2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 13 22:49:11 2018 -0700

    Add support to restart function (#2365)
    
    * Add support to restart function
    
    fix: pulsar function restart
    
    * add support to restart all function instances

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  25 +++++
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    |   2 +-
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  63 +++++++++++-
 .../org/apache/pulsar/client/admin/Functions.java  |  33 +++++++
 .../client/admin/internal/FunctionsImpl.java       |  22 +++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  29 ++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  37 ++++++-
 .../pulsar/functions/worker/FunctionActioner.java  |   4 +-
 .../functions/worker/FunctionRuntimeManager.java   | 107 +++++++++++++++++++++
 .../functions/worker/rest/api/FunctionsImpl.java   |  66 +++++++++++++
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  28 ++++++
 11 files changed, 404 insertions(+), 12 deletions(-)

commit c9988cff24aa12e94c2a09cd112ab2bfa0a8860b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 13 21:20:02 2018 -0700

    Set correct exception if function runnable fails with Error (#2353)
    
    * Set correct exception if function runnable fails with Error
    
    * fix throwable set

 .../org/apache/pulsar/functions/instance/JavaInstanceRunnable.java  | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 82771daadd8d33eaf5087b43328458f970c6c378
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 13 16:56:23 2018 -0700

    Fixed linking of python wrapper to boost-python in MacOS build (#2366)

 pulsar-client-cpp/python/CMakeLists.txt            |  4 +++-
 pulsar-client-cpp/python/pkg/osx/build.sh.template | 14 ++++++++++----
 2 files changed, 13 insertions(+), 5 deletions(-)

commit 296830a37d82de65d30dfd74d9a5893033056f18
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Tue Aug 14 06:05:59 2018 +0800

    [cpp] receiver queue size config acorss partitions in multi-topics-consumer (#2311)
    
    * catch up receiver queue size support in multi topics consumer
    
    * add python config

 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   |  5 ++++-
 pulsar-client-cpp/python/pulsar/__init__.py        | 13 ++++++++++++
 pulsar-client-cpp/python/src/config.cc             |  4 ++++
 .../client/impl/MultiTopicsConsumerImpl.java       | 23 +++++++++++++---------
 4 files changed, 35 insertions(+), 10 deletions(-)

commit cb2f4ee3960fc841ad42bc6e6b1209a92b88d5d9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 13 14:40:18 2018 -0700

    add function package-url into function-get api response (#2354)
    
    ### Motivation
    
    Right now, we mostly use function by submitting function with url and many times, we want to verify function package-url to confirm the package-version. So, function-admin api should return packageurl along with function metadata.
    
    ### Modifications
    
    return function pacakge-url along with function-metadata on get-function api call.

 pulsar-functions/proto/src/main/proto/Function.proto       |  1 +
 .../pulsar/functions/worker/rest/api/FunctionsImpl.java    | 14 ++++++++++----
 2 files changed, 11 insertions(+), 4 deletions(-)

commit 0d2154ed3acd67bcb651644ae13e43cdd4045e90
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 13 14:19:46 2018 -0700

    Fix: function with multi-topic not acking on effectively-once (#2347)
    
    ### Motivation
    
    `MultiTopicsConsumerImpl` doesn't support `acknowledgeCumulativeAsync` and therefore, function with multi-topic and `EFFECTIVELY_ONCE` processing is not acking message and failing `EFFECTIVELY_ONCE` behavior.
    
    ### Modifications
    
    Function should ack message for a specific topic consumer if `inputTopicConsumer` is multi-topic consumer.
    
    ### Result
    
    Function should able to ack messages for multi-topic consumer when processing-guarantee is `EFFECTIVELY_ONCE`

 .../client/api/PartitionedProducerConsumerTest.java     |  9 ++-------
 .../java/org/apache/pulsar/io/PulsarSinkE2ETest.java    | 10 ++++++----
 .../pulsar/client/impl/MultiTopicsConsumerImpl.java     | 17 +++++++++++------
 .../apache/pulsar/functions/source/PulsarSource.java    | 15 ++++++---------
 4 files changed, 25 insertions(+), 26 deletions(-)

commit 777223d8031233ef03f61c41b8b99916c268b819
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 13 09:07:44 2018 -0700

    [docker] Publish pulsar-all image to docker hub (#2361)
    
    ### Motivation
    
    We have `pulsar-all` image since 2.1.0 release. However this image is not pushed to docker hub.
    
     ### Changes
    
    Publish `pulsar-all` image to docker hub.

 docker/publish.sh | 4 ++++
 1 file changed, 4 insertions(+)

commit c0a5072b80d8b63e447cee8a029d23e4e075d2d6
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Mon Aug 13 04:36:41 2018 +0800

    add encoding for WebTargets parts (#2359)
    
    ### Motivation
    
    Fixes #2304
    
    Issue #2304 reported that Pulsar admin commands will fail with some url style parts,
    ```
    root@pulsar-admin:/pulsar# pulsar-admin namespaces grant-permission --actions produce,consume --role 'spiffe://developer/passport' core-platform/testing
    HTTP 404 Not Found
    Reason: HTTP 404 Not Found
    ```
    This PR try to fix it.
    
    ### Modifications
    
    - use URLEncoder to encode webTarget parts.
    - add tests to verify
    
    ### Result
    
    all UT passed

 .../java/org/apache/pulsar/broker/admin/AdminApiTest.java  |  6 ++++++
 .../apache/pulsar/client/admin/internal/WebTargets.java    | 14 +++++++++++++-
 2 files changed, 19 insertions(+), 1 deletion(-)

commit 20caf5f5de9a22aeb4b3c5a9eb4cac5bf4e2030e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Aug 11 22:06:30 2018 -0700

    [deploy][documentation] Fix terraform-ansible script and update documentation (#2357)
    
    * [documentation] Improve documentation on bare mental deployment
    
     ### Motiviation
    
    Fixes #2329
    
     ### Changes
    
    - How to enable state storage for stateful functions
    - How to enable function worker
    - How to install builtin connectors
    - Instructions to test functions
    
    * Improve ansible script
    
    * Fix the documentation
    
    * update 2.1.0 documentation

 deployment/terraform-ansible/aws/instances.tf      |  34 +++++-
 deployment/terraform-ansible/aws/network.tf        |   2 +-
 deployment/terraform-ansible/aws/output.tf         |   2 +-
 deployment/terraform-ansible/aws/setup-disk.yaml   |   2 +-
 deployment/terraform-ansible/aws/terraform.tfvars  |  10 +-
 deployment/terraform-ansible/aws/variables.tf      |  12 +-
 deployment/terraform-ansible/deploy-pulsar.yaml    |  80 +++++++++-----
 .../terraform-ansible/templates/bookkeeper.service |  33 ++++++
 deployment/terraform-ansible/templates/broker.conf |   6 +-
 .../templates/functions_worker.yml                 |  46 ++++++++
 deployment/terraform-ansible/templates/proxy.conf  | 123 +++++++++++++++++++++
 .../{pulsar.service => pulsar.broker.service}      |   2 +-
 .../templates/pulsar.proxy.service                 |  32 ++++++
 site2/docs/deploy-aws.md                           |  13 ++-
 .../version-2.1.0-incubating/deploy-aws.md         |  49 +++++++-
 15 files changed, 393 insertions(+), 53 deletions(-)

commit c65b701b16bab4ba03f39b5a57bd378a6c4532ac
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Sun Aug 12 14:06:13 2018 +0900

    Fix typo (#2360)
    
    * Fix typo
    
    * Fix typo in versioned docs as well

 site2/docs/client-libraries-cpp.md                                      | 2 +-
 .../versioned_docs/version-2.1.0-incubating/client-libraries-cpp.md     | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 9be2a656fdf58c7edc6e1b64461309961e564673
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Aug 11 09:59:29 2018 -0700

    [documentation] Cherry-pick documentation on bare mental deployment to 2.1.0 (#2358)
    
    ### Motivation
    
    PR #2335 improved documentation on bare mental deployment. But it missed to add to 2.1.0 documentation.
    
     ### Changes
    
    Cherry-pick the documentation changes to version 2.1.0

 .../version-2.1.0-incubating/deploy-bare-metal.md  | 127 ++++++++++++++++++++-
 1 file changed, 124 insertions(+), 3 deletions(-)

commit cb16f5584d316de275aa60f69a6391f449a3e3d1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 10 19:40:44 2018 -0700

    Issue 1067: Problems with Partitioned Topics which name contains -partition-N (#2342)
    
    * Issue 1067: Problems with Partitioned Topics which name contains -partition-N
    
     ### Motivation
    
    Fixes #1067.
    
    Someone accidentally created a partitioned topic in one of our cluster with a name which contains -partition-2.
    This raised all sorts of issues, it would seem that only one partition was created for this topic, but metadata exists saying that it has 10 partitions.
    
     ### Changes
    
    Disallow creating a partitioned topic contains '-partition-' in the name.
    
    * only validate partitioned topic name when create/delete/update partitioned topics
    
    * Changed to use a CONSTANT

 .../apache/pulsar/broker/admin/AdminResource.java  |  9 +++
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 42 +++++++++----
 .../pulsar/broker/admin/AdminResourceTest.java     | 69 ++++++++++++++++++++++
 .../org/apache/pulsar/common/naming/TopicName.java |  2 +-
 4 files changed, 108 insertions(+), 14 deletions(-)

commit 8655d53b62c6e8f25cc629f7922f52e23b07c768
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 10 19:40:23 2018 -0700

    [documentation] Improve documentation on bare mental deployment (#2335)
    
    ### Motiviation
    
    Fixes #2329
    
     ### Changes
    
    - How to enable state storage for stateful functions
    - How to enable function worker
    - How to install builtin connectors
    - Instructions to test functions

 deployment/terraform-ansible/aws/setup-disk.yaml   |  36 ++++++
 deployment/terraform-ansible/deploy-pulsar.yaml    |  20 +---
 .../terraform-ansible/templates/bookkeeper.conf    |   2 +-
 site2/docs/deploy-aws.md                           |  38 +++++-
 site2/docs/deploy-bare-metal.md                    | 127 ++++++++++++++++++++-
 5 files changed, 199 insertions(+), 24 deletions(-)

commit 27964313bd26b71e8014dc0e168d4ffbde15a12f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 10 17:35:59 2018 -0700

    [conf] add zookeeper admin server settings to the configuration files (#2331)
    
    ### Motivation
    
    Fixes 2324
    
    zookeeper 3.5 version introduces admin server. by default it starts at 8080.
    
     ### Changes
    
    Add admin server related settings to zookeeper configuration so people can configure them.
    Change the default settings to 9990. To avoid conflicts with existing ports used by Prometheus for bookie/broker.

 conf/global_zookeeper.conf | 5 +++++
 conf/zookeeper.conf        | 5 +++++
 2 files changed, 10 insertions(+)

commit d248cee810c311c201035c6b2ae4d255ea3a54b4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 10 15:46:00 2018 -0700

    [Integration Tests] Improve and fix integration tests (#2356)
    
    * [Integration Tests] Improve and fix integration tests
    
     ### Motivation
    
    Integration test are basically just not working in apache CI. there are multiple reasons:
    
    1. PULSAR_MEM is set to very high (~2G). If we start more than 6 containers, it will quickly go up to ~12GB.
    2. We start containers for each tests, which is very inefficient.
    3. There is a regression from #2214. #2214 tried to listen on a hostname that is configured in worker config,
      which the hostname is internally to docker environment.
    
     ### Changes
    
    1. Set PULSAR_MEM to use no more than 128M.
    2. Switch to use test suite, trying to start containers only once as possible and use them across test suites.
       so we only start the cluster for a set of tests. hence reorganize those tests and get rid
       of using dataProvider, which doesn't work well with current approach.
    3. Remove binding to hostname in WorkerServer, so it binds to all interfaces.
    
    * remove suite xml
    
    * Avoid running testng suites multiple times

 conf/pulsar_env.sh                                 |   2 +-
 conf/pulsar_tools_env.sh                           |   2 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |   3 -
 .../latest-version-image/conf/bookie.conf          |   4 +-
 .../latest-version-image/conf/broker.conf          |   2 +-
 .../latest-version-image/conf/global-zk.conf       |   2 +-
 .../latest-version-image/conf/local-zk.conf        |   2 +-
 .../latest-version-image/conf/proxy.conf           |   2 +-
 tests/integration/pom.xml                          |   4 +
 .../pulsar/tests/integration/cli/CLITest.java      |  11 +-
 .../integration/compaction/TestCompaction.java     | 118 ++--
 .../integration/containers/PulsarContainer.java    |  21 +-
 .../integration/containers/WorkerContainer.java    |   8 +-
 .../integration/functions/FunctionsCLITest.java    |  93 ++++
 .../functions/PulsarFunctionsProcessTest.java      |  30 +
 .../integration/functions/PulsarFunctionsTest.java | 612 +++++++++++++++++++--
 .../functions/PulsarFunctionsTestBase.java         |  27 +-
 .../functions/PulsarFunctionsThreadTest.java       |  30 +
 .../runtime/PulsarFunctionsRuntimeTest.java        | 194 -------
 .../tests/integration/io/CassandraSinkTester.java  |  19 +-
 .../tests/integration/io/KafkaSinkTester.java      |  21 +-
 .../tests/integration/io/KafkaSourceTester.java    |  21 +-
 .../tests/integration/io/PulsarIOSinkTest.java     | 274 ---------
 .../tests/integration/io/PulsarIOSourceTest.java   | 270 ---------
 .../pulsar/tests/integration/io/SinkTester.java    |  14 +-
 .../pulsar/tests/integration/io/SourceTester.java  |  12 +-
 .../tests/integration/offload/TestS3Offload.java   |  67 +--
 .../pulsar/tests/integration/smoke/SmokeTest.java  |  86 ---
 .../tests/integration/suites/PulsarTestSuite.java  |  76 +++
 .../suites/PulsarTieredStorageTestSuite.java       |  80 +++
 .../integration/topologies/PulsarCluster.java      |  72 ++-
 .../topologies/PulsarClusterTestBase.java          |  11 +-
 .../src/test/resources/pulsar-process.xml          |  30 +
 .../src/test/resources/pulsar-thread.xml           |  28 +
 tests/integration/src/test/resources/pulsar.xml    |  30 +
 .../src/test/resources/tiered-storage.xml          |  28 +
 36 files changed, 1257 insertions(+), 1049 deletions(-)

commit b6feac8180c978e3c59dfbcd4ef44494dd73b385
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Aug 10 20:10:49 2018 +0200

    C++ HTTP lookup works with TLS (#2314) (#2350)
    
    * C++ HTTP lookup works with TLS (#2314)
    
    Previously it did not take TLS into account at all. Now, if useTls is
    configured, or the client it configured with a https:// url, the http
    lookup will be configured to use TLS.
    
    This patch also makes some changes to make sure the URL the broker
    advertises for TLS starts with pulsar+ssl://.
    
    * format

 .../org/apache/pulsar/broker/PulsarService.java    |  2 +-
 pulsar-client-cpp/lib/ClientConnection.cc          |  2 +-
 pulsar-client-cpp/lib/ClientImpl.cc                |  5 ++-
 pulsar-client-cpp/lib/HTTPLookupService.cc         | 43 +++++++++++++++++++---
 pulsar-client-cpp/lib/HTTPLookupService.h          |  3 ++
 pulsar-client-cpp/lib/LookupDataResult.h           |  8 ++--
 pulsar-client-cpp/tests/AuthPluginTest.cc          | 22 +++++++++++
 .../pulsar/discovery/service/DiscoveryService.java |  2 +-
 8 files changed, 73 insertions(+), 14 deletions(-)

commit 10c351134a36457d3734a356b798b9f18b8d8593
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 10 00:21:55 2018 -0700

    Add worker specific system and jvm metrics (#2352)

 .../apache/pulsar/broker/admin/v2/WorkerStats.java | 11 +++++-
 .../broker/loadbalance/impl/LoadManagerShared.java |  4 +-
 .../pulsar/broker/stats/MetricsGenerator.java      |  4 +-
 .../prometheus/PrometheusMetricsGenerator.java     |  4 +-
 .../stats/BookieClientsStatsGeneratorTest.java     |  2 +-
 .../apache/pulsar/client/admin/WorkerStats.java    |  9 +++++
 .../client/admin/internal/WorkerStatsImpl.java     | 18 ++++++++-
 .../pulsar/admin/cli/CmdFunctionWorkerStats.java   | 24 ++++++++++--
 .../apache/pulsar/common/stats}/JvmMetrics.java    | 32 +++++++++++-----
 .../org/apache/pulsar/common/stats/Metrics.java    |  5 +++
 .../pulsar/functions/worker/MetricsGenerator.java  | 44 ++++++++++++++++++++++
 .../pulsar/functions/worker/WorkerService.java     |  3 ++
 .../functions/worker/rest/api/FunctionsImpl.java   | 21 ++++++++++-
 .../functions/worker/rest/api/v2/WorkerStats.java  | 17 +++++++--
 14 files changed, 171 insertions(+), 27 deletions(-)

commit 6601edad9694ed0d202e533835b2b3504451085d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 9 23:43:02 2018 -0700

    Remove snapshot-topic ref (#2355)
    
    ### Motivation
    
    remove unused config `functionMetadataSnapshotsTopicPath`

 conf/functions_worker.yml                                                | 1 -
 .../src/main/java/org/apache/pulsar/functions/worker/WorkerConfig.java   | 1 -
 2 files changed, 2 deletions(-)

commit a8509341cc8373e849a52bffdb140184371509a3
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Aug 10 13:38:52 2018 +0900

    Fix NPE when splitting and unloading bundle (#2348)

 .../pulsar/broker/namespace/NamespaceService.java  |  6 ++--
 .../broker/namespace/NamespaceServiceTest.java     | 42 ++++++++++++++++++++++
 2 files changed, 45 insertions(+), 3 deletions(-)

commit 270132c55eaa6170edcb3448efe6472d5b184ac8
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Aug 9 12:45:09 2018 -0700

    Re-added tracking id to new website (#2349)

 site2/website/siteConfig.js | 1 +
 1 file changed, 1 insertion(+)

commit 850b56ddbb7cb7c610d062bcea923ed1d336d95a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 9 00:22:59 2018 -0700

    [documentation] Cherrypick #2341 to version 2.1 documentation (#2344)
    
    Cherrypick documentation changes #2341 to 2.1 documentation

 .../reference-cli-tools.md                         | 61 +++++++++-------------
 1 file changed, 26 insertions(+), 35 deletions(-)

commit 20b41de73912ac1f82280d70a291684cb30d8151
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Aug 8 16:57:22 2018 -0700

    REST and CLI to get function metrics in json for monitoring (#2296)
    
    * REST and CLI to get function metrics in json for monitoring
    
    * add worker-stats end-point

 .../apache/pulsar/broker/admin/v2/WorkerStats.java |  47 ++++++++++
 .../org/apache/pulsar/client/admin/Functions.java  |   1 +
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  11 +++
 .../apache/pulsar/client/admin/WorkerStats.java    |  35 +++++++
 .../client/admin/internal/FunctionsImpl.java       |   2 +-
 .../client/admin/internal/WorkerStatsImpl.java     |  58 ++++++++++++
 .../pulsar/admin/cli/CmdFunctionWorkerStats.java   |  79 ++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   1 +
 .../src/main/proto/InstanceCommunication.proto     |   9 ++
 .../pulsar/functions/worker/rest/Resources.java    |   2 +
 .../functions/worker/rest/api/FunctionsImpl.java   | 103 +++++++++++++++++----
 .../functions/worker/rest/api/v2/WorkerStats.java  |  54 +++++++++++
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |   4 +-
 site2/website/scripts/replace.js                   |   3 +-
 15 files changed, 386 insertions(+), 25 deletions(-)

commit 3b3f541c6dc0d66a3ecaf7a0557fc31e9c8d4dfd
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 8 14:13:44 2018 -0700

    [documentation] Fix syntax error on tiered storage documentation (#2345)
    
    ### Motivation
    
    There is a syntax error in tiered storage doc introduced by #2152.
    
    ```
    Liquid Exception: Invalid syntax for include tag: type="warning" content="Driver names are case-insensitive for driver's name. There is a third driver type, "s3", which is identical to "aws-s3", though it requires that you specify an endpoint url using `s3ManagedLedgerOffloadServiceEndpoint`. This is useful if using a S3 compatible data store, other than AWS." Valid syntax: {% include file.ext param='value' param2='value' %} in docs/latest/cookbooks/tiered-storage.md
    ```
    
     ### Changes
    
    Fix the syntax error.

 site/docs/latest/cookbooks/tiered-storage.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0260df0fa8b3fc2a28ac32413be648b535a5c6ba
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 8 11:06:29 2018 -0700

    [documentation] Issue 2252: incorrect flags for bin/pulsar (#2341)
    
    ### Motivation
    
    Fixes #2252
    
    The documentation lists -c and --conf as possible arguments of the bin/pulsar command.
    https://pulsar.incubator.apache.org/docs/v2.0.1-incubating/reference/CliTools/#zookeeper-90gyx
    
    However, the -c and --conf args to bin/pulsar are not respected.
    It seems that the proper way to specify an alternative config file is via env variables,
    eg the PULSAR_ZK_CONF env variable.
    
     ### Changes
    
    Fix the documentation. Since `bin/pulsar` has specified configuration for all the components,
    we have to use environment variables for overriding the configuration files.

 site2/docs/reference-cli-tools.md | 61 +++++++++++++++++----------------------
 1 file changed, 26 insertions(+), 35 deletions(-)

commit 5e1ee372775668c3ff5f59d9beb58f600bb6bb1b
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Aug 8 16:33:52 2018 +0800

    GCS offload support(4): add documentations for GCS (#2152)
    
    This is the 4th part to support Google Cloud Storage offload.
    It aims to add documentations for GCS. And it is based on PR #2151
    
    Master Issue: #2067

 site/docs/latest/cookbooks/tiered-storage.md | 99 +++++++++++++++++++++-------
 1 file changed, 77 insertions(+), 22 deletions(-)

commit d81bf6d9e61edc96e419f078760ae9371e62f566
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 8 01:32:21 2018 -0700

    Fix flaky test PersistentTopicE2ETest.testMessageRedelivery (#2320)
    
    ### Motivation
    
    Test failures are caused by the delayed acks that making the broker redelivering few more messages than what remained unacked. Disabling delayed acked to have the behavior expected by the test.
    
    Example of failures:
    
    ```
    java.lang.AssertionError: expected [my-message-0] but found [my-message-2]
            at org.testng.Assert.fail(Assert.java:96)
            at org.testng.Assert.failNotEquals(Assert.java:776)
            at org.testng.Assert.assertEqualsImpl(Assert.java:137)
            at org.testng.Assert.assertEquals(Assert.java:118)
            at org.testng.Assert.assertEquals(Assert.java:453)
            at org.testng.Assert.assertEquals(Assert.java:463)
            at org.apache.pulsar.broker.service.PersistentTopicE2ETest.testMessageRedelivery(PersistentTopicE2ETest.java:1252)
    ```
    
    https://builds.apache.org/job/pulsar_precommit_java8/2976/testReport/junit/org.apache.pulsar.broker.service/PersistentTopicE2ETest/testMessageRedelivery_2/

 .../broker/service/PersistentTopicE2ETest.java     | 29 ++++++++++++----------
 1 file changed, 16 insertions(+), 13 deletions(-)

commit acc26c9e08476c87d30045a705c4d11d6a572b69
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 8 01:31:11 2018 -0700

    Introduce warmup period in performance producer (#2338)

 .../pulsar/testclient/PerformanceProducer.java       | 20 +++++++++++++-------
 1 file changed, 13 insertions(+), 7 deletions(-)

commit 8cc74988e9d6919a7387832dde9d14602b36c1e8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 8 01:30:56 2018 -0700

    [website] fix broken links (#2337)

 site2/website/blog/2018-08-06-Apache-Pulsar-2-1-0.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 20e652bd7e4b02bb522f3f48df2afcfd695b57d8
Author: danielccyr <josephdanielcyr@live.fr>
Date:   Wed Aug 8 04:30:14 2018 -0400

    added FRench to website (#2339)
    
    ### Motivation
    
    adding french to website
    
    ### Modifications
    
    toggled a flag

 site2/website/languages.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 376bc8b984b2a43163ffea43296eca4ee0a3693b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Aug 7 20:41:13 2018 -0700

    Ignore unknown Properties from config file when parsing (#2336)
    
    ### Motivation
    As Functions evolve, we will be adding new properties/fields to the FunctionConfig. There will be fields present in the config files that won't make sense for previous admin tool installation. This especially happens when submitting pulsar functions using newer client to run over kubernetes with an older installation of pulsar. This pr will mark the unknown fields to be ignored to get over that problem

 .../src/main/java/org/apache/pulsar/functions/utils/FunctionConfig.java | 2 ++
 1 file changed, 2 insertions(+)

commit 18b168ecf798b422dd554e9cfc501c73d26dfccd
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 7 20:39:15 2018 -0700

    [website] update downlink used for quickstart (#2325)
    
    ### Changes
    
    - Use archieve links to ensure all command line works with old releases
    - Fix formatting
    - Remove redundant pip dependencies

 site2/docs/functions-quickstart.md                                    | 4 +++-
 site2/website/scripts/replace.js                                      | 4 ++--
 .../versioned_docs/version-2.1.0-incubating/functions-quickstart.md   | 4 +++-
 3 files changed, 8 insertions(+), 4 deletions(-)

commit c8e6fce132d1eaa9d789dd0c7bd2e5c53e4e5424
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Aug 7 18:40:47 2018 -0700

    Add python user exception function example (#2333)

 pulsar-functions/python-examples/user_exception.py | 29 ++++++++++++++++++++++
 1 file changed, 29 insertions(+)

commit 1773576bbbb425eb6a6bdfeda3962f34efa0cd05
Author: Grant Wu <grantwwu@gmail.com>
Date:   Tue Aug 7 21:40:03 2018 -0400

    Minor typos (#2334)

 site2/docs/client-libraries-cpp.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit f11dfdab71071faf330ec9db3389be4662823af2
Author: Grant Wu <grantwwu@gmail.com>
Date:   Tue Aug 7 19:02:50 2018 -0400

    Minor typo fixes (#2332)
    
    Haven't made any more invasive changes

 site2/website/blog/2018-08-06-Apache-Pulsar-2-1-0.md | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit de66d374aef2b38cc443da51721b5757f99eca04
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 7 10:56:54 2018 -0700

    [blog] Enable blog in website and add one for 2.1.0 release (#2308)
    
    ### Motivation
    
    To provide a channel for users to catch up with latest information in Pulsar

 .../website/blog/2018-08-06-Apache-Pulsar-2-1-0.md | 88 ++++++++++++++++++++++
 site2/website/siteConfig.js                        |  5 +-
 2 files changed, 92 insertions(+), 1 deletion(-)

commit 7e16f136346b4ba046c5a0eda44a4db2137a903a
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Aug 7 17:20:31 2018 +0200

    Enable TLS in client if serviceUrl has pulsar+ssl:// or https:// (#2315)
    
    It's silly to have to do enableTls(true) if pulsar+ssl or https is there.

 conf/client.conf                                   |  3 --
 pulsar-client-cpp/lib/ClientImpl.cc                | 33 +++++++++++++++-------
 pulsar-client-cpp/tests/AuthPluginTest.cc          | 21 ++++++++++++++
 .../apache/pulsar/client/cli/PulsarClientTool.java |  3 --
 .../apache/pulsar/client/api/ClientBuilder.java    |  5 +++-
 .../pulsar/client/impl/ClientBuilderImpl.java      |  4 ++-
 .../apache/pulsar/client/impl/BuildersTest.java    | 30 ++++++++++++++++++--
 site/docs/latest/clients/Cpp.md                    |  1 -
 site/docs/latest/clients/Java.md                   |  6 ++--
 site/docs/latest/security/athenz.md                |  1 -
 site/docs/latest/security/authorization.md         |  8 ++----
 site/docs/latest/security/tls-transport.md         |  3 --
 site/docs/latest/security/tls.md                   |  3 --
 13 files changed, 83 insertions(+), 38 deletions(-)

commit 15441f8b49deea1c781b538fa8cba2768af4458f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 7 08:06:24 2018 -0700

    [website] rename property to tenant (#2326)
    
    ### Changes
    
    - fix swagger definitions on offloader and compaction
    - rename property to tenant across documentations

 .../apache/pulsar/broker/admin/v2/Namespaces.java  | 42 +++++++++++-----------
 site2/docs/admin-api-partitioned-topics.md         |  4 +--
 site2/docs/administration-geo.md                   |  8 ++---
 site2/docs/concepts-architecture-overview.md       |  2 +-
 site2/docs/cookbooks-partitioned.md                |  2 +-
 site2/docs/deploy-kubernetes.md                    |  4 +--
 site2/docs/security-authorization.md               |  2 +-
 site2/docs/security-encryption.md                  |  4 +--
 .../admin-api-partitioned-topics.md                |  4 +--
 .../version-2.1.0-incubating/administration-geo.md |  8 ++---
 .../concepts-architecture-overview.md              |  2 +-
 .../cookbooks-partitioned.md                       |  2 +-
 .../version-2.1.0-incubating/deploy-kubernetes.md  |  4 +--
 .../security-authorization.md                      |  2 +-
 .../security-encryption.md                         |  4 +--
 15 files changed, 47 insertions(+), 47 deletions(-)

commit 6f6c5c8e7fbfed0be5e00104038636250a504d9c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Aug 7 08:06:05 2018 -0700

    Issue 2272: Fix git-commit-id-plugin (#2327)
    
    ### Motivation
    
    Fixes #2272.
    
    We are using git-commit-id plugin for generating a properties file containing all the build information.
    However you have to skip git-commit-id-plugin when the source code is not in a git repo.
    
     ### Changes
    
    add `<failOnNoGitDirectory>false</failOnNoGitDirectory>` to git-commit-plugin

 pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit 14765b2c4b452dcc3a0d1a4fd488142fd5111a93
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 7 01:06:13 2018 -0700

    Avoid creating output topic on tenant namespace if output-topic not provided (#2261)
    
    * Avoid creating output topic on tenant namespace if output-topic not provided
    
    fix test
    
    add flag to skip output topic
    
    rename skip-output cmd
    
    * fix test

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 31 +++++++++++++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 24 ++++-------
 .../functions/instance/JavaInstanceRunnable.java   | 23 +++++-----
 .../pulsar/functions/sink/PulsarSinkDisable.java   | 49 ++++++++++++++++++++++
 .../pulsar/functions/utils/FunctionConfig.java     |  2 +-
 5 files changed, 100 insertions(+), 29 deletions(-)

commit b1b670258eabc6cfa123f1bd602b7b083a37c9aa
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 6 23:19:47 2018 -0700

    [website] Translation strings are not downloaded correctly (#2322)
    
    ### Motivation
    
    Noticed following warnings in website CI builds.
    
    ```
    Warning: Downloaded translations do not match current project configuration. The following files will be omitted:
     - '/website/i18n/ja-JP.json'
    ```
    
    The warnings were generated before `i18n/en.json` was not generated before downloading translations.
    
     ### Changes
    
    add `yarn write-translations` before uploading/downloading translations.
    
    additionaly fix `<translate>` location for download page

 site2/tools/docker-build-site.sh   | 2 +-
 site2/website/pages/en/download.js | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit b118f7b4b03848c9066504ed872398273d964f99
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Aug 6 18:52:18 2018 -0700

    [website] generate swagger definitions for schema API and update schema documentation (#2319)
    
    * [website] generate swagger definitions for schema API and update schema documentation
    
     ### Motivation
    
    The swagger definitions for Schemas are missing.
    
     ### Changes
    
    Add swagger definitions for Schemas API. Improve the documentation around Schemas.
    
    * Make the documentation changes to v2.1.0
    
    * remove swp file

 .../pulsar/broker/admin/v2/SchemasResource.java    |  57 ++-
 site2/docs/admin-api-schemas.md                    |  98 +++++
 site2/docs/concepts-schema-registry.md             |   6 +-
 site2/website/sidebars.json                        |   3 +-
 site2/website/static/swagger/swagger.json          | 421 +++++++++++++++++++--
 .../version-2.1.0-incubating/admin-api-schemas.md  |  99 +++++
 .../concepts-schema-registry.md                    |   6 +-
 .../version-2.1.0-incubating-sidebars.json         |   3 +-
 8 files changed, 661 insertions(+), 32 deletions(-)

commit 6b7a76fba4b1c08bf845409c6e4cabf48a454a5e
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 7 09:12:47 2018 +0900

    Fixed refcounting when processing entries from sql (#2316)

 .../java/org/apache/pulsar/client/impl/MessageParser.java    |  5 -----
 .../org/apache/pulsar/sql/presto/PulsarRecordCursor.java     | 12 +++++-------
 2 files changed, 5 insertions(+), 12 deletions(-)

commit 9213e58a74dc26096cc132eec709ae3d95ade095
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 7 09:11:28 2018 +0900

    Attempt to fix flakyness of BrokerBkEnsemblesTests.testSkipCorruptDataLedger (#2318)

 .../broker/service/BrokerBkEnsemblesTests.java     | 22 +++++++++++++++-------
 1 file changed, 15 insertions(+), 7 deletions(-)

commit 461647a2b7943787883760a810f7cecda88128ec
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Aug 6 10:29:26 2018 -0700

    PIP-19: Initial implementation of Pulsar SQL (#2265)
    
    * adding module for Pulsar SQL
    
    * renaming presto pulsar package
    
    * fixing pom and configs
    
    * fixing pom
    
    * using project version variable in pom
    
    * adding comments

 pom.xml                                            |   2 +
 pulsar-sql/pom.xml                                 |  39 ++
 pulsar-sql/presto-pulsar-plugin/pom.xml            |  74 +++
 .../src/main/assembly/assembly.xml                 |  35 ++
 pulsar-sql/presto-pulsar/pom.xml                   | 114 +++++
 .../pulsar/sql/presto/AvroSchemaHandler.java       |  64 +++
 .../pulsar/sql/presto/JSONSchemaHandler.java       |  88 ++++
 .../pulsar/sql/presto/PulsarColumnHandle.java      | 146 ++++++
 .../pulsar/sql/presto/PulsarColumnMetadata.java    |  90 ++++
 .../apache/pulsar/sql/presto/PulsarConnector.java  |  95 ++++
 .../pulsar/sql/presto/PulsarConnectorConfig.java   |  98 ++++
 .../pulsar/sql/presto/PulsarConnectorFactory.java  |  72 +++
 .../pulsar/sql/presto/PulsarConnectorId.java       |  49 ++
 .../pulsar/sql/presto/PulsarConnectorModule.java   |  79 +++
 .../pulsar/sql/presto/PulsarConnectorUtils.java    |  40 ++
 .../pulsar/sql/presto/PulsarHandleResolver.java    |  82 +++
 .../pulsar/sql/presto/PulsarInternalColumn.java    | 203 ++++++++
 .../apache/pulsar/sql/presto/PulsarMetadata.java   | 384 ++++++++++++++
 .../org/apache/pulsar/sql/presto/PulsarPlugin.java |  31 ++
 .../pulsar/sql/presto/PulsarRecordCursor.java      | 344 +++++++++++++
 .../apache/pulsar/sql/presto/PulsarRecordSet.java  |  62 +++
 .../pulsar/sql/presto/PulsarRecordSetProvider.java |  58 +++
 .../org/apache/pulsar/sql/presto/PulsarSplit.java  | 168 ++++++
 .../pulsar/sql/presto/PulsarSplitManager.java      | 241 +++++++++
 .../pulsar/sql/presto/PulsarTableHandle.java       | 120 +++++
 .../pulsar/sql/presto/PulsarTableLayoutHandle.java |  44 ++
 .../pulsar/sql/presto/PulsarTopicDescription.java  |  68 +++
 .../pulsar/sql/presto/PulsarTransactionHandle.java |  25 +
 .../apache/pulsar/sql/presto/SchemaHandler.java    |  27 +
 .../services/com.facebook.presto.spi.Plugin        |   1 +
 .../pulsar/sql/presto/TestPulsarConnector.java     | 565 +++++++++++++++++++++
 .../pulsar/sql/presto/TestPulsarMetadata.java      | 404 +++++++++++++++
 .../pulsar/sql/presto/TestPulsarRecordCursor.java  |  79 +++
 .../pulsar/sql/presto/TestPulsarSplitManager.java  | 169 ++++++
 34 files changed, 4160 insertions(+)

commit 3f8944f28ef2188d4bdab8f9394650fd799bc786
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Mon Aug 6 07:49:42 2018 +0800

    Issue #1452: remove reachedEndOfTopic in addConsumer (#2301)
    
    ### Motivation
    
    Fixes #1452
    
    In issue #1452 , reachedEndOfTopic was called twice if a topic has been terminated before subscription.
    It may be better to call `reachedEndOfTopic`, when real read/ack happened to the subscription, so delete the calling in `addConsumer` to avoid dup calling.
    
    ### Modifications
    
    remove dup calling in `addConsumer` .
    add related ut.
    
    ### Result
    
    Expected all ut passed.

 .../service/persistent/PersistentSubscription.java |  5 ---
 .../client/api/SimpleProducerConsumerTest.java     | 42 ++++++++++++++++++++--
 2 files changed, 40 insertions(+), 7 deletions(-)

commit df02c7bfd12c0a62e25bd28b6ec0d35a7eaf7e9a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Aug 5 16:47:20 2018 -0700

    fix Test: function-tls test stops server gracefully (#2297)
    
    ### Motivation
    
    As discussed in #2214 , right now, integration test requires function-worker process to exit when worker-server thread is interrupted which was removed in #2214. so, revert back previous behavior to exit worker-server when server thread is interrupted. However, tls-test will not create a separate thread to start worker-server so, unit-test will not exist during testing.
    
    
    ### Result
    
    Fix integration test failure.

 .../apache/pulsar/io/PulsarFunctionTlsTest.java    | 12 +----
 .../org/apache/pulsar/functions/worker/Worker.java | 19 +++----
 .../pulsar/functions/worker/rest/WorkerServer.java | 60 ++++++++--------------
 3 files changed, 29 insertions(+), 62 deletions(-)

commit 0d97479ab2c67e2dad04c5c9887b51bc49fd3e52
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Aug 5 16:45:42 2018 -0700

     [website] update clients page with feature matrix and a list of 3rdparty clients (#2309)
    
    * [website] update clients page with feature matrix and a list of 3rdparty clients
    
    * Use a table to keep the list

 site2/docs/getting-started-clients.md              | 16 ++++++++++
 .../getting-started-clients.md                     | 35 ++++++++++++++++++++++
 2 files changed, 51 insertions(+)

commit 41a973b5f1f0ce842ec05ff95730e2746f2bdb97
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Aug 5 16:44:19 2018 -0700

    [website] wrap strings with <translate> tags (#2310)
    
    ### Motivation
    
    wrap the strings with `<translate>` tags so they can be translated

 site2/website/pages/en/contact.js   | 26 ++++++++++---------
 site2/website/pages/en/download.js  | 50 ++++++++++++++++++++-----------------
 site2/website/pages/en/events.js    |  8 +++---
 site2/website/pages/en/index.js     |  4 ++-
 site2/website/pages/en/resources.js | 20 ++++++++-------
 site2/website/pages/en/team.js      | 28 +++++++++++++--------
 site2/website/pages/en/versions.js  | 34 +++++++++++++++++--------
 7 files changed, 101 insertions(+), 69 deletions(-)

commit 28fe0a174c38bb57e11e0ca9706893c294b4df42
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Aug 4 00:12:59 2018 -0700

    [website] fix css problem on languages menu (#2306)
    
    ### Problem
    
    The languages menu is not displayed properly.
    
    ### Changes
    
    Add language menu to custom css file.

 site2/website/static/css/custom.css | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

commit 04d62345bc4db147ef262b0be07524a57b11fa60
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sat Aug 4 00:10:49 2018 -0700

    Add Example functions (#2305)
    
    We add 2 more examples pulsar functions.

 .../api/examples/InstanceIdAppenderFunction.java   | 34 ++++++++++++++++++++++
 .../api/examples/IntegerAdditionFunction.java      | 34 ++++++++++++++++++++++
 2 files changed, 68 insertions(+)

commit 93e192f7b8ce6273c2d906edf0a19726fe7d455a
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Sat Aug 4 14:56:56 2018 +0800

    Cpp client: add PatternMultiTopicsConsumerImpl to support regex subscribe (#2219)
    
    In PR #1279 and #1298 we added regex based subscription. This is a catch up work to add `PatternMultiTopicsConsumerImpl` in cpp client.

 pulsar-client-cpp/include/pulsar/Client.h          |  16 ++
 .../include/pulsar/ConsumerConfiguration.h         |  10 +
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  |  42 ++++
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |   9 +
 pulsar-client-cpp/lib/Client.cc                    |  24 ++
 pulsar-client-cpp/lib/ClientConnection.cc          |  86 ++++++-
 pulsar-client-cpp/lib/ClientConnection.h           |  13 +-
 pulsar-client-cpp/lib/ClientImpl.cc                |  58 +++++
 pulsar-client-cpp/lib/ClientImpl.h                 |   8 +
 pulsar-client-cpp/lib/Commands.cc                  |  18 ++
 pulsar-client-cpp/lib/Commands.h                   |   1 +
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |   6 +
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |   4 +-
 pulsar-client-cpp/lib/HTTPLookupService.cc         | 112 +++++++--
 pulsar-client-cpp/lib/HTTPLookupService.h          |   9 +-
 pulsar-client-cpp/lib/LookupService.h              |  11 +
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h    |   2 +-
 .../lib/PatternMultiTopicsConsumerImpl.cc          | 235 +++++++++++++++++++
 .../lib/PatternMultiTopicsConsumerImpl.h           |  76 ++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 257 +++++++++++++++++++++
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |  67 ++++++
 21 files changed, 1032 insertions(+), 32 deletions(-)

commit 5c2e88c3d58c29e75eddc05153abee3e4d53642b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 3 19:31:22 2018 +0900

    Fixed linking of boost and boost-python for osx build (#2302)
    
    Build of wheels files in OSX is broken due to failures in finding boost after installing from brew.

 pulsar-client-cpp/python/pkg/osx/build.sh.template | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

commit ba3a36e60b611098bae7684a60e939c081c16f65
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 3 03:29:29 2018 -0700

    [website] Fix a few broken links (#2303)
    
    * [website] Fix a few broken links
    
     ### Changes
    
    - missing hyperlink in `release-notes`
    - add latest release in `release.json`
    - fixing replace script since version already has `-incubating`
    
     ### NOTE
    
    currently we have `releases.json` and `versions.json`. we should consolidate them in subsequent PRs

 site2/docs/io-overview.md                          |  2 +-
 site2/website/pages/en/index.js                    | 10 +++----
 site2/website/release-notes.md                     |  2 +-
 site2/website/releases.json                        |  3 +-
 site2/website/scripts/replace.js                   | 34 ++++++++++++----------
 .../version-2.1.0-incubating/io-overview.md        |  2 +-
 6 files changed, 28 insertions(+), 25 deletions(-)

commit 8d91dfb449ec1be54a7f2fad2e02ea2212bdb1a4
Author: penghui <codelipenghui@gmail.com>
Date:   Fri Aug 3 18:04:12 2018 +0800

     Add some metrics to prometheus. (#2299)
    
    * Add some metrics to prometheus.
    
    1.pulsar_subscription_back_log
    2.pulsar_subscription_msg_rate_redeliver
    3.pulsar_subscription_unacked_massages
    4.pulsar_subscription_blocked_on_unacked_messages
    5.pulsar_consumer_msg_rate_redeliver
    6.pulsar_consumer_unacked_massages
    7.pulsar_consumer_blocked_on_unacked_messages
    
    * Add some metrics to prometheus.
    
    1.pulsar_subscription_back_log
    2.pulsar_subscription_msg_rate_redeliver
    3.pulsar_subscription_unacked_massages
    4.pulsar_subscription_blocked_on_unacked_messages
    5.pulsar_consumer_msg_rate_redeliver
    6.pulsar_consumer_unacked_massages
    7.pulsar_consumer_blocked_on_unacked_messages

 conf/broker.conf                                   |    3 +
 docker/grafana/dashboards/topic.json               | 1160 ++++++++++++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java |    9 +
 .../org/apache/pulsar/broker/PulsarService.java    |    2 +-
 .../stats/prometheus/AggregatedConsumerStats.java  |   34 +
 .../stats/prometheus/AggregatedNamespaceStats.java |   20 +
 .../prometheus/AggregatedSubscriptionStats.java    |   41 +
 .../stats/prometheus/NamespaceStatsAggregator.java |   41 +-
 .../prometheus/PrometheusMetricsGenerator.java     |    4 +-
 .../stats/prometheus/PrometheusMetricsServlet.java |    6 +-
 .../pulsar/broker/stats/prometheus/TopicStats.java |   53 +-
 .../pulsar/broker/stats/PrometheusMetricsTest.java |    4 +-
 12 files changed, 1360 insertions(+), 17 deletions(-)

commit c2539e3414ff74aacb7e4e0bc1de13493fe5b6dd
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Aug 3 00:23:20 2018 -0700

    [release][website] Release 2.1.0 documentation (#2300)
    
    ### Changes
    
    - cut the documentation for `2.1.0` release
    - update website to display versions

 site2/crowdin.yaml                                 |    8 +-
 site2/docs/io-quickstart.md                        |    2 +-
 site2/tools/docker-build-site.sh                   |    2 +-
 site2/website/pages/en/versions.js                 |   27 +-
 site2/website/siteConfig.js                        |   13 +-
 .../version-2.1.0-incubating/adaptors-kafka.md     |  260 ++++
 .../version-2.1.0-incubating/adaptors-spark.md     |   67 +
 .../version-2.1.0-incubating/adaptors-storm.md     |  105 ++
 .../version-2.1.0-incubating/admin-api-brokers.md  |  149 ++
 .../version-2.1.0-incubating/admin-api-clusters.md |  210 +++
 .../admin-api-namespaces.md                        |  642 ++++++++
 .../admin-api-non-persistent-topics.md             |  254 +++
 .../version-2.1.0-incubating/admin-api-overview.md |   73 +
 .../admin-api-partitioned-topics.md                |  333 ++++
 .../admin-api-permissions.md                       |  115 ++
 .../admin-api-persistent-topics.md                 |  605 ++++++++
 .../version-2.1.0-incubating/admin-api-tenants.md  |   86 +
 .../administration-dashboard.md                    |   51 +
 .../version-2.1.0-incubating/administration-geo.md |  127 ++
 .../administration-load-distribution.md            |  218 +++
 .../administration-proxy.md                        |   67 +
 .../administration-stats.md                        |   64 +
 .../administration-zk-bk.md                        |  322 ++++
 .../client-libraries-cpp.md                        |  184 +++
 .../client-libraries-go.md                         |  464 ++++++
 .../client-libraries-java.md                       |  469 ++++++
 .../client-libraries-python.md                     |   95 ++
 .../client-libraries-websocket.md                  |  410 +++++
 .../concepts-architecture-overview.md              |  153 ++
 .../concepts-authentication.md                     |    9 +
 .../version-2.1.0-incubating/concepts-clients.md   |   80 +
 .../version-2.1.0-incubating/concepts-messaging.md |  308 ++++
 .../concepts-multi-tenancy.md                      |   40 +
 .../version-2.1.0-incubating/concepts-overview.md  |   32 +
 .../concepts-replication.md                        |    9 +
 .../concepts-schema-registry.md                    |   78 +
 .../concepts-tiered-storage.md                     |   18 +
 .../concepts-topic-compaction.md                   |   37 +
 .../cookbooks-compaction.md                        |  132 ++
 .../cookbooks-deduplication.md                     |  122 ++
 .../cookbooks-encryption.md                        |  170 ++
 .../cookbooks-message-queue.md                     |   95 ++
 .../cookbooks-non-persistent.md                    |   59 +
 .../cookbooks-partitioned.md                       |   76 +
 .../cookbooks-retention-expiry.md                  |  285 ++++
 .../cookbooks-tiered-storage.md                    |  136 ++
 .../version-2.1.0-incubating/deploy-aws.md         |  186 +++
 .../deploy-bare-metal-multi-cluster.md             |  409 +++++
 .../version-2.1.0-incubating/deploy-bare-metal.md  |  236 +++
 .../version-2.1.0-incubating/deploy-dcos.md        |  183 +++
 .../version-2.1.0-incubating/deploy-kubernetes.md  |  324 ++++
 .../version-2.1.0-incubating/deploy-monitoring.md  |   98 ++
 .../developing-binary-protocol.md                  |  553 +++++++
 .../version-2.1.0-incubating/developing-cpp.md     |  101 ++
 .../developing-load-manager.md                     |  215 +++
 .../version-2.1.0-incubating/developing-schema.md  |   58 +
 .../version-2.1.0-incubating/developing-tools.md   |  106 ++
 .../version-2.1.0-incubating/functions-api.md      |  714 +++++++++
 .../functions-deploying.md                         |  227 +++
 .../functions-guarantees.md                        |   42 +
 .../version-2.1.0-incubating/functions-metrics.md  |   44 +
 .../version-2.1.0-incubating/functions-overview.md |  452 ++++++
 .../functions-quickstart.md                        |  264 ++++
 .../version-2.1.0-incubating/functions-state.md    |  119 ++
 .../getting-started-clients.md                     |   42 +
 .../getting-started-concepts-and-architecture.md   |   16 +
 .../getting-started-docker.md                      |  156 ++
 .../getting-started-pulsar.md                      |   66 +
 .../getting-started-standalone.md                  |  181 +++
 .../version-2.1.0-incubating/io-aerospike.md       |   22 +
 .../version-2.1.0-incubating/io-cassandra.md       |   23 +
 .../version-2.1.0-incubating/io-connectors.md      |   19 +
 .../version-2.1.0-incubating/io-develop.md         |  196 +++
 .../version-2.1.0-incubating/io-kafka.md           |   41 +
 .../version-2.1.0-incubating/io-kinesis.md         |   37 +
 .../version-2.1.0-incubating/io-managing.md        |  162 ++
 .../version-2.1.0-incubating/io-overview.md        |   40 +
 .../version-2.1.0-incubating/io-quickstart.md      |  400 +++++
 .../version-2.1.0-incubating/io-rabbitmq.md        |   20 +
 .../version-2.1.0-incubating/io-twitter.md         |   25 +
 .../reference-cli-tools.md                         |  599 +++++++
 .../reference-configuration.md                     |  468 ++++++
 .../reference-pulsar-admin.md                      | 1640 ++++++++++++++++++++
 .../reference-terminology.md                       |  162 ++
 .../version-2.1.0-incubating/security-athenz.md    |   89 ++
 .../security-authorization.md                      |  115 ++
 .../security-encryption.md                         |  170 ++
 .../version-2.1.0-incubating/security-extending.md |  207 +++
 .../version-2.1.0-incubating/security-overview.md  |   40 +
 .../security-tls-authentication.md                 |  137 ++
 .../security-tls-transport.md                      |  197 +++
 .../version-2.1.0-incubating-sidebars.json         |  115 ++
 site2/website/versions.json                        |    3 +
 93 files changed, 16967 insertions(+), 13 deletions(-)

commit 87fa8381516c5b591e3d2888d46d47e94034a72a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 2 14:34:48 2018 -0700

    Add tls support to authenticate client to access function admin-api (#2214)
    
    ### Motivation
    
    Add TLS support on function webservice so, function-authentication in #2213 can leverage TLS authentication.
    
    ### Modifications
    
    Function server can now support TLS.
    
    ### Note
    I will add test once #2213 is merged and we can add TLS-authentication test on top of it.

 conf/functions_worker.yml                          |  13 ++
 .../apache/pulsar/io/PulsarFunctionTlsTest.java    | 230 +++++++++++++++++++++
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |   3 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  14 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |  68 +++++-
 5 files changed, 316 insertions(+), 12 deletions(-)

commit 794b0391f47e5eaa1e1a83dd1a6451ab84fa6d76
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Aug 2 14:33:39 2018 -0700

    rename args in CmdFunctions to be consistent with existing CLI arg naming conventions in pulsar (#2273)
    
    ### Motivation
    
    Currently the CLI arg naming conventions is not consistent with that of the rest of Pulsar cli args
    
    ### Modifications
    
    Rename args to use dashes to separate words instead of camel case.  Kept existing cli args for backwards compatibility purposes and hid them
    
    Will also do this for CmdSink and CmdSource when everyone is on board with is change

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 208 +++++++++++++++++----
 1 file changed, 171 insertions(+), 37 deletions(-)

commit 773045d971dd45bbb17aa3ee5677c6d1bf0621ab
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 13:49:09 2018 -0700

    [release][website] Add release notes for Release 2.1.0 (#2292)

 site2/website/release-notes.md | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)

commit 8103fd17006cd6dfad91ca94e62ea47a62efd834
Author: Jia Zhai <jiazhai@users.noreply.github.com>
Date:   Fri Aug 3 04:24:56 2018 +0800

    add System property config to run real S3 and GCS test for offloader (#2281)
    
    ### Motivation
    
    BlobStoreTestBase should support to use real AWS S3 and real GCS, if a system property was set.
    
    ### Modifications
    
    - change BlobStoreTestBase, add related System property config
    - fix error when run BlobStoreManagedLedgerOffloaderTest and BlobStoreBackedInputStreamTest
    
    ### Result
    
    Pass UT: BlobStoreBackedInputStreamTest and BlobStoreManagedLedgerOffloaderTest by using RealAWS and RealGCS

 .../pulsar/broker/offload/BlobStoreTestBase.java   | 37 ++++++++++++++++++----
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  | 23 +++++++++-----
 2 files changed, 46 insertions(+), 14 deletions(-)

commit c85dc46638cbc7822872511c776777897ce1895c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 2 12:36:04 2018 -0700

    Fix: set subscription-type based on message ordering (#2259)
    
    * Fix: set subscription-type based on message ordering
    
    * set failover sub on EFFECTIVELY_ONCE processing guarantee

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 31 +++++++++-------------
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 11 +++++---
 .../pulsar/functions/utils/FunctionConfig.java     |  1 +
 3 files changed, 21 insertions(+), 22 deletions(-)

commit d2f6dd906292078e68376d8d5b995903e58138de
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 2 12:35:48 2018 -0700

    kinesis-sink: manage msg ordering for publish callback failure (#2285)

 .../org/apache/pulsar/io/kinesis/KinesisSink.java  | 49 ++++++++++++++--------
 .../pulsar/io/kinesis/KinesisSinkConfig.java       |  1 +
 2 files changed, 33 insertions(+), 17 deletions(-)

commit 42600251c645eff288203d985cdba92dd81fe064
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 12:05:25 2018 -0700

    [website] fix anchors in functions documentation pages and add `State` documentation (#2290)
    
    ### Changes
    
    - fix anchors in functions' documentation pages
    - add `functions-state` page on documentation state api

 site2/docs/functions-api.md                        |  73 ++++++-------
 site2/docs/functions-deploying.md                  |  38 +++----
 ...tions-gaurantees.md => functions-guarantees.md} |   4 +-
 site2/docs/functions-metrics.md                    |   6 +-
 site2/docs/functions-overview.md                   |  52 ++++-----
 site2/docs/functions-quickstart.md                 |  20 ++--
 site2/docs/functions-state.md                      | 118 +++++++++++++++++++++
 site2/website/sidebars.json                        |   1 +
 8 files changed, 210 insertions(+), 102 deletions(-)

commit a4c6b5163ba654f0ea5bdaa565944c7acea1aaf1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 10:40:52 2018 -0700

    [website] cherry-pick "Rework TLS docs to separate concerns" to new website (#2286)

 site2/docs/admin-api-clusters.md              |   2 +-
 site2/docs/admin-api-permissions.md           | 109 +++++++++++++-
 site2/docs/client-libraries-go.md             |   4 +-
 site2/docs/client-libraries-java.md           |   6 +-
 site2/docs/concepts-architecture-overview.md  |   2 +-
 site2/docs/deploy-bare-metal-multi-cluster.md |   2 +-
 site2/docs/deploy-bare-metal.md               |   4 +-
 site2/docs/security-authorization.md          |  73 ++++++----
 site2/docs/security-overview.md               |   4 +-
 site2/docs/security-tls-authentication.md     | 136 ++++++++++++++++++
 site2/docs/security-tls-transport.md          | 196 ++++++++++++++++++++++++++
 site2/docs/security-tls.md                    | 142 -------------------
 site2/website/sidebars.json                   |   3 +-
 site2/website/static/examples/openssl.cnf     | 152 ++++++++++++++++++++
 14 files changed, 652 insertions(+), 183 deletions(-)

commit 651d4cdd535652be55f39e1c1d04a0d59cc3ffde
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 10:37:29 2018 -0700

    [build] pin protobuf-shaded version (#2279)
    
    ### Motivation
    
    shading kills the development experiences in IDEs like intellij.
    since protobuf-shaded is a module that is rarely changed, we should
    pin the version of `protobuf-shaded` to make IDEs work well with
    shaded depenencies
    
     ### Changes
    
    Pin `protobuf-shaded` to `2.1.0-incubating`

 pom.xml                        | 4 +++-
 pulsar-broker/pom.xml          | 2 +-
 pulsar-common/pom.xml          | 2 +-
 pulsar-functions/utils/pom.xml | 2 +-
 pulsar-io/core/pom.xml         | 2 +-
 5 files changed, 7 insertions(+), 5 deletions(-)

commit b7267e6b13b3edf114f4aab12bb498a0dc4a3be4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 10:37:05 2018 -0700

    [website] Fix website docker build (#2291)
    
    * [website] Fix website integration with crowdin
    
     ### Motivation
    
    Crowdin integration requires API key. The API key is set at CI,
    however it is not propagated into the docker image that we are
    using for building the website. So Crowdin was not able to download
    translations.
    
    ```shell
    $ crowdin --config ../crowdin.yaml upload sources --auto-update -b master
    Project identifier is empty
    Project key is empty
    Done in 0.46s.
    yarn run v1.7.0
    warning package.json: No license field
    $ crowdin --config ../crowdin.yaml download -b master
    Project identifier is empty
    Project key is empty
    Done in 0.47s.
    yarn run v1.7.0
    ```
    
     ### Changes
    
    Pass Crowdin related environment settings from host to docker.
    
    * add back missing comment

 site2/tools/docker-build-site.sh | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 25e98f4ccf478ed32c5315f29be12a03a736d865
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 10:36:34 2018 -0700

    [website] fix `developing-binary-protocol` page (#2288)
    
    ### Motiviation
    
    old website has a customized template on formating protobuf file
    into website. it is hard to achieve in the new website.
    
     ### Changes
    
    Changes to a hyperlink to point back to the protobuf definition file at github.

 site2/docs/developing-binary-protocol.md | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

commit 410c361c4893dacff07f3b476e9a48fbf3839263
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 2 03:11:44 2018 -0700

     [website] improve pulsar connector documentation (#2275)
    
    
    * [website] improve pulsar connector documentation
    
     ### Changes
    
    - Add documentation for each IO connector
    - Add a tutorial how to run a built-in connector (end-to-end)
    - How to develop a Pulsar IO connector
    
    * Addressed review comments

 site2/docs/deploy-bare-metal-multi-cluster.md |  10 +-
 site2/docs/deploy-bare-metal.md               |  11 +-
 site2/docs/deploy-dcos.md                     |   5 +
 site2/docs/deploy-kubernetes.md               |   5 +
 site2/docs/getting-started-standalone.md      |  44 +++
 site2/docs/io-aerospike.md                    |  21 ++
 site2/docs/io-cassandra.md                    |  22 ++
 site2/docs/io-connectors.md                   |  18 ++
 site2/docs/io-develop.md                      | 195 +++++++++++++
 site2/docs/io-kafka.md                        |  40 +++
 site2/docs/io-kinesis.md                      |  36 +++
 site2/docs/io-managing.md                     | 161 +++++++++++
 site2/docs/io-overview.md                     |  19 +-
 site2/docs/io-quickstart.md                   | 389 ++++++++++++++++++++++++--
 site2/docs/io-rabbitmq.md                     |  19 ++
 site2/docs/io-twitter.md                      |  24 ++
 site2/website/scripts/replace.js              |   7 +
 site2/website/sidebars.json                   |   5 +-
 18 files changed, 988 insertions(+), 43 deletions(-)

commit cb4e6f80fb9e1aa720bcadaac557199c1a1fd681
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 1 16:22:48 2018 -0700

    [website] update client references (#2284)
    
    ### Changes
    
    - add downloads for PRM and DEB packages
    - specify version for python client (via `pip install`) and go client (via `dep`)

 site2/docs/client-libraries-cpp.md    | 38 +++++++++++++++++++++++++++++++++++
 site2/docs/client-libraries-go.md     | 13 +++++++++++-
 site2/docs/client-libraries-python.md |  2 +-
 site2/docs/getting-started-clients.md |  2 +-
 site2/website/scripts/replace.js      | 32 ++++++++++++++++++++++++++---
 5 files changed, 81 insertions(+), 6 deletions(-)

commit aa80ecd8c9d3e974ecfd66cfd8c8cf0b595f6199
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Aug 2 01:11:00 2018 +0200

    Rework TLS docs to separate concerns (#2220)
    
    * Rework TLS docs to separate concerns
    
    Rework TLS documentation to split TLS transport, TLS authentication, and
    authorization into separate, though dependent guides.
    
    Also adds documentation on how to set up the proxy with all of the above.
    
    * Use TLS plugin directly in examples, rather than going through factory

 site/_data/sidebar.yaml                    |   4 +-
 site/docs/latest/security/authorization.md |  67 +++++----
 site/docs/latest/security/openssl.cnf      | 152 +++++++++++++++++++++
 site/docs/latest/security/tls-transport.md | 209 +++++++++++++++++++++++++++++
 site/docs/latest/security/tls.md           | 176 ++++++++++++------------
 5 files changed, 493 insertions(+), 115 deletions(-)

commit 29e2cc9f9ee12fc13272fbe88eeb0636297eb238
Author: Grant Wu <grantwwu@gmail.com>
Date:   Wed Aug 1 19:09:40 2018 -0400

    Destination fix (#2194)
    
    * Fix s/destination/topic/ in docs
    
    * Fix up getBundleRange route
    
    * Change lookupDestination to lookupTopic
    
    * Unhide swagger docs for /lookup/v2 routes

 .../pulsar/broker/lookup/v2/TopicLookup.java       |   1 -
 .../docs/latest/admin-api/non-persistent-topics.md |  24 ++---
 site/docs/latest/admin-api/persistent-topics.md    | 108 ++++++++++-----------
 3 files changed, 66 insertions(+), 67 deletions(-)

commit 6b701223b29e186c3bd28bfc5a1eae0a0b362109
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 1 14:25:50 2018 -0700

    [website] Move `Concepts and Architecture` page into a seperate category (#2276)
    
    ### Changes
    
    Break down the `Concepts and Architecture` page into multiple pages and move it as a separate top-level category.

 site2/docs/admin-api-clusters.md                   |   2 +-
 site2/docs/administration-proxy.md                 |   2 +-
 site2/docs/administration-zk-bk.md                 |   4 +-
 site2/docs/client-libraries-go.md                  |   6 +-
 site2/docs/client-libraries-java.md                |  12 +-
 site2/docs/client-libraries-python.md              |   2 +-
 site2/docs/concepts-architecture-overview.md       | 152 +++++
 site2/docs/concepts-authentication.md              |   8 +
 site2/docs/concepts-clients.md                     |  79 +++
 site2/docs/concepts-messaging.md                   | 307 +++++++++
 site2/docs/concepts-multi-tenancy.md               |  39 ++
 site2/docs/concepts-overview.md                    |  31 +
 site2/docs/concepts-replication.md                 |   8 +
 site2/docs/concepts-schema-registry.md             |  77 +++
 site2/docs/concepts-tiered-storage.md              |  17 +
 site2/docs/concepts-topic-compaction.md            |  36 ++
 site2/docs/cookbooks-compaction.md                 |   2 +-
 site2/docs/cookbooks-deduplication.md              |   2 +-
 site2/docs/cookbooks-message-queue.md              |   4 +-
 site2/docs/cookbooks-non-persistent.md             |   4 +-
 site2/docs/cookbooks-partitioned.md                |   4 +-
 site2/docs/cookbooks-retention-expiry.md           |   4 +-
 site2/docs/deploy-bare-metal-multi-cluster.md      |   2 +-
 site2/docs/deploy-kubernetes.md                    |   4 +-
 site2/docs/developing-schema.md                    |   2 +-
 site2/docs/functions-deploying.md                  |  10 +-
 .../getting-started-concepts-and-architecture.md   | 691 ---------------------
 site2/docs/getting-started-docker.md               |   2 +-
 site2/docs/getting-started-pulsar.md               |   2 +-
 site2/docs/getting-started-standalone.md           |   2 +-
 site2/docs/io-quickstart.md                        |   2 +-
 site2/docs/reference-configuration.md              |   2 +-
 site2/website/sidebars.json                        |  17 +-
 33 files changed, 806 insertions(+), 732 deletions(-)

commit a57057a4c8932fffd155615da9115a50b90f5cf5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 1 09:08:11 2018 -0700

    [website] fix swagger file url (#2277)
    
    ### Motivation
    
    The urls were hardcoded for local development.
    
     ### Changes
    
    Fix the urls

 site2/website/pages/en/admin-rest-api.js | 2 +-
 site2/website/siteConfig.js              | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 595ba8102ba811e301b917ce8b34b5abe36fcb62
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Aug 1 10:22:10 2018 +0200

    Namespace level policy for offload deletion lag (#2256)
    
    Add a policy parameter at the namespace level for the offload deletion
    lag, the amount of time to wait after offloading a ledger before we
    delete the ledger from bookkeeper.
    
    This namespace policy overrides the broker configured policy. Via the
    REST api this is exposed at a millisecond granularity while via the
    CLI it is exposed a minute granularity.

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  39 +++++++-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  44 +++++++++
 .../pulsar/broker/service/BrokerService.java       |  12 ++-
 .../org/apache/pulsar/client/admin/Namespaces.java |  69 +++++++++++++
 .../client/admin/internal/NamespacesImpl.java      |  35 +++++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  52 ++++++++++
 .../pulsar/common/policies/data/Policies.java      |   7 +-
 .../tests/integration/offload/TestS3Offload.java   | 109 +++++++++++++++++++++
 8 files changed, 360 insertions(+), 7 deletions(-)

commit 6b77a23564a805096b0f9b6a2f7153ac8b0c3ec3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Aug 1 01:19:37 2018 -0700

     [website] Render Pulsar REST API in ReDoc and Fix endpoint template (#2274)
    
    * Update swagger version
    
    * [website] Render Pulsar REST API in ReDoc and Fix endpoint template
    
     ### Motivation
    
    [ReDoc](https://github.com/Rebilly/ReDoc) provides a good mechanism to load OpenAPI/Swagger-generated API reference documentation.
    
     ### Changes
    
    - Use ReDoc to load the pulsar swagger definition
    - Fix the rest admin api references and `endpoint` macros
    
    * Address comments

 pom.xml                                            |    6 +-
 pulsar-broker-shaded/pom.xml                       |    1 -
 pulsar-broker/pom.xml                              |    9 +-
 .../apache/pulsar/broker/admin/v1/BrokerStats.java |    3 +-
 .../org/apache/pulsar/broker/admin/v1/Brokers.java |    2 +-
 .../apache/pulsar/broker/admin/v1/Clusters.java    |    2 +-
 .../apache/pulsar/broker/admin/v1/Functions.java   |    2 +-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |    8 +-
 .../broker/admin/v1/NonPersistentTopics.java       |    3 +-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |    2 +-
 .../apache/pulsar/broker/admin/v1/Properties.java  |    2 +-
 .../pulsar/broker/admin/v1/ResourceQuotas.java     |    2 +-
 .../apache/pulsar/broker/admin/v2/Functions.java   |    5 +-
 pulsar-discovery-service/pom.xml                   |    2 +-
 site2/docs/admin-api-brokers.md                    |   24 +-
 site2/docs/admin-api-clusters.md                   |   26 +-
 site2/docs/admin-api-namespaces.md                 |   20 +-
 site2/docs/admin-api-non-persistent-topics.md      |   25 +-
 site2/docs/admin-api-overview.md                   |    6 +-
 site2/docs/admin-api-partitioned-topics.md         |   42 +-
 site2/docs/admin-api-persistent-topics.md          |  120 +-
 site2/docs/administration-geo.md                   |    2 +-
 site2/docs/administration-zk-bk.md                 |   12 +-
 site2/docs/cookbooks-compaction.md                 |    2 +-
 site2/docs/cookbooks-retention-expiry.md           |   49 +-
 .../getting-started-concepts-and-architecture.md   |    4 +-
 site2/docs/reference-rest-api.md                   |    8 -
 site2/website/package.json                         |    5 +-
 site2/website/pages/en/admin-rest-api.js           |   26 +-
 site2/website/sidebars.json                        |    2 +-
 site2/website/siteConfig.js                        |   19 +
 site2/website/static/swagger/swagger.json          | 9038 +++++---------------
 src/gen-swagger.sh                                 |   31 +
 33 files changed, 2461 insertions(+), 7049 deletions(-)

commit b0b3cee50d48c334a69b88d0f0682e7de137b6f2
Author: Jimmy Casey <casey.jimmy@gmail.com>
Date:   Tue Jul 31 23:57:19 2018 +0100

    Fixed Spelling. (#2263)

 pulsar-functions/scripts/python/setup.py.template | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7d8ee04c0d891fb0c835a790b61876474475ee6c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 31 15:43:04 2018 -0700

     [website] Enable Translation & Localization (#2251)
    
    * [website] Enable Translation & Localization
    
    *Motivation*
    
    Docusaurus allows for easy translation functionality using [Crowdin](https://crowdin.com/).
    Documentation files written in English are uploaded to Crowdin for translation by users within a community.
    
    *Changes*
    
    - Enable the integration with Crowdin.
    - Adjust hyperlinks to include `language`.
    
    Crowdin project: https://crowdin.com/project/apache-pulsar
    
    * Add a statement about translations

 .gitignore                         |   5 +
 build/docker/Dockerfile            |   4 +
 site2/crowdin.yaml                 |  49 ++++++++++
 site2/tools/docker-build-site.sh   |   6 +-
 site2/website/languages.js         | 181 +++++++++++++++++++++++++++++++++++++
 site2/website/package.json         |   4 +-
 site2/website/pages/en/contact.js  |  22 -----
 site2/website/pages/en/download.js |  20 ++--
 site2/website/pages/en/index.js    |  89 +++++++++---------
 site2/website/pages/en/versions.js |   2 +-
 site2/website/siteConfig.js        |   1 +
 11 files changed, 306 insertions(+), 77 deletions(-)

commit c7436fecb7a567a253a84451244b6ea50cf286fe
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 31 11:33:02 2018 -0700

    handle subscription-already-exist exception on partitioned-topic for create-sub admin-api (#2269)

 .../broker/admin/impl/PersistentTopicsBase.java    | 35 +++++++++++++++++-----
 .../broker/admin/CreateSubscriptionTest.java       | 26 ++++++++++++++++
 2 files changed, 54 insertions(+), 7 deletions(-)

commit a59f9884865d7430b1bc762444207358b16618a5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 31 11:32:49 2018 -0700

    Derive source/sink arg-class name from function-class for file-url (#2258)
    
    * Derive source/sink arg-class name from functio-class for file-url archive
    
    * fix set type-arg if src/sink arg-class is not set
    
    * add unit-test

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 99 ++++++++++++++++------
 .../org/apache/pulsar/functions/utils/Utils.java   | 15 ++--
 .../functions/worker/rest/api/FunctionsImpl.java   | 42 ++++++---
 3 files changed, 113 insertions(+), 43 deletions(-)

commit f7adc3cf276d2ae15b608562cc3a22b39388be92
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 31 10:47:52 2018 -0700

    Open site links in new windows (#2267)

 site2/website/core/Footer.js      | 13 +++++++------
 site2/website/pages/en/contact.js | 22 +++++++++++-----------
 site2/website/static/js/custom.js | 18 +++++++++---------
 3 files changed, 27 insertions(+), 26 deletions(-)

commit 5ebd4f5bebe65788a0d5051fb15af81bc3c5555c
Author: Yuta Mochizuki <41100271+yumochiz@users.noreply.github.com>
Date:   Tue Jul 31 17:51:01 2018 +0900

    Fix the sample code in Metrics for Pulsar Functions document (#2270)

 site/docs/latest/functions/metrics.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d0350fc2cbec3e103cbec262a0ea61d90bf0d062
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Jul 30 18:03:52 2018 -0700

    Add Test Specific Examples (#2253)
    
    These are function examples specifically for test scenarios.

 .../functions/api/examples/ByteBufferSerDe.java    | 39 ++++++++++++++++++++
 .../api/examples/CommaWindowFunction.java          | 31 ++++++++++++++++
 .../functions/api/examples/CustomBaseObject.java   | 32 ++++++++++++++++
 .../functions/api/examples/CustomBaseSerde.java    | 42 +++++++++++++++++++++
 .../api/examples/CustomBaseToBaseFunction.java     | 34 +++++++++++++++++
 .../api/examples/CustomBaseToDerivedFunction.java  | 34 +++++++++++++++++
 .../api/examples/CustomDerivedObject.java          | 34 +++++++++++++++++
 .../functions/api/examples/CustomDerivedSerde.java | 43 ++++++++++++++++++++++
 .../api/examples/CustomDerivedToBaseFunction.java  | 34 +++++++++++++++++
 .../examples/CustomDerivedToDerivedFunction.java   | 34 +++++++++++++++++
 .../functions/api/examples/UserConfigFunction.java | 41 +++++++++++++++++++++
 .../api/examples/UserExceptionFunction.java        | 34 +++++++++++++++++
 .../api/examples/UserPublishFunction.java          | 41 +++++++++++++++++++++
 .../api/examples/WindowDurationFunction.java       | 32 ++++++++++++++++
 14 files changed, 505 insertions(+)

commit 95e54c2f9a76bdade62729a0dae9ea8393c4967e
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 30 18:02:41 2018 -0700

    Use HTTPs for downloads in new website (#2268)

 site2/website/pages/en/download.js | 21 +++++++++++++--------
 site2/website/siteConfig.js        |  8 ++++----
 2 files changed, 17 insertions(+), 12 deletions(-)

commit 5f30d048f91191366412136dff2ef9290ab6761a
Author: cckellogg <cckellogg@gmail.com>
Date:   Mon Jul 30 15:20:26 2018 -0700

    Fix pulsar:version vars in site2 docs. (#2254)

 site2/docs/deploy-bare-metal.md          | 8 ++++----
 site2/docs/getting-started-standalone.md | 6 +++---
 2 files changed, 7 insertions(+), 7 deletions(-)

commit 6a4d66cf49ea597929d3c7a21f708a82b6323e79
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 30 11:31:31 2018 -0700

    Fix: function-cli avoid arg-type check and class-loading for file url (#2257)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 9 ++++++++-
 .../java/org/apache/pulsar/functions/utils/FunctionConfig.java   | 1 -
 .../apache/pulsar/functions/utils/validation/ValidatorImpls.java | 4 +++-
 3 files changed, 11 insertions(+), 3 deletions(-)

commit 2416789520e6d06e79ad45bad95fcdc2aaf711cf
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 30 11:13:02 2018 -0700

    [website] Add contribution guide to README.md (#2255)

 site2/README.md | 190 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 190 insertions(+)

commit 9d378978026b532386d89f7af3afc6997d3bff1c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jul 27 12:11:39 2018 -0700

    [website] remove `reference-auth.md` (#2248)
    
    ### Motivation
    
    This page is a duplication of `security-extending.md`
    
     ### Changes
    
    Remove the duplicated `reference-auth.md`

 site2/docs/reference-auth.md | 206 -------------------------------------------
 site2/website/sidebars.json  |   3 +-
 2 files changed, 1 insertion(+), 208 deletions(-)

commit e2aca368910c437e4d8eefe826ffb6cf86b232da
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jul 27 19:10:05 2018 +0100

    Throw exception on non-zero command exit in integ tests (#2249)
    
    This patch replaces the boolean flag to ignore failure, and instead
    always throws an exception if a command exits with non-zero. This
    means that test code doesn't need to check the exit code for each
    invokation. For non-zero exits, the ContainerExecResult is carried as
    part of the exception, so the test can also assert on the contents of
    stdout, stderr and the exit code.

 .../pulsar/tests/integration/cli/CLITest.java      | 52 ++++++++++------------
 .../integration/containers/ChaosContainer.java     |  3 +-
 .../integration/docker/ContainerExecException.java | 32 +++++++++++++
 .../runtime/PulsarFunctionsRuntimeTest.java        | 28 ++++++------
 .../tests/integration/io/PulsarIOSinkTest.java     | 40 ++++++++++-------
 .../tests/integration/io/PulsarIOSourceTest.java   | 39 +++++++++-------
 .../tests/integration/utils/DockerUtils.java       | 29 ++++--------
 7 files changed, 129 insertions(+), 94 deletions(-)

commit fd1b4593d9f993a3450a151e8aa7d1ce671f215e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jul 27 10:31:39 2018 -0700

     [website] Add versions page (#2247)
    
    * Update release notes title
    
    * [website] Add versions page
    
     ### Motivation
    
    We need to link back to the documentation for the old versions.
    
     ### Changes
    
    Update `versions` page to include links back to old versions.
    
     ### NOTES
    
    This change doesn't include cutting a version for 2.1.0 release.
    This will be done after 2.1.0 release is cut.

 site2/website/oldversions.json          |   8 ++
 site2/website/pages/en/download.js      |  21 ++--
 site2/website/pages/en/release-notes.js |   2 +-
 site2/website/pages/en/versions.js      | 171 +++++++++++++++++---------------
 site2/website/siteConfig.js             |   2 +-
 5 files changed, 113 insertions(+), 91 deletions(-)

commit d8c171bff58659cbc801db5987508ca860827a88
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 23:47:55 2018 -0700

    [website] fix javadoc template (#2245)
    
    ### Motivation
    
    the existing site is using `{% javadoc ... %}` for templating url to the javadoc link of a given java class.
    since the new site doesn't use any templating language. we need to fix these templates.
    
     ### Changes
    
    I am extending the `inject` logic in markdown rendering, providing a similar feature as existing site.
    
    when you want to create a link to a java class, you can use `{@inject: javadoc:<class-name>:<relative-class-path-to-javadoc-location>}`.
    
    Example: if you want to link to https://pulsar.incubator.apache.org/api/admin/org/apache/pulsar/client/admin/PulsarAdmin.html, you can
    use `{@inject: javadoc:PulsarAdmin:admin/org/apache/pulsar/client/admin/PulsarAdmin}` and the rendered result will be
    
    [PulsarAdmin](https://pulsar.incubator.apache.org/api/admin/org/apache/pulsar/client/admin/PulsarAdmin.html)

 site2/docs/admin-api-brokers.md                      |  2 +-
 site2/docs/admin-api-clusters.md                     |  2 +-
 site2/docs/admin-api-namespaces.md                   |  2 +-
 site2/docs/admin-api-overview.md                     |  2 +-
 site2/docs/administration-dashboard.md               |  2 +-
 site2/docs/administration-geo.md                     |  2 +-
 site2/docs/client-libraries-java.md                  | 20 ++++++++++----------
 site2/docs/cookbooks-partitioned.md                  |  2 +-
 site2/docs/deploy-kubernetes.md                      |  2 +-
 site2/docs/functions-api.md                          |  4 ++--
 site2/docs/functions-metrics.md                      |  2 +-
 .../getting-started-concepts-and-architecture.md     |  4 ++--
 site2/website/scripts/replace.js                     | 12 ++----------
 site2/website/siteConfig.js                          | 17 ++++++++++++++++-
 14 files changed, 41 insertions(+), 34 deletions(-)

commit 4544f6eb3706e21c8953210c256eb22445a1a440
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 26 23:36:06 2018 -0700

    add function-name reference with function failure log (#2246)

 .../main/java/org/apache/pulsar/functions/runtime/RuntimeSpawner.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 831897763655dcd2fb0bdc3c6743d0ebef8b6490
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 26 22:04:34 2018 -0700

    remove redundant endpoint to get workers in cluster (#2240)
    
    ### Motivation
    
    There are two endpoints to do the same thing for worker functions which is get a list of workers
    
    ### Modifications
    
    Remove one of the redundant endpoints

 .../org/apache/pulsar/broker/admin/impl/FunctionsBase.java | 13 ++-----------
 .../java/org/apache/pulsar/io/PulsarFunctionAdminTest.java |  2 +-
 .../java/org/apache/pulsar/client/admin/Functions.java     |  2 +-
 .../apache/pulsar/client/admin/internal/FunctionsImpl.java |  4 ++--
 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java     | 12 ++++++------
 .../pulsar/functions/worker/rest/api/FunctionsImpl.java    | 13 +------------
 .../worker/rest/api/v2/FunctionApiV2Resource.java          | 14 +++-----------
 7 files changed, 16 insertions(+), 44 deletions(-)

commit 46e6ea8b5c481165ef09ff35f878bad41b9015b3
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 26 17:46:30 2018 -0700

    Fix batching time in perf producer to allow to disable batching (#2244)
    
    ### Motivation
    
    Allow to disable batching in perf producer or to configure a grouping time < 1 millis.

 .../java/org/apache/pulsar/testclient/PerformanceProducer.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

commit 5b9dc23ecf602190f11b4ee5e9074c91d08d40b5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 17:43:50 2018 -0700

    [website] add a terminology page and replace popovers with hyperlinks (#2243)
    
    ### Motivation
    
    popovers isn't friendly to documentation contribution from non-committers.
    
     ### Changes
    
    move all the popover definitions to a terminology page and replace popovers with hyperlinks

 site2/docs/admin-api-brokers.md                    |  10 +-
 site2/docs/admin-api-clusters.md                   |  11 +-
 site2/docs/admin-api-namespaces.md                 |   8 +-
 site2/docs/admin-api-overview.md                   |  10 +-
 site2/docs/admin-api-tenants.md                    |   2 +-
 site2/docs/administration-dashboard.md             |   2 +-
 site2/docs/administration-geo.md                   |   2 +-
 site2/docs/administration-zk-bk.md                 |   4 +-
 site2/docs/client-libraries-go.md                  |  26 ++--
 site2/docs/client-libraries-java.md                |  12 +-
 site2/docs/client-libraries-websocket.md           |   6 +-
 site2/docs/cookbooks-deduplication.md              |   2 +-
 site2/docs/cookbooks-message-queue.md              |   8 +-
 site2/docs/cookbooks-non-persistent.md             |   2 +-
 site2/docs/cookbooks-partitioned.md                |   2 +-
 site2/docs/cookbooks-retention-expiry.md           |   6 +-
 site2/docs/deploy-aws.md                           |   4 +-
 site2/docs/deploy-bare-metal-multi-cluster.md      |   9 +-
 site2/docs/deploy-dcos.md                          |   6 +-
 site2/docs/deploy-kubernetes.md                    |  13 +-
 site2/docs/developing-binary-protocol.md           |   2 +-
 site2/docs/functions-api.md                        |   6 +-
 site2/docs/functions-deploying.md                  |   6 +-
 site2/docs/functions-overview.md                   |   4 +-
 site2/docs/functions-quickstart.md                 |   4 +-
 .../getting-started-concepts-and-architecture.md   |  16 +-
 site2/docs/reference-terminology.md                | 161 +++++++++++++++++++++
 site2/docs/security-athenz.md                      |   6 +-
 site2/docs/security-authorization.md               |   4 +-
 site2/docs/security-tls.md                         |   4 +-
 site2/website/sidebars.json                        |   1 +
 31 files changed, 262 insertions(+), 97 deletions(-)

commit 10ec02eabe0670aab7d60d49e6d242469a8a11f0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 26 15:51:53 2018 -0700

    add stats entry for active consumer name and endpoint to get leader of functions cluster (#2234)
    
    * add stats entry for active consumer name and endpoint to get leader of functions cluster
    
    * fixing bug in stats
    
    * removing line

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 14 ++++++++++++
 .../service/persistent/PersistentSubscription.java |  7 ++++++
 .../common/policies/data/SubscriptionStats.java    |  5 ++++-
 .../pulsar/functions/worker/MembershipManager.java | 25 ++++++++++++++++++++++
 .../functions/worker/rest/api/FunctionsImpl.java   | 18 ++++++++++++++++
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  7 ++++++
 6 files changed, 75 insertions(+), 1 deletion(-)

commit 8e62a468471187036d5d6c3df825b5144c70ed85
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 15:15:01 2018 -0700

    [build] Add `yarn.lock` into gitignore file (#2242)
    
    ### Motivation
    
    We introduced docusaurus in #2206 for building the new documentation site.
    docusaurus is using [yarn](https://yarnpkg.com/en/docs/install#mac-stable) for building.
    It will leave `yarn.lock` file after builds.
    
     ### Changes
    
    Add `yarn.lock` into gitignore file

 .gitignore | 4 ++++
 1 file changed, 4 insertions(+)

commit c1c1f90902aa147b3b742679ca1169b1d35dd46e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 13:38:32 2018 -0700

    [website] fix sidebar (#2241)
    
    ### Motivation
    
    In #2237, `administration-auth` is removed. However it is not removed from sidebard. It is causing failures on building website.
    
    ```
    generate.js triggered...
    Error: Improper sidebars.json file, document with id 'administration-auth' not found. Make sure that documents with the ids specified in sidebars.json exist and that no ids are repeated.
        at _loop (/pulsar/site2/website/node_modules/docusaurus/lib/server/readCategories.js:58:17)
        at readCategories (/pulsar/site2/website/node_modules/docusaurus/lib/server/readCategories.js:34:53)
        at DocsSidebar.render (/pulsar/site2/website/node_modules/docusaurus/lib/core/DocsSidebar.js:16:26)
        at processChild (/pulsar/site2/website/node_modules/react-dom/cjs/react-dom-server.node.development.js:2204:18)
        at resolve (/pulsar/site2/website/node_modules/react-dom/cjs/react-dom-server.node.development.js:2061:5)
        at ReactDOMServerRenderer.render (/pulsar/site2/website/node_modules/react-dom/cjs/react-dom-server.node.development.js:2380:22)
        at ReactDOMServerRenderer.read (/pulsar/site2/website/node_modules/react-dom/cjs/react-dom-server.node.development.js:2354:19)
        at renderToStaticMarkup (/pulsar/site2/website/node_modules/react-dom/cjs/react-dom-server.node.development.js:2737:25)
        at renderToStaticMarkupWithDoctype (/pulsar/site2/website/node_modules/docusaurus/lib/server/renderUtils.js:16:30)
        at /pulsar/site2/website/node_modules/docusaurus/lib/server/generate.js:199:17
    ```
    
     ### Changes
    
    Remove `administration-auth` from the sidebar. Also remove codebase page, which doesn't make sense to be there because code changes are happening very frequently. The page quickly becomes out-of-dated.
    Additionally cleanup a few things in the sidebar.

 site2/docs/adaptors-kafka.md             |  2 +-
 site2/docs/client-libraries-websocket.md |  2 +-
 site2/docs/cookbooks-deduplication.md    |  2 +-
 site2/docs/developing-codebase.md        | 10 ----------
 site2/website/sidebars.json              |  3 +--
 5 files changed, 4 insertions(+), 15 deletions(-)

commit 4fcbe5e608efa5e1bbbf921578d5fe9c0430879b
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jul 26 20:19:15 2018 +0100

    Docker compose files for setting up pulsar cluster (#1134)
    
    This patch contains docker compose configuration files to quickly
    bring up a pulsar cluster locally.

 tests/compose/README.md                 |   9 ++
 tests/compose/multi/docker-compose.yml  | 167 ++++++++++++++++++++++++++++++++
 tests/compose/simple/docker-compose.yml |  86 ++++++++++++++++
 3 files changed, 262 insertions(+)

commit 56affb99cacbd50c1069f747265a3d9c36234319
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 12:11:41 2018 -0700

    Clean up sidebar menu under `Deployment` (#2185)
    
    *Motivation*
    
    There's "Deploy on Amazon Web Services" and "Pulsar on AWS" in the deployment section of the site. These are confused.
    
    *Changes*
    
    Remove sub-sections of "kubernetes" deployment from sidebard and only leave "Pulsar on Kubernetes" there.

 site/_data/sidebar.yaml | 4 ----
 1 file changed, 4 deletions(-)

commit f98e0997315171517ac5502e719bd69fcb97cbaf
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 10:31:38 2018 -0700

    [website] Fix content inconsistency between site and site2 (#2235)
    
    ### Motivation
    
    There were a few changes merged to site after site2 is merged.
    This PR is to address the content inconsistency between site and site2
    
     ### Changes
    
    Fix content inconsistency

 site2/docs/admin-api-brokers.md               | 18 +++---
 site2/docs/admin-api-clusters.md              | 14 ++--
 site2/docs/admin-api-namespaces.md            | 93 +++++++++++----------------
 site2/docs/admin-api-non-persistent-topics.md | 10 +--
 site2/docs/admin-api-persistent-topics.md     | 30 ++++-----
 site2/docs/administration-dashboard.md        | 14 +++-
 site2/docs/administration-geo.md              |  4 +-
 site2/docs/cookbooks-deduplication.md         |  8 +--
 site2/docs/cookbooks-tiered-storage.md        |  2 +-
 9 files changed, 94 insertions(+), 99 deletions(-)

commit 16327080e65fd3d5c7164f68419a7b7e8d89baef
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 09:57:29 2018 -0700

    [website] Fix security page links and includes (#2237)
    
    ### Motivation
    
    There is a duplication in the security pages. That was introduced because security pages were relocated
    when developing new site.
    
    And a couple of includes links are not working.
    
     ### Changes
    
    - Fix all the security related links and removed unneeded `docs/administration-auth.md` page
    - Expanding the includes
    
    additionally fixing some anchors when modifying the pages

 site2/docs/adaptors-kafka.md                       |   4 +-
 site2/docs/adaptors-spark.md                       |   4 +-
 site2/docs/admin-api-brokers.md                    |   4 +-
 site2/docs/admin-api-clusters.md                   |  13 +-
 site2/docs/admin-api-non-persistent-topics.md      |   4 +-
 site2/docs/admin-api-overview.md                   |  20 +-
 site2/docs/admin-api-persistent-topics.md          |   5 +-
 site2/docs/administration-auth.md                  | 434 ---------------------
 site2/docs/administration-dashboard.md             |   2 +-
 site2/docs/administration-zk-bk.md                 |   5 -
 site2/docs/client-libraries-go.md                  |   4 +-
 site2/docs/client-libraries-java.md                |  20 +-
 site2/docs/client-libraries-websocket.md           |   2 +-
 site2/docs/cookbooks-partitioned.md                |  14 +-
 site2/docs/cookbooks-tiered-storage.md             |   2 -
 site2/docs/deploy-bare-metal-multi-cluster.md      |  10 +-
 site2/docs/deploy-bare-metal.md                    |   4 +-
 site2/docs/deploy-kubernetes.md                    |   2 +-
 site2/docs/getting-started-clients.md              |   2 +-
 .../getting-started-concepts-and-architecture.md   |  99 ++---
 site2/docs/getting-started-docker.md               |   4 +-
 site2/docs/getting-started-standalone.md           |   2 +-
 site2/docs/reference-auth.md                       |   2 +-
 site2/docs/security-athenz.md                      |   8 +-
 site2/docs/security-authorization.md               |  12 +-
 site2/docs/security-tls.md                         |   3 +-
 site2/website/scripts/replace.js                   |  10 +-
 27 files changed, 105 insertions(+), 590 deletions(-)

commit 20c97a85d055f3db132e22aa68196b2e005d099f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 26 09:57:02 2018 -0700

    [build][docker] Add zip and unzip to pulsar-build docker image (#2239)
    
    ### Motivation
    
    zip and unzip are required for building pulsar project since #2192.
    
     ### Changes
    
    add `zip` and `unzip` into `pulsar-build` docker image, so the docker
    image can be used for building website

 build/docker/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2415d1310576d59143c842f9606c7ccd4574adab
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 23:02:25 2018 -0700

    Issue 2110: get-retention returns retentionSizeInMB as 0 when set to -1 (#2182)
    
    * Issue 2110: get-retention returns retentionSizeInMB as 0 when set to -1
    
     ### Motivation
    
    Fixes #2110. infinite retention is not correctly propagated.
    
     ### Changes
    
    Fix the command tool to set infinite retention correctly. Update command line description and website to reflect the fact retention size less than 1MB is treated as no retention.

 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 10 ++++--
 site/_data/cli/pulsar-admin.yaml                   |  2 +-
 .../pulsar/tests/integration/cli/CLITest.java      | 38 ++++++++++++++++++++++
 3 files changed, 46 insertions(+), 4 deletions(-)

commit 355199eae59e885aa6a05a46479e3d6618e008cf
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 23:00:29 2018 -0700

    [website] Expand the includes `admin-api-partitioned-topics.md` (#2238)

 site2/docs/admin-api-partitioned-topics.md | 348 ++++++++++++++++++++++++++++-
 site2/docs/reference-pulsar-admin.md       |  14 ++
 2 files changed, 360 insertions(+), 2 deletions(-)

commit bf56a8ab168a2ec03ce44331ff7f95d687433f4a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 25 16:11:01 2018 -0700

    Cleanup unnecessary casting and creating variables (#2199)
    
    ### Motivation
    
    I think due to recent refactoring some of the minor code which is not necessary to keep. so, cleaning up unnecessary assignments.

 .../main/java/org/apache/pulsar/functions/source/PulsarSource.java   | 5 -----
 1 file changed, 5 deletions(-)

commit 5b543ca8b87e464c725939788222974b61443f04
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Jul 25 16:09:54 2018 -0700

    Fix Spelling Mistake in class (#2232)
    
    * Fix Spelling Mistake in class
    * Update Docs

 ...NativeExclmationFunction.java => JavaNativeExclamationFunction.java} | 2 +-
 site/docs/latest/functions/api.md                                       | 2 +-
 site2/docs/functions-api.md                                             | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit cca58fc03f4f1da0d7c44b286b025bb250f13c23
Author: cckellogg <cckellogg@gmail.com>
Date:   Wed Jul 25 16:07:51 2018 -0700

    Add search bar to new site. (#2231)
    
    Add doc search to site version 2.

 site2/website/siteConfig.js | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 596d68170172937f92bcc0876eb36a42a99c0793
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 16:06:43 2018 -0700

     [integration tests] Return exit code as part of execution result of running a command in testcontainers (#2233)
    
     ### Motivation
    
    The default `ExecResult` in testcontainers doesn't include the exit code of running a command in a test container.
    
     ### Changes
    
    - Add a class `ContainerExecResult` to represent the result of executing a command in a container, including exitCode, stdout and stderr
    - Improve the existing util method in `DockerUtils` to return `ContainerExecResult`
    - Improve all the integration tests on validating exit codes before validating outputs

 .../pulsar/tests/integration/cli/CLITest.java      | 39 ++++++++++------
 .../integration/compaction/TestCompaction.java     | 51 +++++++++++----------
 .../integration/containers/ChaosContainer.java     | 19 +++-----
 .../integration/docker/ContainerExecResult.java    | 33 ++++++++++++++
 .../integration/functions/PulsarFunctionsTest.java | 10 +++--
 .../runtime/PulsarFunctionsRuntimeTest.java        | 17 ++++---
 .../tests/integration/io/PulsarIOSinkTest.java     | 25 +++++++----
 .../tests/integration/io/PulsarIOSourceTest.java   | 24 ++++++----
 .../pulsar/tests/integration/smoke/SmokeTest.java  | 17 ++++---
 .../integration/topologies/PulsarCluster.java      | 12 ++---
 .../tests/integration/utils/DockerUtils.java       | 52 ++++++++++++++++------
 11 files changed, 196 insertions(+), 103 deletions(-)

commit 2d1b100ba282f2cb983889fd80c7de1b2305a6d3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 14:21:25 2018 -0700

    Add script and README for publishing `pulsar-build` image (#2222)
    
    *Motivation*
    
    The instructions are missing for publishing `pulsar-build` image.
    
    *Changes*
    
    - Add a script for publishing `pulsar-build` image
    - Add a README for the instructions to do so

 build/docker/README.md  | 17 +++++++++++++++
 build/docker/publish.sh | 57 +++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 74 insertions(+)

commit fbc12b51fc7aff878527f6ff8de3213f8f982124
Author: cckellogg <cckellogg@gmail.com>
Date:   Wed Jul 25 14:20:37 2018 -0700

    Make doc image links work when there is a base path. (#2230)
    
    ### Motivation
    
    Make images work in the docs when there is a base path. Example can be seen here.
    
    https://cckellogg.github.io/incubator-pulsar/docs/functions-overview

 site2/docs/administration-geo.md                   |  2 +-
 site2/docs/administration-zk-bk.md                 |  2 +-
 site2/docs/cookbooks-encryption.md                 |  4 +--
 site2/docs/cookbooks-tiered-storage.md             |  2 +-
 site2/docs/deploy-bare-metal.md                    |  2 +-
 site2/docs/deploy-dcos.md                          | 38 +++++++++++-----------
 site2/docs/developing-binary-protocol.md           |  8 ++---
 site2/docs/functions-overview.md                   |  6 ++--
 .../getting-started-concepts-and-architecture.md   | 26 +++++++--------
 site2/docs/io-overview.md                          |  2 +-
 site2/docs/security-encryption.md                  |  4 +--
 11 files changed, 48 insertions(+), 48 deletions(-)

commit 9273c282f4d29b16366262d1d8d96d875076792c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 14:13:38 2018 -0700

    Fix TestS3Offload (#2227)
    
    * Fix TestS3Offload
    
     ### Motivation
    
    s3 mock service doesn't need credential. so we will fail to load credentials on s3 integration tests.
    that is expected. However there is a regression when introducing GCS support in #2151:
    https://github.com/apache/incubator-pulsar/pull/2151/files#diff-9160ffc9df7afcf42a8335f214393c6dR188
    
     ### Changes
    
    * Don't throw exception when failed to load aws credentials
    * change `log.error` to `log.warn`

 .../pulsar/broker/offload/impl/BlobStoreManagedLedgerOffloader.java    | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 55c8dc0519608a755509cdc445496140b38d98b3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 25 13:07:52 2018 -0700

    Set empty response to complete grpc txn (#2225)

 .../java/org/apache/pulsar/functions/runtime/JavaInstanceMain.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit ebb2822e611009662dca7b4a3ed1309f039a7f14
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jul 25 20:42:09 2018 +0100

    More detailed documentation to config file for TLS (#2228)
    
    This patch adds more detail for TLS options in the broker, proxy, and
    client configuration files which were previously ambiguous. It also
    adds some options which were missing, and suggests some defaults in
    the client configuration.

 conf/broker.conf | 15 ++++++++++++---
 conf/client.conf | 43 ++++++++++++++++++++++++++++++++++++++-----
 conf/proxy.conf  | 12 ++++++++++++
 3 files changed, 62 insertions(+), 8 deletions(-)

commit 4e217dde805014da49ba147889e1e7ee224f7dd0
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jul 25 20:40:34 2018 +0100

    C++ should default not allow insecure connections with TLS (#2229)
    
    If tlsAllowInsecureConnection is true, then the client doesn't
    validate the server's TLS cert, allowing for MITM attacks. This
    shouldn't be the default option.

 pulsar-client-cpp/lib/ClientConfigurationImpl.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4d631c0608fdeb605dd39822e2abc2cc57c7b37b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jul 25 11:37:48 2018 -0700

    fix bug in FunctionRuntimeManager involving not cleaning up old invalid assignments (#2223)
    
    ### Motivation
    
    Old invalid assignments of functions are not cleaned up and left over after a function is rescheduled.
    
    Getting the status of functions rely on assignments to route the get status to the correct worker running the function.  If the assignments are not correct, get status requests will be routed incorrectly.
    
    Also fixed  a test that was asserting the incorrect value.  The test would have caught this problem if it was asserting the correct value.

 .../pulsar/functions/worker/FunctionRuntimeManager.java      | 12 ++++++++++--
 .../pulsar/functions/worker/FunctionRuntimeManagerTest.java  |  4 +---
 2 files changed, 11 insertions(+), 5 deletions(-)

commit be1eaac9f4bd7a8c8804d77bd1935411f70955ab
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 11:32:54 2018 -0700

    Pull docker images before running integration tests (#2212)
    
    *Motivation*
    
    Integration tests sometime failed with "No such image:".
    
    *Changes*
    
    This change attempts to pull docker images before running integration tests.
    Hopefully it can improve the stability on running integration tests.

 tests/scripts/pre-integ-tests.sh | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 04e38c7e66a9712ca35cfccc81e5a0041e640e5f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 25 11:32:28 2018 -0700

    Rename Netty native libs to reflect shading prefix (#2192)
    
    ### Motivation
    
    When using shaded artifacts, the Netty epoll and OpenSSL libraries are not being loaded correctly and it falls back to Java based implementations.
    
    The problem is that when the Java classes are shaded, Netty expects the native library also to be prefixed with the same name.
    
    Since there is no easy way to do the renaming in Maven itself, I've added here a bash script that gets executed before the install phase.

 pulsar-broker-shaded/pom.xml                       | 24 ++++++++++
 .../pulsar-client-kafka-shaded/pom.xml             | 24 ++++++++++
 pulsar-client-shaded/pom.xml                       | 25 ++++++++++
 src/rename-netty-native-libs.sh                    | 54 ++++++++++++++++++++++
 4 files changed, 127 insertions(+)

commit d57f400121e5d0a232092b67ad7b96f734d9d6e7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 25 11:31:28 2018 -0700

    dumpContainerDirToTargetCompressed should copy files to a containerName named directory (#2189)
    
    *Motivation*
    
    dumpContainerLogToTarget copies the files to a containerName named directory.
    However dumpContainerDirToTargetCompressed doesn't.
    
    *Changes*
    
    Change `dumpContainerDirToTargetCompressed` to copy the tarball to a containerName named directory.

 .../java/org/apache/pulsar/tests/integration/utils/DockerUtils.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a1866721d9e9aa85fb913bc6a0ea165ca0f7ab3d
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Jul 25 19:53:08 2018 +0900

    Fix implementation of equals() for MessageId (#2226)

 .../pulsar/client/impl/BatchMessageIdImpl.java     |  4 +++-
 .../apache/pulsar/client/impl/MessageIdImpl.java   |  8 ++++----
 .../pulsar/client/impl/BatchMessageIdImplTest.java | 24 ++++++++++++++++++++++
 3 files changed, 31 insertions(+), 5 deletions(-)

commit 3c2e3e2e3fc3d2cce75dd3e42a77c2d7b3bc0499
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 25 02:00:16 2018 -0700

    Fixed ack message tracker cleanup for single message batches (#2224)
    
    ### Motivation
    
    Fixes #2221
    
    The issue is that we were removing a batch message id impl from the tracking set which contains the batch-wide ids.

 .../impl/UnAcknowledgedMessagesTimeoutTest.java    | 32 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 28 +++++++++----------
 2 files changed, 46 insertions(+), 14 deletions(-)

commit 2ad89f475a0feced7242ce9de2ec2234dc24d1c7
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 24 22:03:43 2018 -0700

    Make sure schema is initialized before the topic is loaded (#2203)
    
    * Make sure schema is initialized before the topic is loaded
    
    * Added overloaded method

 .../org/apache/pulsar/broker/PulsarService.java    |  2 +-
 .../broker/admin/impl/PersistentTopicsBase.java    |  4 +--
 .../pulsar/broker/service/BrokerService.java       | 41 +++++++++++++++++-----
 .../apache/pulsar/broker/service/ServerCnx.java    |  4 +--
 .../service/nonpersistent/NonPersistentTopic.java  |  8 +++--
 .../broker/service/persistent/PersistentTopic.java |  4 +++
 .../broker/service/BrokerBkEnsemblesTests.java     |  6 ++--
 .../pulsar/broker/service/BrokerServiceTest.java   | 11 +++---
 8 files changed, 56 insertions(+), 24 deletions(-)

commit de05a9b8e7bdf43d24b0f9ff6e665501d61d6d5e
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Jul 25 02:33:37 2018 +0800

    GCS offload support(3): add configs to support GCS driver (#2151)
    
    This is the third part to support Google Cloud Storage offload.
    It aims to support GCS related config in `ManagedLedgerOffloader`.  It is based on PR #2065.  Please only review the commits after [e5b1f7a](https://github.com/apache/incubator-pulsar/pull/2065/commits/e5b1f7aad4fc1f0d8f4c61b69806100a38774633).
    
    Currently it passed the real test in GCS, by test case [ManagedLedgerOffloaderTest#testGcsRealOffload](https://github.com/apache/incubator-pulsar/pull/2151/commits/eda5097f110acfd3fc5ee518dd8bc16771707c27#diff-6387a2ab4cf9c9243135b5a34c8522efR584), since lack of GCS mock docker image, will try to use read GCS to do the integration test in later PR.
    
    Master Issue: #2067

 conf/broker.conf                                   |  19 +++
 .../apache/pulsar/broker/ServiceConfiguration.java |  59 +++++++++
 .../impl/BlobStoreManagedLedgerOffloader.java      | 132 ++++++++++++++++-----
 .../impl/BlobStoreManagedLedgerOffloaderTest.java  |  50 ++++++++
 4 files changed, 229 insertions(+), 31 deletions(-)

commit 725d3af4a4bbc1f7abd0d11786a945d5b49f745e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jul 24 01:54:07 2018 -0700

    set worker port to be broker service port when running worker with broker (#2218)
    
    The port for the function worker should be same as the broker service port when the worker service is run as part of the broker

 pulsar-broker/src/main/java/org/apache/pulsar/PulsarBrokerStarter.java | 1 +
 pulsar-broker/src/main/java/org/apache/pulsar/PulsarStandalone.java    | 1 +
 2 files changed, 2 insertions(+)

commit 6b2ce6ba272384d08a410c2492525c6bc96e1b00
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Mon Jul 23 23:23:27 2018 -0700

    Cleanup Arquillian consolidate projects (#2180)
    
    ### Motivation
    
    This is the last in the series of PR's to migrate to Test Containers,  here we remove arquillian resources  and consolidate test projects.

 tests/README.md                                    |   9 +-
 tests/integration-tests-base/pom.xml               | 115 --------
 tests/integration-tests-topologies/pom.xml         |  56 ----
 ...single-cluster-3-bookie-2-broker-unstarted.yaml | 189 -------------
 .../single-cluster-3-bookie-2-broker.yaml          | 187 -------------
 tests/integration-tests-utils/pom.xml              |  77 ------
 .../pulsar/tests/LogToTargetDirStopAction.java     |  41 ---
 .../org/apache/pulsar/tests/NoopAwaitStrategy.java |  28 --
 .../apache/pulsar/tests/PulsarClusterUtils.java    | 306 ---------------------
 .../tests/PulsarLogsToTargetDirStopAction.java     |  43 ---
 .../tests/ZKJournalToTargetDirStopAction.java      |  42 ---
 .../pulsar/tests/ZooKeeperAwaitStrategy.java       |  54 ----
 .../src/main/resources/log4j2.yml                  |  41 ---
 tests/integration/compaction/pom.xml               |  54 ----
 tests/integration/pom.xml                          |  67 ++++-
 tests/integration/s3-offload/pom.xml               |  58 ----
 tests/integration/semantics/pom.xml                |  73 -----
 .../pulsar/tests/integration/utils/TestUtils.java  |  35 ---
 .../pulsar/tests/integration/cli/CLITest.java      |   6 +-
 .../integration/compaction}/TestCompaction.java    |   5 +-
 .../tests/integration}/containers/BKContainer.java |   2 +-
 .../integration}/containers/BrokerContainer.java   |   2 +-
 .../tests/integration}/containers/CSContainer.java |   2 +-
 .../containers/CassandraContainer.java             |   2 +-
 .../integration}/containers/ChaosContainer.java    |   4 +-
 .../integration}/containers/ProxyContainer.java    |   2 +-
 .../integration}/containers/PulsarContainer.java   |   5 +-
 .../tests/integration}/containers/S3Container.java |   2 +-
 .../integration}/containers/WorkerContainer.java   |   2 +-
 .../tests/integration}/containers/ZKContainer.java |   4 +-
 .../integration}/containers/package-info.java      |   2 +-
 .../integration/functions/PulsarFunctionsTest.java |   4 +-
 .../functions/PulsarFunctionsTestBase.java         |   6 +-
 .../runtime/PulsarFunctionsRuntimeTest.java        |   5 +-
 .../functions/utils/CommandGenerator.java          |   2 +-
 .../utils/UploadDownloadCommandGenerator.java      |   2 +-
 .../tests/integration/io/CassandraSinkTester.java  |  18 +-
 .../tests/integration/io/KafkaSinkTester.java      |   6 +-
 .../tests/integration/io/KafkaSourceTester.java    |   6 +-
 .../tests/integration/io/PulsarIOSinkTest.java     |   6 +-
 .../tests/integration/io/PulsarIOSourceTest.java   |   6 +-
 .../pulsar/tests/integration/io/SinkTester.java    |   0
 .../pulsar/tests/integration/io/SourceTester.java  |   0
 .../tests/integration/offload}/TestS3Offload.java  |  21 +-
 .../tests/integration/semantics/SemanticsTest.java |   2 +-
 .../pulsar/tests/integration/smoke/SmokeTest.java  |   2 +-
 .../topologies/FunctionRuntimeType.java            |   2 +-
 .../integration}/topologies/PulsarCluster.java     |  20 +-
 .../integration}/topologies/PulsarClusterSpec.java |   3 +-
 .../topologies/PulsarClusterTestBase.java          |   4 +-
 .../tests/integration/utils}/DockerUtils.java      |  23 +-
 .../src/test}/resources/kafka-zookeeper.properties |   0
 tests/pom.xml                                      |   3 -
 53 files changed, 133 insertions(+), 1523 deletions(-)

commit ce6fe8b9b757c505afafd8f209f673ec86733aa7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 23 20:18:25 2018 -0700

    Add authorization support on function apis (#2213)
    
    * Add authorization support on function apis
    
    * fix authorization enable check

 conf/functions_worker.yml                          |  8 +++
 .../pulsar/broker/admin/impl/FunctionsBase.java    | 11 ++--
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 41 ++++++++++++++-
 pulsar-functions/worker/pom.xml                    |  6 +++
 .../pulsar/functions/worker/WorkerConfig.java      | 22 +++++++-
 .../pulsar/functions/worker/WorkerService.java     | 17 +++++-
 .../functions/worker/rest/FunctionApiResource.java | 12 +++++
 .../pulsar/functions/worker/rest/WorkerServer.java | 15 ++++++
 .../functions/worker/rest/api/FunctionsImpl.java   | 61 ++++++++++++++++++++--
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 14 +++--
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 25 +++++----
 11 files changed, 203 insertions(+), 29 deletions(-)

commit 2543ccfe6d5978a32a1cab7e346569af8d504358
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Jul 24 05:25:45 2018 +0800

    Cpp client: add multiTopicsConsumer (#1996)
    
    In PR #1103, we add Multi-Topics-Consumer in java client.  This is a catch up work to add it in cpp client.

 pulsar-client-cpp/include/pulsar/Client.h          |   9 +
 pulsar-client-cpp/include/pulsar/Consumer.h        |   1 +
 pulsar-client-cpp/include/pulsar/Message.h         |   1 +
 pulsar-client-cpp/include/pulsar/MessageId.h       |  12 +
 pulsar-client-cpp/lib/Client.cc                    |  24 +
 pulsar-client-cpp/lib/ClientImpl.cc                |  36 ++
 pulsar-client-cpp/lib/ClientImpl.h                 |   3 +
 pulsar-client-cpp/lib/MessageId.cc                 |   4 +
 pulsar-client-cpp/lib/MessageIdImpl.h              |  17 +-
 pulsar-client-cpp/lib/MessageImpl.cc               |  10 +-
 pulsar-client-cpp/lib/MessageImpl.h                |  11 +
 .../lib/MultiTopicsBrokerConsumerStatsImpl.cc      | 158 +++++
 .../lib/MultiTopicsBrokerConsumerStatsImpl.h       |  92 +++
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.cc   | 644 +++++++++++++++++++++
 pulsar-client-cpp/lib/MultiTopicsConsumerImpl.h    | 133 +++++
 pulsar-client-cpp/lib/NamespaceName.cc             |   5 +
 pulsar-client-cpp/lib/NamespaceName.h              |   5 +
 pulsar-client-cpp/lib/TopicName.cc                 |   3 +
 pulsar-client-cpp/lib/TopicName.h                  |   1 +
 .../lib/UnAckedMessageTrackerDisabled.h            |   1 +
 .../lib/UnAckedMessageTrackerEnabled.cc            |  20 +
 .../lib/UnAckedMessageTrackerEnabled.h             |   1 +
 .../lib/UnAckedMessageTrackerInterface.h           |   3 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 173 +++++-
 pulsar-client-cpp/tests/NamespaceNameTest.cc       |   1 +
 25 files changed, 1364 insertions(+), 4 deletions(-)

commit b82f66e3beff62f831b688c636c671310bdedd95
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 23 11:21:43 2018 -0700

    Fix License Issue (#2208)
    
    ### Motivation
    
    Some libaries are not bundled with server distribution anymore.
    
     ### Changes
    
    Update the LICENSE.bin.txt to reflect the libraries we have in server distribution.

 distribution/server/src/assemble/LICENSE.bin.txt | 30 ++++++++++++------------
 1 file changed, 15 insertions(+), 15 deletions(-)

commit 977cc00c2b23d0952cb3f28b1cb8856a121d0768
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 23 11:21:18 2018 -0700

    Exclude helm files from Apache Rat Check. (#2209)
    
    *Motivation*
    
    Some of the helm files (e.g. helm ignore file and template file) doesn't have ASF license header.
    It is tricky to add license headers for them. so exclude them from rat check.
    
    *Changes*
    
    Exclude two files from Apache Rat Check

 pom.xml | 4 ++++
 1 file changed, 4 insertions(+)

commit 90908e9d950a747820c9ba8b4160372937062f90
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 23 00:08:15 2018 -0700

    Add option to retrieve schema for a topic from pulsar client (#2215)

 .../pulsar/broker/service/BrokerService.java       |    4 +-
 .../broker/service/PulsarChannelInitializer.java   |   25 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   51 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |    4 +-
 .../service/PersistentTopicConcurrentTest.java     |    2 +-
 .../pulsar/broker/service/PersistentTopicTest.java |    2 +-
 .../pulsar/broker/service/ServerCnxTest.java       |    2 +-
 .../broker/service/schema/ClientGetSchemaTest.java |   97 ++
 .../schema/JsonSchemaCompatibilityCheckTest.java   |   13 +-
 .../pulsar/client/api/PulsarClientException.java   |   10 +
 .../client/impl/BinaryProtoLookupService.java      |   21 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   57 +-
 .../org/apache/pulsar/client/impl/HttpClient.java  |   24 +-
 .../pulsar/client/impl/HttpLookupService.java      |   32 +-
 .../apache/pulsar/client/impl/LookupService.java   |    4 +
 .../pulsar/client/impl/PulsarClientImpl.java       |   23 +-
 .../org/apache/pulsar/common/api/Commands.java     |   60 +
 .../apache/pulsar/common/api/PulsarDecoder.java    |   29 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 1330 ++++++++++++++++++++
 .../apache/pulsar/common/schema/SchemaInfo.java    |   38 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   21 +
 21 files changed, 1800 insertions(+), 49 deletions(-)

commit 7d75fd28b9fff830697afc3505e30c80369b27f5
Author: cckellogg <cckellogg@gmail.com>
Date:   Sun Jul 22 22:02:30 2018 -0700

    Pulsar website using docusaurus (#2206)
    
    ### Motivation
    
    Improve the documentation and usability of the pulsar website. This moves the website and documentation to a new framework (https://docusaurus.io/)  which will make it easier to maintain going forward.
    
    ### Modifications
    
    A new version of the website in site2 directory. Also updates the pulsar build docker to add the new website build dependencies.
    
    ### Result
    
    A more usable website and documentation.
    
    A preview of the site can be seen here: https://cckellogg.github.io/incubator-pulsar
    *All the links and images might not work on this site since it's a test only site*

 build/docker/Dockerfile                            |     7 +
 pom.xml                                            |     1 +
 site2/.gitignore                                   |    12 +
 site2/README.md                                    |    24 +
 site2/docs/adaptors-kafka.md                       |   259 +
 site2/docs/adaptors-spark.md                       |    66 +
 site2/docs/adaptors-storm.md                       |   104 +
 site2/docs/admin-api-brokers.md                    |   158 +
 site2/docs/admin-api-clusters.md                   |   219 +
 site2/docs/admin-api-namespaces.md                 |   668 ++
 site2/docs/admin-api-non-persistent-topics.md      |   254 +
 site2/docs/admin-api-overview.md                   |    68 +
 site2/docs/admin-api-partitioned-topics.md         |    16 +
 site2/docs/admin-api-permissions.md                |     9 +
 site2/docs/admin-api-persistent-topics.md          |   627 +
 site2/docs/admin-api-tenants.md                    |    85 +
 site2/docs/administration-auth.md                  |   434 +
 site2/docs/administration-dashboard.md             |    38 +
 site2/docs/administration-geo.md                   |   124 +
 site2/docs/administration-load-distribution.md     |   217 +
 site2/docs/administration-proxy.md                 |    66 +
 site2/docs/administration-stats.md                 |    63 +
 site2/docs/administration-zk-bk.md                 |   334 +
 site2/docs/assets/binary-protocol-connect.png      |   Bin 0 -> 10230 bytes
 site2/docs/assets/binary-protocol-consumer.png     |   Bin 0 -> 32239 bytes
 site2/docs/assets/binary-protocol-producer.png     |   Bin 0 -> 33100 bytes
 site2/docs/assets/binary-protocol-topic-lookup.png |   Bin 0 -> 29050 bytes
 site2/docs/assets/broker-bookie.png                |   Bin 0 -> 136204 bytes
 site2/docs/assets/dcos_bookie_log.png              |   Bin 0 -> 668472 bytes
 site2/docs/assets/dcos_bookkeeper_in_zookeeper.png |   Bin 0 -> 264657 bytes
 site2/docs/assets/dcos_bookkeeper_run.png          |   Bin 0 -> 524502 bytes
 site2/docs/assets/dcos_bookkeeper_status.png       |   Bin 0 -> 115364 bytes
 site2/docs/assets/dcos_broker_in_zookeeper.png     |   Bin 0 -> 402876 bytes
 site2/docs/assets/dcos_broker_log.png              |   Bin 0 -> 689765 bytes
 site2/docs/assets/dcos_broker_run.png              |   Bin 0 -> 200575 bytes
 site2/docs/assets/dcos_broker_status.png           |   Bin 0 -> 144495 bytes
 site2/docs/assets/dcos_command_execute.png         |   Bin 0 -> 129195 bytes
 site2/docs/assets/dcos_command_execute2.png        |   Bin 0 -> 699589 bytes
 site2/docs/assets/dcos_consumer.png                |   Bin 0 -> 1620672 bytes
 site2/docs/assets/dcos_grafana_dashboard.png       |   Bin 0 -> 102136 bytes
 site2/docs/assets/dcos_grafana_endpoint.png        |   Bin 0 -> 277004 bytes
 site2/docs/assets/dcos_metrics.png                 |   Bin 0 -> 389670 bytes
 site2/docs/assets/dcos_monitor_status.png          |   Bin 0 -> 136506 bytes
 site2/docs/assets/dcos_producer.png                |   Bin 0 -> 1542880 bytes
 site2/docs/assets/dcos_prom_endpoint.png           |   Bin 0 -> 224700 bytes
 site2/docs/assets/dcos_prom_targets.png            |   Bin 0 -> 240218 bytes
 site2/docs/assets/dcos_uninstall.png               |   Bin 0 -> 115389 bytes
 site2/docs/assets/geo-replication.png              |   Bin 0 -> 86141 bytes
 site2/docs/assets/message-deduplication.png        |   Bin 0 -> 116703 bytes
 site2/docs/assets/partitioning.png                 |   Bin 0 -> 125576 bytes
 site2/docs/assets/pulsar-basic-setup.png           |   Bin 0 -> 125695 bytes
 site2/docs/assets/pulsar-encryption-consumer.jpg   |   Bin 0 -> 31221 bytes
 site2/docs/assets/pulsar-encryption-producer.jpg   |   Bin 0 -> 30885 bytes
 .../docs/assets/pulsar-exclusive-subscriptions.png |   Bin 0 -> 59440 bytes
 .../docs/assets/pulsar-failover-subscriptions.png  |   Bin 0 -> 64604 bytes
 site2/docs/assets/pulsar-functions-overview.png    |   Bin 0 -> 77077 bytes
 .../assets/pulsar-functions-routing-example.png    |   Bin 0 -> 62087 bytes
 site2/docs/assets/pulsar-functions-word-count.png  |   Bin 0 -> 85250 bytes
 site2/docs/assets/pulsar-io.png                    |   Bin 0 -> 37316 bytes
 .../assets/pulsar-reader-consumer-interfaces.png   |   Bin 0 -> 131839 bytes
 site2/docs/assets/pulsar-service-discovery.png     |   Bin 0 -> 65898 bytes
 site2/docs/assets/pulsar-shared-subscriptions.png  |   Bin 0 -> 68922 bytes
 site2/docs/assets/pulsar-subscription-modes.png    |   Bin 0 -> 66178 bytes
 site2/docs/assets/pulsar-system-architecture.png   |   Bin 0 -> 309560 bytes
 site2/docs/assets/pulsar-tiered-storage.png        |   Bin 0 -> 9351 bytes
 site2/docs/assets/retention-expiry.png             |   Bin 0 -> 113741 bytes
 site2/docs/client-libraries-cpp.md                 |   145 +
 site2/docs/client-libraries-go.md                  |   452 +
 site2/docs/client-libraries-java.md                |   468 +
 site2/docs/client-libraries-python.md              |    94 +
 site2/docs/client-libraries-websocket.md           |   409 +
 site2/docs/cookbooks-compaction.md                 |   131 +
 site2/docs/cookbooks-deduplication.md              |   121 +
 site2/docs/cookbooks-encryption.md                 |   169 +
 site2/docs/cookbooks-message-queue.md              |    94 +
 site2/docs/cookbooks-non-persistent.md             |    58 +
 site2/docs/cookbooks-partitioned.md                |    85 +
 site2/docs/cookbooks-retention-expiry.md           |   319 +
 site2/docs/cookbooks-tiered-storage.md             |   137 +
 site2/docs/deploy-aws.md                           |   185 +
 site2/docs/deploy-bare-metal-multi-cluster.md      |   399 +
 site2/docs/deploy-bare-metal.md                    |   226 +
 site2/docs/deploy-dcos.md                          |   177 +
 site2/docs/deploy-kubernetes.md                    |   317 +
 site2/docs/deploy-monitoring.md                    |    97 +
 site2/docs/developing-binary-protocol.md           |   557 +
 site2/docs/developing-codebase.md                  |    10 +
 site2/docs/developing-cpp.md                       |   100 +
 site2/docs/developing-load-manager.md              |   214 +
 site2/docs/developing-schema.md                    |    57 +
 site2/docs/developing-tools.md                     |   105 +
 site2/docs/functions-api.md                        |   712 ++
 site2/docs/functions-deploying.md                  |   238 +
 site2/docs/functions-gaurantees.md                 |    41 +
 site2/docs/functions-metrics.md                    |    43 +
 site2/docs/functions-overview.md                   |   451 +
 site2/docs/functions-quickstart.md                 |   263 +
 site2/docs/getting-started-clients.md              |    41 +
 .../getting-started-concepts-and-architecture.md   |   757 ++
 site2/docs/getting-started-docker.md               |   155 +
 site2/docs/getting-started-pulsar.md               |    65 +
 site2/docs/getting-started-standalone.md           |   136 +
 site2/docs/io-overview.md                          |    38 +
 site2/docs/io-quickstart.md                        |    72 +
 site2/docs/reference-auth.md                       |   206 +
 site2/docs/reference-cli-tools.md                  |   598 +
 site2/docs/reference-configuration.md              |   467 +
 site2/docs/reference-pulsar-admin.md               |  1625 +++
 site2/docs/reference-rest-api.md                   |     8 +
 site2/docs/security-athenz.md                      |    84 +
 site2/docs/security-authorization.md               |    89 +
 site2/docs/security-encryption.md                  |   169 +
 site2/docs/security-extending.md                   |   206 +
 site2/docs/security-overview.md                    |    39 +
 site2/docs/security-tls.md                         |   141 +
 site2/tools/docker-build-site.sh                   |    43 +
 site2/website/__tests__/docs.test.js               |   354 +
 site2/website/__tests__/index.test.js              |    18 +
 site2/website/core/Footer.js                       |   187 +
 site2/website/data/resources.js                    |    54 +
 site2/website/data/team.js                         |    94 +
 site2/website/jest-puppeteer.config.js             |    10 +
 site2/website/package.json                         |    24 +
 site2/website/pages/en/admin-rest-api.js           |    44 +
 site2/website/pages/en/contact.js                  |   118 +
 site2/website/pages/en/download.js                 |   177 +
 site2/website/pages/en/events.js                   |    48 +
 site2/website/pages/en/index.js                    |   195 +
 site2/website/pages/en/release-notes.js            |    35 +
 site2/website/pages/en/resources.js                |    78 +
 site2/website/pages/en/team.js                     |    96 +
 site2/website/pages/en/versions.js                 |    97 +
 site2/website/release-notes.md                     |   402 +
 site2/website/releases.json                        |     8 +
 site2/website/scripts/replace.js                   |    99 +
 site2/website/scripts/test-server.js               |    21 +
 site2/website/sidebars.json                        |    97 +
 site2/website/siteConfig.js                        |   134 +
 site2/website/static/css/code-blocks-buttons.css   |    39 +
 site2/website/static/css/custom.css                |    93 +
 .../website/static}/img/apache_incubator.png       |   Bin
 site2/website/static/img/docusaurus.svg            |     1 +
 .../website/static/img/favicon}/favicon.ico        |   Bin
 site2/website/static/img/pulsar.ico                |   Bin 0 -> 1150 bytes
 site2/website/static/img/pulsar.svg                |     1 +
 site2/website/static/js/custom.js                  |   112 +
 site2/website/static/js/pjax-api.min.js            |     4 +
 site2/website/static/swagger/swagger.json          | 11940 +++++++++++++++++++
 148 files changed, 30246 insertions(+)

commit 41792f19d051449d5598a16db833c1b992b391b2
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Fri Jul 20 15:14:18 2018 +0800

    support v2 namespace in cppclient (#2205)
    
    ### Motivation
    
    In pulsar-client-cpp, TopicName support V2 type, and contains method isV2Topic(), but NamespaceName not support it.
    We need to add support for NamespaceName to make it align with java client.
    
    ### Modifications
    
    - add v2 support in NamespaceName
    - add test case for it
    
    ### Result
    
    old behaviour not changed.

 pulsar-client-cpp/lib/NamespaceName.cc       | 30 ++++++++++++++++++++++++++++
 pulsar-client-cpp/lib/NamespaceName.h        |  5 +++++
 pulsar-client-cpp/lib/TopicName.cc           |  6 +++++-
 pulsar-client-cpp/tests/NamespaceNameTest.cc | 12 +++++++++++
 4 files changed, 52 insertions(+), 1 deletion(-)

commit 7ba5c2d4f6048762413f6cc1faab3dbf3210a08f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 19 23:48:26 2018 -0700

    support subscription-type to be passed in sink-function (#2200)
    
    * support subscription-type to be passed in sink-function
    
    * Fix: test
    
    * retain-ordering

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java      | 9 +++++++++
 .../java/org/apache/pulsar/functions/utils/FunctionConfig.java   | 2 +-
 .../main/java/org/apache/pulsar/functions/utils/SinkConfig.java  | 2 +-
 3 files changed, 11 insertions(+), 2 deletions(-)

commit 3c8d13c0546b7fed0100d499bd1841f7ce2a127e
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Fri Jul 20 13:27:05 2018 +0800

    GCS offload support(2): replace `s3client` api with `jclouds` related api  (#2065)
    
    This is the second part to support `Google Cloud Storage` offload.
    It aims to replace "s3 client" api with "jclouds" api, and make sure unit test and integration test passed.
    There will be a following change to add `Google Cloud Storage` support and related test.
    
    change:
    replace `s3client` api with `jclouds` related api in `S3ManagedLedgerOffloader`
    
    Master Issue: #2067

 conf/broker.conf                                   |   2 +-
 distribution/server/src/assemble/LICENSE.bin.txt   |  10 +-
 jclouds-shaded/pom.xml                             | 105 +++++++
 pom.xml                                            |   2 +
 pulsar-broker/pom.xml                              |   8 +-
 .../org/apache/pulsar/broker/PulsarService.java    |   6 +-
 ...pl.java => BlobStoreBackedInputStreamImpl.java} |  63 ++--
 ...mpl.java => BlobStoreBackedReadHandleImpl.java} |  49 ++-
 ...r.java => BlobStoreManagedLedgerOffloader.java} | 220 +++++++++-----
 ...st.java => BlobStoreBackedInputStreamTest.java} | 114 ++++---
 .../{S3TestBase.java => BlobStoreTestBase.java}    |  36 ++-
 .../org/apache/pulsar/broker/offload/S3Mock.java   | 334 ---------------------
 ...va => BlobStoreManagedLedgerOffloaderTest.java} | 190 ++++++------
 ...luster-2-bookie-1-broker-unstarted-with-s3.yaml |   4 +-
 14 files changed, 518 insertions(+), 625 deletions(-)

commit 6142a4c5b03f5a4e26a774fd57ab458844255786
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 19 16:08:16 2018 -0700

     Removed the `Context.ack(byte[] messageId)` and expose `Record` instead  (#2187)
    
    * Removed the `Context.ack(byte[] messageId)` and expose `Record` instead
    
    * Unified all per-message function context into record
    
    * Fixed compilation
    
    * Fixed compilation
    
    * Fix test
    
    * Fixed mocked object
    
    * Fixed test

 .../org/apache/pulsar/functions/api/Context.java   | 20 +----
 .../org/apache/pulsar/functions/api/Record.java    |  7 ++
 .../pulsar/functions/instance/ContextImpl.java     | 89 ++++++++--------------
 .../pulsar/functions/instance/JavaInstance.java    |  7 +-
 .../functions/instance/JavaInstanceRunnable.java   | 31 ++++----
 .../apache/pulsar/functions/sink/PulsarSink.java   |  2 +-
 .../pulsar/functions/source/PulsarRecord.java      |  5 ++
 .../pulsar/functions/source/PulsarSource.java      | 30 ++++++--
 .../apache/pulsar/functions/windowing/Event.java   | 15 ++--
 .../pulsar/functions/windowing/EventImpl.java      | 12 +--
 .../windowing/WindowFunctionExecutor.java          | 33 ++++----
 .../pulsar/functions/windowing/WindowManager.java  | 14 ++--
 .../pulsar/functions/instance/ContextImplTest.java |  7 +-
 .../functions/instance/JavaInstanceTest.java       | 10 +--
 .../windowing/WindowFunctionExecutorTest.java      | 31 ++++++--
 15 files changed, 164 insertions(+), 149 deletions(-)

commit 98eeaf5fb8344e021e1ff3a20c6c36759a6644bd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 19 09:50:46 2018 -0700

    function-instance lookup: retrieve function instance owner's workerId (#2201)
    
    ### Motivation
    
    for administrative purpose, we need to know worker-owner of the function-instance. so, adding workerId along with function-stats to find out owner of the instance.

 .../test/java/org/apache/pulsar/io/PulsarSinkE2ETest.java  |  7 +++++--
 .../proto/src/main/proto/InstanceCommunication.proto       |  2 ++
 .../pulsar/functions/worker/FunctionRuntimeManager.java    | 14 ++++++++++----
 3 files changed, 17 insertions(+), 6 deletions(-)

commit dc0621527c14e630f2c9bc20e3bac1560bb0690d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 19 08:51:26 2018 -0700

    attach shaded artifact while deploying to maven-repo (#2202)

 pulsar-functions/runtime-all/pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit 266834ef2bde5ed2965964f818a369200857acf1
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 19 00:30:08 2018 -0700

    unshade avro in pulsar-client-schema (#2197)
    
    ### Motivation
    
    If users want to use Avro annotations with their POJOs, currently they would have to use the our shaded version of avro because we shade avro which is not the best user experience.  Ideally they should just use the original avro annotations
    
    For example users want to something like this:
    @org.apache.avro.reflect.AvroSchema({ \type\: \long\, \logicalType\: \timestamp-millis\ })
           private long date;
    
    but since we shade avro the user would need to specify like this:
    @org.apache.pulsar.shade.org.apache.avro.reflect.AvroSchema({ \type\: \long\, \logicalType\: \timestamp-millis\ })
           private long date;
    
    ### Modifications
    Unshade avro in pulsar-client-schema

 pulsar-client-schema/pom.xml | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

commit ffe38490fb22ed539c9b542fab97bea000790844
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 18 23:22:09 2018 -0700

    Improved dashboard documentation with warning on advertised address (#2196)
    
    ### Motivation
    
    The dashboard docs should warn user of setting the proper advertised address on standalone service to make it reachable from the stats collector inside Docker.

 site/docs/latest/admin/Dashboard.md        | 14 +++++++++++++-
 site/docs/latest/getting-started/docker.md |  2 +-
 2 files changed, 14 insertions(+), 2 deletions(-)

commit e28ef1b4f7b6cb44cb424b7f121085fd5c1a87d9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 18 17:41:30 2018 -0700

    Add support to configure subscription name for sink-function (#2198)

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 15 ++++++------
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 27 +++++++++++-----------
 .../functions/instance/JavaInstanceRunnable.java   |  4 +++-
 .../proto/src/main/proto/Function.proto            |  1 +
 .../apache/pulsar/functions/utils/SinkConfig.java  |  1 +
 5 files changed, 26 insertions(+), 22 deletions(-)

commit d8c0f10ef9b7174a56204bfad21044c6a1c1278e
Author: Grant Wu <grantwwu@gmail.com>
Date:   Wed Jul 18 18:24:32 2018 -0400

    V2 doc changes (#2174)
    
    * Apparently we've forgotten to add some `v2`s to the URLs.
    
    * Fix random error
    
    * Fix s/property/tenant, delete cluster from most URLs
    
    * Delete documentation of obsolete "List namespaces within a cluster" command

 site/docs/latest/admin-api/brokers.md              |  18 ++--
 site/docs/latest/admin-api/clusters.md             |  14 +--
 site/docs/latest/admin-api/namespaces.md           | 100 ++++++++-------------
 .../docs/latest/admin-api/non-persistent-topics.md |  10 +--
 site/docs/latest/admin-api/persistent-topics.md    |  30 +++----
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |   8 +-
 site/docs/latest/clients/WebSocket.md              |  18 ++--
 site/docs/latest/cookbooks/RetentionExpiry.md      |  28 +++---
 8 files changed, 100 insertions(+), 126 deletions(-)

commit a5c339b4e84d037e6739e70f8467b6d2d2486178
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jul 18 17:58:12 2018 +0100

    Allow construction of c++ builtin auth plugins via factory (#2177)
    
    * Allow construction of c++ builtin auth plugins via factory
    
    Previously, to create the TLS or athenz plugin you had to create the
    auth plugin explicitly. Some application need to configure auth based
    on user provided parameters, so they need a factory like method to
    select the plugin.
    
    There was already a factory, but it only took a library path as first
    parameter. Thus it was impossible to use it with TLS or Athenz.
    
    This patch adds handling to the factory, that if "tls", "athenz" or
    the names of their respective java plugins are passed in, the correct
    builtin plugin will be created.
    
    * Fixed typo

 pulsar-client-cpp/include/pulsar/Authentication.h |  8 ++-
 pulsar-client-cpp/lib/Authentication.cc           | 74 ++++++++++++++++-------
 pulsar-client-cpp/lib/auth/AuthAthenz.h           |  3 +
 pulsar-client-cpp/lib/auth/AuthTls.cc             |  4 ++
 pulsar-client-cpp/lib/auth/AuthTls.h              |  3 +
 pulsar-client-cpp/python/pulsar_test.py           | 60 ++++++++++++++++++
 6 files changed, 128 insertions(+), 24 deletions(-)

commit 6ef9df9cb18b6e28c385702becf1d0de7ba294e2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jul 18 00:58:10 2018 -0700

    augmenting protoschema with info for parsing (#2181)
    
    ### Motivation
    
    Adding additional information to Protobuf schema so that the protobuf can be more easily parsed

 .../pulsar/client/impl/schema/ProtobufSchema.java  | 75 ++++++++++++++++++----
 .../pulsar/client/schema/ProtobufSchemaTest.java   | 47 +++++++++++++-
 pulsar-client-schema/src/test/proto/Test.proto     |  3 +-
 3 files changed, 112 insertions(+), 13 deletions(-)

commit b3845b27a7f6edb4a6ac953e55593a4dd3d173a2
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 17 23:13:24 2018 -0700

    Moved Record interface as part of functions api (#2184)
    
    * Moved Record interface as part of functions api
    
    * Added org.apache.pulsar.functions.api.* to PowerMock ignore

 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  | 18 ++++++------
 .../org/apache/pulsar/functions/api}/Record.java   | 13 +--------
 .../functions/instance/JavaInstanceRunnable.java   |  2 +-
 .../pulsar/functions/instance/SinkRecord.java      | 10 ++-----
 .../apache/pulsar/functions/sink/PulsarSink.java   |  2 +-
 .../pulsar/functions/source/PulsarRecord.java      |  9 ++----
 .../pulsar/functions/source/PulsarSource.java      |  2 +-
 .../source/RecordWithEncryptionContext.java        | 34 ++++++++++++++++++++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  2 +-
 .../pulsar/io/aerospike/AerospikeAbstractSink.java |  2 +-
 .../pulsar/io/aerospike/AerospikeStringSink.java   |  2 +-
 .../pulsar/io/cassandra/CassandraAbstractSink.java |  2 +-
 .../pulsar/io/cassandra/CassandraStringSink.java   |  2 +-
 pulsar-io/core/pom.xml                             | 10 ++-----
 .../java/org/apache/pulsar/io/core/PushSource.java |  2 ++
 .../main/java/org/apache/pulsar/io/core/Sink.java  |  2 ++
 .../java/org/apache/pulsar/io/core/Source.java     |  2 ++
 .../java/org/apache/pulsar/io/core/SinkTest.java   |  1 +
 .../java/org/apache/pulsar/io/core/SourceTest.java |  1 +
 .../apache/pulsar/io/kafka/KafkaAbstractSink.java  |  2 +-
 .../pulsar/io/kafka/KafkaAbstractSource.java       |  2 +-
 .../apache/pulsar/io/kafka/KafkaStringSink.java    |  2 +-
 pulsar-io/kinesis/pom.xml                          |  9 +++++-
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |  2 +-
 .../java/org/apache/pulsar/io/kinesis/Utils.java   | 14 ++++++---
 .../org/apache/pulsar/io/kinesis/UtilsTest.java    |  5 ++--
 .../apache/pulsar/io/rabbitmq/RabbitMQSource.java  |  2 +-
 .../apache/pulsar/io/twitter/TwitterFireHose.java  |  2 +-
 28 files changed, 93 insertions(+), 65 deletions(-)

commit fd7b32c6ed4d8fd814c90718c143fcb7818c11e8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 17 20:47:27 2018 -0700

    Issue 1288: Provide documentation for running BookKeeper auto-recovery (#2186)
    
    * Issue 1288: Provide documentation for running BookKeeper auto-recovery
    
     ### Motivation
    
    Fixes #1288. We mentioned auto-recovery in DCOS deployment. but we don't have any instructions to run auto-recovery in bare-mental deployment.
    
     ### Changes
    
    Update the documentation in bare-mental deployment.
    
    * Enable autorecovery for ansible

 deployment/terraform-ansible/templates/bookkeeper.conf | 2 +-
 site/docs/latest/deployment/cluster.md                 | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

commit f0024d2d95b947f1e2ac09165133ed1fde146cb9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 17 18:02:28 2018 -0700

    Issue 2121: Improve logging around "Namespace not served by this instance" (#2183)
    
    ### Motivation
    
    Fixes #2121. Improve the logging around "namespace not served by this instance" to make things clearer.
    
     ### Changes
    
    Improve the logging to say "namespace bundle for topic not served by", rahter than "namespace not served by"

 .../src/main/java/org/apache/pulsar/broker/service/BrokerService.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 3dfc217e9c2855ab4b42c81d453a3023c5dade32
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jul 17 23:08:39 2018 +0100

    Don't dirty the tree when building in CI (#2175)
    
    When we build a package, mvn inserts the sha of the commit we are
    building from into the tarball. If there have been any changes to the
    work tree, it will add the suffix "(dirty)".
    
    CI makes a couple of modifications to the worktree. It creates its own
    .repository for maven artifacts. And it create a docker debugging
    logfile.
    
    This patch adds these to .gitignore so that they won't be picked up by
    git status and won't cause the tree to be 'dirty'.

 .gitignore | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 8de127d65f0a3eb8eb9bad0194d305f24d3ed791
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 17 15:08:13 2018 -0700

    Add integration test for kafka source (#2171)
    
    
    
    *Motivation*
    
    We added integration tests for kafka & cassandra sinks. We need test coverage on kafka sources.
    
    *Changes*
    
    - Add `PulsarIOSourceTest` and `SourceTester` for testing sources
    - Implement `KafkaSourceTester` for testing kafka source

 .../tests/integration/io/KafkaSourceTester.java    | 140 +++++++++++
 .../tests/integration/io/PulsarIOSourceTest.java   | 255 +++++++++++++++++++++
 .../pulsar/tests/integration/io/SourceTester.java  |  52 +++++
 3 files changed, 447 insertions(+)

commit d6fb900f3741603290f1b93fdb86fe8c1e8d70e5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 17 15:07:44 2018 -0700

    Add integration test for kafka sink (#2170)
    
    *Motivation*
    
     #2167 introduces a sink test for cassandra. this PR adds a test for kafka sink.
    
    *Changes*
    
    - Add a KafkaSinkTester so `PulsarIOSinkTest` will test kafka sink
    - Remove customized `KafkaContainer` and `KafkaProxyContainer` and use testcontainers's KafkaContainer

 pom.xml                                            |   5 +
 .../pulsar/tests/containers/KafkaContainer.java    |  63 ----------
 .../tests/containers/KafkaProxyContainer.java      |  51 --------
 .../pulsar/tests/topologies/PulsarCluster.java     |   7 +-
 tests/integration/semantics/pom.xml                |  11 ++
 .../tests/integration/io/CassandraSinkTester.java  |  11 +-
 .../tests/integration/io/KafkaSinkTester.java      | 130 +++++++++++++++++++++
 .../tests/integration/io/PulsarIOSinkTest.java     |  13 ++-
 .../pulsar/tests/integration/io/SinkTester.java    |   6 +-
 9 files changed, 169 insertions(+), 128 deletions(-)

commit 918e38c73c241c6707ffe41bf98f6b765506dc22
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jul 17 22:55:13 2018 +0100

    Inherit I/O streams in functions process runtime (#2178)
    
    When running processes with the local runner, the output to stderr and
    stdout go nowhere. This makes it hard to debug startup issues.
    
    This patch modifies the process runtime to make the child process
    inherit the streams from the parent process, so the output will be
    visible to the runner.

 .../main/java/org/apache/pulsar/functions/runtime/ProcessRuntime.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d5536cc38a5811c8e02d580165b8e8d0861a8b4d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 17 10:41:29 2018 -0700

    Removed GPL deps on gnu crypto from aerospike connector (#2173)
    
    ### Motivation
    
    There's an optional dependency on gnu-crypto for aerospike connector. We need to remove it to avoid license issue at release.

 pulsar-io/aerospike/pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit 7b59248ad87de2c9b96f56c542ff87a87a44e0f2
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Tue Jul 17 02:42:25 2018 -0700

    Migrate compaction, s3offload to test containers (#2101)
    
    ###Motivation
    
    This is part of the migration effort from arquillian framework to testcontainers.

 .../pulsar/tests/containers/S3Container.java       |  54 +++++
 .../pulsar/tests/topologies/PulsarCluster.java     | 122 +++++++----
 .../pulsar/tests/topologies/PulsarClusterSpec.java |   5 +-
 .../tests/topologies/PulsarClusterTestBase.java    |  61 +++---
 tests/integration/compaction/pom.xml               |  17 +-
 .../pulsar/tests/integration/TestCompaction.java   | 140 ++++++-------
 .../compaction/src/test/resources/arquillian.xml   |  32 ---
 tests/integration/s3-offload/pom.xml               |  11 +-
 .../pulsar/tests/integration/TestS3Offload.java    | 228 ++++++++++-----------
 .../s3-offload/src/test/resources/arquillian.xml   |  32 ---
 10 files changed, 364 insertions(+), 338 deletions(-)

commit 5b72eecb57b56e42f1159ac228de0bc17887a869
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 16 21:51:59 2018 -0700

    Issue 2119: TopicPatternSubscription doesn't work through proxy (#2176)
    
    * Fix regex
    
    * Implement GetTopicsOfNamespace on Proxy
    
    * remove unneeded import

 .../pulsar/proxy/server/LookupProxyHandler.java    | 104 +++++++++++++++++++++
 .../pulsar/proxy/server/ProxyConnection.java       |   8 ++
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  49 ++++++++++
 3 files changed, 161 insertions(+)

commit da5b3cdf1e6fabbcadf6be4adff7c055e37674f5
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jul 17 05:51:00 2018 +0100

    If auth is badly configured in c++, close the connection (#2172)
    
    * If auth is badly configured in c++, close the connection
    
    This patch fixes a segfault where, if auth was badly configured,
    resulting in a null authentication pointer, the client would still try
    to use it to connect, and as a result, segfault.
    
    The patch adds a null check on the authentication object, and a check
    that the connection object is still valid before initialization of the
    tcp channel.
    
    * formatting errors

 pulsar-client-cpp/lib/ClientConnection.cc | 10 ++++++++++
 pulsar-client-cpp/python/pulsar_test.py   | 19 ++++++++++++++++++-
 2 files changed, 28 insertions(+), 1 deletion(-)

commit ba1ea665f0a073701df68eeff3a6b2541f6d1fa6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 16 14:00:46 2018 -0700

    Add kinesis-sink user metrics to sinkContext (#2169)

 .../org/apache/pulsar/io/kinesis/KinesisSink.java  | 34 ++++++++++++++++++----
 1 file changed, 28 insertions(+), 6 deletions(-)

commit 5f779b4ce541e1201354ca5454bebf1276e93f0b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 16 14:00:07 2018 -0700

    Add function metrics with function-stats to get metrics on-demand (#2130)

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 84 ++++++++++++++++++++--
 .../functions/instance/JavaInstanceRunnable.java   | 22 ++++--
 .../src/main/python/InstanceCommunication_pb2.py   | 44 +++++++-----
 .../instance/src/main/python/python_instance.py    |  1 +
 .../src/main/proto/InstanceCommunication.proto     |  1 +
 .../pulsar/functions/runtime/ThreadRuntime.java    | 13 +++-
 6 files changed, 133 insertions(+), 32 deletions(-)

commit 7af63740c1586cb79925fb8b5884bb8e51097d09
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jul 16 09:18:36 2018 -0700

     fixing protobuf schema shading issue (#2168)
    
    * fixing protobuf schema shading issue

 pom.xml                                            |   1 +
 pulsar-broker/pom.xml                              |   5 +
 pulsar-client-admin-shaded/pom.xml                 |  30 --
 .../pulsar-client-kafka-shaded/pom.xml             |  31 +-
 pulsar-client-schema/pom.xml                       | 349 +++++++++++++++++++++
 .../java/org/apache/pulsar/client/api/Schema.java  |  16 +
 .../client/api/SchemaSerializationException.java   |   0
 .../pulsar/client/impl/schema/AvroSchema.java      |   0
 .../pulsar/client/impl/schema/BytesSchema.java     |   0
 .../pulsar/client/impl/schema/JSONSchema.java      |   0
 .../pulsar/client/impl/schema/ProtobufSchema.java  |   0
 .../pulsar/client/impl/schema/StringSchema.java    |   0
 .../pulsar/client/schema}/AvroSchemaTest.java      |   4 +-
 .../pulsar/client/schema}/JSONSchemaTest.java      |   4 +-
 .../pulsar/client/schema}/ProtobufSchemaTest.java  |   8 +-
 .../src/test/proto/Test.proto                      |   2 +-
 pulsar-client-shaded/pom.xml                       |  32 +-
 pulsar-client/pom.xml                              |  63 +---
 .../{schemas => schema}/DefaultSchemasTest.java    |  16 +-
 19 files changed, 403 insertions(+), 158 deletions(-)

commit 555dd57a424956adf1d5a3e46b927eed8660a1e9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Jul 15 22:36:42 2018 -0700

     FunctionActioner should set the type class name for both source and sink (#2167)
    
    * FunctionActioner should set the type class name for both source and sink
    
    *Motivation*
    
    The type class names are not set correctly for builtin connectors by FunctionActioner.
    
    *Changes*
    
    Set the type class name inferred from NAR package in FunctionActioner.
    
    * Add an integration for connectors
    
    * Fix ProcessRuntimeTest

 pom.xml                                            |   6 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |   4 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   4 +-
 .../pulsar/functions/worker/FunctionActioner.java  |  17 ++
 .../tests/containers/CassandraContainer.java       |   4 +
 .../pulsar/tests/topologies/PulsarCluster.java     |   4 +-
 .../tests/topologies/PulsarClusterTestBase.java    |  21 +-
 tests/integration/semantics/pom.xml                |   5 +
 .../functions/PulsarFunctionsTestBase.java         |  30 ++-
 .../runtime/PulsarFunctionsRuntimeTest.java        |   8 -
 .../tests/integration/io/CassandraSinkTester.java  | 113 +++++++++
 .../tests/integration/io/PulsarIOSinkTest.java     | 254 +++++++++++++++++++++
 .../pulsar/tests/integration/io/SinkTester.java    |  52 +++++
 .../pulsar/tests/integration/utils/TestUtils.java  |  35 +++
 15 files changed, 521 insertions(+), 38 deletions(-)

commit b2ef2e45c44b07f3586ac46ed1bf40c785d4b178
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Jul 14 17:57:15 2018 -0700

    Add pulsar-version comment for future reference (#2163)

 pulsar-common/src/main/proto/PulsarApi.proto | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 300f736fced35f13f931f70ca90e7f1b65e75e34
Author: Karthikeyan Palanivelu <pckeyan@users.noreply.github.com>
Date:   Sat Jul 14 14:02:45 2018 -0400

    Documentation need to be updated for Admin command to apply deduplication at namespace: (#2157)
    
    bin/pulsar-admin namespaces set-deduplication \
      persistent://public/default/topic-1 \
      --enable # or just -e
    
    should be
    
    bin/pulsar-admin namespaces set-deduplication \
     public/default \
      --enable # or just -e
    
    How can we reproduce the issue
    
    Running the below statement will result in
    
    java.lang.IllegalArgumentException: Invalid namespace format. namespace: persistent://public/default/topic-1
    
    **Pulsar version**: 2.0-rc1
    
    Fixes: #2156

 site/docs/latest/cookbooks/message-deduplication.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 54dcee44101274dfb15d65817d3b1b549dec2768
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jul 14 10:59:53 2018 -0700

     bin/bookkeeper doesn't output the result to the console (#2155)
    
    ### Motivation
    
    the change from log4j to log4j2 in 2.0 changes the logging behavior for `bin/bookkeeper`. some of the results of BookieShell is not showed up in Console, and other loggings (e.g. zookeeper) are showed up.
    
    ### Modifications
    
    - add a logger for `BookieShell` and set its log level to INFO and appender to Console.
    - make other loggers parameterized. and turn them off in `bin/bookkeeper`
    
    ### Result
    
    This achieves the same behavior as in 1.2x releases.

 bin/bookkeeper   |  6 ++++--
 conf/log4j2.yaml | 24 ++++++++++++++++++++++--
 2 files changed, 26 insertions(+), 4 deletions(-)

commit 35a121b55569bb5b7f1cbe001bc8410a6f246589
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jul 14 10:57:47 2018 -0700

    Add a new docker image to include all pulsar io connectors (#2158)
    
    *Motivation*
    
    We shipped two distributions : server & io-connectors. For people who
    run pulsar in docker, we need to put all the built-in connectors into
    the docker, so that all built-in connectors are available to be used.
    
    *Solution*
    
    Introduce a `pulsar-all` image to include built-in connectors.
    
    Named it as `pulsar-all` to allow include more pluggable components later, for example, offloaders.

 distribution/io/pom.xml                            |   2 +-
 docker/pom.xml                                     |   1 +
 docker/pulsar-all/Dockerfile                       |  25 +++++
 docker/pulsar-all/pom.xml                          | 113 +++++++++++++++++++++
 pom.xml                                            |   5 +-
 .../docker-images/latest-version-image/Dockerfile  |   2 +-
 tests/docker-images/latest-version-image/pom.xml   |   2 +-
 7 files changed, 145 insertions(+), 5 deletions(-)

commit ce9b1258275931b5fb41058d911a3a4a477dac28
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 13 22:30:39 2018 -0700

    git ignore nar extension file (#2161)
    
    ### Motivation
    
    `pulsar-client-tools` module generates nar file under test-resources which should be ignored while checkin.
    
    ### Modifications
    
    add *.nar to .gitignore

 .gitignore                                            |   1 +
 .../src/test/resources/pulsar-io-cassandra.nar        | Bin 9588943 -> 0 bytes
 .../src/test/resources/pulsar-io-twitter.nar          | Bin 6537014 -> 0 bytes
 3 files changed, 1 insertion(+)

commit 0ff99e7cc62a0839477bfd19d4594dc4c7ba6663
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 13 22:23:58 2018 -0700

    Fix: trigger function rest-api (#2162)

 .../pulsar/functions/worker/rest/api/v2/FunctionApiV2Resource.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e54c58a3b143fc2a0b428230c8593662dcf92891
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 13 17:50:51 2018 -0700

    fix: conflicting jackson transitive dependency for worker (#2159)

 pulsar-functions/worker/pom.xml | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

commit 10f273aa00e03f83e77847d8d4b855cc40a6f23b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jul 13 17:03:43 2018 -0700

    Add numFunctionWorkers and externalServices to cluster spec (#2160)
    
    *Motivation*
    
    ClusterSpec is used for defining how a cluster looks like for integration
    testing. Add `numFunctionWorker` and `externalServices` in cluster spec,
    so we have a common place for setting up a cluster.
    
    *Changes*
    
    - `numFunctionWorkers`: define how many function workers to run in the cluster. When a cluster is created from the cluster spec, it will start
    the same number of worker containers.
    
    - `functionRuntimeType`: define how the worker will invoke functions,
    whether it is in process mode or thread mode.
    
    - `externalServices`: define whether there are more external services to
    run along with the cluster. for example, we need cassandra or kafka for
    testing connectors, and we need s3 mock for testing offloaders.

 .../tests/containers/CassandraContainer.java}      | 33 +++++++-----
 .../pulsar/tests/containers/KafkaContainer.java    | 63 ++++++++++++++++++++++
 .../tests/containers/KafkaProxyContainer.java      | 51 ++++++++++++++++++
 .../tests/topologies/FunctionRuntimeType.java}     | 24 ++-------
 .../pulsar/tests/topologies/PulsarCluster.java     | 47 ++++++++++------
 .../pulsar/tests/topologies/PulsarClusterSpec.java | 28 ++++++++++
 .../tests/topologies/PulsarClusterTestBase.java    |  3 +-
 .../src/main/resources/kafka-zookeeper.properties  | 36 +++++++++++++
 .../functions/PulsarFunctionsTestBase.java         | 33 ++++++++++++
 .../runtime/PulsarFunctionsRuntimeTest.java        | 23 ++++----
 10 files changed, 282 insertions(+), 59 deletions(-)

commit ea6eae7d22e94fd2a998813ec9b2af42d9035fc0
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 13 15:54:07 2018 -0700

    Added optional key in pulsar IO (#2116)
    
    * Added optional key in pulsar IO
    
    * Unified Record and RecordContext interfaces
    
    * Fixed pulsar sink
    
    * Fixed test compilation
    
    * Fixed imports
    
    * Removed wrong import

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  1 -
 .../org/apache/pulsar/client/impl/MessageImpl.java | 22 +++---
 .../pulsar/client/impl/TopicMessageImpl.java       |  7 +-
 .../pulsar/client/impl/MessageRecordImplTest.java  | 60 ----------------
 .../functions/instance/JavaInstanceRunnable.java   |  2 +-
 .../pulsar/functions/instance/SinkRecord.java      | 65 +++++++++---------
 .../apache/pulsar/functions/sink/PulsarSink.java   | 58 +++++++++-------
 .../pulsar/functions/source/PulsarRecord.java      | 65 ++++++++++++++----
 .../pulsar/functions/source/PulsarSource.java      | 29 ++++----
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 28 ++++----
 .../pulsar/io/aerospike/AerospikeAbstractSink.java | 54 ++++++++-------
 .../pulsar/io/aerospike/AerospikeStringSink.java   |  6 +-
 .../pulsar/io/cassandra/CassandraAbstractSink.java | 16 ++---
 .../pulsar/io/cassandra/CassandraStringSink.java   |  6 +-
 .../java/org/apache/pulsar/io/core/Record.java     | 66 +++++++++++++++++-
 .../org/apache/pulsar/io/core/RecordContext.java   | 68 -------------------
 .../java/org/apache/pulsar/io/core/SimpleSink.java | 47 -------------
 .../main/java/org/apache/pulsar/io/core/Sink.java  | 10 +--
 .../java/org/apache/pulsar/io/core/SinkTest.java   |  2 +-
 .../apache/pulsar/io/kafka/KafkaAbstractSink.java  | 50 +++++++-------
 .../pulsar/io/kafka/KafkaAbstractSource.java       | 28 +++++---
 .../apache/pulsar/io/kafka/KafkaStringSink.java    |  5 +-
 .../apache/pulsar/io/kafka/KafkaStringSource.java  |  2 +-
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  | 79 +++++++++++-----------
 .../java/org/apache/pulsar/io/kinesis/Utils.java   | 53 ++++++++-------
 .../org/apache/pulsar/io/kinesis/UtilsTest.java    | 46 ++++++++-----
 .../apache/pulsar/io/rabbitmq/RabbitMQSource.java  | 25 +++----
 .../apache/pulsar/io/twitter/TwitterFireHose.java  |  7 ++
 28 files changed, 434 insertions(+), 473 deletions(-)

commit 3b8faea91e3dcd264545b0a36c58ea28d4a8bbba
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 13 15:24:37 2018 -0700

    Fix: file-url sink/source submission with cli (#2150)

 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  23 +++++++++++++++------
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  21 ++++++++++++++-----
 .../src/test/resources/pulsar-io-cassandra.nar     | Bin 0 -> 9588943 bytes
 .../src/test/resources/pulsar-io-twitter.nar       | Bin 0 -> 6537014 bytes
 .../apache/pulsar/functions/utils/SinkConfig.java  |   1 +
 .../pulsar/functions/utils/SourceConfig.java       |   1 +
 6 files changed, 35 insertions(+), 11 deletions(-)

commit 26a70db68fe8a575491da87ad618137782ec509e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 13 07:02:48 2018 -0700

    Fix: function load correct type-class of connector (#2147)

 .../apache/pulsar/functions/worker/FunctionActioner.java   | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

commit 123524d0b59e00881c56016ba54709d4a4e74ab4
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 13 06:55:32 2018 -0700

    Avoid closing cursor when consumers are disconnected (#2149)

 .../service/persistent/PersistentSubscription.java | 28 ++++------------------
 .../broker/service/persistent/PersistentTopic.java | 22 ++++++++++-------
 .../client/impl/SequenceIdWithErrorTest.java       |  2 +-
 3 files changed, 18 insertions(+), 34 deletions(-)

commit 06e26b2663f19421576f235642c1698ab11f7fcf
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 13 06:55:18 2018 -0700

    Fix schema initialization (#2148)
    
    * Fixed race condition in topic schema initialization
    
    * Fixed test name
    
    * Made future map cleanup deterministic

 .../service/schema/BookkeeperSchemaStorage.java    | 114 +++++++++++++--------
 .../schema/PartitionedTopicsSchemaTest.java        | 107 +++++++++++++++++++
 .../broker/service/schema/SchemaServiceTest.java   |   5 +
 3 files changed, 185 insertions(+), 41 deletions(-)

commit 1e2b5d769e988393d0b3de1438a03c730b016d63
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Jul 13 14:40:41 2018 +0900

    Add std=c99 to CMAKE_C_FLAGS to avoid compile error with gcc-4.8 (#2086)

 pulsar-client-cpp/examples/CMakeLists.txt | 2 ++
 1 file changed, 2 insertions(+)

commit e9d67bce84ec880fbea830ec5d8172ba7aedc1c9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 12 18:24:13 2018 -0700

    Function: REST and CLI to get list of workers in cluster (#2112)

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  22 ++-
 .../apache/pulsar/io/PulsarFunctionAdminTest.java  | 220 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Functions.java  |   8 +
 .../client/admin/internal/FunctionsImpl.java       |  10 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  13 ++
 .../apache/pulsar/functions/worker/WorkerInfo.java |  52 +++++
 pulsar-functions/worker/pom.xml                    |   6 +
 .../functions/worker/FunctionRuntimeManager.java   |   6 +-
 .../pulsar/functions/worker/MembershipManager.java |  30 ---
 .../pulsar/functions/worker/WorkerConfig.java      |   2 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |  13 +-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  23 ++-
 .../functions/worker/MembershipManagerTest.java    |  18 +-
 .../functions/worker/SchedulerManagerTest.java     |  73 +++----
 14 files changed, 408 insertions(+), 88 deletions(-)

commit 2a6d1950954e9d0b1ec33c7fc738ebbdab0a4b9e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 12 16:59:00 2018 -0700

    add flatbuffer option to serialize kinesis-message in KinesisSink (#2108)
    
    * add flatbuffer option to serialize kinesis-message
    
    * add flatbuffer license
    
    * fix license

 distribution/server/src/assemble/LICENSE.bin.txt   |   2 +
 pom.xml                                            |  12 ++
 .../pulsar/common/api/EncryptionContext.java       |   1 -
 pulsar-io/kinesis/pom.xml                          |   6 +
 .../kinesis/src/main/fb/KinesisMessageApi.fbs      |  59 +++++++
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |  10 +-
 .../pulsar/io/kinesis/KinesisSinkConfig.java       |   6 +-
 .../java/org/apache/pulsar/io/kinesis/Utils.java   | 129 ++++++++++++++--
 .../pulsar/io/kinesis/fbs/CompressionType.java     |  15 ++
 .../pulsar/io/kinesis/fbs/EncryptionCtx.java       |  68 +++++++++
 .../pulsar/io/kinesis/fbs/EncryptionKey.java       |  52 +++++++
 .../org/apache/pulsar/io/kinesis/fbs/KeyValue.java |  41 +++++
 .../org/apache/pulsar/io/kinesis/fbs/Message.java  |  53 +++++++
 .../org/apache/pulsar/io/kinesis/UtilsTest.java    | 170 ++++++++++++++++-----
 14 files changed, 572 insertions(+), 52 deletions(-)

commit e071ec1803039f31e4a291b7673ed181587455f0
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jul 12 16:52:49 2018 -0700

    Use container name in logs (#2139)
    
    * Use container name in logs
    
    * Add code comments

 .../java/org/apache/pulsar/tests/DockerUtils.java  | 26 ++++++++++++++--------
 1 file changed, 17 insertions(+), 9 deletions(-)

commit 873658239329e0202eb97e871ab624b0ca2841af
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jul 13 00:28:22 2018 +0100

    Add authentication to admin proxy (#2056)
    
    It turns out that the admin rest api proxy wasn't doing authentication
    at all, so if you can connect, you have access to the api at the same
    level as the configured user of the proxy, which could well be
    superuser access.
    
    Master Issue: #1991

 .../pulsar/proxy/server/AdminProxyHandler.java     |  10 ++
 .../pulsar/proxy/server/ProxyServiceStarter.java   |   2 +-
 .../org/apache/pulsar/proxy/server/WebServer.java  |  19 ++-
 .../proxy/server/AuthedAdminProxyHandlerTest.java  | 171 ++++++++++---------
 .../SuperUserAuthedAdminProxyHandlerTest.java      | 183 +++++++++++++++++++++
 .../server/UnauthedAdminProxyHandlerTest.java      |   5 +-
 .../authentication/tls-admin-proxy/admin.cert.pem  |  26 +++
 .../tls-admin-proxy/admin.key-pk8.pem              |  28 ++++
 .../authentication/tls-admin-proxy/broker.cert.pem |  27 +++
 .../tls-admin-proxy/broker.key-pk8.pem             |  28 ++++
 .../authentication/tls-admin-proxy/ca.cert.pem     |  29 ++++
 .../authentication/tls-admin-proxy/proxy.cert.pem  |  26 +++
 .../tls-admin-proxy/proxy.key-pk8.pem              |  28 ++++
 .../tls-admin-proxy/randouser.cert.pem             |  19 +++
 .../tls-admin-proxy/randouser.key-pk8.pem          |  28 ++++
 .../tls-admin-proxy/superproxy.cert.pem            |  26 +++
 .../tls-admin-proxy/superproxy.key-pk8.pem         |  28 ++++
 .../authentication/tls-admin-proxy/user1.cert.pem  |  26 +++
 .../tls-admin-proxy/user1.key-pk8.pem              |  28 ++++
 .../client-keys/randouser.cert.pem                 |  19 +++
 .../client-keys/randouser.key-pk8.pem              |  28 ++++
 .../client-keys/randouser.key.pem                  |  28 ++++
 .../client-keys/user1.cert.pem                     |  26 +++
 .../client-keys/user1.csr.pem                      |  15 ++
 .../client-keys/user1.key-pk8.pem                  |  28 ++++
 .../client-keys/user1.key.pem                      |  27 +++
 tests/certificate-authority/index.txt              |   1 +
 tests/certificate-authority/index.txt.old          |   1 +
 tests/certificate-authority/newcerts/1005.pem      |  26 +++
 tests/certificate-authority/serial                 |   2 +-
 tests/certificate-authority/serial.old             |   2 +-
 31 files changed, 853 insertions(+), 87 deletions(-)

commit 2f47a104829a86e0bd6e36cefc9c2cc61625dae3
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jul 13 00:26:05 2018 +0100

    Slow consumer prevents offloaded ledger cleanup (#2126)
    
    This change fixes a bug whereby if a managed ledger had a slow
    consumer, and some ledgers were offloaded, the offloaded ledgers would
    not have their bookkeeper ledgers cleaned up if there was still a
    consumer whose cursor was before or in that ledger.

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 13 +++--
 .../mledger/impl/OffloadLedgerDeleteTest.java      | 55 ++++++++++++++++++++++
 2 files changed, 63 insertions(+), 5 deletions(-)

commit d43bf87f9f3a31cb7f4c06ec08b643da53ac20f7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 12 16:00:52 2018 -0700

    add list-connector rest api at workers (#2146)

 .../pulsar/functions/worker/rest/api/v2/FunctionApiV2Resource.java | 7 +++++++
 1 file changed, 7 insertions(+)

commit 14fc5d956c0044743984e839cce0acdd9d7f5336
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 12 14:54:49 2018 -0700

    Schedule task to update function stats separately (#2128)
    
    keep previous stats sample
    
    configurable update metrics task
    
    fix test

 conf/functions_worker.yml                          |  1 +
 .../pulsar/functions/instance/ContextImpl.java     | 19 +++++++--
 .../pulsar/functions/instance/FunctionStats.java   | 25 +++++++++++-
 .../pulsar/functions/instance/JavaInstance.java    |  8 ++++
 .../functions/instance/JavaInstanceRunnable.java   | 45 +++++++++++++++------
 .../src/main/python/InstanceCommunication_pb2.py   | 24 +++++++++--
 .../main/python/InstanceCommunication_pb2_grpc.py  | 34 ++++++++++++++++
 .../instance/src/main/python/contextimpl.py        | 23 ++++++++---
 .../instance/src/main/python/python_instance.py    | 46 +++++++++++++++++-----
 .../instance/src/main/python/server.py             |  9 +++++
 .../src/main/proto/InstanceCommunication.proto     |  2 +
 .../pulsar/functions/runtime/JavaInstanceMain.java | 30 ++++++++++++++
 .../pulsar/functions/runtime/ProcessRuntime.java   | 44 +++++++++++++++++++++
 .../apache/pulsar/functions/runtime/Runtime.java   |  4 ++
 .../pulsar/functions/runtime/ThreadRuntime.java    | 12 ++++++
 .../functions/worker/FunctionRuntimeManager.java   | 18 +++++++++
 .../functions/worker/FunctionsStatsGenerator.java  |  4 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  3 +-
 .../pulsar/functions/worker/WorkerService.java     | 18 +++++++++
 .../worker/FunctionStatsGeneratorTest.java         |  3 +-
 20 files changed, 336 insertions(+), 36 deletions(-)

commit 2f38b8965521a3169601430b4ad922f16e62e678
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jul 12 14:26:52 2018 -0700

    Minor bug-fixes to examples (#2145)
    
    * Minor bug-fixes to examples
    
    * method overloading in python is via default arguments
    
    * Bring implementation up to date with interface

 pulsar-client-cpp/python/pulsar/functions/context.py             | 9 ++-------
 pulsar-functions/instance/src/main/python/contextimpl.py         | 5 +----
 pulsar-functions/python-examples/config_based_append_function.py | 4 ++--
 pulsar-functions/python-examples/publish_function.py             | 2 +-
 4 files changed, 6 insertions(+), 14 deletions(-)

commit ede2108d1a7a2f73288a768c5c673c0b53b820a0
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 12 12:23:55 2018 -0700

    Release resources for ZLib inflater/deflater when not used (#2111)

 .../apache/pulsar/common/compression/CompressionCodecZLib.java | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 387f8846aa30fb449c53ef779ca2d330168a6f70
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jul 13 01:37:59 2018 +0800

    Added more Java and Python examples and made the examples match across languages (#2137)
    
    ### Motivation
    
    In order to enhance user experience when trying out functions, this pr does two things
    1) Made examples match between java/python. This way users will have a easier time switching between languages of two functions doing identical things but written in different languages
    2) Added more examples to get more coverage on the features
    3) Renamed files to better reflect what the function actually does

 ...unction.java => ConfigBasedAppendFunction.java} | 20 ++++-----
 .../api/examples/CustomObjectFunction.java         | 34 ++++++++++++++
 .../api/examples/ExclamationFunction.java          |  4 ++
 .../functions/api/examples/LoggingFunction.java    | 18 +++-----
 .../functions/api/examples/PublishFunction.java    |  8 +++-
 .../functions/api/examples/UserMetricFunction.java |  6 ++-
 .../functions/api/examples/VoidFunction.java       |  3 ++
 .../functions/api/examples/WindowFunction.java     | 13 ++----
 ...CounterFunction.java => WordCountFunction.java} |  9 +++-
 .../functions/api/examples/serde/CustomObject.java | 33 ++++++++++++++
 .../api/examples/serde/CustomObjectSerde.java      | 41 +++++++++++++++++
 .../example-stateful-function-config.yaml          |  2 +-
 .../config_based_append_function.py                | 34 ++++++++++++++
 .../python-examples/custom_object_function.py      | 52 ++++++++++++++++++++++
 .../{logfunction.py => exclamation_function.py}    |  5 ++-
 .../python-examples/logging_function.py            | 34 ++++++++++++++
 ...clamation.py => native_exclamation_function.py} |  0
 .../python-examples/publish_function.py            | 35 +++++++++++++++
 .../{exclamation.py => void_function.py}           |  5 ++-
 .../functions/PulsarFunctionsTestBase.java         |  4 +-
 20 files changed, 315 insertions(+), 45 deletions(-)

commit 960dc3a6cccf3f4a16bcfaaa4fa22342f718152b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 12 10:36:02 2018 -0700

    Fixed RPM/Deb package to include "apache" and "incubating" in name (#2129)
    
    * Fixed RPM/Deb package to include "apache" and "incubating" in name
    
    * Fixed deb name and version

 pulsar-client-cpp/pkg/deb/build-deb.sh             | 17 +++++++++--------
 pulsar-client-cpp/pkg/rpm/SPECS/pulsar-client.spec |  7 ++++---
 2 files changed, 13 insertions(+), 11 deletions(-)

commit 48431543729fc4f382637c968976d0d164d5427b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 12 10:35:45 2018 -0700

    Fixed mem leak when receiving unrecoverable fencing errors in managed ledger (#2138)

 .../main/java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java  | 1 -
 .../src/main/java/org/apache/bookkeeper/mledger/impl/OpAddEntry.java     | 1 +
 2 files changed, 1 insertion(+), 1 deletion(-)

commit cc8ec3d962bac1d06f1fad4cac9eca5ea64f733e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 12 09:08:59 2018 -0700

    Issue 1433: Expose batch flushAsync() and flush() methods in Producer (#2103)
    
    * expose flush
    
    * Issue 1433: Expose batch flushAsync() and flush() methods in Producer
    
    *Motivation*
    
    Currently when you're using batches server will wait until timeout to send messages.
    
    To archive the maximum theoretical performance I suggest to expose flushAsync method (and flush() for completeness) of the Producer class.
    
    That will force publisher to flush all batched messages for faster delivery (faster than waiting until batch timeout).
    
    *Changes*
    
    - Introduce `flush` and `flushAsync` in Producer interface
    - rename existing `flush` method to `triggerFlush`
    - flush is waiting for the completion of last write
    
    * Add a test case for batch disabled
    
    * Addressed review comments
    
    * Fix javadoc

 .../client/api/SimpleProducerConsumerTest.java     | 72 ++++++++++++++++++++++
 .../org/apache/pulsar/client/api/Producer.java     | 18 ++++++
 .../client/impl/PartitionedProducerImpl.java       | 12 +++-
 .../apache/pulsar/client/impl/ProducerBase.java    | 23 ++++++-
 .../apache/pulsar/client/impl/ProducerImpl.java    | 19 +++++-
 5 files changed, 138 insertions(+), 6 deletions(-)

commit bf906d12b9ca42f25250a1cd35e8852b3f7ae16b
Author: Yuta Mochizuki <41100271+yumochiz@users.noreply.github.com>
Date:   Fri Jul 13 01:06:51 2018 +0900

    Fix a command in Pulsar Function overview Document (#2143)

 site/docs/latest/functions/overview.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 15e4d3d1e03b313cc0a44744b6fc3d938af0b948
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Thu Jul 12 17:03:49 2018 +0900

    fix link in binary protocol (#2131)

 site/docs/latest/getting-started/ConceptsAndArchitecture.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 86310674a6d2b8c4e5655c5658117d1b94b036dc
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 11 23:10:36 2018 -0700

    Temporarely disable SequenceIdWithErrorTest (#2140)

 .../java/org/apache/pulsar/client/impl/SequenceIdWithErrorTest.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a4e9399c51ac616ebff833db178d261a1a17165b
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Jul 11 21:42:08 2018 -0700

    Add pulsar python to gitignore (#2123)

 .gitignore | 1 +
 1 file changed, 1 insertion(+)

commit 21472010db047398612ba94824ac56434f1ac38a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 11 17:12:14 2018 -0700

    Submit and run locally builtin connectors (#2114)
    
    * Submit and run locally builtin connectors
    
    * Fixed test class constructor
    
    * Fixed null check
    
    * Fixed function package update
    
    * Fixed sourceClassName when submiting custom archive

 bin/pulsar                                         |   2 +-
 bin/pulsar-admin                                   |   8 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  19 +++
 .../client/admin/internal/FunctionsImpl.java       |  25 +++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 101 ++++++++++++++--
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  99 ++++++++++++++--
 .../proto/src/main/proto/Function.proto            |   8 ++
 .../org/apache/pulsar/functions/utils/Utils.java   |   5 +-
 .../functions/utils/validation/ValidatorImpls.java |  12 +-
 .../pulsar/functions/worker/FunctionActioner.java  | 128 +++++++++++++++++----
 .../functions/worker/FunctionRuntimeManager.java   |   9 +-
 .../pulsar/functions/worker/WorkerService.java     |   6 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |  85 +++++++++++---
 .../functions/worker/FunctionActionerTest.java     |   8 +-
 .../worker/FunctionRuntimeManagerTest.java         |   9 +-
 .../functions/worker/MembershipManagerTest.java    |   9 +-
 16 files changed, 448 insertions(+), 85 deletions(-)

commit 133331c15587400b8d7846ff1ca84cf3a8802565
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Jul 11 16:58:49 2018 -0700

    Extract out common code from standalone and build Embedded Pulsar (#2080)
    
    * Extract out common code form standalone
    
    * Add license Header
    
    * Remove lombok generator
    
    * Add Embedded Pulsar driver
    
    * Fix code review comments
    
    * Fix class Name
    
    * Implement AutoCloseable

 .../java/org/apache/pulsar/PulsarStandalone.java   | 388 +++++++++++++++++++++
 .../org/apache/pulsar/PulsarStandaloneBuilder.java | 124 +++++++
 .../org/apache/pulsar/PulsarStandaloneStarter.java | 190 +---------
 3 files changed, 521 insertions(+), 181 deletions(-)

commit 76fb8dcdf27e43dbd4f06f68cf823eedcb73e1cf
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 11 10:14:51 2018 -0700

    Fix a few links in security pages (#2134)
    
    *Motivation*
    
    A few links use `../..` for locating pages in same `security` category, which are wrong.
    
    *Solution*
    
    Change `../..` to `..`

 site/docs/latest/security/authorization.md | 6 +++---
 site/docs/latest/security/extending.md     | 2 +-
 site/docs/latest/security/tls.md           | 4 ++--
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 6391b847d45d38ab30e4bdf4e8eb87590c098f38
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jul 10 22:22:14 2018 -0700

    patching CmdSources and adding unit tests (#2124)
    
    Patching some bugs in the source CLI and also adding extensive unit tests

 pulsar-client-tools/pom.xml                        |  10 +
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   4 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  72 +-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  |  65 +-
 .../apache/pulsar/admin/cli/TestCmdSources.java    | 858 +++++++++++++++++++++
 .../pulsar/functions/utils/SourceConfig.java       |   2 +-
 6 files changed, 955 insertions(+), 56 deletions(-)

commit 5632d9519ba723431248e7e33a3417dd6b303153
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Wed Jul 11 14:05:46 2018 +0900

    Fix an Argument of Wget in Pulsar Functions Getting Started (#2132)
    
    ### Motivation
    
    In https://pulsar.incubator.apache.org/docs/latest/functions/quickstart ,
    
    ```
    wget https://repository.apache.org/content/repositories/snapshots/org/apache/pulsar/distribution/2.0.0-incubating-SNAPSHOT/distribution-2.0.0-incubating-20180426.125800-32-bin.tar.gz
    ```
    is wrong.
    
    This is executed, then it returns 404.
    
    ```
    $ wget https://repository.apache.org/content/repositories/snapshots/org/apache/pulsar/distribution/2.0.0-incubating-SNAPSHOT/distribution-2.0.0-incubating-20180426.125800-32-bin.tar.gz
    --2018-07-11 12:25:49--  https://repository.apache.org/content/repositories/snapshots/org/apache/pulsar/distribution/2.0.0-incubating-SNAPSHOT/distribution-2.0.0-incubating-20180426.125800-32-bin.tar.gz
    Resolving repository.apache.org... 207.244.88.140
    Connecting to repository.apache.org|207.244.88.140|:443... connected.
    HTTP request sent, awaiting response... 404 Not Found
    2018-07-11 12:25:50 ERROR 404: Not Found.
    ```
    
    ### Modifications
    
    I changed `distribution-2.0.0-incubating-20180426.125800-32-bin.tar.gz` to binary release of current version .
    
    After Modification:
    ```
    wget 'https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&filename=incubator/pulsar/pulsar-2.0.1-incubating/apache-pulsar-2.0.1-incubating-bin.tar.gz' -O apache-pulsar-2.0.1-incubating-bin.tar.gz
    ```
    
    ### Result
    
    This modified command can be downloaded successfully.
    
    ```
    $ wget 'https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&filename=incubator/pulsar/pulsar-2.0.1-incubating/apache-pulsar-2.0.1-incubating-bin.tar.gz' -O apache-pulsar-2.0.1-incubating-bin.tar.gz
    --2018-07-11 12:31:08--  https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&filename=incubator/pulsar/pulsar-2.0.1-incubating/apache-pulsar-2.0.1-incubating-bin.tar.gz
    Resolving www.apache.org... 95.216.24.32, 40.79.78.1, 2a01:4f9:2a:185f::2
    Connecting to www.apache.org|95.216.24.32|:443... connected.
    HTTP request sent, awaiting response... 302 Found
    Location: http://ftp.riken.jp/net/apache/incubator/pulsar/pulsar-2.0.1-incubating/apache-pulsar-2.0.1-incubating-bin.tar.gz [following]
    --2018-07-11 12:31:11--  http://ftp.riken.jp/net/apache/incubator/pulsar/pulsar-2.0.1-incubating/apache-pulsar-2.0.1-incubating-bin.tar.gz
    Resolving ftp.riken.jp... 134.160.38.1
    Connecting to ftp.riken.jp|134.160.38.1|:80... connected.
    HTTP request sent, awaiting response... 200 OK
    Length: 186527350 (178M) [application/x-gzip]
    Saving to: apache-pulsar-2.0.1-incubating-bin.tar.gz
    
    100%[==================================================================================================================================================================>] 186,527,350 57.9M/s   in 3.7s
    
    2018-07-11 12:31:14 (48.2 MB/s) - apache-pulsar-2.0.1-incubating-bin.tar.gz saved [186527350/186527350]
    ```
    And all sample codes of `Getting started with Pulsar Functions` can be executed successfully.

 site/docs/latest/functions/quickstart.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit db804e704fa980f46942180dcd99dc13800bc5f7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 10 14:08:29 2018 -0700

    Remove popover from security overview page (#2109)
    
    *Motivation*
    
    Currently website uses a customized plugin for popover. If you don't define the popover,
    it will fail the build. It becomes a bit tricky to add popovers and link the popovers
    with actual data.
    
    *Changes*
    
    Remove popover.

 site/docs/latest/security/overview.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit a89fe84927f0e46579001592de2bbfb92e2d62dc
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Wed Jul 11 06:08:17 2018 +0900

    remove | (#2125)

 site/_data/popovers.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 914de19f8d3a1f11d547cde934519f08fa3d6d4c
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jul 10 18:01:07 2018 +0100

    Only exit from watch-znode if we managed to communicate with zk (#2127)
    
    The integration tests sometimes fail because the watch-znode script
    which is used to set the order of service startup throws an exception
    and exits without waiting for initialization to happen.
    
    This patch changes the watch-znode script to only ever exit if
    communication with zk has been successful.

 docker/pulsar/scripts/watch-znode.py | 40 +++++++++++++++++++++---------------
 1 file changed, 24 insertions(+), 16 deletions(-)

commit 5c9d077d3679a51410c47904cd42ef6f1578c737
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jul 10 10:00:27 2018 -0700

    shading dependencies in pulsar client (#2120)
    
    * shading dependencies in pulsar client
    
    * shading additional dependencies

 pulsar-client-admin-shaded/pom.xml                          |  5 +++++
 .../pulsar-client-kafka-shaded/pom.xml                      | 13 ++++++++++++-
 pulsar-client-shaded/pom.xml                                |  7 +++++++
 3 files changed, 24 insertions(+), 1 deletion(-)

commit a92ac3d495e953d9e32a2d7494652458399e6ec4
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Tue Jul 10 10:12:38 2018 +0900

    add { in creation of ClientOptions (#2115)

 site/docs/latest/clients/go.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8b206c3431525882fb4bbf68869e779fab4a5e34
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jul 9 17:08:08 2018 -0700

    patching CmdSink and adding extensive unit tests (#2107)
    
    * patching CmdSink and add extensive unit tests

 pulsar-client-tools/pom.xml                        |  34 +
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 116 ++-
 .../org/apache/pulsar/admin/cli/TestCmdSinks.java  | 980 +++++++++++++++++++++
 .../apache/pulsar/functions/utils/Resources.java   |   1 +
 .../apache/pulsar/functions/utils/SinkConfig.java  |   2 +-
 .../functions/utils/validation/ValidatorImpls.java | 132 +--
 6 files changed, 1158 insertions(+), 107 deletions(-)

commit b113e90b461ab1443828094b78299a08e5f15de4
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Jul 10 07:30:09 2018 +0900

    Make it possible to set idle WebSocket session timeout period (#2118)

 conf/broker.conf                                               |  2 ++
 conf/standalone.conf                                           |  2 ++
 conf/websocket.conf                                            |  3 +++
 .../java/org/apache/pulsar/broker/ServiceConfiguration.java    | 10 ++++++++++
 .../org/apache/pulsar/websocket/WebSocketConsumerServlet.java  |  6 ++++--
 .../org/apache/pulsar/websocket/WebSocketProducerServlet.java  |  5 ++++-
 .../org/apache/pulsar/websocket/WebSocketReaderServlet.java    |  6 ++++--
 .../pulsar/websocket/service/WebSocketProxyConfiguration.java  | 10 ++++++++++
 8 files changed, 39 insertions(+), 5 deletions(-)

commit cd35677131008d1fb3ee5400c112fba6f357d105
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Tue Jul 10 06:52:47 2018 +0900

    change ID() to Payload (#2117)

 site/docs/latest/clients/go.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 704714673a8dcfdf8a2b2106f1b3c9e45341cbe7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 9 13:39:46 2018 -0700

    derive worker-host and id at runtime if not provided (#2113)

 .../pulsar/functions/worker/WorkerConfig.java      | 28 +++++++++++++++++++++-
 1 file changed, 27 insertions(+), 1 deletion(-)

commit d81cd3801b2985f7d8a47157231059008249820b
Author: massakam <massakam@yahoo-corp.jp>
Date:   Mon Jul 9 16:49:50 2018 +0900

    Make ack timeout work in asynchronous implementation of C++ consumer (#2087)
    
    ### Motivation
    
    If implementing a consumer that uses message listener in C++, unacknowledged messages are not redelivered to the consumer even if specifying `unAckedMessagesTimeoutMs`. This is because the received messages have not been added to the unacked message tracker.
    
    ### Modifications
    
    Fixed `ConsumerImpl.cc` to add received message to the unacked message tracker before the message listener start processing it.
    
    ### Result
    
    Messages that are not acknowledged within `unAckedMessagesTimeoutMs` will be redelivered.

 pulsar-client-cpp/lib/ConsumerImpl.cc        |  1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 81 ++++++++++++++++++++++++++++
 2 files changed, 82 insertions(+)

commit bc6e1e667fc6dd96c07b183109662b005a5d6ca8
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Sun Jul 8 17:46:12 2018 -0700

    Disable empty methods in SequenceIdWithErrorTest (#2093)
    
    BeforeMethod and AfterMethod from the base class were being called in quick succession due to empty test method overrides , this disables them to allow for a faster run and cleaner reporting.

 .../pulsar/client/impl/SequenceIdWithErrorTest.java      | 16 ++--------------
 1 file changed, 2 insertions(+), 14 deletions(-)

commit c455e5e54ea19c5992338d58a5f6ada44c2ed3ea
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jul 8 07:31:49 2018 -0700

    Provide API and CLI to access list of connectors supported by system (#2106)
    
    * Provide API and CLI to access list of connectors supported by system
    
    * Have default value for connectors directory
    
    * Fixed test with non-existing connectors dir

 conf/functions_worker.yml                          |  5 ++-
 .../pulsar/broker/admin/impl/FunctionsBase.java    | 17 ++++++++
 .../apache/pulsar/broker/admin/v2/Functions.java   |  7 ++++
 .../org/apache/pulsar/client/admin/Functions.java  | 20 ++++++---
 .../client/admin/internal/FunctionsImpl.java       | 19 ++++++++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 19 ++++++++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 18 +++++++-
 .../pulsar/common}/io/ConnectorDefinition.java     |  2 +-
 .../pulsar/functions/utils/io/ConnectorUtils.java  | 49 ++++++++++++++++++++++
 .../pulsar/functions/utils/io/Connectors.java      | 36 ++++++++++++++++
 .../pulsar/functions/worker/ConnectorsManager.java | 48 +++++++++++++++++++++
 .../pulsar/functions/worker/WorkerConfig.java      |  3 +-
 .../pulsar/functions/worker/WorkerService.java     | 10 +++--
 .../functions/worker/rest/api/FunctionsImpl.java   | 12 ++++++
 14 files changed, 250 insertions(+), 15 deletions(-)

commit 2bf2568eec66a61a62cb2a5bc752ca425d2a97e1
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jul 7 15:49:59 2018 -0700

    Load connectors from NAR archives (#2102)
    
    * Load connectors from NAR archives
    
    * Fixed exception type
    
    * Fixed ProcessRuntimeTest
    
    * Fixed CmdFunctionsTest

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  56 ++---
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  61 +++--
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 152 +++++------
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 149 +++++------
 .../pulsar/client/impl/PulsarClientImpl.java       |   3 +-
 pulsar-common/pom.xml                              |   5 +
 .../org/apache/pulsar/common/nar/FileUtils.java    | 221 ++++++++++++++++
 .../apache/pulsar/common/nar/NarClassLoader.java   | 280 +++++++++++++++++++++
 .../org/apache/pulsar/common/nar/NarUnpacker.java  | 162 ++++++++++++
 .../pulsar/common/util/ObjectMapperFactory.java    |  28 ++-
 .../functions/instance/JavaInstanceRunnable.java   |  38 ++-
 .../apache/pulsar/functions/sink/PulsarSink.java   |   6 +
 .../pulsar/functions/runtime/ProcessRuntime.java   |   7 +-
 .../functions/runtime/ProcessRuntimeFactory.java   |   3 +-
 .../apache/pulsar/functions/runtime/Runtime.java   |   4 +-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |   4 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |   2 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   9 +-
 .../apache/pulsar/functions/utils/SinkConfig.java  |   6 +-
 .../pulsar/functions/utils/SourceConfig.java       |   7 +-
 .../org/apache/pulsar/functions/utils/Utils.java   |  16 +-
 .../utils/functioncache/FunctionCacheEntry.java    |  16 +-
 .../utils/functioncache/FunctionCacheManager.java  |   2 +
 .../functioncache/FunctionCacheManagerImpl.java    |  24 ++
 .../functions/utils/io/ConnectorDefinition.java    |  51 ++++
 .../pulsar/functions/utils/io/ConnectorUtils.java  | 104 ++++++++
 .../functions/utils/validation/ValidatorImpls.java | 207 ++++++++-------
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  23 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 .../resources/META-INF/services/pulsar-io.yaml     |  22 ++
 33 files changed, 1413 insertions(+), 343 deletions(-)

commit 5402d210a6df6e86d7006087f26e3cb8ff5ccea0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jul 7 15:34:25 2018 -0700

    Move Security related documentation to a top-level category (#2051)
    
    
    
    *Motivation*
    
    Security is one of the most important features that Apache Pulsar offers.
    It is making sense to have a top-level cateory to hold all the documentation related to security.
    
    e.g.
    
    - tls encryption and authentication
    - authenz authentication
    - authorization
    - end-to-end encryption
    
    *Solution*
    
    All security documentation are now in `Security` category.

 site/_data/messages.yaml                           |   2 +-
 site/_data/sidebar.yaml                            |  20 +-
 site/_includes/explanations/admin-setup.md         |   4 +-
 site/_includes/explanations/client-url.md          |   2 +-
 site/_includes/explanations/tenants-namespaces.md  |   2 +-
 site/docs/latest/admin-api/clusters.md             |   2 +-
 site/docs/latest/admin/Authz.md                    | 329 ---------------------
 site/docs/latest/admin/Dashboard.md                |   2 +-
 site/docs/latest/clients/Java.md                   |   6 +-
 site/docs/latest/clients/go.md                     |   2 +-
 site/docs/latest/deployment/Kubernetes.md          |   4 +-
 site/docs/latest/deployment/cluster.md             |   4 +-
 site/docs/latest/deployment/instance.md            |   2 +-
 .../getting-started/ConceptsAndArchitecture.md     |   6 +-
 site/docs/latest/security/athenz.md                | 104 +++++++
 site/docs/latest/security/authorization.md         | 109 +++++++
 site/docs/latest/security/encryption.md            | 194 ++++++++++++
 .../CustomAuth.md => security/extending.md}        |   2 +-
 site/docs/latest/security/overview.md              |  57 ++++
 site/docs/latest/security/tls.md                   | 161 ++++++++++
 20 files changed, 661 insertions(+), 353 deletions(-)

commit 027f53568b7955f487ecea08fa6d612a7a6d734b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jul 7 14:00:15 2018 -0700

    Issue 2090: (#2092)
    
    *Motivation*
    
    Fixes #2090.
    
    Links to connector source code are broken
    
    *Changes*
    
    - Change package name from `connect` to `io`
    - Fix the connector class name

 site/_data/connectors.yaml     | 10 +++++-----
 site/_includes/connectors.html |  4 ++--
 2 files changed, 7 insertions(+), 7 deletions(-)

commit ffe7b62fc26cb3d577717439b9cdd4048a36dcf1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jul 7 13:59:03 2018 -0700

    Issue 2077: SubscriptionInitialPosition doesn't work with multiple-topic type subscription (#2100)
    
    *Motivation*
    
    Fixes #2077.
    
    The problem is the consumer configuration is copied to an internal consumer configuration for multi-topic style subscription. but we missed copying SubscriptionInitialPosition.
    
    *Solution*
    
    Use `clone` for popagating configuration to internal configuration.
    
    Added a test case to cover it.

 .../client/impl/MultiTopicsConsumerImpl.java       | 21 +------
 .../tests/integration/semantics/SemanticsTest.java | 68 ++++++++++++++++++++++
 2 files changed, 69 insertions(+), 20 deletions(-)

commit 423a9af9973c3df6275f2abd97957bd772e3da43
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Jul 7 11:38:43 2018 -0700

    Add context to source and sink (#2098)
    
    * adding contexts to sink and source interface
    
    * cleaning up
    
    * adding unit tests

 .../pulsar/functions/instance/ContextImpl.java     |  4 +-
 .../pulsar/functions/instance/JavaInstance.java    | 21 +-------
 .../functions/instance/JavaInstanceRunnable.java   | 37 +++++++++----
 .../apache/pulsar/functions/sink/PulsarSink.java   |  3 +-
 .../pulsar/functions/source/PulsarSource.java      |  3 +-
 .../functions/instance/JavaInstanceTest.java       | 26 +++-------
 .../pulsar/functions/source/PulsarSourceTest.java  |  9 ++--
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  3 +-
 .../pulsar/io/aerospike/AerospikeAbstractSink.java |  3 +-
 .../pulsar/io/cassandra/CassandraAbstractSink.java |  3 +-
 .../java/org/apache/pulsar/io/core/PushSource.java |  3 +-
 .../java/org/apache/pulsar/io/core/SimpleSink.java |  1 +
 .../main/java/org/apache/pulsar/io/core/Sink.java  |  3 +-
 .../org/apache/pulsar/io/core/SinkContext.java     | 28 ++++++++++
 .../java/org/apache/pulsar/io/core/Source.java     |  3 +-
 .../org/apache/pulsar/io/core/SourceContext.java   | 28 ++++++++++
 .../java/org/apache/pulsar/io/core/SinkTest.java   | 60 ++++++++++++++++++++++
 .../java/org/apache/pulsar/io/core/SourceTest.java | 59 +++++++++++++++++++++
 .../apache/pulsar/io/kafka/KafkaAbstractSink.java  |  3 +-
 .../pulsar/io/kafka/KafkaAbstractSource.java       |  3 +-
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |  3 +-
 .../apache/pulsar/io/rabbitmq/RabbitMQSource.java  |  4 +-
 .../apache/pulsar/io/twitter/TwitterFireHose.java  |  3 +-
 23 files changed, 244 insertions(+), 69 deletions(-)

commit 86f0a0db90c1cfdd517fc25cd015df83835bbb4f
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Jul 6 21:41:40 2018 -0700

    Remove unused test annotation (#2095)

 .../apache/pulsar/tests/integration/functions/PulsarFunctionsTest.java   | 1 -
 1 file changed, 1 deletion(-)

commit 1ebe3349d3a185d441e22ad3d9767d0ea39871eb
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 6 14:31:43 2018 -0700

    Fixed path for Postgres in dashboard docker image (#2088)

 dashboard/Dockerfile               |  2 +-
 dashboard/conf/postgresql.conf     | 10 +++++-----
 dashboard/conf/supervisor-app.conf |  2 +-
 3 files changed, 7 insertions(+), 7 deletions(-)

commit 7bfc34340d627f9a6e01ada004550b4d7e09f1d6
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 6 14:15:22 2018 -0700

    Remove dependencies exclusions for org.apache.httpcomponents:httpclient (#2104)

 pom.xml | 6 ------
 1 file changed, 6 deletions(-)

commit da8981c7becab94443cdac41a9495654943570ef
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 6 11:59:29 2018 -0700

    Kinesis sink publish full json message (#2079)
    
    * Kinesis sink publish full json message
    
    * fix pulsar typo

 pulsar-io/core/pom.xml                             |  13 ++
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  |  23 ++-
 .../pulsar/io/kinesis/KinesisSinkConfig.java       |  26 +++-
 .../java/org/apache/pulsar/io/kinesis/Utils.java   | 103 +++++++++++++
 .../org/apache/pulsar/io/kinesis/UtilsTest.java    | 162 +++++++++++++++++++++
 5 files changed, 324 insertions(+), 3 deletions(-)

commit 3e9bac60e4bc5521ed3864dee7f14efd6e5bc0d1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jul 6 08:37:29 2018 -0700

    Issue 1252: Enable bookie autorecovery daemon by default (#2096)
    
    *Motivation*
    
    Fixes #1252
    
    AutoRecovery daemon should be enabled by default for new users.
    
    *Changes*
    
    Turn on `autoRecoveryDaemonEnabled`. uncommeted recovery related settings to allow them being configured in containers.

 conf/bookkeeper.conf | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 83e31579f5df941ad49fb54ec269c1d917821504
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jul 6 08:37:07 2018 -0700

    Issue 1455: MessageID has always batch index 0 when sending messages in a batch (#2099)
    
    *Motivation*
    
    Fixes #1455.
    
    Pulsar uses a callback chain for completing the list of callbacks for a batch. However the callback chain doesn't reference the message instance for completing the callback.
    so when callback chain is triggered, it always uses the first message id to complete the chain of callbacks.
    
    *Changes*
    
    Introduce a field to keep message instance in the callback chain. So when the chain is invoked, each callback can use the right message instance to complete the callback.
    
    Added an integration test to ensure it works correctly.

 .../nonpersistent/NonPersistentReplicator.java     |  7 ++-
 .../service/persistent/PersistentReplicator.java   |  7 ++-
 .../pulsar/client/impl/BatchMessageContainer.java  |  2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    | 14 ++++-
 .../apache/pulsar/client/impl/SendCallback.java    | 14 ++++-
 .../tests/integration/semantics/SemanticsTest.java | 64 ++++++++++++++++++++++
 6 files changed, 99 insertions(+), 9 deletions(-)

commit 0420e594eeaf7268886f5dc307488151c9bfc27e
Author: Yuto Furuta <mzq6mft9zz@gmail.com>
Date:   Fri Jul 6 19:15:57 2018 +0900

    Fix wget argument (#2085)
    
    * fix wget value
    
    * remove -incubating

 site/_includes/explanations/install-package.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 268161c113a7f5b8522ecfb8d0c4794568563b90
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jul 5 18:53:42 2018 -0700

    Move Smoke Test and Cli test to semantic package (#2097)
    
    Me are moving single test projects to unified location , eventually semantic will be renamed to a more general name handle , this is due to migration from arquillian to testcontainers.

 tests/integration/cli/pom.xml                      | 53 ---------------------
 tests/integration/pom.xml                          |  2 -
 .../pulsar/tests/integration/cli/CLITest.java}     |  4 +-
 .../pulsar/tests/integration/smoke}/SmokeTest.java |  2 +-
 tests/integration/smoke/pom.xml                    | 54 ----------------------
 5 files changed, 3 insertions(+), 112 deletions(-)

commit 99892d72e6dcb19dc8fd411dfbe38d4f4da5f5ff
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jul 5 17:16:57 2018 -0700

    Enhance Pulsar cluster with container logs (#2078)
    
    ### Motivation
    This is continuation of the existing work to move from the arquiilian framework to test containers library , here we focus on more traceability in the pulsar test containers with logging and migrate the smoke test from the old framework.
    
    ### Result
    Smoke test based on testcontainers should be removing the older arquillian based version.

 .../pulsar/tests/containers/BKContainer.java       |  2 +
 .../pulsar/tests/containers/BrokerContainer.java   |  2 +
 .../pulsar/tests/containers/ChaosContainer.java    |  8 +-
 .../pulsar/tests/containers/ProxyContainer.java    |  2 +
 .../pulsar/tests/containers/PulsarContainer.java   | 11 +--
 .../pulsar/tests/containers/WorkerContainer.java   |  2 +
 .../pulsar/tests/containers/ZKContainer.java       |  6 +-
 .../pulsar/tests/topologies/PulsarCluster.java     | 34 ++++++--
 .../tests/topologies/PulsarClusterTestBase.java    | 29 ++++---
 .../functions/PulsarFunctionsTestBase.java         | 11 +--
 .../runtime/PulsarFunctionsProcessRuntimeTest.java | 15 +++-
 .../runtime/PulsarFunctionsRuntimeTest.java        | 10 +--
 .../runtime/PulsarFunctionsThreadRuntimeTest.java  |  9 +-
 tests/integration/smoke/pom.xml                    | 17 ++--
 .../apache/pulsar/tests/integration/SmokeTest.java | 83 ++++++++++++++++++
 .../apache/pulsar/tests/integration/TestSmoke.java | 98 ----------------------
 .../smoke/src/test/resources/arquillian.xml        | 33 --------
 17 files changed, 183 insertions(+), 189 deletions(-)

commit 2f6dc803c588a039060f2c88764c71a4a576b006
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Thu Jul 5 17:16:14 2018 -0700

    Fix Rackaware test (#2094)

 .../src/test/java/org/apache/pulsar/broker/service/RackAwareTest.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 4eee5b1a72e073620b382ef19a88581f10f85b89
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 5 16:47:36 2018 -0700

    Added ReadOnlyCursor to ManagedLedger (#2041)
    
    * Added ReadOnlyCursor to ManagedLedger
    
    * Fixed issue with skipping to last available entry
    
    * Fixed recovery flag on open ledger
    
    * Added more check for currentLedger != null

 .../apache/bookkeeper/mledger/AsyncCallbacks.java  |   6 +
 .../bookkeeper/mledger/ManagedLedgerFactory.java   |  26 +++
 .../apache/bookkeeper/mledger/ReadOnlyCursor.java  | 101 ++++++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   4 +-
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |  63 ++++++
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  45 +++--
 .../mledger/impl/ReadOnlyCursorImpl.java           |  65 ++++++
 .../mledger/impl/ReadOnlyManagedLedgerImpl.java    | 130 ++++++++++++
 .../mledger/impl/ReadOnlyCursorTest.java           | 223 +++++++++++++++++++++
 9 files changed, 643 insertions(+), 20 deletions(-)

commit f71f4ba8c34d0b196c544bf04fc8d2f5a393087c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 5 16:22:49 2018 -0700

    avoid unnecessary reflection to create pulsar source instance (#2083)

 .../apache/pulsar/functions/instance/JavaInstanceRunnable.java   | 9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

commit d62cdd884b324aa1fb210687a674d62877a6b809
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 5 14:55:23 2018 -0700

    Cleanup unused function resource (#2082)

 .../functions/worker/rest/api/FunctionsImpl.java   | 423 ++++++++-------------
 1 file changed, 158 insertions(+), 265 deletions(-)

commit 1893323bc2f22001b63ea0d310ec47e88889e3e0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jul 5 13:15:55 2018 -0700

    change JSONSchema to generate and store an avro schema (#2071)
    
    Change JSONSchema to generate a Avro schema from POJO so we can standardize on using Avro schema

 .../schema/JsonSchemaCompatibilityCheck.java       | 117 +++++++++++++++-
 .../service/schema/SchemaCompatibilityCheck.java   |   7 +
 .../schema/AvroSchemaCompatibilityCheckTest.java   | 127 ++---------------
 .../schema/BaseAvroSchemaCompatibilityTest.java    | 152 +++++++++++++++++++++
 .../schema/JsonSchemaCompatibilityCheckTest.java   | 140 +++++++++++++++++++
 .../ProtobufSchemaCompatibilityCheckTest.java      |  37 +++++
 .../api/SimpleTypedProducerConsumerTest.java       |   8 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  24 +++-
 .../pulsar/client/impl/schema/AvroSchema.java      |   2 +-
 .../pulsar/client/impl/schema/JSONSchema.java      |  66 ++++++---
 .../pulsar/client/schemas/JSONSchemaTest.java      | 106 ++++++++++++++
 .../org/apache/pulsar/common/api/Commands.java     |   3 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  |   3 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 14 files changed, 647 insertions(+), 146 deletions(-)

commit ec04dc070464d01071774d3eacc09daa20da0cd6
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jul 5 13:10:07 2018 -0700

    Move Pulsar IO as a top-category section at the sidebar (#2050)
    
    *Motivation*
    
    Pulsar I/O is too deep in the documentation. It is hard for people to realize the connectors.
    
    *Changes*
    
    Move Pulsar I/O documentation to a top-category section.
    
    Also renaming "pulsar administration" to "Administration"

 site/_data/sidebar.yaml                            | 13 ++++--
 .../getting-started/ConceptsAndArchitecture.md     | 28 ------------
 site/docs/latest/io/overview.md                    | 51 ++++++++++++++++++++++
 .../{cookbooks/pulsar-io.md => io/quickstart.md}   |  4 +-
 4 files changed, 64 insertions(+), 32 deletions(-)

commit c9d1066f1b33a4eff4a907cf5616cb0e7a65ac8e
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Jul 6 00:35:56 2018 +0900

    Fix python/CMakeLists.txt (#2084)

 pulsar-client-cpp/python/CMakeLists.txt | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 59fc8e22ac75f0b7c9e718444bd74cb4dbbd01ea
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jul 4 01:42:49 2018 -0700

    Dump container & pulsar log before container stops (#2076)
    
    *Motivation*
    
    Arquillian tests dump container & pulsar logs before container stops.
    When moving integration tests from arquillian to testcontainers, we
    should have same behavior.
    
    *Changes*
    
    Add a hook `beforeStop` to add logic to run before a container is stopped.

 .../pulsar/tests/containers/CSContainer.java       |  2 +-
 .../pulsar/tests/containers/ChaosContainer.java    | 19 ++++++++++++
 .../pulsar/tests/containers/PulsarContainer.java   | 13 ++++++++
 .../pulsar/tests/containers/ZKContainer.java       | 36 +++++++++++++++++++++-
 .../pulsar/tests/topologies/PulsarCluster.java     |  2 +-
 5 files changed, 69 insertions(+), 3 deletions(-)

commit 9a8428a839300452f5712ce9a5d34d6b3bdd1dcf
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jul 4 01:42:17 2018 -0700

    shade dependencies in pulsar client and admin (#2069)

 pulsar-client-admin-shaded/pom.xml | 5 +++++
 pulsar-client-shaded/pom.xml       | 6 ++++++
 2 files changed, 11 insertions(+)

commit e422a6f93d2e1eb9a3469401966e5c7c4a4a9bda
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 3 12:58:00 2018 -0700

    fix: configure crypto-action for internal consumer independently cryptoReader (#2073)
    
    * fix: configure crypto-action for internal consumer independently cryptoReader
    
    * add test-case for multi-topic + cryptoFailureAction

 .../pulsar/client/api/SimpleProducerConsumerTest.java       | 13 +++++++------
 .../apache/pulsar/client/impl/MultiTopicsConsumerImpl.java  |  4 ++--
 2 files changed, 9 insertions(+), 8 deletions(-)

commit 8e95ddc5f3103279a39bd98031b3d16fb17dbdb3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 3 11:00:40 2018 -0700

    By default PulsarSource consume encrypted message (#2074)
    
    * By default PulsarSource consume encrypted message
    
    * fix: mock test

 .../src/main/java/org/apache/pulsar/functions/source/PulsarSource.java  | 2 ++
 .../test/java/org/apache/pulsar/functions/source/PulsarSourceTest.java  | 1 +
 2 files changed, 3 insertions(+)

commit 5d73bb40f1ade12ba27d49d26cb50477f4e39c30
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 3 11:00:07 2018 -0700

    Fix: destination lookup url for v2 (#2075)

 .../src/main/java/org/apache/pulsar/client/impl/HttpLookupService.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5614cc5ef6e5eec01213baabe6cedbb6b65d8f53
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jul 3 00:24:09 2018 -0700

    Integration test coverage on python functions (#2072)
    
    *Motivation*
    
    - Make sure python wheel file is built and can be installed/used correctly
    - Make sure pulsar python functions work as expected
    
    *Changes*
    
    - copy `python-examples` to the distribution
    - install python client in test image for pulsar python function test
    - add PYTHON runtime to functions runtime test

 distribution/server/src/assemble/bin.xml           |  4 ++
 pom.xml                                            |  1 +
 pulsar-client-cpp/docker/build-wheels.sh           | 28 +++++++++++++
 .../docker-images/latest-version-image/Dockerfile  |  8 +++-
 tests/docker-images/latest-version-image/pom.xml   | 46 ++++++++++++++++++++++
 .../scripts/install-pulsar-client.sh               | 24 +++++++++++
 .../functions/PulsarFunctionsTestBase.java         | 20 +++++++++-
 .../runtime/PulsarFunctionsProcessRuntimeTest.java |  3 ++
 .../runtime/PulsarFunctionsRuntimeTest.java        | 34 ++++++++++++++--
 .../runtime/PulsarFunctionsThreadRuntimeTest.java  |  4 ++
 .../functions/utils/CommandGenerator.java          |  2 +-
 11 files changed, 165 insertions(+), 9 deletions(-)

commit 5e4579d2fbfa70ac0668a298c269e31d3b54ab13
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 2 17:51:33 2018 -0700

    Pass encryption-context to pulsar-sink if source receive encrypted message (#2068)
    
    * Pass encryption-context to pulsar-sink if source receive encrypted message
    
    * move Encryption-ctx to api-pkg

 .../client/api/SimpleProducerConsumerTest.java       |  4 ++--
 .../client/api/ConsumerCryptoFailureAction.java      |  2 +-
 .../java/org/apache/pulsar/client/api/Message.java   | 12 ++++++++++++
 .../org/apache/pulsar/client/impl/ConsumerImpl.java  |  4 ++--
 .../org/apache/pulsar/client/impl/MessageImpl.java   |  2 ++
 .../apache/pulsar/client/impl/MessageRecordImpl.java | 15 +++++++++++++++
 .../apache/pulsar/client/impl/TopicMessageImpl.java  |  9 ++++++++-
 .../apache/pulsar/common/api}/EncryptionContext.java |  2 +-
 .../apache/pulsar/functions/source/PulsarRecord.java |  3 +++
 .../apache/pulsar/functions/source/PulsarSource.java |  2 ++
 pulsar-io/core/pom.xml                               | 12 ++++++++++++
 .../org/apache/pulsar/io/core/RecordContext.java     | 20 ++++++++++++++++++++
 12 files changed, 80 insertions(+), 7 deletions(-)

commit e16f91c116c133e1741d0a20b69644fa82fa02a0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 2 17:14:21 2018 -0700

    Run functions runtime test with thread mode (#2070)
    
    *Motivation*
    
    Pulsar Functions supports both process and thread modes to run functions.
    Currently the test case only test process mode.
    
    *Changes*
    
    Improve the existing test to support testing pulsar functions in thread mode

 docker/pulsar/scripts/gen-yml-from-env.py          |  28 +++-
 .../pulsar/functions/worker/WorkerConfig.java      |   1 -
 .../pulsar/tests/topologies/PulsarCluster.java     |  39 ++++-
 .../integration/functions/PulsarFunctionsTest.java | 130 ----------------
 .../functions/PulsarFunctionsTestBase.java         |  10 +-
 .../runtime/PulsarFunctionsProcessRuntimeTest.java |  25 ++++
 .../runtime/PulsarFunctionsRuntimeTest.java        | 165 +++++++++++++++++++++
 .../runtime/PulsarFunctionsThreadRuntimeTest.java  |  42 ++++++
 8 files changed, 294 insertions(+), 146 deletions(-)

commit 7559632715e21bfc32e8f84db8cd368f697993f9
Author: Adam Williams <pwnfactory@gmail.com>
Date:   Mon Jul 2 16:05:06 2018 -0600

    Improve RedeliverUnacknowledgedMessages binary protocol docs (#2066)
    
    This updates the binary protocol documentation to mention the varying
    behavior of `RedeliverUnacknowledgedMessages`, depending on the
    subscription type.
    
    Closes apache/incubator-pulsar#2003

 site/docs/latest/project/BinaryProtocol.md | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

commit 7a10d938a286a3d25114ee59f5cee63e1a57a795
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Jul 3 01:25:29 2018 +0800

    GCS offload support(1): rename s3offload related classes to be reuse-able (#2064)
    
    This is the first part to support `Google Cloud Storage` offload.
    change:
    rename Offload related classes to make them also reuse-able for GCS.
    
    Master Issue: #2067

 .../java/org/apache/pulsar/broker/PulsarService.java  |  2 +-
 .../BackedInputStream.java}                           |  4 ++--
 .../BlockAwareSegmentInputStream.java                 |  3 +--
 .../{s3offload => offload}/DataBlockHeader.java       |  3 +--
 .../{s3offload => offload}/OffloadIndexBlock.java     |  2 +-
 .../OffloadIndexBlockBuilder.java                     |  4 ++--
 .../{s3offload => offload}/OffloadIndexEntry.java     |  2 +-
 .../impl/BlockAwareSegmentInputStreamImpl.java        |  4 ++--
 .../impl/DataBlockHeaderImpl.java                     |  4 ++--
 .../impl/OffloadIndexBlockBuilderImpl.java            |  6 +++---
 .../impl/OffloadIndexBlockImpl.java                   |  7 +++----
 .../impl/OffloadIndexEntryImpl.java                   |  4 ++--
 .../impl/S3BackedInputStreamImpl.java                 |  8 ++++----
 .../impl/S3BackedReadHandleImpl.java                  | 19 +++++++++----------
 .../impl}/S3ManagedLedgerOffloader.java               |  8 ++++----
 .../S3BackedInputStreamTest.java                      | 18 ++++++++----------
 .../pulsar/broker/{s3offload => offload}/S3Mock.java  |  2 +-
 .../broker/{s3offload => offload}/S3TestBase.java     |  7 ++-----
 .../impl/BlockAwareSegmentInputStreamTest.java        |  6 ++----
 .../impl/DataBlockHeaderTest.java                     |  4 ++--
 .../{s3offload => offload}/impl/OffloadIndexTest.java |  8 ++++----
 .../impl}/S3ManagedLedgerOffloaderTest.java           | 12 ++++++------
 22 files changed, 63 insertions(+), 74 deletions(-)

commit 791b5963d08fa002659706e28e73abdf8f80aa56
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 2 10:22:17 2018 -0700

    Add integration tests on pulsar functions on process mode (#2063)

 tests/integration/semantics/pom.xml                |   4 +
 .../integration/functions/PulsarFunctionsTest.java | 138 ++++++++++-
 .../functions/PulsarFunctionsTestBase.java         |  12 +
 .../functions/utils/CommandGenerator.java          | 260 +++++++++++++++++++++
 4 files changed, 412 insertions(+), 2 deletions(-)

commit d01cc7561cc9ff960e998b4c3e633a9cbbe51af3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 2 02:32:46 2018 -0700

    Fix build issue in master (#2062)
    
    *Motivation*
    
    merging apache/pulsar#2060 and apache/pulsar#2061 seems causing one method being merged as duplicated method. it broke the master build.
    
    *Changes*
    
    removed duplicated method introduced after merging apache/pulsar#2060 and apache/pulsar#2061

 .../main/java/org/apache/pulsar/tests/topologies/PulsarCluster.java   | 4 ----
 1 file changed, 4 deletions(-)

commit b22e883890fe4729675e67868f62d448cc42ed6a
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 2 00:22:01 2018 -0700

    Package Pulsar IO connectors into separate tgz in form of nar archives (#2054)
    
    ### Motivation
    
    We need to package Pulsar IO connectors as part of the release.
    We provide a new file `apache-pulsar-io-connectors-$VERSION-bin.tar.gz` that contains [NAR](https://medium.com/hashmapinc/nifi-nar-files-explained-14113f7796fd).
    
    In subsequent PR, I'll add the logic to load and use these archives.

 .travis.yml                                        |  2 +-
 bin/bookkeeper                                     |  2 +-
 bin/pulsar                                         |  2 +-
 bin/pulsar-admin                                   |  2 +-
 bin/pulsar-client                                  |  2 +-
 bin/pulsar-perf                                    |  2 +-
 distribution/io/pom.xml                            | 68 ++++++++++++++++++
 distribution/io/src/assemble/README                | 10 +++
 distribution/io/src/assemble/io.xml                | 84 ++++++++++++++++++++++
 distribution/pom.xml                               | 40 +++++++++++
 .../server}/licenses/LICENSE-AspectJ.txt           |  0
 .../server}/licenses/LICENSE-CC0.txt               |  0
 .../server}/licenses/LICENSE-CDDL-1.1.txt          |  0
 .../server}/licenses/LICENSE-EA-Agent-Loader.txt   |  0
 .../server}/licenses/LICENSE-EPL-1.0.txt           |  0
 .../server}/licenses/LICENSE-Hamcrest.txt          |  0
 .../server}/licenses/LICENSE-HdrHistogram.txt      |  0
 .../server}/licenses/LICENSE-HdrHistogram0.txt     |  0
 .../server}/licenses/LICENSE-JSR305.txt            |  0
 .../server}/licenses/LICENSE-LevelDB.txt           |  0
 .../server}/licenses/LICENSE-Lombok.txt            |  0
 .../server}/licenses/LICENSE-SLF4J.txt             |  0
 .../server}/licenses/LICENSE-SemVer.txt            |  0
 .../server}/licenses/LICENSE-Webbit.txt            |  0
 .../server}/licenses/LICENSE-bouncycastle.txt      |  0
 .../licenses/LICENSE-google-auth-library.txt       |  0
 .../server}/licenses/LICENSE-jbzip2.txt            |  0
 .../server}/licenses/LICENSE-jfastlz.txt           |  0
 .../server}/licenses/LICENSE-libdivsufsort.txt     |  0
 .../server}/licenses/LICENSE-protobuf.txt          |  0
 .../server}/licenses/LICENSE-xz.txt                |  0
 {all => distribution/server}/pom.xml               |  6 +-
 .../server}/src/assemble/LICENSE.bin.txt           |  0
 .../server}/src/assemble/NOTICE.bin.txt            |  0
 .../server}/src/assemble/README.bin.txt            |  0
 {all => distribution/server}/src/assemble/bin.xml  | 16 ++---
 {all => distribution/server}/src/assemble/src.xml  |  2 +-
 docker/pulsar/pom.xml                              |  6 +-
 pom.xml                                            | 21 +++++-
 pulsar-client-cpp/pkg/deb/build-deb.sh             |  2 +-
 pulsar-client-cpp/pkg/rpm/build-rpm.sh             |  2 +-
 pulsar-client-cpp/run-unit-tests.sh                |  2 +-
 pulsar-io/aerospike/pom.xml                        | 12 +++-
 pulsar-io/cassandra/pom.xml                        | 10 ++-
 .../pulsar/io/cassandra/CassandraAbstractSink.java |  9 +--
 .../java/org/apache/pulsar/io/core/PushSource.java |  1 -
 pulsar-io/kafka/pom.xml                            | 10 ++-
 pulsar-io/kinesis/pom.xml                          | 34 ++-------
 pulsar-io/rabbitmq/pom.xml                         | 11 ++-
 pulsar-io/twitter/pom.xml                          | 11 ++-
 .../apache/pulsar/io/twitter/TwitterFireHose.java  | 10 +--
 src/stage-release.sh                               |  5 +-
 52 files changed, 306 insertions(+), 78 deletions(-)

commit 4ade1bdabb4f0d434443b9dd8ceca196b84a6ec1
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 2 00:19:49 2018 -0700

    Tests Python Wheel packaging in CI build (#2042)
    
    ### Motivation
    
    Currently, we're not testing the validity of the wheel file package for the Python client library. This leads to find packaging error later in the release phase.
    
    ### Modifications
    
    Build Python wheel file as part of CI build and make sure the tests are importing the pulsar library from that installed wheel file.

 pulsar-client-cpp/python/pulsar_test.py |  5 ++++-
 pulsar-client-cpp/run-unit-tests.sh     | 22 ++++++++++++++++++++--
 2 files changed, 24 insertions(+), 3 deletions(-)

commit 57668440104fb56ce932287190f5203e2073bd62
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jul 2 00:18:28 2018 -0700

    fix bug in concerning ContextImpl (#2052)
    
    NPE thrown when submitting a source because context is null

 .../apache/pulsar/functions/instance/ContextImpl.java    | 16 ++++++++++++----
 .../apache/pulsar/functions/instance/JavaInstance.java   |  9 +++++----
 2 files changed, 17 insertions(+), 8 deletions(-)

commit 124dfafeb3ab92f55ce5fb2de4220f3ea57a803c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 2 00:17:40 2018 -0700

     Move integration tests for function upload/download to apache (#2061)
    
    This change add `function-worker` into the `PulsarClusterTestBase` to create a test base for functions related tests `PulsarFunctionsTestBase`.
    
    Move the existing upload/download tests to use it.

 docker/pulsar/Dockerfile                           |  3 +-
 docker/pulsar/scripts/gen-yml-from-env.py          | 65 +++++++++++++++++
 .../docker-images/latest-version-image/Dockerfile  |  4 +-
 .../conf/functions_worker.conf                     | 27 +++++++
 .../scripts/run-functions-worker.sh                | 31 ++++++++
 .../pulsar/tests/containers/PulsarContainer.java   |  9 +--
 .../pulsar/tests/containers/WorkerContainer.java   | 30 ++++++++
 .../pulsar/tests/topologies/PulsarCluster.java     | 52 +++++++++++--
 .../integration/functions/PulsarFunctionsTest.java | 85 ++++++++++++++++++++++
 .../functions/PulsarFunctionsTestBase.java         | 36 +++++++++
 .../utils/UploadDownloadCommandGenerator.java      | 74 +++++++++++++++++++
 11 files changed, 403 insertions(+), 13 deletions(-)

commit 60a07e981c001cb42e732c76553fd42ea4feee64
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jul 2 00:16:19 2018 -0700

    Migrate CLI integration test mode to use testcontainers (#2060)

 .../pulsar/tests/topologies/PulsarCluster.java     |   8 +-
 tests/integration/cli/pom.xml                      |  10 +-
 .../apache/pulsar/tests/integration/TestCLI.java   | 191 ++++++++++-----------
 .../cli/src/test/resources/arquillian.xml          |  32 ----
 4 files changed, 101 insertions(+), 140 deletions(-)

commit 9b1cc78e3e3f9897f931d186afdf5e02dc399136
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Jul 1 15:40:02 2018 -0700

    Forward encryption properties with encrypted payload to consumer (#2024)
    
    * Forward encryption properties with encrypted payload to consumer
    
    * add EncryptionCtx to message to store encryption metadata

 .../client/api/SimpleProducerConsumerTest.java     | 161 ++++++++++++++++++++-
 .../client/api/ConsumerCryptoFailureAction.java    |  19 ++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  65 ++++++++-
 .../pulsar/client/impl/EncryptionContext.java      |  52 +++++++
 .../apache/pulsar/client/impl/MessageCrypto.java   |   2 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |  16 +-
 .../apache/pulsar/client/impl/MessageParser.java   |   3 +-
 7 files changed, 300 insertions(+), 18 deletions(-)

commit 89c7b65f182f35c16558aeb5278208cb3f88146f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Jul 1 10:45:38 2018 -0700

    Pulsar Kinesis-sink upgrade aws-sdk version (#2058)
    
    * Pulsar Kinesis-sink upgrade aws-sdk version
    
    * fix: formatting

 pulsar-io/kinesis/pom.xml | 20 ++++++--------------
 1 file changed, 6 insertions(+), 14 deletions(-)

commit 7cebe2330bd7376df066a31c01231f0cb693deaf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Jul 1 10:45:27 2018 -0700

    Forward user-properties to sink (#2057)

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 38 +++++++++++++---------
 .../functions/instance/JavaInstanceRunnable.java   |  4 +--
 .../apache/pulsar/functions/sink/PulsarSink.java   | 11 ++++---
 .../pulsar/functions/source/PulsarRecord.java      |  4 +++
 .../pulsar/functions/source/PulsarSource.java      |  1 +
 5 files changed, 37 insertions(+), 21 deletions(-)

commit f14b9e96865f75fa542a2f42dbbd7ed09964a3e4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Jun 30 23:00:05 2018 -0700

    fix bug with specifying jar via config file (#2053)

 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java     |  8 ++++----
 .../main/java/org/apache/pulsar/admin/cli/CmdSinks.java    | 10 +++++-----
 .../main/java/org/apache/pulsar/admin/cli/CmdSources.java  | 14 +++++++-------
 3 files changed, 16 insertions(+), 16 deletions(-)

commit bee124e96c9695660a453e75983c3f53fc57bc87
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jun 30 22:58:08 2018 -0700

    Add semantic integration tests for non-persistent topics and effectively-once producing (#2059)

 .../pulsar/tests/topologies/PulsarCluster.java     |  33 ++++++
 .../tests/topologies/PulsarClusterTestBase.java    |  59 ++++++++++
 .../tests/integration/semantics/SemanticsTest.java | 126 ++++++++++++++++++++-
 3 files changed, 212 insertions(+), 6 deletions(-)

commit 4d1cf20c6d52ad8491eff0fdd9f1ea4793134999
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jun 30 17:22:01 2018 -0700

    Introduce testcontainer based cluster integration tests (#2055)
    
    * Introduce testcontainer cluster tests
    
    *Motivation*
    
    Introduce testcontainer based cluster tests for replacing existing arquilian tests.
    
    testcontainer is more flexible and more nature to how we write unit tests. arquilian is configuration based and hard to change cluster at runtime.
    it is possible to add bookies/brokers/proxies at testing runtime using testcontainers.
    
    current arquilian based integration tests can only run in linux environment (which is using host network). it is impossible to run arquillian tests in mac environment,
    where host network is meaningless. changing to testcontainers is allowing running integration tests on mac to speed up development.
    
    *Changes*
    
    This mirrors the exact same setup as existing arquillian tests - 1 zk container, 1 cs container, 3 bk containers, 2 broker containers and 1 proxy container.
    
    add a semantic integration test module to using the new testcontainer test base `PulsarClusterTestBase`.
    
    *Result*
    
    - both arquillian and testcontainers exist.
    - new integration tests are encouraged to be written using `PulsarClusterTestBase`. It is just as easy as how you write normal unit tests.
    - existing arquillian tests will be migrated in future PRs.
    
    * all modules under `tests/integration` should only be run after `-DintegrationTests` is specified

 pom.xml                                            |  27 ++++
 tests/integration-tests-topologies/pom.xml         |  16 ++
 .../pulsar/tests/containers/BKContainer.java       |  30 ++++
 .../pulsar/tests/containers/BrokerContainer.java   |  30 ++++
 .../pulsar/tests/containers/CSContainer.java       |  37 +++++
 .../pulsar/tests/containers/ChaosContainer.java    | 116 ++++++++++++++
 .../pulsar/tests/containers/ProxyContainer.java    |  38 +++++
 .../pulsar/tests/containers/PulsarContainer.java   | 111 +++++++++++++
 .../pulsar/tests/containers/ZKContainer.java       |  38 +++++
 .../pulsar/tests/containers/package-info.java      |  22 +++
 .../pulsar/tests/topologies/PulsarCluster.java     | 172 +++++++++++++++++++++
 .../pulsar/tests/topologies/PulsarClusterSpec.java |  74 +++++++++
 .../tests/topologies/PulsarClusterTestBase.java    |  61 ++++++++
 tests/integration-tests-utils/pom.xml              |   7 -
 tests/integration/pom.xml                          |  50 ++++++
 tests/integration/semantics/pom.xml                |  53 +++++++
 .../tests/integration/semantics/SemanticsTest.java |  73 +++++++++
 17 files changed, 948 insertions(+), 7 deletions(-)

commit 99c0ed2d9309ae272a049852889827d227a87882
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jun 29 15:30:36 2018 -0700

    Issue 1416: Docs about garbage collection are inaccurate/lacking (#2049)
    
    *Motivation*
    
    Fixes #1416. Improve documentation around garbage collecting topic in [GeoReplication](http://pulsar.apache.org/docs/latest/admin/GeoReplication/#creating-global-namespaces) documentation page.
    
    *Solution*
    
    - explicitly callout topics only being deleted when no messages are kept for retention.
    - callout the flag to disable garabge collecting inactive topics.

 site/docs/latest/admin/GeoReplication.md | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit f1df0484d1f094d9bd48db18d28e1a1ef233f6db
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 28 15:21:25 2018 -0700

    Fixed resetting of producer sequence id counter after receiving SendError before any message was successfully published (#2047)

 .../broker/service/BrokerBkEnsemblesTests.java     |   8 +-
 .../pulsar/broker/service/RackAwareTest.java       |   4 +-
 .../client/impl/SequenceIdWithErrorTest.java       | 102 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ProducerImpl.java    |   5 +-
 4 files changed, 112 insertions(+), 7 deletions(-)

commit 583ddee954d31721cef647faf504f40a216eedae
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 28 12:24:43 2018 -0700

    Fixed lookups for v2 topics in C++ client lib with HTTP service URL (#2043)
    
    * Fixed lookups for v2 topics in C++ client lib with HTTP service URL
    
    * Fixed formatting
    
    * Fixed path
    
    * Use different topic names in tests
    
    * Fixed formatting

 pulsar-client-cpp/lib/HTTPLookupService.cc   | 37 ++++++++++++++++++++++------
 pulsar-client-cpp/python/pulsar_test.py      | 27 ++++++++++++++++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 30 ++++++++++++++++++++++
 3 files changed, 86 insertions(+), 8 deletions(-)

commit 398a0bdac0754a7354d83102f5888b895db3428b
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jun 29 01:21:02 2018 +0900

    Enable authentication and authorization for some admin APIs (#2046)
    
    ### Motivation
    
    Currently, it seems to that users who are not admin can send POST requests to the REST APIs for configuring retention policy and persistence policies.
    ```
    POST /admin/namespaces/{tenant}/{namespace}/retention
    POST /admin/persistent/{tenant}/{namespace}/persistence
    ```
    I think that only administrators should be able to change these settings.
    
    ### Modifications
    
    Fixed these APIs to authenticate and authorize users by calling the `validateAdminAccessForTenant()` method.
    
    ### Result
    
    Only the administrators of the tenant will be able to change these settings.

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  2 +
 .../apache/pulsar/broker/admin/NamespacesTest.java | 73 +++++++++++++++++-----
 2 files changed, 59 insertions(+), 16 deletions(-)

commit c16dfbe178f31b5b9caa72c1084ff4d0ab275723
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 28 18:04:06 2018 +0200

    Original principal authorization for admin API (#2028)
    
    * Original principal authorization for admin API
    
    The broker admin checks if the authenticated user is listed as a proxy
    user. If so, it checks looks for the header X-Original-Principal, and
    validates that the role is authorized to access the resource in
    question.
    
    There are two use cases:
    
    1. The proxy role is a normal role. In this case, if a resource is to
    be used via the proxy, the proxy user must be explicitly granted
    permission on the resource. So, to use the admin api for a tenant, the
    proxy role must be listed as a tenant admin.
    2. The proxy role is a superuser role. In this case, any resource can
    be used via the proxy as long as the user authorized with the proxy is
    authorized to use the resource. However, if the proxy is compromised,
    a bad actor has full access to the cluster.
    
    This patch is the first part of a fix for #1991.
    
    * Factor out some validation for original principal
    
    Also added a check that if original principal is set, it must have
    come from a role contained in proxyRoles.

 .../broker/admin/impl/PersistentTopicsBase.java    |   4 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   2 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  65 ++++-
 .../pulsar/broker/admin/AdminApiTlsAuthTest.java   | 322 +++++++++++++++++++++
 .../apache/pulsar/broker/admin/NamespacesTest.java |  55 ++--
 .../authentication/tls-http/admin.cert.pem         |  26 ++
 .../authentication/tls-http/admin.key-pk8.pem      |  28 ++
 .../authentication/tls-http/broker.cert.pem        |  27 ++
 .../authentication/tls-http/broker.key-pk8.pem     |  28 ++
 .../resources/authentication/tls-http/ca.cert.pem  |  29 ++
 .../authentication/tls-http/proxy.cert.pem         |  26 ++
 .../authentication/tls-http/proxy.key-pk8.pem      |  28 ++
 .../authentication/tls-http/superproxy.cert.pem    |  26 ++
 .../authentication/tls-http/superproxy.key-pk8.pem |  28 ++
 .../client-keys/proxy.cert.pem                     |  26 ++
 .../client-keys/proxy.csr.pem                      |  15 +
 .../client-keys/proxy.key-pk8.pem                  |  28 ++
 .../client-keys/proxy.key.pem                      |  27 ++
 .../client-keys/superproxy.cert.pem                |  26 ++
 .../client-keys/superproxy.csr.pem                 |  15 +
 .../client-keys/superproxy.key-pk8.pem             |  28 ++
 .../client-keys/superproxy.key.pem                 |  27 ++
 tests/certificate-authority/index.txt              |   3 +
 tests/certificate-authority/index.txt.old          |   3 +
 tests/certificate-authority/newcerts/1002.pem      |  26 ++
 tests/certificate-authority/newcerts/1003.pem      |  26 ++
 tests/certificate-authority/newcerts/1004.pem      |  26 ++
 tests/certificate-authority/serial                 |   2 +-
 tests/certificate-authority/serial.old             |   2 +-
 29 files changed, 933 insertions(+), 41 deletions(-)

commit ae596ed7f546dd6db7e9c5c5623d34c2a1a0bda0
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 28 18:02:47 2018 +0200

    Inject AuthenticationService into ProxyService (#2038)
    
    So that the same authentication service can be used for the webserver also.
    
    Master issue: #1991

 .../java/org/apache/pulsar/proxy/server/ProxyService.java    | 12 ++++++------
 .../org/apache/pulsar/proxy/server/ProxyServiceStarter.java  |  5 ++++-
 .../proxy/server/ProxyAuthenticatedProducerConsumerTest.java |  5 ++++-
 .../apache/pulsar/proxy/server/ProxyAuthenticationTest.java  |  6 +++++-
 .../pulsar/proxy/server/ProxyConnectionThrottlingTest.java   |  5 ++++-
 .../apache/pulsar/proxy/server/ProxyForwardAuthDataTest.java | 10 ++++++++--
 .../pulsar/proxy/server/ProxyLookupThrottlingTest.java       |  7 ++++++-
 .../pulsar/proxy/server/ProxyRolesEnforcementTest.java       |  6 +++++-
 .../test/java/org/apache/pulsar/proxy/server/ProxyTest.java  |  5 ++++-
 .../java/org/apache/pulsar/proxy/server/ProxyTlsTest.java    |  5 ++++-
 .../pulsar/proxy/server/ProxyWithAuthorizationNegTest.java   |  6 +++++-
 .../pulsar/proxy/server/ProxyWithAuthorizationTest.java      | 12 +++++++++---
 .../proxy/server/ProxyWithoutServiceDiscoveryTest.java       |  6 +++++-
 13 files changed, 69 insertions(+), 21 deletions(-)

commit 4487d04dbd9ecb2a73e84ac202d1aa36a4aab788
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 28 08:37:46 2018 -0700

    Add depedency on grpcio and protobuf for Python lib (#2044)
    
    ### Motivation
    
    The functions runtime code for Python depends on 2 libraries (`grpcio` and `protobuf`). These currently needs to be installed manually.
    
    This change will list them as dependency so that `pip install pulsar-client` will also pull them automatically.

 pulsar-client-cpp/python/setup.py | 3 +++
 1 file changed, 3 insertions(+)

commit 7c3070255a24dc47d0cc36477ef91bc53680b06e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jun 27 21:55:23 2018 -0700

    Fix license in binary distribution (#2040)
    
    *Motivation*
    
    versions were upgraded on some dependencies, but the license file is not updated.
    
    *Changes*
    
    - fix the versions
    - drop the dependencies that don't exist
    - add the license for xz-java (public domain)

 all/licenses/LICENSE-JLine.txt   | 29 -----------------------------
 all/licenses/LICENSE-xz.txt      |  1 +
 all/src/assemble/LICENSE.bin.txt | 27 +++++++++++++--------------
 3 files changed, 14 insertions(+), 43 deletions(-)

commit c80dfb6abe6acfc4a95f73b55e43a4702762e12f
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jun 27 19:16:14 2018 +0200

    Move AuthenticationFilter to pulsar-broker-common (#2039)
    
    So that it can be used by the proxy also.
    
    Master issue: #1991

 .../main/java/org/apache/pulsar/broker/web/AuthenticationFilter.java | 5 ++---
 .../src/main/java/org/apache/pulsar/broker/web/WebService.java       | 3 ++-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 174fd02f972e2db19e67874781a503cb264b0099
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jun 26 16:09:55 2018 -0700

    Exclude a few files from apache-rat:check (#2035)
    
    *Motivation*
    
    Apache-rat check is failing
    
    *Changes*
    
    - Exclude two BSD licensed files
    - Exclude files related to certs used for testing

 pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit b0292a182d768b2fead6e433e208e9f59602f24f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 26 15:31:15 2018 -0700

     adding a module that shades managed-ledge (#2034)
    
    * adding a module that shades managed-ledger
    
    * removing commented out lines

 managed-ledger-shaded/pom.xml                      | 291 +++++++++++++++++++++
 managed-ledger/pom.xml                             |   2 +-
 pom.xml                                            |   1 +
 pulsar-broker-auth-athenz/pom.xml                  |   2 +-
 pulsar-broker/pom.xml                              |   4 +-
 .../pulsar-client-kafka-tests/pom.xml              |   2 +-
 .../pulsar-client-kafka/pom.xml                    |   2 +-
 pulsar-client-tools-test/pom.xml                   |   2 +-
 pulsar-discovery-service/pom.xml                   |   4 +-
 pulsar-proxy/pom.xml                               |   2 +-
 pulsar-spark/pom.xml                               |   2 +-
 pulsar-storm/pom.xml                               |   2 +-
 pulsar-testclient/pom.xml                          |   2 +-
 pulsar-websocket/pom.xml                           |   2 +-
 pulsar-zookeeper-utils/pom.xml                     |   4 +-
 tests/integration/s3-offload/pom.xml               |   2 +-
 16 files changed, 309 insertions(+), 17 deletions(-)

commit ca93d4a949ca06c0211be29c47c5c9b22fd91715
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 26 13:59:18 2018 -0700

    Added custom compiled OpenSSL into docker image for RPM/Deb (#2032)

 pulsar-client-cpp/pkg/deb/Dockerfile | 11 +++++++++--
 pulsar-client-cpp/pkg/rpm/Dockerfile | 12 +++++++++---
 2 files changed, 18 insertions(+), 5 deletions(-)

commit bdf52bceb6b22c3421b0c6fc948133bd87559a55
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 26 12:46:22 2018 -0700

    Added integer types casting to avoid compile errors with gcc-4.8 (#2031)

 pulsar-client-go/pulsar/c_consumer.go |  2 +-
 pulsar-client-go/pulsar/c_message.go  | 10 +++++-----
 2 files changed, 6 insertions(+), 6 deletions(-)

commit ae90f22b54cb5f4132542211d4867c066ea7b9e7
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 26 12:18:37 2018 -0700

    Change MessageProcessor Interface to be public (#2030)
    
    * Change MessageProcessor Interface to be public
    
    * remove static

 .../src/main/java/org/apache/pulsar/client/impl/MessageParser.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 97d06c91b7b93b936e77bd009e19576011ea1b46
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 26 11:14:02 2018 -0700

    Fixed C99 variable initialization in cgo header (#2029)

 pulsar-client-go/pulsar/c_go_pulsar.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 8b2929b3e5403fb44653976dc74be287666f7b96
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jun 25 23:54:39 2018 -0700

    Bump Pulsar version to 2.2.0-incubating (#2027)
    
    Signed-off-by: Sijie Guo <sijie@apache.org>

 all/pom.xml                                                   | 2 +-
 buildtools/pom.xml                                            | 2 +-
 docker/grafana/pom.xml                                        | 2 +-
 docker/pom.xml                                                | 2 +-
 docker/pulsar/pom.xml                                         | 2 +-
 managed-ledger/pom.xml                                        | 2 +-
 pom.xml                                                       | 2 +-
 protobuf-shaded/pom.xml                                       | 2 +-
 pulsar-broker-auth-athenz/pom.xml                             | 2 +-
 pulsar-broker-common/pom.xml                                  | 2 +-
 pulsar-broker-shaded/pom.xml                                  | 2 +-
 pulsar-broker/pom.xml                                         | 2 +-
 pulsar-client-admin-shaded/pom.xml                            | 2 +-
 pulsar-client-admin/pom.xml                                   | 2 +-
 pulsar-client-auth-athenz/pom.xml                             | 2 +-
 pulsar-client-kafka-compat/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml  | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml        | 2 +-
 pulsar-client-shaded/pom.xml                                  | 2 +-
 pulsar-client-tools-test/pom.xml                              | 2 +-
 pulsar-client-tools/pom.xml                                   | 2 +-
 pulsar-client/pom.xml                                         | 2 +-
 pulsar-common/pom.xml                                         | 2 +-
 pulsar-discovery-service/pom.xml                              | 2 +-
 pulsar-functions/api-java/pom.xml                             | 2 +-
 pulsar-functions/instance/pom.xml                             | 2 +-
 pulsar-functions/java-examples/pom.xml                        | 2 +-
 pulsar-functions/metrics/pom.xml                              | 2 +-
 pulsar-functions/pom.xml                                      | 2 +-
 pulsar-functions/proto-shaded/pom.xml                         | 2 +-
 pulsar-functions/proto/pom.xml                                | 2 +-
 pulsar-functions/runtime-all/pom.xml                          | 2 +-
 pulsar-functions/runtime-shaded/pom.xml                       | 2 +-
 pulsar-functions/runtime/pom.xml                              | 2 +-
 pulsar-functions/utils/pom.xml                                | 2 +-
 pulsar-functions/worker/pom.xml                               | 2 +-
 pulsar-io/aerospike/pom.xml                                   | 2 +-
 pulsar-io/cassandra/pom.xml                                   | 2 +-
 pulsar-io/core/pom.xml                                        | 2 +-
 pulsar-io/kafka/pom.xml                                       | 2 +-
 pulsar-io/kinesis/pom.xml                                     | 2 +-
 pulsar-io/pom.xml                                             | 2 +-
 pulsar-io/rabbitmq/pom.xml                                    | 2 +-
 pulsar-io/twitter/pom.xml                                     | 2 +-
 pulsar-log4j2-appender/pom.xml                                | 2 +-
 pulsar-proxy/pom.xml                                          | 2 +-
 pulsar-spark/pom.xml                                          | 2 +-
 pulsar-storm/pom.xml                                          | 2 +-
 pulsar-testclient/pom.xml                                     | 2 +-
 pulsar-websocket/pom.xml                                      | 2 +-
 pulsar-zookeeper-utils/pom.xml                                | 2 +-
 pulsar-zookeeper/pom.xml                                      | 2 +-
 tests/docker-images/latest-version-image/pom.xml              | 2 +-
 tests/docker-images/pom.xml                                   | 2 +-
 tests/integration-tests-base/pom.xml                          | 2 +-
 tests/integration-tests-topologies/pom.xml                    | 2 +-
 tests/integration-tests-utils/pom.xml                         | 2 +-
 tests/integration/cli/pom.xml                                 | 2 +-
 tests/integration/compaction/pom.xml                          | 2 +-
 tests/integration/pom.xml                                     | 2 +-
 tests/integration/s3-offload/pom.xml                          | 2 +-
 tests/integration/smoke/pom.xml                               | 2 +-
 tests/pom.xml                                                 | 2 +-
 64 files changed, 64 insertions(+), 64 deletions(-)

commit b5067934b86b263bc6a771ae5d9e656777d6a290
Author: Daniel Jorge <daniel.jorge@sticorp.com.br>
Date:   Mon Jun 25 14:47:19 2018 -0300

    Helm charts for deployment on GKE (#1993)
    
    * Helm charts for deployment on GKE
    
    * Repackaginh helm charts under deployment/kubernetes/helm
    
    * Formatting licences
    
    * Removing cloud specific values to enable more generic deployments

 deployment/kubernetes/helm/README.md               |  23 ++
 deployment/kubernetes/helm/pulsar/.helmignore      |  21 ++
 deployment/kubernetes/helm/pulsar/Chart.yaml       |  24 ++
 .../kubernetes/helm/pulsar/templates/_helpers.tpl  |  32 ++
 .../pulsar/templates/autorecovery-configmap.yaml   |  38 ++
 .../pulsar/templates/autorecovery-deployment.yaml  | 105 ++++++
 .../helm/pulsar/templates/bastion-configmap.yaml   |  35 ++
 .../helm/pulsar/templates/bastion-deployment.yaml  |  80 ++++
 .../pulsar/templates/bookkeeper-configmap.yaml     |  36 ++
 .../helm/pulsar/templates/bookkeeper-pdb.yaml      |  40 ++
 .../helm/pulsar/templates/bookkeeper-service.yaml  |  41 +++
 .../pulsar/templates/bookkeeper-statefulset.yaml   | 159 ++++++++
 .../pulsar/templates/bookkeeper-storageclass.yaml  |  59 +++
 .../helm/pulsar/templates/broker-configmap.yaml    |  40 ++
 .../helm/pulsar/templates/broker-deployment.yaml   | 114 ++++++
 .../helm/pulsar/templates/broker-pdb.yaml          |  40 ++
 .../helm/pulsar/templates/broker-service.yaml      |  41 +++
 .../pulsar/templates/dashboard-deployment.yaml     |  73 ++++
 .../helm/pulsar/templates/dashboard-service.yaml   |  43 +++
 .../helm/pulsar/templates/grafana-deployment.yaml  |  72 ++++
 .../helm/pulsar/templates/grafana-service.yaml     |  43 +++
 .../helm/pulsar/templates/namespace.yaml           |  25 ++
 .../pulsar/templates/prometheus-configmap.yaml     |  70 ++++
 .../pulsar/templates/prometheus-deployment.yaml    |  82 +++++
 .../helm/pulsar/templates/prometheus-pvc.yaml      |  36 ++
 .../helm/pulsar/templates/prometheus-rbac.yaml     |  57 +++
 .../helm/pulsar/templates/prometheus-service.yaml  |  43 +++
 .../pulsar/templates/prometheus-storageclass.yaml  |  41 +++
 .../helm/pulsar/templates/proxy-configmap.yaml     |  42 +++
 .../helm/pulsar/templates/proxy-deployment.yaml    | 109 ++++++
 .../helm/pulsar/templates/proxy-pdb.yaml           |  42 +++
 .../helm/pulsar/templates/proxy-service.yaml       |  43 +++
 .../helm/pulsar/templates/zookeeper-configmap.yaml |  33 ++
 .../helm/pulsar/templates/zookeeper-metadata.yaml  |  58 +++
 .../helm/pulsar/templates/zookeeper-pdb.yaml       |  40 ++
 .../helm/pulsar/templates/zookeeper-service.yaml   |  41 +++
 .../pulsar/templates/zookeeper-statefulset.yaml    | 142 ++++++++
 .../pulsar/templates/zookeeper-storageclass.yaml   |  39 ++
 deployment/kubernetes/helm/pulsar/values.yaml      | 405 +++++++++++++++++++++
 39 files changed, 2507 insertions(+)

commit f7c569614d7d1cdccd306ff5aad3ed7c21e53f2a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jun 25 10:29:21 2018 -0700

     adding pulsar io docs (#2001)

 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  19 ++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  27 ++--
 site/_data/cli/pulsar-admin.yaml                   | 158 +++++++++++++++++++++
 site/_data/connectors.yaml                         |  49 +++++++
 site/_data/sidebar.yaml                            |   2 +
 site/_includes/connectors.html                     |  44 ++++++
 site/_includes/figure.html                         |   9 +-
 site/_sass/_docs.scss                              |  18 +++
 site/docs/latest/cookbooks/pulsar-io.md            |  82 +++++++++++
 .../getting-started/ConceptsAndArchitecture.md     |  28 ++++
 site/img/pulsar-io.png                             | Bin 0 -> 37316 bytes
 11 files changed, 409 insertions(+), 27 deletions(-)

commit 172f05050318889af825b1e7b71ba6f43da8c5df
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 25 09:56:46 2018 -0700

    Added message parser to decode raw headers and payload without a Consumer instance (#2019)
    
    * Added message parser to decode raw headers and payload without a Consumer instance
    
    * Added header

 .../pulsar/client/impl/MessageParserTest.java      | 155 +++++++++++++++++
 .../apache/pulsar/client/impl/MessageParser.java   | 190 +++++++++++++++++++++
 2 files changed, 345 insertions(+)

commit 8a8bef7e22bbc563efe68a5632668a2b44b1dc33
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 25 18:56:24 2018 +0200

    Fixup misleading text in compaction cookbook (#2026)
    
    Previously the text said that keyless messages are ignored, which
    could mean they are retained or are discarded. I've updated the text
    to clarify.

 site/docs/latest/cookbooks/compaction.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 7a5072eeb2330f4fa0d208459d321ed80cccb27e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jun 25 08:07:58 2018 -0700

    Update LICENSE & NOTICE for newly introduced or version-upgraded dependencies  (#2023)
    
    - Add bunch of newly introduced dependencies to the LICENSE file
    - Update dependencies of bookkeeper after upgraded to 4.7.1

 all/licenses/LICENSE-Hamcrest.txt | 27 ++++++++++++++++
 all/src/assemble/LICENSE.bin.txt  | 66 +++++++++++++++++++++++++++++++++++----
 all/src/assemble/NOTICE.bin.txt   | 20 ++++++++++++
 3 files changed, 107 insertions(+), 6 deletions(-)

commit 6eb238b442e145857977d3980d3b6a23dfda671d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jun 23 04:36:24 2018 -0700

    Remove jboss-reflect dependency (#2022)
    
    * Remove jboss-reflect dependency
    
    *Motivation*
    
    `jboss-reflect` is a LGPL dependency, which is in Category-X and can't be used for apache project.
    
    *Solution*
    
    Removed `jboss-reflect` dependency and replace it with a simple util function to load classes.
    
    Signed-off-by: Sijie Guo <sijie@apache.org>

 pom.xml                                            |  7 --
 pulsar-functions/instance/pom.xml                  |  5 --
 .../apache/pulsar/functions/sink/PulsarSink.java   |  4 +-
 .../pulsar/functions/source/PulsarSource.java      |  4 +-
 pulsar-functions/runtime-shaded/pom.xml            |  3 -
 .../apache/pulsar/functions/utils/Reflections.java | 74 ++++++++++++++++++++++
 .../pulsar/functions/utils/ReflectionsTest.java    | 31 +++++++++
 7 files changed, 109 insertions(+), 19 deletions(-)

commit ed5a8ba79c306d2bf015b65354fa2228fc07e0a1
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 22 09:24:46 2018 -0700

    Added REST/CLI tools to manage bookies rack placement config (#2005)
    
    ### Motivation
    
    Currently we don't have tools to manage the rack placement configuration for bookies in a Pulsar cluster.
    
    ### Modifications
    
     * Added `/admin/v2/bookie` REST handler
     * Added `admin.bookie()` in Java admin client
     * Added `pulsar-admin bookies ...` CLI tool
     * Worked around an issue with bookie hostname and hostname:port that prevented BK client to detect the correct rack.
    
    Fixes #151

 .../apache/pulsar/PulsarClusterMetadataSetup.java  |  11 ++
 .../org/apache/pulsar/broker/admin/v2/Bookies.java | 142 +++++++++++++++++++++
 .../broker/service/BrokerBkEnsemblesTests.java     |  13 +-
 .../pulsar/broker/service/RackAwareTest.java       | 133 +++++++++++++++++++
 .../org/apache/pulsar/client/admin/Bookies.java    |  48 +++++++
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  10 ++
 .../pulsar/client/admin/internal/BookiesImpl.java  |  77 +++++++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  23 ++++
 .../org/apache/pulsar/admin/cli/CmdBookies.java    |  90 +++++++++++++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   1 +
 .../pulsar/common/policies/data}/BookieInfo.java   |  28 ++--
 .../policies/data/BookiesRackConfiguration.java    |  58 +++++++++
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   5 +
 .../zookeeper/ZkBookieRackAffinityMapping.java     |  91 ++++++++-----
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |   1 +
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |  34 ++---
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |  39 ++----
 17 files changed, 699 insertions(+), 105 deletions(-)

commit db580362e1a034a67a92fe7cd683b990dda960e1
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Sat Jun 23 00:24:11 2018 +0800

    Cpp client: python client wrapper for reader hasMessageAvaliable (#2011)
    
    In PR #1861, we support  hasMessageAvaliable in reader of cpp client. this is the following work to add wrapper for python.
    
    Change:
    - add python and c wrapper
    - add test in pulsar_test.py

 pulsar-client-cpp/include/pulsar/Reader.h   |  6 ++++++
 pulsar-client-cpp/include/pulsar/c/reader.h |  2 ++
 pulsar-client-cpp/lib/c/c_Reader.cc         |  7 ++++++
 pulsar-client-cpp/python/pulsar/__init__.py |  6 ++++++
 pulsar-client-cpp/python/pulsar_test.py     | 33 +++++++++++++++++++++++++++++
 pulsar-client-cpp/python/src/reader.cc      | 12 +++++++++++
 6 files changed, 66 insertions(+)

commit a43a6822c81333f8369a15d9ac142fcd2bd2a951
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jun 22 18:23:29 2018 +0200

    Add TLS certs to testing docker image (#2021)
    
    So that they can be configured to run with TLS.
    
    The certificate authority used to generate the certs is also included
    in tests/ with instructions on how to generate new user and server
    certs.
    
    These certs will be used for an integration test once #1991 is solved.

 tests/certificate-authority/README.md              |  42 ++++++++
 tests/certificate-authority/certs/ca.cert.pem      |  29 ++++++
 .../client-keys/admin.cert.pem                     |  26 +++++
 .../client-keys/admin.csr.pem                      |  15 +++
 .../client-keys/admin.key-pk8.pem                  |  28 +++++
 .../client-keys/admin.key.pem                      |  27 +++++
 tests/certificate-authority/index.txt              |   2 +
 tests/certificate-authority/index.txt.attr         |   1 +
 tests/certificate-authority/index.txt.attr.old     |   1 +
 tests/certificate-authority/index.txt.old          |   1 +
 tests/certificate-authority/newcerts/1000.pem      |  27 +++++
 tests/certificate-authority/newcerts/1001.pem      |  26 +++++
 tests/certificate-authority/openssl.cnf            | 115 +++++++++++++++++++++
 tests/certificate-authority/private/ca.key.pem     |  54 ++++++++++
 tests/certificate-authority/serial                 |   1 +
 tests/certificate-authority/serial.old             |   1 +
 .../server-keys/broker.cert.pem                    |  27 +++++
 .../server-keys/broker.csr.pem                     |  15 +++
 .../server-keys/broker.key-pk8.pem                 |  28 +++++
 .../server-keys/broker.key.pem                     |  27 +++++
 .../docker-images/latest-version-image/Dockerfile  |  20 ++--
 .../latest-version-image/ssl/admin.cert.pem        |  26 +++++
 .../latest-version-image/ssl/admin.key-pk8.pem     |  28 +++++
 .../latest-version-image/ssl/broker.cert.pem       |  27 +++++
 .../latest-version-image/ssl/broker.key-pk8.pem    |  28 +++++
 .../latest-version-image/ssl/ca.cert.pem           |  29 ++++++
 26 files changed, 639 insertions(+), 12 deletions(-)

commit 2028aa2b476fc3922b1ab29b1ebc8456ab0f5bb1
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Jun 22 09:22:16 2018 -0700

    Closing client when Proxyconnection is disconnected (#1821)
    
    * Closing client when Proxyconnection is disconnected
    
    * Addressed massakam's PR comments
    
    * Fixed test failures with authorization disabled

 .../apache/pulsar/client/impl/ConnectionPool.java  |  4 +-
 .../pulsar/proxy/server/ProxyConnection.java       | 10 +++-
 .../pulsar/proxy/server/ProxyConnectionPool.java   | 59 ++++++++++++++++++++++
 3 files changed, 69 insertions(+), 4 deletions(-)

commit 358b68dd560640ed025f91b13971367ff345a591
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 21 23:42:33 2018 -0700

    add admin-api to update function with url (#1987)
    
    * add admin-api to update function with url
    
    * add cli option for jar-url

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  3 +-
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |  7 ++--
 .../org/apache/pulsar/client/admin/Functions.java  | 22 ++++++++++++
 .../client/admin/internal/FunctionsImpl.java       | 17 ++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  6 +++-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  6 +++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 12 +++++--
 .../functions/worker/rest/api/FunctionsImpl.java   | 21 ++++++++----
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  3 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 39 ++++++++++++++++++++++
 10 files changed, 120 insertions(+), 16 deletions(-)

commit 7c3a3242e0777f07f70c5c2044d4bd799929a78a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jun 21 22:34:16 2018 -0700

    Remove pulsar-common dependency from pulsar-io-core module and cleanup pulsar-common dependency references (#2020)
    
    *Motivation*
    
    With pulsar-common shading in pulsar-client, conflicts observed when using pulsar-client with connectors. Because pulsar-client shades its dependencies,
    while pulsar-io implementations pull in pulsar-common which depends on non-shaded dependencies.
    
    *Changes*
    
    - Move KeyValue class to pulsar-io-core, since all pulsar-io is using it.
    - Remove pulsar-common from all pulsar-io implementation modules
    - Cleanup all direct usage of pulsar-common when pulsar-client-original is in the place.

 pulsar-broker/pom.xml                                        | 12 ------------
 pulsar-client-admin/pom.xml                                  |  6 ------
 pulsar-client-tools/pom.xml                                  |  5 -----
 pulsar-functions/worker/pom.xml                              |  6 ------
 pulsar-io/aerospike/pom.xml                                  |  6 ------
 .../apache/pulsar/io/aerospike/AerospikeAbstractSink.java    |  2 +-
 .../org/apache/pulsar/io/aerospike/AerospikeStringSink.java  |  2 +-
 pulsar-io/cassandra/pom.xml                                  |  6 ------
 .../apache/pulsar/io/cassandra/CassandraAbstractSink.java    |  2 +-
 .../org/apache/pulsar/io/cassandra/CassandraStringSink.java  |  2 +-
 pulsar-io/core/pom.xml                                       |  7 +++++++
 .../src/main/java/org/apache/pulsar/io/core}/KeyValue.java   |  2 +-
 pulsar-io/kafka/pom.xml                                      |  6 ------
 .../java/org/apache/pulsar/io/kafka/KafkaAbstractSink.java   |  2 +-
 .../java/org/apache/pulsar/io/kafka/KafkaStringSink.java     |  2 +-
 pulsar-io/kinesis/pom.xml                                    | 10 +++++++---
 pulsar-io/rabbitmq/pom.xml                                   |  6 ------
 pulsar-proxy/pom.xml                                         |  6 ------
 pulsar-websocket/pom.xml                                     |  6 ------
 19 files changed, 21 insertions(+), 75 deletions(-)

commit bf3ff19701e4aa3e414b0838bda6ce4675f72a4d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Jun 21 21:29:08 2018 -0700

    Pulsar proxy configuration docs (#1895)
    
    * Begin adding pulsar proxy config docs
    
    * fill out missing config parameters
    
    * add missing license header
    
    * add missing config

 conf/proxy.conf                             | 51 ++++++++++--------
 site/_data/config/proxy.yaml                | 81 +++++++++++++++++++++++++++++
 site/docs/latest/admin/Proxy.md             |  8 ++-
 site/docs/latest/reference/Configuration.md |  6 +++
 4 files changed, 123 insertions(+), 23 deletions(-)

commit 7b72a971330d72c323e5c8b669ae8a94fe1a0458
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 21 21:25:19 2018 -0700

    Added Go client library links to navigation bar (#2016)

 site/_includes/navbar.html | 6 ++++++
 1 file changed, 6 insertions(+)

commit 471d35ba4cf7bc7ed60e82a58c91049a7fbb0262
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 21 19:05:49 2018 -0700

    Use single instances for compression codec providers (#2017)

 .../apache/pulsar/client/impl/ConsumerImpl.java    |  4 +-
 .../compression/CompressionCodecProvider.java      | 41 ++++---------------
 .../common/compression/CompressionCodecZLib.java   | 46 +++++++++++++---------
 .../common/compression/CompressorCodecTest.java    |  6 +--
 4 files changed, 39 insertions(+), 58 deletions(-)

commit 4c5c3cf2bd00801e0e19f2cf5fa09e2a82a1cf8f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jun 21 17:28:40 2018 -0700

    Revert "Functions schema integration (#1845)" (#2018)
    
    This reverts commit 97b56cf04dfca81c937a4b640bc8cfc5470d66cb.

 .../client/impl/MultiTopicsConsumerImpl.java       |   8 +-
 pulsar-functions/api-java/pom.xml                  |   6 --
 .../org/apache/pulsar/functions/api/SerDe.java     |  28 +----
 .../pulsar/functions/instance/ContextImpl.java     |   9 --
 .../pulsar/functions/instance/JavaInstance.java    |  32 ++----
 .../producers/AbstractOneOuputTopicProducers.java  |  28 +++--
 .../MultiConsumersOneOuputTopicProducers.java      |  21 ++--
 .../functions/instance/producers/Producers.java    |   4 +-
 .../apache/pulsar/functions/sink/PulsarSink.java   |  36 +++----
 .../pulsar/functions/source/PulsarSource.java      | 115 +++++++++------------
 .../MultiConsumersOneOutputTopicProducersTest.java |  11 +-
 .../pulsar/functions/source/PulsarSourceTest.java  |   7 +-
 12 files changed, 110 insertions(+), 195 deletions(-)

commit d02ea0100d5bab1c3654e4154c08fb751c52ceea
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 21 14:42:45 2018 -0700

    Add trademark for "Apache Pulsar" on website footer (#2015)

 site/_includes/footer.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8284fa178481e0302a385402b2a4caefc339914d
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 21 14:42:33 2018 -0700

    Removed links to github from download page (#2014)

 site/download.md | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit 8599151eeed3bcec78964f40b21793220e0b27ea
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jun 21 12:23:41 2018 -0700

    Issue 1943: remove serializable from builders and add loadData to load configuration from a config map (#2004)
    
    * Issue 1943: remove serializable from builders and add loadData to load configuration from a config map
    
    *Motivation*
    
    Make pulsar users be able to use java Serialization framework for distributing client settings. This is required for using pulsar in frameworks like Spark.
    
    *Changes*
    
    - Remove serializable from builders
    - Add a tool to load client/producer/consumer/reader configuration data from a Map config (which is serializable)
    
    Fixes #1943
    
    * Address review comments:
    
    - add example in javadoc
    - change client builder to `loadConf` as well
    - change ConfigurationDataUtil to merge config to existing settings
    
    Signed-off-by: Sijie Guo <sijie@apache.org>
    
    * set FAIL_ON_UNKNOWN_PROPERTIES to true
    add a test case to make sure exceptions thrown when loading config with unknown properties

 .../apache/pulsar/client/api/ClientBuilder.java    |  23 ++++-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  23 ++++-
 .../pulsar/client/api/ConsumerEventListener.java   |   4 +-
 .../apache/pulsar/client/api/CryptoKeyReader.java  |   3 +-
 .../org/apache/pulsar/client/api/MessageId.java    |   3 +-
 .../apache/pulsar/client/api/ProducerBuilder.java  |  23 ++++-
 .../org/apache/pulsar/client/api/PulsarClient.java |   3 +
 .../apache/pulsar/client/api/ReaderBuilder.java    |  24 ++++-
 .../pulsar/client/impl/ClientBuilderImpl.java      |  14 ++-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  13 ++-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  12 ++-
 .../pulsar/client/impl/ReaderBuilderImpl.java      |  12 ++-
 .../client/impl/conf/ClientConfigurationData.java  |   2 +
 .../client/impl/conf/ConfigurationDataUtils.java   |  75 ++++++++++++++
 .../impl/conf/ProducerConfigurationData.java       |   1 +
 .../impl/conf/ConfigurationDataUtilsTest.java      | 111 +++++++++++++++++++++
 .../MultiConsumersOneOutputTopicProducersTest.java |   5 +
 17 files changed, 326 insertions(+), 25 deletions(-)

commit 0c1cc5452197512d42ea45a24a20981e183301a8
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jun 22 01:52:38 2018 +0900

    Enable C++ message listener to receive messages even if receiver queue size is zero (#2010)

 pulsar-client-cpp/lib/ClientImpl.cc          |   3 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc        |  11 ++-
 pulsar-client-cpp/tests/ZeroQueueSizeTest.cc | 115 +++++++++++++++++++++++++++
 3 files changed, 125 insertions(+), 4 deletions(-)

commit 94418bb3d9d19860ce29c74dff1ef99956769d24
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Jun 21 09:52:20 2018 -0700

    Pulsar Go client docs (#1838)
    
    * add new doc and add new doc to sidebar index
    
    * add section on client instantiation
    
    * begin adding consumer and reader section
    
    * begin adding consumer options table
    
    * add section on building messages
    
    * add more example code for producers and consumers
    
    * finish draft of go client docs
    
    * update reader definition for popovers
    
    * fix typo in reader definition
    
    * add missing license header
    
    * Updated to go docs

 site/_data/popovers.yaml        |   4 +
 site/_data/sidebar.yaml         |   6 +-
 site/docs/latest/admin/Authz.md |   6 +-
 site/docs/latest/clients/go.md  | 449 ++++++++++++++++++++++++++++++++++++++++
 4 files changed, 460 insertions(+), 5 deletions(-)

commit ef92062fa05cc125f7399a1ab5506606a035278e
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Jun 22 01:36:11 2018 +0900

     Fix: set visibility,exclude-libs options to CMAKE_CXX_FLAGS (#1997)
    
    * Fix: set visibility,exclude-libs options to CMAKE_CXX_FLAGS
    
    * Add GCC visibility push(default) for unit test
    
    * Fix undefined reference to auth plugin methods
    
    * Build _pulsar.so without exclude-libs

 pulsar-client-cpp/CMakeLists.txt                   | 12 +++++++----
 pulsar-client-cpp/lib/BoostHash.h                  |  3 ++-
 pulsar-client-cpp/lib/CMakeLists.txt               |  8 +++-----
 pulsar-client-cpp/lib/JavaStringHash.h             |  3 ++-
 pulsar-client-cpp/lib/Murmur3_32Hash.h             |  2 ++
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |  2 ++
 .../lib/SinglePartitionMessageRouter.h             |  2 ++
 pulsar-client-cpp/lib/TopicMetadataImpl.h          |  4 +++-
 pulsar-client-cpp/lib/auth/CMakeLists.txt          | 23 ----------------------
 pulsar-client-cpp/lib/auth/athenz/CMakeLists.txt   | 20 -------------------
 pulsar-client-cpp/python/CMakeLists.txt            |  4 +++-
 11 files changed, 27 insertions(+), 56 deletions(-)

commit a545c2ef71fb1bc260a284596a3ab4283e9b528f
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Fri Jun 22 00:33:48 2018 +0800

    add consumer.seek in python client (#2008)

 pulsar-client-cpp/python/pulsar/__init__.py | 14 ++++++++++++++
 pulsar-client-cpp/python/pulsar_test.py     | 22 ++++++++++++++++++++++
 pulsar-client-cpp/python/src/consumer.cc    | 10 ++++++++++
 3 files changed, 46 insertions(+)

commit b7e3fdd0976b4703cc858ddebf7e9db17d9a9fd8
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 21 18:26:53 2018 +0200

    Downgrade pulsar-client CLI consume warning message (#1485) (#2012)
    
    Previously this log would spam the stdout if there were no messages
    coming in. The message wasn't even factually correct, as the timeout
    had changed.
    
    I've downgraded the log warn to debug can corrected the factual error.

 .../src/main/java/org/apache/pulsar/client/cli/CmdConsume.java          | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit edaaafc50391f44d79ae16b6f35e664ced7f5dc5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jun 21 01:10:19 2018 -0700

    Improve pulsar-client shading (#2006)
    
    * Improve pulsar-client shading
    
    *Motivation*
    
    - we should not shade `org.apache.pulsar.common` classes, since they will be used by pulsar api
    - Change the shading rules for pulsar-client-admin to make sure they have same shading rules as client, so they can be used together.
    
    *Changes*
    
    - Exclude `org.apache.pulsar.common` from pulsar-client shading rule
    - Change shade class prefix for `pulsar-client-admin`
    
    * Use pulsar-client-original in s3-offload integration

 pulsar-client-admin-shaded/pom.xml   | 40 ++++++++++++++++++------------------
 pulsar-client-shaded/pom.xml         |  4 ----
 tests/integration/s3-offload/pom.xml |  2 +-
 3 files changed, 21 insertions(+), 25 deletions(-)

commit 8cc296ea7f44811ea1b6a5a07c4217ea16349227
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 21 00:14:42 2018 -0700

    Enable CRC32-C by default in BK client (#2002)
    
    * Enable CRC32-C by default in BK client
    
    * Added upgrade notes

 conf/broker.conf                                              |  6 +++---
 .../java/org/apache/pulsar/broker/ServiceConfiguration.java   |  6 +++---
 site/release-notes.md                                         | 11 +++++++++++
 3 files changed, 17 insertions(+), 6 deletions(-)

commit 1318c863c7efa7fbb0e3745a57ac06a52a3a8101
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jun 20 18:26:59 2018 -0700

    Add key/value operations in StateContext (#1587)
    
    * Add key/value operations in StateContext
    
    - add `put` operation to allow state to mutate key/value state
    - add `get` operation to allow fetching key/value state
    
    Signed-off-by: Sijie Guo <sijie@apache.org>

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   8 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |   2 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |   2 +-
 .../org/apache/pulsar/functions/api/Context.java   |  25 +++++
 .../pulsar/functions/instance/ContextImpl.java     |  45 +++++++-
 .../functions/instance/JavaInstanceRunnable.java   |  26 +----
 .../functions/instance/state/StateContext.java     |  44 +++++++-
 .../functions/instance/state/StateContextImpl.java |  40 ++++---
 .../pulsar/functions/instance/ContextImplTest.java | 122 +++++++++++++++++++++
 .../instance/state/StateContextImplTest.java       |  97 ++++++++++++++++
 .../example-stateful-function-config.yaml          |  30 +++++
 .../pulsar/functions/runtime/ProcessRuntime.java   |  11 +-
 .../functions/runtime/ProcessRuntimeFactory.java   |   7 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   9 +-
 .../functions/worker/FunctionRuntimeManager.java   |   1 +
 15 files changed, 415 insertions(+), 54 deletions(-)

commit 12864e8a3dd95977aef406a6499dc30bfc5432c0
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Jun 20 16:39:59 2018 -0700

    Compaction documentation follow-up (#1871)
    
    * clarification around compacted vs non-compacted consumers
    
    * clarify that no-key msgs are ignored
    
    * theoretical clarifications
    
    * clarify language around listening/changes

 site/docs/latest/cookbooks/compaction.md                    | 13 ++++++++++---
 site/docs/latest/getting-started/ConceptsAndArchitecture.md | 10 ++++------
 2 files changed, 14 insertions(+), 9 deletions(-)

commit 233c77fca1ac1bfbc439c2246a45673ff366bfc3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jun 20 16:36:50 2018 -0700

    Issue 1967: Non-persistent topic drop too many messages (#1994)
    
    *Motivation*
    
    Fixes #1967.
    
    in 2.0 there is an optimization change on grouping acknowledgements.
    The [optimization change](https://github.com/apache/incubator-pulsar/commit/19dd2c502725e3b45e56541576508626c4213091#diff-debb36270f152d2533b03902f214fa9aR674)
    avoided delivering messages that are already "delivered". However in non-persistent topic, pulsar doesn't store entries to bookkeeper, so no ledger id and entry id
    are assigned for those messages. Pulsar uses 0 for both ledger id and entry. So the optimization change treats messages as already "delivered". so pulsar client
    doesn't dispatch those messages even it already received them from broker.
    
    *Changes*
    
    - Make AcknowledgementsGroupingTracker an interface
    - Introduce a no-op implementation for non-persistent topics
    
    Signed-off-by: Sijie Guo <sijie@apache.org>

 .../impl/AcknowledgmentsGroupingTracker.java       | 185 +-----------------
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  11 +-
 ...NonPersistentAcknowledgmentGroupingTracker.java |  57 ++++++
 .../PersistentAcknowledgmentsGroupingTracker.java  | 209 +++++++++++++++++++++
 .../impl/AcknowledgementsGroupingTrackerTest.java  |   6 +-
 .../org/apache/pulsar/common/naming/TopicName.java |   4 +
 6 files changed, 290 insertions(+), 182 deletions(-)

commit e7cc3544c2ea94dda29120e83a86ed650ce20e2f
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Jun 21 06:56:21 2018 +0800

    Cpp client: add getLastMessageId and hasMessageAvailable in consmer and reader (#1861)
    
    * add getlastmessageid and hasMessageAvailable in consmer and reader
    
    * change following comments
    
    * rebase master, change followinw @ivan's comments

 pulsar-client-cpp/include/pulsar/MessageId.h |   2 +-
 pulsar-client-cpp/include/pulsar/Reader.h    |   6 ++
 pulsar-client-cpp/lib/ClientConnection.cc    |  59 ++++++++++-
 pulsar-client-cpp/lib/ClientConnection.h     |   5 +
 pulsar-client-cpp/lib/Commands.cc            |  18 ++++
 pulsar-client-cpp/lib/Commands.h             |   1 +
 pulsar-client-cpp/lib/ConsumerImpl.cc        |  74 +++++++++++++-
 pulsar-client-cpp/lib/ConsumerImpl.h         |  16 +++
 pulsar-client-cpp/lib/Reader.cc              |  21 ++++
 pulsar-client-cpp/lib/ReaderImpl.cc          |   5 +
 pulsar-client-cpp/lib/ReaderImpl.h           |   2 +
 pulsar-client-cpp/tests/ReaderTest.cc        | 144 +++++++++++++++++++++++++++
 12 files changed, 350 insertions(+), 3 deletions(-)

commit 9ad54466b462c69db395ceb3897bd1a87dd35f2a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 20 13:18:34 2018 -0700

    Upgrade to RocksDB-5.13.3 (#1999)
    
    ### Motivation
    
    Fixes #1049 . The actual fix was included in RocksDB-5.13.3 https://github.com/facebook/rocksdb/issues/2717 and it's now available in Maven central.
    
    The commit that fixed the assertion for empty SSTs was at https://github.com/facebook/rocksdb/commit/8d7396418c11063481ab5b332188509ec0301a7f

 all/src/assemble/LICENSE.bin.txt | 2 +-
 pom.xml                          | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 97b56cf04dfca81c937a4b640bc8cfc5470d66cb
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Wed Jun 20 09:34:51 2018 -0700

    Functions schema integration (#1845)
    
    * wip
    
    * Removed internal shading
    
    * wip
    
    * Fixed handling of IllegalArgumentException in ZK client wrapper
    
    * wip
    
    * Extend SerDe<T> with Schema<T> and implement PulsarSink
    
    * Add Typed Consumers to functions
    
    * Munge functions and schemas together
    
    * Remove consumer/producer changes
    
    * formatting
    
    * Review changes
    
    * Remove context cache and add setConsumer to context
    
    * Addressed Jerry's comments
    
    * Use pulsar-client-original and fix the tests

 .../client/impl/MultiTopicsConsumerImpl.java       |   8 +-
 pulsar-functions/api-java/pom.xml                  |   6 ++
 .../org/apache/pulsar/functions/api/SerDe.java     |  28 ++++-
 .../pulsar/functions/instance/ContextImpl.java     |   9 ++
 .../pulsar/functions/instance/JavaInstance.java    |  32 ++++--
 .../producers/AbstractOneOuputTopicProducers.java  |  28 ++---
 .../MultiConsumersOneOuputTopicProducers.java      |  21 ++--
 .../functions/instance/producers/Producers.java    |   4 +-
 .../apache/pulsar/functions/sink/PulsarSink.java   |  36 +++----
 .../pulsar/functions/source/PulsarSource.java      | 115 ++++++++++++---------
 .../MultiConsumersOneOutputTopicProducersTest.java |  11 +-
 .../pulsar/functions/source/PulsarSourceTest.java  |   7 +-
 12 files changed, 195 insertions(+), 110 deletions(-)

commit da48f42245b572cc283913f937da476810e03fca
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jun 20 09:16:06 2018 -0700

    Enable bookkeeper table service in pulsar standalone (#1922)
    
    
    
    This change is enabling bookkeeper table service component in pulsar standalone. So people can try out stateful functions in pulsar.
    
    Signed-off-by: Sijie Guo <sijie@apache.org>

 pom.xml                                            |  14 +--
 .../org/apache/pulsar/PulsarStandaloneStarter.java |  12 ++-
 pulsar-client-cpp/run-unit-tests.sh                |   3 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   2 +-
 pulsar-client-tools/pom.xml                        |   6 --
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   3 +-
 pulsar-functions/instance/pom.xml                  |   6 --
 .../functions/instance/JavaInstanceRunnable.java   |   3 +-
 pulsar-zookeeper-utils/pom.xml                     |   5 +
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 108 ++++++++++++++++++++-
 10 files changed, 134 insertions(+), 28 deletions(-)

commit c69003dce6908d0567c08a444ca9e98e6b829216
Author: Adam Williams <pwnfactory@gmail.com>
Date:   Wed Jun 20 09:12:59 2018 -0600

    Fix spelling typos (#1998)
    
    Updates occurrences `establised` to `established`

 .../src/main/java/org/apache/pulsar/client/impl/ConsumerImpl.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit bd00214cd664ab3adc0369605430fca3c236572e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 20 00:15:26 2018 -0700

    Fix: avoid closing RuntimeFactory when any function stops (#1988)
    
    * Fix: avoid closing RuntimeFactory when any function stops
    
    * close runtimeFactory for process-runtime

 .../java/org/apache/pulsar/functions/runtime/JavaInstanceMain.java  | 6 +++++-
 .../java/org/apache/pulsar/functions/runtime/RuntimeSpawner.java    | 5 -----
 .../org/apache/pulsar/functions/worker/FunctionRuntimeManager.java  | 3 +++
 3 files changed, 8 insertions(+), 6 deletions(-)

commit 52c77d57c528f2dc4b7022ed8e1082245e1a9729
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 19 23:09:39 2018 -0700

    Add function-package-url support in function cli add url support to function cli (#1956)
    
    * Add function-package-url support in function cli
    
    add url support to function cli
    
    * file-url comment
    
    * add server-side validation for source/sink class and arg-type
    
    remove cmd-line args

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    |   2 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 128 ++++++++++++++++++++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  78 +++++++++----
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  89 ++++++++++----
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  83 +++++++++----
 .../apache/pulsar/functions/utils/SinkConfig.java  |   3 -
 .../pulsar/functions/utils/SourceConfig.java       |   1 -
 .../org/apache/pulsar/functions/utils/Utils.java   |  10 ++
 .../functions/utils/validation/ValidatorImpls.java |  21 +++-
 .../pulsar/functions/worker/FunctionActioner.java  |  43 ++++---
 .../org/apache/pulsar/functions/worker/Utils.java  |   8 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 116 +++++++++++++++++--
 .../functions/worker/FunctionActionerTest.java     |   3 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  68 +++++++++++
 14 files changed, 545 insertions(+), 108 deletions(-)

commit 5ba840a11b067fc9ac2e853416bbdafbb3ffbfba
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 19 14:16:04 2018 -0700

    Fixed python extension build (#1992)
    
    * Fixed python extension build
    
    * Added comment

 .../docker/build-wheel-file-within-docker.sh          | 19 ++++++++++++++-----
 pulsar-client-cpp/docker/build-wheels.sh              |  2 +-
 pulsar-client-cpp/python/pulsar/__init__.py           |  6 +++---
 pulsar-client-cpp/python/setup.py                     |  2 +-
 4 files changed, 19 insertions(+), 10 deletions(-)

commit 693ea906c33b8ca83a8532644fec8c19e482e5a0
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jun 19 20:10:52 2018 +0200

    Use builder methods in getting started docs (#1942)
    
    * Fix topic name in getting started documentation
    
    It was "my-topic", when it should have been
    persistent://public/default/my-topic.
    
    * Remove topic changes

 site/docs/latest/getting-started/LocalCluster.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a9a37c474bf189221bc391baf427452c5d0aa655
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Jun 20 02:42:23 2018 +0900

    Fixed libgtest path in document (#1990)

 site/docs/latest/project/CompileCpp.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 18f44de25c8fb25dee93300b44e2fa2eccbdd2a6
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Jun 20 01:52:45 2018 +0900

    Fixed message popover def (#1986)

 site/_data/popovers.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8b8335c797f49ce17a1040a0a39c8cec82632fa1
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 19 09:52:33 2018 -0700

    add bk dependency to fun-worker for runtime execution (#1989)

 pulsar-functions/worker/pom.xml | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 37ce4fe367ecb1969ddff48ba3d05295f92a7c67
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jun 18 20:52:11 2018 -0700

    Remove `--advertised-address` from docker getting-started section (#1984)
    
    *Motivation*
    
    Fixes #1929
    
    *Changes*
    
    Per [comment](https://github.com/apache/incubator-pulsar/issues/1929#issuecomment-395497432),
    we don't need to specify `--advertised-address` after 1.22.0

 site/docs/latest/getting-started/docker.md | 3 ---
 1 file changed, 3 deletions(-)

commit 70412a9c3c850bc76b93dc7882a3eb6f2713abee
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 18 20:43:04 2018 -0700

    Added release notes for 2.0.1-incubating release (#1985)
    
    * Added release notes for 2.0.1-incubating release`
    
    * Fixed tag link

 site/_config.yml      |  5 +++--
 site/release-notes.md | 36 ++++++++++++++++++++++++++++++++++++
 2 files changed, 39 insertions(+), 2 deletions(-)

commit c293ae33c28fad12c2ff3e90591e2a18ce95e97e
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Jun 19 10:54:53 2018 +0900

    Enable listener to receive messages even if receiver queue size is zero (#1977)
    
    * Enable listener to receive messages even if receiver queue size is zero
    
    * Send flow if acked message is received

 .gitignore                                         |  1 +
 .../pulsar/client/impl/ZeroQueueSizeTest.java      | 48 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 39 ++++++++++++++----
 3 files changed, 81 insertions(+), 7 deletions(-)

commit 4ed4233d9ed0e119b679cb120a014cd456967ac9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jun 18 18:29:24 2018 -0700

    Add documentation for schema CLI (#1983)
    
    *Motivation*
    
    Make sure we document schema CLI
    
    *Solution*
    
    Add the section in pulsar-admin for schemas CLI.
    
    The last `compact` section is duplicated so removed it.

 site/_data/cli/pulsar-admin.yaml | 23 ++++++++++++++++++-----
 1 file changed, 18 insertions(+), 5 deletions(-)

commit 374d2ac51c99a61c9895b1fec095bbb0439b722c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jun 18 18:29:10 2018 -0700

    Improve message id comparison (#1982)
    
    *Motivation*
    
    Fixes #1918
    
    *Solution*
    
    Make sure `MessageIdImpl` and `BatchMessageIdImpl` recognize TopicMessageIdImpl

 .../pulsar/client/impl/BatchMessageIdImpl.java     |  2 ++
 .../apache/pulsar/client/impl/MessageIdImpl.java   | 21 ++++++-----
 .../pulsar/client/impl/TopicMessageIdImpl.java     | 11 ++++++
 .../pulsar/client/impl/MessageIdCompareToTest.java | 42 ++++++++++++++++++++++
 4 files changed, 68 insertions(+), 8 deletions(-)

commit 8ba8acdbe812725df6739c5d19db3e47a553f351
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 18 12:15:28 2018 -0700

    Add documentation and flexible aws-credential plugin to support aws-role (#1972)
    
    * Add documentation and flexible aws-credential plugin to support aws-role
    
    * add protobuf relocation

 pulsar-io/kinesis/pom.xml                          |  11 +-
 .../io/kinesis/AwsCredentialProviderPlugin.java    |  36 ++---
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  | 104 ++++++++------
 .../apache/pulsar/io/kinesis/KinesisSinkTest.java  | 149 +++++++++++++++++++++
 4 files changed, 227 insertions(+), 73 deletions(-)

commit ee061e29b5fa5da570d2f11fc773d4afb9f7a22b
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 18 19:27:09 2018 +0200

    Fix typo in bookkeeper.conf (#1979)

 conf/bookkeeper.conf | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 713478324ea8e5bf6f8dd527f5dc01bdac6663b4
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Mon Jun 18 10:10:03 2018 -0700

    Addind version 1.22.1 to archived_releases (#1976)

 site/_config.yml | 1 +
 1 file changed, 1 insertion(+)

commit 6e0afee599b180d177e4fbfa9d7e720efaaaaa4a
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 18 09:35:44 2018 +0200

    Tiered Storage documentation (#1941)
    
    * Tiered Storage documentation
    
    The patch adds a section in "Concepts and Architecture" and a cookbook
    for setting up tiered storage with S3.
    
    Master Issue: #1511
    
    * Review comments, and pulled a couple things in from Luc's wip patch
    
    * Added automatic triggering and addressed review comments
    
    * Add offload threshold commands to reference

 site/_data/cli/pulsar-admin.yaml                   |  24 ++++
 site/_data/sidebar.yaml                            |   2 +
 site/docs/latest/cookbooks/tiered-storage.md       | 132 +++++++++++++++++++++
 .../getting-started/ConceptsAndArchitecture.md     |  14 +++
 site/img/pulsar-tiered-storage.png                 | Bin 0 -> 9351 bytes
 5 files changed, 172 insertions(+)

commit b2a373d903c183c95dd5e29b317ef03af9bf81ff
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 18 09:35:13 2018 +0200

    Offload threshold policy for namespaces (#1973)
    
    Allow administrators to specify a offload threshold policy on a
    namespace, which stipulates that once a topic in the namespace has a
    certain amount of data on the pulsar cluster, start offloading some of
    this data to longterm storage.
    
    This patch also cleans up TestS3Offload, and adds offload status each
    ledger in topic internal stats.
    
    Master Issue: #1511

 .../pulsar/broker/admin/impl/NamespacesBase.java   |  37 ++++++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  31 +++++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  29 +++++
 .../pulsar/broker/service/BrokerService.java       |   2 +
 .../broker/service/persistent/PersistentTopic.java |   1 +
 .../org/apache/pulsar/client/admin/Namespaces.java |  48 ++++++++
 .../client/admin/internal/NamespacesImpl.java      |  22 ++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  36 ++++++
 .../data/PersistentTopicInternalStats.java         |   1 +
 .../pulsar/common/policies/data/Policies.java      |   7 +-
 .../pulsar/tests/integration/TestS3Offload.java    | 134 ++++++++++++++++-----
 11 files changed, 313 insertions(+), 35 deletions(-)

commit f221b2652e51e5a539da0431cb27d2520e748a7e
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 18 00:34:42 2018 -0700

    Improved instruction for getting started with C++ client lib (#1975)
    
    ### Motivation
    
    Documentation for C++ library was mixed with instructions on how to build the library and how to use it.
    
    ### Modifications
    
     * Split the C++ client page in 2 parts, one for building and one for using
     * Added instructions to build RPM, which is much easier than build directly (since it builds in Docker with all dependencies installed).

 site/_data/sidebar.yaml                |   2 +
 site/docs/latest/clients/Cpp.md        | 128 +++++++++++----------------------
 site/docs/latest/project/CompileCpp.md | 120 +++++++++++++++++++++++++++++++
 3 files changed, 163 insertions(+), 87 deletions(-)

commit fee34d0bf67cfb77f2b1339dc46ece4bf519dd3a
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 15 17:29:46 2018 -0700

    Fixed shading of pulsar-client and pulsar-client-admin (#1974)

 pom.xml                                            |  6 ++++
 pulsar-client-admin-shaded/pom.xml                 | 39 +++++++++++++++++++++-
 .../pulsar-client-kafka-shaded/pom.xml             | 24 +++++++++++--
 pulsar-client-shaded/pom.xml                       | 23 +++++++++++--
 pulsar-common/pom.xml                              |  2 +-
 pulsar-functions/proto/pom.xml                     |  6 ++++
 6 files changed, 94 insertions(+), 6 deletions(-)

commit 4e99ffedbe5d0239eb8e28c300e365bde07c9a44
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Fri Jun 15 12:44:20 2018 -0600

    Add CLI commands for schema registry (#1944)
    
    * Add CLI commands for schema registry
    
    * Rename commandline args
    
    * Fix License Headers Issue
    
    * - all schema structures used in rest apis should have default constructors
    - change version to long in rest apis
    - fix schema cli issues
    
    * Add integration tests for Schema CLI
    
    * Exclude schema example file from license check
    
    * Exclude schema_example.conf from apache-rat:check

 conf/schema_example.conf                           |   7 ++
 pom.xml                                            |   4 +
 .../pulsar/broker/admin/v2/SchemasResource.java    |  24 +++--
 .../broker/service/schema/LongSchemaVersion.java   |   4 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  10 ++
 .../org/apache/pulsar/client/admin/Schemas.java    |  65 +++++++++++++
 .../pulsar/client/admin/internal/SchemasImpl.java  | 102 +++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdSchemas.java    |  86 +++++++++++++++++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |  10 +-
 .../pulsar/common/schema/DeleteSchemaResponse.java |   6 +-
 .../apache/pulsar/common/schema/EmptyVersion.java  |   2 +-
 .../pulsar/common/schema/GetSchemaResponse.java    |   6 +-
 .../apache/pulsar/common/schema/LatestVersion.java |   2 +-
 .../pulsar/common/schema/PostSchemaPayload.java    |   4 +
 .../pulsar/common/schema/PostSchemaResponse.java   |   4 +
 .../apache/pulsar/common/schema/SchemaInfo.java    |   4 +
 .../apache/pulsar/tests/integration/TestCLI.java   |  58 ++++++++++++
 17 files changed, 385 insertions(+), 13 deletions(-)

commit 4625667b79ca81d4c1ea2f221eb3fa228a1e96a7
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 15 08:26:01 2018 -0700

    Added DEB packaging for C++ pulsar client lib (#1970)

 pulsar-client-cpp/pkg/deb/.gitignore            |  1 +
 pulsar-client-cpp/pkg/deb/Dockerfile            | 76 ++++++++++++++++++++
 pulsar-client-cpp/pkg/deb/build-deb.sh          | 95 +++++++++++++++++++++++++
 pulsar-client-cpp/pkg/deb/build-docker-image.sh | 21 ++++++
 pulsar-client-cpp/pkg/deb/docker-build-deb.sh   | 28 ++++++++
 pulsar-client-cpp/pkg/rpm/docker-build-rpm.sh   |  2 +-
 src/stage-release.sh                            |  3 +
 7 files changed, 225 insertions(+), 1 deletion(-)

commit 0b26ce7e25fb3ef6011a286ec9d1263333c28900
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 14 19:22:10 2018 -0700

    Fixed License header for ByteBufCoded{Input,Output}Stream.java (#1971)

 dev/README.md                                      | 21 +++++++++++++++++
 pom.xml                                            |  3 +++
 .../util/protobuf/ByteBufCodedInputStream.java     | 27 ++++------------------
 .../util/protobuf/ByteBufCodedOutputStream.java    | 27 ++++------------------
 4 files changed, 34 insertions(+), 44 deletions(-)

commit 7dac7ba6f008b25e03a415c5c627218029a0d8a2
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 14 16:21:22 2018 -0700

    Added RPM packaging for C++ pulsar client lib (#1963)
    
    * Added RPM packaging for C++ pulsar client lib
    
    * Generate also pulsar-client-devel package
    
    * Added script to generate YUM repo to be published on Apache dist
    
    * Added license files into RPM
    
    * Fixed license copying order

 pulsar-client-cpp/CMakeLists.txt                   |  18 +-
 pulsar-client-cpp/pkg/licenses/LICENSE-boost.txt   |  23 +++
 pulsar-client-cpp/pkg/licenses/LICENSE-jsoncpp.txt |  55 ++++++
 pulsar-client-cpp/pkg/licenses/LICENSE-libcurl.txt |  22 +++
 .../pkg/licenses/LICENSE-protobuf.txt              |  32 +++
 pulsar-client-cpp/pkg/licenses/LICENSE-zlib.txt    |  23 +++
 pulsar-client-cpp/pkg/licenses/LICENSE.txt         | 215 +++++++++++++++++++++
 pulsar-client-cpp/pkg/rpm/.gitignore               |   5 +
 pulsar-client-cpp/pkg/rpm/Dockerfile               |  77 ++++++++
 pulsar-client-cpp/pkg/rpm/SPECS/pulsar-client.spec |  89 +++++++++
 pulsar-client-cpp/pkg/rpm/build-docker-image.sh    |  21 ++
 pulsar-client-cpp/pkg/rpm/build-rpm.sh             |  43 +++++
 pulsar-client-cpp/pkg/rpm/docker-build-rpm.sh      |  28 +++
 src/sign-release.sh                                |   2 +
 src/stage-release.sh                               |  43 +++++
 15 files changed, 690 insertions(+), 6 deletions(-)

commit 44349cc12fecbce85ed729ab2579c2f1038dcee3
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 14 23:07:28 2018 +0200

    Capture zookeeper journal when integration tests end (#1968)
    
    Some issues with integration are hard to debug from the logs
    alone. For example, #1916 looks like bookies are registering with
    zookeeper, but the broker never sees them. It's hard to narrow the
    issue to the client or the server.
    
    This patch adds a stop action for arquillian, which pulls the
    zookeeper data directory at the end of the run, so we can at least
    verify the state of the cluster from the zookeeper point of view.

 ...luster-2-bookie-1-broker-unstarted-with-s3.yaml |  4 +++
 ...single-cluster-3-bookie-2-broker-unstarted.yaml |  4 +++
 .../single-cluster-3-bookie-2-broker.yaml          |  4 +++
 .../java/org/apache/pulsar/tests/DockerUtils.java  | 24 ++++++++++++-
 .../tests/ZKJournalToTargetDirStopAction.java      | 42 ++++++++++++++++++++++
 5 files changed, 77 insertions(+), 1 deletion(-)

commit 31ab19f9a8b8045044a044b9708b2ef28a2285d8
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 14 22:46:08 2018 +0200

    Issue #1722: Fix copy-paste error in ConsumerBuilder javadoc (#1969)

 .../src/main/java/org/apache/pulsar/client/api/ConsumerBuilder.java    | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e10408504d8c7c77e3c20849e90416d0b14fb80a
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 14 18:21:05 2018 +0200

    Human readable sizes when triggering offload (#1962)
    
    When triggering offload from the CLI, allow the user to specify human
    readable sizes, like 10M, 100G etc.
    
    This patch also fixes a bug where the size wasn't being correctly used
    to find the message ID to offload at.
    
    Master Issue: #1511

 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 11 ++++---
 .../pulsar/tests/integration/TestS3Offload.java    | 36 +++++++++++++++-------
 2 files changed, 32 insertions(+), 15 deletions(-)

commit 77502c8b9e1851f5e419146e2d5f67218fef38d1
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 14 18:18:48 2018 +0200

    Allow ML offload immediately after ledger closed (#1965)
    
    The documentation said that only negative values disabled. If a user
    wants data to be offloaded as soon as possible, the obvious thing is
    to set the threshold to 0. Previously this disabled as the check
    was > 0, rather than >=.
    
    This patch changes the ML implementation to accept 0 as a threshold
    and adds a test to ensure if specified, the ledgers are offloaded as
    soon as possible.
    
    Master Issue: #1511

 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  2 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  2 +-
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 31 ++++++++++++++++++++++
 3 files changed, 33 insertions(+), 2 deletions(-)

commit 468242e33d855a35958cfdd854196a50eac093a6
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jun 14 18:17:59 2018 +0200

    Typo compaction threshold rest api (#1966)
    
    Bad copy/paste.

 .../main/java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0a655c16615003d03d6057573aaea09b1d3649cf
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Jun 14 04:48:12 2018 +0900

    Fixed authorization for REST API provided by WebSocket proxy (#1959)
    
    * Fixed authorization for REST API provided by WebSocket proxy
    
    * Change access modifier

 .../websocket/admin/WebSocketWebResource.java      |  16 +-
 .../websocket/admin/WebSocketWebResourceTest.java  | 244 +++++++++++++++++++++
 2 files changed, 255 insertions(+), 5 deletions(-)

commit 08146c21920180fa336bab4a20567263a1833aaf
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu Jun 14 04:47:46 2018 +0900

    Update pulsar cpp client docs (#1957)

 site/docs/latest/clients/Cpp.md | 18 +++++++++++++++---
 1 file changed, 15 insertions(+), 3 deletions(-)

commit 08ffa52eb5f6b55ee862ab18d2836f60ac53a1d0
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jun 13 21:47:20 2018 +0200

    Remove duplication in CLI validation code (#1958)
    
    There was a couple of validation methods which were duplicated
    verbatim among various classes. All have been moved into the
    CliCommand base class as static methods.

 .../org/apache/pulsar/admin/cli/CliCommand.java    | 89 +++++++++++++++++++---
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 50 ------------
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 37 ---------
 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 37 ---------
 4 files changed, 77 insertions(+), 136 deletions(-)

commit 5c2b0aa14f7c3117f70267b5c04e07901ecc2838
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jun 13 21:47:08 2018 +0200

    Trigger offload when managed ledger reaches a size threshold (#1960)
    
    When a managed ledger reaches a certain size, start offloading ledgers
    in the background.
    
    Master Issue: #1511

 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  22 +++
 .../bookkeeper/mledger/ManagedLedgerException.java |   6 +
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  92 ++++++++--
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 189 +++++++++++++++++++++
 4 files changed, 298 insertions(+), 11 deletions(-)

commit 830eef1795bdc6af0be6248625a98cbbc74027e4
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jun 13 21:46:56 2018 +0200

    Remove potential deadlock in offloading (#1961)
    
    Managed ledger has a lock, ledgersListMutex, to control write access
    to the list of ledgers that form the managed ledger.
    
    Normally this lock is locked in a non-blocking way (if it fails it
    backs off and tries again). Offloading added some operations that
    locked in a blocking manner, which can cause some deadlocking, if
    operations are running on the orderedexecutor.
    
    This patch changes the offloading operations to only use tryLock on
    this lock.
    
    Master Issue: #1511

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 82 +++++++++++++---------
 1 file changed, 49 insertions(+), 33 deletions(-)

commit dbfe9b7fc352f3691a5b35ece74727a696fc6d8a
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jun 13 19:28:23 2018 +0200

    Fix race in MultiTopicsConsumerImpl#redeliverUnacknowledgedMessages (#1952)
    
    This method calls #redeliverUnacknowledgedMessages on all underlying
    consumers and clears the incomingMessages queue. There was a race that
    the redelivery could happen before the incomingMessages was cleared,
    and therefore redelivered messages could be lost. Previously this
    block was protected by synchronized(this) block, but this didn't
    protect against any other blocks.
    
    This patch changes the synchronization to use the writeLock of the
    same lock which is acquired before messages are pushed onto the queue.
    
    This race was the source of flake in
    ResendRequestTest.testSharedSingleAckedPartitionedTopic
    
    Issue: #1160

 .../org/apache/pulsar/client/impl/MultiTopicsConsumerImpl.java     | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit e45d9e37b5b8efc2ae347b6ad24ecc9cedef7121
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 13 10:16:42 2018 -0700

    Workaround for ZK 3.4->3.5 upgrade (#1955)

 all/src/assemble/LICENSE.bin.txt                   |  4 +-
 pom.xml                                            |  2 +-
 .../org/apache/pulsar/PulsarStandaloneStarter.java |  6 +--
 .../pulsar/zookeeper/FileTxnSnapLogWrapper.java    | 60 ++++++++++++++++++++++
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |  8 ++-
 pulsar-zookeeper/pom.xml                           |  7 ++-
 .../pulsar/zookeeper/ZooKeeperServerAspect.java    | 20 +++++++-
 7 files changed, 97 insertions(+), 10 deletions(-)

commit 311817f91eacd49811589d5bf75e54c8221fb642
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 12 22:09:10 2018 -0700

    adding protobuf schema check support (#1954)
    
    * adding protobuf schema check support
    
    * refactoring pom

 pulsar-broker/pom.xml                              |  1 +
 .../schema/AvroSchemaCompatibilityCheck.java       | 14 ++--
 .../schema/ProtobufSchemaCompatibilityCheck.java   | 37 ++++++++++
 .../schema/SchemaCompatibilityStrategy.java        | 25 +++++++
 .../schema/AvroSchemaCompatibilityCheckTest.java   |  6 +-
 .../api/SimpleTypedProducerConsumerTest.java       | 79 ++++++++++++++++++++++
 .../src/test/proto/ProtobufSchemaTest.proto        | 45 ++++++++++++
 pulsar-client/pom.xml                              | 33 +++++++++
 .../pulsar/client/impl/schema/ProtobufSchema.java  |  7 +-
 .../pulsar/client/schemas/ProtobufSchemaTest.java  | 28 ++++++++
 pulsar-client/src/test/proto/Test.proto            | 41 +++++++++++
 11 files changed, 300 insertions(+), 16 deletions(-)

commit c715022895cf7745538cef5075948b6be0ea11fa
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 12 11:48:32 2018 -0700

    Simplified authentication wiht Python client lib (#1921)
    
    * Simplified authentication wiht Python client lib
    
    * Fixed class inheritance
    
    * Fixed inheritance issue
    
    * Fixed tests and segfault

 pulsar-client-cpp/python/pulsar/__init__.py    | 45 +++++++++++++++++++++++---
 pulsar-client-cpp/python/pulsar_test.py        | 30 ++++++++++++++++-
 pulsar-client-cpp/python/src/authentication.cc | 24 ++++++++++++++
 pulsar-client-cpp/python/src/utils.h           |  1 +
 4 files changed, 95 insertions(+), 5 deletions(-)

commit 3b1c6db32e31cd6d95fd0fd9527d5d00f5ab4d89
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Jun 13 01:47:23 2018 +0900

    Fixed Python sample code (#1951)

 site/docs/latest/clients/Python.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 0cd33b8bf2459cae1c5230ef6d84a96c43039d41
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 12 09:46:20 2018 -0700

    Added documentation for authn & authz plugins (#1907)
    
    * Added documentation for authn & authz plugins
    
    * Fixed link to examples

 site/_data/sidebar.yaml                  |   2 +
 site/docs/latest/reference/CustomAuth.md | 228 +++++++++++++++++++++++++++++++
 2 files changed, 230 insertions(+)

commit 673db8bf4d74ee11bf6797edcc4f7227f54a0cb5
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 11 19:46:27 2018 +0200

    Documentation for threshold based compaction (#1948)
    
    Updates for reference and cookbook documentation for compaction to
    show users how to set up automatic compaction based on a size threshold.

 site/_data/cli/pulsar-admin.yaml                      | 10 ++++++++++
 site/docs/latest/cookbooks/compaction.md              | 19 +++++++++++++++----
 .../latest/getting-started/ConceptsAndArchitecture.md |  2 +-
 3 files changed, 26 insertions(+), 5 deletions(-)

commit 2dae33d6816fd304913bc31352d086e2fde2b38c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jun 11 10:46:09 2018 -0700

     adding avro schema (#1917)
    
    * adding avro schema
    
    * improving implementation
    
    * finishing implementation
    
    * remove unnecessary newlines
    
    * fixing poms
    
    * adding avro schema check
    
    * add missing license header
    
    * Add types to proto definitions
    
    * adding compatibiliy unit tests
    
    * shade avro dependencies
    
    * add shading to pulsar client kafka

 pom.xml                                            |   1 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   3 +-
 pulsar-broker-shaded/pom.xml                       |  29 ++++
 pulsar-broker/pom.xml                              |   6 +
 .../apache/pulsar/broker/service/ServerCnx.java    |   4 +
 .../schema/AvroSchemaCompatibilityCheck.java       |  87 ++++++++++++
 .../service/schema/SchemaRegistryServiceImpl.java  |   9 ++
 .../src/main/proto/SchemaRegistryFormat.proto      |   2 +
 .../schema/AvroSchemaCompatibilityCheckTest.java   | 149 +++++++++++++++++++++
 .../api/SimpleTypedProducerConsumerTest.java       | 125 +++++++++++++++++
 pulsar-client-admin-shaded/pom.xml                 |  29 ++++
 .../pulsar-client-kafka-shaded/pom.xml             |  29 ++++
 pulsar-client-shaded/pom.xml                       |  29 ++++
 pulsar-client/pom.xml                              |   6 +
 .../pulsar/client/impl/schema/AvroSchema.java      |  98 ++++++++++++++
 .../pulsar/client/schemas/AvroSchemaTest.java      | 109 +++++++++++++++
 .../org/apache/pulsar/common/api/Commands.java     |   4 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  |   6 +
 .../apache/pulsar/common/schema/SchemaType.java    |  10 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   2 +
 20 files changed, 735 insertions(+), 2 deletions(-)

commit 8ab6c34541eac5ee14e38764c2d4e3db13000da5
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Jun 12 01:18:23 2018 +0800

    Cpp client: add readCompacted in consumer config (#1858)
    
    * add readCompacted in consumer config
    
    * change following comments
    
    * change following comments
    
    * add config in c wrapper
    
    * add e2e test in pulsar_test
    
    * add readerconfig in c wrapper
    
    * change following @ivan's comments
    
    * fix rebase error

 .../include/pulsar/ConsumerConfiguration.h         |   3 +
 .../include/pulsar/ReaderConfiguration.h           |   3 +
 .../include/pulsar/c/consumer_configuration.h      |   5 +
 .../include/pulsar/c/reader_configuration.h        |   5 +
 pulsar-client-cpp/lib/ClientImpl.cc                |   6 ++
 pulsar-client-cpp/lib/Commands.cc                  |   3 +-
 pulsar-client-cpp/lib/Commands.h                   |   3 +-
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |   4 +
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |   4 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  10 +-
 pulsar-client-cpp/lib/ConsumerImpl.h               |   2 +
 pulsar-client-cpp/lib/ReaderConfiguration.cc       |   4 +
 pulsar-client-cpp/lib/ReaderConfigurationImpl.h    |   7 +-
 pulsar-client-cpp/lib/ReaderImpl.cc                |   1 +
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc |   9 ++
 pulsar-client-cpp/lib/c/c_ReaderConfiguration.cc   |   9 ++
 pulsar-client-cpp/python/pulsar/__init__.py        |   5 +-
 pulsar-client-cpp/python/pulsar_test.py            |  55 +++++++++++
 pulsar-client-cpp/python/src/config.cc             |   4 +
 .../tests/ConsumerConfigurationTest.cc             | 105 +++++++++++++++++++++
 20 files changed, 239 insertions(+), 8 deletions(-)

commit 6289cbc9bd8a38bd02e59bd47565c169f73886f8
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 11 10:17:57 2018 -0700

    fix: jackson conflict dependency version (#1947)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3db064396fcd5f855ef720940d76092ea86a6c54
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 11 06:13:37 2018 +0200

    Fix reference configuration display (#1940)
    
    Long lines were not wrapping, so they were overflowing on the next
    cell. Maybe not a problem if you have a gigantic monitor, but a lot of
    people do not.

 site/_sass/_docs.scss | 2 --
 1 file changed, 2 deletions(-)

commit cb4f6ad71f6365b5369ca9705c3bf6985335995a
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sat Jun 9 14:46:40 2018 -0500

    Pulsar Functions resource docs (#1760)
    
    * add section on function resources to overview
    
    * add resource flags to YAML
    
    * add section to deployment doc
    
    * add runtime info

 site/_data/cli/pulsar-admin.yaml                | 12 ++++++++++
 site/docs/latest/admin-api/persistent-topics.md |  2 --
 site/docs/latest/functions/deployment.md        | 26 ++++++++++++++++++++-
 site/docs/latest/functions/overview.md          | 30 ++++++++++++++++++++++---
 4 files changed, 64 insertions(+), 6 deletions(-)

commit 3e74affc869b60a5ce347bd9af1d0ac9842de876
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Jun 9 21:45:08 2018 +0200

    OffloadIndex should have metadata len immediately before metadata (#1911)
    
    Previous to this patch, we had the metadata length, then the index
    entry count, then the metadata. That's weird.
    
    This patch moves the metadata length to immediately before the
    metadata.
    
    Master Issue: #1511

 .../pulsar/broker/s3offload/impl/OffloadIndexBlockImpl.java | 13 ++++++-------
 .../pulsar/broker/s3offload/impl/OffloadIndexTest.java      |  2 +-
 2 files changed, 7 insertions(+), 8 deletions(-)

commit 2245c3785e161d3d421bdd2120e0272878b01c6f
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Jun 9 21:41:39 2018 +0200

    Rest API, AdminClient and CLI for compaction threshold (#1924)
    
    Allow the user to specify a namespace policy for the maximum backlog
    size for topics in that namespace. When a topic backlog reaches this
    size, compaction is triggered.

 .../pulsar/broker/admin/impl/NamespacesBase.java   | 41 ++++++++++++++++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  | 30 ++++++++++++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  | 29 +++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java | 47 ++++++++++++++++++
 .../client/admin/internal/NamespacesImpl.java      | 22 +++++++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 33 +++++++++++++
 .../single-cluster-3-bookie-2-broker.yaml          |  2 +
 .../pulsar/tests/integration/TestCompaction.java   | 57 ++++++++++++++++++++++
 8 files changed, 261 insertions(+)

commit 2bf387d00262db38754ca804956cd83fccd4c512
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 8 17:36:07 2018 -0700

    Use broker advertisedAddress + tls url in function worker (#1946)

 .../src/main/java/org/apache/pulsar/PulsarBrokerStarter.java  | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 8682776b2ae82353e05975c69a2fa7cd21f99a03
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 8 17:35:48 2018 -0700

    Fix: managedledger factory shutdown stuck when any of ledger future-result is not completed (#1945)

 .../mledger/impl/ManagedLedgerFactoryImpl.java     |  1 +
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 36 +++++-----------------
 2 files changed, 9 insertions(+), 28 deletions(-)

commit 51a7c02d5317d9c40db11e17f469e77e21372996
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jun 8 16:08:53 2018 -0700

    Have the ability to specify instance id offset in localrun (#1938)
    
    * Have the ability to specify instance id offset in localrun
    
    * Fixed compilation issue
    
    * Init instanceOffSet with 0

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 10 +++++++---
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java    |  2 +-
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java  |  2 +-
 3 files changed, 9 insertions(+), 5 deletions(-)

commit 7a86673ce4f6eece3281e0fa91da4c6543cedcd7
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jun 8 23:20:56 2018 +0200

    Instructions to build site on linux without root (#1939)
    
    * Instructions to build site on linux with root
    
    Previously you required root access in linux to build a bunch of html
    files. This patch makes it so you no longer need root to run the
    actual build, and adds instructions on how to do so also.
    
    * Missing a line between license and first command

 site/README.md                 | 43 ++++++++++++++++++++++++++++++++++++++++--
 site/scripts/python-doc-gen.sh |  8 +++++---
 2 files changed, 46 insertions(+), 5 deletions(-)

commit 6e336b4080f02370c667e1a93d5d7c65b982d562
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 8 13:00:12 2018 -0700

    Add Client auth plugin and tls support for function to connect with broker (#1935)
    
    * Add Client auth plugin and tls support for function to connect with broker
    
    * add authConfig builder
    
    * add hostnameverification and tlsCertPath
    
    * add broker-tls url on worker
    
    * take string type for boolean data-type

 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 89 ++++++++++++++++++----
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 36 +++++++--
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 29 ++++++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 29 ++++++-
 .../client/impl/conf/ClientConfigurationData.java  |  2 +-
 .../functions/instance/AuthenticationConfig.java   | 44 +++++++++++
 .../src/main/python/python_instance_main.py        | 21 ++++-
 .../pulsar/functions/runtime/JavaInstanceMain.java | 46 ++++++++---
 .../pulsar/functions/runtime/ProcessRuntime.java   | 31 +++++++-
 .../functions/runtime/ProcessRuntimeFactory.java   |  8 +-
 .../functions/runtime/ThreadRuntimeFactory.java    | 41 +++++++---
 .../functions/runtime/ProcessRuntimeTest.java      |  2 +-
 .../functions/worker/FunctionRuntimeManager.java   | 12 ++-
 .../pulsar/functions/worker/MembershipManager.java |  4 +-
 .../org/apache/pulsar/functions/worker/Utils.java  | 17 ++++-
 .../org/apache/pulsar/functions/worker/Worker.java |  4 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  8 +-
 .../pulsar/functions/worker/WorkerService.java     | 15 +++-
 18 files changed, 375 insertions(+), 63 deletions(-)

commit 19505381e4cb0ddbaaab6d2c76de2b8fd8a0f10d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jun 8 09:14:21 2018 -0700

    Added a bunch of concrete sources/sinks so that they are usable without having to write code (#1934)
    
    Currently Kafka/Cassandra/Aerospike connectors are all abstract which means that to use them, one has to actually write a concrete class. This pr adds a bunch of concrete classes so that these classes are usable right away without having to write any code

 ...rospikeSink.java => AerospikeAbstractSink.java} |  4 +--
 .../pulsar/io/aerospike/AerospikeStringSink.java   | 33 ++++++++++++++++++++++
 ...ssandraSink.java => CassandraAbstractSink.java} |  4 +--
 .../pulsar/io/cassandra/CassandraStringSink.java   | 33 ++++++++++++++++++++++
 .../{KafkaSink.java => KafkaAbstractSink.java}     |  4 +--
 .../{KafkaSource.java => KafkaAbstractSource.java} |  4 +--
 .../apache/pulsar/io/kafka/KafkaStringSink.java    | 33 ++++++++++++++++++++++
 .../apache/pulsar/io/kafka/KafkaStringSource.java  | 33 ++++++++++++++++++++++
 8 files changed, 140 insertions(+), 8 deletions(-)

commit bff4f8b34e4881e5673dd9d739334a424a137dd5
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Sat Jun 9 00:13:01 2018 +0800

    Cpp client: fix flaky seek test  (#1936)
    
    In BasicEndToEndTest, test case TEST(BasicEndToEndTest, testSeek) is flaky because of not wait enough time for consumer connection. This PR add sleep time to fix it.

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit c2e9219780140c1a96da36d0cd78acc2bc1b8402
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jun 8 17:30:46 2018 +0200

    Fix doc build error on broker config (#1937)
    
    A recent change added a description with a : to the config data. This
    broke the yaml parser.
    
    Solution is to quote the string in question.

 site/_data/config/broker.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4beb677272090f0db3e19806d51263f59cee254a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jun 7 15:03:49 2018 -0700

    The check should be for null (#1932)

 .../src/main/java/org/apache/pulsar/io/twitter/TwitterFireHose.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 268c73b68d437be4037ef775d97ee4056882f84b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jun 7 14:54:55 2018 -0700

    Only set parameters when things are not null (#1931)
    
    * Only set parameters when things are not null
    
    * Removed unnecessary check

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java       | 8 ++++++--
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java     | 4 +++-
 2 files changed, 9 insertions(+), 3 deletions(-)

commit 4b37fdaeb1f0a286e591e44120da46d33a1c0cc5
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 7 13:35:00 2018 -0700

    Introduce kinesis sink on function (#1904)
    
    * Introduce kinesis sink on function
    
    add pulsarSinkE2E test
    
    * remove kinesis test and dep

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   2 +-
 .../org/apache/pulsar/io/PulsarSinkE2ETest.java    | 293 +++++++++++++++++++++
 .../client/admin/internal/FunctionsImpl.java       |   2 +-
 pulsar-functions/worker/pom.xml                    |   2 +-
 .../pulsar/functions/worker/FunctionActioner.java  |   2 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   4 +-
 pulsar-io/kinesis/pom.xml                          | 125 +++++++++
 .../io/kinesis/AwsCredentialProviderPlugin.java    |  60 +++++
 .../org/apache/pulsar/io/kinesis/KinesisSink.java  | 250 ++++++++++++++++++
 .../pulsar/io/kinesis/KinesisSinkConfig.java       |  57 ++++
 pulsar-io/pom.xml                                  |   1 +
 11 files changed, 792 insertions(+), 6 deletions(-)

commit d77833a479f203af3eeba3f2c97aefb8f818fcea
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jun 8 01:02:12 2018 +0900

    Make Python code work with Pulsar Function localrun (#1930)

 pulsar-functions/instance/src/main/python/python_instance_main.py | 4 ++--
 pulsar-functions/instance/src/main/python/util.py                 | 5 +++--
 2 files changed, 5 insertions(+), 4 deletions(-)

commit e5256f1f2022b0a256af6f28a85d74f54a02d8e0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 7 00:17:54 2018 -0700

    fix pkg location init (#1927)
    
    * fix pkg location init
    
    * test download-dir with permission

 .../pulsar/functions/worker/FunctionActioner.java     | 19 ++++++++++---------
 .../pulsar/functions/worker/FunctionActionerTest.java |  2 ++
 2 files changed, 12 insertions(+), 9 deletions(-)

commit 57f463d11604533e3d3215baaf43e874a73da03d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 6 22:00:01 2018 -0700

    Support pulsar source to start consumer with topic patterns (#1903)
    
    Pass sourceConfig.topicPattern from cmdSink
    
    add test for topic-patterns
    
    add topic-pattern to ProcessRunTime
    
    document topicsPattern usage for java-func only
    
    add python instance validaiton for topicPatterns args
    
    getSequenceId for topicMessage

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 25 +++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 78 ++++++++++++----------
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  8 +++
 .../functions/instance/JavaInstanceRunnable.java   |  1 +
 .../pulsar/functions/source/PulsarSource.java      | 25 ++++++-
 .../functions/source/PulsarSourceConfig.java       |  1 +
 .../src/main/python/python_instance_main.py        |  3 +
 .../pulsar/functions/source/PulsarSourceTest.java  | 21 ++----
 .../proto/src/main/proto/Function.proto            |  1 +
 .../pulsar/functions/runtime/JavaInstanceMain.java |  8 +++
 .../pulsar/functions/runtime/ProcessRuntime.java   |  6 ++
 .../pulsar/functions/runtime/RuntimeSpawner.java   | 10 +++
 .../functions/runtime/ProcessRuntimeTest.java      |  7 +-
 .../pulsar/functions/utils/FunctionConfig.java     |  2 +
 .../apache/pulsar/functions/utils/SinkConfig.java  |  3 +
 .../org/apache/pulsar/functions/utils/Utils.java   | 35 +++++-----
 .../functions/utils/validation/ValidatorImpls.java |  7 +-
 17 files changed, 169 insertions(+), 72 deletions(-)

commit e30dd354e246c4a6553b55a09697173df2a26bbc
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Wed Jun 6 15:16:37 2018 -0700

    Add pulsar python client osx vagrant templates (#1919)
    
    * Add pulsar python client osx vagrant templates
    
    * Change file name and aggregate build
    
    * Change file name and aggregate build
    
    * Move file location
    
    * Update license
    
    * Add Header to reaminging files

 .gitignore                                         | 10 ++++-
 pulsar-client-cpp/python/pkg/osx/build.sh.template | 47 ++++++++++++++++++++
 .../python/pkg/osx/generate-all-wheel.sh           | 50 ++++++++++++++++++++++
 .../python/pkg/osx/osx-10.11-python2.7/Vagrantfile | 28 ++++++++++++
 .../pkg/osx/osx-10.11-python2.7/build.sh.template  |  1 +
 .../osx/osx-10.11-python2.7/generate-wheel-file.sh | 32 ++++++++++++++
 .../python/pkg/osx/osx-10.11-python3.6/Vagrantfile | 28 ++++++++++++
 .../pkg/osx/osx-10.11-python3.6/build.sh.template  |  1 +
 .../osx/osx-10.11-python3.6/generate-wheel-file.sh | 32 ++++++++++++++
 .../python/pkg/osx/osx-10.12-python2.7/Vagrantfile | 28 ++++++++++++
 .../pkg/osx/osx-10.12-python2.7/build.sh.template  |  1 +
 .../osx/osx-10.12-python2.7/generate-wheel-file.sh | 32 ++++++++++++++
 .../python/pkg/osx/osx-10.12-python3.6/Vagrantfile | 28 ++++++++++++
 .../pkg/osx/osx-10.12-python3.6/build.sh.template  |  1 +
 .../osx/osx-10.12-python3.6/generate-wheel-file.sh | 32 ++++++++++++++
 .../python/pkg/osx/osx-10.13-python2.7/Vagrantfile | 29 +++++++++++++
 .../pkg/osx/osx-10.13-python2.7/build.sh.template  |  1 +
 .../osx/osx-10.13-python2.7/generate-wheel-file.sh | 32 ++++++++++++++
 .../python/pkg/osx/osx-10.13-python3.6/Vagrantfile | 29 +++++++++++++
 .../pkg/osx/osx-10.13-python3.6/build.sh.template  |  1 +
 .../osx/osx-10.13-python3.6/generate-wheel-file.sh | 32 ++++++++++++++
 21 files changed, 474 insertions(+), 1 deletion(-)

commit 5f7e367323d1ed4d79eaf23a166730395ec934b4
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 6 14:07:16 2018 -0700

    fix func pkgUrl validation (#1925)
    
    * fix func pkgUrl validation
    
    * add test-cases
    
    * move isFunctionPackageUrlSupported to utils

 .../pulsar/functions/worker/FunctionActioner.java  |   7 +-
 .../org/apache/pulsar/functions/worker/Utils.java  |   7 +
 .../functions/worker/rest/api/FunctionsImpl.java   |   7 +-
 .../functions/worker/FunctionActionerTest.java     | 147 +++++++++++++++++++++
 4 files changed, 159 insertions(+), 9 deletions(-)

commit 91cfd2cb6cd4fb3219a841554b2791c149452e78
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 6 11:34:13 2018 -0700

    Upgrade Lombok to 1.18.0 to work with JDK 10 (#1923)

 all/src/assemble/LICENSE.bin.txt | 2 +-
 pom.xml                          | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

commit cd28ebfb6dbd1400d72a461d0c7790bddd0d6de4
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jun 6 18:30:24 2018 +0200

    Monitor thread to check if topics need compaction (#1915)
    
    Similar to other monitors, runs every 60 seconds by default, and
    checks whether any persistent topics need to be compacted.

 conf/broker.conf                                   |  3 +++
 .../apache/pulsar/broker/ServiceConfiguration.java | 10 ++++++++++
 .../pulsar/broker/service/BrokerService.java       | 22 ++++++++++++++++++++++
 site/_data/config/broker.yaml                      |  3 +++
 4 files changed, 38 insertions(+)

commit 881e27408e6e3d94082712ca2ab4ad7f52b50cb5
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 6 06:57:34 2018 -0700

    Added authentication support in Go client lib (#1920)

 pulsar-client-cpp/homebrew/libpulsar.rb |  2 +-
 pulsar-client-go/pulsar/c_client.go     | 54 +++++++++++++++++++++++++++++++--
 pulsar-client-go/pulsar/c_go_pulsar.h   |  1 +
 pulsar-client-go/pulsar/client.go       | 20 ++++++++++--
 4 files changed, 70 insertions(+), 7 deletions(-)

commit 18abc78606b9319c4bde779a03527224633a5fae
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 5 17:22:17 2018 -0700

    Link internal C++ authentication plugins inside client library (#1913)
    
    * Link internal C++ authentication plugins inside client library
    
    * Removed ztsClient from link list
    
    * Also expose TLS and Athenz in C API
    
    * Fixed certificate path

 pulsar-client-cpp/include/pulsar/Authentication.h  | 47 +++++++++++++++++++++-
 .../include/pulsar/c/authentication.h              |  5 +++
 pulsar-client-cpp/lib/CMakeLists.txt               |  7 ++--
 pulsar-client-cpp/lib/auth/AuthAthenz.cc           |  4 --
 pulsar-client-cpp/lib/auth/AuthAthenz.h            | 14 -------
 pulsar-client-cpp/lib/auth/AuthTls.cc              | 17 ++++----
 pulsar-client-cpp/lib/auth/AuthTls.h               | 23 +++--------
 pulsar-client-cpp/lib/auth/CMakeLists.txt          |  9 +----
 pulsar-client-cpp/lib/auth/athenz/CMakeLists.txt   |  3 +-
 pulsar-client-cpp/lib/c/c_Authentication.cc        | 15 ++++++-
 pulsar-client-cpp/python/CMakeLists.txt            |  6 ++-
 pulsar-client-cpp/tests/AuthPluginTest.cc          | 26 +++++-------
 pulsar-client-cpp/tests/CMakeLists.txt             |  2 +-
 13 files changed, 100 insertions(+), 78 deletions(-)

commit 61a0bb0fb7fad61577890adf347b47eade5803dc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 5 14:38:28 2018 -0700

     adding protobuf schema (#1908)
    
    * adding protobuf schema
    
    * cleaning up
    
    * adjusting pulsar client pom
    
    * improve protobuf parsing
    
    * remove extra space

 pulsar-client/pom.xml                              | 14 ++++
 .../pulsar/client/impl/schema/ProtobufSchema.java  | 81 ++++++++++++++++++++++
 .../pulsar/client/schemas/ProtobufSchemaTest.java  | 42 +++++++++++
 .../apache/pulsar/common/schema/SchemaType.java    |  4 +-
 4 files changed, 140 insertions(+), 1 deletion(-)

commit 439f084147065bec2005b2796cd50dc4aecb777e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 5 13:29:44 2018 -0700

    Fix: GLIBC_2.14  dep issue for protoc-3.5.0-linux-x86_64 (#1914)

 managed-ledger/pom.xml         | 2 +-
 pom.xml                        | 1 +
 pulsar-broker/pom.xml          | 2 +-
 pulsar-functions/proto/pom.xml | 2 +-
 4 files changed, 4 insertions(+), 3 deletions(-)

commit 59c4a6f3595e705b5c73a73e937fd1011c5ad874
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jun 5 20:03:00 2018 +0200

    Use consistent naming for cluster envvar in integ test (#1909)
    
    Previously we were using cluster in some places, and clusterName in
    others. Settles on clusterName, as that's what the config files
    expects. Also changes the znode wait to be cluster specific.

 .../latest-version-image/scripts/init-cluster.sh              |  4 ++--
 .../docker-images/latest-version-image/scripts/run-bookie.sh  |  2 +-
 .../docker-images/latest-version-image/scripts/run-broker.sh  |  2 +-
 tests/docker-images/latest-version-image/scripts/run-proxy.sh |  2 +-
 .../single-cluster-2-bookie-1-broker-unstarted-with-s3.yaml   |  4 +++-
 .../single-cluster-3-bookie-2-broker-unstarted.yaml           | 11 +++++++----
 .../cube-definitions/single-cluster-3-bookie-2-broker.yaml    |  4 +++-
 7 files changed, 18 insertions(+), 11 deletions(-)

commit e0fbbcc390561805c0cf681ed7aff894cb7f2f13
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Jun 5 20:02:18 2018 +0200

    Add compaction threshold policy (#1910)
    
    Policy is number of bytes at which compaction should be triggered for
    a topic.
    
    This patch contains the policy itself, and the check. Subsequent patches
    will include the monitor and rest api.

 .../service/persistent/PersistentSubscription.java |  4 ++
 .../broker/service/persistent/PersistentTopic.java | 36 ++++++++++
 .../pulsar/broker/service/PersistentTopicTest.java | 83 ++++++++++++++++++++++
 .../pulsar/common/policies/data/Policies.java      |  8 ++-
 4 files changed, 129 insertions(+), 2 deletions(-)

commit cf2fdce82908ee7654b3ec119f668fc869919574
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jun 5 11:01:38 2018 -0700

    improving error messages when loading configs (#1853)
    
    * improving error messages when loading configs
    
    * refactoring code
    
    * adding missing import

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  3 +-
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  4 +-
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  4 +-
 .../apache/pulsar/admin/cli/utils/CmdUtils.java    | 63 ++++++++++++++++++++++
 .../apache/pulsar/functions/sink/PulsarSink.java   |  1 -
 .../org/apache/pulsar/functions/utils/Utils.java   |  7 ---
 6 files changed, 69 insertions(+), 13 deletions(-)

commit 844404630f01add24100b31ced3de255cf733ea9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 5 10:25:35 2018 -0700

    Support function registration with package-url (#1902)
    
    * Support function registration with package-url
    
    * keep one admin api for createFunction

 pom.xml                                            |   6 ++
 .../pulsar/broker/admin/impl/FunctionsBase.java    |   5 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  18 +++-
 .../client/admin/internal/FunctionsImpl.java       |  17 ++++
 pulsar-functions/worker/pom.xml                    |   6 ++
 .../pulsar/functions/worker/FunctionActioner.java  |  73 +++++++++------
 .../org/apache/pulsar/functions/worker/Utils.java  |  41 ++++++++-
 .../functions/worker/rest/api/FunctionsImpl.java   | 102 +++++++++++++++------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |   3 +-
 .../apache/pulsar/functions/worker/UtilsTest.java  |  80 ++++++++++++++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  51 ++++++++++-
 11 files changed, 338 insertions(+), 64 deletions(-)

commit 6b84809406d52c26cf7faa1a5543db209b803cc3
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Jun 5 13:30:07 2018 +0800

    Cpp client: add seek support in consumer for cpp client (#1863)
    
    * add seek support in consumer for cpp client
    
    * add c wrapper

 pulsar-client-cpp/include/pulsar/Consumer.h      | 24 +++++++++
 pulsar-client-cpp/include/pulsar/c/consumer.h    |  5 ++
 pulsar-client-cpp/lib/Commands.cc                | 13 +++++
 pulsar-client-cpp/lib/Commands.h                 |  2 +
 pulsar-client-cpp/lib/Consumer.cc                | 21 ++++++++
 pulsar-client-cpp/lib/ConsumerImpl.cc            | 40 +++++++++++++++
 pulsar-client-cpp/lib/ConsumerImpl.h             |  2 +
 pulsar-client-cpp/lib/ConsumerImplBase.h         |  1 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc |  5 ++
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h  |  1 +
 pulsar-client-cpp/lib/c/c_Consumer.cc            | 10 ++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 65 ++++++++++++++++++++++++
 12 files changed, 189 insertions(+)

commit 794d3ad3a48b855c9387cbd48453a915fb073589
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 4 18:32:17 2018 -0700

    Fixed message routing mode in Py client (#1906)

 pulsar-client-cpp/python/pulsar/__init__.py | 7 +++++--
 pulsar-client-cpp/python/pulsar_test.py     | 9 ++++++++-
 2 files changed, 13 insertions(+), 3 deletions(-)

commit d47c3ea8bebc10659949e6f8c76cf41ad9551105
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jun 4 16:01:44 2018 -0700

    fix bug in setting the record sequence in Pulsar source and sink (#1905)
    
    * fix bug in setting the record sequence in Pulsar source and sink
    
    * removing unnecessary file

 .../src/main/java/org/apache/pulsar/functions/source/PulsarRecord.java | 2 +-
 .../src/main/java/org/apache/pulsar/functions/source/PulsarSource.java | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

commit 54eb8a54ef9d5d527e9aa663de117c2fa93ea9a3
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 4 15:12:56 2018 -0700

    Include functions in pulsar-client Python package (#1893)
    
    * Include functions in pulsar-client Python package
    
    * Fixed functions runtime python code copy

 pulsar-client-cpp/python/{pulsar.py => pulsar/__init__.py}  | 0
 pulsar-client-cpp/python/{ => pulsar}/functions/__init__.py | 0
 pulsar-client-cpp/python/{ => pulsar}/functions/context.py  | 0
 pulsar-client-cpp/python/{ => pulsar}/functions/function.py | 0
 pulsar-client-cpp/python/{ => pulsar}/functions/serde.py    | 0
 pulsar-functions/runtime/pom.xml                            | 5 ++---
 6 files changed, 2 insertions(+), 3 deletions(-)

commit 34e8315fbec26787528183c1c1e3927b779f3b90
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 4 12:55:42 2018 -0700

    Removed link to md5 checksums in download page (#1894)

 site/download.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 7c0fd11542a5a87d62628b12918af03065f9bef0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jun 4 12:55:17 2018 -0700

    allowing users to specify function jar in yml file (#1899)
    
    * allowing users to specify function jar in yml file
    
    * fixing unit tests

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  4 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 43 +++++++++++++++++-----
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 17 +++++++--
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 13 ++++++-
 .../pulsar/functions/utils/FunctionConfig.java     |  5 +++
 .../apache/pulsar/functions/utils/SinkConfig.java  |  3 ++
 .../pulsar/functions/utils/SourceConfig.java       |  3 ++
 .../org/apache/pulsar/functions/utils/Utils.java   |  4 ++
 .../validation/ConfigValidationAnnotations.java    |  9 +++++
 .../functions/utils/validation/ValidatorImpls.java | 17 ++++++++-
 10 files changed, 101 insertions(+), 17 deletions(-)

commit dfd4980e9700734a923da212129953030416ea5f
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 4 21:53:19 2018 +0200

    Add tiered storage configuration to website reference (#1900)
    
    Master issue: #1511

 site/_data/config/broker.yaml | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)

commit cfdf6fcbb96eea255a2f49de182411e6f8aa3544
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 4 21:51:35 2018 +0200

    Estimate the size of a managed ledger suffix from a position (#1901)
    
    This patch adds the ability to estimate the size of a suffix of a
    managed ledger by passing in a prefix. The size is an estimate. For
    complete ledgers after the position, the size can be calculated
    exactly, but for the first ledger, if it is partial, we can only get
    an estimate without having to make an RPC. The estimate for this
    ledger is based on the total size of that ledger and the number of
    entries in that ledger.

 .../apache/bookkeeper/mledger/ManagedCursor.java   |  7 ++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  5 +++++
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 18 ++++++++++++++++
 .../mledger/impl/ManagedCursorContainerTest.java   |  5 +++++
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 25 +++++++++++++++++++++-
 5 files changed, 59 insertions(+), 1 deletion(-)

commit 999ac073985ba64a5542adf34274f230c31ad7ff
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 4 19:13:34 2018 +0200

    Increase watch-znode.py connection timeout (#1864)
    
    * Increase watch-znode.py connection timeout
    
    watch-znode is used in integration tests to ensure that initialization
    has occurred before booting brokers and proxies. By default kazoo uses
    a 10 second connection timeout. However, on occasion zookeeper could
    take longer than 10 seconds to come up depending on the order that
    containers are started and the load on the machine.
    
    This patch increases the connect timeout to a very high value (1h). If
    zookeeper doesn't come up within the hour, the test will fail in other
    places, and the containers will be torn down.
    
    * Add infinite connection retry
    
    * Rather than long timeout, short timeout, infinite retry

 docker/pulsar/scripts/watch-znode.py | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 9089692acd6abf8b9dc2f0889ce861a32c0f3e6d
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 4 10:08:45 2018 -0700

    Pulsar Go client library (#1764)
    
    * WIP - Pulsar Go client library
    
    * Refactored configurations to use struct instead of builder
    
    * Simplified methods terminology
    
    * Fixed typos
    
    * Refactored message builder
    
    * More refactoring from comments
    
    * More polishing and using context
    
    * Implemented message properties
    
    * Use standard include and link paths
    
    * Removed dependencies on library for saving pointers
    
    * Remoed all Async methods (except producer.SendAsync() from public API
    
    * MessageBuilder -> ProducerMessage
    
    * Allow to configure custom loggers from Go
    
    * Cleaned up logger
    
    * Use fully qualified package name in example
    
    * Added Unit tests

 pom.xml                                            |   2 +
 .../include/pulsar/c/client_configuration.h        |   6 +-
 pulsar-client-cpp/include/pulsar/c/message.h       |   4 +-
 pulsar-client-cpp/include/pulsar/c/string_map.h    |  46 ++++
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    |   4 +-
 pulsar-client-cpp/lib/LogUtils.cc                  |   9 +-
 pulsar-client-cpp/lib/LogUtils.h                   |  21 +-
 pulsar-client-cpp/lib/SimpleLoggerImpl.cc          |   8 +-
 pulsar-client-cpp/lib/c/cStringMap.cc              |  60 ++++++
 pulsar-client-cpp/lib/c/c_Client.cc                |   2 +-
 pulsar-client-cpp/lib/c/c_ClientConfiguration.cc   |  18 +-
 pulsar-client-cpp/lib/c/c_Message.cc               |   6 +
 pulsar-client-cpp/lib/c/c_structs.h                |   6 +-
 .../consumer-listener/consumer-listener.go         |  60 ++++++
 pulsar-client-go/examples/consumer/consumer.go     |  59 +++++
 pulsar-client-go/examples/producer/producer.go     |  59 +++++
 pulsar-client-go/examples/reader/reader.go         |  56 +++++
 pulsar-client-go/pulsar/c_client.go                | 182 ++++++++++++++++
 pulsar-client-go/pulsar/c_consumer.go              | 239 +++++++++++++++++++++
 pulsar-client-go/pulsar/c_error.go                 |  60 ++++++
 pulsar-client-go/pulsar/c_go_pulsar.h              | 136 ++++++++++++
 pulsar-client-go/pulsar/c_message.go               | 207 ++++++++++++++++++
 pulsar-client-go/pulsar/c_producer.go              | 222 +++++++++++++++++++
 pulsar-client-go/pulsar/c_reader.go                | 172 +++++++++++++++
 pulsar-client-go/pulsar/client.go                  |  87 ++++++++
 pulsar-client-go/pulsar/consumer.go                | 136 ++++++++++++
 pulsar-client-go/pulsar/consumer_test.go           | 133 ++++++++++++
 pulsar-client-go/pulsar/error.go                   |  58 +++++
 pulsar-client-go/pulsar/logger.go                  |  47 ++++
 pulsar-client-go/pulsar/message.go                 |  82 +++++++
 pulsar-client-go/pulsar/pointer.go                 |  64 ++++++
 pulsar-client-go/pulsar/producer.go                | 166 ++++++++++++++
 pulsar-client-go/pulsar/producer_test.go           | 168 +++++++++++++++
 pulsar-client-go/pulsar/reader.go                  |  72 +++++++
 pulsar-client-go/pulsar/reader_test.go             | 122 +++++++++++
 pulsar-client-go/pulsar/util_test.go               |  69 ++++++
 36 files changed, 2818 insertions(+), 30 deletions(-)

commit 44cbed3a842f9a04e656b987433f686e56c616a9
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 4 19:08:18 2018 +0200

    Encrypted or compressed payloads can be compacted out if empty (#1889)
    
    Compressed payloads don't have zero size, even if the uncompressed
    payload is empty, so if a payload was empty, it wouldn't delete that key
    from the compaction result.
    
    Similarly for encrypted messages, zero size unencrypted doesn't map to
    zero size encrypted.
    
    This patch adds special handling to use getUncompressedSize() to find
    the size of the payload, rather than looking at the readableBytes of
    the payload. UncompressedSize is now set for all messages.
    
    We still fall back to using readableBytes for the case where we have
    an old client that isn't updating UncompressedSize.

 .../pulsar/compaction/TwoPhaseCompactor.java       |   7 +-
 .../apache/pulsar/compaction/CompactionTest.java   | 157 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ProducerImpl.java    |   2 +-
 3 files changed, 164 insertions(+), 2 deletions(-)

commit b2b97f2a680a760fe54b8a5b66fc6018c68b01a1
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jun 4 19:07:22 2018 +0200

    Move UUID in S3 object name to start (#1888)
    
    This acheives better load balancing on S3, as I guess internally
    objects in buckets are distributed over machines based on their
    names. Randomizing the names is the Amazon recommended way to acheive
    high request rates.
    
    https://docs.aws.amazon.com/AmazonS3/latest/dev/request-rate-perf-considerations.html
    
    Master Issue: #1511

 .../org/apache/pulsar/broker/s3offload/S3ManagedLedgerOffloader.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6be584f6a35e727377f0bc0968de57c50478164d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Jun 3 14:37:00 2018 -0700

     improving source and sink validation (#1897)
    
    * add source config validation
    
    * improving source and sink validation
    
    * cleaning up code
    
    * refactor sink infer config code

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  42 +-----
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 157 +++++++-------------
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 136 ++++++------------
 .../apache/pulsar/functions/utils/SinkConfig.java  |  18 +++
 .../pulsar/functions/utils/SourceConfig.java       |  19 +++
 .../org/apache/pulsar/functions/utils/Utils.java   |  74 ++++++++--
 .../validation/ConfigValidationAnnotations.java    |  11 ++
 .../functions/utils/validation/ValidatorImpls.java | 160 +++++++++++++++++++--
 8 files changed, 361 insertions(+), 256 deletions(-)

commit 54cc1c3eb2ed5e69f622e863a7db87a3105a5abb
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Jun 2 19:10:14 2018 -0700

    Simplify PushSource (#1898)
    
    ### Motivation
    
    Currently implementing push source requires users implement an additional interface called setConsumer and then using that consumer in their loop. This pr just exposes a consume method from the pushSource abstract class that derived functions can make use of.

 .../java/org/apache/pulsar/io/core/PushSource.java     | 18 +++++++-----------
 .../java/org/apache/pulsar/io/kafka/KafkaSource.java   |  9 +--------
 .../org/apache/pulsar/io/rabbitmq/RabbitMQSource.java  | 16 +++++-----------
 .../org/apache/pulsar/io/twitter/TwitterFireHose.java  |  8 +-------
 4 files changed, 14 insertions(+), 37 deletions(-)

commit 577e5793abbb8d2bd1ce0295cc88d84fc1acf3db
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Jun 2 12:34:38 2018 -0700

    When fetching from kafka, specify to get the earliest of messages (#1896)

 .../kafka/src/main/java/org/apache/pulsar/io/kafka/KafkaSource.java      | 1 +
 1 file changed, 1 insertion(+)

commit 7565ece49424c2efaa1c180564b414c51a832a81
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jun 1 13:38:56 2018 -0700

     allow users to specify message timeout for functions (#1885)
    
    * allow users to specify message timeout
    
    * adding for python functions
    
    * adding validation
    
    * fixing bug in python
    
    * adding missing license header

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 11 +++++-
 .../functions/instance/JavaInstanceRunnable.java   |  4 ++
 .../pulsar/functions/source/PulsarSource.java      | 12 ++++--
 .../functions/source/PulsarSourceConfig.java       |  1 +
 .../instance/src/main/python/Function_pb2.py       | 43 +++++++++++++---------
 .../instance/src/main/python/python_instance.py    |  4 +-
 .../src/main/python/python_instance_main.py        |  3 ++
 .../proto/src/main/proto/Function.proto            |  1 +
 .../pulsar/functions/runtime/JavaInstanceMain.java |  6 +++
 .../pulsar/functions/runtime/ProcessRuntime.java   |  5 +++
 .../pulsar/functions/utils/FunctionConfig.java     |  2 +
 .../functions/utils/validation/ValidatorImpls.java |  8 +++-
 12 files changed, 75 insertions(+), 25 deletions(-)

commit c01c6beb026f477df2e9874581c24c5bb56b7502
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jun 1 20:28:43 2018 +0200

    S3BackedInputStream seeks within current buffer if possible (#1892)
    
    Previously, any time seek was called, the current buffer was
    discarded, and the next time read was called, a request was made to
    S3. This was very inefficient if using seek a lot (which we do).
    
    This patch changes that behaviour so that if the position sought is
    within the range of the current buffer, we just change the reader
    index on the buffer.
    
    Master Issue: #1511

 .../s3offload/impl/S3BackedInputStreamImpl.java    | 14 ++++++-
 .../broker/s3offload/S3BackedInputStreamTest.java  | 47 ++++++++++++++++++++++
 2 files changed, 59 insertions(+), 2 deletions(-)

commit 3412d9c969608f81bc8d53a30237967003738575
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jun 1 10:55:39 2018 -0700

    Fixed the filename of the log files in threaded mode (#1890)

 conf/log4j2.yaml                                                        | 2 +-
 .../java/org/apache/pulsar/functions/instance/JavaInstanceRunnable.java | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

commit ae096ebe3d34782aad817fa6d67ff4f997461165
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jun 1 10:55:10 2018 -0700

    removing allowing users set subscription type (#1880)
    
    * removing allowing users set subscription type
    
    * fix NPE

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 35 +++++++++++-----------
 .../functions/instance/JavaInstanceRunnable.java   | 13 ++++++--
 .../pulsar/functions/sink/PulsarSinkConfig.java    |  1 -
 .../pulsar/functions/source/PulsarSource.java      |  2 +-
 .../functions/source/PulsarSourceConfig.java       |  4 ++-
 .../pulsar/functions/sink/PulsarSinkTest.java      |  1 -
 .../pulsar/functions/source/PulsarSourceTest.java  |  1 -
 .../pulsar/functions/utils/FunctionConfig.java     | 15 ----------
 .../functions/utils/validation/ValidatorImpls.java |  7 -----
 9 files changed, 32 insertions(+), 47 deletions(-)

commit 8376a2a292d18fcbfb7c93c500720b04fd85945c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jun 1 09:22:51 2018 -0700

    All user supplied arguments have to be properly typed (#1883)

 pulsar-functions/instance/src/main/python/contextimpl.py | 3 +++
 1 file changed, 3 insertions(+)

commit 075e87295db70a47fad6dd6097b9ec2f9f0ea283
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jun 1 16:56:05 2018 +0200

    Make supervisord wait a single command (#1866)
    
    The integration tests wait for supervisord to be up before attempting
    to start the brokers and proxies. Previously we were doing this by
    checking for the existence of the supervisord socket
    repeatedly. However, this spams the log.
    
    This patch replaces the loop with a single bash command (a bash loop),
    with the timeout built into the command.
    
    Failure of the socket to appear also throws a exception (timeout
    exits with 124), rather than returning a boolean which we were not
    checking previously anyhow.

 .../org/apache/pulsar/tests/PulsarClusterUtils.java | 21 +++------------------
 1 file changed, 3 insertions(+), 18 deletions(-)

commit 588ea6add5cdf9f04a32826a5217bca3569ed679
Author: William Fry <wrfry95@gmail.com>
Date:   Fri Jun 1 10:55:14 2018 -0400

    Upgrade Ansible to install 2.0.0-rc1-incubating (#1873)
    
    * Update configuration files from 2.0.0
    
    * Revert to private_ip
    
    * Revert to private_ip for client.conf

 deployment/terraform-ansible/deploy-pulsar.yaml    |   4 +-
 .../terraform-ansible/templates/bookkeeper.conf    | 646 +++++++++++++++------
 deployment/terraform-ansible/templates/broker.conf | 482 ++++++++++++++-
 deployment/terraform-ansible/templates/client.conf |  10 +-
 .../terraform-ansible/templates/pulsar_env.sh      |   5 +-
 5 files changed, 951 insertions(+), 196 deletions(-)

commit 89dd66b2fa063a5f0eaee678054c2de362850f56
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 1 07:54:52 2018 -0700

    Upgrade RocksDb to 5.13.1 (#1887)

 all/src/assemble/LICENSE.bin.txt | 2 +-
 pom.xml                          | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 9d1916d46148fc3b6752b797065e9c646e14b9b3
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 31 23:19:12 2018 -0700

    Fixed event time metadata on batched messages (#1882)
    
    * Fixed event time metadata on batched messages
    
    * Fixed test
    
    * Fixed cpp test topic name

 .../broker/service/PersistentTopicE2ETest.java     | 17 +++++++
 pulsar-client-cpp/lib/Commands.cc                  |  4 ++
 pulsar-client-cpp/lib/Message.cc                   |  8 +++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 26 ++++++++++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  4 ++
 .../org/apache/pulsar/common/api/Commands.java     | 10 +++-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 ++++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       | 10 ++--
 8 files changed, 131 insertions(+), 5 deletions(-)

commit 995a2acb449b9494f8b8dce7e9d8618aabff1f44
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 31 23:13:58 2018 -0700

    Made the logging file names uniform accross threaded and process modes (#1884)

 conf/log4j2.yaml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit fc3c1b383c80202f5c69cfac704b52655b211d50
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu May 31 17:17:23 2018 -0700

    [functions] Dont shade log4j2 in java runtime instance (#1881)
    
    *Motivation*
    
     #1849 shade the dependencies in java instance uber jar. However it
     shades the log4j2, which causes functions running in process mode
     can't output any logging messages.
    
    *Solution*
    
    Don't shade log4j2 in java runtime instance

 pulsar-functions/runtime-all/pom.xml | 2 ++
 1 file changed, 2 insertions(+)

commit ec535b6551b8f1174e3096b6c5507c77913eb52f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 31 16:19:42 2018 -0700

    If tenant/namespace are not specified, infer public/default (#1879)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 24 ++++++++++++++++++----
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 10 +++++++--
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 10 +++++++--
 3 files changed, 36 insertions(+), 8 deletions(-)

commit 4a5bd6c66fa0f0c018ff824ba83dd83384d13d3c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 31 16:19:06 2018 -0700

    Make sure that output_bytes are of type bytes (#1878)
    
    * Make sure that output_bytes are of type bytes
    
    * Do the same for publish method in the context as well

 pulsar-functions/instance/src/main/python/contextimpl.py     | 2 +-
 pulsar-functions/instance/src/main/python/python_instance.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 866bbece0cc57894bdc70dd2fb99c23abf0f0bef
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 31 14:11:07 2018 -0700

    adding CmdFunctions unit tests and clean up (#1869)
    
    * adding CmdFunctions unit tests and clean up
    
    * remove unnecessary import

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 309 ++++++++++++++++++---
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  68 +----
 2 files changed, 290 insertions(+), 87 deletions(-)

commit 77d936e65b1bf6a8f6fc52e1a51670851fe90e20
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 31 19:51:22 2018 +0200

    When offloading to S3 add version information (#1876)
    
    When we offload ledgers to S3, we create 2 objects, an index and a
    data object. This patch adds version information for the format, the
    version of the software and the gitsha of the software to each, for
    debugging purposes.
    
    On reads, it the format version is a version higher than the broker
    knows about the read is rejected.
    
    Master Issue: #1511

 .../broker/s3offload/S3ManagedLedgerOffloader.java | 36 ++++++++++-
 .../s3offload/impl/S3BackedInputStreamImpl.java    |  7 +++
 .../s3offload/impl/S3BackedReadHandleImpl.java     |  5 ++
 .../broker/s3offload/S3BackedInputStreamTest.java  | 20 +++++--
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 69 ++++++++++++++++++++++
 5 files changed, 131 insertions(+), 6 deletions(-)

commit 13ad7a60321468ec5290f013cb672c73f87a6b6c
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jun 1 02:36:52 2018 +0900

    Fix REST APIs provided by Pulsar proxy (#1862)
    
    * Fix REST APIs provided by Pulsar proxy
    
    * Rename status file for test
    
    * Exclude status file from license check
    
    * Add license header to status file
    
    * Proxying HTTP request in the same way as Pulsar wire protocol

 .../pulsar/proxy/server/AdminProxyHandler.java     | 63 +++++++++++++++++++++-
 .../pulsar/proxy/server/ProxyConfiguration.java    | 20 +++++++
 .../pulsar/proxy/server/ProxyServiceStarter.java   | 15 ++++--
 .../org/apache/pulsar/proxy/server/WebServer.java  |  9 ++--
 .../proxy/server/AuthedAdminProxyHandlerTest.java  | 30 +++++++----
 .../server/UnauthedAdminProxyHandlerTest.java      | 55 ++++++++++++++-----
 pulsar-proxy/src/test/resources/vip_status.html    | 20 +++++++
 7 files changed, 177 insertions(+), 35 deletions(-)

commit 06f9e2d126eba015bc9b0461014aa3b74794f546
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 31 18:53:09 2018 +0200

    CLI for offload (#1865)
    
    * CLI for offload
    
    This patch adds two CLI commands for offload, one to trigger offload,
    and another to check offload status.
    
    Triggering offload requires a size-threshold argument, which is the
    maximum number of bytes which should be retained locally. The prefix
    of ledgers over this threshold will be offloaded.
    
    ```
    pulsar-admin topics offload --size-threshold 104857600 persistent://public/default/topic1
    pulsar-admin topics offload-status -w persistent://public/default/topic1
    ```
    
    Master Issue: #1511
    
    * luc's review comments

 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 94 +++++++++++++++++++++-
 .../org/apache/pulsar/admin/cli/TestCmdTopics.java | 58 +++++++++++++
 .../pulsar/tests/integration/TestS3Offload.java    | 42 +++++-----
 3 files changed, 175 insertions(+), 19 deletions(-)

commit 6896f8c5eca132dcaef4d928350d916692f9e25b
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 31 18:52:28 2018 +0200

    Disable verbose on git maven plugin (#1877)
    
    It's very noisy.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a1ffa7ff931e0ca7da8ec08452c6a3fc084212ea
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 31 09:20:13 2018 -0700

     fix for python config validation (#1874)
    
    * fix for python config validation
    
    * removing unnecessary file

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../pulsar/functions/utils/FunctionConfig.java     |   4 +-
 .../utils/validation/ConfigValidation.java         | 100 ++++++++++++++++-----
 .../validation/ConfigValidationAnnotations.java    |  40 ++++++++-
 4 files changed, 120 insertions(+), 26 deletions(-)

commit 886022a87249ad0f0744dede2be2595df4be8386
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed May 30 21:35:53 2018 -0700

    Pulsar Function localrun failed using http service url (#1870)
    
    *Motivation*
    
     #1849 shade the dependencies in java instance uber jar. However it
     shades the asynchttpclient to a different namespace, which causes
     following issue when running pulsar function in `localrun` mode
    
     ```
     Exception in thread main java.lang.NumberFormatException: null
        at java.lang.Integer.parseInt(Integer.java:542)
        at java.lang.Integer.parseInt(Integer.java:615)
        at org.apache.pulsar.functions.runtime.shaded.org.asynchttpclient.config.AsyncHttpClientConfigHelper$Config.getInt(AsyncHttpClientConfigHelper.java:109)
        at org.apache.pulsar.functions.runtime.shaded.org.asynchttpclient.config.AsyncHttpClientConfigDefaults.defaultMaxRedirects(AsyncHttpClientConfigDefaults.java:63)
        at org.apache.pulsar.functions.runtime.shaded.org.asynchttpclient.DefaultAsyncHttpClientConfig$Builder.<init>(DefaultAsyncHttpClientConfig.java:631)
        at org.apache.pulsar.client.impl.HttpClient.<init>(HttpClient.java:83)
        at org.apache.pulsar.client.impl.HttpClient.<init>(HttpClient.java:68)
        at org.apache.pulsar.client.impl.HttpLookupService.<init>(HttpLookupService.java:52)
        at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:132)
        at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:118)
        at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:114)
        at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:52)
     ```
    
     The problem is related to #389
    
    *Solution*
    
    Shade the asynchttpclient to the namespace that it has right `ahc.properties` file.

 pulsar-functions/runtime-all/pom.xml | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 35858bf9318241cb7029d2bf170efaff4b17015a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 30 15:50:28 2018 -0700

    Fixed script to build all versions Python wheel files (#1856)

 pulsar-client-cpp/docker/build-wheel-file-within-docker.sh | 1 +
 pulsar-client-cpp/docker/build-wheels.sh                   | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

commit 2710586b7bb05ccf0141f42f0db55031ef99347f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 30 13:01:26 2018 -0700

    Fix Prometheus metrics provider package name (#1868)

 deployment/dcos/PulsarGroups.json                          | 3 +--
 deployment/kubernetes/aws/bookkeeper.yaml                  | 2 +-
 deployment/kubernetes/generic/bookie.yaml                  | 2 +-
 deployment/kubernetes/google-kubernetes-engine/bookie.yaml | 4 ++--
 deployment/terraform-ansible/templates/bookkeeper.conf     | 2 +-
 site/_data/config/bookkeeper.yaml                          | 2 +-
 6 files changed, 7 insertions(+), 8 deletions(-)

commit ecec9337094820c65fe5ecf128f8070a3538bddd
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 30 12:51:11 2018 -0700

    improving config validation (#1859)
    
    * improving config validation
    
    * removing unnecessary file
    
    * removing unnecessary log
    
    * fix bug
    
    * fix potential NPE

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   7 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 303 ++--------
 .../windowing/WindowFunctionExecutor.java          |   5 +-
 .../pulsar/functions/windowing/WindowUtils.java    |  53 +-
 .../windowing/WindowFunctionExecutorTest.java      |   4 +-
 pulsar-functions/utils/pom.xml                     |   5 +
 .../pulsar/functions/utils/FunctionConfig.java     |  34 +-
 .../org/apache/pulsar/functions/utils/Utils.java   |  73 +++
 .../utils/validation/ConfigValidation.java         | 119 ++++
 .../validation/ConfigValidationAnnotations.java    | 183 ++++++
 .../utils/validation/ConfigValidationUtils.java    | 177 ++++++
 .../functions/utils/validation/Validator.java      |  31 +
 .../functions/utils/validation/ValidatorImpls.java | 655 +++++++++++++++++++++
 13 files changed, 1352 insertions(+), 297 deletions(-)

commit 92802e9efafc487c9c336fd9c99989cf8e5c390c
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 30 20:33:37 2018 +0200

    Ship git info in jar and print at boot (#1850)
    
    We currently print the version at boot. However, there's no guarantee
    that modifications haven't been made against that version without the
    version string being bumped. The only why to be sure is to have the
    git sha that the jar was built from.
    
    This patch packages the git information into a properties file, which
    is shipped in the jar. It requires git to be available on the PATH to
    work. If not, the file is not generated, but the build does not fail.
    
    The version printing on boot has been moved to the start of the
    PulsarService#start() method, and now prints the version as before,
    but also the git sha, the git user and email of the builder, the
    machine it was built on and the time it was built.

 pom.xml                                            | 29 ++++++++++++++++++++++
 .../org/apache/pulsar/broker/PulsarService.java    | 10 +++++---
 .../utils/PulsarBrokerVersionStringUtils.java      | 26 +++++++++++++++++++
 3 files changed, 62 insertions(+), 3 deletions(-)

commit 6786a2f69e5ccd8e0800a9a62288c8418e1478ef
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed May 30 11:31:39 2018 -0700

    Topic compaction documentation (#1466)
    
    * add deduplication diagram
    
    * add CLI docs to YAML file
    
    * add docs for new broker.conf settings
    
    * add link to streamlio blog post and remove errant TODOs
    
    * add more to theory section
    
    * add producer idempotency section
    
    * add message deduplication cookbook
    
    * add multiple new sections to cookbook
    
    * add baseline notes to C&A doc plus a cookbook
    
    * add missing flags to pulsar command docs
    
    * begin adding admin docs to cookbook
    
    * add basic stock ticker example and mention
    
    * add empty message example
    
    * more details in client doc
    
    * more material for cookbook
    
    * finish draft of Java client doc
    
    * change admon text
    
    * begin revamping concepts section
    
    * add C+A section on Pulsar messages
    
    * finish section on messages and add popover definition
    
    * fix reader example
    
    * complete description of sequence ID
    
    * fix remaining reader examples in C+A doc
    
    * finish conceptual docs for compaction
    
    * add note to CLI docs
    
    * begin addressing @ivankelly comments
    
    * change header level
    
    * provide clarification around BK ledger

 site/_data/cli/pulsar-admin.yaml                   |   8 +-
 site/_data/cli/pulsar.yaml                         |   5 +-
 site/_data/popovers.yaml                           |   2 +-
 site/_data/sidebar.yaml                            |   4 +-
 site/docs/latest/cookbooks/compaction.md           | 107 +++++++++++++++++++++
 .../docs/latest/cookbooks/message-deduplication.md |   4 +-
 .../getting-started/ConceptsAndArchitecture.md     |  69 +++++++++++--
 7 files changed, 184 insertions(+), 15 deletions(-)

commit f05c73bbd59d7398bf69ecb0d259924a8c250f78
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 30 09:54:30 2018 -0700

    Fixes to new Java API intro docs (#1860)

 site/docs/latest/clients/Java.md | 89 +++++++++++++++++++---------------------
 1 file changed, 43 insertions(+), 46 deletions(-)

commit 430e888f3bcf8e91fbca13bf69b5b3a9813ecd53
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 30 18:51:37 2018 +0200

    Supervisord configurations shouldn't specify stderr logfile (#1867)
    
    As it already being redirected to stderr. Configuring both causes a
    warning in the log.

 tests/docker-images/latest-version-image/conf/proxy.conf | 1 -
 1 file changed, 1 deletion(-)

commit 9b2653927c706e13310d19c18a66308935802386
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 29 17:21:31 2018 -0700

    Updated release notes (#1857)

 site/_includes/pulsar-2.html | 23 -----------------------
 site/_layouts/docs.html      |  2 --
 site/release-notes.md        | 27 +++++++++++++++++++++++++++
 3 files changed, 27 insertions(+), 25 deletions(-)

commit 1a5ef1da4a8280760cd57ca8838eb8f702723f97
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 29 13:34:30 2018 -0700

    fix sample and ns1 references (#1832)

 site/docs/latest/adaptors/KafkaWrapper.md          |  17 +--
 site/docs/latest/adaptors/PulsarSpark.md           |   2 +-
 site/docs/latest/admin-api/namespaces.md           | 161 +++++++++++----------
 .../docs/latest/admin-api/non-persistent-topics.md |  34 ++---
 site/docs/latest/admin-api/persistent-topics.md    | 135 +++++++++--------
 site/docs/latest/clients/Cpp.md                    |   4 +-
 site/docs/latest/clients/Java.md                   |  21 ++-
 site/docs/latest/clients/WebSocket.md              |  24 +--
 .../docs/latest/cookbooks/message-deduplication.md |  12 +-
 site/docs/latest/cookbooks/message-queue.md        |   8 +-
 .../latest/cookbooks/non-persistent-messaging.md   |   2 +-
 site/docs/latest/deployment/aws-cluster.md         |   2 +-
 site/docs/latest/deployment/cluster.md             |   2 +-
 site/docs/latest/functions/api.md                  |  12 +-
 site/docs/latest/functions/deployment.md           |  30 ++--
 site/docs/latest/functions/overview.md             |  44 +++---
 site/docs/latest/functions/quickstart.md           |  72 +++++----
 .../getting-started/ConceptsAndArchitecture.md     |  26 +---
 site/docs/latest/getting-started/LocalCluster.md   |   4 +-
 site/docs/latest/getting-started/docker.md         |   2 +-
 20 files changed, 296 insertions(+), 318 deletions(-)

commit df6962e4ce359a22bcad097ac8cad3b55d975dd2
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 29 20:07:51 2018 +0200

    S3 offloader should throw an error on receiving an empty ledger (#1855)
    
    ManagedLedger should never send an empty ledger for offload, as its a
    waste of resources. This patch adds a defensive check to ensure that
    if the S3 offload does get an empty ledger, it doesn't even attempt to
    create any resources on the S3 side.
    
    Master issue: #1511

 .../broker/s3offload/S3ManagedLedgerOffloader.java |  5 +++++
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 25 ++++++++++++++++++++++
 2 files changed, 30 insertions(+)

commit 9594553e86b35d3f5243cf3bd3519f0122c7a01c
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 29 20:07:20 2018 +0200

    Store data block header length in index and block header (#1854)
    
    In the case of the index, if we store the block header length in the
    index, we can change the length in future without having to break
    compatability.
    
    In the case of the block header itself, storing the header length in
    the block, allows reading of the data object without having to make
    assumptions about the size of the header.
    
    Master Issue: #1511

 .../pulsar/broker/s3offload/DataBlockHeader.java   |  4 +-
 .../pulsar/broker/s3offload/OffloadIndexBlock.java |  7 ++-
 .../broker/s3offload/OffloadIndexBlockBuilder.java |  6 +++
 .../broker/s3offload/S3ManagedLedgerOffloader.java |  3 +-
 .../impl/BlockAwareSegmentInputStreamImpl.java     |  4 ++
 .../broker/s3offload/impl/DataBlockHeaderImpl.java | 53 +++++++++++-----------
 .../impl/OffloadIndexBlockBuilderImpl.java         | 14 +++++-
 .../s3offload/impl/OffloadIndexBlockImpl.java      | 15 +++++-
 .../s3offload/impl/OffloadIndexEntryImpl.java      | 12 ++---
 .../broker/s3offload/impl/DataBlockHeaderTest.java | 13 +++---
 .../broker/s3offload/impl/OffloadIndexTest.java    | 22 ++++++---
 11 files changed, 102 insertions(+), 51 deletions(-)

commit 087c9a22772500c777a729f1496a461692667b6c
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed May 30 02:20:42 2018 +0900

    Run pulsar-functions as daemon process (#1852)

 bin/pulsar-daemon | 4 ++++
 1 file changed, 4 insertions(+)

commit 1448cd6de5de7dc869d501c89a01f6504ad0c40b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue May 29 09:42:23 2018 -0700

    Shade jars included in java instance uber jar (#1849)
    
    *Motivation*
    
    dependencies are packaged into a java uber jar for running functions in process mode.
    however we don't shade those dependencies, it can potentially conflict with user' function
    dependencies
    
    *Solution*
    
    Shade the dependencies included in the java instance uber jar.

 pom.xml                              |   6 ++
 pulsar-functions/runtime-all/pom.xml | 113 +++++++++++++++++++++++++++++++++--
 2 files changed, 115 insertions(+), 4 deletions(-)

commit 5dcd5c4396f2c608178a89980bfa7e49b172e480
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sun May 27 21:03:19 2018 -0700

    Fix message builder examples (#1848)
    
    * fix deprecate MessageBuilder examples
    
    * use Arrays construct for list in geo-rep java example

 site/docs/latest/admin/GeoReplication.md | 19 +++++++++++--------
 site/docs/latest/clients/Java.md         | 15 +++++++++------
 2 files changed, 20 insertions(+), 14 deletions(-)

commit 365475b2874f1d4ef42c42e49c7be025171bc021
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun May 27 11:36:41 2018 -0700

    Corrected release name 2.0.0-incubating -> 2.0.0-rc1-incubating (#1847)

 site/_config.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b0ad69cd37807d9ea4ac6475f7cd9b52828d8b4b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat May 26 09:33:27 2018 -0700

    Fix grpc version conflicts in pulsar binary distribution (#1846)
    
    *Motivation*
    
    There are multiple grpc versions dropped in pulsar binary distribution. It seems that maven
    doesn't handle transitive dependencies well on assembly plugin.
    
    ```
    io.grpc-grpc-all-1.12.0.jar
    io.grpc-grpc-auth-1.5.0.jar
    io.grpc-grpc-context-1.5.0.jar
    io.grpc-grpc-core-1.5.0.jar
    io.grpc-grpc-netty-1.5.0.jar
    io.grpc-grpc-okhttp-1.5.0.jar
    io.grpc-grpc-protobuf-1.5.0.jar
    io.grpc-grpc-protobuf-lite-1.5.0.jar
    io.grpc-grpc-protobuf-nano-1.5.0.jar
    io.grpc-grpc-stub-1.5.0.jar
    io.grpc-grpc-testing-1.12.0.jar
    ```
    
    *Changes*
    
    - Exclude transitive grpc dependencies from functions modules.
    - Pin versions for some grpc modules
    - Exclude netty dependencies that are already included in `netty-all` module.
    
    *Result*
    
    ```
    com.amazonaws-aws-java-sdk-core-1.11.297.jar                                  org.apache.commons-commons-lang3-3.4.jar
    com.amazonaws-aws-java-sdk-kms-1.11.297.jar                                   org.apache.distributedlog-distributedlog-common-4.7.0.jar
    com.amazonaws-aws-java-sdk-s3-1.11.297.jar                                    org.apache.distributedlog-distributedlog-core-4.7.0.jar
    com.amazonaws-jmespath-java-1.11.297.jar                                      org.apache.distributedlog-distributedlog-protocol-4.7.0.jar
    com.beust-jcommander-1.48.jar                                                 org.apache.httpcomponents-httpclient-4.5.5.jar
    com.carrotsearch-hppc-0.7.3.jar                                               org.apache.httpcomponents-httpcore-4.4.9.jar
    com.ea.agentloader-ea-agent-loader-1.0.2.jar                                  org.apache.logging.log4j-log4j-api-2.10.0.jar
    com.fasterxml.jackson.core-jackson-annotations-2.8.4.jar                      org.apache.logging.log4j-log4j-core-2.10.0.jar
    com.fasterxml.jackson.core-jackson-core-2.8.4.jar                             org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar
    com.fasterxml.jackson.core-jackson-databind-2.8.4.jar                         org.apache.logging.log4j-log4j-web-2.10.0.jar
    com.fasterxml.jackson.dataformat-jackson-dataformat-cbor-2.6.7.jar            org.apache.pulsar-managed-ledger-2.1.0-incubating-SNAPSHOT.jar
    com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.8.4.jar            org.apache.pulsar-protobuf-shaded-2.1.0-incubating-SNAPSHOT.jar
    com.fasterxml.jackson.datatype-jackson-datatype-joda-2.8.4.jar                org.apache.pulsar-pulsar-broker-2.1.0-incubating-SNAPSHOT.jar
    com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.8.4.jar                      org.apache.pulsar-pulsar-broker-common-2.1.0-incubating-SNAPSHOT.jar
    com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.8.4.jar             org.apache.pulsar-pulsar-client-admin-original-2.1.0-incubating-SNAPSHOT.jar
    com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.8.4.jar        org.apache.pulsar-pulsar-client-original-2.1.0-incubating-SNAPSHOT.jar
    com.fasterxml.jackson.module-jackson-module-jsonSchema-2.9.0.jar              org.apache.pulsar-pulsar-client-tools-2.1.0-incubating-SNAPSHOT.jar
    com.github.ben-manes.caffeine-caffeine-2.3.3.jar                              org.apache.pulsar-pulsar-common-2.1.0-incubating-SNAPSHOT.jar
    com.github.zafarkhaja-java-semver-0.9.0.jar                                   org.apache.pulsar-pulsar-discovery-service-2.1.0-incubating-SNAPSHOT.jar
    com.google.api.grpc-proto-google-common-protos-0.1.9.jar                      org.apache.pulsar-pulsar-functions-api-2.1.0-incubating-SNAPSHOT.jar
    com.google.auth-google-auth-library-credentials-0.4.0.jar                     org.apache.pulsar-pulsar-functions-api-examples-2.1.0-incubating-SNAPSHOT.jar
    com.google.code.findbugs-jsr305-3.0.2.jar                                     org.apache.pulsar-pulsar-functions-instance-2.1.0-incubating-SNAPSHOT.jar
    com.google.code.gson-gson-2.8.2.jar                                           org.apache.pulsar-pulsar-functions-metrics-2.1.0-incubating-SNAPSHOT.jar
    com.google.errorprone-error_prone_annotations-2.1.2.jar                       org.apache.pulsar-pulsar-functions-proto-2.1.0-incubating-SNAPSHOT.jar
    com.google.errorprone-javac-9-dev-r3297-1-shaded.jar                          org.apache.pulsar-pulsar-functions-runtime-2.1.0-incubating-SNAPSHOT.jar
    com.google.googlejavaformat-google-java-format-1.2.jar                        org.apache.pulsar-pulsar-functions-runtime-all-2.1.0-incubating-SNAPSHOT.jar
    com.google.guava-guava-21.0.jar                                               org.apache.pulsar-pulsar-functions-utils-2.1.0-incubating-SNAPSHOT.jar
    com.google.instrumentation-instrumentation-api-0.4.3.jar                      org.apache.pulsar-pulsar-functions-worker-2.1.0-incubating-SNAPSHOT.jar
    com.google.protobuf-protobuf-java-3.5.1.jar                                   org.apache.pulsar-pulsar-io-core-2.1.0-incubating-SNAPSHOT.jar
    com.google.protobuf-protobuf-java-util-3.3.1.jar                              org.apache.pulsar-pulsar-proxy-2.1.0-incubating-SNAPSHOT.jar
    com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar                  org.apache.pulsar-pulsar-testclient-2.1.0-incubating-SNAPSHOT.jar
    com.squareup.okhttp-okhttp-2.5.0.jar                                          org.apache.pulsar-pulsar-websocket-2.1.0-incubating-SNAPSHOT.jar
    com.squareup.okio-okio-1.6.0.jar                                              org.apache.pulsar-pulsar-zookeeper-2.1.0-incubating-SNAPSHOT.jar
    com.typesafe.netty-netty-reactive-streams-2.0.0.jar                           org.apache.pulsar-pulsar-zookeeper-utils-2.1.0-incubating-SNAPSHOT.jar
    com.wordnik-swagger-annotations-1.5.3-M1.jar                                  org.apache.yetus-audience-annotations-0.5.0.jar
    com.yahoo.datasketches-memory-0.8.3.jar                                       org.aspectj-aspectjrt-1.8.9.jar
    com.yahoo.datasketches-sketches-core-0.8.3.jar                                org.aspectj-aspectjweaver-1.8.9.jar
    commons-beanutils-commons-beanutils-1.7.0.jar                                 org.asynchttpclient-async-http-client-2.1.0-alpha26.jar
    commons-beanutils-commons-beanutils-core-1.8.0.jar                            org.asynchttpclient-async-http-client-netty-utils-2.1.0-alpha26.jar
    commons-cli-commons-cli-1.2.jar                                               org.bouncycastle-bcpkix-jdk15on-1.55.jar
    commons-codec-commons-codec-1.10.jar                                          org.bouncycastle-bcprov-jdk15on-1.55.jar
    commons-collections-commons-collections-3.2.1.jar                             org.eclipse.jetty-jetty-client-9.3.11.v20160721.jar
    commons-configuration-commons-configuration-1.6.jar                           org.eclipse.jetty-jetty-continuation-9.3.11.v20160721.jar
    commons-digester-commons-digester-1.8.jar                                     org.eclipse.jetty-jetty-http-9.3.11.v20160721.jar
    commons-io-commons-io-2.5.jar                                                 org.eclipse.jetty-jetty-io-9.3.11.v20160721.jar
    commons-lang-commons-lang-2.6.jar                                             org.eclipse.jetty-jetty-proxy-9.3.11.v20160721.jar
    commons-logging-commons-logging-1.1.1.jar                                     org.eclipse.jetty-jetty-security-9.3.11.v20160721.jar
    io.grpc-grpc-all-1.12.0.jar                                                   org.eclipse.jetty-jetty-server-9.3.11.v20160721.jar
    io.grpc-grpc-auth-1.12.0.jar                                                  org.eclipse.jetty-jetty-servlet-9.3.11.v20160721.jar
    io.grpc-grpc-context-1.12.0.jar                                               org.eclipse.jetty-jetty-servlets-9.3.11.v20160721.jar
    io.grpc-grpc-core-1.12.0.jar                                                  org.eclipse.jetty-jetty-util-9.3.11.v20160721.jar
    io.grpc-grpc-netty-1.12.0.jar                                                 org.eclipse.jetty.websocket-javax-websocket-client-impl-9.3.11.v20160721.jar
    io.grpc-grpc-okhttp-1.12.0.jar                                                org.eclipse.jetty.websocket-websocket-api-9.3.11.v20160721.jar
    io.grpc-grpc-protobuf-1.12.0.jar                                              org.eclipse.jetty.websocket-websocket-client-9.3.11.v20160721.jar
    io.grpc-grpc-protobuf-lite-1.12.0.jar                                         org.eclipse.jetty.websocket-websocket-common-9.3.11.v20160721.jar
    io.grpc-grpc-protobuf-nano-1.12.0.jar                                         org.eclipse.jetty.websocket-websocket-server-9.3.11.v20160721.jar
    io.grpc-grpc-stub-1.12.0.jar                                                  org.eclipse.jetty.websocket-websocket-servlet-9.3.11.v20160721.jar
    io.grpc-grpc-testing-1.12.0.jar                                               org.glassfish.hk2-hk2-api-2.5.0-b30.jar
    io.netty-netty-3.10.1.Final.jar                                               org.glassfish.hk2-hk2-locator-2.5.0-b30.jar
    io.netty-netty-all-4.1.22.Final.jar                                           org.glassfish.hk2-hk2-utils-2.5.0-b30.jar
    io.netty-netty-tcnative-boringssl-static-2.0.7.Final.jar                      org.glassfish.hk2-osgi-resource-locator-1.0.1.jar
    io.opencensus-opencensus-api-0.11.0.jar                                       org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b30.jar
    io.opencensus-opencensus-contrib-grpc-metrics-0.11.0.jar                      org.glassfish.hk2.external-javax.inject-2.5.0-b30.jar
    io.prometheus-simpleclient-0.0.23.jar                                         org.glassfish.jersey.bundles.repackaged-jersey-guava-2.25.jar
    io.prometheus-simpleclient_common-0.0.23.jar                                  org.glassfish.jersey.containers-jersey-container-servlet-2.25.jar
    io.prometheus-simpleclient_hotspot-0.0.23.jar                                 org.glassfish.jersey.containers-jersey-container-servlet-core-2.25.jar
    io.prometheus-simpleclient_servlet-0.0.23.jar                                 org.glassfish.jersey.core-jersey-client-2.25.jar
    io.swagger-swagger-annotations-1.5.3.jar                                      org.glassfish.jersey.core-jersey-common-2.25.jar
    io.swagger-swagger-core-1.5.3.jar                                             org.glassfish.jersey.core-jersey-server-2.25.jar
    io.swagger-swagger-models-1.5.3.jar                                           org.glassfish.jersey.ext-jersey-entity-filtering-2.25.jar
    javax.annotation-javax.annotation-api-1.2.jar                                 org.glassfish.jersey.media-jersey-media-jaxb-2.25.jar
    javax.servlet-javax.servlet-api-3.1.0.jar                                     org.glassfish.jersey.media-jersey-media-json-jackson-2.25.jar
    javax.validation-validation-api-1.1.0.Final.jar                               org.glassfish.jersey.media-jersey-media-multipart-2.25.jar
    javax.websocket-javax.websocket-api-1.0.jar                                   org.hamcrest-hamcrest-core-1.1.jar
    javax.ws.rs-javax.ws.rs-api-2.1.jar                                           org.hdrhistogram-HdrHistogram-2.1.9.jar
    joda-time-joda-time-2.8.1.jar                                                 org.inferred-freebuilder-1.12.3.jar
    log4j-log4j-1.2.17.jar                                                        org.javassist-javassist-3.21.0-GA.jar
    net.java.dev.jna-jna-4.2.0.jar                                                org.jboss-jboss-common-core-2.2.17.GA.jar
    net.jodah-typetools-0.5.0.jar                                                 org.jboss-jboss-reflect-2.2.1.SP1.jar
    net.jpountz.lz4-lz4-1.3.0.jar                                                 org.jboss.logging-jboss-logging-spi-2.2.0.CR1.jar
    org.apache.bookkeeper-bookkeeper-common-4.7.0.jar                             org.jvnet.mimepull-mimepull-1.9.6.jar
    org.apache.bookkeeper-bookkeeper-proto-4.7.0.jar                              org.projectlombok-lombok-1.16.20.jar
    org.apache.bookkeeper-bookkeeper-server-4.7.0.jar                             org.reactivestreams-reactive-streams-1.0.0.jar
    org.apache.bookkeeper-circe-checksum-4.7.0.jar                                org.rocksdb-rocksdbjni-5.8.6.jar
    org.apache.bookkeeper-stream-storage-java-client-4.7.0.jar                    org.slf4j-jcl-over-slf4j-1.7.25.jar
    org.apache.bookkeeper.http-http-server-4.7.0.jar                              org.slf4j-jul-to-slf4j-1.7.25.jar
    org.apache.bookkeeper.stats-bookkeeper-stats-api-4.7.0.jar                    org.slf4j-slf4j-api-1.7.25.jar
    org.apache.bookkeeper.stats-prometheus-metrics-provider-4.7.0.jar             org.yaml-snakeyaml-1.15.jar
    org.apache.commons-commons-collections4-4.1.jar                               software.amazon.ion-ion-java-1.0.2.jar
    ```

 all/pom.xml              | 18 ++++++++++++++++++
 all/src/assemble/bin.xml | 16 +++++++++-------
 pom.xml                  | 12 ++++++++++++
 3 files changed, 39 insertions(+), 7 deletions(-)

commit 9e88b4de751f0fd3c6e1f7d5aaa176c1cf84c52d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri May 25 16:14:49 2018 -0700

    Update pulsar netty/grpc dependencies (#1844)
    
    
    *Motivation*
    
    apache/pulsar#1816 breaks the pulsar functions running in process mode. This because it removes the shading
    and introduces the conflicts between the netty version that grpc/bk depends and the netty version pulsar depends.
    the grpc doesn't work which fails the health check on functions
    
    *Solution*
    
    Update the netty/grpc/protobuf to align the versions to avoid conflicts between versions.

 pom.xml                                            | 34 ++++++++++++--
 .../pulsar/broker/namespace/OwnershipCache.java    |  6 +--
 pulsar-client-tools/pom.xml                        | 16 +++++++
 .../pulsar/common/policies/data/FailureDomain.java |  6 +--
 pulsar-functions/instance/pom.xml                  | 11 +++++
 pulsar-functions/runtime-all/pom.xml               | 54 ----------------------
 pulsar-functions/runtime/pom.xml                   |  5 ++
 .../pulsar/functions/runtime/ProcessRuntime.java   |  1 +
 .../pulsar/functions/worker/FunctionActioner.java  |  6 ++-
 9 files changed, 70 insertions(+), 69 deletions(-)

commit 333a75cf33b369b0d882a620f82f9ad02efb0f47
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 25 11:17:54 2018 -0700

    If left unspecified, function tenants and namespaces should have the same behavior as topics (#1843)
    
    * If left unspecified, function tenants and namespaces should have the same behavior as topics
    
    * Address comments
    
    * Fixed unittest
    
    * Fix Unittest

 .../org/apache/pulsar/admin/cli/CmdFunctionsTest.java    |  6 +++---
 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 16 ++++------------
 .../main/java/org/apache/pulsar/admin/cli/CmdSinks.java  |  7 +++++++
 .../java/org/apache/pulsar/admin/cli/CmdSources.java     |  7 +++++++
 4 files changed, 21 insertions(+), 15 deletions(-)

commit e249493b7e3a5a5cae4e5a779b9499caccd6324a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 24 09:33:22 2018 -0700

    Make the KakfaSource abstract by allowing users to implement method to extract value (#1842)

 .../org/apache/pulsar/io/kafka/KafkaSource.java     | 21 +++++++++++++--------
 1 file changed, 13 insertions(+), 8 deletions(-)

commit a183d080963553ce8dbef447959a93c13415551e
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Fri May 25 00:31:08 2018 +0800

    Fix flaky test with s3 backend (#1841)
    
    * fix flaky ut
    
    * add try catch to avoid future complete hang
    
    * add more info in log
    
    * add upload id in log

 .../broker/s3offload/S3ManagedLedgerOffloader.java       | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

commit 4e7748b6f320cde28da0cf34b00ed89955b46bfe
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 23 21:47:29 2018 -0700

    Minor code cleanup in JavaInstanceRunnable (#1840)

 .../java/org/apache/pulsar/functions/instance/JavaInstanceRunnable.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0f970e3055dc1ec129da1ccc4e3155415be94724
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 23 21:43:44 2018 -0700

    Removed internal shading (#1816)
    
    * Removed internal shading
    
    * Fixed handling of IllegalArgumentException in ZK client wrapper
    
    * Fixed tests with real ZK server

 all/pom.xml                                        |  12 +-
 all/src/assemble/bin.xml                           |   3 -
 bin/pulsar                                         |  10 +-
 managed-ledger/pom.xml                             |   2 +-
 pom.xml                                            |  13 +-
 pulsar-broker/pom.xml                              |   6 -
 .../pulsar/broker/lookup/TopicLookupBase.java      |  19 +--
 .../s3offload/impl/OffloadIndexBlockImpl.java      |   5 +-
 .../client/api/MessageDispatchThrottlingTest.java  |   4 +-
 pulsar-client-admin-shaded-for-functions/pom.xml   | 180 ---------------------
 pulsar-client-admin/pom.xml                        |  10 +-
 .../org/apache/pulsar/client/admin/Functions.java  |   8 +-
 .../client/admin/internal/FunctionsImpl.java       |  42 ++---
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  11 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  68 ++++----
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  39 +++--
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  36 ++---
 pulsar-functions/instance/pom.xml                  |  12 ++
 .../pulsar/functions/sink/PulsarSinkTest.java      |   2 +-
 pulsar-functions/pom.xml                           |   1 -
 pulsar-functions/runtime-all/pom.xml               |   2 +-
 pulsar-functions/runtime-shaded/pom.xml            |   7 +-
 pulsar-functions/runtime/pom.xml                   |   1 -
 pulsar-functions/utils/pom.xml                     |  89 +---------
 pulsar-functions/worker/pom.xml                    |  71 +-------
 .../org/apache/pulsar/functions/worker/Utils.java  |   4 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |   1 -
 pulsar-zookeeper-utils/pom.xml                     |   2 +-
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   3 +-
 .../zookeeper/ZookeeperClientFactoryImpl.java      |   2 +-
 .../pulsar/zookeeper/ZookeeperServerTest.java      |   2 +
 31 files changed, 158 insertions(+), 509 deletions(-)

commit c4d1ed936b41a58b42d23cbedd87049dd9749976
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed May 23 18:46:55 2018 -0700

    Check if producer is not null before closing (#1839)

 .../kafka/src/main/java/org/apache/pulsar/io/kafka/KafkaSink.java   | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 3988ca394beacc6dd417b40f670213ba27078d6b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 23 15:53:40 2018 -0700

    Remove reference to consumers in client map when unsubscribing (#1836)

 .../client/impl/ConsumerUnsubscribeTest.java       | 64 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  5 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 15 +++++
 3 files changed, 82 insertions(+), 2 deletions(-)

commit a2ca79dad28ecee4e9123678e5d9ed4652e9e13c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 23 12:57:38 2018 -0700

    fixing problem of functions that have an array as input or output (#1837)
    
    * fixing problem of functions that have an array as input or output
    
    * add additional null checks

 pom.xml                                             |  7 +++++++
 pulsar-functions/instance/pom.xml                   |  5 +++++
 .../functions/instance/JavaInstanceRunnable.java    | 21 +++++++++++++--------
 .../apache/pulsar/functions/sink/PulsarSink.java    | 11 +++++++----
 .../pulsar/functions/source/PulsarSource.java       |  9 +++++++--
 pulsar-functions/runtime-shaded/pom.xml             |  3 +++
 6 files changed, 42 insertions(+), 14 deletions(-)

commit e8c8c3744c31ac3a1166a3eb07bbe7d2d77faf3f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 23 11:12:38 2018 -0700

    Resolve the flaky test ReplicatorTest.testCloseReplicatorStartProducer (#1815)
    
    ### Motivation
    
    Fixed the flaky behavior by ensuring the read operation completes with the expected failure instead of throwing assertion error in background.

 .../pulsar/broker/service/ReplicatorTest.java      | 22 +++++++---------------
 1 file changed, 7 insertions(+), 15 deletions(-)

commit 9bf943f0c94452a2928e819472d9fbf1b51f0e2f
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed May 23 11:12:09 2018 -0700

    Change docs versions (#1825)
    
    * bump versions
    
    * fix dangling sentence in pulsar 2.0 doc

 site/_config.yml                               | 4 ++--
 site/docs/latest/getting-started/Pulsar-2.0.md | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit fdb35d449ceae8ec9859bdbf077fd1bbe87d5bad
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 23 19:11:22 2018 +0100

    Integration test for s3offload (#1829)
    
    Starts a cluster with s3offload enabled. Write enough entries to roll
    the ledger. Offload. Manually delete the first ledger. Reboot cluster
    to clear caches. Then read back the whole topic.
    
    Master issue: #1511

 ...luster-2-bookie-1-broker-unstarted-with-s3.yaml | 156 +++++++++++++++++++
 tests/integration/pom.xml                          |   1 +
 tests/integration/s3-offload/pom.xml               |  57 +++++++
 .../pulsar/tests/integration/TestS3Offload.java    | 173 +++++++++++++++++++++
 .../s3-offload/src/test/resources/arquillian.xml   |  32 ++++
 5 files changed, 419 insertions(+)

commit 3e0962811637f4c002ad1e460bdd6da2c769f61a
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 23 11:10:31 2018 -0700

    Added Homebrew recipe for C++ client library (#1834)
    
    ### Motivation
    
    Added recipe to build C++ client library on Mac for Homebrew.
    
    First step is to include the recipe here. The final goal, once 2.1 is released is to have this recipe on main Homebrew repository.

 pulsar-client-cpp/homebrew/libpulsar.rb | 66 +++++++++++++++++++++++++++++++++
 1 file changed, 66 insertions(+)

commit c6c34f53fe4eb453a1fc28c7d26e90115f12ca6f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 23 11:09:55 2018 -0700

    adding worker to instance health check (#1833)
    
    * adding worker to instance health check
    
    * cleaning up logs
    
    * fix bug
    
    * refactoring
    
    * fixing bug
    
    * add check for python

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  2 +-
 .../src/main/python/InstanceCommunication_pb2.py   | 57 +++++++++++++++++---
 .../main/python/InstanceCommunication_pb2_grpc.py  | 20 +++++--
 .../instance/src/main/python/python_instance.py    | 22 ++++++++
 .../instance/src/main/python/server.py             |  3 ++
 .../src/main/proto/InstanceCommunication.proto     |  5 ++
 .../pulsar/functions/runtime/JavaInstanceMain.java | 63 ++++++++++++++++++++--
 .../pulsar/functions/runtime/ProcessRuntime.java   | 57 +++++++++++++++++---
 .../apache/pulsar/functions/runtime/Runtime.java   |  2 +-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  5 ++
 10 files changed, 214 insertions(+), 22 deletions(-)

commit b0b0891147d8b079bc9c6bb8a3d92a4513bb24b7
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 23 17:43:13 2018 +0100

    Use our own minimal S3Mock rather than findify S3Mock (#1806)
    
    * Use our own minimal S3Mock rather than findify S3Mock
    
    The findify mock's project isn't very active, and is missing some
    functionallity, such as setting metadata on multipart objects (it's in
    the code base, but there's no release). Rather than wait for them to
    release with features we need, we should use our own mock, which we
    can update ourselves as needed. Changed to the mock should be
    validated against the real S3 using -DtestRealAWS=true.
    
    Master Issue: #1511
    
    * fix test failures

 pom.xml                                            |   8 -
 pulsar-broker/pom.xml                              |   6 -
 .../broker/s3offload/S3ManagedLedgerOffloader.java |   6 +-
 .../s3offload/S3ManagedLedgerOffloaderTest.java    |  23 +-
 .../org/apache/pulsar/broker/s3offload/S3Mock.java | 334 +++++++++++++++++++++
 .../apache/pulsar/broker/s3offload/S3TestBase.java |  20 +-
 6 files changed, 346 insertions(+), 51 deletions(-)

commit 928ba3d924c32e9bfc2641fecac35064e0228765
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue May 22 15:03:32 2018 -0700

    Don't set Pulsar Memory if variable is already set (#1831)
    
    * Don't set Pulsar Memory if variable is already set
    
    * Took feedback

 conf/pulsar_tools_env.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 26b181e4fcfb9da0827db5f78d29e15c026d20ab
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 22 11:59:39 2018 -0700

    Added option for custom loggers in C++ and C APIs (#1827)

 pulsar-client-cpp/CMakeLists.txt                   |  38 +++++---
 .../include/pulsar/ClientConfiguration.h           |  13 +++
 pulsar-client-cpp/include/pulsar/Logger.h          |  51 +++++++++++
 .../include/pulsar/c/client_configuration.h        |  17 +---
 pulsar-client-cpp/lib/ClientConfiguration.cc       |   7 ++
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    |   2 +
 pulsar-client-cpp/lib/ClientImpl.cc                |  21 ++++-
 pulsar-client-cpp/lib/Log4CxxLogger.h              |  41 +++++++++
 pulsar-client-cpp/lib/Log4cxxLogger.cc             |  96 ++++++++++++++++++++
 pulsar-client-cpp/lib/LogUtils.cc                  |  55 ++++++-----
 pulsar-client-cpp/lib/LogUtils.h                   | 101 ++++++++++-----------
 pulsar-client-cpp/lib/MessageBuilder.cc            |   2 +-
 pulsar-client-cpp/lib/MessageCrypto.cc             |  14 +--
 pulsar-client-cpp/lib/SimpleLoggerImpl.cc          |  90 ++++++++++++++++++
 pulsar-client-cpp/lib/SimpleLoggerImpl.h           |  33 +++++++
 pulsar-client-cpp/lib/c/c_ClientConfiguration.cc   |  30 ++++--
 pulsar-client-cpp/perf/CMakeLists.txt              |   4 +-
 pulsar-client-cpp/perf/PerfConsumer.cc             |   2 -
 pulsar-client-cpp/perf/PerfProducer.cc             |  10 +-
 pulsar-client-cpp/tests/main.cc                    |   1 -
 20 files changed, 500 insertions(+), 128 deletions(-)

commit 6ea9d8501027b63c2e097e0b82d579fc02dae509
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 22 11:36:31 2018 -0700

    Add Pulsar Functions API docs to site build (#1830)
    
    * add javadoc templates to separate folder and add PF API doc gen to script
    
    * add links to PF SDK docs in navbar

 site/.gitignore                                    |  5 +----
 site/Makefile                                      |  1 +
 site/_includes/navbar.html                         |  3 +++
 .../javadoc-admin.html => javadoc/admin.html}      |  0
 .../javadoc-client.html => javadoc/client.html}    |  0
 site/javadoc/pulsar-functions.html                 | 26 ++++++++++++++++++++++
 site/scripts/javadoc-gen.sh                        | 17 ++++++++++++--
 7 files changed, 46 insertions(+), 6 deletions(-)

commit 48e11316170138da7d8bd511356bfa468f4f0426
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 22 18:01:02 2018 +0100

    In S3 offloader, dont use InputStream#available for stream length (#1807)
    
    According to the javadoc, available() returns the number bytes that
    can be read without blocking. It is _not_ the total length of the
    stream. While this currently works for the index as it's backed by a
    byte buffer, we shouldn't rely on implicit assumptions like that.
    
    Master issue: #1511

 .../pulsar/broker/s3offload/OffloadIndexBlock.java | 26 +++++++++++++++++++---
 .../broker/s3offload/S3ManagedLedgerOffloader.java |  4 ++--
 .../s3offload/impl/OffloadIndexBlockImpl.java      | 12 +++++-----
 3 files changed, 30 insertions(+), 12 deletions(-)

commit e98d50a8cde2fcd0bfc28f2552e35798a1073c81
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 22 17:50:26 2018 +0200

    Docker testing init script has wrong service url (#1800)
    
    The script was initializing the broker server url with a http url,
    using the binary protocol port. This patch fixes that and also logs
    the bash commands to make this easier to debug in future.

 tests/docker-images/latest-version-image/scripts/init-cluster.sh | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit ca9099d41586571c9b782a66400d839b08157ea8
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 22 15:54:21 2018 +0200

    BlockAwareSegmentInputStreamImpl shouldn't use LedgerEntry#getLength (#1799)
    
    LedgerEntry#getLength() returns the length of the ledger up to and
    including the length of the entry, not the length of the entry as you
    would expected (and the documentation states). So we shouldn't use it
    when serializing the entry, because what we need is the length of the
    entry.
    
    This patch changes BlockAwareSegmentInputStreamImpl to use the
    readable bytes of the bytebuf instead.
    
    Master Issue: #1511

 .../broker/s3offload/impl/BlockAwareSegmentInputStreamImpl.java      | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 5ce40658e489c3428887244ed1ec1afaba44c9f9
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 22 06:37:43 2018 -0700

    Use exact dependency version in LICENSE file and use check-binary-license to enforce (#1820)

 all/src/assemble/LICENSE.bin.txt | 198 +++++++++++++++++++++++++++++----------
 src/check-binary-license         |  93 ++++++++++++++++++
 2 files changed, 244 insertions(+), 47 deletions(-)

commit 3e04726c0074839713d4bf6d93fb8953768530b4
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon May 21 23:02:32 2018 -0700

    Support non persistent topics in C++ client (#1819)
    
    * Support non persistent topics in C++ client
    
    * Fixed end-to-end test with non-persistent topics

 pulsar-client-cpp/lib/TopicName.cc           |  2 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc |  4 ++--
 pulsar-client-cpp/tests/TopicNameTest.cc     | 10 ++++++++++
 3 files changed, 13 insertions(+), 3 deletions(-)

commit 81e5f9e0238d958e488440e959a26e1a6b0777d8
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon May 21 22:15:55 2018 -0700

    Example Pulsar Function configs in binary distribution (#1824)
    
    * move example YAML configs into java-examples folder
    
    * add example configs to binary distribution
    
    * remove accidentally included file

 all/src/assemble/bin.xml                                       | 10 ++++++++++
 .../src/main/resources/example-function-config.yaml            |  2 +-
 .../src/main/resources/example-window-function-config.yaml     |  2 +-
 3 files changed, 12 insertions(+), 2 deletions(-)

commit 4f076f2e77249473687869b03bfe996169784d3d
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 22 07:14:43 2018 +0200

    S3 offloader doesn't allow block size < 5MB (#1809)
    
    S3 doesn't allow multipart upload to be used with a block size less
    than 5MB. So we shouldn't allow our offloader to be configured with a
    value lower than 5MB.
    
    Master Issue: #1511

 conf/broker.conf                                         |  2 +-
 .../org/apache/pulsar/broker/ServiceConfiguration.java   |  3 ++-
 .../broker/s3offload/S3ManagedLedgerOffloader.java       |  3 +++
 .../broker/s3offload/S3ManagedLedgerOffloaderTest.java   | 16 ++++++++++++++++
 4 files changed, 22 insertions(+), 2 deletions(-)

commit 920b7787d8f6d80213877709d574732c8b77d3c4
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Mon May 21 22:49:05 2018 -0600

    Build responses when returning from web service (#1823)

 .../main/java/org/apache/pulsar/broker/admin/v2/SchemasResource.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 505677a9def60594e277c110e5538888510e583e
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 21 09:59:39 2018 +0200

    S3ManagedLedgerOffloader should require region or endpoint (#1798)
    
    The S3 client requires one of the two, but never both. Previously we
    were throwing an error if region was not specified, even though it's
    not needed if endpoint is.
    
    Master Issue: #1511

 .../apache/pulsar/broker/s3offload/S3ManagedLedgerOffloader.java  | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 069efdbc7520fbcff6e9392c05a8ebbbe8492b0d
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 21 09:57:14 2018 +0200

    Expose offload deletion lag in broker configuration (#1805)
    
    With this configuration, the administrator can configure how long the
    bookkeeper ledger will be kept around after a ledger has been
    successfully offloaded.
    
    Master Issue: #1511

 conf/broker.conf                                             |  4 ++++
 .../org/apache/bookkeeper/mledger/ManagedLedgerConfig.java   |  2 +-
 .../java/org/apache/pulsar/broker/ServiceConfiguration.java  | 12 ++++++++++++
 .../java/org/apache/pulsar/broker/service/BrokerService.java |  2 ++
 4 files changed, 19 insertions(+), 1 deletion(-)

commit fae23437488d8f44a2f7176509750ddd8d168917
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 21 09:55:46 2018 +0200

    Used OrderedScheduler for ledger offload (#1808)
    
    We want to ensure that operations for the same ledger do not
    overlap. This is particularly important for the ReadHandle as it has
    state(the buffer) which could be corrupted by multiple concurrent
    calls.
    
    To avoid this overlap, we use an OrderedScheduler, so all operations
    on a single ledger will run on the same single thread executor.
    
    Master Issue: #1511

 .../java/org/apache/pulsar/broker/PulsarService.java  | 11 ++++++-----
 .../broker/s3offload/S3ManagedLedgerOffloader.java    | 19 +++++++++----------
 .../s3offload/S3ManagedLedgerOffloaderTest.java       |  6 +++---
 3 files changed, 18 insertions(+), 18 deletions(-)

commit 79b0e28d15e1e8c3fcdb4b29aee0956a3a31ebc8
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 21 09:54:28 2018 +0200

    Store offloaded data object size in index (#1810)
    
    We need the size of the data object to set a bound on the stream we
    read from S3. Without the size in the index we need to do an extra
    call to S3 which is undesirable.
    
    Master Issue: #1511

 .../apache/pulsar/broker/s3offload/OffloadIndexBlock.java  |  6 +++++-
 .../pulsar/broker/s3offload/OffloadIndexBlockBuilder.java  |  8 +++++++-
 .../pulsar/broker/s3offload/S3ManagedLedgerOffloader.java  |  7 +++++--
 .../s3offload/impl/OffloadIndexBlockBuilderImpl.java       | 12 ++++++++++--
 .../broker/s3offload/impl/OffloadIndexBlockImpl.java       | 14 +++++++++++++-
 .../broker/s3offload/impl/S3BackedReadHandleImpl.java      |  3 +--
 .../pulsar/broker/s3offload/impl/OffloadIndexTest.java     |  4 +++-
 7 files changed, 44 insertions(+), 10 deletions(-)

commit 2e4362d376511a1349d2508bd666d026cb79f180
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon May 21 00:53:27 2018 -0700

    Improve logging when we fail to bind on server ports (#1811)

 .../pulsar/broker/service/BrokerService.java       |  8 +++++-
 .../apache/pulsar/proxy/server/ProxyService.java   |  9 +++++--
 .../org/apache/pulsar/proxy/server/WebServer.java  | 29 ++++++++++++++++------
 3 files changed, 35 insertions(+), 11 deletions(-)

commit 7f97bde2a384ae00bfbfd1c9f54deb3db124a1ad
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 21 00:52:58 2018 -0700

    adding update functionality to sources and sinks (#1813)

 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 41 +++++++++++++++-------
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 39 ++++++++++++++------
 2 files changed, 57 insertions(+), 23 deletions(-)

commit 0355b1449039bed2a3094a3968d04be8ae67b0ff
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon May 21 00:52:03 2018 -0700

    Fixed race condition in consumer event listener (#1818)
    
    ### Motivation
    
    Fixes #1614 #1617
    
    The flaky test was actually because of a race condition in the dispatcher code. If there is a pending read when the consumer is switched, the actual switch happens after the read completes, but the dispatcher wouldn't trigger the notification at that point.
    
    ### Modifications
    
    Ensure the active/inactive notification is sent after the read completes.

 .../PersistentDispatcherSingleActiveConsumer.java  |  5 +++-
 .../broker/service/PersistentFailoverE2ETest.java  | 27 ++++++++++++----------
 2 files changed, 19 insertions(+), 13 deletions(-)

commit 481f69eae0ca74f99f358389058b439986bf24e6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon May 21 00:51:28 2018 -0700

    Make the current reference sinks usable (#1814)
    
    * Make the current reference sinks usable
    
    * removed unused imports

 .../org/apache/pulsar/io/aerospike/AerospikeSink.java     | 15 +++++++++------
 .../org/apache/pulsar/io/cassandra/CassandraSink.java     | 14 ++++++++------
 .../main/java/org/apache/pulsar/io/kafka/KafkaSink.java   | 13 ++++++++-----
 3 files changed, 25 insertions(+), 17 deletions(-)

commit d7d6ea78384b6882fed1ba00e0f7dbb1cdb19179
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 18 19:04:03 2018 -0700

    Used protobuf-3.x and auto-generation for ManagedLedger and schema registry protobuf (#1812)

 managed-ledger/pom.xml                             |   48 +-
 .../bookkeeper/mledger/proto/MLDataFormats.java    | 5638 --------------------
 pom.xml                                            |    3 +
 pulsar-broker/pom.xml                              |   26 +-
 .../broker/service/schema/SchemaStorageFormat.java | 1785 -------
 .../service/schema/proto/SchemaRegistryFormat.java | 1349 -----
 .../src/main/proto/SchemaRegistryFormat.proto      |    2 +-
 .../src/main/proto/SchemaStorageFormat.proto       |    2 +-
 pulsar-functions/proto/pom.xml                     |    2 +-
 9 files changed, 48 insertions(+), 8807 deletions(-)

commit e800dfb1d6d553892b6f4191dcdb94b523e275c2
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 18 12:54:07 2018 -0700

    Used shaded version of protobuf-2.4.1 internally, to coexist with components using proto3 (#1719)
    
    * Used shaded version of protobuf-2.4.1 internally, to coexist with components using proto3
    
    * 2.1 parent pom
    
    * Add proto3 dependency back since before it was relying on the proto2 dependency
    
    * Fixed dependency

 build/docker/protobuf.patch                        | 1002 ++++-
 managed-ledger/pom.xml                             |   12 +-
 pom.xml                                            |    3 +
 protobuf-shaded/pom.xml                            |   76 +
 .../apache/pulsar/broker/service/ServerCnx.java    |   10 +-
 .../pulsar/broker/service/ServerCnxTest.java       |    2 +-
 .../apache/pulsar/client/impl/MessageCrypto.java   |   16 +-
 .../apache/pulsar/client/impl/MessageIdImpl.java   |   12 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |   23 +-
 pulsar-common/pom.xml                              |   18 +-
 .../org/apache/pulsar/common/api/Commands.java     |    9 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 3858 ++++++++++----------
 .../util/protobuf/ByteBufCodedInputStream.java     |   14 +-
 .../util/protobuf/ByteBufCodedOutputStream.java    |   10 +-
 .../util/protobuf/ByteBufCodedInputStreamTest.java |   15 +-
 pulsar-functions/utils/pom.xml                     |    6 +
 16 files changed, 3007 insertions(+), 2079 deletions(-)

commit 655b7c0edb32a5c22b3a9941764f9867fcb08d36
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 18 06:58:10 2018 -0700

    Ensure BookKeeperClientFactory is only instantiated once in PulsarService (#1804)

 .../pulsar/broker/BookKeeperClientFactoryImpl.java | 28 +++++++++++++++-------
 .../org/apache/pulsar/broker/PulsarService.java    |  8 +++++--
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  2 +-
 .../apache/pulsar/broker/web/WebServiceTest.java   |  2 +-
 4 files changed, 27 insertions(+), 13 deletions(-)

commit e6bcae5428a122a2fcd51f59731191eff1712ecb
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu May 17 16:30:12 2018 -0700

    Document Python dependencies (#1763)
    
    * add installation instructions for Python libs
    
    * update list of python dependencies
    
    * add pulsar-client lib to deps list
    
    * add missing license headers
    
    * add missing line to deps.yaml file under license header

 site/_data/deps.yaml                     | 24 ++++++++++++++++++++++++
 site/_includes/python-deps.html          | 29 +++++++++++++++++++++++++++++
 site/docs/latest/functions/api.md        | 13 +++++++------
 site/docs/latest/functions/quickstart.md |  8 ++++++++
 4 files changed, 68 insertions(+), 6 deletions(-)

commit 1a0c8dcea29feb3d2cee71e4fcc3cab6b06e65bf
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 17 16:29:53 2018 -0700

    Added docker files and script to build static client library and Python bindings on Linux (#1793)
    
    * Added docker files and script to build static client library and Python bindings on Linux
    
    * Added license headers

 pulsar-client-cpp/docker/Dockerfile                | 144 +++++++++++++++++++++
 .../docker/build-client-lib-within-docker.sh       |  34 +++++
 pulsar-client-cpp/docker/build-client-lib.sh       |  44 +++++++
 .../docker/build-wheel-file-within-docker.sh       |  35 +++++
 pulsar-client-cpp/docker/build-wheels.sh           |  48 +++++++
 pulsar-client-cpp/docker/create-images.sh          |  48 +++++++
 pulsar-client-cpp/docker/push-images.sh            |  51 ++++++++
 7 files changed, 404 insertions(+)

commit f09eb3cdbd8542c9f19efbb281891aa0c435116b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 17 12:59:55 2018 -0700

    Remove old comment (#1803)

 .../core/src/main/java/org/apache/pulsar/io/core/Sink.java     | 10 +---------
 1 file changed, 1 insertion(+), 9 deletions(-)

commit 63a6b835bb3f21b63923eb128c285b9f827491d0
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 17 19:43:35 2018 +0200

    Utilities to update configuration for integration tests (#1802)
    
    This patch provides two utility methods. One of them allows the update
    of a key value properties type configuration, such as broker.conf.
    
    The other allows the update of a log4j2.yaml, to add loggers at a certain
    level. This is useful for debugging integration tests.

 .../apache/pulsar/tests/PulsarClusterUtils.java    | 25 +++++++++++++++++++++-
 1 file changed, 24 insertions(+), 1 deletion(-)

commit e22ef77c35c9412461af16113b8107d8933959b4
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 17 19:40:41 2018 +0200

    Log4j2.yaml configures loggers incorrectly (#1801)
    
    log4j2.yaml has a list of loggers. However, this is not a yaml list,
    but a yaml map, so the configuration only picks up the last one.
    
    This patch changes the loggers to a yaml list.

 conf/log4j2.yaml | 48 +++++++++++++++++++++++-------------------------
 1 file changed, 23 insertions(+), 25 deletions(-)

commit 5e4f2bbbf791e216e2eb6c50088c1c5910f0ec20
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 17 10:25:24 2018 -0700

    Modifying sink interface to be generic (#1792)

 .../functions/instance/JavaInstanceRunnable.java   | 10 +--
 .../apache/pulsar/functions/sink/PulsarSink.java   |  8 +-
 .../apache/pulsar/functions/sink/RuntimeSink.java  | 51 ------------
 .../functions/sink/DefaultRuntimeSinkTest.java     | 96 ----------------------
 .../apache/pulsar/io/aerospike/AerospikeSink.java  |  3 +-
 .../apache/pulsar/io/cassandra/CassandraSink.java  |  3 +-
 .../java/org/apache/pulsar/io/core/SimpleSink.java | 46 +++--------
 .../main/java/org/apache/pulsar/io/core/Sink.java  | 21 ++---
 .../java/org/apache/pulsar/io/kafka/KafkaSink.java |  3 +-
 9 files changed, 34 insertions(+), 207 deletions(-)

commit 920ecba6fc53c81191fac011212eccac48186e88
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri May 18 01:07:15 2018 +0900

    Fix C++ MurmurHash3 algorithm (#1795)
    
    * Fix C++ MurmurHash3 algorithm
    
    * Add the same test cases to HashTest.java

 pulsar-client-cpp/lib/Murmur3_32Hash.cc                        |  7 ++++---
 pulsar-client-cpp/tests/HashTest.cc                            | 10 +++++++++-
 .../src/test/java/org/apache/pulsar/client/impl/HashTest.java  |  4 ++++
 3 files changed, 17 insertions(+), 4 deletions(-)

commit 177e88d97e0f7a5745189c0640e2e6192f76c0bc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu May 17 08:50:09 2018 -0700

    adding windowing CLI option comments (#1788)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit a6544bdb82de3056c6350ae9ad389a0f0e5fd2f6
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu May 17 16:35:13 2018 +0800

    PIP-17: impl deleteOffloaded() for S3ManagedLedgerOffloader (#1784)
    
    * s3 delete
    
    * change following @ivan's comments
    
    * fix issue after merge master

 .../broker/s3offload/S3ManagedLedgerOffloader.java | 17 +++++--
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 55 +++++++++++++++++++---
 2 files changed, 63 insertions(+), 9 deletions(-)

commit 971f76bb52aab9a3de162ec050248034e7858492
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 16 18:35:22 2018 -0700

    Create shared library that only exports API symbols (#1794)

 pulsar-client-cpp/CMakeLists.txt                            | 5 +++++
 pulsar-client-cpp/include/pulsar/DeprecatedException.h      | 4 ++++
 pulsar-client-cpp/include/pulsar/TopicMetadata.h            | 4 ++++
 pulsar-client-cpp/include/pulsar/c/authentication.h         | 4 ++++
 pulsar-client-cpp/include/pulsar/c/client.h                 | 4 ++++
 pulsar-client-cpp/include/pulsar/c/client_configuration.h   | 4 ++++
 pulsar-client-cpp/include/pulsar/c/consumer.h               | 4 ++++
 pulsar-client-cpp/include/pulsar/c/consumer_configuration.h | 4 ++++
 pulsar-client-cpp/include/pulsar/c/message.h                | 4 ++++
 pulsar-client-cpp/include/pulsar/c/message_id.h             | 4 ++++
 pulsar-client-cpp/include/pulsar/c/message_router.h         | 4 ++++
 pulsar-client-cpp/include/pulsar/c/producer.h               | 4 ++++
 pulsar-client-cpp/include/pulsar/c/producer_configuration.h | 4 ++++
 pulsar-client-cpp/include/pulsar/c/reader.h                 | 4 ++++
 pulsar-client-cpp/include/pulsar/c/reader_configuration.h   | 4 ++++
 pulsar-client-cpp/include/pulsar/c/result.h                 | 4 ++++
 16 files changed, 65 insertions(+)

commit b1a7b5588774e8c490bb400f3cce517ece7dd748
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 16 14:58:23 2018 -0700

    Fixes in CMakeFiles to automate build on macos (#1787)
    
    * Fixes in CMakeFiles to automate build on macos
    
    * Also fix the lib name for boost-python3
    
    * Added option to disable tests compilation

 pulsar-client-cpp/CMakeLists.txt | 25 ++++++++++++++++++++-----
 1 file changed, 20 insertions(+), 5 deletions(-)

commit 0045d1b324bf06363aaedb1c5b9ea261db1e15cf
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu May 17 03:15:46 2018 +0900

    Fix sidebar link (#1785)

 site/_data/sidebar.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 86fb8a3b3b801030b79460a2d3e88d79347b98c2
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 16 11:15:33 2018 -0700

    Fix build with boost >= 1.65 (#1783)

 pulsar-client-cpp/lib/ClientConnection.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f0b1471a438ea0b4f77c1c00e0b4c64eb57074f7
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 16 19:19:11 2018 +0200

    ReadHandle implementation backed by S3 (#1790)
    
    Implementation of bookkeeper ReadHandle, which reads from an S3
    object.
    
    Master Issue: #1511

 conf/broker.conf                                   |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  12 +
 .../pulsar/broker/s3offload/OffloadIndexEntry.java |   7 +-
 .../broker/s3offload/S3ManagedLedgerOffloader.java |  37 ++-
 .../s3offload/impl/OffloadIndexEntryImpl.java      |   4 +
 .../s3offload/impl/S3BackedReadHandleImpl.java     | 207 +++++++++++++++
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 278 ++++++++++++---------
 7 files changed, 421 insertions(+), 127 deletions(-)

commit b47c05985b199bd862ecbaf21bdf54deccbd4df1
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 16 18:04:25 2018 +0200

    Ability to disable test retries from commandline (#1789)
    
    Sometimes it's useful to be able to disable retries when testing
    sometime, for example, if you want to find flakes, or you have a test
    that's failing and you want to dig into why. This patch adds a
    commandline flag, testRetryCount, which can be passed to maven to
    disable retries.
    
    ```
    mvn test -Dtest=SomeTest -DtestRetryCount=0
    ```

 buildtools/src/main/java/org/apache/pulsar/tests/RetryAnalyzer.java | 2 +-
 pom.xml                                                             | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

commit f3b47c07df815a33a928d6cd997d199bdef4ce6c
Author: haphut <haphut@gmail.com>
Date:   Wed May 16 09:23:10 2018 +0300

    Remove duplicated dependency (#1786)

 pom.xml | 7 -------
 1 file changed, 7 deletions(-)

commit 1478d072712329db33d9744ab1856071f52ea907
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue May 15 22:42:01 2018 -0700

    fixing behavior when configs are empty (#1781)
    
    * fixing empty configs
    
    * refactoring code

 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 17 +++++++++++++++--
 .../apache/pulsar/functions/instance/ContextImpl.java   |  8 ++++++--
 .../pulsar/functions/instance/JavaInstanceRunnable.java | 16 +++++++++++++---
 .../instance/src/main/python/contextimpl.py             |  4 +++-
 .../apache/pulsar/functions/utils/FunctionConfig.java   |  6 +++---
 5 files changed, 40 insertions(+), 11 deletions(-)

commit 5260ba25f823a6fd3d5d5682196bc895e7fee044
Author: haphut <haphut@gmail.com>
Date:   Wed May 16 00:13:35 2018 +0300

    Download dependencies over HTTPS instead of HTTP (#1782)

 pom.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit bcc0bdee67d620b833c33e5a683b08cf04c928b4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue May 15 12:12:25 2018 -0700

    Descriptions of the changes in this PR: (#1779)
    
    *Motivation*
    
    Currently all pulsar's integration tests and bc tests are docker based and written
    using arquillian framework. Due to the way how pulsar integration tests were written,
    we can *ONLY* run integration tests in a linux environment. It is inconvinient to people
    who is using macOS as the development environment.
    
    *Solution*
    
    This PR is providing a Vagrantfile to lanuch a dev vm that contains all the tools required
    for running integration tests and bc tests. So people can actually debug and test integration
    tests locally using a linux vm.

 .gitignore      |  3 ++
 dev/README.md   | 53 +++++++++++++++++++++++++++++++++++
 dev/Vagrantfile | 87 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 143 insertions(+)

commit 46f3829b1fce7a633ea41834760c42ad754af8ce
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 15 11:21:14 2018 -0700

    Fix NPE in Pulsar Functions CLI  (#1776)
    
    As it stands, an NPE is thrown if you try to `create` or `localrun` a function with neither a class name nor a function name supplied, as the CLI will attempt to infer a function name from a class name that is `null`.

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java       | 4 ++++
 1 file changed, 4 insertions(+)

commit d7ab96d3ecb84e3e1e8ff83a1d6a9bceab38eaf6
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed May 16 01:59:24 2018 +0900

    Move isConnected method into each interface class (#1780)

 .../src/main/java/org/apache/pulsar/client/api/Consumer.java         | 5 +++++
 .../src/main/java/org/apache/pulsar/client/api/Producer.java         | 5 +++++
 pulsar-client/src/main/java/org/apache/pulsar/client/api/Reader.java | 5 +++++
 .../src/main/java/org/apache/pulsar/client/impl/ConsumerBase.java    | 2 --
 .../src/main/java/org/apache/pulsar/client/impl/ProducerBase.java    | 2 --
 .../src/main/java/org/apache/pulsar/client/impl/ReaderImpl.java      | 4 ++++
 6 files changed, 19 insertions(+), 4 deletions(-)

commit b6f93f0b4aa4fa96c419bc84150719cd262899ae
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 15 13:59:10 2018 +0200

    InputStream to read from S3 (#1768)
    
    * InputStream to read from S3
    
    Reads from S3 in configurable chunks. Interface allows caller to seek
    to an arbitrary position.
    
    Master Issue: #1511
    
    * Make s3mock use anon credentials to avoid going to S3
    
    Otherwise it uses the default chain which contacts S3. This is
    expensive and time consuming.
    
    * Added read(byte[], int, int)
    
    and other review comments

 .../broker/s3offload/S3BackedInputStream.java      |  27 ++++
 .../s3offload/impl/S3BackedInputStreamImpl.java    | 133 ++++++++++++++++
 .../broker/s3offload/S3BackedInputStreamTest.java  | 177 +++++++++++++++++++++
 .../apache/pulsar/broker/s3offload/S3TestBase.java |   3 +
 4 files changed, 340 insertions(+)

commit c4edead69220388bfb855c8d32442745eddd03b9
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue May 15 19:58:00 2018 +0800

    PIP-17: impl offload() for S3ManagedLedgerOffloader (#1746)
    
    * add write for S3ManagedLedgerOffloader
    
    * merge master, change following comments
    
    * change following @ivan's comments
    
    * change following @ivan's comments
    
    * fix conf error

 conf/broker.conf                                   |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  12 ++
 .../broker/s3offload/S3ManagedLedgerOffloader.java | 128 +++++++++--
 .../impl/BlockAwareSegmentInputStreamImpl.java     |  14 +-
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 237 +++++++++++++++++++--
 .../broker/s3offload/impl/OffloadIndexTest.java    |   2 +-
 6 files changed, 367 insertions(+), 29 deletions(-)

commit 75643daea9a9ea527fb61dc6f186e9d01c2bb7bc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 14 15:49:28 2018 -0700

    setting auto ack to be true for sources and sinks (#1771)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java              | 1 +
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java            | 1 +
 2 files changed, 2 insertions(+)

commit d6a341f4b5160c30c55e071b1d2e6d1860649c07
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 14 14:05:25 2018 -0700

    refactor source and sink classname to be pulsar source and sink when not set (#1769)

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  |  6 ------
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java  |  2 +-
 .../main/java/org/apache/pulsar/admin/cli/CmdSources.java    |  4 ++--
 .../pulsar/functions/instance/JavaInstanceRunnable.java      | 11 ++++++-----
 .../apache/pulsar/functions/runtime/JavaInstanceMain.java    | 12 ++++++++----
 5 files changed, 17 insertions(+), 18 deletions(-)

commit 212eb8116287302a7fd4a7de6a2d71b0cda2c790
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 14 14:05:02 2018 -0700

    adding checkout for auto ack (#1775)

 .../org/apache/pulsar/functions/instance/JavaInstanceRunnable.java  | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 2c5f5dd0a7706310e700b1d59faae23623074764
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon May 14 13:56:07 2018 -0700

    Removed multifunction.jar from sources (#1774)
    
    * Removed multifunction.jar from sources
    
    * Added test dependency
    
    * Removed test scoped dependency on test examples
    
    * Removed tests

 pulsar-functions/pom.xml                           |   2 +-
 pulsar-functions/utils/pom.xml                     |   1 -
 .../functioncache/FunctionCacheEntryTest.java      | 146 -------------------
 .../FunctionCacheManagerImplTest.java              | 162 ---------------------
 .../functioncache/FunctionClassLoadersTest.java    |  56 -------
 .../utils/src/test/resources/multifunction.jar     | Bin 1744 -> 0 bytes
 6 files changed, 1 insertion(+), 366 deletions(-)

commit 0f84222deff90acbb5bab99cc56e9e6f673ad7ef
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 14 12:02:13 2018 -0700

     Implementing PushSource on top of Source (#1766)
    
    * Implementing PushSource on top of Source
    
    * adding missing license header
    
    * fix formatting

 .../java/org/apache/pulsar/io/core/PushSource.java | 48 ++++++++++++++++++----
 .../org/apache/pulsar/io/kafka/KafkaSource.java    | 39 +++++++++++-------
 .../apache/pulsar/io/rabbitmq/RabbitMQSource.java  | 23 +++++------
 .../apache/pulsar/io/twitter/TwitterFireHose.java  | 13 +++---
 4 files changed, 81 insertions(+), 42 deletions(-)

commit 5d6fee39864c4446321dd3a353bb47d4cf6fb945
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 14 11:59:53 2018 -0700

    check record returned by source is not null (#1767)

 .../pulsar/functions/instance/JavaInstanceRunnable.java     | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

commit 553da6588ca38e88f9cb24b4d2c160280be905d6
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun May 13 23:02:27 2018 -0700

    remove unnecessary log message in sink cmd (#1770)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java              | 1 -
 1 file changed, 1 deletion(-)

commit 9fb3dcc8777d0b13175324303c9498dfc4eaa7ca
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun May 13 20:15:16 2018 -0700

    Fixed dasboard docker pom.xml version to 2.1.0-SNAPSHOT (#1773)

 dashboard/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit cd973361a753eb32d7cd62a4dc52dc4d1e65474d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri May 11 15:40:36 2018 -0700

    Windowing for Pulsar Functions (#1758)
    
    * adding window function
    
    * regenerating Function proto for python
    
    * refactoring windowing code based on comments
    
    * fixing tests
    
    * add missing license header
    
    * removing unnecessary imports
    
    * removing another unnecessary import

 conf/example.yml                                   |   6 +-
 conf/window_example.yml                            |  33 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 251 ++++--
 .../org/apache/pulsar/functions/api/Context.java   |   6 +-
 .../pulsar/functions/instance/ContextImpl.java     |  21 +-
 .../functions/instance/JavaInstanceRunnable.java   |   7 +-
 .../windowing/DefaultEvictionContext.java          |  82 ++
 .../apache/pulsar/functions/windowing/Event.java   |  56 ++
 .../pulsar/functions/windowing/EventImpl.java      |  56 ++
 .../functions/windowing/EvictionContext.java       |  56 ++
 .../pulsar/functions/windowing/EvictionPolicy.java | 101 +++
 .../functions/windowing/TimestampExtractor.java    |  34 +
 .../pulsar/functions/windowing/TriggerHandler.java |  32 +
 .../pulsar/functions/windowing/TriggerPolicy.java  |  67 ++
 .../pulsar/functions/windowing/WaterMarkEvent.java |  40 +
 .../windowing/WaterMarkEventGenerator.java         | 152 ++++
 .../apache/pulsar/functions/windowing/Window.java  |  69 ++
 .../pulsar/functions/windowing/WindowContext.java  |  98 +++
 .../functions/windowing/WindowContextImpl.java     |  88 +++
 .../windowing/WindowFunctionExecutor.java          | 298 ++++++++
 .../pulsar/functions/windowing/WindowImpl.java     | 102 +++
 .../windowing/WindowLifecycleListener.java         |  48 ++
 .../pulsar/functions/windowing/WindowManager.java  | 291 +++++++
 .../pulsar/functions/windowing/WindowUtils.java    |  93 +++
 .../windowing/evictors/CountEvictionPolicy.java    |  99 +++
 .../windowing/evictors/TimeEvictionPolicy.java     | 112 +++
 .../evictors/WatermarkCountEvictionPolicy.java     | 128 ++++
 .../evictors/WatermarkTimeEvictionPolicy.java      |  88 +++
 .../windowing/triggers/CountTriggerPolicy.java     |  91 +++
 .../windowing/triggers/TimeTriggerPolicy.java      | 147 ++++
 .../triggers/WatermarkCountTriggerPolicy.java      | 107 +++
 .../triggers/WatermarkTimeTriggerPolicy.java       | 141 ++++
 .../instance/src/main/python/Function_pb2.py       | 138 ++--
 .../instance/src/main/python/contextimpl.py        |   8 +-
 .../src/main/python/python_instance_main.py        |   4 +-
 .../windowing/WaterMarkEventGeneratorTest.java     | 134 ++++
 .../windowing/WindowFunctionExecutorTest.java      | 605 +++++++++++++++
 .../functions/windowing/WindowManagerTest.java     | 839 +++++++++++++++++++++
 .../functions/api/examples/PublishFunction.java    |   2 +-
 .../functions/api/examples/UserConfigFunction.java |   4 +-
 .../functions/api/examples/WindowFunction.java     |  40 +
 .../proto/src/main/proto/Function.proto            |   2 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |   5 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |   4 +-
 .../pulsar/functions/utils/FunctionConfig.java     |   3 +-
 .../pulsar/functions/utils/WindowConfig.java       |  53 ++
 46 files changed, 4673 insertions(+), 168 deletions(-)

commit e2b95f2560f3d524d39a459a59682717d51d65f0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 10 22:46:31 2018 -0700

    Allow ability to specify resources to functions (#1751)
    
    * Added ability to specify resources to functions
    
    * Corrected arguments
    
    * Address comments
    
    * Take feedback into account

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 25 +++++++++++++++
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java | 28 ++++++++++++++++-
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 29 ++++++++++++++++-
 .../proto/src/main/proto/Function.proto            |  7 +++++
 .../pulsar/functions/runtime/ProcessRuntime.java   |  7 +++++
 .../pulsar/functions/utils/FunctionConfig.java     |  1 +
 .../apache/pulsar/functions/utils/Resources.java   | 36 ++++++++++++++++++++++
 .../apache/pulsar/functions/utils/SinkConfig.java  |  1 +
 .../pulsar/functions/utils/SourceConfig.java       |  1 +
 9 files changed, 133 insertions(+), 2 deletions(-)

commit 14e893a9bd5d49a94076dcd7ca2f3d6b7c3bebfc
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 10 22:46:09 2018 -0700

    Encode the path for download (#1765)

 .../java/org/apache/pulsar/functions/worker/rest/api/FunctionsImpl.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 40a5aa5366c6e8c1ed172bfc5fcf7e1749717703
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 10 16:01:12 2018 -0700

    In C API add context pointer to callbacks (#1761)

 .../examples/SampleConsumerListenerCApi.c          |  4 +--
 pulsar-client-cpp/include/pulsar/c/client.h        | 20 +++++------
 pulsar-client-cpp/include/pulsar/c/consumer.h      | 17 ++++-----
 .../include/pulsar/c/consumer_configuration.h      |  9 ++---
 pulsar-client-cpp/include/pulsar/c/message_id.h    |  6 +++-
 .../include/pulsar/c/message_router.h              |  3 +-
 pulsar-client-cpp/include/pulsar/c/producer.h      |  8 ++---
 .../include/pulsar/c/producer_configuration.h      |  2 +-
 pulsar-client-cpp/include/pulsar/c/reader.h        |  4 +--
 .../include/pulsar/c/reader_configuration.h        |  4 +--
 pulsar-client-cpp/lib/c/c_Client.cc                | 42 +++++++++++-----------
 pulsar-client-cpp/lib/c/c_Consumer.cc              | 28 ++++++++-------
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc | 12 ++++---
 pulsar-client-cpp/lib/c/c_MessageId.cc             | 13 ++++++-
 pulsar-client-cpp/lib/c/c_Producer.cc              | 14 ++++----
 pulsar-client-cpp/lib/c/c_ProducerConfiguration.cc |  9 ++---
 pulsar-client-cpp/lib/c/c_Reader.cc                |  4 +--
 pulsar-client-cpp/lib/c/c_ReaderConfiguration.cc   |  8 ++---
 pulsar-client-cpp/lib/c/c_structs.h                |  8 +++--
 19 files changed, 120 insertions(+), 95 deletions(-)

commit 778fd749894befa64847a108ec97fc7cbc8b5ad4
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 10 20:00:29 2018 +0200

    Base class for S3 testing (#1759)
    
    Moves the setting up of the mock and s3 client into a base class so
    that it can be shared by multiple tests.
    
    Includes a switch, that can be flipped with the system property
    testRealAWS(i.e. -DtestRealAWS=true) to run the test against real AWS,
    rather than the mock. This is disabled by default, but allows us to
    validate that the mock is behaving the same way as S3 would. It
    requires that credentials and a default region are specified in
    ~/.aws.
    
    Master Issue: #1511

 pom.xml                                            |  5 ++
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 38 ++-----------
 .../apache/pulsar/broker/s3offload/S3TestBase.java | 63 ++++++++++++++++++++++
 3 files changed, 71 insertions(+), 35 deletions(-)

commit e695c82b4bfa2a98f92f52dd58eda0fa48833146
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 10 08:16:28 2018 +0200

    S3Offload datablock magic word should be negative (#1753)
    
    * S3Offload datablock magic word should be negative
    
    When reading in a bunch of blocks, we need to know when we've hit the
    next block or padding. To identify padding, we just check if the read
    in value is negative. Hitting the magic word for a new block should do
    the same.
    
    Master Issue: #1511
    
    * fix unit test

 .../org/apache/pulsar/broker/s3offload/impl/DataBlockHeaderImpl.java    | 2 +-
 .../org/apache/pulsar/broker/s3offload/impl/DataBlockHeaderTest.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit c7117a3f045d8f33beca20de926d6641e99424e8
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 10 08:14:52 2018 +0200

    Inject AmazonS3 into S3ManagedLedgerOffloader (#1755)
    
    Rather than creating it directly in the offloader, inject the AmazonS3
    object so that it can be mocked for testing.
    
    Master Issue: #1511

 .../org/apache/pulsar/broker/PulsarService.java    |  2 +-
 .../broker/s3offload/S3ManagedLedgerOffloader.java | 14 ++++++++----
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 26 +++++++++-------------
 3 files changed, 22 insertions(+), 20 deletions(-)

commit 8b2dfd04d8bac20ade9438c953dd74337835098f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed May 9 19:28:13 2018 -0700

    Have the ability to provide source/sink config in cmdline for sources/sinks (#1757)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java       | 8 ++++++++
 .../src/main/java/org/apache/pulsar/admin/cli/CmdSources.java     | 8 ++++++++
 .../main/java/org/apache/pulsar/functions/utils/SinkConfig.java   | 2 +-
 3 files changed, 17 insertions(+), 1 deletion(-)

commit 114be4457320715d0b34922275f0f37907e1d429
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu May 10 03:22:53 2018 +0200

    BlockAwareSegmentInputStream should only return unsigned bytes (#1741)
    
    The contract for InputStream expects that read() returns a positive
    int, except in the case of EOF, when it returns -1. In
    BlockAwareSegmentInputStream, we were returning the padding as a
    signed byte, and reading from the ledger as a signed byte. This meant
    that for padding, we were returning negative integers, and possibly
    returning negative integers, even -1 depending on the data, when
    reading from the ledger.
    
    This change ensures that BlockAwareSegmentInputStream always returns
    positive int except in the case of EOF.
    
    Master Issue: #1511

 .../impl/BlockAwareSegmentInputStreamImpl.java     |  9 +---
 .../impl/BlockAwareSegmentInputStreamTest.java     | 60 +++++++++++++++++-----
 2 files changed, 48 insertions(+), 21 deletions(-)

commit f53562755b033062e5774592b5276da66ec2a752
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed May 9 15:08:42 2018 -0700

    Throw exception of source/sink (#1756)
    
    * Throw exception of source/sink
    
    * Don't double log

 .../pulsar/functions/instance/JavaInstanceRunnable.java  | 16 +++-------------
 1 file changed, 3 insertions(+), 13 deletions(-)

commit 374075eefa247f1b0518ccd6cba285591be6e87d
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 9 20:47:25 2018 +0200

    Fix exception in offload index block for consistency (#1754)
    
    One number was being printed with 0x, the other wasn't. Added 0x for
    both, and changed it to use String.format() to avoid string
    concatenation.
    
    Master Issue: #1511

 .../apache/pulsar/broker/s3offload/impl/OffloadIndexBlockImpl.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit f1e6eb80963de7ee4d1de7a1c9457bf8008992ab
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 8 18:51:22 2018 -0700

    Fixed licenses and notice file (#1748)
    
    * Fixed licenses and notice file
    
    * Added licenses for some dependencies bundled in Netty
    
    * Forgot mention of UnixCrypt
    
    * Fixed indent

 all/licenses/LICENSE-AspectJ.txt             | 64 +++++++++++++++++++++++
 all/licenses/LICENSE-JSR305.txt              | 28 ++++++++++
 all/licenses/LICENSE-LevelDB.txt             | 29 +++++++++++
 all/licenses/LICENSE-Lombok.txt              | 19 +++++++
 all/licenses/LICENSE-Webbit.txt              | 37 ++++++++++++++
 all/licenses/LICENSE-google-auth-library.txt | 28 ++++++++++
 all/licenses/LICENSE-jbzip2.txt              | 19 +++++++
 all/licenses/LICENSE-jfastlz.txt             | 24 +++++++++
 all/licenses/LICENSE-libdivsufsort.txt       | 22 ++++++++
 all/src/assemble/LICENSE.bin.txt             | 63 +++++++++++++++++++++--
 all/src/assemble/NOTICE.bin.txt              | 76 ++++++++++++++++++++++++++++
 11 files changed, 405 insertions(+), 4 deletions(-)

commit 17f74150f43fc3766e78e2a566c6a4b8d2150d5b
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 8 12:21:15 2018 -0700

    Pulsar IO rename (#1747)
    
    * begin renaming process
    
    * more class and directory renames
    
    * move Record classes into pulsar-io
    
    * apply rename to Maven configs
    
    * rename java imports
    
    * update versions in maven configs
    
    * add missing imports
    
    * remove Message class from pulsar-io
    
    * add missing import
    
    * add Reflections util import
    
    * add Utils import
    
    * add missing Record import
    
    * supply missing Record imports

 pom.xml                                            |  6 ++---
 pulsar-client-admin-shaded-for-functions/pom.xml   |  4 +--
 pulsar-client-admin-shaded/pom.xml                 |  4 +--
 pulsar-client-shaded/pom.xml                       |  4 +--
 .../java/org/apache/pulsar/admin/cli/CmdSinks.java |  9 ++++---
 .../org/apache/pulsar/admin/cli/CmdSources.java    |  9 ++++---
 pulsar-client/pom.xml                              |  2 +-
 .../pulsar/client/impl/MessageRecordImpl.java      |  2 +-
 pulsar-functions/instance/pom.xml                  |  4 +--
 .../pulsar/functions/instance/JavaInstance.java    |  2 +-
 .../functions/instance/JavaInstanceRunnable.java   |  6 ++---
 .../pulsar/functions/sink/DefaultRuntimeSink.java  |  2 +-
 .../apache/pulsar/functions/sink/PulsarSink.java   |  2 +-
 .../pulsar/functions/sink/PulsarSinkConfig.java    |  2 --
 .../apache/pulsar/functions/sink/RuntimeSink.java  |  4 +--
 .../pulsar/functions/source/PulsarRecord.java      |  2 +-
 .../pulsar/functions/source/PulsarSource.java      |  4 +--
 .../functions/sink/DefaultRuntimeSinkTest.java     |  4 +--
 pulsar-functions/utils/pom.xml                     |  2 +-
 {pulsar-connect => pulsar-io}/aerospike/pom.xml    |  8 +++---
 .../apache/pulsar/io}/aerospike/AerospikeSink.java | 23 ++++++++++-------
 .../pulsar/io}/aerospike/AerospikeSinkConfig.java  |  2 +-
 {pulsar-connect => pulsar-io}/cassandra/pom.xml    |  8 +++---
 .../apache/pulsar/io}/cassandra/CassandraSink.java | 11 +++++---
 .../pulsar/io}/cassandra/CassandraSinkConfig.java  |  2 +-
 {pulsar-connect => pulsar-io}/core/pom.xml         |  6 ++---
 .../org/apache/pulsar/io}/core/PushSource.java     |  2 +-
 .../java/org/apache/pulsar/io}/core/Record.java    |  2 +-
 .../org/apache/pulsar/io}/core/RecordContext.java  |  2 +-
 .../main/java/org/apache/pulsar/io}/core/Sink.java |  2 +-
 .../java/org/apache/pulsar/io}/core/Source.java    |  2 +-
 {pulsar-connect => pulsar-io}/kafka/pom.xml        |  8 +++---
 .../org/apache/pulsar/io}/kafka/KafkaSink.java     |  4 +--
 .../apache/pulsar/io}/kafka/KafkaSinkConfig.java   |  2 +-
 .../org/apache/pulsar/io}/kafka/KafkaSource.java   | 10 +++++---
 .../apache/pulsar/io}/kafka/KafkaSourceConfig.java |  2 +-
 {pulsar-connect => pulsar-io}/pom.xml              |  4 +--
 {pulsar-connect => pulsar-io}/rabbitmq/pom.xml     |  8 +++---
 .../apache/pulsar/io}/rabbitmq/RabbitMQConfig.java |  2 +-
 .../apache/pulsar/io}/rabbitmq/RabbitMQSource.java | 13 +++++++---
 {pulsar-connect => pulsar-io}/twitter/pom.xml      |  8 +++---
 .../apache/pulsar/io}/twitter/TwitterFireHose.java | 29 +++++++++++-----------
 .../pulsar/io}/twitter/TwitterFireHoseConfig.java  |  2 +-
 43 files changed, 128 insertions(+), 108 deletions(-)

commit 705638430161e656d34472b9e5004ab25497ed98
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 8 11:58:05 2018 -0700

    Schema registry documentation (#1457)
    
    * add basic notes for schema registry
    
    * more notes on schema registry in C&A doc
    
    * add java interfaces to concepts doc
    
    * add theoretical docs
    
    * add schema storage cookbook
    
    * add schema storage cookbook to sidebar
    
    * remove schema storage cookbook for now
    
    * remove unused notes
    
    * add java examples
    
    * add schema components
    
    * add user config
    
    * add examples of user-defined props
    
    * finish draft of java client docs
    
    * add custom schema storage document
    
    * more sections in custom doc
    
    * add schemaRegistryStorageClassName to conf/broker.conf file
    
    * change sentence in getting started guide

 conf/broker.conf                                   |  4 +
 site/_data/sidebar.yaml                            |  2 +
 site/_includes/explanations/install-package.md     |  2 +-
 site/docs/latest/clients/Java.md                   | 98 ++++++++++++++++++----
 .../getting-started/ConceptsAndArchitecture.md     | 71 ++++++++++++++++
 site/docs/latest/project/schema-storage.md         | 58 +++++++++++++
 6 files changed, 217 insertions(+), 18 deletions(-)

commit faa107bb9383de16b0d1fdfdf9f005a383c6745d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 8 10:32:59 2018 -0700

    remove superfluous usage() call (#1744)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdBase.java               | 1 -
 1 file changed, 1 deletion(-)

commit f331ff756cb1e86a5c0883d78c3cc6ad559c28c0
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue May 8 11:13:16 2018 +0200

    Allow padding at end of last BlockAwareSegmentInputStream (#1739)
    
    Previous to this patch, we expected that the last block for an
    offloaded ledger would have its size calculated externally, before
    writing, and that calculation would be correct to the byte. This is
    fine, and should be the case in most cases, but in the case where the
    calculation was off by one, the whole stream breaks.
    
    This patch makes BlockAwareSegmentInputStreamImpl more forgiving in
    terms of block size. If the block size is exact, it works as before,
    but if the block size is larger than needed, padding is added.
    
    Master Issue: #1511

 .../impl/BlockAwareSegmentInputStreamImpl.java     | 23 +++----
 .../impl/BlockAwareSegmentInputStreamTest.java     | 70 +++++++++++++++++++++-
 2 files changed, 82 insertions(+), 11 deletions(-)

commit 17a7d91ab5b73cfbce1ae775dfc6312e88896287
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue May 8 02:05:33 2018 -0700

    Seperate cmd line connector interface to explicit source and sink (#1745)

 .../cli/{CmdConnectors.java => CmdSinks.java}      | 245 ++-------------
 .../org/apache/pulsar/admin/cli/CmdSources.java    | 329 +++++++++++++++++++++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   3 +-
 3 files changed, 351 insertions(+), 226 deletions(-)

commit cb648d2e4705e19ba8bc607214fe99d0de23c35e
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon May 7 17:31:41 2018 -0700

    Print periodic status of instances in localrun (#1734)
    
    * Log status of running instances periodically
    
    * Fix shading conflicts
    
    * Add shutdown hook to cancel the timer

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 37 ++++++++++++++++++----
 .../pulsar/functions/runtime/RuntimeSpawner.java   | 12 +++++++
 2 files changed, 42 insertions(+), 7 deletions(-)

commit a2f8aa86943de11da944250ceafd470f26421699
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon May 7 16:07:31 2018 -0700

    Move functions to use V2 style namespaces for internal data keeping (#1742)
    
    * Move functions to use V2 style namespaces for internal data keeping
    
    * Incorporate feedback

 conf/functions_worker.yml                                        | 3 ++-
 .../src/main/java/org/apache/pulsar/broker/PulsarService.java    | 9 +++++----
 .../src/main/java/org/apache/pulsar/functions/worker/Worker.java | 3 +++
 .../java/org/apache/pulsar/functions/worker/WorkerConfig.java    | 1 +
 4 files changed, 11 insertions(+), 5 deletions(-)

commit 2de85486fc1bdbfaf5499026d2da7946e419ff98
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Mon May 7 15:39:48 2018 -0600

    Include Jackson modules in shaded jar as well (#1729)
    
    * Include Jackson modules in shaded jar as well
    
    * Add to shaded admin client as well
    
    * Add to shaded client jar

 pulsar-client-admin-shaded-for-functions/pom.xml              | 1 +
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 1 +
 pulsar-client-shaded/pom.xml                                  | 1 +
 3 files changed, 3 insertions(+)

commit 8f705be78b63f025b12093c883ab33b94669e090
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue May 8 05:39:10 2018 +0800

    fix idnex entry offset (#1738)

 .../pulsar/broker/s3offload/impl/OffloadIndexBlockBuilderImpl.java  | 6 ++++--
 .../apache/pulsar/broker/s3offload/impl/OffloadIndexBlockImpl.java  | 5 +++--
 .../org/apache/pulsar/broker/s3offload/impl/OffloadIndexTest.java   | 2 +-
 3 files changed, 8 insertions(+), 5 deletions(-)

commit 97829ef0df7d540fa0102dc4aa0cc2d69b996389
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon May 7 14:00:35 2018 -0700

     allow custom sources and sink to run on connector framework (#1733)
    
    * allow custom sources and sink to run on connector framework
    
    * cleaning up
    
    * removing connector endpoints
    
    * addressing comments
    
    * addressing comments
    
    * addressing comments
    
    * addressing comments
    
    * correcting comments
    
    * fixing unit test

 .../org/apache/pulsar/client/admin/Functions.java  |   2 -
 .../org/apache/pulsar/admin/cli/CmdConnectors.java | 552 +++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 144 +++---
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   1 +
 .../functions/api/utils/IdentityFunction.java      |  28 ++
 .../pulsar/functions/instance/JavaInstance.java    |   4 +-
 .../functions/instance/JavaInstanceRunnable.java   |  32 +-
 .../MultiConsumersOneOuputTopicProducers.java      |  39 +-
 .../functions/instance/producers/Producers.java    |  21 +-
 .../apache/pulsar/functions/sink/PulsarSink.java   |  39 +-
 .../pulsar/functions/source/PulsarSource.java      |   2 +-
 .../MultiConsumersOneOutputTopicProducersTest.java |  15 +-
 .../proto/src/main/proto/Function.proto            |   2 +
 .../pulsar/functions/runtime/JavaInstanceMain.java |  18 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |  11 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   8 +-
 .../apache/pulsar/functions/utils/SinkConfig.java  |  44 ++
 .../pulsar/functions/utils/SourceConfig.java       |  45 ++
 .../functions/worker/rest/api/FunctionsImpl.java   |   6 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  78 +--
 20 files changed, 869 insertions(+), 222 deletions(-)

commit cc77e6c809b5cd75601cd9bcc47a868104b688b2
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 7 20:53:07 2018 +0200

    Add Commons Logging bridge to broker (#1740)
    
    The AWS SDK, which we use for S3 offload uses commons logging as its
    logging API. For slf4j to be able to pick up this logs, we need to use
    the jcl-over-slf4j bridge. This patch adds the bridge as a dependency
    for the broker.
    
    Master Issue: #1511

 pom.xml               | 6 ++++++
 pulsar-broker/pom.xml | 5 +++++
 2 files changed, 11 insertions(+)

commit 87440f54141978d401164bc94b02d48eeca7f5bb
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 7 10:33:10 2018 +0200

    Skeleton code for S3 offload (#1723)
    
    * Skeleton code for S3 offload
    
    Doesn't implement any of the logic for putting a ledger into an
    object, but does contain code to configure a S3 client and create an
    object, albeit empty.
    
    Also adds a s3mock implementation to test against.
    
    Master issue: #1511
    
    * Fixed NPE
    
    * remove test dependent on local env
    
    Test only worked because I had aws configured locally. Removing for
    now, we can bring something similar back later

 conf/broker.conf                                   |  16 +++
 pom.xml                                            |  16 +++
 .../apache/pulsar/broker/ServiceConfiguration.java |  57 ++++++++
 pulsar-broker/pom.xml                              |  11 ++
 .../org/apache/pulsar/broker/PulsarService.java    |  30 +++-
 .../broker/s3offload/S3ManagedLedgerOffloader.java |  97 +++++++++++++
 .../s3offload/S3ManagedLedgerOffloaderTest.java    | 151 +++++++++++++++++++++
 7 files changed, 377 insertions(+), 1 deletion(-)

commit c570fb18289c3183d28b5128df6759c84e6c5afd
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon May 7 10:29:46 2018 +0200

    Make BlockAwareSegmentInputStream extend InputStream (#1730)
    
    So that it can be used as an InputStream with the S3 interfaces.
    
    Master Issue: #1511

 .../broker/s3offload/BlockAwareSegmentInputStream.java    | 15 ++++++++-------
 .../s3offload/impl/BlockAwareSegmentInputStreamImpl.java  |  2 +-
 2 files changed, 9 insertions(+), 8 deletions(-)

commit 1ab1e28c2c419b50ca7109073904510f8aa0b641
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun May 6 15:42:19 2018 -0700

    C API wrapper based on C++ client library (#1736)
    
    ### Motivation
    
    Added plain C API for Pulsar client.
    
    This is implemented as a super-thin wrapper on top of existing C++ client library. The same `libpulsar.so` will contain both implementations.
    
    Primary use case for this API is to enable wrapping Pulsar client library in higher level languages that have facilities to convert C APIs but not C++ code. One such example is Go language, that with `cgo` can generate bindings for C headers.
    
    Added some working examples for how to use Pulsar C API and I'll add unit tests directly in Go, to cover both wrappers at once.

 pulsar-client-cpp/.gitignore                       |   4 +
 pulsar-client-cpp/examples/CMakeLists.txt          |  24 +++
 pulsar-client-cpp/examples/SampleConsumerCApi.c    |  60 +++++++
 .../examples/SampleConsumerListenerCApi.c          |  59 +++++++
 pulsar-client-cpp/examples/SampleProducerCApi.c    |  63 +++++++
 pulsar-client-cpp/examples/SampleReaderCApi.c      |  59 +++++++
 .../include/pulsar/c/authentication.h              |  35 ++++
 pulsar-client-cpp/include/pulsar/c/client.h        | 133 ++++++++++++++
 .../include/pulsar/c/client_configuration.h        | 144 +++++++++++++++
 pulsar-client-cpp/include/pulsar/c/consumer.h      | 194 +++++++++++++++++++++
 .../include/pulsar/c/consumer_configuration.h      | 163 +++++++++++++++++
 pulsar-client-cpp/include/pulsar/c/message.h       | 168 ++++++++++++++++++
 pulsar-client-cpp/include/pulsar/c/message_id.h    |  53 ++++++
 .../include/pulsar/c/message_router.h              |  36 ++++
 pulsar-client-cpp/include/pulsar/c/producer.h      | 119 +++++++++++++
 .../include/pulsar/c/producer_configuration.h      | 147 ++++++++++++++++
 pulsar-client-cpp/include/pulsar/c/reader.h        |  69 ++++++++
 .../include/pulsar/c/reader_configuration.h        |  82 +++++++++
 pulsar-client-cpp/include/pulsar/c/result.h        |  81 +++++++++
 pulsar-client-cpp/lib/CMakeLists.txt               |   2 +-
 pulsar-client-cpp/lib/c/c_Authentication.cc        |  33 ++++
 pulsar-client-cpp/lib/c/c_Client.cc                | 142 +++++++++++++++
 pulsar-client-cpp/lib/c/c_ClientConfiguration.cc   | 115 ++++++++++++
 pulsar-client-cpp/lib/c/c_Consumer.cc              | 122 +++++++++++++
 pulsar-client-cpp/lib/c/c_ConsumerConfiguration.cc | 104 +++++++++++
 pulsar-client-cpp/lib/c/c_Message.cc               |  96 ++++++++++
 pulsar-client-cpp/lib/c/c_MessageId.cc             |  58 ++++++
 pulsar-client-cpp/lib/c/c_MessageRouter.cc         |  26 +++
 pulsar-client-cpp/lib/c/c_Producer.cc              |  62 +++++++
 pulsar-client-cpp/lib/c/c_ProducerConfiguration.cc | 175 +++++++++++++++++++
 pulsar-client-cpp/lib/c/c_Reader.cc                |  54 ++++++
 pulsar-client-cpp/lib/c/c_ReaderConfiguration.cc   |  78 +++++++++
 pulsar-client-cpp/lib/c/c_Result.cc                |  23 +++
 pulsar-client-cpp/lib/c/c_structs.h                |  80 +++++++++
 34 files changed, 2862 insertions(+), 1 deletion(-)

commit afdf6fbf2b0d3d412dfd39cfe2820dcd564fc9cc
Author: Byron Ruth <b@devel.io>
Date:   Sat May 5 10:30:27 2018 -0400

    Add `messageId` query param for WS Reader doc (#1732)
    
    Signed-off-by: Byron Ruth <b@devel.io>

 site/docs/latest/clients/WebSocket.md | 1 +
 1 file changed, 1 insertion(+)

commit ee3e06d660cf8409607695ee8041dd563ff0cac9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri May 4 22:38:59 2018 -0700

    Encode zk-path for function-pkg (#1727)
    
    * Encode zk-path for function-pkg
    
    * encode only function-name in package-path
    
    * fix test

 .../org/apache/pulsar/functions/worker/Utils.java  |  1 +
 .../functions/worker/rest/api/FunctionsImpl.java   | 23 +++++++++-------------
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  3 ++-
 3 files changed, 12 insertions(+), 15 deletions(-)

commit e3f235b28bd3fcc151668acd0ff9238394104ffe
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat May 5 07:38:40 2018 +0200

    Move s3 unit tests into correct package (#1728)
    
    Unit tests should be in the same package as the units they are testing
    so that they can reach into internals without having to expose those
    internals to the world.
    
    Master issue: #1511

 .../s3offload/impl}/BlockAwareSegmentInputStreamTest.java             | 4 +---
 .../{s3offload => broker/s3offload/impl}/DataBlockHeaderTest.java     | 3 +--
 .../pulsar/{s3offload => broker/s3offload/impl}/OffloadIndexTest.java | 4 +---
 3 files changed, 3 insertions(+), 8 deletions(-)

commit bb98419a41581410f79f3a23383c1a6c9ab32d11
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 4 22:26:41 2018 -0700

    Simplify creation of functions namespace (#1735)

 .../java/org/apache/pulsar/functions/worker/Worker.java    | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

commit 6a42419bd20350d1814168ed4df33439aa112a9f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri May 4 15:00:40 2018 -0700

    Make Function port part of InstanceConfig (#1731)
    
    * Made port part of instance config
    
    * Put back worker dep

 .../java/org/apache/pulsar/admin/cli/CmdFunctions.java |  1 +
 .../pulsar/functions/instance/InstanceConfig.java      |  1 +
 .../pulsar/functions/runtime/JavaInstanceMain.java     |  1 +
 .../pulsar/functions/runtime/ProcessRuntime.java       | 18 ++----------------
 .../java/org/apache/pulsar/functions/utils/Utils.java  | 15 +++++++++++++++
 .../pulsar/functions/worker/FunctionActioner.java      |  1 +
 6 files changed, 21 insertions(+), 16 deletions(-)

commit 7cd7034731a8964d2853c9af81aa645f5309f5d1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu May 3 18:31:02 2018 -0700

    Changed property to tenant in various helper messages and tests (#1726)

 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 58 +++++++-------
 .../apache/pulsar/common/naming/TopicNameTest.java | 92 +++++++++++-----------
 2 files changed, 75 insertions(+), 75 deletions(-)

commit e5f2e32c526bf88592ce7ce9e6261ccabe9aa858
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu May 3 14:23:48 2018 -0700

    Document default values for Pulsar Functions (#1657)
    
    * add section on default values
    
    * clarify default tenants and namespaces

 site/docs/latest/functions/api.md        | 12 ++++++----
 site/docs/latest/functions/deployment.md | 39 ++++++++++++++++++++++++++++++++
 site/docs/latest/functions/overview.md   |  4 ++--
 3 files changed, 49 insertions(+), 6 deletions(-)

commit 8054d291eba66d61075cada3a0f316ac1ada2e37
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu May 3 14:04:39 2018 -0700

    Exclude grpc dependencies in binary distribution (#1724)
    
    *Motivation*
    
    Gprc is used by functions as control plane. The dependencies were shaded in `pulsar-functions-runtime`. However the assembly plugin still
    includes those dependencies in the binary distribution. It causes the conflicts between protobuf versions.
    
    *Solution*
    
    Exclude grpc dependencies in binary distribution.

 all/src/assemble/bin.xml | 3 +++
 1 file changed, 3 insertions(+)

commit ea07ee112d0e5803698dc16d752fa67846a8eab0
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 3 14:04:23 2018 -0700

    Fixed clusters REST API to omit "global" cluster in response (#1725)

 .../pulsar/broker/admin/impl/ClustersBase.java     | 33 +++++++++++++---------
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  3 ++
 2 files changed, 22 insertions(+), 14 deletions(-)

commit ab0d081da0adb148a5f3aa94a86ab1589f103541
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu May 3 15:56:27 2018 +0800

    PIP-17: provide BlockAwareSegmentInputStream implementation and test (#1678)
    
    ### Motivation
    
    Implementation of InputStream(BlockAwareSegmentInputStream). when calls the is.read(), it return the following data:
    -  Block header
    -  Ledger entries starting from passed in entryId
    -  Padding in the with bytes 0xFEDCDEAD
    
    This is based on PR #1669 (commit 3c8a846), And PR #1669 should be reviewed and merged first.
    
    Master issue #1511
    
    ### Modifications
    
    Add class BlockAwareSegmentInputStream and test for it.
    
    ### Result
    
    unit test pass.

 .../s3offload/BlockAwareSegmentInputStream.java    |  70 ++++
 .../impl/BlockAwareSegmentInputStreamImpl.java     | 210 ++++++++++
 .../BlockAwareSegmentInputStreamTest.java          | 437 +++++++++++++++++++++
 3 files changed, 717 insertions(+)

commit d1e719c9dd0190b5d28d3182fa9e2394a29476d7
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu May 3 15:54:55 2018 +0800

    PIP-17: provide DataBlockHeader and implementation (#1669)
    
    ### Motivation
    Provide DataBlockHeader implementation. A block header is in format:
    `[ magic_word -- int ][ block_len -- int ][ first_entry_id  -- long][alignment padding]`
    
    Master issue #1511
    
    ### Modifications
    
    Add class DataBlockHeader and test for it.
    
    ### Result
    
    unit test pass.

 .../pulsar/broker/s3offload/DataBlockHeader.java   |  57 ++++++++++
 .../broker/s3offload/impl/DataBlockHeaderImpl.java | 124 +++++++++++++++++++++
 .../pulsar/s3offload/DataBlockHeaderTest.java      |  83 ++++++++++++++
 3 files changed, 264 insertions(+)

commit 9348d34e830f558e3fc0ca096115bcc0d569ab0d
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Thu May 3 00:04:24 2018 -0700

    Fixed authentication flow via Pulsar Proxy (#1707)

 .../apache/pulsar/broker/service/ServerCnx.java    |  52 +---
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  30 ++-
 .../apache/pulsar/client/impl/ConnectionPool.java  |   7 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   6 +-
 .../org/apache/pulsar/common/api/Commands.java     |  66 ++---
 pulsar-common/src/main/proto/PulsarApi.proto       |   2 +
 .../pulsar/proxy/server/DirectProxyHandler.java    |  29 ++-
 .../pulsar/proxy/server/LookupProxyHandler.java    |  35 ++-
 .../apache/pulsar/proxy/server/ProxyClientCnx.java |  63 +++++
 .../pulsar/proxy/server/ProxyConnection.java       |  95 ++++++--
 .../apache/pulsar/proxy/server/ProxyService.java   |  57 +----
 .../proxy/server/ProxyAuthenticationTest.java      | 268 +++++++++++++++++++++
 .../proxy/server/ProxyForwardAuthDataTest.java     |   2 +-
 13 files changed, 502 insertions(+), 210 deletions(-)

commit efc893b6997f6181e9cd785c9fd023d7632736ab
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 2 16:35:54 2018 -0700

    Bumped version to 2.1.0-incubating-SNAPSHOT (#1709)

 all/pom.xml                                                   | 2 +-
 buildtools/pom.xml                                            | 2 +-
 docker/grafana/pom.xml                                        | 2 +-
 docker/pom.xml                                                | 2 +-
 docker/pulsar/pom.xml                                         | 2 +-
 managed-ledger/pom.xml                                        | 2 +-
 pom.xml                                                       | 2 +-
 pulsar-broker-auth-athenz/pom.xml                             | 2 +-
 pulsar-broker-common/pom.xml                                  | 2 +-
 pulsar-broker-shaded/pom.xml                                  | 2 +-
 pulsar-broker/pom.xml                                         | 2 +-
 pulsar-client-admin-shaded-for-functions/pom.xml              | 2 +-
 pulsar-client-admin-shaded/pom.xml                            | 2 +-
 pulsar-client-admin/pom.xml                                   | 2 +-
 pulsar-client-auth-athenz/pom.xml                             | 2 +-
 pulsar-client-kafka-compat/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-shaded/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml  | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml        | 2 +-
 pulsar-client-shaded/pom.xml                                  | 2 +-
 pulsar-client-tools-test/pom.xml                              | 2 +-
 pulsar-client-tools/pom.xml                                   | 2 +-
 pulsar-client/pom.xml                                         | 2 +-
 pulsar-common/pom.xml                                         | 2 +-
 pulsar-connect/aerospike/pom.xml                              | 2 +-
 pulsar-connect/cassandra/pom.xml                              | 2 +-
 pulsar-connect/core/pom.xml                                   | 2 +-
 pulsar-connect/kafka/pom.xml                                  | 2 +-
 pulsar-connect/pom.xml                                        | 2 +-
 pulsar-connect/rabbitmq/pom.xml                               | 2 +-
 pulsar-connect/twitter/pom.xml                                | 2 +-
 pulsar-discovery-service/pom.xml                              | 2 +-
 pulsar-functions/api-java/pom.xml                             | 2 +-
 pulsar-functions/instance/pom.xml                             | 2 +-
 pulsar-functions/java-examples/pom.xml                        | 2 +-
 pulsar-functions/metrics/pom.xml                              | 2 +-
 pulsar-functions/pom.xml                                      | 2 +-
 pulsar-functions/proto-shaded/pom.xml                         | 2 +-
 pulsar-functions/proto/pom.xml                                | 2 +-
 pulsar-functions/runtime-all/pom.xml                          | 2 +-
 pulsar-functions/runtime-shaded/pom.xml                       | 2 +-
 pulsar-functions/runtime/pom.xml                              | 2 +-
 pulsar-functions/utils/pom.xml                                | 2 +-
 pulsar-functions/worker-shaded/pom.xml                        | 2 +-
 pulsar-functions/worker/pom.xml                               | 2 +-
 pulsar-log4j2-appender/pom.xml                                | 2 +-
 pulsar-proxy/pom.xml                                          | 2 +-
 pulsar-spark/pom.xml                                          | 2 +-
 pulsar-storm/pom.xml                                          | 2 +-
 pulsar-testclient/pom.xml                                     | 2 +-
 pulsar-websocket/pom.xml                                      | 2 +-
 pulsar-zookeeper-utils/pom.xml                                | 2 +-
 pulsar-zookeeper/pom.xml                                      | 2 +-
 tests/docker-images/latest-version-image/pom.xml              | 2 +-
 tests/docker-images/pom.xml                                   | 2 +-
 tests/integration-tests-base/pom.xml                          | 2 +-
 tests/integration-tests-topologies/pom.xml                    | 2 +-
 tests/integration-tests-utils/pom.xml                         | 2 +-
 tests/integration/cli/pom.xml                                 | 2 +-
 tests/integration/compaction/pom.xml                          | 2 +-
 tests/integration/pom.xml                                     | 2 +-
 tests/integration/smoke/pom.xml                               | 2 +-
 tests/pom.xml                                                 | 2 +-
 63 files changed, 63 insertions(+), 63 deletions(-)

commit e9f8d9d7b37721a3c27ffc5264663dbccfafcd75
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed May 2 14:44:54 2018 -0700

    Fix broken image (#1720)
    
    * add missing image
    
    * update image
    
    * one more small change to image

 .../latest/getting-started/ConceptsAndArchitecture.md   |   2 +-
 site/img/failover-subscriptions.png                     | Bin 0 -> 64604 bytes
 2 files changed, 1 insertion(+), 1 deletion(-)

commit 630e1190255a14b483a651a0d248a5a0f6ac40aa
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed May 2 14:44:26 2018 -0700

    Version links in release notes (#1721)
    
    This enables people to easily link to release notes for specific versions. In the future, this page should be templated and built from source files rather than raw Markdown, but for now this provides an easy stopgap solution.

 site/release-notes.md | 52 +++++++++++++++++++++++++--------------------------
 1 file changed, 26 insertions(+), 26 deletions(-)

commit c3c8013d701d986970ec9baef142c338233f2f89
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed May 2 14:43:10 2018 -0700

    Refactor functions to use Sink interface (#1708)
    
    * use pulsar sink
    
    * removing exception from interface
    
    * addressing various comments
    
    * changing MultiConsumersOneOuputTopicProducers to use String for partition id

 .../java/org/apache/pulsar/connect/core/Sink.java  |   2 +-
 .../functions/instance/JavaInstanceRunnable.java   | 212 ++++++++++++------
 .../instance/processors/AtLeastOnceProcessor.java  |  77 -------
 .../instance/processors/AtMostOnceProcessor.java   |  79 -------
 .../processors/EffectivelyOnceProcessor.java       | 120 ----------
 .../instance/processors/MessageProcessor.java      | 107 ---------
 .../instance/processors/MessageProcessorBase.java  | 155 -------------
 .../MultiConsumersOneOuputTopicProducers.java      |  20 +-
 .../functions/instance/producers/Producers.java    |   4 +-
 .../pulsar/functions/sink/DefaultRuntimeSink.java  |   1 -
 .../apache/pulsar/functions/sink/PulsarSink.java   | 247 ++++++++++++++++++++-
 .../pulsar/functions/sink/PulsarSinkConfig.java    |  37 +++
 .../apache/pulsar/functions/sink/RuntimeSink.java  |   5 +-
 .../pulsar/functions/source/PulsarSource.java      |  30 +--
 .../{PulsarConfig.java => PulsarSourceConfig.java} |   9 +-
 .../src/main/python/python_instance_main.py        |  16 +-
 .../instance/JavaInstanceRunnableTest.java         |  81 -------
 .../MultiConsumersOneOutputTopicProducersTest.java |   2 +-
 .../functions/sink/DefaultRuntimeSinkTest.java     |   6 +-
 .../pulsar/functions/sink/PulsarSinkTest.java      | 202 +++++++++++++++++
 .../pulsar/functions/source/PulsarSourceTest.java  |  90 +++++++-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  40 ++--
 .../pulsar/functions/runtime/ProcessRuntime.java   |  35 ++-
 .../functions/runtime/ProcessRuntimeTest.java      |  20 +-
 24 files changed, 817 insertions(+), 780 deletions(-)

commit 8056df573514e2a34224ee0cfe7385a9fd179589
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed May 2 12:32:17 2018 -0700

    Fix website sidebar (#1717)
    
    * use proper YAML syntax
    
    * add swagger docs build to make build command
    
    * rename make commands

 site/Makefile           | 6 +++---
 site/_data/sidebar.yaml | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 4fff8d6827544772ed38c0c6f5dcc09a3f7268e4
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 2 10:35:44 2018 -0700

    Add release notes page in website (#1705)

 site/download.md      |   4 +-
 site/release-notes.md | 363 ++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 365 insertions(+), 2 deletions(-)

commit b982943c77972211c937270d305d14f9d12d5f84
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 2 19:10:25 2018 +0200

    Don't offload empty ledgers (#1687)
    
    It shouldn't be possible for a ledger in a managed ledger to be
    empty (it should be cleaned up on recovery), but this patch adds
    defensive code so that if they do exist for some reason, they won't be
    offloaded.
    
    Master Issue: #1511

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  3 +-
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 43 ++++++++++++++++++++++
 2 files changed, 45 insertions(+), 1 deletion(-)

commit 14049448e5d4170b7ad90fefb8568eb265f278e7
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu May 3 01:03:02 2018 +0800

    PIP-17:  the part of index block for offload. (#1593)
    
    * add offload index block
    
    * change follow ivan's comments
    
    * change to use api.LedgerMetadata
    
    * change following @sijie's comments
    
    * avoid using org.apache.bookkeeper.client.LedgerMetadata serialization
    
    * change following @ivan's comments

 .../pulsar/broker/s3offload/OffloadIndexBlock.java |  63 ++++
 .../broker/s3offload/OffloadIndexBlockBuilder.java |  72 +++++
 .../pulsar/broker/s3offload/OffloadIndexEntry.java |  50 +++
 .../impl/OffloadIndexBlockBuilderImpl.java         |  77 +++++
 .../s3offload/impl/OffloadIndexBlockImpl.java      | 337 +++++++++++++++++++++
 .../s3offload/impl/OffloadIndexEntryImpl.java      |  58 ++++
 .../apache/pulsar/s3offload/OffloadIndexTest.java  | 237 +++++++++++++++
 7 files changed, 894 insertions(+)

commit 5f678e099095b133138ea0e536e06e916d8dc09e
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed May 2 18:59:58 2018 +0200

    Rest API for Ledger Offloading (#1639)
    
    * Rest API for Ledger Offloading
    
    Implemented for both V1 and V2 topic name formats. API takes a message
    ID, up to which the broker will try to offload messages. It returns
    the message ID of the first message in the topic which has not been
    offloaded.
    
    This patch also adds basic support for setting the Offloader
    implementation in the broker (needed for testing). Subsequent patches
    will make this configurable through ServiceConfiguration.
    
    * Split compaction endpoint into two
    
    One for triggering and one for getting the current status.
    
    * Add conflict to rest api doc
    
    * Fixed build

 .../org/apache/pulsar/broker/PulsarService.java    |   6 +
 .../broker/admin/impl/PersistentTopicsBase.java    |  24 +++-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |  37 +++++-
 .../pulsar/broker/admin/v2/PersistentTopics.java   |  35 ++++-
 .../pulsar/broker/service/BrokerService.java       |   2 +
 .../broker/service/persistent/PersistentTopic.java |  57 +++++++-
 .../pulsar/broker/admin/AdminApiOffloadTest.java   | 148 +++++++++++++++++++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  14 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  10 +-
 .../client/admin/LongRunningProcessStatus.java     |  18 +--
 .../pulsar/client/admin/OffloadProcessStatus.java  |  55 ++++++++
 .../org/apache/pulsar/client/admin/Topics.java     |  19 ++-
 .../pulsar/client/admin/internal/TopicsImpl.java   |  30 ++++-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   7 +-
 .../org/apache/pulsar/admin/cli/CmdTopics.java     |   7 +-
 15 files changed, 426 insertions(+), 43 deletions(-)

commit b837af8612165bb880d7d66f8291f8163a5507a5
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 2 09:05:50 2018 -0700

    Added missing license header in terraform.tfvars (#1706)

 deployment/terraform-ansible/aws/terraform.tfvars | 19 +++++++++++++++++++
 pom.xml                                           |  4 ++++
 tests/README.md                                   | 21 +++++++++++++++++++++
 3 files changed, 44 insertions(+)

commit 48787c8d8aa4e2fb51c3736141fa08ff77532bea
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 1 23:04:43 2018 -0700

    Added documentation on how to configure load manager and bundles (#1704)

 conf/broker.conf                                   |   6 +
 site/_data/sidebar.yaml                            |   6 +-
 site/docs/latest/admin/LoadDistribution.md         | 235 +++++++++++++++++++++
 .../{admin => project}/ModularLoadManager.md       |   0
 4 files changed, 245 insertions(+), 2 deletions(-)

commit ab59a41e2b3bbe3a86a49770cf7d011ece493edd
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue May 1 22:34:45 2018 -0700

    adding mock sink for future compatibility purposes with connector framework (#1703)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  4 ++++
 .../apache/pulsar/functions/sink/PulsarSink.java   | 22 ++++++++++++++++++++++
 2 files changed, 26 insertions(+)

commit 6cdc3a9d6d84dc3950e3c4fd0a72332d4af9218a
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue May 1 17:52:42 2018 -0700

    Pulsar 2.0 docs (#1553)
    
    * add new doc and update topic.html include
    
    * Begin change property/tenant language
    
    * fix topic.html includes
    
    * change name of explanation include
    
    * Begin s/global Zk/configuration store changes
    
    * fix global ZK popovers
    
    * more overhaul for configuration store change
    
    * begin documenting schemas in java client
    
    * more info on async java
    
    * add section on schemas
    
    * fix async consumer example
    
    * add missing byte[]s
    
    * more YAML changes for configuration store
    
    * use shortened topic names in CLI docs
    
    * add images for each subscription mode
    
    * add new image for partitioning and routing
    
    * topic naming explanation
    
    * add compaction-specific commands to pulsar-admin docs
    
    * add missing pulsar-admin command
    
    * consolidate into pulsar-admin topics command
    
    * add note on persistent only to compact commands
    
    * fix topic naming shorthand table
    
    * fix issues with pulsar CLI docs
    
    * revert file name for global_zookeeper.yaml
    
    * remove unneeded 'prop' terminology
    
    * note that persistent topics are the default
    
    * remove TODO that isn't rendering properly
    
    * remove unused YAML file
    
    * add figure include
    
    * add missing license header

 site/_config.yml                                   |   7 +-
 site/_data/cli/pulsar-admin.yaml                   | 206 ++++++++++-----------
 site/_data/cli/pulsar.yaml                         |  22 +--
 ...global-zookeeper.yaml => global_zookeeper.yaml} |   0
 site/_data/messages.yaml                           |   2 -
 site/_data/popovers.yaml                           |   9 +-
 site/_data/pulsar-functions.yaml                   |  85 ---------
 site/_data/sidebar.yaml                            |   6 +-
 site/_includes/admonition.html                     |   2 +-
 site/_includes/explanations/client-url.md          |  14 --
 site/_includes/explanations/deploying-zk.md        |  12 +-
 site/_includes/explanations/install-package.md     |   2 +
 .../explanations/non-persistent-topics.md          |   2 +-
 .../explanations/partitioned-topic-admin.md        |   2 +-
 site/_includes/explanations/partitioned-topics.md  |   6 +-
 .../explanations/properties-namespaces.md          |  42 -----
 .../explanations/service-discovery-setup.md        |   6 +-
 site/_includes/explanations/tenants-namespaces.md  |  42 +++++
 site/_includes/figure.html                         |  21 +++
 site/_includes/pulsar-2.html                       |  23 +++
 site/_includes/topic.html                          |   2 +-
 site/_layouts/docs.html                            |   4 +-
 site/_sass/_docs.scss                              |  11 +-
 site/docs/latest/admin-api/partitioned-topics.md   |   2 +-
 site/docs/latest/admin-api/persistent-topics.md    |   2 +-
 site/docs/latest/admin-api/properties.md           | 105 -----------
 site/docs/latest/admin-api/tenants.md              | 104 +++++++++++
 site/docs/latest/admin/Authz.md                    |   2 +-
 site/docs/latest/admin/Proxy.md                    |   2 +-
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |   2 +-
 site/docs/latest/clients/Java.md                   | 110 +++++++----
 site/docs/latest/deployment/cluster.md             |   8 +-
 site/docs/latest/deployment/instance.md            |  42 ++---
 .../getting-started/ConceptsAndArchitecture.md     |  90 ++++-----
 site/docs/latest/getting-started/LocalCluster.md   |  21 +--
 site/docs/latest/getting-started/Pulsar-2.0.md     |  62 +++++++
 site/docs/latest/reference/Configuration.md        |   6 +-
 site/img/exclusive-subscriptions.png               | Bin 0 -> 59440 bytes
 site/img/partitioning.png                          | Bin 0 -> 125576 bytes
 site/img/pulsar-service-discovery.png              | Bin 0 -> 65898 bytes
 site/img/pulsar-subscription-modes.png             | Bin 0 -> 66178 bytes
 ...itecture.png => pulsar-system-architecture.png} | Bin
 site/img/shared-subscriptions.png                  | Bin 0 -> 68922 bytes
 43 files changed, 554 insertions(+), 532 deletions(-)

commit e4a0a5e52965fab9b54f4ab5428646b86faa4f4f
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 1 17:52:15 2018 -0700

    Allow to configure TLS hostname verification in PulsarAdmin (#1702)
    
    * Allow to configure TLS hostname verification in PulsarAdmin
    
    * Fixed test and typo

 conf/client.conf                                   |  5 +-
 .../pulsar/client/api/TlsHostVerification.java     | 64 ++++++++++++++++++++++
 .../pulsar/client/api/TlsProducerConsumerTest.java | 24 +++-----
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  8 +++
 .../pulsar/client/admin/PulsarAdminBuilder.java    | 10 ++++
 .../admin/internal/PulsarAdminBuilderImpl.java     |  6 ++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   | 15 ++++-
 .../apache/pulsar/client/cli/PulsarClientTool.java |  6 +-
 8 files changed, 118 insertions(+), 20 deletions(-)

commit 40f39333ccaf2497b4dbb3ed11665aaca7c5bf69
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue May 1 14:53:26 2018 -0700

    Add admin api to delete topic forcefully (#1656)
    
    * Add admin api to delete topic forcefully
    
    * Added option on CmdTopics as well
    
    * Fixed mocked test
    
    * Fixed other mock verification

 .../broker/admin/impl/PersistentTopicsBase.java    | 24 +++++-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |  9 ++-
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 10 ++-
 .../org/apache/pulsar/broker/service/Topic.java    |  2 +
 .../service/nonpersistent/NonPersistentTopic.java  | 90 +++++++++++++++-------
 .../broker/service/persistent/PersistentTopic.java |  3 +-
 .../broker/service/ReplicatorGlobalNSTest.java     | 33 ++++++--
 .../pulsar/client/admin/PersistentTopics.java      |  7 +-
 .../org/apache/pulsar/client/admin/Topics.java     | 57 ++++++++++++--
 .../pulsar/client/admin/internal/TopicsImpl.java   | 22 +++++-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  8 +-
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 10 ++-
 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 12 ++-
 13 files changed, 221 insertions(+), 66 deletions(-)

commit 28eb37204306b54c253fc1d5ae7898455624def4
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Tue May 1 12:20:57 2018 -0600

    Return an error if schema is incompatible (#1692)
    
    * Return an error is schema is incompatible
    
    * Handle string versions correctly
    
    * Handle string versions correctly
    
    * fix header and update status code for incompatible schemas

 .../pulsar/broker/admin/v2/SchemasResource.java    | 24 +++++++++++++-----
 .../schema/IncompatibleSchemaException.java        | 29 ++++++++++++++++++++++
 .../service/schema/SchemaRegistryServiceImpl.java  |  2 +-
 3 files changed, 48 insertions(+), 7 deletions(-)

commit 762036c36f071d0aca148bf1d333b3df0da66191
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed May 2 01:36:30 2018 +0900

    Delete inactive subscriptions automatically (#1352)
    
    * Delete inactive subscriptions automatically
    
    * Addressed PR comments
    
    * Add subscriptionExpiryCheckIntervalInMinutes
    
    * Add lastActive for ManagedCursorInfo

 conf/broker.conf                                   |   7 +
 conf/standalone.conf                               |   7 +
 .../apache/bookkeeper/mledger/ManagedCursor.java   |  13 ++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  26 +++-
 .../bookkeeper/mledger/proto/MLDataFormats.java    |  65 +++++++-
 managed-ledger/src/main/proto/MLDataFormats.proto  |   2 +
 .../mledger/impl/ManagedCursorContainerTest.java   |  10 ++
 .../apache/pulsar/broker/ServiceConfiguration.java |  21 +++
 .../broker/admin/v1/NonPersistentTopics.java       |  10 +-
 .../broker/admin/v2/NonPersistentTopics.java       |  10 +-
 .../pulsar/broker/service/BrokerService.java       | 166 +++++++++------------
 .../org/apache/pulsar/broker/service/Topic.java    |   2 +
 .../service/nonpersistent/NonPersistentTopic.java  |   5 +
 .../service/persistent/PersistentSubscription.java |   2 +
 .../broker/service/persistent/PersistentTopic.java |  13 ++
 .../broker/stats/BookieClientStatsGenerator.java   |  15 +-
 16 files changed, 252 insertions(+), 122 deletions(-)

commit c62b5c014b1f69c8c9aea78be22d3f9c95eefb99
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed May 2 00:35:57 2018 +0800

    Issue 1014: Rename "global zookeeper" to "configuration-store"(change in code, conf and cli) (#1059)
    
    * global-zookeeper => configuration-store: change in code, conf and cli
    
    * change following @sijie's comments
    
    * remove un-used imports
    
    * change following @ivan's comments
    
    * change following comments
    
    * fix rebase error
    
    * change for PR #1572 and #1223, fix integration fail
    
    * Fix cube definitions after global zookeeper is renamed to configuration-store
    
    * Hide deprecated options and few more adjustments
    
    * Fixed required status of global-zk argument in cluster init tool
    
    * Limit the memory usage for processes
    
    * Fix the aliases and limit the memory usage
    
    * remove environment settings
    
    * Fix time.sleep at watch-znode.py
    
    * revert unstarted to use started yml
    
    * Fix invalid `""`

 bin/pulsar                                         | 26 +++++++--
 bin/pulsar-admin                                   |  1 -
 bin/pulsar-daemon                                  | 21 ++++---
 conf/broker.conf                                   | 11 +++-
 conf/discovery.conf                                | 10 +++-
 conf/proxy.conf                                    | 14 +++--
 conf/standalone.conf                               | 10 +++-
 conf/websocket.conf                                | 12 +++-
 deployment/dcos/PulsarGroups.json                  |  4 +-
 deployment/kubernetes/aws/broker.yaml              |  2 +-
 deployment/kubernetes/generic/broker.yaml          |  2 +-
 deployment/kubernetes/generic/proxy.yaml           |  2 +-
 .../google-kubernetes-engine/broker.yaml           |  2 +-
 .../google-kubernetes-engine/cluster-metadata.yaml |  2 +-
 .../kubernetes/google-kubernetes-engine/proxy.yaml |  2 +-
 deployment/terraform-ansible/deploy-pulsar.yaml    |  6 +-
 deployment/terraform-ansible/templates/broker.conf |  2 +-
 .../apache/pulsar/broker/ServiceConfiguration.java | 24 ++++++++
 .../PulsarConfigurationLoaderTest.java             |  6 +-
 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 51 ++++++++++------
 .../org/apache/pulsar/PulsarStandaloneStarter.java |  2 +-
 .../org/apache/pulsar/broker/PulsarService.java    |  6 +-
 .../pulsar/broker/admin/impl/BrokersBase.java      |  8 +--
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |  8 +--
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  2 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  2 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |  6 +-
 .../broker/service/v1/V1_ReplicatorTestBase.java   |  6 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |  8 +--
 .../websocket/proxy/ProxyAuthenticationTest.java   | 11 +---
 .../websocket/proxy/ProxyAuthorizationTest.java    |  2 +-
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  2 +-
 .../proxy/ProxyPublishConsumeTlsTest.java          |  2 +-
 .../proxy/v1/V1_ProxyAuthenticationTest.java       |  6 +-
 .../configurations/pulsar_broker_test.conf         |  2 +-
 pulsar-client-cpp/test-conf/standalone-ssl.conf    |  5 +-
 pulsar-client-cpp/tests/authentication.conf        |  5 +-
 pulsar-client-cpp/tests/standalone.conf            | 31 +++++-----
 .../common/conf/InternalConfigurationData.java     | 16 +++---
 .../discovery/service/BrokerDiscoveryProvider.java |  2 +-
 .../service/server/DiscoveryServiceStarter.java    | 14 +++--
 .../discovery/service/server/ServiceConfig.java    | 19 +++++-
 .../service/server/DiscoveryServiceWebTest.java    | 67 ++++++++++++++++++++--
 .../proxy/server/BrokerDiscoveryProvider.java      |  2 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    | 16 +++++-
 .../apache/pulsar/proxy/server/ProxyService.java   |  4 +-
 .../pulsar/proxy/server/ProxyServiceStarter.java   | 13 ++++-
 .../ProxyAuthenticatedProducerConsumerTest.java    |  2 +-
 .../server/ProxyConnectionThrottlingTest.java      |  2 +-
 .../proxy/server/ProxyLookupThrottlingTest.java    |  2 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  2 +-
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |  2 +-
 .../apache/pulsar/websocket/WebSocketService.java  |  9 +--
 .../service/WebSocketProxyConfiguration.java       | 18 +++++-
 ...Starter.java => ConfigurationStoreStarter.java} |  4 +-
 site/docs/latest/deployment/cluster.md             |  4 +-
 .../latest-version-image/conf/bookie.conf          |  2 +-
 .../latest-version-image/conf/broker.conf          |  1 +
 .../latest-version-image/conf/global-zk.conf       |  3 +-
 .../latest-version-image/conf/local-zk.conf        |  1 +
 .../latest-version-image/conf/proxy.conf           |  2 +
 .../latest-version-image/scripts/init-cluster.sh   |  2 +-
 tests/integration-tests-base/pom.xml               |  1 -
 ...single-cluster-3-bookie-2-broker-unstarted.yaml | 16 +++---
 .../single-cluster-3-bookie-2-broker.yaml          | 16 +++---
 .../java/org/apache/pulsar/tests/DockerUtils.java  |  1 +
 .../apache/pulsar/tests/PulsarClusterUtils.java    |  4 ++
 .../pulsar/tests/integration/TestCompaction.java   | 16 +++---
 .../smoke/src/test/resources/arquillian.xml        |  1 +
 69 files changed, 400 insertions(+), 188 deletions(-)

commit 1c4b1c4b9927ccb3d3f45feff97c5c058f46fe1c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue May 1 09:35:12 2018 -0700

    adding function worker initialized check (#1697)
    
    * adding function worker intialized check
    
    * removing newline
    
    * refactoring duplicate code
    
    * fixing unit tests

 .../pulsar/client/admin/internal/BaseResource.java |  2 +-
 .../client/admin/internal/FunctionsImpl.java       |  2 -
 .../pulsar/functions/worker/WorkerService.java     |  4 ++
 .../functions/worker/rest/api/FunctionsImpl.java   | 63 ++++++++++++++++++++++
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  1 +
 5 files changed, 69 insertions(+), 3 deletions(-)

commit 2dd158e9514b89ec545169f4fd8fa863f9c099de
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue May 1 09:34:53 2018 -0700

    Fix Trigger functionality for non Java Functions (#1701)

 .../apache/pulsar/functions/worker/rest/api/FunctionsImpl.java    | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 5721892df57eae3a2ddd6a3f336c1dfc50de9e4b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Apr 30 23:51:43 2018 -0700

    adding sink spec (#1700)
    
    * adding sink spec
    
    * addressing comments
    
    * fixing proto numbering

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  17 ++--
 .../pulsar/functions/instance/ContextImpl.java     |   4 +-
 .../functions/instance/JavaInstanceRunnable.java   |  10 +-
 .../instance/processors/AtLeastOnceProcessor.java  |   2 +-
 .../instance/processors/AtMostOnceProcessor.java   |   2 +-
 .../instance/processors/MessageProcessorBase.java  |   4 +-
 .../instance/src/main/python/Function_pb2.py       | 106 ++++++++++-----------
 .../instance/src/main/python/python_instance.py    |  14 +--
 .../src/main/python/python_instance_main.py        |   7 +-
 .../instance/JavaInstanceRunnableTest.java         |   3 +-
 .../functions/instance/JavaInstanceTest.java       |   3 +-
 .../proto/src/main/proto/Function.proto            |  27 ++++--
 .../pulsar/functions/runtime/JavaInstanceMain.java |   8 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |  12 +--
 .../functions/runtime/ProcessRuntimeTest.java      |  14 +--
 .../functions/worker/rest/api/FunctionsImpl.java   |   2 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  31 ++++--
 17 files changed, 151 insertions(+), 115 deletions(-)

commit fd576aea6ec221e9a729b05a19550a33d1864d03
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Apr 30 22:23:10 2018 -0700

    Use Function class loader to resolve function types (#1699)

 .../src/main/java/org/apache/pulsar/functions/source/PulsarSource.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 600b55d2aff1aed6427348fe50cb1d4a3bc5a809
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Apr 30 18:57:16 2018 -0700

    Check if javaInstance is created in the first place before invocing close (#1688)

 .../org/apache/pulsar/functions/instance/JavaInstanceRunnable.java    | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit fb7198a669e0647cf3213739b7b6ffb8c650d978
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Apr 30 18:56:25 2018 -0700

    Allow functions to be triggered without specifying topic name (#1696)
    
    * Re-added trigger functionality with no need for topic name
    
    * Unified paths
    
    * Fix

 .../pulsar/broker/admin/impl/FunctionsBase.java     |  6 +++---
 .../org/apache/pulsar/client/admin/Functions.java   |  2 +-
 .../pulsar/client/admin/internal/FunctionsImpl.java |  8 +++++---
 .../org/apache/pulsar/admin/cli/CmdFunctions.java   |  4 +++-
 .../functions/worker/rest/api/FunctionsImpl.java    | 21 ++++++++++++---------
 .../worker/rest/api/v2/FunctionApiV2Resource.java   |  6 +++---
 6 files changed, 27 insertions(+), 20 deletions(-)

commit cbdce09db4696b77201368e35e26bb8b5b24dd1e
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 30 17:28:03 2018 -0700

    Make SchemaSerializationException an unchecked exception (#1693)

 .../org/apache/kafka/clients/producer/PulsarKafkaProducer.java    | 8 +++-----
 .../main/java/org/apache/pulsar/client/api/MessageBuilder.java    | 2 +-
 .../src/main/java/org/apache/pulsar/client/api/Schema.java        | 2 +-
 .../apache/pulsar/client/api/SchemaSerializationException.java    | 2 +-
 .../java/org/apache/pulsar/client/api/TypedMessageBuilder.java    | 2 +-
 .../java/org/apache/pulsar/client/impl/MessageBuilderImpl.java    | 7 +++----
 .../org/apache/pulsar/client/impl/TypedMessageBuilderImpl.java    | 4 +---
 7 files changed, 11 insertions(+), 16 deletions(-)

commit f5d95028dc3953c1ed89fb0a114b18528da76715
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 30 17:04:10 2018 -0700

    Fix Golang setup in Dockerfile (#1690)
    
    * When preparing pulsar-build Docker image, ensure apt-get update is not cached
    
    * add Go setup to Dockerfile for website build
    
    * update PATH
    
    * set proper env vars
    
    * re-add golang install to main apt-get statement

 build/docker/Dockerfile | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 1e0e12a72fb978abc04797b049dada100d8d0832
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 30 17:03:54 2018 -0700

    Remove "global" from returned clusters list (#1695)

 .../main/java/org/apache/pulsar/broker/admin/AdminResource.java    | 7 ++++++-
 .../test/java/org/apache/pulsar/broker/admin/AdminApiTest2.java    | 6 ++++++
 2 files changed, 12 insertions(+), 1 deletion(-)

commit 3c99306f2e3e95e9070ea47911fbd6855d860261
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Apr 30 16:07:09 2018 -0700

    Key the download directory by the instance id (#1691)

 .../java/org/apache/pulsar/functions/worker/FunctionActioner.java  | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit 1eff40ebf280cc9205f2370fde8a2fd8a74dcaf3
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 30 15:59:29 2018 -0700

    Renamed Schema.IDENTITY into Schema.BYTES (#1694)

 .../apache/pulsar/client/impl/RawReaderImpl.java   |  2 +-
 .../pulsar/client/admin/internal/TopicsImpl.java   |  4 +--
 .../apache/pulsar/client/api/MessageBuilder.java   |  2 +-
 .../java/org/apache/pulsar/client/api/Schema.java  | 23 ++++---------
 .../org/apache/pulsar/client/impl/MessageImpl.java |  2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 14 ++++----
 .../pulsar/client/impl/schema/BytesSchema.java     | 39 ++++++++++++++++++++++
 .../{api/schemas => impl/schema}/StringSchema.java |  2 +-
 .../pulsar/client/schemas/DefaultSchemasTest.java  |  2 +-
 9 files changed, 59 insertions(+), 31 deletions(-)

commit e9a1b9a58b28687558b29705ea66047ef82fd05c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Apr 30 15:21:50 2018 -0700

    additional refactoring to use source interface (#1681)
    
    * additional refactoring to use source interface
    
    * removing PulsarConstants
    
    * remove unnecessary import
    
    * removing sink message for now
    
    * addressing comments
    
    * adding null check

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   3 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 148 +++++-----
 .../org/apache/pulsar/functions/api/Context.java   |   3 +-
 .../pulsar/functions/instance/ContextImpl.java     |   2 +-
 .../pulsar/functions/instance/JavaInstance.java    |   3 +-
 .../functions/instance/JavaInstanceRunnable.java   |  29 +-
 .../instance/processors/AtLeastOnceProcessor.java  |   5 +-
 .../instance/processors/AtMostOnceProcessor.java   |   5 +-
 .../processors/EffectivelyOnceProcessor.java       |  12 +-
 .../instance/processors/MessageProcessor.java      |  28 +-
 .../instance/processors/MessageProcessorBase.java  |  50 ++--
 .../{instance => source}/PulsarConfig.java         |  26 +-
 .../{instance => source}/PulsarRecord.java         |   2 +-
 .../{instance => source}/PulsarSource.java         |  63 ++++-
 .../instance/src/main/python/Function_pb2.py       | 305 ++++++++++-----------
 .../instance/src/main/python/python_instance.py    |  26 +-
 .../src/main/python/python_instance_main.py        |  35 ++-
 .../instance/JavaInstanceRunnableTest.java         |  45 ---
 .../functions/instance/JavaInstanceTest.java       |   4 +-
 .../pulsar/functions/source/PulsarSourceTest.java  | 136 +++++++++
 .../proto/src/main/proto/Function.proto            |  52 ++--
 .../functions/proto/FunctionDetailsTest.java       |   2 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  56 ++--
 .../pulsar/functions/runtime/ProcessRuntime.java   |  55 +---
 .../functions/runtime/ProcessRuntimeTest.java      |  31 ++-
 .../pulsar/functions/utils/FunctionConfig.java     |  12 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |  25 +-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |   3 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 278 ++++++++-----------
 29 files changed, 731 insertions(+), 713 deletions(-)

commit 240f5332d573356ce3e139a38c50845956b59dbf
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 30 14:56:24 2018 -0700

    Pulsar Functions for Python docs (#1482)
    
    * Add initial sections to Python API docs
    
    * add reference to specific python version
    
    * add missing java examples and complete java user config section
    
    * fix incorrect example command
    
    * add new sections to python API doc
    
    * add context object section
    
    * add python SerDe section
    
    * add section on logging
    
    * approaching draft of python docs
    
    * add some python examples to overview page
    
    * fix error in package name
    
    * fix dangling sentence

 site/_config.yml                         |   1 +
 site/docs/latest/functions/api.md        | 246 +++++++++++++++++++++++++++++--
 site/docs/latest/functions/guarantees.md |  10 +-
 site/docs/latest/functions/overview.md   |  33 ++++-
 4 files changed, 272 insertions(+), 18 deletions(-)

commit f0d090771ef368213f2dc84cc7c3d7a977ed8c4d
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 30 14:53:44 2018 -0700

    When preparing pulsar-build Docker image, ensure apt-get update is not cached (#1689)

 build/docker/Dockerfile | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 0f2f478c1ffc4028d7fd271a1bc523b3342a07af
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 30 14:03:06 2018 -0700

    Introduced TypedMessageBuilder (#1683)
    
    * Introduced TypedMessageBuilder
    
    * Converted parts of the tests to use TypedMessageBuilder
    
    * Fixed tests

 .../pulsar/broker/service/BatchMessageTest.java    |  45 ++----
 .../pulsar/broker/service/PartitionKeyTest.java    |   9 +-
 .../broker/service/PersistentTopicE2ETest.java     |   5 +-
 .../pulsar/client/api/ClientDeduplicationTest.java |  14 +-
 .../api/PartitionedProducerConsumerTest.java       |   9 +-
 .../client/api/SimpleProducerConsumerTest.java     |  16 +--
 .../apache/pulsar/client/impl/RawReaderTest.java   |  36 ++---
 .../apache/pulsar/compaction/CompactionTest.java   | 100 +++++--------
 .../clients/producer/PulsarKafkaProducer.java      |  37 ++---
 .../kafka/compat/tests/KafkaConsumerTest.java      |  26 +---
 .../org/apache/pulsar/client/cli/CmdProduce.java   |  47 ++-----
 .../apache/pulsar/client/api/MessageBuilder.java   |  11 +-
 .../org/apache/pulsar/client/api/Producer.java     |  42 +++++-
 .../pulsar/client/api/TypedMessageBuilder.java     | 155 +++++++++++++++++++++
 .../client/impl/PartitionedProducerImpl.java       |  19 ++-
 .../apache/pulsar/client/impl/ProducerBase.java    |  51 +++++--
 .../apache/pulsar/client/impl/ProducerImpl.java    |  28 +---
 .../client/impl/TypedMessageBuilderImpl.java       | 136 ++++++++++++++++++
 .../apache/pulsar/websocket/ProducerHandler.java   |  22 +--
 19 files changed, 524 insertions(+), 284 deletions(-)

commit 3a6e0e205de7272585e9978e619dc80638da5cfc
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 30 14:02:16 2018 -0700

    Fixed NPE and added test for Schema.STRING (#1685)
    
    * Fixed NPE and added test for Schema.STRING
    
    * Added license exclusion for generated file SchemaRegistryFormat.java

 pom.xml                                            |   2 +
 .../apache/pulsar/broker/service/ServerCnx.java    |  18 +-
 .../service/schema/SchemaRegistryServiceImpl.java  |  28 ++--
 .../service/schema/proto/SchemaRegistryFormat.java | 186 +++++++++------------
 .../src/main/proto/SchemaRegistryFormat.proto      |   6 +-
 .../broker/service/schema/SchemaServiceTest.java   |   8 +-
 .../apache/pulsar/client/api/SimpleSchemaTest.java |  63 +++++++
 .../java/org/apache/pulsar/client/api/Schema.java  |  30 ++++
 .../pulsar/client/api/schemas/StringSchema.java    |   3 +-
 .../pulsar/client/impl/ConnectionHandler.java      |   1 +
 .../org/apache/pulsar/common/api/Commands.java     |  12 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  29 ++--
 .../apache/pulsar/common/schema/SchemaInfo.java    |   4 +-
 .../apache/pulsar/common/schema/SchemaType.java    |  18 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   9 +-
 15 files changed, 247 insertions(+), 170 deletions(-)

commit d5780ef1deeed6d24748f263a958e3212a603f89
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 30 14:00:24 2018 -0700

    Add tenant and namespace getters to Python context (#1677)
    
    * add tenant and namespace getters on Python context
    
    * switch to getInputTopicName
    
    * re-name current message methods

 pulsar-client-cpp/python/functions/context.py           | 17 +++++++++++++----
 .../java/org/apache/pulsar/functions/api/Context.java   |  6 +++---
 .../apache/pulsar/functions/instance/ContextImpl.java   |  2 +-
 .../instance/src/main/python/contextimpl.py             | 12 +++++++++---
 4 files changed, 26 insertions(+), 11 deletions(-)

commit 4def3738a0fe43b93c283e3361010ce367b3f795
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 30 13:52:24 2018 -0700

    Update REST API docs (#1684)
    
    * add swagger gen script
    
    * chmod
    
    * new swagger definition
    
    * update site build script
    
    * remove generated JSON from git

 site/Makefile                          |    7 +-
 site/_data/admin-rest-api-swagger.json | 8287 --------------------------------
 site/scripts/swagger-definition-gen.sh |   27 +
 3 files changed, 33 insertions(+), 8288 deletions(-)

commit 31131c23644a3e9c9e951a6fb64741c290c84bb1
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 30 13:47:28 2018 -0700

    Protobuf documentation update (#1686)
    
    * use go get for protoc-gen-doc
    
    * modify Dockerfile for website build

 build/docker/Dockerfile          | 9 +++------
 site/.gitignore                  | 1 -
 site/Makefile                    | 6 +-----
 site/scripts/protobuf-doc-gen.sh | 2 +-
 4 files changed, 5 insertions(+), 13 deletions(-)

commit 1cac0bae469bcb2cadc4ef6cad61d3dbf9b83ca8
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 30 08:36:15 2018 -0700

    Add missing Swagger annotations for Pulsar Functions REST API endpoints (#1661)
    
    * begin adding swagger annotations to pulsar functions endpoints
    
    * annotations for more endpoints
    
    * fix usages of 'exist' and property (vs tenant)
    
    * fix syntax of @ApiResponses annotations
    
    * add missing annotations

 .../pulsar/broker/admin/impl/ClustersBase.java     |    6 +-
 .../pulsar/broker/admin/impl/FunctionsBase.java    |  105 +-
 .../broker/admin/impl/PersistentTopicsBase.java    |    4 +-
 .../pulsar/broker/admin/impl/TenantsBase.java      |   62 +-
 .../broker/admin/v2/NonPersistentTopics.java       |    4 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |   52 +-
 site/_data/admin-rest-api-swagger.json             | 4175 ++++++++++++++------
 7 files changed, 3240 insertions(+), 1168 deletions(-)

commit 42c2f3712f24473845edc059242c629533c1596c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Apr 30 08:29:32 2018 -0700

    Fix DefaultSchemasTest (#1682)
    
    *Motivation*
    
     #1585 introduced default schemas test. it wasn't rebased to latest master. so the PR was merged without problem but fail the build
    
    *Solution*
    
    Fix the test

 .../test/java/org/apache/pulsar/client/schemas/DefaultSchemasTest.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9044c2fd46e7c6e284887b3da5b5cf8711759502
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sun Apr 29 22:23:58 2018 -0700

    Default schemas (#1585)

 .../pulsar/client/api/schemas/StringSchema.java    |  54 +++++++++++
 .../pulsar/client/schemas/DefaultSchemasTest.java  | 101 +++++++++++++++++++++
 2 files changed, 155 insertions(+)

commit 75ac2be1961f19e8d3039767d116c8b0601516eb
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 28 19:03:40 2018 -0700

    Support read-compacted on Reader (#1672)

 .../apache/pulsar/compaction/CompactionTest.java   | 205 +++++++++++++--------
 .../apache/pulsar/client/api/ReaderBuilder.java    |  14 ++
 .../pulsar/client/impl/ReaderBuilderImpl.java      |   6 +
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   1 +
 .../client/impl/conf/ReaderConfigurationData.java  |   2 +
 5 files changed, 155 insertions(+), 73 deletions(-)

commit 21abb34ed93b192fcc5a058488856720437964cb
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 28 19:02:28 2018 -0700

    Provide meaningful error message in "pulsar-admin topics lookup" (#1679)

 .../org/apache/pulsar/broker/web/PulsarWebResource.java     |  4 ++--
 .../org/apache/pulsar/client/admin/internal/LookupImpl.java | 13 ++-----------
 2 files changed, 4 insertions(+), 13 deletions(-)

commit 66fa03f7eab93d660d4bd09a064e218677592abe
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 28 19:01:41 2018 -0700

    Updated Python examples to work with py-2 and py-3 (#1680)

 pulsar-client-cpp/python/examples/rpc_client.py | 11 ++++++-----
 pulsar-client-cpp/python/examples/rpc_server.py |  8 ++++----
 pulsar-client-cpp/python/pulsar.py              | 19 ++++++++-----------
 pulsar-client-cpp/python/test_consumer.py       |  4 ++--
 pulsar-client-cpp/python/test_producer.py       |  4 ++--
 site/docs/latest/clients/Python.md              | 21 ++++++++-------------
 site/docs/latest/getting-started/docker.md      | 10 +++++-----
 7 files changed, 35 insertions(+), 42 deletions(-)

commit 8eb2d21184582035acff47009f544a80d2d3f052
Author: cckellogg <cckellogg@gmail.com>
Date:   Fri Apr 27 18:52:22 2018 -0700

    Optionally expose publisher stats in broker-stats admin rest api. (#1648)
    
    * Optionally expose publisher stats in broker-stats admin rest api.
    
    * Remove comments and add helper to non-persistent topics.
    
    * Update admin client endpoint.
    
    * Add newline to standalone conf.
    
    * Add license.

 conf/broker.conf                                   |  5 ++
 conf/standalone.conf                               |  5 ++
 .../apache/pulsar/broker/ServiceConfiguration.java | 15 ++++
 .../apache/pulsar/broker/admin/v2/BrokerStats.java | 17 +++++
 .../apache/pulsar/broker/service/PulsarStats.java  |  7 +-
 .../pulsar/broker/service/StreamingStats.java      | 85 ++++++++++++++++++++++
 .../org/apache/pulsar/broker/service/Topic.java    |  4 +-
 .../service/nonpersistent/NonPersistentTopic.java  | 39 ++++------
 .../broker/service/persistent/PersistentTopic.java | 33 +++------
 .../client/admin/internal/BrokerStatsImpl.java     |  2 +-
 10 files changed, 158 insertions(+), 54 deletions(-)

commit 070a9f69aaea566de634d4fe935a3df1be66f62d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 27 16:22:31 2018 -0700

    Clean the local cache of downloaded packages if it already exists (#1674)

 .../pulsar/functions/worker/FunctionActioner.java  | 47 ++++++++++++----------
 1 file changed, 25 insertions(+), 22 deletions(-)

commit f46d8eba1701d07e39704f72b01616c206b94966
Author: Ali Ahmed <alahmed.se@gmail.com>
Date:   Fri Apr 27 16:22:03 2018 -0700

    Switch to using ConcurrentHashMap (#1675)

 .../functions/utils/functioncache/FunctionCacheManagerImpl.java  | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

commit 03ab0d78706c4b310b7b4fdfd632346463c0e928
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Apr 28 01:21:00 2018 +0200

    BookKeeper ledgers cleaned up after offload (#1668)
    
    This patch adds a new configuration for managed ledger, offload ledger
    deletion lag, which is the amount of time to wait after a ledger has
    been offloaded to long term storage before the ledger will be deleted
    from bookkeeper. Defaults to 4 hours.
    
    Master Issue: #1511

 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  23 +++
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  89 ++++++++---
 .../bookkeeper/mledger/proto/MLDataFormats.java    | 162 ++++++++++++++++++---
 .../apache/bookkeeper/mledger/util/Futures.java    |   2 +
 managed-ledger/src/main/proto/MLDataFormats.proto  |   2 +
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |   3 +-
 .../mledger/impl/OffloadLedgerDeleteTest.java      | 148 +++++++++++++++++++
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java |   2 +-
 .../apache/bookkeeper/mledger/util/MockClock.java  |  50 +++++++
 9 files changed, 433 insertions(+), 48 deletions(-)

commit 8dbee119232d58cf5fb617f5dfeaea5fcf44aa09
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 27 16:20:25 2018 -0700

    Fix var names of context that were changed (#1676)

 pulsar-functions/instance/src/main/python/contextimpl.py | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit 330a7e879e7123fe25b13be4d5db3f0b5abea7fb
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 27 13:44:45 2018 -0700

    Cleanup ThreadRuntime Exception Management (#1673)
    
    * Cleanup ThreadRuntime Exception Management
    
    * More fixes
    
    * Make JavaInstance keep track and restarting its thread

 .../functions/instance/JavaInstanceRunnable.java      | 19 +++++--------------
 .../pulsar/functions/runtime/JavaInstanceMain.java    |  2 +-
 .../pulsar/functions/runtime/ProcessRuntime.java      | 14 ++------------
 .../pulsar/functions/runtime/RuntimeSpawner.java      |  2 ++
 .../pulsar/functions/runtime/ThreadRuntime.java       | 15 ++-------------
 5 files changed, 12 insertions(+), 40 deletions(-)

commit fa3be03e578a761e5c0bbf523d1f2e4dd39ada11
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Fri Apr 27 12:50:56 2018 -0600

    Return 404 if no schema found (#1659)

 .../pulsar/broker/admin/v2/SchemasResource.java    | 32 +++++++++++++---------
 1 file changed, 19 insertions(+), 13 deletions(-)

commit db89cd460c25492bb6812f31a6e28265c33b192d
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Fri Apr 27 12:45:30 2018 -0600

    Json schema codec (#1551)
    
    * Add JSON schema support
    
    * Use different json schema library
    
    * Add license headers to new files
    
    * Revert "Use different json schema library"
    
    This reverts commit 405b918ed9ccebe947916b7c87192b0cef3e910a.
    
    * Changes related to review input
    
    * Upgrade jackson schema module
    
    * Check schema compatibility on subscribe and publish
    
    * Add missing license headers:
    
    * Ensure schema is stored
    
    * Add negative tests on publish/consume with wrong schema
    
    * Add missing license header
    
    * Release ALL protobuf references
    
    * Remove SecureRandom, it's unneeded and appears to timeout
    
    * GRRRRR license headers

 pom.xml                                            |   6 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  11 +
 .../apache/pulsar/broker/service/ServerCnx.java    |  32 ++-
 .../org/apache/pulsar/broker/service/Topic.java    |   2 +
 .../service/nonpersistent/NonPersistentTopic.java  |   9 +
 .../broker/service/persistent/PersistentTopic.java |   9 +
 .../schema/DefaultSchemaRegistryService.java       |   5 +
 .../schema/JsonSchemaCompatibilityCheck.java       |  46 ++++
 .../service/schema/SchemaCompatibilityCheck.java   |  39 ++++
 .../broker/service/schema/SchemaRegistry.java      |   2 +
 .../service/schema/SchemaRegistryService.java      |  22 +-
 .../service/schema/SchemaRegistryServiceImpl.java  |  52 +++--
 .../broker/service/schema/SchemaServiceTest.java   |   3 +-
 .../pulsar/client/api/ProducerConsumerBase.java    |   4 +-
 .../api/SimpleTypedProducerConsumerTest.java       | 239 +++++++++++++++++++++
 pulsar-client/pom.xml                              |   5 +
 .../apache/pulsar/client/api/MessageBuilder.java   |   2 +-
 .../java/org/apache/pulsar/client/api/Schema.java  |   2 +-
 .../client/api/SchemaSerializationException.java   |  25 +++
 .../pulsar/client/impl/MessageBuilderImpl.java     |   3 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |   1 +
 .../apache/pulsar/client/impl/ProducerBase.java    |   8 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |   3 +-
 .../pulsar/client/impl/TopicMessageImpl.java       |   1 +
 .../pulsar/client/impl/schema/JSONSchema.java      |  84 ++++++++
 .../apache/pulsar/client/tutorial/JsonPojo.java    |  38 ++++
 .../tutorial/SampleAsyncProducerWithSchema.java    |  69 ++++++
 .../client/tutorial/SampleConsumerWithSchema.java  |  49 +++++
 .../org/apache/pulsar/common/api/Commands.java     |  17 +-
 29 files changed, 755 insertions(+), 33 deletions(-)

commit 18dc1c87f3217766453600ba849e82625ee73086
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Apr 27 11:29:37 2018 -0700

    Fix: deadlock while closing non-persistent topic (#1660)

 .../pulsar/broker/service/nonpersistent/NonPersistentTopic.java   | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit f307080e9558bf34edfffbecf9bdcdbe08fa7427
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 27 11:17:50 2018 -0700

    Better Runtime failure mgmt (#1671)
    
    * Retooled management of Runtime failures
    
    * Removed extra code

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  2 +-
 .../functions/instance/JavaInstanceRunnable.java   |  7 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  2 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   | 74 ++++++++++------------
 .../pulsar/functions/runtime/RuntimeSpawner.java   | 12 ++--
 .../pulsar/functions/runtime/ThreadRuntime.java    | 21 ++----
 6 files changed, 50 insertions(+), 68 deletions(-)

commit 66c8428c0c52810a1c834a55a8412e314fcbf387
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 27 19:28:02 2018 +0200

    Read OffloadedLedger if available (#1640)
    
    * Read OffloadedLedger if available
    
    If a ledger has been previously offloaded to long term storage, read
    the ledger from long term storage, rather than from bookkeeper.
    
    Master issue #1511
    
    * Fix NPE

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  41 +--
 .../mledger/impl/OffloadPrefixReadTest.java        | 289 +++++++++++++++++++++
 2 files changed, 314 insertions(+), 16 deletions(-)

commit 002f34d171f4344d5ca08801b904d89b5e80f6ce
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Apr 27 09:24:51 2018 -0700

    update preview version (#1658)

 site/_config.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bceca1dfd0c697c56dd07d3d983a28091e62f239
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 27 08:37:32 2018 -0700

    Fix python functions (#1663)
    
    * Fix Python Functions
    
    * Added licence header
    
    * Fixed unittest

 .../instance/src/main/python/Function_pb2.py       | 146 +++++++++++++++++----
 .../src/main/python/python_instance_main.py        |   2 +-
 .../proto/src/main/proto/Function.proto            |   1 +
 .../pulsar/functions/runtime/ProcessRuntime.java   |  14 +-
 .../functions/runtime/ProcessRuntimeTest.java      |   5 +-
 5 files changed, 135 insertions(+), 33 deletions(-)

commit d92f352d237cae7a1ebcea57cca75f690eaaaae0
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 27 07:27:25 2018 -0700

    Use standard format when generating SHA signatures for release (#1667)

 src/sign-release.sh | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 4202d9fe3f1bba0e8b67baa131ec545f98d694ca
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 27 07:26:59 2018 -0700

    Updated Copyright in NOTICE to 2017-2018 (#1664)

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1fc7ac4536324a16c105198080aabf9411b49083
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 27 00:16:06 2018 -0700

    Include generate_protobuf.sh in src archive (#1666)

 all/src/assemble/src.xml | 1 +
 1 file changed, 1 insertion(+)

commit 17f02465b6ab4689cbc10c586ad856e920335ace
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 27 00:15:45 2018 -0700

    Removed .gitignore.swp from git (#1665)

 .gitignore.swp | Bin 12288 -> 0 bytes
 1 file changed, 0 insertions(+), 0 deletions(-)

commit 8335d7cb0c85ebcd054b80f5da91cbc419d25121
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Apr 26 21:59:27 2018 -0700

    Fix: NPE when cursor failed to close empty subscription (#1662)

 .../pulsar/broker/service/persistent/PersistentSubscription.java      | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 02eff26259b43d3fac646d80f8256f9308baba1d
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 26 18:31:34 2018 -0700

    In pulsar admin Java API, unified persistent vs non-persistent into "topics()" (#1634)
    
    * In pulsar admin Java API, unified persistent vs non-persistent into "topics()"
    
    * Fixed tests
    
    * Merged and fixed tests
    
    * Couple more tests fixes
    
    * Consolidated pulsar-admin persistent|non-persistent into 'topics' command

 .../broker/admin/impl/PersistentTopicsBase.java    |  27 +-
 .../broker/admin/v1/NonPersistentTopics.java       |   9 +-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |   4 +-
 .../broker/admin/v2/NonPersistentTopics.java       |  12 +-
 .../pulsar/broker/admin/v2/PersistentTopics.java   |   4 +-
 .../pulsar/broker/service/BrokerService.java       |   6 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   4 +-
 .../broker/service/persistent/PersistentTopic.java |  68 +-
 .../broker/stats/metrics/AbstractMetrics.java      |   6 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 302 +++----
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  76 +-
 .../broker/admin/CreateSubscriptionTest.java       |  33 +-
 .../broker/admin/IncrementPartitionsTest.java      |  18 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |   2 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    | 292 +++----
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |  46 +-
 .../pulsar/broker/auth/AuthorizationTest.java      |  10 +-
 .../broker/service/BacklogQuotaManagerTest.java    |  14 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |   8 +-
 .../pulsar/broker/service/PeerReplicatorTest.java  |  10 +-
 .../broker/service/PersistentFailoverE2ETest.java  |   8 +-
 .../broker/service/PersistentQueueE2ETest.java     |  14 +-
 .../broker/service/PersistentTopicE2ETest.java     |  20 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   6 +-
 .../pulsar/broker/service/ResendRequestTest.java   |   6 +-
 .../broker/service/SubscriptionSeekTest.java       |   2 +-
 .../broker/service/TopicTerminationTest.java       |  26 +-
 .../broker/service/v1/V1_ReplicatorTest.java       |   2 +
 .../api/AuthenticatedProducerConsumerTest.java     |   4 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |   6 +-
 .../client/api/DispatcherBlockConsumerTest.java    |   4 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |  13 +-
 .../api/PartitionedProducerConsumerTest.java       |  40 +-
 .../client/api/SimpleProducerConsumerStatTest.java |   2 +-
 .../client/api/SimpleProducerConsumerTest.java     |   2 +-
 .../apache/pulsar/client/api/TopicReaderTest.java  |   8 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     |   2 +-
 .../client/impl/BrokerClientIntegrationTest.java   |   4 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |   4 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  22 +-
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   2 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  28 +-
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |   4 +-
 .../pulsar/client/impl/ZeroQueueSizeTest.java      |   2 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |   2 +-
 .../websocket/proxy/ProxyPublishConsumeTest.java   |   4 +-
 .../pulsar/client/admin/NonPersistentTopics.java   |   4 +
 .../pulsar/client/admin/PersistentTopics.java      | 903 +-------------------
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  16 +-
 .../org/apache/pulsar/client/admin/Topics.java     | 940 +++++++++++++++++++++
 .../admin/internal/NonPersistentTopicsImpl.java    |  12 +-
 .../{PersistentTopicsImpl.java => TopicsImpl.java} | 114 ++-
 .../kafka/compat/tests/KafkaConsumerTest.java      |   2 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  90 +-
 .../pulsar/client/cli/PulsarClientToolTest.java    |   2 +-
 .../java/org/apache/pulsar/admin/cli/CmdBase.java  |   9 +-
 .../pulsar/admin/cli/CmdNonPersistentTopics.java   |   7 +-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   3 +-
 .../org/apache/pulsar/admin/cli/CmdTopics.java     | 643 ++++++++++++++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   5 +
 .../org/apache/pulsar/common/naming/TopicName.java |   8 +-
 .../policies/data/NonPersistentTopicStats.java     |   2 +-
 .../policies/data/PartitionedTopicStats.java       |   4 +-
 .../common/policies/data/PersistentTopicStats.java | 100 +--
 .../pulsar/common/policies/data/TopicStats.java    | 122 +++
 .../policies/data/PersistentTopicStatsTest.java    |  64 +-
 .../pulsar/functions/worker/MembershipManager.java |   9 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |   2 +-
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |   2 +-
 .../org/apache/pulsar/storm/PulsarBoltTest.java    |   8 +-
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |  14 +-
 71 files changed, 2575 insertions(+), 1698 deletions(-)

commit 74846643303385cce847120b86c8342e50950492
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Apr 26 16:45:36 2018 -0700

    Pulsar Functions CLI fixes (#1655)
    
    * add new argument checker function
    
    * fix misspelling in variable name
    
    * add check for class name to doJavaSubmitChecks
    
    * add default service URL as constant
    
    * fix input topic checking logic
    
    * remove 'got exception' line from Exception printing
    
    * add check for Python class name
    
    * add basic topic name validation
    
    * fix misspelling in getClassname call
    
    * use formatted string for inferred output topic name
    
    * ensure topics aren't used as both input and output

 .../java/org/apache/pulsar/admin/cli/CmdBase.java  |  1 -
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 92 ++++++++++++++++------
 2 files changed, 69 insertions(+), 24 deletions(-)

commit dab66951f36f1106b3dbfb4cb648fd2b09c5ff00
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 26 16:45:14 2018 -0700

    Enable dispatch-throttling for non backlog consumers by default. (#1654)

 conf/broker.conf     | 6 +++---
 conf/standalone.conf | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

commit 61cb7caa920f468b6fb53176e2994cefb8cbcae3
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Apr 26 23:49:33 2018 +0200

    Use java.time.Clock in managed ledger (#1642)
    
    Rather than direct calls to currentTimeMillis. This allows us to test
    time based functionallity with a mocked clock, and avoid Thread.sleep.

 .../bookkeeper/mledger/ManagedLedgerConfig.java    | 21 +++++++++++++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  7 ++++--
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 27 ++++++++++++----------
 3 files changed, 41 insertions(+), 14 deletions(-)

commit c4ae6c53ec7dfea1cd6cdbc891188473e4f196e4
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Apr 26 13:42:45 2018 -0700

    Using Pulsar as a message queue (cookbook) (#1507)
    
    * change directory structure to include cookbooks
    
    * add new message queue cookbook
    
    * Finish first draft of doc
    
    * add tags to new doc
    
    * add missing subscription name to java example
    
    * Add C++ example
    
    * Add subscription name setting to Java example
    
    * change section on receiver queue

 site/_data/sidebar.yaml                         |   2 +
 site/docs/latest/cookbooks/Encryption.md        |   1 +
 site/docs/latest/cookbooks/PartitionedTopics.md |   1 +
 site/docs/latest/cookbooks/RetentionExpiry.md   |   2 +-
 site/docs/latest/cookbooks/message-queue.md     | 113 ++++++++++++++++++++++++
 5 files changed, 118 insertions(+), 1 deletion(-)

commit 4cfa83aeeee27e13b258065c19c0fc1488255145
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Apr 26 13:37:30 2018 -0700

    refactoring functions to use source interface (#1649)
    
    * refactoring functions to use source interface
    
    * addressing comments

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   6 +
 .../org/apache/pulsar/connect/core/Source.java     |   8 +-
 pulsar-functions/instance/pom.xml                  |   6 +
 .../pulsar/functions/instance/InstanceUtils.java   |  46 +++++++
 .../pulsar/functions/instance/JavaInstance.java    |  11 +-
 .../functions/instance/JavaInstanceRunnable.java   | 139 ++++++++++-----------
 .../{InputMessage.java => PulsarConfig.java}       |  40 ++----
 .../pulsar/functions/instance/PulsarRecord.java    |  53 ++++++++
 .../pulsar/functions/instance/PulsarSource.java    | 120 ++++++++++++++++++
 .../instance/processors/AtLeastOnceProcessor.java  |  11 +-
 .../instance/processors/AtMostOnceProcessor.java   |  11 +-
 .../processors/EffectivelyOnceProcessor.java       |  43 +++----
 .../instance/processors/MessageProcessor.java      |  23 ++--
 .../instance/processors/MessageProcessorBase.java  |  97 +++++++-------
 .../functions/instance/JavaInstanceTest.java       |   3 +-
 .../proto/src/main/proto/Function.proto            |   6 +
 .../pulsar/functions/runtime/JavaInstanceMain.java |  18 +++
 .../pulsar/functions/runtime/ProcessRuntime.java   |   7 ++
 .../pulsar/functions/runtime/ThreadRuntime.java    |  11 +-
 .../functions/runtime/ProcessRuntimeTest.java      |  15 ++-
 .../functions/utils/FunctionDetailsUtils.java      |  11 --
 .../apache/pulsar/functions/utils/Reflections.java |  34 +++++
 22 files changed, 506 insertions(+), 213 deletions(-)

commit eaae9eafd059fba76200593f9a021312c2aa3d44
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 26 13:37:05 2018 -0700

    Refactored BrokerService to use Optional in topics map (#1652)

 .../pulsar/broker/service/BrokerService.java       | 175 +++++++++++----------
 .../broker/stats/BookieClientStatsGenerator.java   |   8 +-
 .../broker/namespace/NamespaceServiceTest.java     |  22 +--
 .../pulsar/broker/service/BrokerServiceTest.java   |   2 +-
 4 files changed, 108 insertions(+), 99 deletions(-)

commit c4a85985ed723ea5cb282034d8af1ac4f2d80a05
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 26 13:36:18 2018 -0700

    Make upload/download hidden since they are really meant for uploading/downloading generic data (#1653)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java       | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 837672602ac1c23ada70ce45dc04efd981c6b339
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Apr 26 09:50:14 2018 -0700

    Fix: handle failure of topic stat update (#1546)

 .../apache/pulsar/broker/service/persistent/PersistentTopic.java   | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 064ba5aa9ae8a3032d9993d1b145eb15c852e11f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 25 23:36:30 2018 -0700

    Modified functions producer consumers to use new builder based api (#1580)
    
    * Modified functions producer consumers to use new builder based api
    
    * remove `@Test` on MultiConsumersOneOutputTopicProducersTest, since the client creation is changed to builder and this code might eventually go aways with connect related changes.
    
    * Fix MultiConsumersOneOutputTopicProducersTest
    
    * Fix FunctionMetaDataManagerTest
    
    * Fix MembershipManagerTest
    
    * Fix SchedulerManagerTest.java

 .../apache/pulsar/compaction/CompactorTool.java    |  27 ++--
 .../pulsar/compaction/TwoPhaseCompactor.java       |  13 +-
 .../pulsar/client/admin/internal/ClustersImpl.java |   9 +-
 .../admin/internal/PersistentTopicsImpl.java       |   3 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   4 +
 .../instance/processors/AtLeastOnceProcessor.java  |   6 +-
 .../instance/processors/AtMostOnceProcessor.java   |   6 +-
 .../processors/EffectivelyOnceProcessor.java       |  11 +-
 .../instance/processors/MessageProcessor.java      |   4 +-
 .../instance/processors/MessageProcessorBase.java  |   4 +-
 .../producers/AbstractOneOuputTopicProducers.java  |  47 +++---
 .../MultiConsumersOneOuputTopicProducers.java      |  16 +-
 .../functions/instance/producers/Producers.java    |   3 +-
 .../instance/FunctionResultRouterTest.java         |  12 +-
 .../instance/JavaInstanceRunnableProcessTest.java  |   2 +-
 .../functions/instance/JavaInstanceTest.java       |   1 +
 .../MultiConsumersOneOutputTopicProducersTest.java | 178 +++++++++++++++++----
 .../functions/runtime/ThreadRuntimeFactory.java    |   5 +-
 .../functions/worker/FunctionAssignmentTailer.java |   8 +-
 .../functions/worker/FunctionMetaDataManager.java  |   4 +-
 .../worker/FunctionMetaDataTopicTailer.java        |  10 +-
 .../functions/worker/FunctionRuntimeManager.java   |   2 +-
 .../functions/worker/FunctionWorkerStarter.java    |   2 -
 .../pulsar/functions/worker/MembershipManager.java |  26 +--
 .../pulsar/functions/worker/SchedulerManager.java  |  42 +++--
 .../org/apache/pulsar/functions/worker/Utils.java  |  37 ++---
 .../pulsar/functions/worker/WorkerConfig.java      |  10 +-
 .../pulsar/functions/worker/WorkerService.java     |   2 +-
 .../worker/FunctionMetaDataManagerTest.java        |  38 +++--
 .../functions/worker/MembershipManagerTest.java    | 104 +++++++-----
 .../functions/worker/SchedulerManagerTest.java     |  37 +++--
 .../apache/pulsar/websocket/ConsumerHandler.java   |  47 +++---
 .../apache/pulsar/websocket/ProducerHandler.java   |  55 ++++---
 .../org/apache/pulsar/websocket/ReaderHandler.java |   8 +-
 34 files changed, 485 insertions(+), 298 deletions(-)

commit 9746ea44337044a4c5d4f744d4e84e31ef53d327
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Apr 25 22:57:38 2018 -0700

    Fix: remove local-cluster from replication list of global-namespace should clean topics (#1647)

 .../broker/service/persistent/PersistentTopic.java | 130 ++++++++++++++-------
 .../broker/service/ReplicatorGlobalNSTest.java     | 110 +++++++++++++++++
 2 files changed, 201 insertions(+), 39 deletions(-)

commit 43d22579fa78ae863ff16cd2e14b87113355243d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Apr 25 22:41:05 2018 -0700

    Fix the exception output for admin commands (#1646)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdBase.java | 14 +++-----------
 1 file changed, 3 insertions(+), 11 deletions(-)

commit fc3417fc3b48fc43184eaff06dcab772d8ede554
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Apr 25 22:40:22 2018 -0700

    Hide namespace cli commands that are no longer relevant (#1645)

 .../java/org/apache/pulsar/admin/cli/CmdNamespaces.java | 17 +++++++++++++++--
 1 file changed, 15 insertions(+), 2 deletions(-)

commit 6001c417c7edf5892c55bc64e299023f16a5fbd9
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Apr 25 23:33:21 2018 +0200

    Delete offloaded ledger when ledger deleted (#1641)
    
    * Delete offloaded ledger when ledger deleted
    
    When a managed ledger trims a ledger, if that ledger has been
    offloaded to long term storage, delete it from long term storage
    also.
    
    Currently, it will always try to delete the bookkeeper ledger also,
    even if the ledger has already been offloaded. Handling for this case
    will be added in a later patch along with delayed bookkeeper ledger
    deletion in the case of offload.
    
    Master Issue: #1511
    
    * Fixup for delete

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 18 ++--
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 98 ++++++++++++++++++++++
 2 files changed, 110 insertions(+), 6 deletions(-)

commit edf01a80cfc6759063bbf1751334fbbfcd91f55c
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Apr 25 23:32:24 2018 +0200

    Offloading prints wrong log on exception (#1643)
    
    The check for exception was backwards, so it was always warning in the
    happy case, and reporting success in the case of failure.
    
    Master Issue: #1511

 .../main/java/org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0c9822c988a7097d7545dfc5c0107cd53c7c14ba
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Wed Apr 25 10:49:54 2018 -0600

    Proxy admin web requests (#1505)
    
    * Proxy admin web requests
    
    * Remove unused dependency:
    
    * Work on redirects
    
    * Rethrow exception on auth failure
    
    * Override decisionm by proxy to disable followRedirects
    
    * Add license header
    
    * Authenticated and Unauthenticated tests for admin proxy
    
    * Add missing license headers:

 pulsar-proxy/pom.xml                               |   5 +
 .../pulsar/proxy/server/AdminProxyHandler.java     | 106 ++++++++++++++
 .../pulsar/proxy/server/ProxyServiceStarter.java   |  28 ++--
 .../org/apache/pulsar/proxy/server/WebServer.java  |  11 +-
 .../proxy/server/AuthedAdminProxyHandlerTest.java  | 163 +++++++++++++++++++++
 .../server/UnauthedAdminProxyHandlerTest.java      | 108 ++++++++++++++
 6 files changed, 409 insertions(+), 12 deletions(-)

commit 785d2a2d31bc0aa843a104cebac085a7f9d0c72a
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Apr 25 00:45:28 2018 -0700

    offloadPrefix implementation for managed ledger (#1549)
    
    * offloadPrefix implementation for managed ledger
    
    When given a position, will select all complete ledgers before that
    position, and offload them. When the offload completes, updates the
    managed ledger metadata with the context information for the offload.
    
    Master issue #1511
    
    * Make offloading sequential and add retries on some ops
    
    Also smaller review comments
    
    * Update to offloader interface (will put in separate PR)
    
    * Two phase update of metadata
    
    * Add test for conflict on offload
    
    * javadoc for interface

 .../apache/bookkeeper/mledger/LedgerOffloader.java |  40 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 252 +++++++-
 .../mledger/impl/NullLedgerOffloader.java          |  12 +-
 .../bookkeeper/mledger/proto/MLDataFormats.java    | 666 ++++++++++++++++++++-
 managed-ledger/src/main/proto/MLDataFormats.proto  |   7 +
 .../bookkeeper/mledger/impl/OffloadPrefixTest.java | 626 +++++++++++++++++++
 6 files changed, 1553 insertions(+), 50 deletions(-)

commit 1fad36bb81f772d7851167b4d2170d388547a620
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Apr 24 17:17:44 2018 -0700

     Rename Connect `Message` interface to `Record` (#1636)
    
    * Rename Connect `Message` interface to `Record`
    
    *Motivation*
    
    Having two different `Message` interfaces is a bit confusing and also introduced unnecessary object allocation.
    
    *Solution*
    
    - rename connect `Message` interface to `Record` interface
    - introduce an abstract base implementation for both `api.Message` and `connect.Record`
    - change the places to the new class
    
    * Add the missing class file
    
    * - change Map<String, String> to Map<String, Object> for all open calls
    - add a `RuntimeSink` in functions which extends Sink and provides the flexibility to control acking behavior for pulsar sink
    
    * record sequence should be part of RecordContext

 pulsar-client-admin-shaded-for-functions/pom.xml   |  7 ++
 pulsar-client-admin-shaded/pom.xml                 |  7 ++
 pulsar-client-shaded/pom.xml                       |  7 ++
 pulsar-client/pom.xml                              |  6 ++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  3 +-
 .../pulsar/client/impl/MessageRecordImpl.java      | 65 +++++++++++++++
 .../pulsar/client/impl/TopicMessageImpl.java       |  9 +-
 .../pulsar/client/impl/MessageRecordImplTest.java  | 60 ++++++++++++++
 .../pulsar/connect/aerospike/AerospikeSink.java    |  9 +-
 .../connect/aerospike/AerospikeSinkConfig.java     |  2 +-
 .../pulsar/connect/cassandra/CassandraSink.java    |  7 +-
 .../connect/cassandra/CassandraSinkConfig.java     |  2 +-
 .../org/apache/pulsar/connect/core/PushSource.java |  4 +-
 .../org/apache/pulsar/connect/core/Record.java     | 31 +++++++
 .../core/{Message.java => RecordContext.java}      | 27 +++---
 .../java/org/apache/pulsar/connect/core/Sink.java  |  6 +-
 .../org/apache/pulsar/connect/core/Source.java     |  2 +-
 .../org/apache/pulsar/connect/kafka/KafkaSink.java |  9 +-
 .../pulsar/connect/kafka/KafkaSinkConfig.java      |  2 +-
 .../apache/pulsar/connect/kafka/KafkaSource.java   | 22 ++---
 .../pulsar/connect/kafka/KafkaSourceConfig.java    |  2 +-
 .../pulsar/connect/rabbitmq/RabbitMQConfig.java    |  2 +-
 .../pulsar/connect/rabbitmq/RabbitMQSource.java    | 22 ++---
 .../pulsar/connect/twitter/TwitterFireHose.java    | 16 ++--
 .../connect/twitter/TwitterFireHoseConfig.java     |  2 +-
 .../pulsar/functions/sink/DefaultRuntimeSink.java  | 69 ++++++++++++++++
 .../apache/pulsar/functions/sink/RuntimeSink.java  | 52 ++++++++++++
 .../functions/sink/DefaultRuntimeSinkTest.java     | 96 ++++++++++++++++++++++
 pulsar-functions/utils/pom.xml                     |  4 +
 29 files changed, 473 insertions(+), 79 deletions(-)

commit dd601b7cd9b39ecc07862950735451e598a3ce42
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 23 17:47:14 2018 -0700

    Also look for the '_static' suffix when searching for libjsoncpp.a (#1635)
    
    *Motivation*
    
    Newer versions of Homebrew have the JSONCpp static library installed as libjsoncpp_static.a

 pulsar-client-cpp/CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9947f748e01f6cd8596e9fb49e16c090c6fda769
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 23 13:35:20 2018 -0700

    Fixed typo in ConsumerBuilder acknowledgmentGroupTime option (#1608)

 .../apache/pulsar/broker/admin/AdminApiTest.java   |  6 +++---
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  6 +++---
 .../pulsar/broker/service/BrokerServiceTest.java   |  4 ++--
 .../broker/service/PersistentFailoverE2ETest.java  |  4 ++--
 .../broker/service/PersistentQueueE2ETest.java     |  2 +-
 .../pulsar/broker/service/ResendRequestTest.java   |  2 +-
 .../client/api/DispatcherBlockConsumerTest.java    | 14 ++++++-------
 .../client/api/SimpleProducerConsumerTest.java     | 24 +++++++++++-----------
 .../stats/client/PulsarBrokerStatsClientTest.java  |  2 +-
 .../kafka/compat/PulsarConsumerKafkaConfig.java    |  2 +-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  2 +-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  2 +-
 .../pulsar/testclient/PerformanceConsumer.java     |  2 +-
 13 files changed, 36 insertions(+), 36 deletions(-)

commit 2ac2b5c751fb2e102fc1b9b9cdd9bf20f850a478
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Apr 23 11:36:33 2018 -0700

    Add a integration test for create subscription CLI command (#1613)
    
    * Add a integration test for create subscription CLI command
    
    * - Pulsar Admin exception casting issue
    - Handle redirects
    
    * - print more details about response
    
    * Dump location
    
    * return the original response

 .../apache/pulsar/broker/web/RestException.java    |  3 +-
 .../pulsar/client/admin/internal/BaseResource.java | 42 +++++++++++-----------
 .../java/org/apache/pulsar/admin/cli/CmdBase.java  | 15 ++++++--
 .../apache/pulsar/tests/integration/TestCLI.java   | 22 ++++++++++++
 4 files changed, 57 insertions(+), 25 deletions(-)

commit 093d005242f0fd2ef98608f753f16c7e3c952d63
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Apr 22 10:39:48 2018 -0700

    Handle unchecked exceptions on cursor to ensure read callback is triggered (#1630)

 .../org/apache/bookkeeper/mledger/impl/OpReadEntry.java   | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)

commit 10119795cf6776ff2e5efe322d39195c56205789
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Apr 22 10:25:46 2018 -0700

    adding ack method to Message interface (#1627)
    
    * adding ack method to Message interface
    
    * adding ack to have default implementation
    
    * adding fail method
    
    * correcting grammar
    
    * removing unneccesary colon

 .../main/java/org/apache/pulsar/connect/core/Message.java    | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

commit 2d621ae7f3ffaef784d231bf546579830137871d
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 21 15:30:46 2018 -0700

    Reverting change in ManagedCursorImpl introduced in #1519 since it causes regression (#1628)
    
    Revert "Fix for cursorPersistenceAsyncMarkDeleteSameThread (#1544)"
    This reverts commit ede7ffe540b4ea8c715c3af9f30f739ea133da94.
    
    Revert "Fixed flaky test in managed ledger close path (#1539)"
    This reverts commit b22769bb57defe435cc4faedcbebe1d3260cdee4.
    
    Revert "Avoid contention in ManagedCursorImpl generated by locking on pendingMarkDeleteOps (#1519)"
    This reverts commit ed8d1a5d39b5bde796954e79feda579dc7f64c2f.

 managed-ledger/pom.xml                             |  11 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 159 ++++++++++-----------
 pom.xml                                            |   7 -
 3 files changed, 81 insertions(+), 96 deletions(-)

commit f20364480fdae02a404244202b493699ada42fb1
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Apr 21 14:30:08 2018 -0700

     refactoring java instance to use pull model for message ingress (#1621)
    
    * refactoring java instance to use pull model for message ingress
    
    * cleaning up unnecessary code
    
    * checking consumer type
    
    * adding header back to commented out test

 .../pulsar/functions/instance/ContextImpl.java     |   22 +-
 .../pulsar/functions/instance/JavaInstance.java    |    4 +-
 .../functions/instance/JavaInstanceRunnable.java   |   68 +-
 .../instance/processors/AtLeastOnceProcessor.java  |    5 +-
 .../instance/processors/AtMostOnceProcessor.java   |    5 +-
 .../processors/EffectivelyOnceProcessor.java       |  151 +-
 .../instance/processors/MessageProcessor.java      |   57 +-
 .../instance/processors/MessageProcessorBase.java  |  103 +-
 .../instance/JavaInstanceRunnableProcessTest.java  | 1988 ++++++++++----------
 .../functions/instance/JavaInstanceTest.java       |    2 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |    1 +
 11 files changed, 1102 insertions(+), 1304 deletions(-)

commit 584cda2295b171ee9f3d7063445bfec49b5333b0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sat Apr 21 14:15:41 2018 -0700

    [pulsar-connect] Add pull source (#1622)

 .../org/apache/pulsar/connect/core/Source.java     | 39 ++++++++++++++++++++++
 1 file changed, 39 insertions(+)

commit 7361767b2c7e99aff24cb1b2ccceb6c4101b1b83
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Apr 21 14:14:40 2018 -0700

    Encryption semi-support for Compaction (#1623)
    
    * Encryption semi-support for Compaction
    
    Without batching, compaction of encrypted topics works as it does with
    any other topic.
    
    However, with batching, compaction of encrypted topics is unable to
    break the batched messages into individual messages, so it's unable to
    read the keys which is uses for compaction, as compaction doesn't have
    access to the encryption key which was used to encrypt the payload.
    
    This change makes it possible to use compaction with an encrypted
    topic, though when it comes across a batched message, it just lets the
    whole batch pass through.
    
    * Fix integration test (bad merge from master)

 .../pulsar/client/impl/RawBatchConverter.java      |   4 +-
 .../pulsar/compaction/TwoPhaseCompactor.java       |   4 +-
 .../apache/pulsar/compaction/CompactionTest.java   | 219 +++++++++++++++++++++
 3 files changed, 223 insertions(+), 4 deletions(-)

commit a08d2488700ebf1d48d32d33f99bc254f66ea0d2
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 21 14:13:40 2018 -0700

    pulsar-client-admin should not shade dependency on pulsar-common (#1626)

 pulsar-client-admin-shaded/pom.xml | 4 ----
 1 file changed, 4 deletions(-)

commit b4658e2f94ba150e00ffe01ec92b358d8c443400
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Apr 21 14:13:21 2018 -0700

    Made upload/download generic so that it doesnt have to be function specific (#1629)

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 21 +++------
 .../org/apache/pulsar/client/admin/Functions.java  | 30 +++++-------
 .../client/admin/internal/FunctionsImpl.java       | 16 +++----
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 49 +++++++++-----------
 .../functions/worker/rest/api/FunctionsImpl.java   | 53 +++++-----------------
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 21 +++------
 6 files changed, 67 insertions(+), 123 deletions(-)

commit 4f73c545344e4b089ecf11291ad6f1d1767f9181
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Apr 20 16:54:37 2018 -0700

    Introduced Upload/Download interface for uploading and downloading function code. (#1624)
    
    * Moved some util functionality from worker to util
    
    * Reverted K8 changes
    
    * Removed k8
    
    * Moved tests
    
    * Change path
    
    * Added upload and download server implementations
    
    * Added upload and download client requests
    
    * Dont need to depend on util
    
    * Missed declarations
    
    * Fix bug
    
    * Fix bug
    
    * Revert "Moved some util functionality from worker to util"
    
    This reverts commit f2347cb05878adf31c9538be489ef174205be761.
    
    * moved path
    
    * Revert "Moved tests"
    
    This reverts commit 7dc4b506018df67773f433aa09f24610dc1d648a.
    
    * Fixed the paths
    
    * Fixed Exception to be precise

 .../pulsar/broker/admin/impl/FunctionsBase.java    | 22 ++++++
 .../org/apache/pulsar/client/admin/Functions.java  | 34 +++++++++
 .../client/admin/internal/FunctionsImpl.java       | 36 ++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 60 ++++++++++++++++
 .../org/apache/pulsar/functions/worker/Utils.java  |  2 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 82 +++++++++++++++++++++-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 23 ++++++
 7 files changed, 257 insertions(+), 2 deletions(-)

commit d116753a191546dccdc266d9afb9f3eeb4ae5e39
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Apr 20 11:16:32 2018 -0700

    Topic termination should work with no consumers connected to (#1620)
    
    *Problem*
    
    Topic termination fails with NPE when there is no consumers connected to.
    
    *Solution*
    
    If there is no consumers connected, we don't need to notify the consumers. This will prevent NPE.
    
    *Result*
    
    Fix the NPE issue and add a test to cover this case.

 .../service/persistent/PersistentSubscription.java |  7 +++-
 .../apache/pulsar/tests/integration/TestCLI.java   | 45 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 2 deletions(-)

commit 3bfa9d6efe53d8f1ecaf6ce8c8bdb6af7df20287
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Apr 19 22:49:11 2018 -0700

    Document 307 redirection on admin restful api (#1619)

 site/docs/latest/admin-api/overview.md | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit f70392664c28f096cecee16d764be0e609f3bc2a
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Thu Apr 19 10:31:20 2018 -0700

    Added config to deploy pulsar in aws using ebs storage (#1586)

 deployment/kubernetes/aws/README.md       |  26 ++++
 deployment/kubernetes/aws/bookkeeper.yaml | 215 ++++++++++++++++++++++++++++++
 deployment/kubernetes/aws/broker.yaml     | 144 ++++++++++++++++++++
 deployment/kubernetes/aws/zookeeper.yaml  | 153 +++++++++++++++++++++
 4 files changed, 538 insertions(+)

commit dc404e0d7f8fc4812abe2a3aca40c9b77ab31098
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Apr 18 23:47:58 2018 -0700

    Compression support for compaction (#1604)
    
    * Compression support for compaction
    
    Messages in a batch are all compressed together, so compaction has to
    handle them as a special case. This change adds that special handling
    and verifies that compaction works with compaction for batched and
    non-batched messages.
    
    * Remove incorrect comments (came through copy paste)
    
    * Fix refcount issue in test

 .../pulsar/client/impl/RawBatchConverter.java      | 37 ++++++++--
 .../apache/pulsar/compaction/CompactionTest.java   | 80 ++++++++++++++++++++++
 2 files changed, 112 insertions(+), 5 deletions(-)

commit a86e7beb91619ccff716807324051530def33f2b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 18 23:43:34 2018 -0700

    Fixed initial default namespace setup with current cluster setup (#1607)

 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 74 +++++++++++++---------
 1 file changed, 45 insertions(+), 29 deletions(-)

commit f8c2d2580dab7a99fa508debc22b8fedf231f7ca
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Apr 18 15:32:37 2018 -0700

    Fix pulsar broker handling WebApplicationException (#1612)
    
    *Problem*
    
    Currently all WebApplicationExeptions are converted to 500 / InternalServerError by broker before responding to rest requests.
    
    *Solution*
    
    Make sure RestException handles WebApplicationExeption

 .../apache/pulsar/broker/web/RestException.java    | 14 +++--
 .../pulsar/broker/web/RestExceptionTest.java       | 59 ++++++++++++++++++++++
 2 files changed, 69 insertions(+), 4 deletions(-)

commit c6f49f8659a1caa0eb5aeb178196242bd85585e2
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 18 14:38:50 2018 -0700

    Proxy should close connections immediately after exception caught (#1602)

 .../org/apache/pulsar/proxy/server/ProxyConnection.java   | 15 +++++++++++++--
 1 file changed, 13 insertions(+), 2 deletions(-)

commit e6d1551d08188bd634f02f4c3704967342c41b18
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Apr 18 14:36:32 2018 -0700

    Enhance Pulsar Connect api by attaching more information about the message (#1606)
    
    * Enhance Pulsar Connect api by attaching more information about the message
    
    * Fix RabbitMQ to fit into the new interface
    
    * Made Message an interface
    
    * Added default implementations for the Message interface

 .../pulsar/connect/aerospike/AerospikeSink.java    |  7 ++--
 .../pulsar/connect/cassandra/CassandraSink.java    |  5 ++-
 .../org/apache/pulsar/connect/core/Message.java    | 43 ++++++++++++++++++++++
 .../org/apache/pulsar/connect/core/PushSource.java |  2 +-
 .../java/org/apache/pulsar/connect/core/Sink.java  |  2 +-
 .../org/apache/pulsar/connect/kafka/KafkaSink.java |  5 ++-
 .../apache/pulsar/connect/kafka/KafkaSource.java   | 30 +++++++++++++--
 .../pulsar/connect/rabbitmq/RabbitMQSource.java    | 24 +++++++++---
 .../pulsar/connect/twitter/TwitterFireHose.java    | 20 ++++++++--
 9 files changed, 118 insertions(+), 20 deletions(-)

commit 1334005eda24564971343c42d0df3102fbe40039
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 18 14:32:13 2018 -0700

    On tenants cli tool, default tenant to all clusters if not specified (#1584)
    
    * On tenants cli tool, default tenant to all clusters if not specified
    
    * Fixed handling of tenant info args in cli

 .../org/apache/pulsar/admin/cli/CmdTenants.java    | 46 ++++++++++++++++------
 .../pulsar/common/policies/data/TenantInfo.java    | 18 ++-------
 2 files changed, 38 insertions(+), 26 deletions(-)

commit 488942e71f1bc4cde9f2b8c35e57d98c5b6efef4
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 18 14:31:39 2018 -0700

    Added option to create namespace on CLI passing list of clusters (#1579)
    
    * Added option to create namespace on CLI passing list of clusters
    
    * Fixed NamespaceCreateBundlesTest.testCreateNamespaceWithDefaultBundles
    
    * Fixed expected value in test
    
    * Use List instead of Set otherwise jcommander would get all param in a single string
    
    * Added mocked test

 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  13 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  21 +--
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |   1 +
 .../org/apache/pulsar/client/admin/Namespaces.java |  23 ++++
 .../client/admin/internal/NamespacesImpl.java      |  17 +++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  56 +++++++-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 144 ++++++++++++---------
 .../pulsar/common/policies/data/Policies.java      |   2 +-
 8 files changed, 200 insertions(+), 77 deletions(-)

commit 732105f45733e48bdfe0216c8148f6c6a1586261
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Apr 18 14:31:14 2018 -0700

    Use official bookkeeper release 4.7.0 (#1605)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e2a585ab2fe1c2f8f8eb0d0f1b8ed2100e7a3fc4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Apr 18 13:17:08 2018 -0700

    cpp tests should wait for standalone up (#1611)

 pulsar-client-cpp/run-unit-tests.sh | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

commit 974cb78e84c4d4536a5b03a004a541e509cd9d07
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 18 13:03:43 2018 -0700

    Fixed intermittent test BrokerServiceThrottlingTest.testLookupThrottl (#1598)
    
    * Fixed intermittent test BrokerServiceThrottlingTest.testLookupThrottlingForClientByBrokerInternalRetry
    
    * more topic name fixes

 .../apache/pulsar/broker/service/BrokerServiceThrottlingTest.java   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 828a8c0752be4b94e17f8d63405b5c410aa35432
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Apr 18 11:25:59 2018 -0700

    fix name space (#1609)

 .../test/java/org/apache/pulsar/broker/service/BrokerServiceTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b9d4912778753865a64073553086cd46964cfd20
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 17 10:50:20 2018 -0700

    Removed duplicated declaration of log4j test in dependenciesManagement (#1597)

 pom.xml | 6 ------
 1 file changed, 6 deletions(-)

commit 978c933e37f21bdae1d8b02dd8350637aefbab82
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Apr 17 10:24:30 2018 -0700

    Add metadata to compacted topic ledger on creation (#1570)
    
    This can be used by ops to identify what the ledger is, and where it
    can be cleaned up. There are corner cases where a compacted topic
    ledger may be created, but never attached to the topic, just as there
    are with managed ledger ledgers, so we need some way that these can be
    identified for garbage collection later.

 .../java/org/apache/pulsar/compaction/TwoPhaseCompactor.java  | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

commit f5a28f4ff560e078d8cde0b76011da0eb5ab39f7
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Apr 17 09:36:55 2018 -0700

    Add rate limit for client lookup requests (#1538)
    
    * add rate limit for client lookup request
    
    * change following comments

 .../pulsar/broker/service/BrokerServiceTest.java   | 33 ++++++++--
 .../apache/pulsar/client/api/ClientBuilder.java    | 12 +++-
 .../pulsar/client/impl/ClientBuilderImpl.java      |  6 ++
 .../org/apache/pulsar/client/impl/ClientCnx.java   | 76 +++++++++++++++++-----
 .../client/impl/conf/ClientConfigurationData.java  |  3 +-
 5 files changed, 105 insertions(+), 25 deletions(-)

commit bb3c72f91e30a1ecfd83880903e24d0a1343d39b
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Apr 17 09:23:23 2018 -0700

    Compaction commands for pulsar-admin (#1596)
    
    Adds an compact and compaction-status command in the persistent
    subcommand of pulsar-admin.
    
    This command differs from the compact-topic CLI (part of pulsar
    command), in that it triggers compaction to occur via the REST api,
    which causes the compaction to run in the broker process. The
    compact-topic CLI spawns a new process to run the compaction.
    
    Patch also fixes batch detection, which was broken (uncovered by a
    change in the defaults), and recycles some metadata that wasn't being
    recycled previously.

 .../pulsar/client/impl/RawBatchConverter.java      |  7 ++-
 .../pulsar/compaction/TwoPhaseCompactor.java       | 12 ++--
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 58 +++++++++++++++++++
 .../pulsar/tests/integration/TestCompaction.java   | 66 +++++++++++++++++++---
 4 files changed, 130 insertions(+), 13 deletions(-)

commit e548aa28505c3e0d40944751c85fbc9360cfcb7d
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Mon Apr 16 22:27:50 2018 -0700

    Reduce un-necessary work when doing bundle lookup for partitioned topic (#1527)
    
    * make only one acquire and load for each bundle
    
    * Change following comments: use ConcurrentOpenHashMap and CompletableFuture handle the concurrent
    
    * change map name

 .../pulsar/broker/namespace/NamespaceService.java  | 75 ++++++++++++++--------
 1 file changed, 47 insertions(+), 28 deletions(-)

commit 39112f4f961aa711d249a78fc76f72494d37f346
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Apr 16 22:25:40 2018 -0700

    Fix: deadlock while closing non-shared consumer (#1591)
    
    * Fix: deadlock while closing non-shared consumer
    
    * removing consumer async cause failure in unsubscribe. so, remove subscription async from topic

 .../pulsar/broker/service/persistent/PersistentSubscription.java    | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit b7fe6714eb3a6155cf0640353d2f0037516e1e0a
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 16 20:19:10 2018 -0700

    When new cluster is setup, public/default namespace should be extended there (#1595)

 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 30 +++++++++++++++++-----
 1 file changed, 24 insertions(+), 6 deletions(-)

commit 3121bec38b065411e8168688d4890b125f38d81f
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Apr 17 01:55:47 2018 +0200

    Add properties alias for tenants in pulsar-admin (#1592)
    
    Recently properties was renamed to tenants in the pulsar-admin
    CLI. However, people may already have scripts that depend on the
    properties command existing, which will break with such a change.
    
    This patch adds an alias for tenants, which so that the commands will
    not break. However, it will not show up in the usage command, so
    people will be encouraged to use tenants.
    
    The change also makes pulsar-admin exit with a non-error code when
    --help is run. This is needed to test, and is standard on unix utils.

 .../org/apache/pulsar/admin/cli/CmdTenants.java    | 12 +++++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |  3 +-
 tests/integration/cli/pom.xml                      | 47 +++++++++++++++++
 .../apache/pulsar/tests/integration/TestCLI.java   | 61 ++++++++++++++++++++++
 .../cli/src/test/resources/arquillian.xml          | 32 ++++++++++++
 tests/integration/pom.xml                          |  1 +
 6 files changed, 155 insertions(+), 1 deletion(-)

commit b421e631ddc4c3c879faab201ba0fb30bb55304e
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Apr 16 23:59:42 2018 +0200

    Don't format bookkeeper if /ledgers exist (#1588)
    
    If you want to run pulsar on a preexisting bookkeeper installation,
    there's currently no way to format the metadata.
    
    This patch skips the bookkeeper initialization if /ledgers already
    exists, which indicates that it has already been formatted.

 .../java/org/apache/pulsar/PulsarClusterMetadataSetup.java    | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

commit 9d19a0ea112d192621d464e708910e2587705bd0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Apr 16 14:58:36 2018 -0700

    Handle NPE for output producer is null for function (#1590)

 .../main/java/org/apache/pulsar/functions/api/utils/DefaultSerDe.java   | 1 +
 .../pulsar/functions/instance/processors/AtLeastOnceProcessor.java      | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

commit 44ace5262000b0892c019810908c5412a3a3a50a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Apr 16 14:41:12 2018 -0700

    Start function worker service after broker is fully started (#1589)

 .../src/main/java/org/apache/pulsar/broker/PulsarService.java       | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit e626e2ac26634b989db344a23f066bf34774363d
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Apr 15 23:21:10 2018 -0700

    Let Proxy handle ZK session expires without restarting (#1583)

 .../bookkeeper/zookeeper/BkZooKeeperClient.java    | 1365 ++++++++++++++++++++
 .../apache/bookkeeper/zookeeper/BkZooWorker.java   |  162 +++
 .../apache/pulsar/proxy/server/ProxyService.java   |   30 +-
 .../util/BkReadOnlyZookeeperClientFactoryImpl.java |   74 ++
 .../proxy/server/util/ZookeeperCacheLoader.java    |   35 +-
 5 files changed, 1622 insertions(+), 44 deletions(-)

commit 8fbb926089effcadf59e199fe69ec65b4bbe4eae
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Apr 15 21:29:23 2018 -0700

    Update default values for a few publisher settings (#1440)

 .../pulsar/broker/service/AbstractReplicator.java  |   6 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  74 ++++++++--
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  34 ++++-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  71 +++++++---
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |  42 ++++--
 .../pulsar/broker/service/BatchMessageTest.java    |  13 +-
 .../broker/service/PersistentFailoverE2ETest.java  |  13 +-
 .../broker/service/PersistentQueueE2ETest.java     |  13 +-
 .../broker/service/PersistentTopicE2ETest.java     | 149 +++++++++++++++++----
 .../pulsar/broker/service/ReplicatorTest.java      |  16 ++-
 .../pulsar/broker/service/ReplicatorTestBase.java  |  18 ++-
 .../pulsar/broker/service/ResendRequestTest.java   |  36 +++--
 .../broker/service/TopicTerminationTest.java       |  51 +++++--
 .../pulsar/client/api/BrokerServiceLookupTest.java |   3 +-
 .../client/api/DispatcherBlockConsumerTest.java    |   4 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |  20 ++-
 .../api/PartitionedProducerConsumerTest.java       |  19 ++-
 .../client/api/SimpleProducerConsumerStatTest.java |  10 +-
 .../client/api/SimpleProducerConsumerTest.java     |  49 +++++--
 .../client/api/v1/V1_ProducerConsumerTest.java     |  24 ++++
 .../apache/pulsar/client/impl/MessageIdTest.java   |  34 ++++-
 .../client/impl/PatternTopicsConsumerImplTest.java |  18 +++
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |  18 ++-
 .../apache/pulsar/client/impl/RawReaderTest.java   |  26 +++-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  17 +++
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |  23 +++-
 .../pulsar/client/impl/ZeroQueueSizeTest.java      |  21 ++-
 .../apache/pulsar/compaction/CompactionTest.java   |  75 ++++++++---
 .../apache/pulsar/compaction/CompactorTest.java    |  16 ++-
 .../apache/pulsar/client/api/ProducerBuilder.java  |  12 +-
 .../pulsar/client/api/ProducerConfiguration.java   |  21 +--
 .../impl/conf/ProducerConfigurationData.java       |   6 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  13 +-
 .../apache/pulsar/websocket/ProducerHandler.java   |   3 +
 .../pulsar/tests/integration/TestCompaction.java   |   7 +-
 35 files changed, 774 insertions(+), 201 deletions(-)

commit bc0a4b87ff5c2a2015e9396c45f7c70dcdb632a5
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Apr 15 20:40:14 2018 -0700

    Forget to recycle MessageMetadata protobuf object (#1541)
    
    * Forget to recycle MessageMetadata protobuf object
    
    * Fixed merge

 .../apache/pulsar/client/impl/ProducerImpl.java    | 31 ++++++++++++----------
 1 file changed, 17 insertions(+), 14 deletions(-)

commit cc9a9d9212a9a7c5731307d067c2e9ac62548524
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Apr 15 20:39:00 2018 -0700

    Renamed "property" into "tenant" (#1578)
    
    * Renamed "property" into "tenant"
    
    * Fixed merging issue
    
    * Fixed tests
    
    * Fixed typo

 deployment/terraform-ansible/deploy-pulsar.yaml    |   2 +-
 .../broker/cache/ConfigurationCacheService.java    |  12 +-
 .../apache/pulsar/PulsarClusterMetadataSetup.java  |  18 +-
 .../org/apache/pulsar/PulsarStandaloneStarter.java |  19 +-
 .../org/apache/pulsar/broker/PulsarService.java    |  22 +-
 .../apache/pulsar/broker/admin/AdminResource.java  |  10 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   | 100 +++---
 .../broker/admin/impl/PersistentTopicsBase.java    |  50 +--
 .../broker/admin/impl/ResourceQuotasBase.java      |   6 +-
 .../impl/{PropertiesBase.java => TenantsBase.java} | 100 +++---
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  22 +-
 .../broker/admin/v1/NonPersistentTopics.java       |  12 +-
 .../apache/pulsar/broker/admin/v1/Properties.java  |   6 +-
 .../apache/pulsar/broker/admin/v2/BrokerStats.java |   6 +-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  | 336 ++++++++++-----------
 .../broker/admin/v2/NonPersistentTopics.java       |  52 ++--
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 176 +++++------
 .../pulsar/broker/admin/v2/ResourceQuotas.java     |  18 +-
 .../pulsar/broker/admin/v2/SchemasResource.java    |  52 ++--
 .../admin/v2/{Properties.java => Tenants.java}     |   8 +-
 .../pulsar/broker/lookup/TopicLookupBase.java      |   8 +-
 .../pulsar/broker/lookup/v2/TopicLookup.java       |  12 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  66 ++--
 .../apache/pulsar/broker/SLAMonitoringTest.java    |  10 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  70 ++---
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  20 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  66 ++--
 .../broker/admin/IncrementPartitionsTest.java      |   6 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java | 232 +++++++-------
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    |  54 ++--
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |  20 +-
 .../pulsar/broker/auth/AuthorizationTest.java      |   6 +-
 .../AntiAffinityNamespaceGroupTest.java            |  28 +-
 .../loadbalance/ModularLoadManagerImplTest.java    |  29 +-
 .../broker/service/BacklogQuotaManagerTest.java    |   6 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |   6 +-
 .../pulsar/broker/service/BrokerTestBase.java      |   6 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   6 +-
 .../pulsar/broker/service/ResendRequestTest.java   |   8 +-
 .../broker/service/v1/V1_ReplicatorTestBase.java   |   6 +-
 .../api/AuthenticatedProducerConsumerTest.java     |  22 +-
 .../AuthenticationTlsHostnameVerificationTest.java |   6 +-
 .../api/AuthorizationProducerConsumerTest.java     |  10 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |  10 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |   4 +-
 .../pulsar/client/api/ProducerConsumerBase.java    |   6 +-
 .../pulsar/client/api/TlsProducerConsumerBase.java |   6 +-
 .../client/api/v1/V1_ProducerConsumerBase.java     |   6 +-
 .../client/impl/ConsumerConfigurationTest.java     |  11 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  12 +-
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   4 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   |   6 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  16 +-
 .../pulsar/compaction/CompactedTopicTest.java      |  22 +-
 .../apache/pulsar/compaction/CompactionTest.java   |   6 +-
 .../apache/pulsar/compaction/CompactorTest.java    |   6 +-
 .../service/web/DiscoveryServiceWebTest.java       |   6 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |   6 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |  54 ++--
 .../pulsar/client/admin/PersistentTopics.java      |   8 +-
 .../org/apache/pulsar/client/admin/Properties.java |  11 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  21 +-
 .../org/apache/pulsar/client/admin/Tenants.java    | 126 ++++++++
 .../client/admin/internal/NamespacesImpl.java      |  12 +-
 .../{PropertiesImpl.java => TenantsImpl.java}      |  65 ++--
 pulsar-client-cpp/run-unit-tests.sh                |   4 +-
 .../kafka/compat/tests/KafkaConsumerTest.java      |   4 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  36 +--
 .../pulsar/client/cli/PulsarClientToolTest.java    |   4 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   2 +-
 .../cli/{CmdProperties.java => CmdTenants.java}    |  50 +--
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   2 +-
 .../client/tutorial/ContinuousAsyncProducer.java   |   2 +-
 .../pulsar/client/tutorial/ContinuousProducer.java |   2 +-
 .../client/tutorial/SampleAsyncProducer.java       |   2 +-
 .../pulsar/client/tutorial/SampleConsumer.java     |   2 +-
 .../client/tutorial/SampleConsumerListener.java    |   2 +-
 .../client/tutorial/SampleCryptoConsumer.java      |   2 +-
 .../client/tutorial/SampleCryptoProducer.java      |   2 +-
 .../pulsar/client/tutorial/SampleProducer.java     |   2 +-
 .../apache/pulsar/common/naming/NamespaceName.java |  54 ++--
 .../org/apache/pulsar/common/naming/TopicName.java |  58 ++--
 .../data/{PropertyAdmin.java => TenantInfo.java}   |  14 +-
 .../pulsar/common/naming/NamespaceNameTest.java    |   8 +-
 .../apache/pulsar/common/naming/TopicNameTest.java |  10 +-
 .../common/policies/data/PoliciesDataTest.java     |   8 +-
 .../discovery/service/BrokerDiscoveryProvider.java |  16 +-
 .../utils/functioncache/FunctionCacheEntry.java    |  12 +-
 .../functioncache/FunctionCacheManagerImpl.java    |  24 +-
 .../functioncache/FunctionCacheEntryTest.java      |   8 +-
 .../FunctionCacheManagerImplTest.java              |   5 +-
 .../proxy/server/BrokerDiscoveryProvider.java      |  16 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |   6 +-
 .../proxy/server/ProxyForwardAuthDataTest.java     |  11 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |   7 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |   4 +-
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |   4 +-
 .../server/ProxyWithAuthorizationNegTest.java      |   6 +-
 .../proxy/server/ProxyWithAuthorizationTest.java   |  18 +-
 .../server/ProxyWithoutServiceDiscoveryTest.java   |   4 +-
 .../websocket/admin/v1/WebSocketProxyStatsV1.java  |   6 +-
 .../websocket/admin/v2/WebSocketProxyStatsV2.java  |   6 +-
 .../pulsar/tests/integration/TestCompaction.java   |  13 +-
 .../apache/pulsar/tests/integration/TestSmoke.java |   2 +-
 105 files changed, 1364 insertions(+), 1230 deletions(-)

commit d8af1369c837378cdf46f1132bee108dede94cdc
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Apr 15 18:27:26 2018 -0700

    Fix for C++ test BasicEndToEndTest.testStatsLatencies (#1581)
    
    * Fix fot C++ test BasicEndToEndTest.testStatsLatencies
    
    * Removed unwanted change in standalone conf

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 24 +++++++++---------------
 1 file changed, 9 insertions(+), 15 deletions(-)

commit b37d7b7a64340659e1994b568d7f4ff562865505
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Apr 15 18:27:10 2018 -0700

    Support short topic name in cpp client (#1564)
    
    * Support short topic name in cpp client
    
    * Fix format issue
    
    * fix test
    
    * fix test failures
    
    * Fix format issue

 pulsar-client-cpp/lib/TopicName.cc           | 86 ++++++++++++++++++++++------
 pulsar-client-cpp/lib/TopicName.h            |  4 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc |  4 +-
 pulsar-client-cpp/tests/TopicNameTest.cc     | 36 ++++++++++++
 4 files changed, 111 insertions(+), 19 deletions(-)

commit 6b205160c339bc941a5d3f36a9d2ee6f2bd26823
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Apr 14 11:22:46 2018 -0700

    Reduce the contention on DispatcherSingleActiveConsumer by using a common thread for frequence operations (#1522)

 .../AbstractDispatcherSingleActiveConsumer.java    |  6 +-
 .../pulsar/broker/service/BrokerService.java       |  9 ++-
 .../org/apache/pulsar/broker/service/Consumer.java | 45 +++++++----
 .../service/nonpersistent/NonPersistentTopic.java  |  5 +-
 .../PersistentDispatcherSingleActiveConsumer.java  | 94 ++++++++++++++--------
 5 files changed, 103 insertions(+), 56 deletions(-)

commit afd438237632eb604a4aa549d0ec54410ad3a043
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 13 23:34:19 2018 -0700

    Fix for intermittent test failure in SubscriptionMessageDispatchThrottlingTest (#1576)

 .../client/api/SubscriptionMessageDispatchThrottlingTest.java       | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 4226d45249ac938599e76057082dcaf60e07275c
Author: cckellogg <cckellogg@gmail.com>
Date:   Fri Apr 13 23:33:43 2018 -0700

    Set admin brokers content type. (#1573)

 .../src/main/java/org/apache/pulsar/broker/admin/v1/Brokers.java       | 3 +++
 .../src/main/java/org/apache/pulsar/broker/admin/v2/Brokers.java       | 3 +++
 2 files changed, 6 insertions(+)

commit 2d4a35077e23c989fa41fed617984d0498d76ea4
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 13 23:32:21 2018 -0700

    Fixed BatchMessageTest intermittent failures (#1577)

 .../java/org/apache/pulsar/broker/service/BatchMessageTest.java  | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

commit 2267ed40c458132efe9d95f7f3c5fd5615c21131
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 13 17:57:19 2018 -0700

    Converted and duplicated AdminApiTest to v2 topics (#1574)
    
    * Converted and duplicated AdminApiTest to v2 topics
    
    * Fixed CreateSubscriptionTest

 .../authorization/PulsarAuthorizationProvider.java |   21 +-
 .../org/apache/pulsar/broker/PulsarService.java    |    5 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  132 +-
 .../broker/admin/impl/PersistentTopicsBase.java    |    7 +-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  111 +-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |   45 +
 .../broker/admin/v2/NonPersistentTopics.java       |  103 +
 .../pulsar/broker/admin/v2/PersistentTopics.java   |   13 +
 .../pulsar/broker/web/PulsarWebResource.java       |   24 +-
 .../apache/pulsar/broker/web/RestException.java    |    4 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  533 +++---
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |   72 +-
 .../broker/admin/CreateSubscriptionTest.java       |    8 +-
 .../pulsar/broker/admin/v1/V1_AdminApiTest.java    | 1966 ++++++++++++++++++++
 .../pulsar/broker/admin/v1/V1_AdminApiTest2.java   |  807 ++++++++
 .../pulsar/broker/service/ReplicatorTest.java      |   44 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |    8 +-
 .../broker/service/v1/V1_ReplicatorTest.java       |  935 ++++++++++
 .../broker/service/v1/V1_ReplicatorTestBase.java   |  375 ++++
 .../apache/pulsar/client/impl/RawReaderTest.java   |   22 +-
 .../service/web/DiscoveryServiceWebTest.java       |    8 +-
 .../kafka/compat/examples/ConsumerExample.java     |    2 +-
 .../kafka/compat/examples/ProducerExample.java     |    2 +-
 .../client/kafka/compat/tests/KafkaApiTest.java    |    2 +-
 .../kafka/compat/tests/KafkaConsumerTest.java      |    4 +-
 .../kafka/compat/tests/KafkaProducerTest.java      |    4 +-
 .../client/tutorial/ContinuousAsyncProducer.java   |    2 +-
 .../pulsar/client/tutorial/ContinuousProducer.java |    2 +-
 .../client/tutorial/SampleAsyncProducer.java       |    2 +-
 .../pulsar/client/tutorial/SampleConsumer.java     |    2 +-
 .../client/tutorial/SampleConsumerListener.java    |    2 +-
 .../client/tutorial/SampleCryptoConsumer.java      |    2 +-
 .../client/tutorial/SampleCryptoProducer.java      |    2 +-
 .../pulsar/client/tutorial/SampleProducer.java     |    2 +-
 .../server/ProxyConnectionThrottlingTest.java      |    4 +-
 .../org/apache/pulsar/storm/PulsarBoltTest.java    |    4 +-
 .../proxy/socket/client/PerformanceClient.java     |    2 +-
 .../pulsar/testclient/PerformanceConsumer.java     |    2 +-
 .../pulsar/testclient/PerformanceProducer.java     |    2 +-
 .../pulsar/testclient/PerformanceReader.java       |    2 +-
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |    2 +
 41 files changed, 4770 insertions(+), 521 deletions(-)

commit aa9e3065931bdad51cf83daeb4efcee96b761748
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sat Apr 14 09:10:05 2018 +0900

    Fix bug that WebSocket proxy returns empty metrics (#1567)

 .../websocket/proxy/ProxyPublishConsumeTest.java   | 12 +++++--
 .../apache/pulsar/websocket/stats/ProxyStats.java  | 40 ++++++++++++++++++----
 2 files changed, 42 insertions(+), 10 deletions(-)

commit 31dae050a79d38e44d6e81c817ad6aba1cd762f9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Apr 13 15:02:10 2018 -0700

    Provide unshaded pulsar-kafka-client (#1566)
    
    * Provide unshaded pulsar-kafka-client
    
    * update doc
    
    * comment on classes

 pulsar-client-kafka-compat/pom.xml                 |   1 +
 .../pulsar-client-kafka-shaded/pom.xml             | 196 +++++++++++++++++++++
 .../pulsar-client-kafka/pom.xml                    | 150 +---------------
 site/docs/latest/adaptors/KafkaWrapper.md          |  17 ++
 4 files changed, 217 insertions(+), 147 deletions(-)

commit fc67fe2c98eeb7c47023ff2dd29144972a4a693f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Apr 13 13:17:20 2018 -0700

    Introduce admin api to get broker and namespace-isolation policy map (#1565)
    
    * Introduce admin api to get broker and namespace-isolation policy map
    
    * add missed commit

 .../pulsar/broker/admin/impl/BrokersBase.java      |   2 +-
 .../pulsar/broker/admin/impl/ClustersBase.java     | 113 ++++++++++++++++++++-
 .../pulsar/broker/loadbalance/LoadManager.java     |  10 ++
 .../broker/loadbalance/ModularLoadManager.java     |   8 ++
 .../loadbalance/impl/ModularLoadManagerImpl.java   |   1 +
 .../impl/ModularLoadManagerWrapper.java            |   6 ++
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   5 +
 .../impl/SimpleResourceAllocationPolicies.java     |   3 +-
 .../pulsar/broker/namespace/NamespaceService.java  |   4 +-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  50 +++++++++
 .../org/apache/pulsar/client/admin/Clusters.java   |  23 +++++
 .../pulsar/client/admin/internal/ClustersImpl.java |  25 +++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  21 +++-
 .../admin/cli/CmdNamespaceIsolationPolicy.java     |  36 +++++++
 .../data/BrokerNamespaceIsolationData.java         |  39 +++++++
 15 files changed, 335 insertions(+), 11 deletions(-)

commit aba0d4247991c68d8d7bce21eaaeba4cb5cb1fb8
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Apr 13 12:48:38 2018 -0700

    moving function worker service to pulsar service (#1568)
    
    * moving function worker service to pulsar service
    
    * moving function worker service start routine to separate method

 .../org/apache/pulsar/PulsarBrokerStarter.java     |  10 --
 .../org/apache/pulsar/PulsarStandaloneStarter.java |   5 -
 .../org/apache/pulsar/broker/PulsarService.java    | 124 +++++++++++++++++++-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |   2 +-
 .../functions/worker/FunctionMetadataSetup.java    | 126 ---------------------
 .../org/apache/pulsar/functions/worker/Worker.java |  95 +++++++++++++++-
 .../pulsar/functions/worker/WorkerService.java     |  18 +--
 7 files changed, 217 insertions(+), 163 deletions(-)

commit 5c21b338b27b043a27d221ad9b252f8d346e786e
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 13 20:27:45 2018 +0200

    Compaction CLI integration test (#1572)
    
    Integration test to exercise CLI based compaction from end to end.

 .../single-cluster-3-bookie-2-broker.yaml          | 179 +++++++++++++++++++++
 tests/integration/compaction/pom.xml               |  47 ++++++
 .../pulsar/tests/integration/TestCompaction.java   | 103 ++++++++++++
 .../compaction/src/test/resources/arquillian.xml   |  32 ++++
 tests/integration/pom.xml                          |   1 +
 5 files changed, 362 insertions(+)

commit ac2721fb8127283f6623f5999437da299a4c4ee6
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 13 11:22:22 2018 -0700

    Converted to v2 topic names test related to ProducerConsumerBase (#1562)
    
    * Converted to v2 topic names test related to ProducerConsumerBase
    
    * Added comment around v2 lookup API marker
    
    * Fixed proxy tests
    
    * Fixed BatchMessageTest
    
    * Fixed ProxyForwardAuthDataTest and ProxyRolesEnforcementTest

 .../apache/pulsar/broker/admin/v2/Namespaces.java  |   2 +-
 .../apache/pulsar/broker/lookup/LookupResult.java  |   6 +-
 .../{TopicLookup.java => TopicLookupBase.java}     | 141 ++++++-------
 .../pulsar/broker/lookup/v1/TopicLookup.java       |  76 +++++++
 .../pulsar/broker/lookup/v2/TopicLookup.java       |  65 ++++++
 .../apache/pulsar/broker/service/ServerCnx.java    |   2 +-
 .../common/naming/NamespaceBundleFactory.java      |   2 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   2 +-
 .../broker/lookup/http/HttpTopicLookupv2Test.java  |   2 +-
 .../namespace/NamespaceCreateBundlesTest.java      |   2 +-
 .../broker/namespace/NamespaceUnloadingTest.java   |  18 +-
 .../broker/service/BacklogQuotaManagerTest.java    |  63 +++---
 .../pulsar/broker/service/BatchMessageTest.java    |  22 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |  42 ++--
 .../pulsar/broker/service/BrokerTestBase.java      |   7 +-
 .../broker/service/PersistentTopicE2ETest.java     |  88 ++++----
 .../broker/service/TopicTerminationTest.java       |   2 +-
 .../api/AuthenticatedProducerConsumerTest.java     |  38 ++--
 .../AuthenticationTlsHostnameVerificationTest.java |  12 +-
 .../api/AuthorizationProducerConsumerTest.java     |  22 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |  12 +-
 .../pulsar/client/api/ClientDeduplicationTest.java |  12 +-
 .../client/api/DispatcherBlockConsumerTest.java    |  28 +--
 .../client/api/MessageDispatchThrottlingTest.java  |  46 ++---
 .../pulsar/client/api/NonPersistentTopicTest.java  |  22 +-
 .../api/PartitionedProducerConsumerTest.java       |  22 +-
 .../pulsar/client/api/ProducerConsumerBase.java    |  13 +-
 .../client/api/SimpleProducerConsumerTest.java     | 136 ++++++------
 .../SubscriptionMessageDispatchThrottlingTest.java |  28 +--
 .../pulsar/client/api/TlsProducerConsumerBase.java |   2 +-
 .../apache/pulsar/client/api/TopicReaderTest.java  |  42 ++--
 .../client/api/v1/V1_ProducerConsumerBase.java     |  57 ++++++
 .../client/api/v1/V1_ProducerConsumerTest.java     |   9 +-
 .../client/impl/BrokerClientIntegrationTest.java   |  20 +-
 .../client/impl/CompactedOutBatchMessageTest.java  |  10 +-
 .../client/impl/ConsumeBaseExceptionTest.java      |   4 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  67 +++---
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |  13 +-
 .../stats/client/PulsarBrokerStatsClientTest.java  |   2 +-
 .../websocket/proxy/ProxyAuthenticationTest.java   |  16 +-
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  53 ++---
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    |  12 +-
 .../proxy/v1/V1_ProxyAuthenticationTest.java       | 228 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  22 ++
 .../pulsar/client/admin/internal/LookupImpl.java   |  26 ++-
 .../client/admin/internal/NamespacesImpl.java      |  45 +++-
 .../pulsar/client/impl/HttpLookupService.java      |  16 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |  10 +-
 .../proxy/server/ProxyForwardAuthDataTest.java     |  15 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |  19 +-
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   4 +-
 ...roxyStats.java => WebSocketProxyStatsBase.java} |  70 ++-----
 .../websocket/admin/WebSocketWebResource.java      |  11 +-
 .../websocket/admin/v1/WebSocketProxyStatsV1.java  |  73 +++++++
 .../websocket/admin/v2/WebSocketProxyStatsV2.java  |  72 +++++++
 .../pulsar/websocket/service/ProxyServer.java      |   2 +-
 .../websocket/service/WebSocketServiceStarter.java |  17 +-
 57 files changed, 1240 insertions(+), 630 deletions(-)

commit 5d2c038f6faabea6d6b09c287efa3a30608a71f7
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 13 17:52:48 2018 +0200

    Increase integration test service wait default timeouts (#1569)
    
    The integration tests have a set utility methods to wait for all
    brokers or all proxy nodes to come up.
    
    The timeout on these were set to 10 seconds, which was a bit short for a
    heavily loaded machine, as can be common in CI. Increased to 60 seconds.

 .../src/main/java/org/apache/pulsar/tests/PulsarClusterUtils.java   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 616e2a278f11161aa91689cf20eecef9c572a3b9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 12 21:28:40 2018 -0700

    Added Kafka Source and Kafka Sink to Pulsar Connect (#1557)
    
    * Added Kafka Source and Kafka Sink to Pulsar Connect
    
    * Standardize on kafka versions for compat and connect

 pom.xml                                            |   1 +
 .../pulsar-client-kafka/pom.xml                    |   6 +-
 pulsar-connect/kafka/pom.xml                       |  67 +++++++++++
 .../org/apache/pulsar/connect/kafka/KafkaSink.java |  93 +++++++++++++++
 .../pulsar/connect/kafka/KafkaSinkConfig.java      |  59 ++++++++++
 .../apache/pulsar/connect/kafka/KafkaSource.java   | 126 +++++++++++++++++++++
 .../pulsar/connect/kafka/KafkaSourceConfig.java    |  61 ++++++++++
 pulsar-connect/pom.xml                             |   1 +
 8 files changed, 409 insertions(+), 5 deletions(-)

commit 9f62c3a29ba4da541f338d86572f55c332208283
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 12 16:23:31 2018 -0700

    Added RabbitMQ source to Pulsar Connect (#1563)

 pom.xml                                            |  1 +
 pulsar-connect/pom.xml                             |  1 +
 pulsar-connect/rabbitmq/pom.xml                    | 67 ++++++++++++++++
 .../pulsar/connect/rabbitmq/RabbitMQConfig.java    | 55 +++++++++++++
 .../pulsar/connect/rabbitmq/RabbitMQSource.java    | 89 ++++++++++++++++++++++
 5 files changed, 213 insertions(+)

commit 18ef01a1b035730a5a8b5ad479869131012e72b6
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Apr 12 14:25:04 2018 -0700

    Make client keepAliveInterval configurable in client side (#1547)
    
    * make client keepAliveInterval configurable
    
    * add client builder for config
    
    * change to use TimeUnit

 .../src/main/java/org/apache/pulsar/client/api/ClientBuilder.java | 8 ++++++++
 .../java/org/apache/pulsar/client/impl/ClientBuilderImpl.java     | 6 ++++++
 .../src/main/java/org/apache/pulsar/client/impl/ClientCnx.java    | 2 +-
 .../apache/pulsar/client/impl/conf/ClientConfigurationData.java   | 1 +
 4 files changed, 16 insertions(+), 1 deletion(-)

commit 61de30d09488395e3c19cf9232e755528a52d342
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Apr 12 14:17:33 2018 -0700

    Issue #1536: Introduce Short Topic Name (#1535)
    
    This closes #1536

 .../apache/pulsar/PulsarClusterMetadataSetup.java  | 52 ++++++++++++++++++++++
 .../org/apache/pulsar/PulsarStandaloneStarter.java | 21 ++++++++-
 .../org/apache/pulsar/common/naming/TopicName.java | 30 ++++++++++---
 .../apache/pulsar/common/naming/TopicNameTest.java | 49 +++++++++++++++-----
 4 files changed, 134 insertions(+), 18 deletions(-)

commit 1fc4b35b5988936ef57f6f7e109e9afd23c138a8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Apr 12 11:50:31 2018 -0700

    Honor User specified Subscription Types while running functions (#1560)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 7 +++++++
 .../pulsar/functions/instance/processors/MessageProcessor.java   | 4 +++-
 pulsar-functions/instance/src/main/python/python_instance.py     | 9 ++++++---
 .../instance/src/main/python/python_instance_main.py             | 2 ++
 .../org/apache/pulsar/functions/runtime/JavaInstanceMain.java    | 4 ++++
 .../java/org/apache/pulsar/functions/runtime/ProcessRuntime.java | 2 ++
 .../org/apache/pulsar/functions/runtime/ProcessRuntimeTest.java  | 6 ++++--
 .../java/org/apache/pulsar/functions/utils/FunctionConfig.java   | 3 ++-
 8 files changed, 30 insertions(+), 7 deletions(-)

commit 9ceedee8064a0820afba2cc9de27bdfd7189eac6
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Apr 12 20:49:38 2018 +0200

    Utility for integration tests to wait for ZK (#1561)
    
    Utility to allow an integration test to wait for zookeeper to come up
    before proceeding.

 .../apache/pulsar/tests/PulsarClusterUtils.java    | 25 ++++++++++++++++++++++
 1 file changed, 25 insertions(+)

commit fafc9632c6f7facc1ce703ee7db9e6248abec345
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Apr 12 11:06:06 2018 -0700

    Documentation for non-persistent topics (#1468)
    
    * add entries to C&A doc, config docs, etc., plus new cookbook
    
    * merge information from C&A doc into include
    
    * reshuffle existing material
    
    * Finish draft of NPT cookbook
    
    * clean up C+A section
    
    * clean up client API section
    
    * Change name of doc and update links
    
    * change name of cookbook in C+A doc

 site/_data/config/broker.yaml                      |  6 ++
 site/_data/sidebar.yaml                            |  2 +
 .../explanations/non-persistent-topics.md          | 62 ++------------------
 site/_includes/topic.html                          |  2 +-
 .../latest/cookbooks/non-persistent-messaging.md   | 66 ++++++++++++++++++++++
 .../getting-started/ConceptsAndArchitecture.md     | 58 +++++++++++++++++--
 6 files changed, 133 insertions(+), 63 deletions(-)

commit 2de50a762628647fcf1b7873b325fb1103c2b198
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Apr 12 10:26:45 2018 -0700

    Issue #1517: make getLastConfirmedEntry in ManagedLedgerImpl return real LAC (#1550)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 12 ++++
 .../apache/pulsar/client/api/TopicReaderTest.java  | 72 ++++++++++++++++------
 2 files changed, 66 insertions(+), 18 deletions(-)

commit 199961ef56e6f8cd1073245480b85e283987a95f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Apr 12 09:59:23 2018 -0700

    Use `AtomicInteger` in LoggingFunction (#1558)
    
    * Add `counter` back in LoggingFunction
    
    * Switch to use AtomicInteger

 .../org/apache/pulsar/functions/api/examples/LoggingFunction.java  | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit 1c9c07428b6281b88c56ebeed5f595cf7dafabda
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Apr 12 18:39:13 2018 +0200

    Allow proxy to come up before any brokers have (#1559)
    
    If no brokers have come up, then /loadbalance/brokers will not have
    been created. Previously, if a proxy came up at this point, it would
    get a NoNodeException when it tried to watch the children of this
    path, and the proxy itself would hang.
    
    This change modifies the ZooKeeper cache, so that if you try to
    getChildren on a node that doesn't exist, a watcher on that path's
    existance will be created before the NoNodeException is thrown.
    
    Callers can then call getChildren with a watcher, and expect the
    watcher to trigger when the the node is created and has another node
    created below it.

 .../proxy/server/util/ZookeeperCacheLoader.java    | 13 ++---
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    | 15 +++++-
 .../pulsar/zookeeper/ZookeeperCacheTest.java       | 58 ++++++++++++++++++++++
 3 files changed, 78 insertions(+), 8 deletions(-)

commit 3fbb4c930f76c2e5fef1def8d23831911c8f78e9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Apr 12 02:40:10 2018 -0700

    renaming/changing FunctionConfig (#1552)
    
    * renaming/changing FunctionConfig
    
    * adding missing license header
    
    * moving FunctionConfig to different module

 .../pulsar/broker/admin/impl/FunctionsBase.java    |   8 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  12 +-
 .../client/admin/internal/FunctionsImpl.java       |  26 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  16 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 262 +++++++----
 .../pulsar/functions/instance/ContextImpl.java     |  14 +-
 .../pulsar/functions/instance/InstanceConfig.java  |   4 +-
 .../pulsar/functions/instance/JavaInstance.java    |   2 +-
 .../functions/instance/JavaInstanceRunnable.java   | 106 ++---
 .../instance/processors/AtLeastOnceProcessor.java  |   8 +-
 .../instance/processors/AtMostOnceProcessor.java   |  10 +-
 .../processors/EffectivelyOnceProcessor.java       |  12 +-
 .../instance/processors/MessageProcessor.java      |  18 +-
 .../instance/processors/MessageProcessorBase.java  |  22 +-
 .../instance/src/main/python/Function_pb2.py       | 248 +++++------
 .../instance/src/main/python/python_instance.py    |  42 +-
 .../src/main/python/python_instance_main.py        |  28 +-
 .../instance/JavaInstanceRunnableProcessTest.java  | 484 ++++++++++-----------
 .../instance/JavaInstanceRunnableTest.java         |  12 +-
 .../functions/instance/JavaInstanceTest.java       |  10 +-
 .../pulsar/functions/metrics/MetricsSink.java      |   7 +-
 .../pulsar/functions/metrics/sink/FileSink.java    |   6 +-
 .../functions/metrics/sink/PrometheusSink.java     |  12 +-
 .../metrics/sink/PrometheusSinkTests.java          |  36 +-
 .../proto/src/main/proto/Function.proto            |   4 +-
 ...ionConfigTest.java => FunctionDetailsTest.java} |  10 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  36 +-
 .../pulsar/functions/runtime/ProcessRuntime.java   |  48 +-
 .../functions/runtime/ProcessRuntimeFactory.java   |   4 +-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |   2 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    |   6 +-
 .../functions/runtime/ProcessRuntimeTest.java      |  68 +--
 .../pulsar/functions/utils/FunctionConfig.java     |  74 ++++
 ...nConfigUtils.java => FunctionDetailsUtils.java} |  49 +--
 .../pulsar/functions/worker/FunctionActioner.java  |  18 +-
 .../functions/worker/FunctionMetaDataManager.java  |  42 +-
 .../functions/worker/FunctionRuntimeManager.java   |  18 +-
 .../functions/worker/FunctionsStatsGenerator.java  |   6 +-
 .../pulsar/functions/worker/MembershipManager.java |  14 +-
 .../pulsar/functions/worker/SchedulerManager.java  |   2 +-
 .../org/apache/pulsar/functions/worker/Utils.java  |   6 +-
 .../functions/worker/rest/api/FunctionsImpl.java   |  74 ++--
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |   8 +-
 .../worker/FunctionMetaDataManagerTest.java        |  44 +-
 .../worker/FunctionRuntimeManagerTest.java         |  26 +-
 .../worker/FunctionStatsGeneratorTest.java         |   4 +-
 .../functions/worker/MembershipManagerTest.java    |  25 +-
 .../functions/worker/SchedulerManagerTest.java     |  30 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  62 +--
 49 files changed, 1083 insertions(+), 1002 deletions(-)

commit aff6c04b156cffaf5b96e05afda5e096fbe34729
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 12 02:39:31 2018 -0700

    Fixed race condition intruduced managed ledger addEntry introduced in #1521 (#1548)

 .../org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java     | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 0fd4e84e2f5ee9cbfff729bfef0fd00933a83e9b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 11 23:48:35 2018 -0700

    remove unnecessary proto def in FunctionsConfig (#1531)

 pulsar-functions/proto/src/main/proto/Function.proto | 3 ---
 1 file changed, 3 deletions(-)

commit 3428d498e3438a24defa279f45648b3be32b38a4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Apr 11 22:03:27 2018 -0700

    fixing and standardizing logging in functions (#1556)
    
    * fixing and standardizing logging in functions
    
    * fix unit tests

 pulsar-functions/instance/src/main/python/log.py                 | 9 +++++++++
 .../instance/src/main/python/python_instance_main.py             | 5 ++++-
 pulsar-functions/instance/src/main/python/util.py                | 3 +++
 .../apache/pulsar/functions/runtime/ProcessRuntimeFactory.java   | 1 +
 .../runtime/src/main/resources/java_instance_log4j2.yml          | 6 +++---
 .../org/apache/pulsar/functions/runtime/ProcessRuntimeTest.java  | 4 ++--
 6 files changed, 22 insertions(+), 6 deletions(-)

commit e33795b7ce43a908d2e9d285d66e07cf21626510
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Apr 11 22:02:11 2018 -0700

    Fix: handle invalid markDelete position at managed-cursor (#1554)
    
    * Fix: handle invalid markDelete position at managed-cursor
    
    * Fix position validation

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 22 ++++++++-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 56 ++++++++++++++++++++++
 2 files changed, 77 insertions(+), 1 deletion(-)

commit 3516aa4415e8d5fda8c6eabcd696d2b62351cbdd
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Apr 11 12:17:59 2018 +0200

    offloadPrefix interface for ManagedLedger (#1543)
    
    Method to offload a prefix of a managed ledger to longterm storage.
    
    Depends on a LedgerOffloader having been provided to the ManagedLedgerConfig.
    This patch only contains the interface definitions. Implementation and testing
    will follow in a separate patch.
    
    Master issue #1511

 .../apache/bookkeeper/mledger/AsyncCallbacks.java  |  5 +++
 .../apache/bookkeeper/mledger/ManagedLedger.java   | 26 ++++++++++++++++
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 36 ++++++++++++++++++++++
 3 files changed, 67 insertions(+)

commit 16bfc441bcaee5073b70b8a97614071647b3f60e
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Apr 11 12:16:09 2018 +0200

    LedgerOffloader interface for ManagedLedger (#1542)
    
    An interface which can be used for offloading ledgers to longterm
    storage.
    
    Master issue #1511

 .../apache/bookkeeper/mledger/LedgerOffloader.java | 81 ++++++++++++++++++++++
 .../bookkeeper/mledger/ManagedLedgerConfig.java    | 24 +++++++
 .../mledger/impl/NullLedgerOffloader.java          | 54 +++++++++++++++
 3 files changed, 159 insertions(+)

commit e370b976649d761042c4b112cea4b6107ee38dd7
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Apr 10 20:45:15 2018 -0700

    Added Aerospike Sink (#1545)

 pom.xml                                            |   1 +
 pulsar-connect/aerospike/pom.xml                   |  67 +++++++++
 .../pulsar/connect/aerospike/AerospikeSink.java    | 151 +++++++++++++++++++++
 .../connect/aerospike/AerospikeSinkConfig.java     |  64 +++++++++
 pulsar-connect/pom.xml                             |   1 +
 5 files changed, 284 insertions(+)

commit 22e45e70c593118af849a17cad2c2de433344625
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Apr 10 20:14:51 2018 -0700

    Refactor JavaInstanceRunnable (#1533)
    
    *Motivation*
    
    EffectivelyOnce processing made `JavaInstanceRunnable` very complicated. There are tons of braching logic. It makes code hard to maintain.
    
    *Solution*
    
    Abstract the processing guarantee related logic into a `MessageProcessor` interface. Implement `at-most-once`, `at-least-once` and `effectively-once` processors.
    
    *Result*
    
    After this change, `JavaInstanceRunnable` is much cleaner. `At-Least-Once` and `At-Most-Once` logic are much simpler and easier to debug.

 .../pulsar/functions/instance/InputMessage.java    |  56 ++++
 .../functions/instance/JavaInstanceRunnable.java   | 342 +++------------------
 .../instance/processors/AtLeastOnceProcessor.java  |  78 +++++
 .../instance/processors/AtMostOnceProcessor.java   |  82 +++++
 .../processors/EffectivelyOnceProcessor.java       | 273 ++++++++++++++++
 .../instance/processors/MessageProcessor.java      | 145 +++++++++
 .../instance/processors/MessageProcessorBase.java  | 167 ++++++++++
 .../producers/AbstractOneOuputTopicProducers.java  |  14 +-
 .../producers/SimpleOneOuputTopicProducers.java    |  63 ----
 .../instance/JavaInstanceRunnableProcessTest.java  |  16 +-
 .../SimpleOneOutputTopicProducersTest.java         |  94 ------
 11 files changed, 856 insertions(+), 474 deletions(-)

commit ede7ffe540b4ea8c715c3af9f30f739ea133da94
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 10 18:03:52 2018 -0700

    Fix for cursorPersistenceAsyncMarkDeleteSameThread (#1544)

 .../org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java    | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 884b1d1d966eea75bb060eebcfada9d761d20c21
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Apr 10 16:46:41 2018 -0700

    Pulsar Functions triggering overview (#1503)
    
    * Add brief section to overview on processing guarantees
    
    * add new sections to overview
    
    * add basic PF diagram
    
    * add word count diagram
    
    * add two new examples to overview
    
    * add triggering section to overview
    
    * change section ID

 site/docs/latest/functions/deployment.md |  4 ++--
 site/docs/latest/functions/overview.md   | 31 ++++++++++++++++++++++++++++---
 2 files changed, 30 insertions(+), 5 deletions(-)

commit 4f3ac369ca31888508b791ccd34d8821d8bb9157
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Apr 10 15:27:59 2018 -0700

    Implement Cassandra Sink (#1534)
    
    * Added Cassandra Sink Connector

 pom.xml                                            |   1 +
 .../org/apache/pulsar/common/util/KeyValue.java    |  48 ++++++++++
 pulsar-connect/cassandra/pom.xml                   |  67 +++++++++++++
 .../pulsar/connect/cassandra/CassandraSink.java    | 105 +++++++++++++++++++++
 .../connect/cassandra/CassandraSinkConfig.java     |  57 +++++++++++
 pulsar-connect/pom.xml                             |   1 +
 6 files changed, 279 insertions(+)

commit 770ddf088c924f6e6c992ba583b4d7138186d223
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Apr 10 23:09:01 2018 +0200

    Compaction sets read compacted flag when reading (#1540)
    
    Previously compaction would read the whole backlog again, even though
    what was in the compacted topic ledger was sufficient for its
    purposes. This patch flips the switch.

 .../apache/pulsar/client/impl/RawReaderImpl.java   |   1 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   4 +-
 .../apache/pulsar/compaction/CompactionTest.java   | 112 ++++++++++++++++++++-
 3 files changed, 114 insertions(+), 3 deletions(-)

commit b22769bb57defe435cc4faedcbebe1d3260cdee4
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 10 12:33:22 2018 -0700

    Fixed flaky test in managed ledger close path (#1539)
    
    * Fixed flaky test in managed ledger close path: ManagedLedgerBkTest.managedLedgerClosed
    
    * Fixed cursorPersistenceAsyncMarkDeleteSameThread test

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  5 ++++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 26 +++++++++++-----------
 2 files changed, 17 insertions(+), 14 deletions(-)

commit f4300bdfed8403d17707f8a796c044a024c178f6
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Apr 11 02:31:52 2018 +0900

    Log warn message if exception occurs while WebSocket proxy is sending/receiving message (#1537)

 .../main/java/org/apache/pulsar/websocket/ConsumerHandler.java   | 9 +++++++++
 .../main/java/org/apache/pulsar/websocket/ProducerHandler.java   | 2 ++
 .../src/main/java/org/apache/pulsar/websocket/ReaderHandler.java | 9 +++++++--
 3 files changed, 18 insertions(+), 2 deletions(-)

commit 9525047d82e2d6105f4de28bc69d36ebcb04b579
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Apr 10 10:31:37 2018 -0700

    Fix for FQFN flag (#1528)
    
    * move fqfn flag into proper command base
    
    * Extend FunctionCommand from BaseCommand rather than NamespaceCommand
    
    * clean up input topics function
    
    * Add special processArguments function for FunctionCommand
    
    * Match wording of error output across commands
    
    * Add checks for tenant, namespace, and function name

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 77 ++++++++++++++++------
 1 file changed, 56 insertions(+), 21 deletions(-)

commit ab67386b966ab92b55e70bef4a48d265a07f509a
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Apr 10 18:56:45 2018 +0200

    Managed ledger uses ReadHandle in read path (#1513)
    
    * Managed ledger uses ReadHandle in read path
    
    BookKeeper 4.6 introduced a new API for reading, called
    ReadHandle. This API is an small interface, unlike LedgerHandle, so it
    is possible to provide implementations of ReadHandle that read from
    sources other than bookkeeper, while presenting the same interface as
    when reading from bookkeeper.
    
    This patch changes the managed ledger entry read path to use
    ReadHandle. This is rquired to implement tiered storage (PIP-17).
    
    Master issue: 1511
    
    * Use whenCompleteAsync and chooseThread where possible
    
    To avoid creating yet another runnable.
    
    * Fix failing BrokerBkEnsembleTest
    
    And another merge conflict.

 .../bookkeeper/mledger/ManagedLedgerConfig.java    |   2 +-
 .../apache/bookkeeper/mledger/impl/EntryCache.java |   6 +-
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    | 136 +++++++++++----------
 .../bookkeeper/mledger/impl/EntryCacheManager.java |  56 ++++-----
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |   2 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   6 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  75 +++++++-----
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |   5 +-
 .../bookkeeper/mledger/impl/EntryCacheTest.java    |  56 ++++-----
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |   3 +-
 .../mledger/impl/ManagedLedgerBkTest.java          |   9 +-
 .../mledger/impl/ManagedLedgerErrorsTest.java      |   2 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |   2 +-
 .../PulsarConfigurationLoaderTest.java             |   2 +-
 .../service/schema/BookkeeperSchemaStorage.java    |   4 +-
 .../pulsar/testclient/ManagedLedgerWriter.java     |   2 +-
 16 files changed, 190 insertions(+), 178 deletions(-)

commit dc9a9dc808dcea35d5570ad5c6d8d22183ce0a7d
Author: cckellogg <cckellogg@gmail.com>
Date:   Mon Apr 9 19:23:32 2018 -0700

    Fix delete topic check and provide better error message. (#1529)
    
    * Fix delete topic check and provide better error message.
    
    * Update error message.
    
    * Update log to match exception.

 .../org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java   | 6 ++++--
 .../apache/pulsar/broker/service/persistent/PersistentTopic.java    | 2 +-
 2 files changed, 5 insertions(+), 3 deletions(-)

commit 027b424fd914db306bc3a9223ca2b36030421ce8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Apr 9 17:08:06 2018 -0700

    Pulsar Connect (#1520)
    
    * Added Pulsar Connect interfaces that define connectors that push data into pulsar and take data from pulsar
    
    * Added Twitter connector
    
    * Added hbc core version mapping
    
    * Addressed comments
    
    * Fixed build
    
    * Fixed license header

 pom.xml                                            |   3 +
 pulsar-connect/core/pom.xml                        |  33 ++++
 .../org/apache/pulsar/connect/core/PushSource.java |  52 +++++++
 .../java/org/apache/pulsar/connect/core/Sink.java  |  49 ++++++
 pulsar-connect/pom.xml                             |  39 +++++
 pulsar-connect/twitter/pom.xml                     |  61 ++++++++
 .../pulsar/connect/twitter/TwitterFireHose.java    | 167 +++++++++++++++++++++
 .../connect/twitter/TwitterFireHoseConfig.java     |  63 ++++++++
 8 files changed, 467 insertions(+)

commit 99bd812e000510a86fd39fca396fc058fc27f673
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Apr 9 15:58:15 2018 -0700

    remove unused proto declaration (#1530)

 pulsar-functions/proto/src/main/proto/Function.proto | 5 -----
 1 file changed, 5 deletions(-)

commit ed8d1a5d39b5bde796954e79feda579dc7f64c2f
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 9 13:55:12 2018 -0700

    Avoid contention in ManagedCursorImpl generated by locking on pendingMarkDeleteOps (#1519)

 managed-ledger/pom.xml                             |  11 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 151 ++++++++++-----------
 pom.xml                                            |   7 +
 3 files changed, 88 insertions(+), 81 deletions(-)

commit ad90ac6463681f7358f3f331a8440dbcfcd34258
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 9 12:43:01 2018 -0700

    Removed contention between producers on ManagedLedger addEntry (#1521)

 .../apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java | 15 +++++++++++----
 .../org/apache/bookkeeper/mledger/impl/OpReadEntry.java   |  2 +-
 2 files changed, 12 insertions(+), 5 deletions(-)

commit 951d4d3805ad0b7365aa83bfb5001c6513ddff68
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Apr 9 21:39:25 2018 +0200

    Compaction considers messages with empty payload as deleting the key (#1525)
    
    If the latest message with a key has an empty payload, compaction
    will take this to mean that the key has been deleted, so it will not
    be stored in the compacted topic ledger.
    
    This patch also introduces empty messages, which were not previously
    possible.

 .../pulsar/client/impl/RawBatchConverter.java      |  3 +-
 .../pulsar/compaction/TwoPhaseCompactor.java       | 18 +++---
 .../apache/pulsar/compaction/CompactionTest.java   | 68 ++++++++++++++++++++++
 .../pulsar/client/impl/MessageBuilderImpl.java     |  4 +-
 4 files changed, 82 insertions(+), 11 deletions(-)

commit da1a11043c9e4591c6c5c1d8e6434ccc59b913b0
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 9 10:19:00 2018 -0700

    Use signSafeMod in RoundRobinPartitionMessageRouter (#1523)
    
    * Use signSafeMod in RoundRobinPartitionMessageRouter
    
    * Added test with mocked clock
    
    * Fixed tests
    
    * Fixed functions test

 .../client/impl/PartitionedProducerImpl.java       |  2 +-
 .../impl/RoundRobinPartitionMessageRouterImpl.java | 27 ++++---
 .../impl/SinglePartitionMessageRouterImpl.java     |  4 +-
 .../org/apache/pulsar/client/util/MathUtils.java   | 41 ++++++++++
 .../RoundRobinPartitionMessageRouterImplTest.java  | 91 ++++++++++++++++++----
 .../functions/instance/FunctionResultRouter.java   |  9 ++-
 .../instance/FunctionResultRouterTest.java         | 31 ++++----
 7 files changed, 158 insertions(+), 47 deletions(-)

commit 8ad606b0c7173a991df540855c588072f5ab5c34
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Apr 8 09:12:39 2018 -0700

    Issue 1510: java.lang.IllegalArgumentException on refreshing stats (#1524)

 .../bookkeeper/mledger/impl/ManagedLedgerFactoryMBeanImpl.java       | 5 +++++
 .../src/main/java/org/apache/bookkeeper/mledger/util/Rate.java       | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)

commit 3ae511518558499729ea9ac2154b183718fc0668
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Apr 6 16:33:10 2018 -0700

    Added test to ensure property name can contain '_' characters. (#1516)

 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 37 ++++++++++++++++++++++
 .../apache/pulsar/common/naming/NamedEntity.java   | 11 ++-----
 .../apache/pulsar/common/naming/TopicDomain.java   |  4 +--
 .../org/apache/pulsar/common/naming/TopicName.java |  8 ++---
 4 files changed, 46 insertions(+), 14 deletions(-)

commit 1eb80681700a8dcf268f06b5f227033cd1165bb4
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Fri Apr 6 16:50:19 2018 -0600

    Schema registry 4/N (#1381)
    
    * Schema Registry proto changes
    
    * Infrastructure to store schemas
    
    * A default schema registry implementation
    
    * Add admin api for the schema registry
    
    * Renumber schema fields
    
    * Update Pulsar API with schema changes
    
    * Revert field number change
    
    * Fix merge conflict
    
    * Fix broken merge
    
    * DestinationName has been renamed to TopicName
    
    * Address issues in review
    
    * Add schema type back to proto definition
    
    * Address comments regarding lombok usage
    
    * Remove reserved future enum fields
    
    * regenerate code from protobuf
    
    * Remove unused code
    
    * Add schema version to producer success message
    
    * plumb schema through to producer
    
    * Revert "Add schema version to producer success message"
    
    This reverts commit e7e72f468cf46f1605524a7399520c22763583c9.
    
    * Revert "Revert "Add schema version to producer success message""
    
    This reverts commit 7b902f6bdb1cb054e26577747ff4dd8c326a6248.
    
    * Persist schema on producer connect
    
    * Add principal to schema on publish
    
    * Reformat function for readability
    
    * Remove unused protoc profile
    
    * Rename put on schema registry to putIfAbsent
    
    * Reformat function for readability
    
    * Remove unused protoc profile
    
    * Rename put on schema registry to putIfAbsent
    
    * fix compile errors from parent branch changes
    
    * fix lombok tomfoolery on builder
    
    * plumb hash through and allow lookup by data
    
    * wip
    
    * run tests
    
    * wip: address review comments
    
    * switch underscore to slash in schema name
    
    * blah
    
    * Get duplicate schema detection to work
    
    * Fix protobuf version incompatibility
    
    * fix merge issues
    
    * Fix license headers
    
    * Fix license headers
    
    * Address review
    
    * Fix webservice
    
    * plumb schema from producer to server and back
    
    * Plumb schema through subscriber
    
    * Create and return schema via rest endpoint
    
    * Make DELETE great again
    
    * Clean up imports
    
    * Move resource objects to common package
    
    * Fix licenses
    
    * Update error message for schema registry service
    
    * Remove cruft
    
    * Address review comments
    
    - rename props to properties in GetSchemaResponse
    - Use config for ledger parameters
    
    * Address review comments
    
    * Fix license headers
    
    * deal with lombock stuff causing issues
    
    * Resolve conflict

 .../pulsar/broker/admin/v2/SchemasResource.java    | 242 +++++++++++++++++++++
 .../service/schema/BookkeeperSchemaStorage.java    |  29 ++-
 .../service/schema/SchemaRegistryService.java      |   3 +-
 .../broker/service/schema/SchemaStorage.java       |   2 +
 .../pulsar/broker/service/schema/StoredSchema.java |  11 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  28 ++-
 .../java/org/apache/pulsar/client/api/Schema.java  |   9 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  49 ++---
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  15 +-
 .../pulsar/client/impl/ProducerResponse.java       |  30 +++
 .../org/apache/pulsar/common/api/Commands.java     |  51 ++++-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 112 ++--------
 .../pulsar/common/schema/DeleteSchemaResponse.java |  28 +++
 .../pulsar/common/schema/GetSchemaResponse.java    |  33 +++
 .../pulsar/common/schema/PostSchemaPayload.java    |  29 +++
 .../pulsar/common/schema/PostSchemaResponse.java   |  28 +++
 .../apache/pulsar/common/schema/SchemaInfo.java    |  30 +++
 pulsar-common/src/main/proto/PulsarApi.proto       |   2 +-
 19 files changed, 583 insertions(+), 150 deletions(-)

commit cc28dd027f02249233e37b73ca08e5e49a8069ae
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 6 23:36:32 2018 +0200

    Readme for integration tests (#1518)

 tests/README.md | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit 346f8312484cc4389d96f2aeefc0be6393c4fcc2
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 6 23:35:56 2018 +0200

    Compaction allows keyless messages to pass through (#1514)
    
    If a message has no key it's impossible to know if a later message
    supercedes it, so in this case, it should be simply passed through
    compaction (i.e. it should appear when reading from a compacted
    topic).

 .../pulsar/client/impl/RawBatchConverter.java      |  7 ++-
 .../pulsar/compaction/TwoPhaseCompactor.java       | 14 ++++-
 .../apache/pulsar/compaction/CompactionTest.java   | 70 ++++++++++++++++++++++
 3 files changed, 86 insertions(+), 5 deletions(-)

commit 6f36aeea72178014d5aed980f38585726ca588d7
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 6 23:12:17 2018 +0200

    Rest endpoint to query compaction status (#1501)
    
    Currently returns whether compaction has not run, is running, is
    complete or has failed. If it has failed, the last error is returned
    also.

 .../broker/admin/impl/PersistentTopicsBase.java    |  7 +++
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 14 ++++++
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 15 +++++++
 .../broker/service/persistent/PersistentTopic.java | 24 ++++++++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 36 +++++++++++++++
 .../pulsar/client/admin/PersistentTopics.java      |  8 ++++
 .../admin/internal/PersistentTopicsImpl.java       | 13 ++++++
 .../pulsar/common/compaction/CompactionStatus.java | 52 ++++++++++++++++++++++
 8 files changed, 169 insertions(+)

commit c2fb7958391f60702d00ef5bd2bc7c982b9cb188
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 6 23:11:37 2018 +0200

    Also log bookkeeper (and managed ledger) in tests (#1512)
    
    Root level is warn, so we need to explicitly set org.apache.bookkeeper
    to info to see the logs.

 buildtools/src/main/resources/log4j2.xml | 1 +
 1 file changed, 1 insertion(+)

commit 9d23892568e4158c04417bab027dae7fc8b6eebc
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Apr 6 12:34:47 2018 -0700

    Enable FQFN specification for the Pulsar Functions CLI (#1504)
    
    * Add FQFN flag plus corresponding test
    
    * add fqfn field to function config protobuf definition
    
    * add section in PF overview on FQFNs
    
    * add missing --jar flag to test
    
    * remove unnecessary imports
    
    * add missing license header
    
    * add final missing import
    
    * remove incomplete line
    
    * make FQFN name check more stringent

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 25 ++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 45 ++++++++++++++++------
 .../proto/src/main/proto/Function.proto            |  3 ++
 site/_includes/fqfn.html                           | 23 +++++++++++
 site/_sass/_docs.scss                              |  6 +--
 site/docs/latest/functions/overview.md             |  8 ++++
 6 files changed, 96 insertions(+), 14 deletions(-)

commit ec210cb0c0648a64a80d4b30c312c82420588836
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Apr 6 12:04:06 2018 -0700

    Message deduplication documentation (#1271)
    
    * add deduplication diagram
    
    * add CLI docs to YAML file
    
    * add docs for new broker.conf settings
    
    * add link to streamlio blog post and remove errant TODOs
    
    * add more to theory section
    
    * add producer idempotency section
    
    * add message deduplication cookbook
    
    * add multiple new sections to cookbook
    
    * add note about dedup and namespaces
    
    * add new badge to new docs
    
    * update description of configs
    
    * finish admin section of doc
    
    * fix minor markdown error
    
    * fix merge conflicts in gemfile.lock

 conf/broker.conf                                   |   6 +-
 .../apache/pulsar/client/api/ProducerBuilder.java  |   2 +
 site/Gemfile.lock                                  |   2 +-
 site/_data/cli/pulsar-admin.yaml                   |  10 ++
 site/_data/config/broker.yaml                      |  14 ++-
 site/_data/sidebar.yaml                            |   6 +-
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |   2 +-
 site/docs/latest/clients/Java.md                   |   2 +-
 .../latest/{advanced => cookbooks}/Encryption.md   |   0
 .../{advanced => cookbooks}/PartitionedTopics.md   |   0
 .../{advanced => cookbooks}/RetentionExpiry.md     |   0
 .../docs/latest/cookbooks/message-deduplication.md | 121 +++++++++++++++++++++
 .../getting-started/ConceptsAndArchitecture.md     |  33 +++++-
 site/img/message-deduplication.png                 | Bin 0 -> 116703 bytes
 14 files changed, 186 insertions(+), 12 deletions(-)

commit b5781a15367f234a4c1c2fe23931a4904f2fe893
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Apr 6 11:54:46 2018 -0700

    Enable Pulsar Functions to access entire user config map (#1498)
    
    * add full user config map fetch capability to pulsar funtions context
    
    * add full user config map fetch for Python API
    
    * Standardize naming across java and python

 pulsar-client-cpp/python/functions/context.py                      | 7 ++++++-
 .../src/main/java/org/apache/pulsar/functions/api/Context.java     | 7 +++++++
 .../java/org/apache/pulsar/functions/instance/ContextImpl.java     | 5 +++++
 pulsar-functions/instance/src/main/python/contextimpl.py           | 3 +++
 4 files changed, 21 insertions(+), 1 deletion(-)

commit 125ca585da6b02ae35c9681ab96aa302f9efdaa0
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Apr 6 11:53:57 2018 -0700

    Pulsar Functions diagrams (#1502)
    
    * Add brief section to overview on processing guarantees
    
    * add new sections to overview
    
    * add basic PF diagram
    
    * add word count diagram
    
    * add two new examples to overview
    
    * switch from python to java example
    
    * Update description of counters

 site/_sass/_docs.scss                         |   2 +-
 site/docs/latest/functions/guarantees.md      |   2 +-
 site/docs/latest/functions/overview.md        | 139 ++++++++++++++++++++++++--
 site/img/pulsar-functions-overview.png        | Bin 0 -> 77077 bytes
 site/img/pulsar-functions-routing-example.png | Bin 0 -> 62087 bytes
 site/img/pulsar-functions-word-count.png      | Bin 0 -> 85250 bytes
 6 files changed, 133 insertions(+), 10 deletions(-)

commit 6e8b5bf05ce0eb31795357879a1ee62297467480
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Fri Apr 6 12:09:14 2018 -0600

    Consolidate Pair implementations (#1515)

 .../apache/bookkeeper/mledger/impl/EntryCache.java |  2 +-
 .../impl/EntryCacheDefaultEvictionPolicy.java      |  6 +--
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    | 14 ++---
 .../bookkeeper/mledger/impl/EntryCacheManager.java |  4 +-
 .../mledger/impl/ManagedCursorContainer.java       |  4 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  8 +--
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 16 +++---
 .../mledger/impl/NonDurableCursorImpl.java         |  8 +--
 .../org/apache/bookkeeper/mledger/util/Pair.java   | 59 ----------------------
 .../apache/bookkeeper/mledger/util/RangeCache.java |  5 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 16 +++---
 .../apache/bookkeeper/mledger/util/PairTest.java   | 50 ------------------
 .../bookkeeper/mledger/util/RangeCacheTest.java    | 21 ++++----
 .../java/org/apache/zookeeper/MockZooKeeper.java   | 40 +++++++--------
 .../broker/loadbalance/impl/OverloadShedder.java   | 12 ++---
 .../impl/AcknowledgmentsGroupingTracker.java       |  3 +-
 pulsar-common/pom.xml                              |  5 ++
 .../org/apache/pulsar/common/api/Commands.java     |  6 +--
 .../pulsar/common/util/collections/Pair.java       | 37 --------------
 19 files changed, 88 insertions(+), 228 deletions(-)

commit 013ea058a74675764d477d4918bce5bd0a433fb9
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Apr 6 16:21:02 2018 +0200

    Integration smoke test for pulsar (#1399)
    
    * Integration smoke test for pulsar
    
    Boots a cluster, sends and receives some messages, shuts down the
    cluster.
    
    If anything fails, then something is very broken.
    
    * license fix
    
    * Disable AnnotationListener for integration tests
    
    The annotation listener adds timeouts to all tests, which changes the
    threading model, which breaks arquillian.
    
    I've created an issue[1] on arquillian for this, but until that is fixed,
    timeouts cannot be used with arquillian.
    
    [1] https://github.com/arquillian/arquillian-core/issues/168

 tests/integration/pom.xml                          | 38 +++++++++
 tests/integration/smoke/pom.xml                    | 47 +++++++++++
 .../apache/pulsar/tests/integration/TestSmoke.java | 98 ++++++++++++++++++++++
 .../smoke/src/test/resources/arquillian.xml        | 32 +++++++
 tests/pom.xml                                      |  1 +
 5 files changed, 216 insertions(+)

commit acc31519607a43524366eb536359be0c93abd12c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Apr 5 17:39:58 2018 -0700

    Refactor pulsar function admin api location (#1508)
    
    * Refactor pulsar function admin api location

 pulsar-client-admin/pom.xml                        |  12 +++
 .../org/apache/pulsar/client/admin/Functions.java  |   4 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  11 +++
 .../client/admin/internal/FunctionsImpl.java       |  26 ++++--
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  22 ++---
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 103 ++++++++++++---------
 .../client/admin/PulsarAdminWithFunctions.java     |  46 ---------
 .../admin/PulsarAdminWithFunctionsBuilderImpl.java |  29 ------
 pulsar-functions/pom.xml                           |   1 +
 pulsar-functions/proto-shaded/pom.xml              |  93 +++++++++++++++++++
 pulsar-functions/utils/pom.xml                     |   4 +
 11 files changed, 214 insertions(+), 137 deletions(-)

commit fb3511dc561d65269429de1776ecc3906600aeeb
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 5 09:31:31 2018 -0700

    When we try to get information for a topic, we should try to load it if exists instead of return "not found" (#1500)
    
    * When we try to get information for a topic, we should try to load it if exists instead of return "not found"
    
    * Fixed tests
    
    * fixed broker unit tests

 .../bookkeeper/mledger/ManagedLedgerConfig.java    | 10 +++
 .../bookkeeper/mledger/ManagedLedgerException.java | 13 ++++
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |  3 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 10 ++-
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |  2 +-
 .../apache/bookkeeper/mledger/impl/MetaStore.java  |  4 +-
 .../mledger/impl/MetaStoreImplZookeeper.java       | 61 ++++++++++-------
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 36 +++++++++-
 .../mledger/impl/MetaStoreImplZookeeperTest.java   |  6 +-
 .../org/apache/pulsar/broker/PulsarService.java    |  2 +-
 .../broker/admin/impl/PersistentTopicsBase.java    | 15 +----
 .../broker/admin/v1/NonPersistentTopics.java       | 32 ++++-----
 .../broker/admin/v2/NonPersistentTopics.java       | 21 ++----
 .../pulsar/broker/service/BrokerService.java       | 78 ++++++++++++++--------
 .../apache/pulsar/broker/service/ServerCnx.java    |  4 +-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 21 +++---
 .../pulsar/broker/service/BatchMessageTest.java    | 22 +++---
 .../broker/service/BrokerBkEnsemblesTests.java     |  6 +-
 .../pulsar/broker/service/BrokerServiceTest.java   | 18 ++---
 .../pulsar/broker/service/PeerReplicatorTest.java  |  4 +-
 .../broker/service/PersistentFailoverE2ETest.java  | 12 ++--
 .../broker/service/PersistentQueueE2ETest.java     |  6 +-
 .../service/PersistentTopicConcurrentTest.java     |  8 +--
 .../broker/service/PersistentTopicE2ETest.java     | 68 +++++++++++++------
 .../pulsar/broker/service/PersistentTopicTest.java | 17 ++---
 .../pulsar/broker/service/ReplicatorTest.java      | 18 ++---
 .../pulsar/broker/service/ResendRequestTest.java   | 10 +--
 .../pulsar/broker/service/ServerCnxTest.java       | 29 ++++----
 .../broker/service/SubscriptionSeekTest.java       |  2 +-
 .../broker/service/persistent/ChecksumTest.java    |  2 +-
 .../client/api/DispatcherBlockConsumerTest.java    |  2 +-
 .../client/api/MessageDispatchThrottlingTest.java  | 24 +++----
 .../pulsar/client/api/NonPersistentTopicTest.java  | 17 +++--
 .../client/api/SimpleProducerConsumerTest.java     |  4 +-
 .../SubscriptionMessageDispatchThrottlingTest.java | 14 ++--
 .../client/api/v1/V1_ProducerConsumerTest.java     |  4 +-
 .../client/impl/BrokerClientIntegrationTest.java   |  2 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   |  2 +-
 .../stats/client/PulsarBrokerStatsClientTest.java  |  2 +-
 39 files changed, 354 insertions(+), 257 deletions(-)

commit 683ee9524b6d0c906af554001b5f07589aaaa264
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Apr 4 21:17:21 2018 -0700

    add Boolean type in DefaultSerDe (#1499)

 .../org/apache/pulsar/functions/api/utils/DefaultSerDe.java    |  4 ++++
 .../apache/pulsar/functions/api/utils/DefaultSerDeTest.java    | 10 ++++++++++
 2 files changed, 14 insertions(+)

commit 687c1fc98f31e2475974bc9dea6eaf6df4b2bb42
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Apr 5 02:09:18 2018 +0200

    Rest endpoint for triggering compaction (#1367)
    
    * Rest endpoint for triggering compaction
    
    Only a single compaction operation can occur per topic, and compaction
    for a topic must be triggered at the broker who owns the topic.
    
    * Remove misconfiguration of auth provider from auth test
    
    It's trying to configure a client with a server side provider.

 .../org/apache/pulsar/broker/PulsarService.java    | 59 ++++++++++++++++++++++
 .../broker/admin/impl/PersistentTopicsBase.java    | 14 +++++
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 15 ++++++
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 14 +++++
 .../broker/service/BrokerServiceException.java     |  6 +++
 .../broker/service/persistent/PersistentTopic.java | 14 +++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 39 ++++++++++++++
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  5 ++
 .../api/AuthorizationProducerConsumerTest.java     |  2 -
 .../pulsar/client/admin/PersistentTopics.java      |  9 ++++
 .../admin/internal/PersistentTopicsImpl.java       | 12 +++++
 11 files changed, 187 insertions(+), 2 deletions(-)

commit ead2a2caaacb35a53b436f46bd39ee3be71024b2
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Apr 4 17:05:41 2018 -0700

    Update pulsar-admin functions language (#1497)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 92 +++++++++++-----------
 1 file changed, 46 insertions(+), 46 deletions(-)

commit 88a9ba3468ac7e04e9d50321823e73223aa3a38e
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Apr 5 02:04:58 2018 +0200

    Disable AnnotationListener for integration tests (#1496)
    
    The annotation listener adds timeouts to all tests, which changes the
    threading model, which breaks arquillian.
    
    I've created an issue[1] on arquillian for this, but until that is fixed,
    timeouts cannot be used with arquillian.
    
    [1] https://github.com/arquillian/arquillian-core/issues/168

 tests/integration-tests-base/pom.xml | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 1edf4d9d31d4c935ccd49015727fe66956434e8a
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Apr 4 15:08:44 2018 -0700

    Fixed InvocationTargetException in pulsar-admin (#1492)

 .../apache/pulsar/client/admin/PulsarAdmin.java    | 27 +++++++++++++++-------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  2 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 11 ++++++---
 .../client/admin/PulsarAdminWithFunctions.java     | 16 ++-----------
 4 files changed, 30 insertions(+), 26 deletions(-)

commit ea8c47738007674657db89e1be1eb1efe3077658
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Apr 4 14:08:37 2018 -0700

    GC improvement: Reduce string objects from Publisher and Consumer stats (#1480)

 .../org/apache/pulsar/broker/service/Consumer.java |  6 +-
 .../org/apache/pulsar/broker/service/Producer.java |  8 +--
 .../apache/pulsar/broker/service/ServerCnx.java    |  4 +-
 .../service/nonpersistent/NonPersistentTopic.java  | 12 ++--
 .../broker/service/persistent/PersistentTopic.java | 16 ++---
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 47 +++++++++++++
 .../pulsar/broker/service/BrokerServiceTest.java   |  4 +-
 .../pulsar/common/policies/data/ConsumerStats.java | 65 ++++++++++++++++--
 .../common/policies/data/PublisherStats.java       | 79 ++++++++++++++++++++--
 .../common/policies/data/ConsumerStatsTest.java    | 65 ++++++++++++++++++
 .../common/policies/data/PublisherStatsTest.java   | 75 ++++++++++++++++++++
 11 files changed, 345 insertions(+), 36 deletions(-)

commit f52f4ef13e0d111a87319aa74f1c69cc91508fc4
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Apr 4 13:50:38 2018 -0700

     In Namespace.addClusters and Properties.addRoles changed dataType to Set (#1494)
    
    * Removed Pulsar Functions from AdminTool
    
    * In Namespace.addClusters and Properties.addRoles changed dataType to Set
    
    * Revert "Removed Pulsar Functions from AdminTool"
    
    This reverts commit e04f4e237e5d68d57829f653381c3590e75a2402.
    
    * Fixed compilation for few Tests
    
    * Converted replication_clusters into a Set

 .../org/apache/pulsar/PulsarStandaloneStarter.java |  2 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  8 +++---
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  2 +-
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  2 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  2 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  5 ++--
 .../apache/pulsar/broker/SLAMonitoringTest.java    |  3 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 17 ++++++-----
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 12 ++++----
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  8 +++---
 .../broker/admin/IncrementPartitionsTest.java      |  2 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java | 12 ++++----
 .../pulsar/broker/auth/AuthorizationTest.java      |  2 +-
 .../AntiAffinityNamespaceGroupTest.java            |  8 +++---
 .../loadbalance/ModularLoadManagerImplTest.java    |  2 +-
 .../broker/lookup/http/HttpTopicLookupv2Test.java  |  3 +-
 .../broker/service/BacklogQuotaManagerTest.java    |  3 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |  3 +-
 .../pulsar/broker/service/BrokerTestBase.java      |  3 +-
 .../pulsar/broker/service/PeerReplicatorTest.java  |  4 +--
 .../pulsar/broker/service/ReplicatorTest.java      | 13 +++++----
 .../pulsar/broker/service/ReplicatorTestBase.java  |  6 ++--
 .../api/AuthenticatedProducerConsumerTest.java     | 33 +++++++++++++---------
 .../AuthenticationTlsHostnameVerificationTest.java |  3 +-
 .../api/AuthorizationProducerConsumerTest.java     |  4 +--
 .../pulsar/client/api/BrokerServiceLookupTest.java |  5 ++--
 .../client/api/MessageDispatchThrottlingTest.java  |  4 +--
 .../pulsar/client/api/NonPersistentTopicTest.java  |  4 +--
 .../pulsar/client/api/ProducerConsumerBase.java    |  4 +--
 .../pulsar/client/api/TlsProducerConsumerBase.java |  7 ++---
 .../client/impl/ConsumerConfigurationTest.java     |  2 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   |  2 +-
 .../pulsar/compaction/CompactedTopicTest.java      |  2 +-
 .../apache/pulsar/compaction/CompactionTest.java   |  2 +-
 .../apache/pulsar/compaction/CompactorTest.java    |  2 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |  2 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |  2 +-
 .../client/admin/internal/NamespacesImpl.java      |  2 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  6 ++--
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  3 +-
 .../org/apache/pulsar/admin/cli/CmdProperties.java |  4 +--
 .../pulsar/common/policies/data/Policies.java      |  4 ++-
 .../pulsar/common/policies/data/PropertyAdmin.java | 12 ++++----
 .../common/policies/data/PoliciesDataTest.java     | 19 +++++--------
 .../ProxyAuthenticatedProducerConsumerTest.java    |  3 +-
 .../proxy/server/ProxyForwardAuthDataTest.java     |  3 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |  5 +---
 .../server/ProxyWithAuthorizationNegTest.java      |  3 +-
 .../proxy/server/ProxyWithAuthorizationTest.java   |  9 +++---
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  3 +-
 50 files changed, 131 insertions(+), 145 deletions(-)

commit f6cc45037c215ef1085b4a0bfc7e3a3fd7ff9f1c
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 4 08:53:37 2018 -0700

    Load manager should offload multiple bundles when overloaded (#1488)
    
    * Load manager should offload multiple bundles when overloaded
    
    * Added test
    
    * Fixed import
    
    * Fixed logger import

 conf/broker.conf                                   |   9 +-
 conf/standalone.conf                               |   4 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |   4 +-
 .../broker/loadbalance/LoadSheddingStrategy.java   |   6 +-
 .../broker/loadbalance/impl/DeviationShedder.java  |  10 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  47 +++---
 .../broker/loadbalance/impl/OverloadShedder.java   | 124 ++++++++------
 .../loadbalance/impl/OverloadShedderTest.java      | 182 +++++++++++++++++++++
 .../data/loadbalancer/LocalBrokerData.java         |  24 ++-
 9 files changed, 313 insertions(+), 97 deletions(-)

commit ffd94e079ae567bd67f348f6faa29e2f4d815ed5
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Apr 4 08:48:17 2018 -0700

    Add MultiTopicsConsumerImpl with leaked commit from partitionedConsumer (#1495)
    
    * add leaked merge from partitionedConsumer
    
    * fix potential race in handleSubscribeOneTopicError

 .../apache/pulsar/client/impl/MultiTopicsConsumerImpl.java  | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

commit 1dd9c43e8e266d3957177354f592015c6f89c6d6
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Apr 3 22:03:55 2018 -0700

    Delete PartitionedConsumerImpl, use TopicsConsumerImpl instead (#1365)
    
    * delete partitionedConsumer, use topicsConsumer instead
    
    * change following comments
    
    * rebase master, rename TopicsConsumerImpl to MultiTopicsConsumerImpl
    
    * avoid dup calling getPartitionedTopicMetadata
    
    * rebase master, fix test error

 .../broker/service/PersistentFailoverE2ETest.java  |   7 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |   7 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  76 +--
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   6 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  46 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 ...sumerImpl.java => MultiTopicsConsumerImpl.java} | 283 ++++++-----
 .../client/impl/PartitionedConsumerImpl.java       | 553 ---------------------
 ...pl.java => PatternMultiTopicsConsumerImpl.java} |  24 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   8 +-
 .../pulsar/client/impl/TopicMessageImpl.java       |   6 +-
 11 files changed, 263 insertions(+), 755 deletions(-)

commit b0526695c5c08a42bd10671c8a344eb44f0116b3
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 3 16:15:21 2018 -0700

    Fixed test_producer_send_async in Python (#1491)

 pulsar-client-cpp/python/pulsar_test.py | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit d309b2cb2f766151dc64861ba15e6dc71fbe8d8f
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 3 14:48:46 2018 -0700

    Refactored to reflect changes in BK for OrderedExecutor (#1489)
    
    * Refactored to reflect changes in BK for OrderedExecutor
    
    * Reverted back part of last change
    
    * Fixed test

 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  4 +-
 .../bookkeeper/mledger/impl/EntryCacheManager.java |  2 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  6 ++-
 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 21 +++++-----
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 45 ++++++++++----------
 .../mledger/impl/MetaStoreImplZookeeper.java       | 36 +++++++++-------
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |  4 +-
 .../bookkeeper/mledger/impl/OpReadEntry.java       |  6 +--
 .../mledger/impl/EntryCacheManagerTest.java        |  6 +--
 .../mledger/impl/ManagedLedgerMBeanTest.java       |  8 ++--
 .../org/apache/pulsar/broker/PulsarService.java    |  9 ++--
 .../pulsar/broker/namespace/NamespaceService.java  |  4 +-
 .../pulsar/broker/service/BrokerService.java       | 20 ++++-----
 .../apache/pulsar/broker/service/ServerCnx.java    |  2 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  9 ++--
 .../service/persistent/MessageDeduplication.java   |  2 +-
 .../PersistentDispatcherMultipleConsumers.java     |  2 +-
 .../broker/auth/SameThreadOrderedSafeExecutor.java | 14 +++----
 .../broker/cache/ResourceQuotaCacheTest.java       | 10 +----
 .../broker/namespace/OwnershipCacheTest.java       | 11 ++---
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  2 +-
 .../discovery/service/BrokerDiscoveryProvider.java |  1 -
 .../service/web/ZookeeperCacheLoader.java          | 10 +----
 .../proxy/server/util/ZookeeperCacheLoader.java    | 10 +----
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |  6 +--
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |  9 ++--
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    | 49 ++++++++++------------
 .../zookeeper/ZookeeperBkClientFactoryImpl.java    | 12 +++---
 .../pulsar/zookeeper/ZookeeperCacheTest.java       | 12 +++---
 29 files changed, 152 insertions(+), 180 deletions(-)

commit 19dd2c502725e3b45e56541576508626c4213091
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 2 20:10:54 2018 -0700

    Delayed acks impl (#1462)
    
    * Added delayed grouped acknowledgments
    
    * Fixed flush on consumer close
    
    * Fixed Kafka consumer test

 .../org/apache/pulsar/broker/service/Consumer.java |  68 ++++---
 .../apache/pulsar/broker/service/Subscription.java |   2 +-
 .../nonpersistent/NonPersistentSubscription.java   |   6 +-
 .../service/persistent/CompactorSubscription.java  |  32 +---
 .../service/persistent/PersistentSubscription.java |  21 +-
 .../apache/pulsar/client/impl/RawReaderImpl.java   |   2 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   6 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |   5 +-
 .../broker/service/PersistentFailoverE2ETest.java  |   4 +-
 .../broker/service/PersistentQueueE2ETest.java     |   3 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   4 +-
 .../pulsar/broker/service/ResendRequestTest.java   |   3 +-
 .../client/api/DispatcherBlockConsumerTest.java    |  14 +-
 .../client/api/SimpleProducerConsumerTest.java     |  33 ++--
 .../stats/client/PulsarBrokerStatsClientTest.java  |   2 +-
 pulsar-client-cpp/lib/Commands.cc                  |   2 +-
 .../clients/consumer/PulsarKafkaConsumer.java      |   1 +
 .../kafka/compat/PulsarConsumerKafkaConfig.java    |   7 +
 .../kafka/compat/tests/KafkaConsumerTest.java      |   2 +
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  14 ++
 .../pulsar/client/api/ConsumerConfiguration.java   |  16 +-
 .../impl/AcknowledgmentsGroupingTracker.java       | 211 +++++++++++++++++++++
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   7 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  78 ++++----
 .../org/apache/pulsar/client/impl/MessageImpl.java |   7 +-
 .../client/impl/PartitionedConsumerImpl.java       |   4 +
 .../impl/conf/ConsumerConfigurationData.java       |   4 +
 .../impl/AcknowledgementsGroupingTrackerTest.java  | 204 ++++++++++++++++++++
 .../org/apache/pulsar/common/api/Commands.java     |  38 +++-
 .../apache/pulsar/common/api/PulsarDecoder.java    |   9 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 185 ++++++++++++------
 .../apache/pulsar/common/schema/SchemaData.java    |   2 +-
 .../pulsar/common/util/collections/Pair.java       |  37 ++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   6 +-
 .../pulsar/testclient/PerformanceConsumer.java     |   4 +
 35 files changed, 821 insertions(+), 222 deletions(-)

commit 46411fe30834bcea0768d18b484cef421b92bbdb
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 2 16:20:03 2018 -0700

    Pulsar Functions overview (#1481)
    
    * add new sections to overview
    
    * add more sections to overview
    
    * polish opening paragraphs
    
    * polish inspirations section
    
    * add metrics section to java API doc
    
    * add parallelism section
    
    * Add user config section
    
    * finish draft of overview
    
    * minor change to wording
    
    * fix typos
    
    * add link to metrics doc

 site/_data/sidebar.yaml                  |   4 +-
 site/_includes/admonition.html           |   2 +-
 site/_includes/sidebar.html              |   2 +-
 site/_layouts/docs.html                  |   6 +-
 site/docs/latest/functions/api.md        |  54 +++++++-
 site/docs/latest/functions/deployment.md |   6 +-
 site/docs/latest/functions/guarantees.md |   2 +-
 site/docs/latest/functions/metrics.md    |   2 +-
 site/docs/latest/functions/overview.md   | 216 +++++++++++++++++++++++++------
 site/docs/latest/functions/quickstart.md |   2 +-
 10 files changed, 241 insertions(+), 55 deletions(-)

commit df3f757abab219cfd3d84c655358f598f54c71a6
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Apr 2 14:39:59 2018 -0700

    Refactored PulsarAdmin to use builder for configuration (#1327)
    
    * Refactored PulsarAdmin to use builder for configuration
    
    * Fixed adminApiTest

 .../org/apache/pulsar/PulsarStandaloneStarter.java |   4 +-
 .../org/apache/pulsar/broker/PulsarService.java    |   8 +-
 .../apache/pulsar/broker/SLAMonitoringTest.java    |   8 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   6 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   2 +-
 .../AntiAffinityNamespaceGroupTest.java            |   4 +-
 .../broker/loadbalance/LoadBalancerTest.java       |   5 +-
 .../loadbalance/ModularLoadManagerImplTest.java    |   5 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |   5 +-
 .../broker/service/BacklogQuotaManagerTest.java    |   3 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |   3 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   7 +-
 .../apache/pulsar/broker/web/WebServiceTest.java   |  13 +-
 .../api/AuthenticatedProducerConsumerTest.java     |  15 +-
 .../AuthenticationTlsHostnameVerificationTest.java |  12 +-
 .../api/AuthorizationProducerConsumerTest.java     |  10 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |   6 +-
 .../pulsar/client/api/TlsProducerConsumerBase.java |  30 ++--
 .../client/impl/BrokerClientIntegrationTest.java   |   2 +-
 .../stats/client/PulsarBrokerStatsClientTest.java  |   2 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  69 +++++----
 .../pulsar/client/admin/PulsarAdminBuilder.java    | 162 +++++++++++++++++++++
 .../admin/internal/PulsarAdminBuilderImpl.java     |  90 ++++++++++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   2 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  19 +--
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |  61 ++++----
 .../client/admin/PulsarAdminWithFunctions.java     |  24 +--
 .../admin/PulsarAdminWithFunctionsBuilderImpl.java |  29 ++++
 .../org/apache/pulsar/functions/worker/Utils.java  |  12 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |  10 +-
 .../proxy/server/ProxyForwardAuthDataTest.java     |   6 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |   7 +-
 .../server/ProxyWithAuthorizationNegTest.java      |  14 +-
 .../proxy/server/ProxyWithAuthorizationTest.java   |  14 +-
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  10 +-
 35 files changed, 430 insertions(+), 249 deletions(-)

commit 6ef9a16df85abcdf2d1a0c644a8f98a7e1225e38
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 2 13:39:06 2018 -0700

    Pulsar Functions quickstart trigger example (#1479)
    
    * Update PF quickstart
    
    * fix doc lead

 site/_config.yml                         |  2 +-
 site/docs/latest/functions/deployment.md |  2 +-
 site/docs/latest/functions/quickstart.md | 70 +++++++++++++++-----------------
 3 files changed, 35 insertions(+), 39 deletions(-)

commit 444d801669af6a23549775759db1ece14205fd8b
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Apr 2 10:47:36 2018 -0700

    Multi-topic subscription documentation (#1181)
    
    * begin adding explanation to C+A doc
    
    * add more C+A docs and java examples
    
    * finish draft of java client doc
    
    * updates to address comments from jia
    
    * fix regexes for topics in java client doc
    
    * fix regex pattern in java examples
    
    * fix regex in C&A doc

 site/docs/latest/clients/Java.md                   | 174 +++++++++++++++------
 .../getting-started/ConceptsAndArchitecture.md     |  37 +++++
 2 files changed, 160 insertions(+), 51 deletions(-)

commit 9a257c2fe784a5334ab6728eb22c90a615da6f97
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Mon Apr 2 10:40:12 2018 -0700

    Issue 1071: add ratelimiter for subscription (#1358)
    
    * add ratelimiter for subscription
    
    * rebase master, change following comments

 .../apache/pulsar/broker/ServiceConfiguration.java |  26 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  50 ++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  24 +
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  22 +
 .../pulsar/broker/service/BrokerService.java       |  35 ++
 .../service/persistent/DispatchRateLimiter.java    |  81 +--
 .../PersistentDispatcherMultipleConsumers.java     |  50 +-
 .../PersistentDispatcherSingleActiveConsumer.java  |  63 ++-
 .../client/api/MessageDispatchThrottlingTest.java  |   8 +-
 .../SubscriptionMessageDispatchThrottlingTest.java | 542 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  22 +
 .../client/admin/internal/NamespacesImpl.java      |  23 +
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  37 ++
 .../pulsar/common/policies/data/DispatchRate.java  |  24 +-
 .../pulsar/common/policies/data/Policies.java      |   1 +
 15 files changed, 948 insertions(+), 60 deletions(-)

commit f4bb185357c4bc702588c2256c171ebce818652d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sun Apr 1 20:10:47 2018 -0700

    Fix Python docs generation script (#1484)

 site/scripts/python-doc-gen.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0bbcea28dd1e5c57d05e7e177d0fee2c86f9b132
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sun Apr 1 15:54:54 2018 -0700

    remove --user-install flag (#1483)

 site/Makefile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1933025776409f689b612197128c2fa65d52917e
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sun Apr 1 15:40:38 2018 -0700

    Streamline Ansible setup (#1291)
    
    * remove bookkeeper.service config file
    
    * remove bookkeeper systemd service from ansible playbook config

 deployment/terraform-ansible/deploy-pulsar.yaml    | 10 +------
 .../terraform-ansible/templates/bookkeeper.service | 32 ----------------------
 .../terraform-ansible/templates/pulsar.service     |  2 +-
 3 files changed, 2 insertions(+), 42 deletions(-)

commit 2eda9725ecb0ec494512bf3725839f0d24bf1d0b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Mar 31 07:05:36 2018 -0700

    Fix race condition in skipEntries that moves readPosition and markDeletePosition incorrectly (#1478)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 25 +++++++++++-----------
 1 file changed, 13 insertions(+), 12 deletions(-)

commit 7fa72021754212766465198559f462b4eba68d95
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Mar 30 11:35:35 2018 -0700

    Avoid creating failure-domain for cluster which doesn't exist (#1474)
    
    * Avoid creating failure-domain for cluster which doesn't exist
    
    * Fix admin api test

 .../pulsar/broker/cache/ConfigurationCacheService.java     |  4 +++-
 .../java/org/apache/pulsar/broker/SLAMonitoringTest.java   |  2 +-
 .../java/org/apache/pulsar/broker/admin/AdminApiTest.java  | 14 ++++++--------
 .../java/org/apache/pulsar/broker/admin/AdminApiTest2.java |  2 +-
 .../java/org/apache/pulsar/broker/admin/AdminTest.java     |  8 ++++----
 .../org/apache/pulsar/broker/admin/NamespacesTest.java     |  2 +-
 .../org/apache/pulsar/broker/auth/AuthorizationTest.java   |  2 +-
 .../broker/loadbalance/ModularLoadManagerImplTest.java     |  2 +-
 .../pulsar/broker/service/BacklogQuotaManagerTest.java     |  2 +-
 .../pulsar/broker/service/BrokerBkEnsemblesTests.java      |  2 +-
 .../apache/pulsar/broker/service/ReplicatorTestBase.java   |  6 +++---
 .../client/api/AuthenticatedProducerConsumerTest.java      |  6 +++---
 .../apache/pulsar/client/api/NonPersistentTopicTest.java   |  6 +++---
 .../apache/pulsar/client/api/TlsProducerConsumerBase.java  |  2 +-
 .../pulsar/websocket/proxy/ProxyAuthorizationTest.java     |  2 +-
 .../server/ProxyAuthenticatedProducerConsumerTest.java     |  2 +-
 16 files changed, 32 insertions(+), 32 deletions(-)

commit ce61498ac72ae51f2922736dda63fa34e94d5bca
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Mar 30 11:19:38 2018 -0700

    use v1 admin api for anti-affinity cluster endpoint (#1473)

 .../java/org/apache/pulsar/client/admin/internal/NamespacesImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3cc89d2db48b168a12f9d13531b211fbac00c77d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Mar 30 11:17:50 2018 -0700

    Ruby version reset to address website build errors (#1477)
    
    * Reset Ruby version to 2.4.1
    
    * Update build Dockerfile
    
    * Update README setup section

 build/docker/Dockerfile | 4 ++--
 site/Gemfile            | 2 +-
 site/Gemfile.lock       | 2 +-
 site/README.md          | 2 +-
 4 files changed, 5 insertions(+), 5 deletions(-)

commit 5f1aed2a17cd27bf35a25ac0cb9f8be07b15d950
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Mar 29 21:37:41 2018 -0700

    More Pulsar Functions documentation (#1362)
    
    * add note on multiple input topics
    
    * fix CSS for highlight blocks
    
    * more java API docs
    
    * fix scrolling issue
    
    * add CLI documentation for pulsar-admin functions
    
    * fix YAML issues
    
    * add PF to features list on front page
    
    * add note about SPEs to feature description
    
    * remove unnecessary include in local config
    
    * add new badges to templates
    
    * add section on core programming modeL
    
    * add section on the SDK
    
    * begin adding section on java sdk
    
    * comparison table for native vs SDK
    
    * add decrementCounter method
    
    * add link
    
    * add counters section
    
    * update example functions
    
    * revert Context object to master
    
    * add user config section for java
    
    * fix misspelling in error output
    
    * add new PF config to YAML descriptor
    
    * add processing guarantees doc to the sidebar
    
    * update download URL and add trigger command to CLI docs
    
    * add logTopic flag to CLI docs
    
    * use native python function in quickstart
    
    * add intro to java section
    
    * update example functions and finish draft of API doc
    
    * fix URL in sidebar config
    
    * finish user config section in API doc
    
    * add example ContextFunction
    
    * finish draft of processing guarantees doc
    
    * add section on triggering
    
    * comment out subscription types section for now
    
    * remove unnecessary console.log statement
    
    * remove <hr> in docs template
    
    * add missing DefaultSerDe class import
    
    * fix error output to match test expectation
    
    * Add missing license header to new example Pulsar Function

 .gitignore                                         |   3 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  52 +--
 .../functions/api/examples/ContextFunction.java    |  45 +++
 .../functions/api/examples/CounterFunction.java    |   8 +-
 .../api/examples/ExclamationFunction.java          |   3 +-
 .../api/examples/JavaNativeExclmationFunction.java |   2 +-
 .../functions/api/examples/LoggingFunction.java    |   8 +-
 .../functions/api/examples/UserMetricFunction.java |   1 -
 .../functions/worker/rest/api/FunctionsImpl.java   |   2 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   2 +-
 site/Gemfile                                       |   2 +-
 site/Gemfile.lock                                  |  16 +-
 site/_config.local.yml                             |   2 -
 site/_config.yml                                   |   1 +
 site/_data/cli/pulsar-admin.yaml                   | 187 ++++++++++
 site/_data/config/broker.yaml                      |   3 +
 site/_data/features.yaml                           |  15 +-
 site/_data/sidebar.yaml                            |  17 +-
 site/_includes/cli.html                            |   6 +-
 site/_includes/head.html                           |   7 -
 site/_includes/sidebar.html                        |   2 +-
 site/_layouts/default.html                         |   8 +
 site/_layouts/docs.html                            |   4 +-
 site/_plugins/custom_tags.rb                       |   8 +
 site/_sass/_admonition.scss                        |   4 +
 site/_sass/_docs.scss                              |   6 +-
 site/docs/latest/deployment/Monitoring.md          |   5 +-
 site/docs/latest/functions/api.md                  | 390 ++++++++++++++++++---
 site/docs/latest/functions/deployment.md           | 172 ++++++++-
 site/docs/latest/functions/guarantees.md           |  25 +-
 site/docs/latest/functions/metrics-and-stats.md    |  19 -
 site/docs/latest/functions/metrics.md              |  41 +++
 site/docs/latest/functions/overview.md             |  13 +-
 site/docs/latest/functions/quickstart.md           |  43 ++-
 site/index.html                                    |   9 +-
 35 files changed, 946 insertions(+), 185 deletions(-)

commit a2cf918394ad9ea52ab3c035bee0223d75772024
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 29 17:40:07 2018 -0700

    Used defaults for Netty allocator used in entry cache (#1465)

 .../apache/bookkeeper/mledger/impl/EntryCacheImpl.java    | 15 +++++++--------
 1 file changed, 7 insertions(+), 8 deletions(-)

commit 73a214a59280d95b66c2a25ebe2fdfe898a7cd29
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 29 17:39:48 2018 -0700

    Added multiple position delete in ManagedLedger (#1450)
    
    * Added multiple position delete in ManagedLedger
    
    * Removed ref to old bug and readded checkNotNull

 .../apache/bookkeeper/mledger/ManagedCursor.java   | 37 ++++++++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 86 +++++++++++-----------
 .../mledger/impl/ManagedCursorContainerTest.java   |  8 ++
 .../mledger/impl/ManagedCursorListAckTest.java     | 75 +++++++++++++++++++
 4 files changed, 165 insertions(+), 41 deletions(-)

commit dd296300a9988d987fdaafd338dba3d74510308a
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Mar 29 15:54:50 2018 -0700

    Fix topic deletion for V2 topics. (#1470)
    
    * Fix topic deletion for V2 topics.
    
    - Add a isReplicated() method to topics
    - Add isReplicated check before deleting a topic
    
    * Remove global check.

 .../org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java    | 4 +++-
 .../src/main/java/org/apache/pulsar/broker/service/Topic.java        | 2 ++
 .../pulsar/broker/service/nonpersistent/NonPersistentTopic.java      | 5 +++++
 .../org/apache/pulsar/broker/service/persistent/PersistentTopic.java | 5 +++++
 4 files changed, 15 insertions(+), 1 deletion(-)

commit f4d6c2bf450c90c4f2e291607dc3f887adc4a1a5
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Thu Mar 29 15:54:10 2018 -0700

    Pulsar Proxy - Added Prometheus metrics for throttled connections and lookups. (#1472)

 .../pulsar/proxy/server/LookupProxyHandler.java    | 23 ++++++++++++++++++----
 .../pulsar/proxy/server/ProxyConnection.java       | 10 +++++-----
 .../server/ProxyConnectionThrottlingTest.java      |  2 ++
 .../proxy/server/ProxyLookupThrottlingTest.java    |  3 ++-
 4 files changed, 28 insertions(+), 10 deletions(-)

commit 6d108d820698cbc831dfa246e13e08f2bed9c5b2
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Mar 29 14:10:11 2018 -0700

    Add admin v2 support for clusters, brokers, and resources quotas. (#1471)

 .../pulsar/client/admin/internal/BrokersImpl.java  |  2 +-
 .../pulsar/client/admin/internal/ClustersImpl.java |  3 +--
 .../client/admin/internal/ResourceQuotasImpl.java  | 28 +++++++++++++---------
 3 files changed, 19 insertions(+), 14 deletions(-)

commit cbdaab1f7d7232207566eedf9e99f2c9f5681f28
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Mar 29 12:42:34 2018 -0700

    Add v2 support for broker stats in the admin client. (#1469)

 .../stats/client/PulsarBrokerStatsClientTest.java  |  2 +-
 .../client/admin/internal/BrokerStatsImpl.java     | 24 ++++++++++++----------
 2 files changed, 14 insertions(+), 12 deletions(-)

commit 7f379143feecc0a04de5701b63fa6758be63971e
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Mar 29 12:09:02 2018 -0700

    Provude v2 support for  admin non persistent topics. (#1463)

 .../admin/internal/NonPersistentTopicsImpl.java    | 52 +++++++++++++++-------
 1 file changed, 35 insertions(+), 17 deletions(-)

commit 56e0109657e3b53690d9c91bfe7a231474a36895
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Thu Mar 29 10:37:05 2018 -0700

    Added Throttling mechanism to Pulsar Proxy (#1453)

 conf/proxy.conf                                    |   7 ++
 .../pulsar/proxy/server/DirectProxyHandler.java    |   2 -
 .../pulsar/proxy/server/LookupProxyHandler.java    | 125 ++++++++++++---------
 .../pulsar/proxy/server/ProxyConfiguration.java    |  24 +++-
 .../pulsar/proxy/server/ProxyConnection.java       |  28 ++++-
 .../apache/pulsar/proxy/server/ProxyService.java   |  13 ++-
 .../server/ProxyConnectionThrottlingTest.java      |  87 ++++++++++++++
 .../proxy/server/ProxyLookupThrottlingTest.java    |  91 +++++++++++++++
 8 files changed, 313 insertions(+), 64 deletions(-)

commit 7e035b0bd5c1fcbe6cb583ae11e6674e0bddc4f0
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 28 20:53:44 2018 -0700

    Avoid boxing of checksum into a Long (#1467)

 .../org/apache/pulsar/broker/service/Consumer.java  |  5 ++---
 .../org/apache/pulsar/broker/service/Producer.java  |  2 +-
 .../pulsar/broker/service/ReplicatorTest.java       |  2 +-
 .../broker/service/persistent/ChecksumTest.java     |  4 ++--
 .../org/apache/pulsar/compaction/CompactorTest.java |  2 +-
 .../org/apache/pulsar/client/impl/ConsumerImpl.java |  2 +-
 .../org/apache/pulsar/client/impl/ProducerImpl.java |  2 +-
 .../java/org/apache/pulsar/common/api/Commands.java | 21 ++++++++++++++-------
 .../pulsar/common/compression/CommandsTest.java     |  2 +-
 9 files changed, 24 insertions(+), 18 deletions(-)

commit ba76b71593ed3b41fded5c1050460a5d6614aa79
Author: cckellogg <cckellogg@gmail.com>
Date:   Wed Mar 28 13:43:29 2018 -0700

    Fix broker stats to work with v2 namespace format. (#1464)

 .../pulsar/broker/admin/impl/BrokerStatsBase.java  | 13 ++----------
 .../apache/pulsar/broker/admin/v1/BrokerStats.java | 24 ++++++++++++++++++++++
 .../apache/pulsar/broker/admin/v2/BrokerStats.java | 23 +++++++++++++++++++++
 3 files changed, 49 insertions(+), 11 deletions(-)

commit 29257d0747a7f044f5e46b55db973eed0e15f1f9
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 28 00:23:28 2018 -0700

    If cursor update to BK fails, fallback to meta store (#1461)
    
    * If cursor update to BK fails, fallback to meta store
    
    * Fixed missing parameters in logs

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 22 +++++++++++++++++-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 26 +++++++++++++++++++---
 .../mledger/impl/ManagedLedgerErrorsTest.java      |  1 +
 .../mledger/impl/NonDurableCursorTest.java         |  8 ++-----
 4 files changed, 47 insertions(+), 10 deletions(-)

commit a141f301deef56e6a6dac5a1d4e527c584ce9ec7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 27 23:37:28 2018 -0700

    Improve batch message acking by removing batch message tracker (#1424)
    
    * Improve batch message acking by removing batch message tracker
    
    * fix
    
    * Fix the cumulative ack
    
    * Fix batchsize

 .../pulsar/broker/service/BatchMessageTest.java    |   6 +-
 .../pulsar/client/impl/BatchMessageAcker.java      |  75 ++++++++++++
 .../client/impl/BatchMessageAckerDisabled.java     |  48 ++++++++
 .../pulsar/client/impl/BatchMessageIdImpl.java     |  38 +++++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 134 +++------------------
 .../client/impl/PartitionedConsumerImpl.java       |   9 --
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  10 --
 .../client/impl/BatchMessageAckerDisabledTest.java |  47 ++++++++
 .../pulsar/client/impl/BatchMessageAckerTest.java  |  71 +++++++++++
 9 files changed, 294 insertions(+), 144 deletions(-)

commit 16b448f66d148920ade4e34dccaac4871d261eb4
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Tue Mar 27 18:35:17 2018 -0700

    Replace cached data key from the map if present already (#1417)

 pulsar-client-cpp/lib/MessageCrypto.cc | 19 +++++++++++++++----
 pulsar-client-cpp/lib/MessageCrypto.h  |  3 ++-
 2 files changed, 17 insertions(+), 5 deletions(-)

commit ba855c36e786c0a38d2caee00e1dbaa707b4467d
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Mar 28 02:05:30 2018 +0200

    Add batching support to compaction (#1427)
    
    With this patch compaction can select to keep only some of the
    submessages from a batch.

 .../pulsar/compaction/TwoPhaseCompactor.java       |  97 +++++++++++++-------
 .../apache/pulsar/compaction/CompactionTest.java   | 100 +++++++++++++++++++++
 2 files changed, 163 insertions(+), 34 deletions(-)

commit 8f6e33d525c0efabe664dbb529e3c4f9d4ab979a
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Mar 27 17:05:13 2018 -0700

    When running standalone broker, force the proxy redirection flag (#1449)

 .../java/org/apache/pulsar/broker/ServiceConfiguration.java   | 11 +++++++++++
 .../main/java/org/apache/pulsar/PulsarStandaloneStarter.java  |  1 +
 .../java/org/apache/pulsar/broker/lookup/TopicLookup.java     |  7 ++++++-
 3 files changed, 18 insertions(+), 1 deletion(-)

commit ffd6f211b206788cfab4fd62e8d259bff96ad366
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Mar 27 16:10:07 2018 -0700

    Add Configuration to set tlsClientAuth (#1297)
    
    * Add Configuration to set tlsClientAuth
    
    * Fixed ProxyPublishConsumeTlsTest
    
    * Handled Matteos PR review comments
    
    * Negative Tests
    
    * Changed the Client Auth to ENUM
    
    * Addressed Matteo's PR review Comments
    
    * Removed unused imports
    
    * Added client Cert to HTTPS
    
    * Split the test case
    
    * Replace tlsReqTrustedClientCertOnConnect with tlsRequireTrustedClientCertOnConnect

 conf/broker.conf                                   |  3 +
 conf/discovery.conf                                |  4 ++
 conf/proxy.conf                                    |  4 ++
 conf/websocket.conf                                |  4 ++
 .../apache/pulsar/broker/ServiceConfiguration.java | 10 ++++
 .../broker/service/PulsarChannelInitializer.java   |  3 +-
 .../org/apache/pulsar/broker/web/WebService.java   | 24 ++++----
 .../pulsar/client/api/TlsProducerConsumerBase.java | 38 ++++++++++---
 .../pulsar/client/api/TlsProducerConsumerTest.java | 66 +++++++++++++++++++++-
 .../proxy/ProxyPublishConsumeTlsTest.java          |  6 ++
 pulsar-common/pom.xml                              |  6 ++
 .../apache/pulsar/common/util/SecurityUtility.java | 31 ++++++++--
 .../service/ServiceChannelInitializer.java         |  3 +-
 .../discovery/service/server/ServerManager.java    | 20 +++----
 .../discovery/service/server/ServiceConfig.java    | 11 ++++
 .../pulsar/proxy/server/ProxyConfiguration.java    | 13 ++++-
 .../proxy/server/ServiceChannelInitializer.java    |  3 +-
 .../org/apache/pulsar/proxy/server/WebServer.java  | 18 +++---
 .../pulsar/websocket/service/ProxyServer.java      | 18 +++---
 .../service/WebSocketProxyConfiguration.java       | 12 +++-
 20 files changed, 238 insertions(+), 59 deletions(-)

commit 5bd13a00afaf4ad3d751addd3901fb35e84a44a4
Author: cckellogg <cckellogg@gmail.com>
Date:   Tue Mar 27 16:00:57 2018 -0700

    Convert admin client properties to use v2 endpoints. (#1410)

 .../java/org/apache/pulsar/client/admin/internal/PropertiesImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f258e6e29cbf93170859fdfe26250bf0ca24d41b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Mar 27 16:00:10 2018 -0700

    Handle null redirection url with error-message at broker (#1418)

 .../java/org/apache/pulsar/broker/lookup/TopicLookup.java     | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

commit 8ffd011a825eabe734ac783344a704e42f222f23
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 27 15:27:41 2018 -0700

    Update the bookkeeper configuration file (#1441)
    
    * Update the bookkeeper configuration file
    
    Update the bookkeeper configuration file to the latest file in bookkeeper.
    This change keeps all the settings same as before.
    
    * Uncommented a few settings

 conf/bookkeeper.conf | 622 +++++++++++++++++++++++++++++++++++++--------------
 1 file changed, 454 insertions(+), 168 deletions(-)

commit bb6daa2036560763902ddac3c9d6f642fcbef47f
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Mar 27 15:27:29 2018 -0700

    Add version warning for latest vs. 2.0 (#1445)
    
    * add 2.0 version warning on each docs page
    
    * add license header to version warning include

 site/_includes/version-warning.html | 23 +++++++++++++++++++++++
 site/_layouts/docs.html             |  2 ++
 2 files changed, 25 insertions(+)

commit ea391488145d7e59309ee1c243bd38b9f9768773
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Mar 27 14:25:10 2018 -0700

    Issue #1117: handle race in concurrent bundle split (#1428)
    
    *  handle race in bundle split
    
    * change following comments
    
    * rebase master, fix test error

 .../broker/cache/LocalZooKeeperCacheService.java   |  21 ++-
 .../pulsar/broker/namespace/NamespaceService.java  | 171 ++++++++++++++-------
 .../pulsar/broker/service/BrokerService.java       |  13 +-
 .../common/naming/NamespaceBundleFactory.java      |  32 ++--
 .../pulsar/common/naming/NamespaceBundles.java     |  18 ++-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 115 ++++++++++++++
 .../broker/namespace/NamespaceServiceTest.java     |  10 +-
 .../pulsar/zookeeper/ZooKeeperDataCache.java       |   8 +
 8 files changed, 306 insertions(+), 82 deletions(-)

commit 527731cff64be2d8ebcc09921aaec843ff9ca7d4
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Mar 27 14:24:52 2018 -0700

    Check if request is HTTPs before redirecting to TLS URL (#1454)
    
    * Check if request is HTTPs before redirecting to TLS URL
    
    * Handled Matteo's PR Comments

 .../java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 86b95461602b1f813e41f382eac41a6b2a31ee63
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Mar 27 11:58:41 2018 -0700

    Send Log statements to log Topic for Java Functions (#1447)
    
    * Added LogTopic support to Java functions
    
    * UseLogAppender instead of PulsarAppender
    
    * Reverted changes to PulsarAppender
    
    * No need to take dep on pulsar-log4j plugin
    
    * Start the appender
    
    * Fixed comments
    
    * Reverted back logging function change

 .../functions/instance/JavaInstanceRunnable.java   |  38 +++++++
 .../pulsar/functions/instance/LogAppender.java     | 121 +++++++++++++++++++++
 2 files changed, 159 insertions(+)

commit 4bf44d98cb2744d7a314f8bc9b96113f6775e04a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Mar 27 10:18:59 2018 -0700

    Fix: NPE on http-lookup redirection (#1451)

 .../src/main/java/org/apache/pulsar/broker/web/PulsarWebResource.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit b1fbd3a7abb7f745af0c2dfc47931f9c8584cebb
Author: Eren Avsarogullari <erenavsarogullari@gmail.com>
Date:   Tue Mar 27 01:32:01 2018 +0100

    Extend Spark Streaming Receiver UT Coverage (#1448)

 .../spark/SparkStreamingPulsarReceiverTest.java    | 46 +++++++++++++++++-----
 1 file changed, 36 insertions(+), 10 deletions(-)

commit dafe123e2909ba138007d1dba3dc43c7852446b5
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 26 16:06:38 2018 -0700

    Enforce timeout on all TestNG tests, thread dump on timeout (#1347)
    
    * Enforce timeout on all TestNG tests, thread dump on timeout
    
    * Increased default timeout to 120 seconds
    
    * Removed usage of log statement that were making the log4j appender test to fail

 .../apache/pulsar/tests/AnnotationListener.java    |  12 +-
 .../apache/pulsar/tests/PulsarTestListener.java    |  73 ++++++++++
 .../org/apache/pulsar/tests/ThreadDumpUtil.java    | 148 +++++++++++++++++++++
 managed-ledger/pom.xml                             |  12 --
 pom.xml                                            |   8 +-
 pulsar-broker/pom.xml                              |  12 --
 pulsar-discovery-service/pom.xml                   |  17 ---
 7 files changed, 239 insertions(+), 43 deletions(-)

commit 01a77aa29d7c1a8376227211403bfec26b57abc7
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 26 15:24:12 2018 -0700

    Avoid allocation of one PositionImpl object in write path (#1439)

 .../src/main/java/org/apache/bookkeeper/mledger/impl/OpAddEntry.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 02fede7c2c1c6465fcdcd01105ac1966029e454c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 26 14:13:46 2018 -0700

    Added Groovy DSL definition for C++/Java PR builds (#1444)
    
    * Added Groovy DSL definition for C++/Java PR builds
    
    * Added license check
    
    * Run PR builds in parallel
    
    * Use "Hadoop" label for Jenkins workers
    
    * Also run integration test concurrently

 .test-infra/jenkins/common_job_properties.groovy   |  2 +-
 .../jenkins/job_pulsar_precommit_cpp.groovy        | 67 ++++++++++++++++++++++
 .../job_pulsar_precommit_integrationtests.groovy   |  3 +
 .../jenkins/job_pulsar_precommit_java8.groovy      | 58 +++++++++++++++++++
 .test-infra/jenkins/job_seed.groovy                |  2 +-
 5 files changed, 130 insertions(+), 2 deletions(-)

commit 358bbc20f151e2fb2f321ab42dce5f68b340bfd3
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Mar 26 23:06:18 2018 +0200

    Revert "Recycle OpAddEntry when ledger-ops fails (#1415)" (#1442)
    
    If the OpAddEntry is recycled before the callback is triggered, the callback is calling into a dead object.
    
    This reverts commit f5ffbbe1ed2b79be1caf4a59688eab006e932ced.

 .../src/main/java/org/apache/bookkeeper/mledger/impl/OpAddEntry.java     | 1 -
 1 file changed, 1 deletion(-)

commit 3360b1485a950e473ca6bfb6c7d65b8d868174ca
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 26 10:13:24 2018 -0700

    Fixed C++ formatting (#1443)

 pulsar-client-cpp/lib/BatchAcknowledgementTracker.cc | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

commit 665672d43daeeb4380c6cc70ffcd4bd2da7e7dc8
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sun Mar 25 16:57:51 2018 -0700

    Update user config interface for Java Pulsar Functions SDK (#1437)
    
    * update user config interface and update example Pulsar Function
    
    * change example function signature to not require a returned String
    
    * fix API example functions

 .../org/apache/pulsar/functions/api/Context.java    | 15 ++++++++++++---
 .../pulsar/functions/instance/ContextImpl.java      | 14 ++++++++------
 .../functions/api/examples/PublishFunction.java     |  4 +++-
 .../functions/api/examples/UserConfigFunction.java  | 21 +++++++++++++++++----
 4 files changed, 40 insertions(+), 14 deletions(-)

commit 9a62eb801c9e2b7412ab75d4091027cd68fce971
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 25 16:57:24 2018 -0700

    Fixed count of messages per thread in managed ledger writer (#1438)

 .../pulsar/testclient/ManagedLedgerWriter.java     | 62 ++++++++++++----------
 1 file changed, 35 insertions(+), 27 deletions(-)

commit 5efafc57fd81eaf622fe65548facfec00af5b49b
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 25 16:20:58 2018 -0700

    Use private impl for MessageId in c++ client (#1322)

 pulsar-client-cpp/include/pulsar/BatchMessageId.h  | 67 ------------------
 pulsar-client-cpp/include/pulsar/Message.h         | 10 +--
 pulsar-client-cpp/include/pulsar/MessageId.h       | 33 +++++----
 .../lib/BatchAcknowledgementTracker.cc             | 40 ++++++-----
 .../lib/BatchAcknowledgementTracker.h              | 27 ++++----
 pulsar-client-cpp/lib/BatchMessageId.cc            | 76 --------------------
 pulsar-client-cpp/lib/ClientImpl.cc                |  4 +-
 pulsar-client-cpp/lib/ClientImpl.h                 |  2 +-
 pulsar-client-cpp/lib/Commands.cc                  | 16 +++--
 pulsar-client-cpp/lib/Commands.h                   |  5 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              | 65 ++++++++----------
 pulsar-client-cpp/lib/ConsumerImpl.h               | 14 ++--
 pulsar-client-cpp/lib/Message.cc                   | 11 +--
 pulsar-client-cpp/lib/MessageId.cc                 | 80 ++++++++++++++--------
 pulsar-client-cpp/lib/MessageIdImpl.h              | 36 ++++++++++
 pulsar-client-cpp/lib/MessageImpl.h                |  3 +-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  4 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  1 -
 pulsar-client-cpp/lib/ReaderImpl.cc                | 10 ++-
 pulsar-client-cpp/lib/ReaderImpl.h                 |  2 +-
 .../lib/UnAckedMessageTrackerEnabled.cc            |  4 +-
 pulsar-client-cpp/python/src/client.cc             |  2 +-
 pulsar-client-cpp/python/src/message.cc            | 14 ++--
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  2 +-
 pulsar-client-cpp/tests/MessageIdTest.cc           |  9 +--
 pulsar-client-cpp/tests/PulsarFriend.h             |  8 ++-
 pulsar-client-cpp/tests/ReaderTest.cc              |  2 +-
 27 files changed, 235 insertions(+), 312 deletions(-)

commit 489099b79b915f067cfce2d92f9973eefe3ec1b4
Author: Ivan Kelly <ivank@apache.org>
Date:   Sun Mar 25 03:53:24 2018 +0200

    Increase timeout on ReplicatorTest#testCloseReplicatorStartProducer (#1426)
    
    A good run takes around 3.5 seconds, so it doesn't take much to push
    it past 5 seconds. Increased timeout to 15 seconds.

 .../src/test/java/org/apache/pulsar/broker/service/ReplicatorTest.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 86592522c3f609f74d2ef066e4d91dac1599a899
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Sat Mar 24 17:16:56 2018 -0700

    update Gemfile.lock and Docker build (#1436)

 build/docker/Dockerfile | 4 ++--
 site/Gemfile.lock       | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 6424b6e4f988c5cfc6922d6cf61b234d6625c17d
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Fri Mar 23 21:34:54 2018 -0700

    move subscriptionInitialPosition from parameter into ConfigurationData (#1434)

 .../apache/pulsar/client/impl/RawReaderImpl.java   |  3 +-
 .../client/api/SimpleProducerConsumerTest.java     | 41 ++++++++++++++++++++++
 .../client/api/SubscriptionInitialPosition.java    | 15 ++++++--
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  7 ++--
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  3 +-
 .../org/apache/pulsar/common/api/Commands.java     |  6 ++--
 6 files changed, 64 insertions(+), 11 deletions(-)

commit a5006b0a864653b91a81157a4f726f0d6adee52e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Mar 23 21:23:06 2018 -0700

    Publish the distribution to maven artifact (#1430)

 all/pom.xml | 7 -------
 1 file changed, 7 deletions(-)

commit a4174a5bef190ff77e74bebe9e97686d55e2a708
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Mar 23 21:22:50 2018 -0700

    Fix Python example class name (#1421)
    
    * fix python class name
    
    * remove python imports
    
    * fix python example script
    
    * change num-msgs flag value to 1

 pulsar-functions/submit-python-function.sh |  8 +++-----
 site/docs/latest/functions/quickstart.md   | 20 +++++++-------------
 2 files changed, 10 insertions(+), 18 deletions(-)

commit 561d954763d0e5cebfaef99c9ac5ca3f55d125a0
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Mar 24 02:09:01 2018 +0100

    Clarify in docs that admin is separate module (#1407)
    
    The java client page gives instructions for pulling in the pulsar
    client, but not for pulling in the admin client. Given this, a user
    will assume that the admin client is part of the same module.
    
    This change adds the maven artifact to the table so that it is clear
    that it is separate.

 site/docs/latest/clients/Java.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 89ca2496012ed0bd713d5ed3ebf0e27f9b3cc51b
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Mar 23 18:08:27 2018 -0700

    change ruby version in Gemfile and update README (#1413)

 site/Gemfile   | 2 +-
 site/README.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit d11ae4d64451eeeef1125d7d6d32d8c2c0ab1445
Author: cckellogg <cckellogg@gmail.com>
Date:   Fri Mar 23 17:50:30 2018 -0700

    Add v2 support to the websockets endpoints. (#1429)
    
    * Add v2 support to the websockets endpoints.
    
    * Add servlet mounts for v2 websockets.
    
    * Add default receiver queue size.

 .../org/apache/pulsar/broker/PulsarService.java    | 19 ++++++--
 .../pulsar/websocket/AbstractWebSocketHandler.java | 31 ++++++++++---
 .../apache/pulsar/websocket/ConsumerHandler.java   | 18 +++++---
 .../apache/pulsar/websocket/ProducerHandler.java   |  5 +--
 .../org/apache/pulsar/websocket/ReaderHandler.java | 52 ++++++++++++----------
 .../pulsar/websocket/WebSocketConsumerServlet.java |  1 +
 .../pulsar/websocket/WebSocketProducerServlet.java |  1 +
 .../pulsar/websocket/WebSocketReaderServlet.java   |  1 +
 8 files changed, 87 insertions(+), 41 deletions(-)

commit 38d3b4b5a19c20dbcee48f40af41b0a6eddc78a6
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 22 15:13:42 2018 -0700

    Performance consumer end-to-end latency can be negative when running on different machines (#1422)

 .../pulsar/testclient/PerformanceConsumer.java     | 33 +++++++++-------------
 1 file changed, 13 insertions(+), 20 deletions(-)

commit fdad48b2d95a6300f2cda39ec6dafab253efacac
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 22 14:30:41 2018 -0700

    Add pulsar python location to python path so that pdoc can succeed generating docs (#1414)

 site/scripts/python-doc-gen.sh | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

commit 65417201d0b65058a4a4d81eb5dfe12e6b769b8b
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Mar 22 17:21:53 2018 +0100

    Utility to rebatch a message (#1391)
    
    * Utility to rebatch a message
    
    When compacting a batched message, we need to take the message, break
    it into its constituent submessages, select the submessages we wish to
    keep, and rebuild the batched message. In other words rebatching. To
    maintain the same batched message ids, the submessages which are not
    selected are replaced with dummy messages with the compactedOut flag
    set to true.
    
    This patch contains a utility method to do this rebatching, along with
    another utility to extract the ids and keys from a batch. These will
    be used to add batching support to compaction in a later patch.
    
    * Avoid double release of m1

 .../pulsar/client/impl/RawBatchConverter.java      | 110 ++++++++++++++++-----
 .../apache/pulsar/client/impl/RawReaderTest.java   |  96 +++++++++---------
 2 files changed, 137 insertions(+), 69 deletions(-)

commit 9bc5518062da1fec23f4bfdb19e65f31fc0d8210
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Mar 22 17:07:54 2018 +0100

    Null checks in MockedPulsarServiceBaseTest (#1420)
    
    If initialization fails, any of the members could be null. If we try
    to do cleanup on null members we get a NullPointerException, which
    obscures the original error that caused the member to be null in the
    first place.

 .../broker/auth/MockedPulsarServiceBaseTest.java   | 23 ++++++++++++++++------
 1 file changed, 17 insertions(+), 6 deletions(-)

commit f5ffbbe1ed2b79be1caf4a59688eab006e932ced
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Mar 21 16:20:35 2018 -0700

    Recycle OpAddEntry when ledger-ops fails (#1415)

 .../src/main/java/org/apache/bookkeeper/mledger/impl/OpAddEntry.java     | 1 +
 1 file changed, 1 insertion(+)

commit baa9c8b1d3775db0e317943547359fa8d5a12327
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Mar 21 17:15:38 2018 +0100

    Allow site to be built on debian/ubuntu (#1408)
    
    The current scripts need root and a version of ruby newer than what
    Debian and Ubuntu ship.
    
    This patch removes the need for root and makes any ruby newer than
    or equal to 2.3.1 acceptable.

 site/Gemfile  | 2 +-
 site/Makefile | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit e7261b7ce829c3d62a7dcf95127c6d83ee896323
Author: XiaoZYang <XiaoZYang@users.noreply.github.com>
Date:   Wed Mar 21 13:06:09 2018 +0800

    Issue 1069: Provide a setting in consumer configuration to specify where to start consuming messages (#1397)
    
    * 1.add SubscriptionInitialPosition option in ConsumerConfiguration to enable initial position when subscribing
    
    * 1.revert unrelated changes in ConsumerImpl 2.add subscriptionInitialPosition in ConsumerConfigurationData
    
    * 1.rename testOpenCursorOnLatestAndEarliest to testConsumerSubscriptionInitializePosition
    
    * 1.revert unrelated changes
    
    * correct doAnswer of asyncOpenCursor in test case

 .../apache/bookkeeper/mledger/ManagedLedger.java   |  36 ++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  35 ++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  32 +++++++
 .../broker/admin/impl/PersistentTopicsBase.java    |   3 +-
 .../org/apache/pulsar/broker/service/Consumer.java |   6 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   4 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   5 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   7 +-
 .../broker/service/persistent/PersistentTopic.java |  15 +--
 .../apache/pulsar/client/impl/RawReaderImpl.java   |   3 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |  17 ++--
 .../service/PersistentTopicConcurrentTest.java     |   9 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  57 +++++------
 .../pulsar/broker/service/ServerCnxTest.java       |   9 +-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   4 +
 .../pulsar/client/api/ConsumerConfiguration.java   |  20 +++-
 .../client/api/SubscriptionInitialPosition.java    |  36 +++++++
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   7 ++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   7 +-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   3 +-
 .../impl/conf/ConsumerConfigurationData.java       |   3 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 105 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   7 ++
 23 files changed, 360 insertions(+), 70 deletions(-)

commit 0068568aed1d1f3739fc55147f4f5565cf7de213
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Tue Mar 20 21:42:20 2018 +0900

    Add a page for events (#1403)
    
    * Add a page for events
    
    * Fix a broken link
    
    * Fix license header

 site/_includes/calendar.html | 22 ++++++++++++++++++++++
 site/_includes/navbar.html   |  1 +
 site/events/current-event.md | 32 ++++++++++++++++++++++++++++++++
 3 files changed, 55 insertions(+)

commit ef87567b11c8d1a1b5c3291cccf077b7a64a563e
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Mon Mar 19 23:26:59 2018 -0700

    Timeout task for batchMessageAndSendTask is not cancelled when close (#1405)
    
    * Timeout task for batchMessageAndSendTask is not cancelled when close
    
    * fix potential race
    
    * also fix the potential race in SendTimeout messages

 .../apache/pulsar/client/impl/ProducerImpl.java    | 26 ++++++++++++++++++----
 1 file changed, 22 insertions(+), 4 deletions(-)

commit 4cb4f114d552cee94ca3a9ea585e02bd1cdffd26
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Mar 19 18:46:03 2018 -0700

    Added trigger Function capability (#1402)
    
    * Added trigger functionality
    
    * Finished logic for trigger
    
    * Added admin side of changes
    
    * Added trigger impl in broker as well
    
    * Switched to comparing to message Id

 .../pulsar/broker/admin/impl/FunctionsBase.java    |  14 +++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  24 +++++
 .../org/apache/pulsar/client/admin/Functions.java  |  20 ++++
 .../client/admin/internal/FunctionsImpl.java       |  20 ++++
 .../instance/src/main/python/python_instance.py    |  37 ++++---
 .../functions/worker/rest/api/FunctionsImpl.java   | 113 ++++++++++++++++++++-
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  11 ++
 7 files changed, 215 insertions(+), 24 deletions(-)

commit bde65988deb5f2f121eb8a5fb9190d08063a52a7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 19 18:45:33 2018 -0700

    Build batching-awareness into round-robin message router (#1387)
    
    * Build batching-awareness into round-robin message router
    
    *Motivation*
    
    The default `SinglePartition` message router works well when you have more producers than the number of partitions.
    Howerver partitions will become idle if you have more partitions than producers. In the case of `producers` <= `partitions`,
    a round-robin message router works better. However the current round-robin messages router doesn't take `batching` into account.
    
    *Modification*
    
    Improve the current round-robin message router to build batching awareness into it. The round-robin messages router choose
    partition based on a randomly-chosen start partition id and the current milliseconds (round-up at the `maxBatchingDelayMs` boundary).
    This guarantees that at a given `maxBatchingDelayMs`, the message router is always choosing a same partition, this improves batching locality.
    
    * Fix FunctionResultRouter
    
    * Fix FunctionResultRouterTest
    
    * Address comments

 .../client/impl/PartitionedProducerImpl.java       |  7 +++-
 .../impl/RoundRobinPartitionMessageRouterImpl.java | 36 ++++++++++++++++++--
 .../RoundRobinPartitionMessageRouterImplTest.java  | 38 ++++++++++++++++++++--
 .../functions/instance/FunctionResultRouter.java   | 13 +++++++-
 .../instance/FunctionResultRouterTest.java         | 22 ++++++++++---
 5 files changed, 105 insertions(+), 11 deletions(-)

commit 9e874cbc3f0fbc4b3d30a66e0e7f7a5a749ac4b9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Mar 19 13:53:12 2018 -0700

    Fix JavaSerDeTest package name (#1406)

 .../java/org/apache/pulsar/functions/api/utils/JavaSerDeTest.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 440284e86a6baac741ef999ed3ebd607f996d412
Author: cckellogg <cckellogg@gmail.com>
Date:   Mon Mar 19 09:04:28 2018 -0700

    Make admin client namepsaces work with v2 rest endpoints. (#1404)

 .../org/apache/pulsar/client/admin/Namespaces.java |   1 +
 .../client/admin/internal/NamespacesImpl.java      | 226 ++++++++++-----------
 2 files changed, 105 insertions(+), 122 deletions(-)

commit 5e541fc70d9e7989d41f24e76a9cad88ecddbceb
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Mar 16 16:35:07 2018 -0700

    NPE in PersistentReplicator in Debug mode since messageId is not set during MessageImpl.deserialize (#1401)

 .../pulsar/broker/service/persistent/PersistentReplicator.java   | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

commit f6a8cb073969d9f88d6065db0ee01ce1b9876709
Author: cckellogg <cckellogg@gmail.com>
Date:   Fri Mar 16 15:23:23 2018 -0700

    Add V2 compatibility for pulsar admin persistent topics. (#1394)

 .../admin/internal/PersistentTopicsImpl.java       | 206 +++++++++++----------
 .../pulsar/client/admin/internal/WebTargets.java   |  35 ++++
 .../apache/pulsar/common/naming/NamespaceName.java |   8 +
 .../org/apache/pulsar/common/naming/TopicName.java |  24 ++-
 4 files changed, 172 insertions(+), 101 deletions(-)

commit 4ac71d4b275a9b6e95f81946564f0315e5f340a1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 16 14:45:35 2018 -0700

    Copy only needed files for building Python Instance (#1400)

 pulsar-functions/runtime/pom.xml | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit cdaec9ec6b35920b9de0d6b73c6a46d402bea6bd
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Mar 16 19:02:53 2018 +0100

    PulsarClusterMetadataSetup exits with non-zero on bad args (#1398)
    
    If a user passes bad arguments to PulsarClusterMetadataSetup, it
    should exit with non-zero. Otherwise, it will look like it
    succeeded (if run from a script).
    
    The fix is just to propagate the Exception after printing out the
    usage message.

 .../src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5b01d3b8d6da0fc8e2fd97bb9caead078718ee7a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 16 10:59:02 2018 -0700

    Correlate Output of function with input (#1382)
    
    * Attach information about which input topic/msgid triggered the function computation in any output
    
    * Address comments
    
    * Fixed unittest

 pulsar-client-cpp/python/pulsar.py                           |  2 +-
 .../org/apache/pulsar/functions/instance/JavaInstance.java   |  5 -----
 .../pulsar/functions/instance/JavaInstanceRunnable.java      | 12 +++++-------
 pulsar-functions/instance/src/main/python/python_instance.py |  4 +++-
 .../functions/instance/JavaInstanceRunnableProcessTest.java  |  9 ++++++++-
 5 files changed, 17 insertions(+), 15 deletions(-)

commit 833539ab2a9f8f920a4b135d73a73269235baa5d
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 15 15:26:32 2018 -0700

    Improved ManagedLedgerWriter to use multiple threads and configurable digest type (#1396)

 .../pulsar/testclient/ManagedLedgerWriter.java     | 140 ++++++++++++---------
 1 file changed, 79 insertions(+), 61 deletions(-)

commit 6fbd8c3c63c66cd1bfc08d04c2c553ffb78e0b55
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Mar 15 15:18:18 2018 -0700

    Functions metrics prometheus (#1373)
    
    * adding pulsar function stats to broker prometheus
    
    * refactoring class name
    
    * adding missing license header
    
    * refactoring code and removing function's metrics sink
    
    * fixing header
    
    * adding instance liveness check
    
    * adding null check
    
    * adding unittest

 conf/functions_worker.yml                          |   7 +-
 .../stats/prometheus/NamespaceStatsAggregator.java |   2 +-
 .../prometheus/PrometheusMetricsGenerator.java     |   6 +-
 .../stats/prometheus/PrometheusMetricsServlet.java |   1 -
 .../pulsar/broker/stats/prometheus/TopicStats.java |   2 +-
 .../org/apache/pulsar/utils/StatsOutputStream.java |   1 +
 .../pulsar/utils/SimpleTextOutputStreamTest.java   |   3 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   3 +-
 .../apache/pulsar/common/util}/NumberFormat.java   |   2 +-
 .../common/util}/SimpleTextOutputStream.java       |   9 +-
 .../pulsar/functions/runtime/JavaInstanceMain.java |  21 ++-
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  50 ++---
 pulsar-functions/worker/pom.xml                    |   6 +
 .../pulsar/functions/worker/FunctionActioner.java  |  11 +-
 .../functions/worker/FunctionRuntimeManager.java   |  24 +--
 .../functions/worker/FunctionsStatsGenerator.java  |  93 ++++++++++
 .../pulsar/functions/worker/WorkerConfig.java      |  28 +--
 .../pulsar/functions/worker/WorkerService.java     |  15 --
 .../pulsar/functions/worker/rest/Resources.java    |  21 ++-
 .../pulsar/functions/worker/rest/WorkerServer.java |  27 ++-
 .../worker/rest/api/FunctionsMetricsResource.java  |  61 +++++++
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |   1 -
 .../worker/FunctionRuntimeManagerTest.java         |   3 -
 .../worker/FunctionStatsGeneratorTest.java         | 201 +++++++++++++++++++++
 .../functions/worker/MembershipManagerTest.java    |   2 -
 .../functions/worker/SchedulerManagerTest.java     |   2 -
 26 files changed, 455 insertions(+), 147 deletions(-)

commit 672047c397f0c8e98ba3dceec9cc6e43f75331bd
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 15 12:23:33 2018 -0700

    Update to newer version of datasketches (#1393)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 7f587cbe471e78c58a31a78a13bc91e6a3239016
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 15 10:53:31 2018 -0700

    Fixed BK PrometheusProvider package name (#1379)

 conf/bookkeeper.conf | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit fee5667e91799433841ac4d1427717b61317263e
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Mar 15 18:52:57 2018 +0100

    Precommit integration test gate (#1392)
    
    * Precommit integration test gate
    
    Currently there are no integration tests in tree, so the job just
    builds the docker image.
    
    * fixup license

 .test-infra/jenkins/common_job_properties.groovy   | 28 +++++----
 .../job_pulsar_precommit_integrationtests.groovy   | 67 ++++++++++++++++++++++
 tests/scripts/post-integ-tests.sh                  | 22 +++++++
 tests/scripts/pre-integ-tests.sh                   | 29 ++++++++++
 4 files changed, 136 insertions(+), 10 deletions(-)

commit 9ee682b028f4eaed4787779dd51bfb1e0e8b8c07
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Mar 15 17:43:57 2018 +0100

    Make close on RawMessage idempotent (#1390)
    
    Closing a raw message twice should not corrupt memory.

 .../src/main/java/org/apache/pulsar/client/impl/RawMessageImpl.java   | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit dc34ab67b8656a92625d6d52a8c2d624802486ed
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Mar 15 09:26:50 2018 -0700

    Standardize on input/output terminology for Pulsar Functions (#1378)
    
    * fix usage of 'sink' terminology
    
    * fix usages of 'source'
    
    * fix additional usages

 pulsar-client-cpp/python/functions/context.py      |   4 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  56 +++++------
 .../org/apache/pulsar/functions/api/Context.java   |  12 +--
 .../pulsar/functions/instance/ContextImpl.java     |  16 ++--
 .../pulsar/functions/instance/JavaInstance.java    |   4 +-
 .../functions/instance/JavaInstanceRunnable.java   |  96 +++++++++----------
 ...rs.java => AbstractOneOuputTopicProducers.java} |  10 +-
 ...a => MultiConsumersOneOuputTopicProducers.java} |  12 +--
 ...cers.java => SimpleOneOuputTopicProducers.java} |  10 +-
 .../instance/src/main/python/contextimpl.py        |   2 +-
 .../src/main/python/python_instance_main.py        |  32 +++----
 .../instance/JavaInstanceRunnableProcessTest.java  |  16 ++--
 ...MultiConsumersOneOutputTopicProducersTest.java} |  16 ++--
 ...java => SimpleOneOutputTopicProducersTest.java} |  16 ++--
 .../pulsar/functions/runtime/JavaInstanceMain.java |  34 +++----
 .../pulsar/functions/runtime/ProcessRuntime.java   |  26 ++---
 .../functions/runtime/ProcessRuntimeTest.java      |  14 +--
 pulsar-functions/submit-python-function.sh         |   4 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 106 ++++++++++-----------
 19 files changed, 243 insertions(+), 243 deletions(-)

commit cad20399f410eb274029614e571fd543975e3656
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Mar 15 00:10:59 2018 -0700

    Prepare admin client to support v2 api. (#1384)
    
    * Prepare admin client to support v2 api.
    
    * Fix admin with functions.

 .../apache/pulsar/broker/admin/AdminApiTest.java   |   2 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  25 ++---
 .../client/admin/internal/BrokerStatsImpl.java     |  18 ++--
 .../pulsar/client/admin/internal/BrokersImpl.java  |  16 ++--
 .../pulsar/client/admin/internal/ClustersImpl.java |  37 ++++----
 .../client/admin/internal/NamespacesImpl.java      | 105 +++++++++++----------
 .../admin/internal/NonPersistentTopicsImpl.java    |  18 ++--
 .../admin/internal/PersistentTopicsImpl.java       |  62 ++++++------
 .../client/admin/internal/PropertiesImpl.java      |  18 ++--
 .../client/admin/internal/ResourceQuotasImpl.java  |  14 +--
 .../client/admin/PulsarAdminWithFunctions.java     |   2 +-
 .../client/admin/internal/FunctionsImpl.java       |   2 +-
 12 files changed, 166 insertions(+), 153 deletions(-)

commit 323f4f1ca2d0dee0b9b1aac55533ca8b36a30586
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Mar 15 00:10:12 2018 -0700

    Improve sync send logic for allowing batching (#1386)
    
    *Motivation*
    
    Batching is required for achieving high performance messaging. If we want to flip the default behaviour of publishers into batch publishing,
    we need to improve current send logic to flush out batches after enqueuing the send requests. so batch settings won't impact sync sends.
    
    *Modification*
    
    - add a flush() method on single partition producer
    - break the send logic on single partition producer to `enqueue-flush-wait`
    - change multi-partitions producer to use single partition producer

 .../client/impl/PartitionedProducerImpl.java       |  8 +++++
 .../apache/pulsar/client/impl/ProducerBase.java    | 17 -----------
 .../apache/pulsar/client/impl/ProducerImpl.java    | 34 ++++++++++++++++++++++
 3 files changed, 42 insertions(+), 17 deletions(-)

commit e118a22520e5cc7ac6e3eb4b737cd0d2002084ff
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Mar 14 22:05:18 2018 -0700

    Fix java docs (#1389)

 pulsar-client/src/main/java/org/apache/pulsar/client/api/Reader.java | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 5c31b2ec9bc48f55a042aaa28a005c40b1971885
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Mar 14 20:34:47 2018 -0700

    remove function package on function delete (#1385)
    
    * remove function package on function delete
    
    * using apache commons for deletion
    
    * refactoring
    
    * removing unnecessary import
    
    * removing unncessary dependency

 .../pulsar/functions/worker/FunctionActioner.java  | 39 ++++++++++++++++------
 1 file changed, 29 insertions(+), 10 deletions(-)

commit e0c9e7ae6adc29ad9ddbf93c6d01e09faafdb645
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Mar 14 22:36:54 2018 +0100

    Add compactedOut flag for batched messages (#1361)
    
    * Add compactedOut flag for batched messages
    
    If batched messages are to be compactable without changing their
    message ids, we need to be able to pad out the batch with empty
    messages, so that the batch index does not change.
    
    For this purpose, this patch introduces a flag, compactedOut. If a
    message in the batch has this flag, it will not be passed to the
    consumer.

 .../client/impl/CompactedOutBatchMessageTest.java  | 94 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  8 ++
 .../org/apache/pulsar/common/api/Commands.java     | 36 +++++----
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 +++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  1 +
 5 files changed, 182 insertions(+), 14 deletions(-)

commit 80dc0deb86f2d8a58563094c24913968e24099d3
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Wed Mar 14 00:16:57 2018 -0600

    Schema registry 3/N (#1363)
    
    * Schema Registry proto changes
    
    * Infrastructure to store schemas
    
    * A default schema registry implementation
    
    * Renumber schema fields
    
    * Update Pulsar API with schema changes
    
    * Revert field number change
    
    * Fix merge conflict
    
    * Fix broken merge
    
    * Address issues in review
    
    * Add schema type back to proto definition
    
    * Address comments regarding lombok usage
    
    * Remove reserved future enum fields
    
    * regenerate code from protobuf
    
    * Remove unused code
    
    * Add schema version to producer success message
    
    * plumb schema through to producer
    
    * Revert "Add schema version to producer success message"
    
    This reverts commit e7e72f468cf46f1605524a7399520c22763583c9.
    
    * Revert "Revert "Add schema version to producer success message""
    
    This reverts commit 7b902f6bdb1cb054e26577747ff4dd8c326a6248.
    
    * Persist schema on producer connect
    
    * Add principal to schema on publish
    
    * Reformat function for readability
    
    * Remove unused protoc profile
    
    * Rename put on schema registry to putIfAbsent
    
    * Reformat function for readability
    
    * Remove unused protoc profile
    
    * Rename put on schema registry to putIfAbsent
    
    * fix compile errors from parent branch changes
    
    * fix lombok tomfoolery on builder
    
    * plumb hash through and allow lookup by data
    
    * wip
    
    * run tests
    
    * wip: address review comments
    
    * switch underscore to slash in schema name
    
    * blah
    
    * Get duplicate schema detection to work
    
    * Fix protobuf version incompatibility
    
    * fix merge issues
    
    * Fix license headers
    
    * Address review

 .../service/schema/BookkeeperSchemaStorage.java    |  479 ++++++
 .../schema/BookkeeperSchemaStorageFactory.java     |   33 +
 .../broker/service/schema/LongSchemaVersion.java   |   69 +
 .../service/schema/SchemaRegistryServiceImpl.java  |   12 +-
 .../broker/service/schema/SchemaStorage.java       |    2 +-
 .../broker/service/schema/SchemaStorageFormat.java | 1785 ++++++++++++++++++++
 .../src/main/proto/SchemaStorageFormat.proto       |   44 +
 .../service/BrokerServiceThrottlingTest.java       |    2 +
 .../broker/service/schema/SchemaServiceTest.java   |  255 +++
 .../apache/pulsar/common/schema/SchemaData.java    |    4 +-
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    |   21 +
 11 files changed, 2702 insertions(+), 4 deletions(-)

commit 9251a4488c10c47e307fa0f1ebf7cb8ee3c2186a
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Mar 13 23:03:28 2018 -0700

    Issue 1118: refine HandlerBase to let only ConsumerImpl and ProducerImpl have client-cnx (#1354)
    
    * refine handlerBase
    
    * change following @sijie's comments

 .../client/impl/BrokerClientIntegrationTest.java   |   2 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |   7 +-
 .../{HandlerBase.java => ConnectionHandler.java}   | 129 ++++++++-------------
 .../apache/pulsar/client/impl/ConsumerBase.java    |   9 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  47 +++++++-
 .../apache/pulsar/client/impl/HandlerState.java    |  69 +++++++++++
 .../client/impl/PartitionedConsumerImpl.java       |  14 +--
 .../client/impl/PartitionedProducerImpl.java       |  10 --
 .../apache/pulsar/client/impl/ProducerBase.java    |   5 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  56 +++++++--
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  14 +--
 11 files changed, 217 insertions(+), 145 deletions(-)

commit 381ccc07e03d45a0ae3f5ccecef56c08cf4de089
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Mar 13 14:33:51 2018 -0700

    Renamed PulsarFunction to plain Function (#1377)

 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  6 ++---
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 21 ++++++++--------
 .../api/{PulsarFunction.java => Function.java}     |  2 +-
 .../functions/api/utils/DefaultSerDeTest.java      |  6 ++---
 .../pulsar/functions/instance/JavaInstance.java    | 17 ++++++-------
 .../functions/instance/JavaInstanceRunnable.java   | 16 ++++++------
 .../instance/JavaInstanceRunnableProcessTest.java  |  9 +++----
 .../instance/JavaInstanceRunnableTest.java         | 29 +++++++++++-----------
 .../functions/instance/JavaInstanceTest.java       |  4 +--
 .../functions/api/examples/CounterFunction.java    |  4 +--
 .../api/examples/ExclamationFunction.java          |  4 +--
 .../functions/api/examples/LoggingFunction.java    |  4 +--
 .../functions/api/examples/PublishFunction.java    |  4 +--
 .../functions/api/examples/UserConfigFunction.java |  4 +--
 .../functions/api/examples/UserMetricFunction.java |  4 +--
 .../functions/api/examples/VoidFunction.java       |  4 +--
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |  4 +--
 site/docs/latest/functions/api.md                  |  2 +-
 18 files changed, 70 insertions(+), 74 deletions(-)

commit e7e340c479f88f2696a4d655776d0af4f601a3ab
Author: cckellogg <cckellogg@gmail.com>
Date:   Tue Mar 13 14:26:28 2018 -0700

    Fix partitioned topic update for admin v2 api. (#1376)

 .../apache/pulsar/broker/admin/AdminResource.java  | 15 +++++++-
 .../apache/pulsar/broker/admin/ZkAdminPaths.java   | 43 ++++++++++++++++++++++
 .../broker/admin/impl/PersistentTopicsBase.java    | 17 ++++-----
 3 files changed, 64 insertions(+), 11 deletions(-)

commit 2f6de5746b644b548cc4e6e0eb4d48f26e901809
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Mar 13 11:34:24 2018 -0700

    add byte array to default pulsar functions serde (#1372)

 .../org/apache/pulsar/functions/api/utils/DefaultSerDe.java    | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit 55d3ff02d32e8af729610f1db6128b371857602d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 13 10:30:26 2018 -0700

    Update log size limit to 1GB (#1374)
    
    https://issues.apache.org/jira/browse/BOOKKEEPER-833

 conf/bookkeeper.conf | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e5aebce110837a4ff02f9af3bb125f28cb80c309
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Mar 13 18:23:38 2018 +0100

    Allow override of redirectTestOutput from CLI (#1366)
    
    If a maven option is set in the configuration, it's impossible to
    override from the commandline. Sometimes, you want to be able to see
    the output of a test on the commandline, such as in the case where the
    test is hanging. This patch adds a property, so that the default
    configuration of redirecting test output to a file can be overridden.

 pom.xml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 933320223fc281642bdaff3e9b2aa7314c5754b4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Mar 13 09:22:35 2018 -0700

    Moved Python Api to a functions module inside pulsar client python module (#1375)

 .../api-python => pulsar-client-cpp/python/functions}/__init__.py   | 2 +-
 .../api-python => pulsar-client-cpp/python/functions}/context.py    | 0
 .../python/functions/function.py                                    | 6 +++---
 .../api-python => pulsar-client-cpp/python/functions}/serde.py      | 0
 pulsar-client-cpp/python/pulsar.py                                  | 3 +++
 pulsar-functions/instance/src/main/python/contextimpl.py            | 4 ++--
 pulsar-functions/instance/src/main/python/python_instance_main.py   | 2 +-
 pulsar-functions/instance/src/main/python/util.py                   | 2 +-
 pulsar-functions/python-examples/exclamation.py                     | 4 ++--
 pulsar-functions/python-examples/logfunction.py                     | 4 ++--
 pulsar-functions/python-examples/thumbnailer.py                     | 4 ++--
 pulsar-functions/runtime/pom.xml                                    | 3 +--
 12 files changed, 18 insertions(+), 16 deletions(-)

commit 4cc20df55e6e3cddbd7e8947b14d81c573b3ac29
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Tue Mar 13 22:47:30 2018 +0900

    Fix CID 262329 (#1258)
    
    * Fix CID 262329
    
    * Fix a test that didn't expect the exception

 .../pulsar/common/util/protobuf/ByteBufCodedInputStream.java       | 2 +-
 .../pulsar/common/util/protobuf/ByteBufCodedInputStreamTest.java   | 7 ++++++-
 2 files changed, 7 insertions(+), 2 deletions(-)

commit b5068bb9bdf20177905ec007e6ca8913f7b652e5
Author: Daniel Jorge <daniel.jorge@sticorp.com.br>
Date:   Mon Mar 12 22:42:00 2018 -0300

    Allow to set BacklogQuota when RetentionSizeInMB is set to -1 (#1368)
    
    I think 1.22 introduced a small bug that prevent setting BacklogQuota at all when RetentionSizeInMB is set to -1, always throwing "Backlog Quota exceeds configured retention quota for namespace"

 .../main/java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 662ac9b8f4e9b0ea46cee3ddd96cc95fa691ca63
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 12 18:41:24 2018 -0700

    Relocate service files for shading `pulsar-client-admin` module (#1370)
    
    * Relocate service files for shading `pulsar-client-admin` module
    
    * Relocate service in `pulsar-client-shaded` as well

 pom.xml                            | 2 +-
 pulsar-client-admin-shaded/pom.xml | 4 ++++
 pulsar-client-shaded/pom.xml       | 4 ++++
 3 files changed, 9 insertions(+), 1 deletion(-)

commit e543a77c99661f72e9e59c92963202419b8d13ed
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 12 12:52:57 2018 -0700

    Allow to configure BK digest type in broker configuration (#1369)

 conf/broker.conf                                   |  4 +++
 conf/standalone.conf                               |  4 +++
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  2 +-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  2 +-
 .../mledger/impl/ManagedLedgerBkTest.java          | 35 +++++++++++++++++++++-
 .../bookkeeper/test/BookKeeperClusterTestCase.java |  1 +
 .../apache/pulsar/broker/ServiceConfiguration.java | 30 ++++++++++++++-----
 .../PulsarConfigurationLoaderTest.java             |  3 ++
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |  1 +
 .../pulsar/broker/service/BrokerService.java       |  2 +-
 .../org/apache/pulsar/common/util/FieldParser.java | 13 ++++++++
 11 files changed, 85 insertions(+), 12 deletions(-)

commit eb526269d23b98c155012444e186f8f4bac6f967
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 9 22:16:36 2018 -0800

    Added slides for Effectively-once semantics in Apache Pulsar (#1364)

 site/_data/resources/presentations.yaml | 18 +++++++++++++-----
 1 file changed, 13 insertions(+), 5 deletions(-)

commit f04eb517e40ea23779fc7c0264c3537dd7d6671f
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Thu Mar 8 15:35:09 2018 -0700

    Schema registry (2/N) (#1319)
    
    * Schema Registry proto changes
    
    * Infrastructure to store schemas
    
    * Renumber schema fields
    
    * Update Pulsar API with schema changes
    
    * Revert field number change
    
    * Fix merge conflict
    
    * Fix broken merge
    
    * Address issues in review
    
    * Add schema type back to proto definition
    
    * Address comments regarding lombok usage
    
    * Remove reserved future enum fields
    
    * regenerate code from protobuf
    
    * Remove unused code
    
    * Add schema version to producer success message
    
    * plumb schema through to producer
    
    * Revert "Add schema version to producer success message"
    
    This reverts commit e7e72f468cf46f1605524a7399520c22763583c9.
    
    * Revert "Revert "Add schema version to producer success message""
    
    This reverts commit 7b902f6bdb1cb054e26577747ff4dd8c326a6248.
    
    * Persist schema on producer connect
    
    * Add principal to schema on publish
    
    * Reformat function for readability
    
    * Remove unused protoc profile
    
    * Rename put on schema registry to putIfAbsent
    
    * wip: address review comments
    
    * switch underscore to slash in schema name
    
    * blah
    
    * Fix protobuf version incompatibility
    
    * Add appropriate license headers

 pom.xml                                            |   14 +
 .../apache/pulsar/broker/ServiceConfiguration.java |   12 +-
 pulsar-broker/pom.xml                              |    6 +
 .../org/apache/pulsar/broker/PulsarService.java    |   21 +-
 .../org/apache/pulsar/broker/service/Producer.java |   23 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  122 +-
 .../org/apache/pulsar/broker/service/Topic.java    |    8 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   30 +-
 .../broker/service/persistent/PersistentTopic.java |   11 +
 .../schema/DefaultSchemaRegistryService.java       |   57 +
 .../broker/service/schema/SchemaRegistry.java      |   79 ++
 .../service/schema/SchemaRegistryService.java      |   46 +
 .../service/schema/SchemaRegistryServiceImpl.java  |  190 +++
 .../broker/service/schema/SchemaStorage.java       |   36 +
 .../service/schema/SchemaStorageFactory.java       |   27 +
 .../pulsar/broker/service/schema/StoredSchema.java |   68 +
 .../service/schema/proto/SchemaRegistryFormat.java | 1373 ++++++++++++++++++++
 .../src/main/proto/SchemaRegistryFormat.proto      |   45 +
 .../pulsar/broker/service/PersistentTopicTest.java |   15 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   19 +-
 .../apache/pulsar/client/api/ClientErrorsTest.java |   16 +-
 .../pulsar/client/api/MockBrokerService.java       |    3 +-
 .../org/apache/pulsar/common/api/Commands.java     |   14 +-
 .../org/apache/pulsar/common/naming/TopicName.java |    6 +
 .../apache/pulsar/common/schema/EmptyVersion.java  |   28 +
 .../apache/pulsar/common/schema/LatestVersion.java |   28 +
 .../apache/pulsar/common/schema/SchemaData.java    |   34 +
 .../apache/pulsar/common/schema/SchemaType.java    |   23 +
 .../apache/pulsar/common/schema/SchemaVersion.java |   26 +
 29 files changed, 2281 insertions(+), 99 deletions(-)

commit e35087c3d3ec7613060f50f56f5b4975a86d42c3
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Mar 8 19:02:30 2018 +0100

    Fix race in PersistentTopicTest#testClosingReplicationProducerTwice (#1360)
    
    A race existed where the replicator was making a startProducer call on
    construction before the client was mocked. This startProducer would
    fail on producer creation, which would trigger a backoff and a
    retry. If this fell exactly the wrong way, it could cause
    createProducerAsync to be called multiple times on the mock before the
    check, which would fail the test.
    
    This fix addresses issue #617 and it's duplicate #1145

 .../java/org/apache/pulsar/broker/service/PersistentTopicTest.java | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit e5ac5f079d64681d59193064d87d589ec971d094
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Mar 8 09:58:34 2018 -0800

    Pulsar Functions documentation follow-up (#1357)
    
    * add new docs to sidebar
    
    * begin documenting programming model and context object
    
    * comment out docs from sidebar (for now)
    
    * add initial steps to quickstart
    
    * cosmetic changes to example java functions
    
    * fix spelling in exception
    
    * small changes to quickstart doc
    
    * add instructions for new python function
    
    * s/not/now
    
    * put reversed string in code block
    
    * add final sentence
    
    * undo changes to example functions
    
    * undo change to exception output

 site/_data/sidebar.yaml                  |  16 ++
 site/_sass/_docs.scss                    |   1 +
 site/docs/latest/functions/api.md        |  71 ++++++++-
 site/docs/latest/functions/quickstart.md | 256 +++++++++++++++++++++++++++++--
 4 files changed, 330 insertions(+), 14 deletions(-)

commit 6b24ab9cbb7a4d471c05c7244b84243936cba4f6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Mar 7 13:02:33 2018 -0800

    Log Topic for Functions (#1356)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   5 +
 .../instance/src/main/python/Function_pb2.py       | 153 +++++++++++++++------
 pulsar-functions/instance/src/main/python/log.py   |   4 +-
 .../proto/src/main/proto/Function.proto            |   1 +
 pulsar-functions/python-examples/logfunction.py    |  30 ++++
 .../pulsar/functions/runtime/JavaInstanceMain.java |   6 +
 .../pulsar/functions/runtime/ProcessRuntime.java   |   5 +
 .../functions/runtime/ProcessRuntimeTest.java      |   7 +-
 8 files changed, 164 insertions(+), 47 deletions(-)

commit dad679ae1392bef4be67c654bcb7d19de79be266
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Mar 7 19:25:26 2018 +0100

    CompactedTopic should seek to position of cursor, not next position (#1336)
    
    * CompactedTopic should seek to position of cursor, not next position
    
    When finding the first ledger entry to read from while reading from a
    compacted topic ledger, we should find the position represented by the
    cursor read position, not the next position after as has been done
    until now.
    
    This bug was due to a misunderstanding of how the read position
    works. It was assumed it worked the same as the mark-delete position,
    which is not the case.
    
    * Fix clash on message cleanup

 .../pulsar/compaction/CompactedTopicImpl.java      |  6 +--
 .../pulsar/compaction/CompactedTopicTest.java      | 27 ++++++------
 .../apache/pulsar/compaction/CompactionTest.java   | 48 ++++++++++++++++++++++
 3 files changed, 63 insertions(+), 18 deletions(-)

commit a8a595d9124d274f030cabff230e3bddc76cc241
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Mar 7 07:29:23 2018 -0800

    Have the ability to send log messages to a topic in Python (#1353)
    
    * Have the ability to send log messages to a topic in Python
    
    * Address review comments

 pulsar-functions/instance/src/main/python/log.py   | 26 ++++++++++++++++++++--
 .../instance/src/main/python/python_instance.py    | 16 ++++++++++++-
 .../src/main/python/python_instance_main.py        |  4 +++-
 3 files changed, 42 insertions(+), 4 deletions(-)

commit a0623d57f0ac680c589197d3a973c4760d3493ae
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Mar 6 22:51:55 2018 -0800

    Pulsar Functions documentation (#1350)
    
    The first cut of pulsar-functions documentation.

 site/_data/popovers.yaml                           |  3 +
 site/_data/pulsar-functions.yaml                   | 85 ++++++++++++++++++++
 site/docs/latest/functions/api.md                  | 76 ++++++++++++++++++
 site/docs/latest/functions/deployment.md           |  9 +++
 site/docs/latest/functions/guarantees.md           | 28 +++++++
 site/docs/latest/functions/metrics-and-stats.md    | 19 +++++
 site/docs/latest/functions/overview.md             | 91 ++++++++++++++++++++++
 site/docs/latest/functions/quickstart.md           | 29 +++++++
 .../getting-started/ConceptsAndArchitecture.md     |  4 +
 9 files changed, 344 insertions(+)

commit 0ac6b9aaf49ce9e3d0fcd5a856cdec48a2fdd546
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 6 21:56:20 2018 -0800

    Shade pulsar-functions-runtime instead of pulsar-functions-worker (#1351)

 all/pom.xml                                        |   9 +
 all/src/assemble/bin.xml                           |   2 +-
 bin/pulsar                                         |   2 +-
 bin/pulsar-admin                                   |   2 +-
 pom.xml                                            |   9 +-
 pulsar-broker/pom.xml                              |  94 ++---------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   4 +-
 pulsar-client-tools/pom.xml                        |  77 +--------
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   6 +-
 pulsar-common/pom.xml                              |  11 +-
 pulsar-functions/pom.xml                           |   2 +
 pulsar-functions/runtime-all/pom.xml               | 169 +++++++++++++++++++
 pulsar-functions/runtime-shaded/pom.xml            | 182 +++++++++++++++++++++
 pulsar-functions/runtime/pom.xml                   |  34 ----
 .../pulsar/functions/runtime/ProcessRuntime.java   |  29 ++++
 pulsar-functions/utils/pom.xml                     |  14 ++
 pulsar-functions/worker-shaded/pom.xml             |  34 ++++
 pulsar-functions/worker/pom.xml                    |  80 ++++++++-
 .../functions/worker/FunctionAssignmentTailer.java |   3 +-
 .../worker/FunctionMetaDataTopicTailer.java        |   3 +-
 .../functions/worker/SchedulerManagerTest.java     |  22 +--
 21 files changed, 566 insertions(+), 222 deletions(-)

commit e0fb00b3dddc4eb091e010b995ece3caf13dcc0f
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Mar 7 01:44:19 2018 +0100

    Base module for Arquillian integration tests (#1349)
    
    Pulls in dependencies needed by all Arquillian integration tests, and
    configures surefire with enough memory. It also configures surefire
    tests to only run when the "integrationTests" system property is
    defined.
    
    All arquillian integration tests should set this module as their
    parent.

 tests/integration-tests-base/pom.xml | 108 +++++++++++++++++++++++++++++++++++
 tests/pom.xml                        |   1 +
 2 files changed, 109 insertions(+)

commit 9c6e124e2077c6a59d81b3b4de7866b9ac79a998
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Mar 7 01:43:03 2018 +0100

    Log phases in two phase compaction (#1335)
    
    Log when each phase in two phase compaction starts so that if it
    stalls we have something to debug by.

 .../src/main/java/org/apache/pulsar/client/api/RawReader.java |  7 +++++++
 .../java/org/apache/pulsar/client/impl/RawReaderImpl.java     | 11 +++++++++++
 .../java/org/apache/pulsar/compaction/TwoPhaseCompactor.java  |  9 +++++++--
 3 files changed, 25 insertions(+), 2 deletions(-)

commit e82ff7e3d5afc736e1ec4e39e165b062255b025a
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Mar 6 16:01:28 2018 -0800

    adding max retries for assignment write wait (#1348)
    
    * adding max retries for assignment write wait.  Also fix issue with SchedulerAssignmentTest
    
    * cleaning up tests
    
    * cleaning up formatting

 conf/functions_worker.yml                          |  1 +
 .../pulsar/functions/worker/SchedulerManager.java  |  6 +++
 .../pulsar/functions/worker/WorkerConfig.java      |  1 +
 .../functions/worker/SchedulerManagerTest.java     | 44 ++++++++--------------
 4 files changed, 23 insertions(+), 29 deletions(-)

commit da142eb839d6ffa384b4683de86c94056ad150aa
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Mar 6 13:33:14 2018 -0800

    Cleanup failed connection from background thread (#1345)
    
    This is a fix for #1138

 .../java/org/apache/pulsar/broker/service/ReplicatorTest.java    | 9 +--------
 .../main/java/org/apache/pulsar/client/impl/ConnectionPool.java  | 8 +++++---
 2 files changed, 6 insertions(+), 11 deletions(-)

commit 2c5ef2dfbef31fba391c9eeb94c80b6e002bd9c2
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Mar 7 04:05:43 2018 +0900

    Make it possible to get namespaces owned by broker when TLS is enabled (#1346)

 .../apache/pulsar/broker/admin/AdminResource.java  |  4 +++-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 22 ++++++++++++++++++++++
 2 files changed, 25 insertions(+), 1 deletion(-)

commit a28c2cfcdd8d167064b09812c2773d617c427e48
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Mar 6 17:00:52 2018 +0100

    Arquillian topologies for integration testing (#1333)
    
    Module to distribute arquillian topologies for integration
    testing. I've put them in a module so multiple tests can share the
    same topology.
    
    There is currently only one topology. This runs a single pulsar
    cluster with:
    - 1 local zookeeper container
    - 1 global zookeeper container
    - 3 bookkeeper bookie containers
    - 2 pulsar brokers (unstarted)
    - 1 pulsar proxy (unstarted)

 tests/integration-tests-topologies/pom.xml         |  40 +++++
 ...single-cluster-3-bookie-2-broker-unstarted.yaml | 182 +++++++++++++++++++++
 tests/pom.xml                                      |   1 +
 3 files changed, 223 insertions(+)

commit 350037a2d2cf5d1bacf28b119cc560feebad0de0
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Mar 6 08:00:14 2018 -0800

    Make default processing guarantee AT_LEAST_ONCE (#1340)
    
    * Make default processing guarantee AT_LEAST_ONCE
    
    * add a simple test to ensure default processing guarantee is ATLEAST_ONCE
    remove nullcheck since protobuf handles that

 .../functions/instance/JavaInstanceRunnable.java   |  8 ++---
 .../proto/src/main/proto/Function.proto            |  4 +--
 .../pulsar/functions/proto/FunctionConfigTest.java | 41 ++++++++++++++++++++++
 .../pulsar/functions/runtime/ProcessRuntime.java   |  6 +---
 .../functions/runtime/ProcessRuntimeTest.java      |  4 +--
 5 files changed, 48 insertions(+), 15 deletions(-)

commit 557166afe50239918eac37be6cbf5f56fd41aabe
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Mar 6 06:10:45 2018 -0800

    Added pulsar-1.22.0-incubating to site configuration (#1330)

 site/_config.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit e9e31c7ddea24d5f4e0edbb24f003327d5f47b11
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 5 21:46:44 2018 -0800

     Merge pulsar-functions dist package into pulsar binary distribution (#1332)
    
    * Move pulsar functions dependency version to root pom and remove duplicated license headers
    
    This addresses some comments in pulsar functions PR #1314
    
    * shade worker
    
    * Fix broken master
    
    * Upgrade the bookkeeper storage client dependency to the official bookkeeper version
    
    This removes the temp dependency in `pulsar-functions-instance`
    
    * set `protobuf2.version` in pulsar-common
    
    * provide a shaded worker
    
    * include worker dependency at broker
    
    * Embeded function worker at broker
    
    * rename 'function worker' to 'functions worker'
    
    * add "--no-functions-worker" for pulsar-client-cpp tests
    
    * Integrate function cli into pulsar-admin cli
    
    - rename `pulsar-client-tools-shaded` to `pulsar-client-admin-shaded-for-functions`, because this module is used by functions only to avoid protobuf conflicts
    - move protobuf3 references to Utils, so it won't be referenced out side of pulsar-functions
    - integrate function cli into pulsar-admin cli
    
    * Merge pulsar-functions dist package into pulsar binary distribution
    
    * Fix license header issues
    
    * Fixed ZK cache test exectutor configuration.
    
    Fixes #1338

 all/pom.xml                                |   9 ++
 all/src/assemble/bin.xml                   |  14 +++
 pulsar-functions/bin/pulsar                | 192 -----------------------------
 pulsar-functions/bin/pulsar-functions      | 148 ----------------------
 pulsar-functions/conf/client.conf          |  27 ----
 pulsar-functions/conf/function_worker.yml  |  46 -------
 pulsar-functions/conf/log4j2.yml           | 167 -------------------------
 pulsar-functions/conf/pulsar_env.sh        |  60 ---------
 pulsar-functions/conf/pulsar_tools_env.sh  |  60 ---------
 pulsar-functions/dist/pom.xml              | 103 ----------------
 pulsar-functions/dist/src/assemble/bin.xml |  83 -------------
 pulsar-functions/dist/src/assemble/src.xml |  92 --------------
 pulsar-functions/pom.xml                   |   2 -
 pulsar-functions/worker-runner/pom.xml     | 111 -----------------
 14 files changed, 23 insertions(+), 1091 deletions(-)

commit 9503274b4b298cb47cd1e9f42716cbdd26367724
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 5 20:02:46 2018 -0800

    Fixed ZK cache test exectutor configuration. (#1343)
    
    Fixes #1338

commit 6230ab4542c733f3390bd7ae7d4d6b0d5a661fb1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 5 18:46:30 2018 -0800

     Integrate function cli into pulsar-admin cli (#1331)
    
    * Move pulsar functions dependency version to root pom and remove duplicated license headers
    
    This addresses some comments in pulsar functions PR #1314
    
    * shade worker
    
    * Fix broken master
    
    * Upgrade the bookkeeper storage client dependency to the official bookkeeper version
    
    This removes the temp dependency in `pulsar-functions-instance`
    
    * set `protobuf2.version` in pulsar-common
    
    * provide a shaded worker
    
    * include worker dependency at broker
    
    * Embeded function worker at broker
    
    * rename 'function worker' to 'functions worker'
    
    * add "--no-functions-worker" for pulsar-client-cpp tests
    
    * Integrate function cli into pulsar-admin cli
    
    - rename `pulsar-client-tools-shaded` to `pulsar-client-admin-shaded-for-functions`, because this module is used by functions only to avoid protobuf conflicts
    - move protobuf3 references to Utils, so it won't be referenced out side of pulsar-functions
    - integrate function cli into pulsar-admin cli
    
    * Fix license header issues
    
    * Fixed ZK cache test exectutor configuration.
    
    Fixes #1338

 bin/pulsar-admin                                   | 53 ++++++++++--
 {pulsar-functions/conf => conf}/example.yml        |  0
 pom.xml                                            |  2 +-
 .../pom.xml                                        | 13 +--
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  7 +-
 .../src/test/resources/test_function_config.yml    |  0
 pulsar-client-tools/pom.xml                        | 85 +++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 14 +--
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   | 35 +++++++-
 .../org/apache/pulsar/client/admin/Functions.java  |  0
 .../client/admin/PulsarAdminWithFunctions.java     |  8 +-
 .../client/admin/internal/FunctionsImpl.java       | 16 ++--
 pulsar-functions/cli/pom.xml                       | 59 -------------
 .../org/apache/pulsar/admin/cli/FunctionsTool.java | 99 ----------------------
 .../org/apache/pulsar/admin/cli/package-info.java  | 24 ------
 pulsar-functions/cli/src/test/resources/log4j2.yml | 37 --------
 pulsar-functions/conf/example_logging.yml          | 27 ------
 pulsar-functions/dist/pom.xml                      |  6 --
 .../pulsar/functions/metrics/sink/FileSink.java    |  4 +-
 pulsar-functions/pom.xml                           |  1 -
 pulsar-functions/utils/pom.xml                     |  2 +-
 .../functions/utils/FunctionConfigUtils.java       |  3 +-
 .../org/apache/pulsar/functions/utils/Utils.java   | 12 +++
 pulsar-functions/worker-shaded/pom.xml             |  4 +-
 .../functions/worker/FunctionRuntimeManager.java   |  7 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 16 ++--
 .../worker/rest/api/v2/FunctionApiV2Resource.java  |  3 +-
 .../rest/api/v2/FunctionApiV2ResourceTest.java     | 70 +++++++--------
 .../pulsar/zookeeper/ZookeeperCacheTest.java       |  2 +-
 29 files changed, 258 insertions(+), 351 deletions(-)

commit a6e65eb28414164fa01029685bc7240f93d9be13
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 5 18:46:13 2018 -0800

    Use log4j2.xml in buildtools and specify the log4j configuration in surefire plugin (#1344)
    
    * Use log4j2.xml in buildtools and specify the log4j configuration in surefire plugin
    
    It seems there is SAXProcess exception when using yaml file when the yaml file is in a jar. log4j2 misinterprets yml as an xml file.
    
    Change it to use xml file and specify that in the surefire plugin
    
    * Add class and linenumber

 buildtools/src/main/resources/log4j2.xml | 34 ++++++++++++++++++++++++++
 buildtools/src/main/resources/log4j2.yml | 41 --------------------------------
 pom.xml                                  |  1 +
 3 files changed, 35 insertions(+), 41 deletions(-)

commit 1013f0490b6cae30849c06000a2d337618171e61
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 5 18:08:10 2018 -0800

    Ignore log4j coming from bookkeeper-server:tests (#1342)

 pom.xml | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 0dfe3fae6f0f39ad9f1fade389a5af8e9e141201
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 5 16:45:05 2018 -0800

    Remove dupliated gson definition in root pom file (#1341)

 pom.xml                           | 6 ------
 pulsar-functions/instance/pom.xml | 4 ----
 2 files changed, 10 deletions(-)

commit 97c2b44a061221784c453fc6ec31fc1ec1718878
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 5 15:44:27 2018 -0800

    Improved API for producer/consumer stats (#1321)
    
    * Improved API for producer/consumer stats
    
    * Fixed compilation after merge

 .../client/api/SimpleProducerConsumerStatTest.java |   2 -
 .../client/impl/PatternTopicsConsumerImplTest.java |   3 +-
 .../org/apache/pulsar/client/api/Consumer.java     |  29 +++--
 .../apache/pulsar/client/api/ConsumerStats.java    |  90 ++++++++++++++
 .../org/apache/pulsar/client/api/Producer.java     |  19 +--
 .../apache/pulsar/client/api/ProducerStats.java    | 110 +++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  28 ++---
 .../pulsar/client/impl/ConsumerStatsDisabled.java  |  91 +++++++++++++-
 .../pulsar/client/impl/ConsumerStatsRecorder.java  |  42 +++++++
 ...erStats.java => ConsumerStatsRecorderImpl.java} |  81 ++++++++-----
 .../client/impl/PartitionedConsumerImpl.java       |   6 +-
 .../client/impl/PartitionedProducerImpl.java       |   6 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  11 +-
 .../pulsar/client/impl/ProducerStatsDisabled.java  |  96 ++++++++++++++-
 .../pulsar/client/impl/ProducerStatsRecorder.java  |  33 ++++++
 ...erStats.java => ProducerStatsRecorderImpl.java} | 131 ++++++++++++++-------
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  15 +--
 17 files changed, 653 insertions(+), 140 deletions(-)

commit 81935b500c923f0e248fc445412d5288071832ed
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Mar 5 15:12:03 2018 -0800

    Added timeout to ZookeeperCacheTest tests (#1339)

 .../java/org/apache/pulsar/zookeeper/ZookeeperCacheTest.java | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

commit b7019252d832c42fb244c07fc92ce4f59801c952
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Mar 5 13:49:50 2018 -0800

    Support running function worker along with broker (#1329)
    
    * Move pulsar functions dependency version to root pom and remove duplicated license headers
    
    This addresses some comments in pulsar functions PR #1314
    
    * shade worker
    
    * Fix broken master
    
    * Upgrade the bookkeeper storage client dependency to the official bookkeeper version
    
    This removes the temp dependency in `pulsar-functions-instance`
    
    * set `protobuf2.version` in pulsar-common
    
    * provide a shaded worker
    
    * include worker dependency at broker
    
    * Embeded function worker at broker
    
    * rename 'function worker' to 'functions worker'
    
    * add "--no-functions-worker" for pulsar-client-cpp tests

 bin/pulsar                                         |  59 ++-
 buildtools/pom.xml                                 |  15 +
 conf/broker.conf                                   |   6 +
 conf/functions_worker.yml                          |  46 ++
 conf/log4j2.yaml                                   | 118 ++++-
 managed-ledger/pom.xml                             |  15 -
 pom.xml                                            |  38 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  13 +
 pulsar-broker/pom.xml                              |  90 ++++
 .../org/apache/pulsar/PulsarBrokerStarter.java     |  55 +-
 .../org/apache/pulsar/PulsarStandaloneStarter.java |  42 +-
 .../org/apache/pulsar/broker/PulsarService.java    |  12 +
 .../pulsar/broker/admin/impl/FunctionsBase.java    | 142 ++++++
 .../apache/pulsar/broker/admin/v1/Functions.java   |  28 ++
 .../apache/pulsar/broker/admin/v2/Functions.java   |  28 ++
 .../org/apache/pulsar/broker/web/WebService.java   |   2 +
 pulsar-client-cpp/run-unit-tests.sh                |   3 +-
 pulsar-client-tools-test/pom.xml                   |  84 ++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   0
 .../apache/pulsar/admin/cli/utils/IOUtilsTest.java |   0
 .../cli/utils/NameValueParameterSplitterTest.java  |   0
 .../pulsar/client/cli/PulsarClientToolTest.java    |   0
 pulsar-client-tools/pom.xml                        | 133 ++---
 pulsar-common/pom.xml                              |   2 +-
 pulsar-functions/bin/pulsar                        |   6 +-
 pulsar-functions/cli/pom.xml                       |  14 -
 pulsar-functions/instance/pom.xml                  |   1 -
 pulsar-functions/pom.xml                           |   2 +
 pulsar-functions/runtime/pom.xml                   |   5 +
 pulsar-functions/utils/pom.xml                     |  14 -
 pulsar-functions/worker-runner/pom.xml             | 111 +++++
 pulsar-functions/worker-shaded/pom.xml             | 113 +++++
 pulsar-functions/worker/pom.xml                    |  14 -
 .../pulsar/functions/worker/MembershipManager.java |   2 +-
 .../org/apache/pulsar/functions/worker/Worker.java |  11 +-
 .../pulsar/functions/worker/WorkerService.java     |  12 +-
 .../functions/worker/rest/FunctionApiResource.java |  14 +-
 .../functions/worker/rest/api/FunctionsImpl.java   | 555 +++++++++++++++++++++
 .../worker/rest/api/v2/FunctionApiV2Resource.java  | 440 +---------------
 .../rest/api/v2/FunctionApiV2ResourceTest.java     |   7 +-
 pulsar-zookeeper-utils/pom.xml                     |  15 -
 41 files changed, 1633 insertions(+), 634 deletions(-)

commit f38fce71b1ffda033071e5c89a4839397f4d1cd1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Mar 4 20:50:03 2018 -0800

    Upgrade the bookkeeper storage client dependency to the official bookkeeper version (#1328)
    
    This removes the temp dependency in `pulsar-functions-instance`

 pom.xml                           |  6 ++++++
 pulsar-functions/instance/pom.xml | 12 ------------
 2 files changed, 6 insertions(+), 12 deletions(-)

commit 585ea13e288a9290b3b80af0324f73cf47d9e4de
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Mar 4 16:43:03 2018 -0800

    Move pulsar functions dependency version to root pom and remove duplicated license headers (#1324)
    
    
    
    This addresses some comments in pulsar functions PR #1314

 pom.xml                                            |  37 +++++
 pulsar-client/pom.xml                              |   1 -
 pulsar-functions/api-java/pom.xml                  |   1 -
 pulsar-functions/cli/pom.xml                       |   6 -
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 .../org/apache/pulsar/admin/cli/FunctionsTool.java |   3 +-
 .../pulsar/client/admin/PulsarFunctionsAdmin.java  |   7 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   3 +-
 pulsar-functions/instance/pom.xml                  | 139 +-----------------
 .../instance/src/main/python/contextimpl.py        |  17 ---
 pulsar-functions/instance/src/main/python/log.py   |  17 ---
 .../instance/src/main/python/python_instance.py    |  17 ---
 .../src/main/python/python_instance_main.py        |  17 ---
 .../instance/src/main/python/server.py             |  17 ---
 pulsar-functions/instance/src/main/python/util.py  |  17 ---
 pulsar-functions/metrics/pom.xml                   |  56 -------
 pulsar-functions/proto/pom.xml                     |   7 +-
 pulsar-functions/runtime/pom.xml                   | 163 ---------------------
 pulsar-functions/utils/pom.xml                     |  21 ---
 pulsar-functions/worker/pom.xml                    |  32 ----
 20 files changed, 55 insertions(+), 525 deletions(-)

commit fb974460ee16d709eb89964ea586f5ca350c5f4e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Mar 4 15:01:21 2018 -0800

    Rename pulsar function api from V1 to V2 (#1325)
    
    - rename the V1 to V2
    - change the way how the rest api was organized to allow it merged back to pulsar webservice and cli

 .../apache/pulsar/functions/worker/rest/Resources.java |  4 ++--
 .../pulsar/functions/worker/rest/WorkerServer.java     | 18 +++++++++++++++++-
 .../FunctionApiV2Resource.java}                        |  7 +++----
 .../FunctionApiV2ResourceTest.java}                    | 10 +++++-----
 4 files changed, 27 insertions(+), 12 deletions(-)

commit 1270bba9f072e6bc29d72872f97c0c41264cc6e9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Mar 4 09:38:23 2018 -0800

    Introduce pulsar-seed and pulsar-snapshot-release jenkins jobs (#1323)
    
    * Add nightly-snapshot job
    
    * Add a seed job
    
    * change the email for testing
    
    * Skip tests
    
    * buildtools should inherit from apache profile
    
    * update the release command
    
    * Revert "change the email for testing"
    
    This reverts commit 152f4c604229418c0f1de87d534b5790fcf81b21.
    
    * remove "-Papache-release" so we don't require gpg keys for deploying to snapshot

 .test-infra/jenkins/common_job_properties.groovy   | 257 +++++++++++++++++++++
 .../job_pulsar_release_nightly_snapshot.groovy     |  45 ++++
 .test-infra/jenkins/job_seed.groovy                |  51 ++++
 buildtools/pom.xml                                 |   6 +
 4 files changed, 359 insertions(+)

commit 052814d516adb429d2c0fca030920f26770a52ac
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 4 09:10:18 2018 -0800

    Refactored all unit tests to use new typed API with builders for configuration (#1320)
    
    * Refactored all unit tests to use new typed API with builders for configuration
    
    * Did conversion in pulsar-client tool
    
    * Refactoring typo fixes

 .../AuthenticationProviderBasic.java               |    6 +-
 .../broker/authorization/AuthorizationService.java |    9 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  201 +-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |   77 +-
 .../broker/admin/CreateSubscriptionTest.java       |    5 +-
 .../broker/admin/IncrementPartitionsTest.java      |    9 +-
 .../AntiAffinityNamespaceGroupTest.java            |    7 +-
 .../broker/loadbalance/LoadBalancerTest.java       |    2 +
 .../loadbalance/ModularLoadManagerImplTest.java    |    5 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |    2 +-
 .../broker/namespace/NamespaceServiceTest.java     |   19 +-
 .../broker/namespace/NamespaceUnloadingTest.java   |    3 +-
 .../broker/service/AddMissingPatchVersionTest.java |    1 -
 .../broker/service/BacklogQuotaManagerTest.java    |  118 +-
 .../pulsar/broker/service/BatchMessageTest.java    |  227 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |   50 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |  267 +--
 .../service/BrokerServiceThrottlingTest.java       |   50 +-
 .../pulsar/broker/service/PartitionKeyTest.java    |   14 +-
 .../pulsar/broker/service/PeerReplicatorTest.java  |   23 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |    9 +-
 .../broker/service/PersistentFailoverE2ETest.java  |  158 +-
 .../broker/service/PersistentQueueE2ETest.java     |  188 +-
 .../service/PersistentTopicConcurrentTest.java     |    2 +
 .../broker/service/PersistentTopicE2ETest.java     |  301 +--
 .../pulsar/broker/service/PersistentTopicTest.java |   13 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   83 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   39 +-
 .../pulsar/broker/service/ResendRequestTest.java   |  143 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   10 +-
 .../broker/service/SubscriptionSeekTest.java       |   13 +-
 .../broker/service/TopicTerminationTest.java       |  104 +-
 .../broker/service/persistent/ChecksumTest.java    |    4 +-
 .../broker/stats/ManagedLedgerMetricsTest.java     |    3 +-
 .../pulsar/broker/stats/PrometheusMetricsTest.java |    8 +-
 .../zookeeper/ZooKeeperClientAspectJTest.java      |    2 +-
 .../api/AuthenticatedProducerConsumerTest.java     |   41 +-
 .../AuthenticationTlsHostnameVerificationTest.java |   34 +-
 .../api/AuthorizationProducerConsumerTest.java     |   55 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |  378 +--
 .../pulsar/client/api/ClientDeduplicationTest.java |   33 +-
 .../apache/pulsar/client/api/ClientErrorsTest.java |  106 +-
 .../client/api/DispatcherBlockConsumerTest.java    |  205 +-
 .../client/api/MessageDispatchThrottlingTest.java  |  196 +-
 .../pulsar/client/api/MockBrokerService.java       |    2 -
 .../pulsar/client/api/NonPersistentTopicTest.java  |  148 +-
 .../api/PartitionedProducerConsumerTest.java       |  147 +-
 .../client/api/SimpleProducerConsumerStatTest.java |  146 +-
 .../client/api/SimpleProducerConsumerTest.java     |  788 +++----
 .../pulsar/client/api/TlsProducerConsumerBase.java |   13 +-
 .../pulsar/client/api/TlsProducerConsumerTest.java |   13 +-
 .../apache/pulsar/client/api/TopicReaderTest.java  |  140 +-
 .../client/api/v1/V1_ProducerConsumerTest.java     | 2459 ++++++++++++++++++++
 .../client/impl/BrokerClientIntegrationTest.java   |  192 +-
 .../client/impl/ConsumeBaseExceptionTest.java      |   16 +-
 .../client/impl/ConsumerConfigurationTest.java     |   40 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |  122 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  113 +-
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   99 +-
 .../pulsar/client/impl/RawMessageSerDeserTest.java |    3 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   |   35 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |   78 +-
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |  114 +-
 .../pulsar/client/impl/ZeroQueueSizeTest.java      |   81 +-
 .../pulsar/common/naming/NamespaceBundleTest.java  |    1 +
 .../pulsar/common/naming/NamespaceBundlesTest.java |    1 +
 .../pulsar/compaction/CompactedTopicTest.java      |   33 +-
 .../apache/pulsar/compaction/CompactionTest.java   |  128 +-
 .../apache/pulsar/compaction/CompactorTest.java    |   37 +-
 .../stats/client/PulsarBrokerStatsClientTest.java  |   22 +-
 .../apache/pulsar/utils/StatsOutputStreamTest.java |    1 -
 .../websocket/proxy/ProxyAuthenticationTest.java   |    4 -
 .../websocket/proxy/ProxyAuthorizationTest.java    |    1 -
 .../websocket/proxy/SimpleProducerSocket.java      |    9 +-
 .../pulsar/client/admin/PersistentTopics.java      |    4 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |   17 +
 .../admin/internal/PersistentTopicsImpl.java       |   21 +-
 .../kafka/compat/examples/ConsumerExample.java     |    2 +
 .../kafka/compat/tests/KafkaConsumerTest.java      |   42 +-
 .../kafka/compat/tests/KafkaProducerTest.java      |   10 +-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |    4 +-
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   15 +-
 .../org/apache/pulsar/client/cli/CmdConsume.java   |   23 +-
 .../org/apache/pulsar/client/cli/CmdProduce.java   |   34 +-
 .../apache/pulsar/client/cli/PulsarClientTool.java |   27 +-
 .../apache/pulsar/admin/cli/utils/IOUtilsTest.java |   20 +-
 .../cli/utils/NameValueParameterSplitterTest.java  |    5 +-
 .../pulsar/client/cli/PulsarClientToolTest.java    |    1 -
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   13 +
 .../org/apache/pulsar/client/api/Producer.java     |    8 +-
 .../pulsar/client/api/ProducerConfiguration.java   |    2 +
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   24 +-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |   32 +-
 .../impl/SinglePartitionMessageRouterImpl.java     |    2 +-
 .../pulsar/client/impl/TopicMessageImpl.java       |   10 +-
 .../pulsar/client/impl/TopicsConsumerImpl.java     |   16 +-
 .../pulsar/client/impl/UnAckedMessageTracker.java  |    4 +-
 .../client/impl/UnAckedTopicMessageTracker.java    |    2 +-
 .../impl/conf/ConsumerConfigurationData.java       |    3 +-
 .../client/impl/conf/ReaderConfigurationData.java  |    1 +
 .../client/api/ConsumerConfigurationTest.java      |    7 +-
 .../pulsar/client/api/MessageRouterTest.java       |    5 +-
 .../pulsar/client/impl/MessageBuilderTest.java     |   18 +-
 .../pulsar/client/impl/MessageIdCompareToTest.java |    1 -
 .../apache/pulsar/client/impl/MessageImplTest.java |    8 +-
 .../RoundRobinPartitionMessageRouterImplTest.java  |    6 +-
 .../impl/SinglePartitionMessageRouterImplTest.java |    6 +-
 .../client/tutorial/ContinuousAsyncProducer.java   |    5 +-
 .../pulsar/client/tutorial/ContinuousProducer.java |    5 +-
 .../client/tutorial/SampleAsyncProducer.java       |   14 +-
 .../pulsar/client/tutorial/SampleConsumer.java     |   10 +-
 .../client/tutorial/SampleConsumerListener.java    |   29 +-
 .../client/tutorial/SampleCryptoConsumer.java      |   26 +-
 .../client/tutorial/SampleCryptoProducer.java      |   20 +-
 .../pulsar/client/tutorial/SampleProducer.java     |    2 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |   41 +-
 .../proxy/server/ProxyForwardAuthDataTest.java     |   14 +-
 .../proxy/server/ProxyRolesEnforcementTest.java    |   77 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |   39 +-
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |   37 +-
 .../server/ProxyWithAuthorizationNegTest.java      |   74 +-
 .../proxy/server/ProxyWithAuthorizationTest.java   |  130 +-
 .../server/ProxyWithoutServiceDiscoveryTest.java   |   46 +-
 123 files changed, 5464 insertions(+), 3707 deletions(-)

commit 12dac7ef2b684b59ae4d9c087b0e1ba4e158156a
Author: Sijie Guo <sijie@apache.org>
Date:   Sat Mar 3 16:52:53 2018 -0800

    - Revert .travis.yml
    - Remove function-composition

 .travis.yml                                        |  63 +-
 pulsar-functions/api-composition-java/pom.xml      |  71 --
 .../windowing/DefaultEvictionContext.java          |  82 --
 .../functions/composition/windowing/Event.java     |  64 --
 .../functions/composition/windowing/EventImpl.java |  63 --
 .../composition/windowing/EvictionContext.java     |  56 --
 .../composition/windowing/EvictionPolicy.java      | 101 ---
 .../functions/composition/windowing/Pair.java      | 112 ---
 .../composition/windowing/TimestampExtractor.java  |  34 -
 .../composition/windowing/TriggerHandler.java      |  32 -
 .../composition/windowing/TriggerPolicy.java       |  67 --
 .../composition/windowing/WaterMarkEvent.java      |  40 -
 .../windowing/WaterMarkEventGenerator.java         | 152 ----
 .../functions/composition/windowing/Window.java    |  69 --
 .../composition/windowing/WindowConfig.java        |  49 --
 .../composition/windowing/WindowContext.java       |  99 ---
 .../composition/windowing/WindowContextImpl.java   |  89 ---
 .../composition/windowing/WindowImpl.java          | 102 ---
 .../windowing/WindowLifecycleListener.java         |  48 --
 .../composition/windowing/WindowManager.java       | 292 -------
 .../composition/windowing/WindowUtils.java         |  25 -
 .../windowing/WindowedPulsarFunction.java          | 360 ---------
 .../windowing/evictors/CountEvictionPolicy.java    |  99 ---
 .../windowing/evictors/TimeEvictionPolicy.java     | 112 ---
 .../evictors/WatermarkCountEvictionPolicy.java     | 128 ----
 .../evictors/WatermarkTimeEvictionPolicy.java      |  88 ---
 .../windowing/triggers/CountTriggerPolicy.java     |  91 ---
 .../windowing/triggers/TimeTriggerPolicy.java      | 148 ----
 .../triggers/WatermarkCountTriggerPolicy.java      | 107 ---
 .../triggers/WatermarkTimeTriggerPolicy.java       | 141 ----
 .../windowing/WaterMarkEventGeneratorTest.java     | 134 ----
 .../composition/windowing/WindowManagerTest.java   | 839 ---------------------
 .../windowing/WindowedPulsarFunctionTest.java      | 521 -------------
 .../src/test/resources/log4j2.yml                  |  37 -
 pulsar-functions/conf/window_example.yml           |  31 -
 pulsar-functions/java-examples/pom.xml             |   6 -
 .../functions/api/examples/WindowedFunction.java   |  47 --
 pulsar-functions/pom.xml                           |   1 -
 38 files changed, 47 insertions(+), 4553 deletions(-)

commit 5245529a12afac677b2aa5ab23fae3e6b0a34a51
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 2 14:58:18 2018 -0800

    Effectively once not yet supported in Python (#278)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 433eb8bfc798cbfad0eb9d5f594af4de4cb2acea
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Mar 2 14:44:15 2018 -0800

    Better variable safety (#277)

 .../pulsar/functions/runtime/ProcessRuntime.java     | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

commit 03df4404f2794f57b362fb076c9c102f98b25fa3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Mar 2 00:17:47 2018 -0800

    adding SchedulerManager tests (#276)

 .../pulsar/functions/worker/SchedulerManager.java  |   8 +-
 .../functions/worker/SchedulerManagerTest.java     | 703 +++++++++++++++++++++
 2 files changed, 708 insertions(+), 3 deletions(-)

commit 46bc5586ee47abf492560f21b93e35ea8c552784
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Mar 1 17:27:40 2018 -0800

    fix scaling up and down as well as updating a function in general (#275)

 .../pulsar/functions/worker/SchedulerManager.java  | 49 ++++++++++++++--------
 1 file changed, 31 insertions(+), 18 deletions(-)

commit 6ec05f941ea22472e45002e62e330a037d014055
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 1 17:06:25 2018 -0800

    If no brokerUrl is specified use localhost (#274)

 .../cli/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 3 +++
 1 file changed, 3 insertions(+)

commit 2e496461248a0fa220da13a77cb3ed183068bdf9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Mar 1 16:45:31 2018 -0800

    Create ProcessBuilder at during start() so that start() can be called (#273)
    
    * Create ProcessBuilder at during start() so that start() can be called multiple times from Spawner
    
    * Fix unittest

 .../apache/pulsar/functions/runtime/ProcessRuntime.java   | 15 ++++++++++++---
 .../pulsar/functions/runtime/ProcessRuntimeTest.java      |  4 ++--
 2 files changed, 14 insertions(+), 5 deletions(-)

commit ae1ac31e5480141a307a03b68969b33075cfb57b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Mar 1 15:35:59 2018 -0800

    Build classpath using `compile` scope (#272)
    
    The `compile` scope in dependency plugin means : compile, provided, and system dependencies

 pulsar-functions/bin/pulsar           | 2 +-
 pulsar-functions/bin/pulsar-functions | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 82bccd16414dd6e51b2eff5c22403eca3e45e875
Author: Sijie Guo <sijie@apache.org>
Date:   Wed Feb 28 22:18:37 2018 -0800

    Resolve rebase conflicts

 pulsar-client-shaded/pom.xml                                           | 1 +
 .../main/java/org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java | 3 ---
 2 files changed, 1 insertion(+), 3 deletions(-)

commit a68fb0de5b6ccea938cddce4a7261ca2228d8b05
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 20:11:25 2018 -0800

    Organize the function packages in tenant/namespace/function hierarchy (#269)
    
    Example:
    
    ```
    (CONNECTING) />
    (CONNECTED) /> ls pulsar/functions/test
    test-namespace
    (CONNECTED) /> ls pulsar/functions/test/test-namespace
    function11
    function12
    function13
    (CONNECTED) /> ls pulsar/functions/test/test-namespace/function11
    8e4dcc81-3b00-4bf9-a489-1823b5514788-pulsar-functions-api-examples.jar
    (CONNECTED) /> ls pulsar/functions/test/test-namespace/function12
    0ee8e267-74cb-4178-99ea-6c723298223c-pulsar-functions-api-examples.jar
    (CONNECTED) /> ls pulsar/functions/test/test-namespace/function13
    8f1dea11-0070-434b-ba97-a42b44d8063c-pulsar-functions-api-examples.jar
    (CONNECTED) />
    ```

 .../pulsar/functions/worker/rest/api/v1/FunctionApiV1Resource.java | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

commit c350e1db257c13813fb52af8c5b6f62940dd289b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 19:59:38 2018 -0800

    Improve function package download process (#268)
    
    - downloader is writing the package to a temp location
    - after a package is downloaded, a hardlink is created to link to the temp file. hardlink will ensure one createLink succeed.
    - after the hardlink is created, the temp files can be deleted.
    
    After this change, it allows concurrent downloading without interleaving with each other.

 .../functions/instance/JavaInstanceRunnable.java   |  2 +-
 .../pulsar/functions/runtime/ThreadRuntime.java    | 11 ++++-
 .../pulsar/functions/worker/FunctionActioner.java  | 55 ++++++++++++++++++----
 3 files changed, 55 insertions(+), 13 deletions(-)

commit 322f3af9e67dc7ca0df71d8d6721f34829e9359c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 18:48:49 2018 -0800

     Fix serviceUrl for functions cli (#267)
    
    * Use `distributedlog-core-shaded` in pulsar worker
    
    * revert to db ledger storage
    
    * Include netty-all
    
    * Fix serviceUrl for functions cli

 .../cli/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java | 2 +-
 .../src/main/java/org/apache/pulsar/admin/cli/FunctionsTool.java    | 6 ++++++
 2 files changed, 7 insertions(+), 1 deletion(-)

commit 6652c5ac93980da5b718c5f753e615e2ac87e18b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 28 18:40:36 2018 -0800

    Move the thread construction to start to avoid illegalstate (#266)
    
    * Move the thread construction to start to avoid illegalstate
    
    * Add more checks to see if thread var is init

 .../pulsar/functions/runtime/ThreadRuntime.java    | 35 ++++++++++++++--------
 1 file changed, 22 insertions(+), 13 deletions(-)

commit 981e472c8665a2f8cd90dfb721de087fd371db22
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 18:39:22 2018 -0800

    Use `distributedlog-core-shaded` in pulsar worker (#257)

 bin/pulsar                                                         | 2 +-
 pom.xml                                                            | 2 +-
 pulsar-functions/dist/pom.xml                                      | 5 +++++
 pulsar-functions/worker/pom.xml                                    | 3 ++-
 .../src/main/java/org/apache/pulsar/functions/worker/Utils.java    | 7 +++++--
 .../java/org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 6 ++----
 6 files changed, 16 insertions(+), 9 deletions(-)

commit 68e1f3c58e44638c4b8b4acc898c32a75e49cba6
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 17:28:00 2018 -0800

    Fix pulsar-functions on locating java & python instance files (#264)

 pulsar-functions/bin/pulsar-functions      | 19 ++++++++++++-------
 pulsar-functions/dist/src/assemble/bin.xml |  2 +-
 2 files changed, 13 insertions(+), 8 deletions(-)

commit e417c57f2408e6b8cc93d6e1ad42a40fea25499c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 28 16:44:28 2018 -0800

    Support parallelism parameter while running functions locally (#262)
    
    * Support parallelism parameter while running functions locally
    
    * Fixed the generation of java and python files

 pulsar-functions/bin/pulsar-functions              | 30 ++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 47 +++++++++++++---------
 .../pulsar/functions/runtime/RuntimeSpawner.java   |  2 +
 3 files changed, 60 insertions(+), 19 deletions(-)

commit e5ed2ed011865ae585c58c88534e37475e798c2d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 16:42:49 2018 -0800

    Provide a distribution package for pulsar functions (#263)
    
    - the package will be generated under `dist/target/`

 pulsar-functions/bin/pulsar                        |  25 +++--
 pulsar-functions/bin/pulsar-functions              |   2 +-
 pulsar-functions/dist/pom.xml                      | 104 +++++++++++++++++++++
 pulsar-functions/dist/src/assemble/bin.xml         |  83 ++++++++++++++++
 pulsar-functions/dist/src/assemble/src.xml         |  92 ++++++++++++++++++
 pulsar-functions/pom.xml                           |   1 +
 .../functions/worker/FunctionMetadataSetup.java    |   1 +
 7 files changed, 294 insertions(+), 14 deletions(-)

commit 9114ddc14e51348c506ee08bc211e2aee0f498f6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 28 15:40:38 2018 -0800

    Moved localrun to process based runtime (#261)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  8 ++---
 .../functions/runtime/ProcessRuntimeFactory.java   | 35 ++++++++++++++++++++++
 .../functions/worker/FunctionWorkerStarter.java    | 35 ----------------------
 3 files changed, 38 insertions(+), 40 deletions(-)

commit dc8f39c7c447a518e378690c4793aba34692c2f4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Feb 28 15:11:50 2018 -0800

    fix bug in scheduler (#260)

 pulsar-functions/conf/function_worker.yml                              | 1 -
 .../main/java/org/apache/pulsar/functions/worker/SchedulerManager.java | 3 ---
 2 files changed, 4 deletions(-)

commit 7370fbc94c12262899dad73d0a0880227c3c9dd2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 28 14:37:38 2018 -0800

    Added abiltiy to specify broker on cmdline for localrun (#259)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 2fe4a38d1d4b5c2b17fda22e80c957f4a73de1b3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 13:37:30 2018 -0800

    Fix NPE for void functions (#258)

 .../functions/instance/JavaInstanceRunnable.java   | 50 +++++++++-------
 .../instance/JavaInstanceRunnableProcessTest.java  | 67 +++++++++++++++++++++-
 2 files changed, 94 insertions(+), 23 deletions(-)

commit ab93a181876f588417613be4e45dcecbfea13ca2
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 27 22:44:34 2018 -0800

    Update threshold (#256)

 .../main/java/org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9bc41ab13332b76dd5b923d27a687c7255ed9f99
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 27 22:15:54 2018 -0800

    Increase bookkeeper disk usage threshold for pulsar standalone (#255)

 .../main/java/org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 2 ++
 1 file changed, 2 insertions(+)

commit b7d308388d27415b0610d60ffa859cbceffc2f7f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 27 20:57:52 2018 -0800

    Upgrade dlog deps (#254)
    
    * Upgrade dlog dependency
    
    * Make pulsar functions work after rebase
    
    - bump zk version 3.5
    - use the same dlog version as bookkeeper
    - change standalone to use sorted ledger storage manager
    
    (this is a temp fix to address the issues after rebase)

 bin/pulsar                                         |  2 +-
 pom.xml                                            |  2 +-
 pulsar-functions/worker/pom.xml                    | 75 +---------------------
 .../org/apache/pulsar/functions/worker/Utils.java  |  3 +-
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |  7 +-
 5 files changed, 9 insertions(+), 80 deletions(-)

commit bbc12423f9f091b266e892eb0591459fb2247eca
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Feb 27 18:39:33 2018 -0800

    revert zookeeper dependency

 pom.xml | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

commit 2412f80f613e12de2e3026bbd4c7decd740b2881
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 27 16:40:00 2018 -0800

    Added more comments to the JavaDoc (#253)

 .../java/org/apache/pulsar/functions/api/Context.java   | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit 41c9713fd38d6f88fec563e8b68412cd9f6a814e
Author: Sijie Guo <sijie@apache.org>
Date:   Tue Feb 27 15:03:16 2018 -0800

    Address conflicts after merged

 pom.xml                                            |  1 -
 .../loadbalance/SimpleLoadManagerImplTest.java     |  1 -
 .../client/impl/BrokerClientIntegrationTest.java   |  2 --
 pulsar-client-admin-shaded/pom.xml                 | 20 +--------------
 pulsar-client-shaded/pom.xml                       | 29 +++++++++++-----------
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |  1 -
 6 files changed, 15 insertions(+), 39 deletions(-)

commit 599077a79d26f4c979e6fcd9a80679d5b9c9e475
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 26 17:32:29 2018 -0800

    Corrected the name of the java instance main (#252)

 .../main/java/org/apache/pulsar/functions/runtime/ProcessRuntime.java   | 2 +-
 .../java/org/apache/pulsar/functions/runtime/ProcessRuntimeTest.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit ee77f771090a22fb5ed888b445c4124f03a33e27
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Feb 26 17:23:21 2018 -0800

    Address merge conflicts

 pulsar-broker/pom.xml                                              | 5 -----
 pulsar-functions/cli/pom.xml                                       | 5 -----
 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 6 +++---
 .../org/apache/pulsar/functions/instance/FunctionResultRouter.java | 2 +-
 pulsar-functions/worker/pom.xml                                    | 7 -------
 5 files changed, 4 insertions(+), 21 deletions(-)

commit 04973686d3e5002a81269d616401402d2302a0ac
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 26 16:59:45 2018 -0800

    Renamed all container stuff to runtime (#250)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 20 ++++----
 .../functions/instance/JavaExecutionResult.java    |  2 +-
 .../pulsar/functions/instance/JavaInstance.java    |  2 +-
 .../runtime/{container => }/JavaInstanceMain.java  | 29 ++++++-----
 ...sFunctionContainer.java => ProcessRuntime.java} | 16 +++----
 ...inerFactory.java => ProcessRuntimeFactory.java} | 16 +++----
 .../FunctionContainer.java => Runtime.java}        |  4 +-
 ...onContainerFactory.java => RuntimeFactory.java} |  8 ++--
 .../{spawner/Spawner.java => RuntimeSpawner.java}  | 56 +++++++++++-----------
 ...adFunctionContainer.java => ThreadRuntime.java} | 16 +++----
 ...ainerFactory.java => ThreadRuntimeFactory.java} | 20 ++++----
 .../functions/runtime/container/package-info.java  | 28 -----------
 .../functions/runtime/spawner/package-info.java    | 22 ---------
 ...nContainerTest.java => ProcessRuntimeTest.java} | 21 ++++----
 .../pulsar/functions/worker/FunctionActioner.java  | 22 ++++-----
 .../functions/worker/FunctionRuntimeInfo.java      |  5 +-
 .../functions/worker/FunctionRuntimeManager.java   | 22 ++++-----
 17 files changed, 130 insertions(+), 179 deletions(-)

commit 2d7a7f8ea7002418de46c256bcdd25de79d060c0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 26 16:35:50 2018 -0800

    Refactored all metrics stuff into its own module (#249)

 pulsar-functions/conf/function_worker.yml          |   2 +-
 pulsar-functions/metrics/pom.xml                   | 106 +++++++++++++++++++++
 .../pulsar/functions}/metrics/MetricsSink.java     |   2 +-
 .../pulsar/functions}/metrics/package-info.java    |   2 +-
 .../functions}/metrics/sink/AbstractWebSink.java   |   4 +-
 .../pulsar/functions}/metrics/sink/FileSink.java   |   4 +-
 .../functions}/metrics/sink/PrometheusSink.java    |   2 +-
 .../functions}/metrics/sink/FileSinkTest.java      |   2 +-
 .../metrics/sink/PrometheusSinkTests.java          |   2 +-
 pulsar-functions/pom.xml                           |   1 +
 pulsar-functions/runtime/pom.xml                   |   6 ++
 .../apache/pulsar/functions/fs/MetricsConfig.java  |  55 -----------
 .../apache/pulsar/functions/fs/package-info.java   |  23 -----
 .../pulsar/functions/runtime/spawner/Spawner.java  |   2 +-
 .../pulsar/functions/fs/FunctionConfigTest.java    |  48 ----------
 .../src/test/resources/test_function_config.yml    |  23 -----
 pulsar-functions/worker/pom.xml                    |   6 ++
 .../pulsar/functions/worker/FunctionActioner.java  |   2 +-
 .../functions/worker/FunctionRuntimeManager.java   |   2 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  34 +++++--
 .../worker/FunctionRuntimeManagerTest.java         |  10 +-
 .../functions/worker/MembershipManagerTest.java    |   5 +-
 22 files changed, 166 insertions(+), 177 deletions(-)

commit 86f6cdcaebef231689cac879ebbb54334740eee2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 26 15:36:32 2018 -0800

    Refactored instance related stuff into instance as well as rejiggered utils into its own module (#248)
    
    * Refactored instance related stuff into instance as well as rejiggered utils into its own module
    
    * Discard empty files

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   2 +-
 pulsar-functions/instance/pom.xml                  | 227 +++++++++++++++++++++
 .../pulsar/functions}/instance/ContextImpl.java    |   5 +-
 .../functions/instance}/FunctionResultRouter.java  |   2 +-
 .../pulsar/functions}/instance/FunctionStats.java  |   2 +-
 .../pulsar/functions/instance}/InstanceConfig.java |   2 +-
 .../functions}/instance/JavaExecutionResult.java   |   2 +-
 .../pulsar/functions}/instance/JavaInstance.java   |   3 +-
 .../functions}/instance/JavaInstanceRunnable.java  |  14 +-
 .../pulsar/functions}/instance/package-info.java   |   2 +-
 .../producers/AbstractOneSinkTopicProducers.java   |   4 +-
 .../MultiConsumersOneSinkTopicProducers.java       |   2 +-
 .../functions}/instance/producers/Producers.java   |   2 +-
 .../producers/SimpleOneSinkTopicProducers.java     |   3 +-
 .../functions/instance}/state/StateContext.java    |   2 +-
 .../instance}/state/StateContextImpl.java          |   2 +-
 .../src/main/python/Function_pb2.py                |   0
 .../src/main/python/InstanceCommunication_pb2.py   |   0
 .../main/python/InstanceCommunication_pb2_grpc.py  |   0
 .../src/main/python/__init__.py                    |   0
 .../src/main/python/contextimpl.py                 |   0
 .../{runtime => instance}/src/main/python/log.py   |   0
 .../src/main/python/python_instance.py             |   0
 .../src/main/python/python_instance_main.py        |   1 -
 .../src/main/python/server.py                      |   1 -
 .../{runtime => instance}/src/main/python/util.py  |   0
 .../instance}/FunctionResultRouterTest.java        |   2 +-
 .../instance/JavaInstanceRunnableProcessTest.java  |   9 +-
 .../instance/JavaInstanceRunnableTest.java         |   4 +-
 .../functions}/instance/JavaInstanceTest.java      |   3 +-
 .../MultiConsumersOneSinkTopicProducersTest.java   |   4 +-
 .../producers/SimpleOneSinkTopicProducersTest.java |   2 +-
 pulsar-functions/pom.xml                           |   2 +
 pulsar-functions/runtime/pom.xml                   |  26 +--
 .../container/FunctionContainerFactory.java        |   2 +
 .../{instance => container}/JavaInstanceMain.java  |   5 +-
 .../container/ProcessFunctionContainer.java        |   1 +
 .../container/ProcessFunctionContainerFactory.java |   1 +
 .../runtime/container/ThreadFunctionContainer.java |   5 +-
 .../container/ThreadFunctionContainerFactory.java  |   5 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  |   5 +-
 .../container/ProcessFunctionContainerTest.java    |   3 +-
 .../container/ThreadFunctionContainerTest.java     |  99 ---------
 pulsar-functions/utils/pom.xml                     | 182 +++++++++++++++++
 .../apache/pulsar/functions/utils/Exceptions.java  |   0
 .../functions/utils/FunctionConfigUtils.java       |   1 -
 .../apache/pulsar/functions/utils/Reflections.java |   0
 .../org/apache/pulsar/functions/utils/Utils.java   |   0
 .../utils}/functioncache/FunctionCacheEntry.java   |   2 +-
 .../utils}/functioncache/FunctionCacheManager.java |   2 +-
 .../functioncache/FunctionCacheManagerImpl.java    |   3 +-
 .../utils}/functioncache/FunctionClassLoaders.java |   2 +-
 .../utils}/functioncache/package-info.java         |   2 +-
 .../pulsar/functions/utils/package-info.java       |   0
 .../pulsar/functions/utils/ExceptionsTest.java     |   0
 .../pulsar/functions/utils/ReflectionsTest.java    |   0
 .../apache/pulsar/functions/utils/UtilsTest.java   |   0
 .../functioncache/FunctionCacheEntryTest.java      |   2 +-
 .../FunctionCacheManagerImplTest.java              |   2 +-
 .../functioncache/FunctionClassLoadersTest.java    |   2 +-
 .../src/test/resources/multifunction.jar           | Bin
 .../pulsar/functions/worker/FunctionActioner.java  |   2 +-
 .../pulsar/functions/worker/SchedulerManager.java  |   1 -
 63 files changed, 478 insertions(+), 181 deletions(-)

commit d5285e2cf1bcf68218c5f05c58afb2e5a3f221d6
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 23 15:39:34 2018 -0800

    Remove hardcoded jackson version (#247)

 .../cli/src/test/java/org/apache/pulsar/admin/cli/CmdFunctionsTest.java | 2 +-
 .../functions/runtime/instance/JavaInstanceRunnableProcessTest.java     | 2 +-
 .../apache/pulsar/functions/worker/ClusterServiceCoordinatorTest.java   | 2 +-
 .../pulsar/functions/worker/rest/api/v1/FunctionApiV1ResourceTest.java  | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit 2e296ee615d0b7c85c7be51f8ef617f2d7667875
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Feb 23 13:23:19 2018 -0800

    Bump log4j2 to 2.10.0

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 753155d6d2a7999ca11262aea935975ab88076b0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Feb 23 13:01:17 2018 -0800

    Remove snapshotting (#246)
    
    * removing snapshotting
    
    * cleaning up

 .../functions/worker/FunctionMetaDataManager.java  |  93 +++------
 .../worker/FunctionMetaDataSnapshotManager.java    | 190 ------------------
 .../worker/FunctionMetaDataTopicTailer.java        |   9 +-
 .../pulsar/functions/worker/SchedulerManager.java  |   5 +
 .../pulsar/functions/worker/WorkerService.java     |   5 -
 .../worker/FunctionMetaDataManagerTest.java        |   8 -
 .../FunctionMetaDataSnapshotManagerTest.java       | 217 ---------------------
 7 files changed, 33 insertions(+), 494 deletions(-)

commit fb5e34bb5ff4decfa136c97275d11f9d7c3bb05f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 23 12:57:15 2018 -0800

    Move function metadata setup logic out of WorkerService (#244)

 .../functions/worker/FunctionMetadataSetup.java    | 125 +++++++++++++++++++++
 .../org/apache/pulsar/functions/worker/Worker.java |  11 +-
 .../pulsar/functions/worker/WorkerService.java     |  86 +-------------
 3 files changed, 136 insertions(+), 86 deletions(-)

commit b1306d65af9dd29d27a3f2614e504e2ed2646036
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 23 10:36:06 2018 -0800

    Cleanup WorkerService (#243)
    
    - pass `WorkerService` instance around in servlet context
    - rename `BaseApiResource` to `FunctionApiResource`
    - rename `ApiV1Resource` to `FunctionApiV1Resource`

 .../pulsar/functions/worker/WorkerService.java     | 10 +--
 .../functions/worker/rest/BaseApiResource.java     | 83 ----------------------
 .../functions/worker/rest/FunctionApiResource.java | 41 +++++++++++
 .../pulsar/functions/worker/rest/Resources.java    |  4 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |  2 +-
 ...iV1Resource.java => FunctionApiV1Resource.java} | 32 ++++-----
 ...rceTest.java => FunctionApiV1ResourceTest.java} | 20 ++++--
 7 files changed, 76 insertions(+), 116 deletions(-)

commit f90c4d331d0b265ee2fd586fa575cd78fab3d8c7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 23 10:28:09 2018 -0800

    Upgrade state storage client to latest version (#245)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java    | 12 ++++++------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java    |  8 ++++----
 pulsar-functions/runtime/pom.xml                     |  4 ++--
 .../runtime/instance/JavaInstanceRunnable.java       | 20 ++++++++++----------
 .../functions/runtime/state/StateContextImpl.java    |  2 +-
 .../instance/JavaInstanceRunnableProcessTest.java    | 12 ++++++------
 6 files changed, 29 insertions(+), 29 deletions(-)

commit 7da97557ff82cc034c8429e7d9e3836846311f86
Author: Sijie Guo <sijie@apache.org>
Date:   Fri Feb 23 00:19:10 2018 -0800

    Ignore "javax.ws.*" from PowerMockito (address rebase issue)

 .../apache/pulsar/functions/worker/rest/api/v1/ApiV1ResourceTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 914179c564f7b5bad027cfa99563633a79b1618f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Feb 22 18:51:49 2018 -0800

     Move all the components required for running worker (except rest endpoint) to WorkerService (#242)
    
    * Move all the components required for running worker (except rest endpoint) to WorkerService (#239)
    
    * start worker service

 .../org/apache/pulsar/functions/worker/Worker.java | 227 +----------------
 .../pulsar/functions/worker/WorkerService.java     | 280 +++++++++++++++++++++
 .../pulsar/functions/worker/rest/Resources.java    |   2 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |  40 +--
 4 files changed, 298 insertions(+), 251 deletions(-)

commit 6b0e08784c4192f1638ae98fe442f48ac47392dc
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 22 17:49:57 2018 -0800

    fixing getting assignments from assignment topic (#240)

 .../functions/worker/FunctionAssignmentTailer.java | 30 ++++++++++-------
 .../functions/worker/FunctionRuntimeManager.java   | 12 +++----
 .../worker/FunctionRuntimeManagerTest.java         | 33 +++++++++++++++++--
 .../functions/worker/MembershipManagerTest.java    | 38 ++++++++++++++++++----
 4 files changed, 86 insertions(+), 27 deletions(-)

commit 587da921dcab0f2f02038d0e44b18e9fd083f61c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 22 13:43:50 2018 -0800

    Revert "Move all the components required for running worker (except rest endpoint) to WorkerService (#239)" (#241)
    
    This reverts commit 8fd1fd1870753ea8fb2576873800380ac2cea3dd.

 .../org/apache/pulsar/functions/worker/Worker.java | 226 ++++++++++++++++-
 .../pulsar/functions/worker/WorkerService.java     | 280 ---------------------
 .../pulsar/functions/worker/rest/Resources.java    |   2 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |  40 ++-
 4 files changed, 251 insertions(+), 297 deletions(-)

commit cb48b0928ca5ba0ed1efeb5e0a2ed0330dbc4da9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Feb 22 11:29:35 2018 -0800

    Move all the components required for running worker (except rest endpoint) to WorkerService (#239)

 .../org/apache/pulsar/functions/worker/Worker.java | 226 +----------------
 .../pulsar/functions/worker/WorkerService.java     | 280 +++++++++++++++++++++
 .../pulsar/functions/worker/rest/Resources.java    |   2 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |  40 +--
 4 files changed, 297 insertions(+), 251 deletions(-)

commit 8a99e50ff7a5f9ac1a6f602e392340a9c4be497d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 21 22:51:45 2018 -0800

    Effectively once support (#230)
    
    * Add `join` interface to container to wait for a container (#121)
    
    * add producers
    
    * Effective-Once support
    
    * Fix conflict after rebase
    
    * add tests
    
    * fix tests
    
    * address the test
    
    * Add more tests
    
    * remove lombok from api
    
    * remove getType
    
    * Fix concurrent modification issue in the tests
    
    * Register send future before enqueuing message
    
    * improve the test
    
    * Use conditional remove
    
    * remove the check

 .../pulsar/functions/api/utils/DefaultSerDe.java   |   2 +-
 .../proto/src/main/proto/Function.proto            |   1 +
 .../runtime/instance/JavaInstanceRunnable.java     | 393 +++++++--
 .../producers/AbstractOneSinkTopicProducers.java   |  72 ++
 .../MultiConsumersOneSinkTopicProducers.java       | 103 +++
 .../runtime/instance/producers/Producers.java      |  59 ++
 .../producers/SimpleOneSinkTopicProducers.java     |  64 ++
 .../runtime/router/FunctionResultRouter.java       |  56 ++
 .../org/apache/pulsar/functions/utils/Utils.java   |  52 ++
 .../instance/JavaInstanceRunnableProcessTest.java  | 942 +++++++++++++++++++++
 .../runtime/instance/JavaInstanceRunnableTest.java |   2 +
 .../MultiConsumersOneSinkTopicProducersTest.java   | 124 +++
 .../producers/SimpleOneSinkTopicProducersTest.java |  94 ++
 .../runtime/router/FunctionResultRouterTest.java   | 117 +++
 .../apache/pulsar/functions/utils/UtilsTest.java   |  55 ++
 15 files changed, 2043 insertions(+), 93 deletions(-)

commit 27ad9c755b823a9219c4a7137b29725b29d10b2b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Feb 21 13:10:33 2018 -0800

    Use metadata field for worker info (#238)

 .../pulsar/functions/worker/MembershipManager.java | 16 ++++++++------
 .../org/apache/pulsar/functions/worker/Worker.java |  4 ++--
 .../functions/worker/rest/BaseApiResource.java     | 10 +++++++++
 .../pulsar/functions/worker/rest/WorkerServer.java |  3 +++
 .../worker/rest/api/v1/ApiV1Resource.java          | 25 ++++++++++++++++++++++
 5 files changed, 49 insertions(+), 9 deletions(-)

commit e3403c560743449254aa1b7987e70c5484a32f5e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Feb 20 16:47:15 2018 -0800

    adding worker retry if cannot connect to broker (#237)

 pulsar-functions/conf/function_worker.yml          |  1 +
 .../org/apache/pulsar/functions/worker/Worker.java | 38 ++++++++++++++++++----
 .../pulsar/functions/worker/WorkerConfig.java      |  1 +
 3 files changed, 34 insertions(+), 6 deletions(-)

commit 64d2b18d2d511cb0a498d7d618fc6861c1064cee
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 20 13:40:09 2018 -0800

    Fix NPE on serializing MembershipManager (#235)
    
    
    
    *Problem*
    
    If we assign workerConfig after setting consumer listener, when `ConsumerStats` tries to dump the consumer configuration,
    it will throw NPE.
    
    *Solution*
    
    https://github.com/apache/incubator-pulsar/pull/1260 tried to ignore listener fields for json serialization
    
    this change focus on avoiding NPE on serializing MembershipManager

 .../java/org/apache/pulsar/functions/worker/MembershipManager.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit fe6747b002aae29a5622c7d3b8d4edcc2bfa3d48
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Feb 19 17:29:24 2018 -0800

    Get rid of the leader election trick and use ConsumerEventListener for electing a leader (#231)

 .../worker/ClusterServiceCoordinator.java          |  40 ++--
 .../pulsar/functions/worker/MembershipManager.java |  99 +++++-----
 .../pulsar/functions/worker/SchedulerManager.java  |  26 +--
 .../worker/ClusterServiceCoordinatorTest.java      | 112 +++++++++++
 .../functions/worker/MembershipManagerTest.java    |  59 +++++-
 .../functions/worker/executor/MockClock.java       |  65 +++++++
 .../functions/worker/executor/MockClockTest.java   |  46 +++++
 .../worker/executor/MockExecutorController.java    | 215 +++++++++++++++++++++
 .../executor/MockExecutorControllerTest.java       | 104 ++++++++++
 9 files changed, 664 insertions(+), 102 deletions(-)

commit f8152c831cbbb5d0f44d5abe501500713bbeeb7f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Feb 19 17:29:12 2018 -0800

    Remove zkServers from worker config (#232)

 pulsar-functions/conf/function_worker.yml          |  1 -
 .../org/apache/pulsar/functions/worker/Utils.java  |  6 +-
 .../org/apache/pulsar/functions/worker/Worker.java | 87 +++++++++++++---------
 .../pulsar/functions/worker/WorkerConfig.java      |  1 -
 .../pulsar/functions/worker/WorkerConfigTest.java  |  3 -
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  3 +-
 .../src/test/resources/test_worker_config.yml      |  1 -
 7 files changed, 54 insertions(+), 48 deletions(-)

commit f6b914d13b8ab85cbd89abc379575e4441a19fb1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 16 18:51:29 2018 +0800

    Address netty version conflicts causing getFunctionStatus to fail (#229)

 pulsar-functions/runtime/pom.xml | 82 +++++++++++++++++++++++++++++++++++++---
 1 file changed, 76 insertions(+), 6 deletions(-)

commit 8f1f0229ed07cc8af1efe922250e00c9f7e78d71
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 15 20:29:53 2018 -0800

    Log before quitting (#228)

 .../org/apache/pulsar/functions/runtime/instance/JavaInstanceMain.java   | 1 +
 1 file changed, 1 insertion(+)

commit e47af0cc40f4cbd634c267d2952c5be82b9b431f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Feb 16 02:35:04 2018 +0800

    Remove zookeeper from dependency management to avoid pulling in a wrong version of zookeeper (#227)

 pom.xml | 16 ----------------
 1 file changed, 16 deletions(-)

commit fe1bb680fae4b28b7dd8d27bd278fb581d2ffa2b
Author: Sijie Guo <sijie@apache.org>
Date:   Thu Feb 15 21:24:53 2018 +0800

    Bump functions to 2.0.0-incubating-SNAPSHOT after rebase

 pulsar-functions/api-composition-java/pom.xml                     | 2 +-
 pulsar-functions/api-java/pom.xml                                 | 2 +-
 pulsar-functions/cli/pom.xml                                      | 2 +-
 pulsar-functions/java-examples/pom.xml                            | 2 +-
 pulsar-functions/pom.xml                                          | 2 +-
 pulsar-functions/proto/pom.xml                                    | 2 +-
 pulsar-functions/runtime/pom.xml                                  | 2 +-
 pulsar-functions/worker/pom.xml                                   | 2 +-
 .../pulsar/functions/worker/rest/api/v1/ApiV1ResourceTest.java    | 8 ++++----
 9 files changed, 12 insertions(+), 12 deletions(-)

commit 03937136619265a9d32b4e103369502d5ba24a22
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Feb 14 14:47:27 2018 -0600

    adding instance id to get status (#226)
    
    * adding instance id to get status
    
    * regen python protobuf
    
    * cleaning up

 .../src/main/proto/InstanceCommunication.proto     |  1 +
 .../pulsar/functions/runtime/spawner/Spawner.java  |  2 +-
 .../src/main/python/InstanceCommunication_pb2.py   | 75 ++++++++++++++++++----
 .../runtime/src/main/python/python_instance.py     |  1 +
 .../functions/worker/FunctionRuntimeManager.java   |  2 +
 5 files changed, 66 insertions(+), 15 deletions(-)

commit adcdf6881286d2fa952d6cfe35886f90b03437f5
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Feb 13 21:23:18 2018 -0600

    adding checks for parallelism (#225)
    
    * adding checks for parallelism
    
    * fixing unit test

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 17 ++++
 pulsar-functions/conf/example.yml                  |  2 +-
 .../functions/utils/FunctionConfigUtils.java       |  5 +-
 .../worker/rest/api/v1/ApiV1Resource.java          |  4 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 92 +++++++++++++++++++---
 5 files changed, 105 insertions(+), 15 deletions(-)

commit e724141ffdfe798301d0ed55f55957a284a8b191
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 13 14:59:12 2018 -0800

    For FunctionsCommand make use of required fields (#224)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 55 ++++++++++------------
 pulsar-functions/conf/limits.yml                   | 23 ---------
 2 files changed, 24 insertions(+), 54 deletions(-)

commit 4b894530edd25504ccabde450f77de3a93ec2e17
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Feb 13 16:03:02 2018 -0600

    Allow workers to deploy multiple function instances (#221)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  14 +-
 .../org/apache/pulsar/client/admin/Functions.java  |   4 +-
 .../client/admin/internal/FunctionsImpl.java       |   7 +-
 pulsar-functions/conf/example.yml                  |   1 +
 .../proto/src/main/proto/Function.proto            |  12 +-
 .../src/main/proto/InstanceCommunication.proto     |   6 +-
 .../runtime/instance/JavaInstanceMain.java         |   6 +-
 .../functions/runtime/spawner/AssignmentInfo.java  |  45 ------
 .../pulsar/functions/runtime/spawner/Spawner.java  |  52 ++-----
 .../pulsar/functions/worker/FunctionActioner.java  |  28 +++-
 .../functions/worker/FunctionRuntimeInfo.java      |   5 +-
 .../functions/worker/FunctionRuntimeManager.java   | 162 +++++++++++++++------
 .../pulsar/functions/worker/MembershipManager.java |  84 ++++++-----
 .../pulsar/functions/worker/SchedulerManager.java  |  51 +++++--
 .../org/apache/pulsar/functions/worker/Utils.java  |  14 ++
 .../org/apache/pulsar/functions/worker/Worker.java |   2 +-
 .../worker/rest/api/v1/ApiV1Resource.java          |  70 ++++++++-
 .../functions/worker/scheduler/IScheduler.java     |   4 +-
 .../worker/scheduler/RoundRobinScheduler.java      |  10 +-
 .../worker/FunctionRuntimeManagerTest.java         |  98 +++++++++----
 .../functions/worker/MembershipManagerTest.java    |  51 ++++---
 21 files changed, 463 insertions(+), 263 deletions(-)

commit d1699b243c47cb12e9d28793b70286413f1ada52
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 13 02:13:40 2018 -0800

    Removed timeout since it is no longer tracked (#223)

 .../src/main/proto/InstanceCommunication.proto     | 22 +++----
 .../functions/runtime/instance/FunctionStats.java  |  7 ---
 .../runtime/instance/JavaExecutionResult.java      |  4 --
 .../runtime/instance/JavaInstanceRunnable.java     |  5 --
 .../src/main/python/InstanceCommunication_pb2.py   | 69 ++++++++++------------
 .../runtime/src/main/python/python_instance.py     |  3 -
 6 files changed, 42 insertions(+), 68 deletions(-)

commit 0c94f2919716e93d610f7b8d3c51b64bd483b917
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 13 00:48:36 2018 -0800

    Removed LimitsConfig (#222)

 .../org/apache/pulsar/functions/api/Context.java   | 19 --------
 pulsar-functions/api-python/context.py             | 15 ------
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 10 +---
 pulsar-functions/conf/function_worker.yml          |  5 --
 .../pure_python_function_exclamation.py            |  2 +-
 .../apache/pulsar/functions/fs/LimitsConfig.java   | 55 ----------------------
 .../runtime/container/InstanceConfig.java          |  3 +-
 .../container/ProcessFunctionContainer.java        |  3 +-
 .../container/ProcessFunctionContainerFactory.java |  7 +--
 .../runtime/container/ThreadFunctionContainer.java |  2 -
 .../container/ThreadFunctionContainerFactory.java  |  6 ---
 .../functions/runtime/instance/ContextImpl.java    | 17 -------
 .../functions/runtime/instance/JavaInstance.java   | 40 ++--------------
 .../runtime/instance/JavaInstanceMain.java         |  7 +--
 .../runtime/instance/JavaInstanceRunnable.java     |  3 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  | 32 ++++++-------
 .../runtime/src/main/python/contextimpl.py         |  9 ----
 .../runtime/src/main/python/python_instance.py     |  8 ++--
 .../src/main/python/python_instance_main.py        |  6 +--
 .../container/ProcessFunctionContainerTest.java    |  9 +---
 .../container/ThreadFunctionContainerTest.java     |  7 +--
 .../runtime/instance/JavaInstanceRunnableTest.java |  7 ++-
 .../runtime/instance/JavaInstanceTest.java         | 35 --------------
 .../pulsar/functions/worker/FunctionActioner.java  |  4 +-
 .../functions/worker/FunctionRuntimeManager.java   |  2 -
 .../functions/worker/FunctionWorkerStarter.java    |  5 --
 .../pulsar/functions/worker/WorkerConfig.java      |  2 -
 .../worker/FunctionRuntimeManagerTest.java         |  4 --
 .../functions/worker/MembershipManagerTest.java    |  4 --
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  7 ---
 30 files changed, 38 insertions(+), 297 deletions(-)

commit 1bb2ccfb488eefce99f9a11cf9403c2696d01c81
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 13 01:11:02 2018 +0800

    Avoid creating pulsar admin client for local run (#219)

 .../org/apache/pulsar/admin/cli/FunctionsTool.java | 41 +++++++++++++++++-----
 pulsar-functions/run-examples.sh                   |  4 +--
 2 files changed, 35 insertions(+), 10 deletions(-)

commit d21341cb808ab4c923a6068cda72772af6ba54c6
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 13 00:05:58 2018 +0800

    Add a cli command to query function state (#200)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 79 ++++++++++++++++++++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 54 ++++++++++++++-
 2 files changed, 131 insertions(+), 2 deletions(-)

commit 21212a16a8f2a444c04b362f84f6462291584ab4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Feb 10 13:22:44 2018 -0800

    Added subscription type to function command (#218)

 .../cli/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 5 +++++
 1 file changed, 5 insertions(+)

commit 43ec19b9be6a623cab6d5a50c9b8cae02042417c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 8 21:46:33 2018 -0800

    Added last invocation time to the function status (#217)

 .../src/main/proto/InstanceCommunication.proto     |  3 ++
 .../functions/runtime/instance/FunctionStats.java  | 12 +++++---
 .../runtime/instance/JavaInstanceRunnable.java     |  3 +-
 .../src/main/python/InstanceCommunication_pb2.py   | 35 +++++++++++++---------
 .../runtime/src/main/python/python_instance.py     | 10 +++++--
 5 files changed, 42 insertions(+), 21 deletions(-)

commit 7fd924f870ff9d71968a8f20bd9471fa8a67edf8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 8 20:43:09 2018 -0800

    Rename FunctionConfig names to make them more consistent (#216)
    
    * Rename FunctionConfig names to make them more consistent
    
    * Added generated python file

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 62 ++++++--------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 96 +++++++++++-----------
 .../src/test/resources/test_function_config.yml    |  2 +-
 pulsar-functions/conf/example.yml                  |  2 +-
 .../proto/src/main/proto/Function.proto            |  4 +-
 pulsar-functions/run-counter-examples.sh           | 10 +--
 pulsar-functions/run-examples.sh                   |  8 +-
 pulsar-functions/run-instance.sh                   | 37 ---------
 pulsar-functions/run-logging-examples.sh           |  8 +-
 pulsar-functions/run-publish-example.sh            |  4 +-
 .../container/ProcessFunctionContainer.java        |  6 +-
 .../functions/runtime/instance/ContextImpl.java    |  2 +-
 .../runtime/instance/JavaInstanceMain.java         |  2 +-
 .../runtime/instance/JavaInstanceRunnable.java     | 12 +--
 .../runtime/src/main/python/Function_pb2.py        | 96 +++++++++++++++-------
 .../runtime/src/main/python/contextimpl.py         |  2 +-
 .../runtime/src/main/python/python_instance.py     | 10 +--
 .../src/main/python/python_instance_main.py        |  4 +-
 .../pulsar/functions/fs/FunctionConfigTest.java    |  2 +-
 .../container/ProcessFunctionContainerTest.java    |  6 +-
 .../container/ThreadFunctionContainerTest.java     |  2 +-
 .../src/test/resources/test_function_config.yml    |  2 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 10 +--
 23 files changed, 189 insertions(+), 200 deletions(-)

commit 2dccc85a1223dc606cadec8a0ee55af7c4bca1d3
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 8 18:27:32 2018 -0600

    fixing bug in scheduler (#215)

 .../pulsar/functions/worker/SchedulerManager.java       | 17 ++++++++---------
 1 file changed, 8 insertions(+), 9 deletions(-)

commit 4b62d14cb7dea58fded16c9fa2209b18024b2511
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 7 14:38:50 2018 -0800

    Don't count first start as a restart (#214)

 .../main/java/org/apache/pulsar/functions/runtime/spawner/Spawner.java   | 1 -
 1 file changed, 1 deletion(-)

commit b64644c3f8b59c0a397b99430a9b28d255abac82
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 7 12:43:44 2018 -0800

    Accomodate native functions (#213)

 .../runtime/src/main/python/python_instance.py     |  8 +++++--
 pulsar-functions/runtime/src/main/python/util.py   | 25 +++++++++++++++-------
 2 files changed, 23 insertions(+), 10 deletions(-)

commit 6fc757e04675fb6a1182b8dae7c52c609f18c4fd
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Feb 7 12:08:13 2018 -0800

    Add a simpler way to publish (#212)

 .../src/main/java/org/apache/pulsar/functions/api/Context.java    | 8 ++++++++
 pulsar-functions/api-python/context.py                            | 5 +++++
 .../org/apache/pulsar/functions/runtime/instance/ContextImpl.java | 5 +++++
 pulsar-functions/runtime/src/main/python/contextimpl.py           | 3 +++
 4 files changed, 21 insertions(+)

commit 0d44440615aa1a0dd3326346209810b9b0bc3a26
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 6 22:31:35 2018 -0800

    Fix the way to import pulsarfunction root specific modules (#211)

 pulsar-functions/runtime/src/main/python/contextimpl.py     |  3 ++-
 pulsar-functions/runtime/src/main/python/python_instance.py | 12 ++++++------
 pulsar-functions/runtime/src/main/python/util.py            |  8 +++++---
 3 files changed, 13 insertions(+), 10 deletions(-)

commit c08b39226c1108b028e532a46125a1f251c3c9e3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 6 21:57:48 2018 -0800

    Always download because the code might have changed (#209)

 .../apache/pulsar/functions/worker/FunctionActioner.java  | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)

commit 911d28947c05e261b0e2d2561df496d313cb266b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 6 17:57:25 2018 -0800

    Fix variable name (#210)

 pulsar-functions/runtime/src/main/python/python_instance.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit f11f19268866c18a1b1aefcb371c2f438170137e
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 6 17:16:38 2018 -0800

    Since we assuming that user key/value are all strings, explicitly transform result to str (#208)

 pulsar-functions/runtime/src/main/python/contextimpl.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4b730b13e616797ebb35039f325e3ccebeb0f9be
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Feb 6 17:09:39 2018 -0800

    GetStatus should return a set of recent exceptions (#207)

 .../src/main/proto/InstanceCommunication.proto     |   6 ++
 .../functions/runtime/instance/FunctionStats.java  |  41 ++++++--
 .../runtime/instance/JavaInstanceRunnable.java     |  10 +-
 .../src/main/python/InstanceCommunication_pb2.py   | 111 +++++++++++++++++----
 .../runtime/src/main/python/python_instance.py     |  33 +++++-
 5 files changed, 165 insertions(+), 36 deletions(-)

commit 1832b52fac60dc170d0d4f7d195a1d8b1887df3f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Feb 6 10:13:18 2018 -0600

    fixing worker namespace initialize race condition (#206)

 .../java/org/apache/pulsar/functions/worker/Worker.java     | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

commit 3af1d480861f1656c4130f86a9266925eb8c7276
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Feb 6 08:53:49 2018 -0600

    fixing bug in snapshot manager (#204)

 .../pulsar/functions/worker/FunctionMetaDataSnapshotManager.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit a9c24379868ba8ba256864b6ae0a4bdb920c62ed
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 5 22:16:09 2018 -0800

    Add more information about function in getstatus (#205)

 .../proto/src/main/proto/InstanceCommunication.proto        |  1 +
 .../apache/pulsar/functions/runtime/spawner/Spawner.java    | 13 ++++++++++++-
 2 files changed, 13 insertions(+), 1 deletion(-)

commit 631f22f72680183c60fa88093c4e4bce450e9dca
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Feb 5 21:14:22 2018 -0800

    Consolidate error handling to Spawner (#203)

 pulsar-functions/conf/function_worker.yml          |  4 +-
 .../runtime/container/FunctionContainer.java       |  6 ++-
 .../container/ProcessFunctionContainer.java        | 54 +++++++++-------------
 .../container/ProcessFunctionContainerFactory.java |  6 +--
 .../runtime/container/ThreadFunctionContainer.java | 19 ++++++++
 .../pulsar/functions/runtime/spawner/Spawner.java  | 20 +++++---
 .../container/ProcessFunctionContainerTest.java    |  2 +-
 .../functions/worker/FunctionRuntimeManager.java   |  1 -
 .../pulsar/functions/worker/WorkerConfig.java      |  1 -
 9 files changed, 63 insertions(+), 50 deletions(-)

commit 8df9d5420e436fb89b53ccd8133ac5168fb0e482
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Feb 5 22:46:59 2018 -0600

    checking synchronization and adding comments (#202)

 .../functions/worker/FunctionRuntimeManager.java   |  91 ++++++++++++-----
 .../pulsar/functions/worker/MembershipManager.java | 112 ++++++++++++---------
 .../pulsar/functions/worker/SchedulerManager.java  |   5 +-
 .../functions/worker/MembershipManagerTest.java    |  19 ++--
 4 files changed, 140 insertions(+), 87 deletions(-)

commit 6779f3a4fa95bd7756d4efc5ea09eeb4d1124905
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Feb 5 18:42:19 2018 -0800

    synchronizing some methods and add comments (#201)

 .../functions/worker/FunctionMetaDataManager.java  | 164 ++++++++++++++-------
 .../functions/worker/FunctionRuntimeManager.java   |  10 ++
 .../worker/rest/api/v1/ApiV1Resource.java          |  11 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  32 ++--
 4 files changed, 143 insertions(+), 74 deletions(-)

commit 868d21dd3d65156c38ef1dafca46faa4de86a599
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Feb 4 20:22:58 2018 -0800

    Reload class for the function/serde type checking on submitting functions (#199)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 36 ++++++++++++++++++++--
 1 file changed, 34 insertions(+), 2 deletions(-)

commit 922494eebf2751bdb076c9a0e20797d8b79e6ff3
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Feb 2 22:37:02 2018 -0800

    Correct the order of checking (#197)
    
    * Correct the order of checking
    
    * Fix more logic

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  2 +-
 .../runtime/instance/JavaInstanceRunnable.java     | 31 +++++++++++++++-------
 2 files changed, 22 insertions(+), 11 deletions(-)

commit ac5ca04b704d34f8c65a57126c25fab7ddc23b13
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Feb 2 17:49:44 2018 -0800

    adding check for failures subroutine and fixing worker delete bug (#196)
    
    * adding check for failures subroutine and fixing worker delete bug
    
    * adding license header

 pulsar-functions/conf/function_worker.yml          |   2 +
 .../worker/ClusterServiceCoordinator.java          |   2 +-
 .../functions/worker/FunctionMetaDataManager.java  |   2 +-
 .../functions/worker/FunctionRuntimeManager.java   |   8 +
 .../pulsar/functions/worker/MembershipManager.java | 100 ++++++++-
 .../pulsar/functions/worker/SchedulerManager.java  |  24 ++-
 .../org/apache/pulsar/functions/worker/Worker.java |   6 +
 .../pulsar/functions/worker/WorkerConfig.java      |   2 +
 .../functions/worker/MembershipManagerTest.java    | 238 +++++++++++++++++++++
 9 files changed, 378 insertions(+), 6 deletions(-)

commit dfcfe5f664b5bc9e9b013f074fb66b3a6f6032c6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Feb 2 16:05:53 2018 -0800

    Avoid race condition by making methods synchronized (#195)

 .../container/ProcessFunctionContainer.java        | 37 +++++++++++++---------
 1 file changed, 22 insertions(+), 15 deletions(-)

commit dd8b4a8365bb12263479b5dba49a234eef46aca2
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Feb 2 15:45:46 2018 -0800

    Raise an exception if the module is not found (#194)

 pulsar-functions/runtime/src/main/python/python_instance.py | 3 +++
 1 file changed, 3 insertions(+)

commit a025bfe4f3d348e643bddded8ce05f06a033d338
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Feb 2 14:47:40 2018 -0800

    Added support for Pure Python Functions (#193)

 .../pure_python_function_exclamation.py            | 22 ++++++++++++++++++++++
 .../runtime/src/main/python/python_instance.py     |  5 ++++-
 2 files changed, 26 insertions(+), 1 deletion(-)

commit 37a0b635566ab45e42b2e0faad62825b4da7c9ef
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Feb 2 14:04:55 2018 -0800

    Added Java Native Functions capability (#192)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 27 +++++++++++----
 .../api/examples/JavaNativeExclmationFunction.java | 28 ++++++++++++++++
 .../functions/runtime/instance/JavaInstance.java   | 18 ++++++++--
 .../runtime/instance/JavaInstanceRunnable.java     | 38 ++++++++++++----------
 .../runtime/instance/JavaInstanceRunnableTest.java | 22 +++++++++----
 5 files changed, 99 insertions(+), 34 deletions(-)

commit ef5f986e485a44ad3dda211a8c11c41182d1c316
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 1 19:24:21 2018 -0800

    DefaultSerDe needs to be init specially for user publish (#191)

 .../org/apache/pulsar/functions/api/Context.java   |  2 +-
 .../functions/runtime/instance/ContextImpl.java    | 29 ++++++++++++++--------
 2 files changed, 20 insertions(+), 11 deletions(-)

commit 0c7e7b56fc5a9f6cf620405b77b92b10736825b4
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 1 18:51:50 2018 -0800

    Check for void type for output serde (#190)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 31 ++++++++++++----------
 1 file changed, 17 insertions(+), 14 deletions(-)

commit 555a08b04529508a9b1fc3bd6063311ba78deb04
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Feb 1 18:27:59 2018 -0800

    Add more type checks for Java submissions (#189)

 .../pulsar/functions/api/utils/DefaultSerDe.java   |  7 +--
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 50 +++++++++++++++++++++-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 26 +++++++----
 .../runtime/instance/JavaInstanceRunnable.java     |  6 +++
 .../apache/pulsar/functions/utils/Reflections.java |  8 ++++
 5 files changed, 82 insertions(+), 15 deletions(-)

commit 79a3b783f138561e59c25634e9e3827b0fb46808
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Feb 1 15:42:49 2018 -0800

     Fixing Function get status (#188)
    
    * Fixing Function get status
    
    * cleaning up
    
    * adding back comment
    
    * removing unneccessary dep

 pulsar-functions/conf/example.yml                  |   1 -
 pulsar-functions/conf/function_worker.yml          |   1 +
 .../functions/worker/FunctionRuntimeManager.java   | 107 ++++++++++++++++++++-
 .../pulsar/functions/worker/MembershipManager.java |  40 +++++++-
 .../pulsar/functions/worker/SchedulerManager.java  |   6 +-
 .../org/apache/pulsar/functions/worker/Worker.java |   8 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   1 +
 .../worker/rest/api/v1/ApiV1Resource.java          |  98 ++++++++-----------
 .../worker/FunctionRuntimeManagerTest.java         |   9 +-
 9 files changed, 193 insertions(+), 78 deletions(-)

commit dfb333f5ec9150dda097f1c8656f823f8c455da1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 31 16:02:09 2018 -0800

    Added a mechanism to configure user config via cli as well (#187)

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 180f01f76b3e1834b27d9cfe48211e2719a2d3e9
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 31 15:52:05 2018 -0800

    Implementing distributed worker mode (#184)

 pulsar-functions/conf/function_worker.yml          |   5 +-
 .../proto/src/main/proto/Function.proto            |   5 +-
 .../proto/src/main/proto/Request.proto             |   5 +
 .../functions/utils/FunctionConfigUtils.java       |   6 +-
 .../worker/ClusterServiceCoordinator.java          |  21 +-
 .../functions/worker/FunctionAssignmentTailer.java |  94 +++
 .../functions/worker/FunctionMetaDataManager.java  | 404 ++++++++++
 .../worker/FunctionMetaDataSnapshotManager.java    | 190 +++++
 .../worker/FunctionMetaDataTopicTailer.java        |  14 +-
 .../functions/worker/FunctionRuntimeManager.java   | 662 ++++++----------
 .../{LeaderElector.java => MembershipManager.java} |  66 +-
 .../pulsar/functions/worker/SchedulerManager.java  | 172 +++++
 .../org/apache/pulsar/functions/worker/Worker.java | 148 ++--
 .../pulsar/functions/worker/WorkerConfig.java      |  14 +-
 .../functions/worker/rest/BaseApiResource.java     |  16 +-
 .../pulsar/functions/worker/rest/WorkerServer.java |   5 +-
 .../worker/rest/api/v1/ApiV1Resource.java          | 138 ++--
 .../functions/worker/scheduler/IScheduler.java     |  30 +
 .../worker/scheduler/RoundRobinScheduler.java      |  73 ++
 .../worker/FunctionMetaDataManagerTest.java        | 451 +++++++++++
 .../FunctionMetaDataSnapshotManagerTest.java       | 217 ++++++
 .../worker/FunctionMetaDataTopicTailerTest.java    |   4 +-
 .../worker/FunctionRuntimeManagerTest.java         | 860 +++++----------------
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  45 +-
 24 files changed, 2314 insertions(+), 1331 deletions(-)

commit 3448c10a563d41bc465a8d72f8f1df06dcc32f6d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 30 18:15:18 2018 -0800

    during startup self.producer will always be null (#186)

 pulsar-functions/runtime/src/main/python/python_instance.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a954d965bba60a3f2b76443cc6bf92c6d3642246
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 30 18:01:36 2018 -0800

    Since server is already module name, rename the variable (#185)

 pulsar-functions/runtime/src/main/python/server.py | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

commit 10e45d62a42d2e11b2a91359953eece8915fe232
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 30 17:06:15 2018 -0800

    Added more python examples and fix existing (#183)

 pulsar-functions/python-examples/exclamation.py |  8 +++----
 pulsar-functions/python-examples/thumbnailer.py | 29 +++++++++++++++++++++++++
 pulsar-functions/submit-python-function.sh      |  1 -
 3 files changed, 33 insertions(+), 5 deletions(-)

commit aa36dcb4eb17919931aecea9c9c69adb664f9634
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 30 09:52:05 2018 -0800

    Fix python location (#168)
    
    * Improve pulsar functions logging
    
    - inject instance id in thread context. so we can have instance id information in function log
    - rename dlog logging to bk logging, so all bk/dlog logging can be routed there
    - add more variables to allow overrides by sys variables
    - fixes some scripts
    
    * Improve the logic for finding java instance location
    
    * Improve configuring log directory for pulsar worker
    
    * Fix python location
    
    * Fix license header

 pulsar-functions/bin/pulsar                        | 18 ++++++++++++++
 pulsar-functions/conf/function_worker.yml          |  2 --
 .../exclamation.py}                                | 11 +++++++-
 pulsar-functions/submit-python-function.sh         | 29 ++++++++++++++++++++++
 .../functions/worker/FunctionWorkerStarter.java    | 25 +++++++++++++++++++
 5 files changed, 82 insertions(+), 3 deletions(-)

commit ecf223c6ff2713a246500fba37afd26098c2770a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 22:05:18 2018 -0800

    Assume a default output topic if none is specified and create one (#182)
    
    only when needed

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 13 ++++++++++++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 19 ++++++++++++++++++
 .../runtime/instance/JavaInstanceRunnable.java     |  4 +++-
 .../pulsar/functions/runtime/spawner/Spawner.java  |  2 ++
 .../runtime/src/main/python/python_instance.py     | 23 ++++++++++++----------
 5 files changed, 50 insertions(+), 11 deletions(-)

commit 467f6e490477ae0bc1efb8df987e086bdd77cf57
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 18:29:36 2018 -0800

    Use the right regexp for extracting class name (#181)

 .../cli/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 75ce6650e929a6e920422e336b938022aa29cf43
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 18:21:49 2018 -0800

    Python Instance should resort to default serializer if nothing is specified (#180)

 .../runtime/src/main/python/python_instance.py     | 22 ++++++++++++++++------
 1 file changed, 16 insertions(+), 6 deletions(-)

commit 14b0fe4336fba578ec75c6a9b15fe32dc57f6a92
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 16:50:29 2018 -0800

    Removed Utf8SerDe now that we have its more generic alternative DefaultSerDe (#179)

 .../windowing/WindowedPulsarFunctionTest.java      | 20 +++++-----
 pulsar-functions/api-java/pom.xml                  |  7 ++++
 .../functions/api/utils/Utf8StringSerDe.java       | 45 ----------------------
 .../functions/api}/utils/DefaultSerDeTest.java     |  3 +-
 .../functions/api/utils/Utf8StringSerDeTest.java   | 41 --------------------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 22 +++++------
 .../src/test/resources/test_function_config.yml    |  2 +-
 .../functions/api/examples/PublishFunction.java    |  4 +-
 pulsar-functions/run-counter-examples.sh           |  2 +-
 pulsar-functions/run-examples.sh                   |  2 +-
 pulsar-functions/run-instance.sh                   |  4 +-
 pulsar-functions/run-logging-examples.sh           |  2 +-
 .../runtime/instance/JavaInstanceRunnable.java     |  7 ++--
 .../runtime/instance/JavaInstanceRunnableTest.java | 11 ++----
 .../runtime/instance/JavaInstanceTest.java         |  4 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  6 +--
 16 files changed, 49 insertions(+), 133 deletions(-)

commit 138da83b31d76b3f47e5b4fea51b37d6d8badd06
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 16:21:39 2018 -0800

    Simplify DefaultSerde and make users be able to explicitly set it (#178)

 .../pulsar/functions/api/utils/DefaultSerDe.java   |  18 +---
 .../runtime/instance/JavaInstanceRunnable.java     |  21 +++--
 .../runtime/instance/JavaInstanceRunnableTest.java |  42 +++++++--
 .../pulsar/functions/utils/DefaultSerDeTest.java   | 102 +++------------------
 4 files changed, 65 insertions(+), 118 deletions(-)

commit d498fa97ebf75da8e6f29d510a0b6da663c4fae8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 15:43:02 2018 -0800

    Move SimpleSerDe to api (#177)
    
    * Move SimpleSerDe to api
    
    * Renamed SimpleSerDe to DefaultSerDe

 .../pulsar/functions/api/utils/DefaultSerDe.java}  | 13 +++---
 .../runtime/instance/JavaInstanceRunnable.java     |  4 +-
 ...{SimpleSerDeTest.java => DefaultSerDeTest.java} | 47 +++++++++++-----------
 3 files changed, 33 insertions(+), 31 deletions(-)

commit 3b7d1f44cd3eca4b2a23912096eea40f3d5f1c6e
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 15:09:08 2018 -0800

    Return a valid response upon not being able to get status from spawner (#176)

 .../apache/pulsar/functions/worker/rest/api/v1/ApiV1Resource.java  | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

commit 06e7d7403dc7a17be53d32bdc6f86dcf0975bb61
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 14:56:41 2018 -0800

    Change the log file name to the name of the function. This greatly as (#175)
    
    * Change the log file name to the name of the function. This greatly assists in the debugging
    
    * Fix unittest

 .../pulsar/functions/runtime/container/ProcessFunctionContainer.java  | 4 ++--
 .../functions/runtime/container/ProcessFunctionContainerTest.java     | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit bcecfcc606088572e7c9112a52c7a2ff7478c7a1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 13:37:30 2018 -0800

    More checks for checking the presence of certain fields (#174)

 .../functions/runtime/container/ProcessFunctionContainer.java       | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 0e4a4daf7bdf4efc67c4de16aa7a65d9e0766c35
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 13:05:48 2018 -0800

    Add more logs while starting thread container (#173)

 .../functions/runtime/container/ThreadFunctionContainer.java      | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 342404165b41cb92a2a16e162f729980bbe8764d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 29 12:58:52 2018 -0800

    Infer Missing Arguments (#172)
    
    * Infer Missing Arguments
    
    * Added unittest

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 60 +++++++++++++++++++-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 66 ++++++++++++++++++++++
 2 files changed, 125 insertions(+), 1 deletion(-)

commit 5f84eb1b7b7908152be8041d1b1f3ce8a3f3d1f1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sun Jan 28 01:33:30 2018 -0800

    Make Output Serde Optional (#171)
    
    * Make Output Serde Optional
    
    * Fix unittest

 .../functions/runtime/instance/JavaInstance.java   |  31 +---
 .../runtime/instance/JavaInstanceRunnable.java     |  56 ++++--
 .../apache/pulsar/functions/utils/SimpleSerDe.java |   4 +-
 .../runtime/instance/JavaInstanceRunnableTest.java | 198 +++++++++++++++++++++
 .../runtime/instance/JavaInstanceTest.java         | 163 +----------------
 .../pulsar/functions/utils/SimpleSerDeTest.java    |  42 ++---
 6 files changed, 269 insertions(+), 225 deletions(-)

commit edbae3cd3edf7c2beb87d2bbeb942e2138387062
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Jan 27 20:16:52 2018 -0800

    Allow two types of input. (#170)
    
    1) one with DefaultSerDe
    2) one with custom SerDe

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  24 +++--
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  16 +--
 pulsar-functions/conf/example.yml                  |   3 +-
 .../proto/src/main/proto/Function.proto            |   3 +-
 pulsar-functions/run-counter-examples.sh           |   2 -
 pulsar-functions/run-examples.sh                   |   2 -
 pulsar-functions/run-logging-examples.sh           |   2 -
 pulsar-functions/run-publish-example.sh            |   2 -
 .../container/ProcessFunctionContainer.java        |  46 +++++----
 .../functions/runtime/instance/JavaInstance.java   |  27 ++---
 .../runtime/instance/JavaInstanceMain.java         |  31 ++++--
 .../runtime/instance/JavaInstanceRunnable.java     |  89 +++++++++++------
 .../functions/utils/FunctionConfigUtils.java       |   2 +-
 .../apache/pulsar/functions/utils/SimpleSerDe.java |  48 ++-------
 .../runtime/src/main/python/Function_pb2.py        |  88 +++++++++--------
 .../runtime/src/main/python/python_instance.py     |  24 +++--
 .../src/main/python/python_instance_main.py        |  24 +++--
 .../pulsar/functions/fs/FunctionConfigTest.java    |   2 +-
 .../container/ProcessFunctionContainerTest.java    |  12 +--
 .../container/ThreadFunctionContainerTest.java     |   2 +-
 .../runtime/instance/JavaInstanceTest.java         |  22 ++++-
 .../pulsar/functions/utils/SimpleSerDeTest.java    | 109 +++++++--------------
 .../src/test/resources/test_function_config.yml    |   3 +-
 .../worker/rest/api/v1/ApiV1Resource.java          |   2 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  10 +-
 25 files changed, 297 insertions(+), 298 deletions(-)

commit efce272e4fa2995826eb07fceae8f5cb17ca8ce6
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Jan 27 12:32:26 2018 -0800

    Use Spawner inside Java Instance rather than using JavaInstance directly (#169)

 .../runtime/instance/JavaInstanceMain.java         | 78 ++++++++++------------
 1 file changed, 37 insertions(+), 41 deletions(-)

commit 2f6167e0d0fbf86ca8f6105387334946bdfab8af
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 26 15:56:52 2018 -0800

    Improve the logic for finding java instance location (#166)

 pulsar-functions/bin/pulsar                           | 19 +++++++++++++++++++
 pulsar-functions/conf/function_worker.yml             |  1 -
 .../functions/worker/FunctionWorkerStarter.java       | 10 ++++++++++
 3 files changed, 29 insertions(+), 1 deletion(-)

commit 989f59d5be8a25e27dc7ee9bfe620a76cf14f111
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 26 15:44:56 2018 -0800

    Improve pulsar functions logging (#165)
    
    - inject instance id in thread context. so we can have instance id information in function log
    - rename dlog logging to bk logging, so all bk/dlog logging can be routed there
    - add more variables to allow overrides by sys variables
    - fixes some scripts

 pulsar-functions/bin/pulsar                        |   4 +
 pulsar-functions/bin/pulsar-functions              |   4 +
 pulsar-functions/conf/log4j2.yml                   | 116 +++++++++++++++++----
 pulsar-functions/run-counter-examples.sh           |   2 +-
 pulsar-functions/run-instance.sh                   |  37 +++++++
 .../runtime/instance/JavaInstanceMain.java         |   2 +-
 .../runtime/instance/JavaInstanceRunnable.java     |   7 +-
 .../src/main/resources/java_instance_log4j2.yml    | 113 +++++++++++++++++---
 8 files changed, 245 insertions(+), 40 deletions(-)

commit 4396db6817745a2b2f898bc158b19529a9694ec4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 26 10:38:31 2018 -0800

    Make state storage service url (#164)

 .../org/apache/pulsar/functions/runtime/instance/JavaInstanceMain.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3f963d8395ee5cd636fc1c2b1aedec4085369f66
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 26 00:09:25 2018 -0800

    Added SimpleSerDe to ser/deser basic types (#163)

 .../apache/pulsar/functions/utils/SimpleSerDe.java | 139 +++++++++++++
 .../pulsar/functions/utils/SimpleSerDeTest.java    | 220 +++++++++++++++++++++
 2 files changed, 359 insertions(+)

commit 46fe5d2fc0297303f2c19d7387f2f5782d42647c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 25 17:00:30 2018 -0800

    Interrupt instance thread when stopping function container (#162)

 .../cli/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 5 +++++
 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java  | 2 ++
 2 files changed, 7 insertions(+)

commit 21aec146b1b3c3f9d34d6c0aa48edbddf7d80b05
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 25 17:00:14 2018 -0800

    State - Counter support (#155)

 .../org/apache/pulsar/functions/api/Context.java   |   8 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   7 +-
 .../functions/api/examples/CounterFunction.java    |  35 +++++++
 pulsar-functions/run-counter-examples.sh           |  28 ++++++
 pulsar-functions/runtime/pom.xml                   |  16 ++++
 .../runtime/container/ThreadFunctionContainer.java |  12 ++-
 .../container/ThreadFunctionContainerFactory.java  |  19 +++-
 .../functions/runtime/instance/ContextImpl.java    |  13 +++
 .../functions/runtime/instance/JavaInstance.java   |   9 +-
 .../runtime/instance/JavaInstanceMain.java         |   6 +-
 .../runtime/instance/JavaInstanceRunnable.java     | 105 ++++++++++++++++++++-
 .../functions/runtime/state/StateContext.java      |  32 +++++++
 .../functions/runtime/state/StateContextImpl.java  |  62 ++++++++++++
 .../container/ThreadFunctionContainerTest.java     |   3 +-
 .../org/apache/pulsar/functions/worker/Worker.java |   3 +-
 .../pulsar/functions/worker/WorkerConfig.java      |   1 +
 16 files changed, 342 insertions(+), 17 deletions(-)

commit 4a820044b1a940c3f53e11e40a699440e7e44f22
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 25 16:07:35 2018 -0800

    Removed the usage of timer since it doesnt seem to be used (#161)

 .../pulsar/functions/runtime/container/ThreadFunctionContainerTest.java | 2 --
 1 file changed, 2 deletions(-)

commit 6e8d14e843badd8086f0dd35aa73d72576675803
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 25 15:23:23 2018 -0800

    localrun uses broker admin url and remove empty module (#160)

 pulsar-functions/conf/example.yml          |   2 +-
 pulsar-functions/pom.xml                   |   1 -
 pulsar-functions/run-examples.sh           |   4 +-
 pulsar-functions/run-logging-examples.sh   |   4 +-
 pulsar-functions/run-publish-example.sh    |   4 +-
 pulsar-functions/runtime-benchmark/pom.xml | 112 -----------------------------
 6 files changed, 7 insertions(+), 120 deletions(-)

commit 5f55daa28959c072c05a1e826c7f7c6e6840f3d0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 25 13:54:15 2018 -0800

    Remove type checking since Serde is now exposed (#159)
    
    * Remove logic of supported types since serde is now exposed to the user
    
    * Fix test

 .../functions/runtime/instance/JavaInstance.java   | 33 ++--------------------
 .../runtime/instance/JavaInstanceTest.java         | 28 ++++++++++++------
 2 files changed, 21 insertions(+), 40 deletions(-)

commit f0d9e1df046805c2cbe1e2be0786bcf2fd60ca3b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 25 12:03:43 2018 -0800

    Convert user config to json in process builder (#157)

 .../runtime/container/ProcessFunctionContainer.java      | 16 ++++++----------
 .../functions/runtime/instance/JavaInstanceMain.java     | 14 +++++---------
 .../runtime/src/main/python/python_instance_main.py      |  8 ++++----
 3 files changed, 15 insertions(+), 23 deletions(-)

commit a94e2d889a0fc46bdb67c1eefcde55ec6299de2f
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 25 11:59:29 2018 -0800

    remove possible race condition (#156)

 .../functions/composition/windowing/WaterMarkEventGeneratorTest.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 86c88972f08b54d823ac4fa33a75803456786ca0
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 24 22:16:45 2018 -0800

    correcting header files (#154)

 .../composition/windowing/DefaultEvictionContext.java |  7 +++----
 .../pulsar/functions/composition/windowing/Event.java |  7 +++----
 .../functions/composition/windowing/EventImpl.java    |  7 +++----
 .../composition/windowing/EvictionContext.java        |  7 +++----
 .../composition/windowing/EvictionPolicy.java         |  7 +++----
 .../pulsar/functions/composition/windowing/Pair.java  |  7 +++----
 .../composition/windowing/TimestampExtractor.java     |  7 +++----
 .../composition/windowing/TriggerHandler.java         |  7 +++----
 .../composition/windowing/TriggerPolicy.java          |  7 +++----
 .../composition/windowing/WaterMarkEvent.java         |  6 +++---
 .../windowing/WaterMarkEventGenerator.java            |  7 +++----
 .../functions/composition/windowing/Window.java       |  6 +++---
 .../functions/composition/windowing/WindowConfig.java |  7 +++----
 .../composition/windowing/WindowContext.java          |  7 +++----
 .../composition/windowing/WindowContextImpl.java      |  6 +++---
 .../functions/composition/windowing/WindowImpl.java   |  7 +++----
 .../windowing/WindowLifecycleListener.java            |  7 +++----
 .../composition/windowing/WindowManager.java          |  6 +++---
 .../functions/composition/windowing/WindowUtils.java  |  7 +++----
 .../composition/windowing/WindowedPulsarFunction.java |  6 +++---
 .../windowing/evictors/CountEvictionPolicy.java       |  7 +++----
 .../windowing/evictors/TimeEvictionPolicy.java        |  7 +++----
 .../evictors/WatermarkCountEvictionPolicy.java        |  6 +++---
 .../evictors/WatermarkTimeEvictionPolicy.java         |  6 +++---
 .../windowing/triggers/CountTriggerPolicy.java        |  7 +++----
 .../windowing/triggers/TimeTriggerPolicy.java         |  6 +++---
 .../triggers/WatermarkCountTriggerPolicy.java         |  6 +++---
 .../triggers/WatermarkTimeTriggerPolicy.java          |  6 +++---
 .../runtime/src/main/python/Function_pb2.py           | 19 +++++++++++++++++++
 .../runtime/src/main/python/python_instance_main.py   | 19 +++++++++++++++++++
 pulsar-functions/scripts/python/generate.sh           | 19 +++++++++++++++++++
 31 files changed, 141 insertions(+), 102 deletions(-)

commit 27cb857af1a72c1bcc9f07ec8ddf479a91c078e5
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 24 17:21:36 2018 -0800

    Added scripts to generate python packages (#153)

 pulsar-functions/scripts/python/README.txt        |  2 ++
 pulsar-functions/scripts/python/generate.sh       | 21 +++++++++++
 pulsar-functions/scripts/python/requirements.txt  |  0
 pulsar-functions/scripts/python/setup.py.template | 44 +++++++++++++++++++++++
 4 files changed, 67 insertions(+)

commit 907b6e4cf5186cfb6f17d20c9d93b781fd7fba4e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 24 17:01:46 2018 -0800

     changing publish function to accept string for classname (#152)
    
    * changing publish function to accept string for classname
    
    * cleaning up
    
    * making change for python api

 .../composition/windowing/WindowContext.java       |  4 +--
 .../composition/windowing/WindowContextImpl.java   |  4 +--
 .../windowing/WindowedPulsarFunction.java          |  4 +--
 .../windowing/WindowedPulsarFunctionTest.java      | 19 +++++++------
 .../org/apache/pulsar/functions/api/Context.java   |  6 ++---
 pulsar-functions/api-python/context.py             |  2 +-
 .../functions/api/examples/PublishFunction.java    |  2 +-
 .../functions/runtime/instance/ContextImpl.java    | 31 ++++++++++------------
 .../runtime/src/main/python/contextimpl.py         |  2 +-
 9 files changed, 35 insertions(+), 39 deletions(-)

commit 4b24eb691206683777b11a6cd3e5ef7684690eb2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 24 16:23:39 2018 -0800

    Correct spacing (#151)
    
    * fixing spacing
    
    * adding end file newline

 .../windowing/DefaultEvictionContext.java          | 102 ++---
 .../functions/composition/windowing/Event.java     |  68 ++--
 .../functions/composition/windowing/EventImpl.java |  66 ++--
 .../composition/windowing/EvictionContext.java     |  60 +--
 .../composition/windowing/EvictionPolicy.java      | 132 +++----
 .../functions/composition/windowing/Pair.java      | 148 +++----
 .../composition/windowing/TimestampExtractor.java  |  20 +-
 .../composition/windowing/TriggerHandler.java      |  18 +-
 .../composition/windowing/TriggerPolicy.java       |  72 ++--
 .../composition/windowing/WaterMarkEvent.java      |  28 +-
 .../windowing/WaterMarkEventGenerator.java         |   8 +-
 .../functions/composition/windowing/Window.java    |  78 ++--
 .../composition/windowing/WindowConfig.java        |   6 +-
 .../composition/windowing/WindowContext.java       |   6 +-
 .../composition/windowing/WindowContextImpl.java   |   9 +-
 .../composition/windowing/WindowImpl.java          | 132 +++----
 .../windowing/WindowLifecycleListener.java         |  42 +-
 .../composition/windowing/WindowManager.java       | 438 ++++++++++-----------
 .../composition/windowing/WindowUtils.java         |   6 +-
 .../windowing/WindowedPulsarFunction.java          |  18 +-
 .../windowing/evictors/CountEvictionPolicy.java    | 104 ++---
 .../windowing/evictors/TimeEvictionPolicy.java     | 142 +++----
 .../evictors/WatermarkCountEvictionPolicy.java     | 152 +++----
 .../evictors/WatermarkTimeEvictionPolicy.java      | 112 +++---
 .../windowing/triggers/CountTriggerPolicy.java     |  98 ++---
 .../windowing/triggers/TimeTriggerPolicy.java      |   6 +-
 .../triggers/WatermarkCountTriggerPolicy.java      | 126 +++---
 .../triggers/WatermarkTimeTriggerPolicy.java       | 182 ++++-----
 28 files changed, 1192 insertions(+), 1187 deletions(-)

commit 3682ed09ebd620e7dd76b0297f66dd683a26bbb4
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 24 16:17:17 2018 -0800

    adding unittest for windowing (#150)
    
    * adding unittest for windowing
    
    * cleaning up
    
    * removing print line

 pulsar-functions/api-composition-java/pom.xml      |  16 +-
 .../functions/composition/windowing/EventImpl.java |   2 +
 .../composition/windowing/WindowConfig.java        |   2 +-
 .../composition/windowing/WindowManager.java       |   2 +-
 .../windowing/WindowedPulsarFunction.java          |  72 +-
 .../windowing/WaterMarkEventGeneratorTest.java     | 134 ++++
 .../composition/windowing/WindowManagerTest.java   | 839 +++++++++++++++++++++
 .../windowing/WindowedPulsarFunctionTest.java      | 522 +++++++++++++
 .../src/test/resources/log4j2.yml                  |  37 +
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   1 -
 10 files changed, 1608 insertions(+), 19 deletions(-)

commit caddfd755bae5c6910e717a9036319efad136a9f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 24 14:57:57 2018 -0800

    Periodically check the liveness of the function process (#149)

 pulsar-functions/conf/function_worker.yml          | 11 ++--
 .../container/ProcessFunctionContainer.java        | 74 ++++++++++++++++------
 .../container/ProcessFunctionContainerFactory.java |  6 +-
 .../container/ProcessFunctionContainerTest.java    |  2 +-
 .../org/apache/pulsar/functions/worker/Worker.java |  1 +
 .../pulsar/functions/worker/WorkerConfig.java      |  1 +
 6 files changed, 68 insertions(+), 27 deletions(-)

commit 1ebc04d656ed6ae6a09cef7c1eaf020cd2de0965
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 24 12:26:42 2018 -0800

    Overhaul stats in both Java and Python instances (#148)
    
    * Overhaul stats in both Java and Python instances
    
    * Added licence header

 .../src/main/proto/InstanceCommunication.proto     |   6 ++
 .../functions/runtime/instance/FunctionStats.java  | 100 ++++++++++++++++---
 .../runtime/instance/JavaInstanceRunnable.java     |  54 ++++++----
 .../src/main/python/InstanceCommunication_pb2.py   | 109 +++++++++++++++------
 .../main/python/InstanceCommunication_pb2_grpc.py  |  17 ----
 .../runtime/src/main/python/python_instance.py     | 105 ++++++++++++++------
 6 files changed, 288 insertions(+), 103 deletions(-)

commit f77cd003113416f9c37b5d32ae64e3232f7fad9e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 23 21:58:21 2018 -0800

    moving windowing code (#147)

 pulsar-functions/api-composition-java/pom.xml      | 65 ++++++++++++++++++++++
 .../windowing/DefaultEvictionContext.java          |  2 +-
 .../functions/composition}/windowing/Event.java    |  2 +-
 .../composition}/windowing/EventImpl.java          |  2 +-
 .../composition}/windowing/EvictionContext.java    |  2 +-
 .../composition}/windowing/EvictionPolicy.java     |  2 +-
 .../functions/composition}/windowing/Pair.java     |  2 +-
 .../composition}/windowing/TimestampExtractor.java |  2 +-
 .../composition}/windowing/TriggerHandler.java     |  2 +-
 .../composition}/windowing/TriggerPolicy.java      |  2 +-
 .../composition}/windowing/WaterMarkEvent.java     |  2 +-
 .../windowing/WaterMarkEventGenerator.java         |  2 +-
 .../functions/composition}/windowing/Window.java   |  2 +-
 .../composition}/windowing/WindowConfig.java       |  2 +-
 .../composition}/windowing/WindowContext.java      |  2 +-
 .../composition}/windowing/WindowContextImpl.java  |  2 +-
 .../composition}/windowing/WindowImpl.java         |  2 +-
 .../windowing/WindowLifecycleListener.java         |  2 +-
 .../composition}/windowing/WindowManager.java      |  8 +--
 .../composition}/windowing/WindowUtils.java        |  2 +-
 .../windowing/WindowedPulsarFunction.java          | 18 +++---
 .../windowing/evictors/CountEvictionPolicy.java    |  8 +--
 .../windowing/evictors/TimeEvictionPolicy.java     |  8 +--
 .../evictors/WatermarkCountEvictionPolicy.java     | 11 ++--
 .../evictors/WatermarkTimeEvictionPolicy.java      |  6 +-
 .../windowing/triggers/CountTriggerPolicy.java     | 12 ++--
 .../windowing/triggers/TimeTriggerPolicy.java      | 14 ++---
 .../triggers/WatermarkCountTriggerPolicy.java      | 14 ++---
 .../triggers/WatermarkTimeTriggerPolicy.java       | 14 ++---
 pulsar-functions/api-java/pom.xml                  | 16 ------
 pulsar-functions/java-examples/pom.xml             |  6 ++
 .../functions/api/examples/WindowedFunction.java   |  8 +--
 pulsar-functions/pom.xml                           |  1 +
 33 files changed, 149 insertions(+), 96 deletions(-)

commit 524199189546997550d878067314011aff0f3286
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 18:20:18 2018 -0800

    Remove calculating of quantiles and keep stats simple (#146)

 .../functions/runtime/instance/FunctionStats.java  | 198 ++-------------------
 .../runtime/instance/JavaInstanceRunnable.java     |  15 +-
 2 files changed, 21 insertions(+), 192 deletions(-)

commit 331e6584f78104eaac6f5254452ae08eb0cebf57
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 23 18:20:05 2018 -0800

    Event time windowing for Pulsar Functions (#145)
    
    * event time windowing for Pulsar Functions
    
    * cleaning up
    
    * fixing logging

 pulsar-functions/api-java/pom.xml                  |  14 ++
 .../org/apache/pulsar/functions/api/Context.java   |  19 +++
 .../streamlet/windowing/TimestampExtractor.java    |   1 +
 .../api/streamlet/windowing/WaterMarkEvent.java    |  40 +++++
 .../windowing/WaterMarkEventGenerator.java         | 153 +++++++++++++++++++
 .../api/streamlet/windowing/WindowConfig.java      |   7 +
 .../api/streamlet/windowing/WindowContextImpl.java |  18 +++
 .../api/streamlet/windowing/WindowImpl.java        |   2 +-
 .../api/streamlet/windowing/WindowManager.java     | 108 ++++++++++---
 .../api/streamlet/windowing/WindowUtils.java       |  26 ++++
 .../windowing/WindowedPulsarFunction.java          | 168 +++++++++++++++++++--
 .../evictors/WatermarkCountEvictionPolicy.java     | 129 ++++++++++++++++
 .../evictors/WatermarkTimeEvictionPolicy.java      |  90 +++++++++++
 .../windowing/triggers/TimeTriggerPolicy.java      |  22 +--
 .../triggers/WatermarkCountTriggerPolicy.java      | 107 +++++++++++++
 .../triggers/WatermarkTimeTriggerPolicy.java       | 141 +++++++++++++++++
 pulsar-functions/conf/window_example.yml           |   3 +-
 .../functions/api/examples/WindowedFunction.java   |  29 +++-
 .../functions/runtime/instance/ContextImpl.java    |  29 +++-
 19 files changed, 1059 insertions(+), 47 deletions(-)

commit 7af9d02aa43d5d01f02acc78d83bb3812899694d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 17:37:53 2018 -0800

    Moved Stats to java instance since it now only has visibility in java world only (#144)

 .../runtime/container/ThreadFunctionContainer.java |  9 +--------
 .../{stats => runtime/instance}/FunctionStats.java |  5 ++---
 .../runtime/instance/JavaInstanceMain.java         | 10 ++--------
 .../runtime/instance/JavaInstanceRunnable.java     | 13 ++++++++++---
 .../pulsar/functions/stats/package-info.java       | 22 ----------------------
 5 files changed, 15 insertions(+), 44 deletions(-)

commit 937b57d658eca0972ae4b1487c6ded510bbcd273
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 16:53:22 2018 -0800

    Support explicit acking in the context just like Java interface (#143)

 pulsar-functions/api-python/context.py                      | 5 +++++
 pulsar-functions/runtime/src/main/python/contextimpl.py     | 8 +++++++-
 pulsar-functions/runtime/src/main/python/python_instance.py | 2 +-
 3 files changed, 13 insertions(+), 2 deletions(-)

commit bc074c871fd01bae7a5bda92e2de21f934a9c257
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 14:50:17 2018 -0800

    Propagate Auto Acking information to the processes (#142)
    
    * Retain server instance.
    
    * Pass AutoAcking information
    
    * By Default set auto acking to true

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java   | 1 +
 .../functions/runtime/container/ProcessFunctionContainer.java     | 6 ++++++
 .../pulsar/functions/runtime/instance/JavaInstanceMain.java       | 8 ++++++++
 pulsar-functions/runtime/src/main/python/python_instance_main.py  | 7 ++++++-
 pulsar-functions/runtime/src/main/python/server.py                | 4 +++-
 .../functions/runtime/container/ProcessFunctionContainerTest.java | 6 ++++--
 6 files changed, 28 insertions(+), 4 deletions(-)

commit f1c403cc80b8c425f08da917821b7c204dc4ec85
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 12:33:55 2018 -0800

    Quit cleanly upon ctrl-c (#141)

 .../runtime/src/main/python/python_instance.py      |  7 +++++++
 .../runtime/src/main/python/python_instance_main.py | 21 ++++++++++++++++++++-
 pulsar-functions/runtime/src/main/python/server.py  |  5 +----
 3 files changed, 28 insertions(+), 5 deletions(-)

commit a2ed4c209e474ddada34409501a51bf9d9af045b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 11:32:16 2018 -0800

    Kill process upon shutdown (#140)

 .../pulsar/functions/runtime/container/ProcessFunctionContainer.java     | 1 +
 1 file changed, 1 insertion(+)

commit d2f32e8c3892b36a7884abf45c7989738c3c11c8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 23 11:16:03 2018 -0800

    Feature Complete Python Instance.  (#139)
    
    * Feature rich python instance
    
    * Seperate out python instance from main
    
    * Functionally complete python
    
    * Fix syntax
    
    * Fix errors
    
    * More fixes
    
    * Semi working version
    
    * Fixed more errors in the produce path
    
    * User userCodeFile instead of jarFile
    
    * ProcessContainer launches correct python process
    
    * Stupid identation bug
    
    * Downloaded file should have the same name as the module
    
    * Added more comments
    
    * Fix a log issue
    
    * Add licence header

 pulsar-functions/api-python/__init__.py            |  21 +
 pulsar-functions/api-python/serde.py               |  10 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   9 +-
 pulsar-functions/conf/function_worker.yml          |   2 +-
 .../container/ProcessFunctionContainer.java        |  10 +-
 .../runtime/instance/JavaInstanceRunnable.java     |   5 +-
 .../functions/utils/FunctionConfigUtils.java       |  21 +
 .../runtime/src/main/python/Function_pb2.py        | 476 +++++++++++++++++++++
 .../runtime/src/main/python/__init__.py            |  21 +
 .../runtime/src/main/python/contextimpl.py         | 159 +++++++
 .../runtime/src/main/python/python_instance.py     | 187 ++++++--
 .../src/main/python/python_instance_main.py        | 103 +++++
 pulsar-functions/runtime/src/main/python/server.py |  12 +-
 pulsar-functions/runtime/src/main/python/util.py   |  72 ++++
 .../container/ProcessFunctionContainerTest.java    |   5 +-
 .../pulsar/functions/worker/FunctionActioner.java  |   3 +-
 16 files changed, 1057 insertions(+), 59 deletions(-)

commit 0667a4715c76d30f346cdeb6ae2526db6b27f6ac
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 23 02:17:54 2018 +0800

    Provide a copy task in runtime package phase to copy all python-instance required files into `target/python-instance` (#137)
    
    * Provide a copy task in runtime package phase to copy all python-instance required files into `target/python-instance`
    
    * cp api-python to target/python-instance/pulsar-function
    fix the licenses headers
    
    * Change `pulsar-function` to `pulsarfunction`

 pulsar-functions/api-python/context.py             | 19 +++++
 pulsar-functions/api-python/pulsar_function.py     | 19 +++++
 pulsar-functions/api-python/serde.py               | 19 +++++
 pulsar-functions/runtime/pom.xml                   | 96 ++++++++++++++--------
 .../src/main/python/InstanceCommunication_pb2.py   | 19 +++++
 .../main/python/InstanceCommunication_pb2_grpc.py  | 19 +++++
 pulsar-functions/runtime/src/main/python/log.py    | 19 +++++
 .../runtime/src/main/python/python_instance.py     | 19 +++++
 pulsar-functions/runtime/src/main/python/server.py | 19 +++++
 9 files changed, 212 insertions(+), 36 deletions(-)

commit 0ee69b979b0609869154708436f85ee42c2ddd66
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Jan 21 17:10:34 2018 -0800

    renaming to streamlet (#138)

 .../{dsl => streamlet}/windowing/DefaultEvictionContext.java |  2 +-
 .../functions/api/{dsl => streamlet}/windowing/Event.java    |  2 +-
 .../api/{dsl => streamlet}/windowing/EventImpl.java          |  2 +-
 .../api/{dsl => streamlet}/windowing/EvictionContext.java    |  2 +-
 .../api/{dsl => streamlet}/windowing/EvictionPolicy.java     |  2 +-
 .../functions/api/{dsl => streamlet}/windowing/Pair.java     |  2 +-
 .../api/{dsl => streamlet}/windowing/TimestampExtractor.java |  2 +-
 .../api/{dsl => streamlet}/windowing/TriggerHandler.java     |  2 +-
 .../api/{dsl => streamlet}/windowing/TriggerPolicy.java      |  2 +-
 .../functions/api/{dsl => streamlet}/windowing/Window.java   |  2 +-
 .../api/{dsl => streamlet}/windowing/WindowConfig.java       |  2 +-
 .../api/{dsl => streamlet}/windowing/WindowContext.java      |  2 +-
 .../api/{dsl => streamlet}/windowing/WindowContextImpl.java  |  2 +-
 .../api/{dsl => streamlet}/windowing/WindowImpl.java         |  2 +-
 .../windowing/WindowLifecycleListener.java                   |  2 +-
 .../api/{dsl => streamlet}/windowing/WindowManager.java      |  8 ++++----
 .../{dsl => streamlet}/windowing/WindowedPulsarFunction.java | 10 +++++-----
 .../windowing/evictors/CountEvictionPolicy.java              |  8 ++++----
 .../windowing/evictors/TimeEvictionPolicy.java               |  8 ++++----
 .../windowing/triggers/CountTriggerPolicy.java               | 12 ++++++------
 .../windowing/triggers/TimeTriggerPolicy.java                | 12 ++++++------
 .../pulsar/functions/api/examples/WindowedFunction.java      |  6 +++---
 22 files changed, 47 insertions(+), 47 deletions(-)

commit 6f853cd2cdf872bc5d77b698176bdd27cb5b4fdf
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Sun Jan 21 17:02:49 2018 -0800

    First of cut of windowing for Pulsar Functions (#136)
    
    * adding windowing to Pulsar functions
    
    * cleaning up
    
    * relocating code

 pulsar-functions/api-java/pom.xml                  |   4 +
 .../org/apache/pulsar/functions/api/Context.java   |  13 ++
 .../api/dsl/windowing/DefaultEvictionContext.java  |  83 ++++++++
 .../pulsar/functions/api/dsl/windowing/Event.java  |  65 ++++++
 .../functions/api/dsl/windowing/EventImpl.java     |  62 ++++++
 .../api/dsl/windowing/EvictionContext.java         |  57 ++++++
 .../api/dsl/windowing/EvictionPolicy.java          | 102 ++++++++++
 .../pulsar/functions/api/dsl/windowing/Pair.java   | 113 +++++++++++
 .../api/dsl/windowing/TimestampExtractor.java      |  34 ++++
 .../api/dsl/windowing/TriggerHandler.java          |  33 ++++
 .../functions/api/dsl/windowing/TriggerPolicy.java |  68 +++++++
 .../pulsar/functions/api/dsl/windowing/Window.java |  69 +++++++
 .../functions/api/dsl/windowing/WindowConfig.java  |  43 ++++
 .../functions/api/dsl/windowing/WindowContext.java | 100 ++++++++++
 .../api/dsl/windowing/WindowContextImpl.java       |  70 +++++++
 .../functions/api/dsl/windowing/WindowImpl.java    | 103 ++++++++++
 .../api/dsl/windowing/WindowLifecycleListener.java |  49 +++++
 .../functions/api/dsl/windowing/WindowManager.java | 218 +++++++++++++++++++++
 .../api/dsl/windowing/WindowedPulsarFunction.java  | 164 ++++++++++++++++
 .../windowing/evictors/CountEvictionPolicy.java    | 100 ++++++++++
 .../dsl/windowing/evictors/TimeEvictionPolicy.java | 113 +++++++++++
 .../dsl/windowing/triggers/CountTriggerPolicy.java |  92 +++++++++
 .../dsl/windowing/triggers/TimeTriggerPolicy.java  | 146 ++++++++++++++
 pulsar-functions/api-python/context.py             |  10 +
 pulsar-functions/conf/window_example.yml           |  30 +++
 .../functions/api/examples/WindowedFunction.java   |  20 ++
 .../functions/runtime/instance/ContextImpl.java    |  14 ++
 27 files changed, 1975 insertions(+)

commit fea9805e89705abb3717d43dd3090200bf6bab9f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 19 11:15:16 2018 -0800

    First cut of Python Instance that just parses the arguments and start (#135)
    
    * First cut of Python Instance that just parses the arguments and starts a server to process incoming requests
    
    * Add license header

 pulsar-functions/conf/function_worker.yml          |   7 +-
 .../container/ProcessFunctionContainer.java        |  31 +-
 .../runtime/instance/JavaInstanceMain.java         |  24 +-
 .../src/main/python/InstanceCommunication_pb2.py   | 317 +++++++++++++++++++++
 .../main/python/InstanceCommunication_pb2_grpc.py  |  84 ++++++
 pulsar-functions/runtime/src/main/python/log.py    |  92 ++++++
 .../runtime/src/main/python/python_instance.py     |  62 ++++
 pulsar-functions/runtime/src/main/python/server.py |  53 ++++
 .../container/ProcessFunctionContainerTest.java    |  44 +--
 9 files changed, 665 insertions(+), 49 deletions(-)

commit 0863c22798bb81af753a2ae342dd1c7c85d9c858
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 18 20:45:21 2018 -0800

    adding user acking and fixing bugs (#134)
    
    * adding user acking and fixing bugs
    
    * cleaning up

 .../org/apache/pulsar/functions/api/Context.java   |  4 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 19 ---------
 pulsar-functions/conf/client.conf                  |  2 +-
 pulsar-functions/conf/example.yml                  |  6 ++-
 .../proto/src/main/proto/Function.proto            |  1 +
 .../functions/runtime/instance/ContextImpl.java    | 30 +++++++++++---
 .../functions/runtime/instance/JavaInstance.java   | 15 ++++---
 .../runtime/instance/JavaInstanceRunnable.java     | 48 +++++++++++++---------
 .../runtime/instance/JavaInstanceTest.java         | 22 +++++-----
 .../worker/rest/api/v1/ApiV1Resource.java          |  3 --
 10 files changed, 85 insertions(+), 65 deletions(-)

commit b590e8bdba369829e4d32eefe68b772a346a52d0
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 18 16:39:45 2018 -0800

    Add plumbing to accept python inside worker/container (#133)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 43 ++++++++++++-------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  3 ++
 .../container/ProcessFunctionContainer.java        | 32 ++++++++------
 .../container/ProcessFunctionContainerFactory.java | 21 +++++++--
 .../container/ProcessFunctionContainerTest.java    | 50 ++++++++++++++++++----
 .../org/apache/pulsar/functions/worker/Worker.java |  1 +
 .../pulsar/functions/worker/WorkerConfig.java      |  1 +
 .../worker/rest/api/v1/ApiV1Resource.java          |  6 ---
 8 files changed, 111 insertions(+), 46 deletions(-)

commit 8f571de3b2cf33493df3ab29921f5a7b8932273a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 18 13:09:36 2018 -0800

    Added python api (#132)

 pulsar-functions/api-python/context.py         | 91 ++++++++++++++++++++++++++
 pulsar-functions/api-python/pulsar_function.py | 33 ++++++++++
 pulsar-functions/api-python/serde.py           | 49 ++++++++++++++
 3 files changed, 173 insertions(+)

commit 624afe71084aa4aae74af252f0d59669501b0e03
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 21:41:55 2018 -0800

    Renamed RequestHandler to PulsarFunction (#131)
    
    * Renamed RequestHandler to PulsarFunction
    
    * Fixed header

 .../{RequestHandler.java => PulsarFunction.java}   |  6 +++---
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  8 ++++----
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  4 ++--
 .../api/examples/ExclamationFunction.java          |  6 +++---
 .../functions/api/examples/LoggingFunction.java    |  6 +++---
 .../functions/api/examples/PublishFunction.java    |  6 +++---
 .../functions/api/examples/UserConfigFunction.java |  6 +++---
 .../functions/api/examples/UserMetricFunction.java |  6 +++---
 .../functions/api/examples/VoidFunction.java       |  6 +++---
 .../functions/runtime/instance/JavaInstance.java   | 15 +++++++-------
 .../runtime/instance/JavaInstanceTest.java         | 24 +++++++++++-----------
 .../worker/FunctionRuntimeManagerTest.java         |  6 +++---
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  6 +++---
 13 files changed, 52 insertions(+), 53 deletions(-)

commit 0e8412194094eff9098ee6f5727fafe8159fbf95
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 19:15:38 2018 -0800

    Removed RawRequest interface (#130)

 .../pulsar/functions/api/RawRequestHandler.java    | 39 ----------------------
 .../functions/runtime/instance/JavaInstance.java   | 36 ++++++--------------
 .../runtime/instance/JavaInstanceRunnable.java     |  4 +--
 .../runtime/instance/JavaInstanceTest.java         |  9 ++---
 4 files changed, 15 insertions(+), 73 deletions(-)

commit 850c1bd4a1e3be3247af76d48a6348faf1efb95a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 14:55:05 2018 -0800

    Moved api/examples to api-java and java-examples (#128)

 pulsar-functions/{api => api-java}/pom.xml                            | 0
 .../src/main/java/org/apache/pulsar/functions/api/Context.java        | 0
 .../main/java/org/apache/pulsar/functions/api/RawRequestHandler.java  | 0
 .../src/main/java/org/apache/pulsar/functions/api/RequestHandler.java | 0
 .../src/main/java/org/apache/pulsar/functions/api/SerDe.java          | 0
 .../src/main/java/org/apache/pulsar/functions/api/package-info.java   | 0
 .../main/java/org/apache/pulsar/functions/api/utils/JavaSerDe.java    | 0
 .../java/org/apache/pulsar/functions/api/utils/Utf8StringSerDe.java   | 0
 .../java/org/apache/pulsar/functions/api/utils/JavaSerDeTest.java     | 0
 .../org/apache/pulsar/functions/api/utils/Utf8StringSerDeTest.java    | 0
 pulsar-functions/{api-examples => java-examples}/pom.xml              | 0
 .../org/apache/pulsar/functions/api/examples/ExclamationFunction.java | 0
 .../org/apache/pulsar/functions/api/examples/LoggingFunction.java     | 0
 .../org/apache/pulsar/functions/api/examples/PublishFunction.java     | 0
 .../org/apache/pulsar/functions/api/examples/UserConfigFunction.java  | 0
 .../org/apache/pulsar/functions/api/examples/UserMetricFunction.java  | 0
 .../java/org/apache/pulsar/functions/api/examples/VoidFunction.java   | 0
 pulsar-functions/pom.xml                                              | 4 ++--
 .../pulsar/functions/runtime/container/ProcessFunctionContainer.java  | 2 +-
 .../org/apache/pulsar/functions/runtime/instance/ContextImpl.java     | 4 ++--
 20 files changed, 5 insertions(+), 5 deletions(-)

commit f50a68e55d1cd4bfa6a39b7370f7c479ff0fd159
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 17 14:18:06 2018 -0800

    adding additional worker tests (#127)

 .../pulsar/functions/worker/FunctionAction.java    |   2 +
 .../functions/worker/FunctionRuntimeManager.java   |  83 ++-
 .../worker/FunctionRuntimeManagerTest.java         | 776 ++++++++++++++++++++-
 3 files changed, 806 insertions(+), 55 deletions(-)

commit 6c380c4315c036b33594bf52f9cfb8af00735285
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 13:51:51 2018 -0800

    Added runtime descriptor in functionConfig (#126)
    
    * Added runtime descriptor in functionConfig
    
    * Fixed unittest

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  |  1 +
 pulsar-functions/proto/src/main/proto/Function.proto         | 12 ++++++++----
 .../runtime/container/ProcessFunctionContainer.java          |  4 ++++
 .../functions/runtime/container/ThreadFunctionContainer.java |  4 ++++
 .../pulsar/functions/worker/rest/api/v1/ApiV1Resource.java   |  6 ++++++
 .../functions/worker/rest/api/v1/ApiV1ResourceTest.java      |  1 -
 6 files changed, 23 insertions(+), 5 deletions(-)

commit f2d511e9cba4c0e26f6d694dc45af3beafef87bb
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 10:42:55 2018 -0800

    Added ability to specify subscription type (#124)
    
    * Added ability to specify subscription type
    
    * Fixed build
    
    * Do not expose subscription type in cmd line

 pulsar-functions/proto/src/main/proto/Function.proto               | 6 +++++-
 .../pulsar/functions/runtime/instance/JavaInstanceRunnable.java    | 7 ++++++-
 2 files changed, 11 insertions(+), 2 deletions(-)

commit 65f02b36ac06b39f79e583392f2934b05455bc4c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 07:59:18 2018 -0800

    Moved JavaInstanceConfig to InstanceConfig (#125)

 .../container/FunctionContainerFactory.java        |  4 +-
 .../InstanceConfig.java}                           |  4 +-
 .../container/ProcessFunctionContainer.java        |  4 +-
 .../container/ProcessFunctionContainerFactory.java |  8 +---
 .../runtime/container/ThreadFunctionContainer.java |  3 +-
 .../container/ThreadFunctionContainerFactory.java  |  3 +-
 .../functions/runtime/instance/ContextImpl.java    |  5 ++-
 .../functions/runtime/instance/JavaInstance.java   |  5 ++-
 .../runtime/instance/JavaInstanceMain.java         |  4 +-
 .../runtime/instance/JavaInstanceRunnable.java     | 51 +++++++++++-----------
 .../pulsar/functions/runtime/spawner/Spawner.java  | 18 ++++----
 .../container/ProcessFunctionContainerTest.java    |  7 ++-
 .../container/ThreadFunctionContainerTest.java     |  7 ++-
 .../runtime/instance/JavaInstanceTest.java         | 19 ++++----
 14 files changed, 66 insertions(+), 76 deletions(-)

commit b3a8b21d494b84b70d5599e55ca9742f1417d08b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 17 06:30:26 2018 -0800

    Added publish interface to the api (#123)
    
    * Added publish interface to the api
    
    * Address comments

 .../functions/api/examples/PublishFunction.java    | 31 +++++++++++++
 .../org/apache/pulsar/functions/api/Context.java   | 11 +++++
 pulsar-functions/conf/example.yml                  |  4 +-
 pulsar-functions/run-publish-example.sh            | 25 +++++++++++
 .../functions/runtime/instance/ContextImpl.java    | 52 +++++++++++++++++++++-
 .../functions/runtime/instance/JavaInstance.java   | 11 +++--
 .../runtime/instance/JavaInstanceRunnable.java     |  2 +-
 .../runtime/instance/JavaInstanceTest.java         | 13 +++---
 8 files changed, 137 insertions(+), 12 deletions(-)

commit 5dfbb27a4498cea78833a081f6685af0396cbc49
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 16 20:56:28 2018 -0800

    Move SerDe to api (#120)
    
    * Move SerDe to api
    
    * Incorporate comments

 .../org/apache/pulsar/functions/api}/SerDe.java    |  2 +-
 .../pulsar/functions/api/utils}/JavaSerDe.java     |  3 ++-
 .../functions/api/utils}/Utf8StringSerDe.java      | 10 ++++++----
 .../pulsar/functions/api/utils}/JavaSerDeTest.java |  1 +
 .../functions/api/utils}/Utf8StringSerDeTest.java  |  1 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  3 +--
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  2 +-
 pulsar-functions/run-examples.sh                   |  4 ++--
 pulsar-functions/run-logging-examples.sh           |  4 ++--
 .../functions/runtime/instance/JavaInstance.java   |  4 ++--
 .../runtime/instance/JavaInstanceRunnable.java     |  2 +-
 .../functions/runtime/serde/package-info.java      | 22 ----------------------
 .../container/ThreadFunctionContainerTest.java     |  2 +-
 .../runtime/instance/JavaInstanceTest.java         |  4 ++--
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  3 +--
 15 files changed, 24 insertions(+), 43 deletions(-)

commit 28ff62850f129d39faadfca2f65c37e2268b83a1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 16 20:48:32 2018 -0800

    Use a different location for caching the classpath (#122)

 pulsar-functions/bin/pulsar                                           | 4 ++--
 pulsar-functions/bin/pulsar-functions                                 | 4 ++--
 .../java/org/apache/pulsar/functions/worker/FunctionActioner.java     | 2 +-
 .../org/apache/pulsar/functions/worker/FunctionWorkerStarter.java     | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

commit 2e438b5bd806558edf50c6830d4fe6cb009ebe2d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 16 20:47:59 2018 -0800

    Add `join` interface to container to wait for a container (#121)

 .../cli/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java | 4 ++--
 .../pulsar/functions/runtime/container/FunctionContainer.java       | 2 ++
 .../functions/runtime/container/ProcessFunctionContainer.java       | 5 +++++
 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java | 5 +++++
 .../java/org/apache/pulsar/functions/runtime/spawner/Spawner.java   | 6 ++++++
 5 files changed, 20 insertions(+), 2 deletions(-)

commit ba069638c08351b1d635dd1606da0205c19a426f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 16 15:21:50 2018 -0800

    Added ability for a function to consume multiple input topics (#118)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  59 ++++++------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  20 ++--
 .../src/test/resources/test_function_config.yml    |   3 +-
 pulsar-functions/conf/client.conf                  |   2 +-
 pulsar-functions/conf/example.yml                  |   4 +-
 .../proto/src/main/proto/Function.proto            |   6 +-
 pulsar-functions/run-examples.sh                   |   4 +-
 pulsar-functions/run-logging-examples.sh           |   4 +-
 .../pulsar/functions/annotation/Annotations.java   |  84 ----------------
 .../pulsar/functions/annotation/RequiredField.java |  27 ------
 .../container/ProcessFunctionContainer.java        |  23 ++++-
 .../functions/runtime/instance/JavaInstance.java   |  22 ++---
 .../runtime/instance/JavaInstanceMain.java         |  14 ++-
 .../runtime/instance/JavaInstanceRunnable.java     | 106 ++++++++++++---------
 .../functions/utils/FunctionConfigUtils.java       |  10 ++
 .../functions/annotation/AnnotationsTest.java      |  67 -------------
 .../pulsar/functions/fs/FunctionConfigTest.java    |   4 +-
 .../container/ProcessFunctionContainerTest.java    |  10 +-
 .../container/ThreadFunctionContainerTest.java     |   3 +-
 .../runtime/instance/JavaInstanceTest.java         |  20 ++--
 .../src/test/resources/test_function_config.yml    |   3 +-
 .../worker/rest/api/v1/ApiV1Resource.java          |   7 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  33 +++----
 23 files changed, 203 insertions(+), 332 deletions(-)

commit 2cb75ba5737d6336ffe71ca0cc619ba32e911a7c
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 16 07:49:24 2018 -0800

    Fixing response and cli (#117)
    
    * fixing response codes and cli
    
    * cleaning up
    
    * fixing unit tests

 .../client/admin/internal/FunctionsImpl.java       | 20 +++++++++--
 .../worker/rest/api/v1/ApiV1Resource.java          | 41 +++++++++++-----------
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 37 ++++++++++---------
 3 files changed, 55 insertions(+), 43 deletions(-)

commit 693ae3b79b9383a264e4948d18a3f83bd990935b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jan 15 20:44:44 2018 -0800

    Use `pulsar-client-tools-shaded` jar to avoid inconsistency between shaded jars and avoid shading jackson (#116)

 pulsar-client-admin-shaded/pom.xml | 18 ++++++++++++++++++
 pulsar-client-shaded/pom.xml       | 12 ++++++++++++
 pulsar-client-tools-shaded/pom.xml |  4 ----
 pulsar-functions/runtime/pom.xml   |  2 +-
 pulsar-functions/worker/pom.xml    |  2 +-
 5 files changed, 32 insertions(+), 6 deletions(-)

commit 8fcdd09ed0273498cf37c50386a535aa15db501d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 15 17:48:36 2018 -0800

    Refactor serde classes into JavaInstanceRunnable (#115)

 .../functions/runtime/instance/JavaInstance.java   | 42 ++++++----------------
 .../runtime/instance/JavaInstanceRunnable.java     | 38 ++++++++++++++++++--
 .../runtime/instance/JavaInstanceTest.java         | 23 ++++++------
 3 files changed, 59 insertions(+), 44 deletions(-)

commit 882d56fabc50ca90cd29473f34ae15074b23a072
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jan 15 15:03:10 2018 -0800

    Adding snapshot feature to Pulsar Functions worker (#113)

 pulsar-functions/conf/function_worker.yml          |   7 +-
 .../proto/src/main/proto/Function.proto            |   6 +
 .../proto/{ServiceRequest.proto => Request.proto}  |   2 +-
 pulsar-functions/worker/pom.xml                    |   9 +-
 .../worker/ClusterServiceCoordinator.java          | 108 ++++++++++++
 .../worker/FunctionMetaDataTopicTailer.java        |  18 +-
 .../functions/worker/FunctionRuntimeManager.java   | 191 ++++++++++++++++++++-
 .../pulsar/functions/worker/LeaderElector.java     | 102 +++++++++++
 .../org/apache/pulsar/functions/worker/Utils.java  |  23 +++
 .../org/apache/pulsar/functions/worker/Worker.java |  77 +++++++--
 .../pulsar/functions/worker/WorkerConfig.java      |  15 +-
 .../worker/rest/api/v1/ApiV1Resource.java          |   2 +-
 .../worker/FunctionMetaDataTopicTailerTest.java    |   4 +-
 .../worker/FunctionRuntimeManagerTest.java         |  31 ++--
 .../pulsar/functions/worker/WorkerConfigTest.java  |   8 +-
 .../apache/pulsar/functions/worker/WorkerTest.java |  79 ---------
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |   4 +-
 .../src/test/resources/test_worker_config.yml      |   2 +-
 18 files changed, 547 insertions(+), 141 deletions(-)

commit 4cbec317ac9974e8fc761a32fcdfb6df70874d77
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Jan 15 13:59:51 2018 -0800

    adding log4j confs for unit tests (#114)

 pulsar-functions/cli/src/test/resources/log4j2.yml | 37 ++++++++++++++++++++++
 .../worker/src/test/resources/log4j2.yml           | 37 ++++++++++++++++++++++
 2 files changed, 74 insertions(+)

commit 8d4ff9570cb65e9897831544f6cc0ea4b7e395a7
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Jan 14 23:01:06 2018 -0800

    Shade `pulsar-client-admin` (#112)
    
    * Provide a shade `pulsar-client-admin` module
    
    * avoid shaded pulsar direct depenencies
    
    * Shade `pulsar-client-tools-shaded` as well

 pulsar-client-admin-shaded/pom.xml |  4 ++--
 pulsar-client-shaded/pom.xml       | 18 +++---------------
 pulsar-client-tools-shaded/pom.xml |  4 ++++
 pulsar-functions/cli/pom.xml       |  2 +-
 4 files changed, 10 insertions(+), 18 deletions(-)

commit 45c807eef43caf9c0ae67734f3f0db7c70e60bf8
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 12 16:43:33 2018 -0800

    Added system metrics to the list of metrics collected (#111)

 .../runtime/instance/JavaInstanceRunnable.java      | 21 ++++++++++++++++++---
 1 file changed, 18 insertions(+), 3 deletions(-)

commit 674b2a261f7fe7655ed6223c0f759eb340b4d27c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 12 14:50:25 2018 -0800

    Misc bug fixes to get metrics to work (#110)

 .../functions/api/examples/UserMetricFunction.java | 31 ++++++++++++++++++++++
 pulsar-functions/conf/function_worker.yml          |  6 +++++
 .../functions/runtime/instance/ContextImpl.java    |  3 ++-
 .../runtime/instance/JavaInstanceRunnable.java     |  6 ++++-
 .../runtime/metrics/sink/AbstractWebSink.java      | 28 ++-----------------
 .../pulsar/functions/runtime/spawner/Spawner.java  | 12 +++++++--
 .../org/apache/pulsar/functions/worker/Worker.java |  4 +--
 7 files changed, 58 insertions(+), 32 deletions(-)

commit 5bf96a71e90f92791e14296dbbb152aaa026650e
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 12 12:16:12 2018 -0800

    Added ability to specify metrics sinks (#109)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  4 +-
 .../apache/pulsar/functions/fs/MetricsConfig.java  | 55 ++++++++++++++++++++++
 .../pulsar/functions/runtime/spawner/Spawner.java  | 31 ++++++++++--
 .../pulsar/functions/worker/FunctionActioner.java  | 10 +++-
 .../org/apache/pulsar/functions/worker/Worker.java | 19 ++++++++
 .../pulsar/functions/worker/WorkerConfig.java      |  2 +
 6 files changed, 116 insertions(+), 5 deletions(-)

commit 1c4bbafd97a39f369e8fa34bf06cd7adeb7cb65c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 12 11:34:27 2018 -0800

    Added metrics sinks interface and added file and prometheus interface (#108)

 .../functions/runtime/metrics/MetricsSink.java     |  63 +++++++
 .../functions/runtime/metrics/package-info.java    |  22 +++
 .../runtime/metrics/sink/AbstractWebSink.java      | 163 ++++++++++++++++++
 .../functions/runtime/metrics/sink/FileSink.java   | 127 ++++++++++++++
 .../runtime/metrics/sink/PrometheusSink.java       | 182 +++++++++++++++++++++
 .../functions/utils/FunctionConfigUtils.java       |  12 ++
 .../runtime/metrics/sink/FileSinkTest.java         | 116 +++++++++++++
 .../runtime/metrics/sink/PrometheusSinkTests.java  | 139 ++++++++++++++++
 8 files changed, 824 insertions(+)

commit d400a034f69ed49d8c27ae93d34d4f2de2a49b23
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 11 19:20:23 2018 -0800

    Added Metric Interface (#107)

 .../org/apache/pulsar/functions/api/Context.java   |  7 +++
 .../src/main/proto/InstanceCommunication.proto     | 11 +++++
 .../runtime/container/FunctionContainer.java       |  6 ++-
 .../container/ProcessFunctionContainer.java        | 18 ++++++++
 .../runtime/container/ThreadFunctionContainer.java |  6 +++
 .../functions/runtime/instance/ContextImpl.java    | 54 ++++++++++++++++++++++
 .../functions/runtime/instance/JavaInstance.java   |  5 ++
 .../runtime/instance/JavaInstanceRunnable.java     |  8 +++-
 8 files changed, 112 insertions(+), 3 deletions(-)

commit 7ea376a6713c7315b7771499a3093922cdc6b601
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 11 11:35:52 2018 -0800

    Removed FunctionStatus and use protobuf as the central datastructure (#106)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  4 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  2 +-
 .../client/admin/internal/FunctionsImpl.java       |  8 ++--
 .../src/main/proto/InstanceCommunication.proto     | 17 ++++----
 .../apache/pulsar/functions/fs/FunctionStatus.java | 50 ----------------------
 .../runtime/container/FunctionContainer.java       |  2 +-
 .../container/ProcessFunctionContainer.java        | 22 +++-------
 .../runtime/container/ThreadFunctionContainer.java | 22 ++++++----
 .../runtime/instance/JavaInstanceMain.java         |  5 ++-
 .../pulsar/functions/runtime/spawner/Spawner.java  |  2 +-
 .../worker/rest/api/v1/ApiV1Resource.java          | 25 +++++------
 11 files changed, 55 insertions(+), 104 deletions(-)

commit cb74f216f4905570df151024ee88c09d5db4ae88
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 11 10:46:20 2018 -0800

    Added ProcessContainerFactory (#105)
    
    * Added Process based container factory
    
    * Added java instance log4j
    
    * Generate uberjar
    
    * Added log directory for process container
    
    * Better naming
    
    * Corrected java command line
    
    * More changes to get things to work
    
    * Fixed process args
    
    * Temp change that needs to be reverted
    
    * Merge conflict
    
    * Siwthced to gprc 1.5.0 for netty compat
    
    * Getter for ProcessBuilder
    
    * Added test
    
    * Added container info
    
    * Send Internal Server Error if we have trouble with the request
    
    * Dont use unsupported apis
    
    * Revert changes
    
    * Make Thread container as default
    
    * Fix build

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   1 +
 pulsar-functions/conf/function_worker.yml          |   5 +
 pulsar-functions/proto/pom.xml                     |   6 +
 .../src/main/proto/InstanceCommunication.proto     |  38 ++++
 pulsar-functions/runtime/pom.xml                   |  64 ++++++-
 .../container/ProcessFunctionContainer.java        | 203 ++++++++++++++++++++
 .../container/ProcessFunctionContainerFactory.java |  68 +++++++
 .../container/ThreadFunctionContainerFactory.java  |  10 +-
 .../functions/runtime/instance/JavaInstance.java   |   2 +-
 .../runtime/instance/JavaInstanceMain.java         | 209 +++++++++++++++++++++
 .../runtime/instance/JavaInstanceRunnable.java     |   5 +-
 .../functions/runtime/spawner/AssignmentInfo.java  |   1 +
 .../pulsar/functions/runtime/spawner/Spawner.java  |   8 +-
 .../src/main/resources/java_instance_log4j2.yml    |  84 +++++++++
 .../container/ProcessFunctionContainerTest.java    | 117 ++++++++++++
 .../container/ThreadFunctionContainerTest.java     |   1 +
 .../org/apache/pulsar/functions/worker/Worker.java |  17 +-
 .../pulsar/functions/worker/WorkerConfig.java      |  21 +++
 .../worker/rest/api/v1/ApiV1Resource.java          |   4 +
 19 files changed, 845 insertions(+), 19 deletions(-)

commit d02ae483136ff83be0f6601e1a7a6a2fbc62e451
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 10 17:27:49 2018 -0800

    Migrating FunctionConfig, FunctionMetaData, and ServiceRequest to proto (#104)
    
    * Migrating data structures to protobuf
    
    * fixing bugs
    
    * removing unneccessary files
    
    * fixing dependency issues
    
    * fixing wrong dependency
    
    * correct proto files
    
    * fixing issues
    
    * fix worker bug

 pulsar-broker/pom.xml                              |   5 +
 .../loadbalance/SimpleLoadManagerImplTest.java     |   1 +
 .../client/impl/BrokerClientIntegrationTest.java   |   2 +
 pulsar-functions/cli/pom.xml                       |  14 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  39 +++--
 .../org/apache/pulsar/admin/cli/FunctionsTool.java |   1 -
 .../org/apache/pulsar/client/admin/Functions.java  |   3 +-
 .../client/admin/internal/FunctionsImpl.java       |  16 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   2 +-
 pulsar-functions/conf/function_worker.yml          |   2 +-
 .../proto/src/main/proto/Function.proto            |  55 +++++++
 .../proto/src/main/proto/ServiceRequest.proto      |  33 +---
 pulsar-functions/runtime/pom.xml                   |  17 +-
 .../apache/pulsar/functions/fs/FunctionConfig.java |  88 -----------
 .../runtime/container/FunctionContainer.java       |   1 -
 .../runtime/container/ThreadFunctionContainer.java |   3 +-
 .../runtime/instance/JavaInstanceConfig.java       |   2 +-
 .../runtime/instance/JavaInstanceRunnable.java     |  15 +-
 .../functions/runtime/spawner/AssignmentInfo.java  |   2 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  |   2 +-
 .../functions/utils/FunctionConfigUtils.java       |  51 ++++++
 .../pulsar/functions/fs/FunctionConfigTest.java    |  24 +--
 .../container/ThreadFunctionContainerTest.java     |  18 +--
 .../runtime/instance/JavaInstanceTest.java         |  16 +-
 pulsar-functions/worker/pom.xml                    |  13 --
 .../pulsar/functions/worker/FunctionActioner.java  |   3 +-
 .../pulsar/functions/worker/FunctionMetaData.java  |  71 ---------
 .../worker/FunctionMetaDataTopicTailer.java        |  16 +-
 .../functions/worker/FunctionRuntimeInfo.java      |   3 +
 .../functions/worker/FunctionRuntimeManager.java   |  65 ++++----
 .../worker/request/DeregisterRequest.java          |  40 -----
 .../functions/worker/request/MarkerRequest.java    |  38 -----
 .../functions/worker/request/ServiceRequest.java   | 125 ---------------
 .../ServiceRequestInfo.java}                       |  37 +++--
 .../worker/request/ServiceRequestManager.java      |   3 +-
 .../worker/request/ServiceRequestUtils.java        |  61 +++++++
 .../functions/worker/request/UpdateRequest.java    |  40 -----
 .../pulsar/functions/worker/rest/WorkerServer.java |   1 +
 .../worker/rest/api/v1/ApiV1Resource.java          | 105 +++++++-----
 .../worker/FunctionMetaDataTopicTailerTest.java    |  16 +-
 .../apache/pulsar/functions/worker/WorkerTest.java |   2 +-
 .../worker/request/ServiceRequestManagerTest.java  |   5 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 176 +++++++++++++--------
 43 files changed, 540 insertions(+), 692 deletions(-)

commit ec46e1a4c5b3f37b743397d356ff4c471de4caed
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 10 12:07:14 2018 -0800

    LimitsConfig is always part of WorkerConfig (#103)

 .../org/apache/pulsar/functions/worker/FunctionActioner.java   |  7 ++-----
 .../apache/pulsar/functions/worker/FunctionWorkerStarter.java  |  9 +++------
 .../main/java/org/apache/pulsar/functions/worker/Worker.java   | 10 +++-------
 .../java/org/apache/pulsar/functions/worker/WorkerConfig.java  |  9 +--------
 .../pulsar/functions/worker/rest/api/v1/ApiV1Resource.java     |  6 ------
 .../java/org/apache/pulsar/functions/worker/WorkerTest.java    |  3 ++-
 .../pulsar/functions/worker/rest/api/v1/ApiV1ResourceTest.java |  2 +-
 7 files changed, 12 insertions(+), 34 deletions(-)

commit a0e4204dc51bfe925979b92d7bd56ca1dbda77f9
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jan 10 11:47:05 2018 -0800

    Rename generated module to proto module (#102)

 .../org/apache/pulsar/admin/cli/FunctionsTool.java |  1 -
 .../org/apache/pulsar/admin/cli/package-info.java  |  1 -
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  1 -
 pulsar-functions/pom.xml                           |  2 +-
 pulsar-functions/{generated => proto}/pom.xml      |  6 +++---
 .../src/main/proto/ServiceRequest.proto            |  6 +++---
 pulsar-functions/worker/pom.xml                    |  2 +-
 .../worker/FunctionMetaDataTopicTailer.java        |  4 ++--
 .../worker/request/DeregisterRequest.java          |  6 +++---
 .../functions/worker/request/MarkerRequest.java    |  6 +++---
 .../functions/worker/request/ServiceRequest.java   | 25 +++++++++++-----------
 .../functions/worker/request/UpdateRequest.java    |  6 +++---
 .../worker/FunctionMetaDataTopicTailerTest.java    |  2 +-
 .../worker/request/ServiceRequestManagerTest.java  |  2 +-
 14 files changed, 33 insertions(+), 37 deletions(-)

commit 8316228e1ab2af66dc03edaa65cd8cdbe53f6070
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jan 10 11:09:18 2018 -0800

    Refactor functions module structure (#101)
    
    because pulsar-client is using patched protobuf, while dlog/bookkeeper/functions uses same proto3.
    
    - move cli related classes to a CLI module
    - use pulsar-client (shaded jar) for runtime
    - use dlog (unshaded jar) in worker

 pulsar-functions/bin/pulsar                        |   6 +-
 pulsar-functions/bin/pulsar-functions              |   4 +-
 pulsar-functions/cli/pom.xml                       |  88 +++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   0
 .../org/apache/pulsar/admin/cli/FunctionsTool.java |   0
 .../org/apache/pulsar/admin/cli/package-info.java  |   0
 .../org/apache/pulsar/client/admin/Functions.java  |   0
 .../pulsar/client/admin/PulsarFunctionsAdmin.java  |   0
 .../client/admin/internal/FunctionsImpl.java       |   0
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   0
 .../src/test/resources/test_function_config.yml    |  23 ++++
 .../generated/src/main/proto/ServiceRequest.proto  |  18 +++
 pulsar-functions/pom.xml                           |  21 +++
 pulsar-functions/runtime/pom.xml                   |  86 ++-----------
 .../pulsar/functions/stats/FunctionStats.java      |   6 +-
 .../container/ThreadFunctionContainerTest.java     |   2 +-
 pulsar-functions/worker/pom.xml                    | 143 ++++++++++++---------
 .../functions/worker/FunctionRuntimeManager.java   |   6 +-
 .../functions/worker/FunctionWorkerStarter.java    |   4 -
 .../org/apache/pulsar/functions/worker/Utils.java  |   6 +-
 .../org/apache/pulsar/functions/worker/Worker.java |   8 ++
 .../functions/worker/request/MarkerRequest.java    |   6 +-
 .../functions/worker/request/ServiceRequest.java   |   6 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |   2 +-
 24 files changed, 271 insertions(+), 164 deletions(-)

commit 7b24f686e63ff5e305a2f911b60cf8ec6c1a2f94
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 9 20:46:47 2018 -0800

    Removed FunctionId and InstanceId (#100)

 .../org/apache/pulsar/functions/fs/FunctionID.java | 41 --------------
 .../org/apache/pulsar/functions/fs/InstanceID.java | 43 --------------
 .../java/org/apache/pulsar/functions/fs/UUID.java  | 65 ----------------------
 .../runtime/functioncache/FunctionCacheEntry.java  | 11 ++--
 .../functioncache/FunctionCacheManager.java        | 25 ++++-----
 .../functioncache/FunctionCacheManagerImpl.java    | 16 +++---
 .../runtime/instance/JavaInstanceConfig.java       |  6 +-
 .../functions/runtime/spawner/AssignmentInfo.java  |  3 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  |  3 +-
 .../apache/pulsar/functions/fs/FunctionIDTest.java | 50 -----------------
 .../apache/pulsar/functions/fs/InstanceIDTest.java | 51 -----------------
 .../container/ThreadFunctionContainerTest.java     |  6 +-
 .../functioncache/FunctionCacheEntryTest.java      | 19 +++----
 .../FunctionCacheManagerImplTest.java              | 28 ++++------
 14 files changed, 48 insertions(+), 319 deletions(-)

commit 426ab5422b25c8c9b7e5e3fe9d8546f852de2978
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 9 18:19:42 2018 -0800

    Migrating ServiceRequest to proto (#99)

 .../generated/src/main/proto/ServiceRequest.proto  |   3 +-
 .../pulsar/functions/worker/FunctionMetaData.java  |   3 -
 .../worker/FunctionMetaDataTopicTailer.java        |  19 +--
 .../functions/worker/FunctionRuntimeManager.java   |  30 ++--
 .../functions/worker/FunctionWorkerStarter.java    |   1 -
 .../worker/request/DeregisterRequest.java          |  19 ++-
 .../functions/worker/request/MarkerRequest.java    |  26 ++--
 .../functions/worker/request/ServiceRequest.java   | 155 ++++++++++++---------
 .../worker/request/ServiceRequestManager.java      |  12 +-
 .../functions/worker/request/UpdateRequest.java    |  17 ++-
 .../worker/rest/api/v1/ApiV1Resource.java          |   2 -
 .../worker/FunctionMetaDataTopicTailerTest.java    |  11 +-
 .../worker/request/ServiceRequestManagerTest.java  |   2 +
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |   1 -
 14 files changed, 149 insertions(+), 152 deletions(-)

commit ce81cb77fe02efacc7074bbdfeb7fef998d6b636
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 9 14:13:03 2018 -0800

    fixing generated dir (#98)

 pulsar-functions/generated/pom.xml                 |  2 +-
 .../generated/src/main/proto/ServiceRequest.proto  | 47 +++++++++++++---------
 pulsar-functions/pom.xml                           |  1 +
 3 files changed, 31 insertions(+), 19 deletions(-)

commit d07897ae771a7b78986185afdd54bbf00ca3772d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 9 11:38:58 2018 -0800

    updating generated code dir (#97)

 pulsar-functions/generated/pom.xml                 |   40 +-
 .../pulsar/functions/generated/ServiceRequest.java | 2263 --------------------
 pulsar-functions/worker/pom.xml                    |    6 +
 3 files changed, 39 insertions(+), 2270 deletions(-)

commit fe80a6cf9149abf8a77b99663e03ef03b84953fb
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 9 10:43:18 2018 -0800

    adding generated code module (#96)

 pulsar-functions/generated/pom.xml                 |   50 +
 .../pulsar/functions/generated/ServiceRequest.java | 2263 ++++++++++++++++++++
 .../generated/src/main/proto/ServiceRequest.proto  |   30 +
 3 files changed, 2343 insertions(+)

commit 9abeef2a2b3041daa8d6ca7bbbf3be93b7cf79fe
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 9 10:37:57 2018 -0800

    Simplify Container interface (#95)

 .../org/apache/pulsar/admin/cli/CmdFunctions.java     |  6 +++++-
 .../runtime/container/FunctionContainer.java          |  4 ----
 .../runtime/container/ThreadFunctionContainer.java    | 19 +++----------------
 .../pulsar/functions/runtime/spawner/Spawner.java     |  6 ------
 4 files changed, 8 insertions(+), 27 deletions(-)

commit 72a9804570a5964224cb7e1b3afd57e42ff37dce
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 9 10:18:35 2018 -0800

    Moved FunctionId/InstanceId to fs package (#94)

 .../java/org/apache/pulsar/functions/{runtime => fs}/FunctionID.java  | 2 +-
 .../java/org/apache/pulsar/functions/{runtime => fs}/InstanceID.java  | 2 +-
 .../main/java/org/apache/pulsar/functions/{runtime => fs}/UUID.java   | 2 +-
 .../pulsar/functions/runtime/functioncache/FunctionCacheEntry.java    | 2 +-
 .../pulsar/functions/runtime/functioncache/FunctionCacheManager.java  | 4 ++--
 .../functions/runtime/functioncache/FunctionCacheManagerImpl.java     | 4 ++--
 .../apache/pulsar/functions/runtime/instance/JavaInstanceConfig.java  | 4 ++--
 .../org/apache/pulsar/functions/runtime/spawner/AssignmentInfo.java   | 2 +-
 .../java/org/apache/pulsar/functions/runtime/spawner/Spawner.java     | 2 +-
 .../org/apache/pulsar/functions/{runtime => fs}/FunctionIDTest.java   | 3 ++-
 .../org/apache/pulsar/functions/{runtime => fs}/InstanceIDTest.java   | 4 +++-
 .../functions/runtime/container/ThreadFunctionContainerTest.java      | 4 ++--
 .../functions/runtime/functioncache/FunctionCacheEntryTest.java       | 2 +-
 .../functions/runtime/functioncache/FunctionCacheManagerImplTest.java | 4 ++--
 14 files changed, 22 insertions(+), 19 deletions(-)

commit f65c4a44cda194789f2d5f47a4c891e98e26ed83
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 9 01:21:20 2018 -0800

    Move most of the instance logic to JavaInstanceRunnable (#93)

 .../runtime/container/FunctionContainer.java       |   2 -
 .../runtime/container/ThreadFunctionContainer.java | 228 +------------------
 .../runtime/instance/JavaInstanceRunnable.java     | 250 +++++++++++++++++++++
 .../container/ThreadFunctionContainerTest.java     |   9 +-
 4 files changed, 266 insertions(+), 223 deletions(-)

commit 493e54ae1fef1fd41f4f7a2f0797f06e5034a8cc
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 8 23:13:39 2018 -0800

    Made use of LimitsConfig in JavaInstanceConfig (#92)
    
    * Made use of LimitsConfig in JavaInstanceConfig
    
    * Add uncommited file

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java |  3 +--
 .../functions/{runtime/spawner => fs}/LimitsConfig.java     |  2 +-
 .../pulsar/functions/runtime/instance/ContextImpl.java      |  4 ++--
 .../pulsar/functions/runtime/instance/JavaInstance.java     |  2 +-
 .../functions/runtime/instance/JavaInstanceConfig.java      |  6 +++---
 .../apache/pulsar/functions/runtime/spawner/Spawner.java    |  4 ++--
 .../runtime/container/ThreadFunctionContainerTest.java      |  7 +++++--
 .../pulsar/functions/runtime/instance/JavaInstanceTest.java | 13 ++++++++-----
 .../apache/pulsar/functions/worker/FunctionActioner.java    |  2 +-
 .../apache/pulsar/functions/worker/FunctionMetaData.java    |  2 +-
 .../pulsar/functions/worker/FunctionWorkerStarter.java      |  2 +-
 .../java/org/apache/pulsar/functions/worker/Worker.java     |  3 +--
 .../org/apache/pulsar/functions/worker/WorkerConfig.java    |  2 +-
 .../pulsar/functions/worker/rest/api/v1/ApiV1Resource.java  |  2 +-
 .../java/org/apache/pulsar/functions/worker/WorkerTest.java |  2 +-
 .../functions/worker/rest/api/v1/ApiV1ResourceTest.java     |  2 +-
 16 files changed, 31 insertions(+), 27 deletions(-)

commit 71997bb7e3353ac82f25e4816ec5c304acd16923
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 8 18:50:29 2018 -0800

    Make ThreadFactory as thin as possible (#91)

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 10 +---------
 .../runtime/container/ThreadFunctionContainerFactory.java      |  5 ++---
 .../main/java/org/apache/pulsar/functions/worker/Worker.java   |  2 +-
 3 files changed, 4 insertions(+), 13 deletions(-)

commit d82a04f80216212270ae45c968f96e85bde290ac
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jan 8 18:46:26 2018 -0800

    Move worker module out of runtime module (#90)
    
    * Move worker module out of runtime module
    
    * Fix license header issues

 pulsar-functions/pom.xml                           |   1 +
 pulsar-functions/runtime/pom.xml                   |  22 ---
 pulsar-functions/worker/pom.xml                    | 183 +++++++++++++++++++++
 .../pulsar/functions}/worker/FunctionAction.java   |   2 +-
 .../pulsar/functions}/worker/FunctionActioner.java |   2 +-
 .../pulsar/functions}/worker/FunctionMetaData.java |   2 +-
 .../worker/FunctionMetaDataTopicTailer.java        |  10 +-
 .../functions}/worker/FunctionRuntimeInfo.java     |   2 +-
 .../functions}/worker/FunctionRuntimeManager.java  |  14 +-
 .../functions/worker}/FunctionWorkerStarter.java   |   4 +-
 .../functions}/worker/PackageLocationMetaData.java |   2 +-
 .../org/apache/pulsar/functions}/worker/Utils.java |   6 +-
 .../apache/pulsar/functions}/worker/Worker.java    |   6 +-
 .../pulsar/functions}/worker/WorkerConfig.java     |   2 +-
 .../functions}/worker/dlog/DLInputStream.java      |   2 +-
 .../functions}/worker/dlog/DLOutputStream.java     |   2 +-
 .../worker/request/DeregisterRequest.java          |   6 +-
 .../functions}/worker/request/MarkerRequest.java   |   4 +-
 .../functions}/worker/request/RequestResult.java   |   2 +-
 .../functions}/worker/request/ServiceRequest.java  |   4 +-
 .../worker/request/ServiceRequestManager.java      |   4 +-
 .../functions}/worker/request/UpdateRequest.java   |   4 +-
 .../functions}/worker/rest/BaseApiResource.java    |   6 +-
 .../worker/rest/ConfigurationResource.java         |   2 +-
 .../pulsar/functions}/worker/rest/Resources.java   |   4 +-
 .../pulsar/functions}/worker/rest/RestUtils.java   |   2 +-
 .../functions}/worker/rest/WorkerServer.java       |   6 +-
 .../worker/rest/api/v1/ApiV1Resource.java          |  15 +-
 .../worker/FunctionMetaDataTopicTailerTest.java    |   6 +-
 .../worker/FunctionRuntimeManagerTest.java         |   4 +-
 .../pulsar/functions}/worker/WorkerConfigTest.java |   2 +-
 .../pulsar/functions}/worker/WorkerTest.java       |   2 +-
 .../functions}/worker/dlog/DLInputStreamTest.java  |   2 +-
 .../functions}/worker/dlog/DLOutputStreamTest.java |   2 +-
 .../worker/request/ServiceRequestManagerTest.java  |   4 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      |  43 ++---
 .../src/test/resources/test_worker_config.yml      |   0
 37 files changed, 278 insertions(+), 108 deletions(-)

commit 1b0607a18a798a6747670fe621f436172491b1fa
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 8 15:02:57 2018 -0800

    Added ability to propagate user defined configs (#89)

 .../functions/api/examples/UserConfigFunction.java | 30 ++++++++
 .../org/apache/pulsar/functions/api/Context.java   |  7 ++
 .../client/admin/internal/FunctionsImpl.java       | 31 +-------
 .../pulsar/functions/annotation/Annotations.java   | 26 +++++++
 .../apache/pulsar/functions/fs/FunctionConfig.java |  4 +-
 .../functions/runtime/instance/ContextImpl.java    |  9 +++
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 79 +++++++-------------
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 83 +++++++---------------
 8 files changed, 130 insertions(+), 139 deletions(-)

commit 5650574a4aa383bfe18bc39f6a568cfb04d4f7ba
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Jan 8 10:37:51 2018 -0800

    Refactor worker to make sure that FunctionActioner is just an actioner. Also consolidate all info in worker in FunctionRuntimeInfo (#88)

 .../functions/runtime/worker/FunctionAction.java   |  2 +-
 .../functions/runtime/worker/FunctionActioner.java | 51 ++++------------
 .../functions/runtime/worker/FunctionMetaData.java |  1 -
 .../worker/FunctionMetaDataTopicTailer.java        | 15 +++--
 .../runtime/worker/FunctionRuntimeInfo.java        | 35 +++++++++++
 ...ataManager.java => FunctionRuntimeManager.java} | 67 ++++++++++------------
 .../pulsar/functions/runtime/worker/Worker.java    | 12 ++--
 .../runtime/worker/rest/BaseApiResource.java       | 23 ++------
 .../runtime/worker/rest/WorkerServer.java          |  9 +--
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 39 ++++++-------
 .../worker/FunctionMetaDataTopicTailerTest.java    |  4 +-
 ...erTest.java => FunctionRuntimeManagerTest.java} |  4 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 14 ++---
 13 files changed, 129 insertions(+), 147 deletions(-)

commit f4130f85d4332b698d7d387ee93461e55ba00bff
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Sat Jan 6 12:51:49 2018 -0800

    Added getstatus function (#87)
    
    * Added getstatus function
    
    * Changed to GetFunctionStatus
    
    * Added licence header

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 17 +++++
 .../org/apache/pulsar/client/admin/Functions.java  | 27 ++++---
 .../client/admin/internal/FunctionsImpl.java       | 10 +++
 .../runtime/container/FunctionContainer.java       |  3 +
 .../runtime/container/ThreadFunctionContainer.java | 21 ++++--
 .../pulsar/functions/runtime/spawner/Spawner.java  |  6 ++
 .../functions/runtime/worker/FunctionActioner.java | 83 ++++++++++++----------
 .../functions/runtime/worker/FunctionMetaData.java |  2 +
 .../pulsar/functions/runtime/worker/Utils.java     | 24 +++----
 .../pulsar/functions/runtime/worker/Worker.java    |  2 +-
 .../runtime/worker/request/MarkerRequest.java      | 18 +++++
 .../runtime/worker/rest/BaseApiResource.java       | 10 +++
 .../runtime/worker/rest/WorkerServer.java          |  3 +
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 56 +++++++++++++--
 14 files changed, 210 insertions(+), 72 deletions(-)

commit d5955d86237b4eb40dce0f3b8febab3eae87d654
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jan 5 17:17:58 2018 -0800

    adding initialize routine to launch existing assignments (#86)

 .../runtime/worker/FunctionMetaDataManager.java    | 85 +++++++++++++++++-----
 .../worker/FunctionMetaDataTopicTailer.java        | 11 +++
 .../runtime/worker/request/DeregisterRequest.java  |  3 +-
 .../runtime/worker/request/MarkerRequest.java      | 16 ++++
 .../runtime/worker/request/ServiceRequest.java     |  3 +-
 .../runtime/worker/request/UpdateRequest.java      |  2 +
 6 files changed, 99 insertions(+), 21 deletions(-)

commit aa1922678940d8035244247d3bb8c5ed79222180
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 5 13:44:33 2018 -0800

    Pulsar worker uses routing appender (#85)
    
    * Fix upload path issue
    
    * fix logging

 pulsar-functions/bin/pulsar               |  2 +-
 pulsar-functions/conf/example_logging.yml | 27 +++++++++++++++++++++++++++
 2 files changed, 28 insertions(+), 1 deletion(-)

commit 5dcf03a10bb354478dc489c647e029afa42d390f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 5 13:23:36 2018 -0800

    If the function is not found, send 404 (#84)
    
    * If the function is not found, send 404
    
    * Fix unittest

 .../pulsar/functions/runtime/worker/rest/api/v1/ApiV1Resource.java      | 2 +-
 .../pulsar/functions/runtime/worker/rest/api/v1/ApiV1ResourceTest.java  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit ab3007f9eae48a50cbae23e06e5d744baedf8394
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Jan 5 13:07:59 2018 -0800

    Removed FunctionStats interface and added FunctionStatus class (#82)

 .../fs/{FunctionStats.java => FunctionStatus.java} |  45 ++++-----
 .../runtime/container/ThreadFunctionContainer.java |  12 +--
 .../{FunctionStatsImpl.java => FunctionStats.java} | 103 +++++++++++++--------
 3 files changed, 91 insertions(+), 69 deletions(-)

commit ee0ba8602d7e9a61d68f5eb56a9e35f23126b7a8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 5 12:12:32 2018 -0800

    Fix upload path issue (#83)

 .../pulsar/functions/runtime/worker/rest/api/v1/ApiV1Resource.java  | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 2fc20b51f4631f745503e143e6050aa5eaf6696d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 5 11:29:05 2018 -0800

     Upgrade testng and downgrade log4j2 and remove junit (#80)

 pom.xml                                            |   2 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  92 +++++++++++------
 .../functions/annotation/AnnotationsTest.java      |   2 +-
 .../pulsar/functions/fs/FunctionConfigTest.java    |  19 ++--
 .../pulsar/functions/runtime/FunctionIDTest.java   |   2 +-
 .../pulsar/functions/runtime/InstanceIDTest.java   |   2 +-
 .../container/ThreadFunctionContainerTest.java     |  17 ++--
 .../functioncache/FunctionCacheEntryTest.java      |   4 +-
 .../FunctionCacheManagerImplTest.java              |  26 ++---
 .../functioncache/FunctionClassLoadersTest.java    |   4 +-
 .../functions/runtime/serde/JavaSerDeTest.java     |   2 +-
 .../runtime/serde/Utf8StringSerDeTest.java         |   2 +-
 .../worker/FunctionMetaDataManagerTest.java        |   8 +-
 .../worker/FunctionMetaDataTopicTailerTest.java    |  13 +--
 .../functions/runtime/worker/WorkerConfigTest.java |  15 ++-
 .../functions/runtime/worker/WorkerTest.java       |   2 +-
 .../runtime/worker/dlog/DLInputStreamTest.java     |   6 +-
 .../runtime/worker/dlog/DLOutputStreamTest.java    |   2 +-
 .../worker/request/ServiceRequestManagerTest.java  |   6 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 113 +++++++++++----------
 .../pulsar/functions/utils/ExceptionsTest.java     |   2 +-
 .../runtime/src/test/resources/log4j2.yml          |   9 +-
 22 files changed, 188 insertions(+), 162 deletions(-)

commit 8002e3b1bd410ca84b41a07bd996a2c4e8a4d75e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Jan 5 09:39:27 2018 -0800

    Use Reader API instead of Consumer API (#81)

 .../functions/runtime/worker/FunctionActioner.java   |  4 ++--
 .../runtime/worker/FunctionMetaDataTopicTailer.java  | 16 +++++++---------
 .../pulsar/functions/runtime/worker/Worker.java      | 18 ++++++++++--------
 ...est.java => FunctionMetaDataTopicTailerTest.java} | 20 +++++++++-----------
 4 files changed, 28 insertions(+), 30 deletions(-)

commit 6a4592a1a5426f643411e5aaf59c8df6f11385d7
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 4 17:10:04 2018 -0800

    fixing bugs and adding assignments datastructure (#79)
    
    * fixing bugs and adding assignments datastructure
    
    * using fully qualified name

 .../functions/runtime/worker/FunctionActioner.java | 28 ++++++++++++++++++----
 .../functions/runtime/worker/FunctionMetaData.java |  1 -
 .../runtime/worker/FunctionMetaDataManager.java    |  8 ++++++-
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  |  2 +-
 4 files changed, 31 insertions(+), 8 deletions(-)

commit 638e3c7df994fe8e08857ff498768ba71ebea27b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 4 16:56:12 2018 -0800

    Fix spelling (#78)

 .../src/main/java/org/apache/pulsar/functions/fs/FunctionConfig.java    | 2 +-
 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java     | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 46d8874c013c61d7f68a64294ad7c54a18ab521c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 4 16:27:58 2018 -0800

     Revert dlog version to stable 0.5.0 (#77)

 pulsar-functions/runtime/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 992e9476042c29934074777d747a562b63100f19
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 4 16:12:56 2018 -0800

    Name our threads (#76)
    
    * Name our threads
    
    * We already set the name of runner thread

 .../org/apache/pulsar/functions/runtime/worker/FunctionActioner.java     | 1 +
 1 file changed, 1 insertion(+)

commit b662fe6f894e07136b7fda83c7e8689ebc2db1df
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 4 16:01:27 2018 -0800

    Function Logging (#74)
    
    * Function Logging
    
    - use log4j2 to route function related logging
    
    * Add logging function and include tenant/namespace in logging file path
    
    * Add missing files

 pom.xml                                            |  1 +
 .../api/examples/ExclamationFunction.java          |  1 +
 .../functions/api/examples/LoggingFunction.java    | 45 +++++++++++
 pulsar-functions/bin/pulsar                        |  8 +-
 pulsar-functions/bin/pulsar-functions              |  8 +-
 pulsar-functions/conf/log4j2.yml                   | 91 ++++++++++++++++++++++
 pulsar-functions/run-logging-examples.sh           | 27 +++++++
 pulsar-functions/runtime/pom.xml                   | 15 ++++
 .../apache/pulsar/functions/fs/FunctionConfig.java |  4 +
 .../runtime/container/ThreadFunctionContainer.java |  4 +
 .../functions/runtime/instance/JavaInstance.java   |  7 +-
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 87 +++++++++++----------
 .../src/test/resources/log4j2.yml}                 | 27 +++----
 13 files changed, 255 insertions(+), 70 deletions(-)

commit 2dc4a5b7c5e7d33d3ca3097521a55b025c76de43
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 4 15:43:04 2018 -0800

    Bug fix and add log messages (#75)
    
    * adding some log messages
    
    * fixing

 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java   | 3 +++
 .../java/org/apache/pulsar/functions/runtime/spawner/Spawner.java     | 4 ++++
 .../org/apache/pulsar/functions/runtime/worker/FunctionActioner.java  | 4 ++++
 .../main/java/org/apache/pulsar/functions/runtime/worker/Utils.java   | 1 +
 4 files changed, 12 insertions(+)

commit f1081f84a3bb9459848f04a12d06ce30827c62cf
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Thu Jan 4 14:53:26 2018 -0800

    add client side class validation (#70)
    
    * add client side class validation
    
    * adding and fixing
    
    * cleaning up

 pulsar-functions/run-examples.sh                   |  2 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 56 ++++++++++++++-
 .../pulsar/functions/runtime/worker/Utils.java     |  8 ++-
 .../apache/pulsar/functions/utils/Reflections.java | 83 ++++++++++++++++++++++
 .../pulsar/functions/utils/ReflectionsTest.java    | 11 +++
 5 files changed, 156 insertions(+), 4 deletions(-)

commit 7e14c8f0cd5b5f917ebaa66d60a2bc0068396c3d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 4 14:27:47 2018 -0800

    More graceful warning when args are missing (#72)
    
    * More graceful warning when args are missing
    
    * Make use of Annotations
    
    * Tests work

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 22 +++++++++++++++++++---
 .../pulsar/functions/annotation/Annotations.java   |  2 ++
 .../apache/pulsar/functions/fs/FunctionConfig.java |  2 ++
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  8 +++++++-
 4 files changed, 30 insertions(+), 4 deletions(-)

commit 4e6adcaa48b4255130cc60e8952684f2f36caaff
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 4 14:10:17 2018 -0800

    Add `@RequiredField` annotation to enforce verification on whether a field is set or not. (#73)

 .../pulsar/functions/annotation/Annotations.java   | 56 ++++++++++++++++++
 .../pulsar/functions/annotation/RequiredField.java | 27 +++++++++
 .../apache/pulsar/functions/fs/FunctionConfig.java |  7 +++
 .../functions/annotation/AnnotationsTest.java      | 67 ++++++++++++++++++++++
 4 files changed, 157 insertions(+)

commit 8a0cd541d09df72f72b4db752b04fb28adf1d09b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Jan 4 10:48:31 2018 -0800

    Added more logging. Also changed getFunctions to return 404 when not found (#71)
    
    * Added more logging. Also changed getFunctions to return 404 when not found
    
    * Fixed logging

 .../runtime/worker/rest/api/v1/ApiV1Resource.java      | 18 +++++++++++++++++-
 .../runtime/worker/rest/api/v1/ApiV1ResourceTest.java  |  2 +-
 2 files changed, 18 insertions(+), 2 deletions(-)

commit 5fe559d9f7f2d5b0bc614fef6863e0e68f5c8489
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Jan 4 10:24:12 2018 -0800

    Add the missing script for running pulsar worker (#69)

 pulsar-functions/bin/pulsar | 152 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 152 insertions(+)

commit 61650f3158fb5f0eebf0b4397d33cd9c743014b1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jan 3 22:54:33 2018 -0800

     Add unit tests for dlog classes and rest api (#67)

 .../apache/pulsar/functions/fs/FunctionConfig.java |   2 +
 .../functions/runtime/spawner/LimitsConfig.java    |   3 +
 .../functions/runtime/worker/FunctionMetaData.java |   2 +
 .../runtime/worker/PackageLocationMetaData.java    |   2 +
 .../functions/runtime/worker/WorkerConfig.java     |   2 +
 .../runtime/worker/request/RequestResult.java      |  18 +-
 .../functions/runtime/worker/rest/RestUtils.java   |  39 +-
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 105 +--
 .../runtime/worker/dlog/DLInputStreamTest.java     | 105 +++
 .../runtime/worker/dlog/DLOutputStreamTest.java    |  77 ++
 .../worker/rest/api/v1/ApiV1ResourceTest.java      | 928 +++++++++++++++++++++
 11 files changed, 1171 insertions(+), 112 deletions(-)

commit d14c23adecab383c87c14a22aab90dc021ffac7b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 3 22:38:31 2018 -0800

    Added FunctionActioner to start/stop functions in seperate thread (#68)
    
    * Added FunctionActioner to start/stop functions in seperate thread
    
    * Fixed a bug

 .../functions/runtime/worker/FunctionAction.java   |  37 ++++++
 .../functions/runtime/worker/FunctionActioner.java | 133 +++++++++++++++++++++
 .../runtime/worker/FunctionMetaDataManager.java    |  87 ++++----------
 .../pulsar/functions/runtime/worker/Worker.java    |  16 ++-
 .../worker/FunctionMetaDataManagerTest.java        |   7 +-
 5 files changed, 212 insertions(+), 68 deletions(-)

commit c74e545cf6a23e66b0c195e7124f1b445d4929e1
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 3 15:31:02 2018 -0800

    Removing ServiceRequest from requestResult (#66)

 .../functions/runtime/worker/FunctionMetaDataManager.java      |  1 -
 .../pulsar/functions/runtime/worker/request/RequestResult.java | 10 ----------
 2 files changed, 11 deletions(-)

commit ef7657c3953ba8d105f60a9cce107d47c1491eb5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jan 3 15:24:34 2018 -0800

     Organize function packages in hierarchy (#65)
    
    * Add worker main
    
    * Organize function packages in hierarchy
    
    - functions are stored under distributedlog://<zkservers>/pulsar/functions/<tenant>/<namespace>/<function>/<package_name>
    - initialize dlog namespace at the startup of worker
    - use zookeeperServers in worker config instead of dlogUri to hide dlog from pulsar configuration. make it consistent with broker configuration.
    
    * Addressed comments

 pulsar-functions/conf/client.conf                  |   2 +-
 pulsar-functions/conf/example.yml                  |   4 +
 pulsar-functions/conf/function_worker.yml          |  31 +++++
 pulsar-functions/conf/limits.yml                   |  23 ++++
 pulsar-functions/runtime/pom.xml                   |   2 +-
 .../functions/runtime/FunctionWorkerStarter.java   |   9 +-
 .../runtime/worker/FunctionMetaDataManager.java    |  49 +++++---
 .../runtime/worker/PackageLocationMetaData.java    |  46 ++++---
 .../pulsar/functions/runtime/worker/Utils.java     | 136 +++++++++------------
 .../pulsar/functions/runtime/worker/Worker.java    |  44 ++++++-
 .../functions/runtime/worker/WorkerConfig.java     |   4 +-
 .../runtime/worker/rest/BaseApiResource.java       |  15 +--
 .../runtime/worker/rest/WorkerServer.java          |  27 ++--
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  |  44 ++++---
 .../worker/FunctionMetaDataManagerTest.java        |   5 +-
 .../functions/runtime/worker/WorkerConfigTest.java |   6 +-
 .../functions/runtime/worker/WorkerTest.java       |   2 +-
 .../src/test/resources/test_worker_config.yml      |   2 +-
 18 files changed, 277 insertions(+), 174 deletions(-)

commit 9902a32b6965ec03636fa855e0e380537e699eed
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 3 14:20:16 2018 -0800

    Moved FunctionStats to fs since it does not belong to api (#64)

 .../src/main/java/org/apache/pulsar/functions/fs}/FunctionStats.java    | 2 +-
 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java     | 1 -
 .../main/java/org/apache/pulsar/functions/stats/FunctionStatsImpl.java  | 2 +-
 3 files changed, 2 insertions(+), 3 deletions(-)

commit 43a09e6067cfaee2bc5f977a35af4e4259e1d4f2
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Wed Jan 3 12:34:18 2018 -0800

    add/fixes the following: (#62)
    
    1. upload packages to bookkeeper will include a UUID
    2. incorrect setName - > setNamespace

 .../functions/runtime/worker/FunctionMetaData.java |  3 +-
 .../runtime/worker/FunctionMetaDataManager.java    |  8 ++--
 .../runtime/worker/PackageLocationMetaData.java    | 35 +++++++++++++++++
 .../pulsar/functions/runtime/worker/Utils.java     | 30 +++++++--------
 .../pulsar/functions/runtime/worker/Worker.java    |  2 +
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 44 ++++++++++------------
 .../functions/runtime/worker/WorkerTest.java       |  1 +
 7 files changed, 78 insertions(+), 45 deletions(-)

commit 38a5987393d6a03f77fc7716f1d40027731099ed
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 3 12:28:01 2018 -0800

    Make sure it works if the function does not have a sink topic (#61)

 .../runtime/container/ThreadFunctionContainer.java | 70 ++++++++++++----------
 1 file changed, 38 insertions(+), 32 deletions(-)

commit 4c973c8c562a73d4b2e079a47c4f5a16b1f3f81f
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Jan 3 12:00:00 2018 -0800

    Added atmost once and atleast once semantics (#60)
    
    * Added atmost once and atleast once semantics
    
    * Added ability to specify processing guarantees in command line

 .../org/apache/pulsar/admin/cli/CmdFunctions.java    |  6 ++++++
 .../apache/pulsar/functions/fs/FunctionConfig.java   |  6 ++++++
 .../runtime/container/ThreadFunctionContainer.java   | 20 ++++++++++++++------
 3 files changed, 26 insertions(+), 6 deletions(-)

commit 4f107d372838c5aa62cdef08938c21143a543c1d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jan 3 11:15:53 2018 -0800

    Use LinkedBlockingQueue#put and ack before processing for at-most-once processing (#59)
    
    * Use LinkedBlockingQueue#put to enqueue items
    
    * Revert it back to at-most-once processing
    
    * remove ack for void functions

 .../runtime/container/ThreadFunctionContainer.java        | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

commit 507b9385b7f3f48db44c6c28334f42a6b11a497e
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Jan 2 18:57:15 2018 -0800

    fixing log functions (#58)

 .../runtime/worker/FunctionMetaDataManager.java         | 17 ++++++++---------
 .../apache/pulsar/functions/runtime/worker/Utils.java   | 10 ++++------
 .../runtime/worker/rest/api/v1/ApiV1Resource.java       | 12 +++++-------
 3 files changed, 17 insertions(+), 22 deletions(-)

commit 58a539225727f1604d9a85ec917e054274098ce1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 2 17:32:46 2018 -0800

    Removed ExecutionResult since its not longer needed (#57)

 .../runtime/container/ExecutionResult.java         | 56 ----------------------
 .../runtime/container/ThreadFunctionContainer.java | 33 ++++++++-----
 2 files changed, 20 insertions(+), 69 deletions(-)

commit eefe67e0730eee69056e3831c0891113c93ba812
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 2 17:04:24 2018 -0800

    Invoke spawner upon start/stop of worker (#56)

 .../functions/runtime/FunctionWorkerStarter.java   |  15 ++-
 .../container/ThreadFunctionContainerFactory.java  |   2 +-
 .../functions/runtime/spawner/LimitsConfig.java    |  11 ++
 .../functions/runtime/worker/FunctionMetaData.java |   2 +
 .../runtime/worker/FunctionMetaDataManager.java    |  73 +++++++++--
 .../pulsar/functions/runtime/worker/Utils.java     | 139 ++++++++++++++++++++-
 .../pulsar/functions/runtime/worker/Worker.java    |  22 ++--
 .../functions/runtime/worker/WorkerConfig.java     |   1 +
 .../{rest/api/v1 => }/dlog/DLInputStream.java      |   2 +-
 .../{rest/api/v1 => }/dlog/DLOutputStream.java     |   2 +-
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  |  29 +++--
 .../runtime/worker/rest/api/v1/Utils.java          | 133 --------------------
 .../worker/FunctionMetaDataManagerTest.java        |  19 ++-
 .../functions/runtime/worker/WorkerTest.java       |   3 +-
 14 files changed, 272 insertions(+), 181 deletions(-)

commit 7c10a31aa1dc74166dd46ecd400be801ecb38725
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 2 15:49:54 2018 -0800

    Cleanup Cli commands (#55)

 pulsar-functions/conf/client.conf                  |   2 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 115 ++++++++++------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 145 +++++++++++++++++++--
 3 files changed, 212 insertions(+), 50 deletions(-)

commit d0c231ebf866ee25e08c43743b254035b4e18c80
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 2 14:31:05 2018 -0800

    Refactor to support at-least-once processing (#54)
    
    * Refactor to support at-least-once processing
    
    This change is refactoring the relationship between Spawner, FunctionContainer and JavaInstance to better support various processing semantics.
    
    - ThreadFunctionContainerFactory is a "singleton" across multiple functions.
    - Spawner, FunctionContainer and JavaInstance are per function. Spawner is manging the lifecycle of function container, in the function container
      it will folks a thread for running java instance, because it has to load classpathes correctly.
    - Remove subscribermanager and move consumer and producer logic into container. that means in future if we are supporting process based and docker
      based container, we can just take the thread container and run it directly as a separate process or a separate docker process. There is no
      extra communication between spawner and containers.
    
    * Create pulsar client in thread container factory

 .../ThreadFunctionContainerBenchmark.java          | 118 -------------
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  30 +++-
 .../pulsar/client/admin/PulsarFunctionsAdmin.java  |   7 +-
 .../runtime/container/FunctionContainer.java       |   2 -
 .../runtime/container/ThreadFunctionContainer.java | 193 +++++++++++++++------
 .../container/ThreadFunctionContainerFactory.java  |  34 +++-
 .../pulsar/functions/runtime/spawner/Spawner.java  |  47 ++---
 .../runtime/subscribermanager/ProducerManager.java |  61 -------
 .../subscribermanager/ResultsProcessor.java        |  65 -------
 .../subscribermanager/SubscriberManager.java       |  63 -------
 .../subscribermanager/TopicSubscription.java       | 139 ---------------
 .../container/ThreadFunctionContainerTest.java     |  50 ++----
 12 files changed, 236 insertions(+), 573 deletions(-)

commit 793b1cf7809d1e97fa3ab1e8a9ade7b23a6744a9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 2 12:14:41 2018 -0800

    Renamed FunctionState stuff to something that reflects their functionality (#53)
    
    * Renamed FunctionState stuff to something that reflects their functionality
    
    * More removal of state

 ...teManager.java => FunctionMetaDataManager.java} | 68 +++++++++++-----------
 ...sumer.java => FunctionMetaDataTopicTailer.java} | 14 ++---
 .../pulsar/functions/runtime/worker/Worker.java    | 22 +++----
 .../runtime/worker/rest/BaseApiResource.java       | 12 ++--
 .../runtime/worker/rest/WorkerServer.java          | 11 ++--
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 30 +++++-----
 .../worker/FunctionMetaDataConsumerTest.java       | 10 ++--
 .../worker/FunctionMetaDataManagerTest.java        |  2 +-
 8 files changed, 84 insertions(+), 85 deletions(-)

commit 59ec63019259835f0c4576bd0ce0b49548b95eac
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Jan 2 11:48:33 2018 -0800

    Rename functionstate (#52)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Adhere to rest semantics
    
    * Renamed FunctionState to FunctionMetaData

 .../{FunctionState.java => FunctionMetaData.java}  |  4 +-
 .../runtime/worker/FunctionStateManager.java       | 56 +++++++++++-----------
 .../runtime/worker/request/DeregisterRequest.java  | 10 ++--
 .../runtime/worker/request/ServiceRequest.java     | 20 ++++----
 .../runtime/worker/request/UpdateRequest.java      | 10 ++--
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 44 ++++++++---------
 ...Test.java => FunctionMetaDataConsumerTest.java} |  6 +--
 ...rTest.java => FunctionMetaDataManagerTest.java} |  2 +-
 8 files changed, 76 insertions(+), 76 deletions(-)

commit 0c113d76423b34e542cd1002fc7df396c2b92171
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 2 10:44:48 2018 -0800

    Rewrite FunctionStateListener to use receiveAsyc (#51)

 .../functions/runtime/FunctionWorkerStarter.java   |   2 +-
 .../runtime/worker/FunctionStateConsumer.java      | 103 +++++++++++++++++++++
 .../runtime/worker/FunctionStateManager.java       |  15 +--
 .../pulsar/functions/runtime/worker/Worker.java    |  86 ++++++++++++-----
 .../worker/request/ServiceRequestManager.java      |  46 ++++-----
 .../runtime/worker/rest/FunctionStateListener.java |  92 ------------------
 .../runtime/worker/FunctionStateConsumerTest.java  |  90 ++++++++++++++++++
 .../runtime/worker/FunctionStateManagerTest.java   |  17 ++++
 .../functions/runtime/worker/WorkerTest.java       |   3 +-
 .../worker/request/ServiceRequestManagerTest.java  |  69 ++++++++++++++
 10 files changed, 374 insertions(+), 149 deletions(-)

commit 84a804076f8bb8960fabf7f5c42b9ebdf0474335
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Jan 2 09:42:35 2018 -0800

    Load function worker configuration from yaml file (#50)

 .../functions/runtime/FunctionWorkerStarter.java   | 74 ++++++++++++++++++++++
 .../pulsar/functions/runtime/worker/Worker.java    |  5 +-
 .../functions/runtime/worker/WorkerConfig.java     | 74 +++++++---------------
 .../worker/request/ServiceRequestManager.java      |  2 +-
 .../runtime/worker/rest/FunctionStateListener.java |  2 +-
 .../runtime/worker/rest/api/v1/Utils.java          | 13 ++--
 .../functions/runtime/worker/WorkerConfigTest.java | 67 ++++++++++++++++++++
 .../functions/runtime/worker/WorkerTest.java       |  8 +--
 .../src/test/resources/test_worker_config.yml      | 26 ++++++++
 9 files changed, 203 insertions(+), 68 deletions(-)

commit 8824efbd5e1b5147467b99376fbdf681c246a44e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Dec 28 02:40:22 2017 -0800

    Compose `FunctionState` with FunctionConfig and LimitsConfig (#49)

 .../ThreadFunctionContainerBenchmark.java          |   1 -
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   1 +
 .../apache/pulsar/functions/fs/FunctionConfig.java |   8 +-
 .../functions/runtime/spawner/LimitsConfig.java    |   7 +-
 .../functions/runtime/worker/FunctionState.java    | 185 +++------------------
 .../runtime/worker/FunctionStateManager.java       |  67 +++++---
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  |  75 ++++++---
 7 files changed, 126 insertions(+), 218 deletions(-)

commit 103d20d1e4aacbb4a751138ae0190736f0ed4dbb
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 26 19:13:25 2017 -0800

    Fix license header (#48)

 .../runtime/worker/FunctionStateManagerTest.java       | 18 ++++++++++++++++++
 .../pulsar/functions/runtime/worker/WorkerTest.java    | 18 ++++++++++++++++++
 2 files changed, 36 insertions(+)

commit 570d59cc5c6faad193f20d76aa07417f7d645b0b
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Tue Dec 26 17:32:52 2017 -0800

    Initial implementation of Pulsar Function Worker (#47)

 pulsar-functions/bin/pulsar-functions              |   2 +-
 pulsar-functions/conf/client.conf                  |   2 +-
 pulsar-functions/conf/example.yml                  |   2 +-
 pulsar-functions/conf/log4j.shell.properties       |   2 +-
 pulsar-functions/pom.xml                           |   2 +-
 .../ThreadFunctionContainerBenchmark.java          |   2 +-
 pulsar-functions/runtime/pom.xml                   |  75 +++-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   6 +-
 .../client/admin/internal/FunctionsImpl.java       |  13 +-
 .../apache/pulsar/functions/fs/FunctionConfig.java |   2 +-
 .../functions/runtime/spawner/LimitsConfig.java    |   4 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  |   4 +-
 .../functions/runtime/worker/FunctionState.java    | 210 +++++++++++
 .../runtime/worker/FunctionStateManager.java       | 278 ++++++++++++++
 .../pulsar/functions/runtime/worker/Utils.java     |  70 ++++
 .../pulsar/functions/runtime/worker/Worker.java    |  60 +++
 .../functions/runtime/worker/WorkerConfig.java     |  86 +++++
 .../runtime/worker/request/DeregisterRequest.java  |  42 +++
 .../runtime/worker/request/RequestResult.java      |  56 +++
 .../runtime/worker/request/ServiceRequest.java     | 104 ++++++
 .../worker/request/ServiceRequestManager.java      |  68 ++++
 .../runtime/worker/request/UpdateRequest.java      |  39 ++
 .../runtime/worker/rest/BaseApiResource.java       |  61 +++
 .../runtime/worker/rest/ConfigurationResource.java |  48 +++
 .../runtime/worker/rest/FunctionStateListener.java |  92 +++++
 .../functions/runtime/worker/rest/Resources.java   |  45 +++
 .../functions/runtime/worker/rest/RestUtils.java   |  70 ++++
 .../runtime/worker/rest/WorkerServer.java          |  94 +++++
 .../runtime/worker/rest/api/v1/ApiV1Resource.java  | 415 +++++++++++++++++++++
 .../runtime/worker/rest/api/v1/Utils.java          | 134 +++++++
 .../worker/rest/api/v1/dlog/DLInputStream.java     | 145 +++++++
 .../worker/rest/api/v1/dlog/DLOutputStream.java    |  73 ++++
 .../runtime/worker/FunctionStateManagerTest.java   |   4 +
 .../functions/runtime/worker/WorkerTest.java       |  61 +++
 34 files changed, 2345 insertions(+), 26 deletions(-)

commit 5c4b28628fb64ecf6f9facc9e095579a882fb923
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Dec 22 15:39:55 2017 -0800

    Print (#46)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Adhere to rest semantics
    
    * Print the return values for get/list functions. Also print some statements on success

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 5ea8065882a7061744e9b8729ac1dd1fe484a667
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Dec 22 14:48:14 2017 -0800

    Fileinterface (#45)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Adhere to rest semantics
    
    * Convert create function to a post request

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java |  7 ++-----
 .../main/java/org/apache/pulsar/client/admin/Functions.java |  4 ++--
 .../apache/pulsar/client/admin/internal/FunctionsImpl.java  | 13 +++++++------
 3 files changed, 11 insertions(+), 13 deletions(-)

commit 0444ac434b8a8e809f00874769e18e5f69e25d47
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Dec 22 11:36:23 2017 -0800

    Introduce FunctionStats to collection function related stats (#44)
    
    * Introduce FunctionStats to collection function related stats
    
    * Format license headers

 .../apache/pulsar/functions/api/FunctionStats.java |  49 ++++++
 .../runtime/container/ThreadFunctionContainer.java |  10 +-
 .../subscribermanager/ResultsProcessor.java        |  10 +-
 .../subscribermanager/TopicSubscription.java       |  91 ++++++----
 .../pulsar/functions/stats/FunctionStatsImpl.java  | 191 +++++++++++++++++++++
 .../pulsar/functions/stats/package-info.java       |  22 +++
 6 files changed, 332 insertions(+), 41 deletions(-)

commit 5077d715708cf6d937aa6f74f3dc416aa66658d5
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 19:12:48 2017 -0800

    Completecli (#43)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Adhere to rest semantics
    
    * Complete the list of functions supported by cli

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 84 +++++++++++++++++++---
 1 file changed, 76 insertions(+), 8 deletions(-)

commit 27f4c0b4f236edf1cdc8a55e66c32f144c3f8b36
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Dec 21 18:37:06 2017 -0800

    Enable batching on producer (#42)

 .../functions/runtime/subscribermanager/ProducerManager.java      | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit a1b1ea5b6399f3740d64d0ae7d68396f09977fbf
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 17:11:07 2017 -0800

    Made Update a put request (#41)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Adhere to rest semantics

 .../java/org/apache/pulsar/client/admin/internal/FunctionsImpl.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4b4bea7e293706d019abd0fc4293322369a1e591
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 16:58:31 2017 -0800

    Reconcile (#40)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Reconciled the interface between worker and client with Jerry
    
    * Fixed the update method

 pulsar-functions/run-examples.sh                   |  3 +-
 .../org/apache/pulsar/client/admin/Functions.java  |  2 +-
 .../client/admin/internal/FunctionsImpl.java       | 45 ++++++++++++++++------
 3 files changed, 37 insertions(+), 13 deletions(-)

commit 5c1e369f1da6e24cb4874c9326fa2ba8cdc29a25
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Dec 21 16:58:01 2017 -0800

    Provide a jmh benchmark to benchmark thread container (#39)
    
    * Provide a jmh benchmark to benchmark thread container
    
    * Rebased to latest master
    
    * revert the scripts

 pulsar-functions/pom.xml                           |   1 +
 pulsar-functions/run-benchmark.sh                  |  20 ++++
 pulsar-functions/runtime-benchmark/pom.xml         | 112 +++++++++++++++++++
 .../ThreadFunctionContainerBenchmark.java          | 119 +++++++++++++++++++++
 .../runtime/container/ThreadFunctionContainer.java |   6 +-
 .../functions/runtime/instance/JavaInstance.java   |   9 +-
 6 files changed, 265 insertions(+), 2 deletions(-)

commit e90b30882df4f7046b481bf1a281bc0574271ec9
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 15:44:40 2017 -0800

    Nonthreadpool (#38)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * In case of Kstream style running, we dont need to spawn a executor service to run the message
    
    * Update comment

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  2 +-
 .../functions/runtime/instance/JavaInstance.java   | 49 +++++++++++++---------
 2 files changed, 31 insertions(+), 20 deletions(-)

commit 7fbe342f58f81cdace22c60ca9b8fc2ad2880b0d
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 15:13:49 2017 -0800

    Asyncack (#37)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Made ack async

 .../pulsar/functions/runtime/subscribermanager/TopicSubscription.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 3f7d304aeef8c2562d4d830f9e883c4496edc160
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 14:23:41 2017 -0800

    Make producer and consumer async

 .../runtime/subscribermanager/ProducerManager.java |  2 +-
 .../subscribermanager/TopicSubscription.java       | 37 +++++++++++-----------
 2 files changed, 20 insertions(+), 19 deletions(-)

commit da66b2d40f21762648003fcaa081fed773d5822a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Thu Dec 21 00:04:25 2017 -0800

    Fix compilation (#35)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Fix compilation issue

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java |  2 +-
 .../runtime/container/FunctionContainerFactory.java         |  2 +-
 .../runtime/container/ThreadFunctionContainer.java          |  6 ++++--
 .../runtime/container/ThreadFunctionContainerFactory.java   |  5 +++--
 .../apache/pulsar/functions/runtime/spawner/Spawner.java    | 13 +++++++++----
 .../runtime/container/ThreadFunctionContainerTest.java      |  2 +-
 6 files changed, 19 insertions(+), 11 deletions(-)

commit 32270655839ce18f39d6c9c4db4371a3745ebe6c
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 20 23:13:05 2017 -0800

    Cleanup (#34)

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java  | 8 ++++----
 .../main/java/org/apache/pulsar/functions/fs/FunctionConfig.java | 9 ---------
 .../functions/runtime/container/ThreadFunctionContainerTest.java | 1 -
 3 files changed, 4 insertions(+), 14 deletions(-)

commit 48d4aa4d26cd1763301e0ad443cd932099da4b23
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 20 18:24:26 2017 -0800

    Added Submit Function capability to the pulsar-functions cli (#33)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added the first cut of the pulsar submit
    
    * Working

 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   1 +
 pulsar-functions/conf/example.yml                  |   2 +-
 pulsar-functions/run-examples.sh                   |   2 +-
 pulsar-functions/runtime/pom.xml                   |  16 +++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  30 +++--
 .../org/apache/pulsar/admin/cli/FunctionsTool.java |  12 +-
 .../org/apache/pulsar/client/admin/Functions.java  | 135 +++++++++++++++++++++
 .../pulsar/client/admin/PulsarFunctionsAdmin.java  |  60 +++++++++
 .../client/admin/internal/FunctionsImpl.java       | 105 ++++++++++++++++
 .../apache/pulsar/functions/fs/FunctionConfig.java |   9 +-
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |  10 +-
 11 files changed, 364 insertions(+), 18 deletions(-)

commit 4dd40890fdc47326dfbc21f8923529782c3ad962
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 20 12:30:47 2017 -0800

    Nomenclature (#32)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Made our function hierarchy match pulsar's
    
    * Replace cluster with tenant

 .../main/java/org/apache/pulsar/admin/cli/CmdFunctions.java    | 10 +++-------
 .../java/org/apache/pulsar/functions/fs/FunctionConfig.java    | 10 ++++++----
 .../functions/runtime/container/ThreadFunctionContainer.java   |  3 ++-
 .../runtime/container/ThreadFunctionContainerTest.java         |  6 +++---
 4 files changed, 14 insertions(+), 15 deletions(-)

commit a548bc2e04890b3d478f4e25f0d1896ff5439ac3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 19 18:38:23 2017 -0800

    Input and Output Serdes (#31)
    
    ### Motivation
    
    input type can be different output type. so we need two serdes for each function.
    
    ### Modifications
    
    - add inputSerde and outputSerde
    - verify both input and output serde to make sure their types are consistent with function types
    
    ### Result
    
    user run functions with input/output serdes.

 pulsar-functions/run-examples.sh                   |  8 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 14 +++-
 .../apache/pulsar/functions/fs/FunctionConfig.java |  6 +-
 .../runtime/container/ThreadFunctionContainer.java |  2 +-
 .../functions/runtime/instance/JavaInstance.java   | 87 ++++++++++++++--------
 .../runtime/instance/JavaInstanceTest.java         | 31 ++++++--
 6 files changed, 103 insertions(+), 45 deletions(-)

commit 275daf0ce05ffc3940b06edfb8be0570da6750cd
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 19 17:44:41 2017 -0800

    Make SerDe interface a generic interface and load the serde class in JavaInstance (#30)
    
    ### Motivation
    
    SerDe is user defined class which used for serializing and deserializing objects for functions. So the initialization of a SerDe class should happen along with Function class and done by the context class loader.
    
    Also SerDe should be a generic-typed interface and the type should be consistent with function type.
    
    ### Modifications
    
    - make SerDe a generic-typed interface
    - move SerDe initialization to JavaInstance and use the thread context class loader
    - verify SerDe type
    - move reflection related code to a util class `Reflections`
    
    ### Result
    
    - SerDe is a generic-typed interface
    - JavaInstance initializes both function and serdes and verifies the types.

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  20 +--
 .../apache/pulsar/functions/fs/FunctionConfig.java |   2 +
 .../runtime/container/ThreadFunctionContainer.java |   2 +-
 .../functions/runtime/instance/JavaInstance.java   |  60 ++++----
 .../runtime/instance/JavaInstanceConfig.java       |   2 -
 .../pulsar/functions/runtime/serde/JavaSerDe.java  |   2 +-
 .../pulsar/functions/runtime/serde/SerDe.java      |   6 +-
 .../functions/runtime/serde/Utf8StringSerDe.java   |   7 +-
 .../functions/runtime/spawner/AssignmentInfo.java  |   9 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  |   6 +-
 .../apache/pulsar/functions/utils/Reflections.java | 115 +++++++++++++++
 .../runtime/instance/JavaInstanceTest.java         | 116 +++++++--------
 .../pulsar/functions/utils/ReflectionsTest.java    | 156 +++++++++++++++++++++
 13 files changed, 384 insertions(+), 119 deletions(-)

commit 316f8346664c3d5014b87f3770a02dec3e284994
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 19 16:04:06 2017 -0800

    relocate SerDe classes to `serde` package and add tests (#29)

 pulsar-functions/run-examples.sh                   |  2 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  2 +-
 .../runtime/container/ExecutionResult.java         |  1 +
 .../functions/runtime/instance/JavaInstance.java   |  2 +-
 .../runtime/instance/JavaInstanceConfig.java       |  2 +-
 .../runtime/{container => serde}/JavaSerDe.java    | 21 +++++---
 .../runtime/{container => serde}/SerDe.java        |  2 +-
 .../Utf8StringSerDe.java}                          | 20 ++++----
 .../functions/runtime/serde/package-info.java      | 22 +++++++++
 .../functions/runtime/spawner/AssignmentInfo.java  |  2 +-
 .../pulsar/functions/runtime/spawner/Spawner.java  |  2 +-
 .../runtime/instance/JavaInstanceTest.java         |  2 +-
 .../functions/runtime/serde/JavaSerDeTest.java     | 56 ++++++++++++++++++++++
 .../runtime/serde/Utf8StringSerDeTest.java         | 40 ++++++++++++++++
 14 files changed, 151 insertions(+), 25 deletions(-)

commit 13bbbf7294835955e8f08dde7f2233e58f55e074
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 19 15:48:35 2017 -0800

    Use the thread context classloader for loading functions (#28)

 pulsar-functions/run-examples.sh                                     | 2 +-
 .../org/apache/pulsar/functions/runtime/instance/JavaInstance.java   | 5 ++++-
 2 files changed, 5 insertions(+), 2 deletions(-)

commit f026ef81b25a852250083982b4f4a7b66f617a95
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 19 15:03:34 2017 -0800

    Refactor cli (#27)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Refactor cli to establish a base FunctionCommand interface that all subcommands can piggyback

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 58 ++++++++++++----------
 1 file changed, 33 insertions(+), 25 deletions(-)

commit 117f816cff95f0f40e088f325487a90b8472f31b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 19 14:26:13 2017 -0800

    System exception (#26)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Introduced the concept of systemException to differentiate from userException

 .../functions/runtime/container/ExecutionResult.java     | 16 ++++++++--------
 .../runtime/container/ThreadFunctionContainer.java       | 13 ++++++++++---
 .../functions/runtime/instance/JavaExecutionResult.java  |  2 ++
 .../pulsar/functions/runtime/instance/JavaInstance.java  |  4 ++--
 .../runtime/subscribermanager/ResultsProcessor.java      |  4 +++-
 .../org/apache/pulsar/functions/utils/Exceptions.java    |  9 +++++++++
 6 files changed, 34 insertions(+), 14 deletions(-)

commit 5adc0668260d57079a53d66e41034ff855069561
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 19 11:18:33 2017 -0800

    Relocate packages (#21)
    
    
    * Relocate instance and spawner to be under `runtime` package
    * fix the pom files and travis build

 .travis.yml                                        |  2 +-
 pulsar-functions/api-examples/pom.xml              |  2 +-
 pulsar-functions/api/pom.xml                       |  2 +-
 pulsar-functions/runtime/pom.xml                   |  2 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  8 ++------
 .../runtime/container/ExecutionResult.java         |  2 +-
 .../container/FunctionContainerFactory.java        |  2 +-
 .../runtime/container/ThreadFunctionContainer.java |  6 +++---
 .../container/ThreadFunctionContainerFactory.java  |  2 +-
 .../{ => runtime}/instance/ContextImpl.java        |  2 +-
 .../instance/JavaExecutionResult.java              |  2 +-
 .../{ => runtime}/instance/JavaInstance.java       |  2 +-
 .../{ => runtime}/instance/JavaInstanceConfig.java |  2 +-
 .../{ => runtime}/instance/package-info.java       |  3 +--
 .../{ => runtime}/spawner/AssignmentInfo.java      |  2 +-
 .../{ => runtime}/spawner/LimitsConfig.java        |  2 +-
 .../functions/{ => runtime}/spawner/Spawner.java   |  6 +++---
 .../functions/runtime/spawner/package-info.java    | 22 ++++++++++++++++++++++
 .../subscribermanager/ProducerManager.java         |  2 +-
 .../subscribermanager/ResultsProcessor.java        |  2 +-
 .../subscribermanager/SubscriberManager.java       |  2 +-
 .../subscribermanager/TopicSubscription.java       |  2 +-
 .../container/ThreadFunctionContainerTest.java     |  3 +--
 .../{ => runtime}/instance/JavaInstanceTest.java   |  3 +--
 24 files changed, 50 insertions(+), 35 deletions(-)

commit f883f165f0c5e646f57abc5b960c9372e334db2a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 19 09:55:19 2017 -0800

    Buffer limit (#25)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added a way to limit the number of outstanding tuples read but still not executed

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java      | 3 ++-
 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java  | 4 ++--
 .../functions/runtime/container/ThreadFunctionContainerFactory.java  | 5 ++++-
 .../main/java/org/apache/pulsar/functions/spawner/LimitsConfig.java  | 1 +
 .../src/main/java/org/apache/pulsar/functions/spawner/Spawner.java   | 2 +-
 .../functions/runtime/container/ThreadFunctionContainerTest.java     | 2 +-
 6 files changed, 11 insertions(+), 6 deletions(-)

commit 5f3b93ea1dd52799450565ec01fdebeceb01fb30
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 19 05:56:06 2017 -0800

    Fix tests (#24)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Fix void type handling

 .../pulsar/functions/instance/JavaInstance.java    |  8 ++--
 .../functions/instance/JavaInstanceTest.java       | 45 ++++++++++++++++++++++
 2 files changed, 49 insertions(+), 4 deletions(-)

commit fc1f71cc4685b057b8cfa7ce0db3e9c22daf3487
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 19 05:04:02 2017 -0800

    Cleanup (#23)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Cleaned up the logic of supported types

 .../functions/api/examples/VoidFunction.java       | 29 ++++++++++++
 .../pulsar/functions/instance/JavaInstance.java    | 51 +++++++---------------
 2 files changed, 45 insertions(+), 35 deletions(-)

commit 9766676715c7f00d1d4a8073b2deb6861ebe2820
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Tue Dec 19 04:13:12 2017 -0800

    Opt (#22)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Don't wait for the result. Instead chain it via CompletedFuture

 .../functions/api/examples/ExclamationFunction.java |  1 -
 .../runtime/container/ThreadFunctionContainer.java  | 21 ++++++++-------------
 .../subscribermanager/TopicSubscription.java        |  1 -
 3 files changed, 8 insertions(+), 15 deletions(-)

commit 228e01ba5d174e56f746966a1f144515139d109b
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 19 03:45:26 2017 -0800

    Fix broken license headers at pulsar-functions (#20)

 pulsar-functions/conf/example.yml                     | 19 +++++++++++++++++++
 pulsar-functions/run-examples.sh                      | 19 +++++++++++++++++++
 .../org/apache/pulsar/functions/spawner/Spawner.java  | 16 ++++++++--------
 .../functions/subscribermanager/ProducerManager.java  | 16 ++++++++--------
 .../functions/subscribermanager/ResultsProcessor.java | 16 ++++++++--------
 .../subscribermanager/SubscriberManager.java          | 16 ++++++++--------
 .../subscribermanager/TopicSubscription.java          | 16 ++++++++--------
 7 files changed, 78 insertions(+), 40 deletions(-)

commit 85e1882a3a8ff311721dfb8e88fb1a83c6e170ad
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 19:31:56 2017 -0800

    Simplestringserde (#19)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added a simple String based serde

 pulsar-functions/run-examples.sh                   |  2 +-
 .../runtime/container/SimpleStringSerDe.java       | 44 ++++++++++++++++++++++
 2 files changed, 45 insertions(+), 1 deletion(-)

commit 52c9c241f5bd2e721aab8a2fedb7c5f86aa2e3ad
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 19:22:06 2017 -0800

    Refactor (#18)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Refactored serialization/deserialization into an interface

 pom.xml                                            |  2 +-
 pulsar-functions/pom.xml                           |  2 +-
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 24 ++++++
 .../functions/instance/JavaExecutionResult.java    | 13 ++-
 .../pulsar/functions/instance/JavaInstance.java    | 94 +++++-----------------
 .../functions/instance/JavaInstanceConfig.java     |  2 +
 .../runtime/container/ExecutionResult.java         | 55 +++++++++++++
 .../runtime/container/FunctionContainer.java       |  1 -
 .../functions/runtime/container/JavaSerDe.java     | 80 ++++++++++++++++++
 .../container/SerDe.java}                          | 16 ++--
 .../runtime/container/ThreadFunctionContainer.java |  5 +-
 .../pulsar/functions/spawner/AssignmentInfo.java   |  2 +
 .../apache/pulsar/functions/spawner/Spawner.java   |  6 +-
 .../subscribermanager/ResultsProcessor.java        |  6 +-
 .../functions/instance/JavaInstanceTest.java       | 10 ++-
 15 files changed, 212 insertions(+), 106 deletions(-)

commit 5b0ed1b247b95242a3e497dfe51a564feb2f126a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 16:43:20 2017 -0800

    Minor stuff (#17)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added join interface to Spawner.

 .../src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java       | 4 +---
 .../pulsar/functions/runtime/container/ThreadFunctionContainer.java   | 2 --
 .../src/main/java/org/apache/pulsar/functions/spawner/Spawner.java    | 4 ++++
 3 files changed, 5 insertions(+), 5 deletions(-)

commit 98d208dbabdc1d9f4ad33695870f2a14eec89269
Author: Sijie Guo <sijie@apache.org>
Date:   Mon Dec 18 16:34:34 2017 -0800

    Add the missing `pulsar-function` script

 pulsar-functions/bin/pulsar-functions | 109 ++++++++++++++++++++++++++++++++++
 1 file changed, 109 insertions(+)

commit e6978bad4962826b51f32c7192a1f8e7c45d18d5
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Dec 18 16:06:41 2017 -0800

    Integrate CLI with spawner to run functions locally (#16)
    
    * Integrate spawner in cli
    
    * add scripts to run pulsar functions
    
    * add example
    
    * Make pulsar-functions run

 ...xclamationFunction => ExclamationFunction.java} |  1 +
 pulsar-functions/conf/client.conf                  | 27 ++++++++++
 pulsar-functions/conf/example.yml                  |  4 ++
 pulsar-functions/conf/log4j.shell.properties       | 39 ++++++++++++++
 pulsar-functions/conf/pulsar_env.sh                | 60 ++++++++++++++++++++++
 pulsar-functions/conf/pulsar_tools_env.sh          | 60 ++++++++++++++++++++++
 pulsar-functions/run-examples.sh                   |  1 +
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 22 +++++++-
 .../runtime/container/ThreadFunctionContainer.java | 23 +++++++--
 .../pulsar/functions/spawner/AssignmentInfo.java   |  1 +
 .../pulsar/functions/spawner/LimitsConfig.java     | 11 ++--
 .../apache/pulsar/functions/spawner/Spawner.java   | 22 +++++++-
 .../subscribermanager/TopicSubscription.java       |  4 ++
 13 files changed, 261 insertions(+), 14 deletions(-)

commit da4957bb3ea828a6a79b2ec0ca6879d3ce114170
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 15:15:15 2017 -0800

    Fix bugs (#15)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * 1. Start only when there is a subscriber
    2. subscription is shared

 .../apache/pulsar/functions/subscribermanager/SubscriberManager.java   | 1 -
 .../apache/pulsar/functions/subscribermanager/TopicSubscription.java   | 3 ++-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit bb6409f707c9d107c649088022d1266283c8e52a
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 14:49:24 2017 -0800

    Add examples (#14)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added a simple example

 .../functions/api/examples/ExclamationFunction     | 29 ++++++++++++++++++++++
 1 file changed, 29 insertions(+)

commit d2b4483f4db6700e40ddf90c5226263927f56a77
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Dec 18 14:40:56 2017 -0800

    Split functions module into api/runtime/api-examples (#13)
    
    * Split functions module into api/runtime/api-examples
    
    * Move `org.apache.pulsar.functions.api` package from runtime to api package

 pom.xml                                            |   2 +-
 pulsar-functions/api-examples/pom.xml              |  46 +++++++++
 pulsar-functions/api/pom.xml                       |  40 ++++++++
 .../org/apache/pulsar/functions/api/Context.java   |   0
 .../pulsar/functions/api/RawRequestHandler.java    |   0
 .../pulsar/functions/api/RequestHandler.java       |   0
 .../apache/pulsar/functions/api/package-info.java  |   0
 pulsar-functions/pom.xml                           |  79 ++-------------
 pulsar-functions/runtime/pom.xml                   | 109 +++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |   0
 .../org/apache/pulsar/admin/cli/FunctionsTool.java |   0
 .../org/apache/pulsar/admin/cli/package-info.java  |   0
 .../apache/pulsar/functions/fs/FunctionConfig.java |   0
 .../apache/pulsar/functions/fs/package-info.java   |   0
 .../pulsar/functions/instance/ContextImpl.java     |   0
 .../functions/instance/JavaExecutionResult.java    |   0
 .../pulsar/functions/instance/JavaInstance.java    |   0
 .../functions/instance/JavaInstanceConfig.java     |   0
 .../pulsar/functions/instance/package-info.java    |   0
 .../org/apache/pulsar/functions/package-info.java  |   0
 .../pulsar/functions/runtime/FunctionID.java       |   0
 .../pulsar/functions/runtime/InstanceID.java       |   0
 .../org/apache/pulsar/functions/runtime/UUID.java  |   0
 .../runtime/container/FunctionContainer.java       |   0
 .../container/FunctionContainerFactory.java        |   0
 .../runtime/container/ThreadFunctionContainer.java |   0
 .../container/ThreadFunctionContainerFactory.java  |   0
 .../functions/runtime/container/package-info.java  |   0
 .../runtime/functioncache/FunctionCacheEntry.java  |   0
 .../functioncache/FunctionCacheManager.java        |   0
 .../functioncache/FunctionCacheManagerImpl.java    |   0
 .../functioncache/FunctionClassLoaders.java        |   0
 .../runtime/functioncache/package-info.java        |   0
 .../pulsar/functions/runtime/package-info.java     |   0
 .../pulsar/functions/spawner/AssignmentInfo.java   |   0
 .../pulsar/functions/spawner/ExecutionResult.java  |   0
 .../pulsar/functions/spawner/LimitsConfig.java     |   0
 .../apache/pulsar/functions/spawner/Spawner.java   |   0
 .../subscribermanager/ProducerManager.java         |   0
 .../subscribermanager/ResultsProcessor.java        |   0
 .../subscribermanager/SubscriberManager.java       |   0
 .../subscribermanager/TopicSubscription.java       |   0
 .../apache/pulsar/functions/utils/Exceptions.java  |   0
 .../pulsar/functions/utils/package-info.java       |   0
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  |   0
 .../pulsar/functions/fs/FunctionConfigTest.java    |   0
 .../functions/instance/JavaInstanceTest.java       |   0
 .../pulsar/functions/runtime/FunctionIDTest.java   |   0
 .../pulsar/functions/runtime/InstanceIDTest.java   |   0
 .../container/ThreadFunctionContainerTest.java     |   0
 .../functioncache/FunctionCacheEntryTest.java      |   0
 .../FunctionCacheManagerImplTest.java              |   0
 .../functioncache/FunctionClassLoadersTest.java    |   0
 .../pulsar/functions/utils/ExceptionsTest.java     |   0
 .../src/test/resources/multifunction.jar           | Bin
 .../src/test/resources/test_function_config.yml    |   0
 56 files changed, 204 insertions(+), 72 deletions(-)

commit 5e76557826b83f77607f1e6212e4b9d1a0e5ebc1
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 14:11:26 2017 -0800

    Bugcix (#12)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Make Spawner class public, Use Lombok for getter/setter

 .../pulsar/functions/spawner/ExecutionResult.java  |  3 +--
 .../pulsar/functions/spawner/LimitsConfig.java     | 23 +++++++---------------
 .../apache/pulsar/functions/spawner/Spawner.java   |  8 ++------
 3 files changed, 10 insertions(+), 24 deletions(-)

commit e30808c1ff6bf5c012b22c82ca72eec0c19d5b8b
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Mon Dec 18 10:04:55 2017 -0800

    Spawner (#11)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added the first cut of the Spawner
    
    * Added more func
    
    * Use already existing FunctionConfig
    
    * ompiling version
    
    * Rationalized the use of data structures
    
    * Completed Spawner
    
    * Fixed the unittest

 .../apache/pulsar/functions/fs/FunctionConfig.java |   5 +-
 .../pulsar/functions/instance/ContextImpl.java     |   8 +-
 .../functions/instance/JavaExecutionResult.java    |  48 +++++++
 .../pulsar/functions/instance/JavaInstance.java    | 149 +++++++++------------
 .../functions/instance/JavaInstanceConfig.java     |   9 +-
 .../runtime/container/FunctionContainer.java       |  11 ++
 .../container/FunctionContainerFactory.java        |   4 +-
 .../runtime/container/ThreadFunctionContainer.java |  86 +++++++++---
 .../container/ThreadFunctionContainerFactory.java  |  13 +-
 .../pulsar/functions/spawner/AssignmentInfo.java   |  39 ++++++
 .../pulsar/functions/spawner/ExecutionResult.java  |  34 +++++
 .../LimitsConfig.java}                             |  30 +++--
 .../apache/pulsar/functions/spawner/Spawner.java   |  71 ++++++++++
 .../subscribermanager/ProducerManager.java         |  55 ++++++++
 .../subscribermanager/ResultsProcessor.java        |  55 ++++++++
 .../subscribermanager/SubscriberManager.java       |  64 +++++++++
 .../subscribermanager/TopicSubscription.java       | 111 +++++++++++++++
 .../functions/instance/JavaInstanceTest.java       |  47 +++++--
 .../container/ThreadFunctionContainerTest.java     |  10 +-
 19 files changed, 689 insertions(+), 160 deletions(-)

commit 920277bee413c87024c98e1838d4cb0231d30290
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Dec 13 09:40:52 2017 -0800

    Introduce `functioncache` and `functioncontainer` (#9)
    
    * Introduce `functioncache` and `functioncontainer`
    
    - introduce `functioncache` for managing function dependencies (e.g. setting up function class loader and its classpath). The `functioncache` is shared across multiple instances.
    - introduce `functioncontainer` for providing a runtime environment to invoke functions.
    - provide a thread based `functioncontainer` implementation, which uses functioncache to load classpath and initial its function class loader.
    
    * Revert FunctionID/InstanceID to String
    
    * Add test cases for functioncache and functioncontainer

 .../org/apache/pulsar/admin/cli/CmdFunctions.java  |  18 +++
 .../org/apache/pulsar/functions/api/Context.java   |   7 +
 .../apache/pulsar/functions/fs/FunctionConfig.java |  11 ++
 .../pulsar/functions/instance/ContextImpl.java     |   7 +-
 .../pulsar/functions/instance/JavaInstance.java    |   4 +-
 .../functions/instance/JavaInstanceConfig.java     |  15 +-
 .../pulsar/functions/runtime/FunctionID.java       |  41 +++++
 .../pulsar/functions/runtime/InstanceID.java       |  43 ++++++
 .../org/apache/pulsar/functions/runtime/UUID.java  |  65 ++++++++
 .../AbstractFunctionContainerFactory.java          |  41 +++++
 .../runtime/container/FunctionContainer.java       |  33 +++++
 .../container/FunctionContainerFactory.java        |  43 ++++++
 .../runtime/container/ThreadFunctionContainer.java | 106 +++++++++++++
 .../container/ThreadFunctionContainerFactory.java  |  52 +++++++
 .../functions/runtime/container/package-info.java  |  28 ++++
 .../runtime/functioncache/FunctionCacheEntry.java  | 107 +++++++++++++
 .../functioncache/FunctionCacheManager.java        |  85 +++++++++++
 .../functioncache/FunctionCacheManagerImpl.java    | 135 +++++++++++++++++
 .../functioncache/FunctionClassLoaders.java        |  49 ++++++
 .../runtime/functioncache/package-info.java        |  23 +++
 .../pulsar/functions/runtime/package-info.java     |  23 +++
 .../apache/pulsar/functions/utils/Exceptions.java  |  42 ++++++
 .../pulsar/functions/utils/package-info.java       |  23 +++
 .../pulsar/functions/runtime/FunctionIDTest.java   |  49 ++++++
 .../pulsar/functions/runtime/InstanceIDTest.java   |  49 ++++++
 .../container/ThreadFunctionContainerTest.java     | 133 +++++++++++++++++
 .../functioncache/FunctionCacheEntryTest.java      | 147 ++++++++++++++++++
 .../FunctionCacheManagerImplTest.java              | 165 +++++++++++++++++++++
 .../functioncache/FunctionClassLoadersTest.java    |  56 +++++++
 .../pulsar/functions/utils/ExceptionsTest.java     |  80 ++++++++++
 .../src/test/resources/multifunction.jar           | Bin 0 -> 1744 bytes
 .../src/test/resources/test_function_config.yml    |   1 +
 32 files changed, 1675 insertions(+), 6 deletions(-)

commit c1b68ed1ee953fc23e378dc05722b8d202dd8480
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Dec 12 15:20:51 2017 -0800

    Run travis ci on linux and osx (#10)

 .travis.yml | 17 +++++++++++++----
 1 file changed, 13 insertions(+), 4 deletions(-)

commit aca6ac5a7b6bef1f794e9b82bd0b2d0078983408
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Dec 11 14:04:38 2017 -0800

    Introduce Function Config and Functions Cmd (#4)
    
    - introduce a `fs` package for function state related classes
    - add `FunctionConfig` for user defined function configurations
    - add `CmdFunctions`: it takes a yaml file and also command parameters

 pulsar-functions/pom.xml                           | 44 +++++++++++
 .../org/apache/pulsar/admin/cli/CmdFunctions.java  | 83 +++++++++++++++++++
 .../org/apache/pulsar/admin/cli/FunctionsTool.java | 59 ++++++++++++++
 .../org/apache/pulsar/admin/cli/package-info.java  | 25 ++++++
 .../apache/pulsar/functions/fs/FunctionConfig.java | 47 +++++++++++
 .../apache/pulsar/functions/fs/package-info.java   | 23 ++++++
 .../pulsar/functions/instance/JavaInstance.java    |  2 +-
 .../functions/instance/JavaInstanceConfig.java     | 61 ++------------
 .../apache/pulsar/admin/cli/CmdFunctionsTest.java  | 92 ++++++++++++++++++++++
 .../pulsar/functions/fs/FunctionConfigTest.java    | 59 ++++++++++++++
 .../src/test/resources/test_function_config.yml    | 22 ++++++
 11 files changed, 460 insertions(+), 57 deletions(-)

commit 7c871b08bebc0994c02665ced4e09f78c683561d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Dec 11 13:44:57 2017 -0800

     Make RequestHandler a functional interface (#8)
    
    * Use TypeResolver to resolve generic types
    
    * Make Pulsar Function a functional interface
    
    * address comments

 .../pulsar/functions/api/RawRequestHandler.java     |  1 +
 .../apache/pulsar/functions/api/RequestHandler.java |  1 +
 .../pulsar/functions/instance/JavaInstanceTest.java | 21 ++++++++++++++++++++-
 3 files changed, 22 insertions(+), 1 deletion(-)

commit 9e7d30cfbccdd2058d50843efcec497d8411c2f8
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Dec 11 11:29:47 2017 -0800

    Use TypeResolver to resolve generic types (#7)

 pulsar-functions/pom.xml                              |  6 ++++++
 .../pulsar/functions/instance/JavaInstance.java       | 19 +++++--------------
 2 files changed, 11 insertions(+), 14 deletions(-)

commit 468c6e10d64472816a3bbd4a34eacd115ee58261
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Dec 10 13:47:44 2017 -0800

    Only test pulsar-functions (#5)

 .travis.yml                                        | 46 ++--------------------
 .../org/apache/pulsar/functions/api/Context.java   | 22 +++++------
 .../pulsar/functions/api/RawRequestHandler.java    | 25 ++++++------
 .../pulsar/functions/api/RequestHandler.java       | 18 ++++-----
 .../apache/pulsar/functions/api/package-info.java  | 15 +++----
 .../pulsar/functions/instance/ContextImpl.java     | 22 +++++------
 .../pulsar/functions/instance/JavaInstance.java    | 28 ++++++-------
 .../functions/instance/JavaInstanceConfig.java     | 18 ++++-----
 .../pulsar/functions/instance/package-info.java    | 15 +++----
 .../org/apache/pulsar/functions/package-info.java  | 15 +++----
 10 files changed, 94 insertions(+), 130 deletions(-)

commit a13d5cecdcc0378fd5731af8d965440d938472cb
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Fri Dec 8 18:39:49 2017 -0800

    Instance (#3)
    
    * Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`
    
    * Added the first cut of the Java interface for Pulsar functions (#2)
    
    * Added a simple Instance to run the exposed user interfaces
    
    * Addressed pr comments plus added tests
    
    * Remove unused import

 .../org/apache/pulsar/functions/api/Context.java   |   2 +-
 .../pulsar/functions/api/RawRequestHandler.java    |   2 +-
 .../pulsar/functions/api/RequestHandler.java       |   2 +-
 .../pulsar/functions/instance/ContextImpl.java     |  91 ++++++++
 .../pulsar/functions/instance/JavaInstance.java    | 259 +++++++++++++++++++++
 .../functions/instance/JavaInstanceConfig.java     |  89 +++++++
 .../pulsar/functions/instance/package-info.java    |  22 ++
 .../functions/instance/JavaInstanceTest.java       | 106 +++++++++
 8 files changed, 570 insertions(+), 3 deletions(-)

commit 9a567747916fab151268db0057d2f21ee71d4b01
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 6 20:35:44 2017 -0800

    Added the first cut of the Java interface for Pulsar functions (#2)

 .../org/apache/pulsar/functions/api/Context.java   | 85 ++++++++++++++++++++++
 .../pulsar/functions/api/RawRequestHandler.java    | 37 ++++++++++
 .../pulsar/functions/api/RequestHandler.java       | 34 +++++++++
 3 files changed, 156 insertions(+)

commit 72092c4b63a2841bcaa419bbc27f0d1b60aa486e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Dec 6 10:43:54 2017 -0800

    Create pulsar-functions module (#1)
    
    * Create pulsar-functions module
    
    * rename `sdk` package to `api`

 pom.xml                                            |  2 +
 pulsar-functions/pom.xml                           | 53 ++++++++++++++++++++++
 .../apache/pulsar/functions/api/package-info.java  | 22 +++++++++
 .../org/apache/pulsar/functions/package-info.java  | 22 +++++++++
 4 files changed, 99 insertions(+)

commit 44e06635c1524229a923e8fbb525df278fcecdec
Author: Ivan Kelly <ivank@apache.org>
Date:   Sat Mar 3 02:17:32 2018 +0100

    Utilities for arquillian integration tests (#1310)
    
    * Utilities for arquillian integration tests
    
    A set of utilities for working with clusters set up in arquillian.
    
    - Utilities to work with docker
    - Utilities to work with arquillian pulsar clusters
    - Await strategies that arquillian uses to know if a node is up
    - Stop actions to copy logs at the end of a test suite
    
    * Move to log4j2
    
    * Pull in extra dependencies for log4j yml configuration

 tests/integration-tests-utils/pom.xml              |  84 +++++++
 .../java/org/apache/pulsar/tests/DockerUtils.java  | 220 +++++++++++++++++
 .../pulsar/tests/LogToTargetDirStopAction.java     |  41 ++++
 .../org/apache/pulsar/tests/NoopAwaitStrategy.java |  28 +++
 .../apache/pulsar/tests/PulsarClusterUtils.java    | 269 +++++++++++++++++++++
 .../tests/PulsarLogsToTargetDirStopAction.java     |  43 ++++
 .../pulsar/tests/ZooKeeperAwaitStrategy.java       |  54 +++++
 .../src/main/resources/log4j2.yml                  |  41 ++++
 tests/pom.xml                                      |   1 +
 9 files changed, 781 insertions(+)

commit 973fa3ac35394e73ca7a950afac4f908633ff23c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Mar 2 13:07:21 2018 -0800

    Introduce a pulsar log4j2 appender (#1316)
    
    ### Motivation
    
    when developing `pulsar-functions`, it would be good to log the log messages generated by functions to pulsar, so the user can easily tail the log messages topic to get all the messages per functions.
    
    ### Modifications
    
    This PR is to add a pulsar based appender.
    
    ### Result
    
    We are able to use pulsar log4j2 appender to log messages.

 pom.xml                                            |  25 +++
 pulsar-log4j2-appender/pom.xml                     |  74 +++++++
 .../pulsar/log4j2/appender/PulsarAppender.java     | 211 ++++++++++++++++++++
 .../pulsar/log4j2/appender/PulsarManager.java      | 145 ++++++++++++++
 .../pulsar/log4j2/appender/PulsarAppenderTest.java | 218 +++++++++++++++++++++
 .../builder/ConfigurationAssemblerTest.java        | 115 +++++++++++
 .../appender/builder/ConfigurationBuilderTest.java | 120 ++++++++++++
 .../builder/CustomConfigurationFactory.java        |  88 +++++++++
 .../src/test/resources/PulsarAppenderTest.xml      |  49 +++++
 9 files changed, 1045 insertions(+)

commit a64b383de7fee866756782c6743823bf90d69395
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 2 00:13:51 2018 -0800

    Converted main part of code to use builder APIs with typed interface (#1311)

 .../pulsar/broker/service/BrokerService.java       | 37 +++++-----
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  8 +--
 .../client/impl/ConsumeBaseExceptionTest.java      |  2 +-
 .../clients/consumer/PulsarKafkaConsumer.java      | 51 +++++++-------
 .../clients/producer/PulsarKafkaProducer.java      | 42 ++++++------
 .../kafka/compat/PulsarClientKafkaConfig.java      | 37 ++++++----
 .../kafka/compat/PulsarConsumerKafkaConfig.java    | 15 ++--
 .../kafka/compat/PulsarProducerKafkaConfig.java    | 21 +++---
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  6 +-
 .../pulsar/client/api/ConsumerConfiguration.java   |  4 +-
 .../pulsar/client/api/ConsumerEventListener.java   |  4 +-
 .../apache/pulsar/client/api/MessageRouter.java    |  4 +-
 .../apache/pulsar/client/api/ProducerBuilder.java  |  2 +-
 .../apache/pulsar/client/api/ReaderBuilder.java    |  2 +-
 .../pulsar/client/impl/BatchMessageContainer.java  |  6 +-
 .../pulsar/client/impl/ClientBuilderImpl.java      |  4 ++
 .../org/apache/pulsar/client/impl/ClientCnx.java   | 18 ++---
 .../apache/pulsar/client/impl/ConsumerBase.java    | 10 +--
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  3 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 11 +--
 .../apache/pulsar/client/impl/ConsumerStats.java   |  8 +--
 .../pulsar/client/impl/ConsumerStatsDisabled.java  |  2 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java | 21 +++---
 .../client/impl/PartitionedConsumerImpl.java       | 24 +++----
 .../client/impl/PartitionedProducerImpl.java       | 10 +--
 .../apache/pulsar/client/impl/ProducerImpl.java    | 21 +++---
 .../apache/pulsar/client/impl/ProducerStats.java   |  4 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 13 ++--
 .../pulsar/client/impl/ReaderBuilderImpl.java      |  7 +-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  2 +-
 .../impl/RoundRobinPartitionMessageRouterImpl.java |  2 +-
 .../apache/pulsar/proxy/server/ProxyService.java   | 20 +++---
 .../proxy/server/ProxyForwardAuthDataTest.java     |  7 +-
 .../apache/pulsar/storm/MessageToValuesMapper.java |  2 +-
 .../java/org/apache/pulsar/storm/PulsarBolt.java   | 55 +++++++++++----
 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 79 +++++++++++++++-------
 .../apache/pulsar/storm/SharedPulsarClient.java    | 55 ++++++++-------
 .../pulsar/testclient/PerformanceConsumer.java     | 62 ++++++++---------
 .../pulsar/testclient/PerformanceProducer.java     | 51 +++++++-------
 .../pulsar/testclient/PerformanceReader.java       | 36 +++++-----
 .../apache/pulsar/websocket/WebSocketService.java  | 29 ++++----
 41 files changed, 436 insertions(+), 361 deletions(-)

commit 21ffe2ccf217df9038776ec59a1c7986519258bb
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Thu Mar 1 17:57:06 2018 -0700

    Schema registry (1/4) (#1232)
    
    * Schema Registry proto changes
    
    * Renumber schema fields
    
    * Update Pulsar API with schema changes
    
    * Revert field number change
    
    * Address issues in review
    
    * Add schema type back to proto definition
    
    * Remove reserved future enum fields
    
    * regenerate code from protobuf
    
    * Add schema version to producer success message
    
    * Revert "Add schema version to producer success message"
    
    This reverts commit e7e72f468cf46f1605524a7399520c22763583c9.
    
    * Revert "Revert "Add schema version to producer success message""
    
    This reverts commit 7b902f6bdb1cb054e26577747ff4dd8c326a6248.

 .../apache/pulsar/common/api/proto/PulsarApi.java  | 1189 ++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   22 +
 2 files changed, 1211 insertions(+)

commit ccf1812da9f9280ef829527d3a97ee23c4ad3691
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Thu Mar 1 15:20:46 2018 -0700

    Remove deprecated newConnect methods (#1315)
    
    * Remove deprecated and unused code
    
    * Revert "Remove deprecated and unused code"
    
    This reverts commit 95114c6f573cd8ef26bc2c3c0ad2691a1af6f268.
    
    * Move old newConnect funtions to tests for backward compat

 .../pulsar/broker/service/ServerCnxTest.java       | 23 +++++++++++++--
 .../org/apache/pulsar/common/api/Commands.java     | 34 ++++------------------
 2 files changed, 26 insertions(+), 31 deletions(-)

commit 1db47cae481c2a6bc16e37fb3012cfcdb469c632
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Mar 1 07:12:16 2018 -0800

    Fix the typo in shaded client-tools module (#1313)

 pulsar-client-tools-shaded/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 72aa7d943c5745af6753cd2b23e4ec1760135c98
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 22:10:47 2018 -0800

    Make client configuration protected in PulsarAdminTool (#1312)
    
    This change allows pulsar-functions access client configuration in admin tool

 .../src/main/java/org/apache/pulsar/admin/cli/PulsarAdminTool.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d0f8a40d0834525ac1679cc7a28621ddc23f899e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Feb 28 22:10:30 2018 -0800

    Precreate readonly path and increase disk usage thresholds for pulsar standalone (#1309)

 .../org/apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java     | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

commit 3b9f3d8cdb9d3b51333d088ee3cd4d179a06eaaa
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 28 13:23:48 2018 -0800

    Moved the bk-tests dependency to parent pom (#1308)

 managed-ledger/pom.xml      | 14 --------------
 pom.xml                     | 15 +++++++++++++++
 pulsar-broker/pom.xml       | 15 ---------------
 pulsar-client-tools/pom.xml | 14 --------------
 pulsar-spark/pom.xml        |  1 -
 5 files changed, 15 insertions(+), 44 deletions(-)

commit 3e76ba2508ec42e642a70cae09970040b41eab7b
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Wed Feb 28 12:17:24 2018 -0700

    Add Type information to Pulsar client interface (#987)
    
    * Add type information to Consumer
    
    * Typed Producer and compiling tests
    
    * Typed consumers
    
    * Typed Client with typed consumers and producers
    
    * Wrap reader and writer configurations in typed variants
    
    * remove type annotation from publisher impl
    
    * Add license headers to new files.
    
    * Remove type from PulsarClient
    
    * Type the consumer on the content not the message
    
    * Fix generic type for Reader config
    
    * Remove type information from PartitionedProducerImpl
    
    * Rename Codec to Schema and add javadoc for client interface
    
    * Make the correct api calls
    
    * Fix incorrectly merged test
    
    * WIP: BROKEN REPLICATOR
    
    * unwrap producer
    
    * Passing tests
    
    * Fix broken merge
    
    * wip
    
    * wip

 .../pulsar/broker/service/AbstractReplicator.java  |   6 +-
 .../pulsar/broker/service/BrokerService.java       |   1 +
 .../nonpersistent/NonPersistentReplicator.java     |   2 +-
 .../service/persistent/PersistentReplicator.java   |   2 +-
 .../org/apache/pulsar/client/api/RawReader.java    |   5 +-
 .../apache/pulsar/client/impl/RawReaderImpl.java   |  13 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   1 +
 .../broker/service/PersistentFailoverE2ETest.java  |   4 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  13 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  14 +-
 .../client/api/DispatcherBlockConsumerTest.java    |  61 ++++-----
 .../client/api/SimpleProducerConsumerStatTest.java |   4 +-
 .../client/api/SimpleProducerConsumerTest.java     |   4 +-
 .../client/impl/BrokerClientIntegrationTest.java   |   2 +-
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   8 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java |  10 +-
 .../admin/internal/PersistentTopicsImpl.java       |   5 +-
 .../clients/consumer/PulsarKafkaConsumer.java      |   6 +-
 .../org/apache/pulsar/client/api/Consumer.java     |  16 +--
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  38 +++---
 .../pulsar/client/api/ConsumerConfiguration.java   |   6 +-
 .../java/org/apache/pulsar/client/api/Message.java |   5 +-
 .../apache/pulsar/client/api/MessageBuilder.java   |  40 ++++--
 .../apache/pulsar/client/api/MessageListener.java  |   6 +-
 .../org/apache/pulsar/client/api/Producer.java     |  16 +--
 .../apache/pulsar/client/api/ProducerBuilder.java  |  48 +++----
 .../org/apache/pulsar/client/api/PulsarClient.java |  71 ++++++++--
 .../java/org/apache/pulsar/client/api/Reader.java  |   8 +-
 .../apache/pulsar/client/api/ReaderBuilder.java    |  24 ++--
 .../pulsar/client/api/ReaderConfiguration.java     |  10 +-
 .../apache/pulsar/client/api/ReaderListener.java   |   6 +-
 .../java/org/apache/pulsar/client/api/Schema.java  |  36 +++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  35 ++---
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  57 ++++----
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  68 +++++-----
 .../pulsar/client/impl/MessageBuilderImpl.java     |  37 +++--
 .../org/apache/pulsar/client/impl/MessageImpl.java |  37 +++--
 .../client/impl/PartitionedConsumerImpl.java       |  71 +++++-----
 .../client/impl/PartitionedProducerImpl.java       |  17 +--
 .../client/impl/PatternTopicsConsumerImpl.java     |  14 +-
 .../apache/pulsar/client/impl/ProducerBase.java    |  23 ++--
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  59 ++++----
 .../apache/pulsar/client/impl/ProducerImpl.java    |   7 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 149 +++++++++++++--------
 .../pulsar/client/impl/ReaderBuilderImpl.java      |  40 +++---
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  34 ++---
 .../pulsar/client/impl/TopicMessageImpl.java       |   5 +
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  57 ++++----
 .../impl/conf/ConsumerConfigurationData.java       |  16 +--
 .../client/impl/conf/ReaderConfigurationData.java  |   8 +-
 .../java/org/apache/pulsar/storm/PulsarBolt.java   |   4 +-
 .../apache/pulsar/storm/TupleToMessageMapper.java  |   2 +-
 .../pulsar/testclient/LoadSimulationClient.java    |   2 +-
 .../pulsar/testclient/PerformanceConsumer.java     |   4 +-
 .../pulsar/testclient/PerformanceProducer.java     |   8 +-
 .../pulsar/testclient/PerformanceReader.java       |   2 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |  11 +-
 .../apache/pulsar/websocket/ProducerHandler.java   |   4 +-
 .../org/apache/pulsar/websocket/ReaderHandler.java |  10 +-
 59 files changed, 728 insertions(+), 544 deletions(-)

commit 9c54e73247cdc9cb33b2fe77287a377798f6b7c7
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Feb 28 18:10:56 2018 +0100

    Docker image for integration testing (#1275)
    
    * Docker image for integration testing
    
    A docker image built with the pulsar distribution tarball. The same
    image can be used to run zookeeper, bookkeeper, the broker or a
    proxy. Scripts are provided to run each. There is also a script to
    initialize the cluster.
    
    All services are run with supervisor, so that tests will be able to
    start and stop the services.
    
    * Fix build

 docker/pom.xml                                     |  1 -
 pom.xml                                            |  6 ++
 .../docker-images/latest-version-image/Dockerfile  | 39 ++++++++++
 .../latest-version-image/conf/bookie.conf          | 26 +++++++
 .../latest-version-image/conf/broker.conf          | 26 +++++++
 .../latest-version-image/conf/global-zk.conf       | 26 +++++++
 .../latest-version-image/conf/local-zk.conf        | 26 +++++++
 .../latest-version-image/conf/proxy.conf           | 26 +++++++
 .../latest-version-image/conf/supervisord.conf     | 40 ++++++++++
 tests/docker-images/latest-version-image/pom.xml   | 85 ++++++++++++++++++++++
 .../latest-version-image/scripts/init-cluster.sh   | 36 +++++++++
 .../latest-version-image/scripts/run-bookie.sh     | 30 ++++++++
 .../latest-version-image/scripts/run-broker.sh     | 30 ++++++++
 .../latest-version-image/scripts/run-global-zk.sh  | 29 ++++++++
 .../latest-version-image/scripts/run-local-zk.sh   | 29 ++++++++
 .../latest-version-image/scripts/run-proxy.sh      | 30 ++++++++
 tests/docker-images/pom.xml                        | 37 ++++++++++
 tests/pom.xml                                      | 48 ++++++++++++
 18 files changed, 569 insertions(+), 1 deletion(-)

commit 3a6b0fbdcc6c0b2fe44a7d5b3899a1c925791006
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Feb 28 18:09:56 2018 +0100

    Cleanup old compacted topic ledgers when a new one is available (#1302)
    
    When a broker is notified of a new compacted ledger for a topic, and
    after it has been persisted to the compaction cursor, delete the old
    compacted topic ledger. The deletion is best effort. If it fails it
    doesn't affect reading from the newer ledger.
    
    This isn't foolproof by any means. There's still plenty of
    opportunities for ledgers to be orphaned. We'll need some sort of GC
    based on ledger metadata to handle all cases, but that needs a newer
    bookkeeper (for the metadata properties changes).

 .../apache/pulsar/compaction/CompactedTopic.java   |  3 +-
 .../pulsar/compaction/CompactedTopicImpl.java      | 27 +++++++++-
 .../pulsar/compaction/CompactedTopicTest.java      | 63 +++++++++++++++-------
 3 files changed, 72 insertions(+), 21 deletions(-)

commit 518120df6a202dfcfd40f8ea657632f6d5a94a61
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Feb 28 09:01:46 2018 -0800

    PIP-13-3/3: auto subscribe based on regex pattern topics changing (#1298)
    
    * auto discovery of pattern subscribe topics changes; auto sub/unsub
    
    * change following @Matteo's comments
    
    * change to use timer

 .../client/impl/PatternTopicsConsumerImplTest.java | 355 ++++++++++++++++++++-
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   9 +
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   7 +
 .../client/impl/PatternTopicsConsumerImpl.java     | 139 +++++++-
 .../pulsar/client/impl/PulsarClientImpl.java       |  30 +-
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  11 +-
 .../impl/conf/ConsumerConfigurationData.java       |   2 +
 7 files changed, 535 insertions(+), 18 deletions(-)

commit d179bee91964ebfe9a95c6614b50f1b890f658c8
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 28 09:00:15 2018 -0800

    Replace pulsar-checksum module with circe-checksum from BK (#1306)

 pom.xml                                            |   3 +-
 pulsar-broker-shaded/pom.xml                       |   2 +-
 .../org/apache/pulsar/broker/service/Producer.java |   2 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  15 +-
 .../broker/service/persistent/ChecksumTest.java    |   7 +-
 pulsar-checksum/pom.xml                            | 173 ----------------
 pulsar-checksum/src/main/assembly/assembly.xml     |  71 -------
 .../src/main/circe/cpp/crc32c_sse42.cpp            | 217 ---------------------
 .../src/main/circe/cpp/crc32c_sse42_jni.cpp        |  78 --------
 pulsar-checksum/src/main/circe/cpp/gf2.hpp         | 174 -----------------
 .../src/main/circe/include/crc32c_sse42.hpp        |  40 ----
 pulsar-checksum/src/main/circe/include/int_types.h |  43 ----
 .../java/com/scurrilous/circe/CommonHashes.java    | 188 ------------------
 .../src/main/java/com/scurrilous/circe/Hash.java   |  53 -----
 .../java/com/scurrilous/circe/HashParameters.java  |  30 ---
 .../java/com/scurrilous/circe/HashProvider.java    | 101 ----------
 .../java/com/scurrilous/circe/HashProviders.java   | 125 ------------
 .../java/com/scurrilous/circe/HashSupport.java     | 179 -----------------
 .../src/main/java/com/scurrilous/circe/Hashes.java | 123 ------------
 .../com/scurrilous/circe/IncrementalIntHash.java   |  88 ---------
 .../com/scurrilous/circe/IncrementalLongHash.java  |  88 ---------
 .../java/com/scurrilous/circe/StatefulHash.java    | 171 ----------------
 .../java/com/scurrilous/circe/StatefulIntHash.java |  31 ---
 .../com/scurrilous/circe/StatefulLongHash.java     |  30 ---
 .../java/com/scurrilous/circe/StatelessHash.java   |  31 ---
 .../com/scurrilous/circe/StatelessIntHash.java     |  77 --------
 .../com/scurrilous/circe/StatelessLongHash.java    |  77 --------
 .../com/scurrilous/circe/crc/AbstractIntCrc.java   |  64 ------
 .../com/scurrilous/circe/crc/AbstractLongCrc.java  |  64 ------
 .../java/com/scurrilous/circe/crc/JavaCrc32.java   | 103 ----------
 .../com/scurrilous/circe/crc/NormalByteCrc.java    |  46 -----
 .../com/scurrilous/circe/crc/NormalIntCrc.java     |  48 -----
 .../com/scurrilous/circe/crc/NormalLongCrc.java    |  48 -----
 .../com/scurrilous/circe/crc/ReflectedIntCrc.java  |  49 -----
 .../com/scurrilous/circe/crc/ReflectedLongCrc.java |  49 -----
 .../java/com/scurrilous/circe/crc/Sse42Crc32C.java | 130 ------------
 .../scurrilous/circe/crc/StandardCrcProvider.java  |  82 --------
 .../com/scurrilous/circe/crc/package-info.java     |  25 ---
 .../circe/impl/AbstractHashProvider.java           | 193 ------------------
 .../circe/impl/AbstractIncrementalIntHash.java     | 114 -----------
 .../circe/impl/AbstractIncrementalLongHash.java    | 114 -----------
 .../circe/impl/AbstractStatefulHash.java           | 132 -------------
 .../circe/impl/AbstractStatelessIntHash.java       |  79 --------
 .../circe/impl/AbstractStatelessLongHash.java      |  79 --------
 .../circe/impl/DirectByteBufferAccess.java         |  34 ----
 .../circe/impl/DirectByteBufferAccessLoader.java   |  49 -----
 .../java/com/scurrilous/circe/impl/HashCache.java  |  44 -----
 .../com/scurrilous/circe/impl/HashCacheLoader.java |  58 ------
 .../circe/impl/IncrementalIntStatefulHash.java     |  92 ---------
 .../circe/impl/IncrementalLongStatefulHash.java    |  92 ---------
 .../scurrilous/circe/impl/IntStatefulLongHash.java | 109 -----------
 .../circe/impl/IntStatelessLongHash.java           |  80 --------
 .../com/scurrilous/circe/impl/package-info.java    |  22 ---
 .../java/com/scurrilous/circe/package-info.java    |  22 ---
 .../com/scurrilous/circe/params/CrcParameters.java | 205 -------------------
 .../circe/params/MurmurHash3Parameters.java        |  73 -------
 .../circe/params/MurmurHash3Variant.java           |  52 -----
 .../circe/params/SimpleHashParameters.java         |  85 --------
 .../circe/params/SipHash24Parameters.java          |  69 -------
 .../com/scurrilous/circe/params/package-info.java  |  21 --
 .../pulsar/checksum/utils/Crc32cChecksum.java      |  85 --------
 .../pulsar/checksum/utils/Crc32cSse42Provider.java |  62 ------
 .../apache/pulsar/checksum/utils/NativeUtils.java  | 101 ----------
 .../services/com.scurrilous.circe.HashProvider     |   1 -
 .../com/scurrilous/circe/CommonHashesTest.java     |  45 -----
 .../com/scurrilous/circe/crc/CRCProvidersTest.java |  88 ---------
 .../java/com/scurrilous/circe/crc/CRCTest.java     | 197 -------------------
 .../circe/impl/AbstractIncrementalIntHashTest.java | 145 --------------
 .../impl/AbstractIncrementalLongHashTest.java      | 147 --------------
 .../circe/impl/AbstractStatefulHashTest.java       | 193 ------------------
 .../circe/impl/AbstractStatelessIntHashTest.java   |  84 --------
 .../circe/impl/AbstractStatelessLongHashTest.java  |  84 --------
 .../pulsar/checksum/utils/Crc32cChecksumTest.java  |  55 ------
 .../pulsar/checksum/utils/NativeUtilsTests.java    |  48 -----
 pulsar-client-admin-shaded/pom.xml                 |   2 +-
 .../pulsar-client-kafka/pom.xml                    |   2 +-
 pulsar-client-shaded/pom.xml                       |   2 +-
 pulsar-client-tools-shaded/pom.xml                 |   4 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |   4 +-
 pulsar-common/pom.xml                              |   6 +-
 .../org/apache/pulsar/common/api/Commands.java     |   4 +-
 .../pulsar/common/compression/CommandsTest.java    |   7 +-
 .../common/compression/Crc32cChecksumTest.java     |  28 +--
 84 files changed, 46 insertions(+), 6093 deletions(-)

commit 6689c4da8e3ad8d91b142246704b18ef85141bb6
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 27 18:52:17 2018 -0800

    Make buildtools dependency in test scope and a few updates in PulsarClientImpl (#1304)

 pom.xml                                                              | 1 +
 .../main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java    | 5 +++--
 2 files changed, 4 insertions(+), 2 deletions(-)

commit 6bd4ccc815fa102be58e7143bf13d5e7359f4daa
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 27 18:23:05 2018 -0800

    Switched to BookKeeper-4.7.0-SNAPSHOT + Adjustements (#1292)
    
    * Switched to BookKeeper-4.7.0-SNAPSHOT + Adjustements
    
    * Added some missing operations to GrowableArrayBlockingQueue
    
    Managed ledger was using UnboundedArrayBlockingQueue from yahoo/bookkeeper branch.
    
    * Removed mock BK classes that are now in BK itself
    
    * Fixed flaky test after refactoring
    
    * Fixed some other tests
    
    * One more flaky test
    
    * Added bk tests dependency to pulsar-client-tools

 all/pom.xml                                        |  10 -
 buildtools/src/main/resources/log4j2.yml           |   5 +-
 managed-ledger/pom.xml                             |  16 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   6 +-
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |   4 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  43 ++--
 .../mledger/impl/MetaStoreImplZookeeper.java       |  16 +-
 .../bookkeeper/client/BookKeeperTestClient.java    |   6 +-
 .../apache/bookkeeper/client/MockBookKeeper.java   | 270 ---------------------
 .../apache/bookkeeper/client/MockLedgerEntry.java  |  68 ------
 .../apache/bookkeeper/client/MockLedgerHandle.java | 223 -----------------
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |   7 +-
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |  23 +-
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java  |   7 +-
 pom.xml                                            |  12 +-
 pulsar-broker/pom.xml                              |  20 ++
 .../apache/pulsar/PulsarClusterMetadataSetup.java  |   9 +-
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |   9 +-
 .../org/apache/pulsar/broker/PulsarService.java    |   9 +-
 .../pulsar/broker/service/BrokerService.java       |  10 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   4 +-
 .../apache/pulsar/compaction/CompactorTool.java    |  31 +--
 .../pulsar/compaction/TwoPhaseCompactor.java       |   3 +-
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |  17 --
 .../broker/MockedBookKeeperClientFactory.java      |  52 ++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   3 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   2 +-
 .../broker/auth/SameThreadOrderedSafeExecutor.java |  15 +-
 .../broker/cache/ResourceQuotaCacheTest.java       |   8 +-
 .../broker/namespace/OwnershipCacheTest.java       |  13 +-
 .../apache/pulsar/broker/web/WebServiceTest.java   |   2 +
 .../zookeeper/ZooKeeperClientAspectJTest.java      |  23 +-
 .../client/api/MessageDispatchThrottlingTest.java  |  44 ++--
 pulsar-client-tools/pom.xml                        |  14 ++
 .../collections/GrowableArrayBlockingQueue.java    |  94 ++++++-
 .../GrowableArrayBlockingQueueTest.java            |  78 ++++++
 .../discovery/service/BrokerDiscoveryProvider.java |   4 +-
 .../service/web/ZookeeperCacheLoader.java          |   5 +-
 .../proxy/server/BrokerDiscoveryProvider.java      |   7 +-
 .../proxy/server/util/ZookeeperCacheLoader.java    |   5 +-
 .../apache/pulsar/websocket/WebSocketService.java  |   6 +-
 pulsar-zookeeper-utils/pom.xml                     |   2 +-
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |   4 +-
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |   4 +-
 .../zookeeper/ZkBookieRackAffinityMapping.java     |  55 +++--
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |  39 +--
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    |  14 +-
 .../zookeeper/ZookeeperBkClientFactoryImpl.java    | 114 +++------
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |  27 +--
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |  66 ++---
 .../ZookeeperBkClientFactoryImplTest.java          |  20 +-
 .../pulsar/zookeeper/ZookeeperCacheTest.java       |  51 ++--
 52 files changed, 640 insertions(+), 959 deletions(-)

commit 3e1465aaf70d6f5595cd1a04206cb1d7e6f8edef
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 27 17:12:20 2018 -0800

    Updated ASF links on index page. (#1305)
    
    This includes fixes from some of the issues reported in #1266

 site/_includes/footer.html |  1 +
 site/_includes/navbar.html | 12 ++++++------
 site/index.html            |  2 +-
 3 files changed, 8 insertions(+), 7 deletions(-)

commit 90fb9b2c7cfabf8035496936de0441008aa2dc32
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Tue Feb 27 16:02:13 2018 -0700

    Make BackoffTest deterministic, fixes #1299 (#1301)

 .../org/apache/pulsar/client/impl/Backoff.java     |  24 +++-
 .../org/apache/pulsar/client/impl/BackoffTest.java | 134 +++++++++++++--------
 2 files changed, 101 insertions(+), 57 deletions(-)

commit 98656cf7e9f28f1e65957c8382947e02020aedb9
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Feb 27 17:47:23 2018 +0100

    Watch-znode script for docker image (#1289)
    
    * Watch-znode script for docker image
    
    Docker compose doesn't have any way to run initialization like k8s
    does, so you need to role your own solution. This script allows you to
    wait for a znode to be created in zookeeper, check if it exists and
    create it. It can be used to ensure that pulsar brokers and bookies do
    not come up before metadata format has run.
    
    * fixup license

 docker/pulsar/Dockerfile             |  3 +-
 docker/pulsar/scripts/watch-znode.py | 95 ++++++++++++++++++++++++++++++++++++
 2 files changed, 97 insertions(+), 1 deletion(-)

commit 08b5b857c64e2cdba8cd3e7f09612ee29662c7f7
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed Feb 28 01:33:27 2018 +0900

    Add prefix setting for C++/Python reader (#1283)
    
    * Add prefix setting for C++ reader
    
    * Ran "make format"
    
    * Fix python reader for subscription role prefix

 pulsar-client-cpp/include/pulsar/ReaderConfiguration.h | 3 +++
 pulsar-client-cpp/lib/ReaderConfiguration.cc           | 8 ++++++++
 pulsar-client-cpp/lib/ReaderConfigurationImpl.h        | 4 +++-
 pulsar-client-cpp/lib/ReaderImpl.cc                    | 3 +++
 pulsar-client-cpp/python/pulsar.py                     | 8 +++++++-
 pulsar-client-cpp/python/src/config.cc                 | 2 ++
 6 files changed, 26 insertions(+), 2 deletions(-)

commit af44a88e2bbb8005da3b676e0b86b691e0493fbc
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 27 08:32:35 2018 -0800

    Use log4j2 as slf4j binding for tests (#1295)
    
    * Use log4j2 as slf4j binding for tests
    
    * Add license plugin for buildtools module

 buildtools/pom.xml                       | 22 +++++++++++------
 buildtools/src/main/resources/log4j2.yml | 42 ++++++++++++++++++++++++++++++++
 pom.xml                                  | 30 ++++++++++++++---------
 3 files changed, 75 insertions(+), 19 deletions(-)

commit ba58a2aed50d6a7573a751f5292b99fc36b6dec6
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Mon Feb 26 22:00:27 2018 -0800

    PIP-13-2/3: support regex based subscription (#1279)
    
    * leverage lookup service to getTopicsOfNamespace, add subscribe pattern method
    
    * change following @matteo's comments
    
    * fix rebase error
    
    * add comments for pattern in builder

 .../apache/pulsar/broker/service/ServerCnx.java    |   32 +-
 .../client/impl/PatternTopicsConsumerImplTest.java |  204 ++++
 .../apache/pulsar/client/api/ConsumerBuilder.java  |   22 +-
 .../client/impl/BinaryProtoLookupService.java      |   71 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   42 +
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |   16 +-
 .../pulsar/client/impl/HttpLookupService.java      |   27 +
 .../apache/pulsar/client/impl/LookupService.java   |   11 +
 .../client/impl/PatternTopicsConsumerImpl.java     |   46 +
 .../pulsar/client/impl/PulsarClientImpl.java       |   51 +-
 .../impl/conf/ConsumerConfigurationData.java       |    3 +
 .../org/apache/pulsar/common/api/Commands.java     |   30 +
 .../apache/pulsar/common/api/PulsarDecoder.java    |   22 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 1077 ++++++++++++++++++++
 .../apache/pulsar/common/naming/NamespaceName.java |    1 -
 pulsar-common/src/main/proto/PulsarApi.proto       |   25 +-
 16 files changed, 1668 insertions(+), 12 deletions(-)

commit 83972e1d9067930b1c42e63b7b9db0f683d16c9c
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Feb 26 20:06:29 2018 -0800

    Enable multipart feature in pulsar admin and make a few fields protected to allow extension (#1293)

 pulsar-client-admin/pom.xml                        |  5 ++++
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  6 +++--
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   | 29 ++++++++++++++++------
 3 files changed, 30 insertions(+), 10 deletions(-)

commit fadb667a3da40de3e8a4b0312fad54bc8ee9aa6d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Feb 26 20:06:04 2018 -0800

    Update CLI documentation (WIP) (#1296)
    
    * add new flags on pulsar.yaml
    
    * add compact-topic command
    
    * add more commands

 site/_data/cli/pulsar-admin.yaml | 33 +++++++++++++++++++++++++++++----
 site/_data/cli/pulsar.yaml       | 20 +++++++++++++++++++-
 2 files changed, 48 insertions(+), 5 deletions(-)

commit fa4493b1c065133a89ab3a28eba7ddc715d98540
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Feb 26 19:03:41 2018 -0800

    Add a shaded module for pulsar-client-tools (#1294)

 pom.xml                            |   5 +-
 pulsar-client-tools-shaded/pom.xml | 179 +++++++++++++++++++++++++++++++++++++
 2 files changed, 182 insertions(+), 2 deletions(-)

commit 8a204998591a25db1def620bab7005407d635683
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Feb 26 16:39:30 2018 -0800

    Upgrade jersey version to 2.25 and powermock to 1.7.3 (#1274)
    
    * Upgrade jersey version to 2.26
    
    * Include inject dependency
    
    * Fix version parameter
    
    * add hk2
    
    * Jersey 2.26 doesn't allow unknown fields so fix the test case
    
    * Revert "Jersey 2.26 doesn't allow unknown fields so fix the test case"
    
    This reverts commit 82d530d6671f81c0de5ed18a06cbc124d612b4f8.
    
    * bump to 2.25

 pom.xml                                            | 33 +++++++++++-----------
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  2 +-
 pulsar-common/pom.xml                              |  1 +
 .../service/web/DiscoveryServiceWebTest.java       |  2 +-
 4 files changed, 20 insertions(+), 18 deletions(-)

commit 3739567c80c6b4999b2414c62a6ae99701fe6967
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Feb 26 16:11:25 2018 -0800

    Fix Terraform/Ansible docs (#1290)
    
    * remove separate BK systemd service
    
    * add tfvars file, reformat terraform configs, and update docs
    
    * update docs with --user=ec2-user flag
    
    * fix jq command in docs
    
    * update pulsar version in ansible playbook config
    
    * revert changes to .service files
    
    * revert ansible config

 .gitignore                                        |  3 ++-
 deployment/terraform-ansible/aws/ansible.cfg      |  3 +--
 deployment/terraform-ansible/aws/instances.tf     | 12 ++++++------
 deployment/terraform-ansible/aws/keys.tf          |  2 +-
 deployment/terraform-ansible/aws/network.tf       | 12 ++++++------
 deployment/terraform-ansible/aws/output.tf        |  2 +-
 deployment/terraform-ansible/aws/security.tf      |  2 +-
 deployment/terraform-ansible/aws/terraform.tfvars | 12 ++++++++++++
 deployment/terraform-ansible/aws/variables.tf     |  2 +-
 site/docs/latest/deployment/aws-cluster.md        |  8 +++++---
 10 files changed, 36 insertions(+), 22 deletions(-)

commit 9656c069ef2608e16b102c0b71cc9863e84cdc69
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Feb 26 21:43:18 2018 +0100

    Mavenize docker images (#1284)
    
    * Mavenize docker images
    
    Build pulsar docker images with maven. This will make it easier to
    pull them in as a base for the maven integration tests.
    
    I didn't touch the publish script, because it has handling for private
    registries which I wasn't able to test.
    
    * Fix licenses

 all/pom.xml                                        |   9 +-
 dashboard/pom.xml                                  |  93 ++++++++++++++++
 docker/build.sh                                    |  42 +------
 docker/grafana/pom.xml                             |  92 +++++++++++++++
 docker/pom.xml                                     |  42 +++++++
 docker/{ => pulsar}/Dockerfile                     |   6 +-
 docker/pulsar/pom.xml                              | 124 +++++++++++++++++++++
 .../{ => pulsar}/scripts/apply-config-from-env.py  |   0
 .../scripts/generate-zookeeper-config.sh           |   0
 .../{ => pulsar}/scripts/pulsar-zookeeper-ruok.sh  |   0
 10 files changed, 364 insertions(+), 44 deletions(-)

commit da64d0cdfbd320c2364d37b4d37d918889cda8e7
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Feb 26 21:42:55 2018 +0100

    Compaction uses GetLastMessageId (#1286)
    
    In two phase compaction, we read from the start of the topic to the
    end. Previously, we had no reliable way to knowing if we were at the
    end of the topic, so we used timeouts.
    
    However, with the new GetLastMessageId api, we can find how far we
    should read in a topic, and just stop when we get there.

 .../org/apache/pulsar/client/api/RawReader.java    |   6 ++
 .../apache/pulsar/client/impl/RawReaderImpl.java   |   5 +
 .../pulsar/compaction/TwoPhaseCompactor.java       |  45 ++++----
 .../apache/pulsar/client/impl/RawReaderTest.java   | 114 ++++++++++-----------
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 5 files changed, 92 insertions(+), 80 deletions(-)

commit 4f1f02b90252180fa513d4ad50fca5e23452de9f
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Feb 26 19:14:28 2018 +0100

    BatchMessageIdImpl can be compared to MessageIdImpl (#1285)
    
    A batch message id is a MessageIdImpl with a batchIndex >=
    0. Therefore, they can be compared to MessageIdImpl. If all fields
    other than the batchIndex are equal to a messageId, the
    BatchMessageIdImpl can compare its batchIndex with -1. If it is -1, it
    matches the MessageIdImpl. If it is greater than -1, then it is
    greater than the MessageIdImpl.

 .../pulsar/client/impl/BatchMessageIdImpl.java     | 31 ++++++++++++++--------
 .../pulsar/client/impl/MessageIdCompareToTest.java | 20 +++++++-------
 2 files changed, 29 insertions(+), 22 deletions(-)

commit c308bd5f81a1eb2c63d4d2dc3ddb652690a74bec
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 26 01:33:55 2018 -0800

    Fixed merge issues with DestinationName renaming (#1282)

 .../NonPersistentDispatcherSingleActiveConsumer.java      |  6 +++---
 .../broker/service/nonpersistent/NonPersistentTopic.java  | 11 ++++-------
 .../persistent/PersistentDispatcherMultipleConsumers.java |  8 ++++----
 .../PersistentDispatcherSingleActiveConsumer.java         | 15 +++++++--------
 .../pulsar/broker/service/persistent/PersistentTopic.java |  4 ++--
 .../apache/pulsar/broker/service/PersistentTopicTest.java | 13 +++++++------
 6 files changed, 27 insertions(+), 30 deletions(-)

commit c8d0a005c355934b2f101035f33d878f6f35269c
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Mon Feb 26 13:58:29 2018 +0900

    Add prefix setting for Java reader (#1272)

 .../apache/pulsar/client/api/ReaderBuilder.java    |  7 +++++++
 .../pulsar/client/api/ReaderConfiguration.java     | 22 +++++++++++++++++++++-
 .../pulsar/client/impl/ReaderBuilderImpl.java      |  6 ++++++
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  4 ++++
 .../client/impl/conf/ReaderConfigurationData.java  |  1 +
 5 files changed, 39 insertions(+), 1 deletion(-)

commit cd6f5396853f984e6fe60dad95b635cbdc7143dc
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Mon Feb 26 13:58:17 2018 +0900

    Add namespace policy for max clients (#1255)
    
    * Add namespace policy for max clients
    
    * Addressed PR comments

 .../pulsar/broker/admin/impl/NamespacesBase.java   | 124 +++++++++++++++++++
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  73 ++++++++++++
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  72 +++++++++++
 ...onPersistentDispatcherSingleActiveConsumer.java |  28 ++++-
 .../service/nonpersistent/NonPersistentTopic.java  |  12 +-
 .../PersistentDispatcherMultipleConsumers.java     |  28 ++++-
 .../PersistentDispatcherSingleActiveConsumer.java  |  29 ++++-
 .../broker/service/persistent/PersistentTopic.java |  12 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  86 +++++++++++---
 .../org/apache/pulsar/client/admin/Namespaces.java | 132 +++++++++++++++++++++
 .../client/admin/internal/NamespacesImpl.java      |  69 +++++++++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  88 ++++++++++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  22 ++++
 .../pulsar/common/policies/data/Policies.java      |  14 ++-
 14 files changed, 764 insertions(+), 25 deletions(-)

commit 6645341c4bda82655d2fbbc05938bd6d77820226
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Feb 25 20:57:54 2018 -0800

    Renamed destination to 'topic' in C++ code (#1281)

 pulsar-client-cpp/include/pulsar/Message.h         |   2 +-
 pulsar-client-cpp/include/pulsar/MessageBuilder.h  |   4 +-
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  |  63 ++++++-----
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |  14 +--
 pulsar-client-cpp/lib/ClientConnection.cc          |   9 +-
 pulsar-client-cpp/lib/ClientConnection.h           |   4 +-
 pulsar-client-cpp/lib/ClientImpl.cc                |  51 ++++-----
 pulsar-client-cpp/lib/ClientImpl.h                 |   8 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   2 +-
 pulsar-client-cpp/lib/HTTPLookupService.cc         |  21 ++--
 pulsar-client-cpp/lib/HTTPLookupService.h          |   2 +-
 pulsar-client-cpp/lib/LookupService.h              |  12 +--
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  20 ++--
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |   6 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  11 +-
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |   8 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              |   2 +-
 .../lib/{DestinationName.cc => TopicName.cc}       |  80 +++++++-------
 .../lib/{DestinationName.h => TopicName.h}         |  24 ++---
 pulsar-client-cpp/perf/PerfConsumer.cc             |   2 +-
 pulsar-client-cpp/python/pulsar.py                 |   8 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |   2 +-
 pulsar-client-cpp/tests/BatchMessageTest.cc        |   2 +-
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |   8 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |   2 +-
 pulsar-client-cpp/tests/DestinationNameTest.cc     | 117 ---------------------
 pulsar-client-cpp/tests/TopicNameTest.cc           | 110 +++++++++++++++++++
 27 files changed, 292 insertions(+), 302 deletions(-)

commit 5fc4d536d76b1d73c6be7b9238bf14b210ee095f
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Feb 25 20:57:40 2018 -0800

    Renamed DestinationName into TopicName (#1280)

 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |  20 +-
 .../authorization/AuthorizationProvider.java       |  39 +-
 .../broker/authorization/AuthorizationService.java | 154 ++++----
 .../authorization/PulsarAuthorizationProvider.java | 102 ++---
 .../org/apache/pulsar/broker/PulsarService.java    |  12 +-
 .../apache/pulsar/broker/admin/AdminResource.java  |  32 +-
 .../pulsar/broker/admin/impl/BrokerStatsBase.java  |   8 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   |  16 +-
 .../broker/admin/impl/PersistentTopicsBase.java    | 440 ++++++++++-----------
 .../pulsar/broker/admin/impl/PropertiesBase.java   |   2 +-
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  31 +-
 .../broker/admin/v1/NonPersistentTopics.java       |  71 ++--
 .../pulsar/broker/admin/v1/PersistentTopics.java   | 172 ++++----
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  22 +-
 .../broker/admin/v2/NonPersistentTopics.java       |  68 ++--
 .../pulsar/broker/admin/v2/PersistentTopics.java   | 166 ++++----
 .../loadbalance/impl/SimpleLoadCalculatorImpl.java |   2 +-
 .../{DestinationLookup.java => TopicLookup.java}   |  78 ++--
 .../pulsar/broker/namespace/NamespaceService.java  |  54 +--
 .../pulsar/broker/service/AbstractReplicator.java  |  22 +-
 .../pulsar/broker/service/BacklogQuotaManager.java |   6 +-
 .../pulsar/broker/service/BrokerService.java       |  65 ++-
 .../org/apache/pulsar/broker/service/Consumer.java |  11 +-
 .../org/apache/pulsar/broker/service/Producer.java |  10 +-
 .../apache/pulsar/broker/service/PulsarStats.java  |  10 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  20 +-
 .../apache/pulsar/broker/service/Subscription.java |   2 +-
 .../nonpersistent/NonPersistentSubscription.java   |   6 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  86 ++--
 .../service/persistent/CompactorSubscription.java  |   2 +-
 .../service/persistent/DispatchRateLimiter.java    |   6 +-
 .../service/persistent/MessageDeduplication.java   |   4 +-
 .../service/persistent/PersistentSubscription.java |   6 +-
 .../broker/service/persistent/PersistentTopic.java | 136 +++----
 .../broker/stats/BookieClientStatsGenerator.java   |  16 +-
 .../pulsar/broker/stats/MetricsGenerator.java      |   2 +-
 .../broker/stats/metrics/AbstractMetrics.java      |  14 +-
 .../broker/stats/metrics/ManagedLedgerMetrics.java |  16 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  34 +-
 .../pulsar/common/naming/NamespaceBundle.java      |   8 +-
 .../pulsar/common/naming/NamespaceBundles.java     |  10 +-
 .../apache/pulsar/broker/SLAMonitoringTest.java    |  20 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  58 +--
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  16 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  22 +-
 .../broker/admin/CreateSubscriptionTest.java       |   4 +-
 .../broker/admin/IncrementPartitionsTest.java      |   4 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |  20 +-
 .../pulsar/broker/auth/AuthorizationTest.java      | 158 ++++----
 .../broker/loadbalance/LoadBalancerTest.java       |  24 +-
 ...ookupv2Test.java => HttpTopicLookupv2Test.java} |  20 +-
 .../broker/namespace/NamespaceServiceTest.java     |  30 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |  30 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |  22 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   4 +-
 .../broker/service/PersistentFailoverE2ETest.java  |   4 +-
 .../service/PersistentTopicConcurrentTest.java     |   4 +-
 .../broker/service/PersistentTopicE2ETest.java     |  18 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   6 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  36 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |  18 +-
 .../pulsar/broker/service/ServerCnxTest.java       |  24 +-
 .../zookeeper/ZooKeeperClientAspectJTest.java      |   4 +-
 .../api/AuthenticatedProducerConsumerTest.java     |   6 +-
 .../api/AuthorizationProducerConsumerTest.java     |  50 +--
 .../pulsar/client/api/BrokerServiceLookupTest.java |  30 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |  18 +-
 .../api/PartitionedProducerConsumerTest.java       |  97 +++--
 .../client/api/SimpleProducerConsumerTest.java     |   8 +-
 .../client/impl/BrokerClientIntegrationTest.java   |  28 +-
 .../pulsar/common/naming/NamespaceBundleTest.java  |  14 +-
 .../pulsar/common/naming/NamespaceBundlesTest.java |  26 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |  26 +-
 .../apache/pulsar/client/admin/BrokerStats.java    |  12 +-
 .../org/apache/pulsar/client/admin/Lookup.java     |  21 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |  34 +-
 .../pulsar/client/admin/NonPersistentTopics.java   |  72 ++--
 .../pulsar/client/admin/PersistentTopics.java      | 294 +++++++-------
 .../org/apache/pulsar/client/admin/Properties.java |   2 +-
 .../apache/pulsar/client/admin/PulsarAdmin.java    |   6 +-
 .../client/admin/internal/BrokerStatsImpl.java     |   2 +-
 .../pulsar/client/admin/internal/LookupImpl.java   |  14 +-
 .../client/admin/internal/NamespacesImpl.java      |   2 +-
 .../admin/internal/NonPersistentTopicsImpl.java    |  48 +--
 .../admin/internal/PersistentTopicsImpl.java       | 194 ++++-----
 .../clients/consumer/PulsarKafkaConsumer.java      |  10 +-
 .../org/apache/pulsar/admin/cli/CliCommand.java    |  26 +-
 .../apache/pulsar/admin/cli/CmdBrokerStats.java    |  10 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  11 +-
 .../pulsar/admin/cli/CmdNonPersistentTopics.java   |  20 +-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  84 ++--
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  10 +-
 .../client/impl/BinaryProtoLookupService.java      |  30 +-
 .../pulsar/client/impl/HttpLookupService.java      |  14 +-
 .../apache/pulsar/client/impl/LookupService.java   |  10 +-
 .../client/impl/PartitionedConsumerImpl.java       |   4 +-
 .../client/impl/PartitionedProducerImpl.java       |   4 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  20 +-
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  28 +-
 .../apache/pulsar/common/naming/NamedEntity.java   |   2 +-
 .../apache/pulsar/common/naming/NamespaceName.java |  18 +-
 .../apache/pulsar/common/naming/ServiceUnitId.java |   8 +-
 .../{DestinationDomain.java => TopicDomain.java}   |   8 +-
 .../{DestinationName.java => TopicName.java}       | 104 ++---
 .../pulsar/common/naming/NamespaceNameTest.java    |  10 +-
 ...DestinationNameTest.java => TopicNameTest.java} | 130 +++---
 .../discovery/service/BrokerDiscoveryProvider.java |  22 +-
 .../pulsar/discovery/service/ServerConnection.java |  10 +-
 .../discovery/service/DiscoveryServiceTest.java    |   6 +-
 .../proxy/server/BrokerDiscoveryProvider.java      |  22 +-
 .../pulsar/proxy/server/LookupProxyHandler.java    |  18 +-
 .../proxy/socket/client/PerformanceClient.java     |  10 +-
 .../pulsar/testclient/LoadSimulationClient.java    |   8 +-
 .../testclient/LoadSimulationController.java       |  70 ++--
 .../pulsar/testclient/PerformanceConsumer.java     |  24 +-
 .../pulsar/testclient/PerformanceProducer.java     |   8 +-
 .../pulsar/testclient/PerformanceReader.java       |  16 +-
 .../pulsar/websocket/AbstractWebSocketHandler.java |   6 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |   4 +-
 .../apache/pulsar/websocket/ProducerHandler.java   |   4 +-
 .../org/apache/pulsar/websocket/ReaderHandler.java |   4 +-
 .../websocket/admin/WebSocketProxyStats.java       |  18 +-
 .../websocket/admin/WebSocketWebResource.java      |   6 +-
 .../apache/pulsar/websocket/stats/ProxyStats.java  |   6 +-
 124 files changed, 2172 insertions(+), 2182 deletions(-)

commit 1a1a6e3b06711248663b3a960c302c9dc2bf02e6
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 24 09:14:08 2018 -0800

    Refactored ClientConfuguration to use ClientConfigurationData shared with ClientBuilderImpl (#1276)
    
    * Refactored ClientConfuguration to use ClientConfigurationData shared with ClientBuilderImpl
    
    * Fixed unit tests
    
    * Fixed cloning issue after refactoring
    
    * Fixed another test
    
    * Fixed cloning issues
    
    * Fixes for mock tests
    
    * Fixed refactoring problem in TopicsConsumerImpl

 pom.xml                                            |  11 +-
 .../apache/pulsar/client/impl/RawMessageImpl.java  |   1 -
 .../apache/pulsar/client/impl/RawReaderImpl.java   |  41 ++---
 .../pulsar/broker/service/PersistentTopicTest.java |   8 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   3 +-
 .../pulsar/client/impl/ConnectionPoolTest.java     |  12 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |   9 +-
 .../pulsar/client/api/ClientConfiguration.java     | 119 ++++++------
 .../pulsar/client/api/ConsumerConfiguration.java   | 120 ++++++------
 .../apache/pulsar/client/api/HashingScheme.java    |  37 ++++
 .../pulsar/client/api/MessageRoutingMode.java      |  21 ++-
 .../apache/pulsar/client/api/ProducerBuilder.java  |  30 ++-
 .../pulsar/client/api/ProducerConfiguration.java   | 140 +++++---------
 .../pulsar/client/api/ReaderConfiguration.java     |  35 ++--
 .../client/impl/BinaryProtoLookupService.java      |   1 -
 .../pulsar/client/impl/ClientBuilderImpl.java      |  39 ++--
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  18 +-
 .../apache/pulsar/client/impl/ConnectionPool.java  |   4 +-
 .../apache/pulsar/client/impl/ConsumerBase.java    |  24 ++-
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  59 +++---
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  27 +--
 .../apache/pulsar/client/impl/ConsumerStats.java   |   6 +-
 .../org/apache/pulsar/client/impl/HttpClient.java  |  24 ++-
 .../pulsar/client/impl/HttpLookupService.java      |   6 +-
 .../apache/pulsar/client/impl/MessageCrypto.java   |  42 ++---
 .../pulsar/client/impl/MessageRouterBase.java      |  18 +-
 .../client/impl/PartitionedConsumerImpl.java       |  21 ++-
 .../client/impl/PartitionedProducerImpl.java       |   8 +-
 .../apache/pulsar/client/impl/ProducerBase.java    |  11 +-
 .../pulsar/client/impl/ProducerBuilderImpl.java    |  45 +++--
 .../apache/pulsar/client/impl/ProducerImpl.java    |  25 ++-
 .../apache/pulsar/client/impl/ProducerStats.java   |   6 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 202 +++++++++++++--------
 .../pulsar/client/impl/ReaderBuilderImpl.java      |  23 +--
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  19 +-
 .../impl/RoundRobinPartitionMessageRouterImpl.java |   7 +-
 .../impl/SinglePartitionMessageRouterImpl.java     |   6 +-
 .../pulsar/client/impl/TopicsConsumerImpl.java     |  52 +++---
 .../client/impl/conf/ClientConfigurationData.java  |  64 +++++++
 .../impl/conf/ConsumerConfigurationData.java       |  91 ++++++++++
 .../impl/conf/ProducerConfigurationData.java       |  97 ++++++++++
 .../client/impl/conf/ReaderConfigurationData.java  |  52 ++++++
 .../client/api/ConsumerConfigurationTest.java      |  34 ++--
 .../apache/pulsar/client/impl/BuildersTest.java    |   7 +-
 .../apache/pulsar/client/impl/ClientCnxTest.java   |   7 +-
 .../RoundRobinPartitionMessageRouterImplTest.java  |   6 +-
 .../impl/SinglePartitionMessageRouterImplTest.java |   6 +-
 47 files changed, 1015 insertions(+), 629 deletions(-)

commit a72c91294aa8ec8546652606a5300ca0b47858f6
Author: XiaoZYang <XiaoZYang@users.noreply.github.com>
Date:   Sat Feb 24 07:25:00 2018 +0800

    Pulsar FAQ (#1186)
    
    * 1. add faq.md
    
    * 1.add initializeSubscriptionOnLatest in ConsumerConfiguration to initialize cursor when subscription initialized
    
    * Revert "1.add initializeSubscriptionOnLatest in ConsumerConfiguration to initialize cursor when subscription initialized"
    
    This reverts commit 8747966a5e5a3fea50b4a5ba010ef92790868f2e.

 faq.md | 273 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 273 insertions(+)

commit 2f1ef0b8fff120224fb00fb28134905b8185a3b8
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Feb 23 15:23:53 2018 -0800

    Improve retention and expiry documentation (WIP) (#1172)
    
    * add retention/expiry diagram
    
    * add color for $ in bash snippets
    
    * modify colors in diagram
    
    * alter diagram colors once again

 site/_sass/_syntax.scss                            |   4 ++++
 .../getting-started/ConceptsAndArchitecture.md     |  24 ++++++++++++++++++++-
 site/img/retention-expiry.png                      | Bin 0 -> 113741 bytes
 3 files changed, 27 insertions(+), 1 deletion(-)

commit 7eb1002f35fc5ba3cb75d90b307215cf2290f98a
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Sat Feb 24 07:54:46 2018 +0900

    allow superuser to consume without subscription_auth_mode check (#1273)

 .../apache/pulsar/broker/authorization/PulsarAuthorizationProvider.java | 2 +-
 .../src/test/java/org/apache/pulsar/broker/auth/AuthorizationTest.java  | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

commit adbf818626988f4cd3cf008462d173b440d4c1ba
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sat Feb 24 07:54:07 2018 +0900

    Change HTTP status code which WebSocket proxy returns to producer whe (#1242)
    
    * Change HTTP status code which WebSocket proxy returns to producer when backlog exceeds threshold
    
    * Fix WebSocket proxy to return exception message to client
    
    * Add some tests for WebSocket

 .../websocket/proxy/ProxyPublishConsumeTest.java   | 206 +++++++++++++++++----
 .../pulsar/websocket/AbstractWebSocketHandler.java |   5 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |  39 ++--
 .../apache/pulsar/websocket/ProducerHandler.java   |   6 +-
 .../org/apache/pulsar/websocket/ReaderHandler.java |   5 +-
 5 files changed, 207 insertions(+), 54 deletions(-)

commit c351026076e0320336c9e1fb0c5c888ed47f7874
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Feb 23 11:01:25 2018 -0800

     Separating configuration for client and server trust store (#1246)
    
    * Use brokerClientTlsTrustCertsFilePath to configure the trust file path for outgoing connection to a broker
    
    * Separating configuration for client and server trust store
    
    * Addressed Matteo's PR Comments

 conf/broker.conf                                   |  1 +
 conf/proxy.conf                                    |  1 +
 conf/websocket.conf                                |  1 +
 .../apache/pulsar/broker/ServiceConfiguration.java | 12 +++-
 .../pulsar/broker/service/BrokerService.java       |  2 +-
 .../proxy/ProxyPublishConsumeTlsTest.java          |  1 +
 .../pulsar/proxy/server/DirectProxyHandler.java    |  4 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    | 31 ++++++----
 .../apache/pulsar/proxy/server/ProxyService.java   |  2 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |  5 +-
 ...est.java => ProxyWithAuthorizationNegTest.java} | 40 ++++++------
 ...onTest.java => ProxyWithAuthorizationTest.java} | 46 +++++++-------
 .../server/ProxyWithoutServiceDiscoveryTest.java   |  2 +
 .../ProxyWithAuthorizationTest/broker-cacert.pem   | 62 +++++++++++++++++++
 .../tls/ProxyWithAuthorizationTest/broker-cert.pem | 72 ++++++++++++++++++++++
 .../tls/ProxyWithAuthorizationTest/broker-key.pem  | 28 +++++++++
 .../ProxyWithAuthorizationTest/client-cacert.pem   | 62 +++++++++++++++++++
 .../tls/ProxyWithAuthorizationTest/client-cert.pem | 72 ++++++++++++++++++++++
 .../tls/ProxyWithAuthorizationTest/client-key.pem  | 28 +++++++++
 .../ProxyWithAuthorizationTest/proxy-cacert.pem    | 62 +++++++++++++++++++
 .../tls/ProxyWithAuthorizationTest/proxy-cert.pem  | 72 ++++++++++++++++++++++
 .../tls/ProxyWithAuthorizationTest/proxy-key.pem   | 28 +++++++++
 .../broker-cert.pem                                | 72 ----------------------
 .../ProxyWithProxyAuthorizationTest/broker-key.pem | 28 ---------
 .../tls/ProxyWithProxyAuthorizationTest/cacert.pem | 62 -------------------
 .../client-cert.pem                                | 72 ----------------------
 .../ProxyWithProxyAuthorizationTest/client-key.pem | 28 ---------
 .../ProxyWithProxyAuthorizationTest/proxy-cert.pem | 72 ----------------------
 .../ProxyWithProxyAuthorizationTest/proxy-key.pem  | 28 ---------
 .../apache/pulsar/websocket/WebSocketService.java  |  2 +-
 .../pulsar/websocket/service/ProxyServer.java      |  1 -
 .../service/WebSocketProxyConfiguration.java       | 37 ++++++++---
 32 files changed, 602 insertions(+), 434 deletions(-)

commit 21d3307b7ba9575ff174165cb060b8be26619157
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Feb 23 10:49:37 2018 -0800

    Upgrade to log4j2 dependency and configuration (#680)
    
    * Add log4j2 dependency and configuration
    
    * add yamal configuration
    
    * Add more roll-over-file configuration + log4j2-web module

 .gitignore                      |  2 +-
 all/pom.xml                     | 28 +++++++++++--
 bin/bookkeeper                  | 10 ++---
 bin/pulsar                      |  8 ++--
 bin/pulsar-admin                |  8 ++--
 bin/pulsar-client               |  8 ++--
 bin/pulsar-daemon               |  4 +-
 bin/pulsar-perf                 |  8 ++--
 conf/log4j.properties           | 73 --------------------------------
 conf/log4j.shell.properties     | 39 -----------------
 conf/log4j2-scripts/filter.js   | 33 +++++++++++++++
 conf/log4j2.yaml                | 93 +++++++++++++++++++++++++++++++++++++++++
 pom.xml                         | 41 +++++++++++++++---
 site/_data/cli/bookkeeper.yaml  |  2 +-
 site/_data/cli/pulsar-perf.yaml |  2 +-
 site/_data/cli/pulsar.yaml      |  2 +-
 16 files changed, 213 insertions(+), 148 deletions(-)

commit e581d95b5e260bef7c0bda697ded0c2eb5211a52
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 23 09:35:06 2018 -0800

    Added ManagedLedger perf tool (#1270)

 bin/pulsar-perf                                    |  15 +-
 .../pulsar/testclient/ManagedLedgerWriter.java     | 332 +++++++++++++++++++++
 2 files changed, 341 insertions(+), 6 deletions(-)

commit f38a003a2a8331da94996fc7ea871abfc779ae24
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Feb 22 18:30:58 2018 -0800

    Broker should not start replicator for root partitioned-topic (#1262)
    
    * Broker should not start replicator for root partitioned-topic
    
    * address comment

 .../pulsar/broker/service/AbstractReplicator.java  | 51 +++++++++++++--
 .../pulsar/broker/service/BrokerService.java       | 53 +++++++++-------
 .../nonpersistent/NonPersistentReplicator.java     |  3 +-
 .../service/nonpersistent/NonPersistentTopic.java  | 35 +++++++++--
 .../service/persistent/PersistentReplicator.java   |  3 +-
 .../broker/service/persistent/PersistentTopic.java | 39 ++++++++++--
 .../pulsar/broker/service/ReplicatorTest.java      | 72 ++++++++++++++++++++++
 .../pulsar/broker/service/ReplicatorTestBase.java  |  3 +
 8 files changed, 220 insertions(+), 39 deletions(-)

commit 68cd1154e9581bb8503eeee2da5a8e1d44336b25
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Feb 22 11:38:59 2018 -0800

    Issue #1237: support builder for topicsConsumer (#1269)
    
    * support builder for topicsConsumer
    
    * change following @Matteo's comments to remove subscribe methods in client
    
    * change to topic(String ... names) for consumer builder
    
    * change following @sijie's comments

 .../pulsar/client/impl/TopicsConsumerImplTest.java | 197 +++++++++++++++------
 .../apache/pulsar/client/api/ConsumerBuilder.java  |  16 +-
 .../org/apache/pulsar/client/api/PulsarClient.java |  57 ------
 .../pulsar/client/impl/ConsumerBuilderImpl.java    |  41 ++++-
 .../pulsar/client/impl/PulsarClientImpl.java       |  32 ----
 5 files changed, 186 insertions(+), 157 deletions(-)

commit 7b07fce3ccf633f705b5bbe1de3248c5abdcac10
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Feb 22 11:06:19 2018 -0800

    Add get-peer clusters admin api (#1268)

 .../pulsar/broker/admin/impl/ClustersBase.java     | 22 +++++++++++++++++++++
 .../pulsar/broker/service/PeerReplicatorTest.java  | 19 ++++++++++++++++++
 .../org/apache/pulsar/client/admin/Clusters.java   | 23 ++++++++++++++++++++++
 .../pulsar/client/admin/internal/ClustersImpl.java | 10 ++++++++++
 .../org/apache/pulsar/admin/cli/CmdClusters.java   | 14 +++++++++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  3 +++
 6 files changed, 91 insertions(+)

commit d073a7c874c391731d703f86ce13849ee7312f0e
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Feb 21 14:15:40 2018 -0800

    PIP-13-1/3: Provide `TopicsConsumer` to consume from several topics under same namespace (#1103)
    
    * add TopicsConsumerImpl and some test
    
    * fix license header check, add get method, and fix unit-test fail
    
    * add subscribe and unsubscribe for one topic, add tests
    
    * change to use subscribeAsync(topic) to subscribe topics in init
    
    * change following comments
    
    * rebase master, fix compile issue

 .../broker/service/PersistentQueueE2ETest.java     |   4 +-
 .../pulsar/client/impl/TopicsConsumerImplTest.java | 522 +++++++++++++
 .../org/apache/pulsar/client/api/PulsarClient.java |  57 ++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  13 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  11 +-
 .../client/impl/PartitionedConsumerImpl.java       |  15 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  65 ++
 .../pulsar/client/impl/TopicMessageIdImpl.java     |  49 ++
 .../pulsar/client/impl/TopicMessageImpl.java       | 101 +++
 .../pulsar/client/impl/TopicsConsumerImpl.java     | 823 +++++++++++++++++++++
 .../pulsar/client/impl/UnAckedMessageTracker.java  |  44 +-
 .../client/impl/UnAckedTopicMessageTracker.java    |  49 ++
 12 files changed, 1712 insertions(+), 41 deletions(-)

commit 6de26521ecb952ab5e5a19a079bc773ee0dd409c
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Feb 21 20:59:26 2018 +0100

    Compaction CLI tool (#1257)
    
    * Compaction CLI tool
    
    CLI tool to run compaction on a topic. This can only be run by the
    administrator. It runs with the same configuration as the broker.
    
    * Only require broker configuration
    
    * Add some help and fix typo in bin/pulsar

 bin/pulsar                                         |   3 +
 .../apache/pulsar/compaction/CompactorTool.java    | 125 +++++++++++++++++++++
 2 files changed, 128 insertions(+)

commit 3dbfb686bc699cb7a9a7c2eaa1cd364db3cd5c51
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Feb 21 08:37:15 2018 -0800

    Fixed Lookup redirect logic on Proxy side (#1265)

 .../main/java/org/apache/pulsar/proxy/server/LookupProxyHandler.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit eab0db90beac8ebe4ddcb4ad323b93b33569a6bb
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Feb 20 20:04:20 2018 -0800

    Fix in ServerCnx to prevent using recycled commands (#1264)

 .../org/apache/pulsar/broker/service/ServerCnx.java  | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

commit 8d9f277cd4e3cb045ad971eb8fbe363d62d347b2
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 20 17:48:02 2018 -0800

    Add JsonIgnore to a few fields in configuration objects (#1260)
    
    *Problem*
    
    We have seen NPE thrown when `ConsumerStats` tries to dump the configuration object with a customized ConsumerEventsListener.
    The problem came from initialization sequence and when jackson tried to serialize the customized ConsumerEventsListener,
    it fails with NPE.
    
    In general, those customized implementation such as `MessageRouter`, `MessageListener` and `ConsumerEventsListener` are not
    really needed to serialize as part of json.
    
    *Solution*
    
    Add @JsonIgnore to those fields to bypass json serialization

 .../pulsar/client/api/ClientConfiguration.java     |  2 +
 .../pulsar/client/api/ConsumerConfiguration.java   |  4 ++
 .../pulsar/client/api/ProducerConfiguration.java   |  4 ++
 .../client/api/ConsumerConfigurationTest.java      | 68 ++++++++++++++++++++++
 4 files changed, 78 insertions(+)

commit 1061906b6a2313cfc23ed31eae984ad3b430c33e
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Feb 20 15:01:42 2018 -0800

    Use advertisedAddress for bookies in pulsar standalone (#1254)
    
    * Use advertisedAddress for bookies in pulsar standalone (#233)
    
    * Use advertised address for zookeeper server in standalone as well

 .../java/org/apache/pulsar/PulsarStandaloneStarter.java  | 11 +++++++----
 .../apache/pulsar/zookeeper/LocalBookkeeperEnsemble.java | 11 +++++++++--
 .../pulsar/zookeeper/LocalBookkeeperEnsembleTest.java    | 16 ++++++++++++++++
 3 files changed, 32 insertions(+), 6 deletions(-)

commit de06bd433fc501b98fd5e57404ba9bba7325ff29
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Feb 21 02:53:45 2018 +0900

    Fix bug that consumer which specify incorrect subscription hangs up w (#1256)
    
    * Fix bug that consumer which specify incorrect subscription hangs up when subscription_auth_mode is Prefix
    
    * Add test for subscription prefix authorization

 .../apache/pulsar/broker/service/ServerCnx.java    | 10 ++++
 .../api/AuthorizationProducerConsumerTest.java     | 60 ++++++++++++++++++++++
 2 files changed, 70 insertions(+)

commit c03943ae8bdd597b2619766a96233e4a35f49344
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Feb 19 17:44:41 2018 -0800

    Add REST api to check host-status for adding/removing from vip (#1241)
    
    * Add REST api to check host-status for adding/removing from vip
    
    * move vipStatus to common place
    
    * address comment

 conf/proxy.conf                                    |  4 ++++
 conf/websocket.conf                                |  4 ++++
 pom.xml                                            |  6 +++++
 pulsar-broker-common/pom.xml                       |  6 +++++
 .../pulsar/common/configuration}/VipStatus.java    | 27 ++++++++++++++--------
 .../org/apache/pulsar/broker/PulsarService.java    | 25 +++++++++++++-------
 .../org/apache/pulsar/broker/web/WebService.java   | 13 +++++++----
 .../pulsar/proxy/server/ProxyConfiguration.java    | 12 ++++++++++
 .../pulsar/proxy/server/ProxyServiceStarter.java   | 11 +++++----
 .../org/apache/pulsar/proxy/server/WebServer.java  | 19 +++++++++++++++
 .../pulsar/websocket/service/ProxyServer.java      |  6 ++---
 .../service/WebSocketProxyConfiguration.java       | 12 ++++++++++
 .../websocket/service/WebSocketServiceStarter.java |  6 ++++-
 13 files changed, 120 insertions(+), 31 deletions(-)

commit 4f1dc52c7eeb77222bf1b6c39074c1df624e15d3
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 19 10:43:45 2018 -0800

    Fix lookup problem with partions in a non-persistent topics (#1251)

 .../broker/admin/impl/PersistentTopicsBase.java    |  4 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  | 50 ++++++++++++++++++++++
 2 files changed, 52 insertions(+), 2 deletions(-)

commit 8d04a42e4cb0e862f0346ead98c228b881cfef53
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Feb 19 18:12:00 2018 +0100

    Read from compacted topic ledger if available and enabled (#1231)
    
    * Read from compacted topic ledger if available and enabled
    
    If a topic has been compacted and the client has enabled reads from
    compacted topics, try to read from the compacted ledger if the cursor
    position lands before or within the range of message IDs in the
    compacted topic ledger. If the cursor position lands after the message
    IDs, in the compacted topic ledger, read from the cursor as normal.
    
    * fixup mocks in tests

 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |   2 +-
 .../pulsar/broker/ManagedLedgerClientFactory.java  |   4 +
 .../org/apache/pulsar/broker/PulsarService.java    |   5 +
 .../PersistentDispatcherSingleActiveConsumer.java  |   6 +-
 .../broker/service/persistent/PersistentTopic.java |   4 +-
 .../apache/pulsar/compaction/CompactedTopic.java   |   4 +
 .../pulsar/compaction/CompactedTopicImpl.java      | 119 +++++++-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   6 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   2 +
 .../pulsar/broker/service/PersistentTopicTest.java |   2 +
 .../pulsar/broker/service/ServerCnxTest.java       |   2 +
 .../apache/pulsar/compaction/CompactionTest.java   | 309 +++++++++++++++++++++
 12 files changed, 457 insertions(+), 8 deletions(-)

commit 3d5d76088819dad653d516de85b951051b2772fd
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Mon Feb 19 21:51:09 2018 +0900

    Refactor SecurityUtility class (#1245)

 .../apache/pulsar/common/util/SecurityUtility.java | 120 +++++++++++++--------
 1 file changed, 74 insertions(+), 46 deletions(-)

commit 27d87d82461be234e9c6be1097ae0574234d7e9d
Author: cckellogg <cckellogg@gmail.com>
Date:   Sun Feb 18 22:46:55 2018 -0800

    Fix znode path creation for proxies. (#1249)

 .../org/apache/pulsar/discovery/service/BrokerDiscoveryProvider.java  | 4 ++--
 .../java/org/apache/pulsar/proxy/server/BrokerDiscoveryProvider.java  | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 42b9c569d2bbc8b626b63a9b3f046f94754c0ba3
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Sun Feb 18 09:32:19 2018 -0800

    Fix redirect url on proxy to honor TLS (#1243)

 .../java/org/apache/pulsar/proxy/server/LookupProxyHandler.java     | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

commit 212d03f7c938f7fce86684206d53e690fdcd6774
Author: cckellogg <cckellogg@gmail.com>
Date:   Sun Feb 18 09:07:13 2018 -0800

    Fix broker conf comments (#1247)
    
    * Fix broker conf comments.
    
    Comments should start with # and not //
    
    * Fix standalone conf comments.

 conf/broker.conf     | 18 +++++++++---------
 conf/standalone.conf | 18 +++++++++---------
 2 files changed, 18 insertions(+), 18 deletions(-)

commit cb5eb5b671316bf200202b5b410b1438f2cde98b
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 17 12:22:47 2018 -0800

    PIP-12 Introduce builder for creating Producer Consumer Reader (#1089)
    
    * PIP-12: Introduce builders for creating Producer Consumer Reader
    
    * Fixed Javadocs
    
    * Addressed comments

 .../pulsar/broker/service/AbstractReplicator.java  |  21 +-
 .../nonpersistent/NonPersistentReplicator.java     |   2 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   6 +-
 .../apache/pulsar/client/api/ClientBuilder.java    | 265 ++++++++++++++++++++
 .../pulsar/client/api/ClientConfiguration.java     |  10 +-
 .../apache/pulsar/client/api/ConsumerBuilder.java  | 245 +++++++++++++++++++
 .../pulsar/client/api/ConsumerConfiguration.java   |   3 +-
 .../apache/pulsar/client/api/CryptoKeyReader.java  |  39 ++-
 .../apache/pulsar/client/api/MessageRouter.java    |   3 +-
 .../pulsar/client/api/MessageRoutingMode.java      |  23 ++
 .../apache/pulsar/client/api/ProducerBuilder.java  | 272 +++++++++++++++++++++
 .../pulsar/client/api/ProducerConfiguration.java   |  23 +-
 .../org/apache/pulsar/client/api/PulsarClient.java |  81 +++++-
 .../apache/pulsar/client/api/ReaderBuilder.java    | 140 +++++++++++
 .../pulsar/client/api/ReaderConfiguration.java     |  10 +-
 .../pulsar/client/impl/ClientBuilderImpl.java      | 154 ++++++++++++
 .../pulsar/client/impl/ConsumerBuilderImpl.java    | 176 +++++++++++++
 .../pulsar/client/impl/ProducerBuilderImpl.java    | 194 +++++++++++++++
 .../pulsar/client/impl/PulsarClientImpl.java       |  23 +-
 .../pulsar/client/impl/ReaderBuilderImpl.java      | 132 ++++++++++
 .../apache/pulsar/client/api/MessageIdTest.java    |  16 +-
 .../apache/pulsar/client/impl/BuildersTest.java    |  47 ++++
 .../pulsar/client/tutorial/SampleProducer.java     |   6 +-
 23 files changed, 1815 insertions(+), 76 deletions(-)

commit d5a4bb0e44632707a96b2260e2ecddb24c1b8d9d
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Feb 17 16:00:42 2018 +0800

    Add a `internalConfiguration` admin restful endpoint for query internal configuration (#1223)

 .../pulsar/broker/admin/impl/BrokersBase.java      | 13 ++++
 .../org/apache/pulsar/broker/admin/AdminTest.java  | 12 ++++
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  1 +
 .../org/apache/pulsar/client/admin/Brokers.java    |  7 ++
 .../pulsar/client/admin/internal/BrokersImpl.java  | 10 +++
 .../org/apache/pulsar/admin/cli/CmdBrokers.java    | 11 +++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  5 +-
 .../common/conf/InternalConfigurationData.java     | 78 ++++++++++++++++++++++
 8 files changed, 136 insertions(+), 1 deletion(-)

commit 32f26ec232d201c9f83f68898099b4a36368b6e1
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Feb 16 22:08:38 2018 -0800

    Created new certs which will expire after ten years (#1244)

 .../resources/authentication/tls/broker-cert.pem   | 101 +++++++++++----------
 .../resources/authentication/tls/broker-key.pem    |  52 +++++------
 .../test/resources/authentication/tls/cacert.pem   |  84 ++++++++---------
 .../resources/authentication/tls/client-cert.pem   | 101 +++++++++++----------
 .../resources/authentication/tls/client-key.pem    |  52 +++++------
 .../test/resources/authentication/tls/cacert.pem   |  84 ++++++++---------
 .../resources/authentication/tls/client-cert.pem   | 101 +++++++++++----------
 .../resources/authentication/tls/client-key.pem    |  52 +++++------
 .../resources/authentication/tls/server-cert.pem   | 101 +++++++++++----------
 .../resources/authentication/tls/server-key.pem    |  52 +++++------
 10 files changed, 392 insertions(+), 388 deletions(-)

commit f2160c01e3581f0e8374db5d4d713810de7533af
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Feb 15 12:12:00 2018 +0800

    Introduce ActiveConsumerListener for realizing if a consumer is active in a failover subscription group (#1156)
    
    * Introduce ConsumerGroupListener for realizing if a consumer is active in a failover subscription group
    
    * Rename ConsumerGroupListener to ActiveConsumerListener
    
    * Fail subscribe if active consumer listener is provided with non-failover subscription.
    
    * Notify consumer state change only after the cursor is rewinded.
    
    * Address comments
    
    * Rename ActiveConsumerListener to ConsumerEventListener
    Use consumer object as identifier for comparison
    
    * Fix test after rebase
    
    * Fix license headers
    
    * Ignore active consumer change command in cpp client
    
    * rename "become" to "became"

 .../AbstractDispatcherSingleActiveConsumer.java    |  38 +-
 .../org/apache/pulsar/broker/service/Consumer.java |  15 +
 .../PersistentDispatcherSingleActiveConsumer.java  |  10 +-
 .../PersistentDispatcherFailoverConsumerTest.java  | 157 ++++++-
 .../broker/service/PersistentFailoverE2ETest.java  |  96 +++-
 pulsar-client-cpp/lib/ClientConnection.cc          |   7 +
 pulsar-client-cpp/lib/Commands.cc                  |   3 +
 .../pulsar/client/api/ConsumerConfiguration.java   |  29 ++
 .../pulsar/client/api/ConsumerEventListener.java   |  36 ++
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  14 +
 .../apache/pulsar/client/impl/ConsumerBase.java    |   3 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  14 +
 .../client/impl/PartitionedConsumerImpl.java       |   4 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   7 +
 .../org/apache/pulsar/common/api/Commands.java     |  18 +
 .../apache/pulsar/common/api/PulsarDecoder.java    |  11 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 486 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  12 +-
 .../pulsar/common/api/PulsarDecoderTest.java       |  60 +++
 19 files changed, 993 insertions(+), 27 deletions(-)

commit 350d2973703f99f3a36e6a56a4348a6b76415c3f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Feb 14 16:29:37 2018 -0800

    add httpcore dep required by httpclient in hostname-verification (#1239)

 all/src/assemble/LICENSE.bin.txt                       | 1 +
 pulsar-broker-shaded/pom.xml                           | 7 +++++++
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml | 9 +++++++++
 pulsar-client-shaded/pom.xml                           | 7 +++++++
 pulsar-client/pom.xml                                  | 7 ++++++-
 5 files changed, 30 insertions(+), 1 deletion(-)

commit 5613c2b92f6b7989d6a4c65e259713953e933e8f
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu Feb 15 08:00:23 2018 +0900

    Make max clients per topic/subscription configurable (#1234)

 conf/broker.conf                                   |  15 ++
 conf/standalone.conf                               |  15 ++
 .../apache/pulsar/broker/ServiceConfiguration.java |  40 ++++-
 .../AbstractDispatcherSingleActiveConsumer.java    |  27 ++--
 .../broker/service/BrokerServiceException.java     |   8 +-
 .../NonPersistentDispatcherMultipleConsumers.java  |  39 ++++-
 ...onPersistentDispatcherSingleActiveConsumer.java |  22 ++-
 .../service/nonpersistent/NonPersistentTopic.java  |  23 ++-
 .../PersistentDispatcherMultipleConsumers.java     |  29 +++-
 .../PersistentDispatcherSingleActiveConsumer.java  |  16 ++
 .../broker/service/persistent/PersistentTopic.java |  22 +++
 .../pulsar/broker/service/PersistentTopicTest.java | 172 ++++++++++++++++++++-
 12 files changed, 406 insertions(+), 22 deletions(-)

commit 3c9e28172d486bfb4c39db5248e1033d5079c48f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Feb 14 12:03:38 2018 -0800

    Add non-persistent topic stats separately in brokers-stat (#1235)

 .../apache/pulsar/broker/service/PulsarStats.java  | 45 +++++++++++++++++-----
 1 file changed, 36 insertions(+), 9 deletions(-)

commit 4592b767ae8f6b0ff3a7ed29b2c476c3c9a71bd6
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 14 08:08:09 2018 -0800

    Force to pull docker build image to regenerate PulsarApi.java generate_protobuf_docker.sh (#1228)

 pulsar-common/generate_protobuf_docker.sh | 3 +++
 1 file changed, 3 insertions(+)

commit 74049522a1d97e1171c9088acd638b426b6de015
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Tue Feb 13 21:21:29 2018 -0800

    Issue 937: add CommandGetLastMessageId to make reader know the end of topic (#1066)
    
    * add CommandGetLastMessageId to getlastMessageId of topic
    
    * rebase master, change following comments
    
    * add partition index in GetLastMessageIdResponse
    
    * fix rebase error
    
    * bump proot version to v11
    
    * change following comments
    
    * change following comments2
    
    * change following comments3
    
    * change following comments
    
    * get cnx() first

 .../apache/bookkeeper/mledger/ManagedLedger.java   |    7 +
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |    9 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |   52 +-
 .../org/apache/pulsar/broker/service/Topic.java    |    3 +
 .../service/nonpersistent/NonPersistentTopic.java  |    6 +
 .../broker/service/persistent/PersistentTopic.java |    5 +
 .../apache/pulsar/client/api/TopicReaderTest.java  |  107 +-
 .../java/org/apache/pulsar/client/api/Reader.java  |   10 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   37 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  131 ++-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   11 +-
 .../pulsar/client/util/ExecutorProvider.java       |    2 +-
 .../org/apache/pulsar/common/api/Commands.java     |   41 +-
 .../apache/pulsar/common/api/PulsarDecoder.java    |   20 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 1026 ++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   47 +-
 16 files changed, 1457 insertions(+), 57 deletions(-)

commit fbb42e711aa9044ec5a1b30f448173432c1d805a
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Tue Feb 13 18:12:13 2018 -0800

    Added debug logs in MessageCrypto (#1233)

 pulsar-client-cpp/lib/MessageCrypto.cc | 101 +++++++++++++++++++++++++--------
 pulsar-client-cpp/lib/MessageCrypto.h  |   1 +
 2 files changed, 77 insertions(+), 25 deletions(-)

commit e77faf4acf760447850bd2e4c99acae24d2ae27c
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 13 12:08:58 2018 -0800

    Bumped master to 2.0.0-incubating-SNAPSHOT (#1226)

 all/pom.xml                                                  | 2 +-
 buildtools/pom.xml                                           | 2 +-
 managed-ledger/pom.xml                                       | 2 +-
 pom.xml                                                      | 2 +-
 pulsar-broker-auth-athenz/pom.xml                            | 2 +-
 pulsar-broker-common/pom.xml                                 | 2 +-
 pulsar-broker-shaded/pom.xml                                 | 2 +-
 pulsar-broker/pom.xml                                        | 2 +-
 pulsar-checksum/pom.xml                                      | 2 +-
 pulsar-client-admin-shaded/pom.xml                           | 2 +-
 pulsar-client-admin/pom.xml                                  | 2 +-
 pulsar-client-auth-athenz/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pom.xml                           | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml       | 2 +-
 pulsar-client-shaded/pom.xml                                 | 2 +-
 pulsar-client-tools/pom.xml                                  | 2 +-
 pulsar-client/pom.xml                                        | 2 +-
 pulsar-common/pom.xml                                        | 2 +-
 pulsar-discovery-service/pom.xml                             | 2 +-
 pulsar-proxy/pom.xml                                         | 2 +-
 pulsar-spark/pom.xml                                         | 2 +-
 pulsar-storm/pom.xml                                         | 2 +-
 pulsar-testclient/pom.xml                                    | 2 +-
 pulsar-websocket/pom.xml                                     | 2 +-
 pulsar-zookeeper-utils/pom.xml                               | 2 +-
 pulsar-zookeeper/pom.xml                                     | 2 +-
 27 files changed, 27 insertions(+), 27 deletions(-)

commit 56ebe368ec2eb8569218ca4b438ee53f2bf5145e
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Feb 13 18:54:29 2018 +0100

    ProxyForwardAuthDataTest shouldn't reuse pulsar client (#1230)
    
    * ProxyForwardAuthDataTest shouldn't reuse pulsar client
    
    This test was flaking due to the pulsar client being reused. The test
    starts a proxy service, subscribes to a topic, stops the proxy, starts
    a new proxy and tries to subscribe again.
    
    If using the same client for both connections, the client will have an
    open connection to the first proxy, which, when the proxy is stopped,
    will be closed by netty asynchronously. This can race with the second
    subscription attempt, and cause it to fail with
    ConnectionClosedException. Specifically, if the subscription attempt
    runs before the netty callback runs, the subscription attempt will try
    to subscribe on a dead connection.
    
    The immediate fix for this test, to stop the flaking, is just to use a
    different client for each attempt.
    
    * Remove trailing whitespace

 .../proxy/server/ProxyForwardAuthDataTest.java     | 55 +++++++++-------------
 1 file changed, 23 insertions(+), 32 deletions(-)

commit b99067479ebca5f955c936d396e72cd7eda09095
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Mon Feb 12 20:57:58 2018 -0800

    Enable specification of TLS Protocol Versions and Cipher Suites (#1225)

 .../apache/pulsar/broker/ServiceConfiguration.java |  24 +++-
 .../broker/service/PulsarChannelInitializer.java   |   5 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   4 +-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   4 +
 .../apache/pulsar/common/util/SecurityUtility.java |  13 +-
 .../service/ServiceChannelInitializer.java         |   3 +-
 .../discovery/service/server/ServiceConfig.java    |  24 +++-
 .../pulsar/proxy/server/ProxyConfiguration.java    |  24 +++-
 .../proxy/server/ServiceChannelInitializer.java    |   2 +-
 .../server/ProxyWithProxyAuthorizationTest.java    | 146 ++++++++++++++++++++-
 10 files changed, 234 insertions(+), 15 deletions(-)

commit 7dd64d072060c7ccadcc9ff747ace3658be1584f
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 12 20:31:01 2018 -0800

    Regenerated the PulsarApi from proto with latest protoc (#1227)

 .../apache/pulsar/common/api/proto/PulsarApi.java  | 680 +++++++++++----------
 1 file changed, 374 insertions(+), 306 deletions(-)

commit 35e84c349ce2442592bde6f1bfc980dacf175f1e
Author: cckellogg <cckellogg@gmail.com>
Date:   Mon Feb 12 19:14:52 2018 -0800

    PIP-10: Removing cluster from topic name (#1150)
    
    * Make DestinationName and NamespaceName classes to handle both formats
    
    * Refactor /namespaces and /resource-quotas handlers for new-style namespace names
    
    * Refactor topics APIs to accept new name formats
    
    * Separate the broker admin rest endpoints in different pacakges.
    
    v1 - legacy endpoints with clusters name
    v2 - endpoints without the cluster name
    
    The new admin v2 endpoints are mounted ad /admin/v2.
    
    * Remove refactor remnants.
    
    * Fix list namespaces to handle v1 and v2 formats.
    
    * Add default namespace policies on create if none are sent.
    
    * Fix internals that assumed a cluster in the path.
    
    * Fix merge compile issue.
    
    * Fix compile issues from merge with master.

 .../org/apache/pulsar/broker/PulsarService.java    |    6 +-
 .../apache/pulsar/broker/admin/AdminResource.java  |  135 +-
 .../org/apache/pulsar/broker/admin/Namespaces.java | 1757 --------------------
 .../BrokerStatsBase.java}                          |   13 +-
 .../admin/{Brokers.java => impl/BrokersBase.java}  |   14 +-
 .../{Clusters.java => impl/ClustersBase.java}      |   16 +-
 .../pulsar/broker/admin/impl/NamespacesBase.java   | 1246 ++++++++++++++
 .../PersistentTopicsBase.java}                     |  828 +++------
 .../{Properties.java => impl/PropertiesBase.java}  |   16 +-
 .../ResourceQuotasBase.java}                       |   97 +-
 .../apache/pulsar/broker/admin/v1/BrokerStats.java |   32 +
 .../org/apache/pulsar/broker/admin/v1/Brokers.java |   29 +
 .../apache/pulsar/broker/admin/v1/Clusters.java    |   32 +
 .../apache/pulsar/broker/admin/v1/Namespaces.java  |  711 ++++++++
 .../broker/admin/{ => v1}/NonPersistentTopics.java |  102 +-
 .../pulsar/broker/admin/v1/PersistentTopics.java   |  421 +++++
 .../apache/pulsar/broker/admin/v1/Properties.java  |   34 +
 .../pulsar/broker/admin/v1/ResourceQuotas.java     |   79 +
 .../apache/pulsar/broker/admin/v2/BrokerStats.java |   32 +
 .../org/apache/pulsar/broker/admin/v2/Brokers.java |   29 +
 .../apache/pulsar/broker/admin/v2/Clusters.java    |   32 +
 .../apache/pulsar/broker/admin/v2/Namespaces.java  |  519 ++++++
 .../broker/admin/v2/NonPersistentTopics.java       |  159 ++
 .../pulsar/broker/admin/v2/PersistentTopics.java   |  396 +++++
 .../apache/pulsar/broker/admin/v2/Properties.java  |   34 +
 .../pulsar/broker/admin/v2/ResourceQuotas.java     |   90 +
 .../broker/loadbalance/impl/LoadManagerShared.java |    6 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |    4 +-
 .../pulsar/broker/namespace/NamespaceService.java  |   12 +-
 .../broker/namespace/ServiceUnitZkUtils.java       |   15 +-
 .../pulsar/broker/service/BrokerService.java       |    2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |    4 +-
 .../pulsar/broker/web/PulsarWebResource.java       |   22 +-
 .../utils/PulsarBrokerVersionStringUtils.java      |    4 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |    4 +-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |   27 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |   14 +-
 .../org/apache/pulsar/common/naming/Constants.java |   26 +
 .../pulsar/common/naming/DestinationName.java      |   73 +-
 .../apache/pulsar/common/naming/NamespaceName.java |   88 +-
 .../pulsar/common/naming/DestinationNameTest.java  |   31 +-
 .../pulsar/common/naming/NamespaceNameTest.java    |   31 +-
 42 files changed, 4572 insertions(+), 2650 deletions(-)

commit a5a7c79bd43520358bd78e3a5f0cb7279f384cc8
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Mon Feb 12 17:16:15 2018 -0700

    Checkstyle managed ledger (#1224)
    
    * Add projet wide checkstyle configuration
    
    * Optimize imports for managed-ledger
    
    * Clean checkstyle for managed-ledger

 .../src/main/resources/pulsar/checkstyle.xml       |  20 +-
 .../src/main/resources/pulsar/suppressions.xml     |  18 +-
 .../apache/bookkeeper/mledger/AsyncCallbacks.java  | 100 +++++-----
 .../java/org/apache/bookkeeper/mledger/Entry.java  |   5 +-
 .../apache/bookkeeper/mledger/ManagedCursor.java   | 204 +++++++++++----------
 .../apache/bookkeeper/mledger/ManagedLedger.java   | 147 +++++++--------
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  18 +-
 .../bookkeeper/mledger/ManagedLedgerException.java |   2 +-
 .../bookkeeper/mledger/ManagedLedgerFactory.java   |  27 ++-
 .../mledger/ManagedLedgerFactoryConfig.java        |   3 +
 .../mledger/ManagedLedgerFactoryMXBean.java        |  18 +-
 .../bookkeeper/mledger/ManagedLedgerInfo.java      |   5 +-
 .../bookkeeper/mledger/ManagedLedgerMXBean.java    |   3 +
 .../apache/bookkeeper/mledger/impl/EntryCache.java |  16 +-
 .../impl/EntryCacheDefaultEvictionPolicy.java      |  11 +-
 .../mledger/impl/EntryCacheEvictionPolicy.java     |   4 +-
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  28 +--
 .../bookkeeper/mledger/impl/EntryCacheManager.java |  15 +-
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |   6 +-
 .../mledger/impl/ManagedCursorContainer.java       |  22 +--
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 109 +++++------
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |  13 +-
 .../impl/ManagedLedgerFactoryMBeanImpl.java        |   2 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  49 +++--
 .../mledger/impl/ManagedLedgerMBeanImpl.java       |   3 +-
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |  15 +-
 .../apache/bookkeeper/mledger/impl/MetaStore.java  |  33 ++--
 .../mledger/impl/MetaStoreImplZookeeper.java       |  11 +-
 .../mledger/impl/NonDurableCursorImpl.java         |   6 +-
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |  14 +-
 .../bookkeeper/mledger/impl/OpFindNewest.java      |   8 +-
 .../bookkeeper/mledger/impl/OpReadEntry.java       |  11 +-
 .../bookkeeper/mledger/impl/PositionImpl.java      |   7 +-
 .../bookkeeper/mledger/impl/package-info.java      |  19 ++
 .../apache/bookkeeper/mledger/package-info.java    |  19 ++
 .../bookkeeper/mledger/proto/package-info.java     |  19 ++
 .../bookkeeper/mledger/util/CallbackMutex.java     |   3 +-
 .../apache/bookkeeper/mledger/util/Futures.java    |   8 +-
 .../org/apache/bookkeeper/mledger/util/Pair.java   |  20 +-
 .../apache/bookkeeper/mledger/util/RangeCache.java |  24 ++-
 .../org/apache/bookkeeper/mledger/util/Rate.java   |   1 +
 .../apache/bookkeeper/mledger/util/SafeRun.java    |   4 +-
 .../bookkeeper/mledger/util/package-info.java      |  19 ++
 .../bookkeeper/client/BookKeeperTestClient.java    |   1 -
 .../apache/bookkeeper/client/MockBookKeeper.java   |   6 +-
 .../apache/bookkeeper/client/MockLedgerEntry.java  |   3 +-
 .../apache/bookkeeper/client/MockLedgerHandle.java |   9 +-
 .../bookkeeper/mledger/SimpleBookKeeperTest.java   |   4 +-
 .../mledger/impl/EntryCacheManagerTest.java        |   2 -
 .../bookkeeper/mledger/impl/EntryCacheTest.java    |  11 +-
 .../mledger/impl/ManagedCursorConcurrencyTest.java |   8 +-
 .../mledger/impl/ManagedCursorContainerTest.java   |  13 +-
 .../mledger/impl/ManagedCursorPropertiesTest.java  |   1 -
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  17 +-
 .../mledger/impl/ManagedLedgerBkTest.java          |   8 +-
 .../mledger/impl/ManagedLedgerErrorsTest.java      |   5 +-
 .../mledger/impl/ManagedLedgerMBeanTest.java       |   1 -
 .../impl/ManagedLedgerSingleBookieTest.java        |   4 +-
 .../mledger/impl/ManagedLedgerTerminationTest.java |   1 -
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  20 +-
 .../mledger/impl/MetaStoreImplZookeeperTest.java   |   1 -
 .../mledger/impl/NonDurableCursorTest.java         |  10 +-
 .../bookkeeper/mledger/impl/PositionTest.java      |   1 -
 .../bookkeeper/mledger/util/CallbackMutexTest.java |   1 -
 .../bookkeeper/mledger/util/RangeCacheTest.java    |   4 +-
 .../bookkeeper/test/BookKeeperClusterTestCase.java |   1 -
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |   1 -
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java  |   1 -
 .../java/org/apache/zookeeper/MockZooKeeper.java   |  17 +-
 .../broker/stats/AllocatorStatsGenerator.java      |   2 +-
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |   2 +-
 71 files changed, 608 insertions(+), 636 deletions(-)

commit fbfd9445ee468faae7f56aeab69e93794bf4a033
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Feb 12 23:14:59 2018 +0100

    Algorithm to find start point of compacted ledger (#1205)
    
    * Algorithm to find start point of compacted ledger
    
    When reading from a compacted topic ledger, the reader will have to find
    the the first entry whole message id is greater than or equal to the
    position of the cursor. This involves a binary search into the ledger.
    
    This patch implements this binary search, along with basic caching to
    avoid rereading the same entry multiple times.
    
    * Guava cache -> Caffeine
    
    * rejig future callbacks

 .../apache/pulsar/client/impl/RawMessageImpl.java  |   2 +-
 .../pulsar/compaction/CompactedTopicImpl.java      |  90 +++++++++
 .../pulsar/compaction/CompactedTopicTest.java      | 214 +++++++++++++++++++++
 3 files changed, 305 insertions(+), 1 deletion(-)

commit fb1c61d1520fa89f98a7c4582129bc39d42c7d8e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Feb 12 11:35:51 2018 -0800

    Add pluggable authorization mechanism (#1200)
    
    * Add pluggable authorization service
    
    fix: move FutureUtils to common and fix import
    
    add grantpermission api
    
    take default auth method
    
    pass authData to authorization provider
    
    keep single authorization provider
    
    * fix rebase change

 conf/broker.conf                                   |   3 +
 conf/discovery.conf                                |   3 +
 conf/proxy.conf                                    |   3 +
 conf/standalone.conf                               |   3 +
 conf/websocket.conf                                |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  11 +
 .../authorization/AuthorizationProvider.java       | 120 ++++
 .../broker/authorization/AuthorizationService.java | 265 ++++++++
 ...nager.java => PulsarAuthorizationProvider.java} | 200 ++++--
 .../broker/cache/ConfigurationCacheService.java    |   4 +
 .../org/apache/pulsar/broker/PulsarService.java    |   2 +-
 .../org/apache/pulsar/broker/admin/Namespaces.java |  46 +-
 .../pulsar/broker/admin/NonPersistentTopics.java   |   2 +-
 .../pulsar/broker/admin/PersistentTopics.java      |  12 +-
 .../broker/loadbalance/impl/LoadManagerShared.java |   2 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |   5 +-
 .../pulsar/broker/namespace/OwnershipCache.java    |   2 +-
 .../pulsar/broker/service/BacklogQuotaManager.java |   2 +-
 .../pulsar/broker/service/BrokerService.java       |  14 +-
 .../org/apache/pulsar/broker/service/Consumer.java |   8 +-
 .../org/apache/pulsar/broker/service/Producer.java |   8 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  37 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   2 +-
 .../broker/service/persistent/PersistentTopic.java |   2 +-
 .../pulsar/broker/web/AuthenticationFilter.java    |   5 +
 .../pulsar/broker/web/PulsarWebResource.java       |  16 +-
 .../pulsar/broker/auth/AuthorizationTest.java      | 152 ++---
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   4 +
 .../AntiAffinityNamespaceGroupTest.java            |   5 +-
 .../lookup/http/HttpDestinationLookupv2Test.java   |   8 +-
 .../pulsar/broker/service/BatchMessageTest.java    |   2 +-
 .../broker/service/PersistentFailoverE2ETest.java  |   2 +-
 .../broker/service/PersistentQueueE2ETest.java     |   2 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   2 +-
 .../pulsar/broker/service/ServerCnxTest.java       |  67 +-
 .../broker/service/TopicTerminationTest.java       |   2 +-
 .../api/AuthorizationProducerConsumerTest.java     | 384 ++++++++++++
 .../pulsar/client/api/BrokerServiceLookupTest.java |   2 +-
 .../client/api/SimpleProducerConsumerTest.java     |   2 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 116 ++--
 .../websocket/proxy/ProxyAuthorizationTest.java    |  28 +-
 .../pulsar/client/admin/internal/BaseResource.java |   2 +-
 .../clients/consumer/PulsarKafkaConsumer.java      |   2 +-
 .../pulsar/client/api/ClientConfiguration.java     |   1 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   4 +-
 .../apache/pulsar/client/impl/ConsumerBase.java    |   2 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 .../org/apache/pulsar/client/impl/HttpClient.java  |  18 +-
 .../pulsar/client/impl/HttpLookupService.java      |   7 +-
 .../client/impl/PartitionedConsumerImpl.java       |   2 +-
 .../client/impl/PartitionedProducerImpl.java       |   2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   4 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 680 ++++++++++-----------
 .../org/apache/pulsar/common}/util/FutureUtil.java |  10 +-
 .../discovery/service/BrokerDiscoveryProvider.java |  10 +-
 .../pulsar/discovery/service/DiscoveryService.java |  10 +-
 .../pulsar/discovery/service/ServerConnection.java |   9 +-
 .../discovery/service/server/ServiceConfig.java    |  11 +
 .../discovery/service/DiscoveryServiceTest.java    |   4 +-
 .../proxy/server/BrokerDiscoveryProvider.java      |  13 +-
 .../pulsar/proxy/server/LookupProxyHandler.java    |   3 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    |  13 +-
 .../pulsar/proxy/server/ProxyConnection.java       |   7 +-
 .../apache/pulsar/proxy/server/ProxyService.java   |  10 +-
 .../pulsar/testclient/PerformanceReader.java       |   2 +-
 .../pulsar/websocket/AbstractWebSocketHandler.java |   7 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |   6 +-
 .../apache/pulsar/websocket/ProducerHandler.java   |  11 +-
 .../org/apache/pulsar/websocket/ReaderHandler.java |   6 +-
 .../apache/pulsar/websocket/WebSocketService.java  |  12 +-
 .../websocket/admin/WebSocketWebResource.java      |  18 +-
 .../service/WebSocketProxyConfiguration.java       |  13 +
 72 files changed, 1682 insertions(+), 777 deletions(-)

commit d38cf249f1ff105bace1607495d5e00d6640234a
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Mon Feb 12 09:34:35 2018 +0900

    Use SecurityUtility (part 2) (#1216)

 .../apache/pulsar/client/impl/ConnectionPool.java  | 30 ++++++-------------
 .../service/ServiceChannelInitializer.java         | 27 ++++-------------
 .../pulsar/proxy/server/DirectProxyHandler.java    | 34 +++++++---------------
 3 files changed, 26 insertions(+), 65 deletions(-)

commit 3fd3ab41012ee24d8e4d4baec01fd8a40389ef0a
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Mon Feb 12 02:11:19 2018 +0900

    Remove org.apache.pulsar.discovery.service.PulsarServerException (#1222)
    
    No defference from org.apache.pulsar.broker.PulsarServerException

 .../discovery/service/BrokerDiscoveryProvider.java |  1 +
 .../discovery/service/PulsarServerException.java   | 38 ----------------------
 .../pulsar/discovery/service/ServerConnection.java |  1 +
 3 files changed, 2 insertions(+), 38 deletions(-)

commit 8e5b11a28bd7b875f9eba56fcb5acbe67d6dfece
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Mon Feb 12 02:10:23 2018 +0900

    Remove org.apache.pulsar.proxy.socket.client.MockAuthenticationProvider (#1221)
    
    Nobody use it, and there are lot of copies.

 .../socket/client/MockAuthenticationProvider.java  | 54 ----------------------
 1 file changed, 54 deletions(-)

commit 3bfc505b5fe430d69750b65e3e911cdbd32f3aa4
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Mon Feb 12 02:09:26 2018 +0900

    Remove org.apache.pulsar.proxy.authentication.AuthenticationServiceTest (#1220)
    
    org.apache.pulsar.broker.auth.AuthenticationServiceTest tests the same thing.

 .../broker/auth/AuthenticationServiceTest.java     |  6 +-
 .../authentication/AuthenticationServiceTest.java  | 91 ----------------------
 2 files changed, 4 insertions(+), 93 deletions(-)

commit 71b3b182f4b5bbf7cc39392e972a483f40d72653
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Mon Feb 12 02:06:59 2018 +0900

    Remove org.apache.pulsar.proxy.socket.client.PaddingDecimalFormat (#1217)
    
    The class is exactly the same as the one in org.apache.pulsar.testclient.utils.

 .../proxy/socket/client/PaddingDecimalFormat.java  | 72 ----------------------
 .../proxy/socket/client/PerformanceClient.java     |  1 +
 2 files changed, 1 insertion(+), 72 deletions(-)

commit a27a1e2dd669bc2082cf8f8cefb30becf56fa616
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Feb 11 09:01:55 2018 -0800

    Support hostname verification on proxy to broker connection (#1214)
    
    * Support hostname verification on proxy to broker connection
    
    * remove dep and rename config

 conf/proxy.conf                                    |  3 +
 .../pulsar/proxy/server/DirectProxyHandler.java    | 42 +++++++++++-
 .../pulsar/proxy/server/ProxyConfiguration.java    | 10 +++
 .../server/ProxyWithProxyAuthorizationTest.java    | 75 +++++++++++++++++++---
 4 files changed, 121 insertions(+), 9 deletions(-)

commit ccbfbf881a8dd3b17ec3b091d4c30eb46389a6c5
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Sun Feb 11 09:54:14 2018 +0900

    Support custom URL scheme handlers (#1212)

 .../client/impl/auth/AuthenticationAthenz.java     |  47 ++++----
 .../client/api/url/DataURLStreamHandler.java       | 121 +++++++++++++++++++++
 .../api/url/PulsarURLStreamHandlerFactory.java     |  51 +++++++++
 .../java/org/apache/pulsar/client/api/url/URL.java |  54 +++++++++
 4 files changed, 246 insertions(+), 27 deletions(-)

commit 2c0616ef70174d1171de1bacc750f8f328e571e1
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Sun Feb 11 09:51:29 2018 +0900

    Use SecurityUtility class (#1213)
    
    * Use SecurityUtility class
    
    * Add a comment
    
    * Fix a careless mistake

 .../broker/service/PulsarChannelInitializer.java   | 36 +-------------
 .../org/apache/pulsar/client/impl/HttpClient.java  |  4 +-
 .../apache/pulsar/common/util/SecurityUtility.java | 56 +++++++++++++++++-----
 .../proxy/server/ServiceChannelInitializer.java    | 30 ++----------
 4 files changed, 54 insertions(+), 72 deletions(-)

commit 16a554bfd5903482512d9a567777ccb21dfd5c01
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 9 21:32:49 2018 -0800

    Allow to configure most client/producer/consumer options in Kafka API wrapper (#1207)

 .../clients/consumer/PulsarKafkaConsumer.java      | 11 ++--
 .../clients/producer/PulsarKafkaProducer.java      |  8 +--
 ...fkaConfig.java => PulsarClientKafkaConfig.java} | 44 ++++++++++++++-
 .../kafka/compat/PulsarConsumerKafkaConfig.java    | 50 +++++++++++++++++
 .../kafka/compat/PulsarProducerKafkaConfig.java    | 64 ++++++++++++++++++++++
 site/docs/latest/adaptors/KafkaWrapper.md          | 42 +++++++++++---
 6 files changed, 203 insertions(+), 16 deletions(-)

commit 8d3ab43cee86c9e49a54db13929a4ecb09e8152f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Feb 9 17:43:23 2018 -0800

    Add hostname-verification at client tls connection (#1208)
    
    * Add hostname-verification at client tls connection
    
    * add httpclient dep with exclude all + add pem in apache-rat
    
    * add httpclient+commons-logging dep in client-shading and LICENSE
    
    * shade artifacts
    
    * fix: proxy send certs to client for host verification

 all/src/assemble/LICENSE.bin.txt                   |   2 +
 pom.xml                                            |  13 ++
 pulsar-broker-shaded/pom.xml                       |   6 +
 .../broker/service/PulsarChannelInitializer.java   |  14 ++
 .../AuthenticationTlsHostnameVerificationTest.java | 255 +++++++++++++++++++++
 .../tls/hn-verification/broker-cert.pem            |  82 +++++++
 .../tls/hn-verification/broker-key.pem             |  28 +++
 .../authentication/tls/hn-verification/cacert.pem  |  79 +++++++
 .../pulsar-client-kafka/pom.xml                    |   6 +
 pulsar-client-shaded/pom.xml                       |   6 +
 pulsar-client/pom.xml                              |  18 ++
 .../pulsar/client/api/ClientConfiguration.java     |  18 ++
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  54 ++++-
 .../apache/pulsar/client/impl/ConnectionPool.java  |   2 +
 .../proxy/server/ServiceChannelInitializer.java    |  14 ++
 .../server/ProxyWithProxyAuthorizationTest.java    |  51 ++++-
 16 files changed, 642 insertions(+), 6 deletions(-)

commit f288db58b45821ee7f5df2694eada6236afbe1a4
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 9 13:02:28 2018 -0800

    Cancel keep-alive timer task after the proxy switch to TCP proxy (#1210)

 .../main/java/org/apache/pulsar/common/api/PulsarHandler.java | 11 ++++++++---
 .../java/org/apache/pulsar/proxy/server/ProxyConnection.java  |  1 +
 2 files changed, 9 insertions(+), 3 deletions(-)

commit 50beacae60cb6ec9384c1fa2b39c4ca3cb7cbe80
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 9 12:30:02 2018 -0800

    Fixed missing '"' sign in system metrics for Prometheus (#1209)

 .../pulsar/broker/stats/prometheus/PrometheusMetricsGenerator.java | 7 +++----
 .../java/org/apache/pulsar/broker/stats/PrometheusMetricsTest.java | 5 +++++
 2 files changed, 8 insertions(+), 4 deletions(-)

commit feb0acc608318fe6f878a2e00dcce9cb0085a79a
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 8 14:31:58 2018 -0800

    Use duplicates when writing from ByteBuf pair to avoid multiple threads issues (#1203)

 .../src/main/java/org/apache/pulsar/common/api/ByteBufPair.java       | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 552249d9b79411b0972967156b3c99a8bbb858c3
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 8 14:04:37 2018 -0800

    Ensure the checksum is not stripped after validation in the broker (#1195)
    
    * Ensure the checksum is not stripped after validation in the broker
    
    * Fixed issue in C++ consumer to adjust size after reading the checksum
    
    * Fixed formatting
    
    * Added missing client protocol version check

 .../org/apache/pulsar/broker/service/Consumer.java |   2 +-
 .../org/apache/pulsar/broker/service/Producer.java |   4 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  31 ++++++
 .../broker/service/persistent/ChecksumTest.java    | 105 +++++++++++++++++++++
 pulsar-client-cpp/lib/ClientConnection.cc          |  14 ++-
 pulsar-client-cpp/lib/ClientConnection.h           |   3 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  |   3 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 8 files changed, 155 insertions(+), 8 deletions(-)

commit 3615e25f91aed95e7f5896449f6d72085489ef65
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 8 11:13:29 2018 -0800

    Reduce size of buffer used to assemble batches (#1204)

 .../pulsar/client/impl/BatchMessageContainer.java      | 18 +++++++++++++-----
 1 file changed, 13 insertions(+), 5 deletions(-)

commit b53816507997074be56744345bdd82f37b55c5b2
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 8 02:08:35 2018 -0800

    Perf producer was overriding the producer max queue size (#1202)

 .../src/main/java/org/apache/pulsar/testclient/PerformanceProducer.java  | 1 -
 1 file changed, 1 deletion(-)

commit b7e2e7cab6bbac3f8670a333547abdf77fa5d24c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Feb 7 18:59:19 2018 -0800

    Add connection timeout for binary lookup request (#1184)
    
    * Add connection timeout for binary lookup request
    
    * operation timeout
    
    * fix test

 .../client/impl/BrokerClientIntegrationTest.java   |  2 -
 .../org/apache/pulsar/client/impl/ClientCnx.java   | 21 +++++++
 .../apache/pulsar/client/impl/ClientCnxTest.java   | 64 ++++++++++++++++++++++
 3 files changed, 85 insertions(+), 2 deletions(-)

commit 11648aa65e2393874c94e69d5733846bbc9f22fa
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Feb 8 02:31:41 2018 +0000

    Notify topic of ledger when compaction finishes (#1188)
    
    When the compactor finishes compacting a topic, it send a cumulative
    acknowledgement to the broker, containing the ledger ID that the topic
    was compacted into. Hitherto the broker has done nothing with this
    acknowledgement.
    
    This patch introduces the compacted topic interface, and, for now, a
    dummy implementation of this interface. It also introduces a
    specialization of PersistentSubscription which is created for the
    compactor's subscription. When this subscription receives a cumulative
    acknowledgement, it extracts the ledger id for the acknowledgement
    topics, and notifies the compacted topic interface of this newly
    available compacted ledger. For now, the compacted topic implementation
    does nothing with it. This will be in a later patch.

 .../service/persistent/CompactorSubscription.java  | 122 +++++++++++++++++++++
 .../service/persistent/PersistentSubscription.java |  10 +-
 .../broker/service/persistent/PersistentTopic.java |  20 +++-
 .../apache/pulsar/compaction/CompactedTopic.java   |  25 +++++
 .../pulsar/compaction/CompactedTopicImpl.java      |  27 +++++
 .../org/apache/pulsar/compaction/Compactor.java    |   4 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  45 ++++++++
 7 files changed, 244 insertions(+), 9 deletions(-)

commit b429931e1de2f430c72b751e237b446f95fedb3c
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Wed Feb 7 18:14:24 2018 -0800

    Proxy forward auth data (#1169)

 conf/broker.conf                                   |   7 +
 conf/proxy.conf                                    |   4 +
 conf/standalone.conf                               |   7 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  12 +
 .../apache/pulsar/broker/service/ServerCnx.java    |  93 +++-
 .../pulsar/broker/service/ServerCnxTest.java       |   2 +-
 .../org/apache/pulsar/common/api/Commands.java     |  53 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 564 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  24 +-
 .../pulsar/proxy/server/DirectProxyHandler.java    |  15 +-
 .../pulsar/proxy/server/LookupProxyHandler.java    |   7 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    |  13 +-
 .../pulsar/proxy/server/ProxyConnection.java       |   7 +
 .../proxy/server/ProxyForwardAuthDataTest.java     | 158 ++++++
 .../proxy/server/ProxyRolesEnforcementTest.java    |   6 +-
 15 files changed, 933 insertions(+), 39 deletions(-)

commit 85cce7357960a9d85af6d7b0693b78908f5c29e0
Author: Adam Williams <pwnfactory@gmail.com>
Date:   Wed Feb 7 18:24:54 2018 -0700

    Update website documentation verbiage (#1199)

 site/docs/latest/project/BinaryProtocol.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 750e1b57eb38fde1d051b906f9f85c8f742e342d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Feb 7 15:22:28 2018 -0800

    Simplify documentation for getting started (#1198)
    
    * begin adding section on connecting to running cluster
    
    * remove unnecessary bash comment

 site/_data/cli/pulsar-client.yaml              |  2 +-
 site/_includes/explanations/install-package.md | 38 +++++++-------------------
 site/docs/latest/deployment/cluster.md         | 24 ++++++++++++++++
 3 files changed, 35 insertions(+), 29 deletions(-)

commit 71cf49b7229b3f0a0b8d102251057e52a150cd72
Author: Adam Williams <pwnfactory@gmail.com>
Date:   Wed Feb 7 11:32:29 2018 -0700

    Update website documentation verbiage (#1197)
    
    ~~The TCP connection is not being affected~~
    The TCP connection is not affected

 site/docs/latest/project/BinaryProtocol.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8d8840734b0604462c86965fe6c4c9c49e5a3fdd
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Thu Feb 8 02:24:15 2018 +0900

    Add support for new interface to AuthenticaionTls (#1147)
    
    This adds EncodedAuthenticationParameterSupport interface to
    AuthenticationTls and AuthenticationDisabled.
    
    Also, mark some methods deprecated as preparation for 2.0

 .../client/impl/auth/AuthenticationAthenz.java     | 14 ++----
 .../apache/pulsar/client/api/Authentication.java   |  4 ++
 .../pulsar/client/api/AuthenticationFactory.java   | 18 +-------
 .../pulsar/client/api/AuthenticationUtil.java      | 53 ++++++++++++++++++++++
 .../client/impl/auth/AuthenticationDisabled.java   |  8 +++-
 .../pulsar/client/impl/auth/AuthenticationTls.java | 18 ++++++--
 6 files changed, 83 insertions(+), 32 deletions(-)

commit dbbb79c170384b52422e54afce7f9504161ab20b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Feb 7 09:02:19 2018 -0800

    Fix: invalid authprovider value from config (#1196)

 conf/standalone.conf | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 153b79703ac979012763d93f537f48520e73d1ea
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Feb 6 21:50:54 2018 -0800

    Templatize resources page (#1041)
    
    * templatize resources page
    
    * change title of page to Resources
    
    * add missing license headers
    
    * add more license headers
    
    * s/creator/co-creator

 site/_data/resources/articles.yaml          | 35 +++++++++++++++++++++
 site/_data/resources/presentations.yaml     | 31 ++++++++++++++++++
 site/_includes/navbar.html                  |  2 +-
 site/_includes/resources/articles.html      | 37 ++++++++++++++++++++++
 site/_includes/resources/presentations.html | 49 +++++++++++++++++++++++++++++
 site/{presentations.md => resources.md}     | 10 ++----
 6 files changed, 156 insertions(+), 8 deletions(-)

commit 3b4d6811be4381c12f978819c3a5885f1d494370
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 6 21:50:29 2018 -0800

    Fixed apache rat errors (#1194)

 deployment/terraform-ansible/aws/ansible.cfg       | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/instances.tf      | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/keys.tf           | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/network.tf        | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/output.tf         | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/provider.tf       | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/security.tf       | 19 ++++++++++++++++
 deployment/terraform-ansible/aws/variables.tf      | 19 ++++++++++++++++
 .../terraform-ansible/templates/bookkeeper.service | 19 ++++++++++++++++
 .../terraform-ansible/templates/pulsar.service     | 19 ++++++++++++++++
 .../terraform-ansible/templates/zookeeper.service  | 19 ++++++++++++++++
 deployment/terraform-ansible/terraform.tfstate     | 16 --------------
 pom.xml                                            | 25 +++++++++++++++++++++-
 .../build-support/clang_format_exclusions.txt      | 19 ++++++++++++++++
 site/Makefile                                      | 19 ++++++++++++++++
 15 files changed, 271 insertions(+), 17 deletions(-)

commit a7df70936350f494be86b86677556fee1f095303
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 6 21:50:17 2018 -0800

    Added instructions to verify the release artifacts signatures (#1193)

 site/download.md | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 27117f23034c41142321af42f36dc31e8a15df9e
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Feb 6 17:55:15 2018 -0800

    Fix for memory leak in Proxy roles enforcement (#1192)
    
    * Fix for Bufferleaks in ServerCnx.java due to ProxyRolesEnforcement
    
    * Added soome comments
    
    * Changed newLookupResponse to correct newPartitionMetadataResponse

 .../apache/pulsar/broker/service/ServerCnx.java    | 63 +++++++++++-----------
 1 file changed, 32 insertions(+), 31 deletions(-)

commit 69db8942eafe7b712227e8804ebaa2afc58b6e70
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 6 17:00:01 2018 -0800

    Fixed storage latency stats with Prometheus (#1185)
    
    * Fixed storage latency stats with Prometheus
    
    * Added tests for prometheus stats generator
    
    * Added license header

 .../stats/prometheus/NamespaceStatsAggregator.java |  26 ++-
 .../prometheus/PrometheusMetricsGenerator.java     |  10 +-
 .../pulsar/broker/stats/prometheus/TopicStats.java |  54 ++++--
 .../pulsar/broker/stats/PrometheusMetricsTest.java | 184 +++++++++++++++++++++
 4 files changed, 252 insertions(+), 22 deletions(-)

commit 28ce0adaef76c52341231104daac4df3e2c55f53
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 6 16:15:40 2018 -0800

    Validate topic name on broker side (#1178)
    
    * Validate topic name on broker side
    
    * Refactored to put them in a single validation method
    
    * Addressed comment

 .../apache/pulsar/broker/service/ServerCnx.java    | 143 ++++++++++++++-------
 .../pulsar/broker/service/ServerCnxTest.java       |  93 +++++++++++---
 .../broker/service/utils/ClientChannelHelper.java  |   6 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  |   3 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 5 files changed, 180 insertions(+), 66 deletions(-)

commit 56452294ec0b7cc8685b3ddb22dcec88227ddfd0
Author: Adam Williams <pwnfactory@gmail.com>
Date:   Tue Feb 6 16:49:39 2018 -0700

    Fix minor typo in documentation (#1191)

 site/docs/latest/project/BinaryProtocol.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d0bdab8f1d30ec4c1813ed4cb0fbf4880df57243
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 6 12:28:42 2018 -0800

    Upgrade to Netty-4.1.21 (#1189)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d05f94d592b7aadf6a884a3eec154b705deba9b7
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 6 10:58:58 2018 -0800

    Performance producer was not using the max producer queue size argument (#1187)

 .../src/main/java/org/apache/pulsar/testclient/PerformanceProducer.java  | 1 +
 1 file changed, 1 insertion(+)

commit b68cc80f60a8c70045b59e73da5e5f312252c3a4
Author: Ivan Kelly <ivank@apache.org>
Date:   Tue Feb 6 18:34:09 2018 +0000

    Read compacted consumer flag (#1136)
    
    * Read compacted consumer flag
    
    When enabled, a consumer will read messages from a compacted topic
    ledger if available. When disabled, the consumer will read from the
    message backlog as before, even if the topic has been compacted.
    
    The logic for actually reading from the compacted topic will be
    submitted in following patch.
    
    * readcompacted only works on non-shared subs on persistent topics
    
    Document this in the javadoc and add server side validation
    
    * Add client side validation
    
    Of course these occlude the server side validations, so they can't be
    tested without doing something nasty.

 .../org/apache/pulsar/broker/service/Consumer.java | 12 ++-
 .../apache/pulsar/broker/service/ServerCnx.java    |  4 +-
 .../org/apache/pulsar/broker/service/Topic.java    |  2 +-
 .../service/nonpersistent/NonPersistentTopic.java  | 10 ++-
 .../broker/service/persistent/PersistentTopic.java | 10 ++-
 .../PersistentDispatcherFailoverConsumerTest.java  | 10 ++-
 .../service/PersistentTopicConcurrentTest.java     |  8 +-
 .../pulsar/broker/service/PersistentTopicTest.java | 38 +++++----
 .../client/impl/ConsumerConfigurationTest.java     | 89 ++++++++++++++++++++++
 .../pulsar/client/api/ConsumerConfiguration.java   | 23 ++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  6 +-
 .../pulsar/client/impl/PulsarClientImpl.java       | 10 +++
 .../org/apache/pulsar/common/api/Commands.java     |  5 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 ++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  2 +
 15 files changed, 251 insertions(+), 35 deletions(-)

commit 13da93526bf25bc0ec54e650ca651fb16ebb63aa
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Tue Feb 6 11:56:38 2018 +0900

    Remove constexpr from C++ client (#1182)

 pulsar-client-cpp/lib/Murmur3_32Hash.cc | 14 +++++++++-----
 pulsar-client-cpp/lib/Murmur3_32Hash.h  |  3 ---
 2 files changed, 9 insertions(+), 8 deletions(-)

commit 5067209042836f7e80c874600c57e55825335b72
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 5 18:56:20 2018 -0800

    Avoid printing exceptio stack trace on lookup connection failures (#1179)

 .../java/org/apache/pulsar/client/impl/BinaryProtoLookupService.java   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 0ba6ae94ab1e5a6e7c35cec248f93b5775004c30
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 5 18:54:48 2018 -0800

    Use double to configure loadBalancerOverrideBrokerNicSpeedGbps (#1180)
    
    * Use double to configure loadBalancerOverrideBrokerNicSpeedGbps
    
    * Fixed tests

 conf/broker.conf                                                   | 3 ++-
 .../main/java/org/apache/pulsar/broker/ServiceConfiguration.java   | 6 +++---
 .../pulsar/broker/loadbalance/impl/LinuxBrokerHostUsageImpl.java   | 2 +-
 .../apache/pulsar/broker/loadbalance/LoadReportNetworkLimit.java   | 6 +++---
 .../org/apache/pulsar/common/naming/ServiceConfigurationTest.java  | 2 +-
 .../src/main/java/org/apache/pulsar/common/util/FieldParser.java   | 7 ++++++-
 6 files changed, 16 insertions(+), 10 deletions(-)

commit 03ade5c078b85111d2a70ad4b9a3fedaa7e7a959
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 5 18:51:18 2018 -0800

    Throw ProducerBusy when producer with same name is already connected (#1174)

 .../broker/service/BrokerServiceException.java     |  2 ++
 .../broker/service/PersistentTopicE2ETest.java     | 36 ++++++++++++++++++++++
 .../pulsar/client/api/ProducerConfiguration.java   |  4 +++
 .../pulsar/client/api/PulsarClientException.java   |  6 ++++
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  2 ++
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  3 ++
 pulsar-common/src/main/proto/PulsarApi.proto       |  2 ++
 .../apache/pulsar/websocket/ProducerHandler.java   | 30 +++++++++++++-----
 8 files changed, 78 insertions(+), 7 deletions(-)

commit 15e665545b1610df362bf58d730bf3b8a2699308
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Mon Feb 5 18:50:50 2018 -0800

    Proxy roles enforcement (#1168)

 .../apache/pulsar/broker/ServiceConfiguration.java |  14 +-
 .../broker/authorization/AuthorizationManager.java |  22 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  52 +++-
 .../pulsar/broker/service/ServerCnxTest.java       |   1 +
 .../proxy/server/ProxyRolesEnforcementTest.java    | 266 +++++++++++++++++++++
 5 files changed, 343 insertions(+), 12 deletions(-)

commit d0a4ff3c66ce46e204678df403339e6aeb5352b6
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Mon Feb 5 13:31:44 2018 -0800

    Update logCtx passed to MessageCrypto, removed unused variable (#1177)
    
    * Update logCtx passed to MessageCrypto, removed unused variable
    
    * Check cryptoKeyReader is not null to confirm if encryption is enabled

 pulsar-client-cpp/lib/MessageCrypto.cc                                 | 1 -
 .../main/java/org/apache/pulsar/client/api/ProducerConfiguration.java  | 2 +-
 .../src/main/java/org/apache/pulsar/client/impl/MessageCrypto.java     | 3 ++-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit 194579900d59bda9d9a8e1f29b10b9dc6aa8cc87
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 5 13:20:57 2018 -0800

    Added some missing configs on websocket producer/consumer (#1173)

 .../java/org/apache/pulsar/websocket/ConsumerHandler.java   |  4 ++++
 .../java/org/apache/pulsar/websocket/ProducerHandler.java   | 13 +++++++++++++
 site/docs/latest/clients/WebSocket.md                       | 10 +++++++---
 3 files changed, 24 insertions(+), 3 deletions(-)

commit 34c18c03e4594dc3ae4adf3093a9ee645469fdcc
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Mon Feb 5 10:03:35 2018 -0800

    add dockerfile for pulsar dcos prometheus (#1127)

 docker/prometheus-dcos/Dockerfile     | 22 ++++++++++++++++++++
 docker/prometheus-dcos/prometheus.yml | 39 +++++++++++++++++++++++++++++++++++
 2 files changed, 61 insertions(+)

commit 5310f74887f62f271213eb7f5191682b05a209c3
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 5 08:40:45 2018 -0800

    Fixed managed ledger missing callback issue when unloading a topic (#1171)

 .../bookkeeper/mledger/ManagedLedgerException.java |  8 +++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  9 +++--
 .../mledger/impl/ManagedLedgerBkTest.java          | 43 ++++++++++++++++++++++
 .../broker/service/BrokerServiceException.java     |  6 +++
 .../org/apache/pulsar/broker/service/Producer.java |  9 ++++-
 .../broker/service/persistent/PersistentTopic.java | 15 +++++++-
 6 files changed, 83 insertions(+), 7 deletions(-)

commit 6ed3a4951ccad6a914b3ec65cead2e07eaa96f1d
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 3 18:44:13 2018 -0800

    Some clarifications on Retention documentation (#1141)

 site/docs/latest/advanced/RetentionExpiry.md | 38 +++++++++++++++++++++++-----
 1 file changed, 31 insertions(+), 7 deletions(-)

commit 3de54fd5db51d6cf03fb31ccea8266e75a3d4100
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 3 16:04:25 2018 -0800

    Introduce retries for flaky tests (#1166)
    
    * Introduce retries for flaky tests
    
    * Avoid conflicts in allocating ports across different processes
    
    * Removed duplicated builtools module after merge
    
    * Also do retries on pulsar-discovery-service

 buildtools/pom.xml                                 |  7 ++
 .../apache/pulsar/tests/AnnotationListener.java    | 35 ++++++++
 .../org/apache/pulsar/tests/RetryAnalyzer.java     | 36 +++++++++
 managed-ledger/pom.xml                             | 19 +++++
 .../org/apache/bookkeeper/test/PortManager.java    | 93 ++++++++++++++++++----
 pulsar-broker/pom.xml                              | 19 +++++
 .../pulsar/broker/service/ReplicatorTest.java      |  9 ++-
 pulsar-discovery-service/pom.xml                   | 22 +++++
 8 files changed, 222 insertions(+), 18 deletions(-)

commit 4d220d411d82738026dcb79c01145b6d90ee3b88
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Feb 3 16:04:09 2018 -0800

    Upgrade BK version: BK-4.3.1.91-yahoo (fix: stats + DoubleByteBuf) (#1170)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d482c0518f06204079024d2890a7fda3ac1b7050
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 3 08:29:33 2018 -0800

    Fixed increment partitions operation (#1153)

 .../pulsar/broker/admin/PersistentTopics.java      | 107 +++++++--------------
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  29 +++---
 .../broker/admin/IncrementPartitionsTest.java      |  95 ++++++++++++++++++
 3 files changed, 147 insertions(+), 84 deletions(-)

commit 71f281ab34e4e5f9c22ea739f327d7620d0c49c7
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Sat Feb 3 05:03:49 2018 +0900

    Add basic authentication plugin (#1087)
    
    * Add password authentication plugin
    
    * Use .htpasswd
    
    * Simplify command data
    
    * Add PulsarHttpAuthenticationException to get realm information
    
    * Addressed PR comments
    
    * Fix tests
    
    * Deleted PulsarHttpAuthenticationException
    
    * Added .htpasswd to license exclude list

 pom.xml                                            |   1 +
 .../AuthenticationProviderBasic.java               | 142 +++++++++++++++++++++
 .../api/AuthenticatedProducerConsumerTest.java     |  86 +++++++++----
 .../test/resources/authentication/basic/.htpasswd  |   2 +
 pulsar-client/pom.xml                              |   6 +
 .../client/impl/auth/AuthenticationBasic.java      |  72 +++++++++++
 .../client/impl/auth/AuthenticationDataBasic.java  |  61 +++++++++
 7 files changed, 343 insertions(+), 27 deletions(-)

commit ddd4de39446cd9d214e1112cc88e23b3ee706231
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Feb 2 12:03:12 2018 -0800

    Reader interface docs update (#1120)
    
    * add basic description in concepts/architecture doc
    
    * begin adding section to java API doc
    
    * finish draft of java API section
    
    * finish draft of concepts/architecture section
    
    * add python example
    
    * add reader interface diagram and fix incomplete sentence
    
    * use local PNG rather than lucidchart URL

 site/docs/latest/clients/Java.md                       |   4 +---
 .../latest/getting-started/ConceptsAndArchitecture.md  |   8 +++++---
 site/img/pulsar-reader-consumer-interfaces.png         | Bin 0 -> 131839 bytes
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 9a081ad9d69aa3f250d5d821ab1d8169b728eeda
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Thu Feb 1 17:17:10 2018 -0800

    Added end to end encryption in C++ client (#1129)

 .../include/pulsar/ConsumerConfiguration.h         |  10 +
 .../include/pulsar/ConsumerCryptoFailureAction.h   |  40 ++
 pulsar-client-cpp/include/pulsar/CryptoKeyReader.h |  70 ++++
 .../include/pulsar/EncryptionKeyInfo.h             |  68 +++
 .../include/pulsar/ProducerConfiguration.h         |  15 +
 .../include/pulsar/ProducerCryptoFailureAction.h   |  36 ++
 pulsar-client-cpp/include/pulsar/Result.h          |   4 +-
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |   4 +
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |  19 +
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |   6 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  55 ++-
 pulsar-client-cpp/lib/ConsumerImpl.h               |   7 +
 pulsar-client-cpp/lib/EncryptionKeyInfo.cc         |  38 ++
 pulsar-client-cpp/lib/EncryptionKeyInfoImpl.cc     |  39 ++
 pulsar-client-cpp/lib/EncryptionKeyInfoImpl.h      |  55 +++
 pulsar-client-cpp/lib/MessageCrypto.cc             | 458 +++++++++++++++++++++
 pulsar-client-cpp/lib/MessageCrypto.h              | 142 +++++++
 pulsar-client-cpp/lib/ProducerConfiguration.cc     |  28 ++
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |   9 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              |  59 ++-
 pulsar-client-cpp/lib/ProducerImpl.h               |  10 +
 pulsar-client-cpp/lib/Result.cc                    |   3 +
 pulsar-client-cpp/perf/PerfConsumer.cc             |  44 +-
 pulsar-client-cpp/perf/PerfProducer.cc             |  49 ++-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 206 +++++++++
 25 files changed, 1461 insertions(+), 13 deletions(-)

commit 034b2b2c47e7b1b42c52edeb27f8c629b4fcbb30
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Thu Feb 1 16:42:10 2018 -0700

    Project-wide Checkstyle Config (#1162)
    
    * Add projet wide checkstyle configuration
    
    * Optimize imports for managed-ledger
    
    * Clean checkstyle for managed-ledger
    
    * Revert "Clean checkstyle for managed-ledger"
    
    This reverts commit 455db2c40e055c4fd98fb2219af6b66df2217de6.
    
    * Revert "Optimize imports for managed-ledger"
    
    This reverts commit c691bc66a08176d671b340c1fee5a7bc58aae35a.
    
    * Revert wrongly merged changes
    
    * Rename builttools project to Pulsar Build Tools
    
    * Add missing license headers

 buildtools/pom.xml                                 |  36 ++
 .../src/main/resources/pulsar/checkstyle.xml       | 445 +++++++++++++++++++++
 .../src/main/resources/pulsar/suppressions.xml     |  51 +++
 pom.xml                                            |  23 ++
 4 files changed, 555 insertions(+)

commit b8fa8c1696172d619eb51f38bf66fa51c2cc4c6e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 1 14:12:42 2018 -0800

    Added missing C++ enum values (#1125)
    
    * Added missing C++ enum values
    
    * Fixed formatting

 pulsar-client-cpp/include/pulsar/Result.h | 4 +++-
 pulsar-client-cpp/lib/ClientConnection.cc | 6 ++++++
 pulsar-client-cpp/lib/Commands.cc         | 6 ++++++
 pulsar-client-cpp/lib/Result.cc           | 3 +++
 4 files changed, 18 insertions(+), 1 deletion(-)

commit 5257db083ad2a8a712424d07cb503cea64db533f
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 1 12:46:06 2018 -0800

    Remove toString() invocation in dispatcher path (#1164)

 .../java/org/apache/pulsar/broker/service/Consumer.java  |  4 ++--
 .../NonPersistentDispatcherMultipleConsumers.java        | 16 ++++++++++------
 .../NonPersistentDispatcherSingleActiveConsumer.java     | 15 ++++++---------
 .../service/nonpersistent/NonPersistentSubscription.java |  8 ++++----
 4 files changed, 22 insertions(+), 21 deletions(-)

commit 58d572797ebd780fecb1c4f4478fad1d590f14c3
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 1 11:03:56 2018 -0800

    Support Pulsar proxy from C++/Python client library (#1124)

 pulsar-client-cpp/lib/BinaryProtoLookupService.cc | 10 ++++++---
 pulsar-client-cpp/lib/ClientConnection.cc         | 25 +++++++++++++++--------
 pulsar-client-cpp/lib/ClientConnection.h          | 15 +++++++++-----
 pulsar-client-cpp/lib/ClientImpl.cc               |  6 +++++-
 pulsar-client-cpp/lib/Commands.cc                 | 10 ++++++++-
 pulsar-client-cpp/lib/Commands.h                  |  3 ++-
 pulsar-client-cpp/lib/ConnectionPool.cc           | 19 +++++++++--------
 pulsar-client-cpp/lib/ConnectionPool.h            | 19 ++++++++++++++++-
 pulsar-client-cpp/lib/HTTPLookupService.cc        |  1 +
 pulsar-client-cpp/lib/LookupDataResult.h          | 15 +++++++++++---
 pulsar-client-cpp/lib/LookupService.h             |  4 ++++
 pulsar-client-cpp/lib/Url.cc                      |  6 ++++++
 pulsar-client-cpp/lib/Url.h                       |  2 ++
 pulsar-client-cpp/lib/lz4/lz4.h                   |  5 +++++
 pulsar-client-cpp/python/test_producer.py         |  4 ++--
 15 files changed, 110 insertions(+), 34 deletions(-)

commit fb72f72e5a3eb53728b35f464fc9f0ae18cf8f65
Author: Dave Rusek <dave.rusek@gmail.com>
Date:   Thu Feb 1 10:17:02 2018 -0700

    Remove deprecation warnings related to access of PoolArenaMetric (#1161)

 .../broker/stats/AllocatorStatsGenerator.java      | 33 ++++++++++++++--------
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |  2 +-
 2 files changed, 22 insertions(+), 13 deletions(-)

commit 69d2b66c3c125216ba7bae64300b4224fec0c633
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 1 09:00:29 2018 -0800

    Fixed use of static synchronized in LoadManagerShared (#1154)

 .../broker/loadbalance/impl/LoadManagerShared.java | 62 +++++++++++++---------
 .../broker/loadbalance/impl/OverloadShedder.java   |  8 ++-
 .../pulsar/broker/service/ReplicatorTest.java      | 12 ++---
 3 files changed, 50 insertions(+), 32 deletions(-)

commit f2073d1f4922553aa0d526c12f53cfa3712ed487
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Feb 1 18:00:13 2018 +0100

    Debump netty version by 1 due to ObjectCleaner bug (#1163)
    
    The ObjectCleaner can possibly keep a process alive forever with netty
    4.1.20 since it is not a daemon thread.
    
    See: https://github.com/netty/netty/issues/7617
    
    This causes initialize-cluster-metadata to hang forever. 4.1.19
    doesn't have this issue, so we should drop down to that until the fix
    is in a release.

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1569d6175644a763296460435bc7a34bf8d3534f
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Feb 1 13:13:54 2018 +0100

    Property name in documentation is incorrect (#1133)
    
    The setup guides specify that test-prop is the property name, but then
    all later examples use test as the property name. This is obviously
    wrong, and this patch fixes that.

 site/docs/latest/deployment/instance.md | 10 +++++-----
 site/ja/deployment/InstanceSetup.md     | 12 ++++++------
 2 files changed, 11 insertions(+), 11 deletions(-)

commit 6154e3cb911154197c8850db8f2db5b99c17cc78
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 31 18:18:06 2018 -0800

    Allow to override the auto-detected NIC speed limit (#1157)

 conf/broker.conf                                   |  8 +++
 .../apache/pulsar/broker/ServiceConfiguration.java | 14 ++++-
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java | 32 ++++++++----
 .../broker/loadbalance/LoadReportNetworkLimit.java | 61 ++++++++++++++++++++++
 .../common/naming/ServiceConfigurationTest.java    | 23 ++++++--
 .../org/apache/pulsar/common/util/FieldParser.java | 11 ++--
 6 files changed, 130 insertions(+), 19 deletions(-)

commit 3191db460fb2aa4612056677e0e39d421fae34b4
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Jan 31 18:17:27 2018 -0800

    Pulsar proxy documentation (#1086)
    
    * add pulsar CLI docs to YAML config
    
    * add new pulsar proxy doc and add doc to sidebar menu
    
    * add section on concepts and architecture
    
    * finish draft of concepts/arch documentation
    
    * add basic admin instructions for proxy

 site/Gemfile                                       |  2 +-
 site/_data/cli/pulsar.yaml                         | 13 ++++++
 site/_data/sidebar.yaml                            |  2 +
 site/docs/latest/admin/Proxy.md                    | 53 ++++++++++++++++++++++
 .../getting-started/ConceptsAndArchitecture.md     | 25 ++++++++++
 5 files changed, 94 insertions(+), 1 deletion(-)

commit 7e7d0fd2acfcb8a750e9c84cd89038a0be229107
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 31 14:19:50 2018 -0800

    Links to archived releases should be using https (#1158)

 site/_config.yml | 2 +-
 site/download.md | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit e82be833c04c9e7325dfe5d86eda4d5dc375f9eb
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Jan 31 10:42:13 2018 -0800

    remove master and slave references from C++ API docs (#1140)

 pulsar-client-cpp/include/pulsar/ConsumerConfiguration.h | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 1bca601537f7a399ea8324f4e07919b00d1fc771
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 31 10:22:38 2018 -0800

    Added infinite time retention configuration option (#1135)
    
    * Added infinite time retention configuration option
    
    * Fixed test
    
    * Updated CLI docs

 .../bookkeeper/mledger/ManagedLedgerConfig.java    | 25 ++++++++++--
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 19 +++++++--
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 30 ++++++++++++--
 .../broker/service/persistent/PersistentTopic.java | 20 +++++----
 .../broker/service/PersistentTopicE2ETest.java     | 47 ++++++++++++++++++++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 18 ++++++---
 site/_data/cli/pulsar-admin.yaml                   |  8 ++--
 7 files changed, 139 insertions(+), 28 deletions(-)

commit 99fb872f2f27991de5a974a9b8434d3d6aa9366b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 31 09:13:45 2018 -0800

    In Kafka consumer wrapper, group multiple messages when the app polls (#1115)
    
    * In Kafka consumer wrapper, group multiple messages when the app polls
    
    * Fixed unit tests

 .../client/kafka/compat/tests/KafkaApiTest.java    | 20 +++---
 .../clients/consumer/PulsarKafkaConsumer.java      | 68 +++++++++++---------
 .../kafka/compat/tests/KafkaConsumerTest.java      | 72 ++++++++++++----------
 3 files changed, 91 insertions(+), 69 deletions(-)

commit 98355ca745b53f7864a9aac0ae709879d5bde48e
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 31 09:11:48 2018 -0800

    Added REST handler to create a subscription on a topic (#1151)

 .../pulsar/broker/admin/PersistentTopics.java      |  87 +++++++++++++++--
 .../broker/admin/CreateSubscriptionTest.java       | 106 +++++++++++++++++++++
 .../pulsar/client/admin/PersistentTopics.java      |  46 ++++++++-
 .../admin/internal/PersistentTopicsImpl.java       |  34 +++++--
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  34 ++++++-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  19 ++--
 6 files changed, 297 insertions(+), 29 deletions(-)

commit 55cb351599735e00f5ae9b14b819a031e505c811
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 31 07:34:20 2018 +0100

    Explicitly set zookeeper version in broker (#1132)
    
    * Explicitly set zookeeper version in broker
    
    The broker "shades" zookeeper via the aspectj stuff, but the version
    it shades is the one pulled in with bookkeeper-server, not the version
    specified in the top level pom. This is fairly harmless, but it breaks
    the pulsar zookeeper-shell command if you want to specify a zookeeper
    command from the commandline.
    
    This change explicitly pulls in the correct zookeeper version,
    excluding all the stuff that we usually exclude when pulling zookeeper.
    
    * Move to dependencyManagement
    
    Doing so stops us pulling in junit, so a test needed a fixup
    
    * changed compiler version by mistake
    
    * It actually needs netty. It pulls 3, we pull 4, they use different packages

 pom.xml                                            | 18 +++++++++--
 .../AntiAffinityNamespaceGroupTest.java            | 37 +++++++++++-----------
 2 files changed, 33 insertions(+), 22 deletions(-)

commit 8d159efa5a4f25191fade5a9fddb45a245ef2e6b
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Wed Jan 31 14:21:07 2018 +0900

    Fix MessageRouter hash inconsistent on C++/Java client (#1029)
    
    * Fix hash inconsistent on between C++ and Java clients.
    
    * Add HashingScheme to select hash function on Java client
    
    * Fix the bug of Murmur3_32Hash on C++ client
    
    * Add Javadoc on makeHash method
    
    * Use JavaStringHash as default hash on Java client
    
    * Use BoostHash as default hash on C++ client
    
    * Make hash method always returns a signed integer
    
    * Re-implement hash classes as singleton on Java client
    
    * Move hash classes from include to lib
    
    * Change constructor argument of hash classes
    
    * Remove unused headers
    
    * Remove `auto` type
    
    * Fix C++ client Hash classes so that these return non-negative signed integer
    This is the same behavior as Hash classes on Java client
    
    * Add tests for C++/Java client Hash

 .../include/pulsar/ProducerConfiguration.h         |   9 ++
 pulsar-client-cpp/lib/BoostHash.cc                 |  29 ++++++
 pulsar-client-cpp/lib/BoostHash.h                  |  39 ++++++++
 pulsar-client-cpp/lib/Hash.h                       |  37 +++++++
 pulsar-client-cpp/lib/JavaStringHash.cc            |  39 ++++++++
 pulsar-client-cpp/lib/JavaStringHash.h             |  36 +++++++
 pulsar-client-cpp/lib/MessageRouterBase.cc         |  40 ++++++++
 pulsar-client-cpp/lib/MessageRouterBase.h          |  41 ++++++++
 pulsar-client-cpp/lib/Murmur3_32Hash.cc            | 110 +++++++++++++++++++++
 pulsar-client-cpp/lib/Murmur3_32Hash.h             |  54 ++++++++++
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |   9 +-
 pulsar-client-cpp/lib/ProducerConfiguration.cc     |   9 ++
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |   2 +
 pulsar-client-cpp/lib/RoundRobinMessageRouter.cc   |   7 +-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |   9 +-
 .../lib/SinglePartitionMessageRouter.cc            |   7 +-
 .../lib/SinglePartitionMessageRouter.h             |  11 ++-
 pulsar-client-cpp/tests/HashTest.cc                |  67 +++++++++++++
 .../tests/RoundRobinMessageRouterTest.cc           |   8 +-
 .../tests/SinglePartitionMessageRouterTest.cc      |   6 +-
 .../pulsar/client/api/ProducerConfiguration.java   |  20 +++-
 .../java/org/apache/pulsar/client/impl/Hash.java   |  28 ++++++
 .../apache/pulsar/client/impl/JavaStringHash.java  |  34 +++++++
 .../pulsar/client/impl/MessageRouterBase.java      |  37 +++++++
 .../apache/pulsar/client/impl/Murmur3_32Hash.java  | 102 +++++++++++++++++++
 .../client/impl/PartitionedProducerImpl.java       |   4 +-
 .../impl/RoundRobinPartitionMessageRouterImpl.java |  10 +-
 .../impl/SinglePartitionMessageRouterImpl.java     |   9 +-
 .../org/apache/pulsar/client/impl/HashTest.java    |  49 +++++++++
 .../RoundRobinPartitionMessageRouterImplTest.java  |   5 +-
 .../impl/SinglePartitionMessageRouterImplTest.java |   5 +-
 31 files changed, 832 insertions(+), 40 deletions(-)

commit e783a58b974253603f5bee72eafc04f08732f660
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 21:19:02 2018 -0800

    Configure a max producer/consumer queue size enforced across partitions (#1123)

 .../include/pulsar/ConsumerConfiguration.h         | 15 +++++++++
 .../include/pulsar/ProducerConfiguration.h         | 16 ++++++++++
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |  8 +++++
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |  4 ++-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  6 ++++
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  5 +++
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |  2 +-
 pulsar-client-cpp/lib/ProducerConfiguration.cc     | 12 ++++++++
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |  2 ++
 .../pulsar/client/api/ConsumerConfiguration.java   | 33 +++++++++++++++++---
 .../pulsar/client/api/ProducerConfiguration.java   | 36 +++++++++++++++++-----
 .../client/impl/PartitionedConsumerImpl.java       | 10 ++++--
 .../client/impl/PartitionedProducerImpl.java       |  4 +++
 13 files changed, 136 insertions(+), 17 deletions(-)

commit 075992f93472a4f42d81587913133744282a8fcc
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 20:33:29 2018 -0800

    Shade all broker dependencies (#1077)

 pulsar-broker-shaded/pom.xml | 194 ++++++++++++++++++++++++++++++++++++-------
 1 file changed, 166 insertions(+), 28 deletions(-)

commit 94bbfda8333ac206908791cb797fe5e3999d1894
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Jan 30 20:11:40 2018 -0800

    Fix bundler version error (#1155)
    
    * update site build script to match bundler version
    
    * remove specified bundler version

 site/Makefile                      | 4 +---
 site/scripts/build-all-versions.sh | 4 +---
 2 files changed, 2 insertions(+), 6 deletions(-)

commit 60a15f85bd9a4bcc03c77c42ae8c218225b0d60d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 18:14:54 2018 -0800

    Use Optional instead of null checks when reading isolation policies (#1128)

 .../broker/loadbalance/impl/LoadManagerShared.java |  2 +-
 .../impl/SimpleResourceAllocationPolicies.java     | 58 ++++++++++++----------
 2 files changed, 33 insertions(+), 27 deletions(-)

commit dde58652aa441afb86e4d9b0541df8222b648ab0
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Jan 30 16:09:37 2018 -0800

    Making Pulsar Proxy more secure (#1002)

 .../broker/authorization/AuthorizationManager.java |  72 ++-
 .../pulsar/broker/admin/PersistentTopics.java      |   2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    | 635 ++++++++++++---------
 .../org/apache/pulsar/common/api/Commands.java     |  54 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 188 ++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   9 +-
 .../pulsar/proxy/server/LookupProxyHandler.java    | 167 ++++--
 .../pulsar/proxy/server/ProxyConfiguration.java    |  22 +-
 .../apache/pulsar/proxy/server/ProxyService.java   |  31 +-
 .../pulsar/proxy/server/ProxyServiceStarter.java   |   9 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |   7 +-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |   5 +
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |   5 +-
 .../server/ProxyWithProxyAuthorizationNegTest.java | 250 ++++++++
 .../server/ProxyWithProxyAuthorizationTest.java    | 238 ++++++++
 .../server/ProxyWithoutServiceDiscoveryTest.java   | 208 +++++++
 .../broker-cert.pem                                |  72 +++
 .../ProxyWithProxyAuthorizationTest/broker-key.pem |  28 +
 .../tls/ProxyWithProxyAuthorizationTest/cacert.pem |  62 ++
 .../client-cert.pem                                |  72 +++
 .../ProxyWithProxyAuthorizationTest/client-key.pem |  28 +
 .../ProxyWithProxyAuthorizationTest/proxy-cert.pem |  72 +++
 .../ProxyWithProxyAuthorizationTest/proxy-key.pem  |  28 +
 23 files changed, 1879 insertions(+), 385 deletions(-)

commit c86aeedda64f18577b90dd615cd9b7fd6cf00425
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 15:49:18 2018 -0800

    Use Apache dist server with HTTPS to link the release signatures (#1148)

 site/download.md | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

commit 0439a1fa425dae46c6cb6298b4d21ee662f72e11
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 31 00:48:55 2018 +0100

    Update maven compiler plugin to newest version (#1042)
    
    * Update maven compiler plugin to newest version
    
    The previously used version doesn't handle the errors from newer jdk
    versions, so if there's a error you can't see what's actually wrong.
    
    * Let aspectJ bind to correct phase
    
    It was binding to process-sources before, which makes no sense since
    it works on the class files. Removed the phase specification, which
    allows it to bind to compile (as it does by default).

 pom.xml                  | 2 +-
 pulsar-broker/pom.xml    | 1 -
 pulsar-zookeeper/pom.xml | 1 -
 3 files changed, 1 insertion(+), 3 deletions(-)

commit 53fa9d0d460ae2c490ea7e58f102869342b43ff6
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Jan 30 12:44:44 2018 -0800

    Add StatefulSet option for BookKeeper on Google Kubernetes Engine (#1047)
    
    * add statefulset bookie config
    
    * re-add daemonset config
    
    * fix indentation issue
    
    * return to original pulsar env vars
    
    * fix minor indentation issues
    
    * fix metadata label issue
    
    * revert to original Deployment definition
    
    * add load balancer service
    
    * use only one bookie.yaml config
    
    * add proxy and cluster metadata configs
    
    * specify cluster metadata initialization as a Job rather than Pod
    
    * create separate storage classes for ledger and journal
    
    * fix YAML indentation issue
    
    * update docs for pulsar-admin pod
    
    * more documentation updates
    
    * update cluster metadata initialization instructions
    
    * add reference to pulsar proxy in docs
    
    * one more small doc update
    
    * avoid name clash in StorageClass definitions
    
    * add selector to statefulset definition in bookie.yaml
    
    * add pod antiaffinity to bookie config
    
    * remove headless Service definition for bookies
    
    * update statefulset to eliminate advertisedAddress
    
    * Added ASF header
    
    * Added ASF header
    
    * move stray YAML files into /deployment
    
    * change containers/initContainers order in config for readability
    
    * add section on client connections

 .../google-kubernetes-engine/bookie.yaml           | 281 +++++++++++----------
 .../google-kubernetes-engine/broker.yaml           |   4 +-
 .../google-kubernetes-engine/cluster-metadata.yaml |  42 +++
 .../kubernetes/google-kubernetes-engine/proxy.yaml |  84 ++++++
 .../google-kubernetes-engine/zookeeper.yaml        |   4 +-
 site/docs/latest/deployment/Kubernetes.md          |  96 +++++--
 6 files changed, 350 insertions(+), 161 deletions(-)

commit d6d4fa3a1103f650bf16e74429f82db3d33fe739
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 11:06:38 2018 -0800

    Use Optional<String> for returning least loaded broker (#1122)
    
    * Use Optional<String> for returning least loaded broker
    
    * Addressed comments
    
    * Fixed unit tests
    
    * More test fixes

 .../pulsar/broker/loadbalance/LoadManager.java     |  3 +-
 .../broker/loadbalance/ModularLoadManager.java     | 14 ++++---
 .../loadbalance/ModularLoadManagerStrategy.java    |  7 ++--
 .../loadbalance/impl/LeastLongTermMessageRate.java | 15 ++++++--
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 44 ++++++++++++----------
 .../impl/ModularLoadManagerWrapper.java            | 14 +++++--
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 17 +++++----
 .../pulsar/broker/namespace/NamespaceService.java  | 22 +++++------
 .../AntiAffinityNamespaceGroupTest.java            | 38 +++++++++----------
 .../broker/loadbalance/LoadBalancerTest.java       | 12 +++---
 .../loadbalance/ModularLoadManagerImplTest.java    | 32 ++++++++--------
 .../ModularLoadManagerStrategyTest.java            | 11 +++---
 .../loadbalance/SimpleLoadManagerImplTest.java     | 20 ++++------
 .../pulsar/client/api/BrokerServiceLookupTest.java | 13 ++++---
 .../pulsar/client/api/NonPersistentTopicTest.java  |  4 +-
 15 files changed, 143 insertions(+), 123 deletions(-)

commit 53619ff1923ff41aedb273dacb9312d973b5fb09
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 11:06:11 2018 -0800

    Validate expected types in Python code wrapper (#1097)
    
    * Validate expected types in Python code wrapper
    
    * Address comments
    
    * Left a couple of checks in old format
    
    * More compact unit tests
    
    * Fixed checks for producer_name which can be None

 pulsar-client-cpp/python/pulsar.py      | 58 ++++++++++++++++++++++
 pulsar-client-cpp/python/pulsar_test.py | 85 ++++++++++++++++++++++++++++++++-
 2 files changed, 142 insertions(+), 1 deletion(-)

commit 650a6b836cb2d3003dd8dccee2f9fd90a88f3fc5
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 30 09:08:18 2018 -0800

    Publish pulsar-client-admin as a shaded artifact (#1095)

 pom.xml                            |   1 +
 pulsar-broker-shaded/pom.xml       |   2 +-
 pulsar-broker/pom.xml              |   2 +-
 pulsar-client-admin-shaded/pom.xml | 194 +++++++++++++++++++++++++++++++++++++
 pulsar-client-admin/pom.xml        |  62 +-----------
 pulsar-client-tools/pom.xml        |   2 +-
 pulsar-testclient/pom.xml          |   2 +-
 7 files changed, 201 insertions(+), 64 deletions(-)

commit 8c93ff8529eefcfbc452f3147bae8351d5bc9b2c
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Jan 31 02:07:59 2018 +0900

    Fix url option on client tool (#1146)

 .../src/main/java/org/apache/pulsar/client/cli/PulsarClientTool.java   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 059149c494592a3913a4fb24ed6939e1b068fc58
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 29 20:12:09 2018 -0800

    Fix race condition in testRedeliveryOnBlockedDistpatcher (#1144)

 .../client/api/DispatcherBlockConsumerTest.java    | 52 ++++++++++------------
 1 file changed, 23 insertions(+), 29 deletions(-)

commit 8a2b2f0389554e0cf32960e175686a87e170e4a2
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 29 18:02:24 2018 -0800

    Add timeouts to setup & teardown for ReplicatorTest (#1139)

 .../test/java/org/apache/pulsar/broker/service/ReplicatorTest.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit a499850b3415add489d702bd61f92288b4f41f60
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jan 29 21:01:19 2018 +0100

    Compact algo (#1044)
    
    * Compaction algorithm for Pulsar
    
    Compaction will go through the topic in two passes. The first pass
    selects latest offset for each key in the topic. Then the second pass
    writes these values to a ledger.
    
    The two passes are required to avoid holding the payloads of each of
    the latest values in memory, as the payload can be many orders of
    magnitude larger than a message id.
    
    * fix nits
    
    * fixup for compactor, empty test
    
    * Shade plugin doesn't like CompletableFuture<?>, which is weird
    
    * Address @rdhabalia comments
    
    * Fix stupid compile error

 .../org/apache/pulsar/client/api/RawMessage.java   |   6 +-
 .../apache/pulsar/client/impl/RawMessageImpl.java  |  16 +-
 .../org/apache/pulsar/compaction/Compactor.java    |  86 +++++++
 .../pulsar/compaction/TwoPhaseCompactor.java       | 285 +++++++++++++++++++++
 .../pulsar/client/impl/RawMessageSerDeserTest.java |   2 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   |   2 +-
 .../apache/pulsar/compaction/CompactorTest.java    | 223 ++++++++++++++++
 7 files changed, 609 insertions(+), 11 deletions(-)

commit b3fe055942b4bd4b8befc96b347140fdfe276f73
Author: Ivan Kelly <ivank@apache.org>
Date:   Mon Jan 29 18:39:30 2018 +0100

    Comment in config breaks docker scripts (#1131)
    
    docker/scripts/apply-config-from-env.py only accepts # comments, not
    double slash.

 conf/broker.conf | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 4e60a98375dc461c891693c5ff0dbc198e80a645
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jan 27 09:33:24 2018 -0800

    Remove stack traces from topic lookup errors during unloads (#1121)

 .../pulsar/broker/lookup/DestinationLookup.java    | 24 ++++++++++++++++------
 1 file changed, 18 insertions(+), 6 deletions(-)

commit 57e9d397c0d35b315bfcd2c71360e257a4739778
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Jan 26 11:25:09 2018 -0800

    Reader interface documentation (#1096)
    
    * add basic description in concepts/architecture doc
    
    * begin adding section to java API doc
    
    * finish draft of java API section
    
    * finish draft of concepts/architecture section
    
    * add python example

 site/docs/latest/clients/Java.md                   | 40 +++++++++++++----
 site/docs/latest/clients/Python.md                 | 16 +++++++
 .../getting-started/ConceptsAndArchitecture.md     | 51 ++++++++++++++++++++++
 3 files changed, 99 insertions(+), 8 deletions(-)

commit 4e0812bcaa4ad7a7f233cef307fe761bb787edc2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jan 25 23:22:49 2018 -0800

    Add api to get list of non-persistent topics (#1114)

 .../pulsar/broker/admin/NonPersistentTopics.java   | 106 +++++++++++++++++++++
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  25 +++++
 .../pulsar/client/admin/NonPersistentTopics.java   |  39 ++++++++
 .../admin/internal/NonPersistentTopicsImpl.java    |  67 ++++++++++++-
 .../pulsar/admin/cli/CmdNonPersistentTopics.java   |  30 ++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   6 ++
 6 files changed, 271 insertions(+), 2 deletions(-)

commit 53bbf288b6715c659103e5bc5fe290a17df53ffe
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Jan 25 17:29:34 2018 -0800

    update assembly src.xml to reflect new directory structure (#1109)

 all/src/assemble/src.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d66e427ed9a58d6ab7017b230c6221be15314933
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 25 17:19:50 2018 -0800

    Increase client setting concurrentLookupRequest default to 50K (#1116)

 pulsar-client-cpp/include/pulsar/ClientConfiguration.h   |  2 +-
 pulsar-client-cpp/lib/ClientConfigurationImpl.h          |  2 +-
 pulsar-client-cpp/python/pulsar.py                       |  2 +-
 .../apache/pulsar/client/api/ClientConfiguration.java    | 16 ++++++++--------
 4 files changed, 11 insertions(+), 11 deletions(-)

commit 1d10e696218c4f0ce2bc810a687fe14baf5295db
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jan 25 15:30:19 2018 -0800

    Fix: deadlock while closing non-persistent topic (#1113)

 .../apache/pulsar/broker/service/nonpersistent/NonPersistentTopic.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 40d37b10731707724b28f11254c4a72697f57bee
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 25 13:55:24 2018 -0800

    Fix ByteBufPair encoder to release buffers (#1110)

 .../pulsar/broker/service/ReplicatorTest.java      | 24 +++++++--------
 .../org/apache/pulsar/common/api/ByteBufPair.java  |  9 ++++--
 .../apache/pulsar/common/api/ByteBufPairTest.java  | 35 +++++++++++++++++++++-
 3 files changed, 53 insertions(+), 15 deletions(-)

commit ed488b266c9dc63ca4728ee171dd58421727d9d7
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 24 21:23:14 2018 -0800

    Set loadBalancerEnabled=true in ServiceConfiguration (#1104)
    
    * Set loadBalancerEnabled=true in ServiceConfiguration
    
    * Fixed tests to run with same settings as before
    
    * One more test config fix

 .../src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java   | 2 +-
 .../src/test/java/org/apache/pulsar/broker/SLAMonitoringTest.java      | 1 +
 .../java/org/apache/pulsar/broker/loadbalance/LoadBalancerTest.java    | 3 ++-
 3 files changed, 4 insertions(+), 2 deletions(-)

commit 72432ce7bb6ebbccb104147f3110a14f51c0a04c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 24 21:00:54 2018 -0800

    Advertise localhost address for unit test (#1105)
    
    * Advertise localhost address for unit test
    
    * fix test

 .../src/test/java/org/apache/pulsar/broker/SLAMonitoringTest.java   | 1 +
 .../org/apache/pulsar/broker/auth/MockedPulsarServiceBaseTest.java  | 1 +
 .../java/org/apache/pulsar/broker/loadbalance/LoadBalancerTest.java | 1 +
 .../org/apache/pulsar/broker/service/AdvertisedAddressTest.java     | 1 +
 .../org/apache/pulsar/broker/service/BacklogQuotaManagerTest.java   | 1 +
 .../org/apache/pulsar/broker/service/BrokerBkEnsemblesTests.java    | 1 +
 .../java/org/apache/pulsar/broker/service/ReplicatorTestBase.java   | 3 +++
 .../src/test/java/org/apache/pulsar/broker/web/WebServiceTest.java  | 1 +
 .../java/org/apache/pulsar/client/api/BrokerServiceLookupTest.java  | 6 ++++++
 .../java/org/apache/pulsar/client/api/NonPersistentTopicTest.java   | 3 +++
 10 files changed, 19 insertions(+)

commit 574ebdebaf0df57da7ee3f3fd19496124ae8cae7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 24 21:00:43 2018 -0800

    Fix: ignore auth flag for websocket-proxy to broker authentication (#1106)

 .../src/main/java/org/apache/pulsar/websocket/WebSocketService.java    | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit f57cd88d82e4412d6031301bc1b1818b3a0cbcfe
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 24 18:19:57 2018 -0800

    Log only first exception in the connection exception handler (#1107)

 .../apache/pulsar/broker/service/ServerCnx.java    | 16 ++++++++++++++--
 .../org/apache/pulsar/client/impl/ClientCnx.java   | 22 ++++++++++++++++++++--
 2 files changed, 34 insertions(+), 4 deletions(-)

commit e1ad269f32334a274565c95f0745468d58a2720b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 24 18:19:24 2018 -0800

    Fixed race condition between write operation and send timeout (#1108)

 .../java/org/apache/pulsar/client/impl/ProducerImpl.java   | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

commit 6bb98344ca48f81aaf403372400cb38013616e9d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 24 17:59:58 2018 -0800

    PIP-7 Introduce Failure-domain and Anti-affinity-namespace group (#896)
    
    * Introduce Failure-domain and Anti-affinity-namespace group

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  11 +
 .../broker/cache/ConfigurationCacheService.java    |  50 ++
 .../org/apache/pulsar/broker/PulsarService.java    |   2 +-
 .../apache/pulsar/broker/admin/AdminResource.java  |  24 +-
 .../org/apache/pulsar/broker/admin/Clusters.java   | 219 ++++++++-
 .../org/apache/pulsar/broker/admin/Namespaces.java | 140 +++++-
 .../broker/loadbalance/impl/LoadManagerShared.java | 242 ++++++++-
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 104 +++-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   2 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  21 +-
 .../apache/pulsar/broker/SLAMonitoringTest.java    |   2 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  16 +-
 .../apache/pulsar/broker/admin/AdminApiTest2.java  |  71 ++-
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  11 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |   2 +-
 .../pulsar/broker/auth/AuthorizationTest.java      |   2 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   4 +-
 .../AntiAffinityNamespaceGroupTest.java            | 540 +++++++++++++++++++++
 .../loadbalance/ModularLoadManagerImplTest.java    |  14 +-
 .../broker/service/BacklogQuotaManagerTest.java    |   2 +-
 .../broker/service/BrokerBkEnsemblesTests.java     |   2 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |   6 +-
 .../ZooKeeperSessionExpireRecoveryTest.java        |   8 +-
 .../api/AuthenticatedProducerConsumerTest.java     |  10 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  |   9 +-
 .../pulsar/client/api/TlsProducerConsumerBase.java |   5 +-
 .../service/web/DiscoveryServiceWebTest.java       |   4 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |   7 +-
 .../org/apache/pulsar/client/admin/Clusters.java   | 132 +++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  72 +++
 .../pulsar/client/admin/internal/ClustersImpl.java |  46 ++
 .../client/admin/internal/NamespacesImpl.java      |  49 ++
 .../org/apache/pulsar/admin/cli/CmdClusters.java   |  85 ++++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  64 +++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  32 ++
 .../pulsar/common/policies/data/FailureDomain.java |  52 ++
 .../pulsar/common/policies/data/Policies.java      |   5 +-
 .../ProxyAuthenticatedProducerConsumerTest.java    |   5 +-
 40 files changed, 1975 insertions(+), 103 deletions(-)

commit f5a2ec74e834e50f1970927f8fa6c107f7a3453c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 24 13:38:39 2018 -0800

    Introduce config to skip non-recoverable data-ledger (#1046)

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  15 +++
 .../bookkeeper/mledger/ManagedLedgerException.java |  13 +++
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  11 +-
 .../bookkeeper/mledger/impl/EntryCacheManager.java |   3 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  25 +++--
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |   3 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  50 +++++++--
 .../bookkeeper/mledger/impl/OpReadEntry.java       |  25 ++++-
 .../apache/pulsar/broker/ServiceConfiguration.java |  12 ++
 .../pulsar/broker/service/BrokerService.java       |  26 +++++
 .../broker/service/BrokerBkEnsemblesTests.java     | 125 ++++++++++++++++++++-
 site/_data/config/broker.yaml                      |   3 +
 site/_data/config/standalone.yaml                  |   2 +
 15 files changed, 287 insertions(+), 32 deletions(-)

commit da4bd4ae3032159a3b8fe26f05e8067b3172b7c5
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu Jan 25 05:05:22 2018 +0900

    Support ztsUrl parameter in athenz client plugin (#1099)

 .../org/apache/pulsar/client/impl/auth/AuthenticationAthenz.java  | 6 +++++-
 .../apache/pulsar/client/impl/auth/AuthenticationAthenzTest.java  | 8 ++++++++
 pulsar-client-auth-athenz/src/test/resources/authParams.json      | 3 ++-
 3 files changed, 15 insertions(+), 2 deletions(-)

commit a6e02bf7444992981a827d2eab550674ba014ed9
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 24 08:53:59 2018 -0800

    Include BoringSSL native implementation for faster TLS (#1094)

 pom.xml                                                             | 2 +-
 .../main/java/org/apache/pulsar/broker/service/BrokerService.java   | 4 +++-
 .../java/org/apache/pulsar/broker/service/BrokerServiceTest.java    | 2 +-
 pulsar-client-shaded/pom.xml                                        | 2 ++
 pulsar-common/pom.xml                                               | 6 ++++++
 5 files changed, 13 insertions(+), 3 deletions(-)

commit a7dadd503a0d4d9e89f61d5194177c105667a3f7
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Wed Jan 24 15:15:13 2018 +0900

    ENH: Apply `make format` into C++ client (#1080)
    
    * Change clang-format options
    
    * Exclude the files generated by protobuf from `make format`
    
    * ENH: Apply `make format` into C++ client
    
    * Change clang-format version to 5.0
    
    * Use gpg2 when docker build
    See https://github.com/rvm/rvm/issues/3544
    
    * Apply clang-format-5.0
    
    * Use `make check-format` on docker-build.sh
    
    * Fix typo

 build/docker/Dockerfile                            |   5 +-
 pulsar-client-cpp/.clang-format                    |   7 +-
 pulsar-client-cpp/CMakeLists.txt                   |   4 +-
 .../build-support/clang_format_exclusions.txt      |   2 +
 pulsar-client-cpp/docker-build.sh                  |   2 +-
 pulsar-client-cpp/docs/MainPage.md                 |   2 +-
 pulsar-client-cpp/include/pulsar/Authentication.h  |  90 +--
 pulsar-client-cpp/include/pulsar/BatchMessageId.h  |  15 +-
 .../include/pulsar/BrokerConsumerStats.h           |  15 +-
 pulsar-client-cpp/include/pulsar/Client.h          |  45 +-
 .../include/pulsar/ClientConfiguration.h           |  13 +-
 pulsar-client-cpp/include/pulsar/CompressionType.h |   3 +-
 pulsar-client-cpp/include/pulsar/Consumer.h        |  45 +-
 .../include/pulsar/ConsumerConfiguration.h         |  17 +-
 pulsar-client-cpp/include/pulsar/ConsumerType.h    |  33 +-
 .../include/pulsar/DeprecatedException.h           |  16 +-
 pulsar-client-cpp/include/pulsar/Message.h         |  29 +-
 pulsar-client-cpp/include/pulsar/MessageBuilder.h  |   9 +-
 pulsar-client-cpp/include/pulsar/MessageId.h       |  15 +-
 .../include/pulsar/MessageRoutingPolicy.h          |  11 +-
 pulsar-client-cpp/include/pulsar/Producer.h        |  10 +-
 .../include/pulsar/ProducerConfiguration.h         |  15 +-
 pulsar-client-cpp/include/pulsar/Reader.h          |   8 +-
 .../include/pulsar/ReaderConfiguration.h           |  16 +-
 pulsar-client-cpp/include/pulsar/Result.h          |  39 +-
 pulsar-client-cpp/include/pulsar/TopicMetadata.h   |   4 +-
 pulsar-client-cpp/lib/Authentication.cc            | 203 +++----
 pulsar-client-cpp/lib/Backoff.cc                   |  15 +-
 pulsar-client-cpp/lib/Backoff.h                    |  13 +-
 .../lib/BatchAcknowledgementTracker.cc             |  60 +-
 .../lib/BatchAcknowledgementTracker.h              |  55 +-
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |  67 +--
 pulsar-client-cpp/lib/BatchMessageContainer.h      |  51 +-
 pulsar-client-cpp/lib/BatchMessageId.cc            |  23 +-
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  | 193 +++---
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |  23 +-
 pulsar-client-cpp/lib/BlockingQueue.h              |  94 +--
 pulsar-client-cpp/lib/BrokerConsumerStats.cc       |  73 +--
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.cc   | 153 ++---
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.h    |  19 +-
 .../lib/BrokerConsumerStatsImplBase.h              |  64 +-
 pulsar-client-cpp/lib/Client.cc                    |  30 +-
 pulsar-client-cpp/lib/ClientConfiguration.cc       |  59 +-
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    |  21 +-
 pulsar-client-cpp/lib/ClientConnection.cc          | 470 +++++++--------
 pulsar-client-cpp/lib/ClientConnection.h           |  36 +-
 pulsar-client-cpp/lib/ClientImpl.cc                | 621 ++++++++++----------
 pulsar-client-cpp/lib/ClientImpl.h                 |  32 +-
 pulsar-client-cpp/lib/Commands.cc                  |  58 +-
 pulsar-client-cpp/lib/Commands.h                   |  35 +-
 pulsar-client-cpp/lib/CompressionCodec.cc          |   7 +-
 pulsar-client-cpp/lib/CompressionCodec.h           |  18 +-
 pulsar-client-cpp/lib/CompressionCodecLZ4.cc       |   7 +-
 pulsar-client-cpp/lib/CompressionCodecLZ4.h        |   5 +-
 pulsar-client-cpp/lib/CompressionCodecZLib.cc      |  10 +-
 pulsar-client-cpp/lib/CompressionCodecZLib.h       |   5 +-
 pulsar-client-cpp/lib/ConnectionPool.cc            |  31 +-
 pulsar-client-cpp/lib/ConnectionPool.h             |  11 +-
 pulsar-client-cpp/lib/Consumer.cc                  |  18 +-
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |  41 +-
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |  15 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              | 245 ++++----
 pulsar-client-cpp/lib/ConsumerImpl.h               |  35 +-
 pulsar-client-cpp/lib/ConsumerImplBase.h           |  11 +-
 pulsar-client-cpp/lib/DeprecatedException.cc       |  10 +-
 pulsar-client-cpp/lib/DestinationName.cc           | 286 +++++----
 pulsar-client-cpp/lib/DestinationName.h            |  75 ++-
 pulsar-client-cpp/lib/ExecutorService.cc           |  26 +-
 pulsar-client-cpp/lib/ExecutorService.h            |  18 +-
 pulsar-client-cpp/lib/Future.h                     |  31 +-
 pulsar-client-cpp/lib/HTTPLookupService.cc         | 355 +++++------
 pulsar-client-cpp/lib/HTTPLookupService.h          |  58 +-
 pulsar-client-cpp/lib/HandlerBase.cc               |  55 +-
 pulsar-client-cpp/lib/HandlerBase.h                |  26 +-
 pulsar-client-cpp/lib/Latch.cc                     |  14 +-
 pulsar-client-cpp/lib/Latch.h                      |   4 +-
 pulsar-client-cpp/lib/LogUtils.cc                  |   9 +-
 pulsar-client-cpp/lib/LogUtils.h                   |  82 ++-
 pulsar-client-cpp/lib/LookupDataResult.h           |  57 +-
 pulsar-client-cpp/lib/LookupService.h              |   6 +-
 pulsar-client-cpp/lib/Message.cc                   |  57 +-
 pulsar-client-cpp/lib/MessageBuilder.cc            |  23 +-
 pulsar-client-cpp/lib/MessageId.cc                 |  25 +-
 pulsar-client-cpp/lib/MessageImpl.cc               |  99 ++--
 pulsar-client-cpp/lib/MessageImpl.h                |   8 +-
 pulsar-client-cpp/lib/NamedEntity.h                |   5 +-
 pulsar-client-cpp/lib/NamespaceName.cc             |  21 +-
 pulsar-client-cpp/lib/NamespaceName.h              |  13 +-
 pulsar-client-cpp/lib/ObjectPool.h                 |  88 ++-
 .../lib/PartitionedBrokerConsumerStatsImpl.cc      | 216 ++++---
 .../lib/PartitionedBrokerConsumerStatsImpl.h       |  11 +-
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   | 650 ++++++++++-----------
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    | 148 +++--
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   | 351 ++++++-----
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |  39 +-
 pulsar-client-cpp/lib/Producer.cc                  |  23 +-
 pulsar-client-cpp/lib/ProducerConfiguration.cc     |  46 +-
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |  22 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              | 177 +++---
 pulsar-client-cpp/lib/ProducerImpl.h               |  27 +-
 pulsar-client-cpp/lib/ProducerImplBase.h           |  27 +-
 pulsar-client-cpp/lib/Reader.cc                    |  15 +-
 pulsar-client-cpp/lib/ReaderConfiguration.cc       |  37 +-
 pulsar-client-cpp/lib/ReaderConfigurationImpl.h    |   8 +-
 pulsar-client-cpp/lib/ReaderImpl.cc                |  39 +-
 pulsar-client-cpp/lib/ReaderImpl.h                 |  15 +-
 pulsar-client-cpp/lib/Result.cc                    |   4 +-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.cc   |  29 +-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |  27 +-
 pulsar-client-cpp/lib/ServiceUnitId.h              |   5 +-
 pulsar-client-cpp/lib/SharedBuffer.h               | 122 ++--
 .../lib/SinglePartitionMessageRouter.cc            |  28 +-
 .../lib/SinglePartitionMessageRouter.h             |  22 +-
 pulsar-client-cpp/lib/TopicMetadataImpl.cc         |  10 +-
 pulsar-client-cpp/lib/TopicMetadataImpl.h          |   6 +-
 .../lib/UnAckedMessageTrackerDisabled.h            |  19 +-
 .../lib/UnAckedMessageTrackerEnabled.cc            |  20 +-
 .../lib/UnAckedMessageTrackerEnabled.h             |   7 +-
 .../lib/UnAckedMessageTrackerInterface.h           |  11 +-
 pulsar-client-cpp/lib/UnboundedBlockingQueue.h     |  36 +-
 pulsar-client-cpp/lib/Url.cc                       |  44 +-
 pulsar-client-cpp/lib/Url.h                        |   9 +-
 pulsar-client-cpp/lib/UtilAllocator.h              |  26 +-
 pulsar-client-cpp/lib/Utils.h                      |  64 +-
 pulsar-client-cpp/lib/auth/AuthAthenz.cc           | 124 ++--
 pulsar-client-cpp/lib/auth/AuthAthenz.h            |  55 +-
 pulsar-client-cpp/lib/auth/AuthTls.cc              |  59 +-
 pulsar-client-cpp/lib/auth/AuthTls.h               |  53 +-
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc     | 513 ++++++++--------
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.h      |  71 +--
 pulsar-client-cpp/lib/checksum/ChecksumProvider.cc |  19 +-
 pulsar-client-cpp/lib/checksum/ChecksumProvider.h  |   8 +-
 pulsar-client-cpp/lib/checksum/crc32c_sse42.cc     | 122 ++--
 pulsar-client-cpp/lib/checksum/crc32c_sse42.h      |  23 +-
 pulsar-client-cpp/lib/checksum/crc32c_sw.cc        |  16 +-
 pulsar-client-cpp/lib/checksum/int_types.h         |  12 +-
 pulsar-client-cpp/lib/lz4/lz4.h                    | 207 ++++---
 pulsar-client-cpp/lib/stats/ConsumerStatsBase.h    |   6 +-
 .../lib/stats/ConsumerStatsDisabled.h              |   2 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.cc   |  57 +-
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.h    |  23 +-
 pulsar-client-cpp/lib/stats/ProducerStatsBase.h    |   8 +-
 .../lib/stats/ProducerStatsDisabled.h              |  11 +-
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.cc   |  97 ++-
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h    |  53 +-
 pulsar-client-cpp/tests/AuthPluginTest.cc          |  69 ++-
 pulsar-client-cpp/tests/BackoffTest.cc             |  10 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 269 ++++-----
 pulsar-client-cpp/tests/BatchMessageTest.cc        | 289 ++++-----
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |   3 +-
 pulsar-client-cpp/tests/BlockingQueueTest.cc       |  34 +-
 pulsar-client-cpp/tests/ClientDeduplicationTest.cc |  29 +-
 pulsar-client-cpp/tests/ClientTest.cc              |  34 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |  48 +-
 pulsar-client-cpp/tests/ConsumerTest.h             |   6 +-
 pulsar-client-cpp/tests/CustomRoutingPolicy.h      |  10 +-
 pulsar-client-cpp/tests/DestinationNameTest.cc     |  44 +-
 pulsar-client-cpp/tests/HttpHelper.cc              |  13 +-
 pulsar-client-cpp/tests/HttpHelper.h               |   1 -
 pulsar-client-cpp/tests/LatchTest.cc               |  12 +-
 pulsar-client-cpp/tests/MessageTest.cc             |  14 +-
 pulsar-client-cpp/tests/PulsarFriend.h             |  16 +-
 pulsar-client-cpp/tests/ReaderTest.cc              |   5 +-
 .../tests/RoundRobinMessageRouterTest.cc           |   6 +-
 .../tests/SinglePartitionMessageRouterTest.cc      |   6 +-
 pulsar-client-cpp/tests/UrlTest.cc                 |   8 +-
 pulsar-client-cpp/tests/ZTSClientTest.cc           |  20 +-
 pulsar-client-cpp/tests/mocks/GMockMessage.h       |  16 +-
 168 files changed, 4489 insertions(+), 5200 deletions(-)

commit be7ba467854e630a044d7a62b0026a49413bb358
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Jan 23 16:48:46 2018 -0800

    Consolidate deployment assets into a single directory (#1098)

 {deploy => deployment}/dcos/PulsarGroups.json                         | 0
 {kubernetes => deployment/kubernetes}/README.md                       | 0
 {kubernetes => deployment/kubernetes}/generic/bookie.yaml             | 0
 {kubernetes => deployment/kubernetes}/generic/broker.yaml             | 0
 {kubernetes => deployment/kubernetes}/generic/monitoring.yaml         | 0
 {kubernetes => deployment/kubernetes}/generic/proxy.yaml              | 0
 {kubernetes => deployment/kubernetes}/generic/zookeeper.yaml          | 0
 .../kubernetes}/google-kubernetes-engine/bookie.yaml                  | 0
 .../kubernetes}/google-kubernetes-engine/broker.yaml                  | 0
 .../kubernetes}/google-kubernetes-engine/monitoring.yaml              | 0
 .../kubernetes}/google-kubernetes-engine/zookeeper.yaml               | 0
 site/docs/latest/deployment/Kubernetes.md                             | 2 +-
 site/docs/latest/deployment/dcos.md                                   | 4 ++--
 13 files changed, 3 insertions(+), 3 deletions(-)

commit 3396abc05dd59f56a1e3d2f41277eda047c7a255
Author: cckellogg <cckellogg@gmail.com>
Date:   Tue Jan 23 09:42:15 2018 -0800

    Allow topic metrics to be exported to prometheus optionally. (#1064)

 conf/broker.conf                                   |  6 ++
 conf/standalone.conf                               |  6 ++
 .../apache/pulsar/broker/ServiceConfiguration.java | 13 ++++
 .../org/apache/pulsar/broker/PulsarService.java    |  3 +-
 .../stats/prometheus/AggregatedNamespaceStats.java | 33 ++++++++
 .../stats/prometheus/NamespaceStatsAggregator.java | 22 +++---
 .../prometheus/PrometheusMetricsGenerator.java     |  9 ++-
 .../stats/prometheus/PrometheusMetricsServlet.java |  7 +-
 .../pulsar/broker/stats/prometheus/TopicStats.java | 89 ++++++++++++++++++++++
 9 files changed, 172 insertions(+), 16 deletions(-)

commit 5a8103ae6877c61cb3758a654efbf4ce659a9906
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jan 22 21:33:04 2018 -0800

    Upgrade BK version: 4.3.1.85-yahoo with Double bytebuf fix (#1093)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0d20924c24f99a3b446f42ee8ad66c71b8327f03
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jan 19 00:20:46 2018 -0800

    Fixed some of the warnings in Maven build (#1085)

 .../apache/pulsar/broker/admin/AdminApiTest.java   | 22 ++++++++--------
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  2 +-
 .../apache/pulsar/broker/web/WebServiceTest.java   |  2 --
 .../pulsar/client/api/BrokerServiceLookupTest.java | 13 ++++++++--
 .../client/impl/auth/AuthenticationAthenz.java     | 21 +++++++--------
 .../client/impl/auth/AuthenticationDataAthenz.java |  2 ++
 .../apache/pulsar/client/api/Authentication.java   |  2 --
 .../pulsar/client/api/AuthenticationFactory.java   |  2 ++
 .../org/apache/pulsar/client/impl/HttpClient.java  |  4 +--
 .../pulsar/client/impl/auth/AuthenticationTls.java |  6 +++--
 .../org/apache/pulsar/common/stats/Metrics.java    |  4 ++-
 .../discovery/service/BaseDiscoveryTestSetup.java  | 18 ++++++-------
 .../discovery/service/web/BaseZKStarterTest.java   |  2 +-
 .../pulsar/zookeeper/ZookeeperCacheTest.java       | 30 ++++++++--------------
 14 files changed, 67 insertions(+), 63 deletions(-)

commit b5392be7be09fc838b230afeccec356815229f9f
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 18 21:49:29 2018 -0800

    Enforce the validation of Pulsar configuration (#1084)
    
    * Enforce the validation of Pulsar configuration
    
    * Fixed isEmpty logic
    
    * Some tests fixes

 .../configuration/PulsarConfigurationLoader.java   | 44 +++++++++++++++++-----
 .../org/apache/pulsar/PulsarStandaloneStarter.java |  2 +-
 .../org/apache/pulsar/broker/PulsarService.java    |  4 ++
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  4 +-
 .../apache/pulsar/broker/web/WebServiceTest.java   |  1 +
 .../pulsar/client/api/BrokerServiceLookupTest.java | 16 +++++---
 6 files changed, 55 insertions(+), 16 deletions(-)

commit ee1b24e3bae7550d8b8e1d028f75c5c6b6b58b2d
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 18 17:49:45 2018 -0800

    Force to use Django 1.11 in Pulsar Dashboard (#1083)

 dashboard/Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9f775b4cda2c75e99c825f68297d0bc6b66895e0
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jan 18 17:16:11 2018 -0800

    Re-implement DoubleByteBuf as a simple holder of a pair of buffers (#1078)

 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |   4 +-
 .../broker/service/PulsarChannelInitializer.java   |   3 +
 .../org/apache/pulsar/client/api/RawMessage.java   |  11 +-
 .../apache/pulsar/client/impl/RawMessageImpl.java  |  14 +-
 .../service/PersistentMessageFinderTest.java       |   4 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   9 +-
 .../apache/pulsar/client/impl/MessageIdTest.java   |   3 +-
 .../pulsar/client/impl/RawMessageSerDeserTest.java |  11 +-
 .../apache/pulsar/client/impl/ConnectionPool.java  |   3 +
 .../apache/pulsar/client/impl/ProducerImpl.java    |  74 +---
 .../org/apache/pulsar/common/api/ByteBufPair.java  | 130 ++++++
 .../org/apache/pulsar/common/api/Commands.java     |  18 +-
 .../apache/pulsar/common/api/DoubleByteBuf.java    | 485 ---------------------
 ...DoubleByteBufTest.java => ByteBufPairTest.java} |  44 +-
 .../pulsar/common/compression/CommandsTest.java    |  26 +-
 15 files changed, 217 insertions(+), 622 deletions(-)

commit cccc0bdbe3f394739785bd9784cf5295e898a501
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Fri Jan 19 09:39:39 2018 +0900

    Implement TopicMetadata for MessageRouter in C++ client (#1033)

 build/docker/Dockerfile                            |  5 +-
 pulsar-client-cpp/CMakeLists.txt                   |  2 +
 .../include/pulsar/DeprecatedException.h           | 35 +++++++++++
 pulsar-client-cpp/include/pulsar/Message.h         |  1 +
 .../include/pulsar/MessageRoutingPolicy.h          | 17 ++++-
 pulsar-client-cpp/include/pulsar/TopicMetadata.h   | 32 ++++++++++
 pulsar-client-cpp/lib/DeprecatedException.cc       | 28 +++++++++
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   | 39 +++++++-----
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |  6 +-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.cc   |  9 ++-
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |  6 +-
 .../lib/SinglePartitionMessageRouter.cc            | 12 ++--
 .../lib/SinglePartitionMessageRouter.h             |  6 +-
 pulsar-client-cpp/lib/TopicMetadataImpl.cc         | 30 +++++++++
 pulsar-client-cpp/lib/TopicMetadataImpl.h          | 35 +++++++++++
 pulsar-client-cpp/tests/CMakeLists.txt             |  4 +-
 pulsar-client-cpp/tests/CustomRoutingPolicy.h      |  7 +++
 .../tests/RoundRobinMessageRouterTest.cc           | 73 ++++++++++++++++++++++
 .../tests/SinglePartitionMessageRouterTest.cc      | 69 ++++++++++++++++++++
 pulsar-client-cpp/tests/TopicMetadataImplTest.cc   | 29 +++++++++
 pulsar-client-cpp/tests/main.cc                    |  4 +-
 pulsar-client-cpp/tests/mocks/GMockMessage.h       | 36 +++++++++++
 22 files changed, 444 insertions(+), 41 deletions(-)

commit a5c123e74b4fd5647ab8287014884699e5a272e7
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Jan 19 01:58:56 2018 +0900

    Support Url Encode in Athenz auth params (#1073)

 .../client/impl/auth/AuthenticationAthenz.java     | 28 +++++---
 .../client/impl/auth/AuthenticationAthenzTest.java | 83 +++++++++++++++++-----
 .../src/test/resources/authParams.json             |  6 ++
 3 files changed, 92 insertions(+), 25 deletions(-)

commit de8d09c5970a2269fbfa5ee29e566986dccdd4f1
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 17 21:58:32 2018 -0800

    Fix shading for Kafka wrapper lib (#1079)

 .../pulsar-client-kafka/pom.xml                    | 79 +++++++++++++++++++++-
 1 file changed, 77 insertions(+), 2 deletions(-)

commit 3295cfd0beac4ee37059e159d06853abc2610ae4
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Jan 17 15:54:15 2018 -0800

    Move zookeeper/bookkeeper from dependency management and only specify the dependency when they are used (#1052)

 managed-ledger/pom.xml         | 15 +++++++++++++++
 pom.xml                        | 26 --------------------------
 pulsar-testclient/pom.xml      |  1 +
 pulsar-zookeeper-utils/pom.xml | 15 +++++++++++++++
 pulsar-zookeeper/pom.xml       |  1 +
 5 files changed, 32 insertions(+), 26 deletions(-)

commit fdf7fa3f428b11ae6d170a0183ebd1fb2136fbc6
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Jan 17 15:53:33 2018 -0800

    Various website updates (#1076)
    
    * update ruby gems and fix sass issues
    
    * remove unnecssary console log in main.js

 site/Gemfile           |  6 +----
 site/Gemfile.lock      | 61 ++++++++++++++++++++++++++++----------------------
 site/Makefile          | 13 ++++++-----
 site/_config.local.yml |  1 -
 site/_sass/_docs.scss  | 39 ++++++++++++--------------------
 site/js/main.js        |  2 --
 6 files changed, 56 insertions(+), 66 deletions(-)

commit 3212fa8a2956ed5c444ddcf886cf58adde0dc340
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jan 17 11:13:34 2018 -0800

    Load-balancer consider max-topic threshold on broker-ownership selection (#1005)

 conf/broker.conf                                   |  3 ++
 conf/standalone.conf                               |  3 ++
 .../apache/pulsar/broker/ServiceConfiguration.java | 14 +++++++--
 .../java/org/apache/pulsar/broker/BundleData.java  | 12 ++++++++
 .../loadbalance/impl/LeastLongTermMessageRate.java | 13 +++++---
 .../broker/loadbalance/impl/LoadManagerShared.java | 30 ++++++++++++++++++
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  4 +++
 .../loadbalance/ModularLoadManagerImplTest.java    | 36 ++++++++++++++++++++++
 site/_data/config/broker.yaml                      |  3 ++
 site/_data/config/standalone.yaml                  |  2 ++
 10 files changed, 113 insertions(+), 7 deletions(-)

commit df0841433ea2ccd0fe7c6870343ac7a7ba650c32
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 17 17:44:11 2018 +0100

    Serialization and Deserialization for RawMessage (#1039)
    
    * Serialization and Deserialization for RawMessage
    
    Serializes the message ID and passes through the payload and metadata
    of the raw message.
    
    * Add logs for errors that should never happen

 .../org/apache/pulsar/client/api/RawMessage.java   |  6 +++
 .../apache/pulsar/client/impl/RawMessageImpl.java  | 57 ++++++++++++++++++++
 .../pulsar/client/impl/RawMessageSerDeserTest.java | 60 ++++++++++++++++++++++
 3 files changed, 123 insertions(+)

commit dd1f64cbc88a494cd2ce63a8d1ab4b4842e4b41a
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Wed Jan 17 08:42:31 2018 -0800

    changes make MessageId Comparable (#1065)

 .../org/apache/pulsar/client/api/MessageId.java    |   2 +-
 .../pulsar/client/impl/BatchMessageIdImpl.java     |  14 ++-
 .../apache/pulsar/client/impl/MessageIdImpl.java   |  24 ++--
 .../pulsar/client/impl/MessageIdCompareToTest.java | 123 +++++++++++++++++++++
 4 files changed, 149 insertions(+), 14 deletions(-)

commit 579556941dd3d8bb872389d22eff15e9792fed12
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Thu Jan 18 01:41:55 2018 +0900

    ENH: Add C++ code auto-formatting option (#1038)

 build/docker/Dockerfile                            |   2 +-
 pulsar-client-cpp/.clang-format                    |  20 +++++
 pulsar-client-cpp/CMakeLists.txt                   |  22 +++++
 .../build-support/clang_format_exclusions.txt      |   0
 .../build-support/run_clang_format.py              |  80 +++++++++++++++++
 .../cmake_modules/FindClangTools.cmake             | 100 +++++++++++++++++++++
 pulsar-client-cpp/docs/MainPage.md                 |   9 ++
 7 files changed, 232 insertions(+), 1 deletion(-)

commit ec1995ae25b97041ab8333c67649403a2750a185
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jan 15 22:13:10 2018 -0800

    Issue 1061: Consumers in failover subscription stops consuming after restart (#1062)

 .../persistent/PersistentDispatcherSingleActiveConsumer.java        | 6 ++++++
 1 file changed, 6 insertions(+)

commit e0c04adf06e66a962c8a2f98bc99288e7f8b793b
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Tue Jan 16 11:38:16 2018 +0900

    Added setting for anonymous user role (#820)
    
    * Added setting for anonymous user role
    
    * Addressed PR comments

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 conf/websocket.conf                                |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  11 +++
 .../authentication/AuthenticationService.java      |   9 ++
 .../api/AuthenticatedProducerConsumerTest.java     |  96 ++++++++++++++-----
 .../proxy/MockUnauthenticationProvider.java        |  38 ++++++++
 .../websocket/proxy/ProxyAuthenticationTest.java   | 106 +++++++++++++--------
 .../service/WebSocketProxyConfiguration.java       |  11 +++
 9 files changed, 219 insertions(+), 61 deletions(-)

commit 36226c7f365615023042ecb88aff513817d44673
Author: yush1ga <y.shiga.91+yush1ga@gmail.com>
Date:   Mon Jan 15 19:46:54 2018 +0900

    Add subscription auth mode by prefix (#899)
    
    * Add subscription auth mode by prefix
    
    * Fix tests
    
    * Throws exceptions when auth role prefix is missed

 .../broker/authorization/AuthorizationManager.java | 50 ++++++++++++++++--
 .../org/apache/pulsar/broker/admin/Namespaces.java | 44 ++++++++++++++++
 .../org/apache/pulsar/broker/service/Consumer.java |  2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    | 13 ++++-
 .../pulsar/broker/auth/AuthorizationTest.java      | 48 +++++++++++++-----
 .../pulsar/broker/service/ServerCnxTest.java       |  4 +-
 .../api/AuthenticatedProducerConsumerTest.java     |  1 +
 .../websocket/proxy/ProxyAuthorizationTest.java    |  6 +--
 .../org/apache/pulsar/client/admin/Namespaces.java | 10 ++++
 .../client/admin/internal/NamespacesImpl.java      | 59 ++++++++++++++--------
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java | 19 ++++++-
 .../pulsar/common/policies/data/Policies.java      |  8 +--
 .../common/policies/data/SubscriptionAuthMode.java | 31 ++++++++++++
 .../apache/pulsar/websocket/ConsumerHandler.java   |  2 +-
 .../org/apache/pulsar/websocket/ReaderHandler.java |  2 +-
 15 files changed, 246 insertions(+), 53 deletions(-)

commit 8aa1f6f12432448e8a26e458690d4939afcc9ccd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jan 12 01:56:44 2018 -0800

    Populate message properties after building a message (#1054)
    
    * Populate message properties after building a message
    
    * perform lazy init for msg properties

 .../org/apache/pulsar/client/impl/MessageImpl.java | 25 +++++++++++++---------
 .../pulsar/client/impl/MessageBuilderTest.java     | 16 ++++++++++++++
 2 files changed, 31 insertions(+), 10 deletions(-)

commit d4572b6ad432eb7d975eb54164c45ff23420930d
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Fri Jan 12 01:55:53 2018 -0800

    fixing imports that mistakenly use jersey.packaged.* (#1057)

 .../org/apache/pulsar/broker/zookeeper/aspectj/ClientCnxnAspect.java  | 3 +--
 .../apache/pulsar/broker/loadbalance/SimpleLoadManagerImplTest.java   | 3 +--
 .../org/apache/pulsar/client/api/DispatcherBlockConsumerTest.java     | 3 +--
 .../org/apache/pulsar/client/impl/BrokerClientIntegrationTest.java    | 4 +---
 .../java/org/apache/pulsar/websocket/admin/WebSocketProxyStats.java   | 2 +-
 5 files changed, 5 insertions(+), 10 deletions(-)

commit d0c70b19d4bf77842622750a68fa99cdfd081801
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Jan 12 18:31:55 2018 +0900

    Fix format of Athenz auth parameters written in document (#1055)

 site/docs/latest/admin/Authz.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 1458e66c88ae388ce44abe99bb25f7ec1260372d
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Jan 10 19:29:38 2018 +0100

    RawReader allows futures to be cancelled (#1043)
    
    * RawReader allows futures to be cancelled
    
    RawReader#readNextAsync returns a Future<RawMessage> to the user, which includes a
    retained ByteBuf. If the user is no longer interested in the result of
    the read call, it should be able to cancel to ensure that the ByteBuf
    is released.
    
    If there are multiple read requests outstanding, and one of them is
    cancelled, all read requests that were made after the cancelled
    request will also be cancelled.
    
    * Test that all outstanding futures are cancelled on close

 .../apache/pulsar/client/impl/RawReaderImpl.java   | 13 +++++++---
 .../apache/pulsar/client/impl/RawReaderTest.java   | 28 ++++++++++++++++++++++
 2 files changed, 38 insertions(+), 3 deletions(-)

commit 00b5599e05365868df60650a768b801500b8e345
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jan 10 00:23:31 2018 +0100

    Revert "Enable usage of KQueue in MacOS (#1036)" (#1045)
    
    This reverts commit efd41890281c0df98557e60f7094ec9263f3880d.

 .../org/apache/pulsar/common/util/netty/EventLoopUtil.java  | 13 -------------
 1 file changed, 13 deletions(-)

commit 67bbda4e7b72457a96e48235e00c18307d7712f6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jan 9 01:07:15 2018 -0800

    Add NoSuchEntryException as not-recoverable error for cursor-recovery (#1040)

 .../main/java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java  | 1 +
 1 file changed, 1 insertion(+)

commit 1fb1938ce66ded8d19cc481704450ac0f7c633e3
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jan 8 17:49:02 2018 -0800

    Issue 1024: Message Router should take `numPartitions` as parameter in choosing partition (#1025)
    
    * Expose partition number in choosePartition method
    
    * Use `ThreadLocalRandom`

 .../apache/pulsar/client/api/MessageRouter.java    | 19 ++++++-
 .../pulsar/client/api/ProducerConfiguration.java   | 33 ++++++------
 .../apache/pulsar/client/api/TopicMetadata.java    | 33 ++++++++++++
 .../client/impl/PartitionedProducerImpl.java       | 45 ++++++++++++----
 .../impl/RoundRobinPartitionMessageRouterImpl.java | 11 ++--
 .../impl/SinglePartitionMessageRouterImpl.java     | 13 ++---
 .../pulsar/client/impl/TopicMetadataImpl.java      | 35 ++++++++++++
 .../pulsar/client/api/MessageRouterTest.java       | 57 ++++++++++++++++++++
 .../RoundRobinPartitionMessageRouterImplTest.java  | 62 ++++++++++++++++++++++
 .../impl/SinglePartitionMessageRouterImplTest.java | 60 +++++++++++++++++++++
 .../pulsar/client/impl/TopicMetadataImplTest.java  | 36 +++++++++++++
 11 files changed, 363 insertions(+), 41 deletions(-)

commit efd41890281c0df98557e60f7094ec9263f3880d
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 8 19:25:11 2018 +0100

    Enable usage of KQueue in MacOS (#1036)

 .../org/apache/pulsar/common/util/netty/EventLoopUtil.java  | 13 +++++++++++++
 1 file changed, 13 insertions(+)

commit 002a29598f78a9bf4814a5869be82e3b62ab84e9
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 8 19:24:51 2018 +0100

    Bookies pods in kubernetes need to use hostPort (#1035)

 kubernetes/generic/bookie.yaml                  | 1 +
 kubernetes/google-kubernetes-engine/bookie.yaml | 1 +
 2 files changed, 2 insertions(+)

commit 6bd113824c33a118a414c7257db466f5950f32b2
Author: cckellogg <cckellogg@gmail.com>
Date:   Sun Jan 7 02:04:51 2018 -0800

    Add optional key/value metadata to consumers. (#1031)

 .../org/apache/pulsar/broker/service/Consumer.java |   7 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  11 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   4 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   6 +-
 .../broker/service/persistent/PersistentTopic.java |  10 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |  11 +-
 .../service/PersistentTopicConcurrentTest.java     |   9 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  33 ++---
 .../pulsar/client/api/ConsumerConfiguration.java   |  33 +++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  21 +--
 .../org/apache/pulsar/common/api/CommandUtils.java |   4 +
 .../org/apache/pulsar/common/api/Commands.java     |   7 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 159 +++++++++++++++++++++
 .../pulsar/common/policies/data/ConsumerStats.java |   5 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   3 +
 .../pulsar/common/api/CommandUtilsTests.java       |  40 +++++-
 16 files changed, 312 insertions(+), 51 deletions(-)

commit 5263e64d76de83f2b7d10f35c200db5cf088bf0a
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sun Jan 7 02:03:25 2018 -0800

    Standardize the unit tests to use TestNG methods only (#1032)

 managed-ledger/pom.xml                                       | 11 +++++++++++
 pom.xml                                                      |  2 +-
 .../apache/pulsar/broker/service/AdvertisedAddressTest.java  | 12 ++++++------
 .../apache/pulsar/broker/stats/ManagedLedgerMetricsTest.java |  3 +--
 .../pulsar/client/api/AuthenticatedProducerConsumerTest.java |  2 +-
 .../apache/pulsar/client/api/TlsProducerConsumerTest.java    |  4 ++--
 .../circe/impl/AbstractIncrementalIntHashTest.java           |  2 --
 .../org/apache/pulsar/client/impl/MessageBuilderTest.java    |  9 +++++----
 .../java/org/apache/pulsar/common/api/CommandUtilsTests.java |  2 +-
 .../java/org/apache/pulsar/common/naming/MetadataTests.java  |  5 ++---
 .../proxy/server/ProxyAuthenticatedProducerConsumerTest.java |  3 +--
 11 files changed, 31 insertions(+), 24 deletions(-)

commit 4d9441326f61a34ab06eb769f523075b50fe27f1
Author: Sijie Guo <guosijie@gmail.com>
Date:   Sat Jan 6 03:29:27 2018 -0800

    Expose sequenceId in message (#1026)

 .../java/org/apache/pulsar/client/api/Message.java | 18 ++++++
 .../org/apache/pulsar/client/impl/MessageImpl.java | 18 ++++++
 .../apache/pulsar/client/impl/MessageImplTest.java | 73 ++++++++++++++++++++++
 3 files changed, 109 insertions(+)

commit 558b0b966e7fd8267d691649d4e248cba775f82d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Jan 5 12:41:33 2018 -0600

    Update downloads page to ensure Apache compliance (WIP) (#999)

 site/_includes/explanations/install-package.md |  9 +++---
 site/download.md                               | 39 ++++++++++----------------
 2 files changed, 20 insertions(+), 28 deletions(-)

commit 7e7966e19e01fdfa16b08ba04b7313fae87e51d8
Author: Ivan Kelly <ivank@apache.org>
Date:   Fri Jan 5 10:24:14 2018 +0100

    Add utility to explode raw batch into individual messages (#993)
    
    The utility method takes a raw batch message and generates then
    generates a raw message for each message in the batch. The generated
    messages have metadata which is a composite of the batch message
    metadata, and the single message metadata for that message. The
    message ID is generated by using the offset within the batch message
    along with the message ID of the batch message itself.
    
    Returning a ByteBuf for the metadataAndPayload of the batched message
    involves a copy of the payload, as both DoubleByteBuf doesn't work
    with getShort() and CompositeByteBuf does not work with slice(). I
    think this is ok for now though, as this will only be used by
    compaction, and compaction is a batch process, so latency isn't
    paramount. However, this should be revisited if this does prove to be
    causing performance problems.

 .../pulsar/client/impl/RawBatchConverter.java      | 80 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/RawMessageImpl.java  |  5 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   | 73 ++++++++++++++++++--
 .../org/apache/pulsar/common/api/Commands.java     | 50 ++++++++++++++
 4 files changed, 200 insertions(+), 8 deletions(-)

commit 1fd7d98cf25eb6659355085555e7c3d3b8095c0d
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Fri Jan 5 02:18:09 2018 +0900

    BUG: Change the search method for boost::python at CMake build (#1030)

 pulsar-client-cpp/CMakeLists.txt | 23 +++++++++++++++++++----
 1 file changed, 19 insertions(+), 4 deletions(-)

commit 3e0f2753c57e0c05db7615022d89287004c569b7
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Thu Jan 4 22:23:03 2018 +0900

    BUG: Fix ProtocolBuffer output directory (#1027)

 pulsar-client-cpp/lib/CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 110c105da11bce55e5614a63184c0140a0bd3afc
Author: cckellogg <cckellogg@gmail.com>
Date:   Thu Jan 4 03:05:09 2018 -0800

    Add optional key/value metadata to producers. (#1009)

 .../org/apache/pulsar/broker/service/Producer.java |  15 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  19 ++-
 .../pulsar/broker/service/PersistentTopicTest.java |  14 +-
 .../pulsar/broker/service/ServerCnxTest.java       |  61 ++++----
 .../pulsar/client/api/ProducerConfiguration.java   |  33 +++++
 .../apache/pulsar/client/impl/ProducerImpl.java    |  15 +-
 .../org/apache/pulsar/common/api/CommandUtils.java |  54 +++++++
 .../org/apache/pulsar/common/api/Commands.java     |  11 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 159 +++++++++++++++++++++
 .../org/apache/pulsar/common/naming/Metadata.java  |  46 ++++++
 .../common/policies/data/PublisherStats.java       |   5 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   3 +
 .../pulsar/common/api/CommandUtilsTests.java       |  78 ++++++++++
 .../apache/pulsar/common/naming/MetadataTests.java |  86 +++++++++++
 14 files changed, 557 insertions(+), 42 deletions(-)

commit 3d9ae3f4f86caa6d5536822ee33ba7eab4617797
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Jan 4 09:21:03 2018 +0100

    Acknowledgement with properties for RawReader (#1006)
    
    * Acknowledgement with properties for RawReader
    
    This will be used by the compactor to update the topic with the
    compacted ledger. There will be a cursor/subscription owned by the
    compactor which keeps track of where we have compacted until, and the
    ID of the ledger into which the compacted data has been written.
    
    This change exposes the cursor's String->Long properties map which is
    already available for Producer sequence tracking. This is only exposed
    through the RawReader, which is part of the broker module. Clients
    will not be able to use it.
    
    * Review comments from @sijie
    
    * Updated protobuf for recycler

 .../org/apache/pulsar/broker/service/Consumer.java |  15 +-
 .../apache/pulsar/broker/service/Subscription.java |   3 +-
 .../nonpersistent/NonPersistentSubscription.java   |   3 +-
 .../service/persistent/PersistentSubscription.java |   5 +-
 .../org/apache/pulsar/client/api/RawReader.java    |  15 +-
 .../apache/pulsar/client/impl/RawReaderImpl.java   |  13 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   3 +-
 .../apache/pulsar/client/impl/RawReaderTest.java   |  56 +-
 .../apache/pulsar/client/impl/ConsumerBase.java    |   9 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  27 +-
 .../client/impl/PartitionedConsumerImpl.java       |   5 +-
 .../org/apache/pulsar/common/api/Commands.java     |   7 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 591 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   6 +
 14 files changed, 724 insertions(+), 34 deletions(-)

commit 1fe28e749a9809ba7ffaeee14903bd41b9739790
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Jan 4 14:08:52 2018 +0800

    refine broker starter command (#1023)

 bin/pulsar                                         |   2 +-
 conf/broker.conf                                   |   6 ++
 .../apache/pulsar/broker/ServiceConfiguration.java |  24 ++++-
 .../org/apache/pulsar/PulsarBrokerStarter.java     | 106 +++++++++++++--------
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |  40 +++++---
 5 files changed, 123 insertions(+), 55 deletions(-)

commit f5d2a4dce88460be46f1687a28bf1ed2d4944b4e
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 2 19:59:50 2018 +0100

    Upgrade Jackson dependency to 2.9.3 (#955)

 pom.xml | 31 ++++++++++++++++++++++++++++---
 1 file changed, 28 insertions(+), 3 deletions(-)

commit 2eb3e497670933eb9bb9f1eb2153b66bb9bf5f70
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jan 2 02:29:14 2018 -0800

    Add timeout for bundle unloading (#990)

 .../pulsar/broker/namespace/NamespaceService.java  | 12 +++----
 .../pulsar/broker/namespace/OwnedBundle.java       | 29 +++++++++++-----
 .../pulsar/broker/service/BrokerService.java       |  2 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |  1 -
 .../broker/namespace/NamespaceServiceTest.java     | 39 ++++++++++++++++++++++
 .../broker/namespace/OwnershipCacheTest.java       |  3 +-
 6 files changed, 68 insertions(+), 18 deletions(-)

commit 3ed91c026a57ea55acb2fb728b4b27f736936cdc
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Jan 2 00:49:10 2018 -0800

    Provide an Ansible playbook for AWS with documentation (#920)

 .gitignore                                         |   6 +
 deployment/terraform-ansible/aws/ansible.cfg       |   9 +
 deployment/terraform-ansible/aws/instances.tf      |  27 ++
 deployment/terraform-ansible/aws/keys.tf           |   9 +
 deployment/terraform-ansible/aws/network.tf        |  98 ++++++
 deployment/terraform-ansible/aws/output.tf         |  15 +
 deployment/terraform-ansible/aws/provider.tf       |   4 +
 deployment/terraform-ansible/aws/security.tf       |  58 ++++
 deployment/terraform-ansible/aws/variables.tf      |  43 +++
 deployment/terraform-ansible/deploy-pulsar.yaml    | 182 +++++++++++
 .../terraform-ansible/templates/bookkeeper.conf    | 355 +++++++++++++++++++++
 .../terraform-ansible/templates/bookkeeper.service |  13 +
 deployment/terraform-ansible/templates/broker.conf |  34 ++
 deployment/terraform-ansible/templates/client.conf |  24 ++
 deployment/terraform-ansible/templates/myid        |   1 +
 .../terraform-ansible/templates/pulsar.service     |  13 +
 .../terraform-ansible/templates/pulsar_env.sh      |  63 ++++
 deployment/terraform-ansible/templates/zoo.cfg     |  49 +++
 .../terraform-ansible/templates/zookeeper.service  |  14 +
 deployment/terraform-ansible/terraform.tfstate     |  16 +
 site/_data/sidebar.yaml                            |   2 +
 site/_sass/_docs.scss                              |   1 +
 site/docs/latest/deployment/aws-cluster.md         | 182 +++++++++++
 23 files changed, 1218 insertions(+)

commit 663e8f4d5ceec24b1f3d55cf8781e1f78a41830e
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Tue Jan 2 17:47:13 2018 +0900

    Check message encryption when producer connect and publish (#904)

 .../org/apache/pulsar/broker/admin/Namespaces.java |  46 +++++++
 .../org/apache/pulsar/broker/service/Producer.java |  32 ++++-
 .../apache/pulsar/broker/service/ServerCnx.java    |  11 +-
 .../org/apache/pulsar/broker/service/Topic.java    |   2 +
 .../service/nonpersistent/NonPersistentTopic.java  |  27 ++++-
 .../broker/service/persistent/PersistentTopic.java |  27 ++++-
 .../pulsar/broker/service/PersistentTopicTest.java |   8 +-
 .../pulsar/broker/service/ServerCnxTest.java       | 134 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  25 ++++
 .../client/admin/internal/NamespacesImpl.java      |  11 ++
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  24 ++++
 .../apache/pulsar/client/impl/ProducerImpl.java    |   2 +-
 .../org/apache/pulsar/common/api/Commands.java     |   5 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  57 +++++++++
 .../pulsar/common/policies/data/Policies.java      |   8 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   2 +
 16 files changed, 410 insertions(+), 11 deletions(-)

commit 039932a7df823e0b3f5f2f7c4afc447afea73389
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jan 2 09:45:15 2018 +0100

    Issue #929: Perform async DNS resolution each time attempting connect (#930)

 .../pulsar/client/impl/ConnectionPoolTest.java     |  90 +++++++++++++
 .../apache/pulsar/client/impl/MessageIdTest.java   |  70 +++++-----
 .../client/impl/BinaryProtoLookupService.java      |  15 ++-
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  13 +-
 .../apache/pulsar/client/impl/ConnectionPool.java  | 148 ++++++++++++++++-----
 .../pulsar/client/impl/HttpLookupService.java      |   2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |  14 +-
 .../pulsar/common/util/netty/EventLoopUtil.java    |  11 ++
 .../pulsar/proxy/server/LookupProxyHandler.java    |   2 +-
 9 files changed, 277 insertions(+), 88 deletions(-)

commit 757c05ed9da57641910d17840c0ca1e39e514bc2
Author: Licht Takeuchi <licht-t@outlook.jp>
Date:   Tue Jan 2 17:37:05 2018 +0900

    ENH: Add RPC client/server sample in Python (#1021)
    
    * ENH: Add RPC client/server sample in Python
    
    * Enable multiple client/server

 pulsar-client-cpp/python/examples/rpc_client.py | 79 +++++++++++++++++++++++++
 pulsar-client-cpp/python/examples/rpc_server.py | 63 ++++++++++++++++++++
 2 files changed, 142 insertions(+)

commit 13582009b23e8f59e5d7a98a735e8c172f5e3d1f
Author: Sijie Guo <guosijie@gmail.com>
Date:   Mon Jan 1 23:14:16 2018 -0800

    Fix Incremental long crc32c (#1010)

 .../com/scurrilous/circe/crc/ReflectedLongCrc.java |  6 +++++-
 .../java/com/scurrilous/circe/crc/CRCTest.java     | 23 +++++++++++++++++++---
 2 files changed, 25 insertions(+), 4 deletions(-)

commit 87b9d4a3df9c583af8944fa4b682274203f4c920
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jan 1 23:14:01 2018 -0800

    Avoid creating new executor per producer for encryption-key generation (#1018)

 .../org/apache/pulsar/client/impl/ProducerImpl.java | 21 ++++++++-------------
 1 file changed, 8 insertions(+), 13 deletions(-)

commit fd36adecbd63886ca561800144dfbd3d8a05e581
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Dec 29 10:34:22 2017 -0800

    Keep strategically-retry logic common for tests (#1019)

 .../java/org/apache/pulsar/broker/admin/AdminApiTest2.java   |  9 +++------
 .../pulsar/broker/auth/MockedPulsarServiceBaseTest.java      | 11 +++++++++++
 .../org/apache/pulsar/broker/service/BatchMessageTest.java   |  8 +-------
 .../apache/pulsar/broker/service/BrokerBkEnsemblesTests.java | 11 +----------
 .../pulsar/broker/service/BrokerServiceThrottlingTest.java   | 10 +++-------
 .../apache/pulsar/client/api/SimpleProducerConsumerTest.java | 12 ++----------
 .../pulsar/client/impl/BrokerClientIntegrationTest.java      | 11 +++--------
 7 files changed, 24 insertions(+), 48 deletions(-)

commit b6f56f0ca121e3e5ad191f4992162feb602a2232
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Dec 27 13:35:09 2017 -0800

    Make load-balancer shedding dynamic configurable (#1012)

 .../apache/pulsar/broker/ServiceConfiguration.java | 11 +++++++++++
 .../apache/pulsar/broker/admin/AdminResource.java  |  1 -
 .../broker/loadbalance/impl/LoadManagerShared.java | 22 +++++-----------------
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  2 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  2 +-
 5 files changed, 18 insertions(+), 20 deletions(-)

commit fcec34b9f800b627213dcda9a7a0d4f43ec4b165
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Dec 27 13:22:14 2017 -0800

    Edits to DC/OS docs (#1013)

 site/_sass/_docs.scss                   |   6 ++
 site/docs/latest/advanced/Encryption.md |   2 -
 site/docs/latest/deployment/dcos.md     | 118 ++++++++++++++++----------------
 3 files changed, 66 insertions(+), 60 deletions(-)

commit 3e7cd2c57db9b7f9264738e53ea9a2783024545b
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Fri Dec 22 06:39:49 2017 -0800

    Fixed error response for Too many get partition metadata request. (#1004)

 .../src/main/java/org/apache/pulsar/broker/service/ServerCnx.java       | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 334afa02c5311c13549d0cdb865dff15e626155a
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Dec 22 06:39:14 2017 -0800

    fix remaining instances (#931)

 .../bookie.yaml                                              |  0
 .../broker.yaml                                              |  0
 .../monitoring.yaml                                          |  0
 .../zookeeper.yaml                                           |  0
 site/_data/sidebar-ja.yaml                                   |  4 ++--
 site/_data/sidebar.yaml                                      |  4 ++--
 site/docs/latest/deployment/Kubernetes.md                    | 12 ++++++------
 site/docs/latest/deployment/instance.md                      |  2 +-
 site/ja/deployment/InstanceSetup.md                          |  2 +-
 site/ja/deployment/Kubernetes.md                             | 12 ++++++------
 10 files changed, 18 insertions(+), 18 deletions(-)

commit 5fa141ef013c74ddff75a6042e7b2f89b064782b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Dec 22 06:38:31 2017 -0800

    Make sure nextTuple emits tuple with non-null values (#1000)
    
    * Make sure nextTuple emits tuple with non-null values
    
    * remove recursive emit call and reduce receive-timeout

 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 30 +++++++++++++++++-----
 1 file changed, 24 insertions(+), 6 deletions(-)

commit df9d4e553898e9025ca75c857d24412456cfcd65
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Thu Dec 21 20:00:03 2017 -0300

    Partitioned Consumer UnAckedMessageTracker (#963)
    
    * add unacked message tracker to partitioned consumer
    
    * ensure partitioned consumer always uses growable queue
    
    * refactor locks

 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   4 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  22 +++-
 .../client/impl/PartitionedConsumerImpl.java       | 142 +++++++++++++++------
 3 files changed, 120 insertions(+), 48 deletions(-)

commit 83b77533aa193e8d8012ee1221da8d379d9fb331
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Fri Dec 22 06:46:38 2017 +0800

    Issue 922: allow run bookie together with broker (#961)
    
    * allow run bookie together with broker
    
    * change following comments

 .../org/apache/pulsar/PulsarBrokerStarter.java     | 158 ++++++++++++++++++++-
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |  90 ++++++++++--
 2 files changed, 234 insertions(+), 14 deletions(-)

commit 73999f2285c8230fcbed42feebb11b2c6f6a13fe
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Dec 21 14:38:15 2017 -0800

    Retry on failure of ledger-deletion and avoid running callback in executor (#982)
    
    * Retry on failure of ledger-deletion and avoid running callback in executor
    
    * address comments: default_val + call-async-in-executor + data-ledger

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 80 ++++++++++++++--------
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 42 ++++++++----
 2 files changed, 80 insertions(+), 42 deletions(-)

commit 35d516d88b656c09210846e2982abc35ccd46f95
Author: Ivan Kelly <ivank@apache.org>
Date:   Thu Dec 21 23:00:03 2017 +0100

    Raw Reader for Pulsar Topics (#962)
    
    * Raw Reader for Pulsar Topics
    
    This reader reads message from the pulsar topic in the same format
    that they are stored in persistent storage.
    
    This is a requirement for topic compaction, as the compactor will need
    to be able to read from a topic and store the read messaging somewhere
    else in a format that can then be easily read back by the broker. If
    the compactor were to decrypt, decompress and decode the messages, it
    would complicate things on the client side, as it would then need to
    have access to decryption keys, etc.
    
    The initial implementation does not account for partitions or
    batching. This will be added later.
    
    * Review comments addressed from @merlimat and @sijie

 .../org/apache/pulsar/client/api/RawMessage.java   |  49 +++++
 .../org/apache/pulsar/client/api/RawReader.java    |  56 +++++
 .../apache/pulsar/client/impl/RawMessageImpl.java  |  55 +++++
 .../apache/pulsar/client/impl/RawReaderImpl.java   | 174 ++++++++++++++++
 .../apache/pulsar/client/impl/RawReaderTest.java   | 229 +++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   2 +-
 6 files changed, 564 insertions(+), 1 deletion(-)

commit ee1a17601cb78ba109f5e92ca7e17dde59ba15f5
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Dec 21 02:52:17 2017 -0800

    Add table listing supported Python versions (#996)
    
    * add python versions table
    
    * add missing apostrophe in code sample

 site/docs/latest/clients/Python.md | 66 ++++++++++++++------------------------
 1 file changed, 24 insertions(+), 42 deletions(-)

commit 0ffeb758e0afdaf3582f6f3cb3b353e8f097a2a2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Dec 20 19:04:38 2017 -0800

    Upgrade bk version to 4.3.1.84-yahoo with ledger-creation fix (#998)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 55948d682be4fcdf4a99926e5435da81004789ba
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Dec 20 10:36:45 2017 -0800

    add signs, hashes, and KEYS to downloads page (#988)

 site/_sass/_docs.scss |  6 +++++-
 site/download.md      | 32 +++++++++++++++++++++++---------
 2 files changed, 28 insertions(+), 10 deletions(-)

commit d3ee6263fbf3240ca15e88ff076745fd3fb33d38
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Wed Dec 20 15:35:49 2017 -0300

    Implement toString in ProducerBase and ConsumerBase (#992)
    
    * Add toString implementation to ConsumerBase
    
    * Add toString implementation to ProducerBase

 .../main/java/org/apache/pulsar/client/impl/ConsumerBase.java    | 9 +++++++++
 .../main/java/org/apache/pulsar/client/impl/ProducerBase.java    | 7 +++++++
 2 files changed, 16 insertions(+)

commit bffc53dd5f7d6346606ea50e55afbf953c376911
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Dec 18 18:24:23 2017 -0800

    Fix: cursor-ledger leak by deleting cursor-ledger after recovering managed-cursor (#985)
    
    * Fix: cursor-ledger leak by deleting cursor-ledger after recovering managed-cursor
    
    * close pulsarClient in test

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  10 +-
 .../broker/service/BrokerBkEnsemblesTests.java     | 219 +++++++++++++++++++++
 .../client/impl/BrokerClientIntegrationTest.java   |   2 +-
 3 files changed, 226 insertions(+), 5 deletions(-)

commit fdc7b8426d8253c9437777ae51a4639239550f00
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Tue Dec 19 03:38:57 2017 +0900

    Update _config.yml for 1.21.0-incubating (#984)

 site/_config.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 6e7b71259b3e4bab06feb6e3752bce96b69b210f
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Sat Dec 16 08:03:07 2017 +0800

    Issue 924: Provide a json file for Marathon app groups to run Pulsar on DCOS (#950)
    
    * a work-able config
    
    * change memory and cpu settings for services
    
    * add a page in site for Pulsar DCOS deploy

 deploy/dcos/PulsarGroups.json             | 351 ++++++++++++++++++++++++++++++
 site/_data/sidebar.yaml                   |   2 +
 site/docs/latest/deployment/dcos.md       | 175 +++++++++++++++
 site/img/dcos/bookie_log.png              | Bin 0 -> 668472 bytes
 site/img/dcos/bookkeeper_in_zookeeper.png | Bin 0 -> 264657 bytes
 site/img/dcos/bookkeeper_run.png          | Bin 0 -> 524502 bytes
 site/img/dcos/bookkeeper_status.png       | Bin 0 -> 115364 bytes
 site/img/dcos/broker_in_zookeeper.png     | Bin 0 -> 402876 bytes
 site/img/dcos/broker_log.png              | Bin 0 -> 689765 bytes
 site/img/dcos/broker_run.png              | Bin 0 -> 200575 bytes
 site/img/dcos/broker_status.png           | Bin 0 -> 144495 bytes
 site/img/dcos/command_execute.png         | Bin 0 -> 129195 bytes
 site/img/dcos/command_execute2.png        | Bin 0 -> 699589 bytes
 site/img/dcos/consumer.png                | Bin 0 -> 1620672 bytes
 site/img/dcos/dcos-logo.png               | Bin 0 -> 17756 bytes
 site/img/dcos/grafana_dashboard.png       | Bin 0 -> 102136 bytes
 site/img/dcos/grafana_endpoint.png        | Bin 0 -> 277004 bytes
 site/img/dcos/metrics.png                 | Bin 0 -> 389670 bytes
 site/img/dcos/monitor_status.png          | Bin 0 -> 136506 bytes
 site/img/dcos/producer.png                | Bin 0 -> 1542880 bytes
 site/img/dcos/prom_endpoint.png           | Bin 0 -> 224700 bytes
 site/img/dcos/prom_targets.png            | Bin 0 -> 240218 bytes
 site/img/dcos/uninstall.png               | Bin 0 -> 115389 bytes
 23 files changed, 528 insertions(+)

commit 2d7d4933f26056a670efd16b9b87558c55899f9b
Author: massakam <massakam@yahoo-corp.jp>
Date:   Sat Dec 16 03:19:49 2017 +0900

    Fix authentication logic in WebSocketWebResource (#949)
    
    * Fix authentication logic in WebSocketWebResource
    
    * Try acquiring clientId even when authentication is disabled

 .../websocket/proxy/ProxyAuthenticationTest.java   | 75 ++++++++++++++++++++--
 pulsar-websocket/pom.xml                           |  5 ++
 .../websocket/admin/WebSocketWebResource.java      | 14 ++--
 3 files changed, 83 insertions(+), 11 deletions(-)

commit dd22d11e98cbb2257d0ffb4f0b50d1a992c17d2d
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Thu Dec 14 09:55:24 2017 +0900

    Fix SHA extension (#964)

 src/sign-release.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f21cb67fcaccd4e77d47a2e1171cf5506dd8ec57
Author: Ivan Kelly <ivank@apache.org>
Date:   Wed Dec 13 22:30:45 2017 +0100

    MockZooKeeper watches for non-existing znode (#979)
    
    This patch adds support for watching for non-existent znode
    using ZooKeeper#exists.

 .../java/org/apache/zookeeper/MockZooKeeper.java   | 79 ++++++++++++++++++----
 1 file changed, 67 insertions(+), 12 deletions(-)

commit af2014334d9a24d235cd2be379f571df46b61582
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Dec 13 10:58:53 2017 +0900

    Don't create producer/consumer when authentication fails on websocket proxy (#958)

 .../apache/pulsar/websocket/AbstractWebSocketHandler.java   | 13 +++++++------
 .../java/org/apache/pulsar/websocket/ConsumerHandler.java   |  4 ++++
 .../java/org/apache/pulsar/websocket/ProducerHandler.java   |  4 ++++
 .../java/org/apache/pulsar/websocket/ReaderHandler.java     |  4 ++++
 4 files changed, 19 insertions(+), 6 deletions(-)

commit 12711eae1541acac2b9f07cb1dfad7e4344892db
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Dec 12 17:08:00 2017 -0800

    Removed unused client version filter method in WebService (#957)

 .../org/apache/pulsar/broker/web/WebService.java   | 26 ----------------------
 1 file changed, 26 deletions(-)

commit 08565e4594dc707765986c393201fba9ef00a402
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Dec 12 16:27:26 2017 -0800

    Adjusted documentation for single cluster deployment to remove need of global ZK (#953)

 site/docs/latest/deployment/cluster.md | 28 +++++++---------------------
 1 file changed, 7 insertions(+), 21 deletions(-)

commit db51e2811be780ebc8d7818ad0c9f4630270a032
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed Dec 13 04:19:33 2017 +0900

    Exclude tests jar path from classpath.txt (#960)

 pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit cc18beb70cad2c52b89a62fa7580134bbfafdce2
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Dec 11 17:42:49 2017 -0800

    fix image width issue (#956)

 site/_sass/_docs.scss | 1 +
 1 file changed, 1 insertion(+)

commit d1ba96e581f11981cc93ecb11946f5863a41d032
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Dec 11 10:20:25 2017 -0800

    Reduce duplicate string allocation for GC improvements (#952)

 .../apache/pulsar/broker/admin/AdminResource.java  |  2 +-
 .../apache/pulsar/broker/admin/BrokerStats.java    |  2 +-
 .../org/apache/pulsar/broker/admin/Namespaces.java | 42 +++++++-------
 .../pulsar/broker/admin/NonPersistentTopics.java   |  2 +-
 .../pulsar/broker/admin/PersistentTopics.java      | 32 +++++------
 .../apache/pulsar/broker/admin/ResourceQuotas.java |  6 +-
 .../loadbalance/impl/BundleSplitterTask.java       |  2 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  2 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  4 +-
 .../pulsar/broker/namespace/NamespaceService.java  |  4 +-
 .../broker/namespace/ServiceUnitZkUtils.java       |  2 +-
 .../pulsar/broker/service/AbstractReplicator.java  |  6 +-
 .../pulsar/broker/service/BrokerService.java       |  2 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  2 +-
 .../pulsar/broker/web/PulsarWebResource.java       |  4 +-
 .../common/naming/NamespaceBundleFactory.java      |  6 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  6 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java | 28 ++++-----
 .../broker/cache/ResourceQuotaCacheTest.java       |  2 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  2 +-
 .../loadbalance/LoadBalancerTestingUtils.java      |  2 +-
 .../loadbalance/ModularLoadManagerImplTest.java    |  2 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |  6 +-
 .../broker/namespace/NamespaceServiceTest.java     | 10 ++--
 .../broker/namespace/OwnershipCacheTest.java       | 14 ++---
 .../pulsar/broker/service/ReplicatorTest.java      |  4 +-
 .../pulsar/common/naming/NamespaceBundleTest.java  | 48 ++++++++--------
 .../pulsar/common/naming/NamespaceBundlesTest.java | 16 +++---
 .../client/admin/internal/NamespacesImpl.java      | 66 +++++++++++-----------
 .../admin/internal/PersistentTopicsImpl.java       |  4 +-
 .../client/admin/internal/ResourceQuotasImpl.java  |  6 +-
 .../org/apache/pulsar/admin/cli/CliCommand.java    |  2 +-
 .../pulsar/common/naming/DestinationName.java      |  5 +-
 .../apache/pulsar/common/naming/NamespaceName.java | 45 ++++++++++++---
 .../pulsar/common/naming/NamespaceNameTest.java    | 64 ++++++++++-----------
 .../impl/NamespaceIsolationPoliciesTest.java       | 10 ++--
 .../impl/NamespaceIsolationPolicyImplTest.java     | 12 ++--
 37 files changed, 251 insertions(+), 223 deletions(-)

commit 3ad77a4e9231247e5627df1a3e841a9bf6192c46
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Dec 7 00:07:00 2017 -0800

    Remove `apache-rat:check` from travis ci (#947)

 .travis.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 664cfa6fd9595770b3843fee807e7df34f628b1b
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Dec 7 16:06:43 2017 +0800

    fix types under k8s dir (#948)

 kubernetes/generic/broker.yaml                     | 2 +-
 kubernetes/generic/monitoring.yaml                 | 4 ++--
 kubernetes/google-container-engine/broker.yaml     | 2 +-
 kubernetes/google-container-engine/monitoring.yaml | 4 ++--
 4 files changed, 6 insertions(+), 6 deletions(-)

commit 3cef49b7149203e0c90a7b2aa4b6c2890c92a228
Author: Sanjeev Kulkarni <sanjeevrk@gmail.com>
Date:   Wed Dec 6 11:46:01 2017 -0800

    Correct the Kafka Wrapper Functionality matrix as well as maven dep (#945)

 site/docs/latest/adaptors/KafkaWrapper.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 0b48aba4487062ddc8a5f5079513b30b6060a318
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Dec 6 18:18:25 2017 +0900

    ReaderHandler starts receiving messages after WebSocket session established (#944)

 .../src/main/java/org/apache/pulsar/websocket/ReaderHandler.java  | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 93825a12b550b65588d36264dde817958272efa2
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Dec 6 17:00:19 2017 +0900

    Start receiving messages after WebSocket session established (#943)

 .../main/java/org/apache/pulsar/websocket/ConsumerHandler.java    | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit c21b61f0cc79c6dfcdcb304feb4bb9702f33ef80
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Dec 5 21:18:39 2017 -0800

    fix directory structure and update sidebar.yaml (#939)

 site/_data/sidebar.yaml                                  | 4 ++--
 site/docs/latest/deployment/{bare-metal => }/cluster.md  | 0
 site/docs/latest/deployment/{bare-metal => }/instance.md | 0
 3 files changed, 2 insertions(+), 2 deletions(-)

commit 09345ab1497f5052231936843b3cc20890c46557
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Dec 5 12:52:28 2017 -0800

    Handle and log uncaught exception (#938)

 .../org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java    | 2 +-
 .../main/java/org/apache/bookkeeper/mledger/impl/OpAddEntry.java | 9 +++++++--
 .../java/org/apache/bookkeeper/mledger/util/StatsBuckets.java    | 4 +++-
 .../main/java/org/apache/pulsar/broker/admin/AdminResource.java  | 2 +-
 .../java/org/apache/pulsar/broker/service/BrokerService.java     | 2 +-
 5 files changed, 13 insertions(+), 6 deletions(-)

commit cc31200c54015240633aefbec19ae679cb823eb2
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Dec 5 12:48:56 2017 -0800

    Remove some netty artifacts from bin package since they're already included in netty-all (#940)

 all/src/assemble/bin.xml | 4 ++++
 1 file changed, 4 insertions(+)

commit 11a6872974fee4a078f9c1823613bb586d012d58
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Dec 5 11:59:27 2017 -0800

    Issue #935: Included Kubernetes deployment files in src package (#936)

 all/src/assemble/src.xml | 1 +
 1 file changed, 1 insertion(+)

commit d5a47f5a8e3ae691111ddf6d56785a694b2cc2eb
Author: Jai Asher <jai1@ccs.neu.edu>
Date:   Tue Dec 5 10:58:55 2017 -0800

    Added more log messages for SLA Namespace acquisition (#932)

 .../src/main/java/org/apache/pulsar/broker/PulsarService.java  |  5 ++++-
 .../org/apache/pulsar/broker/namespace/NamespaceService.java   | 10 +++++-----
 2 files changed, 9 insertions(+), 6 deletions(-)

commit c53aeba68977cbdf8372a93a6d28ab267e86920d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Dec 2 22:27:39 2017 -0800

    Avoid dead-lock on broker service when broker failed to load managed-ledger (#934)

 .../pulsar/broker/service/BrokerService.java       |  2 +-
 .../pulsar/broker/service/BrokerServiceTest.java   | 58 ++++++++++++++++++++++
 2 files changed, 59 insertions(+), 1 deletion(-)

commit b65940982d7dee3dd3b12f7ff4e6e9b91d24bdde
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Nov 30 15:01:54 2017 -0800

    Re-work bare metal cluster deployment documentation (#921)

 site/Gemfile                                       |   2 +-
 site/_config.local.yml                             |   2 +-
 site/_data/sidebar.yaml                            |   6 +-
 site/_plugins/custom_tags.rb                       |  13 ++
 site/_sass/_docs.scss                              |   8 +-
 site/docs/latest/deployment/bare-metal/cluster.md  | 245 +++++++++++++++++++++
 .../{InstanceSetup.md => bare-metal/instance.md}   |   8 +-
 7 files changed, 273 insertions(+), 11 deletions(-)

commit c8849b25e38b9b803b990a6b3bfffa3f0d6e1d7c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Nov 29 17:41:07 2017 -0800

    Fix: failed producer creation leak (#927)

 .../client/impl/BrokerClientIntegrationTest.java   | 42 ++++++++++++++++++----
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  1 +
 .../apache/pulsar/client/impl/ProducerImpl.java    |  1 +
 3 files changed, 38 insertions(+), 6 deletions(-)

commit 935e06d42c8a8cb7d3564fcd58f11ca464e2ec3e
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 29 16:07:29 2017 -0800

    Fixed Apache RAT exclusions (#928)

 all/src/assemble/src.xml                           |  7 +--
 .../mledger/proto/PendingBookieOpsStats.java       | 18 +++++++
 pom.xml                                            | 60 +++-------------------
 3 files changed, 28 insertions(+), 57 deletions(-)

commit d29291e068fc828a5ccc1710ec7059c4efb3c4b5
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 29 12:07:40 2017 -0800

    Fixed NOTICE file for binary distribtution (#926)

 all/src/assemble/NOTICE.bin.txt | 106 ++++++++++++++++++++++++++++++++++++++++
 all/src/assemble/bin.xml        |   2 +-
 2 files changed, 107 insertions(+), 1 deletion(-)

commit cb93f6c97135e196232fe4396c29d869b64308de
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Thu Nov 30 00:07:27 2017 +0900

    Bumped version to 1.22.0-incubating-SNAPSHOT (#925)

 all/pom.xml                                                  | 2 +-
 managed-ledger/pom.xml                                       | 2 +-
 pom.xml                                                      | 2 +-
 pulsar-broker-auth-athenz/pom.xml                            | 2 +-
 pulsar-broker-common/pom.xml                                 | 2 +-
 pulsar-broker-shaded/pom.xml                                 | 2 +-
 pulsar-broker/pom.xml                                        | 2 +-
 pulsar-checksum/pom.xml                                      | 2 +-
 pulsar-client-admin/pom.xml                                  | 2 +-
 pulsar-client-auth-athenz/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pom.xml                           | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml       | 2 +-
 pulsar-client-shaded/pom.xml                                 | 2 +-
 pulsar-client-tools/pom.xml                                  | 2 +-
 pulsar-client/pom.xml                                        | 2 +-
 pulsar-common/pom.xml                                        | 2 +-
 pulsar-discovery-service/pom.xml                             | 2 +-
 pulsar-proxy/pom.xml                                         | 2 +-
 pulsar-spark/pom.xml                                         | 2 +-
 pulsar-storm/pom.xml                                         | 2 +-
 pulsar-testclient/pom.xml                                    | 2 +-
 pulsar-websocket/pom.xml                                     | 2 +-
 pulsar-zookeeper-utils/pom.xml                               | 2 +-
 pulsar-zookeeper/pom.xml                                     | 2 +-
 25 files changed, 25 insertions(+), 25 deletions(-)

commit 2cca6cab775aa84c6ce9e424969fad805bd07d0c
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Nov 28 21:37:48 2017 -0800

    Upgrade to bk-4.3.1.83-yahoo to expose journalSyncData option (#923)

 conf/bookkeeper.conf | 8 ++++++++
 pom.xml              | 4 ++--
 2 files changed, 10 insertions(+), 2 deletions(-)

commit 75de0a9b79671ebaddca7e9798b51230ca27a3e3
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Nov 28 18:32:43 2017 -0800

    Netty 4.1 (#689)
    
    * Upgrade to Netty-4.1
    
    * Updated Recycler usages
    
    * Converted usages of ByteBuf.order()
    
    * Upgrade AsyncHttpClient
    
    * Upgraded BK to 4.3.1.82-yahoo
    
    * Fixed method name that changed in async-http-client-2.1
    
    * Upgrade to Guava 20.0 to match same BK version
    
    * Converted usages of templatized Recycler in protobuf generated code
    
    * Fixed capacity in DoubleByteBuf
    
    * Fixed usages of Objects.toStringHelper
    
    * Use same netty version as BK
    
    * Fixed kafka compat tests
    
    * Include AsyncHttpClient default properties file in shaded jar
    
    * Added ref count check in DoubleByteBufTest

 build/docker/protobuf.patch                        |  58 +-
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |  18 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   4 +-
 .../mledger/impl/NonDurableCursorImpl.java         |   4 +-
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |  11 +-
 .../bookkeeper/mledger/impl/OpReadEntry.java       |   8 +-
 .../bookkeeper/mledger/util/RangeCacheTest.java    |   5 +
 pom.xml                                            |   8 +-
 .../pulsar/broker/TimeAverageBrokerData.java       |   8 +-
 .../loadbalance/impl/SimpleResourceUnit.java       |   4 +-
 .../broker/namespace/NamespaceEphemeralData.java   |   4 +-
 .../org/apache/pulsar/broker/service/Consumer.java |   8 +-
 .../org/apache/pulsar/broker/service/Producer.java |  17 +-
 .../broker/service/PulsarChannelInitializer.java   |   5 +-
 .../nonpersistent/NonPersistentReplicator.java     |   8 +-
 .../nonpersistent/NonPersistentSubscription.java   |   4 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   9 +-
 .../service/persistent/PersistentReplicator.java   |   9 +-
 .../service/persistent/PersistentSubscription.java |   4 +-
 .../broker/service/persistent/PersistentTopic.java |   4 +-
 .../pulsar/broker/stats/ReplicationMetrics.java    |   8 +-
 .../client/kafka/compat/tests/KafkaApiTest.java    |   4 +-
 .../pulsar-client-kafka/pom.xml                    |  10 +
 .../kafka/compat/tests/KafkaConsumerTest.java      |  14 +-
 .../kafka/compat/tests/KafkaProducerTest.java      |   5 +-
 pulsar-client-shaded/pom.xml                       |   6 +
 .../apache/pulsar/client/impl/ConnectionPool.java  |   4 +-
 .../org/apache/pulsar/client/impl/HttpClient.java  |   2 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |   8 +-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  16 +-
 pulsar-client/src/main/resources/ahc.properties    |  10 +-
 .../buffer/AbstractRecyclableDerivedByteBuf.java   |  43 --
 .../netty/buffer/RecyclableDuplicateByteBuf.java   | 322 ----------
 .../io/netty/buffer/RecyclableSlicedByteBuf.java   | 302 ----------
 .../org/apache/pulsar/common/api/Commands.java     |   5 +-
 .../apache/pulsar/common/api/DoubleByteBuf.java    |  66 ++-
 .../common/api/PulsarLengthFieldFrameDecoder.java  |  40 --
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 660 +++++++++++----------
 .../pulsar/common/lookup/data/LookupData.java      |   4 +-
 .../pulsar/common/policies/data/AuthPolicies.java  |   6 +-
 .../pulsar/common/policies/data/BacklogQuota.java  |  10 +-
 .../pulsar/common/policies/data/BundlesData.java   |   7 +-
 .../pulsar/common/policies/data/ClusterData.java   |  22 +-
 .../pulsar/common/policies/data/DispatchRate.java  |  14 +-
 .../common/policies/data/PersistencePolicies.java  |   4 +-
 .../pulsar/common/policies/data/Policies.java      |  21 +-
 .../pulsar/common/policies/data/PropertyAdmin.java |   5 +-
 .../org/apache/pulsar/common/util/RateLimiter.java |   4 +-
 .../util/protobuf/ByteBufCodedInputStream.java     |  13 +-
 .../util/protobuf/ByteBufCodedOutputStream.java    |  14 +-
 .../pulsar/common/api/DoubleByteBufTest.java       |  27 +-
 .../service/ServiceChannelInitializer.java         |   7 +-
 .../pulsar/proxy/server/DirectProxyHandler.java    |   4 +-
 .../proxy/server/ServiceChannelInitializer.java    |   5 +-
 54 files changed, 684 insertions(+), 1208 deletions(-)

commit 4279306dd5a467706746fa45c95ab425e6faa812
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Nov 28 10:58:07 2017 -0800

    Fix: broker-zookeeper latency-metrics's dimension-name (#919)
    
    * Fix: broker-zookeeper latency-metrics's dimension-name
    
    * reset metrics

 .../broker/stats/BrokerOperabilityMetrics.java     |  7 ++++--
 .../apache/pulsar/broker/stats/DimensionStats.java |  4 ++++
 .../zookeeper/ZooKeeperClientAspectJTest.java      | 28 +++++++++++-----------
 3 files changed, 23 insertions(+), 16 deletions(-)

commit f0a7dd9f3c30aed1735c510bcd53402fd6922d98
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Tue Nov 28 15:40:56 2017 +0900

    Check whether the property exists at the beginning of `validateAdminAccessOnProperty` (#912)
    
    * Check whether the property exists at the beginning of `validateAdminAccessOnProperty`
    
    * Fix C++ tests

 .../pulsar/broker/web/PulsarWebResource.java       | 19 +++++++--------
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  1 +
 .../pulsar/broker/service/ResendRequestTest.java   |  4 ++++
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |  2 ++
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |  3 +++
 .../service/web/DiscoveryServiceWebTest.java       |  2 +-
 pulsar-client-cpp/run-unit-tests.sh                |  6 ++++-
 pulsar-client-cpp/test-conf/client-ssl.conf        | 27 ++++++++++++++++++++++
 pulsar-client-cpp/test-conf/client.conf            | 14 +++++------
 .../kafka/compat/tests/KafkaConsumerTest.java      |  2 ++
 .../pulsar/client/cli/PulsarClientToolTest.java    |  4 +++-
 .../org/apache/pulsar/proxy/server/ProxyTest.java  |  2 ++
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |  2 ++
 13 files changed, 69 insertions(+), 19 deletions(-)

commit 136695173a058e8100126511fb7101632bf59bc6
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Tue Nov 28 14:58:12 2017 +0900

    Fix status code when partitioned-topic unsubscribe fails (#910)

 .../java/org/apache/pulsar/broker/admin/PersistentTopics.java | 11 +++++++++--
 .../java/org/apache/pulsar/broker/admin/AdminApiTest.java     |  9 +++++++++
 2 files changed, 18 insertions(+), 2 deletions(-)

commit 84e352f343ac392de5677bce1391138fd9d448eb
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Nov 24 09:01:02 2017 -0800

    add admin-api doc for peer-clusters (#918)
    
    * add admin-api doc for peer-clusters
    
    * update latest swagger
    
    * update swagger file generation doc

 site/README.md                         |    2 +-
 site/_data/admin-rest-api-swagger.json | 2205 +++++++++++++++++++++++++++++---
 site/_data/cli/pulsar-admin.yaml       |    3 +
 site/docs/latest/admin-api/clusters.md |   25 +
 4 files changed, 2027 insertions(+), 208 deletions(-)

commit 08d40157ee24acb91eac126147e37d1e1f682996
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Nov 24 09:00:28 2017 -0800

    Avoid running duplicate ReplicatorTest (#911)

 .../test/java/org/apache/pulsar/broker/service/ReplicatorTlsTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 304d0b02ae8a7374e0621350a5ef01a6de8f397e
Author: Nicolas Ha <nha@users.noreply.github.com>
Date:   Wed Nov 22 01:30:13 2017 +0000

    feat: shaded broker (#914)

 pom.xml                      |   1 +
 pulsar-broker-shaded/pom.xml | 170 +++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 171 insertions(+)

commit 012e2743aff1739ef9c7994ede86529e8338648a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Nov 20 21:40:01 2017 -0800

    Fix intermittent test failure for ZookeeperCacheLoaderTest::testZookeeperCacheLoader (#916)

 .../pulsar/discovery/service/web/ZookeeperCacheLoaderTest.java   | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit f602e6819ce46a47518811e2f266f22fd4aabfb9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Nov 20 18:07:38 2017 -0800

    PIP-8: Introduce peer cluster for global namespace redirection (#903)
    
    * PIP-8: Introduce peer cluster for global namespace redirection
    
    * Change peerClusterNames type to LinkedHashSet
    
    * Validate peer-cluster can't coexit in replication-cluster list
    
    * log replication-cluster and check valid-cluster-data

 .../apache/pulsar/broker/admin/AdminResource.java  |   6 +-
 .../org/apache/pulsar/broker/admin/Clusters.java   |  67 +++++++-
 .../org/apache/pulsar/broker/admin/Namespaces.java |  63 +++++++-
 .../pulsar/broker/admin/NonPersistentTopics.java   |   4 +
 .../pulsar/broker/admin/PersistentTopics.java      |  76 +++++++--
 .../pulsar/broker/lookup/DestinationLookup.java    |  19 ++-
 .../apache/pulsar/broker/service/ServerCnx.java    |   9 +-
 .../pulsar/broker/web/PulsarWebResource.java       | 178 +++++++++++++--------
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 103 +++++++++++-
 .../pulsar/broker/service/PeerReplicatorTest.java  | 156 ++++++++++++++++++
 .../pulsar/broker/service/ReplicatorTest.java      |   6 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |  16 +-
 .../org/apache/pulsar/client/admin/Clusters.java   |  20 +++
 .../pulsar/client/admin/internal/ClustersImpl.java |  12 ++
 .../org/apache/pulsar/admin/cli/CmdClusters.java   |  21 +++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   3 +
 .../pulsar/common/policies/data/ClusterData.java   |  42 +++--
 17 files changed, 673 insertions(+), 128 deletions(-)

commit dddabfc522b6cd53e134c73dc5a060ee2a53c60e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Nov 20 15:00:15 2017 -0800

    Restrict partitioned-metadata rest-api access for cpp-client older than 1.21 (#884)
    
    * Restrict partitioned-metadata rest-api access for cpp-client older than 1.21
    
    * handle patch version
    
    * handle patch version
    
    * validateClientVersion() throws RestException

 .../apache/pulsar/broker/ServiceConfiguration.java |   1 +
 .../pulsar/broker/admin/PersistentTopics.java      |  47 ++++-
 .../pulsar/client/api/BrokerServiceLookupTest.java | 199 ++++++++++++++++++---
 3 files changed, 220 insertions(+), 27 deletions(-)

commit 153cef32774c1eb03659bda95c2369413be86e2b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Nov 20 13:44:53 2017 -0800

    Fail broker start if broker-znode created by other zk-session (#913)

 .../loadbalance/impl/ModularLoadManagerImpl.java   | 19 +++++++++++-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 17 +++++++++++
 .../loadbalance/ModularLoadManagerImplTest.java    | 35 ++++++++++++++++++++--
 3 files changed, 67 insertions(+), 4 deletions(-)

commit bcc74044288932acc9e83b04001bf1ced17d7780
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 19 06:57:14 2017 -0800

    Fixed date-time format used in stats (#909)

 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 17 +++----
 .../pulsar/broker/admin/PersistentTopics.java      | 15 +++---
 .../org/apache/pulsar/broker/service/Consumer.java | 11 ++---
 .../org/apache/pulsar/broker/service/Producer.java |  5 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  9 +---
 .../broker/service/persistent/PersistentTopic.java | 10 ++--
 .../apache/pulsar/client/impl/ProducerImpl.java    |  7 +--
 .../apache/pulsar/common/util/DateFormatter.java   | 56 ++++++++++++++++++++++
 .../apache/pulsar/websocket/ConsumerHandler.java   | 11 ++---
 .../org/apache/pulsar/websocket/ReaderHandler.java |  8 ++--
 .../pulsar/websocket/data/ConsumerMessage.java     |  1 +
 11 files changed, 95 insertions(+), 55 deletions(-)

commit dd3318e78d89aef74e5d4fa2a419174e8b7a0fcb
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Sat Nov 18 07:37:58 2017 +0900

    Use Optional to check null gracefully (#907)

 .../pulsar/broker/service/BacklogQuotaManager.java | 12 +++-----
 .../pulsar/broker/service/BrokerService.java       | 32 +++++++++-------------
 .../service/persistent/DispatchRateLimiter.java    | 17 +++++-------
 .../broker/service/persistent/PersistentTopic.java | 24 ++++------------
 4 files changed, 30 insertions(+), 55 deletions(-)

commit 63fe18c47b0bfb97d3d06468946cf92f389c7c0d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Nov 17 13:22:13 2017 -0800

    Deserialize LoadManagerReport with custom-deserializer + fix broker-discovery (#908)

 .../data/loadbalancer/LoadManagerReport.java       |  4 ++
 .../policies/data/loadbalancer/LoadReport.java     | 10 ++++-
 .../data/loadbalancer/LoadReportDeserializer.java  | 45 +++++++++++++++++++
 .../data/loadbalancer/LocalBrokerData.java         |  9 ++++
 .../pulsar/common/lookup/data/LookupDataTest.java  | 52 ++++++++++++++++++++++
 .../discovery/service/BrokerDiscoveryProvider.java | 10 ++---
 .../pulsar/discovery/service/ServerConnection.java |  4 +-
 .../service/web/DiscoveryServiceServlet.java       |  8 ++--
 .../service/web/ZookeeperCacheLoader.java          | 16 +++----
 .../service/web/ZookeeperCacheLoaderTest.java      | 48 ++++++++++++++------
 .../proxy/server/BrokerDiscoveryProvider.java      |  9 ++--
 .../proxy/server/util/ZookeeperCacheLoader.java    | 17 ++++---
 12 files changed, 185 insertions(+), 47 deletions(-)

commit aa9d267a24dd634698815a01a910db45b85f7495
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Nov 16 15:07:33 2017 -0800

    Avoid logging stacktrace for exclusive consumer-busy exception (#906)
    
    * Avoid logging stacktrace for exclusive consumer-busy exception
    
    * Downgrade to debug level

 .../java/org/apache/pulsar/broker/service/ServerCnx.java   | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

commit 376a0d26b6991de0cca479b6976ffb434e250746
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Nov 16 12:25:12 2017 -0800

    Fail Pulsar storm spout/bolt init on consumer/producer creation failed (#905)

 .../java/org/apache/pulsar/storm/PulsarBolt.java   |  3 +++
 .../java/org/apache/pulsar/storm/PulsarSpout.java  |  4 ++++
 .../org/apache/pulsar/storm/PulsarBoltTest.java    | 22 +++++++++++++++++
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   | 28 ++++++++++++++++++++++
 4 files changed, 57 insertions(+)

commit f538bec3c1f43d85d0d8d6244b5e44c678711f42
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Thu Nov 16 09:16:03 2017 +0900

    Introduce configuration converter (#901)
    
    * Introduce configuration converter
    
    * Addressed PR comments
    
    * Added javadoc for PulsarConfigurationLoaser.convertFrom

 .../apache/pulsar/broker/ServiceConfiguration.java |  2 +
 .../configuration/PulsarConfigurationLoader.java   | 43 +++++++++++++++++++++
 .../PulsarConfigurationLoaderTest.java             | 45 +++++++++++++++++++++-
 .../pulsar/discovery/service/DiscoveryService.java | 13 +------
 .../apache/pulsar/proxy/server/ProxyService.java   | 13 +------
 .../apache/pulsar/websocket/WebSocketService.java  | 39 ++++---------------
 6 files changed, 100 insertions(+), 55 deletions(-)

commit 35505f36637faf74749d3cb2ebe59aedd343896d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Nov 14 21:47:47 2017 -0800

    Cleanup unsused ApiVersionFilter (#885)
    
    * Cleanup unsused ApiVersionFilter
    
    * remove ApiVersionFilter Test

 conf/broker.conf                                   |   3 -
 conf/standalone.conf                               |   3 -
 .../apache/pulsar/broker/ServiceConfiguration.java |  10 --
 .../apache/pulsar/broker/web/ApiVersionFilter.java | 144 ----------------
 .../org/apache/pulsar/broker/web/WebService.java   |  12 --
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |   2 -
 .../pulsar/broker/web/ApiVersionFilterTest.java    | 185 ---------------------
 .../apache/pulsar/broker/web/WebServiceTest.java   |  38 -----
 8 files changed, 397 deletions(-)

commit e145c7ec25c6058eb56e3ae910ce277601448a87
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Nov 14 14:08:04 2017 -0800

    Set error-message into RestException (#902)

 .../src/main/java/org/apache/pulsar/broker/web/RestException.java | 2 +-
 .../src/test/java/org/apache/pulsar/broker/admin/AdminTest.java   | 8 ++++++++
 2 files changed, 9 insertions(+), 1 deletion(-)

commit c3b1e22708227b9376c139c53c7374b9a61c5fb5
Author: Arvin <arvindevel@gmail.com>
Date:   Tue Nov 14 13:36:49 2017 -0600

    E2e in perf-consumer (#898)
    
    * add end to end latency in performance consumer and fix typos in discoveryService
    
    * add hdrHistogram's covered value
    
    * fix time latency wrong using and decrease the time duration, addition changing the PerformanceProducer's micros using
    
    * fix wrong using of hdrHistogram
    
    * add aggregated latency after consumer stop
    
    * add aggregated latency when jvm exiting
    
    * use millis in latency statistics

 .../pulsar/discovery/service/DiscoveryService.java |  4 +-
 .../pulsar/testclient/PerformanceConsumer.java     | 53 +++++++++++++++++++++-
 2 files changed, 53 insertions(+), 4 deletions(-)

commit 635b8467d296cf4531e4cf52cb24ff9315669e21
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Nov 13 16:10:21 2017 -0800

    Fixed getting the position in PulsarKafkaConsumer when we don't have an offset yet (#900)

 .../java/org/apache/kafka/clients/consumer/PulsarKafkaConsumer.java    | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 627885563673e145b850d2160557afdc434ae2fc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Nov 9 22:07:22 2017 -0800

    Fix: discovery service logs (#897)

 .../java/org/apache/pulsar/discovery/service/DiscoveryService.java    | 4 ++--
 .../pulsar/discovery/service/server/DiscoveryServiceStarter.java      | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 29bd6c9c8574f9a04cabcbfc2c8838355561f51f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Nov 9 13:18:14 2017 -0800

    Add debug logs for LoadManager and cleanup unncessary logs (#895)

 .../pulsar/broker/cache/ConfigurationCacheService.java       |  2 +-
 .../java/org/apache/pulsar/PulsarClusterMetadataSetup.java   |  3 ++-
 .../main/java/org/apache/pulsar/broker/PulsarService.java    |  4 +++-
 .../java/org/apache/pulsar/broker/TimeAverageBrokerData.java | 12 ++++++++++++
 .../java/org/apache/pulsar/broker/admin/AdminResource.java   |  3 ---
 .../broker/loadbalance/impl/ModularLoadManagerImpl.java      |  9 +++++++++
 6 files changed, 27 insertions(+), 6 deletions(-)

commit 59931f979109590d0806ad5ef055518bede1e664
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu Nov 9 03:00:14 2017 +0900

    Fix ReaderHandler in WebSocket Proxy (#892)

 .../src/main/java/org/apache/pulsar/websocket/ReaderHandler.java        | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 163dafab36c62e390bf2a68ebb41e266c8bf4f2d
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Thu Nov 9 02:58:11 2017 +0900

    Fixed typo and right sidebar on Encryption.md (#891)

 conf/broker.conf                                                      | 2 +-
 .../src/main/java/org/apache/pulsar/broker/service/ServerCnx.java     | 4 ++--
 .../src/main/java/org/apache/pulsar/broker/web/WebService.java        | 4 ++--
 pulsar-client-cpp/tests/BasicEndToEndTest.cc                          | 2 +-
 site/_data/config/broker.yaml                                         | 2 +-
 site/docs/latest/advanced/Encryption.md                               | 1 +
 site/docs/latest/clients/Java.md                                      | 2 +-
 7 files changed, 9 insertions(+), 8 deletions(-)

commit ce289af1f8073a5a5ef41d04bed04862d80f3b08
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Nov 8 06:43:49 2017 +0900

    End-to-end encryption support in Reader (#889)

 .../apache/pulsar/client/api/TopicReaderTest.java  | 78 +++++++++++++++++++++-
 .../pulsar/client/api/ReaderConfiguration.java     | 38 +++++++++++
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |  5 ++
 3 files changed, 120 insertions(+), 1 deletion(-)

commit 122cc15d422fec7dc888ba4ab572effaf5e27812
Author: Sijie Guo <guosijie@gmail.com>
Date:   Tue Nov 7 09:24:15 2017 -0800

    Use fully-qualified name for docker image (#888)

 site/docs/latest/admin/Dashboard.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 53f4de7da65d92bb4d0acab311b6d6bd640f0e43
Author: Boyang Jerry Peng <jerry.boyang.peng@gmail.com>
Date:   Mon Nov 6 12:58:14 2017 -0800

    updating Storm version in Pulsar (#881)
    
    * updating Storm version in Pulsar
    
    * fix unit test
    
    * adding back tick tuple

 pom.xml                                            |  2 +-
 .../apache/pulsar/storm/MessageToValuesMapper.java |  4 ++--
 .../java/org/apache/pulsar/storm/PulsarBolt.java   | 22 ++++++++--------------
 .../java/org/apache/pulsar/storm/PulsarSpout.java  | 14 +++++++-------
 .../apache/pulsar/storm/TupleToMessageMapper.java  |  4 ++--
 .../apache/pulsar/storm/MockOutputCollector.java   |  9 +++++++--
 .../pulsar/storm/MockSpoutOutputCollector.java     |  7 ++++++-
 .../org/apache/pulsar/storm/PulsarBoltTest.java    | 20 ++++----------------
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |  8 ++++----
 .../apache/pulsar/storm/example/StormExample.java  | 22 +++++++++++-----------
 10 files changed, 52 insertions(+), 60 deletions(-)

commit 9433f36768f3e027d25564444c746207d77bb647
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Nov 7 02:46:20 2017 +0900

    Separate ports used by global and local zookeeper (#876)

 bin/pulsar                                         |  2 +-
 conf/bkenv.sh                                      |  2 +-
 conf/pulsar_env.sh                                 |  2 +-
 conf/pulsar_tools_env.sh                           |  2 +-
 .../pulsar/zookeeper/GlobalZooKeeperStarter.java   | 30 ++++++++++++++++++++++
 .../apache/pulsar/zookeeper/ZooKeeperStarter.java  |  6 ++++-
 site/docs/latest/deployment/Monitoring.md          |  8 ++++--
 7 files changed, 45 insertions(+), 7 deletions(-)

commit c86aceac049c1ee5c6865e619d5b14dfc11d69ab
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Nov 4 09:37:35 2017 -0700

    Reduce the default per-thread retained objects in netty Recycler (#887)

 conf/bkenv.sh      | 2 +-
 conf/pulsar_env.sh | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit d522c45d4843d4714191763e4ff0cb47d82627e5
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Nov 3 15:45:53 2017 -0700

    Use thread local to allocate temp byte[] instead of allocator (#882)

 .../org/apache/pulsar/common/api/Commands.java     | 30 ----------------------
 .../util/protobuf/ByteBufCodedInputStream.java     | 17 ++++++------
 .../util/protobuf/ByteBufCodedOutputStream.java    | 19 +++++++-------
 3 files changed, 19 insertions(+), 47 deletions(-)

commit 7c35ce466db05d8fc35cc35bb3ecf2ff159d54a8
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Nov 3 15:27:08 2017 -0700

    Use 127.0.0.1 in standalone and clean the cookie in case of conflicts (#879)

 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java     | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)

commit 7dbb37ed46a4f452a80e3da0ec4cec2940fd25dd
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Nov 3 15:09:23 2017 -0700

    Do not used Pooled allocator for stats buffers (#883)

 .../main/java/org/apache/pulsar/broker/service/PulsarStats.java   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit a1a479bd218bfb778550ca1ac0e6c9d1b01535e0
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Nov 3 10:39:57 2017 -0700

    CPP Client - Athens Client header visibile and remove C++11 features (#880)

 pulsar-client-cpp/lib/auth/AuthAthenz.cc       | 5 +++--
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 2 +-
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.h  | 2 ++
 3 files changed, 6 insertions(+), 3 deletions(-)

commit a0c98eb9d4ffef7cf1ffed6824c3871ecaa968b2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Nov 2 17:24:58 2017 -0700

    Namespace-isolation policy should consider secondary brokers (#877)
    
    * Namespace-isolation policy should consider secondary brokers
    
    * fix: secondaryCache renaming
    
    * fix test: set broker-host name in isolation policies and not broker-url

 .../broker/loadbalance/impl/LoadManagerShared.java |  20 ++--
 .../impl/SimpleResourceAllocationPolicies.java     |   2 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  13 ++-
 .../loadbalance/ModularLoadManagerImplTest.java    | 127 +++++++++++++++++++++
 4 files changed, 146 insertions(+), 16 deletions(-)

commit 9f63fa789aec8fab44a05f071da691b2e4b9be95
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed Nov 1 16:35:25 2017 +0900

    Fix ConsumerHandler in WebSocket Proxy (#875)

 .../src/main/java/org/apache/pulsar/websocket/ConsumerHandler.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5a4dd113822913431406844051a3d592d22fca84
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 31 14:44:35 2017 -0700

    Fix: Non-persistent topic acking sequence for dropped message (#874)

 .../apache/pulsar/broker/service/ServerCnx.java    | 22 +++++++++++++---------
 .../pulsar/client/api/NonPersistentTopicTest.java  | 10 ++++++----
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  4 ++--
 3 files changed, 21 insertions(+), 15 deletions(-)

commit 3105a467d5fe22cee36d6cc1936aa9ea32250f0b
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed Nov 1 05:14:57 2017 +0900

    Fix missing parenthesises in WebSocket sample code (#873)

 site/docs/latest/clients/WebSocket.md | 4 ++--
 site/ja/clients/WebSocket.md          | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 62000d4b3525f739b02ba64db80d663c6ec5efa9
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 30 22:31:32 2017 -0700

    Moved some info logs in ClientCnx to debug level (#870)

 .../java/org/apache/pulsar/client/impl/ClientCnx.java    | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)

commit 9a851349f9fa8b6ce3410cf982b8111e51675e4f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 30 21:04:00 2017 -0700

    Recycle MessagePublishContext when publish fails at broker (#871)

 .../src/main/java/org/apache/pulsar/broker/service/Producer.java         | 1 +
 1 file changed, 1 insertion(+)

commit 815bd70cdea09bdd3ad28f07274fa60b2ce6adde
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Oct 30 10:29:23 2017 -0700

    Cleanup load-manager configuration and make ModularLoadManager default load-manager (#865)
    
    * Cleanup load-manager configuration and make ModularLoadManager default load-manager
    
    * fix tests
    
    * address PR update config-value + keep deprecated config in broker.conf
    
    * removed deprecated config
    
    * Set SimpleLoadManagerImpl for SimpleLoadManager-Test
    
    * rebase and fix brokerStats

 conf/broker.conf                                   | 28 +++++------------
 conf/standalone.conf                               | 22 ++++----------
 .../apache/pulsar/broker/ServiceConfiguration.java | 35 ++++++++++++----------
 .../apache/pulsar/broker/admin/BrokerStats.java    |  5 ++--
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 10 -------
 .../org/apache/pulsar/broker/admin/AdminTest.java  | 25 +++++++---------
 .../broker/loadbalance/LoadBalancerTest.java       | 22 +++++++-------
 .../loadbalance/SimpleLoadManagerImplTest.java     |  2 ++
 .../pulsar/broker/service/BrokerServiceTest.java   |  2 +-
 9 files changed, 61 insertions(+), 90 deletions(-)

commit c4369277d75be6ff832209163fbda934f8a9ffb6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Oct 29 21:57:09 2017 -0700

    Broker-stats return load-report based on loadmanager + fix: modularLoadManager-loadReport (#869)
    
    * Broker-stats return load-report based on loadmanager + fix: modularLoadManager-loadReport
    
    * return loadReport on updateLocalBrokerData
    
    * Fix: LoadBalancerTest.testLoadReportsWrittenOnZK

 .../java/org/apache/pulsar/broker/BrokerData.java  |  2 +
 .../java/org/apache/pulsar/broker/BundleData.java  |  1 +
 .../pulsar/broker/TimeAverageBrokerData.java       |  1 +
 .../apache/pulsar/broker/admin/BrokerStats.java    |  3 +-
 .../pulsar/broker/loadbalance/LoadManager.java     |  6 +-
 .../broker/loadbalance/ModularLoadManager.java     |  3 +-
 .../loadbalance/impl/BundleSplitterTask.java       |  3 +-
 .../loadbalance/impl/LeastLongTermMessageRate.java |  2 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 12 ++--
 .../impl/ModularLoadManagerWrapper.java            |  7 +-
 .../broker/loadbalance/impl/OverloadShedder.java   |  2 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 11 +---
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 46 ++++++++++---
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  2 +-
 .../loadbalance/BrokerVersionFilterTest.java       |  2 +-
 .../broker/loadbalance/LoadBalancerTest.java       | 16 ++---
 .../loadbalance/ModularLoadManagerImplTest.java    |  2 +-
 .../ModularLoadManagerStrategyTest.java            |  2 +-
 .../broker/namespace/NamespaceServiceTest.java     |  2 +-
 .../apache/pulsar/client/admin/BrokerStats.java    |  3 +
 .../client/admin/internal/BrokerStatsImpl.java     |  8 ++-
 .../apache/pulsar/admin/cli/CmdBrokerStats.java    | 11 ++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      | 22 +++++++
 .../util}/NamespaceBundleStatsComparator.java      |  4 +-
 .../policies/data/loadbalancer}/JSONWritable.java  |  2 +-
 .../data/loadbalancer/LoadManagerReport.java       | 64 ++++++++++++++++++
 .../policies/data/loadbalancer/LoadReport.java     | 75 +++++++++++++++++-----
 .../data/loadbalancer}/LocalBrokerData.java        | 30 +++++++--
 .../apache/pulsar/testclient/BrokerMonitor.java    |  2 +-
 29 files changed, 267 insertions(+), 79 deletions(-)

commit 5c58367600dccc77cd4c4a5fb522fac904c6cf04
Author: Andrey Falko <afalko@users.noreply.github.com>
Date:   Fri Oct 27 20:05:07 2017 -0700

    Add proxy configuration for kubernetes (#856)

 kubernetes/generic/proxy.yaml | 89 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 89 insertions(+)

commit e12d0fd0171b79296f16a8745eb396f482efdea9
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 27 17:59:56 2017 -0700

    Pulsar-testclient should not fetch the shaded pulsar-client dependency (#868)

 pulsar-testclient/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8ba2a7c35c9f01c5a6c3deeb6d5f70076489da39
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Oct 27 16:51:52 2017 -0700

    Fix: profobuf interface generation on doc (#864)

 site/_includes/protobuf.html | 54 ++++++++++++++++++++++----------------------
 1 file changed, 27 insertions(+), 27 deletions(-)

commit 3e965b2d4b3812068d92e8073ca1fff39cd2437d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Oct 27 09:58:24 2017 -0700

    Make spark consumer-listener lambda Serializable (#866)

 .../org/apache/pulsar/spark/SparkStreamingPulsarReceiver.java     | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

commit 6bd024da113587c1b92d56ed735d49d97d3bfb78
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 26 16:22:33 2017 -0700

    Fix: compilation error for NamespaceServiceTest (#863)

 .../java/org/apache/pulsar/broker/namespace/NamespaceServiceTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit eb9e5fc933ea0a1f98f02c201af29634e7caaa0a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 26 14:56:02 2017 -0700

    Introduce auto bundle split and unloading of split bundle in ModularLoadManager (#857)

 conf/broker.conf                                   |   3 +
 conf/standalone.conf                               |   3 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  14 ++-
 .../org/apache/pulsar/broker/PulsarService.java    |   7 +-
 .../pulsar/broker/TimeAverageMessageData.java      |  18 +++
 .../org/apache/pulsar/broker/admin/Namespaces.java |   5 +-
 .../broker/loadbalance/BundleSplitStrategy.java    |  40 ++++++
 .../broker/loadbalance/ModularLoadManager.java     |   2 +-
 .../loadbalance/impl/BundleSplitterTask.java       | 111 ++++++++++++++++
 .../broker/loadbalance/impl/LoadManagerShared.java |   4 +
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  59 ++++++++-
 .../impl/ModularLoadManagerWrapper.java            |   7 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   8 +-
 .../pulsar/broker/namespace/NamespaceService.java  |  36 ++++--
 .../common/naming/NamespaceBundleFactory.java      |  13 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |   2 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |   4 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  30 +++--
 .../broker/namespace/NamespaceServiceTest.java     |   4 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java | 139 ++++++++++++++++++++-
 .../org/apache/pulsar/client/admin/Namespaces.java |   3 +-
 .../client/admin/internal/NamespacesImpl.java      |   6 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |   6 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   2 +-
 24 files changed, 479 insertions(+), 47 deletions(-)

commit 844819843835ccc0a6fb1c150656d2ddb21fc1df
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Oct 26 14:02:37 2017 -0700

    Allow to configure the default number of bundles for new namespaces (#854)

 conf/broker.conf                                   |   6 +-
 conf/standalone.conf                               |   5 +-
 .../apache/pulsar/broker/ServiceConfiguration.java |  14 ++-
 .../org/apache/pulsar/broker/admin/Namespaces.java |   5 +-
 .../apache/pulsar/broker/SLAMonitoringTest.java    |   1 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   1 +
 .../namespace/NamespaceCreateBundlesTest.java      |  55 ++++++++++
 .../broker/namespace/NamespaceServiceTest.java     |  65 +++++++++++
 .../pulsar/client/api/BrokerServiceLookupTest.java | 121 +++++++++++----------
 site/docs/latest/deployment/Kubernetes.md          |   4 +-
 site/ja/deployment/Kubernetes.md                   |   4 +-
 11 files changed, 213 insertions(+), 68 deletions(-)

commit 16819f041212e218351ade74f08a336b3e5f3875
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 26 12:40:50 2017 -0700

    add query-param for websocket-readme (#860)

 site/docs/latest/clients/WebSocket.md | 29 +++++++++++++++++++++++++++++
 1 file changed, 29 insertions(+)

commit d251649eb4caa14ee965c0f4727b7a1e66b1296d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 26 11:34:04 2017 -0700

    fix: return correct error while splitting bundle which can't be split further (#859)

 .../org/apache/pulsar/broker/admin/Namespaces.java |  4 ++++
 .../common/naming/NamespaceBundleFactory.java      |  8 ++++++-
 .../apache/pulsar/broker/admin/NamespacesTest.java | 25 ++++++++++++++++++++++
 3 files changed, 36 insertions(+), 1 deletion(-)

commit 62e1746dbeea070413f6904c117f8f4e7d6eb4b3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 26 11:01:36 2017 -0700

    Validate messageRoutingMode and config-enum values in websocket (#862)

 .../org/apache/pulsar/websocket/ConsumerHandler.java   |  9 ++++++++-
 .../org/apache/pulsar/websocket/ProducerHandler.java   | 18 ++++++++++++++++--
 2 files changed, 24 insertions(+), 3 deletions(-)

commit bbc52fe7f77f24e9b641fb4eab70d10ce69cc5fb
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 24 18:27:15 2017 -0700

    Avoid interrupted exception in PulsarKafkaConsumer when shutting down (#852)

 .../apache/kafka/clients/consumer/PulsarKafkaConsumer.java | 14 ++++++++++----
 .../java/org/apache/pulsar/client/impl/ConsumerImpl.java   | 10 ++++++++--
 2 files changed, 18 insertions(+), 6 deletions(-)

commit aa40f9652f5587dddf80c53149a4f052bf7a8055
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 24 18:26:47 2017 -0700

    Use info log level for message "Reconnecting after timeout" in HandlerBase (#851)

 .../src/main/java/org/apache/pulsar/client/impl/HandlerBase.java        | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c85a779d5929a0e43b3a8239b3236cbeea7e33a4
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 24 13:38:16 2017 -0700

     Implement seekToBeginning()/end operations in Kafka consumer wrapper  (#849)

 .../clients/consumer/PulsarKafkaConsumer.java      |  83 +++++++++++++---
 .../kafka/compat/tests/KafkaConsumerTest.java      | 106 +++++++++++++++++++++
 2 files changed, 175 insertions(+), 14 deletions(-)

commit a5b565920a3b1d4d95e58c71bc5c9ad77dcd8007
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 24 11:49:36 2017 -0700

    In C++ partitioned consumer, do not append partition index in subscription name (#836)

 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc |  6 ++---
 pulsar-client-cpp/tests/BasicEndToEndTest.cc     | 32 +++++++++++++++++++++---
 2 files changed, 30 insertions(+), 8 deletions(-)

commit 6625f8e455ccea79ed57fa528080a0328f3bbcbe
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 24 11:09:42 2017 -0700

    Publish the shaded pulsar-client as the default dependency (#846)

 pom.xml                                            |   1 +
 pulsar-broker/pom.xml                              |   4 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   8 +-
 pulsar-client-admin/pom.xml                        |   4 +-
 pulsar-client-auth-athenz/pom.xml                  |   2 +-
 .../client/kafka/compat/tests/KafkaApiTest.java    |   5 +
 .../pulsar-client-kafka/pom.xml                    |  10 ++
 pulsar-client-shaded/pom.xml                       | 148 +++++++++++++++++++++
 pulsar-client-tools/pom.xml                        |   2 +-
 pulsar-client/pom.xml                              |  99 +-------------
 pulsar-proxy/pom.xml                               |   2 +-
 pulsar-websocket/pom.xml                           |   2 +-
 12 files changed, 178 insertions(+), 109 deletions(-)

commit 21e09d609518d03b28366fe054dc4ff2d8d06a49
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed Oct 25 01:29:07 2017 +0900

    Enable json format to be used as an authentication params string (#847)

 pulsar-client-cpp/lib/auth/AuthAthenz.cc  | 30 +++++++++++++++++++++++++++++-
 pulsar-client-cpp/lib/auth/AuthAthenz.h   |  1 +
 pulsar-client-cpp/tests/AuthPluginTest.cc | 15 ++++++++-------
 3 files changed, 38 insertions(+), 8 deletions(-)

commit 7ba3675fbf9b82b59f4a4ea46ef05ebe287a8865
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Oct 25 00:13:06 2017 +0900

    Change timezone of request log from GMT to local one (#841)

 .../src/main/java/org/apache/pulsar/broker/web/WebService.java        | 4 ++--
 .../org/apache/pulsar/discovery/service/server/ServerManager.java     | 3 ++-
 .../src/main/java/org/apache/pulsar/proxy/server/WebServer.java       | 3 ++-
 .../main/java/org/apache/pulsar/websocket/service/ProxyServer.java    | 3 ++-
 4 files changed, 8 insertions(+), 5 deletions(-)

commit e981e5a5214cd4f0bebe01bab6d32417e4860046
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 24 08:11:26 2017 -0700

    Use "trimStackTrace" option in Maven surefire (#850)

 pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit df56dc981e8a298b30e832d641747ebcd45ded30
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 23 22:07:10 2017 -0700

    Allow consumer to seek to message id from within Pulsar client (#848)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  26 +-
 .../apache/pulsar/broker/service/ServerCnx.java    |  41 ++
 .../apache/pulsar/broker/service/Subscription.java |  13 +-
 .../nonpersistent/NonPersistentSubscription.java   |  10 +-
 .../service/persistent/PersistentSubscription.java |  15 +-
 .../broker/service/SubscriptionSeekTest.java       | 110 ++++
 .../org/apache/pulsar/client/api/Consumer.java     |  39 ++
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  43 +-
 .../client/impl/PartitionedConsumerImpl.java       |  17 +
 .../org/apache/pulsar/common/api/Commands.java     |  27 +-
 .../apache/pulsar/common/api/PulsarDecoder.java    |  11 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 588 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  11 +
 13 files changed, 926 insertions(+), 25 deletions(-)

commit 79ecb72d92a1d47b7c5bcab71dbfdbea852432d3
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Sat Oct 21 08:49:15 2017 +0900

    Modify AuthFactory for C++ Client to enable each plugin to parse authPramsString (#792)

 pulsar-client-cpp/lib/Authentication.cc  | 46 +++++++++++++++++++++++---------
 pulsar-client-cpp/lib/auth/AuthAthenz.cc |  2 +-
 pulsar-client-cpp/lib/auth/AuthTls.cc    |  2 +-
 3 files changed, 36 insertions(+), 14 deletions(-)

commit 4288839fb82f2c64549fc8c6fb4f70db2b72b961
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 20 10:02:27 2017 -0700

    Add PulsarClientImpl.getNumberOfPartitions() to avoid exposing PartitionedTopicMetadata (#842)

 .../org/apache/kafka/clients/consumer/PulsarKafkaConsumer.java     | 7 +++----
 .../main/java/org/apache/pulsar/client/impl/PulsarClientImpl.java  | 4 ++++
 2 files changed, 7 insertions(+), 4 deletions(-)

commit 2c1cbc899fe378b4e8f1c2773f77289fb340a636
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Sat Oct 21 02:02:06 2017 +0900

    Fixed PulsarClientToolTest.testInitialzation (#843)

 .../apache/pulsar/client/cli/PulsarClientToolTest.java    | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit f5268ed3413739641360f603a4aa293dd5441578
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Fri Oct 20 09:36:18 2017 -0700

    Specify rsa transform, aes & tag length (#839)

 .../apache/pulsar/client/impl/MessageCrypto.java   | 23 +++++++++++++++++-----
 1 file changed, 18 insertions(+), 5 deletions(-)

commit 1d9d596ebe65dc6cefae5d5406179146c785cbb4
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Tue Oct 17 23:02:45 2017 -0700

    Check data buffer before release() (#835)

 .../java/org/apache/pulsar/client/impl/MessageCrypto.java   | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

commit fb92a51a8af6cd226d72155c2e75dd15981261f6
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 17 23:02:18 2017 -0700

    Correct Kafka wrapper producer blocking semantic and passing the producer config object (#833)

 .../kafka/clients/producer/PulsarKafkaProducer.java      | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

commit 18aec9a3e02369445b81082b204cf78bbd9edbea
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Oct 18 13:11:50 2017 +0900

    Enable replicator to encrypt communication using TLS (#824)

 conf/broker.conf                                   |  3 +
 .../apache/pulsar/broker/ServiceConfiguration.java | 11 ++++
 .../pulsar/broker/service/BrokerService.java       | 20 ++++---
 .../pulsar/broker/service/ReplicatorTestBase.java  | 60 ++++++++++++++------
 .../pulsar/broker/service/ReplicatorTlsTest.java   | 64 ++++++++++++++++++++++
 .../pulsar/client/impl/PulsarClientImpl.java       |  2 +-
 site/_data/config/broker.yaml                      |  3 +
 7 files changed, 139 insertions(+), 24 deletions(-)

commit 438d0832810e3489d4afe2600755600059699ed5
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 17 17:40:27 2017 -0700

    Fixed missing message key on received batched messages (#837)

 .../pulsar/broker/service/PartitionKeyTest.java    | 81 ++++++++++++++++++++++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  4 ++
 2 files changed, 85 insertions(+)

commit 9e3f390c8637c9804c234b01b8b396945a363af1
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Oct 18 07:20:49 2017 +0900

    Add ASF headers to Markdown documentation files (#823)

 .gitignore.swp                                     | Bin 0 -> 12288 bytes
 CONTRIBUTORS.md                                    |  20 +++++++++++++
 README.md                                          |  21 ++++++++++++++
 build/docker/README.md                             |  19 +++++++++++++
 dashboard/README.md                                |  20 +++++++++++++
 kubernetes/README.md                               |  20 +++++++++++++
 pom.xml                                            |  31 +++++++++++++++++----
 protobuf/README.md                                 |  20 +++++++++++++
 pulsar-client-cpp/README.md                        |  20 +++++++++++++
 pulsar-client-cpp/docs/MainPage.md                 |  21 ++++++++++++++
 pulsar-discovery-service/readme.md                 |  21 ++++++++++++++
 site/Gemfile                                       |  19 +++++++++++++
 site/README.md                                     |  21 ++++++++++++++
 site/_includes/explanations/admin-setup.md         |  21 ++++++++++++++
 site/_includes/explanations/client-url.md          |  23 ++++++++++++++-
 site/_includes/explanations/deploying-bk.md        |  21 ++++++++++++++
 site/_includes/explanations/deploying-zk.md        |  21 ++++++++++++++
 site/_includes/explanations/install-package.md     |  20 +++++++++++++
 site/_includes/explanations/ja/admin-setup.md      |  21 ++++++++++++++
 site/_includes/explanations/ja/broker-admin.md     |  21 ++++++++++++++
 site/_includes/explanations/ja/client-url.md       |  21 ++++++++++++++
 site/_includes/explanations/ja/cluster-admin.md    |  21 ++++++++++++++
 site/_includes/explanations/ja/deploying-bk.md     |  21 ++++++++++++++
 site/_includes/explanations/ja/deploying-zk.md     |  21 ++++++++++++++
 site/_includes/explanations/ja/install-package.md  |  21 ++++++++++++++
 site/_includes/explanations/ja/instance-admin.md   |  21 ++++++++++++++
 site/_includes/explanations/ja/namespace-admin.md  |  21 ++++++++++++++
 .../explanations/ja/non-persistent-topic-admin.md  |  21 ++++++++++++++
 .../explanations/ja/non-persistent-topics.md       |  21 ++++++++++++++
 .../explanations/ja/partitioned-topic-admin.md     |  21 ++++++++++++++
 .../explanations/ja/partitioned-topics.md          |  21 ++++++++++++++
 site/_includes/explanations/ja/permissions.md      |  21 ++++++++++++++
 .../explanations/ja/persistent-topic-admin.md      |  21 ++++++++++++++
 .../explanations/ja/properties-namespaces.md       |  21 ++++++++++++++
 site/_includes/explanations/ja/property-admin.md   |  21 ++++++++++++++
 .../explanations/ja/service-discovery-setup.md     |  21 ++++++++++++++
 .../explanations/non-persistent-topics.md          |  21 ++++++++++++++
 .../explanations/partitioned-topic-admin.md        |  21 ++++++++++++++
 site/_includes/explanations/partitioned-topics.md  |  21 ++++++++++++++
 site/_includes/explanations/permissions.md         |  21 ++++++++++++++
 .../explanations/properties-namespaces.md          |  21 ++++++++++++++
 .../explanations/service-discovery-setup.md        |  21 ++++++++++++++
 site/_sass/_admonition.scss                        |  18 ++++++++++++
 site/_sass/_cli.scss                               |  18 ++++++++++++
 site/_sass/_docs.scss                              |  18 ++++++++++++
 site/_sass/_mixins.scss                            |  18 ++++++++++++
 site/_sass/_navbar.scss                            |  20 ++++++++++++-
 site/_sass/_popover.scss                           |  18 ++++++++++++
 site/_sass/_protobuf.scss                          |  18 ++++++++++++
 site/_sass/_sidebar.scss                           |  20 ++++++++++++-
 site/_sass/_swagger.scss                           |  18 ++++++++++++
 site/_sass/_syntax.scss                            |  18 ++++++++++++
 site/_sass/_toc.scss                               |  18 ++++++++++++
 site/_sass/_variables.scss                         |  18 ++++++++++++
 site/contact.md                                    |  20 +++++++++++++
 site/css/style.scss                                |  19 +++++++++++++
 site/docs/latest/adaptors/KafkaWrapper.md          |  21 ++++++++++++++
 site/docs/latest/adaptors/PulsarSpark.md           |  21 ++++++++++++++
 site/docs/latest/adaptors/PulsarStorm.md           |  21 ++++++++++++++
 site/docs/latest/admin-api/brokers.md              |  21 ++++++++++++++
 site/docs/latest/admin-api/clusters.md             |  21 ++++++++++++++
 site/docs/latest/admin-api/namespaces.md           |  21 ++++++++++++++
 .../docs/latest/admin-api/non-persistent-topics.md |  21 ++++++++++++++
 site/docs/latest/admin-api/overview.md             |  21 ++++++++++++++
 site/docs/latest/admin-api/partitioned-topics.md   |  21 ++++++++++++++
 site/docs/latest/admin-api/permissions.md          |  21 ++++++++++++++
 site/docs/latest/admin-api/persistent-topics.md    |  21 ++++++++++++++
 site/docs/latest/admin-api/properties.md           |  21 ++++++++++++++
 site/docs/latest/admin/Authz.md                    |  21 ++++++++++++++
 site/docs/latest/admin/Dashboard.md                |  21 ++++++++++++++
 site/docs/latest/admin/GeoReplication.md           |  21 ++++++++++++++
 site/docs/latest/admin/ModularLoadManager.md       |  21 ++++++++++++++
 site/docs/latest/admin/Stats.md                    |  21 ++++++++++++++
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |  23 ++++++++++++++-
 site/docs/latest/advanced/Encryption.md            |  21 ++++++++++++++
 site/docs/latest/advanced/PartitionedTopics.md     |  21 ++++++++++++++
 site/docs/latest/advanced/RetentionExpiry.md       |  21 ++++++++++++++
 site/docs/latest/clients/Cpp.md                    |  21 ++++++++++++++
 site/docs/latest/clients/Java.md                   |  21 ++++++++++++++
 site/docs/latest/clients/Python.md                 |  21 ++++++++++++++
 site/docs/latest/clients/WebSocket.md              |  21 ++++++++++++++
 site/docs/latest/deployment/InstanceSetup.md       |  21 ++++++++++++++
 site/docs/latest/deployment/Kubernetes.md          |  21 ++++++++++++++
 site/docs/latest/deployment/Monitoring.md          |  21 ++++++++++++++
 site/docs/latest/getting-started/Clients.md        |  21 ++++++++++++++
 .../getting-started/ConceptsAndArchitecture.md     |  21 ++++++++++++++
 site/docs/latest/getting-started/LocalCluster.md   |  23 ++++++++++++++-
 site/docs/latest/getting-started/docker.md         |  20 +++++++++++++
 site/docs/latest/project/BinaryProtocol.md         |  21 ++++++++++++++
 site/docs/latest/project/Codebase.md               |  23 ++++++++++++++-
 site/docs/latest/project/SimulationTools.md        |  21 ++++++++++++++
 site/docs/latest/reference/CliTools.md             |  21 ++++++++++++++
 site/docs/latest/reference/Configuration.md        |  21 ++++++++++++++
 site/docs/latest/reference/RestApi.md              |  21 ++++++++++++++
 site/download.md                                   |  21 ++++++++++++++
 site/ja/adaptors/PulsarSpark.md                    |  21 ++++++++++++++
 site/ja/adaptors/PulsarStorm.md                    |  21 ++++++++++++++
 site/ja/admin/AdminInterface.md                    |  21 ++++++++++++++
 site/ja/admin/Authz.md                             |  21 ++++++++++++++
 site/ja/admin/ClustersBrokers.md                   |  21 ++++++++++++++
 site/ja/admin/Dashboard.md                         |  21 ++++++++++++++
 site/ja/admin/GeoReplication.md                    |  21 ++++++++++++++
 site/ja/admin/ModularLoadManager.md                |  21 ++++++++++++++
 site/ja/admin/PropertiesNamespaces.md              |  21 ++++++++++++++
 site/ja/admin/Stats.md                             |  21 ++++++++++++++
 site/ja/admin/ZooKeeperBookKeeper.md               |  21 ++++++++++++++
 site/ja/advanced/PartitionedTopics.md              |  21 ++++++++++++++
 site/ja/advanced/RetentionExpiry.md                |  21 ++++++++++++++
 site/ja/clients/Cpp.md                             |  21 ++++++++++++++
 site/ja/clients/Java.md                            |  21 ++++++++++++++
 site/ja/clients/Python.md                          |  21 ++++++++++++++
 site/ja/clients/WebSocket.md                       |  21 ++++++++++++++
 site/ja/deployment/InstanceSetup.md                |  21 ++++++++++++++
 site/ja/deployment/Kubernetes.md                   |  21 ++++++++++++++
 site/ja/deployment/Monitoring.md                   |  21 ++++++++++++++
 site/ja/getting-started/Clients.md                 |  21 ++++++++++++++
 site/ja/getting-started/ConceptsAndArchitecture.md |  21 ++++++++++++++
 site/ja/getting-started/LocalCluster.md            |  21 ++++++++++++++
 site/ja/project/BinaryProtocol.md                  |  21 ++++++++++++++
 site/ja/project/Codebase.md                        |  21 ++++++++++++++
 site/ja/project/SimulationTools.md                 |  21 ++++++++++++++
 site/ja/reference/CliTools.md                      |  21 ++++++++++++++
 site/ja/reference/Configuration.md                 |  21 ++++++++++++++
 site/ja/reference/RestApi.md                       |  21 ++++++++++++++
 site/presentations.md                              |  21 ++++++++++++++
 site/team.md                                       |  21 ++++++++++++++
 126 files changed, 2586 insertions(+), 11 deletions(-)

commit e92c54a79e6130115229c3fd17f5ca6d3641256d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 17 13:14:07 2017 -0700

    When trigger kafka producer callback, don't wrap the exception if it's null (#832)

 .../clients/producer/PulsarKafkaProducer.java      | 21 +++++++-----
 .../kafka/compat/tests/KafkaProducerTest.java      | 38 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 9 deletions(-)

commit b7bbe90df445001da6241a7f08423c3d0e5306d0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 17 11:28:55 2017 -0700

    Avoid bundle-split with old load-report (#826)
    
    * Avoid bundle-split with old load-report
    
    * Remove old split-bundle from stats so load-manager can read before stats update

 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 26 +++++++++++++++++-----
 .../pulsar/broker/service/BrokerService.java       |  1 +
 .../apache/pulsar/broker/service/PulsarStats.java  |  4 ++++
 3 files changed, 25 insertions(+), 6 deletions(-)

commit a26c1e591b83230aeb5d58c597f20c3620db183b
Author: jai1 <jai1@users.noreply.github.com>
Date:   Tue Oct 17 00:13:44 2017 -0700

    CPP Tests - Prevent failure due to namespace creation on rerun (#830)

 pulsar-client-cpp/tests/ClientDeduplicationTest.cc | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 55e04b69e252e7670806be05cadbfa1e5cfb235c
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Tue Oct 17 16:03:51 2017 +0900

    Add athenz role header property (#831)

 .../java/org/apache/pulsar/client/impl/auth/AuthenticationAthenz.java  | 3 +++
 1 file changed, 3 insertions(+)

commit f551c4f6ed8282d4d7678dbdceb77450ba2af432
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Oct 13 12:04:45 2017 -0700

    Update bundle-cache on split-bundle and avoid disabling main bundle (#822)

 .../broker/cache/LocalZooKeeperCacheService.java   |   4 +-
 .../pulsar/broker/namespace/NamespaceService.java  |   4 +-
 .../common/naming/NamespaceBundleFactory.java      |  13 ++-
 .../broker/cache/ResourceQuotaCacheTest.java       |  12 +++
 .../broker/namespace/NamespaceServiceTest.java     |   6 +-
 .../broker/namespace/OwnershipCacheTest.java       |  14 ++-
 .../pulsar/client/api/BrokerServiceLookupTest.java | 101 +++++++++++++++++++++
 .../pulsar/common/naming/NamespaceBundleTest.java  |  20 +++-
 .../pulsar/common/naming/NamespaceBundlesTest.java |  24 ++++-
 9 files changed, 186 insertions(+), 12 deletions(-)

commit ccd9ff305b911eccc6a47bc6bc6c907bfd906544
Author: joefk <22042978+joefk@users.noreply.github.com>
Date:   Fri Oct 13 08:45:12 2017 -0700

    Update _config.yml (#825)

 site/_config.yml | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit b4694c6b3a247d0a81babc70de476017dd77e297
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Oct 11 20:22:26 2017 -0700

    Documentation: Added a few more commands to BinaryProtocol.md (#819)

 site/docs/latest/project/BinaryProtocol.md | 25 ++++++++++++++++++++++++-
 1 file changed, 24 insertions(+), 1 deletion(-)

commit f6ae797f37697488329e747b7e4e6a2e01142da4
Author: massakam <massakam@yahoo-corp.jp>
Date:   Wed Oct 11 02:52:12 2017 +0900

    Prevent message duplication when active consumer is changed (#807)

 conf/broker.conf                                   |  3 +
 conf/standalone.conf                               |  3 +
 .../apache/pulsar/broker/ServiceConfiguration.java | 10 +++
 .../PersistentDispatcherSingleActiveConsumer.java  | 74 ++++++++++++++-----
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  1 +
 .../broker/service/PersistentFailoverE2ETest.java  | 84 ++++++++++++++++++++++
 .../pulsar/broker/service/ReplicatorTest.java      |  7 ++
 .../client/api/DispatcherBlockConsumerTest.java    |  4 +-
 .../client/api/SimpleProducerConsumerTest.java     |  2 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 16 +++--
 site/_data/config/broker.yaml                      |  3 +
 site/_data/config/standalone.yaml                  |  3 +
 12 files changed, 186 insertions(+), 24 deletions(-)

commit 34ae881adb267d7cf7348335b576e281a22bfb72
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 10 10:49:27 2017 -0700

    Admin-api to reset cursor by position (#785)
    
    * Admin-api to reset cursor by position
    
    * Fix: api notes for global topic
    
    * reset cursor using messageId

 .../pulsar/broker/admin/PersistentTopics.java      |  70 ++++++--
 .../apache/pulsar/broker/service/Subscription.java |   4 +-
 .../nonpersistent/NonPersistentSubscription.java   |   6 +
 .../service/persistent/PersistentSubscription.java | 125 +++++++-------
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  58 -------
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 181 ++++++++++++++++++++-
 .../pulsar/client/admin/PersistentTopics.java      |  33 ++++
 .../admin/internal/PersistentTopicsImpl.java       |  22 +++
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  39 ++++-
 9 files changed, 404 insertions(+), 134 deletions(-)

commit 193ea5373eaf74522e300745126de4764d92774f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Oct 7 10:35:24 2017 -0700

    Pass originalPrincipal from proxy to broker for auth + Fix tls (#816)

 .../apache/pulsar/broker/service/ServerCnx.java    |  55 +++---
 .../pulsar/broker/service/ServerCnxTest.java       |   2 +-
 .../org/apache/pulsar/common/api/Commands.java     |  15 +-
 .../pulsar/proxy/server/DirectProxyHandler.java    |  38 +++-
 .../pulsar/proxy/server/LookupProxyHandler.java    |   4 +-
 .../pulsar/proxy/server/ProxyConfiguration.java    |  20 ++
 .../apache/pulsar/proxy/server/ProxyService.java   |   6 +
 .../ProxyAuthenticatedProducerConsumerTest.java    | 211 +++++++++++++++++++++
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   |   9 +-
 .../resources/{ => authentication/tls}/cacert.pem  |   0
 .../resources/authentication/tls/client-cert.pem   |  72 +++++++
 .../resources/authentication/tls/client-key.pem    |  28 +++
 .../tls/server-cert.pem}                           |   0
 .../tls/server-key.pem}                            |   0
 14 files changed, 424 insertions(+), 36 deletions(-)

commit 33d14813ea5d7616219d972afefabc261a7774ae
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Sun Oct 8 02:34:51 2017 +0900

    Support json format in AuthenticationAthenz's authParams (#793)

 .../client/impl/auth/AuthenticationAthenz.java     | 33 ++++++++++++++++++++--
 1 file changed, 30 insertions(+), 3 deletions(-)

commit c65207eba8a470575f8fbe486330618053aa7b5e
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Sun Oct 8 02:34:04 2017 +0900

    Added privateKey field to cpp Athenz client plugin's authParams (#803)

 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 83 +++++++++++++++++++++-----
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.h  | 14 ++++-
 pulsar-client-cpp/tests/AuthPluginTest.cc      |  2 +-
 pulsar-client-cpp/tests/CMakeLists.txt         |  2 +-
 pulsar-client-cpp/tests/ZTSClientTest.cc       | 71 ++++++++++++++++++++++
 5 files changed, 153 insertions(+), 19 deletions(-)

commit d360b07e71eb825cf1cab6f81f1dddaecda36f5e
Author: kyontan <kyontan@monora.me>
Date:   Sun Oct 8 00:57:03 2017 +0900

    Add method to returns bytes type in Python client (#812)

 pulsar-client-cpp/python/pulsar.py      |  2 +-
 pulsar-client-cpp/python/pulsar_test.py | 18 +++++++++---------
 pulsar-client-cpp/python/src/message.cc |  6 +++++-
 3 files changed, 15 insertions(+), 11 deletions(-)

commit 16bf10b69eced4a0d47ec21a23da6bacdfdcdafb
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Fri Oct 6 12:26:20 2017 -0700

    Added end user documentation for encryption (#802)

 .../pulsar/client/tutorial/SampleConsumer.java     |   2 +-
 .../client/tutorial/SampleCryptoConsumer.java      |  98 ++++++++++++
 .../client/tutorial/SampleCryptoProducer.java      |  91 +++++++++++
 site/_data/sidebar.yaml                            |   2 +
 site/docs/latest/advanced/Encryption.md            | 173 +++++++++++++++++++++
 site/img/PulsarEncryptionConsumer.jpg              | Bin 0 -> 31221 bytes
 site/img/PulsarEncryptionProducer.jpg              | Bin 0 -> 30885 bytes
 7 files changed, 365 insertions(+), 1 deletion(-)

commit 482c4c18c755de461c13f20d9daca560137b80f1
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Oct 5 15:53:43 2017 -0700

    Bumped version to 1.21.0-incubating-SNAPSHOT (#815)

 all/pom.xml                                                  | 2 +-
 managed-ledger/pom.xml                                       | 2 +-
 pom.xml                                                      | 2 +-
 pulsar-broker-auth-athenz/pom.xml                            | 2 +-
 pulsar-broker-common/pom.xml                                 | 2 +-
 pulsar-broker/pom.xml                                        | 2 +-
 pulsar-checksum/pom.xml                                      | 2 +-
 pulsar-client-admin/pom.xml                                  | 2 +-
 pulsar-client-auth-athenz/pom.xml                            | 2 +-
 pulsar-client-kafka-compat/pom.xml                           | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka-tests/pom.xml | 2 +-
 pulsar-client-kafka-compat/pulsar-client-kafka/pom.xml       | 2 +-
 pulsar-client-tools/pom.xml                                  | 2 +-
 pulsar-client/pom.xml                                        | 2 +-
 pulsar-common/pom.xml                                        | 2 +-
 pulsar-discovery-service/pom.xml                             | 2 +-
 pulsar-proxy/pom.xml                                         | 2 +-
 pulsar-spark/pom.xml                                         | 2 +-
 pulsar-storm/pom.xml                                         | 2 +-
 pulsar-testclient/pom.xml                                    | 2 +-
 pulsar-websocket/pom.xml                                     | 2 +-
 pulsar-zookeeper-utils/pom.xml                               | 2 +-
 pulsar-zookeeper/pom.xml                                     | 2 +-
 23 files changed, 23 insertions(+), 23 deletions(-)

commit df5be460bf1bf4f04c5572452aafd879cd1213f6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Oct 4 10:17:34 2017 -0700

    Fix testActiveAndInActiveConsumerEntryCacheBehavior (#810)

 .../pulsar/client/api/SimpleProducerConsumerTest.java     | 15 +++++++++++++--
 1 file changed, 13 insertions(+), 2 deletions(-)

commit 44082046b90351f1fcbbf111a730994bf847e0e9
Author: Yuki Shiga <y.shiga.91+yush1ga@gmail.com>
Date:   Wed Oct 4 09:50:04 2017 +0900

    Translated docs into Japanese (#780)

 site/_data/codebase-ja.yaml                        |   58 +
 site/_data/messages-ja.yaml                        |   63 +
 site/_data/popovers-ja.yaml                        |  116 ++
 site/_data/sidebar-ja.yaml                         |  106 +-
 site/_data/stats-ja.yaml                           |   69 +
 site/_includes/codebase-ja.html                    |   34 +
 site/_includes/explanations/ja/admin-setup.md      |   32 +
 site/_includes/explanations/ja/broker-admin.md     |  149 ++
 site/_includes/explanations/ja/client-url.md       |   33 +
 site/_includes/explanations/ja/cluster-admin.md    |  184 ++
 site/_includes/explanations/ja/deploying-bk.md     |   37 +
 site/_includes/explanations/ja/deploying-zk.md     |  115 ++
 site/_includes/explanations/ja/install-package.md  |   54 +
 site/_includes/explanations/ja/instance-admin.md   |    1 +
 site/_includes/explanations/ja/namespace-admin.md  |  604 ++++++
 .../explanations/ja/non-persistent-topic-admin.md  |  218 ++
 .../explanations/ja/non-persistent-topics.md       |   58 +
 .../explanations/ja/partitioned-topic-admin.md     |  272 +++
 .../explanations/ja/partitioned-topics.md          |   31 +
 site/_includes/explanations/ja/permissions.md      |  114 ++
 .../explanations/ja/persistent-topic-admin.md      |  544 +++++
 .../explanations/ja/properties-namespaces.md       |   21 +
 site/_includes/explanations/ja/property-admin.md   |   77 +
 .../explanations/ja/service-discovery-setup.md     |   27 +
 site/_includes/message-ja.html                     |   27 +
 site/_includes/sidebar-ja.html                     |   50 +-
 site/_includes/stats-ja.html                       |   37 +
 site/_includes/tags-modal-ja.html                  |   38 +
 site/_layouts/docs-ja.html                         |   25 +-
 site/_layouts/rest-api-ja.html                     |   46 +
 site/_layouts/rest-api.html                        |    6 +-
 site/_plugins/custom_tags_ja.rb                    |   46 +
 site/ja/AdminTools.md                              | 2148 --------------------
 site/ja/Architecture.md                            |  327 ---
 site/ja/Authentication.md                          |  129 --
 site/ja/Authorization.md                           |   58 -
 site/ja/BinaryProtocol.md                          |  507 -----
 site/ja/ClusterSetup.md                            |  347 ----
 site/ja/Documentation.md                           |   16 -
 site/ja/GeoReplication.md                          |  101 -
 site/ja/GettingStarted.md                          |  136 --
 site/ja/PulsarSpark.md                             |   47 -
 site/ja/PulsarStorm.md                             |  109 -
 site/ja/README.md                                  |   42 -
 site/ja/WebSocket.md                               |  265 ---
 site/ja/adaptors/PulsarSpark.md                    |   63 +
 site/ja/adaptors/PulsarStorm.md                    |  103 +
 site/ja/admin/AdminInterface.md                    |  448 ++++
 site/ja/admin/Authz.md                             |  307 +++
 site/ja/admin/ClustersBrokers.md                   |   22 +
 site/ja/admin/Dashboard.md                         |   36 +
 site/ja/admin/GeoReplication.md                    |  119 ++
 site/ja/admin/ModularLoadManager.md                |  186 ++
 site/ja/admin/PropertiesNamespaces.md              |   23 +
 site/ja/admin/Stats.md                             |   11 +
 site/ja/admin/ZooKeeperBookKeeper.md               |  157 ++
 site/ja/advanced/PartitionedTopics.md              |   88 +
 site/ja/advanced/RetentionExpiry.md                |  286 +++
 site/ja/clients/Cpp.md                             |  159 ++
 site/ja/clients/Java.md                            |  254 +++
 site/ja/clients/Python.md                          |  100 +
 site/ja/clients/WebSocket.md                       |  278 +++
 site/ja/deployment/InstanceSetup.md                |  167 ++
 site/ja/deployment/Kubernetes.md                   |  275 +++
 site/ja/deployment/Monitoring.md                   |   83 +
 site/ja/getting-started/Clients.md                 |   34 +
 site/ja/getting-started/ConceptsAndArchitecture.md |  286 +++
 site/ja/getting-started/LocalCluster.md            |   96 +
 site/ja/index.md                                   |    5 -
 site/ja/project/BinaryProtocol.md                  |  459 +++++
 site/ja/project/Codebase.md                        |    8 +
 site/ja/project/SimulationTools.md                 |   74 +
 site/ja/reference/CliTools.md                      |   41 +
 site/ja/reference/Configuration.md                 |   75 +
 site/ja/reference/RestApi.md                       |    8 +
 75 files changed, 7498 insertions(+), 4277 deletions(-)

commit d0923891eea93875a8828139ef1535102684a574
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 3 16:56:44 2017 -0700

    Fix BrokerServiceThrottlingTest using thread-safe list and closing executor (#809)

 .../pulsar/broker/service/BrokerServiceThrottlingTest.java       | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 03c4ce2d16daa4a6f1970d2df33c29af6b209395
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Oct 3 11:24:21 2017 -0700

    Fix test: shutdown executor and intermittent test failure (#804)

 .../test/java/org/apache/pulsar/client/api/NonPersistentTopicTest.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit a366a2dec3fa3adf46de71b1324a21be7950bbda
Author: Andrey Falko <afalko@users.noreply.github.com>
Date:   Tue Oct 3 10:18:07 2017 -0700

    Allow publish to private registry (#805)

 docker/publish.sh | 35 ++++++++++++++++++++++-------------
 1 file changed, 22 insertions(+), 13 deletions(-)

commit f79fcd3dca62426ae563705628295091a9722f79
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Sun Oct 1 07:58:20 2017 -0700

    Added Crypto notice to src distribution README (#800)

 README.md | 9 +++++++++
 1 file changed, 9 insertions(+)

commit e1ffafc538cb93db8892be3319a101d4736c1cae
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Sep 30 02:01:17 2017 -0400

    Documentation for Kafka/Pulsar client wrapper (#795)

 site/_data/sidebar.yaml                   |   2 +
 site/docs/latest/adaptors/KafkaWrapper.md | 218 ++++++++++++++++++++++++++++++
 2 files changed, 220 insertions(+)

commit af1bedc009ec78dcfd93159f5198c6e11a4490a7
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Fri Sep 29 22:51:11 2017 -0700

    Added Crypto notice into README (#799)

 all/src/assemble/README.bin.txt | 6 ++++++
 1 file changed, 6 insertions(+)

commit fe28023d01fd43e3512b05b684e18cd16b211b51
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Fri Sep 29 23:17:28 2017 +0900

    Fix ProxyPublishConsumeTlsTest (#496)

 .../broker/auth/MockedPulsarServiceBaseTest.java   |  5 +-
 .../pulsar/client/api/TlsProducerConsumerBase.java | 88 ++++++++++++++++++++++
 .../pulsar/client/api/TlsProducerConsumerTest.java | 73 ++----------------
 ...umeTls.java => ProxyPublishConsumeTlsTest.java} | 39 ++++------
 4 files changed, 114 insertions(+), 91 deletions(-)

commit 6010db0e56228fa84a241387388933280ff59de8
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Thu Sep 28 11:35:25 2017 -0700

    Added encryption key metadata to send additional information about th (#798)
    
    * Added encryption key metadata to send additional information about the key
    
    * Use KeyValue type for encryption key metadata

 .../client/api/SimpleProducerConsumerTest.java     |  42 +--
 .../apache/pulsar/client/api/CryptoKeyReader.java  |  15 +-
 .../pulsar/client/api/EncryptionKeyInfo.java       |  57 ++++
 .../pulsar/client/api/ProducerConfiguration.java   |   6 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   3 +-
 .../apache/pulsar/client/impl/MessageCrypto.java   | 122 ++++++---
 .../apache/pulsar/client/impl/ProducerImpl.java    |   5 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 305 ++++++++++++++++-----
 pulsar-common/src/main/proto/PulsarApi.proto       |   7 +-
 .../pulsar/testclient/PerformanceConsumer.java     |  14 +-
 .../pulsar/testclient/PerformanceProducer.java     |  14 +-
 11 files changed, 435 insertions(+), 155 deletions(-)

commit 350e67abacda3fcd5cd3e1b057f1433b3012e4ff
Author: rstout610 <32314766+rstout610@users.noreply.github.com>
Date:   Tue Sep 26 21:36:17 2017 -0700

    Fix typo in bookkeeper.yaml (#796)
    
    bokkeeper -> bookkeeper

 site/_data/config/bookkeeper.yaml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit c359905f36fc20c6ba084ade8626c8e1f7e3bcb3
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 26 15:24:10 2017 -0700

    Add persistent-policies validation and dynamic policy update on managed-ledger/cursor (#781)
    
    * Add persistent-policies validation and dynamic policy update on managed-ledger/cursor
    
    * addressed comments: handle/setting markDelete

 .../apache/bookkeeper/mledger/ManagedCursor.java   |  14 +
 .../apache/bookkeeper/mledger/ManagedLedger.java   |  12 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  21 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  11 +-
 .../mledger/impl/ManagedCursorContainerTest.java   |   9 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  33 ++
 .../org/apache/pulsar/broker/admin/Namespaces.java |  26 +-
 .../pulsar/broker/service/BrokerService.java       |   2 +-
 .../broker/service/persistent/PersistentTopic.java |  18 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 166 +---------
 .../apache/pulsar/broker/admin/AdminApiTest2.java  | 348 +++++++++++++++++++++
 11 files changed, 503 insertions(+), 157 deletions(-)

commit a98e818bfa82ea3e2d5e5829a3f93f31f7a40e97
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 26 06:13:13 2017 -0700

    fix intermittent testBlockBrokerDispatching consume msg async (#787)

 .../client/api/DispatcherBlockConsumerTest.java    | 33 +++++++++++++---------
 1 file changed, 19 insertions(+), 14 deletions(-)

commit c5d4f902a39644a990fcf82dae594437ad63bd77
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Tue Sep 26 22:12:55 2017 +0900

    Fixed some documents (#794)

 site/_includes/explanations/install-package.md         | 6 +++---
 site/_includes/explanations/service-discovery-setup.md | 2 +-
 site/docs/latest/deployment/Kubernetes.md              | 2 +-
 site/docs/latest/deployment/Monitoring.md              | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

commit fea1b3357df19e6f396bf865f6f9befe7d559f4e
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 26 01:14:01 2017 -0400

    Correctly process the ack for a message that was outstanding on a different consumer (#791)
    
    Fixes #759

 .../org/apache/pulsar/broker/service/Consumer.java | 21 ++++----
 .../PersistentDispatcherMultipleConsumers.java     | 27 +++++-----
 .../broker/service/PersistentQueueE2ETest.java     | 61 ++++++++++++++++++++++
 3 files changed, 86 insertions(+), 23 deletions(-)

commit bace0b47ada0d107f33d26ac282e1d6fb0a43156
Author: massakam <massakam@yahoo-corp.jp>
Date:   Tue Sep 26 09:55:38 2017 +0900

    Fix memory leak in WebSocket proxy (#790)

 .../pulsar/websocket/AbstractWebSocketHandler.java |  2 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |  9 ++++++--
 .../apache/pulsar/websocket/ProducerHandler.java   |  9 ++++++--
 .../org/apache/pulsar/websocket/ReaderHandler.java |  9 ++++++--
 .../apache/pulsar/websocket/WebSocketService.java  | 24 +++++++++++-----------
 5 files changed, 34 insertions(+), 19 deletions(-)

commit 5f378f65d3f2ca754eece6e0358d5885fe7b3be3
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Mon Sep 25 23:46:40 2017 +0900

    Fixed Java client documents related to Athenz (#789)

 site/docs/latest/clients/Java.md | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit 25c8107bbdd2e74d11c32079af5f690761ed2561
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sun Sep 24 10:57:07 2017 -0700

    Add admin-api to unload a specific topic (#782)

 .../pulsar/broker/admin/NonPersistentTopics.java   | 14 +++++
 .../pulsar/broker/admin/PersistentTopics.java      | 32 +++++++++++
 .../service/nonpersistent/NonPersistentTopic.java  |  1 +
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 64 ++++++++++++++++++++++
 .../pulsar/client/admin/NonPersistentTopics.java   | 27 +++++++++
 .../pulsar/client/admin/PersistentTopics.java      | 27 +++++++++
 .../admin/internal/NonPersistentTopicsImpl.java    | 31 +++++++++--
 .../admin/internal/PersistentTopicsImpl.java       | 19 +++++++
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 13 +++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  3 +
 site/_data/cli/pulsar-admin.yaml                   | 18 ++++++
 .../docs/latest/admin-api/non-persistent-topics.md | 28 +++++++++-
 site/docs/latest/admin-api/persistent-topics.md    | 52 ++++++++++++++++++
 13 files changed, 322 insertions(+), 7 deletions(-)

commit 7daee93da28297897f2ea88d7281cff2133f01d7
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Thu Sep 21 17:13:55 2017 -0700

    Added Bouncy Castle Licence files (#783)

 all/licenses/LICENSE-bouncycastle.txt | 19 +++++++++++++++++++
 all/src/assemble/LICENSE.bin.txt      |  3 +++
 2 files changed, 22 insertions(+)

commit 577b8976aa3a44616e7ce2b86ae463cc3372a46b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 21 13:14:11 2017 -0700

    Ensure producer/consumer are creating before upgrading from HTTP to WebSocket (#779)
    
    * Ensure producer/consumer are creating before upgrading from HTTP to WebSocket
    
    * Addressed PR comments

 .../websocket/proxy/ProxyPublishConsumeTls.java    | 15 +++---
 .../pulsar/websocket/AbstractWebSocketHandler.java | 55 +++++++++++++---------
 .../apache/pulsar/websocket/ConsumerHandler.java   | 27 ++++++-----
 .../apache/pulsar/websocket/ProducerHandler.java   | 41 +++++++++-------
 .../org/apache/pulsar/websocket/ReaderHandler.java | 46 +++++++++---------
 .../pulsar/websocket/WebSocketConsumerServlet.java |  3 +-
 .../pulsar/websocket/WebSocketProducerServlet.java |  2 +-
 .../pulsar/websocket/WebSocketReaderServlet.java   |  3 +-
 8 files changed, 105 insertions(+), 87 deletions(-)

commit 696c4a9d160d3816969b90cc77d35bdc380fbf43
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 20 21:15:40 2017 -0700

    Fixed the jar name for the aspectjweaver (#775)
    
    * Fixed the jar name for the aspectjweaver
    
    * Use runtime loader

 bin/pulsar                                                         | 7 -------
 pulsar-zookeeper/pom.xml                                           | 5 +++++
 .../main/java/org/apache/pulsar/zookeeper/ZooKeeperStarter.java    | 6 ++++++
 3 files changed, 11 insertions(+), 7 deletions(-)

commit 79a7790f90c4e1f8a4c51a51e4b7fc600992e43f
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 20 19:50:29 2017 -0700

    Fix ClientDeduplicationTest intermittent failure with parallel tests (#777)
    
    * Fix ClientDeduplicationTest intermittent failure with parallel tests
    
    Fix #776
    
    * Fixed url for creating namespace

 pulsar-client-cpp/tests/ClientDeduplicationTest.cc | 25 ++++++++++++++--------
 1 file changed, 16 insertions(+), 9 deletions(-)

commit c8487ef4d4ccec7c7c596cc28fff4cbd4ae267bc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 20 19:05:59 2017 -0700

    Close topics after creating all subscriptions on increment-partitions (#778)

 .../pulsar/broker/admin/PersistentTopics.java      | 37 ++++++++++++++--------
 1 file changed, 24 insertions(+), 13 deletions(-)

commit 8bf8eb1ad6ef970d50b1bbb9cda5ac37372c5246
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 20 17:23:54 2017 -0700

    Refactored replicator test with backlog quota interactions (#773)

 .../apache/pulsar/broker/service/PulsarStats.java  | 11 +++--
 .../pulsar/broker/service/ReplicatorTest.java      | 50 +++++++++++-----------
 2 files changed, 33 insertions(+), 28 deletions(-)

commit b96c50d010f378e087e07c57ae6fac25878433bf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 20 17:05:28 2017 -0700

    Fix Intermittent test for dispatcher (#774)

 .../client/api/DispatcherBlockConsumerTest.java    | 181 +++++++++------------
 1 file changed, 75 insertions(+), 106 deletions(-)

commit 94b1fb9a36c8dc8f2fac9ec1dd9c7bc6fcc31d6c
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 20 14:49:09 2017 -0700

    Fix Intermittent test failure for MessageDispatchThrottlingTest (#771)

 .../client/api/MessageDispatchThrottlingTest.java  | 52 +++++++++++++---------
 1 file changed, 32 insertions(+), 20 deletions(-)

commit b53a5dc8bb1ea2f5ea66a20688b67e4456e1b171
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 20 11:40:08 2017 -0700

    Fixed race condition in ProxyPublishConsumeTest (#770)

 .../websocket/proxy/ProxyPublishConsumeTest.java   | 22 +++++++++++++++-------
 .../websocket/proxy/ProxyPublishConsumeTls.java    | 13 ++++++-------
 2 files changed, 21 insertions(+), 14 deletions(-)

commit 1e73b3176210e34b1ad522b7cf76fa23c655c712
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 19 17:51:48 2017 -0700

    Don't reuse JVM forks when running tests (#769)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 549d1bf7dbc4f12f8126de1845ee545e45c5fc3b
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Wed Sep 20 08:28:26 2017 +0900

    Fix some documents (#767)

 site/_data/cli/pulsar-perf.yaml                        | 2 +-
 site/_includes/explanations/client-url.md              | 2 +-
 site/_includes/explanations/partitioned-topic-admin.md | 6 +++---
 site/docs/latest/adaptors/PulsarSpark.md               | 2 +-
 site/docs/latest/admin-api/brokers.md                  | 2 +-
 site/docs/latest/admin-api/clusters.md                 | 6 ++----
 site/docs/latest/admin/Authz.md                        | 4 ++--
 site/docs/latest/admin/ModularLoadManager.md           | 4 ++--
 site/docs/latest/admin/ZooKeeperBookKeeper.md          | 2 +-
 site/docs/latest/advanced/RetentionExpiry.md           | 2 +-
 site/docs/latest/clients/Java.md                       | 2 +-
 site/docs/latest/clients/WebSocket.md                  | 6 ++----
 site/docs/latest/deployment/Kubernetes.md              | 6 +++---
 site/docs/latest/deployment/Monitoring.md              | 2 --
 site/docs/latest/project/BinaryProtocol.md             | 4 ++--
 site/docs/latest/project/SimulationTools.md            | 2 +-
 site/docs/latest/reference/CliTools.md                 | 2 +-
 site/docs/latest/reference/Configuration.md            | 2 +-
 18 files changed, 26 insertions(+), 32 deletions(-)

commit fbdec4569ae4c556d659b43cef240fd08ccfd2a6
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 19 12:33:27 2017 -0700

    [#766] - Disabling IOUtilsTest.test5() for failures (#768)

 .../test/java/org/apache/pulsar/admin/cli/utils/IOUtilsTest.java  | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

commit 272f2901837ebd12654f364ef5dbb1e1ebb91ab9
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Sep 18 16:30:04 2017 -0700

    CPP Client: Added client version to User Agent in HTTP Lookup (#765)

 pulsar-client-cpp/lib/HTTPLookupService.cc | 5 ++++-
 pulsar-client-cpp/lib/HTTPLookupService.h  | 1 +
 2 files changed, 5 insertions(+), 1 deletion(-)

commit 824922a50462a7cbf7f9f0c546287523a5e5152c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Sep 18 15:48:14 2017 -0700

    Cpp producer sequence id changes (#763)

 pulsar-client-cpp/include/pulsar/MessageBuilder.h  |  18 +++
 pulsar-client-cpp/include/pulsar/Producer.h        |  18 +++
 .../include/pulsar/ProducerConfiguration.h         |   6 +
 pulsar-client-cpp/lib/ClientConnection.cc          |   9 +-
 pulsar-client-cpp/lib/ClientConnection.h           |   6 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   2 +-
 pulsar-client-cpp/lib/MessageBuilder.cc            |   9 ++
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  13 ++
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |   4 +
 pulsar-client-cpp/lib/Producer.cc                  |   8 ++
 pulsar-client-cpp/lib/ProducerConfiguration.cc     |  19 +++
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |   4 +
 pulsar-client-cpp/lib/ProducerImpl.cc              |  36 +++++-
 pulsar-client-cpp/lib/ProducerImpl.h               |  10 +-
 pulsar-client-cpp/lib/ProducerImplBase.h           |   4 +
 pulsar-client-cpp/python/pulsar.py                 |  59 ++++++++-
 pulsar-client-cpp/python/pulsar_test.py            |  92 +++++++++++++
 pulsar-client-cpp/python/src/config.cc             |   4 +
 pulsar-client-cpp/python/src/message.cc            |   1 +
 pulsar-client-cpp/python/src/producer.cc           |   4 +
 pulsar-client-cpp/tests/ClientDeduplicationTest.cc | 142 +++++++++++++++++++++
 pulsar-client-cpp/tests/HttpHelper.cc              |  12 +-
 pulsar-client-cpp/tests/HttpHelper.h               |   1 +
 23 files changed, 463 insertions(+), 18 deletions(-)

commit 1f7712c5125265acfee148d16b34a03788f86bcb
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Sep 18 15:47:40 2017 -0700

    Use `advertisedAddress` from host IP in Kubernetes deployment (#764)

 conf/bookkeeper.conf                              | 5 +++++
 kubernetes/generic/bookie.yaml                    | 6 ++++++
 kubernetes/generic/broker.yaml                    | 1 +
 kubernetes/generic/zookeeper.yaml                 | 1 +
 kubernetes/google-container-engine/bookie.yaml    | 6 ++++++
 kubernetes/google-container-engine/broker.yaml    | 1 +
 kubernetes/google-container-engine/zookeeper.yaml | 1 +
 7 files changed, 21 insertions(+)

commit e7f1160f563e433f1bb2ec70da827c7d420c23d2
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Sep 16 19:25:59 2017 -0700

    Kafka client Java API wrapper (#761)

 pom.xml                                            |   1 +
 pulsar-client-kafka-compat/pom.xml                 |  43 ++
 .../pulsar-client-kafka-tests/pom.xml              |  70 +++
 .../kafka/compat/examples/ConsumerExample.java     |  58 +++
 .../kafka/compat/examples/ProducerExample.java     |  52 +++
 .../client/kafka/compat/tests/KafkaApiTest.java    | 106 +++++
 .../pulsar-client-kafka/pom.xml                    | 124 ++++++
 .../clients/consumer/PulsarKafkaConsumer.java      | 476 +++++++++++++++++++++
 .../clients/producer/PulsarKafkaProducer.java      | 261 +++++++++++
 .../pulsar/client/kafka/compat/MessageIdUtils.java |  44 ++
 .../client/kafka/compat/PulsarKafkaConfig.java     |  57 +++
 .../kafka/compat/tests/KafkaConsumerTest.java      | 235 ++++++++++
 .../kafka/compat/tests/KafkaProducerTest.java      |  78 ++++
 .../apache/pulsar/client/impl/ConsumerBase.java    |  15 +-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |   6 +
 .../apache/pulsar/client/impl/MessageIdImpl.java   |   2 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   2 +-
 .../apache/pulsar/client/util/ConsumerName.java    |  29 ++
 .../pulsar/common/naming/DestinationName.java      |  22 +-
 19 files changed, 1672 insertions(+), 9 deletions(-)

commit b5bdd7967def45313616e4e364878154b185bdd2
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Fri Sep 15 22:31:36 2017 -0700

    End to End Encryption Support - Java client (#731)
    
    * End to End Encryption Support - Java client
    
    * End to End Encryption Support - Java client

 pom.xml                                            |   6 +
 .../client/api/SimpleProducerConsumerTest.java     | 275 ++++++++
 .../certificate/private-key.client-ecdsa.pem       |  13 +
 .../private-key.client-mismatch-rsa.pem            |  29 +
 .../certificate/private-key.client-rsa.pem         |  27 +
 .../certificate/public-key.client-ecdsa.pem        |   7 +
 .../certificate/public-key.client-mismatch-rsa.pem |   9 +
 .../certificate/public-key.client-rsa.pem          |   9 +
 pulsar-client/pom.xml                              |   5 +
 .../pulsar/client/api/ConsumerConfiguration.java   |  38 ++
 .../client/api/ConsumerCryptoFailureAction.java    |  29 +
 .../apache/pulsar/client/api/CryptoKeyReader.java  |  44 ++
 .../pulsar/client/api/ProducerConfiguration.java   |  76 +++
 .../client/api/ProducerCryptoFailureAction.java    |  25 +
 .../pulsar/client/api/PulsarClientException.java   |   6 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 181 +++--
 .../apache/pulsar/client/impl/MessageCrypto.java   | 564 ++++++++++++++++
 .../client/impl/PartitionedConsumerImpl.java       |   4 +
 .../apache/pulsar/client/impl/ProducerImpl.java    |  71 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 749 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  16 +-
 .../pulsar/testclient/PerformanceConsumer.java     |  38 ++
 .../pulsar/testclient/PerformanceProducer.java     |  39 ++
 23 files changed, 2193 insertions(+), 67 deletions(-)

commit fed5ae3fed6e5d9758352bfd0299418c30abb896
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Sep 15 16:52:16 2017 -0700

    Add option to persist unack-msg range to cursor-ledger if range is high (#758)
    
    * Add option to persist unack-msg range to cursor-ledger if range is high
    
    * Increase managedLedgerMaxUnackedRangesToPersist=10K

 conf/broker.conf                                   |   6 +-
 conf/standalone.conf                               |  13 ++
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |  15 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  83 +++++++----
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 156 +++++++++++++++++++++
 .../apache/pulsar/broker/ServiceConfiguration.java |  15 +-
 .../pulsar/broker/service/BrokerService.java       |   1 +
 7 files changed, 262 insertions(+), 27 deletions(-)

commit d4a8c25bc00bc1d61e1a1f5b4ee34566cdacfe3d
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Sep 15 14:13:59 2017 -0700

    Expose control of sequence id in Java producer API (#760)

 .../pulsar/broker/service/AbstractReplicator.java  |  59 ++++----
 .../pulsar/broker/service/BrokerService.java       |   1 -
 .../org/apache/pulsar/broker/service/Producer.java |  13 ++
 .../apache/pulsar/broker/service/ServerCnx.java    |   3 +-
 .../nonpersistent/NonPersistentReplicator.java     |   3 -
 .../service/persistent/MessageDeduplication.java   |   5 +
 .../service/persistent/PersistentReplicator.java   |   7 +-
 .../broker/service/persistent/PersistentTopic.java |   4 +
 .../pulsar/broker/service/PersistentTopicTest.java |  11 +-
 .../pulsar/broker/service/ReplicatorTest.java      |   7 +-
 .../pulsar/client/api/ClientDeduplicationTest.java | 160 +++++++++++++++++++++
 .../client/impl/BrokerClientIntegrationTest.java   |  22 +--
 .../apache/pulsar/client/api/MessageBuilder.java   |  18 +++
 .../org/apache/pulsar/client/api/Producer.java     |  34 +++--
 .../pulsar/client/api/ProducerConfiguration.java   |  65 +++++++--
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  19 +--
 .../pulsar/client/impl/MessageBuilderImpl.java     |   9 ++
 .../client/impl/PartitionedProducerImpl.java       |  16 ++-
 .../apache/pulsar/client/impl/ProducerImpl.java    |  46 ++++--
 .../pulsar/client/impl/PulsarClientImpl.java       |   9 +-
 .../org/apache/pulsar/common/api/Commands.java     |   5 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  |  81 +++++++++--
 .../util/protobuf/ByteBufCodedOutputStream.java    |  14 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |   4 +
 24 files changed, 499 insertions(+), 116 deletions(-)

commit dd635acff4bd73e3e1858952e5773dfbe711f349
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Sep 15 11:51:28 2017 -0700

    Admin Tool: Adding support to peek batch Messages (#727)

 .../pulsar/broker/admin/PersistentTopics.java      |   3 +
 .../admin/internal/PersistentTopicsImpl.java       | 117 ++++++++++++++-------
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  10 +-
 .../org/apache/pulsar/client/impl/MessageImpl.java |  11 +-
 4 files changed, 96 insertions(+), 45 deletions(-)

commit 8f15858180ab58ce4c529b6cb30973e2a0bb8635
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Sep 14 13:04:33 2017 -0700

    Issue #735: Event Time support in c++ client (#736)

 pulsar-client-cpp/include/pulsar/Message.h        |  5 +++++
 pulsar-client-cpp/include/pulsar/MessageBuilder.h |  5 +++++
 pulsar-client-cpp/lib/Message.cc                  |  4 ++++
 pulsar-client-cpp/lib/MessageBuilder.cc           |  6 ++++++
 pulsar-client-cpp/lib/MessageImpl.cc              | 12 ++++++++++++
 pulsar-client-cpp/lib/MessageImpl.h               |  2 ++
 pulsar-client-cpp/python/src/message.cc           |  2 ++
 7 files changed, 36 insertions(+)

commit 2a0468325720be0c1cfb98c7f68fb72a449579af
Author: Yuta Takaba <yutakaba@gmail.com>
Date:   Fri Sep 15 05:03:52 2017 +0900

    Parse authParamsString on plugin side (#671) (#721)

 .../apache/pulsar/client/api/Authentication.java   |  2 +
 .../pulsar/client/api/AuthenticationFactory.java   | 57 ++++++++++-----
 .../api/EncodedAuthenticationParameterSupport.java | 30 ++++++++
 .../pulsar/client/api/AuthenticationTest.java      | 85 ++++++++++++++++++++++
 .../client/impl/auth/MockAuthentication.java       | 56 ++++++++++++++
 .../MockEncodedAuthenticationParameterSupport.java | 68 +++++++++++++++++
 6 files changed, 278 insertions(+), 20 deletions(-)

commit 540b9bca7670116b614554cd1ca82ebe21a4e920
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 13 16:44:40 2017 -0700

    Execute Python client lib unit tests during build (#722)

 pulsar-client-cpp/run-unit-tests.sh | 7 +++++++
 1 file changed, 7 insertions(+)

commit 0acfe574e101d50faf87447296945d52e4672319
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Sep 13 15:30:00 2017 -0700

    Pulsar Clients: Added a mandatory stop to the Backoff logic (#747)

 .../pulsar/broker/service/AbstractReplicator.java  |   2 +-
 .../PersistentDispatcherMultipleConsumers.java     |   2 +-
 .../PersistentDispatcherSingleActiveConsumer.java  |   2 +-
 .../service/persistent/PersistentReplicator.java   |   2 +-
 pulsar-client-cpp/.gitignore                       |   1 +
 pulsar-client-cpp/lib/Backoff.cc                   |  28 ++++-
 pulsar-client-cpp/lib/Backoff.h                    |  14 ++-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   3 +-
 pulsar-client-cpp/lib/HandlerBase.cc               |   4 +-
 pulsar-client-cpp/lib/HandlerBase.h                |   2 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              |  11 +-
 pulsar-client-cpp/tests/BackoffTest.cc             | 127 ++++++++++++++++++--
 pulsar-client-cpp/tests/PulsarFriend.h             |   4 +
 .../org/apache/pulsar/client/impl/Backoff.java     |  36 +++++-
 .../apache/pulsar/client/impl/ConsumerBase.java    |   2 +-
 .../org/apache/pulsar/client/impl/HandlerBase.java |   4 +-
 .../apache/pulsar/client/impl/ProducerBase.java    |   3 +-
 .../org/apache/pulsar/client/impl/BackoffTest.java | 128 ++++++++++++++++++++-
 18 files changed, 333 insertions(+), 42 deletions(-)

commit a8abd9877f4e289688ee9f9d6e5c24be3246b926
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 13 15:29:02 2017 -0700

    Updated bookkeper version to 4.3.1.72 (#757)
    
    BK changes:
     * Issue #372: Allow to configure advertised address in bookies
     * Fix DoubleByteBuf readableBytes()

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5cf010e8d410498e67175dbc4169cc98aafed8db
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 13 15:28:05 2017 -0700

    Added Python wrapper for C++ reader API (#718)

 pulsar-client-cpp/python/CMakeLists.txt |   3 +-
 pulsar-client-cpp/python/pulsar.py      | 124 ++++++++++++++++++++++++++++++++
 pulsar-client-cpp/python/pulsar_test.py | 118 ++++++++++++++++++++++++++++--
 pulsar-client-cpp/python/src/client.cc  |  15 ++++
 pulsar-client-cpp/python/src/config.cc  |  31 +++++---
 pulsar-client-cpp/python/src/message.cc |  25 +++++--
 pulsar-client-cpp/python/src/pulsar.cc  |   2 +
 pulsar-client-cpp/python/src/reader.cc  |  78 ++++++++++++++++++++
 8 files changed, 378 insertions(+), 18 deletions(-)

commit c19a1cea7f42cfbe664ea0ccf7779c02f12f697f
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Sep 13 13:04:09 2017 -0700

    Consider cluster-throttling config when namespace-policy throttling is disabled (#748)

 .../pulsar/broker/service/BrokerService.java       | 19 ++----
 .../service/persistent/DispatchRateLimiter.java    | 24 ++++++-
 .../client/api/MessageDispatchThrottlingTest.java  | 74 ++++++++++++++++++++++
 .../stats/client/PulsarBrokerStatsClientTest.java  |  8 +--
 4 files changed, 105 insertions(+), 20 deletions(-)

commit 6e3ba016dab33f404794d31db7a84dd948d81d8d
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 12 17:49:29 2017 -0700

    Avoid storing ack-msg range while switching-ledger (#756)

 .../org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java  | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit bdbb121e7a21ac17f404c7f3caf0e3845aba6ee3
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 12 17:02:32 2017 -0700

    Broker side deduplication (#751)

 conf/broker.conf                                   |  23 +-
 conf/standalone.conf                               |  50 ++-
 .../apache/pulsar/broker/ServiceConfiguration.java |  59 ++-
 .../org/apache/pulsar/broker/admin/Namespaces.java |  43 +++
 .../pulsar/broker/service/BrokerService.java       |  86 +++--
 .../org/apache/pulsar/broker/service/Producer.java |  54 ++-
 .../org/apache/pulsar/broker/service/Topic.java    |  39 +-
 .../service/nonpersistent/NonPersistentTopic.java  |   7 +-
 .../service/persistent/MessageDeduplication.java   | 421 +++++++++++++++++++++
 .../broker/service/persistent/PersistentTopic.java |  53 ++-
 .../pulsar/broker/service/BrokerServiceTest.java   |   8 +-
 .../org/apache/pulsar/client/admin/Namespaces.java |  35 +-
 .../client/admin/internal/NamespacesImpl.java      |  13 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  26 +-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  28 +-
 .../common/policies/data/PersistentTopicStats.java |   3 +
 .../pulsar/common/policies/data/Policies.java      |  41 +-
 17 files changed, 860 insertions(+), 129 deletions(-)

commit 817898ede1d59e658f14f28115d50ffce9569711
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 12 12:09:18 2017 -0700

    Add configuration to enable throttling for non-backlog consumers (#754)

 conf/broker.conf                                   |  4 ++
 conf/standalone.conf                               |  4 ++
 .../apache/pulsar/broker/ServiceConfiguration.java | 12 ++++
 .../PersistentDispatcherMultipleConsumers.java     | 18 ++++--
 .../PersistentDispatcherSingleActiveConsumer.java  | 21 ++++---
 .../client/api/MessageDispatchThrottlingTest.java  | 70 ++++++++++++++++++++++
 6 files changed, 115 insertions(+), 14 deletions(-)

commit 3a775cf0538680b6128f8caa666e9733cff38f35
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Sep 12 12:01:45 2017 -0700

    Add msg ack-hole metrics to internal-stats and broker-stats (#750)

 .../apache/bookkeeper/mledger/ManagedCursor.java   | 14 ++++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  6 ++
 .../mledger/impl/ManagedCursorContainerTest.java   | 10 +++
 .../service/persistent/PersistentSubscription.java |  8 +++
 .../broker/service/persistent/PersistentTopic.java |  4 ++
 .../stats/client/PulsarBrokerStatsClientTest.java  | 74 +++++++++++++++++++++-
 .../data/PersistentTopicInternalStats.java         |  4 +-
 7 files changed, 116 insertions(+), 4 deletions(-)

commit ee1ba6801525d02dd1f3b79dba60c7757147ff53
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Sep 11 20:53:22 2017 -0700

    Reader API for C++ client (#717)
    
    * Reader API for C++ clienReader API for C++ clientt
    
    * Fixed compile error with listener function
    
    * Fixed compile errors and PR comments
    
    * Fixed conversion between MessageId and BatchMessageId
    
    * Removed usage of std::tie
    
    * Revert change in BatchMessageId since it breaks the tracker
    
    * Increase available permits only once

 pulsar-client-cpp/include/pulsar/BatchMessageId.h  |  32 ++-
 pulsar-client-cpp/include/pulsar/Client.h          |  32 +++
 pulsar-client-cpp/include/pulsar/MessageId.h       |  39 ++-
 pulsar-client-cpp/include/pulsar/Reader.h          |  90 +++++++
 .../include/pulsar/ReaderConfiguration.h           |  89 +++++++
 .../lib/BatchAcknowledgementTracker.cc             |   9 +-
 .../lib/BatchAcknowledgementTracker.h              |   1 +
 pulsar-client-cpp/lib/BatchMessageId.cc            |  83 ++++++
 pulsar-client-cpp/lib/Client.cc                    |  14 ++
 pulsar-client-cpp/lib/ClientImpl.cc                |  52 +++-
 pulsar-client-cpp/lib/ClientImpl.h                 |  16 ++
 pulsar-client-cpp/lib/Commands.cc                  |  16 +-
 pulsar-client-cpp/lib/Commands.h                   |  14 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              | 103 +++++++-
 pulsar-client-cpp/lib/ConsumerImpl.h               |  16 +-
 pulsar-client-cpp/lib/Message.cc                   |   2 +-
 pulsar-client-cpp/lib/MessageId.cc                 |  69 +++++
 pulsar-client-cpp/lib/ProducerImpl.cc              |   4 +-
 pulsar-client-cpp/lib/Reader.cc                    |  76 ++++++
 pulsar-client-cpp/lib/ReaderConfiguration.cc       |  68 +++++
 pulsar-client-cpp/lib/ReaderConfigurationImpl.h    |  38 +++
 pulsar-client-cpp/lib/ReaderImpl.cc                | 111 +++++++++
 pulsar-client-cpp/lib/ReaderImpl.h                 |  71 ++++++
 .../lib/UnAckedMessageTrackerDisabled.h            |   3 +
 .../lib/UnAckedMessageTrackerEnabled.cc            |   5 +
 .../lib/UnAckedMessageTrackerEnabled.h             |   2 +
 .../lib/UnAckedMessageTrackerInterface.h           |   2 +
 pulsar-client-cpp/lib/UnboundedBlockingQueue.h     |  12 +
 pulsar-client-cpp/lib/Utils.h                      |  46 ++++
 pulsar-client-cpp/tests/MessageIdTest.cc           |  36 +++
 pulsar-client-cpp/tests/ReaderTest.cc              | 277 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   4 +-
 32 files changed, 1389 insertions(+), 43 deletions(-)

commit 6d2f7986b34a5820a6c45ec143b28efd815f9dc9
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Sep 8 11:38:27 2017 -0700

    Added links to blog posts (#723)

 site/presentations.md | 3 +++
 1 file changed, 3 insertions(+)

commit 8c0d399bf9fc73dc3bdf084cbb51bead3bad3d4e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 7 20:51:23 2017 -0700

    Add user-defined properties to cursor position (#744)

 .../apache/bookkeeper/mledger/ManagedCursor.java   |   44 +-
 .../bookkeeper/mledger/ManagedLedgerInfo.java      |    1 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  244 ++--
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |    9 +
 .../mledger/impl/NonDurableCursorImpl.java         |    6 +-
 .../bookkeeper/mledger/proto/MLDataFormats.java    | 1296 ++++++++++++++++++--
 managed-ledger/src/main/proto/MLDataFormats.proto  |   14 +
 .../mledger/impl/ManagedCursorContainerTest.java   |   18 +
 .../mledger/impl/ManagedCursorPropertiesTest.java  |  106 ++
 .../broker/service/persistent/PersistentTopic.java |    1 +
 .../data/PersistentTopicInternalStats.java         |    2 +
 11 files changed, 1515 insertions(+), 226 deletions(-)

commit 9c75f8f67e454cc03dae0f8e7248b8428f026f24
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Sep 6 07:28:08 2017 +0200

    Make navbar more mobile friendly (#728)

 site/_includes/explanations/install-package.md |  6 +-
 site/_includes/navbar.html                     | 59 +++++++++++-----
 site/_layouts/default.html                     |  2 +-
 site/_sass/_docs.scss                          | 30 ++++----
 site/_sass/_navbar.scss                        | 21 +++---
 site/_sass/_variables.scss                     |  2 +-
 site/docs/latest/getting-started/docker.md     | 94 +++++++++++++-------------
 site/index.html                                |  2 +-
 8 files changed, 121 insertions(+), 95 deletions(-)

commit f740f34a7bde02704b43a98afa0273fe2627dc33
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Sep 5 18:10:49 2017 -0700

    Position Reader on a specific message within a batch (#720)

 .../mledger/impl/NonDurableCursorImpl.java         |  5 +-
 .../bookkeeper/mledger/impl/PositionImpl.java      |  4 +-
 .../apache/pulsar/broker/service/ServerCnx.java    | 21 ++++----
 .../broker/service/persistent/PersistentTopic.java | 26 +++++++---
 .../client/api/SimpleProducerConsumerTest.java     | 43 ++++++++---------
 .../apache/pulsar/client/api/TopicReaderTest.java  | 50 ++++++++++++++++---
 .../pulsar/client/impl/BatchMessageIdImpl.java     | 12 ++++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 56 +++++++++++++++++-----
 8 files changed, 154 insertions(+), 63 deletions(-)

commit a9cca056ac5951b90f0490552188ef925d1a43fa
Author: Sijie Guo <guosijie@gmail.com>
Date:   Wed Sep 6 05:56:51 2017 +0800

    Include a pre-built protoc in `pulsar-build` docker image (#743)

 build/docker/Dockerfile                   | 13 +++++++++++
 {protobuf => build/docker}/protobuf.patch |  0
 protobuf/README.md                        | 25 +++++++++++++--------
 pulsar-common/generate_protobuf_docker.sh | 37 +++++++++++++++++++++++++++++++
 4 files changed, 66 insertions(+), 9 deletions(-)

commit 5f5015bd47dc28017d6af901e87e3506d1c003b0
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Sep 6 06:31:07 2017 +0900

    Added reader endpoint description to WebSocket.md (#729)
    
    * Added reader endpoint description to WebSocket.md
    
    * Fixed sample code in WebSocket.md
    
    * Use on('message',listener) in node.js sample code

 site/docs/latest/clients/WebSocket.md | 100 +++++++++++++++++++++++++++++++---
 1 file changed, 91 insertions(+), 9 deletions(-)

commit dec05d8fadbe36cabc9ff6099ba536992c4c63fc
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Sep 1 11:56:37 2017 -0700

    Managed-ledger admin update zk with the stat-version (#741)

 bin/pulsar-managed-ledger-admin | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 6ca3373b492c381839b020cb70861463b4dfe6b7
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Fri Sep 1 19:58:52 2017 +0200

    fix code sample (#740)

 site/docs/latest/clients/WebSocket.md | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit 7b9477b211c4f5ffe56dd7273bcd7d53e37ca2bc
Author: Sijie Guo <guosijie@gmail.com>
Date:   Fri Sep 1 07:21:54 2017 -0700

    Update `protobuf/README.md` (#737)
    
    * Update `protobuf/README.md`
    
    *Problem*:
    
    the cpp protobuf files are automatically generated by Cmake.
    we don't need extra instructions for generating cpp files.
    
    *Solution*:
    
    Remove the content about cpp from `protobuf/README.md`
    
    * Update comment - "C++ code is automatically generated by cmake"
    
    * Address comment

 protobuf/README.md | 19 +++----------------
 1 file changed, 3 insertions(+), 16 deletions(-)

commit 070ebc0d23797cd776d0dd14d7df21d43f60cd88
Author: Sijie Guo <guosijie@gmail.com>
Date:   Thu Aug 31 12:51:47 2017 -0700

    Issue 733: Event Time support in java client (#734)
    
    - add `event_time` field in message metadata proto
    - expose `setEventTime` in MessageBuilder
    - expose `getEventTime` in Message
    - add event_time test cases for message & message builder

 .../java/org/apache/pulsar/client/api/Message.java | 17 ++++++
 .../apache/pulsar/client/api/MessageBuilder.java   | 12 +++++
 .../pulsar/client/impl/MessageBuilderImpl.java     |  9 ++++
 .../org/apache/pulsar/client/impl/MessageImpl.java |  9 ++++
 .../pulsar/client/impl/MessageBuilderTest.java     | 62 ++++++++++++++++++++++
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 57 ++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  4 ++
 7 files changed, 170 insertions(+)

commit f8b051a6f732653ef26ee68d239c1ae005e85a4a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 31 10:27:49 2017 -0700

    Handle NPE at load-manager when leader couldn't find available broker (#726)
    
    * Handle NPE at load-manager when leader couldn't find available broker
    
    * avoid throwing exception
    
    * return empty lookup-result if broker not found

 .../loadbalance/impl/SimpleResourceUnit.java       |  8 +++++++
 .../pulsar/broker/lookup/DestinationLookup.java    |  3 ++-
 .../pulsar/broker/namespace/NamespaceService.java  | 26 ++++++++++++++++------
 3 files changed, 29 insertions(+), 8 deletions(-)

commit aa40ebbe02f9b4f60b7f3910c293c50c18f35687
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 31 10:27:25 2017 -0700

    Validate dynamic-configuration value while updating or init (#725)
    
    * Validate dynamic-configuration value while updating or init

 .../org/apache/pulsar/broker/admin/Brokers.java    |   7 +-
 .../pulsar/broker/service/BrokerService.java       | 114 ++++++++++++++++-----
 .../pulsar/broker/service/BrokerServiceTest.java   |  12 +--
 .../client/impl/BrokerClientIntegrationTest.java   |  52 ++++++++++
 4 files changed, 152 insertions(+), 33 deletions(-)

commit aeeeb56d3ca9f228c9a56ac3149ff5ce51d21c0a
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Aug 30 11:13:39 2017 -0700

    CPP Client: Small fixes to make the code work with older libraries - no change in code logic (#724)

 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc | 2 +-
 pulsar-client-cpp/tests/AuthPluginTest.cc      | 1 -
 pulsar-client-cpp/tests/BasicEndToEndTest.cc   | 4 ++--
 3 files changed, 3 insertions(+), 4 deletions(-)

commit df93a426e4c5073552bfc474179ffc408bf08510
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 29 17:35:37 2017 -0700

    add msgAck and redelivery debug-logs And add topic-name in debug-logs (#714)
    
    * Add msgAck and redelivery debug-logs And add topic-name in debug-logs

 .../org/apache/pulsar/broker/service/Consumer.java | 30 ++++++++++----
 .../apache/pulsar/broker/service/ServerCnx.java    |  7 +++-
 .../service/nonpersistent/NonPersistentTopic.java  |  2 +-
 .../PersistentDispatcherMultipleConsumers.java     |  8 ++--
 .../PersistentDispatcherSingleActiveConsumer.java  | 46 +++++++++++++---------
 .../service/persistent/PersistentReplicator.java   |  2 +-
 .../broker/service/persistent/PersistentTopic.java |  2 +-
 .../PersistentDispatcherFailoverConsumerTest.java  | 12 +++---
 .../pulsar/broker/service/PersistentTopicTest.java |  6 +--
 9 files changed, 72 insertions(+), 43 deletions(-)

commit 3751bafdf491d499461b2d71cdc0a99fdf8c2aa9
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 29 10:42:12 2017 -0700

    Remove Managed Ledger metadata text format (#394)
    
    * Remove Managed Ledger metadata text format
    
    * MockZookeeper should store values as byte[] and not convert to String

 .../mledger/ManagedLedgerFactoryConfig.java        |  10 --
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  50 ++--------
 .../mledger/impl/MetaStoreImplZookeeper.java       |  83 ++++------------
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  41 +++++---
 .../impl/ManagedLedgerBinaryFormatConversion.java  | 109 ---------------------
 .../mledger/impl/ManagedLedgerFactoryTest.java     |  32 ++----
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  10 +-
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |  10 --
 .../java/org/apache/zookeeper/MockZooKeeper.java   |  25 ++---
 9 files changed, 72 insertions(+), 298 deletions(-)

commit 1a6ffbfc12812373957d36a23779066505d107de
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 28 18:13:40 2017 -0700

    add namespace site section and fix headers (#719)

 site/_includes/explanations/non-persistent-topics.md        | 12 ++++++------
 site/docs/latest/getting-started/ConceptsAndArchitecture.md | 11 ++++++++++-
 site/docs/latest/getting-started/LocalCluster.md            |  2 +-
 3 files changed, 17 insertions(+), 8 deletions(-)

commit a64d7952418689010a25b8dd77986c12734cbc05
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 25 17:45:39 2017 -0700

    Fix: msg rate acquire permit for msg/bytes (#716)

 .../service/persistent/PersistentDispatcherMultipleConsumers.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 21a618a1304cee3fb8d3b77f51ddb1de95313c51
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Aug 25 10:02:57 2017 +0900

    Support setting private key content in athenz client plugin (#672)
    
    * Support setting private key content in athenz client plugin
    
    * added privateKey field to authParams in athenz client plugin

 .../client/impl/auth/AuthenticationAthenz.java     | 46 ++++++++++++++++++++--
 1 file changed, 43 insertions(+), 3 deletions(-)

commit ccb4d92f25c9046464959cd26a66696e98dc9522
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Aug 23 09:34:21 2017 +0900

    added new entrypoint for reader to websocket proxy (#620)
    
    * added new entrypoint for reader to websocket proxy
    
    * supported non-persistent topic with websocket proxy
    
    * added warn log in ReaderHandler
    
    * call ReadeHandler.receiveMessage() on every readNext()
    
    * receive ack from client in ReaderHandler

 .../org/apache/pulsar/broker/PulsarService.java    |   3 +
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  29 ++-
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   2 +-
 .../pulsar/websocket/AbstractWebSocketHandler.java |   6 +-
 .../apache/pulsar/websocket/ConsumerHandler.java   |   2 +-
 .../org/apache/pulsar/websocket/ReaderHandler.java | 252 +++++++++++++++++++++
 .../pulsar/websocket/WebSocketReaderServlet.java   |  42 ++++
 .../apache/pulsar/websocket/WebSocketService.java  |  19 ++
 .../websocket/admin/WebSocketProxyStats.java       |  33 ++-
 .../websocket/service/WebSocketServiceStarter.java |   2 +
 .../pulsar/websocket/stats/ProxyTopicStat.java     |   8 +
 11 files changed, 383 insertions(+), 15 deletions(-)

commit 3ddc24d8be9871b224cf5ce0ef7070ba2d6f1823
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Aug 22 15:04:11 2017 -0700

    Fix mobile navbar issue (#712)
    
    * hide apache feather on smaller screens
    
    * apply hidden-md-down class to anchor rather than to image

 site/_includes/navbar.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 29c705ffa51ae4c34cc6fb777fb7c649455e2c61
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 22 14:01:21 2017 -0700

    Add missing lib instrunction for pulsar-ml-admin tool (#706)

 bin/pulsar-managed-ledger-admin | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)

commit 54ad9998aa411394eac175e133408c9979c71122
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 22 12:01:21 2017 -0700

    add get bundle api for a given topic-name (#710)
    
    * add get bundle api for a given topic-name
    
    * add cli command to site

 .../org/apache/pulsar/broker/admin/Namespaces.java | 13 ++++-----
 .../pulsar/broker/lookup/DestinationLookup.java    | 31 ++++++++++++++++++++++
 .../apache/pulsar/broker/admin/AdminApiTest.java   | 18 ++++++++++++-
 .../org/apache/pulsar/client/admin/Lookup.java     |  9 +++++++
 .../pulsar/client/admin/internal/LookupImpl.java   | 10 +++++++
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 13 +++++++++
 site/_data/cli/pulsar-admin.yaml                   |  3 +++
 site/docs/latest/admin-api/persistent-topics.md    | 26 ++++++++++++++++++
 8 files changed, 116 insertions(+), 7 deletions(-)

commit bd922bbc45fcfe2bd54b27b5c84fec1e4cae1761
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 22 08:51:37 2017 -0700

    Fix lookup for non-persistent topic based on correct destination-domain (#711)

 .../pulsar/broker/lookup/DestinationLookup.java    | 25 +++++++++++-----------
 .../lookup/http/HttpDestinationLookupv2Test.java   | 13 +++++++----
 2 files changed, 22 insertions(+), 16 deletions(-)

commit db85e87e255022a43ab2031b34605b0c64ebaa47
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 22 08:50:26 2017 -0700

    Succeed when unloading namespace bundles not owned by any broker (#709)

 .../org/apache/pulsar/broker/admin/Namespaces.java |  12 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |  23 ++--
 .../pulsar/broker/namespace/NamespaceService.java  |  40 +++---
 .../pulsar/broker/web/PulsarWebResource.java       |  48 +++++---
 .../apache/pulsar/broker/admin/NamespacesTest.java | 137 ++++++++++-----------
 .../broker/namespace/NamespaceUnloadingTest.java   |  65 ++++++++++
 6 files changed, 209 insertions(+), 116 deletions(-)

commit 45ea0bc45e67751711708ecd7ba8f446ff34c67a
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 21 15:37:53 2017 -0700

    Create global cluster marker for standalone pulsar (#708)

 .../java/org/apache/pulsar/PulsarStandaloneStarter.java    | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

commit bcfba3aa9118b6ced689239c85d42b5b25effcd1
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 18 13:51:20 2017 -0700

    add dispatch rate-limiting for global namespace (#704)

 .../org/apache/pulsar/broker/admin/Namespaces.java | 10 ++-
 .../client/api/MessageDispatchThrottlingTest.java  | 77 ++++++++++++++++++++++
 2 files changed, 85 insertions(+), 2 deletions(-)

commit bcf9f89ead0bd2b382c0fe35d06f6915e5c4fbdf
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 18 13:51:00 2017 -0700

    Fixed misspelled PrometheusMetricsProvider class name in conf file (#705)

 conf/bookkeeper.conf | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 73c417b74254b6a0ff1377c7531d389e63bac9e4
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 17 10:20:28 2017 -0700

    Fix broker links for deployment, client (#701)

 site/docs/latest/clients/Python.md           | 4 ++--
 site/docs/latest/clients/WebSocket.md        | 4 ++--
 site/docs/latest/deployment/InstanceSetup.md | 4 ++--
 3 files changed, 6 insertions(+), 6 deletions(-)

commit 583f7fdfd087fd1a02699b66fbfa1427d936a3aa
Author: Jia Zhai <zhaijia03@gmail.com>
Date:   Thu Aug 17 10:13:34 2017 -0700

    Fix broken links: downloads link in Kubernetes.md and link in kubernetes/README (#703)

 kubernetes/README.md                      | 2 +-
 site/docs/latest/deployment/Kubernetes.md | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit d7e9fbac4d7fd3fbd71eb6bcac3c3d1df92f3dd9
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Aug 16 17:34:32 2017 -0700

    Websocket Client - Making ServiceConfiguration extendable (#700)

 .../src/main/java/org/apache/pulsar/websocket/WebSocketService.java      | 1 +
 1 file changed, 1 insertion(+)

commit 59bb252f1cdc7e087ddae4d1a8451de9124290f2
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 15 16:01:02 2017 -0700

    Add narSystemPackage to avoid maven-warning with nar plugin (#695)

 pulsar-checksum/pom.xml | 2 ++
 1 file changed, 2 insertions(+)

commit ff0b4f518cc04f51fac2c19e92dda7767273afae
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 15 14:34:05 2017 -0700

    Don't attach pulsar-*-{src,bin}.tar.gz to maven artifacts (#616)

 all/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8440e3d2ba6488abc5143e5a94bdf69fb2546543
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 15 14:33:21 2017 -0700

    Interrupt the Python consumer when receiving SIGINT (#675)

 pulsar-client-cpp/python/src/consumer.cc | 23 ++++++++++++++++++++---
 1 file changed, 20 insertions(+), 3 deletions(-)

commit b0bdb25bdd4614daf1a0be6786557d98a214c4e6
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 15 14:32:37 2017 -0700

    Fix broker links due to invalid package (#694)

 site/_includes/explanations/partitioned-topics.md           | 2 +-
 site/docs/latest/admin-api/brokers.md                       | 2 +-
 site/docs/latest/admin/GeoReplication.md                    | 4 ++--
 site/docs/latest/getting-started/Clients.md                 | 2 +-
 site/docs/latest/getting-started/ConceptsAndArchitecture.md | 2 +-
 5 files changed, 6 insertions(+), 6 deletions(-)

commit 8dd6a5ca459cb0d902ce9ddae0fe4d5b1d521c32
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Aug 15 13:12:53 2017 -0700

    remove redundant dependencies from modules (#693)

 pulsar-broker-common/pom.xml                                        | 6 ------
 .../main/java/org/apache/pulsar/broker/ServiceConfiguration.java    | 5 ++---
 pulsar-proxy/pom.xml                                                | 6 ++++++
 pulsar-websocket/pom.xml                                            | 5 -----
 4 files changed, 8 insertions(+), 14 deletions(-)

commit 4ef959e7ddc17d2f2031e32bf7c9a991276a73c7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 14 14:14:49 2017 -0700

    fix list collection import (#688)

 .../pulsar/broker/service/nonpersistent/NonPersistentTopic.java    | 2 +-
 .../apache/pulsar/broker/service/persistent/PersistentTopic.java   | 7 +------
 .../pulsar/discovery/service/web/ZookeeperCacheLoaderTest.java     | 2 +-
 .../main/java/org/apache/pulsar/websocket/WebSocketService.java    | 2 +-
 4 files changed, 4 insertions(+), 9 deletions(-)

commit f03a8b7fdec8ad3c5c726ffde522aa8da4f7adc8
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Aug 14 10:27:39 2017 -0700

    PIP-3 : Introduce message-dispatch rate limiting (#634)
    
    * Introduce message-dispatch rate limiting
    
    read messages based on available-message-rate-permits
    
    add admin command
    
    add message-rate + byte-rate options for dispatch-rate limiting
    
    policies on global-zk + combined msg/byte rate + reset rateLimiter-timeUnit
    
    * address comment

 conf/broker.conf                                   |   8 +
 conf/standalone.conf                               |   8 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  24 +
 .../apache/pulsar/broker/admin/AdminResource.java  |   6 +-
 .../org/apache/pulsar/broker/admin/Namespaces.java |  56 ++
 .../broker/cache/LocalZooKeeperCacheService.java   |   7 +-
 .../pulsar/broker/namespace/NamespaceService.java  |   1 -
 .../pulsar/broker/service/BrokerService.java       |  40 +-
 .../org/apache/pulsar/broker/service/Consumer.java |  45 +-
 .../NonPersistentDispatcherMultipleConsumers.java  |   2 +-
 .../service/persistent/DispatchRateLimiter.java    | 232 ++++++++
 .../PersistentDispatcherMultipleConsumers.java     |  41 +-
 .../PersistentDispatcherSingleActiveConsumer.java  |  47 +-
 .../service/persistent/PersistentSubscription.java |   5 -
 .../broker/service/persistent/PersistentTopic.java |  18 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   6 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   7 +
 .../pulsar/broker/service/PersistentTopicTest.java |   7 +
 .../pulsar/broker/service/ServerCnxTest.java       |   8 +
 .../client/api/MessageDispatchThrottlingTest.java  | 640 +++++++++++++++++++++
 .../org/apache/pulsar/client/admin/Namespaces.java |  24 +-
 .../client/admin/internal/NamespacesImpl.java      |  25 +-
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |  41 ++
 .../pulsar/common/policies/data/DispatchRate.java  |  69 +++
 .../pulsar/common/policies/data/Policies.java      |   4 +
 .../org/apache/pulsar/common/util/RateLimiter.java | 261 +++++++++
 .../apache/pulsar/common/util/RateLimiterTest.java | 165 ++++++
 site/docs/latest/admin-api/namespaces.md           |  56 ++
 28 files changed, 1821 insertions(+), 32 deletions(-)

commit 80ddad614413d806a366ae66daad43bd5df6b849
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 14 10:03:53 2017 -0700

    Refactored usages of deprecated classes (#679)

 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  3 +-
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java  |  1 +
 .../java/org/apache/zookeeper/MockZooKeeper.java   |  4 +-
 .../pulsar/broker/admin/MockServletContext.java    | 60 ++--------------------
 .../pulsar/broker/service/ServerCnxTest.java       |  1 +
 .../stats/BookieClientsStatsGeneratorTest.java     |  7 +--
 .../service/web/DiscoveryServiceWebTest.java       | 11 ++--
 .../websocket/proxy/ProxyPublishConsumeTest.java   |  6 +--
 .../service/web/DiscoveryServiceWebTest.java       | 13 ++---
 .../apache/pulsar/websocket/stats/JvmMetrics.java  |  8 +--
 10 files changed, 31 insertions(+), 83 deletions(-)

commit 89a80f6633abf401ba5f46b57ef24fcead86cc41
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Aug 12 08:11:39 2017 -0700

    Fixed Maven test jars warnings (#678)

 managed-ledger/pom.xml                         | 16 ++++++++++++++++
 pom.xml                                        | 16 ----------------
 pulsar-broker/pom.xml                          | 11 +++++++++++
 pulsar-checksum/src/main/assembly/assembly.xml |  3 +--
 pulsar-zookeeper-utils/pom.xml                 | 16 ++++++++++++++++
 5 files changed, 44 insertions(+), 18 deletions(-)

commit 79f8bf02a6c142325deebfb87e35835f56cecbd0
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Aug 12 08:11:10 2017 -0700

    Removed unnecessary Copyright notices in NOTICE file for bin distribution (#677)

 all/src/assemble/NOTICE.bin.txt | 312 ----------------------------------------
 all/src/assemble/bin.xml        |   2 +-
 2 files changed, 1 insertion(+), 313 deletions(-)

commit c51eaad9745d36d737b30d645fa1db753ae87246
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Aug 11 13:49:44 2017 -0700

    Fix #657: Use exceptions instead of assert() to do runtime parameter validations (#673)

 pulsar-client-cpp/lib/ProducerConfiguration.cc | 8 ++++++--
 pulsar-client-cpp/tests/BatchMessageTest.cc    | 9 +++++++--
 2 files changed, 13 insertions(+), 4 deletions(-)

commit b037a7a6877f8a48cd1390a0b0278909fc35744e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 10 20:21:56 2017 -0700

    remove topicName-dataProvider from testIncrementPartitionsOfTopic test (#676)

 .../src/test/java/org/apache/pulsar/broker/admin/AdminApiTest.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit 71f1347c3eebbb179698bd845b9c7f628f2960d2
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Aug 10 12:50:13 2017 -0700

    Added documentation on how to start the standalone service with Docker (#666)

 site/_data/sidebar.yaml                    |   2 +
 site/docs/latest/getting-started/docker.md | 162 +++++++++++++++++++++++++++++
 2 files changed, 164 insertions(+)

commit 34dc24fff341278da79a8fcbcaf6c137c8549352
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Aug 10 10:50:11 2017 -0700

    Don't run Javadoc and Swagger builds on regular mvn package (#670)

 pom.xml               |  13 ----
 pulsar-broker/pom.xml | 160 ++++++++++++++++++++++++++++++--------------------
 pulsar-client/pom.xml |  17 ------
 pulsar-storm/pom.xml  |  16 -----
 4 files changed, 97 insertions(+), 109 deletions(-)

commit ad3a9009a5a4e7c9fc460c92242ea9d11191d752
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Aug 10 10:08:26 2017 -0700

    Fix Python package version (#668)

 pulsar-client-cpp/python/setup.py | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit fdd709ec803e873c76246ceb56153869dcb157a0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Aug 9 19:21:58 2017 -0700

    centralize policies znode name (#669)

 .../broker/cache/ConfigurationCacheService.java    |  1 +
 .../org/apache/pulsar/broker/PulsarService.java    |  3 +-
 .../apache/pulsar/broker/admin/AdminResource.java  | 11 +++--
 .../org/apache/pulsar/broker/admin/Clusters.java   |  7 +--
 .../org/apache/pulsar/broker/admin/Namespaces.java | 57 +++++++++++-----------
 .../pulsar/broker/admin/PersistentTopics.java      | 19 ++++----
 .../org/apache/pulsar/broker/admin/Properties.java | 19 ++++----
 .../pulsar/broker/service/BacklogQuotaManager.java |  5 +-
 .../pulsar/broker/service/BrokerService.java       |  3 +-
 .../service/nonpersistent/NonPersistentTopic.java  |  3 +-
 .../broker/service/persistent/PersistentTopic.java | 11 +++--
 .../pulsar/broker/web/PulsarWebResource.java       | 10 ++--
 .../org/apache/pulsar/broker/admin/AdminTest.java  |  5 +-
 .../apache/pulsar/broker/admin/NamespacesTest.java |  9 ++--
 .../broker/loadbalance/LoadBalancerTest.java       | 10 +---
 .../lookup/http/HttpDestinationLookupv2Test.java   |  7 ++-
 .../pulsar/broker/service/PersistentTopicTest.java | 17 ++-----
 .../discovery/service/BrokerDiscoveryProvider.java |  3 +-
 .../proxy/server/BrokerDiscoveryProvider.java      |  3 +-
 19 files changed, 99 insertions(+), 104 deletions(-)

commit 12fee6dbe8c2bf515590908746ef78cf68511ba7
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 9 11:45:24 2017 -0700

    Use Docker images from apachepulsar hub org (#665)

 kubernetes/generic/bookie.yaml                     | 6 +++---
 kubernetes/generic/broker.yaml                     | 4 ++--
 kubernetes/generic/monitoring.yaml                 | 4 ++--
 kubernetes/generic/zookeeper.yaml                  | 2 +-
 kubernetes/google-container-engine/bookie.yaml     | 6 +++---
 kubernetes/google-container-engine/broker.yaml     | 4 ++--
 kubernetes/google-container-engine/monitoring.yaml | 4 ++--
 kubernetes/google-container-engine/zookeeper.yaml  | 2 +-
 site/docs/latest/deployment/Monitoring.md          | 2 +-
 9 files changed, 17 insertions(+), 17 deletions(-)

commit b4040c9dbb762cb06beb1f910248cf2145f255af
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 9 11:18:51 2017 -0700

    Fixed broken links to admin-api/overview (#664)

 site/_data/features.yaml                               | 2 +-
 site/_includes/explanations/partitioned-topic-admin.md | 2 +-
 site/_includes/explanations/partitioned-topics.md      | 2 +-
 site/docs/latest/admin-api/partitioned-topics.md       | 2 +-
 site/docs/latest/admin-api/properties.md               | 2 +-
 site/docs/latest/advanced/PartitionedTopics.md         | 2 +-
 site/docs/latest/advanced/RetentionExpiry.md           | 2 +-
 site/docs/latest/clients/Java.md                       | 6 +++---
 site/docs/latest/deployment/InstanceSetup.md           | 2 +-
 site/docs/latest/getting-started/Clients.md            | 2 +-
 10 files changed, 12 insertions(+), 12 deletions(-)

commit c0d9751407c8857fe3f4b0aee8e3e3175cb26608
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 9 10:31:54 2017 -0700

    When publishing website, we should not remove files that were not generated in the last build (#663)

 site/scripts/publish-website.sh | 27 ++++++++++++---------------
 1 file changed, 12 insertions(+), 15 deletions(-)

commit 57314e571c0f0b2d4d7a24b9975387174cddb0c5
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 9 10:31:35 2017 -0700

    Updated download links to Apache mirrors and prepared for multiple versions docs (#660)

 site/_config.local.yml                         |  1 -
 site/_config.yml                               |  5 ++--
 site/_includes/explanations/install-package.md | 19 +++++++-------
 site/_includes/navbar.html                     | 22 ++++++++++++++--
 site/_includes/versions.html                   | 25 ------------------
 site/docs/latest/_config.version.yml           |  1 -
 site/download.md                               | 35 +++++++++++++++-----------
 7 files changed, 52 insertions(+), 56 deletions(-)

commit de24aaf11ce61f8af28bb1dd70c099a8e43d0f08
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Wed Aug 9 15:28:04 2017 +0900

    support tls in performance tool (#662)

 .../pulsar/testclient/PerformanceConsumer.java      | 21 ++++++++++++++++++++-
 .../pulsar/testclient/PerformanceProducer.java      | 19 +++++++++++++++++++
 .../apache/pulsar/testclient/PerformanceReader.java | 21 ++++++++++++++++++++-
 3 files changed, 59 insertions(+), 2 deletions(-)

commit 005aa12dfb76c45284ae5024cf39ee17a8d3f55e
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Wed Aug 9 15:27:48 2017 +0900

    Make athenzConf and athenzPrincipalHeader configurable (#661)

 .../org/apache/pulsar/client/impl/auth/AuthenticationAthenz.java    | 6 ++++++
 1 file changed, 6 insertions(+)

commit b0ee66168408b2a5cbb9e4af2ffff8596c8d57ce
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 8 15:07:52 2017 -0700

    Splitted Admin API reference into multiple pages (#632)

 site/_data/sidebar.yaml                            |  36 +-
 site/_includes/explanations/instance-admin.md      |   1 -
 .../latest/admin-api/brokers.md}                   |   6 +
 .../latest/admin-api/clusters.md}                  |   6 +
 .../latest/admin-api/namespaces.md}                |   9 +-
 .../latest/admin-api/non-persistent-topics.md}     |  15 +-
 site/docs/latest/admin-api/overview.md             |  27 ++
 site/docs/latest/admin-api/partitioned-topics.md   |  13 +
 site/docs/latest/admin-api/permissions.md          |   7 +
 .../latest/admin-api/persistent-topics.md}         |  16 +-
 .../latest/admin-api/properties.md}                |   7 +
 site/docs/latest/admin/AdminInterface.md           | 457 ---------------------
 site/docs/latest/admin/ClustersBrokers.md          |  22 -
 site/docs/latest/admin/PropertiesNamespaces.md     |  23 --
 site/docs/latest/advanced/PartitionedTopics.md     |   4 +-
 15 files changed, 121 insertions(+), 528 deletions(-)

commit ab905fac57eef353459c520523a377a17a8e3577
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 8 13:42:40 2017 -0700

    Use $UID instead of $USER in docker build (#658)

 site/scripts/docker-build.sh | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit f585598e5eb5aca9e85809de56f175e076b80124
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 8 11:01:03 2017 -0700

    Do not delete inactive topics if they have retention policy (#654)

 .../broker/service/persistent/PersistentTopic.java | 116 ++++++++++++++-------
 .../broker/service/PersistentTopicE2ETest.java     |  58 ++++++++++-
 2 files changed, 130 insertions(+), 44 deletions(-)

commit 7c0bd3b87bf23aef462875afe1b57bb0e5c2ff1d
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 8 07:33:26 2017 -0700

    Removed duplicated ASF headers from BookKeeper (#653)

 .../bookkeeper/test/BookKeeperClusterTestCase.java  | 21 ---------------------
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java   | 21 ---------------------
 .../org/apache/pulsar/admin/cli/utils/IOUtils.java  | 21 ---------------------
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java   | 21 ---------------------
 4 files changed, 84 deletions(-)

commit ce1131eab6ce4d6defc465017ad4e0224e2d67d5
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Aug 8 06:52:06 2017 -0700

    clarify time + size limits for retention policy (#656)

 site/docs/latest/advanced/RetentionExpiry.md | 21 ++++-----------------
 1 file changed, 4 insertions(+), 17 deletions(-)

commit d2ab2b599210dff5d2551a3cab875a8d7ef4a3a0
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Aug 8 03:32:12 2017 -0700

    Add link checker and fix broken links (#647)
    
    * add htmltest link checker setup steps and fix a few links
    
    * add license header to new script
    
    * add license header to htmltest YAML config file
    
    * fix Makefile and some broken links

 site/.gitignore                                    |  1 +
 site/.htmltest.yml                                 | 26 ++++++++++++++++++++++
 site/Makefile                                      |  5 ++++-
 site/README.md                                     |  6 ++++-
 site/_includes/sidebar.html                        |  4 ++--
 site/docs/latest/advanced/RetentionExpiry.md       |  4 ++--
 site/docs/latest/clients/Java.md                   |  6 ++---
 .../getting-started/ConceptsAndArchitecture.md     |  2 +-
 site/docs/latest/getting-started/LocalCluster.md   |  2 +-
 site/scripts/htmltest-setup.sh                     | 26 ++++++++++++++++++++++
 10 files changed, 71 insertions(+), 11 deletions(-)

commit 2b63573eea220a8710a93d87f451188e0f253b22
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 7 17:22:37 2017 -0700

    Build website using the current user rather than root (#652)

 site/scripts/docker-build.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 9f64b8cc01a319e95fb1f58dca2aa34594338cd7
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 7 14:27:05 2017 -0700

    Docker image to build website in Jenkins (#628)

 {pulsar-client-cpp => build}/docker/Dockerfile     |   22 +-
 {pulsar-client-cpp => build}/docker/README.md      |    8 +-
 pulsar-client-cpp/docker-build.sh                  |    2 +-
 pulsar-client-cpp/docker-tests.sh                  |    2 +-
 site/.gitignore                                    |    3 +
 site/_config.yml                                   |    1 +
 site/_data/protobuf.json                           | 2026 ------------
 site/api/cpp/_authentication_8h_source.html        |   83 -
 site/api/cpp/_batch_message_id_8h_source.html      |   81 -
 site/api/cpp/_broker_consumer_stats_8h_source.html |   94 -
 site/api/cpp/_client_8h_source.html                |   88 -
 site/api/cpp/_client_configuration_8h_source.html  |   92 -
 site/api/cpp/_compression_type_8h_source.html      |   78 -
 site/api/cpp/_consumer_8h_source.html              |   97 -
 .../api/cpp/_consumer_configuration_8h_source.html |   89 -
 site/api/cpp/_consumer_type_8h_source.html         |   82 -
 site/api/cpp/_message_8h_source.html               |   91 -
 site/api/cpp/_message_builder_8h_source.html       |   88 -
 site/api/cpp/_message_id_8h_source.html            |   80 -
 .../api/cpp/_message_routing_policy_8h_source.html |   80 -
 site/api/cpp/_producer_8h_source.html              |   87 -
 .../api/cpp/_producer_configuration_8h_source.html |   79 -
 site/api/cpp/_result_8h_source.html                |  109 -
 site/api/cpp/annotated.html                        |   93 -
 site/api/cpp/bc_s.png                              |  Bin 676 -> 0 bytes
 site/api/cpp/bdwn.png                              |  Bin 147 -> 0 bytes
 site/api/cpp/classes.html                          |   90 -
 .../cpp/classpulsar_1_1_auth_factory-members.html  |   87 -
 site/api/cpp/classpulsar_1_1_auth_factory.html     |  116 -
 .../classpulsar_1_1_authentication-members.html    |   86 -
 site/api/cpp/classpulsar_1_1_authentication.html   |  107 -
 ...r_1_1_authentication_data_provider-members.html |   90 -
 ...asspulsar_1_1_authentication_data_provider.html |  111 -
 .../classpulsar_1_1_batch_message_id-members.html  |  101 -
 site/api/cpp/classpulsar_1_1_batch_message_id.html |  167 -
 site/api/cpp/classpulsar_1_1_batch_message_id.png  |  Bin 630 -> 0 bytes
 ...sspulsar_1_1_broker_consumer_stats-members.html |   98 -
 .../cpp/classpulsar_1_1_broker_consumer_stats.html |  485 ---
 site/api/cpp/classpulsar_1_1_client-members.html   |   95 -
 site/api/cpp/classpulsar_1_1_client.html           |  299 --
 ...asspulsar_1_1_client_configuration-members.html |  106 -
 .../cpp/classpulsar_1_1_client_configuration.html  |  411 ---
 site/api/cpp/classpulsar_1_1_consumer-members.html |  108 -
 site/api/cpp/classpulsar_1_1_consumer.html         |  541 ----
 ...spulsar_1_1_consumer_configuration-members.html |   98 -
 .../classpulsar_1_1_consumer_configuration.html    |  287 --
 site/api/cpp/classpulsar_1_1_message-members.html  |  103 -
 site/api/cpp/classpulsar_1_1_message.html          |  339 --
 .../classpulsar_1_1_message_builder-members.html   |   93 -
 site/api/cpp/classpulsar_1_1_message_builder.html  |  322 --
 .../cpp/classpulsar_1_1_message_id-members.html    |   97 -
 site/api/cpp/classpulsar_1_1_message_id.html       |  156 -
 site/api/cpp/classpulsar_1_1_message_id.png        |  Bin 634 -> 0 bytes
 ...spulsar_1_1_message_routing_policy-members.html |   82 -
 .../classpulsar_1_1_message_routing_policy.html    |   90 -
 site/api/cpp/classpulsar_1_1_producer-members.html |   89 -
 site/api/cpp/classpulsar_1_1_producer.html         |  259 --
 ...spulsar_1_1_producer_configuration-members.html |  109 -
 .../classpulsar_1_1_producer_configuration.html    |  173 -
 site/api/cpp/closed.png                            |  Bin 132 -> 0 bytes
 site/api/cpp/deprecated.html                       |   77 -
 .../cpp/dir_84093bac216bb6272e4432021f1ca7f4.html  |   77 -
 .../cpp/dir_d44c64559bbebec7f509842c48db8b23.html  |   81 -
 site/api/cpp/doc.png                               |  Bin 746 -> 0 bytes
 site/api/cpp/doxygen.css                           | 1596 ---------
 site/api/cpp/doxygen.png                           |  Bin 3779 -> 0 bytes
 site/api/cpp/dynsections.js                        |   97 -
 site/api/cpp/files.html                            |   95 -
 site/api/cpp/folderclosed.png                      |  Bin 616 -> 0 bytes
 site/api/cpp/folderopen.png                        |  Bin 597 -> 0 bytes
 site/api/cpp/functions.html                        |  325 --
 site/api/cpp/functions_func.html                   |  325 --
 site/api/cpp/hierarchy.html                        |   92 -
 site/api/cpp/index.html                            |  100 -
 site/api/cpp/jquery.js                             |   87 -
 site/api/cpp/menu.js                               |   26 -
 site/api/cpp/menudata.js                           |   46 -
 site/api/cpp/namespacemembers.html                 |  192 --
 site/api/cpp/namespacemembers_enum.html            |   77 -
 site/api/cpp/namespacemembers_eval.html            |  176 -
 site/api/cpp/namespacemembers_type.html            |   77 -
 site/api/cpp/namespacepulsar.html                  |  317 --
 site/api/cpp/namespaces.html                       |   78 -
 site/api/cpp/nav_f.png                             |  Bin 153 -> 0 bytes
 site/api/cpp/nav_g.png                             |  Bin 95 -> 0 bytes
 site/api/cpp/nav_h.png                             |  Bin 98 -> 0 bytes
 site/api/cpp/open.png                              |  Bin 123 -> 0 bytes
 site/api/cpp/pages.html                            |   78 -
 site/api/cpp/search/all_0.html                     |   26 -
 site/api/cpp/search/all_0.js                       |   10 -
 site/api/cpp/search/all_1.html                     |   26 -
 site/api/cpp/search/all_1.js                       |    6 -
 site/api/cpp/search/all_2.html                     |   26 -
 site/api/cpp/search/all_2.js                       |   15 -
 site/api/cpp/search/all_3.html                     |   26 -
 site/api/cpp/search/all_3.js                       |    5 -
 site/api/cpp/search/all_4.html                     |   26 -
 site/api/cpp/search/all_4.js                       |   35 -
 site/api/cpp/search/all_5.html                     |   26 -
 site/api/cpp/search/all_5.js                       |    4 -
 site/api/cpp/search/all_6.html                     |   26 -
 site/api/cpp/search/all_6.js                       |    5 -
 site/api/cpp/search/all_7.html                     |   26 -
 site/api/cpp/search/all_7.js                       |    8 -
 site/api/cpp/search/all_8.html                     |   26 -
 site/api/cpp/search/all_8.js                       |    6 -
 site/api/cpp/search/all_9.html                     |   26 -
 site/api/cpp/search/all_9.js                       |   37 -
 site/api/cpp/search/all_a.html                     |   26 -
 site/api/cpp/search/all_a.js                       |   21 -
 site/api/cpp/search/all_b.html                     |   26 -
 site/api/cpp/search/all_b.js                       |    4 -
 site/api/cpp/search/all_c.html                     |   26 -
 site/api/cpp/search/all_c.js                       |    5 -
 site/api/cpp/search/classes_0.html                 |   26 -
 site/api/cpp/search/classes_0.js                   |    6 -
 site/api/cpp/search/classes_1.html                 |   26 -
 site/api/cpp/search/classes_1.js                   |    5 -
 site/api/cpp/search/classes_2.html                 |   26 -
 site/api/cpp/search/classes_2.js                   |    7 -
 site/api/cpp/search/classes_3.html                 |   26 -
 site/api/cpp/search/classes_3.js                   |    7 -
 site/api/cpp/search/classes_4.html                 |   26 -
 site/api/cpp/search/classes_4.js                   |    5 -
 site/api/cpp/search/close.png                      |  Bin 273 -> 0 bytes
 site/api/cpp/search/enums_0.html                   |   26 -
 site/api/cpp/search/enums_0.js                     |    4 -
 site/api/cpp/search/enums_1.html                   |   26 -
 site/api/cpp/search/enums_1.js                     |    4 -
 site/api/cpp/search/enumvalues_0.html              |   26 -
 site/api/cpp/search/enumvalues_0.js                |    6 -
 site/api/cpp/search/enumvalues_1.html              |   26 -
 site/api/cpp/search/enumvalues_1.js                |   33 -
 site/api/cpp/search/functions_0.html               |   26 -
 site/api/cpp/search/functions_0.js                 |    7 -
 site/api/cpp/search/functions_1.html               |   26 -
 site/api/cpp/search/functions_1.js                 |    4 -
 site/api/cpp/search/functions_2.html               |   26 -
 site/api/cpp/search/functions_2.js                 |    9 -
 site/api/cpp/search/functions_3.html               |   26 -
 site/api/cpp/search/functions_3.js                 |    4 -
 site/api/cpp/search/functions_4.html               |   26 -
 site/api/cpp/search/functions_4.js                 |   35 -
 site/api/cpp/search/functions_5.html               |   26 -
 site/api/cpp/search/functions_5.js                 |    4 -
 site/api/cpp/search/functions_6.html               |   26 -
 site/api/cpp/search/functions_6.js                 |    5 -
 site/api/cpp/search/functions_7.html               |   26 -
 site/api/cpp/search/functions_7.js                 |    4 -
 site/api/cpp/search/functions_8.html               |   26 -
 site/api/cpp/search/functions_8.js                 |    5 -
 site/api/cpp/search/functions_9.html               |   26 -
 site/api/cpp/search/functions_9.js                 |   21 -
 site/api/cpp/search/functions_a.html               |   26 -
 site/api/cpp/search/functions_a.js                 |    5 -
 site/api/cpp/search/mag_sel.png                    |  Bin 563 -> 0 bytes
 site/api/cpp/search/namespaces_0.html              |   26 -
 site/api/cpp/search/namespaces_0.js                |    4 -
 site/api/cpp/search/nomatches.html                 |   12 -
 site/api/cpp/search/pages_0.html                   |   26 -
 site/api/cpp/search/pages_0.js                     |    4 -
 site/api/cpp/search/pages_1.html                   |   26 -
 site/api/cpp/search/pages_1.js                     |    4 -
 site/api/cpp/search/search.css                     |  271 --
 site/api/cpp/search/search.js                      |  791 -----
 site/api/cpp/search/search_l.png                   |  Bin 604 -> 0 bytes
 site/api/cpp/search/search_m.png                   |  Bin 158 -> 0 bytes
 site/api/cpp/search/search_r.png                   |  Bin 612 -> 0 bytes
 site/api/cpp/search/searchdata.js                  |   36 -
 site/api/cpp/search/typedefs_0.html                |   26 -
 site/api/cpp/search/typedefs_0.js                  |    4 -
 site/api/cpp/search/typedefs_1.html                |   26 -
 site/api/cpp/search/typedefs_1.js                  |    4 -
 site/api/cpp/splitbar.png                          |  Bin 314 -> 0 bytes
 site/api/cpp/sync_off.png                          |  Bin 853 -> 0 bytes
 site/api/cpp/sync_on.png                           |  Bin 845 -> 0 bytes
 site/api/cpp/tab_a.png                             |  Bin 142 -> 0 bytes
 site/api/cpp/tab_b.png                             |  Bin 169 -> 0 bytes
 site/api/cpp/tab_h.png                             |  Bin 177 -> 0 bytes
 site/api/cpp/tab_s.png                             |  Bin 184 -> 0 bytes
 site/api/cpp/tabs.css                              |    1 -
 site/api/python/index.html                         | 3402 --------------------
 .../{doxygen-install.sh => docker-build.sh}        |   27 +-
 site/scripts/doxygen-doc-gen.sh                    |    2 +-
 site/scripts/protobuf-doc-gen.sh                   |    2 -
 site/scripts/python-doc-gen.sh                     |    5 +
 186 files changed, 56 insertions(+), 18811 deletions(-)

commit 517885ed0047a69f9a017640c171b93e62dbac31
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 7 14:26:48 2017 -0700

    Ensure the Python client works with Python-3 (#643)

 pulsar-client-cpp/CMakeLists.txt                | 19 +++++++++++++++++--
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h |  4 ++++
 pulsar-client-cpp/python/CMakeLists.txt         |  8 ++++----
 pulsar-client-cpp/python/pulsar.py              |  4 ++--
 pulsar-client-cpp/python/pulsar_test.py         |  4 ++--
 pulsar-client-cpp/python/setup.py               |  2 +-
 pulsar-client-cpp/python/src/enums.cc           |  2 +-
 7 files changed, 31 insertions(+), 12 deletions(-)

commit 69b3e8c8bd18aea5cfb71e2d4b235388e9b2b0cf
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 7 12:18:30 2017 -0700

    Removed required maven version from pom.xml (#640)

 pom.xml | 4 ----
 1 file changed, 4 deletions(-)

commit 4f22047cccf07b3dfc166b4c31b67ef59f4d9869
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Aug 7 10:08:34 2017 -0700

    Fix #644: BrokerServiceThrottlingTest.testLookupThrottlingForClientByBroker intermittent failures (#645)

 .../service/BrokerServiceThrottlingTest.java       | 24 ++++++++++++----------
 1 file changed, 13 insertions(+), 11 deletions(-)

commit b1e28d1c3871994031a88d683679cbbb11421ee1
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Aug 7 10:07:58 2017 -0700

    CPP Client: Fix BrokerConsumerStats function returning value instead of void (#650)

 pulsar-client-cpp/lib/Consumer.cc                |  5 +++--
 pulsar-client-cpp/lib/ConsumerImpl.cc            | 11 +++++++----
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc |  6 ++++--
 3 files changed, 14 insertions(+), 8 deletions(-)

commit 177dc66fa2c8259293fe993233da4f4f62323909
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Aug 7 10:07:06 2017 -0700

    CPP Client: Fix for sendTimer_ being dereferenced after reset (#649)

 pulsar-client-cpp/lib/ProducerImpl.cc | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit bef6cadc831172ea3b741ba07199c79293ca2138
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Aug 7 10:06:35 2017 -0700

    Add instructions on compiling from source (#648)

 site/_includes/explanations/install-package.md | 10 ++++++++++
 1 file changed, 10 insertions(+)

commit 8ee6ff8b0d28541d5e9ce5f702138e841ae51bdd
Author: jai1 <jai1@users.noreply.github.com>
Date:   Sun Aug 6 23:42:28 2017 -0700

    CPP Client - Fixed MAC build errors, due to undefined ZLIB_LIBRARY_PATH (#646)

 pulsar-client-cpp/CMakeLists.txt | 1 +
 1 file changed, 1 insertion(+)

commit 052ca00aea1af3fca82098714201b4e555f1e77e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Aug 4 19:07:09 2017 -0700

    fix: intermittent test by invalidating cache to read fresh data (#642)

 .../src/test/java/org/apache/pulsar/broker/admin/AdminApiTest.java    | 4 ++++
 1 file changed, 4 insertions(+)

commit a0044bce73aadb9a9b2930d67a563b56db1810a9
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 3 16:54:58 2017 -0700

    Add subscription-type argument into test (#636)

 .../main/java/org/apache/pulsar/testclient/PerformanceConsumer.java | 6 ++++++
 1 file changed, 6 insertions(+)

commit 5b7186dfa5c8d197b128b3e51319a49eff71d6c7
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 3 00:26:10 2017 -0700

    make batch-ack thread-safe (#619)

 .../pulsar/broker/service/BatchMessageTest.java    | 75 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 32 ++++++---
 2 files changed, 98 insertions(+), 9 deletions(-)

commit 10fef7d2a842f79c7a93494eca75885a8e25255b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Aug 3 00:01:23 2017 -0700

    remove duplicate dynamic-config listener call (#631)

 .../java/org/apache/pulsar/broker/service/BrokerService.java  | 11 -----------
 1 file changed, 11 deletions(-)

commit de31402450cf020dfc06b148fceb1581121c7bd0
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 2 23:11:55 2017 -0700

    Reduce memory settings for LocalBookieEsemble in tests mode (#626)

 .../org/apache/pulsar/PulsarStandaloneStarter.java    |  2 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java      |  1 +
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java     | 19 ++++++++++++++++++-
 3 files changed, 20 insertions(+), 2 deletions(-)

commit d8e8813c550ab6ad8361de363f9f9c4107711c87
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 2 17:37:57 2017 -0700

    Fix #612: NonPersistentTopicTest test timeout was too short and sometimes failed (#629)

 .../pulsar/client/api/NonPersistentTopicTest.java       | 17 ++++++++---------
 1 file changed, 8 insertions(+), 9 deletions(-)

commit cd5189dc5de2c51ec5f803c0003facb794cc9cf7
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Aug 2 15:14:50 2017 -0700

    Allow to compile C++ client lib in debug mode (#615)

 pulsar-client-cpp/CMakeLists.txt     | 9 ++++++++-
 pulsar-client-cpp/docker-build.sh    | 2 +-
 pulsar-client-cpp/lib/CMakeLists.txt | 6 +++---
 3 files changed, 12 insertions(+), 5 deletions(-)

commit aa5697063f4bcb31576d850aa327e054b47e70ae
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 1 21:54:35 2017 -0700

    Small typo fixes on website (#611)

 site/contact.md                          | 2 +-
 site/docs/latest/admin/AdminInterface.md | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

commit d305d2ec1a03bf0aa72ca8d4e8492300b5bbd63a
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 1 14:52:45 2017 -0700

    Reduce memory usage in producer and subscriptions maps (#613)

 .../pulsar/broker/service/nonpersistent/NonPersistentTopic.java     | 6 +++---
 .../apache/pulsar/broker/service/persistent/PersistentTopic.java    | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

commit a683c1908a82290cddea9f30053468f9f79db3fb
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 1 12:22:46 2017 -0700

    Bumped version to 1.20.0-incubating-SNAPSHOT (#609)

 all/pom.xml                       | 2 +-
 managed-ledger/pom.xml            | 2 +-
 pom.xml                           | 2 +-
 pulsar-broker-auth-athenz/pom.xml | 2 +-
 pulsar-broker-common/pom.xml      | 2 +-
 pulsar-broker/pom.xml             | 2 +-
 pulsar-checksum/pom.xml           | 2 +-
 pulsar-client-admin/pom.xml       | 2 +-
 pulsar-client-auth-athenz/pom.xml | 2 +-
 pulsar-client-tools/pom.xml       | 2 +-
 pulsar-client/pom.xml             | 2 +-
 pulsar-common/pom.xml             | 2 +-
 pulsar-discovery-service/pom.xml  | 2 +-
 pulsar-proxy/pom.xml              | 2 +-
 pulsar-spark/pom.xml              | 2 +-
 pulsar-storm/pom.xml              | 2 +-
 pulsar-testclient/pom.xml         | 2 +-
 pulsar-websocket/pom.xml          | 2 +-
 pulsar-zookeeper-utils/pom.xml    | 2 +-
 pulsar-zookeeper/pom.xml          | 2 +-
 20 files changed, 20 insertions(+), 20 deletions(-)

commit 88314ddcd78ca42ded00ab8e10cae7d6316d1d9c
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Aug 1 11:02:50 2017 -0700

    Redirect unit tests logs to file (#610)

 all/pom.xml                                        |  5 ++
 managed-ledger/pom.xml                             |  6 ++
 .../bookkeeper/mledger/util/CallbackMutexTest.java | 16 ----
 managed-ledger/src/test/resources/log4j.properties | 76 ------------------
 pom.xml                                            | 91 ++++++++++++++++------
 pulsar-broker/pom.xml                              | 40 +---------
 .../java/org/testng/listener/TestListener.java     | 60 --------------
 pulsar-broker/src/test/resources/log4j.properties  | 41 ----------
 pulsar-common/src/test/resources/log4j.properties  | 87 ---------------------
 pulsar-discovery-service/pom.xml                   | 26 +------
 .../src/test/resources/log4j.properties            | 87 ---------------------
 pulsar-proxy/pom.xml                               |  7 +-
 pulsar-websocket/pom.xml                           | 27 +------
 .../src/test/resources/log4j.properties            | 87 ---------------------
 14 files changed, 86 insertions(+), 570 deletions(-)

commit 96ed86c1c0dee77c3651c3ff529a461488f49158
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 31 12:11:07 2017 -0700

    Static link dependency libraries for C++ client lib and Python wrapper (#514)

 pulsar-client-cpp/CMakeLists.txt        | 73 +++++++++++++++++++++++++--------
 pulsar-client-cpp/README.md             |  2 +-
 pulsar-client-cpp/perf/CMakeLists.txt   |  5 +--
 pulsar-client-cpp/python/.gitignore     |  2 +-
 pulsar-client-cpp/python/CMakeLists.txt |  7 +++-
 pulsar-client-cpp/python/setup.py       | 11 ++---
 6 files changed, 71 insertions(+), 29 deletions(-)

commit 666e73f496b98c9685205aadae7f9eebe74c2c9e
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Tue Aug 1 02:11:21 2017 +0900

    Fix variable name in Authentication Class in pulsar.py (#608)

 pulsar-client-cpp/python/pulsar.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b8fd659d9afe90fc034a9225f1ab35d921863149
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jul 29 10:06:54 2017 -0700

    Use PrometheusMetricsProvider by default in bookies (#599)

 conf/bookkeeper.conf                                |  6 +++---
 .../org/apache/pulsar/PulsarStandaloneStarter.java  |  2 +-
 pulsar-zookeeper-utils/pom.xml                      |  7 +------
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java   | 21 +--------------------
 site/_data/config/bookkeeper.yaml                   |  8 +++-----
 5 files changed, 9 insertions(+), 35 deletions(-)

commit 13054396498afb51aeb89f030919a3b151914bf3
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 28 22:39:07 2017 -0700

    Maven artifacts relases into Apache (#607)

 .travis.yml          | 17 +++++-------
 .travis/settings.xml | 42 ++++++++++++++++------------
 pom.xml              | 77 ++++------------------------------------------------
 3 files changed, 38 insertions(+), 98 deletions(-)

commit 85a1c6c49e8a602df3f9326eb97cfec44540169e
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 28 17:24:46 2017 -0700

    add non-persistent topic documentation (#532)

 .../explanations/non-persistent-topics.md          | 61 ++++++++++++++++++++++
 .../getting-started/ConceptsAndArchitecture.md     |  6 ++-
 2 files changed, 66 insertions(+), 1 deletion(-)

commit 875767f6fc37270132190a8d0a8217510d292db9
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 28 15:08:56 2017 -0700

    Added Jenkins setup for building C++ client (#606)

 pulsar-client-cpp/.gitignore                    |   2 +
 pulsar-client-cpp/README.md                     |  15 ++
 pulsar-client-cpp/docker-build.sh               |  44 ++++
 pulsar-client-cpp/docker-tests.sh               |  42 ++++
 pulsar-client-cpp/docker/Dockerfile             |  33 +++
 pulsar-client-cpp/docker/README.md              |  12 ++
 pulsar-client-cpp/run-unit-tests.sh             |  59 ++++++
 pulsar-client-cpp/test-conf/client.conf         |  27 +++
 pulsar-client-cpp/test-conf/standalone-ssl.conf | 265 ++++++++++++++++++++++++
 pulsar-client-cpp/test-conf/standalone.conf     | 257 +++++++++++++++++++++++
 10 files changed, 756 insertions(+)

commit c02c5dfdd4dd69eea9a2d0ac9b78c996737ef571
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jul 28 14:05:55 2017 -0700

    CPP Client - Added -std=c++11 flag (#605)

 pulsar-client-cpp/CMakeLists.txt | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit 380e47e694fa28dc67947a81beb1d72e5039a84b
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 28 12:46:31 2017 -0700

    PIP-2: Introduce non-persistent topics (#538)

 conf/broker.conf                                   |  46 +-
 conf/standalone.conf                               |  18 +
 .../bookkeeper/mledger/impl/EntryCacheManager.java |   6 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  40 +
 .../org/apache/pulsar/broker/LocalBrokerData.java  |  18 +
 .../apache/pulsar/broker/admin/AdminResource.java  |  79 +-
 .../org/apache/pulsar/broker/admin/Namespaces.java |  26 +-
 .../pulsar/broker/admin/NonPersistentTopics.java   | 147 ++++
 .../pulsar/broker/admin/PersistentTopics.java      | 148 +---
 .../broker/loadbalance/impl/LoadManagerShared.java |  34 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  51 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  28 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |   9 +
 .../AbstractDispatcherMultipleConsumers.java       | 203 +++++
 .../AbstractDispatcherSingleActiveConsumer.java    | 197 +++++
 .../pulsar/broker/service/AbstractReplicator.java  | 213 +++++
 .../pulsar/broker/service/BrokerService.java       | 100 ++-
 .../org/apache/pulsar/broker/service/Consumer.java |   4 +-
 .../org/apache/pulsar/broker/service/Producer.java |  35 +-
 .../apache/pulsar/broker/service/PulsarStats.java  |   6 +-
 .../apache/pulsar/broker/service/Replicator.java   |  39 +
 .../apache/pulsar/broker/service/ServerCnx.java    |  21 +-
 .../apache/pulsar/broker/service/Subscription.java |   2 +
 .../org/apache/pulsar/broker/service/Topic.java    |  27 +-
 .../nonpersistent/NonPersistentDispatcher.java     |  75 ++
 .../NonPersistentDispatcherMultipleConsumers.java  | 177 ++++
 ...onPersistentDispatcherSingleActiveConsumer.java |  93 ++
 .../nonpersistent/NonPersistentReplicator.java     | 250 ++++++
 .../nonpersistent/NonPersistentSubscription.java   | 352 ++++++++
 .../service/nonpersistent/NonPersistentTopic.java  | 884 +++++++++++++++++++
 .../PersistentDispatcherMultipleConsumers.java     | 156 +---
 .../PersistentDispatcherSingleActiveConsumer.java  | 153 +---
 .../service/persistent/PersistentReplicator.java   | 214 +----
 .../service/persistent/PersistentSubscription.java |  11 +-
 .../broker/service/persistent/PersistentTopic.java |  44 +-
 .../stats/prometheus/NamespaceStatsAggregator.java |  21 +-
 .../pulsar/common/naming/NamespaceBundle.java      |  11 +
 .../pulsar/common/naming/NamespaceBundles.java     |   6 +-
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  52 +-
 .../broker/namespace/NamespaceServiceTest.java     |  16 +-
 .../pulsar/broker/service/BatchMessageTest.java    |  40 +-
 .../pulsar/broker/service/BrokerServiceTest.java   |   6 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   4 +-
 .../broker/service/PersistentFailoverE2ETest.java  |  12 +-
 .../broker/service/PersistentQueueE2ETest.java     |   4 +-
 .../broker/service/PersistentTopicE2ETest.java     |  22 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  42 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  14 +-
 .../pulsar/broker/service/ServerCnxTest.java       |   4 +-
 .../client/api/DispatcherBlockConsumerTest.java    |   4 +-
 .../pulsar/client/api/NonPersistentTopicTest.java  | 963 +++++++++++++++++++++
 .../com/scurrilous/circe/params/package-info.java  |   2 +-
 .../pulsar/client/admin/NonPersistentTopics.java   | 201 +++++
 .../apache/pulsar/client/admin/PulsarAdmin.java    |  10 +
 .../admin/internal/NonPersistentTopicsImpl.java    | 174 ++++
 .../org/apache/pulsar/admin/cli/CliCommand.java    |   9 +
 .../pulsar/admin/cli/CmdNonPersistentTopics.java   | 111 +++
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   1 +
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  21 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   5 +
 .../pulsar/common/naming/DestinationDomain.java    |  28 +-
 .../pulsar/common/naming/DestinationName.java      |   2 +-
 .../policies/data/NonPersistentPublisherStats.java |  38 +
 .../data/NonPersistentReplicatorStats.java         |  36 +
 .../data/NonPersistentSubscriptionStats.java       |  46 +
 .../policies/data/NonPersistentTopicStats.java     |  79 ++
 .../common/policies/data/PersistentTopicStats.java |   4 +-
 ...bscriptionStats.java => SubscriptionStats.java} |   6 +-
 .../policies/data/loadbalancer/LoadReport.java     |  19 +
 .../policies/data/PartitionedTopicStatsTest.java   |   4 +-
 .../policies/data/PersistentTopicStatsTest.java    |   4 +-
 .../explanations/non-persistent-topic-admin.md     | 221 +++++
 site/docs/latest/admin/AdminInterface.md           |   9 +
 73 files changed, 5362 insertions(+), 795 deletions(-)

commit d7bb707e4833485d7272b43fa6584db1d065a7ca
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Fri Jul 28 15:50:23 2017 +0900

    Add athenz authentication plugin for C++ client (#586)
    
    * Add athenz authentication plugin
    
    * Add tests for athenz plugin
    
    * Move ZTSClient.h
    
    * Addressed PR comments

 pulsar-client-cpp/lib/auth/AuthAthenz.cc         |  92 ++++++++
 pulsar-client-cpp/lib/auth/AuthAthenz.h          |  56 +++++
 pulsar-client-cpp/lib/auth/CMakeLists.txt        |   6 +
 pulsar-client-cpp/lib/auth/athenz/CMakeLists.txt |  21 ++
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.cc   | 288 +++++++++++++++++++++++
 pulsar-client-cpp/lib/auth/athenz/ZTSClient.h    |  53 +++++
 pulsar-client-cpp/tests/AuthPluginTest.cc        |  63 +++++
 7 files changed, 579 insertions(+)

commit 03ab475a875e56f76f7cd5db39ab5467e2f2d4e1
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 27 13:09:12 2017 -0700

    Removed duplicated links (#604)
    
    * Removed duplicated links
    
    * Fixed typos: peristent -> persistent
    
    * Fixed Slack channel links

 site/_includes/explanations/partitioned-topic-admin.md | 2 +-
 site/_includes/navbar.html                             | 2 --
 site/_plugins/custom_tags.rb                           | 2 +-
 site/contact.md                                        | 4 ++--
 site/docs/latest/admin/AdminInterface.md               | 4 ++--
 5 files changed, 6 insertions(+), 8 deletions(-)

commit a6e374a40e5391d5737b134fe967d02a73d6ff20
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 26 22:55:39 2017 -0700

    Remove duplicate cluster-info and bump header for properties (#603)

 .../explanations/persistent-topic-admin.md         | 544 +++++++++++++++++++++
 site/docs/latest/admin/AdminInterface.md           | 399 ++-------------
 2 files changed, 584 insertions(+), 359 deletions(-)

commit ca380d8366aed06e340aa32f8f92b49dd79fe0fa
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 26 17:30:15 2017 -0700

    CPP Client - Use long when calling curl_easy_getinfo in tests (#602)

 pulsar-client-cpp/tests/HttpHelper.cc | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

commit c8dfd41ca212570c60b3bce7f594369d73beb552
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 26 11:17:06 2017 -0700

    Added more info on how to setup monitoring (#600)

 site/_data/sidebar.yaml                      |  4 +-
 site/docs/latest/deployment/InstanceSetup.md | 37 -----------
 site/docs/latest/deployment/Monitoring.md    | 96 ++++++++++++++++++++++++++++
 site/index.html                              |  2 +-
 4 files changed, 100 insertions(+), 39 deletions(-)

commit 257363f75d7d938ccf2577d889d1646b24b6c46a
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 25 16:42:44 2017 -0700

    Added links to the Slack channel in website (#598)

 site/_includes/navbar.html            |  2 +-
 site/{mailing-lists.md => contact.md} | 12 +++++++++++-
 2 files changed, 12 insertions(+), 2 deletions(-)

commit 9d3a4504de56afbf7cf7bf043562f8c3cfc1684d
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Jul 25 14:21:08 2017 -0700

    Documentation changes (#574)

 site/_data/codebase.yaml                           |   27 +-
 site/_data/config/client.yaml                      |    6 +
 site/_data/features.yaml                           |    8 +-
 site/_data/popovers.yaml                           |    5 +-
 site/_data/sidebar.yaml                            |   49 +-
 site/_includes/codebase.html                       |   19 +-
 site/_includes/explanations/admin-setup.md         |    8 +-
 site/_includes/explanations/broker-admin.md        |    3 +-
 site/_includes/explanations/cluster-admin.md       |   33 +
 site/_includes/explanations/install-package.md     |   20 +-
 .../explanations/partitioned-topic-admin.md        |   23 +-
 site/_includes/explanations/partitioned-topics.md  |   34 +-
 .../explanations/service-discovery-setup.md        |    2 +-
 site/_includes/head.html                           |   12 +-
 site/_includes/navbar.html                         |   20 +-
 site/_includes/sidebar-ja.html                     |    4 +-
 site/_includes/sidebar.html                        |   22 +-
 site/_includes/testing.md                          |    3 -
 site/_includes/versions.html                       |    2 +-
 site/_sass/_docs.scss                              |    4 -
 site/_sass/{_tocify.scss => _toc.scss}             |    1 +
 site/css/style.scss                                |   38 +-
 site/docs/latest/_data/admin-rest-api-swagger.json | 4470 --------------------
 site/docs/latest/_data/cli/bookkeeper.yaml         |   85 -
 site/docs/latest/_data/cli/pulsar-admin.yaml       |  120 -
 site/docs/latest/_data/cli/pulsar-client.yaml      |   81 -
 site/docs/latest/_data/cli/pulsar-daemon.yaml      |   20 -
 site/docs/latest/_data/cli/pulsar-perf.yaml        |  202 -
 site/docs/latest/_data/cli/pulsar.yaml             |   89 -
 site/docs/latest/_data/messages.yaml               |   46 -
 site/docs/latest/_data/popovers.yaml               |   88 -
 site/docs/latest/_data/protobuf.json               | 1981 ---------
 site/docs/latest/_data/sidebar-ja.yaml             |   33 -
 site/docs/latest/_data/sidebar.yaml                |   76 -
 .../{applications => adaptors}/PulsarSpark.md      |   10 +-
 .../{applications => adaptors}/PulsarStorm.md      |   17 +-
 site/docs/latest/admin/Authz.md                    |    8 +-
 site/docs/latest/admin/ClustersBrokers.md          |    2 +
 site/docs/latest/admin/GeoReplication.md           |    4 +-
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |    4 +-
 .../{concerns => advanced}/PartitionedTopics.md    |   38 +-
 .../{concerns => advanced}/RetentionExpiry.md      |   14 +-
 .../{applications/CppClient.md => clients/Cpp.md}  |    0
 .../JavaClient.md => clients/Java.md}              |    6 +-
 .../PythonClient.md => clients/Python.md}          |    0
 .../latest/{applications => clients}/WebSocket.md  |    0
 site/docs/latest/deployment/InstanceSetup.md       |   23 +-
 site/docs/latest/deployment/Kubernetes.md          |    8 +-
 site/docs/latest/getting-started/Clients.md        |   18 +-
 .../getting-started/ConceptsAndArchitecture.md     |   26 +-
 site/docs/latest/getting-started/LocalCluster.md   |    8 +-
 site/docs/latest/index.md                          |   12 -
 site/docs/latest/project/BinaryProtocol.md         |    8 +-
 site/docs/latest/project/Codebase.md               |    4 +-
 .../{applications => project}/SimulationTools.md   |    0
 site/docs/latest/reference/Configuration.md        |    2 +-
 site/download.md                                   |   10 +-
 site/index.html                                    |    8 +-
 58 files changed, 352 insertions(+), 7512 deletions(-)

commit 3f7d72316d198692295426f58c01029466bac978
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 25 12:00:26 2017 -0700

    Excluded a couple of binary files from src release artifact (#597)

 all/src/assemble/src.xml |  2 ++
 pulsar-client-cpp/NOTICE | 36 ------------------------------------
 2 files changed, 2 insertions(+), 36 deletions(-)

commit 73d50b6c9881b457ad633c5f8dda34d2ba6af214
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 25 11:19:12 2017 -0700

    Local-policies cache should copy global-policy data and return combined result (#593)

 .../pulsar/broker/service/BrokerServiceTest.java   | 24 ++++++++++++++++++++--
 .../pulsar/zookeeper/ZooKeeperDataCache.java       |  2 +-
 2 files changed, 23 insertions(+), 3 deletions(-)

commit 298533cc919254346e4576f1bce5a4f8e68df140
Author: jai1 <jai1@users.noreply.github.com>
Date:   Tue Jul 25 11:00:07 2017 -0700

    CPP Client - removed log statement from ClientImpl Destructor (#590)

 pulsar-client-cpp/lib/ClientImpl.cc | 1 -
 1 file changed, 1 deletion(-)

commit 52db0e948f4fcad44b75d3845656f7f473b7101e
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Tue Jul 25 16:03:03 2017 +0900

    Added documents for wildcard matching in authorization (#543)

 conf/broker.conf                                   |  5 ++--
 conf/standalone.conf                               |  5 ++--
 conf/websocket.conf                                |  5 ++--
 .../apache/pulsar/broker/ServiceConfiguration.java |  4 ++-
 .../service/WebSocketProxyConfiguration.java       |  4 ++-
 site/_includes/explanations/permissions.md         | 31 ++++++++++++++++++++++
 6 files changed, 46 insertions(+), 8 deletions(-)

commit 87b8944fa16ec6a898d26cb3e9bd32fee82086e8
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Jul 24 18:13:27 2017 -0700

    CPP Client Test for Lookup Issue (#551) (#595)
    
    * CPP Client Test for Lookup Issue (#551)
    
    * Fixed a typo

 pulsar-client-cpp/lib/HandlerBase.h          |   1 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 115 +++++++++++++++++++++------
 pulsar-client-cpp/tests/PulsarFriend.h       |  14 ++++
 3 files changed, 107 insertions(+), 23 deletions(-)

commit aaae2214e6377cccba6c9d42c617b68560b77d06
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 24 15:17:36 2017 -0700

    Enable Apache rat in CI builds (#594)

 .travis.yml                |  2 +-
 pom.xml                    |  7 +++++++
 pulsar-client-cpp/Doxyfile | 19 +++++++++++++++++++
 3 files changed, 27 insertions(+), 1 deletion(-)

commit 422a68f94b918e4c3792b0a1f8dcc741542e5013
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 24 13:42:08 2017 -0700

    Fixed references to Yahoo pages (#591)

 pulsar-client-cpp/docs/MainPage.md                 |  4 ++--
 site/_data/config/broker.yaml                      |  2 +-
 site/_includes/explanations/admin-setup.md         |  2 +-
 site/_includes/explanations/broker-admin.md        |  2 +-
 site/_includes/explanations/cluster-admin.md       |  2 +-
 site/_includes/explanations/install-package.md     | 20 +++++++++---------
 site/_includes/explanations/namespace-admin.md     |  2 +-
 site/_includes/explanations/partitioned-topics.md  | 12 +++++------
 site/api/cpp/index.html                            |  6 +++---
 site/docs/latest/admin/Authz.md                    |  8 ++++----
 site/docs/latest/admin/GeoReplication.md           |  2 +-
 site/docs/latest/admin/ModularLoadManager.md       | 20 +++++++++---------
 site/docs/latest/applications/PulsarSpark.md       |  6 +++---
 site/docs/latest/concerns/PartitionedTopics.md     |  4 ++--
 site/docs/latest/getting-started/Clients.md        | 12 +++++------
 .../getting-started/ConceptsAndArchitecture.md     |  2 +-
 site/docs/latest/project/BinaryProtocol.md         | 24 +++++++++++-----------
 site/download.md                                   | 22 ++++++++++++--------
 site/ja/README.md                                  |  8 +++-----
 site/scripts/javadoc-admin.html                    |  2 +-
 site/scripts/javadoc-client.html                   |  2 +-
 site/scripts/javadoc-gen.sh                        |  3 +++
 22 files changed, 86 insertions(+), 81 deletions(-)

commit 92610d102b8b49247ef2860761122024796fa230
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 24 12:23:34 2017 -0700

    Added script to sign release artifacts (#592)

 src/sign-release.sh | 33 +++++++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)

commit 22aee8943ca9660c4508c417251d2d71dbf51a83
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 21 14:51:13 2017 -0700

    clear up pendingReceive queue when consumer close (#588)

 .../client/api/SimpleProducerConsumerTest.java     | 36 ++++++++++++++++++++++
 .../apache/pulsar/client/impl/ConsumerImpl.java    | 23 +++++++++++++-
 .../client/impl/PartitionedConsumerImpl.java       | 21 +++++++++++++
 3 files changed, 79 insertions(+), 1 deletion(-)

commit 2ab766a697d99aa02e0fbc0cf760c778686002f3
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 21 12:56:27 2017 -0700

    Updated README by removing broken links and adding instruction on how to build (#589)

 README.md | 43 ++++++++++++++++++++++++++++++++-----------
 pom.xml   |  9 +--------
 2 files changed, 33 insertions(+), 19 deletions(-)

commit ee65abeb8bdfa351ca36bdb6afedfb8b2b3cf56f
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jul 21 13:44:56 2017 -0400

    Upgrade to RocksDB 5.5.5 with Apache License 2.0 (#587)

 all/licenses/LICENSE-RocksDB.txt | 74 ----------------------------------------
 all/src/assemble/LICENSE.bin.txt |  4 +--
 pom.xml                          |  7 ++++
 3 files changed, 8 insertions(+), 77 deletions(-)

commit f6ebbb2d2112d0f715f4e77d3943df69bfa029ab
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 19 23:21:12 2017 -0700

    Add GrowablePriorityLongPairQueue and tests (#425)

 .../collections/GrowablePriorityLongPairQueue.java | 375 ++++++++++++++++++++
 .../GrowablePriorityLongPairQueueTest.java         | 386 +++++++++++++++++++++
 2 files changed, 761 insertions(+)

commit 4d4080cebaccc93bb6457a59a4e050c3eb5e0ab3
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Wed Jul 19 17:17:59 2017 -0700

    make javadoc generation not delete whole /api directory (#585)

 site/Makefile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6e8cbc85b9d76beb97ac7cd6129a6e5631fc4459
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Tue Jul 18 22:04:41 2017 -0700

    Basic website fixes (#582)

 site/.gitignore                                    |    3 +-
 site/Makefile                                      |    6 +-
 site/_includes/head.html                           |    3 +
 site/_includes/navbar.html                         |    9 +
 site/api/cpp/_authentication_8h_source.html        |   83 +
 site/api/cpp/_batch_message_id_8h_source.html      |   81 +
 site/api/cpp/_broker_consumer_stats_8h_source.html |   94 ++
 site/api/cpp/_client_8h_source.html                |   88 ++
 site/api/cpp/_client_configuration_8h_source.html  |   92 ++
 site/api/cpp/_compression_type_8h_source.html      |   78 +
 site/api/cpp/_consumer_8h_source.html              |   97 ++
 .../api/cpp/_consumer_configuration_8h_source.html |   89 ++
 site/api/cpp/_consumer_type_8h_source.html         |   82 +
 site/api/cpp/_message_8h_source.html               |   91 ++
 site/api/cpp/_message_builder_8h_source.html       |   88 ++
 site/api/cpp/_message_id_8h_source.html            |   80 +
 .../api/cpp/_message_routing_policy_8h_source.html |   80 +
 site/api/cpp/_producer_8h_source.html              |   87 ++
 .../api/cpp/_producer_configuration_8h_source.html |   79 +
 site/api/cpp/_result_8h_source.html                |  109 ++
 site/api/cpp/annotated.html                        |   93 ++
 site/api/cpp/bc_s.png                              |  Bin 0 -> 676 bytes
 site/api/cpp/bdwn.png                              |  Bin 0 -> 147 bytes
 site/api/cpp/classes.html                          |   90 ++
 .../cpp/classpulsar_1_1_auth_factory-members.html  |   87 ++
 site/api/cpp/classpulsar_1_1_auth_factory.html     |  116 ++
 .../classpulsar_1_1_authentication-members.html    |   86 ++
 site/api/cpp/classpulsar_1_1_authentication.html   |  107 ++
 ...r_1_1_authentication_data_provider-members.html |   90 ++
 ...asspulsar_1_1_authentication_data_provider.html |  111 ++
 .../classpulsar_1_1_batch_message_id-members.html  |  101 ++
 site/api/cpp/classpulsar_1_1_batch_message_id.html |  167 ++
 site/api/cpp/classpulsar_1_1_batch_message_id.png  |  Bin 0 -> 630 bytes
 ...sspulsar_1_1_broker_consumer_stats-members.html |   98 ++
 .../cpp/classpulsar_1_1_broker_consumer_stats.html |  485 ++++++
 site/api/cpp/classpulsar_1_1_client-members.html   |   95 ++
 site/api/cpp/classpulsar_1_1_client.html           |  299 ++++
 ...asspulsar_1_1_client_configuration-members.html |  106 ++
 .../cpp/classpulsar_1_1_client_configuration.html  |  411 +++++
 site/api/cpp/classpulsar_1_1_consumer-members.html |  108 ++
 site/api/cpp/classpulsar_1_1_consumer.html         |  541 +++++++
 ...spulsar_1_1_consumer_configuration-members.html |   98 ++
 .../classpulsar_1_1_consumer_configuration.html    |  287 ++++
 site/api/cpp/classpulsar_1_1_message-members.html  |  103 ++
 site/api/cpp/classpulsar_1_1_message.html          |  339 +++++
 .../classpulsar_1_1_message_builder-members.html   |   93 ++
 site/api/cpp/classpulsar_1_1_message_builder.html  |  322 ++++
 .../cpp/classpulsar_1_1_message_id-members.html    |   97 ++
 site/api/cpp/classpulsar_1_1_message_id.html       |  156 ++
 site/api/cpp/classpulsar_1_1_message_id.png        |  Bin 0 -> 634 bytes
 ...spulsar_1_1_message_routing_policy-members.html |   82 +
 .../classpulsar_1_1_message_routing_policy.html    |   90 ++
 site/api/cpp/classpulsar_1_1_producer-members.html |   89 ++
 site/api/cpp/classpulsar_1_1_producer.html         |  259 ++++
 ...spulsar_1_1_producer_configuration-members.html |  109 ++
 .../classpulsar_1_1_producer_configuration.html    |  173 +++
 site/api/cpp/closed.png                            |  Bin 0 -> 132 bytes
 site/api/cpp/deprecated.html                       |   77 +
 .../cpp/dir_84093bac216bb6272e4432021f1ca7f4.html  |   77 +
 .../cpp/dir_d44c64559bbebec7f509842c48db8b23.html  |   81 +
 site/api/cpp/doc.png                               |  Bin 0 -> 746 bytes
 site/api/cpp/doxygen.css                           | 1596 ++++++++++++++++++++
 site/api/cpp/doxygen.png                           |  Bin 0 -> 3779 bytes
 site/api/cpp/dynsections.js                        |   97 ++
 site/api/cpp/files.html                            |   95 ++
 site/api/cpp/folderclosed.png                      |  Bin 0 -> 616 bytes
 site/api/cpp/folderopen.png                        |  Bin 0 -> 597 bytes
 site/api/cpp/functions.html                        |  325 ++++
 site/api/cpp/functions_func.html                   |  325 ++++
 site/api/cpp/hierarchy.html                        |   92 ++
 site/api/cpp/index.html                            |  100 ++
 site/api/cpp/jquery.js                             |   87 ++
 site/api/cpp/menu.js                               |   26 +
 site/api/cpp/menudata.js                           |   46 +
 site/api/cpp/namespacemembers.html                 |  192 +++
 site/api/cpp/namespacemembers_enum.html            |   77 +
 site/api/cpp/namespacemembers_eval.html            |  176 +++
 site/api/cpp/namespacemembers_type.html            |   77 +
 site/api/cpp/namespacepulsar.html                  |  317 ++++
 site/api/cpp/namespaces.html                       |   78 +
 site/api/cpp/nav_f.png                             |  Bin 0 -> 153 bytes
 site/api/cpp/nav_g.png                             |  Bin 0 -> 95 bytes
 site/api/cpp/nav_h.png                             |  Bin 0 -> 98 bytes
 site/api/cpp/open.png                              |  Bin 0 -> 123 bytes
 site/api/cpp/pages.html                            |   78 +
 site/api/cpp/search/all_0.html                     |   26 +
 site/api/cpp/search/all_0.js                       |   10 +
 site/api/cpp/search/all_1.html                     |   26 +
 site/api/cpp/search/all_1.js                       |    6 +
 site/api/cpp/search/all_2.html                     |   26 +
 site/api/cpp/search/all_2.js                       |   15 +
 site/api/cpp/search/all_3.html                     |   26 +
 site/api/cpp/search/all_3.js                       |    5 +
 site/api/cpp/search/all_4.html                     |   26 +
 site/api/cpp/search/all_4.js                       |   35 +
 site/api/cpp/search/all_5.html                     |   26 +
 site/api/cpp/search/all_5.js                       |    4 +
 site/api/cpp/search/all_6.html                     |   26 +
 site/api/cpp/search/all_6.js                       |    5 +
 site/api/cpp/search/all_7.html                     |   26 +
 site/api/cpp/search/all_7.js                       |    8 +
 site/api/cpp/search/all_8.html                     |   26 +
 site/api/cpp/search/all_8.js                       |    6 +
 site/api/cpp/search/all_9.html                     |   26 +
 site/api/cpp/search/all_9.js                       |   37 +
 site/api/cpp/search/all_a.html                     |   26 +
 site/api/cpp/search/all_a.js                       |   21 +
 site/api/cpp/search/all_b.html                     |   26 +
 site/api/cpp/search/all_b.js                       |    4 +
 site/api/cpp/search/all_c.html                     |   26 +
 site/api/cpp/search/all_c.js                       |    5 +
 site/api/cpp/search/classes_0.html                 |   26 +
 site/api/cpp/search/classes_0.js                   |    6 +
 site/api/cpp/search/classes_1.html                 |   26 +
 site/api/cpp/search/classes_1.js                   |    5 +
 site/api/cpp/search/classes_2.html                 |   26 +
 site/api/cpp/search/classes_2.js                   |    7 +
 site/api/cpp/search/classes_3.html                 |   26 +
 site/api/cpp/search/classes_3.js                   |    7 +
 site/api/cpp/search/classes_4.html                 |   26 +
 site/api/cpp/search/classes_4.js                   |    5 +
 site/api/cpp/search/close.png                      |  Bin 0 -> 273 bytes
 site/api/cpp/search/enums_0.html                   |   26 +
 site/api/cpp/search/enums_0.js                     |    4 +
 site/api/cpp/search/enums_1.html                   |   26 +
 site/api/cpp/search/enums_1.js                     |    4 +
 site/api/cpp/search/enumvalues_0.html              |   26 +
 site/api/cpp/search/enumvalues_0.js                |    6 +
 site/api/cpp/search/enumvalues_1.html              |   26 +
 site/api/cpp/search/enumvalues_1.js                |   33 +
 site/api/cpp/search/functions_0.html               |   26 +
 site/api/cpp/search/functions_0.js                 |    7 +
 site/api/cpp/search/functions_1.html               |   26 +
 site/api/cpp/search/functions_1.js                 |    4 +
 site/api/cpp/search/functions_2.html               |   26 +
 site/api/cpp/search/functions_2.js                 |    9 +
 site/api/cpp/search/functions_3.html               |   26 +
 site/api/cpp/search/functions_3.js                 |    4 +
 site/api/cpp/search/functions_4.html               |   26 +
 site/api/cpp/search/functions_4.js                 |   35 +
 site/api/cpp/search/functions_5.html               |   26 +
 site/api/cpp/search/functions_5.js                 |    4 +
 site/api/cpp/search/functions_6.html               |   26 +
 site/api/cpp/search/functions_6.js                 |    5 +
 site/api/cpp/search/functions_7.html               |   26 +
 site/api/cpp/search/functions_7.js                 |    4 +
 site/api/cpp/search/functions_8.html               |   26 +
 site/api/cpp/search/functions_8.js                 |    5 +
 site/api/cpp/search/functions_9.html               |   26 +
 site/api/cpp/search/functions_9.js                 |   21 +
 site/api/cpp/search/functions_a.html               |   26 +
 site/api/cpp/search/functions_a.js                 |    5 +
 site/api/cpp/search/mag_sel.png                    |  Bin 0 -> 563 bytes
 site/api/cpp/search/namespaces_0.html              |   26 +
 site/api/cpp/search/namespaces_0.js                |    4 +
 site/api/cpp/search/nomatches.html                 |   12 +
 site/api/cpp/search/pages_0.html                   |   26 +
 site/api/cpp/search/pages_0.js                     |    4 +
 site/api/cpp/search/pages_1.html                   |   26 +
 site/api/cpp/search/pages_1.js                     |    4 +
 site/api/cpp/search/search.css                     |  271 ++++
 site/api/cpp/search/search.js                      |  791 ++++++++++
 site/api/cpp/search/search_l.png                   |  Bin 0 -> 604 bytes
 site/api/cpp/search/search_m.png                   |  Bin 0 -> 158 bytes
 site/api/cpp/search/search_r.png                   |  Bin 0 -> 612 bytes
 site/api/cpp/search/searchdata.js                  |   36 +
 site/api/cpp/search/typedefs_0.html                |   26 +
 site/api/cpp/search/typedefs_0.js                  |    4 +
 site/api/cpp/search/typedefs_1.html                |   26 +
 site/api/cpp/search/typedefs_1.js                  |    4 +
 site/api/cpp/splitbar.png                          |  Bin 0 -> 314 bytes
 site/api/cpp/sync_off.png                          |  Bin 0 -> 853 bytes
 site/api/cpp/sync_on.png                           |  Bin 0 -> 845 bytes
 site/api/cpp/tab_a.png                             |  Bin 0 -> 142 bytes
 site/api/cpp/tab_b.png                             |  Bin 0 -> 169 bytes
 site/api/cpp/tab_h.png                             |  Bin 0 -> 177 bytes
 site/api/cpp/tab_s.png                             |  Bin 0 -> 184 bytes
 site/api/cpp/tabs.css                              |    1 +
 178 files changed, 13382 insertions(+), 4 deletions(-)

commit 72a073bdee23cf4a6887415cee7733e8eb44f2c9
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 18 19:18:13 2017 -0700

    Fixed bin distribution file name from pulsar-x.y-bin.tgz to apache-pulsar... (#583)

 docker/Dockerfile | 4 ++--
 docker/build.sh   | 6 +++---
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 0ee1faded27b7cd65878d0dc331362fa4a004e55
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 18 16:32:09 2017 -0700

    Build and publish docker images (#575)

 .travis.yml           | 16 +++++++++++-
 docker/build.sh       | 16 +++++-------
 docker/get-version.sh | 30 +++++++++++++++++++++
 docker/publish.sh     | 72 +++++++++++++++++++++++++++++++++++++++++++++++++++
 4 files changed, 123 insertions(+), 11 deletions(-)

commit 9dae207041e6835878b94669cddc26513387e312
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 18 00:20:45 2017 -0700

    Fix #578: Force early load of epoll library to avoid race condition (#580)

 .../test/java/org/apache/pulsar/websocket/LookupProtocolTest.java | 8 ++++++++
 1 file changed, 8 insertions(+)

commit 7357ae18fbe8d3d9c7cc6e6b0b28a99501f3493c
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 17 17:34:33 2017 -0700

    Fixes for NOTICE and LICENSE files for src and bin distribution (#563)

 DISCLAIMER                                         |   6 +
 LICENSE                                            | 105 +++++-
 NOTICE                                             |  39 +--
 all/licenses/LICENSE-CC0.txt                       | 121 +++++++
 all/licenses/LICENSE-CDDL-1.1.txt                  | 348 +++++++++++++++++++
 all/licenses/LICENSE-EA-Agent-Loader.txt           |  25 ++
 all/licenses/LICENSE-EPL-1.0.txt                   | 216 ++++++++++++
 all/licenses/LICENSE-HdrHistogram.txt              |  41 +++
 all/licenses/LICENSE-HdrHistogram0.txt             |  41 +++
 all/licenses/LICENSE-JLine.txt                     |  29 ++
 all/licenses/LICENSE-RocksDB.txt                   |  74 +++++
 all/licenses/LICENSE-SLF4J.txt                     |  21 ++
 all/licenses/LICENSE-SemVer.txt                    |  21 ++
 .../licenses/LICENSE-protobuf.txt                  |   2 +-
 all/pom.xml                                        |   2 +-
 all/src/assemble/LICENSE.bin.txt                   | 367 +++++++++++++++++++++
 all/src/assemble/NOTICE.bin.txt                    | 312 ++++++++++++++++++
 all/src/assemble/README.bin.txt                    |   2 +
 all/src/assemble/bin.xml                           |  28 +-
 all/src/assemble/src.xml                           |  26 +-
 managed-ledger/LICENSE                             |  11 -
 pom.xml                                            |  30 +-
 22 files changed, 1805 insertions(+), 62 deletions(-)

commit cfc0683b4936fa94a40f3bcc85bd68c6ef979046
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 17 14:13:48 2017 -0700

    Only deploy releases and website from apache/incubator-pulsar repo (#576)

 .travis.yml | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 30be621e8cad6063c90b337532e76880c479d3b0
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jul 17 13:35:10 2017 -0700

    Simplified the instantiation of Netty EventLoopGroup (#570)

 .../pulsar/broker/service/BrokerService.java       | 66 ++++++------------
 .../pulsar/client/api/MockBrokerService.java       | 27 ++------
 .../apache/pulsar/client/impl/ConnectionPool.java  | 11 +--
 .../pulsar/client/impl/PulsarClientImpl.java       | 19 +-----
 .../pulsar/common/util/netty/EventLoopUtil.java    | 78 ++++++++++++++++++++++
 .../pulsar/discovery/service/DiscoveryService.java | 34 ++--------
 .../apache/pulsar/proxy/server/ProxyService.java   | 25 ++-----
 .../pulsar/testclient/LoadSimulationClient.java    | 17 ++---
 .../pulsar/testclient/PerformanceConsumer.java     | 19 +-----
 .../pulsar/testclient/PerformanceProducer.java     | 22 ++----
 .../pulsar/testclient/PerformanceReader.java       | 19 +-----
 11 files changed, 131 insertions(+), 206 deletions(-)

commit 524ff06ebf8b72a8b9923f546db13faf7ebc2033
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jul 17 12:24:38 2017 -0700

    Fix: register zk-stats listener after broker service started (#573)

 .../pulsar/broker/service/BrokerService.java       | 20 ++++++++++++----
 .../broker/zookeeper/aspectj/ClientCnxnAspect.java | 28 ++++++++++++++++++++--
 .../zookeeper/ZooKeeperClientAspectJTest.java      | 28 ++++++++++++----------
 3 files changed, 57 insertions(+), 19 deletions(-)

commit 3047d1c24628bbd6df7a6acc7624ed1641cde2e1
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Sat Jul 15 09:58:53 2017 +0900

    Add empty check for subscription name (#559)

 .../broker/service/persistent/PersistentTopic.java |  9 +++++
 .../pulsar/broker/service/PersistentTopicTest.java | 19 +++++++++++
 .../client/api/SimpleProducerConsumerTest.java     |  8 +++++
 .../websocket/proxy/ProxyPublishConsumeTest.java   | 39 ++++++++++++++++++++++
 .../pulsar/client/impl/PulsarClientImpl.java       |  6 ++--
 .../apache/pulsar/websocket/ConsumerHandler.java   |  1 +
 6 files changed, 80 insertions(+), 2 deletions(-)

commit ae6ca6ba628be1e6ab2c62c723b50376690db6fd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 13 17:40:08 2017 -0700

    disable ZooKeeperClientAspectJTest test (#565)

 .../apache/pulsar/broker/zookeeper/ZooKeeperClientAspectJTest.java  | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 18b47f23c9250217889606dda81c953d3682ac0e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jul 13 16:40:09 2017 -0700

    Publish website after commits on master branch (#567)

 .travis.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 66ae063891499b475772f243a3ff3cd2ac5475b1
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Thu Jul 13 15:42:36 2017 -0700

    New website and documentation (#557)

 .gitignore                                         |    3 +
 .travis.yml                                        |   10 +-
 README.md                                          |    2 +-
 docs/AdminTools.md                                 | 2492 -----------
 docs/Architecture.md                               |  324 --
 docs/Authentication.md                             |  275 --
 docs/Authorization.md                              |   77 -
 docs/ClusterSetup.md                               |  387 --
 docs/Dashboard.md                                  |   51 -
 docs/Documentation.md                              |   23 -
 docs/GeoReplication.md                             |  144 -
 docs/GettingStarted.md                             |  199 -
 docs/Kubernetes.md                                 |  246 --
 docs/ModularLoadManager.md                         |  226 -
 docs/PulsarSpark.md                                |   45 -
 docs/Python.md                                     |  331 --
 docs/WebSocket.md                                  |  278 --
 kubernetes/google-container-engine/bookie.yaml     |    2 +-
 kubernetes/google-container-engine/broker.yaml     |    2 +-
 kubernetes/google-container-engine/zookeeper.yaml  |    2 +-
 pom.xml                                            |    9 +-
 pulsar-client-cpp/Doxyfile                         | 2481 +++++++++++
 pulsar-client-cpp/docs/MainPage.md                 |  150 +
 pulsar-client-cpp/python/pulsar.py                 |   14 +-
 .../pulsar/discovery/service/DiscoveryService.java |    2 +-
 site/.gitignore                                    |   12 +
 site/Gemfile                                       |    8 +
 site/Gemfile.lock                                  |   59 +
 site/Makefile                                      |   77 +
 site/README.md                                     |  115 +
 site/VERSIONS                                      |    1 +
 site/_config.local.yml                             |   25 +
 site/_config.yml                                   |   63 +
 site/_data/admin-rest-api-swagger.json             | 4523 ++++++++++++++++++++
 site/_data/cli/bookkeeper.yaml                     |   73 +
 site/_data/cli/pulsar-admin.yaml                   |  452 ++
 site/_data/cli/pulsar-client.yaml                  |   63 +
 site/_data/cli/pulsar-daemon.yaml                  |   34 +
 site/_data/cli/pulsar-perf.yaml                    |  141 +
 site/_data/cli/pulsar.yaml                         |  159 +
 site/_data/codebase.yaml                           |   43 +
 site/_data/config/bookkeeper.yaml                  |  232 +
 site/_data/config/broker.yaml                      |  283 ++
 site/_data/config/client.yaml                      |   29 +
 site/_data/config/discovery.yaml                   |   65 +
 site/_data/config/global-zookeeper.yaml            |   44 +
 site/_data/config/log4j-shell.yaml                 |   39 +
 site/_data/config/log4j.yaml                       |   57 +
 site/_data/config/standalone.yaml                  |  202 +
 site/_data/config/websocket.yaml                   |   62 +
 site/_data/config/zookeeper.yaml                   |   44 +
 site/_data/features.yaml                           |   55 +
 site/_data/messages.yaml                           |   62 +
 site/_data/popovers.yaml                           |  113 +
 site/_data/protobuf.json                           | 2026 +++++++++
 site/_data/sidebar-ja.yaml                         |   33 +
 site/_data/sidebar.yaml                            |  102 +
 site/_data/stats.yaml                              |   70 +
 site/_includes/admonition.html                     |   26 +
 site/_includes/cli.html                            |  204 +
 site/_includes/codebase.html                       |   31 +
 site/_includes/config.html                         |   40 +
 site/_includes/explanations/admin-setup.md         |   34 +
 site/_includes/explanations/broker-admin.md        |  151 +
 site/_includes/explanations/client-url.md          |   33 +
 site/_includes/explanations/cluster-admin.md       |  153 +
 site/_includes/explanations/deploying-bk.md        |   38 +
 site/_includes/explanations/deploying-zk.md        |  122 +
 site/_includes/explanations/install-package.md     |   49 +
 site/_includes/explanations/instance-admin.md      |    1 +
 site/_includes/explanations/namespace-admin.md     |  603 +++
 .../explanations/partitioned-topic-admin.md        |  255 ++
 site/_includes/explanations/partitioned-topics.md  |   19 +
 site/_includes/explanations/permissions.md         |   82 +
 .../explanations/properties-namespaces.md          |   21 +
 site/_includes/explanations/property-admin.md      |   77 +
 .../explanations/service-discovery-setup.md        |   27 +
 site/_includes/footer.html                         |   25 +
 site/_includes/google-analytics.html               |   30 +
 site/_includes/head.html                           |   40 +
 site/_includes/message.html                        |   27 +
 site/_includes/navbar.html                         |   91 +
 site/_includes/protobuf.html                       |  138 +
 site/_includes/sidebar-ja.html                     |   38 +
 site/_includes/sidebar.html                        |   68 +
 site/_includes/stats.html                          |   37 +
 site/_includes/swagger.html                        |  116 +
 site/_includes/tags-modal.html                     |   38 +
 site/_includes/testing.md                          |    3 +
 site/_includes/topic.html                          |   23 +
 site/_includes/versions.html                       |   25 +
 site/_layouts/content.html                         |   50 +
 site/_layouts/default.html                         |   63 +
 site/_layouts/docs-ja.html                         |   48 +
 site/_layouts/docs-main.html                       |   43 +
 site/_layouts/docs.html                            |   61 +
 site/_layouts/rest-api.html                        |   44 +
 site/_plugins/custom_tags.rb                       |  102 +
 site/_sass/_admonition.scss                        |   57 +
 site/_sass/_cli.scss                               |  100 +
 site/_sass/_docs.scss                              |  256 ++
 site/_sass/_mixins.scss                            |   17 +
 site/_sass/_navbar.scss                            |   56 +
 site/_sass/_popover.scss                           |   25 +
 site/_sass/_protobuf.scss                          |   79 +
 site/_sass/_sidebar.scss                           |   66 +
 site/_sass/_swagger.scss                           |   48 +
 site/_sass/_syntax.scss                            |  149 +
 site/_sass/_tocify.scss                            |   71 +
 site/_sass/_variables.scss                         |   55 +
 site/_sass/bootstrap-sass/.scss-lint.yml           |  567 +++
 site/_sass/bootstrap-sass/_alert.scss              |   55 +
 site/_sass/bootstrap-sass/_badge.scss              |   77 +
 site/_sass/bootstrap-sass/_breadcrumb.scss         |   38 +
 site/_sass/bootstrap-sass/_button-group.scss       |  202 +
 site/_sass/bootstrap-sass/_buttons.scss            |  170 +
 site/_sass/bootstrap-sass/_card.scss               |  276 ++
 site/_sass/bootstrap-sass/_carousel.scss           |  178 +
 site/_sass/bootstrap-sass/_close.scss              |   31 +
 site/_sass/bootstrap-sass/_code.scss               |   64 +
 site/_sass/bootstrap-sass/_custom-forms.scss       |  263 ++
 site/_sass/bootstrap-sass/_custom.scss             |    4 +
 site/_sass/bootstrap-sass/_dropdown.scss           |  161 +
 site/_sass/bootstrap-sass/_forms.scss              |  388 ++
 site/_sass/bootstrap-sass/_grid.scss               |   52 +
 site/_sass/bootstrap-sass/_images.scss             |   43 +
 site/_sass/bootstrap-sass/_input-group.scss        |  178 +
 site/_sass/bootstrap-sass/_jumbotron.scss          |   20 +
 site/_sass/bootstrap-sass/_list-group.scss         |  141 +
 site/_sass/bootstrap-sass/_media.scss              |    8 +
 site/_sass/bootstrap-sass/_mixins.scss             |   57 +
 site/_sass/bootstrap-sass/_modal.scss              |  142 +
 site/_sass/bootstrap-sass/_nav.scss                |  119 +
 site/_sass/bootstrap-sass/_navbar.scss             |  268 ++
 site/_sass/bootstrap-sass/_normalize.scss          |  461 ++
 site/_sass/bootstrap-sass/_pagination.scss         |   67 +
 site/_sass/bootstrap-sass/_popover.scss            |  171 +
 site/_sass/bootstrap-sass/_print.scss              |  119 +
 site/_sass/bootstrap-sass/_progress.scss           |   32 +
 site/_sass/bootstrap-sass/_reboot.scss             |  389 ++
 site/_sass/bootstrap-sass/_responsive-embed.scss   |   52 +
 site/_sass/bootstrap-sass/_tables.scss             |  153 +
 site/_sass/bootstrap-sass/_tooltip.scss            |   90 +
 site/_sass/bootstrap-sass/_transitions.scss        |   34 +
 site/_sass/bootstrap-sass/_type.scss               |  143 +
 site/_sass/bootstrap-sass/_utilities.scss          |   13 +
 site/_sass/bootstrap-sass/_variables.scss          |  961 +++++
 site/_sass/bootstrap-sass/bootstrap-grid.scss      |   43 +
 site/_sass/bootstrap-sass/bootstrap-reboot.scss    |   10 +
 site/_sass/bootstrap-sass/bootstrap.scss           |   54 +
 site/_sass/bootstrap-sass/mixins/_alert.scss       |   14 +
 .../bootstrap-sass/mixins/_background-variant.scss |   12 +
 site/_sass/bootstrap-sass/mixins/_badge.scss       |   11 +
 .../bootstrap-sass/mixins/_border-radius.scss      |   35 +
 site/_sass/bootstrap-sass/mixins/_breakpoints.scss |   95 +
 site/_sass/bootstrap-sass/mixins/_buttons.scss     |   86 +
 site/_sass/bootstrap-sass/mixins/_cards.scss       |   47 +
 site/_sass/bootstrap-sass/mixins/_clearfix.scss    |    7 +
 site/_sass/bootstrap-sass/mixins/_float.scss       |    9 +
 site/_sass/bootstrap-sass/mixins/_forms.scss       |   79 +
 site/_sass/bootstrap-sass/mixins/_gradients.scss   |   37 +
 .../bootstrap-sass/mixins/_grid-framework.scss     |   65 +
 site/_sass/bootstrap-sass/mixins/_grid.scss        |  100 +
 site/_sass/bootstrap-sass/mixins/_hover.scss       |   60 +
 site/_sass/bootstrap-sass/mixins/_image.scss       |   36 +
 site/_sass/bootstrap-sass/mixins/_list-group.scss  |   28 +
 site/_sass/bootstrap-sass/mixins/_lists.scss       |    7 +
 site/_sass/bootstrap-sass/mixins/_nav-divider.scss |   10 +
 .../_sass/bootstrap-sass/mixins/_navbar-align.scss |    9 +
 site/_sass/bootstrap-sass/mixins/_pagination.scss  |   21 +
 site/_sass/bootstrap-sass/mixins/_reset-text.scss  |   17 +
 site/_sass/bootstrap-sass/mixins/_resize.scss      |    6 +
 .../bootstrap-sass/mixins/_screen-reader.scss      |   32 +
 site/_sass/bootstrap-sass/mixins/_size.scss        |    6 +
 site/_sass/bootstrap-sass/mixins/_table-row.scss   |   30 +
 .../bootstrap-sass/mixins/_text-emphasis.scss      |   12 +
 site/_sass/bootstrap-sass/mixins/_text-hide.scss   |    8 +
 .../bootstrap-sass/mixins/_text-truncate.scss      |    8 +
 site/_sass/bootstrap-sass/mixins/_transforms.scss  |   14 +
 site/_sass/bootstrap-sass/mixins/_visibility.scss  |    5 +
 site/_sass/bootstrap-sass/utilities/_align.scss    |    6 +
 .../bootstrap-sass/utilities/_background.scss      |   19 +
 site/_sass/bootstrap-sass/utilities/_borders.scss  |   37 +
 site/_sass/bootstrap-sass/utilities/_clearfix.scss |    3 +
 site/_sass/bootstrap-sass/utilities/_display.scss  |   18 +
 site/_sass/bootstrap-sass/utilities/_flex.scss     |   48 +
 site/_sass/bootstrap-sass/utilities/_float.scss    |    9 +
 site/_sass/bootstrap-sass/utilities/_position.scss |   23 +
 .../bootstrap-sass/utilities/_screenreaders.scss   |   11 +
 site/_sass/bootstrap-sass/utilities/_sizing.scss   |   10 +
 site/_sass/bootstrap-sass/utilities/_spacing.scss  |   43 +
 site/_sass/bootstrap-sass/utilities/_text.scss     |   61 +
 .../bootstrap-sass/utilities/_visibility.scss      |   55 +
 site/_sass/font-awesome/_animated.scss             |   34 +
 site/_sass/font-awesome/_bordered-pulled.scss      |   25 +
 site/_sass/font-awesome/_core.scss                 |   12 +
 site/_sass/font-awesome/_fixed-width.scss          |    6 +
 site/_sass/font-awesome/_icons.scss                |  789 ++++
 site/_sass/font-awesome/_larger.scss               |   13 +
 site/_sass/font-awesome/_list.scss                 |   19 +
 site/_sass/font-awesome/_mixins.scss               |   60 +
 site/_sass/font-awesome/_path.scss                 |   15 +
 site/_sass/font-awesome/_rotated-flipped.scss      |   20 +
 site/_sass/font-awesome/_screen-reader.scss        |    5 +
 site/_sass/font-awesome/_stacked.scss              |   20 +
 site/_sass/font-awesome/_variables.scss            |  799 ++++
 site/_sass/font-awesome/font-awesome.scss          |   18 +
 site/api/python/index.html                         | 3402 +++++++++++++++
 site/css/style.scss                                |  238 +
 site/docs/latest/_config.version.yml               |   21 +
 site/docs/latest/_data/admin-rest-api-swagger.json | 4470 +++++++++++++++++++
 site/docs/latest/_data/cli/bookkeeper.yaml         |   85 +
 site/docs/latest/_data/cli/pulsar-admin.yaml       |  120 +
 site/docs/latest/_data/cli/pulsar-client.yaml      |   81 +
 site/docs/latest/_data/cli/pulsar-daemon.yaml      |   20 +
 site/docs/latest/_data/cli/pulsar-perf.yaml        |  202 +
 site/docs/latest/_data/cli/pulsar.yaml             |   89 +
 site/docs/latest/_data/messages.yaml               |   46 +
 site/docs/latest/_data/popovers.yaml               |   88 +
 site/docs/latest/_data/protobuf.json               | 1981 +++++++++
 site/docs/latest/_data/sidebar-ja.yaml             |   33 +
 site/docs/latest/_data/sidebar.yaml                |   76 +
 site/docs/latest/admin/AdminInterface.md           |  767 ++++
 site/docs/latest/admin/Authz.md                    |  308 ++
 site/docs/latest/admin/ClustersBrokers.md          |   20 +
 site/docs/latest/admin/Dashboard.md                |   36 +
 site/docs/latest/admin/GeoReplication.md           |  118 +
 site/docs/latest/admin/ModularLoadManager.md       |  211 +
 site/docs/latest/admin/PropertiesNamespaces.md     |   23 +
 site/docs/latest/admin/Stats.md                    |   11 +
 site/docs/latest/admin/ZooKeeperBookKeeper.md      |  158 +
 site/docs/latest/applications/CppClient.md         |  161 +
 site/docs/latest/applications/JavaClient.md        |  250 ++
 site/docs/latest/applications/PulsarSpark.md       |   64 +
 .../docs/latest/applications}/PulsarStorm.md       |   23 +-
 site/docs/latest/applications/PythonClient.md      |  102 +
 .../docs/latest/applications}/SimulationTools.md   |   30 +-
 site/docs/latest/applications/WebSocket.md         |  285 ++
 site/docs/latest/concerns/PartitionedTopics.md     |   82 +
 site/docs/latest/concerns/RetentionExpiry.md       |  285 ++
 site/docs/latest/deployment/InstanceSetup.md       |  197 +
 site/docs/latest/deployment/Kubernetes.md          |  275 ++
 site/docs/latest/getting-started/Clients.md        |   35 +
 .../getting-started/ConceptsAndArchitecture.md     |  269 ++
 site/docs/latest/getting-started/LocalCluster.md   |   96 +
 site/docs/latest/index.md                          |   12 +
 .../docs/latest/project}/BinaryProtocol.md         |  309 +-
 site/docs/latest/project/Codebase.md               |    6 +
 site/docs/latest/reference/CliTools.md             |   41 +
 site/docs/latest/reference/Configuration.md        |   76 +
 site/docs/latest/reference/RestApi.md              |    8 +
 site/download.md                                   |   34 +
 site/fonts/font-awesome/FontAwesome.otf            |  Bin 0 -> 259642 bytes
 site/fonts/font-awesome/fontawesome-webfont.eot    |  Bin 0 -> 165742 bytes
 site/fonts/font-awesome/fontawesome-webfont.svg    | 2671 ++++++++++++
 site/fonts/font-awesome/fontawesome-webfont.ttf    |  Bin 0 -> 165548 bytes
 site/fonts/font-awesome/fontawesome-webfont.woff   |  Bin 0 -> 98024 bytes
 site/fonts/font-awesome/fontawesome-webfont.woff2  |  Bin 0 -> 77160 bytes
 .../img/Binary Protocol - Connect.graffle          |  Bin
 {docs => site}/img/Binary Protocol - Connect.png   |  Bin
 .../img/Binary Protocol - Consumer.graffle         |  Bin
 {docs => site}/img/Binary Protocol - Consumer.png  |  Bin
 .../img/Binary Protocol - Producer.graffle         |  Bin
 {docs => site}/img/Binary Protocol - Producer.png  |  Bin
 .../img/Binary Protocol - Topic lookup.graffle     |  Bin
 .../img/Binary Protocol - Topic lookup.png         |  Bin
 {docs => site}/img/GeoReplication.png              |  Bin
 {docs => site}/img/Pulsar-icon.pdf                 |  Bin
 site/img/apache_incubator.png                      |  Bin 0 -> 17730 bytes
 site/img/broker-bookie.png                         |  Bin 0 -> 136204 bytes
 site/img/favicon.ico                               |  Bin 0 -> 1150 bytes
 site/img/feather.png                               |  Bin 0 -> 37733 bytes
 site/img/japan-flag.svg                            |    5 +
 docs/img/pulsar.png => site/img/pulsar-logo.png    |  Bin
 {docs => site}/img/pulsar.pdf                      |  Bin
 site/img/pulsar.png                                |  Bin 0 -> 6156 bytes
 {docs => site}/img/pulsar.svg                      |    0
 {docs => site}/img/pulsar_partitioned_topic.jpg    |  Bin
 {docs => site}/img/pulsar_subscriptions.jpg        |  Bin
 {docs => site}/img/pulsar_system_architecture.png  |  Bin
 site/index.html                                    |   77 +
 {docs/locale => site}/ja/AdminTools.md             |   90 +-
 {docs/locale => site}/ja/Architecture.md           |   34 +-
 {docs/locale => site}/ja/Authentication.md         |   20 +-
 {docs/locale => site}/ja/Authorization.md          |   14 +-
 {docs/locale => site}/ja/BinaryProtocol.md         |   23 +-
 {docs/locale => site}/ja/ClusterSetup.md           |    4 +-
 {docs/locale => site}/ja/Documentation.md          |    4 +-
 {docs/locale => site}/ja/GeoReplication.md         |   15 +-
 {docs/locale => site}/ja/GettingStarted.md         |   18 +-
 {docs/locale => site}/ja/PulsarSpark.md            |    4 +-
 {docs/locale => site}/ja/PulsarStorm.md            |    6 +-
 {docs/locale => site}/ja/README.md                 |    6 +-
 {docs/locale => site}/ja/WebSocket.md              |   17 +-
 site/ja/index.md                                   |    5 +
 site/js/jquery.scrollTo.min.js                     |    7 +
 site/js/jquery.tocify.min.js                       |    4 +
 site/js/main.js                                    |  101 +
 site/mailing-lists.md                              |   14 +
 site/presentations.md                              |   13 +
 site/scripts/build-all-versions.sh                 |   27 +
 site/scripts/doxygen-doc-gen.sh                    |   32 +
 site/scripts/doxygen-install.sh                    |   29 +
 site/scripts/javadoc-admin.html                    |   25 +
 site/scripts/javadoc-client.html                   |   25 +
 site/scripts/javadoc-gen.sh                        |   65 +
 site/scripts/protobuf-doc-gen.sh                   |   30 +
 site/scripts/publish-website.sh                    |   54 +
 site/scripts/python-doc-gen.sh                     |   29 +
 site/team.md                                       |   45 +
 310 files changed, 43813 insertions(+), 5518 deletions(-)

commit 0470a7e57360d93b03a97101a968a0e18338d4ee
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 13 13:50:44 2017 -0700

    avoid multiple registration of zkClient-aspect in test (#566)

 .../apache/pulsar/broker/zookeeper/ZooKeeperClientAspectJTest.java    | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit f3785515e9d776372f3b7b82f0b5fbc2adf2ff81
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jul 13 10:18:31 2017 -0700

    Fix: CPP release baseCommand after serializing it (#561)
    
    * CPP release baseCommand after serializing it
    
    * take mutex for lookup and clear protobuf
    
    * make method level static memeber

 pulsar-client-cpp/lib/ClientConnection.cc |  8 ++++----
 pulsar-client-cpp/lib/Commands.cc         | 33 +++++++++++++++++++++++++------
 pulsar-client-cpp/lib/Commands.h          |  6 +++---
 3 files changed, 34 insertions(+), 13 deletions(-)

commit c033484b563d5735848537be5d44e2fa7aaa3cd0
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 12 16:11:32 2017 -0700

    Removed test log file (#562)

 pulsar-client-cpp/log | 1202 -------------------------------------------------
 1 file changed, 1202 deletions(-)

commit 49301ef4dee8207acc05880a7c364bc38bb796df
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 12 16:05:11 2017 -0700

    Upgrdate JNA library to 4.2.0 (#560)

 pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit bb0a8fbb598a87326582386d9b97a6b435afedcf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jul 11 16:58:36 2017 -0700

    Add zk-stats instrumentation to get zk-client stats (#507)
    
    * Add zk-stats instrumentation to get zk-client stats
    
    * fix: listenerTypo + add timeUnit
    
    * Add Prometheus for dimension metrics instead histogram
    
    * caching string variable
    
    * remove pom: todo
    
    * Fix: duplicate summary registration for unit-test

 pom.xml                                            |   6 +
 pulsar-broker/pom.xml                              |  70 +++++
 .../org/apache/pulsar/PulsarBrokerStarter.java     |   6 +
 .../org/apache/pulsar/PulsarStandaloneStarter.java |   6 +-
 .../org/apache/pulsar/broker/PulsarService.java    |   9 +-
 .../pulsar/broker/service/BrokerService.java       |   5 +
 .../apache/pulsar/broker/service/PulsarStats.java  |  13 +
 .../broker/stats/BrokerOperabilityMetrics.java     |  53 +++-
 .../apache/pulsar/broker/stats/DimensionStats.java | 111 +++++++
 .../apache/pulsar/broker/stats/TopicLoadStats.java |  69 -----
 .../broker/zookeeper/aspectj/ClientCnxnAspect.java | 181 +++++++++++
 pulsar-broker/src/main/resources/META-INF/aop.xml  |  31 ++
 .../pulsar/broker/service/BrokerServiceTest.java   |   2 +-
 .../zookeeper/ZooKeeperClientAspectJTest.java      | 337 +++++++++++++++++++++
 .../zookeeper/ZookeeperBkClientFactoryImpl.java    | 122 ++++++++
 .../ZookeeperBkClientFactoryImplTest.java          |  84 +++++
 16 files changed, 1014 insertions(+), 91 deletions(-)

commit 4be5883fe1636dbdb9bb6de49ea12656985cffd0
Author: jai1 <jai1@users.noreply.github.com>
Date:   Tue Jul 11 12:08:59 2017 -0700

    CPP Client - Reducing number of duplicate lookups (#556)
    
    * CPP Client: Avoiding duplicate reconnection attempts
    
    * CPP Client: Avoiding duplicate reconnection attempts
    
    * Fix for Unit Test

 pulsar-client-cpp/lib/ClientConnection.cc | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

commit f36b70cd6fb249cd54d1f63fe55e3a4e3203d168
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jul 11 11:17:46 2017 -0700

    PIP-1 - Introduce Pulsar proxy component (#548)

 all/pom.xml                                        |   6 +
 bin/pulsar                                         |  14 +-
 conf/proxy.conf                                    |  72 ++++++
 pom.xml                                            |   3 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |  31 +--
 .../apache/pulsar/broker/service/ServerCnx.java    |  12 +-
 .../pulsar/broker/service/ServerCnxTest.java       |  10 +-
 .../apache/pulsar/client/api/ClientErrorsTest.java |   8 +-
 .../pulsar/client/api/MockBrokerService.java       |  12 +-
 .../client/impl/BinaryProtoLookupService.java      |  61 +++--
 .../org/apache/pulsar/client/impl/ClientCnx.java   |  25 ++-
 .../apache/pulsar/client/impl/ConnectionPool.java  |  49 +++-
 .../pulsar/client/impl/HttpLookupService.java      |   8 +-
 .../apache/pulsar/client/impl/LookupService.java   |  19 +-
 .../pulsar/client/impl/PulsarClientImpl.java       |   7 +-
 .../org/apache/pulsar/common/api/Commands.java     |  61 ++---
 .../apache/pulsar/common/api/PulsarDecoder.java    |   2 +-
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 248 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  80 ++++---
 .../pulsar/discovery/service/ServerConnection.java |  12 +-
 pulsar-proxy/pom.xml                               | 146 ++++++++++++
 .../proxy/server/BrokerDiscoveryProvider.java      | 178 +++++++++++++++
 .../pulsar/proxy/server/DirectProxyHandler.java    | 183 +++++++++++++++
 .../pulsar/proxy/server/LookupProxyHandler.java    | 160 +++++++++++++
 .../pulsar/proxy/server/ProxyConfiguration.java    | 220 ++++++++++++++++++
 .../pulsar/proxy/server/ProxyConnection.java       | 244 ++++++++++++++++++++
 .../apache/pulsar/proxy/server/ProxyService.java   | 235 +++++++++++++++++++
 .../pulsar/proxy/server/ProxyServiceStarter.java   | 127 +++++++++++
 .../proxy/server/ServiceChannelInitializer.java    |  66 ++++++
 .../org/apache/pulsar/proxy/server/WebServer.java  | 138 ++++++++++++
 .../proxy/server/util/ZookeeperCacheLoader.java    | 138 ++++++++++++
 pulsar-proxy/src/main/resources/log4j.properties   |  73 ++++++
 .../org/apache/pulsar/proxy/server/ProxyTest.java  | 126 +++++++++++
 .../apache/pulsar/proxy/server/ProxyTlsTest.java   | 121 ++++++++++
 pulsar-proxy/src/test/resources/cacert.pem         |  62 ++++++
 pulsar-proxy/src/test/resources/proxy-cert.pem     |  72 ++++++
 pulsar-proxy/src/test/resources/proxy-key.pem      |  28 +++
 37 files changed, 2900 insertions(+), 157 deletions(-)

commit 365230c57a8d0b7ed7dc9c9fdd7a9f7fcf75d84e
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Jul 10 15:00:47 2017 -0700

    CPP Client - Accessing connection_ pointer under a lock (#555)

 pulsar-client-cpp/lib/ConsumerImpl.cc | 4 +++-
 pulsar-client-cpp/lib/HandlerBase.cc  | 4 +++-
 pulsar-client-cpp/lib/ProducerImpl.cc | 3 ++-
 3 files changed, 8 insertions(+), 3 deletions(-)

commit 9a8098fb9d61701c829d5bda27f7b277c854e8eb
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jul 7 16:39:25 2017 -0700

    ZookeeperCache children-cache invalidation on watch-event  and LoadManager handling if availableBrokerCache is not updated (#550)

 .../loadbalance/impl/ModularLoadManagerImpl.java    |  9 ++++++++-
 .../loadbalance/impl/ModularLoadManagerWrapper.java |  1 -
 .../loadbalance/ModularLoadManagerImplTest.java     | 21 +++++++++++++++++++++
 .../org/apache/pulsar/zookeeper/ZooKeeperCache.java |  8 ++++++++
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java    |  2 +-
 5 files changed, 38 insertions(+), 3 deletions(-)

commit f54dea1e1a46e67d4ba477b1aa338ea1ab8e5085
Author: cckellogg <cckellogg@gmail.com>
Date:   Fri Jul 7 16:03:41 2017 -0700

    Allow cumulative acknowledgements for Failover subscriptions. (#549)

 .../src/main/java/org/apache/pulsar/client/impl/ConsumerBase.java   | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

commit f5768b057aab33f58988753d3eb643d86437db85
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jul 7 15:43:16 2017 -0700

    Fix for Problems in lookup flow in C++ Client (#551) - Issue 1 (#553)

 pulsar-client-cpp/lib/HandlerBase.cc | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

commit dcd9b137470abef0766aac2bfaab0b210a26c709
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Fri Jul 7 07:08:11 2017 +0900

    Added wildcard matching setting for DiscoveryService (#547)

 conf/discovery.conf                                |  5 ++++
 .../pulsar/discovery/service/DiscoveryService.java | 32 +++++++++++-----------
 .../discovery/service/server/ServiceConfig.java    | 13 +++++++++
 3 files changed, 34 insertions(+), 16 deletions(-)

commit b801eaa5551a2e53593125cf4adf84b35437bb80
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jul 5 18:39:17 2017 -0700

    Message size validation on post compression (#541)
    
    * Message size validation on post compression
    
    * check blockQueue after payload size
    
    * Change topic-name to avoid conflict in parallel test-runs

 pulsar-client-cpp/lib/ConsumerImpl.cc        |  5 +--
 pulsar-client-cpp/lib/ProducerImpl.cc        | 25 ++++++++------
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 51 ++++++++++++++++++++++++++++
 3 files changed, 68 insertions(+), 13 deletions(-)

commit 09fd5e9ecdd733c8edddf0cb30f8aef89d4f5742
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 5 12:58:20 2017 -0700

    Generate C++ protobuf code during cmake build (#471)

 pulsar-client-cpp/.gitignore           |     4 +
 pulsar-client-cpp/README.md            |     5 +-
 pulsar-client-cpp/generate_protobuf.sh |    22 -
 pulsar-client-cpp/lib/CMakeLists.txt   |    13 +-
 pulsar-client-cpp/lib/PulsarApi.pb.cc  | 10320 -------------------------------
 pulsar-client-cpp/lib/PulsarApi.pb.h   |  9632 -----------------------------
 pulsar-client-cpp/travis-build.sh      |    10 +-
 7 files changed, 19 insertions(+), 19987 deletions(-)

commit 91d8414333fa8f794e1856917a4a211cd4a292d4
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jul 5 10:27:23 2017 -0700

    Disabled deployment of SNAPSHOT jars to Sonatype repository (#546)

 .travis.yml | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)

commit c232df62e6b7df274419dd2437779a2c90dbeedd
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Fri Jun 30 15:28:39 2017 -0700

    Fix: intermittent test failure for BrokerClientIntegrationTest.testCloseBrokerService (#545)

 .../apache/pulsar/client/impl/BrokerClientIntegrationTest.java | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit b86f7bb852cb5915501ddf5744cbbb8339344200
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Fri Jun 30 09:57:20 2017 -0700

    Enable TLS Client Authentication  on WebSocketProxy and DiscoveryService (#535)

 .../discovery/service/ServiceChannelInitializer.java | 13 +++++++++++--
 .../discovery/service/server/ServerManager.java      |  4 ++--
 .../discovery/service/server/ServiceConfig.java      | 20 ++++++++++++++++++++
 .../apache/pulsar/websocket/service/ProxyServer.java |  2 +-
 4 files changed, 34 insertions(+), 5 deletions(-)

commit 1994f4f0b3e3ede13223838ade4b7c989f3e13d3
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Fri Jun 30 09:36:09 2017 -0700

    Support wildcard in permitted role name (#530)

 conf/broker.conf                                   |  4 +
 conf/standalone.conf                               |  4 +
 conf/websocket.conf                                |  4 +
 .../apache/pulsar/broker/ServiceConfiguration.java | 17 +++-
 .../broker/authorization/AuthorizationManager.java | 78 ++++++++++++++-----
 .../pulsar/broker/auth/AuthorizationTest.java      | 91 ++++++++++++++++++++++
 .../org/apache/pulsar/common/util/FieldParser.java | 35 +++++----
 .../common/util/collections/FieldParserTest.java   |  2 +-
 .../apache/pulsar/websocket/WebSocketService.java  |  1 +
 .../service/WebSocketProxyConfiguration.java       | 11 +++
 10 files changed, 204 insertions(+), 43 deletions(-)

commit 3d00b31d76804ebe2e1ce1379626742b6bdcd635
Author: Yuta Takaba <yutakaba@gmail.com>
Date:   Fri Jun 30 15:17:15 2017 +0900

    Fixed license link (#542)

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5fa4cb6feaf283bccec1a8bf699c0981450fc40e
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Thu Jun 29 23:05:56 2017 -0700

    Bump up athenz version (#540)

 pom.xml                                                             | 6 +++---
 pulsar-broker-auth-athenz/pom.xml                                   | 2 +-
 .../pulsar/broker/authentication/AuthenticationProviderAthenz.java  | 6 +++---
 pulsar-client-auth-athenz/pom.xml                                   | 2 +-
 4 files changed, 8 insertions(+), 8 deletions(-)

commit 435a6644465fde973066798bad663cb6cced66f3
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Jun 29 17:08:46 2017 -0700

    C++ unit tests in less than a minute (#539)

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 8 +++++---
 pulsar-client-cpp/tests/BatchMessageTest.cc  | 7 +++++--
 pulsar-client-cpp/travis-build.sh            | 6 +++++-
 3 files changed, 15 insertions(+), 6 deletions(-)

commit d178710308005224a9b18b77c7491caadc9214c0
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Wed Jun 28 16:41:42 2017 -0700

    Validate msg size after compressing the msg while sending msg (#534)

 .../client/api/SimpleProducerConsumerTest.java     | 76 +++++++++++++++++++++-
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  9 +--
 .../pulsar/client/impl/MessageBuilderImpl.java     |  5 --
 .../apache/pulsar/client/impl/ProducerImpl.java    | 15 +++++
 4 files changed, 94 insertions(+), 11 deletions(-)

commit b3db513bcc1733ba4dd2bb9448da297b2ec7a5bf
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Jun 28 15:37:00 2017 -0700

    CPP Client - Added Monitoring Stats (#485)

 .../include/pulsar/ClientConfiguration.h           |   12 +
 .../include/pulsar/ProducerConfiguration.h         |    1 +
 pulsar-client-cpp/lib/CMakeLists.txt               |    2 +-
 pulsar-client-cpp/lib/ClientConfiguration.cc       |    9 +
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    |    5 +-
 pulsar-client-cpp/lib/ClientImpl.cc                |    5 +
 pulsar-client-cpp/lib/ClientImpl.h                 |    2 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   43 +-
 pulsar-client-cpp/lib/ConsumerImpl.h               |   10 +
 pulsar-client-cpp/lib/ProducerImpl.cc              |   45 +-
 pulsar-client-cpp/lib/ProducerImpl.h               |    9 +-
 pulsar-client-cpp/lib/Result.cc                    |    4 +-
 pulsar-client-cpp/lib/Utils.h                      |    9 +
 pulsar-client-cpp/lib/stats/ConsumerStatsBase.h    |   38 +
 .../lib/stats/ConsumerStatsDisabled.h              |   35 +
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.cc   |  113 ++
 pulsar-client-cpp/lib/stats/ConsumerStatsImpl.h    |   83 ++
 pulsar-client-cpp/lib/stats/ProducerStatsBase.h    |   37 +
 .../lib/stats/ProducerStatsDisabled.h              |   32 +
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.cc   |  132 +++
 pulsar-client-cpp/lib/stats/ProducerStatsImpl.h    |  118 ++
 pulsar-client-cpp/log                              | 1202 ++++++++++++++++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  167 ++-
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  125 +-
 pulsar-client-cpp/tests/PulsarFriend.h             |   21 +
 25 files changed, 2176 insertions(+), 83 deletions(-)

commit 8ccbfae42e8b4338830076dfe023524b345c3faf
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Tue Jun 27 15:08:44 2017 -0700

    exclude license for athenz-test-conf file (#533)

 .../AuthenticationProviderAthenzTest.java             |  2 +-
 .../test/resources/{athenz.conf => athenz.conf.test}  | 19 -------------------
 2 files changed, 1 insertion(+), 20 deletions(-)

commit b3a0f642d1131425bb1b00eedb600c0ec79af6fa
Author: jai1 <jai1@users.noreply.github.com>
Date:   Tue Jun 27 14:53:58 2017 -0700

    C++ Client - Changed compiler to default version (4.8.4) (#529)

 pulsar-client-cpp/travis-build.sh | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 6a84aac955994a29229ac0be12fdccc0656c6814
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 26 16:37:28 2017 -0700

    Added apache-rat plugin and fixed some license headers (#528)

 .travis.yml                                        | 18 +++++++
 managed-ledger/src/test/resources/log4j.properties | 19 +++++++
 pom.xml                                            | 58 ++++++++++++++++++++--
 .../src/test/resources/athenz.conf                 | 19 +++++++
 .../resources/pulsar-broker-version.properties     | 19 +++++++
 .../configurations/pulsar_broker_test.conf         | 19 +++++++
 pulsar-broker/src/test/resources/log4j.properties  | 19 +++++++
 pulsar-broker/src/test/resources/logback.xml       | 20 ++++++++
 .../com/scurrilous/circe/crc/package-info.java     | 16 ++++++
 .../circe/impl/DirectByteBufferAccess.java         | 18 ++++++-
 .../com/scurrilous/circe/impl/package-info.java    | 16 ++++++
 .../java/com/scurrilous/circe/package-info.java    | 16 ++++++
 .../com/scurrilous/circe/params/package-info.java  | 16 ++++++
 .../src/test/resources/athenz.conf                 | 19 +++++++
 pulsar-client-cpp/lib/auth/CMakeLists.txt          | 19 +++++++
 pulsar-client-cpp/lib/checksum/crc32c_sw.h         | 18 +++++++
 pulsar-client-tools/src/test/resources/localtest   |  2 -
 pulsar-client/src/main/resources/ahc.properties    | 19 +++++++
 .../resources/pulsar-client-version.properties     | 19 +++++++
 pulsar-client/src/test/resources/logback-test.xml  | 20 ++++++++
 pulsar-common/src/test/resources/log4j.properties  | 19 +++++++
 .../src/test/resources/log4j.properties            | 19 +++++++
 .../src/test/resources/log4j.properties            | 19 +++++++
 .../src/main/resources/META-INF/aop.xml            | 20 ++++++++
 24 files changed, 460 insertions(+), 6 deletions(-)

commit a9a0afc1628d8463e77bf39016d3a2a6007da3db
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Mon Jun 26 16:24:32 2017 -0700

    cleanup yahoo test-url (#531)

 .../apache/pulsar/broker/loadbalance/SimpleLoadManagerImplTest.java   | 4 ++--
 pulsar-client-cpp/include/pulsar/Client.h                             | 2 +-
 pulsar-client-cpp/lib/ClientConnection.h                              | 4 ++--
 3 files changed, 5 insertions(+), 5 deletions(-)

commit fd3fb1dd9b51bed92e44b1033039a8fdc3feba89
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 26 10:53:38 2017 -0700

    Reduce default producer queue size from 30K to 1K also for Python (#522)

 docs/Python.md                     | 2 +-
 pulsar-client-cpp/python/pulsar.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 76a73e3a6a855b93d3f9f3f78a6bce4dd6cdbf30
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Sat Jun 24 18:50:03 2017 -0700

    Add managed-ledger admin tool to access ml binary information (#526)

 bin/proto/MLDataFormats_pb2.py  | 342 ++++++++++++++++++++++++++++++++++++++++
 bin/proto/__init__.py           |  18 +++
 bin/pulsar-managed-ledger-admin | 312 ++++++++++++++++++++++++++++++++++++
 pom.xml                         |   1 +
 4 files changed, 673 insertions(+)

commit c3a55b5fb995f4b409c6bb6b3b73f162427e9975
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jun 24 18:42:32 2017 -0700

    Changed version to 1.19-incubating-SNAPSHOT (#527)

 all/pom.xml                       | 2 +-
 managed-ledger/pom.xml            | 2 +-
 pom.xml                           | 2 +-
 pulsar-broker-auth-athenz/pom.xml | 2 +-
 pulsar-broker-common/pom.xml      | 2 +-
 pulsar-broker/pom.xml             | 2 +-
 pulsar-checksum/pom.xml           | 2 +-
 pulsar-client-admin/pom.xml       | 2 +-
 pulsar-client-auth-athenz/pom.xml | 2 +-
 pulsar-client-tools/pom.xml       | 2 +-
 pulsar-client/pom.xml             | 2 +-
 pulsar-common/pom.xml             | 2 +-
 pulsar-discovery-service/pom.xml  | 2 +-
 pulsar-spark/pom.xml              | 2 +-
 pulsar-storm/pom.xml              | 2 +-
 pulsar-testclient/pom.xml         | 2 +-
 pulsar-websocket/pom.xml          | 2 +-
 pulsar-zookeeper-utils/pom.xml    | 2 +-
 pulsar-zookeeper/pom.xml          | 2 +-
 19 files changed, 19 insertions(+), 19 deletions(-)

commit 9bf2a076b6b5171d78a360e5ba583686065c7408
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 23 15:15:20 2017 -0700

    Updated maven groupId from com.yahoo.pulsar to org.apache.pulsar (#525)

 README.md                         |  2 +-
 all/pom.xml                       | 10 +++++-----
 docs/GettingStarted.md            |  4 ++--
 docs/PulsarSpark.md               |  2 +-
 docs/PulsarStorm.md               |  2 +-
 docs/locale/ja/GettingStarted.md  |  4 ++--
 docs/locale/ja/PulsarSpark.md     |  2 +-
 docs/locale/ja/PulsarStorm.md     |  2 +-
 docs/locale/ja/README.md          |  2 +-
 managed-ledger/pom.xml            |  4 ++--
 pom.xml                           |  2 +-
 pulsar-broker-auth-athenz/pom.xml |  2 +-
 pulsar-broker-common/pom.xml      |  2 +-
 pulsar-broker/pom.xml             |  2 +-
 pulsar-checksum/pom.xml           |  2 +-
 pulsar-client-admin/pom.xml       |  2 +-
 pulsar-client-auth-athenz/pom.xml |  2 +-
 pulsar-client-tools/pom.xml       |  2 +-
 pulsar-client/pom.xml             |  6 +++---
 pulsar-common/pom.xml             |  4 ++--
 pulsar-discovery-service/pom.xml  |  4 ++--
 pulsar-spark/pom.xml              |  2 +-
 pulsar-storm/pom.xml              |  2 +-
 pulsar-testclient/pom.xml         |  2 +-
 pulsar-websocket/pom.xml          |  2 +-
 pulsar-zookeeper-utils/pom.xml    |  2 +-
 pulsar-zookeeper/pom.xml          |  2 +-
 27 files changed, 38 insertions(+), 38 deletions(-)

commit ac94698df6c66c4b84faa9f96db71f0019bf955e
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 23 13:37:07 2017 -0700

    Converted repo urls to apache/incubator-pulsar (#524)

 pom.xml                                           | 22 +++++++++++-----------
 pulsar-broker/src/test/resources/log4j.properties |  2 +-
 2 files changed, 12 insertions(+), 12 deletions(-)

commit bcb6b57100356b5113c7119eea7fbf06c0f2d36a
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 23 11:35:00 2017 -0700

    Updated references of github.com/yahoo/pulsar to github.com/apache/incubator-pulsar (#524)

 dashboard/README.md                             | 2 +-
 docs/Architecture.md                            | 2 +-
 docs/BinaryProtocol.md                          | 6 +++---
 docs/ClusterSetup.md                            | 2 +-
 docs/GettingStarted.md                          | 2 +-
 docs/locale/ja/BinaryProtocol.md                | 4 ++--
 docs/locale/ja/GettingStarted.md                | 2 +-
 docs/locale/ja/README.md                        | 2 +-
 pom.xml                                         | 8 ++++----
 pulsar-client-cpp/README.md                     | 2 +-
 pulsar-client/src/main/resources/ahc.properties | 2 +-
 11 files changed, 17 insertions(+), 17 deletions(-)

commit 251594ead95bfaa624b3eb2d7443a01da5ab5bcd
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 23 11:28:42 2017 -0700

    Renamed java package names in scripts and documentation (#524)

 bin/pulsar                                         | 14 ++--
 bin/pulsar-admin                                   |  2 +-
 bin/pulsar-client                                  |  2 +-
 bin/pulsar-perf                                    | 14 ++--
 conf/broker.conf                                   |  2 +-
 docs/AdminTools.md                                 |  2 +-
 docs/Authentication.md                             |  8 +-
 docs/ModularLoadManager.md                         | 38 ++++-----
 docs/PulsarSpark.md                                |  2 +-
 docs/PulsarStorm.md                                |  2 +-
 docs/SimulationTools.md                            |  6 +-
 docs/locale/ja/AdminTools.md                       |  2 +-
 docs/locale/ja/Authentication.md                   |  4 +-
 docs/locale/ja/PulsarSpark.md                      |  2 +-
 docs/locale/ja/PulsarStorm.md                      |  2 +-
 protobuf/README.md                                 |  2 +-
 protobuf/protobuf.patch                            | 20 ++---
 pulsar-broker/pom.xml                              |  2 +-
 .../configurations/pulsar_broker_test.conf         |  2 +-
 pulsar-client-admin/pom.xml                        |  2 +-
 pulsar-client-cpp/tests/authentication.conf        |  2 +-
 pulsar-client-cpp/tests/client.conf                |  2 +-
 pulsar-client/pom.xml                              | 26 +++----
 pulsar-client/src/main/resources/ahc.properties    | 90 +++++++++++-----------
 pulsar-client/src/test/resources/logback-test.xml  |  2 +-
 pulsar-common/src/main/proto/PulsarApi.proto       |  2 +-
 pulsar-discovery-service/readme.md                 |  4 +-
 pulsar-spark/pom.xml                               |  4 +-
 pulsar-storm/pom.xml                               |  2 +-
 .../src/main/resources/META-INF/aop.xml            |  6 +-
 src/findbugs-exclude.xml                           |  2 +-
 31 files changed, 136 insertions(+), 136 deletions(-)

commit 70da31b082ea0ff7466cdf740fc0d6b443d21861
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 23 11:22:49 2017 -0700

    Renamed Java packages from com.yahoo.pulsar to org.apache.pulsar (#524)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |     6 +-
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |     7 +-
 .../mledger/impl/ManagedLedgerBkTest.java          |     2 +-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |     6 +-
 .../AuthenticationProviderAthenz.java              |   119 -
 .../AuthenticationProviderAthenz.java              |   119 +
 .../AuthenticationProviderAthenzTest.java          |   122 -
 .../AuthenticationProviderAthenzTest.java          |   121 +
 .../yahoo/pulsar/broker/PulsarServerException.java |    38 -
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  1039 -
 .../pulsar/broker/ServiceConfigurationUtils.java   |    49 -
 .../authentication/AuthenticationDataCommand.java  |    88 -
 .../authentication/AuthenticationDataHttp.java     |    72 -
 .../authentication/AuthenticationDataHttps.java    |    48 -
 .../authentication/AuthenticationDataSource.java   |   120 -
 .../authentication/AuthenticationProvider.java     |    59 -
 .../authentication/AuthenticationProviderTls.java  |    92 -
 .../authentication/AuthenticationService.java      |   105 -
 .../broker/authorization/AuthorizationManager.java |   192 -
 .../broker/cache/ConfigurationCacheService.java    |   147 -
 .../pulsar/common/configuration/FieldContext.java  |    69 -
 .../common/configuration/PulsarConfiguration.java  |    28 -
 .../configuration/PulsarConfigurationLoader.java   |   130 -
 .../pulsar/broker/PulsarServerException.java       |    38 +
 .../apache/pulsar/broker/ServiceConfiguration.java |  1040 +
 .../pulsar/broker/ServiceConfigurationUtils.java   |    49 +
 .../authentication/AuthenticationDataCommand.java  |    88 +
 .../authentication/AuthenticationDataHttp.java     |    72 +
 .../authentication/AuthenticationDataHttps.java    |    48 +
 .../authentication/AuthenticationDataSource.java   |   120 +
 .../authentication/AuthenticationProvider.java     |    59 +
 .../authentication/AuthenticationProviderTls.java  |    92 +
 .../authentication/AuthenticationService.java      |   105 +
 .../broker/authorization/AuthorizationManager.java |   191 +
 .../broker/cache/ConfigurationCacheService.java    |   147 +
 .../pulsar/common/configuration/FieldContext.java  |    69 +
 .../common/configuration/PulsarConfiguration.java  |    28 +
 .../configuration/PulsarConfigurationLoader.java   |   130 +
 .../PulsarConfigurationLoaderTest.java             |   173 -
 .../PulsarConfigurationLoaderTest.java             |   174 +
 .../java/com/yahoo/pulsar/PulsarBrokerStarter.java |    74 -
 .../yahoo/pulsar/PulsarClusterMetadataSetup.java   |   148 -
 .../com/yahoo/pulsar/PulsarStandaloneStarter.java  |   201 -
 .../pulsar/broker/BookKeeperClientFactory.java     |    32 -
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |   101 -
 .../java/com/yahoo/pulsar/broker/BrokerData.java   |    70 -
 .../java/com/yahoo/pulsar/broker/BundleData.java   |    96 -
 .../java/com/yahoo/pulsar/broker/JSONWritable.java |    51 -
 .../com/yahoo/pulsar/broker/LocalBrokerData.java   |   374 -
 .../pulsar/broker/ManagedLedgerClientFactory.java  |    66 -
 .../broker/MessagingServiceShutdownHook.java       |   118 -
 .../com/yahoo/pulsar/broker/PulsarService.java     |   662 -
 .../yahoo/pulsar/broker/TimeAverageBrokerData.java |   171 -
 .../pulsar/broker/TimeAverageMessageData.java      |   164 -
 .../yahoo/pulsar/broker/admin/AdminResource.java   |   284 -
 .../com/yahoo/pulsar/broker/admin/BrokerStats.java |   187 -
 .../com/yahoo/pulsar/broker/admin/Brokers.java     |   189 -
 .../com/yahoo/pulsar/broker/admin/Clusters.java    |   387 -
 .../com/yahoo/pulsar/broker/admin/Namespaces.java  |  1331 --
 .../pulsar/broker/admin/PersistentTopics.java      |  1423 --
 .../com/yahoo/pulsar/broker/admin/Properties.java  |   210 -
 .../yahoo/pulsar/broker/admin/ResourceQuotas.java  |   180 -
 .../broker/cache/LocalZooKeeperCacheService.java   |   237 -
 .../pulsar/broker/cache/ResourceQuotaCache.java    |   232 -
 .../pulsar/broker/loadbalance/BrokerFilter.java    |    52 -
 .../BrokerFilterBadVersionException.java           |    33 -
 .../broker/loadbalance/BrokerFilterException.java  |    33 -
 .../pulsar/broker/loadbalance/BrokerHostUsage.java |    36 -
 .../pulsar/broker/loadbalance/LeaderBroker.java    |    65 -
 .../broker/loadbalance/LeaderElectionService.java  |   194 -
 .../pulsar/broker/loadbalance/LoadCalculator.java  |    31 -
 .../yahoo/pulsar/broker/loadbalance/LoadData.java  |    66 -
 .../pulsar/broker/loadbalance/LoadManager.java     |   144 -
 .../pulsar/broker/loadbalance/LoadRanker.java      |    25 -
 .../pulsar/broker/loadbalance/LoadReport.java      |    35 -
 .../broker/loadbalance/LoadReportUpdaterTask.java  |    46 -
 .../loadbalance/LoadResourceQuotaUpdaterTask.java  |    46 -
 .../broker/loadbalance/LoadSheddingStrategy.java   |    40 -
 .../broker/loadbalance/LoadSheddingTask.java       |    46 -
 .../broker/loadbalance/ModularLoadManager.java     |   103 -
 .../loadbalance/ModularLoadManagerStrategy.java    |    65 -
 .../broker/loadbalance/PlacementStrategy.java      |    27 -
 .../broker/loadbalance/ResourceDescription.java    |    38 -
 .../pulsar/broker/loadbalance/ResourceUnit.java    |    30 -
 .../pulsar/broker/loadbalance/ServiceRequest.java  |    23 -
 .../pulsar/broker/loadbalance/ServiceUnit.java     |    34 -
 .../loadbalance/impl/BrokerVersionFilter.java      |   155 -
 .../broker/loadbalance/impl/DeviationShedder.java  |   154 -
 .../impl/GenericBrokerHostUsageImpl.java           |    99 -
 .../loadbalance/impl/LeastLongTermMessageRate.java |   128 -
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java |   235 -
 .../broker/loadbalance/impl/LoadManagerShared.java |   252 -
 .../loadbalance/impl/ModularLoadManagerImpl.java   |   744 -
 .../impl/ModularLoadManagerWrapper.java            |   118 -
 .../broker/loadbalance/impl/OverloadShedder.java   |   109 -
 .../loadbalance/impl/PulsarLoadReportImpl.java     |    88 -
 .../impl/PulsarResourceDescription.java            |   108 -
 .../loadbalance/impl/PulsarServiceRequest.java     |   114 -
 .../broker/loadbalance/impl/PulsarServiceUnit.java |    73 -
 .../impl/ResourceAvailabilityRanker.java           |    88 -
 .../loadbalance/impl/SimpleLoadCalculatorImpl.java |    51 -
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  1445 --
 .../impl/SimpleResourceAllocationPolicies.java     |   112 -
 .../loadbalance/impl/SimpleResourceUnit.java       |    69 -
 .../loadbalance/impl/WRRPlacementStrategy.java     |    89 -
 .../pulsar/broker/lookup/DestinationLookup.java    |   258 -
 .../yahoo/pulsar/broker/lookup/LookupResult.java   |    73 -
 .../yahoo/pulsar/broker/lookup/NamespaceData.java  |    31 -
 .../yahoo/pulsar/broker/lookup/RedirectData.java   |    31 -
 .../broker/namespace/NamespaceEphemeralData.java   |    71 -
 .../pulsar/broker/namespace/NamespaceService.java  |   784 -
 .../yahoo/pulsar/broker/namespace/OwnedBundle.java |   154 -
 .../pulsar/broker/namespace/OwnershipCache.java    |   358 -
 .../broker/namespace/ServiceUnitZkUtils.java       |   234 -
 .../pulsar/broker/service/BacklogQuotaManager.java |   206 -
 .../yahoo/pulsar/broker/service/BrokerService.java |  1237 --
 .../broker/service/BrokerServiceException.java     |   150 -
 .../com/yahoo/pulsar/broker/service/Consumer.java  |   579 -
 .../yahoo/pulsar/broker/service/Dispatcher.java    |    73 -
 .../broker/service/DistributedIdGenerator.java     |    87 -
 .../com/yahoo/pulsar/broker/service/Producer.java  |   378 -
 .../broker/service/PulsarChannelInitializer.java   |    77 -
 .../yahoo/pulsar/broker/service/PulsarStats.java   |   193 -
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   879 -
 .../yahoo/pulsar/broker/service/Subscription.java  |    79 -
 .../com/yahoo/pulsar/broker/service/Topic.java     |    75 -
 .../PersistentDispatcherMultipleConsumers.java     |   645 -
 .../PersistentDispatcherSingleActiveConsumer.java  |   399 -
 .../persistent/PersistentMessageExpiryMonitor.java |   135 -
 .../persistent/PersistentMessageFinder.java        |   120 -
 .../service/persistent/PersistentReplicator.java   |   711 -
 .../service/persistent/PersistentSubscription.java |   650 -
 .../broker/service/persistent/PersistentTopic.java |  1361 --
 .../broker/stats/AllocatorStatsGenerator.java      |   116 -
 .../broker/stats/BookieClientStatsGenerator.java   |    72 -
 .../broker/stats/BrokerOperabilityMetrics.java     |    80 -
 .../broker/stats/ClusterReplicationMetrics.java    |    87 -
 .../pulsar/broker/stats/MBeanStatsGenerator.java   |   120 -
 .../pulsar/broker/stats/MetricsGenerator.java      |    80 -
 .../yahoo/pulsar/broker/stats/NamespaceStats.java  |    79 -
 .../pulsar/broker/stats/ReplicationMetrics.java    |    86 -
 .../yahoo/pulsar/broker/stats/TopicLoadStats.java  |    69 -
 .../broker/stats/metrics/AbstractMetrics.java      |   251 -
 .../pulsar/broker/stats/metrics/JvmMetrics.java    |   177 -
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |   101 -
 .../broker/stats/metrics/ManagedLedgerMetrics.java |   153 -
 .../stats/prometheus/AggregatedNamespaceStats.java |    68 -
 .../prometheus/AggregatedReplicationStats.java     |    36 -
 .../stats/prometheus/NamespaceStatsAggregator.java |   188 -
 .../prometheus/PrometheusMetricsGenerator.java     |   104 -
 .../stats/prometheus/PrometheusMetricsServlet.java |    86 -
 .../yahoo/pulsar/broker/web/ApiVersionFilter.java  |   145 -
 .../pulsar/broker/web/AuthenticationFilter.java    |    83 -
 .../pulsar/broker/web/NoSwaggerDocumentation.java  |    23 -
 .../pulsar/broker/web/PulsarServerConnector.java   |    68 -
 .../yahoo/pulsar/broker/web/PulsarWebResource.java |   615 -
 .../pulsar/broker/web/ResponseHandlerFilter.java   |    76 -
 .../com/yahoo/pulsar/broker/web/RestException.java |    71 -
 .../com/yahoo/pulsar/broker/web/VipStatus.java     |    48 -
 .../com/yahoo/pulsar/broker/web/WebService.java    |   231 -
 .../pulsar/common/naming/NamespaceBundle.java      |   136 -
 .../common/naming/NamespaceBundleFactory.java      |   259 -
 .../pulsar/common/naming/NamespaceBundles.java     |   138 -
 .../java/com/yahoo/pulsar/utils/CmdUtility.java    |    86 -
 .../yahoo/pulsar/utils/CopyOnWriteArrayList.java   |   124 -
 .../java/com/yahoo/pulsar/utils/NumberFormat.java  |    63 -
 .../utils/PulsarBrokerVersionStringUtils.java      |   104 -
 .../com/yahoo/pulsar/utils/PulsarKeyException.java |    35 -
 .../yahoo/pulsar/utils/SimpleTextOutputStream.java |   135 -
 .../com/yahoo/pulsar/utils/StatsOutputStream.java  |   130 -
 .../org/apache/pulsar/PulsarBrokerStarter.java     |    73 +
 .../apache/pulsar/PulsarClusterMetadataSetup.java  |   148 +
 .../org/apache/pulsar/PulsarStandaloneStarter.java |   201 +
 .../pulsar/broker/BookKeeperClientFactory.java     |    33 +
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |   101 +
 .../java/org/apache/pulsar/broker/BrokerData.java  |    70 +
 .../java/org/apache/pulsar/broker/BundleData.java  |    96 +
 .../org/apache/pulsar/broker/JSONWritable.java     |    52 +
 .../org/apache/pulsar/broker/LocalBrokerData.java  |   374 +
 .../pulsar/broker/ManagedLedgerClientFactory.java  |    67 +
 .../broker/MessagingServiceShutdownHook.java       |   118 +
 .../org/apache/pulsar/broker/PulsarService.java    |   665 +
 .../pulsar/broker/TimeAverageBrokerData.java       |   171 +
 .../pulsar/broker/TimeAverageMessageData.java      |   164 +
 .../apache/pulsar/broker/admin/AdminResource.java  |   284 +
 .../apache/pulsar/broker/admin/BrokerStats.java    |   186 +
 .../org/apache/pulsar/broker/admin/Brokers.java    |   189 +
 .../org/apache/pulsar/broker/admin/Clusters.java   |   387 +
 .../org/apache/pulsar/broker/admin/Namespaces.java |  1331 ++
 .../pulsar/broker/admin/PersistentTopics.java      |  1422 ++
 .../org/apache/pulsar/broker/admin/Properties.java |   210 +
 .../apache/pulsar/broker/admin/ResourceQuotas.java |   180 +
 .../broker/cache/LocalZooKeeperCacheService.java   |   236 +
 .../pulsar/broker/cache/ResourceQuotaCache.java    |   232 +
 .../pulsar/broker/loadbalance/BrokerFilter.java    |    52 +
 .../BrokerFilterBadVersionException.java           |    33 +
 .../broker/loadbalance/BrokerFilterException.java  |    33 +
 .../pulsar/broker/loadbalance/BrokerHostUsage.java |    37 +
 .../pulsar/broker/loadbalance/LeaderBroker.java    |    65 +
 .../broker/loadbalance/LeaderElectionService.java  |   194 +
 .../pulsar/broker/loadbalance/LoadCalculator.java  |    31 +
 .../apache/pulsar/broker/loadbalance/LoadData.java |    66 +
 .../pulsar/broker/loadbalance/LoadManager.java     |   143 +
 .../pulsar/broker/loadbalance/LoadRanker.java      |    25 +
 .../pulsar/broker/loadbalance/LoadReport.java      |    35 +
 .../broker/loadbalance/LoadReportUpdaterTask.java  |    46 +
 .../loadbalance/LoadResourceQuotaUpdaterTask.java  |    46 +
 .../broker/loadbalance/LoadSheddingStrategy.java   |    40 +
 .../broker/loadbalance/LoadSheddingTask.java       |    46 +
 .../broker/loadbalance/ModularLoadManager.java     |   103 +
 .../loadbalance/ModularLoadManagerStrategy.java    |    65 +
 .../broker/loadbalance/PlacementStrategy.java      |    27 +
 .../broker/loadbalance/ResourceDescription.java    |    38 +
 .../pulsar/broker/loadbalance/ResourceUnit.java    |    30 +
 .../pulsar/broker/loadbalance/ServiceRequest.java  |    23 +
 .../pulsar/broker/loadbalance/ServiceUnit.java     |    34 +
 .../loadbalance/impl/BrokerVersionFilter.java      |   154 +
 .../broker/loadbalance/impl/DeviationShedder.java  |   153 +
 .../impl/GenericBrokerHostUsageImpl.java           |   100 +
 .../loadbalance/impl/LeastLongTermMessageRate.java |   127 +
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java |   236 +
 .../broker/loadbalance/impl/LoadManagerShared.java |   251 +
 .../loadbalance/impl/ModularLoadManagerImpl.java   |   743 +
 .../impl/ModularLoadManagerWrapper.java            |   118 +
 .../broker/loadbalance/impl/OverloadShedder.java   |   108 +
 .../loadbalance/impl/PulsarLoadReportImpl.java     |    88 +
 .../impl/PulsarResourceDescription.java            |   108 +
 .../loadbalance/impl/PulsarServiceRequest.java     |   114 +
 .../broker/loadbalance/impl/PulsarServiceUnit.java |    73 +
 .../impl/ResourceAvailabilityRanker.java           |    87 +
 .../loadbalance/impl/SimpleLoadCalculatorImpl.java |    52 +
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  1445 ++
 .../impl/SimpleResourceAllocationPolicies.java     |   111 +
 .../loadbalance/impl/SimpleResourceUnit.java       |    69 +
 .../loadbalance/impl/WRRPlacementStrategy.java     |    89 +
 .../pulsar/broker/lookup/DestinationLookup.java    |   257 +
 .../apache/pulsar/broker/lookup/LookupResult.java  |    73 +
 .../apache/pulsar/broker/lookup/NamespaceData.java |    31 +
 .../apache/pulsar/broker/lookup/RedirectData.java  |    31 +
 .../broker/namespace/NamespaceEphemeralData.java   |    71 +
 .../pulsar/broker/namespace/NamespaceService.java  |   784 +
 .../pulsar/broker/namespace/OwnedBundle.java       |   153 +
 .../pulsar/broker/namespace/OwnershipCache.java    |   358 +
 .../broker/namespace/ServiceUnitZkUtils.java       |   234 +
 .../pulsar/broker/service/BacklogQuotaManager.java |   206 +
 .../pulsar/broker/service/BrokerService.java       |  1237 ++
 .../broker/service/BrokerServiceException.java     |   150 +
 .../org/apache/pulsar/broker/service/Consumer.java |   579 +
 .../apache/pulsar/broker/service/Dispatcher.java   |    73 +
 .../broker/service/DistributedIdGenerator.java     |    87 +
 .../org/apache/pulsar/broker/service/Producer.java |   378 +
 .../broker/service/PulsarChannelInitializer.java   |    77 +
 .../apache/pulsar/broker/service/PulsarStats.java  |   193 +
 .../apache/pulsar/broker/service/ServerCnx.java    |   879 +
 .../apache/pulsar/broker/service/Subscription.java |    78 +
 .../org/apache/pulsar/broker/service/Topic.java    |    75 +
 .../PersistentDispatcherMultipleConsumers.java     |   645 +
 .../PersistentDispatcherSingleActiveConsumer.java  |   398 +
 .../persistent/PersistentMessageExpiryMonitor.java |   134 +
 .../persistent/PersistentMessageFinder.java        |   119 +
 .../service/persistent/PersistentReplicator.java   |   710 +
 .../service/persistent/PersistentSubscription.java |   650 +
 .../broker/service/persistent/PersistentTopic.java |  1361 ++
 .../broker/stats/AllocatorStatsGenerator.java      |   116 +
 .../broker/stats/BookieClientStatsGenerator.java   |    72 +
 .../broker/stats/BrokerOperabilityMetrics.java     |    81 +
 .../broker/stats/ClusterReplicationMetrics.java    |    87 +
 .../pulsar/broker/stats/MBeanStatsGenerator.java   |   121 +
 .../pulsar/broker/stats/MetricsGenerator.java      |    81 +
 .../apache/pulsar/broker/stats/NamespaceStats.java |    80 +
 .../pulsar/broker/stats/ReplicationMetrics.java    |    88 +
 .../apache/pulsar/broker/stats/TopicLoadStats.java |    69 +
 .../broker/stats/metrics/AbstractMetrics.java      |   251 +
 .../pulsar/broker/stats/metrics/JvmMetrics.java    |   177 +
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |   101 +
 .../broker/stats/metrics/ManagedLedgerMetrics.java |   153 +
 .../stats/prometheus/AggregatedNamespaceStats.java |    68 +
 .../prometheus/AggregatedReplicationStats.java     |    36 +
 .../stats/prometheus/NamespaceStatsAggregator.java |   187 +
 .../prometheus/PrometheusMetricsGenerator.java     |   103 +
 .../stats/prometheus/PrometheusMetricsServlet.java |    85 +
 .../apache/pulsar/broker/web/ApiVersionFilter.java |   144 +
 .../pulsar/broker/web/AuthenticationFilter.java    |    82 +
 .../pulsar/broker/web/NoSwaggerDocumentation.java  |    23 +
 .../pulsar/broker/web/PulsarServerConnector.java   |    68 +
 .../pulsar/broker/web/PulsarWebResource.java       |   615 +
 .../pulsar/broker/web/ResponseHandlerFilter.java   |    75 +
 .../apache/pulsar/broker/web/RestException.java    |    71 +
 .../org/apache/pulsar/broker/web/VipStatus.java    |    48 +
 .../org/apache/pulsar/broker/web/WebService.java   |   231 +
 .../pulsar/common/naming/NamespaceBundle.java      |   138 +
 .../common/naming/NamespaceBundleFactory.java      |   260 +
 .../pulsar/common/naming/NamespaceBundles.java     |   139 +
 .../java/org/apache/pulsar/utils/CmdUtility.java   |    86 +
 .../apache/pulsar/utils/CopyOnWriteArrayList.java  |   124 +
 .../java/org/apache/pulsar/utils/NumberFormat.java |    63 +
 .../utils/PulsarBrokerVersionStringUtils.java      |   104 +
 .../apache/pulsar/utils/PulsarKeyException.java    |    35 +
 .../pulsar/utils/SimpleTextOutputStream.java       |   135 +
 .../org/apache/pulsar/utils/StatsOutputStream.java |   130 +
 .../com/yahoo/pulsar/PulsarBrokerStarterTest.java  |   274 -
 .../com/yahoo/pulsar/broker/SLAMonitoringTest.java |   245 -
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |  1814 --
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |   624 -
 .../pulsar/broker/admin/MockServletContext.java    |   333 -
 .../yahoo/pulsar/broker/admin/NamespacesTest.java  |  1140 --
 .../broker/auth/AuthenticationServiceTest.java     |    90 -
 .../pulsar/broker/auth/AuthorizationTest.java      |   108 -
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   237 -
 .../broker/auth/SameThreadOrderedSafeExecutor.java |    49 -
 .../broker/cache/ResourceQuotaCacheTest.java       |   109 -
 .../loadbalance/BrokerVersionFilterTest.java       |    82 -
 .../broker/loadbalance/LoadBalancerTest.java       |  1021 -
 .../loadbalance/LoadBalancerTestingUtils.java      |    43 -
 .../loadbalance/ModularLoadManagerImplTest.java    |   406 -
 .../ModularLoadManagerStrategyTest.java            |    69 -
 .../loadbalance/SimpleLoadManagerImplTest.java     |   531 -
 .../lookup/http/HttpDestinationLookupv2Test.java   |   223 -
 .../broker/namespace/NamespaceServiceTest.java     |   351 -
 .../broker/namespace/OwnershipCacheTest.java       |   297 -
 .../broker/service/AddMissingPatchVersionTest.java |    44 -
 .../broker/service/AdvertisedAddressTest.java      |    79 -
 .../broker/service/BacklogQuotaManagerTest.java    |   608 -
 .../pulsar/broker/service/BatchMessageTest.java    |   598 -
 .../pulsar/broker/service/BrokerServiceTest.java   |   824 -
 .../service/BrokerServiceThrottlingTest.java       |   274 -
 .../pulsar/broker/service/BrokerTestBase.java      |    75 -
 .../broker/service/DistributedIdGeneratorTest.java |   127 -
 .../broker/service/MessageIdSerialization.java     |    56 -
 .../PersistentDispatcherFailoverConsumerTest.java  |   453 -
 .../broker/service/PersistentFailoverE2ETest.java  |   436 -
 .../service/PersistentMessageFinderTest.java       |   192 -
 .../broker/service/PersistentQueueE2ETest.java     |   518 -
 .../service/PersistentTopicConcurrentTest.java     |   348 -
 .../broker/service/PersistentTopicE2ETest.java     |  1217 --
 .../pulsar/broker/service/PersistentTopicTest.java |   951 -
 .../pulsar/broker/service/ReplicatorTest.java      |   813 -
 .../pulsar/broker/service/ReplicatorTestBase.java  |   362 -
 .../pulsar/broker/service/ResendRequestTest.java   |   717 -
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  1313 --
 .../broker/service/TopicTerminationTest.java       |   344 -
 .../broker/service/utils/ClientChannelHelper.java  |   150 -
 .../stats/BookieClientsStatsGeneratorTest.java     |    88 -
 .../broker/stats/ManagedLedgerMetricsTest.java     |    92 -
 .../pulsar/broker/web/ApiVersionFilterTest.java    |   183 -
 .../yahoo/pulsar/broker/web/WebServiceTest.java    |   346 -
 .../ZooKeeperSessionExpireRecoveryTest.java        |    70 -
 .../api/AuthenticatedProducerConsumerTest.java     |   236 -
 .../pulsar/client/api/BrokerServiceLookupTest.java |   762 -
 .../yahoo/pulsar/client/api/ClientErrorsTest.java  |   661 -
 .../client/api/DispatcherBlockConsumerTest.java    |  1054 -
 .../yahoo/pulsar/client/api/MockBrokerService.java |   434 -
 .../pulsar/client/api/MockBrokerServiceHooks.java  |    72 -
 .../api/PartitionedProducerConsumerTest.java       |   556 -
 .../pulsar/client/api/ProducerConsumerBase.java    |    57 -
 .../client/api/SimpleProducerConsumerStatTest.java |   381 -
 .../client/api/SimpleProducerConsumerTest.java     |  2041 --
 .../pulsar/client/api/TlsProducerConsumerTest.java |   124 -
 .../yahoo/pulsar/client/api/TopicReaderTest.java   |   242 -
 .../impl/BatchMessageIdImplSerializationTest.java  |    57 -
 .../client/impl/BrokerClientIntegrationTest.java   |   667 -
 .../client/impl/ConsumeBaseExceptionTest.java      |    82 -
 .../yahoo/pulsar/client/impl/MessageIdTest.java    |   508 -
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   454 -
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |   407 -
 .../pulsar/client/impl/ZeroQueueSizeTest.java      |   261 -
 .../pulsar/common/naming/NamespaceBundleTest.java  |   199 -
 .../pulsar/common/naming/NamespaceBundlesTest.java |   281 -
 .../common/naming/ServiceConfigurationTest.java    |    90 -
 .../service/web/DiscoveryServiceWebTest.java       |   147 -
 .../stats/client/PulsarBrokerStatsClientTest.java  |    79 -
 .../pulsar/utils/SimpleTextOutputStreamTest.java   |   119 -
 .../yahoo/pulsar/utils/StatsOutputStreamTest.java  |   226 -
 .../proxy/MockAuthenticationProvider.java          |    54 -
 .../websocket/proxy/ProxyAuthenticationTest.java   |   139 -
 .../websocket/proxy/ProxyAuthorizationTest.java    |   127 -
 .../websocket/proxy/ProxyPublishConsumeTest.java   |   295 -
 .../websocket/proxy/ProxyPublishConsumeTls.java    |   160 -
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    |   131 -
 .../websocket/proxy/SimpleConsumerSocket.java      |   102 -
 .../websocket/proxy/SimpleProducerSocket.java      |   106 -
 .../org/apache/pulsar/PulsarBrokerStarterTest.java |   275 +
 .../apache/pulsar/broker/SLAMonitoringTest.java    |   247 +
 .../apache/pulsar/broker/admin/AdminApiTest.java   |  1814 ++
 .../org/apache/pulsar/broker/admin/AdminTest.java  |   631 +
 .../pulsar/broker/admin/MockServletContext.java    |   333 +
 .../apache/pulsar/broker/admin/NamespacesTest.java |  1143 ++
 .../broker/auth/AuthenticationServiceTest.java     |    90 +
 .../pulsar/broker/auth/AuthorizationTest.java      |   108 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   237 +
 .../broker/auth/SameThreadOrderedSafeExecutor.java |    49 +
 .../broker/cache/ResourceQuotaCacheTest.java       |   109 +
 .../loadbalance/BrokerVersionFilterTest.java       |    84 +
 .../broker/loadbalance/LoadBalancerTest.java       |  1026 +
 .../loadbalance/LoadBalancerTestingUtils.java      |    44 +
 .../loadbalance/ModularLoadManagerImplTest.java    |   407 +
 .../ModularLoadManagerStrategyTest.java            |    70 +
 .../loadbalance/SimpleLoadManagerImplTest.java     |   538 +
 .../lookup/http/HttpDestinationLookupv2Test.java   |   223 +
 .../broker/namespace/NamespaceServiceTest.java     |   355 +
 .../broker/namespace/OwnershipCacheTest.java       |   302 +
 .../broker/service/AddMissingPatchVersionTest.java |    44 +
 .../broker/service/AdvertisedAddressTest.java      |    79 +
 .../broker/service/BacklogQuotaManagerTest.java    |   608 +
 .../pulsar/broker/service/BatchMessageTest.java    |   598 +
 .../pulsar/broker/service/BrokerServiceTest.java   |   827 +
 .../service/BrokerServiceThrottlingTest.java       |   275 +
 .../pulsar/broker/service/BrokerTestBase.java      |    75 +
 .../broker/service/DistributedIdGeneratorTest.java |   127 +
 .../broker/service/MessageIdSerialization.java     |    55 +
 .../PersistentDispatcherFailoverConsumerTest.java  |   452 +
 .../broker/service/PersistentFailoverE2ETest.java  |   436 +
 .../service/PersistentMessageFinderTest.java       |   191 +
 .../broker/service/PersistentQueueE2ETest.java     |   518 +
 .../service/PersistentTopicConcurrentTest.java     |   348 +
 .../broker/service/PersistentTopicE2ETest.java     |  1218 ++
 .../pulsar/broker/service/PersistentTopicTest.java |   956 +
 .../pulsar/broker/service/ReplicatorTest.java      |   813 +
 .../pulsar/broker/service/ReplicatorTestBase.java  |   363 +
 .../pulsar/broker/service/ResendRequestTest.java   |   716 +
 .../pulsar/broker/service/ServerCnxTest.java       |  1315 ++
 .../broker/service/TopicTerminationTest.java       |   343 +
 .../broker/service/utils/ClientChannelHelper.java  |   151 +
 .../stats/BookieClientsStatsGeneratorTest.java     |    87 +
 .../broker/stats/ManagedLedgerMetricsTest.java     |    91 +
 .../pulsar/broker/web/ApiVersionFilterTest.java    |   185 +
 .../apache/pulsar/broker/web/WebServiceTest.java   |   347 +
 .../ZooKeeperSessionExpireRecoveryTest.java        |    70 +
 .../api/AuthenticatedProducerConsumerTest.java     |   244 +
 .../pulsar/client/api/BrokerServiceLookupTest.java |   773 +
 .../apache/pulsar/client/api/ClientErrorsTest.java |   667 +
 .../client/api/DispatcherBlockConsumerTest.java    |  1062 +
 .../pulsar/client/api/MockBrokerService.java       |   434 +
 .../pulsar/client/api/MockBrokerServiceHooks.java  |    72 +
 .../api/PartitionedProducerConsumerTest.java       |   564 +
 .../pulsar/client/api/ProducerConsumerBase.java    |    57 +
 .../client/api/SimpleProducerConsumerStatTest.java |   389 +
 .../client/api/SimpleProducerConsumerTest.java     |  2051 ++
 .../pulsar/client/api/TlsProducerConsumerTest.java |   131 +
 .../apache/pulsar/client/api/TopicReaderTest.java  |   248 +
 .../impl/BatchMessageIdImplSerializationTest.java  |    56 +
 .../client/impl/BrokerClientIntegrationTest.java   |   672 +
 .../client/impl/ConsumeBaseExceptionTest.java      |    81 +
 .../apache/pulsar/client/impl/MessageIdTest.java   |   513 +
 .../PerMessageUnAcknowledgedRedeliveryTest.java    |   455 +
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |   408 +
 .../pulsar/client/impl/ZeroQueueSizeTest.java      |   260 +
 .../pulsar/common/naming/NamespaceBundleTest.java  |   199 +
 .../pulsar/common/naming/NamespaceBundlesTest.java |   286 +
 .../common/naming/ServiceConfigurationTest.java    |    89 +
 .../service/web/DiscoveryServiceWebTest.java       |   147 +
 .../stats/client/PulsarBrokerStatsClientTest.java  |    78 +
 .../pulsar/utils/SimpleTextOutputStreamTest.java   |   121 +
 .../apache/pulsar/utils/StatsOutputStreamTest.java |   228 +
 .../proxy/MockAuthenticationProvider.java          |    54 +
 .../websocket/proxy/ProxyAuthenticationTest.java   |   139 +
 .../websocket/proxy/ProxyAuthorizationTest.java    |   127 +
 .../websocket/proxy/ProxyPublishConsumeTest.java   |   295 +
 .../websocket/proxy/ProxyPublishConsumeTls.java    |   159 +
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    |   130 +
 .../websocket/proxy/SimpleConsumerSocket.java      |   102 +
 .../websocket/proxy/SimpleProducerSocket.java      |   107 +
 .../java/com/scurrilous/circe/crc/Sse42Crc32C.java |     3 +-
 .../pulsar/checksum/utils/Crc32cChecksum.java      |    85 -
 .../pulsar/checksum/utils/Crc32cSse42Provider.java |    62 -
 .../yahoo/pulsar/checksum/utils/NativeUtils.java   |   101 -
 .../pulsar/checksum/utils/Crc32cChecksum.java      |    85 +
 .../pulsar/checksum/utils/Crc32cSse42Provider.java |    62 +
 .../apache/pulsar/checksum/utils/NativeUtils.java  |   101 +
 .../pulsar/checksum/utils/Crc32cChecksumTest.java  |    56 -
 .../pulsar/checksum/utils/NativeUtilsTests.java    |    47 -
 .../pulsar/checksum/utils/Crc32cChecksumTest.java  |    55 +
 .../pulsar/checksum/utils/NativeUtilsTests.java    |    48 +
 .../com/yahoo/pulsar/client/admin/BrokerStats.java |    63 -
 .../com/yahoo/pulsar/client/admin/Brokers.java     |   101 -
 .../com/yahoo/pulsar/client/admin/Clusters.java    |   267 -
 .../java/com/yahoo/pulsar/client/admin/Lookup.java |    34 -
 .../com/yahoo/pulsar/client/admin/Namespaces.java  |   765 -
 .../pulsar/client/admin/PersistentTopics.java      |   805 -
 .../com/yahoo/pulsar/client/admin/Properties.java  |   128 -
 .../com/yahoo/pulsar/client/admin/PulsarAdmin.java |   294 -
 .../pulsar/client/admin/PulsarAdminException.java  |   161 -
 .../yahoo/pulsar/client/admin/ResourceQuotas.java  |   200 -
 .../pulsar/client/admin/internal/BaseResource.java |   190 -
 .../client/admin/internal/BrokerStatsImpl.java     |   115 -
 .../pulsar/client/admin/internal/BrokersImpl.java  |    94 -
 .../pulsar/client/admin/internal/ClustersImpl.java |   141 -
 .../client/admin/internal/JacksonConfigurator.java |    43 -
 .../pulsar/client/admin/internal/LookupImpl.java   |    68 -
 .../client/admin/internal/NamespacesImpl.java      |   426 -
 .../admin/internal/PersistentTopicsImpl.java       |   700 -
 .../client/admin/internal/PropertiesImpl.java      |    91 -
 .../client/admin/internal/ResourceQuotasImpl.java  |    91 -
 .../apache/pulsar/client/admin/BrokerStats.java    |    63 +
 .../org/apache/pulsar/client/admin/Brokers.java    |   101 +
 .../org/apache/pulsar/client/admin/Clusters.java   |   267 +
 .../org/apache/pulsar/client/admin/Lookup.java     |    34 +
 .../org/apache/pulsar/client/admin/Namespaces.java |   765 +
 .../pulsar/client/admin/PersistentTopics.java      |   805 +
 .../org/apache/pulsar/client/admin/Properties.java |   128 +
 .../apache/pulsar/client/admin/PulsarAdmin.java    |   293 +
 .../pulsar/client/admin/PulsarAdminException.java  |   161 +
 .../apache/pulsar/client/admin/ResourceQuotas.java |   200 +
 .../pulsar/client/admin/internal/BaseResource.java |   189 +
 .../client/admin/internal/BrokerStatsImpl.java     |   115 +
 .../pulsar/client/admin/internal/BrokersImpl.java  |    94 +
 .../pulsar/client/admin/internal/ClustersImpl.java |   141 +
 .../client/admin/internal/JacksonConfigurator.java |    44 +
 .../pulsar/client/admin/internal/LookupImpl.java   |    68 +
 .../client/admin/internal/NamespacesImpl.java      |   426 +
 .../admin/internal/PersistentTopicsImpl.java       |   700 +
 .../client/admin/internal/PropertiesImpl.java      |    91 +
 .../client/admin/internal/ResourceQuotasImpl.java  |    91 +
 .../client/impl/auth/AuthenticationAthenz.java     |   110 -
 .../client/impl/auth/AuthenticationDataAthenz.java |    62 -
 .../client/impl/auth/AuthenticationAthenz.java     |   112 +
 .../client/impl/auth/AuthenticationDataAthenz.java |    63 +
 .../client/impl/auth/AuthenticationAthenzTest.java |   114 -
 .../client/impl/auth/AuthenticationAthenzTest.java |   115 +
 .../com/yahoo/pulsar/admin/cli/CliCommand.java     |   140 -
 .../java/com/yahoo/pulsar/admin/cli/CmdBase.java   |    84 -
 .../com/yahoo/pulsar/admin/cli/CmdBrokerStats.java |   134 -
 .../com/yahoo/pulsar/admin/cli/CmdBrokers.java     |    93 -
 .../com/yahoo/pulsar/admin/cli/CmdClusters.java    |   116 -
 .../admin/cli/CmdNamespaceIsolationPolicy.java     |   199 -
 .../com/yahoo/pulsar/admin/cli/CmdNamespaces.java  |   533 -
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   490 -
 .../com/yahoo/pulsar/admin/cli/CmdProperties.java  |   114 -
 .../yahoo/pulsar/admin/cli/CmdResourceQuotas.java  |   132 -
 .../yahoo/pulsar/admin/cli/PulsarAdminTool.java    |   167 -
 .../com/yahoo/pulsar/admin/cli/utils/IOUtils.java  |    81 -
 .../cli/utils/NameValueParameterSplitter.java      |    62 -
 .../com/yahoo/pulsar/client/cli/CmdConsume.java    |   162 -
 .../com/yahoo/pulsar/client/cli/CmdProduce.java    |   198 -
 .../yahoo/pulsar/client/cli/PulsarClientTool.java  |   173 -
 .../org/apache/pulsar/admin/cli/CliCommand.java    |   141 +
 .../java/org/apache/pulsar/admin/cli/CmdBase.java  |    85 +
 .../apache/pulsar/admin/cli/CmdBrokerStats.java    |   135 +
 .../org/apache/pulsar/admin/cli/CmdBrokers.java    |    94 +
 .../org/apache/pulsar/admin/cli/CmdClusters.java   |   117 +
 .../admin/cli/CmdNamespaceIsolationPolicy.java     |   200 +
 .../org/apache/pulsar/admin/cli/CmdNamespaces.java |   534 +
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   491 +
 .../org/apache/pulsar/admin/cli/CmdProperties.java |   115 +
 .../apache/pulsar/admin/cli/CmdResourceQuotas.java |   133 +
 .../apache/pulsar/admin/cli/PulsarAdminTool.java   |   167 +
 .../org/apache/pulsar/admin/cli/utils/IOUtils.java |    81 +
 .../cli/utils/NameValueParameterSplitter.java      |    62 +
 .../org/apache/pulsar/client/cli/CmdConsume.java   |   162 +
 .../org/apache/pulsar/client/cli/CmdProduce.java   |   198 +
 .../apache/pulsar/client/cli/PulsarClientTool.java |   173 +
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   431 -
 .../yahoo/pulsar/admin/cli/utils/IOUtilsTest.java  |   146 -
 .../cli/utils/NameValueParameterSplitterTest.java  |    54 -
 .../pulsar/client/cli/PulsarClientToolTest.java    |    85 -
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   438 +
 .../apache/pulsar/admin/cli/utils/IOUtilsTest.java |   147 +
 .../cli/utils/NameValueParameterSplitterTest.java  |    55 +
 .../pulsar/client/cli/PulsarClientToolTest.java    |    85 +
 .../yahoo/pulsar/client/api/Authentication.java    |    53 -
 .../client/api/AuthenticationDataProvider.java     |   110 -
 .../pulsar/client/api/AuthenticationFactory.java   |    81 -
 .../pulsar/client/api/ClientConfiguration.java     |   359 -
 .../yahoo/pulsar/client/api/CompressionType.java   |    30 -
 .../java/com/yahoo/pulsar/client/api/Consumer.java |   242 -
 .../pulsar/client/api/ConsumerConfiguration.java   |   207 -
 .../java/com/yahoo/pulsar/client/api/Message.java  |    92 -
 .../yahoo/pulsar/client/api/MessageBuilder.java    |   111 -
 .../com/yahoo/pulsar/client/api/MessageId.java     |    54 -
 .../yahoo/pulsar/client/api/MessageListener.java   |    54 -
 .../com/yahoo/pulsar/client/api/MessageRouter.java |    33 -
 .../java/com/yahoo/pulsar/client/api/Producer.java |   140 -
 .../pulsar/client/api/ProducerConfiguration.java   |   309 -
 .../com/yahoo/pulsar/client/api/PulsarClient.java  |   248 -
 .../pulsar/client/api/PulsarClientException.java   |   187 -
 .../java/com/yahoo/pulsar/client/api/Reader.java   |    65 -
 .../pulsar/client/api/ReaderConfiguration.java     |   100 -
 .../yahoo/pulsar/client/api/ReaderListener.java    |    52 -
 .../yahoo/pulsar/client/api/SubscriptionType.java  |    43 -
 .../java/com/yahoo/pulsar/client/impl/Backoff.java |    75 -
 .../pulsar/client/impl/BatchMessageContainer.java  |   147 -
 .../pulsar/client/impl/BatchMessageIdImpl.java     |    77 -
 .../client/impl/BinaryProtoLookupService.java      |   196 -
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |   510 -
 .../yahoo/pulsar/client/impl/ConnectionPool.java   |   204 -
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |   324 -
 .../com/yahoo/pulsar/client/impl/ConsumerId.java   |    61 -
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  1108 --
 .../yahoo/pulsar/client/impl/ConsumerStats.java    |   245 -
 .../pulsar/client/impl/ConsumerStatsDisabled.java  |    46 -
 .../com/yahoo/pulsar/client/impl/HandlerBase.java  |   193 -
 .../com/yahoo/pulsar/client/impl/HttpClient.java   |   208 -
 .../pulsar/client/impl/HttpLookupService.java      |    95 -
 .../yahoo/pulsar/client/impl/LookupService.java    |    64 -
 .../pulsar/client/impl/MessageBuilderImpl.java     |   100 -
 .../yahoo/pulsar/client/impl/MessageIdImpl.java    |   154 -
 .../com/yahoo/pulsar/client/impl/MessageImpl.java  |   253 -
 .../client/impl/PartitionedConsumerImpl.java       |   460 -
 .../client/impl/PartitionedProducerImpl.java       |   197 -
 .../com/yahoo/pulsar/client/impl/ProducerBase.java |   107 -
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java |  1165 --
 .../yahoo/pulsar/client/impl/ProducerStats.java    |   258 -
 .../pulsar/client/impl/ProducerStatsDisabled.java  |    44 -
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |   495 -
 .../com/yahoo/pulsar/client/impl/ReaderImpl.java   |   132 -
 .../impl/RoundRobinPartitionMessageRouterImpl.java |    47 -
 .../com/yahoo/pulsar/client/impl/SendCallback.java |    56 -
 .../impl/SinglePartitionMessageRouterImpl.java     |    46 -
 .../pulsar/client/impl/UnAckedMessageTracker.java  |   206 -
 .../client/impl/auth/AuthenticationDataNull.java   |    25 -
 .../client/impl/auth/AuthenticationDataTls.java    |    63 -
 .../client/impl/auth/AuthenticationDisabled.java   |    61 -
 .../pulsar/client/impl/auth/AuthenticationTls.java |    70 -
 .../yahoo/pulsar/client/util/ExecutorProvider.java |    55 -
 .../com/yahoo/pulsar/client/util/FutureUtil.java   |    73 -
 .../apache/pulsar/client/api/Authentication.java   |    53 +
 .../client/api/AuthenticationDataProvider.java     |   110 +
 .../pulsar/client/api/AuthenticationFactory.java   |    82 +
 .../pulsar/client/api/ClientConfiguration.java     |   359 +
 .../apache/pulsar/client/api/CompressionType.java  |    30 +
 .../org/apache/pulsar/client/api/Consumer.java     |   242 +
 .../pulsar/client/api/ConsumerConfiguration.java   |   207 +
 .../java/org/apache/pulsar/client/api/Message.java |    92 +
 .../apache/pulsar/client/api/MessageBuilder.java   |   111 +
 .../org/apache/pulsar/client/api/MessageId.java    |    54 +
 .../apache/pulsar/client/api/MessageListener.java  |    54 +
 .../apache/pulsar/client/api/MessageRouter.java    |    33 +
 .../org/apache/pulsar/client/api/Producer.java     |   140 +
 .../pulsar/client/api/ProducerConfiguration.java   |   310 +
 .../org/apache/pulsar/client/api/PulsarClient.java |   248 +
 .../pulsar/client/api/PulsarClientException.java   |   187 +
 .../java/org/apache/pulsar/client/api/Reader.java  |    65 +
 .../pulsar/client/api/ReaderConfiguration.java     |   100 +
 .../apache/pulsar/client/api/ReaderListener.java   |    52 +
 .../apache/pulsar/client/api/SubscriptionType.java |    43 +
 .../org/apache/pulsar/client/impl/Backoff.java     |    75 +
 .../pulsar/client/impl/BatchMessageContainer.java  |   147 +
 .../pulsar/client/impl/BatchMessageIdImpl.java     |    77 +
 .../client/impl/BinaryProtoLookupService.java      |   195 +
 .../org/apache/pulsar/client/impl/ClientCnx.java   |   509 +
 .../apache/pulsar/client/impl/ConnectionPool.java  |   203 +
 .../apache/pulsar/client/impl/ConsumerBase.java    |   324 +
 .../org/apache/pulsar/client/impl/ConsumerId.java  |    61 +
 .../apache/pulsar/client/impl/ConsumerImpl.java    |  1108 ++
 .../apache/pulsar/client/impl/ConsumerStats.java   |   245 +
 .../pulsar/client/impl/ConsumerStatsDisabled.java  |    46 +
 .../org/apache/pulsar/client/impl/HandlerBase.java |   192 +
 .../org/apache/pulsar/client/impl/HttpClient.java  |   209 +
 .../pulsar/client/impl/HttpLookupService.java      |    94 +
 .../apache/pulsar/client/impl/LookupService.java   |    64 +
 .../pulsar/client/impl/MessageBuilderImpl.java     |   101 +
 .../apache/pulsar/client/impl/MessageIdImpl.java   |   155 +
 .../org/apache/pulsar/client/impl/MessageImpl.java |   254 +
 .../client/impl/PartitionedConsumerImpl.java       |   460 +
 .../client/impl/PartitionedProducerImpl.java       |   197 +
 .../apache/pulsar/client/impl/ProducerBase.java    |   107 +
 .../apache/pulsar/client/impl/ProducerImpl.java    |  1165 ++
 .../apache/pulsar/client/impl/ProducerStats.java   |   258 +
 .../pulsar/client/impl/ProducerStatsDisabled.java  |    44 +
 .../pulsar/client/impl/PulsarClientImpl.java       |   495 +
 .../org/apache/pulsar/client/impl/ReaderImpl.java  |   131 +
 .../impl/RoundRobinPartitionMessageRouterImpl.java |    47 +
 .../apache/pulsar/client/impl/SendCallback.java    |    56 +
 .../impl/SinglePartitionMessageRouterImpl.java     |    46 +
 .../pulsar/client/impl/UnAckedMessageTracker.java  |   205 +
 .../client/impl/auth/AuthenticationDataNull.java   |    25 +
 .../client/impl/auth/AuthenticationDataTls.java    |    63 +
 .../client/impl/auth/AuthenticationDisabled.java   |    61 +
 .../pulsar/client/impl/auth/AuthenticationTls.java |    70 +
 .../pulsar/client/util/ExecutorProvider.java       |    55 +
 .../org/apache/pulsar/client/util/FutureUtil.java  |    73 +
 .../yahoo/pulsar/client/api/ConsumerIdTest.java    |    74 -
 .../com/yahoo/pulsar/client/api/MessageIdTest.java |    48 -
 .../com/yahoo/pulsar/client/impl/BackoffTest.java  |    40 -
 .../pulsar/client/impl/BatchMessageIdImplTest.java |    46 -
 .../client/tutorial/ContinuousAsyncProducer.java   |    37 -
 .../pulsar/client/tutorial/ContinuousProducer.java |    46 -
 .../client/tutorial/SampleAsyncProducer.java       |    73 -
 .../pulsar/client/tutorial/SampleConsumer.java     |    43 -
 .../client/tutorial/SampleConsumerListener.java    |    54 -
 .../pulsar/client/tutorial/SampleProducer.java     |    39 -
 .../apache/pulsar/client/api/ConsumerIdTest.java   |    74 +
 .../apache/pulsar/client/api/MessageIdTest.java    |    49 +
 .../org/apache/pulsar/client/impl/BackoffTest.java |    41 +
 .../pulsar/client/impl/BatchMessageIdImplTest.java |    47 +
 .../client/tutorial/ContinuousAsyncProducer.java   |    37 +
 .../pulsar/client/tutorial/ContinuousProducer.java |    46 +
 .../client/tutorial/SampleAsyncProducer.java       |    73 +
 .../pulsar/client/tutorial/SampleConsumer.java     |    43 +
 .../client/tutorial/SampleConsumerListener.java    |    53 +
 .../pulsar/client/tutorial/SampleProducer.java     |    39 +
 .../java/com/yahoo/pulsar/common/api/Commands.java |   810 -
 .../com/yahoo/pulsar/common/api/DoubleByteBuf.java |   429 -
 .../com/yahoo/pulsar/common/api/PulsarDecoder.java |   371 -
 .../com/yahoo/pulsar/common/api/PulsarHandler.java |   123 -
 .../common/api/PulsarLengthFieldFrameDecoder.java  |    40 -
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 19388 -------------------
 .../common/compression/CompressionCodec.java       |    54 -
 .../common/compression/CompressionCodecLZ4.java    |    66 -
 .../common/compression/CompressionCodecNone.java   |    38 -
 .../compression/CompressionCodecProvider.java      |    66 -
 .../common/compression/CompressionCodecZLib.java   |   112 -
 .../pulsar/common/lookup/data/LookupData.java      |    91 -
 .../pulsar/common/naming/DestinationDomain.java    |    23 -
 .../pulsar/common/naming/DestinationName.java      |   258 -
 .../yahoo/pulsar/common/naming/NamedEntity.java    |    47 -
 .../yahoo/pulsar/common/naming/NamespaceName.java  |   165 -
 .../yahoo/pulsar/common/naming/ServiceUnitId.java  |    41 -
 .../common/partition/PartitionedTopicMetadata.java |    34 -
 .../pulsar/common/policies/AutoFailoverPolicy.java |    44 -
 .../common/policies/NamespaceIsolationPolicy.java  |   111 -
 .../pulsar/common/policies/data/AuthAction.java    |    30 -
 .../pulsar/common/policies/data/AuthPolicies.java  |    46 -
 .../policies/data/AutoFailoverPolicyData.java      |    51 -
 .../policies/data/AutoFailoverPolicyType.java      |    34 -
 .../pulsar/common/policies/data/BacklogQuota.java  |   107 -
 .../common/policies/data/BrokerAssignment.java     |    23 -
 .../pulsar/common/policies/data/BrokerStatus.java  |    64 -
 .../pulsar/common/policies/data/BundlesData.java   |    75 -
 .../pulsar/common/policies/data/ClusterData.java   |   116 -
 .../pulsar/common/policies/data/ConsumerStats.java |    66 -
 .../pulsar/common/policies/data/ErrorData.java     |    30 -
 .../pulsar/common/policies/data/LocalPolicies.java |    42 -
 .../policies/data/NamespaceIsolationData.java      |    58 -
 .../policies/data/NamespaceOwnershipStatus.java    |    42 -
 .../policies/data/PartitionedTopicStats.java       |    50 -
 .../common/policies/data/PersistencePolicies.java  |    75 -
 .../policies/data/PersistentOfflineTopicStats.java |   104 -
 .../policies/data/PersistentSubscriptionStats.java |    94 -
 .../data/PersistentTopicInternalStats.java         |    64 -
 .../common/policies/data/PersistentTopicStats.java |   119 -
 .../pulsar/common/policies/data/Policies.java      |    90 -
 .../pulsar/common/policies/data/PropertyAdmin.java |    78 -
 .../common/policies/data/PublisherStats.java       |    57 -
 .../common/policies/data/ReplicatorStats.java      |    73 -
 .../pulsar/common/policies/data/ResourceQuota.java |   218 -
 .../common/policies/data/RetentionPolicies.java    |    73 -
 .../policies/data/loadbalancer/BrokerUsage.java    |    69 -
 .../policies/data/loadbalancer/JvmUsage.java       |    52 -
 .../policies/data/loadbalancer/LoadReport.java     |   390 -
 .../data/loadbalancer/NamespaceBundleStats.java    |   121 -
 .../NamespaceBundleStatsComparator.java            |    58 -
 .../policies/data/loadbalancer/NamespaceUsage.java |   202 -
 .../data/loadbalancer/ResourceUnitRanking.java     |   306 -
 .../policies/data/loadbalancer/ResourceUsage.java  |    66 -
 .../data/loadbalancer/ServiceLookupData.java       |    30 -
 .../data/loadbalancer/SystemResourceUsage.java     |    92 -
 .../policies/impl/AutoFailoverPolicyFactory.java   |    37 -
 .../common/policies/impl/MinAvailablePolicy.java   |    88 -
 .../policies/impl/NamespaceIsolationPolicies.java  |   173 -
 .../impl/NamespaceIsolationPolicyImpl.java         |   163 -
 .../yahoo/pulsar/common/stats/AllocatorStats.java  |    77 -
 .../com/yahoo/pulsar/common/stats/Metrics.java     |   102 -
 .../java/com/yahoo/pulsar/common/util/Codec.java   |    51 -
 .../com/yahoo/pulsar/common/util/FieldParser.java  |   303 -
 .../yahoo/pulsar/common/util/KeyStoreHolder.java   |    61 -
 .../pulsar/common/util/ObjectMapperFactory.java    |    49 -
 .../yahoo/pulsar/common/util/SecurityUtility.java  |   169 -
 .../util/collections/ConcurrentLongHashMap.java    |   492 -
 .../util/collections/ConcurrentLongPairSet.java    |   554 -
 .../util/collections/ConcurrentOpenHashMap.java    |   451 -
 .../util/collections/ConcurrentOpenHashSet.java    |   470 -
 .../collections/GrowableArrayBlockingQueue.java    |   355 -
 .../util/protobuf/ByteBufCodedInputStream.java     |   362 -
 .../util/protobuf/ByteBufCodedOutputStream.java    |   255 -
 .../org/apache/pulsar/common/api/Commands.java     |   811 +
 .../apache/pulsar/common/api/DoubleByteBuf.java    |   429 +
 .../apache/pulsar/common/api/PulsarDecoder.java    |   370 +
 .../apache/pulsar/common/api/PulsarHandler.java    |   122 +
 .../common/api/PulsarLengthFieldFrameDecoder.java  |    40 +
 .../apache/pulsar/common/api/proto/PulsarApi.java  | 19388 +++++++++++++++++++
 .../common/compression/CompressionCodec.java       |    54 +
 .../common/compression/CompressionCodecLZ4.java    |    66 +
 .../common/compression/CompressionCodecNone.java   |    38 +
 .../compression/CompressionCodecProvider.java      |    66 +
 .../common/compression/CompressionCodecZLib.java   |   112 +
 .../pulsar/common/lookup/data/LookupData.java      |    91 +
 .../pulsar/common/naming/DestinationDomain.java    |    23 +
 .../pulsar/common/naming/DestinationName.java      |   258 +
 .../apache/pulsar/common/naming/NamedEntity.java   |    47 +
 .../apache/pulsar/common/naming/NamespaceName.java |   165 +
 .../apache/pulsar/common/naming/ServiceUnitId.java |    41 +
 .../common/partition/PartitionedTopicMetadata.java |    34 +
 .../pulsar/common/policies/AutoFailoverPolicy.java |    44 +
 .../common/policies/NamespaceIsolationPolicy.java  |   111 +
 .../pulsar/common/policies/data/AuthAction.java    |    30 +
 .../pulsar/common/policies/data/AuthPolicies.java  |    46 +
 .../policies/data/AutoFailoverPolicyData.java      |    52 +
 .../policies/data/AutoFailoverPolicyType.java      |    34 +
 .../pulsar/common/policies/data/BacklogQuota.java  |   107 +
 .../common/policies/data/BrokerAssignment.java     |    23 +
 .../pulsar/common/policies/data/BrokerStatus.java  |    64 +
 .../pulsar/common/policies/data/BundlesData.java   |    75 +
 .../pulsar/common/policies/data/ClusterData.java   |   116 +
 .../pulsar/common/policies/data/ConsumerStats.java |    66 +
 .../pulsar/common/policies/data/ErrorData.java     |    30 +
 .../pulsar/common/policies/data/LocalPolicies.java |    42 +
 .../policies/data/NamespaceIsolationData.java      |    58 +
 .../policies/data/NamespaceOwnershipStatus.java    |    42 +
 .../policies/data/PartitionedTopicStats.java       |    51 +
 .../common/policies/data/PersistencePolicies.java  |    75 +
 .../policies/data/PersistentOfflineTopicStats.java |   104 +
 .../policies/data/PersistentSubscriptionStats.java |    95 +
 .../data/PersistentTopicInternalStats.java         |    64 +
 .../common/policies/data/PersistentTopicStats.java |   119 +
 .../pulsar/common/policies/data/Policies.java      |    90 +
 .../pulsar/common/policies/data/PropertyAdmin.java |    78 +
 .../common/policies/data/PublisherStats.java       |    57 +
 .../common/policies/data/ReplicatorStats.java      |    73 +
 .../pulsar/common/policies/data/ResourceQuota.java |   218 +
 .../common/policies/data/RetentionPolicies.java    |    73 +
 .../policies/impl/AutoFailoverPolicyFactory.java   |    37 +
 .../common/policies/impl/MinAvailablePolicy.java   |    89 +
 .../policies/impl/NamespaceIsolationPolicies.java  |   173 +
 .../impl/NamespaceIsolationPolicyImpl.java         |   164 +
 .../apache/pulsar/common/stats/AllocatorStats.java |    77 +
 .../org/apache/pulsar/common/stats/Metrics.java    |   102 +
 .../java/org/apache/pulsar/common/util/Codec.java  |    51 +
 .../org/apache/pulsar/common/util/FieldParser.java |   303 +
 .../apache/pulsar/common/util/KeyStoreHolder.java  |    61 +
 .../pulsar/common/util/ObjectMapperFactory.java    |    49 +
 .../apache/pulsar/common/util/SecurityUtility.java |   169 +
 .../util/collections/ConcurrentLongHashMap.java    |   492 +
 .../util/collections/ConcurrentLongPairSet.java    |   554 +
 .../util/collections/ConcurrentOpenHashMap.java    |   451 +
 .../util/collections/ConcurrentOpenHashSet.java    |   470 +
 .../collections/GrowableArrayBlockingQueue.java    |   355 +
 .../util/protobuf/ByteBufCodedInputStream.java     |   363 +
 .../util/protobuf/ByteBufCodedOutputStream.java    |   256 +
 .../policies/data/loadbalancer/BrokerUsage.java    |    69 +
 .../policies/data/loadbalancer/JvmUsage.java       |    52 +
 .../policies/data/loadbalancer/LoadReport.java     |   390 +
 .../data/loadbalancer/NamespaceBundleStats.java    |   121 +
 .../NamespaceBundleStatsComparator.java            |    58 +
 .../policies/data/loadbalancer/NamespaceUsage.java |   202 +
 .../data/loadbalancer/ResourceUnitRanking.java     |   306 +
 .../policies/data/loadbalancer/ResourceUsage.java  |    66 +
 .../data/loadbalancer/ServiceLookupData.java       |    30 +
 .../data/loadbalancer/SystemResourceUsage.java     |    92 +
 .../yahoo/pulsar/common/api/DoubleByteBufTest.java |    52 -
 .../pulsar/common/compression/CommandsTest.java    |    98 -
 .../common/compression/CompressorCodecTest.java    |   119 -
 .../common/compression/Crc32cChecksumTest.java     |   157 -
 .../pulsar/common/lookup/data/LookupDataTest.java  |    70 -
 .../pulsar/common/naming/DestinationNameTest.java  |   225 -
 .../pulsar/common/naming/NamespaceNameTest.java    |   203 -
 .../policies/data/AutoFailoverPolicyDataTest.java  |    54 -
 .../policies/data/AutoFailoverPolicyTypeTest.java  |    33 -
 .../common/policies/data/BacklogQuotaTest.java     |    41 -
 .../common/policies/data/ClusterDataTest.java      |    64 -
 .../common/policies/data/LocalPolicesTest.java     |    52 -
 .../policies/data/NamespaceIsolationDataTest.java  |    82 -
 .../data/NamespaceOwnershipStatusTest.java         |    65 -
 .../pulsar/common/policies/data/OldPolicies.java   |    60 -
 .../policies/data/PartitionedTopicStatsTest.java   |    54 -
 .../policies/data/PersistencePoliciesTest.java     |    35 -
 .../data/PersistentOfflineTopicStatsTest.java      |    49 -
 .../policies/data/PersistentTopicStatsTest.java    |    62 -
 .../common/policies/data/PoliciesDataTest.java     |   107 -
 .../common/policies/data/ReplicatorStatsTest.java  |    58 -
 .../common/policies/data/ResourceQuotaTest.java    |    83 -
 .../common/policies/data/RetentionPolicesTest.java |    35 -
 .../impl/AutoFailoverPolicyFactoryTest.java        |    53 -
 .../policies/impl/MinAvailablePolicyTest.java      |    35 -
 .../impl/NamespaceIsolationPoliciesTest.java       |   181 -
 .../impl/NamespaceIsolationPolicyImplTest.java     |   193 -
 .../collections/ConcurrentLongHashMapTest.java     |   432 -
 .../collections/ConcurrentLongPairSetTest.java     |   409 -
 .../collections/ConcurrentOpenHashMapTest.java     |   459 -
 .../collections/ConcurrentOpenHashSetTest.java     |   339 -
 .../common/util/collections/FieldParserTest.java   |   121 -
 .../GrowableArrayBlockingQueueTest.java            |   204 -
 .../util/protobuf/ByteBufCodedInputStreamTest.java |    97 -
 .../pulsar/common/api/DoubleByteBufTest.java       |    54 +
 .../pulsar/common/compression/CommandsTest.java    |    97 +
 .../common/compression/CompressorCodecTest.java    |   120 +
 .../common/compression/Crc32cChecksumTest.java     |   157 +
 .../pulsar/common/lookup/data/LookupDataTest.java  |    70 +
 .../pulsar/common/naming/DestinationNameTest.java  |   226 +
 .../pulsar/common/naming/NamespaceNameTest.java    |   205 +
 .../policies/data/AutoFailoverPolicyDataTest.java  |    56 +
 .../policies/data/AutoFailoverPolicyTypeTest.java  |    34 +
 .../common/policies/data/BacklogQuotaTest.java     |    41 +
 .../common/policies/data/ClusterDataTest.java      |    65 +
 .../common/policies/data/LocalPolicesTest.java     |    53 +
 .../policies/data/NamespaceIsolationDataTest.java  |    85 +
 .../data/NamespaceOwnershipStatusTest.java         |    65 +
 .../pulsar/common/policies/data/OldPolicies.java   |    61 +
 .../policies/data/PartitionedTopicStatsTest.java   |    58 +
 .../policies/data/PersistencePoliciesTest.java     |    36 +
 .../data/PersistentOfflineTopicStatsTest.java      |    50 +
 .../policies/data/PersistentTopicStatsTest.java    |    66 +
 .../common/policies/data/PoliciesDataTest.java     |   112 +
 .../common/policies/data/ReplicatorStatsTest.java  |    59 +
 .../common/policies/data/ResourceQuotaTest.java    |    82 +
 .../common/policies/data/RetentionPolicesTest.java |    36 +
 .../impl/AutoFailoverPolicyFactoryTest.java        |    53 +
 .../policies/impl/MinAvailablePolicyTest.java      |    35 +
 .../impl/NamespaceIsolationPoliciesTest.java       |   183 +
 .../impl/NamespaceIsolationPolicyImplTest.java     |   194 +
 .../collections/ConcurrentLongHashMapTest.java     |   432 +
 .../collections/ConcurrentLongPairSetTest.java     |   410 +
 .../collections/ConcurrentOpenHashMapTest.java     |   459 +
 .../collections/ConcurrentOpenHashSetTest.java     |   339 +
 .../common/util/collections/FieldParserTest.java   |   121 +
 .../GrowableArrayBlockingQueueTest.java            |   205 +
 .../util/protobuf/ByteBufCodedInputStreamTest.java |    99 +
 .../discovery/service/BrokerDiscoveryProvider.java |   177 -
 .../pulsar/discovery/service/DiscoveryService.java |   231 -
 .../discovery/service/PulsarServerException.java   |    38 -
 .../pulsar/discovery/service/ServerConnection.java |   167 -
 .../service/ServiceChannelInitializer.java         |    67 -
 .../service/server/DiscoveryServiceStarter.java    |   103 -
 .../discovery/service/server/ServerManager.java    |   145 -
 .../discovery/service/server/ServiceConfig.java    |   202 -
 .../service/web/DiscoveryServiceServlet.java       |   172 -
 .../discovery/service/web/RestException.java       |    57 -
 .../service/web/ZookeeperCacheLoader.java          |   132 -
 .../discovery/service/BrokerDiscoveryProvider.java |   177 +
 .../pulsar/discovery/service/DiscoveryService.java |   230 +
 .../discovery/service/PulsarServerException.java   |    38 +
 .../pulsar/discovery/service/ServerConnection.java |   166 +
 .../service/ServiceChannelInitializer.java         |    67 +
 .../service/server/DiscoveryServiceStarter.java    |   102 +
 .../discovery/service/server/ServerManager.java    |   145 +
 .../discovery/service/server/ServiceConfig.java    |   203 +
 .../service/web/DiscoveryServiceServlet.java       |   171 +
 .../discovery/service/web/RestException.java       |    57 +
 .../service/web/ZookeeperCacheLoader.java          |   131 +
 .../discovery/service/BaseDiscoveryTestSetup.java  |    89 -
 .../discovery/service/DiscoveryServiceTest.java    |   248 -
 .../service/server/DiscoveryServiceWebTest.java    |    64 -
 .../discovery/service/web/BaseZKStarterTest.java   |    71 -
 .../service/web/DiscoveryServiceWebTest.java       |   302 -
 .../service/web/ZookeeperCacheLoaderTest.java      |    98 -
 .../discovery/service/BaseDiscoveryTestSetup.java  |    91 +
 .../discovery/service/DiscoveryServiceTest.java    |   247 +
 .../service/server/DiscoveryServiceWebTest.java    |    66 +
 .../discovery/service/web/BaseZKStarterTest.java   |    71 +
 .../service/web/DiscoveryServiceWebTest.java       |   305 +
 .../service/web/ZookeeperCacheLoaderTest.java      |    99 +
 .../discovery/service/BaseDiscoveryTestSetup.java  |    89 -
 .../discovery/service/DiscoveryServiceTest.java    |   211 -
 .../service/server/DiscoveryServiceWebTest.java    |    61 -
 .../discovery/service/web/BaseZKStarterTest.java   |    71 -
 .../service/web/DiscoveryServiceWebTest.java       |   320 -
 .../service/web/ZookeeperCacheLoaderTest.java      |   104 -
 .../pulsar/spark/SparkStreamingPulsarReceiver.java |    93 -
 .../pulsar/spark/SparkStreamingPulsarReceiver.java |    88 +
 .../spark/SparkStreamingPulsarReceiverTest.java    |    87 -
 .../SparkStreamingPulsarReceiverExample.java       |    71 -
 .../spark/SparkStreamingPulsarReceiverTest.java    |    87 +
 .../SparkStreamingPulsarReceiverExample.java       |    68 +
 .../yahoo/pulsar/storm/MessageToValuesMapper.java  |    44 -
 .../java/com/yahoo/pulsar/storm/PulsarBolt.java    |   195 -
 .../pulsar/storm/PulsarBoltConfiguration.java      |    57 -
 .../java/com/yahoo/pulsar/storm/PulsarSpout.java   |   298 -
 .../pulsar/storm/PulsarSpoutConfiguration.java     |   138 -
 .../pulsar/storm/PulsarStormConfiguration.java     |    90 -
 .../com/yahoo/pulsar/storm/SharedPulsarClient.java |   125 -
 .../yahoo/pulsar/storm/TupleToMessageMapper.java   |    44 -
 .../apache/pulsar/storm/MessageToValuesMapper.java |    44 +
 .../java/org/apache/pulsar/storm/PulsarBolt.java   |   195 +
 .../pulsar/storm/PulsarBoltConfiguration.java      |    57 +
 .../java/org/apache/pulsar/storm/PulsarSpout.java  |   298 +
 .../pulsar/storm/PulsarSpoutConfiguration.java     |   138 +
 .../pulsar/storm/PulsarStormConfiguration.java     |    90 +
 .../apache/pulsar/storm/SharedPulsarClient.java    |   125 +
 .../apache/pulsar/storm/TupleToMessageMapper.java  |    44 +
 .../yahoo/pulsar/storm/MockOutputCollector.java    |    91 -
 .../pulsar/storm/MockSpoutOutputCollector.java     |    70 -
 .../com/yahoo/pulsar/storm/PulsarBoltTest.java     |   228 -
 .../com/yahoo/pulsar/storm/PulsarSpoutTest.java    |   322 -
 .../test/java/com/yahoo/pulsar/storm/TestUtil.java |    35 -
 .../yahoo/pulsar/storm/example/StormExample.java   |   171 -
 .../apache/pulsar/storm/MockOutputCollector.java   |    91 +
 .../pulsar/storm/MockSpoutOutputCollector.java     |    70 +
 .../org/apache/pulsar/storm/PulsarBoltTest.java    |   227 +
 .../org/apache/pulsar/storm/PulsarSpoutTest.java   |   325 +
 .../java/org/apache/pulsar/storm/TestUtil.java     |    35 +
 .../apache/pulsar/storm/example/StormExample.java  |   171 +
 .../socket/client/MockAuthenticationProvider.java  |    54 -
 .../proxy/socket/client/PaddingDecimalFormat.java  |    72 -
 .../proxy/socket/client/PerformanceClient.java     |   322 -
 .../socket/client/SimpleTestProducerSocket.java    |   111 -
 .../com/yahoo/pulsar/testclient/BrokerMonitor.java |   480 -
 .../pulsar/testclient/LoadSimulationClient.java    |   393 -
 .../testclient/LoadSimulationController.java       |   723 -
 .../pulsar/testclient/PerformanceConsumer.java     |   247 -
 .../pulsar/testclient/PerformanceProducer.java     |   391 -
 .../yahoo/pulsar/testclient/PerformanceReader.java |   240 -
 .../utils/FixedColumnLengthTableMaker.java         |   159 -
 .../testclient/utils/PaddingDecimalFormat.java     |    72 -
 .../socket/client/MockAuthenticationProvider.java  |    54 +
 .../proxy/socket/client/PaddingDecimalFormat.java  |    72 +
 .../proxy/socket/client/PerformanceClient.java     |   321 +
 .../socket/client/SimpleTestProducerSocket.java    |   111 +
 .../apache/pulsar/testclient/BrokerMonitor.java    |   480 +
 .../pulsar/testclient/LoadSimulationClient.java    |   393 +
 .../testclient/LoadSimulationController.java       |   723 +
 .../pulsar/testclient/PerformanceConsumer.java     |   247 +
 .../pulsar/testclient/PerformanceProducer.java     |   391 +
 .../pulsar/testclient/PerformanceReader.java       |   240 +
 .../utils/FixedColumnLengthTableMaker.java         |   159 +
 .../testclient/utils/PaddingDecimalFormat.java     |    72 +
 .../pulsar/websocket/AbstractWebSocketHandler.java |   157 -
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |   278 -
 .../yahoo/pulsar/websocket/ProducerHandler.java    |   252 -
 .../pulsar/websocket/WebSocketConsumerServlet.java |    42 -
 .../com/yahoo/pulsar/websocket/WebSocketError.java |    58 -
 .../pulsar/websocket/WebSocketProducerServlet.java |    40 -
 .../yahoo/pulsar/websocket/WebSocketService.java   |   312 -
 .../pulsar/websocket/admin/RestException.java      |    66 -
 .../websocket/admin/WebSocketProxyStats.java       |   132 -
 .../websocket/admin/WebSocketWebResource.java      |   133 -
 .../yahoo/pulsar/websocket/data/ConsumerAck.java   |    30 -
 .../pulsar/websocket/data/ConsumerMessage.java     |    34 -
 .../yahoo/pulsar/websocket/data/ProducerAck.java   |    46 -
 .../pulsar/websocket/data/ProducerMessage.java     |    30 -
 .../pulsar/websocket/service/ProxyServer.java      |   161 -
 .../service/WebSocketProxyConfiguration.java       |   276 -
 .../websocket/service/WebSocketServiceStarter.java |    63 -
 .../yahoo/pulsar/websocket/stats/JvmMetrics.java   |   155 -
 .../yahoo/pulsar/websocket/stats/ProxyStats.java   |   139 -
 .../pulsar/websocket/stats/ProxyTopicStat.java     |    73 -
 .../yahoo/pulsar/websocket/stats/StatsBuckets.java |   116 -
 .../pulsar/websocket/AbstractWebSocketHandler.java |   157 +
 .../apache/pulsar/websocket/ConsumerHandler.java   |   278 +
 .../apache/pulsar/websocket/ProducerHandler.java   |   252 +
 .../pulsar/websocket/WebSocketConsumerServlet.java |    42 +
 .../apache/pulsar/websocket/WebSocketError.java    |    58 +
 .../pulsar/websocket/WebSocketProducerServlet.java |    40 +
 .../apache/pulsar/websocket/WebSocketService.java  |   312 +
 .../pulsar/websocket/admin/RestException.java      |    66 +
 .../websocket/admin/WebSocketProxyStats.java       |   131 +
 .../websocket/admin/WebSocketWebResource.java      |   132 +
 .../apache/pulsar/websocket/data/ConsumerAck.java  |    30 +
 .../pulsar/websocket/data/ConsumerMessage.java     |    34 +
 .../apache/pulsar/websocket/data/ProducerAck.java  |    47 +
 .../pulsar/websocket/data/ProducerMessage.java     |    30 +
 .../pulsar/websocket/service/ProxyServer.java      |   161 +
 .../service/WebSocketProxyConfiguration.java       |   277 +
 .../websocket/service/WebSocketServiceStarter.java |    61 +
 .../apache/pulsar/websocket/stats/JvmMetrics.java  |   155 +
 .../apache/pulsar/websocket/stats/ProxyStats.java  |   140 +
 .../pulsar/websocket/stats/ProxyTopicStat.java     |    74 +
 .../pulsar/websocket/stats/StatsBuckets.java       |   116 +
 .../authentication/AuthenticationServiceTest.java  |    91 -
 .../yahoo/pulsar/websocket/LookupProtocolTest.java |    92 -
 .../authentication/AuthenticationServiceTest.java  |    91 +
 .../pulsar/websocket/LookupProtocolTest.java       |    92 +
 .../com/yahoo/pulsar/zookeeper/BookieInfo.java     |    41 -
 .../com/yahoo/pulsar/zookeeper/Deserializers.java  |    56 -
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |   165 -
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   329 -
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |    65 -
 .../zookeeper/LocalZooKeeperConnectionService.java |   169 -
 .../zookeeper/ZkBookieRackAffinityMapping.java     |   177 -
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |   157 -
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |   407 -
 .../pulsar/zookeeper/ZooKeeperCacheListener.java   |    25 -
 .../pulsar/zookeeper/ZooKeeperCacheWatcher.java    |    30 -
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java   |   105 -
 .../pulsar/zookeeper/ZooKeeperClientFactory.java   |    46 -
 .../yahoo/pulsar/zookeeper/ZooKeeperDataCache.java |   154 -
 .../pulsar/zookeeper/ZooKeeperSessionWatcher.java  |   183 -
 .../zookeeper/ZookeeperClientFactoryImpl.java      |    86 -
 .../org/apache/pulsar/zookeeper/BookieInfo.java    |    41 +
 .../org/apache/pulsar/zookeeper/Deserializers.java |    56 +
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |   164 +
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   329 +
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |    65 +
 .../zookeeper/LocalZooKeeperConnectionService.java |   169 +
 .../zookeeper/ZkBookieRackAffinityMapping.java     |   177 +
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |   157 +
 .../apache/pulsar/zookeeper/ZooKeeperCache.java    |   407 +
 .../pulsar/zookeeper/ZooKeeperCacheListener.java   |    25 +
 .../pulsar/zookeeper/ZooKeeperCacheWatcher.java    |    30 +
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java   |   105 +
 .../pulsar/zookeeper/ZooKeeperClientFactory.java   |    46 +
 .../pulsar/zookeeper/ZooKeeperDataCache.java       |   154 +
 .../pulsar/zookeeper/ZooKeeperSessionWatcher.java  |   183 +
 .../zookeeper/ZookeeperClientFactoryImpl.java      |    86 +
 .../yahoo/pulsar/zookeeper/DeserializersTest.java  |    55 -
 .../zookeeper/LocalBookkeeperEnsembleTest.java     |   113 -
 .../LocalZooKeeperConnectionServiceTest.java       |   111 -
 .../MockedZooKeeperClientFactoryImpl.java          |    57 -
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |   199 -
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |   309 -
 .../zookeeper/ZooKeeperSessionWatcherTest.java     |   170 -
 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java |   455 -
 .../zookeeper/ZookeeperClientFactoryImplTest.java  |    83 -
 .../pulsar/zookeeper/ZookeeperServerTest.java      |    77 -
 .../apache/pulsar/zookeeper/DeserializersTest.java |    57 +
 .../zookeeper/LocalBookkeeperEnsembleTest.java     |   112 +
 .../LocalZooKeeperConnectionServiceTest.java       |   114 +
 .../MockedZooKeeperClientFactoryImpl.java          |    56 +
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |   202 +
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |   313 +
 .../zookeeper/ZooKeeperSessionWatcherTest.java     |   171 +
 .../pulsar/zookeeper/ZookeeperCacheTest.java       |   463 +
 .../zookeeper/ZookeeperClientFactoryImplTest.java  |    84 +
 .../pulsar/zookeeper/ZookeeperServerTest.java      |    78 +
 .../zookeeper/FinalRequestProcessorAspect.java     |   126 -
 .../pulsar/zookeeper/ZooKeeperServerAspect.java    |    94 -
 .../yahoo/pulsar/zookeeper/ZooKeeperStarter.java   |    62 -
 .../zookeeper/FinalRequestProcessorAspect.java     |   126 +
 .../pulsar/zookeeper/ZooKeeperServerAspect.java    |    94 +
 .../apache/pulsar/zookeeper/ZooKeeperStarter.java  |    62 +
 1109 files changed, 129066 insertions(+), 129710 deletions(-)

commit 59a952dcd2b15671bc2d9d9a906af0a99e26f19b
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 22 18:08:08 2017 -0700

    Fixed problem in starting ZK server for standalone mode (#521)

 .../yahoo/pulsar/zookeeper/ZooKeeperServerAspect.java  | 18 ++++++++++++++----
 1 file changed, 14 insertions(+), 4 deletions(-)

commit 7c0b28faa92bf1ea4dd4c9b8ec24bcfc48a4fbfe
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Thu Jun 22 16:48:56 2017 -0700

    Enable to configure webSocketServiceEnabled on Standalone (#520)

 .../src/main/java/com/yahoo/pulsar/PulsarStandaloneStarter.java          | 1 -
 1 file changed, 1 deletion(-)

commit 009d73e20c176780f64dd81dcc76a4d1231aa217
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Jun 22 16:27:33 2017 -0700

    Reverting commit d990b1 - changing producer queue size back to 1000 (#517)

 pulsar-client-cpp/lib/ProducerConfigurationImpl.h                       | 2 +-
 .../main/java/com/yahoo/pulsar/client/api/ProducerConfiguration.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 0dda90475d996c7c520debf9bfa9af9399989480
Author: Rajan Dhabalia <rdhabalia@apache.org>
Date:   Thu Jun 22 15:18:29 2017 -0700

    Updates headers with ASF source files header (#519)
    
    * Updates headers with ASF source files header
    
    * change license to additional files

 .travis/settings.xml                               | 25 ++++++-----
 NOTICE                                             | 29 +++++++------
 README.md                                          |  2 -
 all/pom.xml                                        | 29 +++++++------
 all/src/assemble/bin.xml                           | 25 ++++++-----
 all/src/assemble/src.xml                           | 25 ++++++-----
 bin/bookkeeper                                     | 29 +++++++------
 bin/pulsar                                         | 29 +++++++------
 bin/pulsar-admin                                   | 27 ++++++------
 bin/pulsar-client                                  | 27 ++++++------
 bin/pulsar-daemon                                  | 29 +++++++------
 bin/pulsar-perf                                    | 29 +++++++------
 conf/bkenv.sh                                      | 25 ++++++-----
 conf/bookkeeper.conf                               | 25 ++++++-----
 conf/broker.conf                                   | 25 ++++++-----
 conf/client.conf                                   | 31 +++++++-------
 conf/discovery.conf                                | 25 ++++++-----
 conf/global_zookeeper.conf                         | 31 +++++++-------
 conf/log4j.properties                              | 25 ++++++-----
 conf/log4j.shell.properties                        | 29 +++++++------
 conf/pulsar_env.sh                                 | 31 +++++++-------
 conf/pulsar_tools_env.sh                           | 31 +++++++-------
 conf/standalone.conf                               | 31 +++++++-------
 conf/websocket.conf                                | 25 ++++++-----
 conf/zookeeper.conf                                | 31 +++++++-------
 dashboard/Dockerfile                               | 25 ++++++-----
 dashboard/conf/nginx-app.conf                      | 25 ++++++-----
 dashboard/conf/postgresql.conf                     | 25 ++++++-----
 dashboard/conf/supervisor-app.conf                 | 25 ++++++-----
 dashboard/conf/uwsgi.ini                           | 25 ++++++-----
 dashboard/django/collector.py                      | 25 ++++++-----
 dashboard/django/collector.sh                      | 25 ++++++-----
 dashboard/django/dashboard/__init__.py             | 25 ++++++-----
 dashboard/django/dashboard/settings.py             | 25 ++++++-----
 dashboard/django/dashboard/urls.py                 | 25 ++++++-----
 dashboard/django/dashboard/wsgi.py                 | 25 ++++++-----
 dashboard/django/manage.py                         | 25 ++++++-----
 dashboard/django/stats/__init__.py                 | 25 ++++++-----
 dashboard/django/stats/admin.py                    | 25 ++++++-----
 dashboard/django/stats/apps.py                     | 25 ++++++-----
 dashboard/django/stats/migrations/__init__.py      | 28 +++++++------
 dashboard/django/stats/models.py                   | 25 ++++++-----
 dashboard/django/stats/templates/stats/base.html   | 29 +++++++------
 dashboard/django/stats/templates/stats/broker.html | 48 ++++++++--------------
 .../django/stats/templates/stats/brokers.html      | 25 ++++++-----
 .../django/stats/templates/stats/clusters.html     | 29 +++++++------
 dashboard/django/stats/templates/stats/home.html   | 25 ++++++-----
 .../django/stats/templates/stats/namespace.html    | 29 +++++++------
 .../django/stats/templates/stats/property.html     | 25 ++++++-----
 dashboard/django/stats/templates/stats/topic.html  | 29 +++++++------
 dashboard/django/stats/templates/stats/topics.html | 29 +++++++------
 dashboard/django/stats/templatetags/__init__.py    | 25 ++++++-----
 .../django/stats/templatetags/stats_extras.py      | 25 ++++++-----
 dashboard/django/stats/templatetags/table.py       | 25 ++++++-----
 dashboard/django/stats/tests.py                    | 25 ++++++-----
 dashboard/django/stats/urls.py                     | 25 ++++++-----
 dashboard/django/stats/views.py                    | 25 ++++++-----
 docker/Dockerfile                                  | 25 ++++++-----
 docker/build.sh                                    | 25 ++++++-----
 docker/grafana/Dockerfile                          | 25 ++++++-----
 docker/grafana/grafana.ini                         | 25 ++++++-----
 docker/grafana/start.sh                            | 25 ++++++-----
 docker/scripts/apply-config-from-env.py            | 25 ++++++-----
 docker/scripts/generate-zookeeper-config.sh        | 25 ++++++-----
 docker/scripts/pulsar-zookeeper-ruok.sh            | 25 ++++++-----
 docs/locale/ja/README.md                           |  2 -
 kubernetes/generic/bookie.yaml                     | 25 ++++++-----
 kubernetes/generic/broker.yaml                     | 25 ++++++-----
 kubernetes/generic/monitoring.yaml                 | 25 ++++++-----
 kubernetes/generic/zookeeper.yaml                  | 25 ++++++-----
 kubernetes/google-container-engine/bookie.yaml     | 25 ++++++-----
 kubernetes/google-container-engine/broker.yaml     | 25 ++++++-----
 kubernetes/google-container-engine/monitoring.yaml | 25 ++++++-----
 kubernetes/google-container-engine/zookeeper.yaml  | 25 ++++++-----
 managed-ledger/pom.xml                             | 25 ++++++-----
 .../apache/bookkeeper/mledger/AsyncCallbacks.java  | 25 ++++++-----
 .../java/org/apache/bookkeeper/mledger/Entry.java  | 25 ++++++-----
 .../apache/bookkeeper/mledger/ManagedCursor.java   | 25 ++++++-----
 .../apache/bookkeeper/mledger/ManagedLedger.java   | 25 ++++++-----
 .../bookkeeper/mledger/ManagedLedgerConfig.java    | 25 ++++++-----
 .../bookkeeper/mledger/ManagedLedgerException.java | 25 ++++++-----
 .../bookkeeper/mledger/ManagedLedgerFactory.java   | 25 ++++++-----
 .../mledger/ManagedLedgerFactoryConfig.java        | 25 ++++++-----
 .../mledger/ManagedLedgerFactoryMXBean.java        | 25 ++++++-----
 .../bookkeeper/mledger/ManagedLedgerInfo.java      | 25 ++++++-----
 .../bookkeeper/mledger/ManagedLedgerMXBean.java    | 25 ++++++-----
 .../org/apache/bookkeeper/mledger/Position.java    | 25 ++++++-----
 .../apache/bookkeeper/mledger/impl/EntryCache.java | 25 ++++++-----
 .../impl/EntryCacheDefaultEvictionPolicy.java      | 25 ++++++-----
 .../mledger/impl/EntryCacheEvictionPolicy.java     | 25 ++++++-----
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    | 25 ++++++-----
 .../bookkeeper/mledger/impl/EntryCacheManager.java | 25 ++++++-----
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  | 25 ++++++-----
 .../mledger/impl/ManagedCursorContainer.java       | 25 ++++++-----
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 25 ++++++-----
 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 25 ++++++-----
 .../impl/ManagedLedgerFactoryMBeanImpl.java        | 25 ++++++-----
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 25 ++++++-----
 .../mledger/impl/ManagedLedgerMBeanImpl.java       | 25 ++++++-----
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  | 25 ++++++-----
 .../apache/bookkeeper/mledger/impl/MetaStore.java  | 25 ++++++-----
 .../mledger/impl/MetaStoreImplZookeeper.java       | 25 ++++++-----
 .../mledger/impl/NonDurableCursorImpl.java         | 25 ++++++-----
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java | 25 ++++++-----
 .../bookkeeper/mledger/impl/OpFindNewest.java      | 25 ++++++-----
 .../bookkeeper/mledger/impl/OpReadEntry.java       | 25 ++++++-----
 .../bookkeeper/mledger/impl/PositionImpl.java      | 25 ++++++-----
 .../bookkeeper/mledger/util/CallbackMutex.java     | 25 ++++++-----
 .../apache/bookkeeper/mledger/util/Futures.java    | 25 ++++++-----
 .../org/apache/bookkeeper/mledger/util/Pair.java   | 25 ++++++-----
 .../apache/bookkeeper/mledger/util/RangeCache.java | 25 ++++++-----
 .../org/apache/bookkeeper/mledger/util/Rate.java   | 25 ++++++-----
 .../apache/bookkeeper/mledger/util/SafeRun.java    | 25 ++++++-----
 .../bookkeeper/mledger/util/StatsBuckets.java      | 25 ++++++-----
 managed-ledger/src/main/proto/MLDataFormats.proto  | 25 ++++++-----
 .../bookkeeper/client/BookKeeperTestClient.java    | 25 ++++++-----
 .../apache/bookkeeper/client/MockBookKeeper.java   | 25 ++++++-----
 .../apache/bookkeeper/client/MockLedgerEntry.java  | 25 ++++++-----
 .../apache/bookkeeper/client/MockLedgerHandle.java | 25 ++++++-----
 .../bookkeeper/mledger/SimpleBookKeeperTest.java   | 25 ++++++-----
 .../mledger/impl/EntryCacheManagerTest.java        | 25 ++++++-----
 .../bookkeeper/mledger/impl/EntryCacheTest.java    | 25 ++++++-----
 .../mledger/impl/ManagedCursorConcurrencyTest.java | 25 ++++++-----
 .../mledger/impl/ManagedCursorContainerTest.java   | 25 ++++++-----
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 25 ++++++-----
 .../impl/ManagedLedgerBinaryFormatConversion.java  | 25 ++++++-----
 .../mledger/impl/ManagedLedgerBkTest.java          | 25 ++++++-----
 .../mledger/impl/ManagedLedgerErrorsTest.java      | 25 ++++++-----
 .../mledger/impl/ManagedLedgerFactoryTest.java     | 25 ++++++-----
 .../mledger/impl/ManagedLedgerMBeanTest.java       | 25 ++++++-----
 .../impl/ManagedLedgerSingleBookieTest.java        | 25 ++++++-----
 .../mledger/impl/ManagedLedgerTerminationTest.java | 25 ++++++-----
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 25 ++++++-----
 .../mledger/impl/MetaStoreImplZookeeperTest.java   | 25 ++++++-----
 .../mledger/impl/NonDurableCursorTest.java         | 25 ++++++-----
 .../bookkeeper/mledger/impl/PositionTest.java      | 25 ++++++-----
 .../bookkeeper/mledger/util/CallbackMutexTest.java | 25 ++++++-----
 .../apache/bookkeeper/mledger/util/PairTest.java   | 25 ++++++-----
 .../bookkeeper/mledger/util/RangeCacheTest.java    | 25 ++++++-----
 .../bookkeeper/mledger/util/TestStatsBuckets.java  | 25 ++++++-----
 .../bookkeeper/test/BookKeeperClusterTestCase.java | 25 ++++++-----
 .../bookkeeper/test/MockedBookKeeperTestCase.java  | 25 ++++++-----
 .../org/apache/bookkeeper/test/PortManager.java    | 25 ++++++-----
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java  | 25 ++++++-----
 .../java/org/apache/zookeeper/MockZooKeeper.java   | 25 ++++++-----
 pom.xml                                            | 29 +++++++------
 pulsar-broker-auth-athenz/pom.xml                  | 29 +++++++------
 .../AuthenticationProviderAthenz.java              | 25 ++++++-----
 .../AuthenticationProviderAthenzTest.java          | 25 ++++++-----
 pulsar-broker-common/pom.xml                       | 29 +++++++------
 .../yahoo/pulsar/broker/PulsarServerException.java | 25 ++++++-----
 .../yahoo/pulsar/broker/ServiceConfiguration.java  | 25 ++++++-----
 .../pulsar/broker/ServiceConfigurationUtils.java   | 25 ++++++-----
 .../authentication/AuthenticationDataCommand.java  | 25 ++++++-----
 .../authentication/AuthenticationDataHttp.java     | 25 ++++++-----
 .../authentication/AuthenticationDataHttps.java    | 25 ++++++-----
 .../authentication/AuthenticationDataSource.java   | 25 ++++++-----
 .../authentication/AuthenticationProvider.java     | 25 ++++++-----
 .../authentication/AuthenticationProviderTls.java  | 25 ++++++-----
 .../authentication/AuthenticationService.java      | 25 ++++++-----
 .../broker/authorization/AuthorizationManager.java | 25 ++++++-----
 .../broker/cache/ConfigurationCacheService.java    | 25 ++++++-----
 .../pulsar/common/configuration/FieldContext.java  | 25 ++++++-----
 .../common/configuration/PulsarConfiguration.java  | 25 ++++++-----
 .../configuration/PulsarConfigurationLoader.java   | 25 ++++++-----
 .../PulsarConfigurationLoaderTest.java             | 25 ++++++-----
 pulsar-broker/pom.xml                              | 29 +++++++------
 .../java/com/yahoo/pulsar/PulsarBrokerStarter.java | 25 ++++++-----
 .../yahoo/pulsar/PulsarClusterMetadataSetup.java   | 25 ++++++-----
 .../com/yahoo/pulsar/PulsarStandaloneStarter.java  | 25 ++++++-----
 .../pulsar/broker/BookKeeperClientFactory.java     | 25 ++++++-----
 .../pulsar/broker/BookKeeperClientFactoryImpl.java | 25 ++++++-----
 .../java/com/yahoo/pulsar/broker/BrokerData.java   | 25 ++++++-----
 .../java/com/yahoo/pulsar/broker/BundleData.java   | 25 ++++++-----
 .../java/com/yahoo/pulsar/broker/JSONWritable.java | 25 ++++++-----
 .../com/yahoo/pulsar/broker/LocalBrokerData.java   | 25 ++++++-----
 .../pulsar/broker/ManagedLedgerClientFactory.java  | 25 ++++++-----
 .../broker/MessagingServiceShutdownHook.java       | 25 ++++++-----
 .../com/yahoo/pulsar/broker/PulsarService.java     | 25 ++++++-----
 .../yahoo/pulsar/broker/TimeAverageBrokerData.java | 25 ++++++-----
 .../pulsar/broker/TimeAverageMessageData.java      | 25 ++++++-----
 .../yahoo/pulsar/broker/admin/AdminResource.java   | 25 ++++++-----
 .../com/yahoo/pulsar/broker/admin/BrokerStats.java | 25 ++++++-----
 .../com/yahoo/pulsar/broker/admin/Brokers.java     | 25 ++++++-----
 .../com/yahoo/pulsar/broker/admin/Clusters.java    | 25 ++++++-----
 .../com/yahoo/pulsar/broker/admin/Namespaces.java  | 25 ++++++-----
 .../pulsar/broker/admin/PersistentTopics.java      | 25 ++++++-----
 .../com/yahoo/pulsar/broker/admin/Properties.java  | 25 ++++++-----
 .../yahoo/pulsar/broker/admin/ResourceQuotas.java  | 25 ++++++-----
 .../broker/cache/LocalZooKeeperCacheService.java   | 25 ++++++-----
 .../pulsar/broker/cache/ResourceQuotaCache.java    | 25 ++++++-----
 .../pulsar/broker/loadbalance/BrokerFilter.java    | 25 ++++++-----
 .../BrokerFilterBadVersionException.java           | 25 ++++++-----
 .../broker/loadbalance/BrokerFilterException.java  | 25 ++++++-----
 .../pulsar/broker/loadbalance/BrokerHostUsage.java | 25 ++++++-----
 .../pulsar/broker/loadbalance/LeaderBroker.java    | 25 ++++++-----
 .../broker/loadbalance/LeaderElectionService.java  | 25 ++++++-----
 .../pulsar/broker/loadbalance/LoadCalculator.java  | 25 ++++++-----
 .../yahoo/pulsar/broker/loadbalance/LoadData.java  | 25 ++++++-----
 .../pulsar/broker/loadbalance/LoadManager.java     | 25 ++++++-----
 .../pulsar/broker/loadbalance/LoadRanker.java      | 25 ++++++-----
 .../pulsar/broker/loadbalance/LoadReport.java      | 25 ++++++-----
 .../broker/loadbalance/LoadReportUpdaterTask.java  | 25 ++++++-----
 .../loadbalance/LoadResourceQuotaUpdaterTask.java  | 25 ++++++-----
 .../broker/loadbalance/LoadSheddingStrategy.java   | 25 ++++++-----
 .../broker/loadbalance/LoadSheddingTask.java       | 25 ++++++-----
 .../broker/loadbalance/ModularLoadManager.java     | 25 ++++++-----
 .../loadbalance/ModularLoadManagerStrategy.java    | 25 ++++++-----
 .../broker/loadbalance/PlacementStrategy.java      | 25 ++++++-----
 .../broker/loadbalance/ResourceDescription.java    | 25 ++++++-----
 .../pulsar/broker/loadbalance/ResourceUnit.java    | 25 ++++++-----
 .../pulsar/broker/loadbalance/ServiceRequest.java  | 25 ++++++-----
 .../pulsar/broker/loadbalance/ServiceUnit.java     | 25 ++++++-----
 .../loadbalance/impl/BrokerVersionFilter.java      | 25 ++++++-----
 .../broker/loadbalance/impl/DeviationShedder.java  | 25 ++++++-----
 .../impl/GenericBrokerHostUsageImpl.java           | 25 ++++++-----
 .../loadbalance/impl/LeastLongTermMessageRate.java | 25 ++++++-----
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java | 25 ++++++-----
 .../broker/loadbalance/impl/LoadManagerShared.java | 25 ++++++-----
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 25 ++++++-----
 .../impl/ModularLoadManagerWrapper.java            | 25 ++++++-----
 .../broker/loadbalance/impl/OverloadShedder.java   | 25 ++++++-----
 .../loadbalance/impl/PulsarLoadReportImpl.java     | 25 ++++++-----
 .../impl/PulsarResourceDescription.java            | 25 ++++++-----
 .../loadbalance/impl/PulsarServiceRequest.java     | 25 ++++++-----
 .../broker/loadbalance/impl/PulsarServiceUnit.java | 25 ++++++-----
 .../impl/ResourceAvailabilityRanker.java           | 25 ++++++-----
 .../loadbalance/impl/SimpleLoadCalculatorImpl.java | 25 ++++++-----
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 25 ++++++-----
 .../impl/SimpleResourceAllocationPolicies.java     | 25 ++++++-----
 .../loadbalance/impl/SimpleResourceUnit.java       | 25 ++++++-----
 .../loadbalance/impl/WRRPlacementStrategy.java     | 25 ++++++-----
 .../pulsar/broker/lookup/DestinationLookup.java    | 25 ++++++-----
 .../yahoo/pulsar/broker/lookup/LookupResult.java   | 25 ++++++-----
 .../yahoo/pulsar/broker/lookup/NamespaceData.java  | 25 ++++++-----
 .../yahoo/pulsar/broker/lookup/RedirectData.java   | 25 ++++++-----
 .../broker/namespace/NamespaceEphemeralData.java   | 25 ++++++-----
 .../pulsar/broker/namespace/NamespaceService.java  | 25 ++++++-----
 .../yahoo/pulsar/broker/namespace/OwnedBundle.java | 25 ++++++-----
 .../pulsar/broker/namespace/OwnershipCache.java    | 25 ++++++-----
 .../broker/namespace/ServiceUnitZkUtils.java       | 25 ++++++-----
 .../pulsar/broker/service/BacklogQuotaManager.java | 25 ++++++-----
 .../yahoo/pulsar/broker/service/BrokerService.java | 25 ++++++-----
 .../broker/service/BrokerServiceException.java     | 25 ++++++-----
 .../com/yahoo/pulsar/broker/service/Consumer.java  | 25 ++++++-----
 .../yahoo/pulsar/broker/service/Dispatcher.java    | 25 ++++++-----
 .../broker/service/DistributedIdGenerator.java     | 25 ++++++-----
 .../com/yahoo/pulsar/broker/service/Producer.java  | 25 ++++++-----
 .../broker/service/PulsarChannelInitializer.java   | 25 ++++++-----
 .../yahoo/pulsar/broker/service/PulsarStats.java   | 25 ++++++-----
 .../com/yahoo/pulsar/broker/service/ServerCnx.java | 25 ++++++-----
 .../yahoo/pulsar/broker/service/Subscription.java  | 25 ++++++-----
 .../com/yahoo/pulsar/broker/service/Topic.java     | 25 ++++++-----
 .../PersistentDispatcherMultipleConsumers.java     | 25 ++++++-----
 .../PersistentDispatcherSingleActiveConsumer.java  | 25 ++++++-----
 .../persistent/PersistentMessageExpiryMonitor.java | 25 ++++++-----
 .../persistent/PersistentMessageFinder.java        | 25 ++++++-----
 .../service/persistent/PersistentReplicator.java   | 25 ++++++-----
 .../service/persistent/PersistentSubscription.java | 25 ++++++-----
 .../broker/service/persistent/PersistentTopic.java | 25 ++++++-----
 .../broker/stats/AllocatorStatsGenerator.java      | 25 ++++++-----
 .../broker/stats/BookieClientStatsGenerator.java   | 25 ++++++-----
 .../broker/stats/BrokerOperabilityMetrics.java     | 25 ++++++-----
 .../broker/stats/ClusterReplicationMetrics.java    | 25 ++++++-----
 .../pulsar/broker/stats/MBeanStatsGenerator.java   | 25 ++++++-----
 .../pulsar/broker/stats/MetricsGenerator.java      | 25 ++++++-----
 .../yahoo/pulsar/broker/stats/NamespaceStats.java  | 25 ++++++-----
 .../pulsar/broker/stats/ReplicationMetrics.java    | 25 ++++++-----
 .../yahoo/pulsar/broker/stats/TopicLoadStats.java  | 25 ++++++-----
 .../broker/stats/metrics/AbstractMetrics.java      | 25 ++++++-----
 .../pulsar/broker/stats/metrics/JvmMetrics.java    | 25 ++++++-----
 .../stats/metrics/ManagedLedgerCacheMetrics.java   | 25 ++++++-----
 .../broker/stats/metrics/ManagedLedgerMetrics.java | 25 ++++++-----
 .../stats/prometheus/AggregatedNamespaceStats.java | 25 ++++++-----
 .../prometheus/AggregatedReplicationStats.java     | 25 ++++++-----
 .../stats/prometheus/NamespaceStatsAggregator.java | 25 ++++++-----
 .../prometheus/PrometheusMetricsGenerator.java     | 25 ++++++-----
 .../stats/prometheus/PrometheusMetricsServlet.java | 25 ++++++-----
 .../yahoo/pulsar/broker/web/ApiVersionFilter.java  | 25 ++++++-----
 .../pulsar/broker/web/AuthenticationFilter.java    | 25 ++++++-----
 .../pulsar/broker/web/NoSwaggerDocumentation.java  | 25 ++++++-----
 .../pulsar/broker/web/PulsarServerConnector.java   | 25 ++++++-----
 .../yahoo/pulsar/broker/web/PulsarWebResource.java | 25 ++++++-----
 .../pulsar/broker/web/ResponseHandlerFilter.java   | 25 ++++++-----
 .../com/yahoo/pulsar/broker/web/RestException.java | 25 ++++++-----
 .../com/yahoo/pulsar/broker/web/VipStatus.java     | 25 ++++++-----
 .../com/yahoo/pulsar/broker/web/WebService.java    | 25 ++++++-----
 .../pulsar/common/naming/NamespaceBundle.java      | 25 ++++++-----
 .../common/naming/NamespaceBundleFactory.java      | 25 ++++++-----
 .../pulsar/common/naming/NamespaceBundles.java     | 25 ++++++-----
 .../java/com/yahoo/pulsar/utils/CmdUtility.java    | 25 ++++++-----
 .../yahoo/pulsar/utils/CopyOnWriteArrayList.java   | 25 ++++++-----
 .../java/com/yahoo/pulsar/utils/NumberFormat.java  | 25 ++++++-----
 .../utils/PulsarBrokerVersionStringUtils.java      | 25 ++++++-----
 .../com/yahoo/pulsar/utils/PulsarKeyException.java | 25 ++++++-----
 .../yahoo/pulsar/utils/SimpleTextOutputStream.java | 25 ++++++-----
 .../com/yahoo/pulsar/utils/StatsOutputStream.java  | 25 ++++++-----
 .../com/yahoo/pulsar/PulsarBrokerStarterTest.java  | 25 ++++++-----
 .../com/yahoo/pulsar/broker/SLAMonitoringTest.java | 25 ++++++-----
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 25 ++++++-----
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   | 25 ++++++-----
 .../pulsar/broker/admin/MockServletContext.java    | 25 ++++++-----
 .../yahoo/pulsar/broker/admin/NamespacesTest.java  | 25 ++++++-----
 .../broker/auth/AuthenticationServiceTest.java     | 25 ++++++-----
 .../pulsar/broker/auth/AuthorizationTest.java      | 25 ++++++-----
 .../broker/auth/MockedPulsarServiceBaseTest.java   | 25 ++++++-----
 .../broker/auth/SameThreadOrderedSafeExecutor.java | 25 ++++++-----
 .../broker/cache/ResourceQuotaCacheTest.java       | 25 ++++++-----
 .../loadbalance/BrokerVersionFilterTest.java       | 25 ++++++-----
 .../broker/loadbalance/LoadBalancerTest.java       | 25 ++++++-----
 .../loadbalance/LoadBalancerTestingUtils.java      | 25 ++++++-----
 .../loadbalance/ModularLoadManagerImplTest.java    | 25 ++++++-----
 .../ModularLoadManagerStrategyTest.java            | 25 ++++++-----
 .../loadbalance/SimpleLoadManagerImplTest.java     | 25 ++++++-----
 .../lookup/http/HttpDestinationLookupv2Test.java   | 25 ++++++-----
 .../broker/namespace/NamespaceServiceTest.java     | 25 ++++++-----
 .../broker/namespace/OwnershipCacheTest.java       | 25 ++++++-----
 .../broker/service/AddMissingPatchVersionTest.java | 25 ++++++-----
 .../broker/service/AdvertisedAddressTest.java      | 25 ++++++-----
 .../broker/service/BacklogQuotaManagerTest.java    | 25 ++++++-----
 .../pulsar/broker/service/BatchMessageTest.java    | 25 ++++++-----
 .../pulsar/broker/service/BrokerServiceTest.java   | 25 ++++++-----
 .../service/BrokerServiceThrottlingTest.java       | 25 ++++++-----
 .../pulsar/broker/service/BrokerTestBase.java      | 25 ++++++-----
 .../broker/service/DistributedIdGeneratorTest.java | 25 ++++++-----
 .../broker/service/MessageIdSerialization.java     | 25 ++++++-----
 .../PersistentDispatcherFailoverConsumerTest.java  | 25 ++++++-----
 .../broker/service/PersistentFailoverE2ETest.java  | 25 ++++++-----
 .../service/PersistentMessageFinderTest.java       | 25 ++++++-----
 .../broker/service/PersistentQueueE2ETest.java     | 25 ++++++-----
 .../service/PersistentTopicConcurrentTest.java     | 25 ++++++-----
 .../broker/service/PersistentTopicE2ETest.java     | 25 ++++++-----
 .../pulsar/broker/service/PersistentTopicTest.java | 25 ++++++-----
 .../pulsar/broker/service/ReplicatorTest.java      | 25 ++++++-----
 .../pulsar/broker/service/ReplicatorTestBase.java  | 25 ++++++-----
 .../pulsar/broker/service/ResendRequestTest.java   | 25 ++++++-----
 .../yahoo/pulsar/broker/service/ServerCnxTest.java | 25 ++++++-----
 .../broker/service/TopicTerminationTest.java       | 25 ++++++-----
 .../broker/service/utils/ClientChannelHelper.java  | 25 ++++++-----
 .../stats/BookieClientsStatsGeneratorTest.java     | 25 ++++++-----
 .../broker/stats/ManagedLedgerMetricsTest.java     | 25 ++++++-----
 .../pulsar/broker/web/ApiVersionFilterTest.java    | 25 ++++++-----
 .../yahoo/pulsar/broker/web/WebServiceTest.java    | 25 ++++++-----
 .../ZooKeeperSessionExpireRecoveryTest.java        | 25 ++++++-----
 .../api/AuthenticatedProducerConsumerTest.java     | 25 ++++++-----
 .../pulsar/client/api/BrokerServiceLookupTest.java | 25 ++++++-----
 .../yahoo/pulsar/client/api/ClientErrorsTest.java  | 25 ++++++-----
 .../client/api/DispatcherBlockConsumerTest.java    | 25 ++++++-----
 .../yahoo/pulsar/client/api/MockBrokerService.java | 25 ++++++-----
 .../pulsar/client/api/MockBrokerServiceHooks.java  | 25 ++++++-----
 .../api/PartitionedProducerConsumerTest.java       | 25 ++++++-----
 .../pulsar/client/api/ProducerConsumerBase.java    | 25 ++++++-----
 .../client/api/SimpleProducerConsumerStatTest.java | 25 ++++++-----
 .../client/api/SimpleProducerConsumerTest.java     | 25 ++++++-----
 .../pulsar/client/api/TlsProducerConsumerTest.java | 25 ++++++-----
 .../yahoo/pulsar/client/api/TopicReaderTest.java   | 25 ++++++-----
 .../impl/BatchMessageIdImplSerializationTest.java  | 25 ++++++-----
 .../client/impl/BrokerClientIntegrationTest.java   | 25 ++++++-----
 .../client/impl/ConsumeBaseExceptionTest.java      | 26 ++++++------
 .../yahoo/pulsar/client/impl/MessageIdTest.java    | 25 ++++++-----
 .../PerMessageUnAcknowledgedRedeliveryTest.java    | 25 ++++++-----
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    | 25 ++++++-----
 .../pulsar/client/impl/ZeroQueueSizeTest.java      | 25 ++++++-----
 .../pulsar/common/naming/NamespaceBundleTest.java  | 25 ++++++-----
 .../pulsar/common/naming/NamespaceBundlesTest.java | 25 ++++++-----
 .../common/naming/ServiceConfigurationTest.java    | 25 ++++++-----
 .../service/web/DiscoveryServiceWebTest.java       | 25 ++++++-----
 .../stats/client/PulsarBrokerStatsClientTest.java  | 25 ++++++-----
 .../pulsar/utils/SimpleTextOutputStreamTest.java   | 25 ++++++-----
 .../yahoo/pulsar/utils/StatsOutputStreamTest.java  | 25 ++++++-----
 .../proxy/MockAuthenticationProvider.java          | 25 ++++++-----
 .../websocket/proxy/ProxyAuthenticationTest.java   | 26 ++++++------
 .../websocket/proxy/ProxyAuthorizationTest.java    | 25 ++++++-----
 .../websocket/proxy/ProxyPublishConsumeTest.java   | 25 ++++++-----
 .../websocket/proxy/ProxyPublishConsumeTls.java    | 25 ++++++-----
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    | 25 ++++++-----
 .../websocket/proxy/SimpleConsumerSocket.java      | 25 ++++++-----
 .../websocket/proxy/SimpleProducerSocket.java      | 25 ++++++-----
 .../java/org/testng/listener/TestListener.java     | 25 ++++++-----
 pulsar-checksum/pom.xml                            | 25 ++++++-----
 pulsar-checksum/src/main/assembly/assembly.xml     | 25 ++++++-----
 .../pulsar/checksum/utils/Crc32cChecksum.java      | 25 ++++++-----
 .../pulsar/checksum/utils/Crc32cSse42Provider.java | 25 ++++++-----
 .../yahoo/pulsar/checksum/utils/NativeUtils.java   | 25 ++++++-----
 .../pulsar/checksum/utils/Crc32cChecksumTest.java  | 25 ++++++-----
 .../pulsar/checksum/utils/NativeUtilsTests.java    | 25 ++++++-----
 pulsar-client-admin/pom.xml                        | 25 ++++++-----
 .../com/yahoo/pulsar/client/admin/BrokerStats.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/admin/Brokers.java     | 25 ++++++-----
 .../com/yahoo/pulsar/client/admin/Clusters.java    | 25 ++++++-----
 .../java/com/yahoo/pulsar/client/admin/Lookup.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/admin/Namespaces.java  | 25 ++++++-----
 .../pulsar/client/admin/PersistentTopics.java      | 25 ++++++-----
 .../com/yahoo/pulsar/client/admin/Properties.java  | 25 ++++++-----
 .../com/yahoo/pulsar/client/admin/PulsarAdmin.java | 25 ++++++-----
 .../pulsar/client/admin/PulsarAdminException.java  | 25 ++++++-----
 .../yahoo/pulsar/client/admin/ResourceQuotas.java  | 25 ++++++-----
 .../pulsar/client/admin/internal/BaseResource.java | 25 ++++++-----
 .../client/admin/internal/BrokerStatsImpl.java     | 25 ++++++-----
 .../pulsar/client/admin/internal/BrokersImpl.java  | 25 ++++++-----
 .../pulsar/client/admin/internal/ClustersImpl.java | 25 ++++++-----
 .../client/admin/internal/JacksonConfigurator.java | 25 ++++++-----
 .../pulsar/client/admin/internal/LookupImpl.java   | 25 ++++++-----
 .../client/admin/internal/NamespacesImpl.java      | 25 ++++++-----
 .../admin/internal/PersistentTopicsImpl.java       | 25 ++++++-----
 .../client/admin/internal/PropertiesImpl.java      | 25 ++++++-----
 .../client/admin/internal/ResourceQuotasImpl.java  | 25 ++++++-----
 pulsar-client-auth-athenz/pom.xml                  | 29 +++++++------
 .../client/impl/auth/AuthenticationAthenz.java     | 25 ++++++-----
 .../client/impl/auth/AuthenticationDataAthenz.java | 25 ++++++-----
 .../client/impl/auth/AuthenticationAthenzTest.java | 25 ++++++-----
 pulsar-client-cpp/CMakeLists.txt                   | 29 +++++++------
 pulsar-client-cpp/NOTICE                           | 29 +++++++------
 pulsar-client-cpp/eclipse-formatter.xml            | 27 ++++++------
 pulsar-client-cpp/examples/CMakeLists.txt          | 29 +++++++------
 pulsar-client-cpp/examples/SampleAsyncProducer.cc  | 26 ++++++------
 pulsar-client-cpp/examples/SampleConsumer.cc       | 26 ++++++------
 .../examples/SampleConsumerListener.cc             | 26 ++++++------
 pulsar-client-cpp/examples/SampleProducer.cc       | 26 ++++++------
 pulsar-client-cpp/generate_protobuf.sh             | 25 ++++++-----
 pulsar-client-cpp/include/pulsar/Authentication.h  | 26 ++++++------
 pulsar-client-cpp/include/pulsar/BatchMessageId.h  | 26 ++++++------
 .../include/pulsar/BrokerConsumerStats.h           | 26 ++++++------
 pulsar-client-cpp/include/pulsar/Client.h          | 26 ++++++------
 .../include/pulsar/ClientConfiguration.h           | 26 ++++++------
 pulsar-client-cpp/include/pulsar/CompressionType.h | 26 ++++++------
 pulsar-client-cpp/include/pulsar/Consumer.h        | 26 ++++++------
 .../include/pulsar/ConsumerConfiguration.h         | 26 ++++++------
 pulsar-client-cpp/include/pulsar/ConsumerType.h    | 26 ++++++------
 pulsar-client-cpp/include/pulsar/Message.h         | 26 ++++++------
 pulsar-client-cpp/include/pulsar/MessageBuilder.h  | 26 ++++++------
 pulsar-client-cpp/include/pulsar/MessageId.h       | 26 ++++++------
 .../include/pulsar/MessageRoutingPolicy.h          | 26 ++++++------
 pulsar-client-cpp/include/pulsar/Producer.h        | 26 ++++++------
 .../include/pulsar/ProducerConfiguration.h         | 26 ++++++------
 pulsar-client-cpp/include/pulsar/Result.h          | 26 ++++++------
 pulsar-client-cpp/lib/Authentication.cc            | 26 ++++++------
 pulsar-client-cpp/lib/Backoff.cc                   | 26 ++++++------
 pulsar-client-cpp/lib/Backoff.h                    | 26 ++++++------
 .../lib/BatchAcknowledgementTracker.cc             | 26 ++++++------
 .../lib/BatchAcknowledgementTracker.h              | 26 ++++++------
 pulsar-client-cpp/lib/BatchMessageContainer.cc     | 26 ++++++------
 pulsar-client-cpp/lib/BatchMessageContainer.h      | 26 ++++++------
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  | 26 ++++++------
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   | 26 ++++++------
 pulsar-client-cpp/lib/BlockingQueue.h              | 26 ++++++------
 pulsar-client-cpp/lib/BrokerConsumerStats.cc       | 26 ++++++------
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.cc   | 26 ++++++------
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.h    | 26 ++++++------
 .../lib/BrokerConsumerStatsImplBase.h              | 26 ++++++------
 pulsar-client-cpp/lib/CMakeLists.txt               | 29 +++++++------
 pulsar-client-cpp/lib/Client.cc                    | 26 ++++++------
 pulsar-client-cpp/lib/ClientConfiguration.cc       | 26 ++++++------
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    | 26 ++++++------
 pulsar-client-cpp/lib/ClientConnection.cc          | 26 ++++++------
 pulsar-client-cpp/lib/ClientConnection.h           | 26 ++++++------
 pulsar-client-cpp/lib/ClientImpl.cc                | 26 ++++++------
 pulsar-client-cpp/lib/ClientImpl.h                 | 26 ++++++------
 pulsar-client-cpp/lib/Commands.cc                  | 26 ++++++------
 pulsar-client-cpp/lib/Commands.h                   | 26 ++++++------
 pulsar-client-cpp/lib/CompressionCodec.cc          | 26 ++++++------
 pulsar-client-cpp/lib/CompressionCodec.h           | 26 ++++++------
 pulsar-client-cpp/lib/CompressionCodecLZ4.cc       | 26 ++++++------
 pulsar-client-cpp/lib/CompressionCodecLZ4.h        | 26 ++++++------
 pulsar-client-cpp/lib/CompressionCodecZLib.cc      | 26 ++++++------
 pulsar-client-cpp/lib/CompressionCodecZLib.h       | 26 ++++++------
 pulsar-client-cpp/lib/ConnectionPool.cc            | 26 ++++++------
 pulsar-client-cpp/lib/ConnectionPool.h             | 26 ++++++------
 pulsar-client-cpp/lib/Consumer.cc                  | 26 ++++++------
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     | 26 ++++++------
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  | 26 ++++++------
 pulsar-client-cpp/lib/ConsumerImpl.cc              | 26 ++++++------
 pulsar-client-cpp/lib/ConsumerImpl.h               | 26 ++++++------
 pulsar-client-cpp/lib/ConsumerImplBase.h           | 26 ++++++------
 pulsar-client-cpp/lib/DestinationName.cc           | 26 ++++++------
 pulsar-client-cpp/lib/DestinationName.h            | 26 ++++++------
 pulsar-client-cpp/lib/ExecutorService.cc           | 26 ++++++------
 pulsar-client-cpp/lib/ExecutorService.h            | 26 ++++++------
 pulsar-client-cpp/lib/Future.h                     | 26 ++++++------
 pulsar-client-cpp/lib/HTTPLookupService.cc         | 25 ++++++-----
 pulsar-client-cpp/lib/HTTPLookupService.h          | 26 ++++++------
 pulsar-client-cpp/lib/HandlerBase.cc               | 26 ++++++------
 pulsar-client-cpp/lib/HandlerBase.h                | 26 ++++++------
 pulsar-client-cpp/lib/Latch.cc                     | 26 ++++++------
 pulsar-client-cpp/lib/Latch.h                      | 26 ++++++------
 pulsar-client-cpp/lib/LogUtils.cc                  | 26 ++++++------
 pulsar-client-cpp/lib/LogUtils.h                   | 26 ++++++------
 pulsar-client-cpp/lib/LookupDataResult.h           | 26 ++++++------
 pulsar-client-cpp/lib/LookupService.h              | 26 ++++++------
 pulsar-client-cpp/lib/Message.cc                   | 26 ++++++------
 pulsar-client-cpp/lib/MessageBuilder.cc            | 26 ++++++------
 pulsar-client-cpp/lib/MessageId.cc                 | 26 ++++++------
 pulsar-client-cpp/lib/MessageImpl.cc               | 26 ++++++------
 pulsar-client-cpp/lib/MessageImpl.h                | 26 ++++++------
 pulsar-client-cpp/lib/NamedEntity.cc               | 26 ++++++------
 pulsar-client-cpp/lib/NamedEntity.h                | 26 ++++++------
 pulsar-client-cpp/lib/NamespaceName.cc             | 26 ++++++------
 pulsar-client-cpp/lib/NamespaceName.h              | 26 ++++++------
 pulsar-client-cpp/lib/ObjectPool.h                 | 26 ++++++------
 .../lib/PartitionedBrokerConsumerStatsImpl.cc      | 26 ++++++------
 .../lib/PartitionedBrokerConsumerStatsImpl.h       | 26 ++++++------
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   | 26 ++++++------
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    | 26 ++++++------
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   | 26 ++++++------
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    | 26 ++++++------
 pulsar-client-cpp/lib/Producer.cc                  | 26 ++++++------
 pulsar-client-cpp/lib/ProducerConfiguration.cc     | 26 ++++++------
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  | 26 ++++++------
 pulsar-client-cpp/lib/ProducerImpl.cc              | 26 ++++++------
 pulsar-client-cpp/lib/ProducerImpl.h               | 26 ++++++------
 pulsar-client-cpp/lib/ProducerImplBase.h           | 26 ++++++------
 pulsar-client-cpp/lib/Result.cc                    | 26 ++++++------
 pulsar-client-cpp/lib/RoundRobinMessageRouter.cc   | 26 ++++++------
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    | 26 ++++++------
 pulsar-client-cpp/lib/ServiceUnitId.h              | 26 ++++++------
 pulsar-client-cpp/lib/SharedBuffer.h               | 26 ++++++------
 .../lib/SinglePartitionMessageRouter.cc            | 26 ++++++------
 .../lib/SinglePartitionMessageRouter.h             | 26 ++++++------
 .../lib/UnAckedMessageTrackerDisabled.h            | 26 ++++++------
 .../lib/UnAckedMessageTrackerEnabled.cc            | 26 ++++++------
 .../lib/UnAckedMessageTrackerEnabled.h             | 26 ++++++------
 .../lib/UnAckedMessageTrackerInterface.h           | 26 ++++++------
 pulsar-client-cpp/lib/UnboundedBlockingQueue.h     | 26 ++++++------
 pulsar-client-cpp/lib/Url.cc                       | 26 ++++++------
 pulsar-client-cpp/lib/Url.h                        | 26 ++++++------
 pulsar-client-cpp/lib/UtilAllocator.h              | 26 ++++++------
 pulsar-client-cpp/lib/Utils.h                      | 26 ++++++------
 pulsar-client-cpp/lib/Version.h                    | 26 ++++++------
 pulsar-client-cpp/lib/auth/AuthTls.cc              | 26 ++++++------
 pulsar-client-cpp/lib/auth/AuthTls.h               | 26 ++++++------
 pulsar-client-cpp/lib/checksum/ChecksumProvider.cc | 26 ++++++------
 pulsar-client-cpp/lib/checksum/ChecksumProvider.h  | 26 ++++++------
 pulsar-client-cpp/log4cxx.conf                     | 25 ++++++-----
 pulsar-client-cpp/perf/CMakeLists.txt              | 29 +++++++------
 pulsar-client-cpp/perf/PerfConsumer.cc             | 26 ++++++------
 pulsar-client-cpp/perf/PerfProducer.cc             | 26 ++++++------
 pulsar-client-cpp/perf/RateLimiter.h               | 26 ++++++------
 pulsar-client-cpp/python/CMakeLists.txt            | 29 +++++++------
 pulsar-client-cpp/python/pulsar.py                 | 25 ++++++-----
 pulsar-client-cpp/python/pulsar_test.py            | 25 ++++++-----
 pulsar-client-cpp/python/setup.py                  | 25 ++++++-----
 pulsar-client-cpp/python/src/authentication.cc     | 26 ++++++------
 pulsar-client-cpp/python/src/client.cc             | 26 ++++++------
 pulsar-client-cpp/python/src/config.cc             | 26 ++++++------
 pulsar-client-cpp/python/src/consumer.cc           | 26 ++++++------
 pulsar-client-cpp/python/src/enums.cc              | 26 ++++++------
 pulsar-client-cpp/python/src/message.cc            | 26 ++++++------
 pulsar-client-cpp/python/src/producer.cc           | 26 ++++++------
 pulsar-client-cpp/python/src/pulsar.cc             | 26 ++++++------
 pulsar-client-cpp/python/src/utils.h               | 25 ++++++-----
 pulsar-client-cpp/python/test_consumer.py          | 25 ++++++-----
 pulsar-client-cpp/python/test_producer.py          | 25 ++++++-----
 pulsar-client-cpp/tests/AuthPluginTest.cc          | 26 ++++++------
 pulsar-client-cpp/tests/BackoffTest.cc             | 26 ++++++------
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       | 26 ++++++------
 pulsar-client-cpp/tests/BatchMessageTest.cc        | 26 ++++++------
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc | 26 ++++++------
 pulsar-client-cpp/tests/BlockingQueueTest.cc       | 26 ++++++------
 pulsar-client-cpp/tests/CMakeLists.txt             | 29 +++++++------
 pulsar-client-cpp/tests/ClientTest.cc              | 26 ++++++------
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       | 26 ++++++------
 pulsar-client-cpp/tests/ConsumerTest.cc            | 26 ++++++------
 pulsar-client-cpp/tests/ConsumerTest.h             | 26 ++++++------
 pulsar-client-cpp/tests/CustomRoutingPolicy.h      | 26 ++++++------
 pulsar-client-cpp/tests/DestinationNameTest.cc     | 26 ++++++------
 pulsar-client-cpp/tests/HttpHelper.cc              | 26 ++++++------
 pulsar-client-cpp/tests/HttpHelper.h               | 26 ++++++------
 pulsar-client-cpp/tests/LatchTest.cc               | 26 ++++++------
 pulsar-client-cpp/tests/LoggerTest.cc              | 26 ++++++------
 pulsar-client-cpp/tests/MessageTest.cc             | 26 ++++++------
 pulsar-client-cpp/tests/NamespaceNameTest.cc       | 26 ++++++------
 pulsar-client-cpp/tests/ProducerTest.cc            | 26 ++++++------
 pulsar-client-cpp/tests/PulsarFriend.h             | 26 ++++++------
 pulsar-client-cpp/tests/UrlTest.cc                 | 26 ++++++------
 pulsar-client-cpp/tests/authentication.conf        | 25 ++++++-----
 pulsar-client-cpp/tests/client.conf                | 25 ++++++-----
 pulsar-client-cpp/tests/main.cc                    | 26 ++++++------
 pulsar-client-cpp/tests/standalone.conf            | 31 +++++++-------
 pulsar-client-cpp/travis-build.sh                  | 25 ++++++-----
 pulsar-client-cpp/wireshark/moduleinfo.h           | 26 ++++++------
 pulsar-client-cpp/wireshark/pulsarDissector.cc     | 26 ++++++------
 pulsar-client-tools/pom.xml                        | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/CliCommand.java     | 25 ++++++-----
 .../java/com/yahoo/pulsar/admin/cli/CmdBase.java   | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/CmdBrokerStats.java | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/CmdBrokers.java     | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/CmdClusters.java    | 25 ++++++-----
 .../admin/cli/CmdNamespaceIsolationPolicy.java     | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/CmdNamespaces.java  | 25 ++++++-----
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/CmdProperties.java  | 25 ++++++-----
 .../yahoo/pulsar/admin/cli/CmdResourceQuotas.java  | 25 ++++++-----
 .../yahoo/pulsar/admin/cli/PulsarAdminTool.java    | 25 ++++++-----
 .../com/yahoo/pulsar/admin/cli/utils/IOUtils.java  | 26 ++++++------
 .../cli/utils/NameValueParameterSplitter.java      | 25 ++++++-----
 .../com/yahoo/pulsar/client/cli/CmdConsume.java    | 25 ++++++-----
 .../com/yahoo/pulsar/client/cli/CmdProduce.java    | 25 ++++++-----
 .../yahoo/pulsar/client/cli/PulsarClientTool.java  | 25 ++++++-----
 .../pulsar/admin/cli/PulsarAdminToolTest.java      | 25 ++++++-----
 .../yahoo/pulsar/admin/cli/utils/IOUtilsTest.java  | 25 ++++++-----
 .../cli/utils/NameValueParameterSplitterTest.java  | 25 ++++++-----
 .../pulsar/client/cli/PulsarClientToolTest.java    | 25 ++++++-----
 pulsar-client/pom.xml                              | 29 +++++++------
 .../yahoo/pulsar/client/api/Authentication.java    | 25 ++++++-----
 .../client/api/AuthenticationDataProvider.java     | 25 ++++++-----
 .../pulsar/client/api/AuthenticationFactory.java   | 25 ++++++-----
 .../pulsar/client/api/ClientConfiguration.java     | 25 ++++++-----
 .../yahoo/pulsar/client/api/CompressionType.java   | 25 ++++++-----
 .../java/com/yahoo/pulsar/client/api/Consumer.java | 25 ++++++-----
 .../pulsar/client/api/ConsumerConfiguration.java   | 25 ++++++-----
 .../java/com/yahoo/pulsar/client/api/Message.java  | 25 ++++++-----
 .../yahoo/pulsar/client/api/MessageBuilder.java    | 25 ++++++-----
 .../com/yahoo/pulsar/client/api/MessageId.java     | 25 ++++++-----
 .../yahoo/pulsar/client/api/MessageListener.java   | 25 ++++++-----
 .../com/yahoo/pulsar/client/api/MessageRouter.java | 25 ++++++-----
 .../java/com/yahoo/pulsar/client/api/Producer.java | 25 ++++++-----
 .../pulsar/client/api/ProducerConfiguration.java   | 25 ++++++-----
 .../com/yahoo/pulsar/client/api/PulsarClient.java  | 25 ++++++-----
 .../pulsar/client/api/PulsarClientException.java   | 25 ++++++-----
 .../java/com/yahoo/pulsar/client/api/Reader.java   | 25 ++++++-----
 .../pulsar/client/api/ReaderConfiguration.java     | 25 ++++++-----
 .../yahoo/pulsar/client/api/ReaderListener.java    | 25 ++++++-----
 .../yahoo/pulsar/client/api/SubscriptionType.java  | 25 ++++++-----
 .../java/com/yahoo/pulsar/client/impl/Backoff.java | 25 ++++++-----
 .../pulsar/client/impl/BatchMessageContainer.java  | 25 ++++++-----
 .../pulsar/client/impl/BatchMessageIdImpl.java     | 25 ++++++-----
 .../client/impl/BinaryProtoLookupService.java      | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    | 25 ++++++-----
 .../yahoo/pulsar/client/impl/ConnectionPool.java   | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ConsumerId.java   | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 25 ++++++-----
 .../yahoo/pulsar/client/impl/ConsumerStats.java    | 25 ++++++-----
 .../pulsar/client/impl/ConsumerStatsDisabled.java  | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/HandlerBase.java  | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/HttpClient.java   | 25 ++++++-----
 .../pulsar/client/impl/HttpLookupService.java      | 25 ++++++-----
 .../yahoo/pulsar/client/impl/LookupService.java    | 25 ++++++-----
 .../pulsar/client/impl/MessageBuilderImpl.java     | 25 ++++++-----
 .../yahoo/pulsar/client/impl/MessageIdImpl.java    | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/MessageImpl.java  | 25 ++++++-----
 .../client/impl/PartitionedConsumerImpl.java       | 25 ++++++-----
 .../client/impl/PartitionedProducerImpl.java       | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ProducerBase.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java | 25 ++++++-----
 .../yahoo/pulsar/client/impl/ProducerStats.java    | 25 ++++++-----
 .../pulsar/client/impl/ProducerStatsDisabled.java  | 25 ++++++-----
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/ReaderImpl.java   | 25 ++++++-----
 .../impl/RoundRobinPartitionMessageRouterImpl.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/impl/SendCallback.java | 25 ++++++-----
 .../impl/SinglePartitionMessageRouterImpl.java     | 25 ++++++-----
 .../pulsar/client/impl/UnAckedMessageTracker.java  | 25 ++++++-----
 .../client/impl/auth/AuthenticationDataNull.java   | 25 ++++++-----
 .../client/impl/auth/AuthenticationDataTls.java    | 25 ++++++-----
 .../client/impl/auth/AuthenticationDisabled.java   | 25 ++++++-----
 .../pulsar/client/impl/auth/AuthenticationTls.java | 25 ++++++-----
 .../yahoo/pulsar/client/util/ExecutorProvider.java | 25 ++++++-----
 .../com/yahoo/pulsar/client/util/FutureUtil.java   | 25 ++++++-----
 pulsar-client/src/main/javadoc/overview.html       | 25 ++++++-----
 .../yahoo/pulsar/client/api/ConsumerIdTest.java    | 26 ++++++------
 .../com/yahoo/pulsar/client/api/MessageIdTest.java | 26 ++++++------
 .../com/yahoo/pulsar/client/impl/BackoffTest.java  | 26 ++++++------
 .../pulsar/client/impl/BatchMessageIdImplTest.java | 25 ++++++-----
 .../client/tutorial/ContinuousAsyncProducer.java   | 25 ++++++-----
 .../pulsar/client/tutorial/ContinuousProducer.java | 25 ++++++-----
 .../client/tutorial/SampleAsyncProducer.java       | 25 ++++++-----
 .../pulsar/client/tutorial/SampleConsumer.java     | 25 ++++++-----
 .../client/tutorial/SampleConsumerListener.java    | 25 ++++++-----
 .../pulsar/client/tutorial/SampleProducer.java     | 25 ++++++-----
 pulsar-common/generate_protobuf.sh                 | 25 ++++++-----
 pulsar-common/pom.xml                              | 25 ++++++-----
 .../java/com/yahoo/pulsar/common/api/Commands.java | 25 ++++++-----
 .../com/yahoo/pulsar/common/api/DoubleByteBuf.java | 25 ++++++-----
 .../com/yahoo/pulsar/common/api/PulsarDecoder.java | 25 ++++++-----
 .../com/yahoo/pulsar/common/api/PulsarHandler.java | 25 ++++++-----
 .../common/api/PulsarLengthFieldFrameDecoder.java  | 25 ++++++-----
 .../common/compression/CompressionCodec.java       | 25 ++++++-----
 .../common/compression/CompressionCodecLZ4.java    | 25 ++++++-----
 .../common/compression/CompressionCodecNone.java   | 25 ++++++-----
 .../compression/CompressionCodecProvider.java      | 25 ++++++-----
 .../common/compression/CompressionCodecZLib.java   | 25 ++++++-----
 .../pulsar/common/lookup/data/LookupData.java      | 25 ++++++-----
 .../pulsar/common/naming/DestinationDomain.java    | 25 ++++++-----
 .../pulsar/common/naming/DestinationName.java      | 25 ++++++-----
 .../yahoo/pulsar/common/naming/NamedEntity.java    | 25 ++++++-----
 .../yahoo/pulsar/common/naming/NamespaceName.java  | 25 ++++++-----
 .../yahoo/pulsar/common/naming/ServiceUnitId.java  | 25 ++++++-----
 .../common/partition/PartitionedTopicMetadata.java | 25 ++++++-----
 .../pulsar/common/policies/AutoFailoverPolicy.java | 25 ++++++-----
 .../common/policies/NamespaceIsolationPolicy.java  | 25 ++++++-----
 .../pulsar/common/policies/data/AuthAction.java    | 25 ++++++-----
 .../pulsar/common/policies/data/AuthPolicies.java  | 25 ++++++-----
 .../policies/data/AutoFailoverPolicyData.java      | 25 ++++++-----
 .../policies/data/AutoFailoverPolicyType.java      | 25 ++++++-----
 .../pulsar/common/policies/data/BacklogQuota.java  | 25 ++++++-----
 .../common/policies/data/BrokerAssignment.java     | 25 ++++++-----
 .../pulsar/common/policies/data/BrokerStatus.java  | 25 ++++++-----
 .../pulsar/common/policies/data/BundlesData.java   | 25 ++++++-----
 .../pulsar/common/policies/data/ClusterData.java   | 25 ++++++-----
 .../pulsar/common/policies/data/ConsumerStats.java | 25 ++++++-----
 .../pulsar/common/policies/data/ErrorData.java     | 25 ++++++-----
 .../pulsar/common/policies/data/LocalPolicies.java | 25 ++++++-----
 .../policies/data/NamespaceIsolationData.java      | 25 ++++++-----
 .../policies/data/NamespaceOwnershipStatus.java    | 25 ++++++-----
 .../policies/data/PartitionedTopicStats.java       | 25 ++++++-----
 .../common/policies/data/PersistencePolicies.java  | 25 ++++++-----
 .../policies/data/PersistentOfflineTopicStats.java | 25 ++++++-----
 .../policies/data/PersistentSubscriptionStats.java | 25 ++++++-----
 .../data/PersistentTopicInternalStats.java         | 25 ++++++-----
 .../common/policies/data/PersistentTopicStats.java | 25 ++++++-----
 .../pulsar/common/policies/data/Policies.java      | 25 ++++++-----
 .../pulsar/common/policies/data/PropertyAdmin.java | 25 ++++++-----
 .../common/policies/data/PublisherStats.java       | 25 ++++++-----
 .../common/policies/data/ReplicatorStats.java      | 25 ++++++-----
 .../pulsar/common/policies/data/ResourceQuota.java | 25 ++++++-----
 .../common/policies/data/RetentionPolicies.java    | 25 ++++++-----
 .../policies/data/loadbalancer/BrokerUsage.java    | 25 ++++++-----
 .../policies/data/loadbalancer/JvmUsage.java       | 25 ++++++-----
 .../policies/data/loadbalancer/LoadReport.java     | 25 ++++++-----
 .../data/loadbalancer/NamespaceBundleStats.java    | 25 ++++++-----
 .../NamespaceBundleStatsComparator.java            | 25 ++++++-----
 .../policies/data/loadbalancer/NamespaceUsage.java | 25 ++++++-----
 .../data/loadbalancer/ResourceUnitRanking.java     | 25 ++++++-----
 .../policies/data/loadbalancer/ResourceUsage.java  | 25 ++++++-----
 .../data/loadbalancer/ServiceLookupData.java       | 25 ++++++-----
 .../data/loadbalancer/SystemResourceUsage.java     | 25 ++++++-----
 .../policies/impl/AutoFailoverPolicyFactory.java   | 25 ++++++-----
 .../common/policies/impl/MinAvailablePolicy.java   | 25 ++++++-----
 .../policies/impl/NamespaceIsolationPolicies.java  | 25 ++++++-----
 .../impl/NamespaceIsolationPolicyImpl.java         | 25 ++++++-----
 .../yahoo/pulsar/common/stats/AllocatorStats.java  | 26 ++++++------
 .../com/yahoo/pulsar/common/stats/Metrics.java     | 25 ++++++-----
 .../java/com/yahoo/pulsar/common/util/Codec.java   | 25 ++++++-----
 .../com/yahoo/pulsar/common/util/FieldParser.java  | 25 ++++++-----
 .../yahoo/pulsar/common/util/KeyStoreHolder.java   | 25 ++++++-----
 .../pulsar/common/util/ObjectMapperFactory.java    | 25 ++++++-----
 .../yahoo/pulsar/common/util/SecurityUtility.java  | 25 ++++++-----
 .../util/collections/ConcurrentLongHashMap.java    | 25 ++++++-----
 .../util/collections/ConcurrentLongPairSet.java    | 25 ++++++-----
 .../util/collections/ConcurrentOpenHashMap.java    | 25 ++++++-----
 .../util/collections/ConcurrentOpenHashSet.java    | 25 ++++++-----
 .../collections/GrowableArrayBlockingQueue.java    | 25 ++++++-----
 .../util/protobuf/ByteBufCodedInputStream.java     | 25 ++++++-----
 .../util/protobuf/ByteBufCodedOutputStream.java    | 25 ++++++-----
 .../buffer/AbstractRecyclableDerivedByteBuf.java   | 25 ++++++-----
 .../netty/buffer/RecyclableDuplicateByteBuf.java   | 25 ++++++-----
 .../io/netty/buffer/RecyclableSlicedByteBuf.java   | 25 ++++++-----
 pulsar-common/src/main/proto/PulsarApi.proto       | 25 ++++++-----
 .../yahoo/pulsar/common/api/DoubleByteBufTest.java | 25 ++++++-----
 .../pulsar/common/compression/CommandsTest.java    | 25 ++++++-----
 .../common/compression/CompressorCodecTest.java    | 25 ++++++-----
 .../common/compression/Crc32cChecksumTest.java     | 25 ++++++-----
 .../pulsar/common/lookup/data/LookupDataTest.java  | 25 ++++++-----
 .../pulsar/common/naming/DestinationNameTest.java  | 25 ++++++-----
 .../pulsar/common/naming/NamespaceNameTest.java    | 25 ++++++-----
 .../policies/data/AutoFailoverPolicyDataTest.java  | 25 ++++++-----
 .../policies/data/AutoFailoverPolicyTypeTest.java  | 25 ++++++-----
 .../common/policies/data/BacklogQuotaTest.java     | 25 ++++++-----
 .../common/policies/data/ClusterDataTest.java      | 25 ++++++-----
 .../common/policies/data/LocalPolicesTest.java     | 25 ++++++-----
 .../policies/data/NamespaceIsolationDataTest.java  | 25 ++++++-----
 .../data/NamespaceOwnershipStatusTest.java         | 25 ++++++-----
 .../pulsar/common/policies/data/OldPolicies.java   | 25 ++++++-----
 .../policies/data/PartitionedTopicStatsTest.java   | 25 ++++++-----
 .../policies/data/PersistencePoliciesTest.java     | 25 ++++++-----
 .../data/PersistentOfflineTopicStatsTest.java      | 25 ++++++-----
 .../policies/data/PersistentTopicStatsTest.java    | 25 ++++++-----
 .../common/policies/data/PoliciesDataTest.java     | 25 ++++++-----
 .../common/policies/data/ReplicatorStatsTest.java  | 25 ++++++-----
 .../common/policies/data/ResourceQuotaTest.java    | 25 ++++++-----
 .../common/policies/data/RetentionPolicesTest.java | 25 ++++++-----
 .../impl/AutoFailoverPolicyFactoryTest.java        | 25 ++++++-----
 .../policies/impl/MinAvailablePolicyTest.java      | 25 ++++++-----
 .../impl/NamespaceIsolationPoliciesTest.java       | 25 ++++++-----
 .../impl/NamespaceIsolationPolicyImplTest.java     | 25 ++++++-----
 .../collections/ConcurrentLongHashMapTest.java     | 25 ++++++-----
 .../collections/ConcurrentLongPairSetTest.java     | 25 ++++++-----
 .../collections/ConcurrentOpenHashMapTest.java     | 25 ++++++-----
 .../collections/ConcurrentOpenHashSetTest.java     | 25 ++++++-----
 .../common/util/collections/FieldParserTest.java   | 25 ++++++-----
 .../GrowableArrayBlockingQueueTest.java            | 25 ++++++-----
 .../util/protobuf/ByteBufCodedInputStreamTest.java | 25 ++++++-----
 pulsar-discovery-service/pom.xml                   | 29 +++++++------
 .../discovery/service/BrokerDiscoveryProvider.java | 25 ++++++-----
 .../pulsar/discovery/service/DiscoveryService.java | 25 ++++++-----
 .../discovery/service/PulsarServerException.java   | 25 ++++++-----
 .../pulsar/discovery/service/ServerConnection.java | 25 ++++++-----
 .../service/ServiceChannelInitializer.java         | 25 ++++++-----
 .../service/server/DiscoveryServiceStarter.java    | 25 ++++++-----
 .../discovery/service/server/ServerManager.java    | 25 ++++++-----
 .../discovery/service/server/ServiceConfig.java    | 25 ++++++-----
 .../service/web/DiscoveryServiceServlet.java       | 25 ++++++-----
 .../discovery/service/web/RestException.java       | 25 ++++++-----
 .../service/web/ZookeeperCacheLoader.java          | 25 ++++++-----
 .../discovery/service/BaseDiscoveryTestSetup.java  | 25 ++++++-----
 .../discovery/service/DiscoveryServiceTest.java    | 25 ++++++-----
 .../service/server/DiscoveryServiceWebTest.java    | 25 ++++++-----
 .../discovery/service/web/BaseZKStarterTest.java   | 25 ++++++-----
 .../service/web/DiscoveryServiceWebTest.java       | 25 ++++++-----
 .../service/web/ZookeeperCacheLoaderTest.java      | 25 ++++++-----
 .../discovery/service/BaseDiscoveryTestSetup.java  | 25 ++++++-----
 .../discovery/service/DiscoveryServiceTest.java    | 25 ++++++-----
 .../service/server/DiscoveryServiceWebTest.java    | 25 ++++++-----
 .../discovery/service/web/BaseZKStarterTest.java   | 25 ++++++-----
 .../service/web/DiscoveryServiceWebTest.java       | 25 ++++++-----
 .../service/web/ZookeeperCacheLoaderTest.java      | 25 ++++++-----
 pulsar-spark/pom.xml                               | 29 +++++++------
 .../pulsar/spark/SparkStreamingPulsarReceiver.java | 26 ++++++------
 .../spark/SparkStreamingPulsarReceiverTest.java    | 25 ++++++-----
 .../SparkStreamingPulsarReceiverExample.java       | 26 ++++++------
 pulsar-storm/pom.xml                               | 29 +++++++------
 .../yahoo/pulsar/storm/MessageToValuesMapper.java  | 25 ++++++-----
 .../java/com/yahoo/pulsar/storm/PulsarBolt.java    | 25 ++++++-----
 .../pulsar/storm/PulsarBoltConfiguration.java      | 25 ++++++-----
 .../java/com/yahoo/pulsar/storm/PulsarSpout.java   | 25 ++++++-----
 .../pulsar/storm/PulsarSpoutConfiguration.java     | 25 ++++++-----
 .../pulsar/storm/PulsarStormConfiguration.java     | 25 ++++++-----
 .../com/yahoo/pulsar/storm/SharedPulsarClient.java | 25 ++++++-----
 .../yahoo/pulsar/storm/TupleToMessageMapper.java   | 25 ++++++-----
 pulsar-storm/src/main/javadoc/overview.html        | 25 ++++++-----
 .../yahoo/pulsar/storm/MockOutputCollector.java    | 25 ++++++-----
 .../pulsar/storm/MockSpoutOutputCollector.java     | 25 ++++++-----
 .../com/yahoo/pulsar/storm/PulsarBoltTest.java     | 25 ++++++-----
 .../com/yahoo/pulsar/storm/PulsarSpoutTest.java    | 25 ++++++-----
 .../test/java/com/yahoo/pulsar/storm/TestUtil.java | 25 ++++++-----
 .../yahoo/pulsar/storm/example/StormExample.java   | 25 ++++++-----
 pulsar-testclient/pom.xml                          | 25 ++++++-----
 .../socket/client/MockAuthenticationProvider.java  | 25 ++++++-----
 .../proxy/socket/client/PaddingDecimalFormat.java  | 25 ++++++-----
 .../proxy/socket/client/PerformanceClient.java     | 25 ++++++-----
 .../socket/client/SimpleTestProducerSocket.java    | 25 ++++++-----
 .../com/yahoo/pulsar/testclient/BrokerMonitor.java | 25 ++++++-----
 .../pulsar/testclient/LoadSimulationClient.java    | 25 ++++++-----
 .../testclient/LoadSimulationController.java       | 25 ++++++-----
 .../pulsar/testclient/PerformanceConsumer.java     | 25 ++++++-----
 .../pulsar/testclient/PerformanceProducer.java     | 25 ++++++-----
 .../yahoo/pulsar/testclient/PerformanceReader.java | 25 ++++++-----
 .../utils/FixedColumnLengthTableMaker.java         | 25 ++++++-----
 .../testclient/utils/PaddingDecimalFormat.java     | 25 ++++++-----
 pulsar-websocket/pom.xml                           | 29 +++++++------
 .../pulsar/websocket/AbstractWebSocketHandler.java | 25 ++++++-----
 .../yahoo/pulsar/websocket/ConsumerHandler.java    | 26 ++++++------
 .../yahoo/pulsar/websocket/ProducerHandler.java    | 25 ++++++-----
 .../pulsar/websocket/WebSocketConsumerServlet.java | 25 ++++++-----
 .../com/yahoo/pulsar/websocket/WebSocketError.java | 25 ++++++-----
 .../pulsar/websocket/WebSocketProducerServlet.java | 25 ++++++-----
 .../yahoo/pulsar/websocket/WebSocketService.java   | 25 ++++++-----
 .../pulsar/websocket/admin/RestException.java      | 25 ++++++-----
 .../websocket/admin/WebSocketProxyStats.java       | 25 ++++++-----
 .../websocket/admin/WebSocketWebResource.java      | 25 ++++++-----
 .../yahoo/pulsar/websocket/data/ConsumerAck.java   | 25 ++++++-----
 .../pulsar/websocket/data/ConsumerMessage.java     | 25 ++++++-----
 .../yahoo/pulsar/websocket/data/ProducerAck.java   | 25 ++++++-----
 .../pulsar/websocket/data/ProducerMessage.java     | 25 ++++++-----
 .../pulsar/websocket/service/ProxyServer.java      | 25 ++++++-----
 .../service/WebSocketProxyConfiguration.java       | 25 ++++++-----
 .../websocket/service/WebSocketServiceStarter.java | 25 ++++++-----
 .../yahoo/pulsar/websocket/stats/JvmMetrics.java   | 25 ++++++-----
 .../yahoo/pulsar/websocket/stats/ProxyStats.java   | 25 ++++++-----
 .../pulsar/websocket/stats/ProxyTopicStat.java     | 25 ++++++-----
 .../yahoo/pulsar/websocket/stats/StatsBuckets.java | 25 ++++++-----
 .../authentication/AuthenticationServiceTest.java  | 25 ++++++-----
 .../yahoo/pulsar/websocket/LookupProtocolTest.java | 25 ++++++-----
 pulsar-zookeeper-utils/pom.xml                     | 29 +++++++------
 .../com/yahoo/pulsar/zookeeper/BookieInfo.java     | 25 ++++++-----
 .../com/yahoo/pulsar/zookeeper/Deserializers.java  | 25 ++++++-----
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     | 25 ++++++-----
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 25 ++++++-----
 .../pulsar/zookeeper/LocalZooKeeperCache.java      | 25 ++++++-----
 .../zookeeper/LocalZooKeeperConnectionService.java | 25 ++++++-----
 .../zookeeper/ZkBookieRackAffinityMapping.java     | 25 ++++++-----
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   | 25 ++++++-----
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java | 25 ++++++-----
 .../pulsar/zookeeper/ZooKeeperCacheListener.java   | 25 ++++++-----
 .../pulsar/zookeeper/ZooKeeperCacheWatcher.java    | 25 ++++++-----
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java   | 25 ++++++-----
 .../pulsar/zookeeper/ZooKeeperClientFactory.java   | 25 ++++++-----
 .../yahoo/pulsar/zookeeper/ZooKeeperDataCache.java | 25 ++++++-----
 .../pulsar/zookeeper/ZooKeeperSessionWatcher.java  | 25 ++++++-----
 .../zookeeper/ZookeeperClientFactoryImpl.java      | 25 ++++++-----
 .../yahoo/pulsar/zookeeper/DeserializersTest.java  | 25 ++++++-----
 .../zookeeper/LocalBookkeeperEnsembleTest.java     | 25 ++++++-----
 .../LocalZooKeeperConnectionServiceTest.java       | 25 ++++++-----
 .../MockedZooKeeperClientFactoryImpl.java          | 25 ++++++-----
 .../zookeeper/ZkBookieRackAffinityMappingTest.java | 25 ++++++-----
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java | 25 ++++++-----
 .../zookeeper/ZooKeeperSessionWatcherTest.java     | 25 ++++++-----
 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java | 25 ++++++-----
 .../zookeeper/ZookeeperClientFactoryImplTest.java  | 25 ++++++-----
 .../pulsar/zookeeper/ZookeeperServerTest.java      | 25 ++++++-----
 pulsar-zookeeper/pom.xml                           | 25 ++++++-----
 .../zookeeper/FinalRequestProcessorAspect.java     | 25 ++++++-----
 .../pulsar/zookeeper/ZooKeeperServerAspect.java    | 25 ++++++-----
 .../yahoo/pulsar/zookeeper/ZooKeeperStarter.java   | 25 ++++++-----
 src/findbugs-exclude.xml                           | 25 ++++++-----
 src/formatter.xml                                  | 25 ++++++-----
 src/license-header.txt                             | 25 ++++++-----
 898 files changed, 12630 insertions(+), 10127 deletions(-)

commit c0ba223b9729ad20c3d77cc168f3a41c41923b59
Author: Rajan <rdhabalia@apache.org>
Date:   Wed Jun 21 21:57:15 2017 -0700

    Fix testDisconnectClientWithoutClosingConnection (#516)

 .../com/yahoo/pulsar/client/impl/BrokerClientIntegrationTest.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit afd64dfce35647957399da2c9ab0b275c1d022f2
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 21 15:34:05 2017 -0700

    Only throw Python exception when the current thread is holding the GIL (#513)

 pulsar-client-cpp/python/src/client.cc   | 24 +++++++++++++--
 pulsar-client-cpp/python/src/consumer.cc | 52 +++++++++++++++++++++++++++-----
 pulsar-client-cpp/python/src/producer.cc | 17 ++++++++---
 pulsar-client-cpp/python/src/pulsar.cc   |  3 +-
 4 files changed, 80 insertions(+), 16 deletions(-)

commit 2ca1a7a9b0e9db66af6d2c71c64b6e66c8797cb7
Author: Rajan <rdhabalia@apache.org>
Date:   Wed Jun 21 11:33:06 2017 -0700

    fix AdminApi test by creating separate mock-pulsar instances for different broker (#512)

 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 58 +++++++++++++---------
 1 file changed, 35 insertions(+), 23 deletions(-)

commit c7d982beef1e190163658e29cd177eeda4c90649
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Wed Jun 21 09:55:08 2017 -0700

    Add authetication by http header in WebSocket performance tool (#505)

 .../proxy/socket/client/PerformanceClient.java     | 25 ++++++++++++++++++++--
 1 file changed, 23 insertions(+), 2 deletions(-)

commit d746024695b2ff6aa7bd3a1c93f9a652f9c26ddc
Author: Rajan <rdhabalia@apache.org>
Date:   Tue Jun 20 21:59:50 2017 -0700

    Fix testConsumerBlockingWithUnAckedMessagesAndRedelivery : add strategically retry (#510)

 .../client/api/DispatcherBlockConsumerTest.java    | 129 +++++++++++++--------
 1 file changed, 81 insertions(+), 48 deletions(-)

commit fde9b6cdd704039d2b5085dbd0c53c1c8e03942a
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 20 17:34:29 2017 -0700

    Redirect standalone broker logs to file during C++ unit tests (#508)

 pulsar-client-cpp/travis-build.sh | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

commit 3f39a61dba856bc8544111b5d912bbca237a3c89
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Tue Jun 20 17:00:25 2017 -0700

    Add connectionsPerBroker setting to WebSocket proxy (#497)

 conf/broker.conf                                          | 14 +++++++++++---
 conf/standalone.conf                                      | 11 +++++++++++
 conf/websocket.conf                                       |  6 ++++++
 .../com/yahoo/pulsar/broker/ServiceConfiguration.java     | 14 ++++++++++++++
 .../java/com/yahoo/pulsar/websocket/WebSocketService.java |  6 +++++-
 .../websocket/service/WebSocketProxyConfiguration.java    | 15 +++++++++++++--
 6 files changed, 60 insertions(+), 6 deletions(-)

commit a45ffe25572e5d896eac2a03a480344b5067a9eb
Author: Rajan <rdhabalia@apache.org>
Date:   Tue Jun 20 14:16:23 2017 -0700

    Add max per-broker unacked message limit (#420)
    
    * Add max per-broker unacked message limit
    
    * default disable perBrokerMaxDispatcher limit
    
    * replace LongAdder with atomicInteger to track per-broker unack messages

 conf/broker.conf                                   |  11 +
 conf/standalone.conf                               |  11 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  26 ++
 .../yahoo/pulsar/broker/service/BrokerService.java | 148 ++++++++-
 .../PersistentDispatcherMultipleConsumers.java     |  31 +-
 .../client/api/DispatcherBlockConsumerTest.java    | 353 +++++++++++++++++++++
 6 files changed, 575 insertions(+), 5 deletions(-)

commit 02128c61e1a1f337a31c737bf49143c6150857cd
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 20 12:23:12 2017 -0700

    Add extra wait to avoid intermittent failures in OwnershipCacheTest (#503)

 .../java/com/yahoo/pulsar/broker/namespace/OwnershipCacheTest.java  | 6 ++++++
 1 file changed, 6 insertions(+)

commit e87d5f8d0b2bc61a789bc6029e249f42d4a34da8
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 20 12:18:48 2017 -0700

    Disabled load-dependent test in ModularLoadManagerImplTest (#502)

 .../loadbalance/ModularLoadManagerImplTest.java    | 24 ++++++++++++++--------
 1 file changed, 16 insertions(+), 8 deletions(-)

commit f4969b4e8d18ef7471d65b1eea8e53f699abf800
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 20 11:30:59 2017 -0700

    Refactor HttpLookupService to take ownership of HttpClient (#501)

 .../client/impl/BinaryProtoLookupService.java      | 25 ++++++++++-------
 .../pulsar/client/impl/HttpLookupService.java      | 31 +++++++++++++++-------
 .../yahoo/pulsar/client/impl/LookupService.java    | 14 +++++-----
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |  9 ++-----
 4 files changed, 45 insertions(+), 34 deletions(-)

commit 0797c4d362f3972bf90be788bd1a74421caafe28
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 20 11:30:04 2017 -0700

    Fixed tests timeouts for PartitionedProducerConsumerTest (#500)

 .../api/PartitionedProducerConsumerTest.java       | 38 +++++++++++++---------
 1 file changed, 23 insertions(+), 15 deletions(-)

commit 5b93f10d1c2bb7c1cbc2683f0466b77cf54f9b0d
Author: Rajan <rdhabalia@apache.org>
Date:   Tue Jun 20 09:41:46 2017 -0700

    add wagon-ssh-external extension (#499)

 pom.xml | 7 +++++++
 1 file changed, 7 insertions(+)

commit b643bd6162ced143661df4677abd64e3408da75d
Author: Rajan <rdhabalia@apache.org>
Date:   Mon Jun 19 23:18:43 2017 -0700

    Fix intermittent LoadBalancerTest due to unpredictable host usage (#498)

 .../test/java/com/yahoo/pulsar/broker/loadbalance/LoadBalancerTest.java | 2 --
 1 file changed, 2 deletions(-)

commit 120a3c4526c2622765915de7c723ea66ecc6e764
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 19 18:06:00 2017 -0700

    Fixed travis build script spaces (#493)

 .travis.yml                       |  3 +--
 pulsar-client-cpp/travis-build.sh | 20 ++++++++++++++++++--
 2 files changed, 19 insertions(+), 4 deletions(-)

commit cd8a7584f4e8448926a5f9cf8abc761fe592659b
Author: Luc Perkins <lucperkins@gmail.com>
Date:   Mon Jun 19 17:39:29 2017 -0700

    Modify Python docstrings to fit the pdoc format (#484)

 pulsar-client-cpp/python/pulsar.py | 539 +++++++++++++++++++++++--------------
 1 file changed, 330 insertions(+), 209 deletions(-)

commit 3c6e29aac123f2b3d52420bee6ff89dd97f42a68
Author: Rajan <rdhabalia@apache.org>
Date:   Mon Jun 19 17:35:56 2017 -0700

    add timeout for websocket testcase (#495)

 .../pulsar/proxy/authentication/AuthenticationServiceTest.java    | 4 ++--
 .../test/java/com/yahoo/pulsar/websocket/LookupProtocolTest.java  | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)

commit e1a703f3233159a4d80cb347176c3aa833a9c1f6
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 19 12:17:52 2017 -0700

    Use maven-3.5.0 in travis builds (#492)

 .travis.yml | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

commit b4ad43e76d30605f13c372b59bb2a6ff11246d13
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 19 10:36:11 2017 -0700

    Fixed NPE on load manager shutdown (#491)

 .../com/yahoo/pulsar/broker/PulsarService.java     |  4 ++--
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 11 +++++++---
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  4 ++++
 .../broker/auth/MockedPulsarServiceBaseTest.java   | 21 ++++++++++++------
 .../pulsar/broker/service/PersistentTopicTest.java | 25 +++++++++++++---------
 .../client/api/DispatcherBlockConsumerTest.java    | 24 ++++++++++-----------
 6 files changed, 55 insertions(+), 34 deletions(-)

commit 07d2daf4871da7b280b60d7fc71188e6cb8a4858
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jun 18 07:41:35 2017 -0700

    Shutdown load manager executor on pulsar service close (#489)

 .../main/java/com/yahoo/pulsar/broker/PulsarService.java | 16 ++++++++++------
 .../broker/loadbalance/impl/ModularLoadManagerImpl.java  | 16 +++++++++-------
 .../broker/loadbalance/impl/SimpleLoadManagerImpl.java   |  4 +++-
 3 files changed, 22 insertions(+), 14 deletions(-)

commit 02198296c266c1bd6c66f3f6c7c29a74e1e8c894
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Jun 18 07:40:44 2017 -0700

    Fixed race condition with NPE on Producer.closeAsync() (#490)

 .../src/main/java/com/yahoo/pulsar/client/impl/ProducerImpl.java      | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit d9c92e72da0c1462dda74ed96cc19d8a34605d7e
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jun 17 18:23:51 2017 -0700

    Shutdown zk cache executor on service shutdown (#487)

 pulsar-broker/src/main/java/com/yahoo/pulsar/broker/PulsarService.java | 1 +
 1 file changed, 1 insertion(+)

commit 3e4a3db8bc80bc4d31b59a6e6b8d6ec78305cd0e
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Jun 17 13:27:17 2017 -0700

    Bump version to 1.19-SNAPSHOT

 all/pom.xml                       | 2 +-
 managed-ledger/pom.xml            | 2 +-
 pom.xml                           | 2 +-
 pulsar-broker-auth-athenz/pom.xml | 2 +-
 pulsar-broker-common/pom.xml      | 2 +-
 pulsar-broker/pom.xml             | 2 +-
 pulsar-checksum/pom.xml           | 2 +-
 pulsar-client-admin/pom.xml       | 2 +-
 pulsar-client-auth-athenz/pom.xml | 2 +-
 pulsar-client-tools/pom.xml       | 2 +-
 pulsar-client/pom.xml             | 2 +-
 pulsar-common/pom.xml             | 2 +-
 pulsar-discovery-service/pom.xml  | 2 +-
 pulsar-spark/pom.xml              | 2 +-
 pulsar-storm/pom.xml              | 2 +-
 pulsar-testclient/pom.xml         | 2 +-
 pulsar-websocket/pom.xml          | 2 +-
 pulsar-zookeeper-utils/pom.xml    | 2 +-
 pulsar-zookeeper/pom.xml          | 2 +-
 19 files changed, 19 insertions(+), 19 deletions(-)

commit 658243b4a6f09719f23211af0b64a5d89aa22e9e
Author: rdhabalia <rdhabalia@yahoo-inc.com>
Date:   Fri Jun 16 18:41:18 2017 -0700

    Pulsar release v1.18

 all/pom.xml                       | 2 +-
 managed-ledger/pom.xml            | 2 +-
 pom.xml                           | 2 +-
 pulsar-broker-auth-athenz/pom.xml | 2 +-
 pulsar-broker-common/pom.xml      | 2 +-
 pulsar-broker/pom.xml             | 2 +-
 pulsar-checksum/pom.xml           | 2 +-
 pulsar-client-admin/pom.xml       | 2 +-
 pulsar-client-auth-athenz/pom.xml | 2 +-
 pulsar-client-tools/pom.xml       | 2 +-
 pulsar-client/pom.xml             | 2 +-
 pulsar-common/pom.xml             | 2 +-
 pulsar-discovery-service/pom.xml  | 2 +-
 pulsar-spark/pom.xml              | 2 +-
 pulsar-storm/pom.xml              | 2 +-
 pulsar-testclient/pom.xml         | 2 +-
 pulsar-websocket/pom.xml          | 2 +-
 pulsar-zookeeper-utils/pom.xml    | 2 +-
 pulsar-zookeeper/pom.xml          | 2 +-
 19 files changed, 19 insertions(+), 19 deletions(-)

commit c92abefd80d67039d966c6770aac14c52a70fed9
Author: Rajan <rdhabalia@apache.org>
Date:   Fri Jun 16 18:40:03 2017 -0700

    increment bookkeeper version (#486)

 all/pom.xml | 7 ++++++-
 pom.xml     | 8 +++++++-
 2 files changed, 13 insertions(+), 2 deletions(-)

commit 70b2a3523d9c7a5fa97f90767a2c1cbe989ec635
Author: Brad McMillen <brad@mcmillen.com>
Date:   Fri Jun 16 12:27:44 2017 -0700

    Remove bundle from the ephemeral preallocated map once it is loaded (#481)

 .../loadbalance/impl/ModularLoadManagerImpl.java   | 50 ++++++++++++++++++----
 1 file changed, 42 insertions(+), 8 deletions(-)

commit c0f8b0d48377ed35b46192179d60fafa2ccfb010
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Jun 15 16:26:32 2017 -0700

    Add debug statement for redelivery message for troubleshoot (#483)

 .../PersistentDispatcherMultipleConsumers.java       |  5 ++---
 .../util/collections/ConcurrentLongPairSet.java      | 20 ++++++++++++++++++++
 .../util/collections/ConcurrentLongPairSetTest.java  | 12 ++++++++++++
 3 files changed, 34 insertions(+), 3 deletions(-)

commit 3750e2eaf79f4d9f45a14a2e7e87453160375312
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 15 16:24:30 2017 -0700

    Pulsar Python client library (#468)

 docs/Documentation.md                          |   1 +
 docs/Python.md                                 | 331 ++++++++++++++++++
 pulsar-client-cpp/CMakeLists.txt               |  19 +-
 pulsar-client-cpp/README.md                    |  24 +-
 pulsar-client-cpp/lib/Message.cc               |   3 -
 pulsar-client-cpp/python/.gitignore            |   4 +
 pulsar-client-cpp/python/CMakeLists.txt        |  29 ++
 pulsar-client-cpp/python/pulsar.py             | 444 +++++++++++++++++++++++++
 pulsar-client-cpp/python/pulsar_test.py        | 122 +++++++
 pulsar-client-cpp/python/setup.py              |  70 ++++
 pulsar-client-cpp/python/src/authentication.cc |  29 ++
 pulsar-client-cpp/python/src/client.cc         |  45 +++
 pulsar-client-cpp/python/src/config.cc         | 125 +++++++
 pulsar-client-cpp/python/src/consumer.cc       |  86 +++++
 pulsar-client-cpp/python/src/enums.cc          |  76 +++++
 pulsar-client-cpp/python/src/message.cc        |  65 ++++
 pulsar-client-cpp/python/src/producer.cc       |  76 +++++
 pulsar-client-cpp/python/src/pulsar.cc         |  49 +++
 pulsar-client-cpp/python/src/utils.h           |  40 +++
 pulsar-client-cpp/python/test_consumer.py      |  29 ++
 pulsar-client-cpp/python/test_producer.py      |  36 ++
 21 files changed, 1689 insertions(+), 14 deletions(-)

commit 29b2dd1df7be7d2f643b40bc88a754749938854b
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Jun 15 13:12:07 2017 -0700

    Allow client(producer/consumer) to check topic stats (#482)

 .../pulsar/broker/admin/PersistentTopics.java      | 23 ++++++++++++++++++++--
 1 file changed, 21 insertions(+), 2 deletions(-)

commit 042521a7d6e7b2c6b1b3b00bbc52a8bc74dc7f66
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Jun 15 00:09:49 2017 -0700

    Fixed message rate out with batches to count messages/s (#466) (#474)

 .../com/yahoo/pulsar/broker/service/Consumer.java  |  8 +++--
 .../client/api/SimpleProducerConsumerStatTest.java | 37 ++++++++++++++++++++++
 2 files changed, 42 insertions(+), 3 deletions(-)

commit 8abafee5bc229d7e447aae3187885ab906c8290b
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 14 17:11:48 2017 -0700

    Correct outdated comments in code about wire protocol format (#477)
    
    Fixes: #428

 .../src/main/java/com/yahoo/pulsar/common/api/Commands.java          | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit 121ed54516983dd0ee01b7aafb1f26b1867cd5cb
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Thu Jun 15 04:45:25 2017 +0900

    Internal Producer/Consumer in WebSocketProxy should be closed asynchronously (#473)

 .../main/java/com/yahoo/pulsar/websocket/ConsumerHandler.java | 11 +++++++++--
 .../main/java/com/yahoo/pulsar/websocket/ProducerHandler.java |  9 ++++++++-
 2 files changed, 17 insertions(+), 3 deletions(-)

commit 17e6537053319b5a916f905b0e9eeacc7805afcb
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Jun 13 16:30:56 2017 -0700

    Add Docker images definition and instruction to deploy on Kubernetes (#443)

 docker/.gitignore                                  |    3 +
 docker/Dockerfile                                  |   35 +
 docker/build.sh                                    |   65 +
 docker/grafana/Dockerfile                          |   27 +
 docker/grafana/dashboards/bookkeeper.json          | 1523 ++++++++++++
 docker/grafana/dashboards/jvm.json                 | 2555 ++++++++++++++++++++
 docker/grafana/dashboards/namespace.json           | 1490 ++++++++++++
 docker/grafana/dashboards/prometheus.json          |  719 ++++++
 docker/grafana/dashboards/zookeeper.json           |  951 ++++++++
 docker/grafana/grafana.ini                         |   36 +
 docker/grafana/start.sh                            |   36 +
 docker/scripts/apply-config-from-env.py            |   60 +
 docker/scripts/generate-zookeeper-config.sh        |   53 +
 docker/scripts/pulsar-zookeeper-ruok.sh            |   26 +
 docs/Documentation.md                              |    1 +
 docs/Kubernetes.md                                 |  246 ++
 kubernetes/README.md                               |    6 +
 kubernetes/generic/bookie.yaml                     |  158 ++
 kubernetes/generic/broker.yaml                     |  118 +
 kubernetes/generic/monitoring.yaml                 |  194 ++
 kubernetes/generic/zookeeper.yaml                  |  144 ++
 kubernetes/google-container-engine/bookie.yaml     |  159 ++
 kubernetes/google-container-engine/broker.yaml     |  117 +
 kubernetes/google-container-engine/monitoring.yaml |  212 ++
 kubernetes/google-container-engine/zookeeper.yaml  |  162 ++
 25 files changed, 9096 insertions(+)

commit f5ab3b95c40e86755dc74e925f301a008319a1d9
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jun 12 16:26:10 2017 -0700

    Small compilation fixes for GCC 6.3 (#470)

 pulsar-client-cpp/lib/ObjectPool.h           | 1 +
 pulsar-client-cpp/lib/SharedBuffer.h         | 1 +
 pulsar-client-cpp/tests/ConsumerStatsTest.cc | 2 +-
 3 files changed, 3 insertions(+), 1 deletion(-)

commit 10ac6c163b40bc07ce79f7c6122a02de2f8037a2
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Tue Jun 13 08:09:05 2017 +0900

    WebSocket proxy should not make a consumer/producer when authorization is failed (#448)

 .../pulsar/websocket/AbstractWebSocketHandler.java | 27 ++++++++++++++--------
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |  8 +++----
 .../yahoo/pulsar/websocket/ProducerHandler.java    | 11 +++++----
 3 files changed, 26 insertions(+), 20 deletions(-)

commit 019e5f3b0844a4a411f149695887cba1cc15bc96
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jun 9 16:34:17 2017 -0700

    C++ Client - Batch Messages - changing group commit time to 10ms (#467)

 pulsar-client-cpp/lib/ProducerConfigurationImpl.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit ec2ea804359f7502cb30c2ec50681e2dc22d3001
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 9 15:13:52 2017 -0700

    Added ZooKeeper instrumentation for enhanced stats (#436)

 all/pom.xml                                        |   6 +
 all/src/assemble/bin.xml                           |   3 +
 bin/pulsar                                         |  11 +-
 conf/log4j.properties                              |   2 +
 pom.xml                                            |  20 ++++
 pulsar-zookeeper/pom.xml                           | 129 +++++++++++++++++++++
 .../zookeeper/FinalRequestProcessorAspect.java     | 123 ++++++++++++++++++++
 .../pulsar/zookeeper/ZooKeeperServerAspect.java    |  81 +++++++++++++
 .../yahoo/pulsar/zookeeper/ZooKeeperStarter.java   |  59 ++++++++++
 .../src/main/resources/META-INF/aop.xml            |  13 +++
 10 files changed, 445 insertions(+), 2 deletions(-)

commit 87d8d72c4dd85285edfe7252b6071e6fea5afc5c
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Jun 9 14:48:03 2017 -0700

    In MockZooKeeper triggers callback without holding mutex (#460)

 .../java/org/apache/zookeeper/MockZooKeeper.java   | 596 ++++++++++++---------
 1 file changed, 338 insertions(+), 258 deletions(-)

commit 11f874e27d2bf2bd456cd4bafe67fa1f8862ab52
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jun 9 14:33:17 2017 -0700

    C++ Client - Better handling and logging for curl response. (#461)

 pulsar-client-cpp/lib/HTTPLookupService.cc | 14 +++++++++--
 pulsar-client-cpp/lib/LookupDataResult.h   | 10 ++++++++
 pulsar-client-cpp/lib/Result.cc            | 38 ++++++++++++++++++++++++++++--
 3 files changed, 58 insertions(+), 4 deletions(-)

commit efb177ddea0a0d5fb1be159fb1a6608d1d42283b
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jun 9 14:28:55 2017 -0700

    Blocking queue (#463)

 .../pulsar/broker/service/persistent/PersistentReplicator.java    | 2 +-
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h                 | 2 +-
 pulsar-client-cpp/perf/PerfProducer.cc                            | 3 +++
 .../src/main/java/com/yahoo/pulsar/client/api/Producer.java       | 6 ++----
 .../java/com/yahoo/pulsar/client/api/ProducerConfiguration.java   | 8 ++++----
 .../java/com/yahoo/pulsar/testclient/PerformanceProducer.java     | 3 +++
 6 files changed, 14 insertions(+), 10 deletions(-)

commit 06cdf7aa1018547573653d704d13dd217e3b223c
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Jun 9 14:08:51 2017 -0700

    update shaded async-http-client property file with 2.0.31 version (#465)

 pulsar-client/src/main/resources/ahc.properties | 1 +
 1 file changed, 1 insertion(+)

commit 0ddb5fea23ae6e3c06547a748a168186f569b634
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jun 9 13:30:28 2017 -0700

    C++ Client - fix for seeing correct msg rate in broker stats (#462)

 pulsar-client-cpp/lib/Commands.cc | 3 +++
 1 file changed, 3 insertions(+)

commit 0d0c9edc5ac587a31c274a5acc8e98945442a117
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Jun 9 11:49:43 2017 -0700

    Fix test: testNeedBrokerDataUpdate loadReport considers absolute percentage change only (#464)

 .../pulsar/broker/loadbalance/ModularLoadManagerImplTest.java    | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

commit 70abe6d4de51c83970d0eb07d987ed58bdf196d2
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Jun 8 10:43:05 2017 -0700

    Update ZK version to 3.4.10 (#414)

 pom.xml | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 96a4c4fa0cca630d06987448d87b0d10ecd453bb
Author: Brad McMillen <brad@mcmillen.com>
Date:   Thu Jun 8 10:35:53 2017 -0700

    Look at the absolute difference in maximum usage percentage. (#454)

 .../java/com/yahoo/pulsar/broker/ServiceConfiguration.java     |  2 ++
 .../pulsar/broker/loadbalance/impl/ModularLoadManagerImpl.java | 10 ++++++----
 2 files changed, 8 insertions(+), 4 deletions(-)

commit ffc6db740730222900b9f6efb1953b7b54911810
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 7 22:52:36 2017 -0700

    Topic termination (#433)

 docs/BinaryProtocol.md                             |   9 +
 .../apache/bookkeeper/mledger/AsyncCallbacks.java  |   6 +
 .../apache/bookkeeper/mledger/ManagedLedger.java   |  19 +
 .../bookkeeper/mledger/ManagedLedgerException.java |  15 +-
 .../bookkeeper/mledger/ManagedLedgerInfo.java      |   1 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  18 +-
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |   8 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 182 +++++++--
 .../mledger/impl/MetaStoreImplZookeeper.java       |   5 +-
 .../bookkeeper/mledger/proto/MLDataFormats.java    | 193 ++++++++-
 managed-ledger/src/main/proto/MLDataFormats.proto  |   6 +
 .../mledger/impl/ManagedLedgerTerminationTest.java | 160 ++++++++
 .../pulsar/broker/admin/PersistentTopics.java      |  46 ++-
 .../broker/service/BrokerServiceException.java     |  14 +-
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  49 ++-
 .../com/yahoo/pulsar/broker/service/Producer.java  |  14 +-
 .../com/yahoo/pulsar/broker/service/Topic.java     |   4 +-
 .../PersistentDispatcherMultipleConsumers.java     |  53 +--
 .../PersistentDispatcherSingleActiveConsumer.java  |  13 +-
 .../service/persistent/PersistentSubscription.java |  19 +-
 .../broker/service/persistent/PersistentTopic.java |  59 ++-
 .../broker/service/TopicTerminationTest.java       | 341 ++++++++++++++++
 .../yahoo/pulsar/client/api/ClientErrorsTest.java  |  18 +-
 .../pulsar/client/admin/PersistentTopics.java      |  26 +-
 .../admin/internal/PersistentTopicsImpl.java       |  48 ++-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  25 +-
 .../java/com/yahoo/pulsar/client/api/Consumer.java |  11 +-
 .../yahoo/pulsar/client/api/MessageListener.java   |  18 +-
 .../pulsar/client/api/PulsarClientException.java   |   8 +-
 .../java/com/yahoo/pulsar/client/api/Reader.java   |   5 +
 .../yahoo/pulsar/client/api/ReaderListener.java    |  12 +-
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |  80 ++--
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  16 +
 .../com/yahoo/pulsar/client/impl/HandlerBase.java  |   6 +
 .../yahoo/pulsar/client/impl/MessageIdImpl.java    |   7 +-
 .../client/impl/PartitionedConsumerImpl.java       |   7 +-
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java |  65 ++--
 .../yahoo/pulsar/client/impl/ProducerStats.java    |   7 +
 .../com/yahoo/pulsar/client/impl/ReaderImpl.java   |  28 +-
 .../java/com/yahoo/pulsar/common/api/Commands.java |  52 +--
 .../com/yahoo/pulsar/common/api/PulsarDecoder.java |  33 +-
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 433 +++++++++++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  13 +
 43 files changed, 1908 insertions(+), 244 deletions(-)

commit 252b5399e7b417d19354c2204cd976e3b98a5679
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Thu Jun 8 14:51:59 2017 +0900

    Fixed links and a statement related to persistent topic permission in AdminTools.md (#459)

 docs/AdminTools.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 54d54c9015c80d4bc873d8f80fb4d78682b4c3b8
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Jun 7 15:29:48 2017 -0700

    pulsar-client should use the log4j.shell.properties conf (#453)

 bin/pulsar-client | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 6233356e9c519b943f0c54598f2ad999fe7aa49b
Author: Brad McMillen <brad@mcmillen.com>
Date:   Wed Jun 7 11:39:54 2017 -0700

    Fix shared reference between the two load reports (#450)
    
    This shared reference caused the resource usages between the current report (not published to ZooKeeper) and the
    most recently written report to be incorrect and hence when the broker utilization was rapidly changing (e.g., after
    a broker restart), the load report only got written once per 15 minutes.

 .../src/main/java/com/yahoo/pulsar/broker/LocalBrokerData.java | 10 +++++-----
 .../common/policies/data/loadbalancer/ResourceUsage.java       |  6 +++++-
 2 files changed, 10 insertions(+), 6 deletions(-)

commit 45fcd35e774ce38c67b0b5660a3b7757bd83a236
Author: jai1 <jai1@users.noreply.github.com>
Date:   Tue Jun 6 16:09:09 2017 -0700

    Removed duplicate mentions of authenticationProviders from the websocket.conf. (#449)

 conf/websocket.conf | 3 ---
 1 file changed, 3 deletions(-)

commit 049e4281e2d86bda6574b7572b8527ca84e06a81
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Mon Jun 5 23:01:53 2017 +0900

    Fix DoubleByteBuf to send large size messages in TLS mode (#447)

 .../api/AuthenticatedProducerConsumerTest.java     |   2 +-
 .../pulsar/client/api/TlsProducerConsumerTest.java | 121 +++++++++++++++++++++
 .../com/yahoo/pulsar/common/api/DoubleByteBuf.java |   5 -
 .../yahoo/pulsar/common/api/DoubleByteBufTest.java |  49 +++++++++
 4 files changed, 171 insertions(+), 6 deletions(-)

commit 5c6c9c311f90e87189452a2716bd63abbcc6ffff
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jun 2 16:00:13 2017 -0700

    Set Block If queue full to false by default (#441)
    
    * Changed ProducerConfiguration blockIfQueueFull to false by default
    
    * Fixed test cases

 .../test/java/com/yahoo/pulsar/broker/service/BatchMessageTest.java  | 1 +
 .../java/com/yahoo/pulsar/broker/service/PersistentQueueE2ETest.java | 5 ++++-
 2 files changed, 5 insertions(+), 1 deletion(-)

commit d990b171f5d3f14a2a196363fb315594c46afab6
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Jun 2 14:33:23 2017 -0700

    Changed the default value of maxPendingMessages to 30,000 (#445)

 pulsar-client-cpp/lib/ProducerConfigurationImpl.h                       | 2 +-
 .../main/java/com/yahoo/pulsar/client/api/ProducerConfiguration.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 2e4475e334c6df1dee5246b1ce469b436ea6a7ee
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Jun 2 13:13:51 2017 -0700

    Recover cursor with correct readPosition and replay unackedMessages (#446)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 16 +++++
 .../bookkeeper/mledger/impl/OpReadEntry.java       |  6 +-
 .../client/api/DispatcherBlockConsumerTest.java    | 84 ++++++++++++++++++++++
 3 files changed, 105 insertions(+), 1 deletion(-)

commit 5a82c79a37d87ec328f5287674beb6fa420a43c3
Author: Brad McMillen <brad@mcmillen.com>
Date:   Thu Jun 1 10:07:41 2017 -0700

    Remove broker weights for ModularLoadManager (#442)

 .../loadbalance/impl/LeastLongTermMessageRate.java  | 21 ++++++++-------------
 1 file changed, 8 insertions(+), 13 deletions(-)

commit e146696c60188ea622a0122338f1ad7d26f880c7
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Jun 1 00:15:04 2017 -0700

    add log and cleanup failed non-durable subscription (#444)

 .../java/org/apache/bookkeeper/mledger/impl/ManagedCursorImpl.java    | 4 +---
 .../com/yahoo/pulsar/broker/service/persistent/PersistentTopic.java   | 3 +++
 2 files changed, 4 insertions(+), 3 deletions(-)

commit 19718e46ca648b6c902bd6bf878e8f739d7f107b
Author: massakam <massakam@yahoo-corp.jp>
Date:   Thu Jun 1 13:34:51 2017 +0900

    Enable PulsarAdmin to trust multiple certificates (#440)

 .../src/main/java/com/yahoo/pulsar/common/util/SecurityUtility.java   | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit e93a4c37b40040c336a03c2c08cebcaa99ac5cc3
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 30 18:10:20 2017 -0700

    Add endpoint to fetch stats for Prometheus (#294)

 .../bookkeeper/mledger/ManagedLedgerMXBean.java    |   5 +
 .../mledger/impl/ManagedLedgerMBeanImpl.java       |  10 ++
 .../bookkeeper/mledger/util/StatsBuckets.java      |  21 +++
 pom.xml                                            |  14 +-
 pulsar-broker/pom.xml                              |  10 ++
 .../com/yahoo/pulsar/broker/PulsarService.java     |  13 +-
 .../com/yahoo/pulsar/broker/admin/BrokerStats.java |   4 +-
 .../pulsar/broker/loadbalance/LoadManager.java     |  12 +-
 .../impl/ModularLoadManagerWrapper.java            |   4 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   6 +-
 .../yahoo/pulsar/broker/service/BrokerService.java |  12 +-
 .../stats/prometheus/AggregatedNamespaceStats.java |  65 ++++++++
 .../prometheus/AggregatedReplicationStats.java     |  33 ++++
 .../stats/prometheus/NamespaceStatsAggregator.java | 185 +++++++++++++++++++++
 .../prometheus/PrometheusMetricsGenerator.java     | 101 +++++++++++
 .../stats/prometheus/PrometheusMetricsServlet.java |  83 +++++++++
 .../yahoo/pulsar/utils/SimpleTextOutputStream.java | 132 +++++++++++++++
 .../com/yahoo/pulsar/utils/StatsOutputStream.java  | 141 ++++------------
 .../pulsar/utils/SimpleTextOutputStreamTest.java   | 116 +++++++++++++
 .../yahoo/pulsar/utils/StatsOutputStreamTest.java  |  83 +--------
 20 files changed, 840 insertions(+), 210 deletions(-)

commit 293153e24157c44c89c50b48aab897d5e480ed7d
Author: Brad McMillen <brad@mcmillen.com>
Date:   Fri May 26 12:50:46 2017 -0700

    Add long-term message rate to the broker monitor (#423)

 .../com/yahoo/pulsar/testclient/BrokerMonitor.java | 22 ++++++++++++++++++----
 1 file changed, 18 insertions(+), 4 deletions(-)

commit b47df828b585e93d0e516e6aadb2ac71b5f91097
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Sat May 27 01:58:35 2017 +0900

    Move websocket performance client and fix bugs (#430)

 bin/pulsar-perf                                    |  3 +++
 .../socket/client/MockAuthenticationProvider.java  |  0
 .../proxy/socket/client/PaddingDecimalFormat.java  |  0
 .../proxy/socket/client/PerformanceClient.java     | 28 +++++++++++++---------
 .../socket/client/SimpleTestProducerSocket.java    |  8 +++----
 5 files changed, 24 insertions(+), 15 deletions(-)

commit 6f08d3bf58654623c84ce66207446033036b4bb9
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 26 09:58:16 2017 -0700

    Configure to use less memory for short-lived CLI tools (#431)

 bin/pulsar-admin         |  4 ++--
 bin/pulsar-client        |  4 ++--
 conf/pulsar_tools_env.sh | 57 ++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 61 insertions(+), 4 deletions(-)

commit d67499af41b7eec16529160f04aa5db9a505b223
Author: Brad McMillen <brad@mcmillen.com>
Date:   Fri May 26 09:56:58 2017 -0700

    Log broker message rates, weights, and scores during bundle placement (#435)

 .../broker/loadbalance/impl/LeastLongTermMessageRate.java     | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

commit f888d60b7718f5a1f60fbf6e8e7c01102e74bfcb
Author: Brad McMillen <brad@mcmillen.com>
Date:   Thu May 25 17:29:43 2017 -0700

    Increase ZK timeout in broker-monitor (#432)

 .../src/main/java/com/yahoo/pulsar/testclient/BrokerMonitor.java        | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 5ba05cc3d22b5fbc6758c78838b28df1396f9bf4
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue May 23 11:49:03 2017 -0700

    add api to increase partitions of existing non-global partitioned-topic (#299)
    
    * add api to increase partitions of existing non-global partitioned-topic
    
    * add documentation for ordering violation

 docs/AdminTools.md                                 |  74 ++++++---
 .../pulsar/broker/admin/PersistentTopics.java      | 167 +++++++++++++++++++++
 .../com/yahoo/pulsar/broker/service/Topic.java     |   2 +
 .../broker/service/persistent/PersistentTopic.java |  12 +-
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 128 ++++++++++++++--
 .../pulsar/client/admin/PersistentTopics.java      |  32 ++++
 .../admin/internal/PersistentTopicsImpl.java       |  21 +++
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  19 +++
 8 files changed, 417 insertions(+), 38 deletions(-)

commit 96b8c209d5a9be57695b896a47f1cc396ecb1903
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 23 11:48:16 2017 -0700

    Include default values uncommented in conf/bookkepeer.conf (#429)

 bin/bookkeeper       |  9 +++----
 conf/bookkeeper.conf | 75 ++++++++++++++++++++++++++--------------------------
 2 files changed, 42 insertions(+), 42 deletions(-)

commit 77416c60c80ccee6b6462a6ed3bb9d64f5203e09
Author: Tetsuya Morimoto <tetsuya.morimoto@gmail.com>
Date:   Tue May 23 08:40:19 2017 +0900

    fix a typo in pulsar binary protocol specification: CHECKSUM size is not 2 bytes, but 4 bytes (#427)

 docs/BinaryProtocol.md           | 2 +-
 docs/locale/ja/BinaryProtocol.md | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 16cc9972bdd339c185d45260ef272a5c89b3e9b5
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon May 22 15:46:09 2017 -0700

    Made log category name configurable in CPP Client (#426)

 pulsar-client-cpp/CMakeLists.txt | 7 +++++++
 pulsar-client-cpp/lib/LogUtils.h | 2 +-
 2 files changed, 8 insertions(+), 1 deletion(-)

commit 5a0d2102adec4d9f6605a1c9a78ddda59b156ce3
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu May 18 19:33:03 2017 -0700

    Replace messagesToReplay set to ConcurrentLongPairSet to improve gc (#406)

 .../PersistentDispatcherMultipleConsumers.java     | 35 ++++++++++++----------
 .../broker/service/PersistentTopicE2ETest.java     |  7 +++--
 2 files changed, 24 insertions(+), 18 deletions(-)

commit 7a7b60b637bee93d797311dd5dd1cabae091a229
Author: Brad McMillen <brad@mcmillen.com>
Date:   Thu May 18 11:53:17 2017 -0700

    Correct documentation for how to enable ModularLoadManagerImpl (#419)

 docs/ModularLoadManager.md | 22 +++++++++++-----------
 1 file changed, 11 insertions(+), 11 deletions(-)

commit 08deca115f45b86de10a18e03364b92b5856e01e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu May 18 11:51:57 2017 -0700

    Remove "experimental" warning for WebSocket API (#421)

 docs/WebSocket.md | 3 ---
 1 file changed, 3 deletions(-)

commit 0a50fda23b3928b75f4d508465853ec618132398
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed May 17 16:27:28 2017 -0700

    fix direct-memory usage count (#418)

 .../com/yahoo/pulsar/broker/loadbalance/impl/LoadManagerShared.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 320dd908069f19ade0f8307e6cb248848ce6bd23
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 17 10:25:29 2017 -0700

    Ignore bin/ directories in submodules (#417)

 .gitignore | 1 +
 1 file changed, 1 insertion(+)

commit 920374a41eead0d095096f5c244072c8cc007b90
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 17 10:24:25 2017 -0700

    Fixed comment typo in broker.conf (#416)

 conf/broker.conf | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 805db3c8ec97ed87cf389736e7124508669f81c2
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 16 18:36:32 2017 -0700

    Fixed ZK configuration instructions (#415)

 docs/ClusterSetup.md | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

commit cdaf2287b284f74f4628a3ff4403b250266404aa
Author: Brad McMillen <brad@mcmillen.com>
Date:   Tue May 16 16:32:27 2017 -0700

    Fix typo in documentation page for ModularLoadManagerImpl (#413)

 docs/ModularLoadManager.md | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit d12eee6fef104a1b67f12cc5f032a197e02a2b29
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 16 10:22:30 2017 -0700

    Print hostname and error when we get connection failures (#412)

 .../src/main/java/com/yahoo/pulsar/client/impl/ConnectionPool.java       | 1 +
 1 file changed, 1 insertion(+)

commit 5de4955cab6a822920105ea471732874f78bea74
Author: Brad McMillen <brad@mcmillen.com>
Date:   Tue May 16 09:39:32 2017 -0700

    Update documentation for modular load manager impl (#408)

 docs/ModularLoadManager.md | 147 +++++++++++++++++++++++++++++++++++++++------
 1 file changed, 130 insertions(+), 17 deletions(-)

commit 8ce76313412192a3ad8bccb478057b49a7fdf5b9
Author: Tetsuya Morimoto <tetsuya.morimoto@gmail.com>
Date:   Tue May 16 08:12:47 2017 +0900

    add syntax statement since protoc warns to declare explicitly (#410)

 managed-ledger/src/main/proto/MLDataFormats.proto | 2 ++
 pulsar-common/src/main/proto/PulsarApi.proto      | 2 ++
 2 files changed, 4 insertions(+)

commit 8bb42f2144c89ef584ab09cad177d53ded4eb736
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon May 15 15:56:51 2017 -0700

    close webService on test to close pulsarClient and executors (#409)

 .../src/main/java/com/yahoo/pulsar/websocket/WebSocketService.java    | 4 +++-
 .../yahoo/pulsar/proxy/authentication/AuthenticationServiceTest.java  | 2 ++
 .../src/test/java/com/yahoo/pulsar/websocket/LookupProtocolTest.java  | 4 ++++
 3 files changed, 9 insertions(+), 1 deletion(-)

commit 6e3411566f7455cce0f0995cc11bf6f58be69fe8
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon May 15 15:32:59 2017 -0700

    add ConcurrentLongPairSet and test (#405)

 .../util/collections/ConcurrentLongPairSet.java    | 531 +++++++++++++++++++++
 .../collections/ConcurrentLongPairSetTest.java     | 394 +++++++++++++++
 2 files changed, 925 insertions(+)

commit 5f64da7d1eec6f8ea0d8d2025a1455944241d40f
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat May 13 22:55:22 2017 -0700

    Added missing license header

 .../pulsar/utils/PulsarBrokerVersionStringUtils.java      | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

commit ca5a445f59b9efe1f0a7d9f226be80e8b214afaa
Author: Brad McMillen <brad@mcmillen.com>
Date:   Sat May 13 22:03:49 2017 -0700

    Add ability to filter brokers based on their build version (#397)

 conf/broker.conf                                   |   4 +
 pom.xml                                            |   6 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  12 ++
 pulsar-broker/pom.xml                              |  12 +-
 .../com/yahoo/pulsar/broker/LocalBrokerData.java   |  11 ++
 .../com/yahoo/pulsar/broker/PulsarService.java     |   8 +-
 .../pulsar/broker/loadbalance/BrokerFilter.java    |   8 +-
 .../BrokerFilterBadVersionException.java           |  30 ++++
 .../broker/loadbalance/BrokerFilterException.java  |  30 ++++
 .../loadbalance/impl/BrokerVersionFilter.java      | 152 +++++++++++++++++++++
 .../loadbalance/impl/ModularLoadManagerImpl.java   |  36 +++--
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   2 +
 .../utils/PulsarBrokerVersionStringUtils.java      |  86 ++++++++++++
 .../resources/pulsar-broker-version.properties     |   1 +
 .../loadbalance/BrokerVersionFilterTest.java       |  79 +++++++++++
 .../broker/service/AddMissingPatchVersionTest.java |  41 ++++++
 .../policies/data/loadbalancer/LoadReport.java     |   9 ++
 17 files changed, 513 insertions(+), 14 deletions(-)

commit 1c12849a685e2a2715bad72a201b8572d7629aa4
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 12 18:31:10 2017 -0700

    Fixed websocket proxy stats license headers (#403)

 .../pulsar/websocket/admin/WebSocketWebResource.java      | 15 +++++++++++++++
 .../java/com/yahoo/pulsar/websocket/stats/ProxyStats.java | 15 +++++++++++++++
 .../com/yahoo/pulsar/websocket/stats/ProxyTopicStat.java  | 15 +++++++++++++++
 3 files changed, 45 insertions(+)

commit a2ce53608916eb60a88d7a57c69e627666dbdb4e
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri May 12 16:35:51 2017 -0700

    Dispatcher blocks dispatching once unackMsgs reached max limit (#399)

 conf/broker.conf                                   |   6 +
 conf/standalone.conf                               |   6 +
 .../java/org/apache/bookkeeper/mledger/Entry.java  |  11 +
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |  10 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  20 +-
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  55 +-
 .../yahoo/pulsar/broker/service/Dispatcher.java    |   2 +
 .../yahoo/pulsar/broker/service/Subscription.java  |   2 +
 .../PersistentDispatcherMultipleConsumers.java     |  52 +-
 .../PersistentDispatcherSingleActiveConsumer.java  |   5 +
 .../service/persistent/PersistentSubscription.java |  15 +-
 .../broker/service/persistent/PersistentTopic.java |   9 +-
 .../client/api/DispatcherBlockConsumerTest.java    | 583 +++++++++++++++++++++
 .../policies/data/PersistentSubscriptionStats.java |   3 +
 14 files changed, 747 insertions(+), 32 deletions(-)

commit 348759ce06d724f0a79e7b539c9a3d2db857e650
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Sat May 13 07:56:35 2017 +0900

    Add options to admin tool (#400)

 .../com/yahoo/pulsar/admin/cli/CmdBrokers.java     |  2 +-
 .../com/yahoo/pulsar/admin/cli/CmdClusters.java    |  2 +-
 .../admin/cli/CmdNamespaceIsolationPolicy.java     |  2 +-
 .../com/yahoo/pulsar/admin/cli/CmdNamespaces.java  |  2 +-
 .../com/yahoo/pulsar/admin/cli/CmdProperties.java  |  2 +-
 .../yahoo/pulsar/admin/cli/CmdResourceQuotas.java  |  2 +-
 .../yahoo/pulsar/admin/cli/PulsarAdminTool.java    | 93 ++++++++++++++--------
 7 files changed, 65 insertions(+), 40 deletions(-)

commit b2e350a0772f69ae8978651bca0df95c983a1581
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri May 12 15:38:58 2017 -0700

    Add stats and monitoring for websocket proxy (#341)

 .../com/yahoo/pulsar/broker/admin/BrokerStats.java |   3 +-
 .../pulsar/broker/loadbalance/LoadManager.java     |   2 +-
 .../impl/ModularLoadManagerWrapper.java            |   2 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   2 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |   2 -
 .../yahoo/pulsar/broker/service/BrokerService.java |   2 +-
 .../yahoo/pulsar/broker/service/PulsarStats.java   |   2 +-
 .../broker/stats/BrokerOperabilityMetrics.java     |   1 +
 .../broker/stats/ClusterReplicationMetrics.java    |   1 +
 .../pulsar/broker/stats/MBeanStatsGenerator.java   |   1 +
 .../pulsar/broker/stats/MetricsGenerator.java      |   1 +
 .../yahoo/pulsar/broker/stats/NamespaceStats.java  |   1 +
 .../pulsar/broker/stats/ReplicationMetrics.java    |   2 +
 .../broker/stats/metrics/AbstractMetrics.java      |   2 +-
 .../pulsar/broker/stats/metrics/JvmMetrics.java    |   2 +-
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |   2 +-
 .../broker/stats/metrics/ManagedLedgerMetrics.java |   2 +-
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |   2 +-
 .../broker/service/PersistentTopicE2ETest.java     |   2 +-
 .../broker/stats/ManagedLedgerMetricsTest.java     |   1 +
 .../yahoo/pulsar/client/api/ClientErrorsTest.java  |   2 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 179 ++++++++++++---------
 .../websocket/proxy/ProxyAuthenticationTest.java   |  27 ++--
 .../websocket/proxy/ProxyPublishConsumeTest.java   | 176 ++++++++++++++++++--
 .../websocket/proxy/ProxyPublishConsumeTls.java    |  26 +--
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    |  23 +--
 .../websocket/proxy/SimpleConsumerSocket.java      |   2 +-
 .../websocket/proxy/SimpleProducerSocket.java      |   9 +-
 .../com/yahoo/pulsar/common}/stats/Metrics.java    |   2 +-
 pulsar-websocket/pom.xml                           |  20 +++
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |  75 ++++++++-
 .../yahoo/pulsar/websocket/ProducerHandler.java    |  71 +++++++-
 .../yahoo/pulsar/websocket/WebSocketService.java   |  56 ++++++-
 .../pulsar/websocket/admin/RestException.java      |  63 ++++++++
 .../websocket/admin/WebSocketProxyStats.java       | 129 +++++++++++++++
 .../websocket/admin/WebSocketWebResource.java      | 115 +++++++++++++
 .../pulsar/websocket/service/ProxyServer.java      |  26 ++-
 .../websocket/service/WebSocketServiceStarter.java |   6 +-
 .../yahoo/pulsar/websocket/stats/JvmMetrics.java   | 152 +++++++++++++++++
 .../yahoo/pulsar/websocket/stats/ProxyStats.java   | 121 ++++++++++++++
 .../pulsar/websocket/stats/ProxyTopicStat.java     |  55 +++++++
 .../yahoo/pulsar/websocket/stats/StatsBuckets.java | 113 +++++++++++++
 42 files changed, 1326 insertions(+), 157 deletions(-)

commit 8d924193a6a132dd3170f381c04d09f2cf1d9757
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Fri May 12 15:20:00 2017 -0700

    Always evenly distribute bundles in the same namespace (#388)

 .../pulsar/broker/cache/ResourceQuotaCache.java    |  2 +-
 .../broker/loadbalance/impl/LoadManagerShared.java | 66 +++++++++++++++++++++
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 20 +++++++
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 50 +++++++++++++---
 .../loadbalance/LoadBalancerTestingUtils.java      | 40 +++++++++++++
 .../loadbalance/ModularLoadManagerImplTest.java    | 35 +++++++++++
 .../loadbalance/SimpleLoadManagerImplTest.java     | 69 ++++++++++++++++++----
 .../data/loadbalancer/ResourceUnitRanking.java     |  7 +++
 8 files changed, 266 insertions(+), 23 deletions(-)

commit bd3fa5625f3a412302b9017eb0aed489723cfd52
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri May 12 15:19:24 2017 -0700

    Removing blockIfQueueFull option from WebSocket Proxy Server (#396)

 .../main/java/com/yahoo/pulsar/websocket/ProducerHandler.java  |  7 +++----
 .../main/java/com/yahoo/pulsar/websocket/WebSocketService.java | 10 ++++++----
 .../java/com/yahoo/pulsar/websocket/service/ProxyServer.java   |  7 ++++---
 .../pulsar/websocket/service/WebSocketProxyConfiguration.java  |  9 +++++++++
 4 files changed, 22 insertions(+), 11 deletions(-)

commit 7badf1ab833f36319edb5e373e76966ed74958ab
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 5 17:21:56 2017 -0700

    Introduce topic reader in client API (#371)

 bin/pulsar-perf                                    |  19 +-
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |  47 ++--
 .../com/yahoo/pulsar/broker/service/Topic.java     |   3 +-
 .../persistent/PersistentMessageExpiryMonitor.java |   5 +-
 .../service/persistent/PersistentReplicator.java   |   3 +-
 .../service/persistent/PersistentSubscription.java |  15 +-
 .../broker/service/persistent/PersistentTopic.java | 131 +++++++----
 .../PersistentDispatcherFailoverConsumerTest.java  |   2 +-
 .../service/PersistentMessageFinderTest.java       |   2 +-
 .../service/PersistentTopicConcurrentTest.java     |   8 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  28 +--
 .../yahoo/pulsar/client/api/TopicReaderTest.java   | 239 +++++++++++++++++++++
 .../com/yahoo/pulsar/client/api/MessageId.java     |  12 +-
 .../com/yahoo/pulsar/client/api/PulsarClient.java  |  53 +++++
 .../java/com/yahoo/pulsar/client/api/Reader.java   |  57 +++++
 .../pulsar/client/api/ReaderConfiguration.java     |  97 +++++++++
 .../yahoo/pulsar/client/api/ReaderListener.java    |  41 ++++
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 117 ++++++++--
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |  80 ++++++-
 .../com/yahoo/pulsar/client/impl/ReaderImpl.java   | 113 ++++++++++
 .../java/com/yahoo/pulsar/common/api/Commands.java |  12 +-
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 153 +++++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |  10 +
 .../yahoo/pulsar/testclient/PerformanceReader.java | 237 ++++++++++++++++++++
 24 files changed, 1355 insertions(+), 129 deletions(-)

commit 65da593a5490719eca2ca2c4c071cca2c0367782
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri May 5 17:20:10 2017 -0700

    NonDurable cursor for managed ledger (#366)

 .../apache/bookkeeper/mledger/ManagedCursor.java   |   5 +
 .../apache/bookkeeper/mledger/ManagedLedger.java   |  17 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  16 +-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  17 +-
 .../mledger/impl/NonDurableCursorImpl.java         | 116 ++++
 .../bookkeeper/mledger/impl/PositionImpl.java      |  10 +-
 .../mledger/impl/ManagedCursorContainerTest.java   |   5 +
 .../mledger/impl/NonDurableCursorTest.java         | 585 +++++++++++++++++++++
 8 files changed, 758 insertions(+), 13 deletions(-)

commit de1b35ac15a7c9db905a1585a070b803b595d1e0
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed May 3 12:19:40 2017 -0700

    Upgrade to netty-4.0.46 (#392)
    
    * Upgrade to netty-4.0.46
    
    * Fixed DoubleByteBuf leak detector
    
    * Exclude netty-common from datasketches-metrics dependency
    
    * Upgrade async-http-client to latest stable version (fix incompatibility with netty)

 all/pom.xml                                        |  5 +++
 pom.xml                                            |  4 +-
 .../com/yahoo/pulsar/common/api/DoubleByteBuf.java | 44 +++++++++++-----------
 pulsar-zookeeper-utils/pom.xml                     |  5 +++
 4 files changed, 35 insertions(+), 23 deletions(-)

commit 80bebd59875f5d6ba89125bb90173588b53a2a09
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue May 2 16:55:07 2017 -0700

    Change default mark-delete rate limit from 10s to 1s (#393)

 conf/broker.conf                                                  | 4 ++--
 .../main/java/com/yahoo/pulsar/broker/ServiceConfiguration.java   | 8 +++++---
 2 files changed, 7 insertions(+), 5 deletions(-)

commit 914e428258639226014169f6acd4e652e77aa83e
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Tue May 2 16:49:08 2017 -0700

    Add load shedding strategy (#345)

 .../yahoo/pulsar/broker/loadbalance/LoadData.java  |  10 ++
 .../broker/loadbalance/impl/LoadManagerShared.java |  26 +++-
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 132 ++++++++----------
 .../broker/loadbalance/impl/OverloadShedder.java   | 106 +++++++++++++++
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  44 +-----
 .../loadbalance/ModularLoadManagerImplTest.java    |  69 ++++++++++
 .../com/yahoo/pulsar/testclient/BrokerMonitor.java |   4 +
 .../pulsar/testclient/LoadSimulationClient.java    | 150 ++++++++++++---------
 8 files changed, 356 insertions(+), 185 deletions(-)

commit 398bb6a7cd97351e60b9c186c5012bad31912182
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Mon May 1 18:53:14 2017 -0700

    Introduce Interface for Customizing Update Conditions (#347)
    
    * Allow customizable ZK update conditions
    
    * Add copyright
    
    * Add unit test, put update condition directly into load manager

 .../com/yahoo/pulsar/broker/LocalBrokerData.java   |  35 +++++--
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 112 ++++++++++++++-------
 .../loadbalance/ModularLoadManagerImplTest.java    |  77 ++++++++++++++
 3 files changed, 175 insertions(+), 49 deletions(-)

commit fa3cc70fd52da331d5363768327b1c3dc00d9623
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon May 1 00:20:16 2017 -0700

    C++ Client - moving all MessageData related code to MessageImpl (#391)

 pulsar-client-cpp/lib/MessageImpl.cc | 4 ++++
 pulsar-client-cpp/lib/MessageImpl.h  | 1 +
 2 files changed, 5 insertions(+)

commit ce553b717e8af2b0e4e8f0e7f71f9a4b89d0d9f6
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sun Apr 30 22:46:12 2017 -0700

    Pass client library version to broker and show on stats (#387)

 .../main/java/com/yahoo/pulsar/broker/service/Consumer.java  |  1 +
 .../main/java/com/yahoo/pulsar/broker/service/Producer.java  |  1 +
 .../main/java/com/yahoo/pulsar/broker/service/ServerCnx.java | 10 ++++++++++
 .../pulsar/broker/service/persistent/PersistentTopic.java    |  3 +++
 .../com/yahoo/pulsar/broker/service/BrokerServiceTest.java   |  2 ++
 .../java/com/yahoo/pulsar/broker/service/ServerCnxTest.java  | 12 ++++++------
 .../main/java/com/yahoo/pulsar/client/impl/ClientCnx.java    |  3 ++-
 .../main/java/com/yahoo/pulsar/client/impl/HttpClient.java   |  2 +-
 .../src/main/java/com/yahoo/pulsar/common/api/Commands.java  | 10 +++++-----
 .../com/yahoo/pulsar/common/policies/data/ConsumerStats.java |  3 +++
 .../yahoo/pulsar/common/policies/data/PublisherStats.java    |  3 +++
 .../yahoo/pulsar/discovery/service/DiscoveryServiceTest.java |  2 +-
 12 files changed, 38 insertions(+), 14 deletions(-)

commit c4d2e8bf846a90ae3c87eb110aac8f33a06d3ee9
Author: jai1 <jai1@users.noreply.github.com>
Date:   Sun Apr 30 22:45:42 2017 -0700

    Shaded AsyncHttpClient in pulsar client (#390)

 pulsar-client/pom.xml                           |  4 +++
 pulsar-client/src/main/resources/ahc.properties | 47 +++++++++++++++++++++++++
 2 files changed, 51 insertions(+)

commit 947e40970aa316abb33e6383b0d24921ef0ebe4f
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 25 13:27:02 2017 -0700

    Send replay entries read callback from background thread, to avoid recursive stack calls (#384)

 .../org/apache/bookkeeper/mledger/impl/EntryCacheImpl.java     | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

commit e77fa5b1182a065faedd45677bfe63ef8b5e2a0c
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 25 10:50:14 2017 -0700

    Skip travis local cleanup before uploading releases to github. Fix for #340 (#381)

 .travis.yml | 1 +
 1 file changed, 1 insertion(+)

commit 09b6bb0c2e39e1418b4422c138bd0865cf8950bc
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Apr 24 21:35:28 2017 -0700

    handle zkCache failure: invalidate cache and zk-getData failure (#377)
    
    * handle zkCache failure: invalidate cache and zk-getData failure
    
    * introduce separate executor to serve zkcache callback
    
    * add executor to discovery service
    
    * remove testing npe
    
    * add assetion on zkCache executor parameter and update tests
    
    * update executor thread in testcase for intermittent failure

 .../com/yahoo/pulsar/broker/PulsarService.java     |  10 +-
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |  12 +--
 .../broker/cache/ResourceQuotaCacheTest.java       |  17 +++-
 .../broker/namespace/OwnershipCacheTest.java       |   7 +-
 .../discovery/service/BrokerDiscoveryProvider.java |   5 +-
 .../service/web/ZookeeperCacheLoader.java          |  11 ++-
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |  54 ++++++----
 .../yahoo/pulsar/zookeeper/ZooKeeperDataCache.java |   2 +
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |   6 +-
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |   6 +-
 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java | 109 ++++++++++++++++++++-
 11 files changed, 196 insertions(+), 43 deletions(-)

commit 7f63ee985fd4bdae300d6e6b08f4c7e1eeae2f01
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Apr 24 17:48:39 2017 -0700

    Modifications to create a wrapper for CPP client (#379)

 pulsar-client-cpp/.gitignore                         |  4 ++--
 pulsar-client-cpp/CMakeLists.txt                     | 11 +++++++----
 pulsar-client-cpp/include/pulsar/BatchMessageId.h    |  6 +++++-
 .../include/pulsar/BrokerConsumerStats.h             |  6 ++++++
 pulsar-client-cpp/include/pulsar/Client.h            |  7 ++++---
 .../include/pulsar/ClientConfiguration.h             |  9 ++++++---
 pulsar-client-cpp/include/pulsar/CompressionType.h   |  2 ++
 pulsar-client-cpp/include/pulsar/Consumer.h          |  8 ++++----
 .../include/pulsar/ConsumerConfiguration.h           |  5 ++++-
 pulsar-client-cpp/include/pulsar/ConsumerType.h      |  3 ++-
 pulsar-client-cpp/include/pulsar/Message.h           |  2 ++
 pulsar-client-cpp/include/pulsar/MessageBuilder.h    |  5 ++++-
 pulsar-client-cpp/include/pulsar/MessageId.h         |  2 ++
 pulsar-client-cpp/include/pulsar/Producer.h          |  6 +++---
 .../include/pulsar/ProducerConfiguration.h           |  5 +++++
 pulsar-client-cpp/lib/BrokerConsumerStats.cc         |  2 ++
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.h      |  3 ++-
 pulsar-client-cpp/lib/Client.cc                      |  3 +++
 pulsar-client-cpp/lib/ClientConfiguration.cc         |  2 +-
 pulsar-client-cpp/lib/ClientImpl.cc                  |  4 ++--
 pulsar-client-cpp/lib/ConnectionPool.h               |  4 ++--
 pulsar-client-cpp/lib/MessageBuilder.cc              |  8 ++++++--
 pulsar-client-cpp/lib/MessageImpl.cc                 | 20 ++++++++++++++++++++
 pulsar-client-cpp/lib/MessageImpl.h                  |  9 ++++++++-
 .../lib/PartitionedBrokerConsumerStatsImpl.h         |  3 ++-
 25 files changed, 106 insertions(+), 33 deletions(-)

commit 9765de162591a081d53dcae5a6bdefb3e66d6c8a
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Apr 24 13:37:45 2017 -0700

    Get messageId in string format (#370)

 .../pulsar/client/impl/BatchMessageIdImpl.java     |  3 +-
 .../yahoo/pulsar/client/impl/MessageIdImpl.java    |  3 +-
 .../com/yahoo/pulsar/client/api/MessageIdTest.java | 46 ++++++++++++++++++++++
 3 files changed, 48 insertions(+), 4 deletions(-)

commit 2f1c5fa1ad941e06769bfb3df1f0263900e96c8d
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Tue Apr 25 04:00:41 2017 +0900

    no call session.close() in onWebSocketError() (#378)

 .../main/java/com/yahoo/pulsar/websocket/AbstractWebSocketHandler.java   | 1 -
 1 file changed, 1 deletion(-)

commit f13606e81c8bd015d23c6d8bf1d4813af57fc935
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Apr 24 10:37:49 2017 -0700

    avoid incrementing unack-msg count for non-shared sub and not show it on stats (#376)

 .../main/java/com/yahoo/pulsar/broker/service/Consumer.java |  2 +-
 .../java/com/yahoo/pulsar/broker/service/Subscription.java  |  3 +++
 .../broker/service/persistent/PersistentSubscription.java   |  2 ++
 .../pulsar/broker/service/persistent/PersistentTopic.java   | 13 ++++++++++---
 4 files changed, 16 insertions(+), 4 deletions(-)

commit 55c49c8f6d7e143a1ca12b510187f580e186db7e
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Fri Apr 21 14:26:53 2017 -0700

    Remove Exceptionally Completed Topic Futures (#374)
    
    * Remove exceptionally completed topic futures
    
    * Ensure more recently created futures are not removed

 .../main/java/com/yahoo/pulsar/broker/service/BrokerService.java   | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

commit 26963dc73be053ba3958ea31a314986682d5deba
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Apr 21 13:54:27 2017 -0700

    BrokerService should not remove failed topic from map with the same thread which adds in map to prevent deadlock (#375)

 .../yahoo/pulsar/broker/service/BrokerService.java |  5 +-
 .../pulsar/broker/service/BrokerServiceTest.java   | 58 ++++++++++++++++++++++
 2 files changed, 62 insertions(+), 1 deletion(-)

commit 01b510464a0ea153dfe20ccef0cc0e1173bbb055
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Apr 21 11:40:32 2017 -0700

    Avoid using zk-client thread to process zk-data result (#361)
    
    * Avoid using zk-client thread to process zk-data result
    
    * add ThreadPool-name and stop executors on shutdown
    
    * shutdown zkCache executor if zkCache has initialized it

 .../java/org/apache/zookeeper/MockZooKeeper.java   | 20 +++++++-
 .../pulsar/broker/BookKeeperClientFactory.java     |  1 +
 .../pulsar/broker/BookKeeperClientFactoryImpl.java | 22 +++++++--
 .../com/yahoo/pulsar/broker/PulsarService.java     | 12 +++--
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  5 ++
 .../broker/cache/ResourceQuotaCacheTest.java       |  2 +-
 .../broker/namespace/OwnershipCacheTest.java       |  2 +-
 .../service/web/ZookeeperCacheLoader.java          |  3 +-
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |  2 +-
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |  7 ++-
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java | 35 ++++++++++---
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |  6 +--
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |  6 +--
 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java | 57 ++++++++++++++++++++--
 14 files changed, 147 insertions(+), 33 deletions(-)

commit 136fb7b1746f480be9ec841376838ecf66355af6
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 20 17:25:50 2017 -0700

    Fixed travis release yaml configuration. Fix for #340 (#373)

 .travis.yml | 1 -
 1 file changed, 1 deletion(-)

commit 9961d2c305bf86aa765b000fc50bd91d2294ae25
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 20 17:03:29 2017 -0700

    add complete list of configuration into websocket.conf template file (#372)

 conf/websocket.conf | 27 ++++++++++++++++++++++++++-
 1 file changed, 26 insertions(+), 1 deletion(-)

commit 2620d66b3a3dea004c0470947c751a23bb590ba8
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Apr 20 13:22:24 2017 -0700

    In BinaryProtocol.md use %20 in image links (#368)

 docs/BinaryProtocol.md | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 5862644e069a01f91406dac757c4c2468f6ecb73
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 20 12:14:39 2017 -0700

    Refactor dispatcher's getting next consumer with consumer priority (#367)

 .../PersistentDispatcherMultipleConsumers.java     | 150 ++++++++++++--------
 .../PersistentDispatcherFailoverConsumerTest.java  | 152 ++++++++++++++++++---
 .../client/api/SimpleProducerConsumerTest.java     | 118 +++++++++++++++-
 3 files changed, 343 insertions(+), 77 deletions(-)

commit 766e987e9b6f2189c44e679a70891f2bec846af6
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Apr 19 13:31:08 2017 -0700

    Fix for flaky test in testLeakFailedLedgerOfManageCursor (#365)

 .../java/org/apache/bookkeeper/mledger/impl/ManagedCursorTest.java     | 3 +++
 1 file changed, 3 insertions(+)

commit 3b99f3047e3ec5332804ce3a82b6f99b8a33e4fe
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Thu Apr 20 04:42:26 2017 +0900

    Use binary protocol lookup for connection between WebSocket proxy and broker (#363)

 conf/websocket.conf                                |  2 +
 .../com/yahoo/pulsar/broker/PulsarService.java     |  3 +-
 .../yahoo/pulsar/websocket/WebSocketService.java   | 19 +++--
 .../service/WebSocketProxyConfiguration.java       | 18 +++++
 .../yahoo/pulsar/websocket/LookupProtocolTest.java | 85 ++++++++++++++++++++++
 5 files changed, 120 insertions(+), 7 deletions(-)

commit d58cc0ba0bd2212026a82ae613c3403b7ddd497a
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Apr 19 09:52:26 2017 -0700

    Removing Inner structs in cpp client (#360)

 pulsar-client-cpp/include/pulsar/Client.h          | 144 +--------------------
 .../include/pulsar/ClientConfiguration.h           | 130 +++++++++++++++++++
 pulsar-client-cpp/include/pulsar/CompressionType.h |  27 ++++
 pulsar-client-cpp/include/pulsar/Consumer.h        | 102 +--------------
 .../include/pulsar/ConsumerConfiguration.h         | 128 ++++++++++++++++++
 pulsar-client-cpp/include/pulsar/Producer.h        |  66 +---------
 .../include/pulsar/ProducerConfiguration.h         |  85 ++++++++++++
 pulsar-client-cpp/lib/Client.cc                    | 136 -------------------
 pulsar-client-cpp/lib/ClientConfiguration.cc       | 122 +++++++++++++++++
 pulsar-client-cpp/lib/ClientConfigurationImpl.h    |  45 +++++++
 pulsar-client-cpp/lib/Consumer.cc                  |  95 +-------------
 pulsar-client-cpp/lib/ConsumerConfiguration.cc     |  94 ++++++++++++++
 pulsar-client-cpp/lib/ConsumerConfigurationImpl.h  |  42 ++++++
 pulsar-client-cpp/lib/Producer.cc                  | 134 +------------------
 pulsar-client-cpp/lib/ProducerConfiguration.cc     | 132 +++++++++++++++++++
 pulsar-client-cpp/lib/ProducerConfigurationImpl.h  |  52 ++++++++
 16 files changed, 862 insertions(+), 672 deletions(-)

commit 099201125cd8481af3d53e4b70638e03a9e5b025
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Apr 19 09:42:43 2017 -0700

    Add timeout on zkDataCache dependent task (#362)

 .../pulsar/broker/authorization/AuthorizationManager.java    | 12 ++++++++++--
 .../com/yahoo/pulsar/broker/namespace/NamespaceService.java  | 12 +++++++-----
 .../java/com/yahoo/pulsar/broker/web/PulsarWebResource.java  |  8 +++++++-
 .../main/java/com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |  6 +++++-
 4 files changed, 29 insertions(+), 9 deletions(-)

commit e7622f3a9ddf2a88e9a7cb9838010948f0239c77
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Tue Apr 18 06:07:13 2017 +0900

    Fixed WebSocket TLS connection bug (#356)

 .../com/yahoo/pulsar/websocket/WebSocketService.java |  5 +++++
 .../service/WebSocketProxyConfiguration.java         | 20 ++++++++++++++++++++
 2 files changed, 25 insertions(+)

commit 927862392b7cc2af1fe58a2a0714fb8a02363975
Author: Brad McMillen <brad@mcmillen.com>
Date:   Mon Apr 17 14:06:48 2017 -0700

    Fix LoadManager shutdown timing issue (#358)
    
    * Fix LoadManager shutdown timing issue
    
    * Remove synchronization on close()

 .../yahoo/pulsar/broker/loadbalance/impl/ModularLoadManagerImpl.java    | 2 +-
 .../com/yahoo/pulsar/broker/loadbalance/impl/SimpleLoadManagerImpl.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit b2e3d33b923733ea16218e4b5d0b8c16eeda87e3
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Apr 17 12:22:16 2017 -0700

    Small fixes in CPP Client (#357)

 pulsar-client-cpp/include/pulsar/Client.h    | 2 +-
 pulsar-client-cpp/lib/BrokerConsumerStats.cc | 5 +----
 2 files changed, 2 insertions(+), 5 deletions(-)

commit 6099e88f7ab03e86306536d1f4bead11edcc0631
Author: jai1 <jai1@users.noreply.github.com>
Date:   Sun Apr 16 17:50:59 2017 -0700

    Removed ability to disable connection pool (#337)

 .../main/java/com/yahoo/pulsar/client/api/ClientConfiguration.java   | 5 +++--
 .../main/java/com/yahoo/pulsar/testclient/PerformanceConsumer.java   | 2 +-
 .../main/java/com/yahoo/pulsar/testclient/PerformanceProducer.java   | 2 +-
 3 files changed, 5 insertions(+), 4 deletions(-)

commit df34ae7c51881083f70935e3882ffb2ac5109dd8
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 13 17:54:43 2017 -0700

    fix import into AdminApiTest and introduce disable-namespaceBundle unit test (#354)

 .../yahoo/pulsar/broker/service/BrokerService.java |  2 +-
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 31 +-------------------
 .../yahoo/pulsar/broker/admin/NamespacesTest.java  | 33 ++++++++++++++++++++++
 .../pulsar/broker/service/BrokerServiceTest.java   | 30 ++++++++++++++++++++
 4 files changed, 65 insertions(+), 31 deletions(-)

commit 19399e0f273e45e94b9d4ce70956b131b3506395
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 13 10:43:35 2017 -0700

    Delete local-policies and invalidate cache when namespace is deleted (#352)

 .../com/yahoo/pulsar/broker/admin/Namespaces.java  |  9 ++++--
 .../pulsar/broker/namespace/NamespaceService.java  |  3 ++
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 36 ++++++++++++++++++----
 3 files changed, 40 insertions(+), 8 deletions(-)

commit bd5a6222ec7a6ac10054dd7263a758bc3cd3ff84
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 13 10:43:20 2017 -0700

    register listener on dynamic-config zpath even if deserialization fail on service startup (#351)

 .../yahoo/pulsar/broker/service/BrokerService.java | 70 +++++++++++-----------
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 36 +++++++++++
 2 files changed, 72 insertions(+), 34 deletions(-)

commit fc109317349aa4b7ac0dd17757dda7a80fea1288
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Wed Apr 12 14:45:22 2017 -0700

    Fix bug causing removed brokers to be considered as candidates (#343)
    
    * Make candidate selection only consider active brokers

 .../loadbalance/impl/ModularLoadManagerImpl.java   |  71 ++++---
 .../loadbalance/ModularLoadManagerImplTest.java    | 207 +++++++++++++++++++++
 .../ModularLoadManagerStrategyTest.java            |  15 ++
 3 files changed, 268 insertions(+), 25 deletions(-)

commit 8bc4235216af11baf6ea4eccc21019c7c62f34bf
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Wed Apr 12 14:44:29 2017 -0700

    Fixes to some of the issues reported by fbinfer static code analyzer (#344)

 .../apache/bookkeeper/mledger/impl/ManagedCursorContainer.java   | 2 +-
 .../pulsar/broker/loadbalance/impl/SimpleLoadManagerImpl.java    | 5 +++++
 .../loadbalance/impl/SimpleResourceAllocationPolicies.java       | 9 ++++++---
 .../java/com/yahoo/pulsar/broker/namespace/NamespaceService.java | 3 ---
 .../src/main/java/com/yahoo/pulsar/client/admin/PulsarAdmin.java | 3 ++-
 .../src/main/java/com/yahoo/pulsar/client/cli/CmdProduce.java    | 1 +
 .../main/java/com/yahoo/pulsar/client/impl/ConsumerStats.java    | 3 +++
 .../main/java/com/yahoo/pulsar/client/impl/ProducerStats.java    | 3 +++
 .../pulsar/common/policies/impl/NamespaceIsolationPolicies.java  | 2 +-
 9 files changed, 22 insertions(+), 9 deletions(-)

commit f572241537b958a8afda48b8af13ea768a7230f7
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Apr 12 10:33:00 2017 -0700

    Remove orphan ledger when  managedCursor fails to switch ledger (#350)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 20 ++++++-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java | 67 ++++++++++++++++++++++
 2 files changed, 86 insertions(+), 1 deletion(-)

commit b5fd035dba5e82a3f31d943d03ff8c0795be0587
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Apr 12 10:25:17 2017 -0700

    Legacy code expects the AuthData to be initialized to Auth::Disabled (#348)

 pulsar-client-cpp/include/pulsar/Client.h | 6 ++++++
 pulsar-client-cpp/lib/Client.cc           | 1 +
 2 files changed, 7 insertions(+)

commit e224df9ea01e51650148aa001a3490d34200d2e2
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 11 18:10:30 2017 -0700

    Regenerate OAuth token for github releases upload from travis (#349)

 .travis.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 731e5df6e92d6a07088b8f9e3cac98e5d90258b7
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Mon Apr 10 15:36:22 2017 -0700

    Fix Bugs Introduced by New Load Manager (#332)
    
    * Fix bugs introduced by new load manager

 .../loadbalance/impl/LeastLongTermMessageRate.java | 33 ++++++++------
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 20 +++++----
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 11 ++++-
 .../pulsar/broker/namespace/NamespaceService.java  |  8 ++--
 .../broker/namespace/ServiceUnitZkUtils.java       | 24 +++++-----
 .../yahoo/pulsar/broker/service/BrokerService.java |  2 +-
 .../broker/loadbalance/LoadBalancerTest.java       | 23 +++++++++-
 .../ModularLoadManagerStrategyTest.java            | 51 ++++++++++++++++++++++
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java   | 11 ++++-
 .../yahoo/pulsar/zookeeper/ZooKeeperDataCache.java | 17 +++++++-
 10 files changed, 159 insertions(+), 41 deletions(-)

commit 74c5b6ef8ab953c61bb7b72fc4ff3e713ccecaec
Author: jai1 <jai1@users.noreply.github.com>
Date:   Sun Apr 9 23:03:14 2017 -0700

    BrokerConsumerStats - refactored the server side logic to get stats. (#339)
    
    * BrokerConsumerStats - refactored the server side logic to get stats.
    
    * Addressed Andrew's CR comments
    
    * Addressed Matteo's and Rajan's CR comments
    
    * Addressed Matteo's and Rajan's CR comments
    
    * Corrected comments in proto file
    
    * Changed field number to 4

 .../com/yahoo/pulsar/broker/service/Consumer.java  |   4 +
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |  72 ++-----
 .../yahoo/pulsar/broker/service/Subscription.java  |   4 +
 pulsar-client-cpp/lib/ClientConnection.cc          |   7 +-
 pulsar-client-cpp/lib/ClientConnection.h           |   3 +-
 pulsar-client-cpp/lib/Commands.cc                  |   5 +-
 pulsar-client-cpp/lib/Commands.h                   |   3 +-
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   4 +-
 pulsar-client-cpp/lib/PulsarApi.pb.cc              | 142 +++++--------
 pulsar-client-cpp/lib/PulsarApi.pb.h               | 236 ++++-----------------
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 219 +------------------
 pulsar-common/src/main/proto/PulsarApi.proto       |   7 +-
 12 files changed, 148 insertions(+), 558 deletions(-)

commit 2d07cd58bc54f290b635d84a71c1e122a96b5097
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Apr 7 10:57:43 2017 -0700

    CPP Client - Async call for getting broker side consumer stats

 .../include/pulsar/BrokerConsumerStats.h           |  86 +++++++++++
 pulsar-client-cpp/include/pulsar/Consumer.h        | 101 +++---------
 pulsar-client-cpp/include/pulsar/ConsumerType.h    |  40 +++++
 pulsar-client-cpp/lib/BrokerConsumerStats.cc       |  99 ++++++++++++
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.cc   | 127 ++++++++++++++++
 pulsar-client-cpp/lib/BrokerConsumerStatsImpl.h    | 126 +++++++++++++++
 .../lib/BrokerConsumerStatsImplBase.h              |  67 ++++++++
 pulsar-client-cpp/lib/ClientConnection.cc          |  14 +-
 pulsar-client-cpp/lib/ClientConnection.h           |   7 +-
 pulsar-client-cpp/lib/Consumer.cc                  |  69 +++------
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  46 +++---
 pulsar-client-cpp/lib/ConsumerImpl.h               |   8 +-
 pulsar-client-cpp/lib/ConsumerImplBase.h           |   2 +-
 .../lib/PartitionedBrokerConsumerStatsImpl.cc      | 167 ++++++++++++++++++++
 .../lib/PartitionedBrokerConsumerStatsImpl.h       |  90 +++++++++++
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  43 ++++--
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |   8 +-
 pulsar-client-cpp/lib/ProducerImpl.cc              |   2 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       | 169 ++++++++++++++++-----
 19 files changed, 1062 insertions(+), 209 deletions(-)

commit 911a9b67bf0096ec26faa7c1a1177bd8455bcf61
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 6 17:41:29 2017 -0700

    deserialize load report based on load-manager (#338)

 .../pulsar/broker/loadbalance/LoadManager.java     |  9 ++++
 .../broker/loadbalance/ModularLoadManager.java     |  9 ++++
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 11 +++++
 .../impl/ModularLoadManagerWrapper.java            |  7 +++
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  9 ++++
 .../pulsar/broker/namespace/NamespaceService.java  |  8 +---
 .../broker/namespace/NamespaceServiceTest.java     | 56 +++++++++++++++++++++-
 7 files changed, 102 insertions(+), 7 deletions(-)

commit 4866563de262eaae5ae8646cda207dcdece21272
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Apr 6 15:50:21 2017 -0700

    return if serviceNotReady while creating topic (#336)

 .../com/yahoo/pulsar/broker/service/BrokerService.java    |  1 +
 .../testclient/utils/FixedColumnLengthTableMaker.java     | 15 +++++++++++++++
 2 files changed, 16 insertions(+)

commit b38da8840a1b68bf8ce2739122c94a179677d0db
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Thu Apr 6 12:19:04 2017 -0700

    Improve Simulation Tools and Add Documentation (#328)
    
    * Add documentation, improve simulation tools.
    
    * Add global summary for monitor
    
    * monitor -> monitor-brokers
    
    * Don't modify performance producer/consumer
    
    * Use property/cluster instead of cluster/property for simulation
    
    * Fix regex

 bin/pulsar-perf                                    |  17 +-
 docs/Documentation.md                              |   1 +
 docs/SimulationTools.md                            | 101 ++++
 .../pulsar/broker/loadbalance/LoadManager.java     |   5 +-
 .../broker/loadbalance/impl/LoadManagerShared.java |  15 +-
 .../loadbalance/impl/ModularLoadManagerImpl.java   |   9 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |   2 -
 .../com/yahoo/pulsar/testclient/BrokerMonitor.java | 459 +++++++++++++++
 .../pulsar/testclient/LoadSimulationClient.java    | 170 +++---
 .../testclient/LoadSimulationController.java       | 623 +++++++++++----------
 .../ModularLoadManagerBrokerMonitor.java           | 205 -------
 .../testclient/SimpleLoadManagerBrokerMonitor.java | 197 -------
 .../utils/FixedColumnLengthTableMaker.java         | 141 +++++
 13 files changed, 1149 insertions(+), 796 deletions(-)

commit 8080e88bdbd4eca230cd8be759cd8b8303ea7a26
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Apr 6 08:47:25 2017 -0700

    Fixed BasicEndToEndTest.testResendViaSendCallback (#333)
    
    * Fixed BasicEndToEndTes.testResendViaSendCallback
    
    * Update travis-build.sh
    
    * Added include path for json headers
    
    * Update travis-build.sh
    
    * Update travis-build.sh
    
    * Update CMakeLists.txt

 pulsar-client-cpp/CMakeLists.txt             |  8 ++++++++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 18 +++++++++++-------
 pulsar-client-cpp/travis-build.sh            |  2 +-
 3 files changed, 20 insertions(+), 8 deletions(-)

commit b1469b17a02727e4d50a9223844b086cc08ee1f6
Author: hefeiyun <hfy231-30@163.com>
Date:   Thu Apr 6 23:46:13 2017 +0800

    Update cpp client README.md with mention of libjsoncpp  (#334)

 pulsar-client-cpp/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bea8ff221b02aa3ed4fb33bbd2ac71db1fc1b0d6
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Apr 5 16:14:04 2017 -0700

    HTTP lookups for c++ client lib (#317)

 pulsar-client-cpp/CMakeLists.txt                  |   6 +
 pulsar-client-cpp/README.md                       |   2 +-
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc |   1 -
 pulsar-client-cpp/lib/BinaryProtoLookupService.h  |  12 +-
 pulsar-client-cpp/lib/ClientImpl.cc               |  18 +-
 pulsar-client-cpp/lib/ClientImpl.h                |   2 +-
 pulsar-client-cpp/lib/HTTPLookupService.cc        | 200 ++++++++++++++++++++++
 pulsar-client-cpp/lib/HTTPLookupService.h         |  61 +++++++
 pulsar-client-cpp/lib/LookupDataResult.h          |   2 +
 pulsar-client-cpp/lib/LookupService.h             |  45 +++++
 pulsar-client-cpp/lib/Url.cc                      |  29 +++-
 pulsar-client-cpp/lib/Url.h                       |  10 +-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc      |   2 +-
 pulsar-client-cpp/tests/UrlTest.cc                |  16 ++
 14 files changed, 386 insertions(+), 20 deletions(-)

commit 16d8177c05801c7eac367ab58a81b07a8135491d
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Wed Apr 5 10:13:40 2017 -0700

    Use historical data from old API in new API (#329)

 .../loadbalance/impl/ModularLoadManagerImpl.java   | 26 ++++++++++++++++++++++
 1 file changed, 26 insertions(+)

commit e34b595ba3e44314edace5afa3cc8b1267f73b65
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Apr 4 12:44:12 2017 -0700

    Fixed pulsar-spark pom version (#330)

 pulsar-spark/pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit b1df955092ca7ec99b90af5180f01c44c4b88007
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Wed Apr 5 02:51:01 2017 +0900

    Added spark streaming custom receiver for pulsar (#296)

 docs/Documentation.md                              |   1 +
 docs/PulsarSpark.md                                |  45 ++++++++
 docs/locale/ja/Documentation.md                    |   1 +
 docs/locale/ja/PulsarSpark.md                      |  45 ++++++++
 pom.xml                                            |  29 +++++
 pulsar-spark/pom.xml                               | 124 +++++++++++++++++++++
 .../pulsar/spark/SparkStreamingPulsarReceiver.java |  91 +++++++++++++++
 .../spark/SparkStreamingPulsarReceiverTest.java    |  84 ++++++++++++++
 .../SparkStreamingPulsarReceiverExample.java       |  69 ++++++++++++
 9 files changed, 489 insertions(+)

commit 378217d468e0c392ebb5d1e480649e6c4296a4a0
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Apr 3 13:58:03 2017 -0700

    create dynamic-config znode if not present (#327)

 .../yahoo/pulsar/broker/service/BrokerService.java | 14 ++++++++
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 41 ++++++++++------------
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  2 +-
 .../service/BrokerServiceThrottlingTest.java       | 32 -----------------
 .../PersistentDispatcherFailoverConsumerTest.java  |  3 +-
 .../service/PersistentTopicConcurrentTest.java     |  3 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  3 +-
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  4 +--
 8 files changed, 41 insertions(+), 61 deletions(-)

commit 8c270c94088ce2386741dfd92e7898cd2dea08a5
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Sun Apr 2 01:02:34 2017 +0900

    Added api to get list of partitioned topics (#319)

 docs/AdminTools.md                                 | 33 +++++++++++++++--
 .../pulsar/broker/admin/PersistentTopics.java      | 41 ++++++++++++++++++++++
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |  3 ++
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |  3 ++
 .../pulsar/client/admin/PersistentTopics.java      | 23 ++++++++++++
 .../admin/internal/PersistentTopicsImpl.java       | 12 +++++++
 .../pulsar/admin/cli/CmdPersistentTopics.java      | 13 +++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |  3 ++
 8 files changed, 129 insertions(+), 2 deletions(-)

commit 06ec3bb1be401e28a8b99867ab503dd163c4b87b
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Sat Apr 1 09:02:13 2017 -0700

    Add documentation for changing load manager (#325)

 docs/Documentation.md      |   1 +
 docs/ModularLoadManager.md | 112 +++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 113 insertions(+)

commit b2e676d766bfb6f99809524400b0d32a7b128b57
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Mar 30 21:55:56 2017 -0700

    Avoid extra retain of entry data (#326)

 .../src/main/java/org/apache/bookkeeper/mledger/impl/EntryImpl.java      | 1 -
 1 file changed, 1 deletion(-)

commit a7d476fde30598278f021974f4937c6ae45f0d17
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Mar 30 21:54:57 2017 -0700

    Fixed CPP Client test cases for BasicEndToEndTests.cc (#323)

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 49 +++++++++++++++++-----------
 pulsar-client-cpp/tests/BatchMessageTest.cc  |  3 +-
 2 files changed, 32 insertions(+), 20 deletions(-)

commit d22d656c174503c2a6212500c53b2acf5385e24b
Author: rdhabalia <rdhabalia@yahoo-inc.com>
Date:   Thu Mar 30 20:22:05 2017 -0700

    Bump version to 1.18-SNAPSHOT

 all/pom.xml                       | 2 +-
 managed-ledger/pom.xml            | 2 +-
 pom.xml                           | 2 +-
 pulsar-broker-auth-athenz/pom.xml | 2 +-
 pulsar-broker-common/pom.xml      | 2 +-
 pulsar-broker/pom.xml             | 2 +-
 pulsar-checksum/pom.xml           | 2 +-
 pulsar-client-admin/pom.xml       | 2 +-
 pulsar-client-auth-athenz/pom.xml | 2 +-
 pulsar-client-tools/pom.xml       | 2 +-
 pulsar-client/pom.xml             | 2 +-
 pulsar-common/pom.xml             | 2 +-
 pulsar-discovery-service/pom.xml  | 2 +-
 pulsar-storm/pom.xml              | 2 +-
 pulsar-testclient/pom.xml         | 2 +-
 pulsar-websocket/pom.xml          | 2 +-
 pulsar-zookeeper-utils/pom.xml    | 2 +-
 17 files changed, 17 insertions(+), 17 deletions(-)

commit a64be757c2ee9c3a96247d085a75755614d2b915
Author: rdhabalia <rdhabalia@yahoo-inc.com>
Date:   Thu Mar 30 19:14:13 2017 -0700

    Pulsar release v1.17

 all/pom.xml                       | 2 +-
 managed-ledger/pom.xml            | 2 +-
 pom.xml                           | 2 +-
 pulsar-broker-auth-athenz/pom.xml | 2 +-
 pulsar-broker-common/pom.xml      | 2 +-
 pulsar-broker/pom.xml             | 2 +-
 pulsar-checksum/pom.xml           | 2 +-
 pulsar-client-admin/pom.xml       | 2 +-
 pulsar-client-auth-athenz/pom.xml | 2 +-
 pulsar-client-tools/pom.xml       | 2 +-
 pulsar-client/pom.xml             | 2 +-
 pulsar-common/pom.xml             | 2 +-
 pulsar-discovery-service/pom.xml  | 2 +-
 pulsar-storm/pom.xml              | 2 +-
 pulsar-testclient/pom.xml         | 2 +-
 pulsar-websocket/pom.xml          | 2 +-
 pulsar-zookeeper-utils/pom.xml    | 2 +-
 17 files changed, 17 insertions(+), 17 deletions(-)

commit 9e31e89135ff8e95e3d2981bbb97b59e9c2f5458
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Mar 30 19:09:23 2017 -0700

    Make EntryImpl recyclable to improve gc at broker (#318)
    
    * Recycle EntryImpl of EntryCache
    
    * remove position import from Entry
    
    * Use proper ref-counting semantic for Entry and removed position-impl recycling
    
    * release data after retain into Entry + make variables final in position
    
    * Fixed ref-counting after reading entries

 .../java/org/apache/bookkeeper/mledger/Entry.java  |   9 +-
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |  30 +++---
 .../bookkeeper/mledger/impl/EntryCacheManager.java |   5 +-
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  | 105 ++++++++++++++-------
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |   5 -
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |   1 -
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |   6 +-
 .../bookkeeper/mledger/impl/OpFindNewest.java      |   7 +-
 .../bookkeeper/mledger/impl/OpReadEntry.java       |   3 +-
 .../bookkeeper/mledger/impl/PositionImpl.java      |  34 +------
 .../apache/bookkeeper/mledger/util/RangeCache.java |   2 +
 .../bookkeeper/mledger/util/ReferenceCounted.java  |  22 -----
 .../mledger/impl/EntryCacheManagerTest.java        |  30 +++---
 .../bookkeeper/mledger/impl/EntryCacheTest.java    |  24 ++---
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  27 +++---
 .../bookkeeper/mledger/util/RangeCacheTest.java    |  36 +++----
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  11 ++-
 .../PersistentDispatcherMultipleConsumers.java     |   9 +-
 .../service/persistent/PersistentReplicator.java   |   2 +-
 .../service/persistent/PersistentSubscription.java |   3 -
 .../broker/service/persistent/PersistentTopic.java |   1 -
 21 files changed, 186 insertions(+), 186 deletions(-)

commit 1e02afb29fb3016f8a2ea8851c3b0fa56b4be85b
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Thu Mar 30 15:01:15 2017 -0700

    Introduce new load manager API (#303)
    
    * Introduce new load manager API
    
    * Fix formatting and style issues
    
    * Fix imports
    
    * Add back renamed classes
    
    * Add policies to ModularLoadManagerImpl
    
    * Make system resource usage more influential
    
    * Fix reflective setting of load manager in tests
    
    * Conform with mockito syntax
    
    * Improve formatting and design
    
    * Revert to old simulation behavior, use reflective interface design
    
    * Remove unnecessary async call
    
    * Fix formatting
    
    * Remove git merge remnant
    
    * Refactor some classes and put loadManagerClassName in dynamic conf
    
    * Delete LoadSimulationServer
    
    * Clean API, share more code
    
    * Remove redundant synchronized block, make correction to onUpdate
    
    * Fix policy filter bug
    
    * Remove availableActiveBrokers.get() call
    
    * Use connection pooling
    
    * Remove unused code
    
    * Don't try reading the symlink and converting to absolute path
    
    * Remove redundant and unnecessary statments
    
    * Add test back to see if path contains /virtual/
    
    * Replace System.out statements with log.info
    
    * Change %s to {}

 bin/pulsar-perf                                    |  19 +-
 conf/broker.conf                                   |   3 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  13 +-
 .../java/com/yahoo/pulsar/broker/BrokerData.java   |  67 ++
 .../java/com/yahoo/pulsar/broker/BundleData.java   |  93 +++
 .../java/com/yahoo/pulsar/broker/JSONWritable.java |  48 ++
 .../com/yahoo/pulsar/broker/LocalBrokerData.java   | 345 ++++++++++
 .../com/yahoo/pulsar/broker/PulsarService.java     |  16 +-
 .../yahoo/pulsar/broker/TimeAverageBrokerData.java | 168 +++++
 .../pulsar/broker/TimeAverageMessageData.java      | 161 +++++
 .../com/yahoo/pulsar/broker/admin/BrokerStats.java |  12 +-
 .../com/yahoo/pulsar/broker/admin/Brokers.java     |   3 +-
 .../pulsar/broker/loadbalance/BrokerFilter.java    |  45 ++
 .../yahoo/pulsar/broker/loadbalance/LoadData.java  |  53 ++
 .../pulsar/broker/loadbalance/LoadManager.java     |  39 ++
 .../broker/loadbalance/LoadReportUpdaterTask.java  |   7 +-
 .../loadbalance/LoadResourceQuotaUpdaterTask.java  |   7 +-
 .../broker/loadbalance/LoadSheddingStrategy.java   |  37 +
 .../broker/loadbalance/LoadSheddingTask.java       |   7 +-
 .../broker/loadbalance/ModularLoadManager.java     |  91 +++
 .../loadbalance/ModularLoadManagerStrategy.java    |  62 ++
 .../broker/loadbalance/impl/DeviationShedder.java  | 151 +++++
 .../loadbalance/impl/LeastLongTermMessageRate.java | 118 ++++
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java |  47 +-
 .../broker/loadbalance/impl/LoadManagerShared.java | 158 +++++
 .../loadbalance/impl/ModularLoadManagerImpl.java   | 593 ++++++++++++++++
 .../impl/ModularLoadManagerWrapper.java            | 106 +++
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 742 +++++++++++----------
 .../pulsar/broker/namespace/NamespaceService.java  |  35 +-
 .../broker/namespace/ServiceUnitZkUtils.java       |   2 +-
 .../yahoo/pulsar/broker/service/BrokerService.java |  14 +-
 .../pulsar/broker/stats/MetricsGenerator.java      |   2 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  22 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |   6 +-
 .../pulsar/client/api/BrokerServiceLookupTest.java |  45 +-
 .../client/impl/BrokerClientIntegrationTest.java   |   2 +-
 .../policies/data/loadbalancer/LoadReport.java     | 154 ++++-
 .../data/loadbalancer/ResourceUnitRanking.java     |  24 +-
 .../data/loadbalancer/ServiceLookupData.java       |  27 +
 .../pulsar/discovery/service/ServerConnection.java |   2 +-
 pulsar-testclient/pom.xml                          |  14 +
 .../pulsar/testclient/LoadSimulationClient.java    | 374 +++++++++++
 .../testclient/LoadSimulationController.java       | 661 ++++++++++++++++++
 .../ModularLoadManagerBrokerMonitor.java           | 205 ++++++
 .../pulsar/testclient/PerformanceConsumer.java     |   6 +-
 .../testclient/SimpleLoadManagerBrokerMonitor.java | 197 ++++++
 46 files changed, 4512 insertions(+), 491 deletions(-)

commit 66c091e4105f4a3b6edc7ead7a4d2d69c305ee59
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Mar 31 03:25:11 2017 +0900

    Start auth service before providing auth data in PulsarAdmin (#321)

 .../java/com/yahoo/pulsar/client/admin/PulsarAdmin.java | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

commit 28862505dc2705d6c753601576b608d63fb7fc23
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Mar 24 16:05:28 2017 -0700

    Add topic loading throttling (#306)

 conf/broker.conf                                   |  3 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  | 11 +++
 .../yahoo/pulsar/broker/service/BrokerService.java | 92 +++++++++++++++++++---
 .../broker/service/BrokerServiceException.java     |  8 ++
 .../com/yahoo/pulsar/broker/service/ServerCnx.java | 11 ++-
 .../pulsar/broker/service/BrokerServiceTest.java   |  2 +-
 .../service/BrokerServiceThrottlingTest.java       |  6 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 67 ++++++++++++++++
 .../pulsar/client/api/PulsarClientException.java   |  4 +-
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |  4 +-
 10 files changed, 187 insertions(+), 21 deletions(-)

commit 7dbd59698018b90f36f5b38f34446d9a5e88fea4
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Sat Mar 25 07:15:01 2017 +0900

    Add Athenz unit tests (#314)

 pom.xml                                            |   5 +-
 pulsar-broker-auth-athenz/pom.xml                  |  10 +-
 .../AuthenticationProviderAthenzTest.java          | 119 +++++++++++++++++++++
 .../src/test/resources/athenz.conf                 |  16 +++
 .../src/test/resources/zts_private.pem             |  27 +++++
 .../src/test/resources/zts_public.pem              |   9 ++
 .../client/impl/auth/AuthenticationAthenz.java     |  10 +-
 .../client/impl/auth/AuthenticationAthenzTest.java | 111 +++++++++++++++++++
 .../src/test/resources/athenz.conf                 |  16 +++
 .../src/test/resources/tenant_private.pem          |  27 +++++
 .../src/test/resources/tenant_public.pem           |   9 ++
 .../src/test/resources/zts_private.pem             |  27 +++++
 .../src/test/resources/zts_public.pem              |   9 ++
 13 files changed, 387 insertions(+), 8 deletions(-)

commit 80986d79eaf50bdd17dbfdc7bd9e9c40ee7d39f9
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 24 15:14:42 2017 -0700

    Fix for cursor reset after topic reload (#315)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 41 ++++++----------------
 .../mledger/impl/ManagedLedgerBkTest.java          | 32 +++++++++++++++++
 2 files changed, 43 insertions(+), 30 deletions(-)

commit df0bf9e2028347a07be85ef7509e16102b8e67b3
Author: bobbeyreese <breese@yahoo-inc.com>
Date:   Fri Mar 24 14:30:15 2017 -0700

    Atomically Set State when Closing Producer (#313)

 .../main/java/com/yahoo/pulsar/client/impl/HandlerBase.java |  5 +++++
 .../java/com/yahoo/pulsar/client/impl/ProducerImpl.java     | 13 +++++++++----
 2 files changed, 14 insertions(+), 4 deletions(-)

commit 6710a7bc888d29b4b51ced1c138bc1bc6900134c
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 24 10:07:20 2017 -0700

    Added REST and CLI tool to expose ManagedLedger metadata (#292)

 .../apache/bookkeeper/mledger/AsyncCallbacks.java  |   6 +
 .../bookkeeper/mledger/ManagedLedgerFactory.java   |  25 ++++
 .../bookkeeper/mledger/ManagedLedgerInfo.java      |  75 +++++++++++
 .../mledger/impl/ManagedLedgerFactoryImpl.java     | 148 +++++++++++++++++++++
 .../mledger/impl/ManagedLedgerFactoryTest.java     |  91 +++++++++++++
 .../pulsar/broker/admin/PersistentTopics.java      |  35 ++++-
 .../pulsar/client/admin/PersistentTopics.java      |  31 +++++
 .../admin/internal/PersistentTopicsImpl.java       |  38 +++++-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  20 ++-
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   3 +
 .../pulsar/common/util/ObjectMapperFactory.java    |   3 +
 11 files changed, 471 insertions(+), 4 deletions(-)

commit 5a28f6324d4b2ac9b2ba078de4135c23ce636b57
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Mar 23 13:53:19 2017 -0700

    Added more checks in CPP Client URL Tests (#312)

 pulsar-client-cpp/tests/UrlTest.cc | 5 +++++
 1 file changed, 5 insertions(+)

commit 181172f7af3e40e14373084b17e76d064949938e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 23 12:08:40 2017 -0700

    Exclude netty individual jars from binary distribution (#311)

 all/src/assemble/bin.xml | 12 ++++++++++++
 1 file changed, 12 insertions(+)

commit 9c5088fce289a3ec6e23244904fdc68ede429c0b
Author: massakam <massakam@yahoo-corp.jp>
Date:   Fri Mar 24 03:06:14 2017 +0900

    Fix typo in ConsumerHandler (#310)

 .../websocket/proxy/ProxyPublishConsumeTest.java   | 35 +++++++++++++++-------
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |  4 +--
 2 files changed, 27 insertions(+), 12 deletions(-)

commit b7bc3810ba766c248c25fe079feaab01503a3090
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Fri Mar 24 01:38:35 2017 +0900

    Add Athenz documentation (#301)

 docs/Authentication.md | 101 +++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 101 insertions(+)

commit a86b6df3c54da8f78bd986f2541cd106f031421e
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Mar 24 01:37:28 2017 +0900

    added c++ sample code to documents (#304)

 docs/Authentication.md                             | 24 +++++++++-
 docs/GettingStarted.md                             | 53 ++++++++++++++++++++++
 pulsar-client-cpp/examples/SampleAsyncProducer.cc  |  2 +
 pulsar-client-cpp/examples/SampleConsumer.cc       |  2 +
 .../examples/SampleConsumerListener.cc             |  2 +
 pulsar-client-cpp/examples/SampleProducer.cc       |  2 +
 pulsar-client-cpp/travis-build.sh                  |  2 +-
 7 files changed, 84 insertions(+), 3 deletions(-)

commit 8dd9ef4e324bf68deb34a35cf3f416cd1248c12e
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 23 09:36:24 2017 -0700

    Update BK to 4.3.1.60-yahoo (#302)
    
    Changes includes:
      * Fixes for 64bit ledger ids
      * Fixed memory leak on read-only bookies
      * Fixed datasketches metric provider concurrency issue

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 8cee84677a6d097453e6e80bf3c2b99425bbb3ad
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Mar 22 10:12:32 2017 -0700

    Fixed CPP Client ABI (backward compatibility) with minimal changes. (#290)

 pulsar-client-cpp/.gitignore                       |  1 +
 pulsar-client-cpp/CMakeLists.txt                   | 10 ++++-
 .../include/pulsar/{Auth.h => Authentication.h}    | 51 +++++-----------------
 pulsar-client-cpp/include/pulsar/Client.h          | 37 ++++++++++++++--
 pulsar-client-cpp/include/pulsar/Message.h         | 15 +++----
 .../lib/{Auth.cc => Authentication.cc}             | 26 +++++------
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |  2 +-
 pulsar-client-cpp/lib/CMakeLists.txt               | 10 +++--
 pulsar-client-cpp/lib/Client.cc                    | 26 ++++++++---
 pulsar-client-cpp/lib/Commands.h                   |  2 +-
 pulsar-client-cpp/lib/auth/AuthTls.h               |  2 +-
 pulsar-client-cpp/perf/PerfConsumer.cc             |  6 +--
 pulsar-client-cpp/perf/PerfProducer.cc             |  6 +--
 pulsar-client-cpp/tests/AuthPluginTest.cc          | 10 ++---
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  2 +-
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |  4 +-
 16 files changed, 114 insertions(+), 96 deletions(-)

commit dd7de4d7a2b8a5099ad06c4d65827ca047e41fb7
Author: Hwan-Joon Choi <hc5duke@gmail.com>
Date:   Sun Mar 19 17:15:51 2017 -0700

    Fix typo in docs/Architecture.md (#297)

 docs/Architecture.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit bd3fbb28deba268cfed53d52455fda6bcad68f35
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Fri Mar 17 15:36:57 2017 +0900

    translate documents into japanese (#285)
    
    * translate documents into japanese
    
    * reference the same files under doc/images folder
    
    * fixed typo
    
    * delete unnecessary line
    
    * Change the expression of a few words
    
    * add a link to the translation in Documentation.md

 docs/Documentation.md            |    2 +
 docs/locale/ja/AdminTools.md     | 2232 ++++++++++++++++++++++++++++++++++++++
 docs/locale/ja/Architecture.md   |  353 ++++++
 docs/locale/ja/Authentication.md |  141 +++
 docs/locale/ja/Authorization.md  |   66 ++
 docs/locale/ja/BinaryProtocol.md |  522 +++++++++
 docs/locale/ja/ClusterSetup.md   |  345 ++++++
 docs/locale/ja/Documentation.md  |   15 +
 docs/locale/ja/GeoReplication.md |  110 ++
 docs/locale/ja/GettingStarted.md |  148 +++
 docs/locale/ja/PulsarStorm.md    |  107 ++
 docs/locale/ja/README.md         |   44 +
 docs/locale/ja/WebSocket.md      |  276 +++++
 13 files changed, 4361 insertions(+)

commit 49ac77d9c7261806ccf81bac91b12708f856ddef
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Mar 14 15:24:40 2017 -0700

    add hyperlink for getting-started doc (#293)

 docs/AdminTools.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit f0fbb4da55d60099af12159f7b7932f9ec4843b3
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Mar 12 22:31:06 2017 -0700

    Extending ZK version wrapper to include ctime and mtime (#288)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 28 ++++-----
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 42 +++++++-------
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |  6 +-
 .../apache/bookkeeper/mledger/impl/MetaStore.java  | 13 +++--
 .../mledger/impl/MetaStoreImplZookeeper.java       | 66 +++++++++++++++-------
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 12 ++--
 .../mledger/impl/MetaStoreImplZookeeperTest.java   | 18 +++---
 7 files changed, 106 insertions(+), 79 deletions(-)

commit d1cb591da6f35673b4af1d229fced3996744b7cb
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 10 16:52:21 2017 -0800

    Fixed race condition in cursor.asyncDelete() (#287)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 109 ++++++++++-----------
 1 file changed, 54 insertions(+), 55 deletions(-)

commit 6d4bd9d2563fe6ad56cc24a7be7ef647ff656a2c
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Mar 10 16:23:21 2017 -0800

    close client connectionon  tooManyRequest and internal-server error (#274)

 .../pulsar/broker/admin/PersistentTopics.java      |   6 +-
 .../yahoo/pulsar/broker/service/BrokerService.java |   3 +-
 .../yahoo/pulsar/broker/web/PulsarWebResource.java |  30 ++---
 .../pulsar/broker/service/BrokerServiceTest.java   |   3 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 134 ++++++++++++++++++---
 .../pulsar/client/api/ClientConfiguration.java     |  22 ++++
 .../client/impl/BinaryProtoLookupService.java      |   3 +-
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |  49 +++++++-
 8 files changed, 209 insertions(+), 41 deletions(-)

commit 146738c59098f0c50ef827c9d21c155e7312c313
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Mar 10 14:38:40 2017 -0800

    Enable ML binary format from broker configuration (#282)

 .../mledger/ManagedLedgerFactoryConfig.java        |  10 ++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  25 ++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |   2 +-
 .../mledger/impl/MetaStoreImplZookeeper.java       | 183 ++++++++++++++-------
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |   8 +
 .../impl/ManagedLedgerBinaryFormatConversion.java  | 106 ++++++++++++
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |   8 +
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |  14 +-
 8 files changed, 286 insertions(+), 70 deletions(-)

commit 1fa4508e0a744a4a5cf040740b4d4cf367db9ee1
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Mar 10 11:19:45 2017 -0800

    reduce collection instances while generating metrics (#284)
    
    reduce collection instances while generating metrics

 .../yahoo/pulsar/broker/stats/NamespaceStats.java  |  4 -
 .../broker/stats/metrics/AbstractMetrics.java      | 14 ++--
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |  8 +-
 .../broker/stats/metrics/ManagedLedgerMetrics.java | 72 +++++++++---------
 .../broker/stats/ManagedLedgerMetricsTest.java     | 88 ++++++++++++++++++++++
 5 files changed, 137 insertions(+), 49 deletions(-)

commit 1d5ec83a13b6787996fbcf9f556b89481f5b55b6
Author: hrsakai <hsakai@yahoo-corp.jp>
Date:   Sat Mar 11 03:18:08 2017 +0900

    amend some typographic errors in documents (#286)

 docs/AdminTools.md     | 22 +++++++---------------
 docs/BinaryProtocol.md |  2 +-
 docs/ClusterSetup.md   |  4 ++--
 docs/GeoReplication.md |  2 +-
 docs/WebSocket.md      |  2 +-
 5 files changed, 12 insertions(+), 20 deletions(-)

commit 75d2273e00fffef5929b36024e8e9575401411d0
Author: Andrews <sahaya.andrews@gmail.com>
Date:   Fri Mar 10 08:20:24 2017 -0800

    Rlease ping/pong command buffer (#283)

 .../java/com/yahoo/pulsar/common/api/Commands.java | 29 +++++++++++++++++-----
 1 file changed, 23 insertions(+), 6 deletions(-)

commit 83605f6e45b24636d2a548a7e20459681aada88f
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 9 15:36:46 2017 -0800

    Persist individually deleted messages (#276)
    
    PR from @sschepens  + tests and few fixes from @merlimat

 conf/broker.conf                                   |    9 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |   18 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  242 ++-
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |    2 +-
 .../mledger/impl/MetaStoreImplZookeeper.java       |  265 ++-
 .../bookkeeper/mledger/impl/PositionImpl.java      |    9 +
 .../bookkeeper/mledger/proto/MLDataFormats.java    | 1819 ++++++++++++++++++--
 managed-ledger/src/main/proto/MLDataFormats.proto  |   12 +
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |   90 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |   16 +
 .../yahoo/pulsar/broker/service/BrokerService.java |    1 +
 11 files changed, 2156 insertions(+), 327 deletions(-)

commit fbdbddd13c88f9c43dd18b5e8255639ecc4243a6
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Mar 7 11:35:26 2017 -0800

    fix Intermittent test failure in BrokerServiceThrottlingTest (#280)

 .../broker/service/BrokerServiceThrottlingTest.java  | 20 ++++++++++++++++++--
 1 file changed, 18 insertions(+), 2 deletions(-)

commit ea85d9544622783de1e799af3b3350acd991744e
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Mar 6 16:03:00 2017 -0800

    Updated CPP Travis build script to use cached dependencies. (#278)

 pulsar-client-cpp/travis-build.sh | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

commit 3345d24d528f739d6b85e133da5cd7acef90ed76
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sun Mar 5 21:45:21 2017 -0800

    Add server-side lookup throttling (#181)

 conf/broker.conf                                   |   3 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  11 +
 .../pulsar/broker/lookup/DestinationLookup.java    |  30 ++-
 .../yahoo/pulsar/broker/service/BrokerService.java |  18 +-
 .../broker/service/BrokerServiceException.java     |   2 +-
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |  80 ++++--
 .../lookup/http/HttpDestinationLookupv2Test.java   |  32 +++
 .../service/BrokerServiceThrottlingTest.java       | 287 +++++++++++++++++++++
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |   2 +
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   |   3 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 11 files changed, 431 insertions(+), 38 deletions(-)

commit 92b79d0e2e7b9e7b686dedeaae9725620eb5ec3f
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sun Mar 5 09:55:43 2017 -0800

    Update Broker service configuration dynamically (#186)

 docs/AdminTools.md                                 | 154 +++++++++++++++++++++
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |   1 +
 .../pulsar/common/configuration/FieldContext.java  |   7 +
 .../com/yahoo/pulsar/broker/admin/Brokers.java     | 111 ++++++++++++++-
 .../yahoo/pulsar/broker/service/BrokerService.java | 136 +++++++++++++++++-
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 115 +++++++++++++++
 .../com/yahoo/pulsar/client/admin/Brokers.java     |  28 ++++
 .../pulsar/client/admin/internal/BrokersImpl.java  |  32 +++++
 .../com/yahoo/pulsar/admin/cli/CmdBrokers.java     |  34 +++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   9 ++
 .../com/yahoo/pulsar/common/util/FieldParser.java  |   2 +-
 11 files changed, 623 insertions(+), 6 deletions(-)

commit 85442005858dcc6d99e95243dbde569a2a5be6ba
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Mar 3 16:48:05 2017 -0800

    Fix for Infinite loop in PersistentReplicator.startProducer() (#275)
    
    * Fix for Infinite loop in PersistentReplicator.startProducer()
    
    * Fix for Infinite loop in PersistentReplicator.startProducer()

 .../service/persistent/PersistentReplicator.java   | 11 ++++--
 .../pulsar/broker/service/PersistentTopicTest.java | 46 +++++++++++++++++++++-
 2 files changed, 53 insertions(+), 4 deletions(-)

commit 5c7833897ca255429648b54ce41ec303051ded3e
Author: maurice barnum <msb@yahoo-inc.com>
Date:   Thu Mar 2 15:20:38 2017 -0800

    Close HTTP client connection upon server error or per HTTP spec (#273)
    
    Besides 500, other errors indicate that the server is having problems,
    so close the connection to avoid sending requests to the same bad
    server.  DefaultKeepAliveStrategy will look at the request and response
    headers for other reasons to close, such as "Connection: close" headers.

 .../main/java/com/yahoo/pulsar/client/impl/HttpClient.java    | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 895509daafea55367d5611ecc6de1967c2a9c693
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Mar 2 12:05:34 2017 -0800

    Handle unknown exception on authorization check (#270)
    
    * Handle unknown exception on authorization check
    
    * fix test:init AuthorizationManager on Auth-enable and set status-500 on topic-lookup-internal-failire
    
    * fail partitionMetadata on zk-failure

 .../broker/authorization/AuthorizationManager.java | 15 ++++---
 .../pulsar/broker/admin/PersistentTopics.java      | 15 ++++++-
 .../pulsar/broker/lookup/DestinationLookup.java    | 23 +++++++---
 .../com/yahoo/pulsar/broker/service/Consumer.java  | 11 ++++-
 .../com/yahoo/pulsar/broker/service/Producer.java  | 13 ++++--
 .../yahoo/pulsar/broker/web/PulsarWebResource.java |  9 +---
 .../pulsar/broker/auth/AuthorizationTest.java      |  2 +-
 .../api/AuthenticatedProducerConsumerTest.java     | 51 ++++++++++++++++++++--
 .../pulsar/client/api/BrokerServiceLookupTest.java |  3 ++
 .../websocket/proxy/ProxyAuthorizationTest.java    |  2 +-
 .../discovery/service/BrokerDiscoveryProvider.java |  2 +-
 11 files changed, 112 insertions(+), 34 deletions(-)

commit 9d274a113dce61bc341096ffa01dcb80a624f08f
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Mar 2 12:04:43 2017 -0800

    If there is an error in reading from ZK, DiscoveryService should fail when reading partitions metadata (#272)

 .../discovery/service/BrokerDiscoveryProvider.java | 33 ++++++++---------
 .../discovery/service/DiscoveryServiceTest.java    | 41 ++++++++++++++++++----
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |  8 ++++-
 3 files changed, 57 insertions(+), 25 deletions(-)

commit 5e80344444997d3956e7709aa5c19204fc37a399
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Thu Mar 2 14:27:32 2017 +0900

    Resolve compatibility with previous version (#241)

 pulsar-client-cpp/include/pulsar/Auth.h | 57 ++++++++++++++++++++++++------
 pulsar-client-cpp/lib/Auth.cc           | 61 +++++++++++++++------------------
 pulsar-client-cpp/lib/Client.cc         |  2 +-
 3 files changed, 75 insertions(+), 45 deletions(-)

commit bb0de8eba8a2cb40a162ce838b0b0e2a418cddc3
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Mar 1 21:01:38 2017 -0800

    Added g++-4.4 to travis build (#266)

 pulsar-client-cpp/CMakeLists.txt  | 4 ----
 pulsar-client-cpp/travis-build.sh | 7 +++----
 2 files changed, 3 insertions(+), 8 deletions(-)

commit 17630b9c0386143714a12361d01713f695b4a73c
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Thu Mar 2 00:01:01 2017 -0300

    Fix reset on closed cursors (#231)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 128 ++++++++++++---------
 .../service/persistent/PersistentSubscription.java |  70 ++++++-----
 2 files changed, 116 insertions(+), 82 deletions(-)

commit 522aee81d45eeffb15c99548ccd3611fbabd374e
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Mar 1 18:05:09 2017 -0800

    close http-connection on internal server error from broker (#265)
    
    * close http-connection on internal server error from broker
    
    * broker kills current session on internal-server-error
    
    * add broker-address into response for client-debugging

 .../pulsar/broker/web/ResponseHandlerFilter.java   | 73 ++++++++++++++++++++++
 .../com/yahoo/pulsar/broker/web/WebService.java    |  3 +
 .../api/AuthenticatedProducerConsumerTest.java     | 68 +++++++++++++++-----
 .../com/yahoo/pulsar/client/impl/HttpClient.java   |  7 ++-
 4 files changed, 131 insertions(+), 20 deletions(-)

commit 0286fa89e515ce58118e85e055b9f3886a96c2b3
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 1 15:54:39 2017 -0800

    Fixed circular dependency in slf4j loggers for pulsar-storm unit tests (#264)

 pulsar-storm/pom.xml | 4 ++++
 1 file changed, 4 insertions(+)

commit 619ad64212e0f8eb02455e7c038fdfea42b11b56
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 1 14:09:26 2017 -0800

    Replaced use of System.out.println() in unit tests (#260)

 .../bookkeeper/mledger/impl/ManagedLedgerTest.java    |  3 +--
 .../broker/loadbalance/SimpleLoadManagerImplTest.java | 10 +++++-----
 .../pulsar/broker/namespace/NamespaceServiceTest.java |  6 +++++-
 .../broker/service/PersistentTopicConcurrentTest.java | 19 ++++++++-----------
 .../pulsar/broker/service/PersistentTopicTest.java    |  4 ++--
 .../com/yahoo/pulsar/broker/web/WebServiceTest.java   |  7 +++++--
 .../client/api/PartitionedProducerConsumerTest.java   |  4 ++--
 .../pulsar/client/api/SimpleProducerConsumerTest.java |  4 ++--
 .../client/impl/BrokerClientIntegrationTest.java      |  8 ++++----
 .../pulsar/common/naming/NamespaceBundlesTest.java    |  7 +++++--
 .../stats/client/PulsarBrokerStatsClientTest.java     | 10 ++++++++--
 .../com/yahoo/pulsar/client/impl/BackoffTest.java     |  1 -
 12 files changed, 47 insertions(+), 36 deletions(-)

commit 24c7724c190a0dc3c6a24c6670c1575f85d62757
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Mar 1 14:08:45 2017 -0800

    Fix in ConsumerBase.java to return failed future - #249 (#257)

 .../client/impl/ConsumeBaseExceptionTest.java      | 80 ++++++++++++++++++++++
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |  6 +-
 2 files changed, 83 insertions(+), 3 deletions(-)

commit a715c93411b2aa2abdc83672cd2554c21f11e7ec
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 1 13:52:07 2017 -0800

    Fixed license check mappings and exclusions (#261)

 dashboard/conf/uwsgi.ini          | 16 ++++++++++++++++
 pom.xml                           |  9 ++++++++-
 pulsar-client-cpp/travis-build.sh | 21 +++++++++++----------
 3 files changed, 35 insertions(+), 11 deletions(-)

commit f6d2219319c46afeb92c62036897f4c0042f5c83
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Mar 1 10:58:55 2017 -0800

    Test case for ByteBufCodedOutputStream.writeDouble (#256)

 .../util/protobuf/ByteBufCodedInputStreamTest.java | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

commit c5200ff2fcaa0c577c352cc79e41aa8055103b09
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 1 10:29:37 2017 -0800

    Avoid printing unit test info logs by default for pulsar-storm (#259)

 pulsar-storm/pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit 246a864b749ce4cb634dfea6c18017c9f8f598c2
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Mar 1 07:30:58 2017 -0800

    Introduce Pulsar Dashboard (#188)

 .gitignore                                         |   7 +
 dashboard/Dockerfile                               |  54 ++++
 dashboard/README.md                                |   8 +
 dashboard/conf/nginx-app.conf                      |  34 ++
 dashboard/conf/postgresql.conf                     |  35 +++
 dashboard/conf/supervisor-app.conf                 |  28 ++
 dashboard/conf/uwsgi.ini                           |  26 ++
 dashboard/conf/uwsgi_params                        |  16 +
 dashboard/django/collector.py                      | 342 +++++++++++++++++++++
 dashboard/django/collector.sh                      |  20 ++
 dashboard/django/dashboard/__init__.py             |  16 +
 dashboard/django/dashboard/settings.py             | 178 +++++++++++
 dashboard/django/dashboard/urls.py                 |  42 +++
 dashboard/django/dashboard/wsgi.py                 |  32 ++
 dashboard/django/manage.py                         |  38 +++
 dashboard/django/stats/__init__.py                 |  16 +
 dashboard/django/stats/admin.py                    |  31 ++
 dashboard/django/stats/apps.py                     |  23 ++
 dashboard/django/stats/migrations/0001_initial.py  | 202 ++++++++++++
 dashboard/django/stats/migrations/__init__.py      |  16 +
 dashboard/django/stats/models.py                   | 197 ++++++++++++
 dashboard/django/stats/templates/stats/base.html   |  95 ++++++
 dashboard/django/stats/templates/stats/broker.html |  87 ++++++
 .../django/stats/templates/stats/brokers.html      |  87 ++++++
 .../django/stats/templates/stats/clusters.html     | 103 +++++++
 dashboard/django/stats/templates/stats/home.html   |  71 +++++
 .../django/stats/templates/stats/namespace.html    |  93 ++++++
 .../django/stats/templates/stats/property.html     |  69 +++++
 dashboard/django/stats/templates/stats/topic.html  | 194 ++++++++++++
 dashboard/django/stats/templates/stats/topics.html |  88 ++++++
 dashboard/django/stats/templatetags/__init__.py    |  16 +
 .../django/stats/templatetags/stats_extras.py      |  61 ++++
 dashboard/django/stats/templatetags/table.py       |  88 ++++++
 dashboard/django/stats/tests.py                    |  19 ++
 dashboard/django/stats/urls.py                     |  34 ++
 dashboard/django/stats/views.py                    | 280 +++++++++++++++++
 docs/Dashboard.md                                  |  51 +++
 docs/Documentation.md                              |   1 +
 pom.xml                                            |   3 +
 39 files changed, 2801 insertions(+)

commit 8ec61b2e701d8bfc67ab5b3644ecfceb87adc357
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Feb 28 17:37:52 2017 -0800

    fix Intermittent test failures in ProxyPublishConsumeTest.socketTest (#253)

 .../websocket/proxy/ProxyAuthenticationTest.java    | 17 ++++++++++++++---
 .../websocket/proxy/ProxyPublishConsumeTest.java    | 21 +++++++++++++++++----
 .../websocket/proxy/ProxyPublishConsumeTls.java     | 17 ++++++++++++++---
 .../proxy/ProxyPublishConsumeWithoutZKTest.java     | 18 +++++++++++++++---
 4 files changed, 60 insertions(+), 13 deletions(-)

commit d89563ce54c0f65a78a75d485539be85c0429015
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Feb 27 16:31:06 2017 -0800

    connect dispatcher again on reset cursor complete (#250)
    
    * connect dispatcher again on reset cursor complete
    
    * Renaming methods
    
    * Only disconnect consumers on cursor-reset

 .../yahoo/pulsar/broker/service/Dispatcher.java    |  20 ++-
 .../PersistentDispatcherMultipleConsumers.java     |  33 ++++-
 .../PersistentDispatcherSingleActiveConsumer.java  |  23 +++-
 .../service/persistent/PersistentSubscription.java |   6 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 137 ++++++++++++++++++++-
 5 files changed, 204 insertions(+), 15 deletions(-)

commit ae381b4cb956b60b57e3d45a1a5b5f84ddaaec34
Author: jai1 <jai1@users.noreply.github.com>
Date:   Mon Feb 27 09:52:13 2017 -0800

    Get ConsumerStats using Binary Protocol (#216)

 .gitignore                                         |    3 +
 pom.xml                                            |    1 +
 protobuf/README.md                                 |   49 +-
 .../yahoo/pulsar/broker/service/Dispatcher.java    |    1 -
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   87 +
 pulsar-client-cpp/.gitignore                       |    1 +
 pulsar-client-cpp/include/pulsar/Consumer.h        |   73 +-
 pulsar-client-cpp/include/pulsar/Result.h          |    7 +-
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |    3 +-
 pulsar-client-cpp/lib/Client.cc                    |    4 +-
 pulsar-client-cpp/lib/ClientConnection.cc          |  158 +-
 pulsar-client-cpp/lib/ClientConnection.h           |   14 +-
 pulsar-client-cpp/lib/Commands.cc                  |   17 +
 pulsar-client-cpp/lib/Commands.h                   |    3 +
 pulsar-client-cpp/lib/Consumer.cc                  |   51 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              |   51 +-
 pulsar-client-cpp/lib/ConsumerImpl.h               |    5 +-
 pulsar-client-cpp/lib/ConsumerImplBase.h           |    1 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |    8 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |    1 +
 pulsar-client-cpp/lib/PulsarApi.pb.cc              | 1633 ++++++++++++---
 pulsar-client-cpp/lib/PulsarApi.pb.h               | 1483 +++++++++++++-
 pulsar-client-cpp/tests/ConsumerStatsTest.cc       |  215 ++
 .../java/com/yahoo/pulsar/common/api/Commands.java |   28 +
 .../com/yahoo/pulsar/common/api/PulsarDecoder.java |   23 +-
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 2125 ++++++++++++++++++++
 .../util/protobuf/ByteBufCodedOutputStream.java    |    7 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   63 +-
 28 files changed, 5756 insertions(+), 359 deletions(-)

commit 9fde15b962ad4d7e31606676162cbed4d73c8c87
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Feb 25 19:13:22 2017 -0800

    Fixed compile error in ServerCnxTest after merge (#247)

 .../src/test/java/com/yahoo/pulsar/broker/service/ServerCnxTest.java | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

commit cd2d16e01521cff39d4e425d9841414fce5751bb
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sat Feb 25 17:23:05 2017 -0800

    Message dispatching based on consumer priority-level (#165)

 .../com/yahoo/pulsar/broker/service/Consumer.java  |  12 ++-
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   3 +-
 .../com/yahoo/pulsar/broker/service/Topic.java     |   2 +-
 .../PersistentDispatcherMultipleConsumers.java     | 116 ++++++++++++++++++---
 .../broker/service/persistent/PersistentTopic.java |   4 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |  74 ++++++++++++-
 .../service/PersistentTopicConcurrentTest.java     |   8 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  30 +++---
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  40 +++----
 .../client/api/SimpleProducerConsumerTest.java     |  63 +++++++++++
 .../pulsar/client/api/ConsumerConfiguration.java   |  30 ++++++
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |   7 +-
 .../java/com/yahoo/pulsar/common/api/Commands.java |   3 +-
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   |  57 ++++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 15 files changed, 380 insertions(+), 70 deletions(-)

commit 82f9adb4218374590b662a9cc81713122eeda6e3
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Feb 24 15:57:40 2017 -0800

    On batch-msg dispatching: broker should disconnect consumer which doesn't support batch-message  (#215)
    
    * On batch-msg dispatching: broker should disconnect consumer which doesn't support batch-message
    
    * Close consumer at broker-side without closing connection if consumer doesn't support batch-message
    
    * Fail unsupportedBatchVersion-subscriber if topic has served batch-message

 .../broker/service/BrokerServiceException.java     |   8 ++
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  28 +++++-
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   5 +
 .../yahoo/pulsar/broker/service/Subscription.java  |   2 +
 .../service/persistent/PersistentSubscription.java |   5 +
 .../broker/service/persistent/PersistentTopic.java |  17 ++++
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  40 ++++++++
 .../client/api/SimpleProducerConsumerTest.java     |   2 +-
 .../client/impl/BrokerClientIntegrationTest.java   | 111 +++++++++++++++++++++
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   |   3 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   1 +
 11 files changed, 218 insertions(+), 4 deletions(-)

commit 5dcb4408c8d0a7c8a8d8afc82a0169e66997b0de
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Feb 24 15:50:41 2017 -0800

    Travis Build - install xmllint and enforce backward compatibility with gcc4.4 (#242)

 pulsar-client-cpp/CMakeLists.txt  | 4 ++++
 pulsar-client-cpp/travis-build.sh | 3 ++-
 2 files changed, 6 insertions(+), 1 deletion(-)

commit a54a1bf76f619529ffeb978030777fc15c76cd6d
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Feb 24 14:56:01 2017 -0800

    Corrected test case ProxyAuthentication, ProxyPublishConsumeTls and ProxyPublishConsumeWithoutZK (#245)

 .../pulsar/websocket/proxy/ProxyAuthenticationTest.java      |  2 +-
 .../yahoo/pulsar/websocket/proxy/ProxyPublishConsumeTls.java | 12 +++++++-----
 .../websocket/proxy/ProxyPublishConsumeWithoutZKTest.java    |  7 ++++---
 3 files changed, 12 insertions(+), 9 deletions(-)

commit 99cf1dc4967aafc282a713cefaaf1bfa24e92d4a
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Feb 24 14:19:43 2017 -0800

    Avoid triggering startReplProducer on newAddProducer as it may flips replicator state wrongly (#232)
    
    * Avoid triggering startReplProducer on newAddProducer as it may flips replicator state wrongly
    
    * Signal replicator is stopping if porducer is not created yet
    
    * read repl-cluster from policies to avoid restart of closing-replicator

 .../service/persistent/PersistentReplicator.java   |  4 +-
 .../broker/service/persistent/PersistentTopic.java | 22 ++++++-
 .../pulsar/broker/service/PersistentTopicTest.java | 67 ++++++++++++++++++++++
 3 files changed, 89 insertions(+), 4 deletions(-)

commit 96f824b136b315440d30a34daae4d33c8ab79bab
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Feb 24 14:14:09 2017 -0800

    Replicator stop retrying to read when cursor is already closed (#239)

 .../bookkeeper/mledger/ManagedLedgerException.java |  6 ++
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  8 ++-
 .../service/persistent/PersistentReplicator.java   | 13 ++++-
 .../pulsar/broker/service/ReplicatorTest.java      | 64 ++++++++++++++++++++++
 4 files changed, 86 insertions(+), 5 deletions(-)

commit e1c3d4b5f5eb5d164672980da6c89bb498d75cf3
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Feb 24 13:02:49 2017 -0800

    Corrected test case ProxyPublishConsumeTest (#243)

 .../com/yahoo/pulsar/websocket/proxy/ProxyPublishConsumeTest.java | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

commit 318617529f35f2b587eb2078b226932bdb45fe30
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Sat Feb 25 03:28:41 2017 +0900

    Add TLS authentication end to end tests (#224)
    
    * Make C++ tls auth api same as Java
    
    * Add tls auth test for Java client
    
    * Add tls auth test for C++ client

 .../api/AuthenticatedProducerConsumerTest.java     | 156 ++++++++++++
 .../resources/authentication/tls/broker-cert.pem   |  72 ++++++
 .../resources/authentication/tls/broker-key.pem    |  28 +++
 .../test/resources/authentication/tls/cacert.pem   |  62 +++++
 .../resources/authentication/tls/client-cert.pem   |  72 ++++++
 .../resources/authentication/tls/client-key.pem    |  28 +++
 pulsar-client-cpp/lib/auth/AuthTls.cc              |  26 +-
 pulsar-client-cpp/tests/AuthPluginTest.cc          |  84 +++++++
 pulsar-client-cpp/tests/authentication.conf        | 262 +++++++++++++++++++++
 pulsar-client-cpp/tests/client.conf                |  24 ++
 pulsar-client-cpp/travis-build.sh                  |  17 +-
 11 files changed, 812 insertions(+), 19 deletions(-)

commit 8c8b72c73c8169b8f8e06a83173d61fdf80e853f
Author: jai1 <jai1@users.noreply.github.com>
Date:   Thu Feb 23 08:26:38 2017 -0800

    Set minimum level to DEBUG in log4j.properties

 conf/log4j.properties       | 4 ++--
 conf/log4j.shell.properties | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 1a7b950282e7bdc7932607319154ffbceb8959e5
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 23 08:16:55 2017 -0800

    Include timezone in datetime printed in stats (#233)

 .../src/main/java/com/yahoo/pulsar/broker/admin/PersistentTopics.java   | 2 +-
 .../com/yahoo/pulsar/broker/service/persistent/PersistentTopic.java     | 2 +-
 .../src/main/java/com/yahoo/pulsar/client/impl/ProducerImpl.java        | 2 +-
 .../src/main/java/com/yahoo/pulsar/websocket/ConsumerHandler.java       | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

commit e2df954dfeba01262098b0a5823bfd36138f678f
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Feb 23 08:16:34 2017 -0800

    Remove partition-topic redirection as broker sends partition-metadata without redirection (#235)

 pulsar-client-cpp/lib/BinaryProtoLookupService.cc | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)

commit 16917784d433c16d6103febced5955cefea6cca9
Merge: 4ac21b4c28 9f17905428
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Feb 22 09:41:33 2017 -0800

    Merge pull request #218 from jai1/TLSV1
    
    Using TLSv1 since boost1_41 supports TLS v1.0

commit 4ac21b4c285619d2d06d7f65c9f2332d261f3619
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Feb 21 11:55:39 2017 -0800

    Add lookup throttling (#225)

 pulsar-client-cpp/include/pulsar/Client.h         | 14 ++++++++++++++
 pulsar-client-cpp/include/pulsar/Result.h         |  1 +
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc |  6 +++---
 pulsar-client-cpp/lib/Client.cc                   | 11 +++++++++++
 pulsar-client-cpp/lib/ClientConnection.cc         | 14 +++++++++++++-
 pulsar-client-cpp/lib/ClientConnection.h          |  3 +++
 pulsar-client-cpp/tests/BasicEndToEndTest.cc      | 15 +++++++++++++++
 7 files changed, 60 insertions(+), 4 deletions(-)

commit d62cf072537ec2b4075a99506bc7d6b741b09235
Author: jai1 <jai1@users.noreply.github.com>
Date:   Sat Feb 18 07:34:54 2017 -0800

    Partitioned topics fix (#226)

 pulsar-client-cpp/tests/BasicEndToEndTest.cc | 65 ++++++++++++----------------
 pulsar-client-cpp/tests/BatchMessageTest.cc  | 10 ++---
 pulsar-client-cpp/tests/HttpHelper.cc        | 41 ++++++++++--------
 3 files changed, 56 insertions(+), 60 deletions(-)

commit b6f061a7d42324f35f0247aa49bfb62b27607cf9
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Feb 17 21:06:49 2017 -0800

    Derive direct memory used count from netty counter (#223)
    
    * Derive direct memory used count from netty counter
    
    * Fix: avoid initial direct-memory assertion with 0

 .../pulsar/broker/stats/metrics/JvmMetrics.java    | 32 +++++++++++++++++++--
 .../stats/BookieClientsStatsGeneratorTest.java     | 33 ++++++++++++++++++++++
 2 files changed, 62 insertions(+), 3 deletions(-)

commit 321d583a8fe0e2e1a5c9420540af180ef3fc631a
Author: jai1 <jai1@users.noreply.github.com>
Date:   Fri Feb 17 16:28:42 2017 -0800

    Fixed the C++ build to work in mac (#219)

 pulsar-client-cpp/.gitignore         |  3 +-
 pulsar-client-cpp/CMakeLists.txt     |  3 ++
 pulsar-client-cpp/README.md          | 90 ++++++++++++++++++++++++++++++------
 pulsar-client-cpp/lib/CMakeLists.txt |  3 +-
 4 files changed, 82 insertions(+), 17 deletions(-)

commit 6fd212affde8a4621ecda82889ace96060187493
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Fri Feb 17 15:55:28 2017 -0800

    Fix #199: Do not stop to replicate when producer throws exception (#220)
    
    * Fix #199: Do not stop to replicate when producer throws exception
    
    * Fix log messages
    
    * testReplicatorProducerClosing shoud be executed at last since it closes pulsar2/pulsar3
    
    * Add unit test for replication resumption on backlog exceeded

 .../service/persistent/PersistentReplicator.java   | 16 ++---
 .../pulsar/broker/service/ReplicatorTest.java      | 82 ++++++++++++++++++++--
 .../pulsar/broker/service/ReplicatorTestBase.java  |  4 ++
 3 files changed, 88 insertions(+), 14 deletions(-)

commit 7284ae8166c2b694678900bef6de062b328fd26f
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Feb 17 14:59:05 2017 -0800

    Fixed race condition on client reconnection logic (#221)

 .../yahoo/pulsar/client/api/ClientErrorsTest.java  |  9 +++--
 .../yahoo/pulsar/client/impl/ConnectionPool.java   | 15 +++++++-
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java | 43 ++++++++++++----------
 3 files changed, 42 insertions(+), 25 deletions(-)

commit 9f179054282d13b91e0280d14fb9dfcdb6e363d5
Author: Jai ASher <jai1@yahoo-inc.com>
Date:   Fri Feb 17 13:13:40 2017 -0800

    Added the macro to determine tls version

 pulsar-client-cpp/lib/ClientConnection.cc | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

commit fdef79eb7810526a93ba543de4ea2124d03cd0ab
Author: jai1 <jai1@yahoo-inc.com>
Date:   Thu Feb 16 20:48:41 2017 +0000

    Using TLSv1 since boost1_41 supports TLS v1.0

 pulsar-client-cpp/include/pulsar/Auth.h   |  4 ++--
 pulsar-client-cpp/lib/Auth.cc             |  6 +++---
 pulsar-client-cpp/lib/ClientConnection.cc | 11 +++++------
 pulsar-client-cpp/lib/ExecutorService.h   |  3 +--
 4 files changed, 11 insertions(+), 13 deletions(-)

commit 88e75fe5fc39a202acdfa45e3b0974dff8af1022
Author: Yuki Shiga <yushiga@yahoo-corp.jp>
Date:   Wed Feb 15 15:41:54 2017 -0800

    Add tls authentication plugin for cpp client (#200)
    
    * Added authentication plugin for C++ client
    
    * Enabled performance tools for C++ client to use authentication pugin

 pulsar-client-cpp/include/pulsar/Auth.h      |  45 +++++--
 pulsar-client-cpp/include/pulsar/Client.h    |   9 ++
 pulsar-client-cpp/lib/Auth.cc                | 187 ++++++++++++++++++---------
 pulsar-client-cpp/lib/Client.cc              |  30 +++++
 pulsar-client-cpp/lib/ClientConnection.cc    | 147 +++++++++++++++------
 pulsar-client-cpp/lib/ClientConnection.h     |  25 ++++
 pulsar-client-cpp/lib/Commands.cc            |   6 +-
 pulsar-client-cpp/lib/ExecutorService.cc     |   4 +
 pulsar-client-cpp/lib/ExecutorService.h      |   3 +
 pulsar-client-cpp/lib/auth/AuthTls.cc        |  53 +++++++-
 pulsar-client-cpp/lib/auth/AuthTls.h         |  50 +++----
 pulsar-client-cpp/perf/PerfConsumer.cc       |  28 ++++
 pulsar-client-cpp/perf/PerfProducer.cc       |  27 ++++
 pulsar-client-cpp/tests/AuthPluginTest.cc    |   9 +-
 pulsar-client-cpp/tests/BasicEndToEndTest.cc |   4 +-
 15 files changed, 478 insertions(+), 149 deletions(-)

commit b1dd7f9fbedae86213648afb37cbc8ac7d69235d
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 15 12:55:00 2017 -0800

    Fixed Discovery Service initialization of global zk cache (#203)

 conf/discovery.conf                                |  5 ++-
 .../discovery/service/BrokerDiscoveryProvider.java | 38 +++++++++++++++-------
 .../pulsar/discovery/service/DiscoveryService.java |  9 ++---
 .../discovery/service/server/ServiceConfig.java    | 24 ++++++++++----
 .../service/web/DiscoveryServiceServlet.java       |  7 +++-
 .../service/web/ZookeeperCacheLoader.java          |  7 ++--
 .../service/web/DiscoveryServiceWebTest.java       |  2 +-
 .../service/web/ZookeeperCacheLoaderTest.java      |  2 +-
 8 files changed, 64 insertions(+), 30 deletions(-)

commit c89000595c49d367c178625df83f7ecfbcf1cbef
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 15 12:54:42 2017 -0800

    Directory service should use HTTP temporary redirect (307) (#204)

 .../service/web/DiscoveryServiceWebTest.java       | 26 ++++++++++++----------
 .../service/web/DiscoveryServiceServlet.java       |  4 +++-
 2 files changed, 17 insertions(+), 13 deletions(-)

commit 5c82997c97c3515dc3b689f7b395ba533846c34d
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Feb 15 12:23:51 2017 -0800

    Issue #206: Fixed flaky web socket proxy test (#214)

 .../pulsar/websocket/proxy/ProxyPublishConsumeTest.java      | 12 ++++++------
 .../websocket/proxy/ProxyPublishConsumeWithoutZKTest.java    |  9 ++++-----
 .../yahoo/pulsar/websocket/proxy/SimpleConsumerSocket.java   |  7 +++++++
 3 files changed, 17 insertions(+), 11 deletions(-)

commit 369e084d1a43dc80dbe07d3443ac35319466ee3b
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Feb 14 18:23:05 2017 -0800

    Update README to set correct config path to start pulsar-standalone (#213)

 pulsar-client-cpp/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit d13bc682e771b538670e0a64e1367581505386f9
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 14 13:03:42 2017 -0800

    Fix #206 - Intermittent test failure in ProxyPublishConsumeTest (#211)

 .../java/com/yahoo/pulsar/websocket/proxy/SimpleConsumerSocket.java | 6 +++---
 .../java/com/yahoo/pulsar/websocket/proxy/SimpleProducerSocket.java | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

commit ccde9085a7e9011cf977898ba065a27dc032b9a2
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Feb 14 09:44:14 2017 -0800

    Prefer ipv4 in client connections (#209)

 bin/pulsar        | 2 +-
 bin/pulsar-admin  | 1 +
 bin/pulsar-client | 1 +
 bin/pulsar-perf   | 2 +-
 4 files changed, 4 insertions(+), 2 deletions(-)

commit 27cc96fdca4fe5c0e7ec643885ce93167b7966e1
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Feb 13 21:57:48 2017 -0800

    Intermittent test failure on DiscoveryServiceTest (#210)

 .../yahoo/pulsar/discovery/service/DiscoveryServiceTest.java   | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

commit 60ec362e969c1cb8ae7e874a0d338fd7be5b3c1d
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Feb 13 12:24:46 2017 -0800

    Ignore already existing required z-nodes in global zk (#202)

 .../yahoo/pulsar/PulsarClusterMetadataSetup.java   | 34 ++++++++++++++++------
 1 file changed, 25 insertions(+), 9 deletions(-)

commit fc9b34cb4612cdada0dbccc5a9fa16544486de9f
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Thu Feb 9 22:49:22 2017 -0300

    Replace usages of Atomic* for Atomic*FieldUpdater (#195)
    
    Replaced some usages of AtomicInteger, AtomicLong and AtomicReference
    for their Atomic*FieldUpdater counterpart on classes which get
    instantiated a lot, this should reduce memory usage for the broker
    and clients which use lots of topics and consumers.

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 114 ++++++++++++---------
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  93 +++++++++--------
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |   6 +-
 .../yahoo/pulsar/broker/namespace/OwnedBundle.java |  19 ++--
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  48 +++++----
 .../PersistentDispatcherSingleActiveConsumer.java  |  31 +++---
 .../service/persistent/PersistentReplicator.java   |  65 ++++++------
 .../service/persistent/PersistentSubscription.java |  33 +++---
 .../broker/service/persistent/PersistentTopic.java |  31 +++---
 .../client/impl/BrokerClientIntegrationTest.java   |  90 ++++++++++------
 .../yahoo/pulsar/client/impl/MessageIdTest.java    |  46 ++++++---
 .../java/org/testng/listener/TestListener.java     |   2 +-
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |   6 +-
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  56 +++++-----
 .../com/yahoo/pulsar/client/impl/HandlerBase.java  |  56 ++++++----
 .../client/impl/PartitionedConsumerImpl.java       |  24 ++---
 .../client/impl/PartitionedProducerImpl.java       |  14 +--
 .../com/yahoo/pulsar/client/impl/ProducerBase.java |   1 -
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java |  30 +++---
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |   2 +-
 .../impl/RoundRobinPartitionMessageRouterImpl.java |   9 +-
 .../collections/GrowableArrayBlockingQueue.java    |  37 ++++---
 22 files changed, 466 insertions(+), 347 deletions(-)

commit 68338c7aed86f4021553a2be5325377e6cafcbcd
Author: jai1 <jai1@users.noreply.github.com>
Date:   Wed Feb 8 18:20:54 2017 -0800

    Getting the code to run with old boost asio (#197)

 pulsar-client-cpp/lib/ClientConnection.cc | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit d4610109ecedfdebcb60ef9852166b4ea814abda
Author: nkurihar <nkurihar6012@gmail.com>
Date:   Thu Feb 9 03:26:53 2017 +0900

    Add Athenz authentication plugin (#178)

 conf/broker.conf                                   |   2 +
 conf/standalone.conf                               |   2 +
 pom.xml                                            |  23 ++++
 pulsar-broker-auth-athenz/pom.xml                  |  47 +++++++++
 .../AuthenticationProviderAthenz.java              | 116 +++++++++++++++++++++
 pulsar-client-auth-athenz/pom.xml                  |  47 +++++++++
 .../client/impl/auth/AuthenticationAthenz.java     | 107 +++++++++++++++++++
 .../client/impl/auth/AuthenticationDataAthenz.java |  59 +++++++++++
 8 files changed, 403 insertions(+)

commit d278601a851a18c4424bcec2da9d674b9ea3465a
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Feb 7 18:09:07 2017 -0800

    Add binary-protocol lookup url in documentation (#129)
    
    * Add binary-protocol lookup url in documentation
    
    * add webServiceUrl and brokerServiceUrl to clientTools
    
    * Fallback to old version serviceUrl property for clientTools

 conf/client.conf                                     |  3 ++-
 docs/Architecture.md                                 |  4 ++--
 docs/Authentication.md                               |  2 +-
 docs/ClusterSetup.md                                 |  9 +++++----
 docs/GettingStarted.md                               |  6 +++---
 docs/PulsarStorm.md                                  |  4 ++--
 .../com/yahoo/pulsar/PulsarClusterMetadataSetup.java | 20 ++++++++++++++------
 .../com/yahoo/pulsar/admin/cli/PulsarAdminTool.java  |  6 +++++-
 .../yahoo/pulsar/client/cli/PulsarClientTool.java    |  8 +++++++-
 .../yahoo/pulsar/testclient/PerformanceConsumer.java |  9 +++++++++
 .../yahoo/pulsar/testclient/PerformanceProducer.java |  9 +++++++++
 11 files changed, 59 insertions(+), 21 deletions(-)

commit 9833b1954f5571cc9e946b0779c2d3a53395c13f
Author: saandrews <sahaya.andrews@gmail.com>
Date:   Tue Feb 7 13:59:26 2017 -0800

    Excluded travis-build.sh from license check (#193)

 pom.xml | 1 +
 1 file changed, 1 insertion(+)

commit 77f1ce88eecd6ed738153ced255c5f06f7b4ff2c
Author: saandrews <sahaya.andrews@gmail.com>
Date:   Tue Feb 7 12:37:51 2017 -0800

    Added pulsar C++ client (#185)

 .travis.yml                                        |   11 +-
 pom.xml                                            |    5 +
 pulsar-client-cpp/.gitignore                       |   58 +
 pulsar-client-cpp/CMakeLists.txt                   |   65 +
 pulsar-client-cpp/NOTICE                           |   33 +
 pulsar-client-cpp/README.md                        |   66 +
 pulsar-client-cpp/eclipse-formatter.xml            |  186 +
 pulsar-client-cpp/examples/CMakeLists.txt          |   41 +
 pulsar-client-cpp/examples/SampleAsyncProducer.cc  |   50 +
 pulsar-client-cpp/examples/SampleConsumer.cc       |   46 +
 .../examples/SampleConsumerListener.cc             |   48 +
 pulsar-client-cpp/examples/SampleProducer.cc       |   43 +
 pulsar-client-cpp/generate_protobuf.sh             |   19 +
 pulsar-client-cpp/include/pulsar/Auth.h            |   57 +
 pulsar-client-cpp/include/pulsar/BatchMessageId.h  |   56 +
 pulsar-client-cpp/include/pulsar/Client.h          |  202 +
 pulsar-client-cpp/include/pulsar/Consumer.h        |  303 +
 pulsar-client-cpp/include/pulsar/Message.h         |  143 +
 pulsar-client-cpp/include/pulsar/MessageBuilder.h  |  105 +
 pulsar-client-cpp/include/pulsar/MessageId.h       |   64 +
 .../include/pulsar/MessageRoutingPolicy.h          |   42 +
 pulsar-client-cpp/include/pulsar/Producer.h        |  175 +
 pulsar-client-cpp/include/pulsar/Result.h          |   78 +
 pulsar-client-cpp/lib/Auth.cc                      |  106 +
 pulsar-client-cpp/lib/Backoff.cc                   |   38 +
 pulsar-client-cpp/lib/Backoff.h                    |   41 +
 .../lib/BatchAcknowledgementTracker.cc             |  154 +
 .../lib/BatchAcknowledgementTracker.h              |  105 +
 pulsar-client-cpp/lib/BatchMessageContainer.cc     |  145 +
 pulsar-client-cpp/lib/BatchMessageContainer.h      |  140 +
 pulsar-client-cpp/lib/BinaryProtoLookupService.cc  |  146 +
 pulsar-client-cpp/lib/BinaryProtoLookupService.h   |   78 +
 pulsar-client-cpp/lib/BlockingQueue.h              |  330 +
 pulsar-client-cpp/lib/CMakeLists.txt               |   31 +
 pulsar-client-cpp/lib/Client.cc                    |  190 +
 pulsar-client-cpp/lib/ClientConnection.cc          | 1001 +++
 pulsar-client-cpp/lib/ClientConnection.h           |  252 +
 pulsar-client-cpp/lib/ClientImpl.cc                |  358 +
 pulsar-client-cpp/lib/ClientImpl.h                 |  131 +
 pulsar-client-cpp/lib/Commands.cc                  |  401 +
 pulsar-client-cpp/lib/Commands.h                   |  103 +
 pulsar-client-cpp/lib/CompressionCodec.cc          |   73 +
 pulsar-client-cpp/lib/CompressionCodec.h           |   89 +
 pulsar-client-cpp/lib/CompressionCodecLZ4.cc       |   52 +
 pulsar-client-cpp/lib/CompressionCodecLZ4.h        |   32 +
 pulsar-client-cpp/lib/CompressionCodecZLib.cc      |   62 +
 pulsar-client-cpp/lib/CompressionCodecZLib.h       |   35 +
 pulsar-client-cpp/lib/ConnectionPool.cc            |   73 +
 pulsar-client-cpp/lib/ConnectionPool.h             |   53 +
 pulsar-client-cpp/lib/Consumer.cc                  |  262 +
 pulsar-client-cpp/lib/ConsumerImpl.cc              |  689 ++
 pulsar-client-cpp/lib/ConsumerImpl.h               |  141 +
 pulsar-client-cpp/lib/ConsumerImplBase.h           |   52 +
 pulsar-client-cpp/lib/DestinationName.cc           |  187 +
 pulsar-client-cpp/lib/DestinationName.h            |   74 +
 pulsar-client-cpp/lib/ExecutorService.cc           |   95 +
 pulsar-client-cpp/lib/ExecutorService.h            |   95 +
 pulsar-client-cpp/lib/Future.h                     |  165 +
 pulsar-client-cpp/lib/HandlerBase.cc               |  161 +
 pulsar-client-cpp/lib/HandlerBase.h                |  118 +
 pulsar-client-cpp/lib/Latch.cc                     |   68 +
 pulsar-client-cpp/lib/Latch.h                      |   55 +
 pulsar-client-cpp/lib/LogUtils.cc                  |   51 +
 pulsar-client-cpp/lib/LogUtils.h                   |   70 +
 pulsar-client-cpp/lib/LookupDataResult.h           |   76 +
 pulsar-client-cpp/lib/Message.cc                   |  157 +
 pulsar-client-cpp/lib/MessageBuilder.cc            |  114 +
 pulsar-client-cpp/lib/MessageId.cc                 |   52 +
 pulsar-client-cpp/lib/MessageImpl.cc               |   54 +
 pulsar-client-cpp/lib/MessageImpl.h                |   55 +
 pulsar-client-cpp/lib/NamedEntity.cc               |   23 +
 pulsar-client-cpp/lib/NamedEntity.h                |   28 +
 pulsar-client-cpp/lib/NamespaceName.cc             |   80 +
 pulsar-client-cpp/lib/NamespaceName.h              |   52 +
 pulsar-client-cpp/lib/ObjectPool.h                 |  243 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.cc   |  383 +
 pulsar-client-cpp/lib/PartitionedConsumerImpl.h    |  100 +
 pulsar-client-cpp/lib/PartitionedProducerImpl.cc   |  214 +
 pulsar-client-cpp/lib/PartitionedProducerImpl.h    |  111 +
 pulsar-client-cpp/lib/Producer.cc                  |  208 +
 pulsar-client-cpp/lib/ProducerImpl.cc              |  570 ++
 pulsar-client-cpp/lib/ProducerImpl.h               |  149 +
 pulsar-client-cpp/lib/ProducerImplBase.h           |   42 +
 pulsar-client-cpp/lib/PulsarApi.pb.cc              | 9223 ++++++++++++++++++++
 pulsar-client-cpp/lib/PulsarApi.pb.h               | 8437 ++++++++++++++++++
 pulsar-client-cpp/lib/Result.cc                    |   99 +
 pulsar-client-cpp/lib/RoundRobinMessageRouter.cc   |   40 +
 pulsar-client-cpp/lib/RoundRobinMessageRouter.h    |   38 +
 pulsar-client-cpp/lib/ServiceUnitId.h              |   29 +
 pulsar-client-cpp/lib/SharedBuffer.h               |  282 +
 .../lib/SinglePartitionMessageRouter.cc            |   38 +
 .../lib/SinglePartitionMessageRouter.h             |   37 +
 .../lib/UnAckedMessageTrackerDisabled.h            |   35 +
 .../lib/UnAckedMessageTrackerEnabled.cc            |  108 +
 .../lib/UnAckedMessageTrackerEnabled.h             |   45 +
 .../lib/UnAckedMessageTrackerInterface.h           |   50 +
 pulsar-client-cpp/lib/UnboundedBlockingQueue.h     |  147 +
 pulsar-client-cpp/lib/Url.cc                       |   84 +
 pulsar-client-cpp/lib/Url.h                        |   47 +
 pulsar-client-cpp/lib/UtilAllocator.h              |   83 +
 pulsar-client-cpp/lib/Utils.h                      |   70 +
 pulsar-client-cpp/lib/Version.h                    |   24 +
 pulsar-client-cpp/lib/auth/AuthTls.cc              |   25 +
 pulsar-client-cpp/lib/auth/AuthTls.h               |   49 +
 pulsar-client-cpp/lib/auth/CMakeLists.txt          |    3 +
 pulsar-client-cpp/lib/checksum/ChecksumProvider.cc |   60 +
 pulsar-client-cpp/lib/checksum/ChecksumProvider.h  |   34 +
 pulsar-client-cpp/lib/checksum/crc32c_sse42.cc     |  232 +
 pulsar-client-cpp/lib/checksum/crc32c_sse42.h      |   46 +
 pulsar-client-cpp/lib/checksum/crc32c_sw.cc        |  102 +
 pulsar-client-cpp/lib/checksum/crc32c_sw.h         |    8 +
 pulsar-client-cpp/lib/checksum/gf2.hpp             |  199 +
 pulsar-client-cpp/lib/checksum/int_types.h         |   43 +
 pulsar-client-cpp/lib/lz4/lz4.c                    | 1516 ++++
 pulsar-client-cpp/lib/lz4/lz4.h                    |  360 +
 pulsar-client-cpp/log4cxx.conf                     |   29 +
 pulsar-client-cpp/perf/CMakeLists.txt              |   33 +
 pulsar-client-cpp/perf/PerfConsumer.cc             |  280 +
 pulsar-client-cpp/perf/PerfProducer.cc             |  315 +
 pulsar-client-cpp/perf/RateLimiter.h               |   91 +
 pulsar-client-cpp/tests/AuthPluginTest.cc          |   40 +
 pulsar-client-cpp/tests/BackoffTest.cc             |   37 +
 pulsar-client-cpp/tests/BasicEndToEndTest.cc       |  814 ++
 pulsar-client-cpp/tests/BatchMessageTest.cc        |  840 ++
 pulsar-client-cpp/tests/BinaryLookupServiceTest.cc |   55 +
 pulsar-client-cpp/tests/BlockingQueueTest.cc       |  232 +
 pulsar-client-cpp/tests/CMakeLists.txt             |   25 +
 pulsar-client-cpp/tests/ClientTest.cc              |   77 +
 pulsar-client-cpp/tests/ConsumerTest.cc            |   95 +
 pulsar-client-cpp/tests/ConsumerTest.h             |   29 +
 pulsar-client-cpp/tests/CustomRoutingPolicy.h      |   30 +
 pulsar-client-cpp/tests/DestinationNameTest.cc     |  115 +
 pulsar-client-cpp/tests/HttpHelper.cc              |   38 +
 pulsar-client-cpp/tests/HttpHelper.h               |   25 +
 pulsar-client-cpp/tests/LatchTest.cc               |   89 +
 pulsar-client-cpp/tests/LoggerTest.cc              |   26 +
 pulsar-client-cpp/tests/MessageTest.cc             |   79 +
 pulsar-client-cpp/tests/NamespaceNameTest.cc       |   29 +
 pulsar-client-cpp/tests/ProducerTest.cc            |   48 +
 pulsar-client-cpp/tests/PulsarFriend.h             |   29 +
 pulsar-client-cpp/tests/UrlTest.cc                 |   60 +
 pulsar-client-cpp/tests/main.cc                    |   24 +
 pulsar-client-cpp/tests/standalone.conf            |  254 +
 pulsar-client-cpp/travis-build.sh                  |   70 +
 pulsar-client-cpp/wireshark/moduleinfo.h           |   32 +
 pulsar-client-cpp/wireshark/pulsarDissector.cc     |  958 ++
 146 files changed, 37598 insertions(+), 2 deletions(-)

commit 295577cbc38b6763cd32e81ec6a937001c580061
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Feb 6 18:52:39 2017 -0800

    Add client-side lookup throttling (#182)

 .../pulsar/broker/service/BrokerServiceTest.java   | 28 ++++++++++++-
 .../pulsar/client/api/ClientConfiguration.java     | 21 ++++++++++
 .../pulsar/client/api/PulsarClientException.java   |  6 +++
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    | 47 +++++++++++++++++-----
 4 files changed, 91 insertions(+), 11 deletions(-)

commit 9f429361bbb6f0c5014c65a7bd1206229d882681
Author: rdhabalia <rdhabalia@yahoo-inc.com>
Date:   Thu Feb 2 15:02:11 2017 -0800

    Bump version to 1.17-SNAPSHOT

 all/pom.xml                      | 2 +-
 managed-ledger/pom.xml           | 2 +-
 pom.xml                          | 2 +-
 pulsar-broker-common/pom.xml     | 2 +-
 pulsar-broker/pom.xml            | 2 +-
 pulsar-checksum/pom.xml          | 2 +-
 pulsar-client-admin/pom.xml      | 2 +-
 pulsar-client-tools/pom.xml      | 2 +-
 pulsar-client/pom.xml            | 2 +-
 pulsar-common/pom.xml            | 2 +-
 pulsar-discovery-service/pom.xml | 2 +-
 pulsar-storm/pom.xml             | 2 +-
 pulsar-testclient/pom.xml        | 2 +-
 pulsar-websocket/pom.xml         | 2 +-
 pulsar-zookeeper-utils/pom.xml   | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit c70601ebf25ea75bd189ef93f152ca0189e6081f
Author: rdhabalia <rdhabalia@yahoo-inc.com>
Date:   Thu Feb 2 14:38:37 2017 -0800

    Pulsar release v1.16

 all/pom.xml                      | 2 +-
 managed-ledger/pom.xml           | 2 +-
 pom.xml                          | 2 +-
 pulsar-broker-common/pom.xml     | 2 +-
 pulsar-broker/pom.xml            | 2 +-
 pulsar-checksum/pom.xml          | 2 +-
 pulsar-client-admin/pom.xml      | 2 +-
 pulsar-client-tools/pom.xml      | 2 +-
 pulsar-client/pom.xml            | 2 +-
 pulsar-common/pom.xml            | 2 +-
 pulsar-discovery-service/pom.xml | 2 +-
 pulsar-storm/pom.xml             | 2 +-
 pulsar-testclient/pom.xml        | 2 +-
 pulsar-websocket/pom.xml         | 2 +-
 pulsar-zookeeper-utils/pom.xml   | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit 39164cee3044d6da088f852587b9b855ba464291
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Feb 2 14:34:27 2017 -0800

    Support custom advertised address in pulsar standalone (#187)

 .../com/yahoo/pulsar/PulsarStandaloneStarter.java  | 28 +++++++++++++++++++---
 1 file changed, 25 insertions(+), 3 deletions(-)

commit 99f7e21f4da8468b1e59a4984da67128c295ade5
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Jan 31 15:16:50 2017 -0800

    Configure split-bundle task interval different than loadReportGenerationTask-interval (#183)

 conf/broker.conf                                   |  3 --
 conf/standalone.conf                               |  3 --
 .../yahoo/pulsar/broker/ServiceConfiguration.java  | 10 ------
 .../com/yahoo/pulsar/broker/PulsarService.java     |  9 -----
 .../loadbalance/NamespaceBundleSplitTask.java      | 42 ----------------------
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  2 ++
 .../loadbalance/SimpleLoadManagerImplTest.java     |  4 ---
 7 files changed, 2 insertions(+), 71 deletions(-)

commit de2a61107f9160d3342270cb3bbe93468a0092ff
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Jan 30 14:37:50 2017 -0800

    Return correct error code on create-producer/consumer is not complete yet (#177)

 .../com/yahoo/pulsar/broker/service/ServerCnx.java | 19 ++++++++-
 .../yahoo/pulsar/broker/service/ServerCnxTest.java | 45 ++++++++++++++++++++++
 2 files changed, 62 insertions(+), 2 deletions(-)

commit 7f92ae611aed2e250aacbdd12f1206b7955793f5
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Mon Jan 30 14:59:39 2017 -0300

    fix file descriptor leak on LinuxBrokerHostUsageImpl (#179)

 .../pulsar/broker/loadbalance/impl/LinuxBrokerHostUsageImpl.java | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

commit 69a68b179b068e0c8bde83ebb9b50d017c6a0a7a
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Mon Jan 23 17:05:54 2017 -0300

    Support online consumer cursor reset (#139)

 .../PersistentDispatcherSingleActiveConsumer.java  |   2 +-
 .../service/persistent/PersistentSubscription.java | 131 ++++++++++-----------
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |  38 ------
 3 files changed, 62 insertions(+), 109 deletions(-)

commit 616d84f482dd9617958e363b45cacac433a03367
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sat Jan 21 11:51:10 2017 -0800

    Generalize PulsarConfigurationLoader (#168)
    
    * Generalize PulsarConfigurationLoader
    
    * fix: PulsarConfigurationLoader Test

 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  4 +-
 .../configuration}/FieldContext.java               |  2 +-
 .../common/configuration/PulsarConfiguration.java  | 25 +++++++++
 .../configuration/PulsarConfigurationLoader.java}  | 32 +++++++-----
 .../PulsarConfigurationLoaderTest.java             | 61 +++++++++++++++++-----
 .../java/com/yahoo/pulsar/PulsarBrokerStarter.java |  6 +--
 .../com/yahoo/pulsar/PulsarStandaloneStarter.java  |  6 +--
 .../broker/service/BacklogQuotaManagerTest.java    |  4 +-
 .../pulsar/broker/service/ReplicatorTestBase.java  |  8 ++-
 .../common/naming/ServiceConfigurationTest.java    |  6 +--
 .../service/server/DiscoveryServiceStarter.java    | 31 ++---------
 .../discovery/service/server/ServiceConfig.java    |  3 +-
 .../service/server/DiscoveryServiceWebTest.java    |  4 +-
 .../service/WebSocketProxyConfiguration.java       | 16 +++++-
 .../websocket/service/WebSocketServiceStarter.java | 29 ++--------
 15 files changed, 135 insertions(+), 102 deletions(-)

commit e61acc12b0b8a26b3be685e40cb0c5baec6bff05
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Jan 20 15:00:42 2017 -0800

    Fix consumer redelivery should not clear availablePermits (#170)

 .../client/api/SimpleProducerConsumerTest.java     | 83 ++++++++++++++++++++++
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  3 +-
 2 files changed, 84 insertions(+), 2 deletions(-)

commit 0569689bdc061e7471b6948f23f090f9c331e0d2
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Jan 20 15:00:28 2017 -0800

    Pass brokerServiceUrl to websocket service configuration (#166)

 conf/websocket.conf                                |   8 +
 .../websocket/proxy/ProxyAuthenticationTest.java   |   3 +-
 .../websocket/proxy/ProxyAuthorizationTest.java    |   6 +-
 .../websocket/proxy/ProxyPublishConsumeTest.java   |   5 +-
 .../websocket/proxy/ProxyPublishConsumeTls.java    |   5 +-
 .../proxy/ProxyPublishConsumeWithoutZKTest.java    | 113 ++++++++++++
 .../yahoo/pulsar/websocket/WebSocketService.java   |  71 +++++--
 .../pulsar/websocket/service/ProxyServer.java      |   5 +-
 .../service/WebSocketProxyConfiguration.java       | 203 +++++++++++++++++++++
 .../websocket/service/WebSocketServiceStarter.java |  29 ++-
 10 files changed, 419 insertions(+), 29 deletions(-)

commit 8818eeaab3f245bb361f4c555b70a62e3279fd0a
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Jan 20 13:40:08 2017 -0800

    Unload bundle: close topic forcefully and enable bundle on ownership removal failure (#164)

 .../pulsar/broker/namespace/NamespaceService.java  |  6 +-
 .../yahoo/pulsar/broker/namespace/OwnedBundle.java | 25 +++++--
 .../pulsar/broker/namespace/OwnershipCache.java    | 80 ++++++++++++----------
 .../broker/namespace/NamespaceServiceTest.java     | 44 +++++++++++-
 .../broker/namespace/OwnershipCacheTest.java       |  3 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  2 +-
 6 files changed, 111 insertions(+), 49 deletions(-)

commit 9266687736e7b3595626aedcb99a15b22f3adc78
Merge: 56afa5589a f80a079e89
Author: saandrews <sahaya.andrews@gmail.com>
Date:   Thu Jan 19 11:14:48 2017 -0800

    Merge pull request #169 from krumo/patch-1
    
    Update AdminTools.md

commit f80a079e89b9877ef30fb47a21a7fd5f36a50809
Author: haooran <krumo@users.noreply.github.com>
Date:   Thu Jan 19 09:44:51 2017 +0800

    Update AdminTools.md
    
    modify a typo

 docs/AdminTools.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 56afa5589adf6fc913125198f6b0cfce5bf7c286
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Jan 17 22:06:10 2017 -0800

    Updated to 4.3.1.47-yahoo (#167)

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit a6186b2d1d48ab84658107a08cd4098c87916399
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Jan 10 13:54:40 2017 -0800

    Safely stop(close replication-producer) and remove replicator (#152)

 .../service/persistent/PersistentReplicator.java   |  3 +-
 .../broker/service/persistent/PersistentTopic.java | 26 +++++++--
 .../pulsar/broker/service/ReplicatorTest.java      | 66 ++++++++++++++++++++++
 .../pulsar/common/policies/data/Policies.java      | 11 ++++
 4 files changed, 100 insertions(+), 6 deletions(-)

commit 12f896ee70f5911ee04e5dafde04ede1921ccb0b
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Jan 10 04:31:56 2017 -0800

    Fair message consumption from all partitions in partitioned-cons (#153)

 .../api/PartitionedProducerConsumerTest.java       | 64 ++++++++++++++++++++++
 .../client/api/SimpleProducerConsumerTest.java     |  2 +-
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 19 ++++++-
 .../client/impl/PartitionedConsumerImpl.java       | 13 ++++-
 4 files changed, 91 insertions(+), 7 deletions(-)

commit 3aaff9327819e295ab31c2650c1524bac47754e5
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Jan 9 17:19:30 2017 -0800

    Include DataSketches metrics provider for bookie stats (#143)

 all/pom.xml                                        |  5 +++
 conf/bookkeeper.conf                               |  5 +--
 docs/ClusterSetup.md                               | 23 +++++++++++++-
 pom.xml                                            |  2 +-
 pulsar-zookeeper-utils/pom.xml                     |  5 +++
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  | 37 ++++++++++++++++------
 6 files changed, 63 insertions(+), 14 deletions(-)

commit 3a5ff46969a1b892f88a4bfc2abea09cbd7f311d
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Jan 9 11:48:24 2017 -0800

    Validate cursor-readPosition before reading while checkingBacklogCursor (#162)

 .../org/apache/bookkeeper/mledger/impl/ManagedLedgerImpl.java     | 8 ++++++++
 1 file changed, 8 insertions(+)

commit e2d8c2e658fc95fc9bfe7925ae5db670afb30a72
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Jan 9 11:36:30 2017 -0800

    Replicator-producer creation should be idempotent (#161)

 .../broker/service/persistent/PersistentTopic.java |  2 +-
 .../pulsar/broker/service/ReplicatorTest.java      | 48 +++++++++++++++++++++-
 .../pulsar/broker/service/ReplicatorTestBase.java  |  2 +
 3 files changed, 50 insertions(+), 2 deletions(-)

commit efd21ba281232ee436a74433c1a26c2343b355e6
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Jan 9 11:23:46 2017 -0800

    recycle OpSendMsg after releasing payload (#157)

 .../main/java/com/yahoo/pulsar/client/impl/ProducerImpl.java  | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

commit 2e7ecc9c922c3b9a0a78ef82bfbdad54ff34814d
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Mon Jan 9 16:23:30 2017 -0300

    Async reset cursor (#155)

 .../java/com/yahoo/pulsar/client/admin/PersistentTopics.java | 12 ++++++++++++
 .../pulsar/client/admin/internal/PersistentTopicsImpl.java   |  9 +++++++++
 2 files changed, 21 insertions(+)

commit 4dbe9d34235853bc64eb3f38816ffe014308492d
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Dec 23 01:48:19 2016 -0800

    Stop consuming messages from consumer-listener if incoming-queue is cleared (#142)

 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 39 +++++++++++++---------
 1 file changed, 23 insertions(+), 16 deletions(-)

commit 9609885c340479416a721c8cbe5fac2a6a669042
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Dec 21 10:51:52 2016 -0800

    Use binary-proto-lookup url for replication lookup (#128)

 .../com/yahoo/pulsar/broker/service/BrokerService.java     | 14 ++++++--------
 .../yahoo/pulsar/broker/service/ReplicatorTestBase.java    | 12 +++++++++---
 2 files changed, 15 insertions(+), 11 deletions(-)

commit 6f1fcd31881b45a6dba0dd6ebe9332617791a9ce
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Dec 19 17:39:00 2016 -0800

    Support url/uri encoding of topic-name for http-request (#148)

 .../pulsar/broker/admin/PersistentTopics.java      | 194 ++++++++-------
 .../pulsar/broker/lookup/DestinationLookup.java    |   7 +-
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 266 ++++++++++++++-------
 .../api/PartitionedProducerConsumerTest.java       |  19 ++
 .../pulsar/common/lookup/data/LookupDataTest.java  |  11 +
 5 files changed, 332 insertions(+), 165 deletions(-)

commit e83647a65b2d57f532dd4ca2278f1e17418e36f8
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Dec 19 12:26:49 2016 -0800

    Fix: PartitionedConsumer support queueSize 1 (#149)

 .../api/PartitionedProducerConsumerTest.java       | 51 ++++++++++++++++++++++
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |  6 +--
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  2 +-
 .../client/impl/PartitionedConsumerImpl.java       |  3 +-
 4 files changed, 57 insertions(+), 5 deletions(-)

commit 4136b40031ba9d10d4e558e11809fdcd23f510ff
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Dec 7 22:02:42 2016 -0800

    Updated to BK-4.3.1.45-yahoo (#127)
    
    Changes included:
     * [a25b53] Removed unused SortedLruCache
     * [74cd2f] Removed unused DbLedgerStorage configuration keys
     * [fb279e] Reorder read operations based on Bookie availability
     * [d203c2] DataSketches metrics provider
     * [17ab66] Catch IndexOutOfBoundsException when reading entry log index map
     * [270b69] Fixed NPE when accessing readonly bookie list

 pom.xml | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit caba91c92bd8289c40eeab2d5d167540db8be16d
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Dec 7 14:51:10 2016 -0800

    adminApi: add brokerServiceUrl while creating cluster (#140)

 docs/AdminTools.md                                     | 12 +++++++-----
 .../java/com/yahoo/pulsar/admin/cli/CmdClusters.java   | 18 ++++++++++++++++--
 2 files changed, 23 insertions(+), 7 deletions(-)

commit 6448d36112bf498bc1c000bba92ede18b2a7a3b3
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Dec 7 14:49:55 2016 -0800

    signSafeMod while getNextBroker index (#141)

 .../yahoo/pulsar/discovery/service/web/DiscoveryServiceServlet.java   | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit 710755ffb054e5e493548148ed164f16679c2d36
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sat Dec 3 09:57:19 2016 -0800

    Add support of auth&auth at discovery BinaryProto-lookup (#126)

 conf/discovery.conf                                |  26 +
 docs/BinaryProtocol.md                             |  14 +-
 docs/ClusterSetup.md                               |   4 +
 .../pulsar/client/api/BrokerServiceLookupTest.java | 206 ++++++-
 .../client/impl/BinaryProtoLookupService.java      |  31 +-
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |  11 +-
 .../java/com/yahoo/pulsar/common/api/Commands.java |  18 +-
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 639 ++++++++-------------
 pulsar-common/src/main/proto/PulsarApi.proto       |  11 +-
 pulsar-discovery-service/pom.xml                   |   6 +
 .../discovery/service/BrokerDiscoveryProvider.java | 111 +++-
 .../pulsar/discovery/service/DiscoveryService.java |  51 +-
 .../pulsar/discovery/service/ServerConnection.java |  74 ++-
 .../service/ServiceChannelInitializer.java         |   2 +-
 .../service/server/DiscoveryServiceStarter.java    |   2 +
 .../discovery/service/server/ServiceConfig.java    |  70 ++-
 .../discovery/service/DiscoveryServiceTest.java    |   4 +-
 .../service/server/DiscoveryServiceWebTest.java    |   1 +
 18 files changed, 752 insertions(+), 529 deletions(-)

commit d04b36fbc1eab07d04505336a7cd5a6a1d602270
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Dec 2 11:36:13 2016 -0800

    Cleanup pending lookup request on connection close (#131)

 .../yahoo/pulsar/client/api/ClientErrorsTest.java  | 38 +++++++++++++++++++
 .../yahoo/pulsar/client/api/MockBrokerService.java | 44 ++++++++++++++++++++++
 .../pulsar/client/api/MockBrokerServiceHooks.java  |  8 ++++
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |  1 +
 4 files changed, 91 insertions(+)

commit 4283b1a08e6199e61130862c95106a3181a370d4
Author: Aaron Gong <ais-one@users.noreply.github.com>
Date:   Sat Dec 3 02:42:53 2016 +0800

    Fix Error in NodeJS consumer example code (#138)
    
    There was some problems with the URL and also the data packet coming in was a string and should be parsed...

 docs/WebSocket.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 6ea847cc1cc6458de85b5eab48b8d68040e5c547
Author: yush1ga <yushiga@yahoo-corp.jp>
Date:   Fri Dec 2 05:11:13 2016 +0900

    Replaced Json Library (#130)

 pom.xml                                            |  8 +----
 pulsar-broker/pom.xml                              |  4 +--
 .../broker/service/AdvertisedAddressTest.java      |  9 +++---
 .../pulsar/broker/service/BrokerServiceTest.java   | 29 +++++++++--------
 .../service/web/DiscoveryServiceWebTest.java       | 11 ++++---
 .../websocket/proxy/SimpleConsumerSocket.java      | 16 +++++-----
 .../websocket/proxy/SimpleProducerSocket.java      | 13 ++++----
 pulsar-client-admin/pom.xml                        |  9 ++----
 .../com/yahoo/pulsar/client/admin/BrokerStats.java | 12 ++++----
 .../client/admin/internal/BrokerStatsImpl.java     | 29 ++++++++---------
 .../com/yahoo/pulsar/admin/cli/CmdBrokerStats.java | 36 +++++++++++++++-------
 pulsar-client/pom.xml                              |  5 ---
 pulsar-websocket/pom.xml                           |  4 +--
 .../socket/client/SimpleTestProducerSocket.java    | 15 ++++-----
 14 files changed, 102 insertions(+), 98 deletions(-)

commit 5af7d3feac568f28245bc7a20ac425bed3bdc8c5
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Nov 28 15:54:51 2016 -0800

    Added DbLedgerStorage configuration keys with default values in bookkeeper.conf (#123)

 conf/bookkeeper.conf | 54 ++++++++++++++++++++++++++++++++++++++--------------
 1 file changed, 40 insertions(+), 14 deletions(-)

commit 83ff857541b5cc78fd6f327c69cb99948908c332
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Nov 22 14:27:43 2016 -0800

    exclude: conflicting artifact from async-http-client to avoid split-package conflict (#125)

 pom.xml               | 7 +++++++
 pulsar-client/pom.xml | 6 ------
 2 files changed, 7 insertions(+), 6 deletions(-)

commit 3cec7e4626fee8e5403988ec9899a6e19d38bd51
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Nov 22 10:49:33 2016 -0800

    Add blockedConsumerOnUnackedMsgs flag in consumer-stats (#124)

 .../src/main/java/com/yahoo/pulsar/broker/service/Consumer.java       | 1 +
 .../com/yahoo/pulsar/broker/service/persistent/PersistentTopic.java   | 1 +
 .../java/com/yahoo/pulsar/common/policies/data/ConsumerStats.java     | 4 ++++
 3 files changed, 6 insertions(+)

commit e525da35335a6a9d5d2f30066345d98995698250
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sun Nov 20 19:06:48 2016 -0800

    Fix: split-package conflict while server startup (#122)

 pulsar-client/pom.xml | 6 ++++++
 1 file changed, 6 insertions(+)

commit 6089dcba0e18e69e4b1a6cd92fe8ea377673ad53
Author: Rajan <dhabalia.me@gmail.com>
Date:   Sun Nov 20 19:06:20 2016 -0800

    Check symbolicLink file type before reading it as SymbolicLink file (#121)

 .../yahoo/pulsar/broker/loadbalance/impl/LinuxBrokerHostUsageImpl.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit a7e746dcf12465346973e1246b0a63a91fe62e10
Author: Matteo Merli <mmerli@apache.org>
Date:   Sun Nov 20 09:13:20 2016 -0800

    Pulsar binary protocol documentation (#111)
    
    Fixes #109

 docs/BinaryProtocol.md                          | 573 ++++++++++++++++++++++++
 docs/Documentation.md                           |   2 +
 docs/img/Binary Protocol - Connect.graffle      | Bin 0 -> 2718 bytes
 docs/img/Binary Protocol - Connect.png          | Bin 0 -> 10230 bytes
 docs/img/Binary Protocol - Consumer.graffle     | Bin 0 -> 3583 bytes
 docs/img/Binary Protocol - Consumer.png         | Bin 0 -> 32239 bytes
 docs/img/Binary Protocol - Producer.graffle     | Bin 0 -> 3480 bytes
 docs/img/Binary Protocol - Producer.png         | Bin 0 -> 33100 bytes
 docs/img/Binary Protocol - Topic lookup.graffle | Bin 0 -> 3002 bytes
 docs/img/Binary Protocol - Topic lookup.png     | Bin 0 -> 29050 bytes
 10 files changed, 575 insertions(+)

commit b21e0f3556d0fe79be1c272b483c4c7af4a8e868
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Nov 17 16:52:51 2016 -0800

    Upgrade to BK-4.3.1.42-yahoo (#120)
    
    Changes included:
     * [c4f1f9a] Avoid RocksDB get() operations during read-ahead cache filling (#145)
    
    Related to #110

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 610a9fb0e2b568e7764308f918a15889d6bf31a1
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Nov 17 16:47:43 2016 -0800

    Remove shading-package-relocation for async-client as it creates conflict while reading property file (#119)

 pulsar-client/pom.xml | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

commit 70ae671086d99f6a61ef22636698e324e96ecabf
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Nov 16 22:25:36 2016 -0800

    Initialize lookup-request variables locally before request-instance recycle (#117)

 .../com/yahoo/pulsar/broker/service/ServerCnx.java | 88 +++++++++++-----------
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  1 +
 .../client/impl/BinaryProtoLookupService.java      | 15 ++--
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |  8 +-
 4 files changed, 58 insertions(+), 54 deletions(-)

commit 4563540cf3d3481e3092c1099edd2b578ad87dc4
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Nov 16 15:21:18 2016 -0800

    [#114] Process ZK event from background thread to avoid deadlock on ZK sync operations (#115)

 .../pulsar/broker/namespace/NamespaceService.java  | 59 +++++++++++-----------
 1 file changed, 30 insertions(+), 29 deletions(-)

commit 3c596d49ac48468de587fd6870d81987c52a6d0f
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Wed Nov 16 21:23:24 2016 +0200

    Fix LinuxBrokerHostUsageImpl scheduled timer (#113)

 .../pulsar/broker/loadbalance/impl/LinuxBrokerHostUsageImpl.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

commit 536d353eb3c01a6cfec3cc0685351f3c48baed88
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Nov 16 10:25:14 2016 -0800

    Fix: Discovery-lookup returns correct PartitionMetadataResponse on partition-lookup (#112)

 .../java/com/yahoo/pulsar/common/api/Commands.java     | 18 ++++++++++++++++++
 .../pulsar/discovery/service/ServerConnection.java     | 13 ++++++++++++-
 2 files changed, 30 insertions(+), 1 deletion(-)

commit f9993942932f67549fda74a79f90d7b736a15127
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Wed Nov 16 20:24:35 2016 +0200

    Implement BrokerHostUsage using java (#88)

 conf/broker.conf                                   |   5 +-
 conf/standalone.conf                               |   5 +-
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  13 +-
 .../com/yahoo/pulsar/broker/PulsarService.java     |  14 +-
 .../pulsar/broker/loadbalance/BrokerHostUsage.java |  68 +----
 .../impl/GenericBrokerHostUsageImpl.java           |  96 +++++++
 .../loadbalance/impl/LinuxBrokerHostUsageImpl.java | 241 +++++++++++++++++
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 285 +++++++++++----------
 .../com/yahoo/pulsar/PulsarBrokerStarterTest.java  |   2 -
 .../broker/loadbalance/LoadBalancerTest.java       |   8 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |  22 +-
 .../configurations/pulsar_broker_test.conf         |   1 -
 .../resources/test-script-pulsar-broker-host-usage |   7 -
 13 files changed, 507 insertions(+), 260 deletions(-)

commit 5e9884c7ea310baf62687efddb63af0521415d35
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Wed Nov 16 19:57:10 2016 +0200

    Increment permits when redelivering messages from incomingMessages (#101)

 .../client/api/SimpleProducerConsumerTest.java     |  63 ++++-
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |   3 +-
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 259 +++++++++++++--------
 .../client/impl/PartitionedConsumerImpl.java       |   6 +-
 .../pulsar/client/impl/UnAckedMessageTracker.java  |   4 +-
 5 files changed, 227 insertions(+), 108 deletions(-)

commit 72cc6779b57c470eb101967850f4c44030e00bf7
Merge: f2636e1e23 ff8318be95
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Nov 14 10:05:31 2016 -0800

    Issue #80: Use receiveAsync() to aggregate messages into shared queue for partitioned consumer (#106)

commit ff8318be95f752386683cc9c686e7470ebca4c79
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Thu Nov 10 23:42:54 2016 -0800

    Issue #80: Use receiveAsync() to aggregate messages into shared queue for partitioned consumer

 .../yahoo/pulsar/broker/service/BrokerService.java |   9 +-
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |   9 +-
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |   9 +-
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  16 +--
 .../client/impl/PartitionedConsumerImpl.java       | 108 ++++++++++++---------
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |  34 +++----
 .../pulsar/testclient/PerformanceConsumer.java     |   3 +-
 .../pulsar/testclient/PerformanceProducer.java     |   3 +-
 8 files changed, 101 insertions(+), 90 deletions(-)

commit f2636e1e235e4e7629ca3da640d0c602991d1fd5
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Nov 11 15:35:10 2016 -0800

    Fix typo in pulsar-admin (#108)

 docs/GeoReplication.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 4e9b0517bd008feb3f35c6d16ef650e80a70c539
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Nov 11 13:08:53 2016 -0800

    Avoid setting ReplicatedFrom while init batchMessageMetadata (#107)

 .../src/test/java/com/yahoo/pulsar/broker/service/ReplicatorTest.java | 2 +-
 .../test/java/com/yahoo/pulsar/broker/service/ReplicatorTestBase.java | 3 ++-
 pulsar-common/src/main/java/com/yahoo/pulsar/common/api/Commands.java | 4 +++-
 3 files changed, 6 insertions(+), 3 deletions(-)

commit 004e022fbc30dc2e3c9942c379367dbb04b8bb35
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Nov 9 14:52:16 2016 -0800

    Support Topic lookup using Pulsar binary protocol (#5)

 .../yahoo/pulsar/broker/admin/AdminResource.java   |    1 +
 .../pulsar/broker/admin/PersistentTopics.java      |   92 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |  130 +-
 .../yahoo/pulsar/broker/lookup/LookupResult.java   |   28 +-
 .../pulsar/broker/namespace/NamespaceService.java  |   91 +-
 .../com/yahoo/pulsar/broker/service/Consumer.java  |    1 -
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   52 +-
 .../yahoo/pulsar/broker/web/PulsarWebResource.java |  254 +-
 .../yahoo/pulsar/broker/admin/NamespacesTest.java  |   62 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   16 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |    3 +
 .../lookup/http/HttpDestinationLookupv2Test.java   |    7 +
 .../pulsar/client/api/BrokerServiceLookupTest.java |  551 ++++
 .../yahoo/pulsar/client/api/MockBrokerService.java |    2 +-
 .../client/api/SimpleProducerConsumerTest.java     |    6 +-
 .../client/impl/BinaryProtoLookupService.java      |  215 ++
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |   98 +-
 .../yahoo/pulsar/client/impl/ConnectionPool.java   |   10 +-
 .../pulsar/client/impl/HttpLookupService.java      |   81 +
 .../yahoo/pulsar/client/impl/LookupService.java    |   72 +-
 .../impl/PartitionMetadataLookupService.java       |   35 -
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |   34 +-
 .../java/com/yahoo/pulsar/common/api/Commands.java |   98 +
 .../com/yahoo/pulsar/common/api/PulsarDecoder.java |   44 +
 .../com/yahoo/pulsar/common/api/PulsarHandler.java |    6 +-
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 2991 ++++++++++++++++++++
 .../pulsar/common/lookup/data/LookupData.java      |   18 +-
 .../pulsar/common/policies/data/ClusterData.java   |   54 +-
 .../util/protobuf/ByteBufCodedOutputStream.java    |   11 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   56 +
 .../pulsar/common/lookup/data/LookupDataTest.java  |    7 +-
 .../discovery/service/BrokerDiscoveryProvider.java |   83 +
 .../pulsar/discovery/service/DiscoveryService.java |  184 ++
 .../discovery/service/PulsarServerException.java   |   35 +
 .../pulsar/discovery/service/ServerConnection.java |  107 +
 .../service/ServiceChannelInitializer.java         |   64 +
 .../service/server/DiscoveryServiceStarter.java    |   11 +
 .../discovery/service/server/ServerManager.java    |    4 +
 .../discovery/service/server/ServiceConfig.java    |   31 +
 .../service/web/DiscoveryServiceServlet.java       |    2 +-
 .../service/web/ZookeeperCacheLoader.java          |    2 +-
 .../discovery/service/BaseDiscoveryTestSetup.java  |   86 +
 .../discovery/service/DiscoveryServiceTest.java    |  208 ++
 .../service/server/DiscoveryServiceWebTest.java    |   58 +
 .../service/web/DiscoveryServiceWebTest.java       |   16 +-
 .../src/test/resources/certificate/client.crt      |   20 +
 .../src/test/resources/certificate/client.key      |   28 +
 .../discovery/service/BaseDiscoveryTestSetup.java  |   86 +
 .../discovery/service/DiscoveryServiceTest.java    |  208 ++
 .../service/server/DiscoveryServiceWebTest.java    |   58 +
 .../discovery/service/web/BaseZKStarterTest.java   |   68 +
 .../service/web/DiscoveryServiceWebTest.java       |  317 +++
 .../service/web/ZookeeperCacheLoaderTest.java      |  101 +
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |   11 +
 54 files changed, 6601 insertions(+), 313 deletions(-)

commit afaa63fdaa53bc04554329b43ddbf95c5b158ae8
Author: Rajan <dhabalia.me@gmail.com>
Date:   Wed Nov 9 10:40:15 2016 -0800

    Async authorization check while creation of producer/consumer (#98)

 .../broker/authorization/AuthorizationManager.java | 104 ++++--
 .../com/yahoo/pulsar/broker/service/ServerCnx.java | 359 +++++++++++----------
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  12 +-
 .../pulsar/websocket/AbstractWebSocketHandler.java |  18 +-
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |   5 +-
 .../yahoo/pulsar/websocket/ProducerHandler.java    |   5 +-
 6 files changed, 280 insertions(+), 223 deletions(-)

commit 15683fd02b4cc8d6c076d24aa9961d254acd8a84
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Nov 4 11:39:25 2016 -0700

    Complete Message replay immediately if there is no entry to replay which will not block reads from other consumer (#103)

 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  8 +++
 .../PersistentDispatcherMultipleConsumers.java     |  6 ++
 .../broker/service/PersistentTopicE2ETest.java     | 81 ++++++++++++++++++++++
 3 files changed, 95 insertions(+)

commit 1f053681e6f2a5b5200b1fb9222bd794b786841f
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Nov 1 11:34:16 2016 -0700

    Fix: broken websocket test and proxy-producer error handling (#99)

 docs/WebSocket.md                                  | 11 +++++
 .../yahoo/pulsar/broker/admin/AdminResource.java   |  2 +-
 .../websocket/proxy/ProxyAuthenticationTest.java   | 36 ++++++++++-----
 .../websocket/proxy/ProxyPublishConsumeTest.java   | 41 ++++++++++------
 .../websocket/proxy/ProxyPublishConsumeTls.java    | 37 +++++++++------
 .../websocket/proxy/SimpleConsumerSocket.java      |  4 +-
 .../websocket/proxy/SimpleProducerSocket.java      | 24 ++++++----
 .../yahoo/pulsar/websocket/ProducerHandler.java    | 54 +++++++++++++---------
 .../com/yahoo/pulsar/websocket/WebSocketError.java |  4 +-
 .../yahoo/pulsar/websocket/data/ProducerAck.java   | 15 +++++-
 .../websocket/service/WebSocketServiceStarter.java | 20 ++++----
 11 files changed, 162 insertions(+), 86 deletions(-)

commit 5799ffaa2ba5ee5d1386704c9d023bda9f219d03
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Tue Nov 1 14:01:41 2016 -0300

    Updating ning async-http-client to use Netty4 based implementation  (#97)

 pom.xml                                            |  4 +--
 .../pulsar/broker/service/BrokerServiceTest.java   |  2 +-
 pulsar-client-admin/pom.xml                        |  6 ++--
 pulsar-client-tools/pom.xml                        |  2 +-
 pulsar-client/pom.xml                              | 12 +++----
 .../yahoo/pulsar/client/impl/ConsumerStats.java    |  2 +-
 .../com/yahoo/pulsar/client/impl/HttpClient.java   | 35 ++++++++-----------
 .../yahoo/pulsar/client/impl/ProducerStats.java    |  2 +-
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java | 18 +---------
 .../yahoo/pulsar/common/util/SecurityUtility.java  | 40 +++++++++++++++++-----
 pulsar-storm/pom.xml                               |  2 +-
 11 files changed, 60 insertions(+), 65 deletions(-)

commit 25d4c5559eb14c0a4a47d7f5c6fa48324442051c
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Tue Nov 1 13:59:53 2016 -0300

    unacked messages should always be changed even if BlockConsumerOnUnackMsgs is disabled (#96)

 .../src/main/java/com/yahoo/pulsar/broker/service/Consumer.java   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

commit 5e55d799c7b6ea23f86950f63f571bf8e81ca07f
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Tue Nov 1 13:59:19 2016 -0300

    Add redelivery rates to consumer and subscription stats (#95)

 .../com/yahoo/pulsar/broker/service/Consumer.java  | 10 +++
 .../service/persistent/PersistentSubscription.java |  2 +
 .../broker/service/persistent/PersistentTopic.java |  7 ++
 .../pulsar/broker/service/BrokerServiceTest.java   | 90 ++++++++++++++++++++++
 .../pulsar/common/policies/data/ConsumerStats.java |  4 +
 .../policies/data/PersistentSubscriptionStats.java | 10 +++
 6 files changed, 123 insertions(+)

commit 340dc8d170ee5ecea8c4623cfbbbc7aaef999b38
Author: Matteo Merli <mmerli@apache.org>
Date:   Sat Oct 29 08:58:42 2016 -0700

    Fix #91 - Intermittent test failure on SimpleProducerConsumerTest.testSharedConsumerAckDifferentConsumer (#92)

 .../client/api/SimpleProducerConsumerTest.java     | 101 ++++++++++-----------
 1 file changed, 50 insertions(+), 51 deletions(-)

commit 551d42d84e820322f532a853cc8e264d0e56eed4
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Oct 28 13:09:41 2016 -0700

    Fix #91 intermittent test failure PulsarClientToolTest.testInitialzation (#94)

 .../src/test/java/com/yahoo/pulsar/client/cli/PulsarClientToolTest.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit e7f08a83106bb7a2022e1d846c65966e385d197b
Author: Rajan <dhabalia.me@gmail.com>
Date:   Fri Oct 28 10:34:03 2016 -0700

    Fix: Reset message-header index while verify checksum-strip at Reconnection (#89) (#90)

 .../yahoo/pulsar/client/impl/MessageIdTest.java    | 64 ++++++++++++++++++++++
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java |  6 +-
 2 files changed, 67 insertions(+), 3 deletions(-)

commit 1868d2ff58e83d073e3031d48adf1da0d36b8308
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 26 12:13:18 2016 -0700

    Async ZooKeeper cache implementation (#76)
    
     * Changed Guava cache with Caffeine async loading cache
     * Added async lookup methods in ZooKeeperDataCache
     * Changed namespace bundle ownership registration to be asynchronous
     * Use Optional<> to treat ZK NoNodeError instead of propagating the exception to the cache
     * Changed HTTP topic lookup to use async servlet
     * Fixed MockZookeeper to notify watchers without holding instance mutex to avoid deadlocks in unit tests

 .../java/org/apache/zookeeper/MockZooKeeper.java   | 156 +++++----
 pom.xml                                            |  18 +-
 .../broker/authorization/AuthorizationManager.java |  20 +-
 pulsar-broker/pom.xml                              |   5 +
 .../com/yahoo/pulsar/broker/PulsarService.java     |  72 +++--
 .../yahoo/pulsar/broker/admin/AdminResource.java   |  20 +-
 .../com/yahoo/pulsar/broker/admin/Clusters.java    |  90 +++---
 .../com/yahoo/pulsar/broker/admin/Namespaces.java  |  41 ++-
 .../pulsar/broker/admin/PersistentTopics.java      |  15 +-
 .../com/yahoo/pulsar/broker/admin/Properties.java  |   6 +-
 .../broker/cache/LocalZooKeeperCacheService.java   | 131 ++++++--
 .../pulsar/broker/cache/ResourceQuotaCache.java    |  12 +-
 .../pulsar/broker/loadbalance/LoadManager.java     |   9 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  36 +--
 .../impl/SimpleResourceAllocationPolicies.java     |  21 +-
 .../pulsar/broker/lookup/DestinationLookup.java    |  85 +++--
 .../yahoo/pulsar/broker/lookup/LookupResource.java |  63 ----
 .../pulsar/broker/namespace/NamespaceService.java  | 357 +++++++++++----------
 .../{OwnedServiceUnit.java => OwnedBundle.java}    |  42 +--
 .../pulsar/broker/namespace/OwnershipCache.java    | 291 ++++++++++-------
 .../broker/namespace/ServiceUnitZkUtils.java       |   6 +-
 .../pulsar/broker/service/BacklogQuotaManager.java |  18 +-
 .../yahoo/pulsar/broker/service/BrokerService.java |  49 +--
 .../PersistentDispatcherSingleActiveConsumer.java  |   7 +-
 .../service/persistent/PersistentSubscription.java |   9 +-
 .../broker/service/persistent/PersistentTopic.java |   7 +-
 .../yahoo/pulsar/broker/web/ApiVersionFilter.java  |   9 +-
 .../yahoo/pulsar/broker/web/PulsarWebResource.java | 161 ++--------
 .../com/yahoo/pulsar/broker/web/RestException.java |  14 +-
 .../com/yahoo/pulsar/broker/web/WebService.java    |   2 +-
 .../pulsar/common/naming/NamespaceBundle.java      |   2 +-
 .../common/naming/NamespaceBundleFactory.java      |  67 ++--
 .../pulsar/common/naming/NamespaceBundles.java     |   2 +-
 .../yahoo/pulsar/utils/CopyOnWriteArrayList.java   |   1 -
 .../com/yahoo/pulsar/broker/SLAMonitoringTest.java |   7 +-
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |  43 +--
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |  22 +-
 .../yahoo/pulsar/broker/admin/NamespacesTest.java  |  34 +-
 .../lookup/http/HttpDestinationLookupv2Test.java   |  61 ++--
 .../broker/namespace/NamespaceServiceTest.java     |  24 +-
 .../broker/namespace/OwnershipCacheTest.java       | 122 +++----
 .../PersistentDispatcherFailoverConsumerTest.java  |   4 +-
 .../service/PersistentTopicConcurrentTest.java     |   4 +-
 .../pulsar/broker/service/PersistentTopicTest.java |  28 +-
 .../pulsar/broker/service/ReplicatorTest.java      |  10 +-
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |   6 +-
 .../pulsar/broker/web/ApiVersionFilterTest.java    |  10 +-
 .../client/impl/BrokerClientIntegrationTest.java   |   8 +-
 .../pulsar/common/naming/NamespaceBundlesTest.java |  11 +-
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |  16 +-
 .../pulsar/common/lookup/data/LookupData.java      |   8 +
 .../pulsar/common/policies/data/BundlesData.java   |   5 +
 .../service/web/ZookeeperCacheLoader.java          |   2 +-
 .../yahoo/pulsar/websocket/WebSocketService.java   |   5 +-
 pulsar-zookeeper-utils/pom.xml                     |   9 +-
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |   2 +-
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |   4 +-
 .../zookeeper/ZkBookieRackAffinityMapping.java     |   4 +-
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |   5 +-
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |  94 ++++--
 .../yahoo/pulsar/zookeeper/ZooKeeperDataCache.java |  45 ++-
 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java |  35 +-
 62 files changed, 1292 insertions(+), 1180 deletions(-)

commit 1bb5bda2b33f401a1fa977e008cb99af7c45196d
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Oct 26 10:44:33 2016 -0700

    Make protoc compiler to use 'pulsar::proto' as C++ namespace (#87)

 pulsar-common/src/main/proto/PulsarApi.proto | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

commit 979c46dc9ee21855d2e113dfd30236ae4e9e3e31
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Oct 25 10:43:04 2016 -0700

    Added pulsar logo in icon format

 docs/img/Pulsar-icon.pdf | Bin 0 -> 8713 bytes
 1 file changed, 0 insertions(+), 0 deletions(-)

commit 031271cbe14aaadbbcdf04a836a2d74d2f11cba5
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 25 10:26:16 2016 -0700

    Added badge image with latest Pulsar version from Maven central (#84)

 README.md              | 3 +++
 docs/GettingStarted.md | 6 ++++--
 2 files changed, 7 insertions(+), 2 deletions(-)

commit 776042ba38ceb5cabbf9d254561b2a679ab63282
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Tue Oct 25 14:23:12 2016 -0300

    Increment receive timeout on PerMessageUnAcknowledgedRedeliveryTest to prevent failing tests (#85)

 .../PerMessageUnAcknowledgedRedeliveryTest.java    | 32 +++++++++++-----------
 1 file changed, 16 insertions(+), 16 deletions(-)

commit 4d685b515a429c1eaba93a55939b826e7aa3f9e2
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 24 18:07:13 2016 -0700

    Use local broker address as serviceURL when running WebSocket component embedded in broker (#82)
    
    Fixes #77

 .../com/yahoo/pulsar/broker/PulsarService.java     |  7 +--
 .../yahoo/pulsar/websocket/WebSocketService.java   | 53 ++++++++++++++--------
 2 files changed, 39 insertions(+), 21 deletions(-)

commit b33b2a198479a84fb8d15ce349a61dde588d0557
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Mon Oct 24 16:49:36 2016 -0300

    Partitioned numMessagesInQueue should count it's incoming messages (#78)

 .../main/java/com/yahoo/pulsar/client/impl/PartitionedConsumerImpl.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 2221aee4943801186f32122cf8f252a269077817
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Mon Oct 24 16:45:38 2016 -0300

    allow reset of global topic subscription (#79)

 .../java/com/yahoo/pulsar/broker/admin/PersistentTopics.java  |  3 ---
 .../java/com/yahoo/pulsar/broker/service/ReplicatorTest.java  | 11 +++--------
 2 files changed, 3 insertions(+), 11 deletions(-)

commit eb619f3e0c96012aa398b0f27965d973714b8de0
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 18 22:05:52 2016 -0700

    GPG keys need to imported just once (#75)

 .travis.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 36d7fb1aa4c34d61d022d753b0077170706269a4
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Oct 18 16:50:12 2016 -0700

    Bump version to 1.16-SNAPSHOT

 all/pom.xml                      | 2 +-
 managed-ledger/pom.xml           | 2 +-
 pom.xml                          | 2 +-
 pulsar-broker-common/pom.xml     | 2 +-
 pulsar-broker/pom.xml            | 2 +-
 pulsar-checksum/pom.xml          | 2 +-
 pulsar-client-admin/pom.xml      | 2 +-
 pulsar-client-tools/pom.xml      | 2 +-
 pulsar-client/pom.xml            | 2 +-
 pulsar-common/pom.xml            | 2 +-
 pulsar-discovery-service/pom.xml | 2 +-
 pulsar-storm/pom.xml             | 2 +-
 pulsar-testclient/pom.xml        | 2 +-
 pulsar-websocket/pom.xml         | 2 +-
 pulsar-zookeeper-utils/pom.xml   | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit 29494905d677f1b525b2863c34d10f26ab7868ce
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Oct 18 15:21:20 2016 -0700

    Pulsar release v1.15

 all/pom.xml                      | 2 +-
 managed-ledger/pom.xml           | 2 +-
 pom.xml                          | 2 +-
 pulsar-broker-common/pom.xml     | 2 +-
 pulsar-broker/pom.xml            | 2 +-
 pulsar-checksum/pom.xml          | 2 +-
 pulsar-client-admin/pom.xml      | 2 +-
 pulsar-client-tools/pom.xml      | 2 +-
 pulsar-client/pom.xml            | 2 +-
 pulsar-common/pom.xml            | 2 +-
 pulsar-discovery-service/pom.xml | 2 +-
 pulsar-storm/pom.xml             | 2 +-
 pulsar-testclient/pom.xml        | 2 +-
 pulsar-websocket/pom.xml         | 2 +-
 pulsar-zookeeper-utils/pom.xml   | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit 8df2868bcb4fa5371fb7eba89eb9fc9d3dbbf80a
Author: Rajan <dhabalia.me@gmail.com>
Date:   Tue Oct 18 14:53:48 2016 -0700

    fix: flow permits on blocked consumer while redelivery of messages (#74)

 .../com/yahoo/pulsar/broker/service/Consumer.java  |  31 +++-
 .../client/api/SimpleProducerConsumerTest.java     | 182 ++++++++++++++++++++-
 2 files changed, 207 insertions(+), 6 deletions(-)

commit 430eb5e0057ed43a7ebfaa7a7f2b8d82024da3f3
Author: sschepens <sebastian.schepens@mercadolibre.com>
Date:   Tue Oct 18 15:32:37 2016 -0300

    Add numMessagesInQueue and getAvailablePermits for PartitionedConsumerImpl (#72)

 .../main/java/com/yahoo/pulsar/client/impl/ConsumerBase.java   |  4 ++++
 .../main/java/com/yahoo/pulsar/client/impl/ConsumerImpl.java   |  2 ++
 .../com/yahoo/pulsar/client/impl/PartitionedConsumerImpl.java  | 10 ++++++++++
 3 files changed, 16 insertions(+)

commit b2805b8c47b3522970ab8b0aec9d857dcc2e507e
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Oct 17 18:55:03 2016 -0700

    Admin-api-tool doc: Fix REST api url, add expire-messge api doc (#71)

 docs/AdminTools.md                                 | 202 +++++++++++++++------
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   4 +-
 2 files changed, 145 insertions(+), 61 deletions(-)

commit e274a24b875ac047db5182214c34023033d23750
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 17 16:16:31 2016 -0700

    Support per message unacknowledged redelivery on RedeliverUnAcknowledgedMessages (#70)

 .../com/yahoo/pulsar/broker/service/Consumer.java  |  10 +
 .../yahoo/pulsar/broker/service/Dispatcher.java    |   5 +
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   7 +-
 .../yahoo/pulsar/broker/service/Subscription.java  |   3 +
 .../PersistentDispatcherMultipleConsumers.java     |  11 +
 .../PersistentDispatcherSingleActiveConsumer.java  |   7 +
 .../service/persistent/PersistentSubscription.java |   7 +
 .../PerMessageUnAcknowledgedRedeliveryTest.java    | 451 +++++++++++++++++++++
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |  17 +-
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  39 ++
 .../client/impl/PartitionedConsumerImpl.java       |  23 +-
 .../pulsar/client/impl/UnAckedMessageTracker.java  |  11 +-
 pulsar-common/generate_protobuf.sh                 |   1 +
 .../java/com/yahoo/pulsar/common/api/Commands.java |  14 +
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 159 ++++++++
 pulsar-common/src/main/proto/PulsarApi.proto       |   3 +-
 16 files changed, 754 insertions(+), 14 deletions(-)

commit f946a6d1c7f9ebd83266b76957adf2762e8ec21f
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 17 14:51:30 2016 -0700

    Added pulsar logo (#69)

 README.md           |   2 +-
 docs/img/pulsar.pdf | Bin 0 -> 42581 bytes
 docs/img/pulsar.png | Bin 0 -> 6156 bytes
 docs/img/pulsar.svg |   1 +
 4 files changed, 2 insertions(+), 1 deletion(-)

commit 1e9fa9fa17b36bf6c7e35057725f412d5840a4fe
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Oct 17 14:46:24 2016 -0700

    Unack message tracker for pre-fetched messages (#68)

 .../client/api/SimpleProducerConsumerStatTest.java | 20 ++---
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    | 40 ++++------
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java | 12 ---
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 93 ++++++++++------------
 .../client/impl/PartitionedConsumerImpl.java       | 34 +-------
 .../pulsar/client/impl/UnAckedMessageTracker.java  | 64 ++++++++++++---
 6 files changed, 124 insertions(+), 139 deletions(-)

commit 18332962926b63ac3f328d7e5d4e2760265b1762
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Oct 17 13:04:13 2016 -0700

    avoid synchronization for method that blocks while fetching zero-queue message (#61)

 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java | 26 ++++++++++++++++------
 1 file changed, 19 insertions(+), 7 deletions(-)

commit 5b7b910994bffc3c2314f8d799015f3457a7e563
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Oct 17 12:35:21 2016 -0700

    Add pending-bloclked-message-permits to dispatcher while redelivery of pending messages (#63)

 .../com/yahoo/pulsar/broker/service/Consumer.java  | 36 ++++++++++++++++++----
 1 file changed, 30 insertions(+), 6 deletions(-)

commit 3e4e12760572d931ba317fbf4f0ec0133e17851e
Author: Rajan <dhabalia.me@gmail.com>
Date:   Mon Oct 17 12:35:08 2016 -0700

    Reduce Dispatcher-totalPermits by number of messages delivered in batch (#67)

 .../com/yahoo/pulsar/broker/service/Consumer.java  | 16 ++++++++++-----
 .../PersistentDispatcherMultipleConsumers.java     | 23 ++++++++++++----------
 .../PersistentDispatcherSingleActiveConsumer.java  |  2 +-
 3 files changed, 25 insertions(+), 16 deletions(-)

commit bd49d6997662bfe155acad549d2fe9942a33643b
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 14 11:08:22 2016 -0700

    Include pulsar-checksum in pulsar-client shaded jar (#65)

 pulsar-client/pom.xml | 9 +++++++++
 1 file changed, 9 insertions(+)

commit 050ecd11c48a15598f78f209d25f7ab31a8b4a4d
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Sat Oct 15 02:15:48 2016 +0900

    Use threadsafe formatter (#64)
    
    * Use thread safe datetime formatter
    
    This closes #62
    
    * Organize import lines

 .../pulsar/broker/admin/PersistentTopics.java      | 38 ++++++++--------
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  4 +-
 .../com/yahoo/pulsar/broker/service/Producer.java  |  8 ++--
 .../broker/service/persistent/PersistentTopic.java | 53 +++++++++++-----------
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java | 13 +++---
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |  8 ++--
 6 files changed, 64 insertions(+), 60 deletions(-)

commit 1304d4b44d74f62a76eab35f0a11060a87303448
Author: Rajan <dhabalia.me@gmail.com>
Date:   Thu Oct 13 11:45:02 2016 -0700

    Add admin-interface(REST/CLI) to expire messages for topic (#59)

 .../pulsar/broker/admin/PersistentTopics.java      |  86 +++++++++++++++
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    | 118 +++++++++++++++++++++
 .../pulsar/client/admin/PersistentTopics.java      |  52 +++++++++
 .../admin/internal/PersistentTopicsImpl.java       |  45 +++++++-
 .../pulsar/admin/cli/CmdPersistentTopics.java      |  36 +++++++
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   6 ++
 6 files changed, 342 insertions(+), 1 deletion(-)

commit e85a1c3706325a3f45226edf6fbfa46c919994a1
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 11 13:42:11 2016 -0700

    Print current running unit test in pulsar-broker (#57)

 pulsar-broker/src/test/resources/log4j.properties | 2 ++
 1 file changed, 2 insertions(+)

commit 309d7531c3a130999301bd43bed12f001a638c8e
Author: Rajan <rajan.sjsu@gmail.com>
Date:   Tue Oct 11 11:41:09 2016 -0700

    Add crc32c-checksum verification on message header-payload (#43)

 .../com/yahoo/pulsar/broker/service/Consumer.java  |   7 +
 .../com/yahoo/pulsar/broker/service/Producer.java  |  58 +++---
 .../broker/service/PersistentTopicE2ETest.java     |   7 +-
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |   3 +-
 .../client/api/SimpleProducerConsumerTest.java     |  38 ++++
 .../yahoo/pulsar/client/impl/MessageIdTest.java    | 215 ++++++++++++++++++++-
 .../pulsar/checksum/utils/Crc32cChecksum.java      |  15 +-
 .../pulsar/client/api/PulsarClientException.java   |   6 +
 .../pulsar/client/impl/BatchMessageContainer.java  |   7 -
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |  12 +-
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |  51 +++--
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java | 210 +++++++++++++++++++-
 pulsar-common/pom.xml                              |   1 -
 .../java/com/yahoo/pulsar/common/api/Commands.java |  87 +++++++--
 .../com/yahoo/pulsar/common/api/DoubleByteBuf.java |   8 +
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   |  75 ++-----
 .../yahoo/pulsar/common/util/XXHashChecksum.java   |  37 ----
 pulsar-common/src/main/proto/PulsarApi.proto       |   7 +-
 .../pulsar/common/compression/CommandsTest.java    |  95 +++++++++
 .../common/compression/Crc32cChecksumTest.java     |   1 -
 20 files changed, 723 insertions(+), 217 deletions(-)

commit 7892754abdb3b9a359a9950069182ec5ae0aec09
Author: Matteo Merli <mmerli@apache.org>
Date:   Tue Oct 11 10:48:13 2016 -0700

    Ensure importing of GPG keys in travis build doesn't get stuck on confirmation prompt (#56)

 .travis.yml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

commit 95b82399870d7f78485df95c65ea859283410352
Author: Rajan <rajan.sjsu@gmail.com>
Date:   Tue Oct 11 09:20:08 2016 -0700

    Add unack-message threshold to restrict consumer for receiving messages without acknowledging-msg up to the threshold (#48)

 conf/broker.conf                                   |   5 +
 conf/standalone.conf                               |   5 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |  12 +
 .../com/yahoo/pulsar/broker/service/Consumer.java  |  84 +++-
 .../PersistentDispatcherMultipleConsumers.java     |  44 +-
 .../broker/service/persistent/PersistentTopic.java |   6 +-
 .../PersistentDispatcherFailoverConsumerTest.java  |   6 +-
 .../pulsar/broker/service/PersistentTopicTest.java |   6 +-
 .../client/api/SimpleProducerConsumerTest.java     | 540 +++++++++++++++++++++
 .../pulsar/common/policies/data/ConsumerStats.java |   4 +
 10 files changed, 686 insertions(+), 26 deletions(-)

commit cc7c80758a8fe850a761d7f88f505b598bedd329
Author: h3nng <ruihenng@gmail.com>
Date:   Mon Oct 10 07:06:46 2016 +0800

    Synchronized  'consumers' in PulsarClientImpl during cleanup (#54)

 .../src/main/java/com/yahoo/pulsar/client/impl/PulsarClientImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 0fa6701583e7af6b60b63f66fefb45160b57a065
Author: Matteo Merli <mmerli@apache.org>
Date:   Fri Oct 7 16:57:42 2016 -0700

    Deploy artifacts to OSS sonatype and github release page (#53)

 .travis.yml          | 29 +++++++++++++++++++++++++++++
 .travis/settings.xml | 39 +++++++++++++++++++++++++++++++++++++++
 2 files changed, 68 insertions(+)

commit bb357161d4f091aa17dc4f32f9a16f72324a9d0b
Author: Rajan <rajan.sjsu@gmail.com>
Date:   Fri Oct 7 10:17:25 2016 -0700

    Accept received-msg-ack from different consumer than received-consumer on shared-subscription (#52)

 .../com/yahoo/pulsar/broker/service/Consumer.java  | 21 ++++++-
 .../client/api/SimpleProducerConsumerTest.java     | 69 ++++++++++++++++++++++
 2 files changed, 89 insertions(+), 1 deletion(-)

commit f5260160c96b1c2b813e442c6382c35ab2c08df3
Author: Siddharth Boobna <siddharth.boobna@gmail.com>
Date:   Wed Oct 5 21:05:18 2016 -0700

    Handle concurrent open cursor requests (#50)

 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java | 29 ++++++++++-
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java | 59 ++++++++++++++++++++++
 2 files changed, 86 insertions(+), 2 deletions(-)

commit adb461c9569c222a4950d6a4c486d00f47c1760d
Author: Rajan Dhabalia <rajan.sjsu@gmail.com>
Date:   Fri Sep 30 10:08:41 2016 -0700

    Fix incremental checksum computation for crc (#49)

 pulsar-checksum/src/main/circe/include/int_types.h | 12 +++--
 .../com/scurrilous/circe/crc/ReflectedIntCrc.java  |  6 ++-
 .../pulsar/checksum/utils/Crc32cChecksum.java      | 15 +++++-
 .../java/com/scurrilous/circe/crc/CRCTest.java     | 19 +++++++-
 .../common/compression/Crc32cChecksumTest.java     | 56 ++++++++++++++++++++++
 5 files changed, 102 insertions(+), 6 deletions(-)

commit 16f156125c694cdd4dc72f08eec2587d8842d82f
Author: yush1ga <yushiga@yahoo-corp.jp>
Date:   Fri Sep 30 07:25:40 2016 +0900

    Revise null check of ServiceConfigureUtils (#47)

 .../main/java/com/yahoo/pulsar/broker/ServiceConfigurationUtils.java  | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

commit bfd6b08f7439ee448ffcf83fc027a95c6f87fb76
Author: Masakazu Kitajo <maskit@apache.org>
Date:   Fri Sep 30 07:25:30 2016 +0900

    Correct an invalid null check (#46)

 .../src/main/java/com/yahoo/pulsar/client/cli/PulsarClientTool.java    | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 554f0505fc424896d820d639252b28e0ec523526
Author: Rajan Dhabalia <rajan.sjsu@gmail.com>
Date:   Wed Sep 28 20:42:59 2016 -0700

    Add circe source code to checksum library (#44)

 NOTICE                                             |  10 +-
 pom.xml                                            |   6 +
 protobuf/LICENSE.protobuf.txt                      |  42 +++++
 pulsar-checksum/pom.xml                            |  33 +---
 .../java/com/scurrilous/circe/CommonHashes.java    | 188 +++++++++++++++++++
 .../src/main/java/com/scurrilous/circe/Hash.java   |  53 ++++++
 .../java/com/scurrilous/circe/HashParameters.java  |  30 +++
 .../java/com/scurrilous/circe/HashProvider.java    | 101 ++++++++++
 .../java/com/scurrilous/circe/HashProviders.java   | 125 +++++++++++++
 .../java/com/scurrilous/circe/HashSupport.java     | 179 ++++++++++++++++++
 .../src/main/java/com/scurrilous/circe/Hashes.java | 123 +++++++++++++
 .../com/scurrilous/circe/IncrementalIntHash.java   |  88 +++++++++
 .../com/scurrilous/circe/IncrementalLongHash.java  |  88 +++++++++
 .../java/com/scurrilous/circe/StatefulHash.java    | 171 +++++++++++++++++
 .../java/com/scurrilous/circe/StatefulIntHash.java |  31 ++++
 .../com/scurrilous/circe/StatefulLongHash.java     |  30 +++
 .../java/com/scurrilous/circe/StatelessHash.java   |  31 ++++
 .../com/scurrilous/circe/StatelessIntHash.java     |  77 ++++++++
 .../com/scurrilous/circe/StatelessLongHash.java    |  77 ++++++++
 .../com/scurrilous/circe/crc/AbstractIntCrc.java   |  64 +++++++
 .../com/scurrilous/circe/crc/AbstractLongCrc.java  |  64 +++++++
 .../java/com/scurrilous/circe/crc/JavaCrc32.java   | 103 +++++++++++
 .../com/scurrilous/circe/crc/NormalByteCrc.java    |  46 +++++
 .../com/scurrilous/circe/crc/NormalIntCrc.java     |  48 +++++
 .../com/scurrilous/circe/crc/NormalLongCrc.java    |  48 +++++
 .../com/scurrilous/circe/crc/ReflectedIntCrc.java  |  45 +++++
 .../com/scurrilous/circe/crc/ReflectedLongCrc.java |  45 +++++
 .../scurrilous/circe/crc/StandardCrcProvider.java  |  82 +++++++++
 .../com/scurrilous/circe/crc/package-info.java     |   9 +
 .../circe/impl/AbstractHashProvider.java           | 193 +++++++++++++++++++
 .../circe/impl/AbstractIncrementalIntHash.java     | 114 ++++++++++++
 .../circe/impl/AbstractIncrementalLongHash.java    | 114 ++++++++++++
 .../circe/impl/AbstractStatefulHash.java           | 132 +++++++++++++
 .../circe/impl/AbstractStatelessIntHash.java       |  79 ++++++++
 .../circe/impl/AbstractStatelessLongHash.java      |  79 ++++++++
 .../circe/impl/DirectByteBufferAccess.java         |  18 ++
 .../circe/impl/DirectByteBufferAccessLoader.java   |  49 +++++
 .../java/com/scurrilous/circe/impl/HashCache.java  |  44 +++++
 .../com/scurrilous/circe/impl/HashCacheLoader.java |  58 ++++++
 .../circe/impl/IncrementalIntStatefulHash.java     |  92 +++++++++
 .../circe/impl/IncrementalLongStatefulHash.java    |  92 +++++++++
 .../scurrilous/circe/impl/IntStatefulLongHash.java | 109 +++++++++++
 .../circe/impl/IntStatelessLongHash.java           |  80 ++++++++
 .../com/scurrilous/circe/impl/package-info.java    |   6 +
 .../java/com/scurrilous/circe/package-info.java    |   6 +
 .../com/scurrilous/circe/params/CrcParameters.java | 205 +++++++++++++++++++++
 .../circe/params/MurmurHash3Parameters.java        |  73 ++++++++
 .../circe/params/MurmurHash3Variant.java           |  52 ++++++
 .../circe/params/SimpleHashParameters.java         |  85 +++++++++
 .../circe/params/SipHash24Parameters.java          |  69 +++++++
 .../com/scurrilous/circe/params/package-info.java  |   5 +
 .../services/com.scurrilous.circe.HashProvider     |   1 +
 .../com/scurrilous/circe/CommonHashesTest.java     |  45 +++++
 .../com/scurrilous/circe/crc/CRCProvidersTest.java |  88 +++++++++
 .../java/com/scurrilous/circe/crc/CRCTest.java     | 163 ++++++++++++++++
 .../circe/impl/AbstractIncrementalIntHashTest.java | 147 +++++++++++++++
 .../impl/AbstractIncrementalLongHashTest.java      | 147 +++++++++++++++
 .../circe/impl/AbstractStatefulHashTest.java       | 193 +++++++++++++++++++
 .../circe/impl/AbstractStatelessIntHashTest.java   |  84 +++++++++
 .../circe/impl/AbstractStatelessLongHashTest.java  |  84 +++++++++
 60 files changed, 4713 insertions(+), 30 deletions(-)

commit 26671f61a9bd008f6eef62f56c1ace231d5fae60
Author: Rajan Dhabalia <rajan.sjsu@gmail.com>
Date:   Wed Sep 28 20:32:09 2016 -0700

    access individualDeletedMessages with thread-safe while filtering out replay-message (#45)

 .../apache/bookkeeper/mledger/impl/ManagedCursorImpl.java   | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

commit 0577fdaaad37f353af65e3eb90423c992c7b6975
Author: Rad Gruchalski <radek@gruchalski.com>
Date:   Tue Sep 27 23:01:25 2016 +0200

    WebService refactoring (#40)
    
    * Little WebService refactor, removing magic values, removing unnecessary argument in the constructor.

 .../com/yahoo/pulsar/broker/PulsarService.java     |  2 +-
 .../yahoo/pulsar/broker/web/PulsarWebResource.java |  2 +-
 .../com/yahoo/pulsar/broker/web/WebService.java    | 68 ++++++++++++----------
 3 files changed, 40 insertions(+), 32 deletions(-)

commit 577596e49e0a9650f7a09f523cffad8742375ab2
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Sep 27 10:38:10 2016 -0700

    Fixed logic of test PersistentTopicE2ETest.testMessageRedelivery
    
    Fixes #41

 .../broker/service/PersistentTopicE2ETest.java     | 63 +++++-----------------
 1 file changed, 13 insertions(+), 50 deletions(-)

commit 2203316517c43ae97f8c1426a7f2db9fa417eb17
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Mon Sep 26 17:34:57 2016 -0700

    Updated BK version to 4.3.1.41-yahoo

 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

commit 728091e17860acbca86ba4871d4a025276cf8d33
Author: Matteo Merli <mmerli@apache.org>
Date:   Mon Sep 26 17:33:38 2016 -0700

    Added log4j with info logs for pulsar-broker unit tests (#37)

 pulsar-broker/src/test/resources/log4j.properties | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

commit bea1087f7fb6c90520cfcfa32adf99c473e5b6d9
Author: Raj <rajan.sjsu@gmail.com>
Date:   Mon Sep 26 17:05:00 2016 -0700

    Fix msg-acknowledge counter at client-stats (#36)

 .../client/api/SimpleProducerConsumerStatTest.java  | 21 +++++++++++++++------
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java  | 21 ++++++++++++++-------
 .../com/yahoo/pulsar/client/impl/ConsumerStats.java | 19 -------------------
 .../pulsar/client/impl/ConsumerStatsDisabled.java   | 21 ---------------------
 4 files changed, 29 insertions(+), 53 deletions(-)

commit d7d51632274ffd7b9c32a762a23dd1b7f74d621d
Author: Raj <rajan.sjsu@gmail.com>
Date:   Mon Sep 26 15:14:55 2016 -0700

    Prevent message-replay of already acknowledged messages (#38)

 .../apache/bookkeeper/mledger/ManagedCursor.java   |  4 +-
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java | 36 ++++----
 .../mledger/impl/ManagedCursorContainerTest.java   |  4 +-
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  6 +-
 .../PersistentDispatcherMultipleConsumers.java     |  6 +-
 .../broker/service/PersistentTopicE2ETest.java     | 98 ++++++++++++++++++++++
 6 files changed, 128 insertions(+), 26 deletions(-)

commit 8df6b74fba977badb520c48156f37b7632ba90f5
Author: Rad Gruchalski <radek@gruchalski.com>
Date:   Mon Sep 26 23:49:26 2016 +0200

    Removes bindOnLocalhost=boolean. Adds bindAddress and advertisedAddress. (#26)
    
    Fixes #23

 .gitignore                                         |  2 +
 conf/broker.conf                                   |  7 +-
 conf/standalone.conf                               |  7 +-
 conf/websocket.conf                                |  4 +-
 .../yahoo/pulsar/broker/ServiceConfiguration.java  | 25 ++++++--
 .../pulsar/broker/ServiceConfigurationUtils.java   | 44 +++++++++++++
 .../com/yahoo/pulsar/broker/PulsarService.java     | 46 ++++++-------
 .../pulsar/broker/admin/PersistentTopics.java      |  2 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  6 +-
 .../pulsar/broker/namespace/NamespaceService.java  |  6 +-
 .../yahoo/pulsar/broker/service/BrokerService.java |  9 +--
 .../yahoo/pulsar/broker/service/PulsarStats.java   |  2 +-
 .../com/yahoo/pulsar/broker/web/WebService.java    |  2 +
 .../com/yahoo/pulsar/broker/SLAMonitoringTest.java | 16 ++---
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |  3 +-
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |  2 +-
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  6 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  2 +-
 .../loadbalance/SimpleLoadManagerImplTest.java     |  4 +-
 .../broker/namespace/OwnershipCacheTest.java       |  2 -
 .../broker/service/AdvertisedAddressTest.java      | 75 ++++++++++++++++++++++
 .../broker/service/BacklogQuotaManagerTest.java    |  1 -
 .../pulsar/broker/service/BrokerServiceTest.java   | 21 ++++--
 .../pulsar/broker/service/ReplicatorTestBase.java  |  3 -
 .../yahoo/pulsar/broker/web/WebServiceTest.java    |  6 +-
 .../configurations/pulsar_broker_test.conf         |  3 +-
 26 files changed, 223 insertions(+), 83 deletions(-)

commit 2d75e88269e35ed0e9959c2ad678bd349c605436
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 22 16:39:52 2016 -0700

    In managed ledger BK test, wait for background ledger roll-over to complete before shutting down (#35)
    
    Fixes #16: Intermittent test failure in ManagedLedgerBkTest.testConcurrentMarkDelete

 .../java/org/apache/bookkeeper/mledger/impl/ManagedLedgerBkTest.java   | 3 +++
 1 file changed, 3 insertions(+)

commit 997d8f621d6e500939e8fa0f748210e9b05be364
Author: Matteo Merli <mmerli@apache.org>
Date:   Thu Sep 22 11:44:58 2016 -0700

    Synchronized producer cleanup during close operation (#34)
    
    Fixes #33: Intermittent test failure on BacklogQuotaManagerTest.testAheadProducerOnHoldTimeout

 .../com/yahoo/pulsar/client/impl/ProducerImpl.java   | 20 ++++++++++++++------
 1 file changed, 14 insertions(+), 6 deletions(-)

commit 7d317bd3c325ffcfea17fd92c88cfe9a5b52ece1
Author: Raj <rajan.sjsu@gmail.com>
Date:   Thu Sep 22 09:48:34 2016 -0700

    While closing-topic: remove producer from set in separate thread than same set-iterator thread (#32)

 .../src/main/java/com/yahoo/pulsar/broker/service/Producer.java     | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

commit 4e1bde9ff5281b2f4e52acd29b0a32d9f6fe00bb
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 21 22:25:13 2016 -0700

    In unit tests, do ZK cache reloads in same thread, to avoid race conditions (#31)

 .../com/yahoo/pulsar/broker/PulsarService.java     |  6 +--
 .../broker/auth/MockedPulsarServiceBaseTest.java   |  7 ++++
 .../broker/auth/SameThreadOrderedSafeExecutor.java | 46 ++++++++++++++++++++++
 3 files changed, 56 insertions(+), 3 deletions(-)

commit afc771bdaf3a2742bb661f4030c9479c6290321d
Author: Matteo Merli <mmerli@apache.org>
Date:   Wed Sep 21 17:18:09 2016 -0700

    Status file path should not be required in configuration (#28)

 conf/broker.conf                                                        | 2 +-
 .../src/main/java/com/yahoo/pulsar/broker/ServiceConfiguration.java     | 1 -
 2 files changed, 1 insertion(+), 2 deletions(-)

commit 001ce0139a7800ed38eacd14fef50da5142a89d4
Author: yush1ga <yushiga@yahoo-corp.jp>
Date:   Thu Sep 22 02:49:32 2016 +0900

    amend some typographic errors in docs/Architecture.md and docs/Authentication.md (#30)

 docs/Architecture.md   | 14 +++++++-------
 docs/Authentication.md |  2 +-
 2 files changed, 8 insertions(+), 8 deletions(-)

commit b5d0ebb251eb4b3d868311cddf9be2ecfb6249f7
Author: Rad Gruchalski <radek@gruchalski.com>
Date:   Wed Sep 21 00:09:17 2016 +0200

    Fix the cluster setup instructions. (#21)

 docs/ClusterSetup.md | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)

commit de86ce9df5b0f337a59039c70f320b3d2393f755
Merge: d93b233a33 c2fc29f31a
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Tue Sep 20 11:57:45 2016 -0700

    Merge pull request #27 from rdhabalia/discTest
    
    Refactoring Discovery Service and Https support

commit c2fc29f31a60a1c7e6a19405577076ac53324445
Author: rdhabalia <rdhabalia@yahoo-inc.com>
Date:   Tue Sep 20 10:42:24 2016 -0700

    Fix: unit test cases of Discovery Service

 .../discovery/service/ZookeeperCacheLoader.java    |  42 ------
 .../DiscoveryServiceWebTest.java}                  |  50 ++++---
 .../service/server/DiscoveryServiceStarter.java    |   2 +-
 .../discovery/service/server/ServerManager.java    |   2 +-
 .../discovery/service/server/ServiceConfig.java    |   2 +-
 .../service/{ => web}/DiscoveryServiceServlet.java |   7 +-
 .../discovery/service/{ => web}/RestException.java |   2 +-
 .../service/{ => web}/ZookeeperCacheLoader.java    |   2 +-
 .../discovery/service/web/BaseZKStarterTest.java   |  68 ++++++++++
 .../DiscoveryServiceWebTest.java}                  | 149 ++++++++++-----------
 .../{ => web}/ZookeeperCacheLoaderTest.java        |  22 +--
 11 files changed, 192 insertions(+), 156 deletions(-)

commit de2c7ee82d354f7c04349ca848016facde6796df
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Sep 6 21:17:28 2016 -0700

    Refactoring of DiscoveryService

 .../discovery/service/DiscoveryServiceTest.java    |  21 +--
 .../discovery/service/ZookeeperCacheLoader.java    |   2 +-
 pulsar-discovery-service/pom.xml                   |   8 +
 .../pulsar/discovery/service/DiscoveryService.java | 145 ------------------
 .../discovery/service/DiscoveryServiceServlet.java | 159 ++++++++++++++++++++
 .../discovery/service/ZookeeperCacheLoader.java    | 150 ++++++++-----------
 .../service/server/DiscoveryServiceStarter.java    |  20 +--
 .../discovery/service/server/ServerManager.java    |  66 ++++----
 .../discovery/service/server/ServiceConfig.java    |   4 +-
 .../discovery/service/DiscoveryServiceTest.java    |  31 ++--
 .../service/ZookeeperCacheLoaderTest.java          |  23 ++-
 .../zookeeper/LocalZooKeeperConnectionService.java | 166 ---------------------
 12 files changed, 302 insertions(+), 493 deletions(-)

commit d93b233a338367376d04cc3a715dc71765ca7ba0
Author: Raj <rajan.sjsu@gmail.com>
Date:   Mon Sep 19 13:57:12 2016 -0700

    Replace Collections.sort(list) with list.sort() to support earlier jdk-version than jdk-1.8.0_20 (#24)
    
    Fixes #20

 .../bookkeeper/mledger/impl/EntryCacheDefaultEvictionPolicy.java  | 2 +-
 .../main/java/com/yahoo/pulsar/broker/admin/AdminResource.java    | 3 +--
 .../src/main/java/com/yahoo/pulsar/broker/admin/Namespaces.java   | 2 +-
 .../main/java/com/yahoo/pulsar/broker/admin/PersistentTopics.java | 2 +-
 .../src/main/java/com/yahoo/pulsar/broker/admin/Properties.java   | 2 +-
 .../java/com/yahoo/pulsar/broker/namespace/NamespaceService.java  | 2 +-
 .../persistent/PersistentDispatcherSingleActiveConsumer.java      | 2 +-
 .../test/java/com/yahoo/pulsar/broker/admin/NamespacesTest.java   | 6 +++---
 .../pulsar/common/util/collections/ConcurrentLongHashMapTest.java | 8 ++++----
 .../pulsar/common/util/collections/ConcurrentOpenHashMapTest.java | 8 ++++----
 .../pulsar/common/util/collections/ConcurrentOpenHashSetTest.java | 6 +++---
 11 files changed, 21 insertions(+), 22 deletions(-)

commit b2cbf4e852b5198843f38b59516fb86a7acc84a0
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Fri Sep 16 16:22:25 2016 -0700

    Fixed stats buffer rotation (#17)

 .../com/yahoo/pulsar/broker/admin/BrokerStats.java | 35 ++++++++--------------
 .../yahoo/pulsar/broker/service/BrokerService.java |  5 ++--
 .../yahoo/pulsar/broker/service/PulsarStats.java   | 32 ++++++++++++--------
 3 files changed, 35 insertions(+), 37 deletions(-)

commit 47a213c1b682565974c48a43dea139c521797436
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Thu Sep 15 10:57:29 2016 -0700

    Expose broker URLs in loadbalancer registration node (#11)

 .../com/yahoo/pulsar/broker/admin/BrokerStats.java |  2 +-
 .../pulsar/broker/loadbalance/LoadManager.java     |  2 +-
 .../broker/loadbalance/ResourceDescription.java    |  2 +-
 .../loadbalance/impl/PulsarLoadReportImpl.java     |  6 ++--
 .../impl/PulsarResourceDescription.java            |  2 +-
 .../impl/ResourceAvailabilityRanker.java           |  2 +-
 .../loadbalance/impl/SimpleLoadManagerImpl.java    | 20 ++++++-----
 .../yahoo/pulsar/broker/service/BrokerService.java |  2 +-
 .../yahoo/pulsar/broker/service/PulsarStats.java   |  2 +-
 .../broker/service/persistent/PersistentTopic.java |  2 +-
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |  2 +-
 .../broker/loadbalance/LoadBalancerTest.java       |  9 +++--
 .../loadbalance/SimpleLoadManagerImplTest.java     | 24 ++++++-------
 .../broker/service/PersistentTopicE2ETest.java     |  2 +-
 .../policies/data/loadbalancer}/BrokerUsage.java   |  2 +-
 .../policies/data/loadbalancer}/JvmUsage.java      |  2 +-
 .../policies/data/loadbalancer}/LoadReport.java    | 39 ++++++++++++++++++++--
 .../data/loadbalancer}/NamespaceBundleStats.java   |  2 +-
 .../NamespaceBundleStatsComparator.java            |  4 +--
 .../data/loadbalancer}/NamespaceUsage.java         |  2 +-
 .../data/loadbalancer}/ResourceUnitRanking.java    |  8 ++---
 .../policies/data/loadbalancer}/ResourceUsage.java |  2 +-
 .../data/loadbalancer}/SystemResourceUsage.java    |  4 +--
 23 files changed, 87 insertions(+), 57 deletions(-)

commit 5771aa419e4e5293b3fea1974592f3feb6865adf
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Tue Sep 13 15:26:37 2016 -0700

    [#7] Added Geo-Replication documentation (#10)

 docs/Documentation.md       |   1 +
 docs/GeoReplication.md      | 144 ++++++++++++++++++++++++++++++++++++++++++++
 docs/img/GeoReplication.png | Bin 0 -> 86141 bytes
 3 files changed, 145 insertions(+)

commit 167386b79f97673eed81061b36c84ed097241759
Author: MahdiZareie <MahdiZareie@users.noreply.github.com>
Date:   Tue Sep 13 23:45:37 2016 +0430

    specify require dependencies for python example (#14)
    
    the python example require websocket-client to be installed .

 docs/WebSocket.md | 1 +
 1 file changed, 1 insertion(+)

commit 25d65cb1256ce4f791b38bdfd5f5b93de76de411
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Mon Sep 12 18:46:07 2016 -0700

    Added configuration to upload binaries to maven-central (#6)

 pom.xml | 102 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++------
 1 file changed, 93 insertions(+), 9 deletions(-)

commit 47dbfdb43e30682649594800aab5d6cc8f2f81b0
Merge: 4f796e4308 ddd814ac6d
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Mon Sep 12 12:37:41 2016 -0700

    Merge pull request #9 from merlimat/master
    
    Fixed more test that were flickering on the Travis CI build

commit ddd814ac6dc116b5917cf32ff89b6c30716d7200
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Mon Sep 12 09:34:23 2016 -0700

    Removed flickering part of getBundles test

 .../java/com/yahoo/pulsar/broker/admin/NamespacesTest.java     | 10 ----------
 1 file changed, 10 deletions(-)

commit 39b74071365fbdb5394b74eca56be6e3ab21f2a2
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Mon Sep 12 00:30:18 2016 -0700

    Added better error reporting in PulsarClientToolTest

 .../com/yahoo/pulsar/client/cli/CmdConsume.java    |  5 ++--
 .../pulsar/client/cli/PulsarClientToolTest.java    | 29 ++++++++++------------
 2 files changed, 16 insertions(+), 18 deletions(-)

commit bd18ebc825923b000d1e52248859452fe224a2c4
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Sun Sep 11 23:29:22 2016 -0700

    Made ServerCnx timeout test to execute all steps in same thread

 .../yahoo/pulsar/broker/service/ServerCnxTest.java | 108 ++++++++-------------
 1 file changed, 38 insertions(+), 70 deletions(-)

commit 0c4116a443ddaddca7527e06bcfc40aba1da48ae
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Sun Sep 11 18:45:26 2016 -0700

    Disabled payload corruption test

 .../java/com/yahoo/pulsar/broker/service/PersistentTopicE2ETest.java   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

commit 020a073dae2a31f389e1ea773e1cb0239a425b1a
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Sat Sep 10 11:45:58 2016 -0700

    Disable Jacoco coverage on every build

 pom.xml | 99 +++++++++++++++++++++++++++++++++++------------------------------
 1 file changed, 54 insertions(+), 45 deletions(-)

commit 4f796e43082490fb65f38c2fed78c2824366db99
Merge: d913f714f4 d522fbfec8
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Fri Sep 9 18:48:59 2016 -0700

    Merge pull request #3 from merlimat/master
    
    Fixed ZookeeperCacheTest failures on Travis build

commit d522fbfec8f27f1c2784ce491ed04d73e6d9c209
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Fri Sep 9 18:00:18 2016 -0700

    Made ServerCnxTest.testSubscribeTimeout more resilient

 .../yahoo/pulsar/broker/service/ServerCnxTest.java | 42 +++++++++++-----------
 1 file changed, 22 insertions(+), 20 deletions(-)

commit c68e8bc28b8f0cad3b32836f14dfbbd20b6dd4ba
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Thu Sep 8 23:00:15 2016 -0700

    Run ZookeeperCacheTest with MockZK event in same thread to avoid race conditions

 .../test/java/org/apache/zookeeper/MockZooKeeper.java   | 14 +++++++++++---
 .../pulsar/broker/auth/MockedPulsarServiceBaseTest.java |  3 ++-
 .../com/yahoo/pulsar/broker/service/ServerCnxTest.java  | 17 ++++++++++++++++-
 .../com/yahoo/pulsar/zookeeper/ZookeeperCacheTest.java  |  4 +++-
 4 files changed, 32 insertions(+), 6 deletions(-)

commit 9f7461cd0b230dc89f776435989cd31147234538
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Thu Sep 8 10:34:32 2016 -0700

    Mocked timeout tests failing on slower build machine

 .../pulsar/broker/admin/PersistentTopics.java      |   7 +-
 .../yahoo/pulsar/broker/service/BrokerService.java |   8 +-
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |  13 ++-
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |   4 +-
 .../broker/service/PersistentTopicE2ETest.java     |   7 +-
 .../yahoo/pulsar/broker/service/ServerCnxTest.java | 118 +++++++++++++++++++--
 .../yahoo/pulsar/client/api/ClientErrorsTest.java  |  10 +-
 7 files changed, 139 insertions(+), 28 deletions(-)

commit f09d57987aeabaecd159e2e4709e3a92e951c47f
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Wed Sep 7 17:14:00 2016 -0700

    Invalid ZK cache after updating property and cluster metadata

 .../main/java/com/yahoo/pulsar/broker/admin/Clusters.java   |  9 ++++++---
 .../main/java/com/yahoo/pulsar/broker/admin/Properties.java |  4 +++-
 .../test/java/com/yahoo/pulsar/broker/admin/AdminTest.java  | 13 +++++++++++++
 3 files changed, 22 insertions(+), 4 deletions(-)

commit 7edf572856c21dd181f9d1ba2c4bd295957af936
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Wed Sep 7 16:39:13 2016 -0700

    Fixed ZookeeperCacheTest failures on Travis build

 .../src/test/java/com/yahoo/pulsar/zookeeper/ZookeeperCacheTest.java    | 2 --
 1 file changed, 2 deletions(-)

commit d913f714f4fc520b8ed8a7027925228e46af8395
Author: Jeremy Gailor <JGailor@users.noreply.github.com>
Date:   Thu Sep 8 14:36:52 2016 -0700

    Explicitly calling out the need to close the client in both the producer and consumer (#4)

 docs/GettingStarted.md | 4 ++++
 1 file changed, 4 insertions(+)

commit d876f7506b11c84de5e6fcc860f053868202d809
Merge: e7579991e1 94b941a41e
Author: Matteo Merli <matteo.merli@gmail.com>
Date:   Wed Sep 7 16:03:07 2016 -0700

    Merge pull request #2 from merlimat/master
    
    Configure Travis CI build

commit 94b941a41e96dd0e7e72982217836c8b545d65da
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Wed Sep 7 15:32:03 2016 -0700

    Fixed ZookeeperCacheTest timing dependent failures

 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java | 67 +++++++++-------------
 1 file changed, 28 insertions(+), 39 deletions(-)

commit 171a993f59894ffd8bee5178c69456af571fc005
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Wed Sep 7 12:38:34 2016 -0700

    Fixed concurrent tests intermittently failing

 .../mledger/impl/ManagedCursorConcurrencyTest.java | 114 +++++++++------------
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |   7 +-
 2 files changed, 56 insertions(+), 65 deletions(-)

commit d79c33f22ab12e67d9c895056c5238a34e338561
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Wed Sep 7 11:50:37 2016 -0700

    Configure Travis CI build

 .travis.yml | 8 ++++++++
 1 file changed, 8 insertions(+)

commit e7579991e1c3949cbf3f5b64d9fa025f8fe7f763
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Wed Sep 7 10:39:05 2016 -0700

    Added link to announcent blog post in README

 README.md | 1 +
 1 file changed, 1 insertion(+)

commit a5f9aba54ab97bd9d0f3b08886d9b045b4235836
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Sep 6 22:12:54 2016 -0700

    Set version to 1.15-SNAPSHOT

 all/pom.xml                      | 2 +-
 managed-ledger/pom.xml           | 2 +-
 pom.xml                          | 2 +-
 pulsar-broker-common/pom.xml     | 2 +-
 pulsar-broker/pom.xml            | 2 +-
 pulsar-checksum/pom.xml          | 2 +-
 pulsar-client-admin/pom.xml      | 2 +-
 pulsar-client-tools/pom.xml      | 2 +-
 pulsar-client/pom.xml            | 2 +-
 pulsar-common/pom.xml            | 2 +-
 pulsar-discovery-service/pom.xml | 2 +-
 pulsar-storm/pom.xml             | 2 +-
 pulsar-testclient/pom.xml        | 2 +-
 pulsar-websocket/pom.xml         | 2 +-
 pulsar-zookeeper-utils/pom.xml   | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

commit 9f849c324969e160f9891203b2a2e4805fae5a1c
Author: Matteo Merli <mmerli@yahoo-inc.com>
Date:   Tue Sep 6 22:10:37 2016 -0700

    Initial import

 .github/ISSUE_TEMPLATE.md                          |    14 +
 .github/PULL_REQUEST_TEMPLATE.md                   |    12 +
 .gitignore                                         |    27 +
 CONTRIBUTORS.md                                    |    34 +
 LICENSE                                            |   202 +
 NOTICE                                             |    28 +
 README.md                                          |    42 +
 all/pom.xml                                        |    89 +
 all/src/assemble/bin.xml                           |    66 +
 all/src/assemble/src.xml                           |    65 +
 bin/bookkeeper                                     |   198 +
 bin/pulsar                                         |   218 +
 bin/pulsar-admin                                   |   105 +
 bin/pulsar-client                                  |   105 +
 bin/pulsar-daemon                                  |   188 +
 bin/pulsar-perf                                    |   144 +
 conf/bkenv.sh                                      |    51 +
 conf/bookkeeper.conf                               |   305 +
 conf/broker.conf                                   |   279 +
 conf/client.conf                                   |    23 +
 conf/discovery.conf                                |    35 +
 conf/global_zookeeper.conf                         |    42 +
 conf/log4j.properties                              |    68 +
 conf/log4j.shell.properties                        |    36 +
 conf/pulsar_env.sh                                 |    57 +
 conf/standalone.conf                               |   249 +
 conf/websocket.conf                                |    44 +
 conf/zookeeper.conf                                |    42 +
 docs/AdminTools.md                                 |  2197 +++
 docs/Architecture.md                               |   324 +
 docs/Authentication.md                             |   154 +
 docs/Authorization.md                              |    77 +
 docs/ClusterSetup.md                               |   344 +
 docs/Documentation.md                              |    12 +
 docs/GettingStarted.md                             |   140 +
 docs/PulsarStorm.md                                |   107 +
 docs/WebSocket.md                                  |   269 +
 docs/img/pulsar_partitioned_topic.jpg              |   Bin 0 -> 73437 bytes
 docs/img/pulsar_subscriptions.jpg                  |   Bin 0 -> 40837 bytes
 docs/img/pulsar_system_architecture.png            |   Bin 0 -> 309560 bytes
 managed-ledger/.gitignore                          |     8 +
 managed-ledger/LICENSE                             |    11 +
 managed-ledger/pom.xml                             |    97 +
 .../apache/bookkeeper/mledger/AsyncCallbacks.java  |   113 +
 .../java/org/apache/bookkeeper/mledger/Entry.java  |    54 +
 .../apache/bookkeeper/mledger/ManagedCursor.java   |   418 +
 .../apache/bookkeeper/mledger/ManagedLedger.java   |   285 +
 .../bookkeeper/mledger/ManagedLedgerConfig.java    |   350 +
 .../bookkeeper/mledger/ManagedLedgerException.java |    83 +
 .../bookkeeper/mledger/ManagedLedgerFactory.java   |    88 +
 .../mledger/ManagedLedgerFactoryConfig.java        |    53 +
 .../mledger/ManagedLedgerFactoryMXBean.java        |    61 +
 .../bookkeeper/mledger/ManagedLedgerMXBean.java    |    99 +
 .../org/apache/bookkeeper/mledger/Position.java    |    32 +
 .../apache/bookkeeper/mledger/impl/EntryCache.java |   119 +
 .../impl/EntryCacheDefaultEvictionPolicy.java      |    97 +
 .../mledger/impl/EntryCacheEvictionPolicy.java     |    34 +
 .../bookkeeper/mledger/impl/EntryCacheImpl.java    |   313 +
 .../bookkeeper/mledger/impl/EntryCacheManager.java |   234 +
 .../apache/bookkeeper/mledger/impl/EntryImpl.java  |   103 +
 .../mledger/impl/ManagedCursorContainer.java       |   297 +
 .../bookkeeper/mledger/impl/ManagedCursorImpl.java |  2054 +++
 .../mledger/impl/ManagedLedgerFactoryImpl.java     |   314 +
 .../impl/ManagedLedgerFactoryMBeanImpl.java        |   101 +
 .../bookkeeper/mledger/impl/ManagedLedgerImpl.java |  1957 +++
 .../mledger/impl/ManagedLedgerMBeanImpl.java       |   274 +
 .../mledger/impl/ManagedLedgerOfflineBacklog.java  |   459 +
 .../apache/bookkeeper/mledger/impl/MetaStore.java  |   133 +
 .../mledger/impl/MetaStoreImplZookeeper.java       |   326 +
 .../apache/bookkeeper/mledger/impl/OpAddEntry.java |   219 +
 .../bookkeeper/mledger/impl/OpFindNewest.java      |   122 +
 .../bookkeeper/mledger/impl/OpReadEntry.java       |   160 +
 .../bookkeeper/mledger/impl/PositionImpl.java      |   133 +
 .../bookkeeper/mledger/proto/MLDataFormats.java    |  2049 +++
 .../mledger/proto/PendingBookieOpsStats.java       |    14 +
 .../bookkeeper/mledger/util/CallbackMutex.java     |    71 +
 .../apache/bookkeeper/mledger/util/Futures.java    |    60 +
 .../org/apache/bookkeeper/mledger/util/Pair.java   |    48 +
 .../apache/bookkeeper/mledger/util/RangeCache.java |   227 +
 .../org/apache/bookkeeper/mledger/util/Rate.java   |    80 +
 .../bookkeeper/mledger/util/ReferenceCounted.java  |    22 +
 .../apache/bookkeeper/mledger/util/SafeRun.java    |    52 +
 .../bookkeeper/mledger/util/StatsBuckets.java      |   103 +
 managed-ledger/src/main/proto/MLDataFormats.proto  |    43 +
 .../bookkeeper/client/BookKeeperTestClient.java    |    49 +
 .../apache/bookkeeper/client/MockBookKeeper.java   |   269 +
 .../apache/bookkeeper/client/MockLedgerEntry.java  |    66 +
 .../apache/bookkeeper/client/MockLedgerHandle.java |   223 +
 .../bookkeeper/mledger/SimpleBookKeeperTest.java   |    64 +
 .../mledger/impl/EntryCacheManagerTest.java        |   271 +
 .../bookkeeper/mledger/impl/EntryCacheTest.java    |   272 +
 .../mledger/impl/ManagedCursorConcurrencyTest.java |   450 +
 .../mledger/impl/ManagedCursorContainerTest.java   |   507 +
 .../bookkeeper/mledger/impl/ManagedCursorTest.java |  2282 +++
 .../mledger/impl/ManagedLedgerBkTest.java          |   426 +
 .../mledger/impl/ManagedLedgerErrorsTest.java      |   527 +
 .../mledger/impl/ManagedLedgerMBeanTest.java       |   134 +
 .../impl/ManagedLedgerSingleBookieTest.java        |    76 +
 .../bookkeeper/mledger/impl/ManagedLedgerTest.java |  2077 +++
 .../mledger/impl/MetaStoreImplZookeeperTest.java   |   215 +
 .../bookkeeper/mledger/impl/PositionTest.java      |    79 +
 .../bookkeeper/mledger/util/CallbackMutexTest.java |   140 +
 .../apache/bookkeeper/mledger/util/PairTest.java   |    47 +
 .../bookkeeper/mledger/util/RangeCacheTest.java    |   249 +
 .../bookkeeper/mledger/util/TestStatsBuckets.java  |    99 +
 .../bookkeeper/test/BookKeeperClusterTestCase.java |   513 +
 .../bookkeeper/test/MockedBookKeeperTestCase.java  |   113 +
 .../org/apache/bookkeeper/test/PortManager.java    |    51 +
 .../org/apache/bookkeeper/test/ZooKeeperUtil.java  |   156 +
 .../java/org/apache/zookeeper/MockZooKeeper.java   |   701 +
 managed-ledger/src/test/resources/log4j.properties |    57 +
 pom.xml                                            |   607 +
 protobuf/README.md                                 |    33 +
 protobuf/protobuf.patch                            |   256 +
 pulsar-broker-common/pom.xml                       |    55 +
 .../java/com/yahoo/pulsar/broker/FieldContext.java |    59 +
 .../yahoo/pulsar/broker/PulsarServerException.java |    35 +
 .../yahoo/pulsar/broker/ServiceConfiguration.java  |   913 ++
 .../pulsar/broker/ServiceConfigurationLoader.java  |   119 +
 .../authentication/AuthenticationDataCommand.java  |    85 +
 .../authentication/AuthenticationDataHttp.java     |    69 +
 .../authentication/AuthenticationDataHttps.java    |    45 +
 .../authentication/AuthenticationDataSource.java   |   117 +
 .../authentication/AuthenticationProvider.java     |    56 +
 .../authentication/AuthenticationProviderTls.java  |    89 +
 .../authentication/AuthenticationService.java      |   102 +
 .../broker/authorization/AuthorizationManager.java |   144 +
 .../broker/cache/ConfigurationCacheService.java    |   144 +
 pulsar-broker/pom.xml                              |   265 +
 .../java/com/yahoo/pulsar/PulsarBrokerStarter.java |    71 +
 .../yahoo/pulsar/PulsarClusterMetadataSetup.java   |   121 +
 .../com/yahoo/pulsar/PulsarStandaloneStarter.java  |   177 +
 .../pulsar/broker/BookKeeperClientFactory.java     |    28 +
 .../pulsar/broker/BookKeeperClientFactoryImpl.java |    84 +
 .../pulsar/broker/ManagedLedgerClientFactory.java  |    63 +
 .../broker/MessagingServiceShutdownHook.java       |   115 +
 .../com/yahoo/pulsar/broker/PulsarService.java     |   632 +
 .../yahoo/pulsar/broker/admin/AdminResource.java   |   297 +
 .../com/yahoo/pulsar/broker/admin/BrokerStats.java |   188 +
 .../com/yahoo/pulsar/broker/admin/Brokers.java     |    82 +
 .../com/yahoo/pulsar/broker/admin/Clusters.java    |   373 +
 .../com/yahoo/pulsar/broker/admin/Namespaces.java  |  1316 ++
 .../pulsar/broker/admin/PersistentTopics.java      |   952 ++
 .../com/yahoo/pulsar/broker/admin/Properties.java  |   207 +
 .../yahoo/pulsar/broker/admin/ResourceQuotas.java  |   177 +
 .../broker/cache/LocalZooKeeperCacheService.java   |   169 +
 .../pulsar/broker/cache/ResourceQuotaCache.java    |   231 +
 .../pulsar/broker/loadbalance/BrokerHostUsage.java |    95 +
 .../pulsar/broker/loadbalance/LeaderBroker.java    |    62 +
 .../broker/loadbalance/LeaderElectionService.java  |   191 +
 .../pulsar/broker/loadbalance/LoadCalculator.java  |    28 +
 .../pulsar/broker/loadbalance/LoadManager.java     |    91 +
 .../pulsar/broker/loadbalance/LoadRanker.java      |    22 +
 .../pulsar/broker/loadbalance/LoadReport.java      |    32 +
 .../broker/loadbalance/LoadReportUpdaterTask.java  |    42 +
 .../loadbalance/LoadResourceQuotaUpdaterTask.java  |    42 +
 .../broker/loadbalance/LoadSheddingTask.java       |    42 +
 .../loadbalance/NamespaceBundleSplitTask.java      |    42 +
 .../broker/loadbalance/PlacementStrategy.java      |    24 +
 .../broker/loadbalance/ResourceDescription.java    |    35 +
 .../pulsar/broker/loadbalance/ResourceUnit.java    |    27 +
 .../pulsar/broker/loadbalance/ServiceRequest.java  |    20 +
 .../pulsar/broker/loadbalance/ServiceUnit.java     |    31 +
 .../broker/loadbalance/data/BrokerUsage.java       |    66 +
 .../pulsar/broker/loadbalance/data/JvmUsage.java   |    49 +
 .../pulsar/broker/loadbalance/data/LoadReport.java |   211 +
 .../loadbalance/data/NamespaceBundleStats.java     |   118 +
 .../data/NamespaceBundleStatsComparator.java       |    55 +
 .../broker/loadbalance/data/NamespaceUsage.java    |   199 +
 .../loadbalance/data/ResourceUnitRanking.java      |   276 +
 .../broker/loadbalance/data/ResourceUsage.java     |    59 +
 .../loadbalance/data/SystemResourceUsage.java      |    91 +
 .../loadbalance/impl/PulsarLoadReportImpl.java     |    85 +
 .../impl/PulsarResourceDescription.java            |   105 +
 .../loadbalance/impl/PulsarServiceRequest.java     |   111 +
 .../broker/loadbalance/impl/PulsarServiceUnit.java |    70 +
 .../impl/ResourceAvailabilityRanker.java           |    85 +
 .../loadbalance/impl/SimpleLoadCalculatorImpl.java |    48 +
 .../loadbalance/impl/SimpleLoadManagerImpl.java    |  1412 ++
 .../impl/SimpleResourceAllocationPolicies.java     |   113 +
 .../loadbalance/impl/SimpleResourceUnit.java       |    66 +
 .../loadbalance/impl/WRRPlacementStrategy.java     |    86 +
 .../pulsar/broker/lookup/DestinationLookup.java    |    80 +
 .../yahoo/pulsar/broker/lookup/LookupResource.java |    63 +
 .../yahoo/pulsar/broker/lookup/LookupResult.java   |    70 +
 .../yahoo/pulsar/broker/lookup/NamespaceData.java  |    28 +
 .../yahoo/pulsar/broker/lookup/RedirectData.java   |    28 +
 .../broker/namespace/NamespaceEphemeralData.java   |    68 +
 .../pulsar/broker/namespace/NamespaceService.java  |   743 +
 .../pulsar/broker/namespace/OwnedServiceUnit.java  |   129 +
 .../pulsar/broker/namespace/OwnershipCache.java    |   286 +
 .../broker/namespace/ServiceUnitZkUtils.java       |   227 +
 .../pulsar/broker/service/BacklogQuotaManager.java |   207 +
 .../yahoo/pulsar/broker/service/BrokerService.java |   829 ++
 .../broker/service/BrokerServiceException.java     |   119 +
 .../com/yahoo/pulsar/broker/service/Consumer.java  |   344 +
 .../yahoo/pulsar/broker/service/Dispatcher.java    |    46 +
 .../broker/service/DistributedIdGenerator.java     |    84 +
 .../com/yahoo/pulsar/broker/service/Producer.java  |   371 +
 .../broker/service/PulsarChannelInitializer.java   |    74 +
 .../yahoo/pulsar/broker/service/PulsarStats.java   |   184 +
 .../com/yahoo/pulsar/broker/service/ServerCnx.java |   681 +
 .../yahoo/pulsar/broker/service/Subscription.java  |    62 +
 .../com/yahoo/pulsar/broker/service/Topic.java     |    67 +
 .../PersistentDispatcherMultipleConsumers.java     |   366 +
 .../PersistentDispatcherSingleActiveConsumer.java  |   354 +
 .../persistent/PersistentMessageExpiryMonitor.java |   133 +
 .../persistent/PersistentMessageFinder.java        |   117 +
 .../service/persistent/PersistentReplicator.java   |   689 +
 .../service/persistent/PersistentSubscription.java |   590 +
 .../broker/service/persistent/PersistentTopic.java |  1177 ++
 .../broker/stats/AllocatorStatsGenerator.java      |   113 +
 .../broker/stats/BookieClientStatsGenerator.java   |    69 +
 .../broker/stats/BrokerOperabilityMetrics.java     |    76 +
 .../broker/stats/ClusterReplicationMetrics.java    |    83 +
 .../pulsar/broker/stats/MBeanStatsGenerator.java   |   116 +
 .../com/yahoo/pulsar/broker/stats/Metrics.java     |    99 +
 .../pulsar/broker/stats/MetricsGenerator.java      |    76 +
 .../yahoo/pulsar/broker/stats/NamespaceStats.java  |    79 +
 .../pulsar/broker/stats/ReplicationMetrics.java    |    81 +
 .../yahoo/pulsar/broker/stats/TopicLoadStats.java  |    66 +
 .../broker/stats/metrics/AbstractMetrics.java      |   246 +
 .../pulsar/broker/stats/metrics/JvmMetrics.java    |   148 +
 .../stats/metrics/ManagedLedgerCacheMetrics.java   |    94 +
 .../broker/stats/metrics/ManagedLedgerMetrics.java |   152 +
 .../yahoo/pulsar/broker/web/ApiVersionFilter.java  |   141 +
 .../pulsar/broker/web/AuthenticationFilter.java    |    80 +
 .../pulsar/broker/web/NoSwaggerDocumentation.java  |    20 +
 .../pulsar/broker/web/PulsarServerConnector.java   |    65 +
 .../yahoo/pulsar/broker/web/PulsarWebResource.java |   632 +
 .../com/yahoo/pulsar/broker/web/RestException.java |    58 +
 .../com/yahoo/pulsar/broker/web/VipStatus.java     |    45 +
 .../com/yahoo/pulsar/broker/web/WebService.java    |   215 +
 .../pulsar/common/naming/NamespaceBundle.java      |   133 +
 .../common/naming/NamespaceBundleFactory.java      |   247 +
 .../pulsar/common/naming/NamespaceBundles.java     |   135 +
 .../java/com/yahoo/pulsar/utils/CmdUtility.java    |    83 +
 .../yahoo/pulsar/utils/CopyOnWriteArrayList.java   |   122 +
 .../java/com/yahoo/pulsar/utils/NumberFormat.java  |    60 +
 .../com/yahoo/pulsar/utils/PulsarKeyException.java |    32 +
 .../com/yahoo/pulsar/utils/StatsOutputStream.java  |   200 +
 .../com/yahoo/pulsar/PulsarBrokerStarterTest.java  |   273 +
 .../com/yahoo/pulsar/broker/SLAMonitoringTest.java |   247 +
 .../yahoo/pulsar/broker/admin/AdminApiTest.java    |  1369 ++
 .../com/yahoo/pulsar/broker/admin/AdminTest.java   |   623 +
 .../pulsar/broker/admin/MockServletContext.java    |   330 +
 .../yahoo/pulsar/broker/admin/NamespacesTest.java  |  1110 ++
 .../broker/auth/AuthenticationServiceTest.java     |    87 +
 .../pulsar/broker/auth/AuthorizationTest.java      |   105 +
 .../broker/auth/MockedPulsarServiceBaseTest.java   |   202 +
 .../broker/cache/ResourceQuotaCacheTest.java       |    93 +
 .../broker/loadbalance/LoadBalancerTest.java       |   998 ++
 .../loadbalance/SimpleLoadManagerImplTest.java     |   488 +
 .../lookup/http/HttpDestinationLookupv2Test.java   |   172 +
 .../broker/namespace/NamespaceServiceTest.java     |   248 +
 .../broker/namespace/OwnershipCacheTest.java       |   310 +
 .../broker/service/BacklogQuotaManagerTest.java    |   608 +
 .../pulsar/broker/service/BatchMessageTest.java    |   594 +
 .../pulsar/broker/service/BrokerServiceTest.java   |   606 +
 .../pulsar/broker/service/BrokerTestBase.java      |    72 +
 .../broker/service/DistributedIdGeneratorTest.java |   124 +
 .../broker/service/MessageIdSerialization.java     |    53 +
 .../PersistentDispatcherFailoverConsumerTest.java  |   263 +
 .../broker/service/PersistentFailoverE2ETest.java  |   433 +
 .../service/PersistentMessageFinderTest.java       |   189 +
 .../broker/service/PersistentQueueE2ETest.java     |   512 +
 .../service/PersistentTopicConcurrentTest.java     |   347 +
 .../broker/service/PersistentTopicE2ETest.java     |  1070 ++
 .../pulsar/broker/service/PersistentTopicTest.java |   841 ++
 .../pulsar/broker/service/ReplicatorTest.java      |   569 +
 .../pulsar/broker/service/ReplicatorTestBase.java  |   351 +
 .../pulsar/broker/service/ResendRequestTest.java   |   714 +
 .../yahoo/pulsar/broker/service/ServerCnxTest.java |  1137 ++
 .../broker/service/utils/ClientChannelHelper.java  |   147 +
 .../stats/BookieClientsStatsGeneratorTest.java     |    52 +
 .../pulsar/broker/web/ApiVersionFilterTest.java    |   178 +
 .../yahoo/pulsar/broker/web/WebServiceTest.java    |   338 +
 .../ZooKeeperSessionExpireRecoveryTest.java        |    67 +
 .../yahoo/pulsar/client/api/ClientErrorsTest.java  |   625 +
 .../yahoo/pulsar/client/api/MockBrokerService.java |   387 +
 .../pulsar/client/api/MockBrokerServiceHooks.java  |    61 +
 .../api/PartitionedProducerConsumerTest.java       |   411 +
 .../pulsar/client/api/ProducerConsumerBase.java    |    54 +
 .../client/api/SimpleProducerConsumerStatTest.java |   338 +
 .../client/api/SimpleProducerConsumerTest.java     |   891 ++
 .../impl/BatchMessageIdImplSerializationTest.java  |    54 +
 .../client/impl/BrokerClientIntegrationTest.java   |   204 +
 .../yahoo/pulsar/client/impl/MessageIdTest.java    |   226 +
 .../impl/UnAcknowledgedMessagesTimeoutTest.java    |   410 +
 .../pulsar/client/impl/ZeroQueueSizeTest.java      |   258 +
 .../pulsar/common/naming/NamespaceBundleTest.java  |   196 +
 .../pulsar/common/naming/NamespaceBundlesTest.java |   278 +
 .../naming/ServiceConfigurationLoaderTest.java     |   137 +
 .../common/naming/ServiceConfigurationTest.java    |    87 +
 .../discovery/service/DiscoveryServiceTest.java    |   130 +
 .../discovery/service/ZookeeperCacheLoader.java    |    42 +
 .../stats/client/PulsarBrokerStatsClientTest.java  |    70 +
 .../yahoo/pulsar/utils/StatsOutputStreamTest.java  |   296 +
 .../proxy/MockAuthenticationProvider.java          |    51 +
 .../websocket/proxy/ProxyAuthenticationTest.java   |   108 +
 .../websocket/proxy/ProxyAuthorizationTest.java    |   122 +
 .../websocket/proxy/ProxyPublishConsumeTest.java   |   100 +
 .../websocket/proxy/ProxyPublishConsumeTls.java    |   128 +
 .../websocket/proxy/SimpleConsumerSocket.java      |    90 +
 .../websocket/proxy/SimpleProducerSocket.java      |    93 +
 .../java/org/testng/listener/TestListener.java     |    57 +
 .../src/test/resources/TestLoadReport.json         |    28 +
 .../src/test/resources/certificate/client.crt      |    20 +
 .../src/test/resources/certificate/client.csr      |    17 +
 .../src/test/resources/certificate/client.key      |    28 +
 .../src/test/resources/certificate/server.crt      |    20 +
 .../src/test/resources/certificate/server.csr      |    17 +
 .../src/test/resources/certificate/server.key      |    28 +
 .../configurations/pulsar_broker_test.conf         |    63 +
 pulsar-broker/src/test/resources/logback.xml       |    16 +
 .../resources/test-script-pulsar-broker-host-usage |     7 +
 pulsar-checksum/pom.xml                            |   193 +
 pulsar-checksum/src/main/assembly/assembly.xml     |    69 +
 .../src/main/circe/cpp/crc32c_sse42.cpp            |   217 +
 .../src/main/circe/cpp/crc32c_sse42_jni.cpp        |    78 +
 pulsar-checksum/src/main/circe/cpp/gf2.hpp         |   174 +
 .../src/main/circe/include/crc32c_sse42.hpp        |    40 +
 pulsar-checksum/src/main/circe/include/int_types.h |    37 +
 .../java/com/scurrilous/circe/crc/Sse42Crc32C.java |   129 +
 .../pulsar/checksum/utils/Crc32cChecksum.java      |    58 +
 .../pulsar/checksum/utils/Crc32cSse42Provider.java |    59 +
 .../yahoo/pulsar/checksum/utils/NativeUtils.java   |    98 +
 .../pulsar/checksum/utils/Crc32cChecksumTest.java  |    53 +
 .../pulsar/checksum/utils/NativeUtilsTests.java    |    44 +
 pulsar-client-admin/.gitignore                     |     1 +
 pulsar-client-admin/pom.xml                        |   139 +
 .../com/yahoo/pulsar/client/admin/BrokerStats.java |    60 +
 .../com/yahoo/pulsar/client/admin/Brokers.java     |    70 +
 .../com/yahoo/pulsar/client/admin/Clusters.java    |   264 +
 .../java/com/yahoo/pulsar/client/admin/Lookup.java |    31 +
 .../com/yahoo/pulsar/client/admin/Namespaces.java  |   762 +
 .../pulsar/client/admin/PersistentTopics.java      |   640 +
 .../com/yahoo/pulsar/client/admin/Properties.java  |   125 +
 .../com/yahoo/pulsar/client/admin/PulsarAdmin.java |   283 +
 .../pulsar/client/admin/PulsarAdminException.java  |   158 +
 .../yahoo/pulsar/client/admin/ResourceQuotas.java  |   197 +
 .../pulsar/client/admin/internal/BaseResource.java |   187 +
 .../client/admin/internal/BrokerStatsImpl.java     |   111 +
 .../pulsar/client/admin/internal/BrokersImpl.java  |    59 +
 .../pulsar/client/admin/internal/ClustersImpl.java |   138 +
 .../client/admin/internal/JacksonConfigurator.java |    40 +
 .../pulsar/client/admin/internal/LookupImpl.java   |    65 +
 .../client/admin/internal/NamespacesImpl.java      |   423 +
 .../admin/internal/PersistentTopicsImpl.java       |   540 +
 .../client/admin/internal/PropertiesImpl.java      |    88 +
 .../client/admin/internal/ResourceQuotasImpl.java  |    88 +
 pulsar-client-tools/pom.xml                        |   104 +
 .../com/yahoo/pulsar/admin/cli/CliCommand.java     |   137 +
 .../java/com/yahoo/pulsar/admin/cli/CmdBase.java   |    81 +
 .../com/yahoo/pulsar/admin/cli/CmdBrokerStats.java |   117 +
 .../com/yahoo/pulsar/admin/cli/CmdBrokers.java     |    56 +
 .../com/yahoo/pulsar/admin/cli/CmdClusters.java    |    99 +
 .../admin/cli/CmdNamespaceIsolationPolicy.java     |   196 +
 .../com/yahoo/pulsar/admin/cli/CmdNamespaces.java  |   530 +
 .../pulsar/admin/cli/CmdPersistentTopics.java      |   380 +
 .../com/yahoo/pulsar/admin/cli/CmdProperties.java  |   111 +
 .../yahoo/pulsar/admin/cli/CmdResourceQuotas.java  |   129 +
 .../yahoo/pulsar/admin/cli/PulsarAdminTool.java    |   135 +
 .../com/yahoo/pulsar/admin/cli/utils/IOUtils.java  |    79 +
 .../cli/utils/NameValueParameterSplitter.java      |    59 +
 .../com/yahoo/pulsar/client/cli/CmdConsume.java    |   158 +
 .../com/yahoo/pulsar/client/cli/CmdProduce.java    |   194 +
 .../yahoo/pulsar/client/cli/PulsarClientTool.java  |   163 +
 .../pulsar/admin/cli/PulsarAdminToolTest.java      |   407 +
 .../yahoo/pulsar/admin/cli/utils/IOUtilsTest.java  |   143 +
 .../cli/utils/NameValueParameterSplitterTest.java  |    51 +
 .../pulsar/client/cli/PulsarClientToolTest.java    |    85 +
 pulsar-client-tools/src/test/resources/localtest   |     2 +
 pulsar-client/pom.xml                              |   183 +
 .../yahoo/pulsar/client/api/Authentication.java    |    50 +
 .../client/api/AuthenticationDataProvider.java     |   107 +
 .../pulsar/client/api/AuthenticationFactory.java   |    78 +
 .../pulsar/client/api/ClientConfiguration.java     |   312 +
 .../yahoo/pulsar/client/api/CompressionType.java   |    27 +
 .../java/com/yahoo/pulsar/client/api/Consumer.java |   234 +
 .../pulsar/client/api/ConsumerConfiguration.java   |   174 +
 .../java/com/yahoo/pulsar/client/api/Message.java  |    89 +
 .../yahoo/pulsar/client/api/MessageBuilder.java    |   108 +
 .../com/yahoo/pulsar/client/api/MessageId.java     |    47 +
 .../yahoo/pulsar/client/api/MessageListener.java   |    41 +
 .../com/yahoo/pulsar/client/api/MessageRouter.java |    30 +
 .../java/com/yahoo/pulsar/client/api/Producer.java |   139 +
 .../pulsar/client/api/ProducerConfiguration.java   |   306 +
 .../com/yahoo/pulsar/client/api/PulsarClient.java  |   192 +
 .../pulsar/client/api/PulsarClientException.java   |   166 +
 .../yahoo/pulsar/client/api/SubscriptionType.java  |    40 +
 .../java/com/yahoo/pulsar/client/impl/Backoff.java |    72 +
 .../pulsar/client/impl/BatchMessageContainer.java  |   151 +
 .../pulsar/client/impl/BatchMessageIdImpl.java     |    75 +
 .../com/yahoo/pulsar/client/impl/ClientCnx.java    |   321 +
 .../yahoo/pulsar/client/impl/ConnectionPool.java   |   181 +
 .../com/yahoo/pulsar/client/impl/ConsumerBase.java |   324 +
 .../com/yahoo/pulsar/client/impl/ConsumerId.java   |    58 +
 .../com/yahoo/pulsar/client/impl/ConsumerImpl.java |   891 ++
 .../yahoo/pulsar/client/impl/ConsumerStats.java    |   258 +
 .../pulsar/client/impl/ConsumerStatsDisabled.java  |    64 +
 .../com/yahoo/pulsar/client/impl/HandlerBase.java  |   159 +
 .../com/yahoo/pulsar/client/impl/HttpClient.java   |   204 +
 .../yahoo/pulsar/client/impl/LookupService.java    |    59 +
 .../pulsar/client/impl/MessageBuilderImpl.java     |    97 +
 .../yahoo/pulsar/client/impl/MessageIdImpl.java    |   147 +
 .../com/yahoo/pulsar/client/impl/MessageImpl.java  |   250 +
 .../impl/PartitionMetadataLookupService.java       |    35 +
 .../client/impl/PartitionedConsumerImpl.java       |   421 +
 .../client/impl/PartitionedProducerImpl.java       |   194 +
 .../com/yahoo/pulsar/client/impl/ProducerBase.java |   105 +
 .../com/yahoo/pulsar/client/impl/ProducerImpl.java |   925 ++
 .../yahoo/pulsar/client/impl/ProducerStats.java    |   245 +
 .../pulsar/client/impl/ProducerStatsDisabled.java  |    41 +
 .../yahoo/pulsar/client/impl/PulsarClientImpl.java |   425 +
 .../impl/RoundRobinPartitionMessageRouterImpl.java |    41 +
 .../com/yahoo/pulsar/client/impl/SendCallback.java |    53 +
 .../impl/SinglePartitionMessageRouterImpl.java     |    43 +
 .../pulsar/client/impl/UnAckedMessageTracker.java  |   154 +
 .../client/impl/auth/AuthenticationDataNull.java   |    22 +
 .../client/impl/auth/AuthenticationDataTls.java    |    60 +
 .../client/impl/auth/AuthenticationDisabled.java   |    58 +
 .../pulsar/client/impl/auth/AuthenticationTls.java |    67 +
 .../yahoo/pulsar/client/util/ExecutorProvider.java |    52 +
 .../com/yahoo/pulsar/client/util/FutureUtil.java   |    70 +
 pulsar-client/src/main/javadoc/overview.html       |    26 +
 .../resources/pulsar-client-version.properties     |     1 +
 .../yahoo/pulsar/client/api/ConsumerIdTest.java    |    72 +
 .../com/yahoo/pulsar/client/impl/BackoffTest.java  |    39 +
 .../pulsar/client/impl/BatchMessageIdImplTest.java |    43 +
 .../client/tutorial/ContinuousAsyncProducer.java   |    34 +
 .../pulsar/client/tutorial/ContinuousProducer.java |    43 +
 .../client/tutorial/SampleAsyncProducer.java       |    70 +
 .../pulsar/client/tutorial/SampleConsumer.java     |    40 +
 .../client/tutorial/SampleConsumerListener.java    |    51 +
 .../pulsar/client/tutorial/SampleProducer.java     |    36 +
 pulsar-client/src/test/resources/logback-test.xml  |    18 +
 pulsar-common/generate_protobuf.sh                 |    19 +
 pulsar-common/pom.xml                              |    72 +
 .../java/com/yahoo/pulsar/common/api/Commands.java |   569 +
 .../com/yahoo/pulsar/common/api/DoubleByteBuf.java |   421 +
 .../com/yahoo/pulsar/common/api/PulsarDecoder.java |   292 +
 .../com/yahoo/pulsar/common/api/PulsarHandler.java |   118 +
 .../common/api/PulsarLengthFieldFrameDecoder.java  |    37 +
 .../yahoo/pulsar/common/api/proto/PulsarApi.java   | 13907 +++++++++++++++++++
 .../common/compression/CompressionCodec.java       |    51 +
 .../common/compression/CompressionCodecLZ4.java    |    63 +
 .../common/compression/CompressionCodecNone.java   |    35 +
 .../compression/CompressionCodecProvider.java      |    63 +
 .../common/compression/CompressionCodecZLib.java   |   109 +
 .../pulsar/common/lookup/data/LookupData.java      |    64 +
 .../pulsar/common/naming/DestinationDomain.java    |    20 +
 .../pulsar/common/naming/DestinationName.java      |   255 +
 .../yahoo/pulsar/common/naming/NamedEntity.java    |    44 +
 .../yahoo/pulsar/common/naming/NamespaceName.java  |   162 +
 .../yahoo/pulsar/common/naming/ServiceUnitId.java  |    38 +
 .../common/partition/PartitionedTopicMetadata.java |    31 +
 .../pulsar/common/policies/AutoFailoverPolicy.java |    41 +
 .../common/policies/NamespaceIsolationPolicy.java  |   108 +
 .../pulsar/common/policies/data/AuthAction.java    |    27 +
 .../pulsar/common/policies/data/AuthPolicies.java  |    43 +
 .../policies/data/AutoFailoverPolicyData.java      |    48 +
 .../policies/data/AutoFailoverPolicyType.java      |    31 +
 .../pulsar/common/policies/data/BacklogQuota.java  |   104 +
 .../common/policies/data/BrokerAssignment.java     |    20 +
 .../pulsar/common/policies/data/BrokerStatus.java  |    61 +
 .../pulsar/common/policies/data/BundlesData.java   |    67 +
 .../pulsar/common/policies/data/ClusterData.java   |    79 +
 .../pulsar/common/policies/data/ConsumerStats.java |    48 +
 .../pulsar/common/policies/data/ErrorData.java     |    27 +
 .../pulsar/common/policies/data/LocalPolicies.java |    39 +
 .../policies/data/NamespaceIsolationData.java      |    55 +
 .../policies/data/NamespaceOwnershipStatus.java    |    39 +
 .../policies/data/PartitionedTopicStats.java       |    47 +
 .../common/policies/data/PersistencePolicies.java  |    72 +
 .../policies/data/PersistentOfflineTopicStats.java |   101 +
 .../policies/data/PersistentSubscriptionStats.java |    78 +
 .../data/PersistentTopicInternalStats.java         |    61 +
 .../common/policies/data/PersistentTopicStats.java |   116 +
 .../pulsar/common/policies/data/Policies.java      |    76 +
 .../pulsar/common/policies/data/PropertyAdmin.java |    75 +
 .../common/policies/data/PublisherStats.java       |    51 +
 .../common/policies/data/ReplicatorStats.java      |    70 +
 .../pulsar/common/policies/data/ResourceQuota.java |   215 +
 .../common/policies/data/RetentionPolicies.java    |    70 +
 .../policies/impl/AutoFailoverPolicyFactory.java   |    34 +
 .../common/policies/impl/MinAvailablePolicy.java   |    85 +
 .../policies/impl/NamespaceIsolationPolicies.java  |   170 +
 .../impl/NamespaceIsolationPolicyImpl.java         |   160 +
 .../yahoo/pulsar/common/stats/AllocatorStats.java  |    75 +
 .../java/com/yahoo/pulsar/common/util/Codec.java   |    48 +
 .../com/yahoo/pulsar/common/util/FieldParser.java  |   300 +
 .../yahoo/pulsar/common/util/KeyStoreHolder.java   |    58 +
 .../pulsar/common/util/ObjectMapperFactory.java    |    43 +
 .../yahoo/pulsar/common/util/SecurityUtility.java  |   142 +
 .../yahoo/pulsar/common/util/XXHashChecksum.java   |    37 +
 .../util/collections/ConcurrentLongHashMap.java    |   489 +
 .../util/collections/ConcurrentOpenHashMap.java    |   448 +
 .../util/collections/ConcurrentOpenHashSet.java    |   467 +
 .../collections/GrowableArrayBlockingQueue.java    |   349 +
 .../util/protobuf/ByteBufCodedInputStream.java     |   359 +
 .../util/protobuf/ByteBufCodedOutputStream.java    |   234 +
 .../buffer/AbstractRecyclableDerivedByteBuf.java   |    40 +
 .../netty/buffer/RecyclableDuplicateByteBuf.java   |   319 +
 .../io/netty/buffer/RecyclableSlicedByteBuf.java   |   299 +
 pulsar-common/src/main/proto/PulsarApi.proto       |   293 +
 .../common/compression/CompressorCodecTest.java    |   116 +
 .../common/compression/Crc32cChecksumTest.java     |    99 +
 .../pulsar/common/lookup/data/LookupDataTest.java  |    53 +
 .../pulsar/common/naming/DestinationNameTest.java  |   222 +
 .../pulsar/common/naming/NamespaceNameTest.java    |   200 +
 .../policies/data/AutoFailoverPolicyDataTest.java  |    51 +
 .../policies/data/AutoFailoverPolicyTypeTest.java  |    30 +
 .../common/policies/data/BacklogQuotaTest.java     |    38 +
 .../common/policies/data/ClusterDataTest.java      |    61 +
 .../common/policies/data/LocalPolicesTest.java     |    49 +
 .../policies/data/NamespaceIsolationDataTest.java  |    79 +
 .../data/NamespaceOwnershipStatusTest.java         |    62 +
 .../pulsar/common/policies/data/OldPolicies.java   |    57 +
 .../policies/data/PartitionedTopicStatsTest.java   |    51 +
 .../policies/data/PersistencePoliciesTest.java     |    32 +
 .../data/PersistentOfflineTopicStatsTest.java      |    46 +
 .../policies/data/PersistentTopicStatsTest.java    |    59 +
 .../common/policies/data/PoliciesDataTest.java     |   104 +
 .../common/policies/data/ReplicatorStatsTest.java  |    55 +
 .../common/policies/data/ResourceQuotaTest.java    |    80 +
 .../common/policies/data/RetentionPolicesTest.java |    32 +
 .../impl/AutoFailoverPolicyFactoryTest.java        |    50 +
 .../policies/impl/MinAvailablePolicyTest.java      |    32 +
 .../impl/NamespaceIsolationPoliciesTest.java       |   178 +
 .../impl/NamespaceIsolationPolicyImplTest.java     |   190 +
 .../collections/ConcurrentLongHashMapTest.java     |   429 +
 .../collections/ConcurrentOpenHashMapTest.java     |   456 +
 .../collections/ConcurrentOpenHashSetTest.java     |   336 +
 .../common/util/collections/FieldParserTest.java   |   118 +
 .../GrowableArrayBlockingQueueTest.java            |   201 +
 .../util/protobuf/ByteBufCodedInputStreamTest.java |    72 +
 pulsar-common/src/test/resources/log4j.properties  |    68 +
 pulsar-discovery-service/pom.xml                   |   147 +
 pulsar-discovery-service/readme.md                 |    39 +
 .../pulsar/discovery/service/DiscoveryService.java |   145 +
 .../pulsar/discovery/service/RestException.java    |    54 +
 .../discovery/service/ZookeeperCacheLoader.java    |   146 +
 .../service/server/DiscoveryServiceStarter.java    |   108 +
 .../discovery/service/server/ServerManager.java    |   154 +
 .../discovery/service/server/ServiceConfig.java    |    89 +
 .../discovery/service/DiscoveryServiceTest.java    |   303 +
 .../service/ZookeeperCacheLoaderTest.java          |    96 +
 .../zookeeper/LocalZooKeeperConnectionService.java |   166 +
 .../src/test/resources/certificate/server.crt      |    20 +
 .../src/test/resources/certificate/server.key      |    28 +
 .../src/test/resources/log4j.properties            |    68 +
 pulsar-storm/pom.xml                               |   145 +
 .../yahoo/pulsar/storm/MessageToValuesMapper.java  |    41 +
 .../java/com/yahoo/pulsar/storm/PulsarBolt.java    |   192 +
 .../pulsar/storm/PulsarBoltConfiguration.java      |    54 +
 .../java/com/yahoo/pulsar/storm/PulsarSpout.java   |   295 +
 .../pulsar/storm/PulsarSpoutConfiguration.java     |   135 +
 .../pulsar/storm/PulsarStormConfiguration.java     |    87 +
 .../com/yahoo/pulsar/storm/SharedPulsarClient.java |   122 +
 .../yahoo/pulsar/storm/TupleToMessageMapper.java   |    41 +
 pulsar-storm/src/main/javadoc/overview.html        |    26 +
 .../yahoo/pulsar/storm/MockOutputCollector.java    |    88 +
 .../pulsar/storm/MockSpoutOutputCollector.java     |    67 +
 .../com/yahoo/pulsar/storm/PulsarBoltTest.java     |   225 +
 .../com/yahoo/pulsar/storm/PulsarSpoutTest.java    |   319 +
 .../test/java/com/yahoo/pulsar/storm/TestUtil.java |    32 +
 .../yahoo/pulsar/storm/example/StormExample.java   |   168 +
 pulsar-testclient/pom.xml                          |    60 +
 .../pulsar/testclient/PerformanceConsumer.java     |   236 +
 .../pulsar/testclient/PerformanceProducer.java     |   377 +
 .../testclient/utils/PaddingDecimalFormat.java     |    69 +
 pulsar-websocket/pom.xml                           |   125 +
 .../pulsar/websocket/AbstractWebSocketHandler.java |   142 +
 .../yahoo/pulsar/websocket/ConsumerHandler.java    |   199 +
 .../yahoo/pulsar/websocket/ProducerHandler.java    |   166 +
 .../pulsar/websocket/WebSocketConsumerServlet.java |    39 +
 .../com/yahoo/pulsar/websocket/WebSocketError.java |    53 +
 .../pulsar/websocket/WebSocketProducerServlet.java |    37 +
 .../yahoo/pulsar/websocket/WebSocketService.java   |   178 +
 .../yahoo/pulsar/websocket/data/ConsumerAck.java   |    27 +
 .../pulsar/websocket/data/ConsumerMessage.java     |    31 +
 .../yahoo/pulsar/websocket/data/ProducerAck.java   |    32 +
 .../pulsar/websocket/data/ProducerMessage.java     |    27 +
 .../pulsar/websocket/service/ProxyServer.java      |   136 +
 .../websocket/service/WebSocketServiceStarter.java |    58 +
 .../authentication/AuthenticationServiceTest.java  |    86 +
 .../socket/client/MockAuthenticationProvider.java  |    51 +
 .../proxy/socket/client/PaddingDecimalFormat.java  |    69 +
 .../proxy/socket/client/PerformanceClient.java     |   292 +
 .../socket/client/SimpleTestProducerSocket.java    |   107 +
 .../src/test/resources/log4j.properties            |    68 +
 pulsar-zookeeper-utils/pom.xml                     |    74 +
 .../com/yahoo/pulsar/zookeeper/BookieInfo.java     |    38 +
 .../com/yahoo/pulsar/zookeeper/Deserializers.java  |    53 +
 .../pulsar/zookeeper/GlobalZooKeeperCache.java     |   162 +
 .../pulsar/zookeeper/LocalBookkeeperEnsemble.java  |   309 +
 .../pulsar/zookeeper/LocalZooKeeperCache.java      |    59 +
 .../zookeeper/LocalZooKeeperConnectionService.java |   166 +
 .../zookeeper/ZkBookieRackAffinityMapping.java     |   172 +
 .../ZkIsolatedBookieEnsemblePlacementPolicy.java   |   151 +
 .../com/yahoo/pulsar/zookeeper/ZooKeeperCache.java |   298 +
 .../pulsar/zookeeper/ZooKeeperCacheListener.java   |    22 +
 .../pulsar/zookeeper/ZooKeeperCacheWatcher.java    |    27 +
 .../pulsar/zookeeper/ZooKeeperChildrenCache.java   |    93 +
 .../pulsar/zookeeper/ZooKeeperClientFactory.java   |    43 +
 .../yahoo/pulsar/zookeeper/ZooKeeperDataCache.java |   109 +
 .../pulsar/zookeeper/ZooKeeperSessionWatcher.java  |   180 +
 .../zookeeper/ZookeeperClientFactoryImpl.java      |    83 +
 .../yahoo/pulsar/zookeeper/DeserializersTest.java  |    52 +
 .../zookeeper/LocalBookkeeperEnsembleTest.java     |   110 +
 .../LocalZooKeeperConnectionServiceTest.java       |   108 +
 .../MockedZooKeeperClientFactoryImpl.java          |    54 +
 .../zookeeper/ZkBookieRackAffinityMappingTest.java |   196 +
 ...kIsolatedBookieEnsemblePlacementPolicyTest.java |   306 +
 .../zookeeper/ZooKeeperSessionWatcherTest.java     |   167 +
 .../yahoo/pulsar/zookeeper/ZookeeperCacheTest.java |   320 +
 .../zookeeper/ZookeeperClientFactoryImplTest.java  |    80 +
 .../pulsar/zookeeper/ZookeeperServerTest.java      |    74 +
 src/findbugs-exclude.xml                           |    30 +
 src/formatter.xml                                  |   286 +
 src/license-header.txt                             |    13 +
 622 files changed, 129878 insertions(+)

